<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MaCh3: Diagnostics/RHat.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="MaCh3.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mach3logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MaCh3
   &#160;<span id="projectnumber">2.4.2</span>
   </div>
   <div id="projectbrief">Reference Guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_335e938d2c12c5a13717c0a8a9316e75.html">Diagnostics</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">RHat.cpp File Reference<div class="ingroups"><a class="el" href="group__MaCh3DiagnosticProcessing.html">MaCh3 Diagnostic &amp; Processing</a> &#124; <a class="el" href="group__MaCh3DiagnosticProcessing.html">MaCh3 Diagnostic &amp; Processing</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>This executable calculates the \( \hat{R} \) estimator for Markov Chain Monte Carlo (MCMC) convergence.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="Manager_8h_source.html">Manager/Manager.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="SampleStructs_8h_source.html">Samples/SampleStructs.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="HistogramUtils_8h_source.html">Samples/HistogramUtils.h</a>&quot;</code><br />
<code>#include &quot;TObjArray.h&quot;</code><br />
<code>#include &quot;TChain.h&quot;</code><br />
<code>#include &quot;TFile.h&quot;</code><br />
<code>#include &quot;TBranch.h&quot;</code><br />
<code>#include &quot;TCanvas.h&quot;</code><br />
<code>#include &quot;TLine.h&quot;</code><br />
<code>#include &quot;TLegend.h&quot;</code><br />
<code>#include &quot;TString.h&quot;</code><br />
<code>#include &quot;TH1.h&quot;</code><br />
<code>#include &quot;TRandom3.h&quot;</code><br />
<code>#include &quot;TStopwatch.h&quot;</code><br />
<code>#include &quot;TColor.h&quot;</code><br />
<code>#include &quot;TStyle.h&quot;</code><br />
<code>#include &quot;TROOT.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for RHat.cpp:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="RHat_8cpp__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div>
<p><a href="RHat_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af40d823e599ba2565e989e4f43c78628"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#af40d823e599ba2565e989e4f43c78628">PrepareChains</a> ()</td></tr>
<tr class="separator:af40d823e599ba2565e989e4f43c78628"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3efe8085dcbead1e66a6cf54fc77ab5e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#a3efe8085dcbead1e66a6cf54fc77ab5e">InitialiseArrays</a> ()</td></tr>
<tr class="separator:a3efe8085dcbead1e66a6cf54fc77ab5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c5629fb030eb27c32cab42a42c6623b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#a4c5629fb030eb27c32cab42a42c6623b">RunDiagnostic</a> ()</td></tr>
<tr class="separator:a4c5629fb030eb27c32cab42a42c6623b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd5f8455bf73bda17794dc06218e6713"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#abd5f8455bf73bda17794dc06218e6713">CalcRhat</a> ()</td></tr>
<tr class="separator:abd5f8455bf73bda17794dc06218e6713"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a194d97ca48b57a07a9df018a65f3166e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#a194d97ca48b57a07a9df018a65f3166e">SaveResults</a> ()</td></tr>
<tr class="separator:a194d97ca48b57a07a9df018a65f3166e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb60917440a91d5a3507fd4059d3e23b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#abb60917440a91d5a3507fd4059d3e23b">DestroyArrays</a> ()</td></tr>
<tr class="separator:abb60917440a91d5a3507fd4059d3e23b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac038d6f2a074799534fc4a986ca36ef3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#ac038d6f2a074799534fc4a986ca36ef3">CalcMedian</a> (double arr[], int size)</td></tr>
<tr class="separator:ac038d6f2a074799534fc4a986ca36ef3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29838c9a1c93843ffd2eb4dc33f2076d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#a29838c9a1c93843ffd2eb4dc33f2076d">CapVariable</a> (double var, double cap)</td></tr>
<tr class="separator:a29838c9a1c93843ffd2eb4dc33f2076d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a7b48ace8081df9b5f35c17126ee81046"><td class="memItemLeft" align="right" valign="top">int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#a7b48ace8081df9b5f35c17126ee81046">Ntoys_requested</a></td></tr>
<tr class="separator:a7b48ace8081df9b5f35c17126ee81046"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a348f0c1b68d0a2ece8297050105dffc1"><td class="memItemLeft" align="right" valign="top">int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#a348f0c1b68d0a2ece8297050105dffc1">Ntoys_filled</a></td></tr>
<tr class="separator:a348f0c1b68d0a2ece8297050105dffc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d5589b851b154e9a366017ca14da0f5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#a8d5589b851b154e9a366017ca14da0f5">TotToys</a></td></tr>
<tr class="separator:a8d5589b851b154e9a366017ca14da0f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a348554f563d67f5b273668bc3f3d51c7"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#a348554f563d67f5b273668bc3f3d51c7">NThin</a></td></tr>
<tr class="separator:a348554f563d67f5b273668bc3f3d51c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a231bc179b5599c7e29d5ba28ff2b4b70"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a></td></tr>
<tr class="separator:a231bc179b5599c7e29d5ba28ff2b4b70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2faf756e30936102294777663fae31d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a></td></tr>
<tr class="separator:ae2faf756e30936102294777663fae31d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a871d6466cea2597401bdb203293f4033"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TString &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#a871d6466cea2597401bdb203293f4033">BranchNames</a></td></tr>
<tr class="separator:a871d6466cea2597401bdb203293f4033"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa19a5e341d34dce5448ee490dedba8ef"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#aa19a5e341d34dce5448ee490dedba8ef">MCMCFile</a></td></tr>
<tr class="separator:aa19a5e341d34dce5448ee490dedba8ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5217beba3b3cb82269e95bf52c3d62c5"><td class="memItemLeft" align="right" valign="top">std::vector&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#a5217beba3b3cb82269e95bf52c3d62c5">ValidPar</a></td></tr>
<tr class="separator:a5217beba3b3cb82269e95bf52c3d62c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0179885171f5d0541296df969f8d609b"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#a0179885171f5d0541296df969f8d609b">S1_global</a></td></tr>
<tr class="separator:a0179885171f5d0541296df969f8d609b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a674f607d7d269b2f3d09f1e12f5e5f"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#a0a674f607d7d269b2f3d09f1e12f5e5f">S2_global</a></td></tr>
<tr class="separator:a0a674f607d7d269b2f3d09f1e12f5e5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14d43e9a0adb2500e2d44a762d3b5238"><td class="memItemLeft" align="right" valign="top">double **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#a14d43e9a0adb2500e2d44a762d3b5238">S1_chain</a></td></tr>
<tr class="separator:a14d43e9a0adb2500e2d44a762d3b5238"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf01bbc6f4a3b8dabe58adc72bccb142"><td class="memItemLeft" align="right" valign="top">double **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#adf01bbc6f4a3b8dabe58adc72bccb142">S2_chain</a></td></tr>
<tr class="separator:adf01bbc6f4a3b8dabe58adc72bccb142"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7d224b5fffa9367046f2976bb4972d1"><td class="memItemLeft" align="right" valign="top">double **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a></td></tr>
<tr class="separator:ab7d224b5fffa9367046f2976bb4972d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bdfaf60cce582e30db6bd3001de9935"><td class="memItemLeft" align="right" valign="top">double **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#a5bdfaf60cce582e30db6bd3001de9935">StandardDeviation</a></td></tr>
<tr class="separator:a5bdfaf60cce582e30db6bd3001de9935"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4526fa4abfccd1173c87267a0beb6977"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#a4526fa4abfccd1173c87267a0beb6977">MeanGlobal</a></td></tr>
<tr class="separator:a4526fa4abfccd1173c87267a0beb6977"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64de0e32daa60ec4f40e0e741d927334"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#a64de0e32daa60ec4f40e0e741d927334">StandardDeviationGlobal</a></td></tr>
<tr class="separator:a64de0e32daa60ec4f40e0e741d927334"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52dcf07f8f740636605516f6c2ab3e40"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#a52dcf07f8f740636605516f6c2ab3e40">BetweenChainVariance</a></td></tr>
<tr class="separator:a52dcf07f8f740636605516f6c2ab3e40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68813385f1240d1264e139391b12bf05"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#a68813385f1240d1264e139391b12bf05">MarginalPosteriorVariance</a></td></tr>
<tr class="separator:a68813385f1240d1264e139391b12bf05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5cfb5e8741283e8d8252aae184004e4"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#ab5cfb5e8741283e8d8252aae184004e4">RHat</a></td></tr>
<tr class="separator:ab5cfb5e8741283e8d8252aae184004e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae673254e98992bd483de55c6c1d1dcaf"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html#ae673254e98992bd483de55c6c1d1dcaf">EffectiveSampleSize</a></td></tr>
<tr class="separator:ae673254e98992bd483de55c6c1d1dcaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This executable calculates the \( \hat{R} \) estimator for Markov Chain Monte Carlo (MCMC) convergence. </p>
<p>KS: This exe is meant to calculate the \( \hat{R} \) estimator. For a well-converged chain, this distribution should be centered at one. The \( \hat{R} \) statistic is used to assess the convergence of MCMC simulations and helps determine whether the chains have reached a stable distribution.</p>
<p><a class="el" href="citelist.html#CITEREF_gelman2019">[33]</a>.</p>
<p>MJR: Update &ndash; Improved memory usage so that whole chains can be quickly loaded without requiring copious amounts of RAM. This comes at the cost of not being able to calculate the Folded RHat since finding the median requires the loading of full chains at a time. The method has been validated to give identical results to the "High Memory" (original) version at a fraction of the runtime and resources.</p>
<p>The input format is also slightly altered; since we can now load entire chains, there's less need to specify how many toys are desired for a sub-sample, so the Ntoys input has been removed.</p>
<dl class="section author"><dt>Author</dt><dd>Kamil Skwarczynski </dd>
<dd>
Michael Reh</dd></dl>
<p>KS: This exe is meant to calculate the \( \hat{R} \) estimator. For a well-converged chain, this distribution should be centered at one. The \( \hat{R} \) statistic is used to assess the convergence of MCMC simulations and helps determine whether the chains have reached a stable distribution.</p>
<p><a class="el" href="citelist.html#CITEREF_gelman2019">[33]</a>.</p>
<dl class="section author"><dt>Author</dt><dd>Kamil Skwarczynski </dd>
<dd>
Michael Reh </dd></dl>

<p class="definition">Definition in file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ac038d6f2a074799534fc4a986ca36ef3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac038d6f2a074799534fc4a986ca36ef3">&#9670;&nbsp;</a></span>CalcMedian()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double CalcMedian </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>arr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00688">688</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                                                {</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">// *******************</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  std::sort(arr, arr+size);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="keywordflow">if</span> (size % 2 != 0)</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="keywordflow">return</span> arr[size/2];</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="keywordflow">return</span> (arr[(size-1)/2] + arr[size/2])/2.0;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abd5f8455bf73bda17794dc06218e6713"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd5f8455bf73bda17794dc06218e6713">&#9670;&nbsp;</a></span>CalcRhat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CalcRhat </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00387">387</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">// *******************</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  TStopwatch clock;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  clock.Start();</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">//KS: Start parallel region</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="comment">// If we would like to do this for thousands of chains we might consider using GPU for this</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="preprocessor">  #pragma omp parallel</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="preprocessor">    #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="preprocessor">    #pragma omp for</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="comment">//KS: loop over chains and draws are independent so might as well collapse for sweet cache hits</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="comment">//Calculate the mean for each parameter within each considered chain</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="comment">// MJR: Calculate using running totals to massively save on time and memory</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; <a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>; ++m)</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>; ++j)</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <a class="code" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a>[m][j] = <a class="code" href="RHat_8cpp.html#a14d43e9a0adb2500e2d44a762d3b5238">S1_chain</a>[m][j] / <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(<a class="code" href="RHat_8cpp.html#a348f0c1b68d0a2ece8297050105dffc1">Ntoys_filled</a>[m]);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <a class="code" href="RHat_8cpp.html#a5bdfaf60cce582e30db6bd3001de9935">StandardDeviation</a>[m][j] = <a class="code" href="RHat_8cpp.html#adf01bbc6f4a3b8dabe58adc72bccb142">S2_chain</a>[m][j]/<span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(<a class="code" href="RHat_8cpp.html#a348f0c1b68d0a2ece8297050105dffc1">Ntoys_filled</a>[m]) - <a class="code" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a>[m][j]*<a class="code" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a>[m][j];</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="preprocessor">    #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="preprocessor">    #pragma omp for</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">//Calculate the mean for each parameter global means we include information from several chains</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>; ++j)</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; <a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>; ++m)</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <a class="code" href="RHat_8cpp.html#a64de0e32daa60ec4f40e0e741d927334">StandardDeviationGlobal</a>[j] += <a class="code" href="RHat_8cpp.html#a5bdfaf60cce582e30db6bd3001de9935">StandardDeviation</a>[m][j];</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      }</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      <a class="code" href="RHat_8cpp.html#a4526fa4abfccd1173c87267a0beb6977">MeanGlobal</a>[j] = <a class="code" href="RHat_8cpp.html#a0179885171f5d0541296df969f8d609b">S1_global</a>[j] / <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(<a class="code" href="RHat_8cpp.html#a8d5589b851b154e9a366017ca14da0f5">TotToys</a>);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <a class="code" href="RHat_8cpp.html#a64de0e32daa60ec4f40e0e741d927334">StandardDeviationGlobal</a>[j] = <a class="code" href="RHat_8cpp.html#a64de0e32daa60ec4f40e0e741d927334">StandardDeviationGlobal</a>[j] / <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(<a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    }</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="preprocessor">    #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="preprocessor">    #pragma omp for</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>; ++j)</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <span class="comment">//KS: This term only makes sense if we have at least 2 chains</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a> == 1)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <a class="code" href="RHat_8cpp.html#a52dcf07f8f740636605516f6c2ab3e40">BetweenChainVariance</a>[j] = 0.;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; <a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>; ++m)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;          <a class="code" href="RHat_8cpp.html#a52dcf07f8f740636605516f6c2ab3e40">BetweenChainVariance</a>[j] += ( <a class="code" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a>[m][j] - <a class="code" href="RHat_8cpp.html#a4526fa4abfccd1173c87267a0beb6977">MeanGlobal</a>[j])*( <a class="code" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a>[m][j] - <a class="code" href="RHat_8cpp.html#a4526fa4abfccd1173c87267a0beb6977">MeanGlobal</a>[j]) * <a class="code" href="RHat_8cpp.html#a348f0c1b68d0a2ece8297050105dffc1">Ntoys_filled</a>[m];</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <a class="code" href="RHat_8cpp.html#a52dcf07f8f740636605516f6c2ab3e40">BetweenChainVariance</a>[j] = <a class="code" href="RHat_8cpp.html#a52dcf07f8f740636605516f6c2ab3e40">BetweenChainVariance</a>[j]/(<a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>-1);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordtype">int</span> avgNtoys = <a class="code" href="RHat_8cpp.html#a8d5589b851b154e9a366017ca14da0f5">TotToys</a>/<a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="preprocessor">    #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="preprocessor">    #pragma omp for</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>; ++j)</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    {</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <a class="code" href="RHat_8cpp.html#a68813385f1240d1264e139391b12bf05">MarginalPosteriorVariance</a>[j] = (avgNtoys-1) * <a class="code" href="RHat_8cpp.html#a64de0e32daa60ec4f40e0e741d927334">StandardDeviationGlobal</a>[j] / (avgNtoys) + <a class="code" href="RHat_8cpp.html#a52dcf07f8f740636605516f6c2ab3e40">BetweenChainVariance</a>[j]/avgNtoys;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="preprocessor">    #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="preprocessor">    #pragma omp for</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="comment">//Finally calculate our estimator</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>; ++j)</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <a class="code" href="RHat_8cpp.html#ab5cfb5e8741283e8d8252aae184004e4">RHat</a>[j] = sqrt(<a class="code" href="RHat_8cpp.html#a68813385f1240d1264e139391b12bf05">MarginalPosteriorVariance</a>[j]/<a class="code" href="RHat_8cpp.html#a64de0e32daa60ec4f40e0e741d927334">StandardDeviationGlobal</a>[j]);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <span class="comment">//KS: For flat params values can be crazy so cap at 0</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <a class="code" href="RHat_8cpp.html#a29838c9a1c93843ffd2eb4dc33f2076d">CapVariable</a>(<a class="code" href="RHat_8cpp.html#ab5cfb5e8741283e8d8252aae184004e4">RHat</a>[j], 0);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    }</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="preprocessor">    #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="preprocessor">    #pragma omp for</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="comment">//KS: Additionally calculates effective step size which is an estimate of the sample size required to achieve the same level of precision if that sample was a simple random sample.</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>; ++j)</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a> &gt; 1) <a class="code" href="RHat_8cpp.html#ae673254e98992bd483de55c6c1d1dcaf">EffectiveSampleSize</a>[j] = <a class="code" href="RHat_8cpp.html#a8d5589b851b154e9a366017ca14da0f5">TotToys</a> * <a class="code" href="RHat_8cpp.html#a68813385f1240d1264e139391b12bf05">MarginalPosteriorVariance</a>[j] / <a class="code" href="RHat_8cpp.html#a52dcf07f8f740636605516f6c2ab3e40">BetweenChainVariance</a>[j];</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="comment">//KS: For flat params values can be crazy so cap at 0</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <a class="code" href="RHat_8cpp.html#a29838c9a1c93843ffd2eb4dc33f2076d">CapVariable</a>(<a class="code" href="RHat_8cpp.html#ae673254e98992bd483de55c6c1d1dcaf">EffectiveSampleSize</a>[j], 0);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    }</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  } <span class="comment">//End parallel region</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  clock.Stop();</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Finished calculating RHat, it took {:.2f}s to finish&quot;</span>, clock.RealTime());</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a95fa4dffc648e4c5536c9292c2bdcac3"><div class="ttname"><a href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a></div><div class="ttdeci">#define MACH3LOG_INFO</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00035">MaCh3Logger.h:35</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_a0179885171f5d0541296df969f8d609b"><div class="ttname"><a href="RHat_8cpp.html#a0179885171f5d0541296df969f8d609b">S1_global</a></div><div class="ttdeci">double * S1_global</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00058">RHat.cpp:58</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_a14d43e9a0adb2500e2d44a762d3b5238"><div class="ttname"><a href="RHat_8cpp.html#a14d43e9a0adb2500e2d44a762d3b5238">S1_chain</a></div><div class="ttdeci">double ** S1_chain</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00060">RHat.cpp:60</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_a231bc179b5599c7e29d5ba28ff2b4b70"><div class="ttname"><a href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a></div><div class="ttdeci">int Nchains</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00051">RHat.cpp:51</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_a29838c9a1c93843ffd2eb4dc33f2076d"><div class="ttname"><a href="RHat_8cpp.html#a29838c9a1c93843ffd2eb4dc33f2076d">CapVariable</a></div><div class="ttdeci">void CapVariable(double var, double cap)</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00698">RHat.cpp:698</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_a348f0c1b68d0a2ece8297050105dffc1"><div class="ttname"><a href="RHat_8cpp.html#a348f0c1b68d0a2ece8297050105dffc1">Ntoys_filled</a></div><div class="ttdeci">int * Ntoys_filled</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00048">RHat.cpp:48</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_a4526fa4abfccd1173c87267a0beb6977"><div class="ttname"><a href="RHat_8cpp.html#a4526fa4abfccd1173c87267a0beb6977">MeanGlobal</a></div><div class="ttdeci">double * MeanGlobal</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00066">RHat.cpp:66</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_a52dcf07f8f740636605516f6c2ab3e40"><div class="ttname"><a href="RHat_8cpp.html#a52dcf07f8f740636605516f6c2ab3e40">BetweenChainVariance</a></div><div class="ttdeci">double * BetweenChainVariance</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00069">RHat.cpp:69</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_a5bdfaf60cce582e30db6bd3001de9935"><div class="ttname"><a href="RHat_8cpp.html#a5bdfaf60cce582e30db6bd3001de9935">StandardDeviation</a></div><div class="ttdeci">double ** StandardDeviation</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00064">RHat.cpp:64</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_a64de0e32daa60ec4f40e0e741d927334"><div class="ttname"><a href="RHat_8cpp.html#a64de0e32daa60ec4f40e0e741d927334">StandardDeviationGlobal</a></div><div class="ttdeci">double * StandardDeviationGlobal</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00067">RHat.cpp:67</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_a68813385f1240d1264e139391b12bf05"><div class="ttname"><a href="RHat_8cpp.html#a68813385f1240d1264e139391b12bf05">MarginalPosteriorVariance</a></div><div class="ttdeci">double * MarginalPosteriorVariance</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00070">RHat.cpp:70</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_a8d5589b851b154e9a366017ca14da0f5"><div class="ttname"><a href="RHat_8cpp.html#a8d5589b851b154e9a366017ca14da0f5">TotToys</a></div><div class="ttdeci">int TotToys</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00049">RHat.cpp:49</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_ab5cfb5e8741283e8d8252aae184004e4"><div class="ttname"><a href="RHat_8cpp.html#ab5cfb5e8741283e8d8252aae184004e4">RHat</a></div><div class="ttdeci">double * RHat</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00071">RHat.cpp:71</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_ab7d224b5fffa9367046f2976bb4972d1"><div class="ttname"><a href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a></div><div class="ttdeci">double ** Mean</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00063">RHat.cpp:63</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_adf01bbc6f4a3b8dabe58adc72bccb142"><div class="ttname"><a href="RHat_8cpp.html#adf01bbc6f4a3b8dabe58adc72bccb142">S2_chain</a></div><div class="ttdeci">double ** S2_chain</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00061">RHat.cpp:61</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_ae2faf756e30936102294777663fae31d"><div class="ttname"><a href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a></div><div class="ttdeci">int nDraw</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00052">RHat.cpp:52</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_ae673254e98992bd483de55c6c1d1dcaf"><div class="ttname"><a href="RHat_8cpp.html#ae673254e98992bd483de55c6c1d1dcaf">EffectiveSampleSize</a></div><div class="ttdeci">double * EffectiveSampleSize</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00072">RHat.cpp:72</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a29838c9a1c93843ffd2eb4dc33f2076d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29838c9a1c93843ffd2eb4dc33f2076d">&#9670;&nbsp;</a></span>CapVariable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CapVariable </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00698">698</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                                               {</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">// *******************</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="keywordflow">if</span>(std::isnan(var) || !std::isfinite(var)) var = cap;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abb60917440a91d5a3507fd4059d3e23b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb60917440a91d5a3507fd4059d3e23b">&#9670;&nbsp;</a></span>DestroyArrays()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DestroyArrays </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00657">657</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                     {</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">// *******************</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160; </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Killing all arrays&quot;</span>);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="keyword">delete</span>[] <a class="code" href="RHat_8cpp.html#a4526fa4abfccd1173c87267a0beb6977">MeanGlobal</a>;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="keyword">delete</span>[] <a class="code" href="RHat_8cpp.html#a64de0e32daa60ec4f40e0e741d927334">StandardDeviationGlobal</a>;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="keyword">delete</span>[] <a class="code" href="RHat_8cpp.html#a52dcf07f8f740636605516f6c2ab3e40">BetweenChainVariance</a>;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="keyword">delete</span>[] <a class="code" href="RHat_8cpp.html#a68813385f1240d1264e139391b12bf05">MarginalPosteriorVariance</a>;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="keyword">delete</span>[] <a class="code" href="RHat_8cpp.html#ab5cfb5e8741283e8d8252aae184004e4">RHat</a>;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keyword">delete</span>[] <a class="code" href="RHat_8cpp.html#ae673254e98992bd483de55c6c1d1dcaf">EffectiveSampleSize</a>;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> m = 0; m &lt; <a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>; m++)</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a>[m];</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="RHat_8cpp.html#a5bdfaf60cce582e30db6bd3001de9935">StandardDeviation</a>[m];</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="RHat_8cpp.html#a14d43e9a0adb2500e2d44a762d3b5238">S1_chain</a>[m];</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="RHat_8cpp.html#adf01bbc6f4a3b8dabe58adc72bccb142">S2_chain</a>[m];</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  <span class="keyword">delete</span>[] <a class="code" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a>;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <span class="keyword">delete</span>[] <a class="code" href="RHat_8cpp.html#a5bdfaf60cce582e30db6bd3001de9935">StandardDeviation</a>;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="keyword">delete</span>[] <a class="code" href="RHat_8cpp.html#a14d43e9a0adb2500e2d44a762d3b5238">S1_chain</a>;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <span class="keyword">delete</span>[] <a class="code" href="RHat_8cpp.html#adf01bbc6f4a3b8dabe58adc72bccb142">S2_chain</a>;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="keyword">delete</span>[] <a class="code" href="RHat_8cpp.html#a0179885171f5d0541296df969f8d609b">S1_global</a>;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="keyword">delete</span>[] <a class="code" href="RHat_8cpp.html#a0a674f607d7d269b2f3d09f1e12f5e5f">S2_global</a>;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="keyword">delete</span>[] <a class="code" href="RHat_8cpp.html#a7b48ace8081df9b5f35c17126ee81046">Ntoys_requested</a>;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="keyword">delete</span>[] <a class="code" href="RHat_8cpp.html#a348f0c1b68d0a2ece8297050105dffc1">Ntoys_filled</a>;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;}</div>
<div class="ttc" id="aRHat_8cpp_html_a0a674f607d7d269b2f3d09f1e12f5e5f"><div class="ttname"><a href="RHat_8cpp.html#a0a674f607d7d269b2f3d09f1e12f5e5f">S2_global</a></div><div class="ttdeci">double * S2_global</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00059">RHat.cpp:59</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_a7b48ace8081df9b5f35c17126ee81046"><div class="ttname"><a href="RHat_8cpp.html#a7b48ace8081df9b5f35c17126ee81046">Ntoys_requested</a></div><div class="ttdeci">int * Ntoys_requested</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00047">RHat.cpp:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3efe8085dcbead1e66a6cf54fc77ab5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3efe8085dcbead1e66a6cf54fc77ab5e">&#9670;&nbsp;</a></span>InitialiseArrays()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void InitialiseArrays </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00339">339</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                        {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">// *******************</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Initialising arrays&quot;</span>);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <a class="code" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>*[<a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>]();</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <a class="code" href="RHat_8cpp.html#a5bdfaf60cce582e30db6bd3001de9935">StandardDeviation</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>*[<a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>]();</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <a class="code" href="RHat_8cpp.html#a4526fa4abfccd1173c87267a0beb6977">MeanGlobal</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>]();</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <a class="code" href="RHat_8cpp.html#a64de0e32daa60ec4f40e0e741d927334">StandardDeviationGlobal</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>]();</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <a class="code" href="RHat_8cpp.html#a52dcf07f8f740636605516f6c2ab3e40">BetweenChainVariance</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>]();</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <a class="code" href="RHat_8cpp.html#a68813385f1240d1264e139391b12bf05">MarginalPosteriorVariance</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>]();</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <a class="code" href="RHat_8cpp.html#ab5cfb5e8741283e8d8252aae184004e4">RHat</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>]();</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <a class="code" href="RHat_8cpp.html#ae673254e98992bd483de55c6c1d1dcaf">EffectiveSampleSize</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>]();</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; <a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>; ++m)</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <a class="code" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a>[m] = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>]();</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="RHat_8cpp.html#a5bdfaf60cce582e30db6bd3001de9935">StandardDeviation</a>[m] = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>]();</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>; ++j)</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <a class="code" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a>[m][j] = 0.;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <a class="code" href="RHat_8cpp.html#a5bdfaf60cce582e30db6bd3001de9935">StandardDeviation</a>[m][j] = 0.;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="keywordflow">if</span>(m == 0)</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <a class="code" href="RHat_8cpp.html#a4526fa4abfccd1173c87267a0beb6977">MeanGlobal</a>[j] = 0.;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <a class="code" href="RHat_8cpp.html#a64de0e32daa60ec4f40e0e741d927334">StandardDeviationGlobal</a>[j] = 0.;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <a class="code" href="RHat_8cpp.html#a52dcf07f8f740636605516f6c2ab3e40">BetweenChainVariance</a>[j] = 0.;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <a class="code" href="RHat_8cpp.html#a68813385f1240d1264e139391b12bf05">MarginalPosteriorVariance</a>[j] = 0.;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <a class="code" href="RHat_8cpp.html#ab5cfb5e8741283e8d8252aae184004e4">RHat</a>[j] = 0.;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <a class="code" href="RHat_8cpp.html#ae673254e98992bd483de55c6c1d1dcaf">EffectiveSampleSize</a>[j] = 0.;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0ddf1224851353fc92bfbff6f499fa97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ddf1224851353fc92bfbff6f499fa97">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00088">88</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                                 {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">// *******************</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#aa603c55ea73cd86d1994901227883e1e">SetMaCh3LoggerFormat</a>();</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <a class="code" href="namespaceMaCh3Utils.html#ac6f4a3b6a7749967ff9a011469352f6c">MaCh3Utils::MaCh3Welcome</a>();</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <a class="code" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <a class="code" href="RHat_8cpp.html#a5bdfaf60cce582e30db6bd3001de9935">StandardDeviation</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="RHat_8cpp.html#a4526fa4abfccd1173c87267a0beb6977">MeanGlobal</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <a class="code" href="RHat_8cpp.html#a64de0e32daa60ec4f40e0e741d927334">StandardDeviationGlobal</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <a class="code" href="RHat_8cpp.html#a52dcf07f8f740636605516f6c2ab3e40">BetweenChainVariance</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <a class="code" href="RHat_8cpp.html#a68813385f1240d1264e139391b12bf05">MarginalPosteriorVariance</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="RHat_8cpp.html#ab5cfb5e8741283e8d8252aae184004e4">RHat</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="RHat_8cpp.html#ae673254e98992bd483de55c6c1d1dcaf">EffectiveSampleSize</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a> = 0;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordflow">if</span> (argc &lt; 2)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Wrong arguments&quot;</span>);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;./RHat NThin MCMCchain_1.root MCMCchain_2.root MCMCchain_3.root ... [how many you like]&quot;</span>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="RHat_8cpp.html#a348554f563d67f5b273668bc3f3d51c7">NThin</a> = atoi(argv[1]);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="comment">//KS Gelman suggests to diagnose on more than one chain</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 2; i &lt; argc; i++)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <a class="code" href="RHat_8cpp.html#aa19a5e341d34dce5448ee490dedba8ef">MCMCFile</a>.push_back(std::string(argv[i]));</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Adding file: {}&quot;</span>, <a class="code" href="RHat_8cpp.html#aa19a5e341d34dce5448ee490dedba8ef">MCMCFile</a>.back());</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>++;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a> == 1)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Gelman is going to be sad :(. He suggested you should use more than one chain (at least 4). Code works fine for one chain, however, estimator might be biased.&quot;</span>);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Multiple chains are more likely to reveal multimodality and poor adaptation or mixing:&quot;</span>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Diagnosing {} chains&quot;</span>, <a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <a class="code" href="RHat_8cpp.html#af40d823e599ba2565e989e4f43c78628">PrepareChains</a>();</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <a class="code" href="RHat_8cpp.html#a3efe8085dcbead1e66a6cf54fc77ab5e">InitialiseArrays</a>();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="comment">//KS: Main function</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <a class="code" href="RHat_8cpp.html#a4c5629fb030eb27c32cab42a42c6623b">RunDiagnostic</a>();</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <a class="code" href="RHat_8cpp.html#a194d97ca48b57a07a9df018a65f3166e">SaveResults</a>();</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <a class="code" href="RHat_8cpp.html#abb60917440a91d5a3507fd4059d3e23b">DestroyArrays</a>();</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a61052119a625282d0ec6d4a97adf3ee2"><div class="ttname"><a href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a></div><div class="ttdeci">#define MACH3LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00037">MaCh3Logger.h:37</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_aa603c55ea73cd86d1994901227883e1e"><div class="ttname"><a href="MaCh3Logger_8h.html#aa603c55ea73cd86d1994901227883e1e">SetMaCh3LoggerFormat</a></div><div class="ttdeci">void SetMaCh3LoggerFormat()</div><div class="ttdoc">Set messaging format of the logger.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00061">MaCh3Logger.h:61</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_ad5b2eb6377721e3ac95def22c2386bb1"><div class="ttname"><a href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a></div><div class="ttdeci">#define MACH3LOG_WARN</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00036">MaCh3Logger.h:36</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_a194d97ca48b57a07a9df018a65f3166e"><div class="ttname"><a href="RHat_8cpp.html#a194d97ca48b57a07a9df018a65f3166e">SaveResults</a></div><div class="ttdeci">void SaveResults()</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00491">RHat.cpp:491</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_a348554f563d67f5b273668bc3f3d51c7"><div class="ttname"><a href="RHat_8cpp.html#a348554f563d67f5b273668bc3f3d51c7">NThin</a></div><div class="ttdeci">unsigned int NThin</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00050">RHat.cpp:50</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_a3efe8085dcbead1e66a6cf54fc77ab5e"><div class="ttname"><a href="RHat_8cpp.html#a3efe8085dcbead1e66a6cf54fc77ab5e">InitialiseArrays</a></div><div class="ttdeci">void InitialiseArrays()</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00339">RHat.cpp:339</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_a4c5629fb030eb27c32cab42a42c6623b"><div class="ttname"><a href="RHat_8cpp.html#a4c5629fb030eb27c32cab42a42c6623b">RunDiagnostic</a></div><div class="ttdeci">void RunDiagnostic()</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00378">RHat.cpp:378</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_aa19a5e341d34dce5448ee490dedba8ef"><div class="ttname"><a href="RHat_8cpp.html#aa19a5e341d34dce5448ee490dedba8ef">MCMCFile</a></div><div class="ttdeci">std::vector&lt; std::string &gt; MCMCFile</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00055">RHat.cpp:55</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_abb60917440a91d5a3507fd4059d3e23b"><div class="ttname"><a href="RHat_8cpp.html#abb60917440a91d5a3507fd4059d3e23b">DestroyArrays</a></div><div class="ttdeci">void DestroyArrays()</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00657">RHat.cpp:657</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_af40d823e599ba2565e989e4f43c78628"><div class="ttname"><a href="RHat_8cpp.html#af40d823e599ba2565e989e4f43c78628">PrepareChains</a></div><div class="ttdeci">void PrepareChains()</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00147">RHat.cpp:147</a></div></div>
<div class="ttc" id="aclassMaCh3Exception_html"><div class="ttname"><a href="classMaCh3Exception.html">MaCh3Exception</a></div><div class="ttdoc">Custom exception class used throughout MaCh3.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Exception_8h_source.html#l00023">MaCh3Exception.h:23</a></div></div>
<div class="ttc" id="anamespaceMaCh3Utils_html_ac6f4a3b6a7749967ff9a011469352f6c"><div class="ttname"><a href="namespaceMaCh3Utils.html#ac6f4a3b6a7749967ff9a011469352f6c">MaCh3Utils::MaCh3Welcome</a></div><div class="ttdeci">void MaCh3Welcome()</div><div class="ttdoc">KS: Prints welcome message with MaCh3 logo.</div><div class="ttdef"><b>Definition:</b> <a href="Monitor_8cpp_source.html#l00012">Monitor.cpp:12</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af40d823e599ba2565e989e4f43c78628"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af40d823e599ba2565e989e4f43c78628">&#9670;&nbsp;</a></span>PrepareChains()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PrepareChains </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00147">147</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                     {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">// *******************</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  TStopwatch clock;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  clock.Start();</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <a class="code" href="RHat_8cpp.html#a7b48ace8081df9b5f35c17126ee81046">Ntoys_requested</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>]();</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <a class="code" href="RHat_8cpp.html#a348f0c1b68d0a2ece8297050105dffc1">Ntoys_filled</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>]();</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <a class="code" href="RHat_8cpp.html#a8d5589b851b154e9a366017ca14da0f5">TotToys</a> = 0;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  std::vector&lt;unsigned int&gt; BurnIn(<a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  std::vector&lt;unsigned int&gt; nEntries(<a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  std::vector&lt;int&gt; nBranches(<a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  std::vector&lt;unsigned int&gt; step(<a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <a class="code" href="RHat_8cpp.html#a14d43e9a0adb2500e2d44a762d3b5238">S1_chain</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>*[<a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>]();</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <a class="code" href="RHat_8cpp.html#adf01bbc6f4a3b8dabe58adc72bccb142">S2_chain</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>*[<a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>]();</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="comment">// KS: This can reduce time necessary for caching even by half</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="comment">//ROOT::EnableImplicitMT();</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="comment">// Open the Chain</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="comment">//It is tempting to multithread here but unfortunately, ROOT files are not thread safe :(</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; <a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>; m++)</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    TChain* Chain = <span class="keyword">new</span> TChain(<span class="stringliteral">&quot;posteriors&quot;</span>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    Chain-&gt;Add(<a class="code" href="RHat_8cpp.html#aa19a5e341d34dce5448ee490dedba8ef">MCMCFile</a>[m].c_str());</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    nEntries[m] = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(Chain-&gt;GetEntries());</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="RHat_8cpp.html#a7b48ace8081df9b5f35c17126ee81046">Ntoys_requested</a>[m] = nEntries[m]/<a class="code" href="RHat_8cpp.html#a348554f563d67f5b273668bc3f3d51c7">NThin</a>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="RHat_8cpp.html#a348f0c1b68d0a2ece8297050105dffc1">Ntoys_filled</a>[m] = 0;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;On file: {}&quot;</span>, <a class="code" href="RHat_8cpp.html#aa19a5e341d34dce5448ee490dedba8ef">MCMCFile</a>[m].c_str());</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Generating {} Toys&quot;</span>, <a class="code" href="RHat_8cpp.html#a7b48ace8081df9b5f35c17126ee81046">Ntoys_requested</a>[m]);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">// Set the step cut to be 20%</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    BurnIn[m] = nEntries[m]/5;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">// Get the list of branches</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    TObjArray* brlis = Chain-&gt;GetListOfBranches();</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">// Get the number of branches</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    nBranches[m] = brlis-&gt;GetEntries();</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">if</span>(m == 0) <a class="code" href="RHat_8cpp.html#a871d6466cea2597401bdb203293f4033">BranchNames</a>.reserve(nBranches[m]);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">// Set all the branches to off</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    Chain-&gt;SetBranchStatus(<span class="stringliteral">&quot;*&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">// Loop over the number of branches</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">// Find the name and how many of each systematic we have</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nBranches[m]; i++)</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="comment">// Get the TBranch and its name</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      TBranch* br = <span class="keyword">static_cast&lt;</span>TBranch *<span class="keyword">&gt;</span>(brlis-&gt;At(i));</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keywordflow">if</span>(!br){</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Invalid branch at position {}&quot;</span>, i);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__,__LINE__);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      TString bname = br-&gt;GetName();</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="comment">// Read in the step</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="keywordflow">if</span> (bname == <span class="stringliteral">&quot;step&quot;</span>) {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        Chain-&gt;SetBranchStatus(bname, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        Chain-&gt;SetBranchAddress(bname, &amp;step[m]);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <span class="comment">//Count all branches</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bname.BeginsWith(<span class="stringliteral">&quot;PCA_&quot;</span>) || bname.BeginsWith(<span class="stringliteral">&quot;accProb&quot;</span>) || bname.BeginsWith(<span class="stringliteral">&quot;stepTime&quot;</span>) )</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="comment">//KS: Save branch name only for one chain, we assume all chains have the same branches, otherwise this doesn&#39;t make sense either way</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">if</span>(m == 0)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;          <a class="code" href="RHat_8cpp.html#a871d6466cea2597401bdb203293f4033">BranchNames</a>.push_back(bname);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;          <span class="comment">//KS: We calculate R Hat also for LogL, just in case, however we plot them separately</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;          <span class="keywordflow">if</span>(bname.BeginsWith(<span class="stringliteral">&quot;LogL&quot;</span>))</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;          {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <a class="code" href="RHat_8cpp.html#a5217beba3b3cb82269e95bf52c3d62c5">ValidPar</a>.push_back(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;          {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <a class="code" href="RHat_8cpp.html#a5217beba3b3cb82269e95bf52c3d62c5">ValidPar</a>.push_back(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;          }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        Chain-&gt;SetBranchStatus(bname, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a>(<span class="stringliteral">&quot;{}&quot;</span>, bname);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">if</span>(m == 0) <a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a> = int(<a class="code" href="RHat_8cpp.html#a871d6466cea2597401bdb203293f4033">BranchNames</a>.size());</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">// MJR: Initialize quantities needed for calculating RHat</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="RHat_8cpp.html#a14d43e9a0adb2500e2d44a762d3b5238">S1_chain</a>[m] = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>]();</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="RHat_8cpp.html#adf01bbc6f4a3b8dabe58adc72bccb142">S2_chain</a>[m] = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>]();</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">if</span> (m == 0)</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <a class="code" href="RHat_8cpp.html#a0179885171f5d0541296df969f8d609b">S1_global</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>]();</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <a class="code" href="RHat_8cpp.html#a0a674f607d7d269b2f3d09f1e12f5e5f">S2_global</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>]();</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; <a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>; ++id)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <a class="code" href="RHat_8cpp.html#a14d43e9a0adb2500e2d44a762d3b5238">S1_chain</a>[m][id] = 0.0;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <a class="code" href="RHat_8cpp.html#adf01bbc6f4a3b8dabe58adc72bccb142">S2_chain</a>[m][id] = 0.0;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keywordflow">if</span> (m == 0)</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <a class="code" href="RHat_8cpp.html#a0179885171f5d0541296df969f8d609b">S1_global</a>[id] = 0.0;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <a class="code" href="RHat_8cpp.html#a0a674f607d7d269b2f3d09f1e12f5e5f">S2_global</a>[id] = 0.0;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">//TN: Qualitatively faster sanity check, with the very same outcome (all chains have the same #branches)</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">if</span>(m &gt; 0)</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="keywordflow">if</span>(nBranches[m] != nBranches[0])</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Ups, something went wrong, chain {} called {} has {} branches, while 0 called {} has {} branches&quot;</span>, m, <a class="code" href="RHat_8cpp.html#aa19a5e341d34dce5448ee490dedba8ef">MCMCFile</a>[m], nBranches[m], <a class="code" href="RHat_8cpp.html#aa19a5e341d34dce5448ee490dedba8ef">MCMCFile</a>[0], nBranches[0]);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;All chains should have the same number of branches&quot;</span>);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">// MJR: Create an array to hold branch values. Resetting branch addresses</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">//      for every step is very expensive.</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordtype">double</span>* branch_values = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>]();</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; <a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>; ++id)</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      Chain-&gt;SetBranchAddress(<a class="code" href="RHat_8cpp.html#a871d6466cea2597401bdb203293f4033">BranchNames</a>[<span class="keywordtype">id</span>].Data(), &amp;branch_values[id]);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">//TN: move looping over toys here, so we don&#39;t need to loop over chains more than once</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordflow">if</span>(BurnIn[m] &gt;= nEntries[m])</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;You are running on a chain shorter than BurnIn cut&quot;</span>);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Number of entries {} BurnIn cut {}&quot;</span>, nEntries[m], BurnIn[m]);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;You will run into the infinite loop&quot;</span>);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;You can make a new chain or modify BurnIn cut&quot;</span>);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Loading chain {} / {}...&quot;</span>, m, <a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="RHat_8cpp.html#a7b48ace8081df9b5f35c17126ee81046">Ntoys_requested</a>[m]; i++)</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <span class="comment">// This is here as a placeholder in case we want to do some thinning later</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="keywordtype">int</span> entry = i*<a class="code" href="RHat_8cpp.html#a348554f563d67f5b273668bc3f3d51c7">NThin</a>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      Chain-&gt;GetEntry(entry);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="comment">// If we have combined chains by hadd need to check the step in the chain</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="comment">// Note, entry is not necessarily the same as the step due to merged ROOT files, so can&#39;t choose an entry in the range BurnIn - nEntries :(</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="keywordflow">if</span> (step[m] &lt; BurnIn[m])</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="comment">// Output some info for the user</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="RHat_8cpp.html#a7b48ace8081df9b5f35c17126ee81046">Ntoys_requested</a>[m] &gt; 10 &amp;&amp; i % (<a class="code" href="RHat_8cpp.html#a7b48ace8081df9b5f35c17126ee81046">Ntoys_requested</a>[m]/10) == 0) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <a class="code" href="namespaceMaCh3Utils.html#a4c8bdeb1d34606aed192e9f1311a72f5">MaCh3Utils::PrintProgressBar</a>(i+m*<a class="code" href="RHat_8cpp.html#a7b48ace8081df9b5f35c17126ee81046">Ntoys_requested</a>[m], <span class="keyword">static_cast&lt;</span>Long64_t<span class="keyword">&gt;</span>(<a class="code" href="RHat_8cpp.html#a7b48ace8081df9b5f35c17126ee81046">Ntoys_requested</a>[m])*<a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a>(<span class="stringliteral">&quot;Getting random entry {}&quot;</span>, entry);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="comment">// MJR: Fill running quantities instead of loading everything into RAM.</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="comment">//      This is where we save big on both memory and time (resetting</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="comment">//      branch addresses and calling GetEntry() again here is very slow).</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>; ++j)</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <a class="code" href="RHat_8cpp.html#a0179885171f5d0541296df969f8d609b">S1_global</a>[j] += branch_values[j];</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <a class="code" href="RHat_8cpp.html#a0a674f607d7d269b2f3d09f1e12f5e5f">S2_global</a>[j] += branch_values[j]*branch_values[j];</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <a class="code" href="RHat_8cpp.html#a14d43e9a0adb2500e2d44a762d3b5238">S1_chain</a>[m][j] += branch_values[j];</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <a class="code" href="RHat_8cpp.html#adf01bbc6f4a3b8dabe58adc72bccb142">S2_chain</a>[m][j] += branch_values[j]*branch_values[j];</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="comment">// Increment counters</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <a class="code" href="RHat_8cpp.html#a348f0c1b68d0a2ece8297050105dffc1">Ntoys_filled</a>[m]++;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <a class="code" href="RHat_8cpp.html#a8d5589b851b154e9a366017ca14da0f5">TotToys</a>++;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    }<span class="comment">//end loop over toys</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">//TN: There, we now don&#39;t need to keep the chain in memory anymore</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keyword">delete</span> Chain;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keyword">delete</span>[] branch_values;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Finished loading chain {}!&quot;</span>, m);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  clock.Stop();</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Finished calculating Toys, it took {:.2f}s to finish&quot;</span>, clock.RealTime());</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a4db4657acad5c79ac4bbb66a9d1c5905"><div class="ttname"><a href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a></div><div class="ttdeci">#define MACH3LOG_DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00034">MaCh3Logger.h:34</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_a5217beba3b3cb82269e95bf52c3d62c5"><div class="ttname"><a href="RHat_8cpp.html#a5217beba3b3cb82269e95bf52c3d62c5">ValidPar</a></div><div class="ttdeci">std::vector&lt; bool &gt; ValidPar</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00056">RHat.cpp:56</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_a871d6466cea2597401bdb203293f4033"><div class="ttname"><a href="RHat_8cpp.html#a871d6466cea2597401bdb203293f4033">BranchNames</a></div><div class="ttdeci">std::vector&lt; TString &gt; BranchNames</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00054">RHat.cpp:54</a></div></div>
<div class="ttc" id="anamespaceMaCh3Utils_html_a4c8bdeb1d34606aed192e9f1311a72f5"><div class="ttname"><a href="namespaceMaCh3Utils.html#a4c8bdeb1d34606aed192e9f1311a72f5">MaCh3Utils::PrintProgressBar</a></div><div class="ttdeci">void PrintProgressBar(const Long64_t Done, const Long64_t All)</div><div class="ttdoc">KS: Simply print progress bar.</div><div class="ttdef"><b>Definition:</b> <a href="Monitor_8cpp_source.html#l00228">Monitor.cpp:228</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4c5629fb030eb27c32cab42a42c6623b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c5629fb030eb27c32cab42a42c6623b">&#9670;&nbsp;</a></span>RunDiagnostic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RunDiagnostic </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00378">378</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                     {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">// *******************</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <a class="code" href="RHat_8cpp.html#abd5f8455bf73bda17794dc06218e6713">CalcRhat</a>();</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="comment">//In case in future we expand this</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;}</div>
<div class="ttc" id="aRHat_8cpp_html_abd5f8455bf73bda17794dc06218e6713"><div class="ttname"><a href="RHat_8cpp.html#abd5f8455bf73bda17794dc06218e6713">CalcRhat</a></div><div class="ttdeci">void CalcRhat()</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00387">RHat.cpp:387</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a194d97ca48b57a07a9df018a65f3166e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a194d97ca48b57a07a9df018a65f3166e">&#9670;&nbsp;</a></span>SaveResults()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SaveResults </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00491">491</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                   {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">// *******************</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="preprocessor">  #pragma GCC diagnostic ignored &quot;-Wfloat-conversion&quot;</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  std::string NameTemp = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="comment">//KS: If we run over many many chains there is danger that name will be so absurdly long we run over system limit and job will be killed :(</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a> &lt; 5)</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  {</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>; i++)</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      std::string temp = <a class="code" href="RHat_8cpp.html#aa19a5e341d34dce5448ee490dedba8ef">MCMCFile</a>[i];</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="keywordflow">while</span> (temp.find(<span class="stringliteral">&quot;.root&quot;</span>) != std::string::npos) {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        temp = temp.substr(0, temp.find(<span class="stringliteral">&quot;.root&quot;</span>));</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      }</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <span class="comment">// Strip directory path</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> slash = temp.find_last_of(<span class="stringliteral">&quot;/\\&quot;</span>);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <span class="keywordflow">if</span> (slash != std::string::npos) {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        temp = temp.substr(slash + 1);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      }</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      NameTemp = NameTemp + temp + <span class="stringliteral">&quot;_&quot;</span>;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    NameTemp = std::to_string(<a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>) + <span class="stringliteral">&quot;Chains&quot;</span> + <span class="stringliteral">&quot;_&quot;</span>;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  }</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  NameTemp += <span class="stringliteral">&quot;diag.root&quot;</span>;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  TFile *DiagFile = <a class="code" href="namespaceM3.html#a87841bdbf0e0a2a733d9e4ca499f820d">M3::Open</a>(NameTemp, <span class="stringliteral">&quot;recreate&quot;</span>, __FILE__, __LINE__);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  DiagFile-&gt;cd();</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  TH1D *StandardDeviationGlobalPlot = <span class="keyword">new</span> TH1D(<span class="stringliteral">&quot;StandardDeviationGlobalPlot&quot;</span>, <span class="stringliteral">&quot;StandardDeviationGlobalPlot&quot;</span>, <a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>, 0, <a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  TH1D *BetweenChainVariancePlot = <span class="keyword">new</span> TH1D(<span class="stringliteral">&quot;BetweenChainVariancePlot&quot;</span>, <span class="stringliteral">&quot;BetweenChainVariancePlot&quot;</span>, <a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>, 0, <a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  TH1D *MarginalPosteriorVariancePlot = <span class="keyword">new</span> TH1D(<span class="stringliteral">&quot;MarginalPosteriorVariancePlot&quot;</span>, <span class="stringliteral">&quot;MarginalPosteriorVariancePlot&quot;</span>, <a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>, 0, <a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  TH1D *RhatPlot = <span class="keyword">new</span> TH1D(<span class="stringliteral">&quot;RhatPlot&quot;</span>, <span class="stringliteral">&quot;RhatPlot&quot;</span>, 200, 0, 2);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  TH1D *EffectiveSampleSizePlot = <span class="keyword">new</span> TH1D(<span class="stringliteral">&quot;EffectiveSampleSizePlot&quot;</span>, <span class="stringliteral">&quot;EffectiveSampleSizePlot&quot;</span>, 400, 0, 10000);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  TH1D *RhatLogPlot = <span class="keyword">new</span> TH1D(<span class="stringliteral">&quot;RhatLogPlot&quot;</span>, <span class="stringliteral">&quot;RhatLogPlot&quot;</span>, 200, 0, 2);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="keywordtype">int</span> Criterium = 0;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>; j++)</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  {</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="comment">//KS: Fill only valid parameters</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="RHat_8cpp.html#a5217beba3b3cb82269e95bf52c3d62c5">ValidPar</a>[j])</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      StandardDeviationGlobalPlot-&gt;Fill(j,<a class="code" href="RHat_8cpp.html#a64de0e32daa60ec4f40e0e741d927334">StandardDeviationGlobal</a>[j]);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      BetweenChainVariancePlot-&gt;Fill(j,<a class="code" href="RHat_8cpp.html#a52dcf07f8f740636605516f6c2ab3e40">BetweenChainVariance</a>[j]);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      MarginalPosteriorVariancePlot-&gt;Fill(j,<a class="code" href="RHat_8cpp.html#a68813385f1240d1264e139391b12bf05">MarginalPosteriorVariance</a>[j]);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      RhatPlot-&gt;Fill(<a class="code" href="RHat_8cpp.html#ab5cfb5e8741283e8d8252aae184004e4">RHat</a>[j]);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      EffectiveSampleSizePlot-&gt;Fill(<a class="code" href="RHat_8cpp.html#ae673254e98992bd483de55c6c1d1dcaf">EffectiveSampleSize</a>[j]);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="RHat_8cpp.html#ab5cfb5e8741283e8d8252aae184004e4">RHat</a>[j] &gt; 1.1) Criterium++;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    }</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      RhatLogPlot-&gt;Fill(<a class="code" href="RHat_8cpp.html#ab5cfb5e8741283e8d8252aae184004e4">RHat</a>[j]);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  }</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="comment">//KS: We set criterium of 1.1 based on Gelman et al. (2003) Bayesian Data Analysis</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Number of parameters which has R hat greater than 1.1 is {}({:.2f}%)&quot;</span>, Criterium, 100*<span class="keywordtype">double</span>(Criterium)/<span class="keywordtype">double</span>(<a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>));</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="RHat_8cpp.html#ae2faf756e30936102294777663fae31d">nDraw</a>; j++)</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keywordflow">if</span>( (<a class="code" href="RHat_8cpp.html#ab5cfb5e8741283e8d8252aae184004e4">RHat</a>[j] &gt; 1.1) &amp;&amp; <a class="code" href="RHat_8cpp.html#a5217beba3b3cb82269e95bf52c3d62c5">ValidPar</a>[j])</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a07ff6d6a15b24f94afc88a1b89779beb">MACH3LOG_CRITICAL</a>(<span class="stringliteral">&quot;Parameter {} has R hat higher than 1.1&quot;</span>, <a class="code" href="RHat_8cpp.html#a871d6466cea2597401bdb203293f4033">BranchNames</a>[j]);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    }</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  StandardDeviationGlobalPlot-&gt;Write();</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  BetweenChainVariancePlot-&gt;Write();</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  MarginalPosteriorVariancePlot-&gt;Write();</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  RhatPlot-&gt;Write();</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  EffectiveSampleSizePlot-&gt;Write();</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  RhatLogPlot-&gt;Write();</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="comment">//KS: Now we make fancy canvases, consider some function to have less copy pasting</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="keyword">auto</span> TempCanvas = std::make_unique&lt;TCanvas&gt;(<span class="stringliteral">&quot;Canvas&quot;</span>, <span class="stringliteral">&quot;Canvas&quot;</span>, 1024, 1024);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  gStyle-&gt;SetOptStat(0);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  TempCanvas-&gt;SetGridx();</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  TempCanvas-&gt;SetGridy();</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="comment">// Random line to write useful information to TLegend</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="keyword">auto</span> TempLine = std::make_unique&lt;TLine&gt;(0, 0, 0, 0);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  TempLine-&gt;SetLineColor(kBlack);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  RhatPlot-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;R hat&quot;</span>);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  RhatPlot-&gt;SetLineColor(kRed);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  RhatPlot-&gt;SetFillColor(kRed);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  TLegend *Legend = <span class="keyword">new</span> TLegend(0.55, 0.6, 0.9, 0.9);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  Legend-&gt;SetTextSize(0.04);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  Legend-&gt;SetFillColor(0);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  Legend-&gt;SetFillStyle(0);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  Legend-&gt;SetLineWidth(0);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  Legend-&gt;SetLineColor(0);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  Legend-&gt;AddEntry(TempLine.get(), Form(<span class="stringliteral">&quot;Number of throws=%.0i, Number of chains=%.1i&quot;</span>, <a class="code" href="RHat_8cpp.html#a8d5589b851b154e9a366017ca14da0f5">TotToys</a>, <a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>), <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  Legend-&gt;AddEntry(RhatPlot, <span class="stringliteral">&quot;Rhat Gelman 2013&quot;</span>, <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  RhatPlot-&gt;Draw();</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  Legend-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  TempCanvas-&gt;Write(<span class="stringliteral">&quot;Rhat&quot;</span>);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="keyword">delete</span> Legend;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  Legend = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="comment">//Now R hat for log L</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  RhatLogPlot-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;R hat for LogL&quot;</span>);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  RhatLogPlot-&gt;SetLineColor(kRed);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  RhatLogPlot-&gt;SetFillColor(kRed);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  Legend = <span class="keyword">new</span> TLegend(0.55, 0.6, 0.9, 0.9);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  Legend-&gt;SetTextSize(0.04);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  Legend-&gt;SetFillColor(0);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  Legend-&gt;SetFillStyle(0);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  Legend-&gt;SetLineWidth(0);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  Legend-&gt;SetLineColor(0);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  Legend-&gt;AddEntry(TempLine.get(), Form(<span class="stringliteral">&quot;Number of throws=%.0i, Number of chains=%.1i&quot;</span>, <a class="code" href="RHat_8cpp.html#a8d5589b851b154e9a366017ca14da0f5">TotToys</a>, <a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>), <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  Legend-&gt;AddEntry(RhatLogPlot, <span class="stringliteral">&quot;Rhat Gelman 2013&quot;</span>, <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  RhatLogPlot-&gt;Draw();</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  Legend-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  TempCanvas-&gt;Write(<span class="stringliteral">&quot;RhatLog&quot;</span>);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="keyword">delete</span> Legend;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  Legend = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160; </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="comment">//Now canvas for effective sample size</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  EffectiveSampleSizePlot-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;S_{eff, BDA2}&quot;</span>);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  EffectiveSampleSizePlot-&gt;SetLineColor(kRed);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  Legend = <span class="keyword">new</span> TLegend(0.45, 0.6, 0.9, 0.9);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  Legend-&gt;SetTextSize(0.03);</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  Legend-&gt;SetFillColor(0);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  Legend-&gt;SetFillStyle(0);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  Legend-&gt;SetLineWidth(0);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  Legend-&gt;SetLineColor(0);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> Mean1 = EffectiveSampleSizePlot-&gt;GetMean();</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> RMS1 = EffectiveSampleSizePlot-&gt;GetRMS();</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160; </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  Legend-&gt;AddEntry(TempLine.get(), Form(<span class="stringliteral">&quot;Number of throws=%.0i, Number of chains=%.1i&quot;</span>, <a class="code" href="RHat_8cpp.html#a8d5589b851b154e9a366017ca14da0f5">TotToys</a>, <a class="code" href="RHat_8cpp.html#a231bc179b5599c7e29d5ba28ff2b4b70">Nchains</a>), <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  Legend-&gt;AddEntry(EffectiveSampleSizePlot, Form(<span class="stringliteral">&quot;S_{eff, BDA2} #mu = %.2f, #sigma = %.2f&quot;</span>,Mean1 ,RMS1), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  EffectiveSampleSizePlot-&gt;Draw();</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  Legend-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  TempCanvas-&gt;Write(<span class="stringliteral">&quot;EffectiveSampleSize&quot;</span>);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  <span class="comment">//Fancy memory cleaning</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <span class="keyword">delete</span> StandardDeviationGlobalPlot;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="keyword">delete</span> BetweenChainVariancePlot;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="keyword">delete</span> MarginalPosteriorVariancePlot;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="keyword">delete</span> RhatPlot;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="keyword">delete</span> EffectiveSampleSizePlot;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="keyword">delete</span> Legend;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160; </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="keyword">delete</span> RhatLogPlot;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  DiagFile-&gt;Close();</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="keyword">delete</span> DiagFile;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Finished and wrote results to {}&quot;</span>, NameTemp);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a07ff6d6a15b24f94afc88a1b89779beb"><div class="ttname"><a href="MaCh3Logger_8h.html#a07ff6d6a15b24f94afc88a1b89779beb">MACH3LOG_CRITICAL</a></div><div class="ttdeci">#define MACH3LOG_CRITICAL</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00038">MaCh3Logger.h:38</a></div></div>
<div class="ttc" id="anamespaceM3_html_a87841bdbf0e0a2a733d9e4ca499f820d"><div class="ttname"><a href="namespaceM3.html#a87841bdbf0e0a2a733d9e4ca499f820d">M3::Open</a></div><div class="ttdeci">TFile * Open(const std::string &amp;Name, const std::string &amp;Type, const std::string &amp;File, const int Line)</div><div class="ttdoc">Opens a ROOT file with the given name and mode.</div><div class="ttdef"><b>Definition:</b> <a href="HistogramUtils_8cpp_source.html#l00662">HistogramUtils.cpp:662</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a52dcf07f8f740636605516f6c2ab3e40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52dcf07f8f740636605516f6c2ab3e40">&#9670;&nbsp;</a></span>BetweenChainVariance</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double* BetweenChainVariance</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00069">69</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>

</div>
</div>
<a id="a871d6466cea2597401bdb203293f4033"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a871d6466cea2597401bdb203293f4033">&#9670;&nbsp;</a></span>BranchNames</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TString&gt; BranchNames</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00054">54</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>

</div>
</div>
<a id="ae673254e98992bd483de55c6c1d1dcaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae673254e98992bd483de55c6c1d1dcaf">&#9670;&nbsp;</a></span>EffectiveSampleSize</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double* EffectiveSampleSize</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00072">72</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>

</div>
</div>
<a id="a68813385f1240d1264e139391b12bf05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68813385f1240d1264e139391b12bf05">&#9670;&nbsp;</a></span>MarginalPosteriorVariance</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double* MarginalPosteriorVariance</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00070">70</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>

</div>
</div>
<a id="aa19a5e341d34dce5448ee490dedba8ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa19a5e341d34dce5448ee490dedba8ef">&#9670;&nbsp;</a></span>MCMCFile</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; MCMCFile</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00055">55</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>

</div>
</div>
<a id="ab7d224b5fffa9367046f2976bb4972d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7d224b5fffa9367046f2976bb4972d1">&#9670;&nbsp;</a></span>Mean</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double** Mean</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00063">63</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>

</div>
</div>
<a id="a4526fa4abfccd1173c87267a0beb6977"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4526fa4abfccd1173c87267a0beb6977">&#9670;&nbsp;</a></span>MeanGlobal</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double* MeanGlobal</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00066">66</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>

</div>
</div>
<a id="a231bc179b5599c7e29d5ba28ff2b4b70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a231bc179b5599c7e29d5ba28ff2b4b70">&#9670;&nbsp;</a></span>Nchains</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Nchains</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00051">51</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>

</div>
</div>
<a id="ae2faf756e30936102294777663fae31d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2faf756e30936102294777663fae31d">&#9670;&nbsp;</a></span>nDraw</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int nDraw</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00052">52</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>

</div>
</div>
<a id="a348554f563d67f5b273668bc3f3d51c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a348554f563d67f5b273668bc3f3d51c7">&#9670;&nbsp;</a></span>NThin</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int NThin</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00050">50</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>

</div>
</div>
<a id="a348f0c1b68d0a2ece8297050105dffc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a348f0c1b68d0a2ece8297050105dffc1">&#9670;&nbsp;</a></span>Ntoys_filled</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int* Ntoys_filled</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00048">48</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>

</div>
</div>
<a id="a7b48ace8081df9b5f35c17126ee81046"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b48ace8081df9b5f35c17126ee81046">&#9670;&nbsp;</a></span>Ntoys_requested</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int* Ntoys_requested</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00047">47</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>

</div>
</div>
<a id="ab5cfb5e8741283e8d8252aae184004e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5cfb5e8741283e8d8252aae184004e4">&#9670;&nbsp;</a></span>RHat</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double* RHat</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00071">71</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>

</div>
</div>
<a id="a14d43e9a0adb2500e2d44a762d3b5238"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14d43e9a0adb2500e2d44a762d3b5238">&#9670;&nbsp;</a></span>S1_chain</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double** S1_chain</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00060">60</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>

</div>
</div>
<a id="a0179885171f5d0541296df969f8d609b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0179885171f5d0541296df969f8d609b">&#9670;&nbsp;</a></span>S1_global</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double* S1_global</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00058">58</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>

</div>
</div>
<a id="adf01bbc6f4a3b8dabe58adc72bccb142"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf01bbc6f4a3b8dabe58adc72bccb142">&#9670;&nbsp;</a></span>S2_chain</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double** S2_chain</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00061">61</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>

</div>
</div>
<a id="a0a674f607d7d269b2f3d09f1e12f5e5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a674f607d7d269b2f3d09f1e12f5e5f">&#9670;&nbsp;</a></span>S2_global</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double* S2_global</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00059">59</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>

</div>
</div>
<a id="a5bdfaf60cce582e30db6bd3001de9935"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bdfaf60cce582e30db6bd3001de9935">&#9670;&nbsp;</a></span>StandardDeviation</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double** StandardDeviation</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00064">64</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>

</div>
</div>
<a id="a64de0e32daa60ec4f40e0e741d927334"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64de0e32daa60ec4f40e0e741d927334">&#9670;&nbsp;</a></span>StandardDeviationGlobal</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double* StandardDeviationGlobal</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00067">67</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>

</div>
</div>
<a id="a8d5589b851b154e9a366017ca14da0f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d5589b851b154e9a366017ca14da0f5">&#9670;&nbsp;</a></span>TotToys</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TotToys</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00049">49</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>

</div>
</div>
<a id="a5217beba3b3cb82269e95bf52c3d62c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5217beba3b3cb82269e95bf52c3d62c5">&#9670;&nbsp;</a></span>ValidPar</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;bool&gt; ValidPar</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RHat_8cpp_source.html#l00056">56</a> of file <a class="el" href="RHat_8cpp_source.html">RHat.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- Footer for MaCh3 Doxygen documentation -->
<footer class="mach3-footer" style="text-align: center;">
    <div style="margin-bottom: 15px;">
        <span style="font-weight: bold;">The MaCh3 Collaboration</span>
    </div>
    <!-- Dropdown to jump between doc versions -->
    <div style="margin-bottom: 10px;">
        <span>Select Software Version: </span>
        <select id="versionSelector" onchange="window.location.href=this.value" style="padding: 5px; border-radius: 4px; border: 1px solid #ccc;">
            <option value="">-- Select --</option>
            <option value="https://mach3-software.github.io/MaCh3/">develop</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.4.0/index.html">v2.4.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.3.0/index.html">v2.3.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.2.0/index.html">v2.2.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.1.0/index.html">v2.1.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.0.0/index.html">v2.0.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.5.0/index.html">v1.5.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.4.0/index.html">v1.4.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.3.0/index.html">v1.3.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.2.0/index.html">v1.2.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.1.0/index.html">v1.1.0</option>
        </select>
    </div>
    <!-- Footer info about doxygen -->
    <div style="font-size: 0.9em; color: #666; margin-top: 10px;">
        Documentation generated with
        <a href="https://www.doxygen.nl/" target="_blank" style="color: #666;">Doxygen</a>
        <span id="doxygenVersion"></span>
    </div>
    <!-- Now grab doxygen version from metadata -->
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        const meta = document.querySelector('meta[name="generator"]');
        if (meta) {
            const version = meta.getAttribute("content").replace("Doxygen ", "");
            document.getElementById("doxygenVersion").textContent = " " + version;
        }
    });
    </script>
</footer>
