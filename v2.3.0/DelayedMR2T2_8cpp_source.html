<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MaCh3: Fitters/DelayedMR2T2.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="MaCh3.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mach3logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MaCh3
   &#160;<span id="projectnumber">2.3.0</span>
   </div>
   <div id="projectbrief">Reference Guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_c4587985b869c96ecd5a3e2399525831.html">Fitters</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">DelayedMR2T2.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="DelayedMR2T2_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DelayedMR2T2_8h.html">Fitters/DelayedMR2T2.h</a>&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160; </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// *************************</span></div>
<div class="line"><a name="l00004"></a><span class="lineno"><a class="line" href="classDelayedMR2T2.html#a57cd4fa23139d3b8564b5c2d2f8390c8">    4</a></span>&#160;<a class="code" href="classDelayedMR2T2.html#a57cd4fa23139d3b8564b5c2d2f8390c8">DelayedMR2T2::DelayedMR2T2</a>(<a class="code" href="classmanager.html">manager</a> * <span class="keyword">const</span> <a class="code" href="classmanager.html">manager</a>) : <a class="code" href="classMR2T2.html">MR2T2</a>(<a class="code" href="classmanager.html">manager</a>) {</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// *************************</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    <a class="code" href="classFitterBase.html#a6c5b6c38ba4c6f482592147c7e6b3b95">AlgorithmName</a> = <span class="stringliteral">&quot;DelayedMR2T2&quot;</span>;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    <span class="comment">// Step scale for delayed step = step scale prev delay * decay_rate</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    <a class="code" href="classDelayedMR2T2.html#a97286b3dc12944f370d411fa74b93819">decay_rate</a> = GetFromManager&lt;double&gt;(<a class="code" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code" href="classmanager.html#aecbfb3ead2c10006f39a144f64d3cb53">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;MCMC&quot;</span>][<span class="stringliteral">&quot;DecayRate&quot;</span>], 0.1);</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    <span class="comment">// Maximum number of rejections</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    <a class="code" href="classDelayedMR2T2.html#a185409c3e33c69119be37ac12d640dd6">max_rejections</a> = GetFromManager&lt;int&gt;(<a class="code" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code" href="classmanager.html#aecbfb3ead2c10006f39a144f64d3cb53">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;MCMC&quot;</span>][<span class="stringliteral">&quot;MaxRejections&quot;</span>], 1);</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <span class="comment">// How big is the first step scale. This scales parameter step by initial_scale * &lt;step scale in ParameterHandler&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <a class="code" href="classDelayedMR2T2.html#ada98d6554360043c6a3cde78596dd1ff">initial_scale</a> = GetFromManager&lt;int&gt;(<a class="code" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code" href="classmanager.html#aecbfb3ead2c10006f39a144f64d3cb53">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;MCMC&quot;</span>][<span class="stringliteral">&quot;InitialScale&quot;</span>], 1);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <span class="comment">// On delayed on out of bounds steps. This saves some compute time and possibly regains efficiency</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <a class="code" href="classDelayedMR2T2.html#a5c99ea1ad5427c6532e217271ec7d998">delay_on_oob_only</a> = GetFromManager&lt;bool&gt;(<a class="code" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code" href="classmanager.html#aecbfb3ead2c10006f39a144f64d3cb53">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;MCMC&quot;</span>][<span class="stringliteral">&quot;DelayOnlyOutBounds&quot;</span>], <span class="keyword">false</span>);</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="comment">// </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <a class="code" href="classDelayedMR2T2.html#a5506f8b2e6f1e8bbea69a134280add70">delay_probability</a> = GetFromManager&lt;double&gt;(<a class="code" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code" href="classmanager.html#aecbfb3ead2c10006f39a144f64d3cb53">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;MCMC&quot;</span>][<span class="stringliteral">&quot;DelayProbability&quot;</span>], 1.0);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classDelayedMR2T2.html#a5506f8b2e6f1e8bbea69a134280add70">delay_probability</a> &gt; 1.0){</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Probability of delaying steps &gt; 1, setting to 1&quot;</span>);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        <a class="code" href="classDelayedMR2T2.html#a5506f8b2e6f1e8bbea69a134280add70">delay_probability</a> = 1.0;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    }</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classDelayedMR2T2.html#a5506f8b2e6f1e8bbea69a134280add70">delay_probability</a>&lt;=0.0){</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a07ff6d6a15b24f94afc88a1b89779beb">MACH3LOG_CRITICAL</a>(<span class="stringliteral">&quot;Probability of delaying steps &lt;= 0, setting to 0, delay will no longer have an impact!&quot;</span>);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <a class="code" href="classDelayedMR2T2.html#a5506f8b2e6f1e8bbea69a134280add70">delay_probability</a> = 0.0;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <span class="comment">// Since we&#39;re not delaying at all set max_rejections = 0 to save time</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <a class="code" href="classDelayedMR2T2.html#a185409c3e33c69119be37ac12d640dd6">max_rejections</a> = 0;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    }</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Using Delayed MCMC with decay rate: {} and {} allowed rejections&quot;</span>, <a class="code" href="classDelayedMR2T2.html#a97286b3dc12944f370d411fa74b93819">decay_rate</a>, <a class="code" href="classDelayedMR2T2.html#a185409c3e33c69119be37ac12d640dd6">max_rejections</a>);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;}</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">// *************************</span></div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="classDelayedMR2T2.html#acdba31f62c06dabe2e0b1acb9cdddc35">   36</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classDelayedMR2T2.html#acdba31f62c06dabe2e0b1acb9cdddc35">DelayedMR2T2::ScaleSystematics</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> scale) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">// *************************</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;syst : <a class="code" href="classFitterBase.html#afeffc9d794c973a015aa12ec1a8f79da">systematics</a>)</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        syst-&gt;SetStepScale(scale*syst-&gt;GetGlobalStepScale(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    }</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;}</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">// *************************</span></div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="classDelayedMR2T2.html#a96602821ff54f3056e042dfa22fb95ed">   45</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classDelayedMR2T2.html#a96602821ff54f3056e042dfa22fb95ed">DelayedMR2T2::ResetSystScale</a>() {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">// *************************</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; static_cast&lt;int&gt;(<a class="code" href="classFitterBase.html#afeffc9d794c973a015aa12ec1a8f79da">systematics</a>.size()); ++i)</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <a class="code" href="classFitterBase.html#afeffc9d794c973a015aa12ec1a8f79da">systematics</a>[i]-&gt;SetStepScale(<a class="code" href="classDelayedMR2T2.html#a58ec170db56d4d98713e75bf479a7212">start_step_scale</a>[i], <span class="keyword">false</span>);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;}</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">// *************************</span></div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="classDelayedMR2T2.html#a1312615b2dac7760ca152e4d61efa8e2">   54</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classDelayedMR2T2.html#a1312615b2dac7760ca152e4d61efa8e2">DelayedMR2T2::PrepareOutput</a>() {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">// *************************</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="classFitterBase.html#a53715760edd8c7640432f31793fd28f9">FitterBase::PrepareOutput</a>();</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">// Store delayed specific settings</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>-&gt;Branch(<span class="stringliteral">&quot;DelayedStep&quot;</span>, &amp;<a class="code" href="classDelayedMR2T2.html#a0339cfd51542ac59ad5d22cf6f7d84c8">accepted_delayed</a>, <span class="stringliteral">&quot;DelayedStep/B&quot;</span>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;}</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">//**********************************************</span></div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="classDelayedMR2T2.html#a39b3237d0c235cf9659140626960dbf6">   63</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classDelayedMR2T2.html#a39b3237d0c235cf9659140626960dbf6">DelayedMR2T2::StoreCurrentStep</a>() {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">// *********************************************</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">    Stores values from  step</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">// Ensure vector is correctly sized</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="classDelayedMR2T2.html#af8590de3ef5df7a7bfb9483f78c2efe5">current_step_vals</a>.resize(<a class="code" href="classFitterBase.html#afeffc9d794c973a015aa12ec1a8f79da">systematics</a>.size());</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="classDelayedMR2T2.html#a58ec170db56d4d98713e75bf479a7212">start_step_scale</a>.resize(<a class="code" href="classFitterBase.html#afeffc9d794c973a015aa12ec1a8f79da">systematics</a>.size());</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">// Fill with old proposed step, need to copy to avoid using the same step twice</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;static_cast&lt;int&gt;(<a class="code" href="classFitterBase.html#afeffc9d794c973a015aa12ec1a8f79da">systematics</a>.size()); ++i){</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <a class="code" href="classDelayedMR2T2.html#af8590de3ef5df7a7bfb9483f78c2efe5">current_step_vals</a>[i] = std::vector&lt;double&gt;(<a class="code" href="classFitterBase.html#afeffc9d794c973a015aa12ec1a8f79da">systematics</a>[i]-&gt;GetParCurrVec());</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <a class="code" href="classDelayedMR2T2.html#a58ec170db56d4d98713e75bf479a7212">start_step_scale</a>[i] = <a class="code" href="classFitterBase.html#afeffc9d794c973a015aa12ec1a8f79da">systematics</a>[i]-&gt;GetGlobalStepScale();</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;}</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">// *************************</span></div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="classDelayedMR2T2.html#a5a5e903d0f74ae730a25f375e4fc4d8c">   80</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classDelayedMR2T2.html#a5a5e903d0f74ae730a25f375e4fc4d8c">DelayedMR2T2::AcceptanceProbability</a>() {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">// *************************</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// From https://arxiv.org/pdf/2010.04190 and DRAM Matlab implementation</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> numerator = std::max(0.0, std::exp(<a class="code" href="classDelayedMR2T2.html#a7eabffdbdfe03767c4876ab0ff1d8594">MinLogLikelihood</a> - <a class="code" href="classFitterBase.html#a187dd22c17f9e96e5a7e2fb2371abace">logLProp</a>) - 1.0);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> denominator = std::exp(<a class="code" href="classDelayedMR2T2.html#a7eabffdbdfe03767c4876ab0ff1d8594">MinLogLikelihood</a> - <a class="code" href="classFitterBase.html#abfb6f10720764d8bbbe43754fd5cd976">logLCurr</a>) - 1.0;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">if</span> (denominator &lt;= 0.0) <span class="keywordflow">return</span> 1.0;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">// Large enough that the the minus 1 will make NO difference so the max term cancels</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">if</span>(std::isinf(numerator) or std::isinf(denominator) ){</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classMR2T2.html#a991bdcec55b12d179b85b0293313d682">MR2T2::AcceptanceProbability</a>();</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">return</span> std::min(numerator / denominator, 1.0);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;}</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">// *************************</span></div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="classDelayedMR2T2.html#aa5b4afdb3a9852d7e86e42e3751c7f07">   96</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classDelayedMR2T2.html#aa5b4afdb3a9852d7e86e42e3751c7f07">DelayedMR2T2::DoStep</a>() {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">// *************************</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// Set the initial rejection to false</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="classDelayedMR2T2.html#a39b3237d0c235cf9659140626960dbf6">StoreCurrentStep</a>();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">// Apply initial scale</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="classDelayedMR2T2.html#acdba31f62c06dabe2e0b1acb9cdddc35">ScaleSystematics</a>(<a class="code" href="classDelayedMR2T2.html#ada98d6554360043c6a3cde78596dd1ff">initial_scale</a>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordtype">bool</span> accepted = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordtype">bool</span> delay = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="classDelayedMR2T2.html#a0339cfd51542ac59ad5d22cf6f7d84c8">accepted_delayed</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="classDelayedMR2T2.html#a7eabffdbdfe03767c4876ab0ff1d8594">MinLogLikelihood</a> = <a class="code" href="namespaceM3.html#a1a85b25da2b8b2cbb0993b15dcf77a6d">M3::_LARGE_LOGL_</a>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;=<a class="code" href="classDelayedMR2T2.html#a185409c3e33c69119be37ac12d640dd6">max_rejections</a>; ++i)</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <a class="code" href="classMR2T2.html#a8887ddc1e04965b04c99182637b4654a">ProposeStep</a>();</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="comment">// Small hack to ensure we can &quot;leapfrog&quot;</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;syst : <a class="code" href="classFitterBase.html#afeffc9d794c973a015aa12ec1a8f79da">systematics</a>)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            syst-&gt;AcceptStep();</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classMCMCBase.html#a8c81e543609bb3878b114f9f8b2c0393">out_of_bounds</a> or <a class="code" href="classFitterBase.html#a187dd22c17f9e96e5a7e2fb2371abace">logLProp</a>&gt;<a class="code" href="classDelayedMR2T2.html#a7eabffdbdfe03767c4876ab0ff1d8594">MinLogLikelihood</a>){</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordflow">if</span>(i==0){</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <a class="code" href="classFitterBase.html#a6319d2ea50984860475bbc6c708b0d90">accProb</a> = <a class="code" href="classMR2T2.html#a991bdcec55b12d179b85b0293313d682">MR2T2::AcceptanceProbability</a>();</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <a class="code" href="classFitterBase.html#a6319d2ea50984860475bbc6c708b0d90">accProb</a> = <a class="code" href="classDelayedMR2T2.html#a5a5e903d0f74ae730a25f375e4fc4d8c">AcceptanceProbability</a>();</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            delay = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classMCMCBase.html#a9b8aac7fa8691719347ae70a5fa20226">IsStepAccepted</a>(<a class="code" href="classFitterBase.html#a6319d2ea50984860475bbc6c708b0d90">accProb</a>)){</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <a class="code" href="classMCMCBase.html#a504f906fea923b63221732a8c8d1d591">AcceptStep</a>();</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            accepted = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="comment">// Keep track of if step is delayed + accepted for storage</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <a class="code" href="classDelayedMR2T2.html#a0339cfd51542ac59ad5d22cf6f7d84c8">accepted_delayed</a> = delay;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="comment">// Update</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordflow">if</span>(not <a class="code" href="classMCMCBase.html#a8c81e543609bb3878b114f9f8b2c0393">out_of_bounds</a> and <a class="code" href="classDelayedMR2T2.html#a5c99ea1ad5427c6532e217271ec7d998">delay_on_oob_only</a>){</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <span class="comment">// If we are not out of bounds and only delaying on out of bounds steps</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <span class="comment">// We can skip the delay</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">if</span>(not <a class="code" href="classDelayedMR2T2.html#a2a55f2f94cb371bc9bcfad3778e61fe1">ProbabilisticDelay</a>()){</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="comment">// Temporary, means we can &quot;leapfrog&quot;</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <a class="code" href="classDelayedMR2T2.html#acdba31f62c06dabe2e0b1acb9cdddc35">ScaleSystematics</a>(<a class="code" href="classDelayedMR2T2.html#a97286b3dc12944f370d411fa74b93819">decay_rate</a>);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <a class="code" href="classDelayedMR2T2.html#a7eabffdbdfe03767c4876ab0ff1d8594">MinLogLikelihood</a> = <a class="code" href="classFitterBase.html#a187dd22c17f9e96e5a7e2fb2371abace">logLProp</a>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">// If we reject we need to reset everything [this is probably a tad too slow...</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">// especially in PCA...</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">if</span>(!accepted){</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;static_cast&lt;int&gt;(<a class="code" href="classFitterBase.html#afeffc9d794c973a015aa12ec1a8f79da">systematics</a>.size()); ++i){</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;static_cast&lt;int&gt;(<a class="code" href="classFitterBase.html#afeffc9d794c973a015aa12ec1a8f79da">systematics</a>[i]-&gt;GetParCurrVec().<a class="code" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>()); ++j){</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                <a class="code" href="classFitterBase.html#afeffc9d794c973a015aa12ec1a8f79da">systematics</a>[i]-&gt;SetParCurrProp(j, <a class="code" href="classDelayedMR2T2.html#af8590de3ef5df7a7bfb9483f78c2efe5">current_step_vals</a>[i][j]);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="classDelayedMR2T2.html#a96602821ff54f3056e042dfa22fb95ed">ResetSystScale</a>();</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;}</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">// *************************</span></div>
<div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="classDelayedMR2T2.html#a2a55f2f94cb371bc9bcfad3778e61fe1">  172</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classDelayedMR2T2.html#a2a55f2f94cb371bc9bcfad3778e61fe1">DelayedMR2T2::ProbabilisticDelay</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">// *************************</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">// We can delay probabilistically</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="classFitterBase.html#a138f250d9204a30204e4ca5b973008b2">random</a>-&gt;Rndm() &gt; <a class="code" href="classDelayedMR2T2.html#a5506f8b2e6f1e8bbea69a134280add70">delay_probability</a>);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;}</div>
<div class="ttc" id="aDelayedMR2T2_8h_html"><div class="ttname"><a href="DelayedMR2T2_8h.html">DelayedMR2T2.h</a></div></div>
<div class="ttc" id="aGetPenaltyTerm_8cpp_html_a439227feff9d7f55384e8780cfc2eb82"><div class="ttname"><a href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a></div><div class="ttdeci">int size</div><div class="ttdef"><b>Definition:</b> <a href="GetPenaltyTerm_8cpp_source.html#l00039">GetPenaltyTerm.cpp:39</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_a07ff6d6a15b24f94afc88a1b89779beb"><div class="ttname"><a href="MaCh3Logger_8h.html#a07ff6d6a15b24f94afc88a1b89779beb">MACH3LOG_CRITICAL</a></div><div class="ttdeci">#define MACH3LOG_CRITICAL</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00038">MaCh3Logger.h:38</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_a95fa4dffc648e4c5536c9292c2bdcac3"><div class="ttname"><a href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a></div><div class="ttdeci">#define MACH3LOG_INFO</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00035">MaCh3Logger.h:35</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_ad5b2eb6377721e3ac95def22c2386bb1"><div class="ttname"><a href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a></div><div class="ttdeci">#define MACH3LOG_WARN</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00036">MaCh3Logger.h:36</a></div></div>
<div class="ttc" id="aclassDelayedMR2T2_html_a0339cfd51542ac59ad5d22cf6f7d84c8"><div class="ttname"><a href="classDelayedMR2T2.html#a0339cfd51542ac59ad5d22cf6f7d84c8">DelayedMR2T2::accepted_delayed</a></div><div class="ttdeci">bool accepted_delayed</div><div class="ttdoc">Was the step we just accepted delayed?</div><div class="ttdef"><b>Definition:</b> <a href="DelayedMR2T2_8h_source.html#l00091">DelayedMR2T2.h:91</a></div></div>
<div class="ttc" id="aclassDelayedMR2T2_html_a1312615b2dac7760ca152e4d61efa8e2"><div class="ttname"><a href="classDelayedMR2T2.html#a1312615b2dac7760ca152e4d61efa8e2">DelayedMR2T2::PrepareOutput</a></div><div class="ttdeci">void PrepareOutput()</div><div class="ttdoc">override to add in rejection information to output</div><div class="ttdef"><b>Definition:</b> <a href="DelayedMR2T2_8cpp_source.html#l00054">DelayedMR2T2.cpp:54</a></div></div>
<div class="ttc" id="aclassDelayedMR2T2_html_a185409c3e33c69119be37ac12d640dd6"><div class="ttname"><a href="classDelayedMR2T2.html#a185409c3e33c69119be37ac12d640dd6">DelayedMR2T2::max_rejections</a></div><div class="ttdeci">int max_rejections</div><div class="ttdoc">How many rejections allowed?</div><div class="ttdef"><b>Definition:</b> <a href="DelayedMR2T2_8h_source.html#l00085">DelayedMR2T2.h:85</a></div></div>
<div class="ttc" id="aclassDelayedMR2T2_html_a2a55f2f94cb371bc9bcfad3778e61fe1"><div class="ttname"><a href="classDelayedMR2T2.html#a2a55f2f94cb371bc9bcfad3778e61fe1">DelayedMR2T2::ProbabilisticDelay</a></div><div class="ttdeci">bool ProbabilisticDelay() const</div><div class="ttdoc">if delay has a chance of occurring</div><div class="ttdef"><b>Definition:</b> <a href="DelayedMR2T2_8cpp_source.html#l00172">DelayedMR2T2.cpp:172</a></div></div>
<div class="ttc" id="aclassDelayedMR2T2_html_a39b3237d0c235cf9659140626960dbf6"><div class="ttname"><a href="classDelayedMR2T2.html#a39b3237d0c235cf9659140626960dbf6">DelayedMR2T2::StoreCurrentStep</a></div><div class="ttdeci">void StoreCurrentStep()</div><div class="ttdoc">Store information about the current proposed step.</div><div class="ttdef"><b>Definition:</b> <a href="DelayedMR2T2_8cpp_source.html#l00063">DelayedMR2T2.cpp:63</a></div></div>
<div class="ttc" id="aclassDelayedMR2T2_html_a5506f8b2e6f1e8bbea69a134280add70"><div class="ttname"><a href="classDelayedMR2T2.html#a5506f8b2e6f1e8bbea69a134280add70">DelayedMR2T2::delay_probability</a></div><div class="ttdeci">double delay_probability</div><div class="ttdoc">Can delay with probability instead.</div><div class="ttdef"><b>Definition:</b> <a href="DelayedMR2T2_8h_source.html#l00096">DelayedMR2T2.h:96</a></div></div>
<div class="ttc" id="aclassDelayedMR2T2_html_a57cd4fa23139d3b8564b5c2d2f8390c8"><div class="ttname"><a href="classDelayedMR2T2.html#a57cd4fa23139d3b8564b5c2d2f8390c8">DelayedMR2T2::DelayedMR2T2</a></div><div class="ttdeci">DelayedMR2T2(manager *const fitMan)</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="DelayedMR2T2_8cpp_source.html#l00004">DelayedMR2T2.cpp:4</a></div></div>
<div class="ttc" id="aclassDelayedMR2T2_html_a58ec170db56d4d98713e75bf479a7212"><div class="ttname"><a href="classDelayedMR2T2.html#a58ec170db56d4d98713e75bf479a7212">DelayedMR2T2::start_step_scale</a></div><div class="ttdeci">std::vector&lt; double &gt; start_step_scale</div><div class="ttdoc">Stores the initial scale for all parameters.</div><div class="ttdef"><b>Definition:</b> <a href="DelayedMR2T2_8h_source.html#l00078">DelayedMR2T2.h:78</a></div></div>
<div class="ttc" id="aclassDelayedMR2T2_html_a5a5e903d0f74ae730a25f375e4fc4d8c"><div class="ttname"><a href="classDelayedMR2T2.html#a5a5e903d0f74ae730a25f375e4fc4d8c">DelayedMR2T2::AcceptanceProbability</a></div><div class="ttdeci">double AcceptanceProbability() override</div><div class="ttdoc">Step acceptance probability.</div><div class="ttdef"><b>Definition:</b> <a href="DelayedMR2T2_8cpp_source.html#l00080">DelayedMR2T2.cpp:80</a></div></div>
<div class="ttc" id="aclassDelayedMR2T2_html_a5c99ea1ad5427c6532e217271ec7d998"><div class="ttname"><a href="classDelayedMR2T2.html#a5c99ea1ad5427c6532e217271ec7d998">DelayedMR2T2::delay_on_oob_only</a></div><div class="ttdeci">bool delay_on_oob_only</div><div class="ttdoc">Delay only if we go out of bounds.</div><div class="ttdef"><b>Definition:</b> <a href="DelayedMR2T2_8h_source.html#l00094">DelayedMR2T2.h:94</a></div></div>
<div class="ttc" id="aclassDelayedMR2T2_html_a7eabffdbdfe03767c4876ab0ff1d8594"><div class="ttname"><a href="classDelayedMR2T2.html#a7eabffdbdfe03767c4876ab0ff1d8594">DelayedMR2T2::MinLogLikelihood</a></div><div class="ttdeci">double MinLogLikelihood</div><div class="ttdoc">Minimum (negative) log-likelihood of proposed steps.</div><div class="ttdef"><b>Definition:</b> <a href="DelayedMR2T2_8h_source.html#l00088">DelayedMR2T2.h:88</a></div></div>
<div class="ttc" id="aclassDelayedMR2T2_html_a96602821ff54f3056e042dfa22fb95ed"><div class="ttname"><a href="classDelayedMR2T2.html#a96602821ff54f3056e042dfa22fb95ed">DelayedMR2T2::ResetSystScale</a></div><div class="ttdeci">void ResetSystScale()</div><div class="ttdoc">Reset scale after delay process.</div><div class="ttdef"><b>Definition:</b> <a href="DelayedMR2T2_8cpp_source.html#l00045">DelayedMR2T2.cpp:45</a></div></div>
<div class="ttc" id="aclassDelayedMR2T2_html_a97286b3dc12944f370d411fa74b93819"><div class="ttname"><a href="classDelayedMR2T2.html#a97286b3dc12944f370d411fa74b93819">DelayedMR2T2::decay_rate</a></div><div class="ttdeci">double decay_rate</div><div class="ttdoc">How much to decrease the step scale each step.</div><div class="ttdef"><b>Definition:</b> <a href="DelayedMR2T2_8h_source.html#l00083">DelayedMR2T2.h:83</a></div></div>
<div class="ttc" id="aclassDelayedMR2T2_html_aa5b4afdb3a9852d7e86e42e3751c7f07"><div class="ttname"><a href="classDelayedMR2T2.html#aa5b4afdb3a9852d7e86e42e3751c7f07">DelayedMR2T2::DoStep</a></div><div class="ttdeci">void DoStep() override</div><div class="ttdoc">The MCMC step proposal.</div><div class="ttdef"><b>Definition:</b> <a href="DelayedMR2T2_8cpp_source.html#l00096">DelayedMR2T2.cpp:96</a></div></div>
<div class="ttc" id="aclassDelayedMR2T2_html_acdba31f62c06dabe2e0b1acb9cdddc35"><div class="ttname"><a href="classDelayedMR2T2.html#acdba31f62c06dabe2e0b1acb9cdddc35">DelayedMR2T2::ScaleSystematics</a></div><div class="ttdeci">void ScaleSystematics(const double scale)</div><div class="ttdoc">Set parameter scale to be original_scale* scale.</div><div class="ttdef"><b>Definition:</b> <a href="DelayedMR2T2_8cpp_source.html#l00036">DelayedMR2T2.cpp:36</a></div></div>
<div class="ttc" id="aclassDelayedMR2T2_html_ada98d6554360043c6a3cde78596dd1ff"><div class="ttname"><a href="classDelayedMR2T2.html#ada98d6554360043c6a3cde78596dd1ff">DelayedMR2T2::initial_scale</a></div><div class="ttdeci">double initial_scale</div><div class="ttdoc">Scale for (non-delayed) step is initial_scale * start_step_scale.</div><div class="ttdef"><b>Definition:</b> <a href="DelayedMR2T2_8h_source.html#l00081">DelayedMR2T2.h:81</a></div></div>
<div class="ttc" id="aclassDelayedMR2T2_html_af8590de3ef5df7a7bfb9483f78c2efe5"><div class="ttname"><a href="classDelayedMR2T2.html#af8590de3ef5df7a7bfb9483f78c2efe5">DelayedMR2T2::current_step_vals</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; current_step_vals</div><div class="ttdoc">Store information about the current proposed step.</div><div class="ttdef"><b>Definition:</b> <a href="DelayedMR2T2_8h_source.html#l00075">DelayedMR2T2.h:75</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a138f250d9204a30204e4ca5b973008b2"><div class="ttname"><a href="classFitterBase.html#a138f250d9204a30204e4ca5b973008b2">FitterBase::random</a></div><div class="ttdeci">std::unique_ptr&lt; TRandom3 &gt; random</div><div class="ttdoc">Random number.</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00149">FitterBase.h:149</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a187dd22c17f9e96e5a7e2fb2371abace"><div class="ttname"><a href="classFitterBase.html#a187dd22c17f9e96e5a7e2fb2371abace">FitterBase::logLProp</a></div><div class="ttdeci">double logLProp</div><div class="ttdoc">proposed likelihood</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00120">FitterBase.h:120</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a4fceb68f242feeb04a0ddf42a5a37095"><div class="ttname"><a href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">FitterBase::fitMan</a></div><div class="ttdeci">manager * fitMan</div><div class="ttdoc">The manager for configuration handling.</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00113">FitterBase.h:113</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a53715760edd8c7640432f31793fd28f9"><div class="ttname"><a href="classFitterBase.html#a53715760edd8c7640432f31793fd28f9">FitterBase::PrepareOutput</a></div><div class="ttdeci">void PrepareOutput()</div><div class="ttdoc">Prepare the output file.</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8cpp_source.html#l00158">FitterBase.cpp:158</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a6319d2ea50984860475bbc6c708b0d90"><div class="ttname"><a href="classFitterBase.html#a6319d2ea50984860475bbc6c708b0d90">FitterBase::accProb</a></div><div class="ttdeci">double accProb</div><div class="ttdoc">current acceptance prob</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00122">FitterBase.h:122</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a6c5b6c38ba4c6f482592147c7e6b3b95"><div class="ttname"><a href="classFitterBase.html#a6c5b6c38ba4c6f482592147c7e6b3b95">FitterBase::AlgorithmName</a></div><div class="ttdeci">std::string AlgorithmName</div><div class="ttdoc">Name of fitting algorithm that is being used.</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00173">FitterBase.h:173</a></div></div>
<div class="ttc" id="aclassFitterBase_html_abfb6f10720764d8bbbe43754fd5cd976"><div class="ttname"><a href="classFitterBase.html#abfb6f10720764d8bbbe43754fd5cd976">FitterBase::logLCurr</a></div><div class="ttdeci">double logLCurr</div><div class="ttdoc">current likelihood</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00118">FitterBase.h:118</a></div></div>
<div class="ttc" id="aclassFitterBase_html_aed2032b9c4a4f2248abe548f54f8dcc8"><div class="ttname"><a href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">FitterBase::outTree</a></div><div class="ttdeci">TTree * outTree</div><div class="ttdoc">Output tree with posteriors.</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00158">FitterBase.h:158</a></div></div>
<div class="ttc" id="aclassFitterBase_html_afeffc9d794c973a015aa12ec1a8f79da"><div class="ttname"><a href="classFitterBase.html#afeffc9d794c973a015aa12ec1a8f79da">FitterBase::systematics</a></div><div class="ttdeci">std::vector&lt; ParameterHandlerBase * &gt; systematics</div><div class="ttdoc">Systematic holder.</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00139">FitterBase.h:139</a></div></div>
<div class="ttc" id="aclassMCMCBase_html_a504f906fea923b63221732a8c8d1d591"><div class="ttname"><a href="classMCMCBase.html#a504f906fea923b63221732a8c8d1d591">MCMCBase::AcceptStep</a></div><div class="ttdeci">void AcceptStep()</div><div class="ttdoc">Accept a step.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCBase_8cpp_source.html#l00189">MCMCBase.cpp:189</a></div></div>
<div class="ttc" id="aclassMCMCBase_html_a8c81e543609bb3878b114f9f8b2c0393"><div class="ttname"><a href="classMCMCBase.html#a8c81e543609bb3878b114f9f8b2c0393">MCMCBase::out_of_bounds</a></div><div class="ttdeci">bool out_of_bounds</div><div class="ttdoc">Do we reject based on hitting boundaries in systs.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCBase_8h_source.html#l00060">MCMCBase.h:60</a></div></div>
<div class="ttc" id="aclassMCMCBase_html_a9b8aac7fa8691719347ae70a5fa20226"><div class="ttname"><a href="classMCMCBase.html#a9b8aac7fa8691719347ae70a5fa20226">MCMCBase::IsStepAccepted</a></div><div class="ttdeci">bool IsStepAccepted(const double acc_prob)</div><div class="ttdoc">Is step accepted?</div><div class="ttdef"><b>Definition:</b> <a href="MCMCBase_8cpp_source.html#l00171">MCMCBase.cpp:171</a></div></div>
<div class="ttc" id="aclassMR2T2_html"><div class="ttname"><a href="classMR2T2.html">MR2T2</a></div><div class="ttdoc">MCMC algorithm implementing the MetropolisRosenbluthRosenbluthTellerTeller (MR T ) method.</div><div class="ttdef"><b>Definition:</b> <a href="MR2T2_8h_source.html#l00025">MR2T2.h:25</a></div></div>
<div class="ttc" id="aclassMR2T2_html_a8887ddc1e04965b04c99182637b4654a"><div class="ttname"><a href="classMR2T2.html#a8887ddc1e04965b04c99182637b4654a">MR2T2::ProposeStep</a></div><div class="ttdeci">void ProposeStep() override</div><div class="ttdoc">Propose a step.</div><div class="ttdef"><b>Definition:</b> <a href="MR2T2_8cpp_source.html#l00025">MR2T2.cpp:25</a></div></div>
<div class="ttc" id="aclassMR2T2_html_a991bdcec55b12d179b85b0293313d682"><div class="ttname"><a href="classMR2T2.html#a991bdcec55b12d179b85b0293313d682">MR2T2::AcceptanceProbability</a></div><div class="ttdeci">double AcceptanceProbability() override</div><div class="ttdoc">Step acceptance probability.</div><div class="ttdef"><b>Definition:</b> <a href="MR2T2_8cpp_source.html#l00103">MR2T2.cpp:103</a></div></div>
<div class="ttc" id="aclassmanager_html"><div class="ttname"><a href="classmanager.html">manager</a></div><div class="ttdoc">The manager class is responsible for managing configurations and settings.</div><div class="ttdef"><b>Definition:</b> <a href="Manager_8h_source.html#l00016">Manager.h:16</a></div></div>
<div class="ttc" id="aclassmanager_html_aecbfb3ead2c10006f39a144f64d3cb53"><div class="ttname"><a href="classmanager.html#aecbfb3ead2c10006f39a144f64d3cb53">manager::raw</a></div><div class="ttdeci">YAML::Node const  &amp; raw() const</div><div class="ttdoc">Return config.</div><div class="ttdef"><b>Definition:</b> <a href="Manager_8h_source.html#l00041">Manager.h:41</a></div></div>
<div class="ttc" id="anamespaceM3_html_a1a85b25da2b8b2cbb0993b15dcf77a6d"><div class="ttname"><a href="namespaceM3.html#a1a85b25da2b8b2cbb0993b15dcf77a6d">M3::_LARGE_LOGL_</a></div><div class="ttdeci">constexpr static const double _LARGE_LOGL_</div><div class="ttdoc">Large Likelihood is used it parameter go out of physical boundary, this indicates in MCMC that such s...</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00080">Core.h:80</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- Footer for MaCh3 Doxygen documentation -->
<footer class="mach3-footer" style="text-align: center;">
    <div style="margin-bottom: 15px;">
        <span style="font-weight: bold;">The MaCh3 Collaboration</span>
    </div>
    <!-- Dropdown to jump between doc versions -->
    <div style="margin-bottom: 10px;">
        <span>Select Software Version: </span>
        <select id="versionSelector" onchange="window.location.href=this.value" style="padding: 5px; border-radius: 4px; border: 1px solid #ccc;">
            <option value="">-- Select --</option>
            <option value="https://mach3-software.github.io/MaCh3/">develop</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.3.0/index.html">v2.3.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.2.0/index.html">v2.2.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.1.0/index.html">v2.1.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.0.0/index.html">v2.0.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.5.0/index.html">v1.5.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.4.0/index.html">v1.4.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.3.0/index.html">v1.3.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.2.0/index.html">v1.2.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.1.0/index.html">v1.1.0</option>
        </select>
    </div>
    <!-- Footer info about doxygen -->
    <div style="font-size: 0.9em; color: #666; margin-top: 10px;">
        Documentation generated with
        <a href="https://www.doxygen.nl/" target="_blank" style="color: #666;">Doxygen</a>
        <span id="doxygenVersion"></span>
    </div>
    <!-- Now grab doxygen version from metadata -->
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        const meta = document.querySelector('meta[name="generator"]');
        if (meta) {
            const version = meta.getAttribute("content").replace("Doxygen ", "");
            document.getElementById("doxygenVersion").textContent = " " + version;
        }
    });
    </script>
</footer>
