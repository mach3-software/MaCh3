<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MaCh3: MaCh3 Diagnostic &amp; Processing</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="MaCh3.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mach3logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MaCh3
   &#160;<span id="projectnumber">2.4.2</span>
   </div>
   <div id="projectbrief">Reference Guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a>  </div>
  <div class="headertitle">
<div class="title">MaCh3 Diagnostic &amp; Processing</div>  </div>
</div><!--header-->
<div class="contents">

<p>Tools used for diagnostic MCMC and general MCMC processing.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:CombineMaCh3Chains_8cpp"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="CombineMaCh3Chains_8cpp.html">CombineMaCh3Chains.cpp</a></td></tr>
<tr class="memdesc:CombineMaCh3Chains_8cpp"><td class="mdescLeft">&#160;</td><td class="mdescRight">Combine chains files produced by <b>MCMC</b>, enforcing the condition that all the files to combine were made using the exact same software versions and config files. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:DiagMCMC_8cpp"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="DiagMCMC_8cpp.html">DiagMCMC.cpp</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:GetPenaltyTerm_8cpp"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="GetPenaltyTerm_8cpp.html">GetPenaltyTerm.cpp</a></td></tr>
<tr class="memdesc:GetPenaltyTerm_8cpp"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: This file contains the implementation of the function to extract specific penalty terms from systematic chains. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:PlotLLHMap_8cpp"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="PlotLLHMap_8cpp.html">PlotLLHMap.cpp</a></td></tr>
<tr class="memdesc:PlotLLHMap_8cpp"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processing n-dimensional LLHMap outputs generating 1D and 2D profiled likelihoods as defined in config. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:PlotMCMCDiag_8cpp"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="PlotMCMCDiag_8cpp.html">PlotMCMCDiag.cpp</a></td></tr>
<tr class="memdesc:PlotMCMCDiag_8cpp"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: This script is used to analyse output form DiagMCMC. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ProcessMCMC_8cpp"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProcessMCMC_8cpp.html">ProcessMCMC.cpp</a></td></tr>
<tr class="memdesc:ProcessMCMC_8cpp"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main exectable responsible for different types of MCMC processing like drawing posteriors, triangle plots etc. Actual implantation of methods is in <a class="el" href="classMCMCProcessor.html" title="Class responsible for processing MCMC chains, performing diagnostics, generating plots,...">MCMCProcessor</a>. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ReweightMCMC_8cpp"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ReweightMCMC_8cpp.html">ReweightMCMC.cpp</a></td></tr>
<tr class="memdesc:ReweightMCMC_8cpp"><td class="mdescLeft">&#160;</td><td class="mdescRight">This executable allow to reweight MCMC Chain, such technique is used to study impact of different priors without rerunning MCMC. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:RHat_8cpp"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html">RHat.cpp</a></td></tr>
<tr class="memdesc:RHat_8cpp"><td class="mdescLeft">&#160;</td><td class="mdescRight">This executable calculates the \( \hat{R} \) estimator for Markov Chain Monte Carlo (MCMC) convergence. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:RHat_8cpp"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RHat_8cpp.html">RHat.cpp</a></td></tr>
<tr class="memdesc:RHat_8cpp"><td class="mdescLeft">&#160;</td><td class="mdescRight">This executable calculates the \( \hat{R} \) estimator for Markov Chain Monte Carlo (MCMC) convergence. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:SmearChain_8cpp"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SmearChain_8cpp.html">SmearChain.cpp</a></td></tr>
<tr class="memdesc:SmearChain_8cpp"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allows you to smear contour. For example after performing sets of study one finds out that used sets of uncertainty doesn't fully cover analysis need. Then one can smear additionally contour. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Tools used for diagnostic MCMC and general MCMC processing. </p>
<h1><a class="anchor" id="autotoc_md59"></a>
Diagnostic Applications</h1>
<p><b><a class="el" href="ProcessMCMC_8cpp.html">ProcessMCMC</a></b> The main application for analysing the ND280 chain. It prints posterior distributions after the burn-in cut and allows comparison of two or three different chains. Several options can be configured directly in the app, such as selection, burn-in cut, and whether to plot xsec+flux or only flux.</p>
<p>Additional functionality includes: </p><ol>
<li>
Produce a covariance matrix with multithreading (RAM intensive due to caching) </li>
<li>
Violin plots </li>
<li>
Credible intervals and regions </li>
<li>
Calculation of Bayes factors with significance based on the Jeffreys scale </li>
<li>
Triangle plots </li>
<li>
Study of covariance matrix stability </li>
</ol>
<p>More options are described here: <a href="https://mach3-software.github.io/MaCh3/BayesianAnalysis.html">Bayesian Analysis Documentation</a></p>
<p><b><a class="el" href="GetPenaltyTerm_8cpp.html">GetPenaltyTerm</a></b> Since xsec, flux, and ND spline systematics are treated as the same systematic object, the log term cannot be taken directly. This utility evaluates the correct penalty term: </p><div class="fragment"><div class="line">GetFluxPenaltyTerm MCMCChain.root <a class="code" href="ProcessMCMC_8cpp.html#a13056efd080ab16304b6f7be0ebf0a61">config</a></div>
<div class="ttc" id="aProcessMCMC_8cpp_html_a13056efd080ab16304b6f7be0ebf0a61"><div class="ttname"><a href="ProcessMCMC_8cpp.html#a13056efd080ab16304b6f7be0ebf0a61">config</a></div><div class="ttdeci">std::string config</div><div class="ttdef"><b>Definition:</b> <a href="ProcessMCMC_8cpp_source.html#l00030">ProcessMCMC.cpp:30</a></div></div>
</div><!-- fragment --><p> Relevant parameters are loaded via the configuration, allowing arbitrary combinations to be studied. Runtime increases with the number of sets.</p>
<p><b><a class="el" href="DiagMCMC_8cpp.html">DiagMCMC</a></b> Performs MCMC diagnostics such as autocorrelation and trace plots.</p>
<p><b><a class="el" href="PlotMCMCDiag_8cpp.html">PlotMCMCDiag</a></b> Plots the output of <em>DiagMCMC</em> and can compare multiple files: </p><div class="fragment"><div class="line">./PlotMCMCDiag DiagMCMC_file_1.root Label_1, DiagMCMC_file_2.root Label_2 ...</div>
</div><!-- fragment --><p> Up to four files can be processed simultaneously.</p>
<p><b><a class="el" href="RHat_8cpp.html">RHat</a></b> Performs the \(\hat{R}\) diagnostic to verify that all chains converged to the same stationary distribution: </p><div class="fragment"><div class="line">./<a class="code" href="RHat_8cpp.html#ab5cfb5e8741283e8d8252aae184004e4">RHat</a> <a class="code" href="RHat__HighMem_8cpp.html#afa110f35953074d3cc7ad452d003fd7a">Ntoys</a> MCMCchain_1.root MCMCchain_2.root MCMCchain_3.root ...</div>
<div class="ttc" id="aRHat_8cpp_html_ab5cfb5e8741283e8d8252aae184004e4"><div class="ttname"><a href="RHat_8cpp.html#ab5cfb5e8741283e8d8252aae184004e4">RHat</a></div><div class="ttdeci">double * RHat</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00071">RHat.cpp:71</a></div></div>
<div class="ttc" id="aRHat__HighMem_8cpp_html_afa110f35953074d3cc7ad452d003fd7a"><div class="ttname"><a href="RHat__HighMem_8cpp.html#afa110f35953074d3cc7ad452d003fd7a">Ntoys</a></div><div class="ttdeci">int Ntoys</div><div class="ttdef"><b>Definition:</b> <a href="RHat__HighMem_8cpp_source.html#l00039">RHat_HighMem.cpp:39</a></div></div>
</div><!-- fragment --><p><b><a class="el" href="CombineMaCh3Chains_8cpp.html">CombineMaCh3Chains</a></b> Combines chain files produced by MCMC, enforcing that all inputs were generated with identical software versions and configuration: </p><div class="fragment"><div class="line">CombineMaCh3Chains [-h] [-c [0-9]] [-f] [-o &lt;output file&gt;] file1.root [file2.root ...]</div>
</div><!-- fragment --><p>Options:</p><ul>
<li><code>-c</code> Target compression level (default 1, consistent with <code>hadd</code>)</li>
<li><code>-f</code> Force overwrite if the output file already exists</li>
<li><code>-h</code> Print usage message and exit</li>
</ul>
<p>If no output name is specified, the first input file name is reused.</p>
<p><b><a class="el" href="SmearChain_8cpp.html">SmearChain</a></b> Allows smearing of contours. Useful when a study shows that the evaluated uncertainty set does not fully cover the analysis needs: </p><div class="fragment"><div class="line"><a class="code" href="SmearChain_8cpp.html#aaea0692d40005c70e3328be6bebc8588">SmearChain</a> MCMCchain.root Config.yaml</div>
<div class="ttc" id="aSmearChain_8cpp_html_aaea0692d40005c70e3328be6bebc8588"><div class="ttname"><a href="SmearChain_8cpp.html#aaea0692d40005c70e3328be6bebc8588">SmearChain</a></div><div class="ttdeci">void SmearChain(const std::string &amp;inputFile, const std::string &amp;config)</div><div class="ttdoc">Main function creating MCMCProcessor and calling Smear Chain.</div><div class="ttdef"><b>Definition:</b> <a href="SmearChain_8cpp_source.html#l00012">SmearChain.cpp:12</a></div></div>
</div><!-- fragment --><p><b><a class="el" href="ReweightMCMC_8cpp.html">ReweightMCMC</a></b> Enables chain reweighting to test alternative prior choices without rerunning the MCMC. Commonly used to study the impact of reactor constraints on \(\theta_{13}\): </p><div class="fragment"><div class="line"><a class="code" href="ReweightMCMC_8cpp.html#ade0a39153d1b68876f307113a0d298cd">ReweightMCMC</a> Config.yaml MCMCchain.root</div>
<div class="ttc" id="aReweightMCMC_8cpp_html_ade0a39153d1b68876f307113a0d298cd"><div class="ttname"><a href="ReweightMCMC_8cpp.html#ade0a39153d1b68876f307113a0d298cd">ReweightMCMC</a></div><div class="ttdeci">void ReweightMCMC(const std::string &amp;inputFile, const std::string &amp;configFile)</div><div class="ttdoc">Main executable responsible for reweighting MCMC chains.</div><div class="ttdef"><b>Definition:</b> <a href="ReweightMCMC_8cpp_source.html#l00280">ReweightMCMC.cpp:280</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- Footer for MaCh3 Doxygen documentation -->
<footer class="mach3-footer" style="text-align: center;">
    <div style="margin-bottom: 15px;">
        <span style="font-weight: bold;">The MaCh3 Collaboration</span>
    </div>
    <!-- Dropdown to jump between doc versions -->
    <div style="margin-bottom: 10px;">
        <span>Select Software Version: </span>
        <select id="versionSelector" onchange="window.location.href=this.value" style="padding: 5px; border-radius: 4px; border: 1px solid #ccc;">
            <option value="">-- Select --</option>
            <option value="https://mach3-software.github.io/MaCh3/">develop</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.4.0/index.html">v2.4.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.3.0/index.html">v2.3.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.2.0/index.html">v2.2.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.1.0/index.html">v2.1.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.0.0/index.html">v2.0.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.5.0/index.html">v1.5.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.4.0/index.html">v1.4.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.3.0/index.html">v1.3.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.2.0/index.html">v1.2.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.1.0/index.html">v1.1.0</option>
        </select>
    </div>
    <!-- Footer info about doxygen -->
    <div style="font-size: 0.9em; color: #666; margin-top: 10px;">
        Documentation generated with
        <a href="https://www.doxygen.nl/" target="_blank" style="color: #666;">Doxygen</a>
        <span id="doxygenVersion"></span>
    </div>
    <!-- Now grab doxygen version from metadata -->
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        const meta = document.querySelector('meta[name="generator"]');
        if (meta) {
            const version = meta.getAttribute("content").replace("Doxygen ", "");
            document.getElementById("doxygenVersion").textContent = " " + version;
        }
    });
    </script>
</footer>
