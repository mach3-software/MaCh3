<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MaCh3: SampleHandlerFD Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="MaCh3.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mach3logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MaCh3
   &#160;<span id="projectnumber">2.1.0</span>
   </div>
   <div id="projectbrief">Reference Guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classSampleHandlerFD-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">SampleHandlerFD Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>Class responsible for handling implementation of samples used in analysis, reweighting and returning LLH.  
 <a href="classSampleHandlerFD.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="SampleHandlerFD_8h_source.html">/hosthome/v2.1.0/Samples/SampleHandlerFD.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for SampleHandlerFD:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classSampleHandlerFD__inherit__graph.svg" width="156" height="187"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for SampleHandlerFD:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classSampleHandlerFD__coll__graph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:abc6513dc1e3301ac7fcc611fc3779198"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#abc6513dc1e3301ac7fcc611fc3779198">SampleHandlerFD</a> (std::string ConfigFileName, <a class="el" href="classParameterHandlerGeneric.html">ParameterHandlerGeneric</a> *xsec_cov, <a class="el" href="classParameterHandlerOsc.html">ParameterHandlerOsc</a> *osc_cov=nullptr, const std::shared_ptr&lt; <a class="el" href="classOscillationHandler.html">OscillationHandler</a> &gt; &amp;OscillatorObj_=nullptr)</td></tr>
<tr class="memdesc:abc6513dc1e3301ac7fcc611fc3779198"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classSampleHandlerFD.html#abc6513dc1e3301ac7fcc611fc3779198">More...</a><br /></td></tr>
<tr class="separator:abc6513dc1e3301ac7fcc611fc3779198"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7aa8473194b5afccfbf453392b49e580"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a7aa8473194b5afccfbf453392b49e580">~SampleHandlerFD</a> ()</td></tr>
<tr class="memdesc:a7aa8473194b5afccfbf453392b49e580"><td class="mdescLeft">&#160;</td><td class="mdescRight">destructor  <a href="classSampleHandlerFD.html#a7aa8473194b5afccfbf453392b49e580">More...</a><br /></td></tr>
<tr class="separator:a7aa8473194b5afccfbf453392b49e580"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3f9eb0131a6e1f7d4bd411902f4425ca"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga3f9eb0131a6e1f7d4bd411902f4425ca">GetNDim</a> ()</td></tr>
<tr class="separator:ga3f9eb0131a6e1f7d4bd411902f4425ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga46ca9963ed2f9b9b337db72bf52d99e6"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga46ca9963ed2f9b9b337db72bf52d99e6">GetSampleName</a> (int iSample=0) const override</td></tr>
<tr class="separator:ga46ca9963ed2f9b9b337db72bf52d99e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga80a62c0759d4df18e8d641a3cbceea46"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga80a62c0759d4df18e8d641a3cbceea46">GetTitle</a> () const override</td></tr>
<tr class="separator:ga80a62c0759d4df18e8d641a3cbceea46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8c4ed6a59c8e49f6292513c4de315e62"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga8c4ed6a59c8e49f6292513c4de315e62">GetXBinVarName</a> ()</td></tr>
<tr class="separator:ga8c4ed6a59c8e49f6292513c4de315e62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1095657cb0d1613333dd90448d3fbc4a"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga1095657cb0d1613333dd90448d3fbc4a">GetYBinVarName</a> ()</td></tr>
<tr class="separator:ga1095657cb0d1613333dd90448d3fbc4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6873a444da656d651d4ada07345c0ae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#af6873a444da656d651d4ada07345c0ae">PrintIntegral</a> (TString OutputName=&quot;/dev/null&quot;, int WeightStyle=0, TString OutputCSVName=&quot;/dev/null&quot;)</td></tr>
<tr class="separator:af6873a444da656d651d4ada07345c0ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd6a736c3752b05dde1e1e3703bf42a5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#afd6a736c3752b05dde1e1e3703bf42a5">AddData</a> (TH1D *Data) override</td></tr>
<tr class="separator:afd6a736c3752b05dde1e1e3703bf42a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dea09fa53bc8ec35a38c3a26f000c03"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a2dea09fa53bc8ec35a38c3a26f000c03">AddData</a> (TH2D *Data) override</td></tr>
<tr class="separator:a2dea09fa53bc8ec35a38c3a26f000c03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a203041ed33becd131eb3d03277d7d20c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a203041ed33becd131eb3d03277d7d20c">AddData</a> (std::vector&lt; double &gt; &amp;data) override</td></tr>
<tr class="separator:a203041ed33becd131eb3d03277d7d20c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2a7215360849e5c681b62bdf56b8ebc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#af2a7215360849e5c681b62bdf56b8ebc">AddData</a> (std::vector&lt; std::vector&lt; double &gt; &gt; &amp;data) override</td></tr>
<tr class="separator:af2a7215360849e5c681b62bdf56b8ebc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f8116b84ce4dd9f2ab55983f793fe14"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a4f8116b84ce4dd9f2ab55983f793fe14">GetLikelihood</a> () override</td></tr>
<tr class="memdesc:a4f8116b84ce4dd9f2ab55983f793fe14"><td class="mdescLeft">&#160;</td><td class="mdescRight">DB Multi-threaded GetLikelihood.  <a href="classSampleHandlerFD.html#a4f8116b84ce4dd9f2ab55983f793fe14">More...</a><br /></td></tr>
<tr class="separator:a4f8116b84ce4dd9f2ab55983f793fe14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3e03bd9beffb8b31acfd3bb5ebb44a2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ae3e03bd9beffb8b31acfd3bb5ebb44a2">Reweight</a> () override</td></tr>
<tr class="separator:ae3e03bd9beffb8b31acfd3bb5ebb44a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e735d294d926fef87a6fc4c0ec54dca"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a9e735d294d926fef87a6fc4c0ec54dca">GetEventWeight</a> (const int iEntry) const</td></tr>
<tr class="separator:a9e735d294d926fef87a6fc4c0ec54dca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fe790616b56940869c438822a79b1de"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a9fe790616b56940869c438822a79b1de">InitialiseNuOscillatorObjects</a> ()</td></tr>
<tr class="memdesc:a9fe790616b56940869c438822a79b1de"><td class="mdescLeft">&#160;</td><td class="mdescRight">including Dan's magic NuOscillator  <a href="classSampleHandlerFD.html#a9fe790616b56940869c438822a79b1de">More...</a><br /></td></tr>
<tr class="separator:a9fe790616b56940869c438822a79b1de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4bcbd508ec8d14d36f32911e12af1e9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ae4bcbd508ec8d14d36f32911e12af1e9">SetupNuOscillatorPointers</a> ()</td></tr>
<tr class="separator:ae4bcbd508ec8d14d36f32911e12af1e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12b800763e6bbcfaa6a527de18bc90f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a12b800763e6bbcfaa6a527de18bc90f5">ReadSampleConfig</a> ()</td></tr>
<tr class="separator:a12b800763e6bbcfaa6a527de18bc90f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae9fedcc337bc5aa5baeb1311548258c9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gae9fedcc337bc5aa5baeb1311548258c9">GetNMCSamples</a> () override</td></tr>
<tr class="separator:gae9fedcc337bc5aa5baeb1311548258c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga72d58e162b82d2fe895087d91c07c0a2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga72d58e162b82d2fe895087d91c07c0a2">GetNOscChannels</a> ()</td></tr>
<tr class="separator:ga72d58e162b82d2fe895087d91c07c0a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9eb3d4a487ed877beb252738b9de9443"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga9eb3d4a487ed877beb252738b9de9443">GetFlavourName</a> (const int iChannel)</td></tr>
<tr class="separator:ga9eb3d4a487ed877beb252738b9de9443"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga87d23d5355b2dcebe497a4bb7150b532"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga87d23d5355b2dcebe497a4bb7150b532">Get1DVarHist</a> (const std::string &amp;ProjectionVar, const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;SelectionVec=std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt;(), int WeightStyle=0, TAxis *Axis=nullptr)</td></tr>
<tr class="separator:ga87d23d5355b2dcebe497a4bb7150b532"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57505f631ef8a9501b9036b9ff7a7a49"><td class="memItemLeft" align="right" valign="top">TH2 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a57505f631ef8a9501b9036b9ff7a7a49">Get2DVarHist</a> (const std::string &amp;ProjectionVarX, const std::string &amp;ProjectionVarY, const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;SelectionVec=std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt;(), int WeightStyle=0, TAxis *AxisX=nullptr, TAxis *AxisY=nullptr)</td></tr>
<tr class="separator:a57505f631ef8a9501b9036b9ff7a7a49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaac0dad7d2090250cf8094eb8ceaab932"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gaac0dad7d2090250cf8094eb8ceaab932">Get1DVarHistByModeAndChannel</a> (const std::string &amp;ProjectionVar_Str, int kModeToFill=-1, int kChannelToFill=-1, int WeightStyle=0, TAxis *Axis=nullptr)</td></tr>
<tr class="separator:gaac0dad7d2090250cf8094eb8ceaab932"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa78d7bcfe9377cb7d47d596b39eda84c"><td class="memItemLeft" align="right" valign="top">TH2 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gaa78d7bcfe9377cb7d47d596b39eda84c">Get2DVarHistByModeAndChannel</a> (const std::string &amp;ProjectionVar_StrX, const std::string &amp;ProjectionVar_StrY, int kModeToFill=-1, int kChannelToFill=-1, int WeightStyle=0, TAxis *AxisX=nullptr, TAxis *AxisY=nullptr)</td></tr>
<tr class="separator:gaa78d7bcfe9377cb7d47d596b39eda84c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabb8ac1e8e55d6ea2097380e5078a0198"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gabb8ac1e8e55d6ea2097380e5078a0198">GetModeHist1D</a> (int s, int m, int style=0)</td></tr>
<tr class="separator:gabb8ac1e8e55d6ea2097380e5078a0198"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3100796be3a94b715355d045a530ba43"><td class="memItemLeft" align="right" valign="top">TH2 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga3100796be3a94b715355d045a530ba43">GetModeHist2D</a> (int s, int m, int style=0)</td></tr>
<tr class="separator:ga3100796be3a94b715355d045a530ba43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac7f3dd7b022e7c0714ab12db1184eb47"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH1 * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gac7f3dd7b022e7c0714ab12db1184eb47">ReturnHistsBySelection1D</a> (std::string KinematicProjection, int Selection1, int Selection2=-1, int WeightStyle=0, TAxis *Axis=0)</td></tr>
<tr class="separator:gac7f3dd7b022e7c0714ab12db1184eb47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7aa8723e32e056e1247341d41378ab60"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH2 * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga7aa8723e32e056e1247341d41378ab60">ReturnHistsBySelection2D</a> (std::string KinematicProjectionX, std::string KinematicProjectionY, int Selection1, int Selection2=-1, int WeightStyle=0, TAxis *XAxis=0, TAxis *YAxis=0)</td></tr>
<tr class="separator:ga7aa8723e32e056e1247341d41378ab60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafab4fb4f384c540493af65a3efa55287"><td class="memItemLeft" align="right" valign="top">THStack *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gafab4fb4f384c540493af65a3efa55287">ReturnStackedHistBySelection1D</a> (std::string KinematicProjection, int Selection1, int Selection2=-1, int WeightStyle=0, TAxis *Axis=0)</td></tr>
<tr class="separator:gafab4fb4f384c540493af65a3efa55287"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8be73835c2d9f0e50d738c4f204a0286"><td class="memItemLeft" align="right" valign="top">TLegend *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga8be73835c2d9f0e50d738c4f204a0286">ReturnStackHistLegend</a> ()</td></tr>
<tr class="separator:ga8be73835c2d9f0e50d738c4f204a0286"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae2769d593f34e8356b545af076818f89"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gae2769d593f34e8356b545af076818f89">ReturnKinematicParameterFromString</a> (const std::string &amp;KinematicStr) const</td></tr>
<tr class="memdesc:gae2769d593f34e8356b545af076818f89"><td class="mdescLeft">&#160;</td><td class="mdescRight">ETA function to generically convert a string from xsec cov to a kinematic type.  <a href="group__SampleHandlerGetters.html#gae2769d593f34e8356b545af076818f89">More...</a><br /></td></tr>
<tr class="separator:gae2769d593f34e8356b545af076818f89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3e88e3720a6a8d3384a6b8d317795c74"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga3e88e3720a6a8d3384a6b8d317795c74">ReturnStringFromKinematicParameter</a> (const int KinematicVariable) const</td></tr>
<tr class="memdesc:ga3e88e3720a6a8d3384a6b8d317795c74"><td class="mdescLeft">&#160;</td><td class="mdescRight">ETA function to generically convert a kinematic type from xsec cov to a string.  <a href="group__SampleHandlerGetters.html#ga3e88e3720a6a8d3384a6b8d317795c74">More...</a><br /></td></tr>
<tr class="separator:ga3e88e3720a6a8d3384a6b8d317795c74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classSampleHandlerBase"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classSampleHandlerBase')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classSampleHandlerBase.html">SampleHandlerBase</a></td></tr>
<tr class="memitem:a6a6d7e5d275154ed550cd6c9dfc36000 inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a6a6d7e5d275154ed550cd6c9dfc36000">SampleHandlerBase</a> ()</td></tr>
<tr class="separator:a6a6d7e5d275154ed550cd6c9dfc36000 inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07b6726b71241ea71e12cfa78fbc49ed inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a07b6726b71241ea71e12cfa78fbc49ed">~SampleHandlerBase</a> ()</td></tr>
<tr class="memdesc:a07b6726b71241ea71e12cfa78fbc49ed inherit pub_methods_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">destructor  <a href="classSampleHandlerBase.html#a07b6726b71241ea71e12cfa78fbc49ed">More...</a><br /></td></tr>
<tr class="separator:a07b6726b71241ea71e12cfa78fbc49ed inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac4b73a8841ff9bab2fb08b578ad4137f inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gac4b73a8841ff9bab2fb08b578ad4137f">GetNsamples</a> ()</td></tr>
<tr class="separator:gac4b73a8841ff9bab2fb08b578ad4137f inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3f4388fbe27168c5dae8fa722a7c1299 inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga3f4388fbe27168c5dae8fa722a7c1299">GetSampleLikelihood</a> (const int isample)</td></tr>
<tr class="separator:ga3f4388fbe27168c5dae8fa722a7c1299 inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6e807de9ac80fb9f12722e033c44f7e inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#ab6e807de9ac80fb9f12722e033c44f7e">CleanMemoryBeforeFit</a> ()=0</td></tr>
<tr class="memdesc:ab6e807de9ac80fb9f12722e033c44f7e inherit pub_methods_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allow to clean not used memory before fit starts.  <a href="classSampleHandlerBase.html#ab6e807de9ac80fb9f12722e033c44f7e">More...</a><br /></td></tr>
<tr class="separator:ab6e807de9ac80fb9f12722e033c44f7e inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4e232eb59bc09c3f8ff4cbed69fcd688 inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMaCh3Modes.html">MaCh3Modes</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga4e232eb59bc09c3f8ff4cbed69fcd688">GetMaCh3Modes</a> () const</td></tr>
<tr class="memdesc:ga4e232eb59bc09c3f8ff4cbed69fcd688 inherit pub_methods_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to MaCh3 modes.  <a href="group__SampleHandlerGetters.html#ga4e232eb59bc09c3f8ff4cbed69fcd688">More...</a><br /></td></tr>
<tr class="separator:ga4e232eb59bc09c3f8ff4cbed69fcd688 inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad78de3486a4320a687a38ee2248e7167 inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">TH1D *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gad78de3486a4320a687a38ee2248e7167">Get1DHist</a> ()</td></tr>
<tr class="separator:gad78de3486a4320a687a38ee2248e7167 inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacb8b0145f4e9342ca670c4202e24d815 inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">TH2D *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gacb8b0145f4e9342ca670c4202e24d815">Get2DHist</a> ()</td></tr>
<tr class="separator:gacb8b0145f4e9342ca670c4202e24d815 inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga76bc810effe60f0f23063398b9497008 inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">TH1D *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga76bc810effe60f0f23063398b9497008">Get1DDataHist</a> ()</td></tr>
<tr class="separator:ga76bc810effe60f0f23063398b9497008 inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5317b30446e26bac66c3ad58ffb28529 inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">TH2D *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga5317b30446e26bac66c3ad58ffb28529">Get2DDataHist</a> ()</td></tr>
<tr class="separator:ga5317b30446e26bac66c3ad58ffb28529 inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5463cc125470d1f31fbc1ab8f01b60a7 inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga5463cc125470d1f31fbc1ab8f01b60a7">GetNEvents</a> ()</td></tr>
<tr class="separator:ga5463cc125470d1f31fbc1ab8f01b60a7 inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cf61d8f769755c4a0fa549adc575c3e inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a0cf61d8f769755c4a0fa549adc575c3e">SetupBinning</a> (const <a class="el" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a> Selection, std::vector&lt; double &gt; &amp;BinningX, std::vector&lt; double &gt; &amp;BinningY)</td></tr>
<tr class="separator:a0cf61d8f769755c4a0fa549adc575c3e inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5a3f0796fcbbe49c4368d71a2198861 inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">virtual TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#aa5a3f0796fcbbe49c4368d71a2198861">GetData</a> (const int Selection)</td></tr>
<tr class="separator:aa5a3f0796fcbbe49c4368d71a2198861 inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41f6bdcb629e1269724249fbeb5289c2 inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">virtual TH2Poly *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a41f6bdcb629e1269724249fbeb5289c2">GetW2</a> (const int Selection)</td></tr>
<tr class="separator:a41f6bdcb629e1269724249fbeb5289c2 inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6dff7e88d8d8be3f27cf4c5d05e6f13 inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">virtual TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#af6dff7e88d8d8be3f27cf4c5d05e6f13">GetPDF</a> (const int Selection)</td></tr>
<tr class="separator:af6dff7e88d8d8be3f27cf4c5d05e6f13 inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c2ab1f967e527e656b0198038a43bfb inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">virtual TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a1c2ab1f967e527e656b0198038a43bfb">GetPDFMode</a> (const int Selection, const int Mode)</td></tr>
<tr class="separator:a1c2ab1f967e527e656b0198038a43bfb inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bef25c33bdd8d4c800cb64ae4197911 inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a9bef25c33bdd8d4c800cb64ae4197911">GetKinVarLabel</a> (const int sample, const int Dimension)</td></tr>
<tr class="separator:a9bef25c33bdd8d4c800cb64ae4197911 inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac0cfbc3d13eafd3b5687ff739b862b80 inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gac0cfbc3d13eafd3b5687ff739b862b80">GetTestStatLLH</a> (double data, double mc) const</td></tr>
<tr class="memdesc:gac0cfbc3d13eafd3b5687ff739b862b80 inherit pub_methods_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate test statistic for a single bin using Poisson.  <a href="group__SampleHandlerGetters.html#gac0cfbc3d13eafd3b5687ff739b862b80">More...</a><br /></td></tr>
<tr class="separator:gac0cfbc3d13eafd3b5687ff739b862b80 inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga527307a4186e2eb61475ea975108aa65 inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga527307a4186e2eb61475ea975108aa65">GetTestStatLLH</a> (const double data, const double mc, const double w2) const</td></tr>
<tr class="memdesc:ga527307a4186e2eb61475ea975108aa65 inherit pub_methods_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate test statistic for a single bin. Calculation depends on setting of fTestStatistic.  <a href="group__SampleHandlerGetters.html#ga527307a4186e2eb61475ea975108aa65">More...</a><br /></td></tr>
<tr class="separator:ga527307a4186e2eb61475ea975108aa65 inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1c81b6b7a7e70b04c6c6ca1c81c70fc5 inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga1c81b6b7a7e70b04c6c6ca1c81c70fc5">SetTestStatistic</a> (<a class="el" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67">TestStatistic</a> testStat)</td></tr>
<tr class="memdesc:ga1c81b6b7a7e70b04c6c6ca1c81c70fc5 inherit pub_methods_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the test statistic to be used when calculating the binned likelihoods.  <a href="group__SampleHandlerGetters.html#ga1c81b6b7a7e70b04c6c6ca1c81c70fc5">More...</a><br /></td></tr>
<tr class="separator:ga1c81b6b7a7e70b04c6c6ca1c81c70fc5 inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:addd28baa3d823f7a9cd69864185fe399"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#addd28baa3d823f7a9cd69864185fe399">SetupWeightPointers</a> ()=0</td></tr>
<tr class="memdesc:addd28baa3d823f7a9cd69864185fe399"><td class="mdescLeft">&#160;</td><td class="mdescRight">DB Function to determine which weights apply to which types of samples pure virtual!!  <a href="classSampleHandlerFD.html#addd28baa3d823f7a9cd69864185fe399">More...</a><br /></td></tr>
<tr class="separator:addd28baa3d823f7a9cd69864185fe399"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61a1e9bbc4f812704278bf655d0d0ae2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a61a1e9bbc4f812704278bf655d0d0ae2">SetupKinematicMap</a> ()</td></tr>
<tr class="memdesc:a61a1e9bbc4f812704278bf655d0d0ae2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ensure Kinematic Map is setup and make sure it is initialised correctly.  <a href="classSampleHandlerFD.html#a61a1e9bbc4f812704278bf655d0d0ae2">More...</a><br /></td></tr>
<tr class="separator:a61a1e9bbc4f812704278bf655d0d0ae2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a984c564107c7207a2611d0bf67d9cc"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a1a984c564107c7207a2611d0bf67d9cc">SetupSplines</a> ()=0</td></tr>
<tr class="memdesc:a1a984c564107c7207a2611d0bf67d9cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">initialise your splineXX object and then use InitialiseSplineObject to conviently setup everything up  <a href="classSampleHandlerFD.html#a1a984c564107c7207a2611d0bf67d9cc">More...</a><br /></td></tr>
<tr class="separator:a1a984c564107c7207a2611d0bf67d9cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09cbb146872131227838a06581103c33"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a09cbb146872131227838a06581103c33">Init</a> ()=0</td></tr>
<tr class="memdesc:a09cbb146872131227838a06581103c33"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise any variables that your experiment specific SampleHandler needs.  <a href="classSampleHandlerFD.html#a09cbb146872131227838a06581103c33">More...</a><br /></td></tr>
<tr class="separator:a09cbb146872131227838a06581103c33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a330f801dfd7c0d14326048e93c5a51ae"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a330f801dfd7c0d14326048e93c5a51ae">SetupExperimentMC</a> ()=0</td></tr>
<tr class="memdesc:a330f801dfd7c0d14326048e93c5a51ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Experiment specific setup, returns the number of events which were loaded.  <a href="classSampleHandlerFD.html#a330f801dfd7c0d14326048e93c5a51ae">More...</a><br /></td></tr>
<tr class="separator:a330f801dfd7c0d14326048e93c5a51ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e112b4f306f7b792da77f6299535c1b"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a8e112b4f306f7b792da77f6299535c1b">SetupFDMC</a> ()=0</td></tr>
<tr class="memdesc:a8e112b4f306f7b792da77f6299535c1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function which translates experiment struct into core struct.  <a href="classSampleHandlerFD.html#a8e112b4f306f7b792da77f6299535c1b">More...</a><br /></td></tr>
<tr class="separator:a8e112b4f306f7b792da77f6299535c1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74209f7f52f81dd0663997e63d49d4e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a74209f7f52f81dd0663997e63d49d4e1">Initialise</a> ()</td></tr>
<tr class="memdesc:a74209f7f52f81dd0663997e63d49d4e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function which does a lot of the lifting regarding the workflow in creating different MC objects.  <a href="classSampleHandlerFD.html#a74209f7f52f81dd0663997e63d49d4e1">More...</a><br /></td></tr>
<tr class="separator:a74209f7f52f81dd0663997e63d49d4e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64b2af7680c88713c70f064fb7574184"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a64b2af7680c88713c70f064fb7574184">FillSplineBins</a> ()</td></tr>
<tr class="memdesc:a64b2af7680c88713c70f064fb7574184"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the binned spline that an event should apply to and stored them in a a vector for easy evaluation in the fillArray() function.  <a href="classSampleHandlerFD.html#a64b2af7680c88713c70f064fb7574184">More...</a><br /></td></tr>
<tr class="separator:a64b2af7680c88713c70f064fb7574184"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7da9bc1df59603a15e5164112ba4b72c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a7da9bc1df59603a15e5164112ba4b72c">FindNominalBinAndEdges1D</a> ()</td></tr>
<tr class="separator:a7da9bc1df59603a15e5164112ba4b72c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b4c3a7f56f3f7bc352555a0d847ec22"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a5b4c3a7f56f3f7bc352555a0d847ec22">FindNominalBinAndEdges2D</a> ()</td></tr>
<tr class="separator:a5b4c3a7f56f3f7bc352555a0d847ec22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9ea7e245d3bf6098ee49de38cf6d1fe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#af9ea7e245d3bf6098ee49de38cf6d1fe">Set1DBinning</a> (size_t nbins, double *boundaries)</td></tr>
<tr class="memdesc:af9ea7e245d3bf6098ee49de38cf6d1fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">sets the binning used for the likelihood calculation, used for both data and MC  <a href="classSampleHandlerFD.html#af9ea7e245d3bf6098ee49de38cf6d1fe">More...</a><br /></td></tr>
<tr class="separator:af9ea7e245d3bf6098ee49de38cf6d1fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17ee4ecca05819a49470c0492bfcf5c7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a17ee4ecca05819a49470c0492bfcf5c7">Set1DBinning</a> (size_t nbins, double low, double high)</td></tr>
<tr class="memdesc:a17ee4ecca05819a49470c0492bfcf5c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">set the binning used for likelihood calculation using uniform binning  <a href="classSampleHandlerFD.html#a17ee4ecca05819a49470c0492bfcf5c7">More...</a><br /></td></tr>
<tr class="separator:a17ee4ecca05819a49470c0492bfcf5c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae57301ae5bf3a8223179c1bd674d73f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#aae57301ae5bf3a8223179c1bd674d73f">Set2DBinning</a> (size_t nbins1, double *boundaries1, size_t nbins2, double *boundaries2)</td></tr>
<tr class="memdesc:aae57301ae5bf3a8223179c1bd674d73f"><td class="mdescLeft">&#160;</td><td class="mdescRight">set the binning for 2D sample used for the likelihood calculation  <a href="classSampleHandlerFD.html#aae57301ae5bf3a8223179c1bd674d73f">More...</a><br /></td></tr>
<tr class="separator:aae57301ae5bf3a8223179c1bd674d73f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5343d89326adb246a939c060d6da566"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ae5343d89326adb246a939c060d6da566">Set2DBinning</a> (size_t nbins1, double low1, double high1, size_t nbins2, double low2, double high2)</td></tr>
<tr class="memdesc:ae5343d89326adb246a939c060d6da566"><td class="mdescLeft">&#160;</td><td class="mdescRight">set the binning for 2D sample used for the likelihood calculation  <a href="classSampleHandlerFD.html#ae5343d89326adb246a939c060d6da566">More...</a><br /></td></tr>
<tr class="separator:ae5343d89326adb246a939c060d6da566"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed96d26b4689311ad4fdc8d74c4754d3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#aed96d26b4689311ad4fdc8d74c4754d3">Set1DBinning</a> (std::vector&lt; double &gt; &amp;XVec)</td></tr>
<tr class="memdesc:aed96d26b4689311ad4fdc8d74c4754d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">set the binning for 1D sample used for the likelihood calculation  <a href="classSampleHandlerFD.html#aed96d26b4689311ad4fdc8d74c4754d3">More...</a><br /></td></tr>
<tr class="separator:aed96d26b4689311ad4fdc8d74c4754d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9fe6d9954a86f091778161a1d9ed6d3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ae9fe6d9954a86f091778161a1d9ed6d3">Set2DBinning</a> (std::vector&lt; double &gt; &amp;XVec, std::vector&lt; double &gt; &amp;YVec)</td></tr>
<tr class="memdesc:ae9fe6d9954a86f091778161a1d9ed6d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">set the binning for 2D sample used for the likelihood calculation  <a href="classSampleHandlerFD.html#ae9fe6d9954a86f091778161a1d9ed6d3">More...</a><br /></td></tr>
<tr class="separator:ae9fe6d9954a86f091778161a1d9ed6d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aded32bec26d70281e5f134e10beda79b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#aded32bec26d70281e5f134e10beda79b">SetupSampleBinning</a> ()</td></tr>
<tr class="memdesc:aded32bec26d70281e5f134e10beda79b"><td class="mdescLeft">&#160;</td><td class="mdescRight">wrapper to call set binning functions based on sample config info  <a href="classSampleHandlerFD.html#aded32bec26d70281e5f134e10beda79b">More...</a><br /></td></tr>
<tr class="separator:aded32bec26d70281e5f134e10beda79b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7c4f1d9510cb3300c8612a95fb1238f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#af7c4f1d9510cb3300c8612a95fb1238f">SetupReweightArrays</a> (const size_t numberXBins, const size_t numberYBins)</td></tr>
<tr class="memdesc:af7c4f1d9510cb3300c8612a95fb1238f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise data, MC and W2 histograms.  <a href="classSampleHandlerFD.html#af7c4f1d9510cb3300c8612a95fb1238f">More...</a><br /></td></tr>
<tr class="separator:af7c4f1d9510cb3300c8612a95fb1238f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed15ee1f6209f26e55bb8e53108a9c6a"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#aed15ee1f6209f26e55bb8e53108a9c6a">SetupFunctionalParameters</a> ()</td></tr>
<tr class="memdesc:aed15ee1f6209f26e55bb8e53108a9c6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">ETA - a function to setup and pass values to functional parameters where you need to pass a value to some custom reweight calc or engine.  <a href="classSampleHandlerFD.html#aed15ee1f6209f26e55bb8e53108a9c6a">More...</a><br /></td></tr>
<tr class="separator:aed15ee1f6209f26e55bb8e53108a9c6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2626d0d48874d1aff1a107f62f1f02d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#aa2626d0d48874d1aff1a107f62f1f02d">RegisterIndividualFunctionalParameter</a> (const std::string &amp;fpName, int fpEnum, <a class="el" href="ParameterStructs_8h.html#a916ddc21f75755739f308b54dd06e0ae">FuncParFuncType</a> fpFunc)</td></tr>
<tr class="memdesc:aa2626d0d48874d1aff1a107f62f1f02d"><td class="mdescLeft">&#160;</td><td class="mdescRight">HH - a helper function for RegisterFunctionalParameter.  <a href="classSampleHandlerFD.html#aa2626d0d48874d1aff1a107f62f1f02d">More...</a><br /></td></tr>
<tr class="separator:aa2626d0d48874d1aff1a107f62f1f02d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5a809cfcd1e221ba0094b65f8e748f8"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ab5a809cfcd1e221ba0094b65f8e748f8">RegisterFunctionalParameters</a> ()=0</td></tr>
<tr class="memdesc:ab5a809cfcd1e221ba0094b65f8e748f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">HH - a experiment-specific function where the maps to actual functions are set up.  <a href="classSampleHandlerFD.html#ab5a809cfcd1e221ba0094b65f8e748f8">More...</a><br /></td></tr>
<tr class="separator:ab5a809cfcd1e221ba0094b65f8e748f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a691a4ec2c4c82b3c4437ead052644a54"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a691a4ec2c4c82b3c4437ead052644a54">PrepFunctionalParameters</a> ()</td></tr>
<tr class="memdesc:a691a4ec2c4c82b3c4437ead052644a54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the functional parameter values to the latest propsed values. Needs to be called before every new reweight so is called in fillArray.  <a href="classSampleHandlerFD.html#a691a4ec2c4c82b3c4437ead052644a54">More...</a><br /></td></tr>
<tr class="separator:a691a4ec2c4c82b3c4437ead052644a54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2894de183f70f36e5af4e12948a8507"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ad2894de183f70f36e5af4e12948a8507">ApplyShifts</a> (int iEvent)</td></tr>
<tr class="memdesc:ad2894de183f70f36e5af4e12948a8507"><td class="mdescLeft">&#160;</td><td class="mdescRight">ETA - generic function applying shifts.  <a href="classSampleHandlerFD.html#ad2894de183f70f36e5af4e12948a8507">More...</a><br /></td></tr>
<tr class="separator:ad2894de183f70f36e5af4e12948a8507"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ce3d6b9d9f6cce379fe1e8dd404369a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a1ce3d6b9d9f6cce379fe1e8dd404369a">IsEventSelected</a> (const int iEvent)</td></tr>
<tr class="memdesc:a1ce3d6b9d9f6cce379fe1e8dd404369a"><td class="mdescLeft">&#160;</td><td class="mdescRight">DB Function which determines if an event is selected, where Selection double looks like {{ND280KinematicTypes Var1, douuble LowBound}.  <a href="classSampleHandlerFD.html#a1ce3d6b9d9f6cce379fe1e8dd404369a">More...</a><br /></td></tr>
<tr class="separator:a1ce3d6b9d9f6cce379fe1e8dd404369a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06a5cccd7d178bd999dc1e4f3782e9b7"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a06a5cccd7d178bd999dc1e4f3782e9b7">resetShifts</a> (int iEvent)</td></tr>
<tr class="memdesc:a06a5cccd7d178bd999dc1e4f3782e9b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">HH - reset the shifted values to the original values.  <a href="classSampleHandlerFD.html#a06a5cccd7d178bd999dc1e4f3782e9b7">More...</a><br /></td></tr>
<tr class="separator:a06a5cccd7d178bd999dc1e4f3782e9b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d4ae325a527df590f54121d51dd0a16"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a5d4ae325a527df590f54121d51dd0a16">CalcNormsBins</a> (std::vector&lt; std::vector&lt; int &gt; &gt; &amp;xsec_norms_bins)</td></tr>
<tr class="memdesc:a5d4ae325a527df590f54121d51dd0a16"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether a normalisation systematic affects an event or not.  <a href="classSampleHandlerFD.html#a5d4ae325a527df590f54121d51dd0a16">More...</a><br /></td></tr>
<tr class="separator:a5d4ae325a527df590f54121d51dd0a16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab661c52bc446ed7a3ba19f90509ce110"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ab661c52bc446ed7a3ba19f90509ce110">CalcWeightSpline</a> (const <a class="el" href="structFarDetectorCoreInfo.html">FarDetectorCoreInfo</a> *MCEvent) const</td></tr>
<tr class="memdesc:ab661c52bc446ed7a3ba19f90509ce110"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the spline weight for a given event.  <a href="classSampleHandlerFD.html#ab661c52bc446ed7a3ba19f90509ce110">More...</a><br /></td></tr>
<tr class="separator:ab661c52bc446ed7a3ba19f90509ce110"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa412b194cece690a049f44e52ecdae38"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#aa412b194cece690a049f44e52ecdae38">CalcWeightNorm</a> (const <a class="el" href="structFarDetectorCoreInfo.html">FarDetectorCoreInfo</a> *MCEvent) const</td></tr>
<tr class="memdesc:aa412b194cece690a049f44e52ecdae38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the norm weight for a given event.  <a href="classSampleHandlerFD.html#aa412b194cece690a049f44e52ecdae38">More...</a><br /></td></tr>
<tr class="separator:aa412b194cece690a049f44e52ecdae38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1781ff483b5bae72103e9298109c4698"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a1781ff483b5bae72103e9298109c4698">CalcWeightFunc</a> (int iEvent)</td></tr>
<tr class="memdesc:a1781ff483b5bae72103e9298109c4698"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate weights for function parameters.  <a href="classSampleHandlerFD.html#a1781ff483b5bae72103e9298109c4698">More...</a><br /></td></tr>
<tr class="separator:a1781ff483b5bae72103e9298109c4698"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0f549802b5625871e11d86905989697"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ad0f549802b5625871e11d86905989697">ReturnKinematicParameter</a> (std::string KinematicParamter, int iEvent)=0</td></tr>
<tr class="memdesc:ad0f549802b5625871e11d86905989697"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the value of an assocaited kinematic parameter for an event.  <a href="classSampleHandlerFD.html#ad0f549802b5625871e11d86905989697">More...</a><br /></td></tr>
<tr class="separator:ad0f549802b5625871e11d86905989697"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0000225f48d985e8dd60bc94a1c0425"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ae0000225f48d985e8dd60bc94a1c0425">ReturnKinematicParameter</a> (int KinematicVariable, int iEvent)=0</td></tr>
<tr class="separator:ae0000225f48d985e8dd60bc94a1c0425"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7b638d6d2440fc6ac6ded45059bb8b4"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ac7b638d6d2440fc6ac6ded45059bb8b4">ReturnKinematicParameterBinning</a> (std::string KinematicParameter)=0</td></tr>
<tr class="memdesc:ac7b638d6d2440fc6ac6ded45059bb8b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the binning used to draw a kinematic parameter.  <a href="classSampleHandlerFD.html#ac7b638d6d2440fc6ac6ded45059bb8b4">More...</a><br /></td></tr>
<tr class="separator:ac7b638d6d2440fc6ac6ded45059bb8b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a889f8aeb4ab9e6b6441dabcc484c91c2"><td class="memItemLeft" align="right" valign="top">virtual const double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a889f8aeb4ab9e6b6441dabcc484c91c2">GetPointerToKinematicParameter</a> (std::string KinematicParamter, int iEvent)=0</td></tr>
<tr class="separator:a889f8aeb4ab9e6b6441dabcc484c91c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64100ff9107ef5ed40945063da3b6eda"><td class="memItemLeft" align="right" valign="top">virtual const double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a64100ff9107ef5ed40945063da3b6eda">GetPointerToKinematicParameter</a> (double KinematicVariable, int iEvent)=0</td></tr>
<tr class="separator:a64100ff9107ef5ed40945063da3b6eda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57a1fbb900f450168181af14d1336a21"><td class="memItemLeft" align="right" valign="top">const double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a57a1fbb900f450168181af14d1336a21">GetPointerToOscChannel</a> (const int iEvent) const</td></tr>
<tr class="separator:a57a1fbb900f450168181af14d1336a21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fa55fd1e82f8c4fccd5cd77b814f86a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a5fa55fd1e82f8c4fccd5cd77b814f86a">SetupNormParameters</a> ()</td></tr>
<tr class="separator:a5fa55fd1e82f8c4fccd5cd77b814f86a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3011ffe56e290c5e05781edfee00db43"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a3011ffe56e290c5e05781edfee00db43">Fill1DHist</a> () override</td></tr>
<tr class="memdesc:a3011ffe56e290c5e05781edfee00db43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill a 1D histogram with the event-level information used in the fit.  <a href="classSampleHandlerFD.html#a3011ffe56e290c5e05781edfee00db43">More...</a><br /></td></tr>
<tr class="separator:a3011ffe56e290c5e05781edfee00db43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a720a0aa689648040dfb8565658d82836"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a720a0aa689648040dfb8565658d82836">Fill2DHist</a> () override</td></tr>
<tr class="memdesc:a720a0aa689648040dfb8565658d82836"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill a 2D histogram with the event-level information used in the fit.  <a href="classSampleHandlerFD.html#a720a0aa689648040dfb8565658d82836">More...</a><br /></td></tr>
<tr class="separator:a720a0aa689648040dfb8565658d82836"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeef0f943cb1e0d4c9bba4814cb24a507"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#aeef0f943cb1e0d4c9bba4814cb24a507">FillArray</a> ()</td></tr>
<tr class="memdesc:aeef0f943cb1e0d4c9bba4814cb24a507"><td class="mdescLeft">&#160;</td><td class="mdescRight">DB Nice new multi-threaded function which calculates the event weights and fills the relevant bins of an array.  <a href="classSampleHandlerFD.html#aeef0f943cb1e0d4c9bba4814cb24a507">More...</a><br /></td></tr>
<tr class="separator:aeef0f943cb1e0d4c9bba4814cb24a507"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1f944f73f43a68be3af388cd17bc5e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ac1f944f73f43a68be3af388cd17bc5e3">ResetHistograms</a> ()</td></tr>
<tr class="memdesc:ac1f944f73f43a68be3af388cd17bc5e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to reset histograms.  <a href="classSampleHandlerFD.html#ac1f944f73f43a68be3af388cd17bc5e3">More...</a><br /></td></tr>
<tr class="separator:ac1f944f73f43a68be3af388cd17bc5e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf6d02ac82328fdfd6487e3989e3d383"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#aaf6d02ac82328fdfd6487e3989e3d383">InitialiseSingleFDMCObject</a> ()</td></tr>
<tr class="memdesc:aaf6d02ac82328fdfd6487e3989e3d383"><td class="mdescLeft">&#160;</td><td class="mdescRight">function to create the member of the FarDetectorInfo struct so they are the appropriate size.  <a href="classSampleHandlerFD.html#aaf6d02ac82328fdfd6487e3989e3d383">More...</a><br /></td></tr>
<tr class="separator:aaf6d02ac82328fdfd6487e3989e3d383"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2918509fadc1dac47d423f161b619cc4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a2918509fadc1dac47d423f161b619cc4">InitialiseSplineObject</a> ()</td></tr>
<tr class="separator:a2918509fadc1dac47d423f161b619cc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classSampleHandlerBase"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classSampleHandlerBase')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classSampleHandlerBase.html">SampleHandlerBase</a></td></tr>
<tr class="memitem:ad1e91b3accfd9269e794f43aa7f9b979 inherit pro_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#ad1e91b3accfd9269e794f43aa7f9b979">QuietPlease</a> ()</td></tr>
<tr class="memdesc:ad1e91b3accfd9269e794f43aa7f9b979 inherit pro_methods_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Redirect std::cout to silence some experiment specific libraries.  <a href="classSampleHandlerBase.html#ad1e91b3accfd9269e794f43aa7f9b979">More...</a><br /></td></tr>
<tr class="separator:ad1e91b3accfd9269e794f43aa7f9b979 inherit pro_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2da39aacd5ba10a3a745d546eccb859f inherit pro_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a2da39aacd5ba10a3a745d546eccb859f">NowTalk</a> ()</td></tr>
<tr class="memdesc:a2da39aacd5ba10a3a745d546eccb859f inherit pro_methods_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Redirect std::cout to silence some experiment specific libraries.  <a href="classSampleHandlerBase.html#a2da39aacd5ba10a3a745d546eccb859f">More...</a><br /></td></tr>
<tr class="separator:a2da39aacd5ba10a3a745d546eccb859f inherit pro_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad16c838d4dc86e98445f199a16cf9bdf inherit pro_methods_classSampleHandlerBase"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ad16c838d4dc86e98445f199a16cf9bdf inherit pro_methods_classSampleHandlerBase"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#ad16c838d4dc86e98445f199a16cf9bdf">MatchCondition</a> (const std::vector&lt; T &gt; &amp;allowedValues, const T &amp;value)</td></tr>
<tr class="memdesc:ad16c838d4dc86e98445f199a16cf9bdf inherit pro_methods_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">check if event is affected by following conditions, for example pdg, or modes etc  <a href="classSampleHandlerBase.html#ad16c838d4dc86e98445f199a16cf9bdf">More...</a><br /></td></tr>
<tr class="separator:ad16c838d4dc86e98445f199a16cf9bdf inherit pro_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a17193b3fe2b44e6484f9eefda86f97dd"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classBinnedSplineHandler.html">BinnedSplineHandler</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">SplineHandler</a></td></tr>
<tr class="memdesc:a17193b3fe2b44e6484f9eefda86f97dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contains all your binned splines and handles the setup and the returning of weights from spline evaluations.  <a href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">More...</a><br /></td></tr>
<tr class="separator:a17193b3fe2b44e6484f9eefda86f97dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7115dd53d73a45fb64c565561095b6a"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classOscillationHandler.html">OscillationHandler</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">Oscillator</a></td></tr>
<tr class="memdesc:aa7115dd53d73a45fb64c565561095b6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contains all your binned splines and handles the setup and the returning of weights from spline evaluations.  <a href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">More...</a><br /></td></tr>
<tr class="separator:aa7115dd53d73a45fb64c565561095b6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cd052288a69d57c215088e666fa4be3"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a5cd052288a69d57c215088e666fa4be3">XVarStr</a></td></tr>
<tr class="memdesc:a5cd052288a69d57c215088e666fa4be3"><td class="mdescLeft">&#160;</td><td class="mdescRight">the strings associated with the variables used for the binning e.g. "RecoNeutrinoEnergy"  <a href="classSampleHandlerFD.html#a5cd052288a69d57c215088e666fa4be3">More...</a><br /></td></tr>
<tr class="separator:a5cd052288a69d57c215088e666fa4be3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fda7dea41c730724a5b3e171a572378"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a8fda7dea41c730724a5b3e171a572378">YVarStr</a></td></tr>
<tr class="separator:a8fda7dea41c730724a5b3e171a572378"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d4d75bc7d6611e0eab5501311bd38f0"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a0d4d75bc7d6611e0eab5501311bd38f0">SplineVarNames</a></td></tr>
<tr class="separator:a0d4d75bc7d6611e0eab5501311bd38f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e0ad070b2d5c389350709110ad7e193"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a8e0ad070b2d5c389350709110ad7e193">SampleXBins</a></td></tr>
<tr class="memdesc:a8e0ad070b2d5c389350709110ad7e193"><td class="mdescLeft">&#160;</td><td class="mdescRight">vector of the binning used in axis 1 (the x-axis)  <a href="classSampleHandlerFD.html#a8e0ad070b2d5c389350709110ad7e193">More...</a><br /></td></tr>
<tr class="separator:a8e0ad070b2d5c389350709110ad7e193"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7da646b34085605653acb7965068c4a5"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a7da646b34085605653acb7965068c4a5">SampleYBins</a></td></tr>
<tr class="memdesc:a7da646b34085605653acb7965068c4a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">vector of the binning used in axis 2 (the y-axis)  <a href="classSampleHandlerFD.html#a7da646b34085605653acb7965068c4a5">More...</a><br /></td></tr>
<tr class="separator:a7da646b34085605653acb7965068c4a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02254668e1d1e4417dfd38e416e46bf8"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structFunctionalParameter.html">FunctionalParameter</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a02254668e1d1e4417dfd38e416e46bf8">funcParsVec</a></td></tr>
<tr class="memdesc:a02254668e1d1e4417dfd38e416e46bf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">HH - a vector that stores all the FuncPars struct.  <a href="classSampleHandlerFD.html#a02254668e1d1e4417dfd38e416e46bf8">More...</a><br /></td></tr>
<tr class="separator:a02254668e1d1e4417dfd38e416e46bf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8ed9895a0b2802e45569ce2d1a0a837"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; std::string, int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">funcParsNamesMap</a></td></tr>
<tr class="memdesc:af8ed9895a0b2802e45569ce2d1a0a837"><td class="mdescLeft">&#160;</td><td class="mdescRight">HH - a map that relates the name of the functional parameter to funcpar enum.  <a href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">More...</a><br /></td></tr>
<tr class="separator:af8ed9895a0b2802e45569ce2d1a0a837"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06eab1b725605a68cdb75e3826122c47"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structFunctionalParameter.html">FunctionalParameter</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a06eab1b725605a68cdb75e3826122c47">funcParsMap</a></td></tr>
<tr class="memdesc:a06eab1b725605a68cdb75e3826122c47"><td class="mdescLeft">&#160;</td><td class="mdescRight">HH - a map that relates the funcpar enum to pointer of FuncPars struct.  <a href="classSampleHandlerFD.html#a06eab1b725605a68cdb75e3826122c47">More...</a><br /></td></tr>
<tr class="separator:a06eab1b725605a68cdb75e3826122c47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a577a57992e396a5b34efcd3bb6ed45cf"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; int, <a class="el" href="ParameterStructs_8h.html#a916ddc21f75755739f308b54dd06e0ae">FuncParFuncType</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a577a57992e396a5b34efcd3bb6ed45cf">funcParsFuncMap</a></td></tr>
<tr class="memdesc:a577a57992e396a5b34efcd3bb6ed45cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">HH - a map that relates the funcpar enum to pointer of the actual function.  <a href="classSampleHandlerFD.html#a577a57992e396a5b34efcd3bb6ed45cf">More...</a><br /></td></tr>
<tr class="separator:a577a57992e396a5b34efcd3bb6ed45cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00060ee2bbc0e3e5528932705ce690e6"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a00060ee2bbc0e3e5528932705ce690e6">funcParsGrid</a></td></tr>
<tr class="memdesc:a00060ee2bbc0e3e5528932705ce690e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">HH - a grid of vectors of enums for each sample and event.  <a href="classSampleHandlerFD.html#a00060ee2bbc0e3e5528932705ce690e6">More...</a><br /></td></tr>
<tr class="separator:a00060ee2bbc0e3e5528932705ce690e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a888112d7eebd6fdb877c0015e1951f9d"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a888112d7eebd6fdb877c0015e1951f9d">funcParsNamesVec</a> = {}</td></tr>
<tr class="memdesc:a888112d7eebd6fdb877c0015e1951f9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">HH - a vector of string names for each functional parameter.  <a href="classSampleHandlerFD.html#a888112d7eebd6fdb877c0015e1951f9d">More...</a><br /></td></tr>
<tr class="separator:a888112d7eebd6fdb877c0015e1951f9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d79462d4aab26cdb603b45addff173a"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">XBinEdges</a></td></tr>
<tr class="memdesc:a1d79462d4aab26cdb603b45addff173a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector to hold x-axis bin-edges.  <a href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">More...</a><br /></td></tr>
<tr class="separator:a1d79462d4aab26cdb603b45addff173a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8e54b8d677e132f8d7237495f6fb755"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a></td></tr>
<tr class="memdesc:ac8e54b8d677e132f8d7237495f6fb755"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector to hold y-axis bin-edges.  <a href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">More...</a><br /></td></tr>
<tr class="separator:ac8e54b8d677e132f8d7237495f6fb755"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab933df667fbccf97b3028297ddd8eae2"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ab933df667fbccf97b3028297ddd8eae2">nXBins</a></td></tr>
<tr class="memdesc:ab933df667fbccf97b3028297ddd8eae2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of X axis bins in the histogram used for likelihood calculation.  <a href="classSampleHandlerFD.html#ab933df667fbccf97b3028297ddd8eae2">More...</a><br /></td></tr>
<tr class="separator:ab933df667fbccf97b3028297ddd8eae2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae48ed0755671be986cb04690b4fa6959"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ae48ed0755671be986cb04690b4fa6959">nYBins</a></td></tr>
<tr class="memdesc:ae48ed0755671be986cb04690b4fa6959"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of Y axis bins in the histogram used for likelihood calculation.  <a href="classSampleHandlerFD.html#ae48ed0755671be986cb04690b4fa6959">More...</a><br /></td></tr>
<tr class="separator:ae48ed0755671be986cb04690b4fa6959"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab040097a0524dd6aa6cad01c991b5ce"><td class="memItemLeft" align="right" valign="top">double **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#aab040097a0524dd6aa6cad01c991b5ce">SampleHandlerFD_array</a></td></tr>
<tr class="memdesc:aab040097a0524dd6aa6cad01c991b5ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">DB Array to be filled after reweighting.  <a href="classSampleHandlerFD.html#aab040097a0524dd6aa6cad01c991b5ce">More...</a><br /></td></tr>
<tr class="separator:aab040097a0524dd6aa6cad01c991b5ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3905ae0e2531525dba5d663110f86527"><td class="memItemLeft" align="right" valign="top">double **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a3905ae0e2531525dba5d663110f86527">SampleHandlerFD_array_w2</a></td></tr>
<tr class="memdesc:a3905ae0e2531525dba5d663110f86527"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS Array used for MC stat.  <a href="classSampleHandlerFD.html#a3905ae0e2531525dba5d663110f86527">More...</a><br /></td></tr>
<tr class="separator:a3905ae0e2531525dba5d663110f86527"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adce8040b6fe6501aa4833bbb5ca1163f"><td class="memItemLeft" align="right" valign="top">double **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#adce8040b6fe6501aa4833bbb5ca1163f">SampleHandlerFD_data</a></td></tr>
<tr class="memdesc:adce8040b6fe6501aa4833bbb5ca1163f"><td class="mdescLeft">&#160;</td><td class="mdescRight">DB Array to be filled in AddData.  <a href="classSampleHandlerFD.html#adce8040b6fe6501aa4833bbb5ca1163f">More...</a><br /></td></tr>
<tr class="separator:adce8040b6fe6501aa4833bbb5ca1163f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af779913cecbf20c194010aa540ac78c8"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structFarDetectorCoreInfo.html">FarDetectorCoreInfo</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a></td></tr>
<tr class="separator:af779913cecbf20c194010aa540ac78c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57f378f84f66caa817e52c0bfb5ff0be"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structOscChannelInfo.html">OscChannelInfo</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a57f378f84f66caa817e52c0bfb5ff0be">OscChannels</a></td></tr>
<tr class="separator:a57f378f84f66caa817e52c0bfb5ff0be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1db89c4df22a237b1cb26a2b55ee0866"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classParameterHandlerGeneric.html">ParameterHandlerGeneric</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a1db89c4df22a237b1cb26a2b55ee0866">ParHandler</a> = nullptr</td></tr>
<tr class="separator:a1db89c4df22a237b1cb26a2b55ee0866"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af118f92cdc227715e60ca7d76778508f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classParameterHandlerOsc.html">ParameterHandlerOsc</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#af118f92cdc227715e60ca7d76778508f">OscParHandler</a> = nullptr</td></tr>
<tr class="separator:af118f92cdc227715e60ca7d76778508f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af03bf91649d1848a3e531ff7f865c313"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#af03bf91649d1848a3e531ff7f865c313">nDimensions</a> = <a class="el" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a></td></tr>
<tr class="memdesc:af03bf91649d1848a3e531ff7f865c313"><td class="mdescLeft">&#160;</td><td class="mdescRight">Keep track of the dimensions of the sample binning.  <a href="classSampleHandlerFD.html#af03bf91649d1848a3e531ff7f865c313">More...</a><br /></td></tr>
<tr class="separator:af03bf91649d1848a3e531ff7f865c313"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc09fc72a5d00762fa023ab617f9a54d"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#afc09fc72a5d00762fa023ab617f9a54d">SampleName</a></td></tr>
<tr class="memdesc:afc09fc72a5d00762fa023ab617f9a54d"><td class="mdescLeft">&#160;</td><td class="mdescRight">A unique ID for each sample based on powers of two for quick binary operator comparisons.  <a href="classSampleHandlerFD.html#afc09fc72a5d00762fa023ab617f9a54d">More...</a><br /></td></tr>
<tr class="separator:afc09fc72a5d00762fa023ab617f9a54d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ebc5e194703ef6b9d3c7e4994417d60"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a1ebc5e194703ef6b9d3c7e4994417d60">SampleTitle</a></td></tr>
<tr class="memdesc:a1ebc5e194703ef6b9d3c7e4994417d60"><td class="mdescLeft">&#160;</td><td class="mdescRight">the name of this sample e.g."muon-like"  <a href="classSampleHandlerFD.html#a1ebc5e194703ef6b9d3c7e4994417d60">More...</a><br /></td></tr>
<tr class="separator:a1ebc5e194703ef6b9d3c7e4994417d60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bbc930a955e5171d15324d6b2e55f81"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structNormParameter.html">NormParameter</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a5bbc930a955e5171d15324d6b2e55f81">norm_parameters</a></td></tr>
<tr class="memdesc:a5bbc930a955e5171d15324d6b2e55f81"><td class="mdescLeft">&#160;</td><td class="mdescRight">Information to store for normalisation pars.  <a href="classSampleHandlerFD.html#a5bbc930a955e5171d15324d6b2e55f81">More...</a><br /></td></tr>
<tr class="separator:a5bbc930a955e5171d15324d6b2e55f81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a402634a2a3f7520228b50bf208c00e78"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a402634a2a3f7520228b50bf208c00e78">StoredSelection</a></td></tr>
<tr class="memdesc:a402634a2a3f7520228b50bf208c00e78"><td class="mdescLeft">&#160;</td><td class="mdescRight">What gets pulled from config options, these are constant after loading in this is of length 3: 0th index is the value, 1st is lower bound, 2nd is upper bound.  <a href="classSampleHandlerFD.html#a402634a2a3f7520228b50bf208c00e78">More...</a><br /></td></tr>
<tr class="separator:a402634a2a3f7520228b50bf208c00e78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe55d06685c38b03a10134019b1aca06"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#abe55d06685c38b03a10134019b1aca06">SelectionStr</a></td></tr>
<tr class="memdesc:abe55d06685c38b03a10134019b1aca06"><td class="mdescLeft">&#160;</td><td class="mdescRight">the strings grabbed from the sample config specifying the selections  <a href="classSampleHandlerFD.html#abe55d06685c38b03a10134019b1aca06">More...</a><br /></td></tr>
<tr class="separator:abe55d06685c38b03a10134019b1aca06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b0a7ada3c931e66211eebd91de0c0d0"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a2b0a7ada3c931e66211eebd91de0c0d0">Selection</a></td></tr>
<tr class="memdesc:a2b0a7ada3c931e66211eebd91de0c0d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">a way to store selection cuts which you may push back in the get1DVar functions most of the time this is just the same as StoredSelection  <a href="classSampleHandlerFD.html#a2b0a7ada3c931e66211eebd91de0c0d0">More...</a><br /></td></tr>
<tr class="separator:a2b0a7ada3c931e66211eebd91de0c0d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae37732e76f0b17b6f124bd5543177e4"><td class="memItemLeft" align="right" valign="top">const std::unordered_map&lt; std::string, int &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#aae37732e76f0b17b6f124bd5543177e4">KinematicParameters</a></td></tr>
<tr class="memdesc:aae37732e76f0b17b6f124bd5543177e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mapping between string and kinematic enum.  <a href="classSampleHandlerFD.html#aae37732e76f0b17b6f124bd5543177e4">More...</a><br /></td></tr>
<tr class="separator:aae37732e76f0b17b6f124bd5543177e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7ac675cc4ce81bec42e0700f1ff2620"><td class="memItemLeft" align="right" valign="top">const std::unordered_map&lt; int, std::string &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ad7ac675cc4ce81bec42e0700f1ff2620">ReversedKinematicParameters</a></td></tr>
<tr class="memdesc:ad7ac675cc4ce81bec42e0700f1ff2620"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mapping between kinematic enum and string.  <a href="classSampleHandlerFD.html#ad7ac675cc4ce81bec42e0700f1ff2620">More...</a><br /></td></tr>
<tr class="separator:ad7ac675cc4ce81bec42e0700f1ff2620"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ccc0e26810ded77d0615e95e8a9b277"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classmanager.html">manager</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a></td></tr>
<tr class="memdesc:a9ccc0e26810ded77d0615e95e8a9b277"><td class="mdescLeft">&#160;</td><td class="mdescRight">The manager object used to read the sample yaml file.  <a href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">More...</a><br /></td></tr>
<tr class="separator:a9ccc0e26810ded77d0615e95e8a9b277"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd686fdebead1a699d9bad4a1bebaa8f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#abd686fdebead1a699d9bad4a1bebaa8f">mc_files</a></td></tr>
<tr class="separator:abd686fdebead1a699d9bad4a1bebaa8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a02e96c7d7731097c7c10660d23b3a5"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a4a02e96c7d7731097c7c10660d23b3a5">spline_files</a></td></tr>
<tr class="separator:a4a02e96c7d7731097c7c10660d23b3a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad625af417f4445b9b14710ca3bdc409d"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; std::string, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ad625af417f4445b9b14710ca3bdc409d">_modeNomWeightMap</a></td></tr>
<tr class="separator:ad625af417f4445b9b14710ca3bdc409d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af60df24f4eb7954a3297c9841c60624b"><td class="memItemLeft" align="right" valign="top">TLegend *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">THStackLeg</a> = nullptr</td></tr>
<tr class="memdesc:af60df24f4eb7954a3297c9841c60624b"><td class="mdescLeft">&#160;</td><td class="mdescRight">DB Miscellaneous Variables.  <a href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">More...</a><br /></td></tr>
<tr class="separator:af60df24f4eb7954a3297c9841c60624b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ff1ef7d99cee6d6a9fba74296d4d0ea"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a1ff1ef7d99cee6d6a9fba74296d4d0ea">FirstTimeW2</a></td></tr>
<tr class="memdesc:a1ff1ef7d99cee6d6a9fba74296d4d0ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS:Super hacky to update W2 or not.  <a href="classSampleHandlerFD.html#a1ff1ef7d99cee6d6a9fba74296d4d0ea">More...</a><br /></td></tr>
<tr class="separator:a1ff1ef7d99cee6d6a9fba74296d4d0ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa654562842a0da51ff917aaed517310e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#aa654562842a0da51ff917aaed517310e">UpdateW2</a></td></tr>
<tr class="memdesc:aa654562842a0da51ff917aaed517310e"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS:Super hacky to update W2 or not.  <a href="classSampleHandlerFD.html#aa654562842a0da51ff917aaed517310e">More...</a><br /></td></tr>
<tr class="separator:aa654562842a0da51ff917aaed517310e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classSampleHandlerBase"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classSampleHandlerBase')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classSampleHandlerBase.html">SampleHandlerBase</a></td></tr>
<tr class="memitem:a87670dbcda5d09b09675e8f407fe3a30 inherit pro_attribs_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67">TestStatistic</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a87670dbcda5d09b09675e8f407fe3a30">fTestStatistic</a></td></tr>
<tr class="memdesc:a87670dbcda5d09b09675e8f407fe3a30 inherit pro_attribs_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test statistic tells what kind of likelihood sample is using.  <a href="classSampleHandlerBase.html#a87670dbcda5d09b09675e8f407fe3a30">More...</a><br /></td></tr>
<tr class="separator:a87670dbcda5d09b09675e8f407fe3a30 inherit pro_attribs_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47d291148fa6153a7e05beebde6cfdb9 inherit pro_attribs_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">std::streambuf *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a47d291148fa6153a7e05beebde6cfdb9">buf</a></td></tr>
<tr class="memdesc:a47d291148fa6153a7e05beebde6cfdb9 inherit pro_attribs_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Keep the cout buffer.  <a href="classSampleHandlerBase.html#a47d291148fa6153a7e05beebde6cfdb9">More...</a><br /></td></tr>
<tr class="separator:a47d291148fa6153a7e05beebde6cfdb9 inherit pro_attribs_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b884367733c4f3a93c75127ed6e9df9 inherit pro_attribs_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">std::streambuf *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a6b884367733c4f3a93c75127ed6e9df9">errbuf</a></td></tr>
<tr class="memdesc:a6b884367733c4f3a93c75127ed6e9df9 inherit pro_attribs_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Keep the cerr buffer.  <a href="classSampleHandlerBase.html#a6b884367733c4f3a93c75127ed6e9df9">More...</a><br /></td></tr>
<tr class="separator:a6b884367733c4f3a93c75127ed6e9df9 inherit pro_attribs_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7a13af22c2314c718fb6438d493d3d1 inherit pro_attribs_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#aa7a13af22c2314c718fb6438d493d3d1">nSamples</a></td></tr>
<tr class="memdesc:aa7a13af22c2314c718fb6438d493d3d1 inherit pro_attribs_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contains how many samples we've got.  <a href="classSampleHandlerBase.html#aa7a13af22c2314c718fb6438d493d3d1">More...</a><br /></td></tr>
<tr class="separator:aa7a13af22c2314c718fb6438d493d3d1 inherit pro_attribs_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a162e3e8fddeef43d1137875b660f897b inherit pro_attribs_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a162e3e8fddeef43d1137875b660f897b">nDims</a></td></tr>
<tr class="memdesc:a162e3e8fddeef43d1137875b660f897b inherit pro_attribs_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: number of dimension for this sample.  <a href="classSampleHandlerBase.html#a162e3e8fddeef43d1137875b660f897b">More...</a><br /></td></tr>
<tr class="separator:a162e3e8fddeef43d1137875b660f897b inherit pro_attribs_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab497b52d94868283a8a7cedbd1a4d777 inherit pro_attribs_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#ab497b52d94868283a8a7cedbd1a4d777">nEvents</a></td></tr>
<tr class="memdesc:ab497b52d94868283a8a7cedbd1a4d777 inherit pro_attribs_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of MC events are there.  <a href="classSampleHandlerBase.html#ab497b52d94868283a8a7cedbd1a4d777">More...</a><br /></td></tr>
<tr class="separator:ab497b52d94868283a8a7cedbd1a4d777 inherit pro_attribs_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9f61ca5c8abb03d4d84947e9bfa7943 inherit pro_attribs_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMaCh3Modes.html">MaCh3Modes</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#ab9f61ca5c8abb03d4d84947e9bfa7943">Modes</a></td></tr>
<tr class="memdesc:ab9f61ca5c8abb03d4d84947e9bfa7943 inherit pro_attribs_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds information about used Generator and MaCh3 modes.  <a href="classSampleHandlerBase.html#ab9f61ca5c8abb03d4d84947e9bfa7943">More...</a><br /></td></tr>
<tr class="separator:ab9f61ca5c8abb03d4d84947e9bfa7943 inherit pro_attribs_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7938f32b145ce648d3ce4ae33bc9d560 inherit pro_attribs_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">TH1D *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a7938f32b145ce648d3ce4ae33bc9d560">dathist</a></td></tr>
<tr class="separator:a7938f32b145ce648d3ce4ae33bc9d560 inherit pro_attribs_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7ed25798bc8d52dc16b5ea2f6c9d0c3 inherit pro_attribs_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">TH2D *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#aa7ed25798bc8d52dc16b5ea2f6c9d0c3">dathist2d</a></td></tr>
<tr class="separator:aa7ed25798bc8d52dc16b5ea2f6c9d0c3 inherit pro_attribs_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcc9b928dce6e7dddf761f0c13e7b409 inherit pro_attribs_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">TH1D *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#adcc9b928dce6e7dddf761f0c13e7b409">_hPDF1D</a></td></tr>
<tr class="separator:adcc9b928dce6e7dddf761f0c13e7b409 inherit pro_attribs_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd5728e1c6a21b870ec0a5567bd18389 inherit pro_attribs_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">TH2D *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">_hPDF2D</a></td></tr>
<tr class="separator:abd5728e1c6a21b870ec0a5567bd18389 inherit pro_attribs_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class responsible for handling implementation of samples used in analysis, reweighting and returning LLH. </p>
<dl class="section author"><dt>Author</dt><dd>Dan Barrow </dd>
<dd>
Ed Atkin </dd></dl>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00019">19</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="abc6513dc1e3301ac7fcc611fc3779198"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc6513dc1e3301ac7fcc611fc3779198">&#9670;&nbsp;</a></span>SampleHandlerFD()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SampleHandlerFD::SampleHandlerFD </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>ConfigFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classParameterHandlerGeneric.html">ParameterHandlerGeneric</a> *&#160;</td>
          <td class="paramname"><em>xsec_cov</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classParameterHandlerOsc.html">ParameterHandlerOsc</a> *&#160;</td>
          <td class="paramname"><em>osc_cov</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classOscillationHandler.html">OscillationHandler</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>OscillatorObj_</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ConfigFileName</td><td>Name of config to initialise the sample object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00010">10</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;                                                                                                                        : <a class="code" href="classSampleHandlerBase.html#a6a6d7e5d275154ed550cd6c9dfc36000">SampleHandlerBase</a>() {</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;-------------------------------------------------------------------&quot;</span>);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Creating SampleHandlerFD object&quot;</span>);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <span class="comment">//ETA - safety feature so you can&#39;t pass a NULL xsec_cov</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <span class="keywordflow">if</span>(!xsec_cov){</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;You&#39;ve passed me a nullptr to a SystematicHandlerGeneric... I need this to setup splines!&quot;</span>);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  }</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a1db89c4df22a237b1cb26a2b55ee0866">ParHandler</a> = xsec_cov;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <a class="code" href="classSampleHandlerBase.html#aa7a13af22c2314c718fb6438d493d3d1">nSamples</a> = 1;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keywordflow">if</span>(!osc_cov){</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;You have passed a nullptr to a covarianceOsc, this means I will not calculate oscillation weights&quot;</span>);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  }</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <a class="code" href="classSampleHandlerFD.html#af118f92cdc227715e60ca7d76778508f">OscParHandler</a> = osc_cov;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordflow">if</span> (OscillatorObj_ != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;You have passed an Oscillator object through the constructor of a SampleHandlerFD object - this will be used for all oscillation channels&quot;</span>);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">Oscillator</a> = OscillatorObj_;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  }</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <a class="code" href="classSampleHandlerFD.html#aae37732e76f0b17b6f124bd5543177e4">KinematicParameters</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <a class="code" href="classSampleHandlerFD.html#ad7ac675cc4ce81bec42e0700f1ff2620">ReversedKinematicParameters</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <a class="code" href="classSampleHandlerFD.html#aab040097a0524dd6aa6cad01c991b5ce">SampleHandlerFD_array</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <a class="code" href="classSampleHandlerFD.html#adce8040b6fe6501aa4833bbb5ca1163f">SampleHandlerFD_data</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a3905ae0e2531525dba5d663110f86527">SampleHandlerFD_array_w2</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <a class="code" href="classSampleHandlerFD.html#afc09fc72a5d00762fa023ab617f9a54d">SampleName</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a> = std::unique_ptr&lt;manager&gt;(<span class="keyword">new</span> <a class="code" href="classmanager.html">manager</a>(ConfigFileName.c_str()));</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="comment">// Variables related to MC stat</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a1ff1ef7d99cee6d6a9fba74296d4d0ea">FirstTimeW2</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="classSampleHandlerFD.html#aa654562842a0da51ff917aaed517310e">UpdateW2</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a61052119a625282d0ec6d4a97adf3ee2"><div class="ttname"><a href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a></div><div class="ttdeci">#define MACH3LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00025">MaCh3Logger.h:25</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_a95fa4dffc648e4c5536c9292c2bdcac3"><div class="ttname"><a href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a></div><div class="ttdeci">#define MACH3LOG_INFO</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00023">MaCh3Logger.h:23</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_ad5b2eb6377721e3ac95def22c2386bb1"><div class="ttname"><a href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a></div><div class="ttdeci">#define MACH3LOG_WARN</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00024">MaCh3Logger.h:24</a></div></div>
<div class="ttc" id="aclassMaCh3Exception_html"><div class="ttname"><a href="classMaCh3Exception.html">MaCh3Exception</a></div><div class="ttdoc">Custom exception class for MaCh3 errors.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Exception_8h_source.html#l00013">MaCh3Exception.h:13</a></div></div>
<div class="ttc" id="aclassSampleHandlerBase_html_a6a6d7e5d275154ed550cd6c9dfc36000"><div class="ttname"><a href="classSampleHandlerBase.html#a6a6d7e5d275154ed550cd6c9dfc36000">SampleHandlerBase::SampleHandlerBase</a></div><div class="ttdeci">SampleHandlerBase()</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8cpp_source.html#l00003">SampleHandlerBase.cpp:3</a></div></div>
<div class="ttc" id="aclassSampleHandlerBase_html_aa7a13af22c2314c718fb6438d493d3d1"><div class="ttname"><a href="classSampleHandlerBase.html#aa7a13af22c2314c718fb6438d493d3d1">SampleHandlerBase::nSamples</a></div><div class="ttdeci">M3::int_t nSamples</div><div class="ttdoc">Contains how many samples we've got.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00132">SampleHandlerBase.h:132</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a1db89c4df22a237b1cb26a2b55ee0866"><div class="ttname"><a href="classSampleHandlerFD.html#a1db89c4df22a237b1cb26a2b55ee0866">SampleHandlerFD::ParHandler</a></div><div class="ttdeci">ParameterHandlerGeneric * ParHandler</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00308">SampleHandlerFD.h:308</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a1ff1ef7d99cee6d6a9fba74296d4d0ea"><div class="ttname"><a href="classSampleHandlerFD.html#a1ff1ef7d99cee6d6a9fba74296d4d0ea">SampleHandlerFD::FirstTimeW2</a></div><div class="ttdeci">bool FirstTimeW2</div><div class="ttdoc">KS:Super hacky to update W2 or not.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00362">SampleHandlerFD.h:362</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a3905ae0e2531525dba5d663110f86527"><div class="ttname"><a href="classSampleHandlerFD.html#a3905ae0e2531525dba5d663110f86527">SampleHandlerFD::SampleHandlerFD_array_w2</a></div><div class="ttdeci">double ** SampleHandlerFD_array_w2</div><div class="ttdoc">KS Array used for MC stat.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00293">SampleHandlerFD.h:293</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a9ccc0e26810ded77d0615e95e8a9b277"><div class="ttname"><a href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleHandlerFD::SampleManager</a></div><div class="ttdeci">std::unique_ptr&lt; manager &gt; SampleManager</div><div class="ttdoc">The manager object used to read the sample yaml file.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00345">SampleHandlerFD.h:345</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_aa654562842a0da51ff917aaed517310e"><div class="ttname"><a href="classSampleHandlerFD.html#aa654562842a0da51ff917aaed517310e">SampleHandlerFD::UpdateW2</a></div><div class="ttdeci">bool UpdateW2</div><div class="ttdoc">KS:Super hacky to update W2 or not.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00364">SampleHandlerFD.h:364</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_aa7115dd53d73a45fb64c565561095b6a"><div class="ttname"><a href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">SampleHandlerFD::Oscillator</a></div><div class="ttdeci">std::shared_ptr&lt; OscillationHandler &gt; Oscillator</div><div class="ttdoc">Contains all your binned splines and handles the setup and the returning of weights from spline evalu...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00144">SampleHandlerFD.h:144</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_aab040097a0524dd6aa6cad01c991b5ce"><div class="ttname"><a href="classSampleHandlerFD.html#aab040097a0524dd6aa6cad01c991b5ce">SampleHandlerFD::SampleHandlerFD_array</a></div><div class="ttdeci">double ** SampleHandlerFD_array</div><div class="ttdoc">DB Array to be filled after reweighting.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00291">SampleHandlerFD.h:291</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_aae37732e76f0b17b6f124bd5543177e4"><div class="ttname"><a href="classSampleHandlerFD.html#aae37732e76f0b17b6f124bd5543177e4">SampleHandlerFD::KinematicParameters</a></div><div class="ttdeci">const std::unordered_map&lt; std::string, int &gt; * KinematicParameters</div><div class="ttdoc">Mapping between string and kinematic enum.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00340">SampleHandlerFD.h:340</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ad7ac675cc4ce81bec42e0700f1ff2620"><div class="ttname"><a href="classSampleHandlerFD.html#ad7ac675cc4ce81bec42e0700f1ff2620">SampleHandlerFD::ReversedKinematicParameters</a></div><div class="ttdeci">const std::unordered_map&lt; int, std::string &gt; * ReversedKinematicParameters</div><div class="ttdoc">Mapping between kinematic enum and string.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00342">SampleHandlerFD.h:342</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_adce8040b6fe6501aa4833bbb5ca1163f"><div class="ttname"><a href="classSampleHandlerFD.html#adce8040b6fe6501aa4833bbb5ca1163f">SampleHandlerFD::SampleHandlerFD_data</a></div><div class="ttdeci">double ** SampleHandlerFD_data</div><div class="ttdoc">DB Array to be filled in AddData.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00295">SampleHandlerFD.h:295</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_af118f92cdc227715e60ca7d76778508f"><div class="ttname"><a href="classSampleHandlerFD.html#af118f92cdc227715e60ca7d76778508f">SampleHandlerFD::OscParHandler</a></div><div class="ttdeci">ParameterHandlerOsc * OscParHandler</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00309">SampleHandlerFD.h:309</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_afc09fc72a5d00762fa023ab617f9a54d"><div class="ttname"><a href="classSampleHandlerFD.html#afc09fc72a5d00762fa023ab617f9a54d">SampleHandlerFD::SampleName</a></div><div class="ttdeci">std::string SampleName</div><div class="ttdoc">A unique ID for each sample based on powers of two for quick binary operator comparisons.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00316">SampleHandlerFD.h:316</a></div></div>
<div class="ttc" id="aclassmanager_html"><div class="ttname"><a href="classmanager.html">manager</a></div><div class="ttdoc">The manager class is responsible for managing configurations and settings.</div><div class="ttdef"><b>Definition:</b> <a href="Manager_8h_source.html#l00016">Manager.h:16</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7aa8473194b5afccfbf453392b49e580"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7aa8473194b5afccfbf453392b49e580">&#9670;&nbsp;</a></span>~SampleHandlerFD()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SampleHandlerFD::~SampleHandlerFD </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>destructor </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00048">48</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;{</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a>(<span class="stringliteral">&quot;I&#39;m deleting SampleHandlerFD&quot;</span>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> yBin=0;yBin&lt;(<a class="code" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a>.size()-1);yBin++) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#aab040097a0524dd6aa6cad01c991b5ce">SampleHandlerFD_array</a> != <span class="keyword">nullptr</span>){<span class="keyword">delete</span>[] <a class="code" href="classSampleHandlerFD.html#aab040097a0524dd6aa6cad01c991b5ce">SampleHandlerFD_array</a>[yBin];}</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="classSampleHandlerFD.html#a3905ae0e2531525dba5d663110f86527">SampleHandlerFD_array_w2</a>[yBin];</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">//ETA - there is a chance that you haven&#39;t added any data...</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#adce8040b6fe6501aa4833bbb5ca1163f">SampleHandlerFD_data</a> != <span class="keyword">nullptr</span>){<span class="keyword">delete</span>[] <a class="code" href="classSampleHandlerFD.html#adce8040b6fe6501aa4833bbb5ca1163f">SampleHandlerFD_data</a>[yBin];}</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#aab040097a0524dd6aa6cad01c991b5ce">SampleHandlerFD_array</a> != <span class="keyword">nullptr</span>){<span class="keyword">delete</span>[] <a class="code" href="classSampleHandlerFD.html#aab040097a0524dd6aa6cad01c991b5ce">SampleHandlerFD_array</a>;}</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keyword">delete</span>[] <a class="code" href="classSampleHandlerFD.html#a3905ae0e2531525dba5d663110f86527">SampleHandlerFD_array_w2</a>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="comment">//ETA - there is a chance that you haven&#39;t added any data...</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#adce8040b6fe6501aa4833bbb5ca1163f">SampleHandlerFD_data</a> != <span class="keyword">nullptr</span>){<span class="keyword">delete</span>[] <a class="code" href="classSampleHandlerFD.html#adce8040b6fe6501aa4833bbb5ca1163f">SampleHandlerFD_data</a>;}</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">THStackLeg</a> != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code" href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">THStackLeg</a>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a4db4657acad5c79ac4bbb66a9d1c5905"><div class="ttname"><a href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a></div><div class="ttdeci">#define MACH3LOG_DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00022">MaCh3Logger.h:22</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ac8e54b8d677e132f8d7237495f6fb755"><div class="ttname"><a href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">SampleHandlerFD::YBinEdges</a></div><div class="ttdeci">std::vector&lt; double &gt; YBinEdges</div><div class="ttdoc">Vector to hold y-axis bin-edges.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00282">SampleHandlerFD.h:282</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_af60df24f4eb7954a3297c9841c60624b"><div class="ttname"><a href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">SampleHandlerFD::THStackLeg</a></div><div class="ttdeci">TLegend * THStackLeg</div><div class="ttdoc">DB Miscellaneous Variables.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00358">SampleHandlerFD.h:358</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a203041ed33becd131eb3d03277d7d20c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a203041ed33becd131eb3d03277d7d20c">&#9670;&nbsp;</a></span>AddData() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::AddData </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="classSampleHandlerBase.html#a0c23502c36e51562bf784ebcced54c6c">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01123">1123</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                                                     {</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  <a class="code" href="classSampleHandlerBase.html#aa7ed25798bc8d52dc16b5ea2f6c9d0c3">dathist2d</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  <a class="code" href="classSampleHandlerBase.html#a7938f32b145ce648d3ce4ae33bc9d560">dathist</a>-&gt;Reset(); </div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  </div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__SampleHandlerGetters.html#ga3f9eb0131a6e1f7d4bd411902f4425ca">GetNDim</a>()!=1) {</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Trying to set a 1D &#39;data&#39; histogram when the number of dimensions for this sample is {}&quot;</span>, <a class="code" href="group__SampleHandlerGetters.html#ga3f9eb0131a6e1f7d4bd411902f4425ca">GetNDim</a>());</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;This won&#39;t work, please specify the correct dimensions in your sample config with the X and Y variables&quot;</span>);</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  }</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; data_point : data){</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <a class="code" href="classSampleHandlerBase.html#a7938f32b145ce648d3ce4ae33bc9d560">dathist</a>-&gt;Fill(data_point);</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  }</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160; </div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#adce8040b6fe6501aa4833bbb5ca1163f">SampleHandlerFD_data</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;SampleHandlerFD_data haven&#39;t been initialised yet&quot;</span>);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  }</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> yBin=0;yBin&lt;<a class="code" href="classSampleHandlerFD.html#ae48ed0755671be986cb04690b4fa6959">nYBins</a>;yBin++) {</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> xBin=0;xBin&lt;<a class="code" href="classSampleHandlerFD.html#ab933df667fbccf97b3028297ddd8eae2">nXBins</a>;xBin++) {</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      <a class="code" href="classSampleHandlerFD.html#adce8040b6fe6501aa4833bbb5ca1163f">SampleHandlerFD_data</a>[yBin][xBin] = <a class="code" href="classSampleHandlerBase.html#a7938f32b145ce648d3ce4ae33bc9d560">dathist</a>-&gt;GetBinContent(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(xBin+1));</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    }</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  }</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerBase_html_a7938f32b145ce648d3ce4ae33bc9d560"><div class="ttname"><a href="classSampleHandlerBase.html#a7938f32b145ce648d3ce4ae33bc9d560">SampleHandlerBase::dathist</a></div><div class="ttdeci">TH1D * dathist</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00142">SampleHandlerBase.h:142</a></div></div>
<div class="ttc" id="aclassSampleHandlerBase_html_aa7ed25798bc8d52dc16b5ea2f6c9d0c3"><div class="ttname"><a href="classSampleHandlerBase.html#aa7ed25798bc8d52dc16b5ea2f6c9d0c3">SampleHandlerBase::dathist2d</a></div><div class="ttdeci">TH2D * dathist2d</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00143">SampleHandlerBase.h:143</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ab933df667fbccf97b3028297ddd8eae2"><div class="ttname"><a href="classSampleHandlerFD.html#ab933df667fbccf97b3028297ddd8eae2">SampleHandlerFD::nXBins</a></div><div class="ttdeci">size_t nXBins</div><div class="ttdoc">Number of X axis bins in the histogram used for likelihood calculation.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00286">SampleHandlerFD.h:286</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ae48ed0755671be986cb04690b4fa6959"><div class="ttname"><a href="classSampleHandlerFD.html#ae48ed0755671be986cb04690b4fa6959">SampleHandlerFD::nYBins</a></div><div class="ttdeci">size_t nYBins</div><div class="ttdoc">Number of Y axis bins in the histogram used for likelihood calculation.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00288">SampleHandlerFD.h:288</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_ga3f9eb0131a6e1f7d4bd411902f4425ca"><div class="ttname"><a href="group__SampleHandlerGetters.html#ga3f9eb0131a6e1f7d4bd411902f4425ca">SampleHandlerFD::GetNDim</a></div><div class="ttdeci">int GetNDim()</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00031">SampleHandlerFD.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af2a7215360849e5c681b62bdf56b8ebc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2a7215360849e5c681b62bdf56b8ebc">&#9670;&nbsp;</a></span>AddData() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::AddData </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="classSampleHandlerBase.html#a0152cea82b224f36eb5cb4efa247407d">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01148">1148</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                                                                   {</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <a class="code" href="classSampleHandlerBase.html#a7938f32b145ce648d3ce4ae33bc9d560">dathist</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <a class="code" href="classSampleHandlerBase.html#aa7ed25798bc8d52dc16b5ea2f6c9d0c3">dathist2d</a>-&gt;Reset();                                                       </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160; </div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__SampleHandlerGetters.html#ga3f9eb0131a6e1f7d4bd411902f4425ca">GetNDim</a>()!=2) {</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Trying to set a 2D &#39;data&#39; histogram when the number of dimensions for this sample is {}&quot;</span>, <a class="code" href="group__SampleHandlerGetters.html#ga3f9eb0131a6e1f7d4bd411902f4425ca">GetNDim</a>());</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;This won&#39;t work, please specify the correct dimensions in your sample config with the X and Y variables&quot;</span>);</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  }</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160; </div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  <span class="comment">//TODO: this assumes that std::vector is of length 2 and then both data.at(0) and data</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  <span class="comment">//ETA: I think this might just be wrong? We should probably just make this AddData(std::vector&lt;double&gt; data_x, std::vector&lt;double&gt; data_y)</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  <span class="comment">// or maybe something like AddData(std::vector&lt;std::pair&lt;double, double&gt;&gt; data)?</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; int(data.size()); i++) {</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <a class="code" href="classSampleHandlerBase.html#aa7ed25798bc8d52dc16b5ea2f6c9d0c3">dathist2d</a>-&gt;Fill(data.at(0)[i],data.at(1)[i]);</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  }</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160; </div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#adce8040b6fe6501aa4833bbb5ca1163f">SampleHandlerFD_data</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;SampleHandlerFD_data haven&#39;t been initialised yet&quot;</span>);</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  }</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> yBin=0;yBin&lt;<a class="code" href="classSampleHandlerFD.html#ae48ed0755671be986cb04690b4fa6959">nYBins</a>;yBin++) {</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> xBin=0;xBin&lt;<a class="code" href="classSampleHandlerFD.html#ab933df667fbccf97b3028297ddd8eae2">nXBins</a>;xBin++) {</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      <span class="comment">//Need to cast to an int (Int_t) for ROOT</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <span class="comment">//Need to do +1 for the bin, this is to be consistent with ROOTs binning scheme</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      <a class="code" href="classSampleHandlerFD.html#adce8040b6fe6501aa4833bbb5ca1163f">SampleHandlerFD_data</a>[yBin][xBin] = <a class="code" href="classSampleHandlerBase.html#aa7ed25798bc8d52dc16b5ea2f6c9d0c3">dathist2d</a>-&gt;GetBinContent(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(xBin+1),<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(yBin+1));</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    }</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  }</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afd6a736c3752b05dde1e1e3703bf42a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd6a736c3752b05dde1e1e3703bf42a5">&#9670;&nbsp;</a></span>AddData() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::AddData </td>
          <td>(</td>
          <td class="paramtype">TH1D *&#160;</td>
          <td class="paramname"><em>Data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="classSampleHandlerBase.html#a9a9d84e402166a08a6b2c975c39b8680">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01178">1178</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                                        {</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Adding 1D data histogram: {} with {:.2f} events&quot;</span>, Data-&gt;GetTitle(), Data-&gt;Integral());</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  <a class="code" href="classSampleHandlerBase.html#aa7ed25798bc8d52dc16b5ea2f6c9d0c3">dathist2d</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <a class="code" href="classSampleHandlerBase.html#a7938f32b145ce648d3ce4ae33bc9d560">dathist</a> = Data;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  </div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__SampleHandlerGetters.html#ga3f9eb0131a6e1f7d4bd411902f4425ca">GetNDim</a>()!=1) {</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Trying to set a 1D &#39;data&#39; histogram in a 2D sample - Quitting&quot;</span>); </div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;The number of dimensions for this sample is {}&quot;</span>, <a class="code" href="group__SampleHandlerGetters.html#ga3f9eb0131a6e1f7d4bd411902f4425ca">GetNDim</a>());</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  }</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    </div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#adce8040b6fe6501aa4833bbb5ca1163f">SampleHandlerFD_data</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;SampleHandlerFD_data haven&#39;t been initialised yet&quot;</span>);</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  }</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> yBin=0;yBin&lt;<a class="code" href="classSampleHandlerFD.html#ae48ed0755671be986cb04690b4fa6959">nYBins</a>;yBin++) {</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> xBin=0;xBin&lt;<a class="code" href="classSampleHandlerFD.html#ab933df667fbccf97b3028297ddd8eae2">nXBins</a>;xBin++) {</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      <span class="comment">//Need to cast to an int (Int_t) for ROOT</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;      <span class="comment">//Need to do +1 for the bin, this is to be consistent with ROOTs binning scheme</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;      <a class="code" href="classSampleHandlerFD.html#adce8040b6fe6501aa4833bbb5ca1163f">SampleHandlerFD_data</a>[yBin][xBin] = Data-&gt;GetBinContent(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(xBin+1));</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    }</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  }</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2dea09fa53bc8ec35a38c3a26f000c03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dea09fa53bc8ec35a38c3a26f000c03">&#9670;&nbsp;</a></span>AddData() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::AddData </td>
          <td>(</td>
          <td class="paramtype">TH2D *&#160;</td>
          <td class="paramname"><em>Data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="classSampleHandlerBase.html#a2063aad8c057e15a8709e89861f90a87">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01202">1202</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                                        {</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Adding 2D data histogram: {} with {:.2f} events&quot;</span>, Data-&gt;GetTitle(), Data-&gt;Integral());</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  <a class="code" href="classSampleHandlerBase.html#aa7ed25798bc8d52dc16b5ea2f6c9d0c3">dathist2d</a> = Data;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  <a class="code" href="classSampleHandlerBase.html#a7938f32b145ce648d3ce4ae33bc9d560">dathist</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__SampleHandlerGetters.html#ga3f9eb0131a6e1f7d4bd411902f4425ca">GetNDim</a>()!=2) {</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Trying to set a 2D &#39;data&#39; histogram in a 1D sample - Quitting&quot;</span>); </div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );}    </div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;   </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#adce8040b6fe6501aa4833bbb5ca1163f">SampleHandlerFD_data</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;SampleHandlerFD_data haven&#39;t been initialised yet&quot;</span>);</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  }</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> yBin=0;yBin&lt;<a class="code" href="classSampleHandlerFD.html#ae48ed0755671be986cb04690b4fa6959">nYBins</a>;yBin++) {</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> xBin=0;xBin&lt;<a class="code" href="classSampleHandlerFD.html#ab933df667fbccf97b3028297ddd8eae2">nXBins</a>;xBin++) {</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      <span class="comment">//Need to cast to an int (Int_t) for ROOT</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      <span class="comment">//Need to do +1 for the bin, this is to be consistent with ROOTs binning scheme</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      <a class="code" href="classSampleHandlerFD.html#adce8040b6fe6501aa4833bbb5ca1163f">SampleHandlerFD_data</a>[yBin][xBin] = <a class="code" href="classSampleHandlerBase.html#aa7ed25798bc8d52dc16b5ea2f6c9d0c3">dathist2d</a>-&gt;GetBinContent(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(xBin+1),<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(yBin+1));</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    }</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;  }</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad2894de183f70f36e5af4e12948a8507"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2894de183f70f36e5af4e12948a8507">&#9670;&nbsp;</a></span>ApplyShifts()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::ApplyShifts </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iEvent</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>ETA - generic function applying shifts. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00713">713</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                                            {</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="comment">// Given a sample and event, apply the shifts to the event based on the vector of functional parameter enums</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="comment">// First reset shifted array back to nominal values</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a06a5cccd7d178bd999dc1e4f3782e9b7">resetShifts</a>(iEvent);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fpEnum : <a class="code" href="classSampleHandlerFD.html#a00060ee2bbc0e3e5528932705ce690e6">funcParsGrid</a>[iEvent]) {</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <a class="code" href="structFunctionalParameter.html">FunctionalParameter</a> *fp = <a class="code" href="classSampleHandlerFD.html#a06eab1b725605a68cdb75e3826122c47">funcParsMap</a>[<span class="keyword">static_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(fpEnum)];</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="comment">// if (fp-&gt;funcPtr) {</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="comment">//   (*fp-&gt;funcPtr)(fp-&gt;valuePtr, iEvent);</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="comment">// } else {</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="comment">//   MACH3LOG_ERROR(&quot;Functional parameter function pointer for {} is null for event {} in sample {}&quot;, fp-&gt;name, iEvent);</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="comment">//   throw MaCh3Exception(__FILE__, __LINE__);</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    (*fp-&gt;<a class="code" href="structFunctionalParameter.html#a9c6502d6199b3a388998172859cd8031">funcPtr</a>)(fp-&gt;<a class="code" href="structFunctionalParameter.html#a4be18ce2fe67e89237f74d5e54b04a09">valuePtr</a>, iEvent);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  }</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a00060ee2bbc0e3e5528932705ce690e6"><div class="ttname"><a href="classSampleHandlerFD.html#a00060ee2bbc0e3e5528932705ce690e6">SampleHandlerFD::funcParsGrid</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int &gt; &gt; funcParsGrid</div><div class="ttdoc">HH - a grid of vectors of enums for each sample and event.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00227">SampleHandlerFD.h:227</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a06a5cccd7d178bd999dc1e4f3782e9b7"><div class="ttname"><a href="classSampleHandlerFD.html#a06a5cccd7d178bd999dc1e4f3782e9b7">SampleHandlerFD::resetShifts</a></div><div class="ttdeci">virtual void resetShifts(int iEvent)</div><div class="ttdoc">HH - reset the shifted values to the original values.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00212">SampleHandlerFD.h:212</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a06eab1b725605a68cdb75e3826122c47"><div class="ttname"><a href="classSampleHandlerFD.html#a06eab1b725605a68cdb75e3826122c47">SampleHandlerFD::funcParsMap</a></div><div class="ttdeci">std::vector&lt; FunctionalParameter * &gt; funcParsMap</div><div class="ttdoc">HH - a map that relates the funcpar enum to pointer of FuncPars struct.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00222">SampleHandlerFD.h:222</a></div></div>
<div class="ttc" id="astructFunctionalParameter_html"><div class="ttname"><a href="structFunctionalParameter.html">FunctionalParameter</a></div><div class="ttdoc">HH - Functional parameters Carrier for whether you want to apply a systematic to an event or not.</div><div class="ttdef"><b>Definition:</b> <a href="ParameterStructs_8h_source.html#l00188">ParameterStructs.h:188</a></div></div>
<div class="ttc" id="astructFunctionalParameter_html_a4be18ce2fe67e89237f74d5e54b04a09"><div class="ttname"><a href="structFunctionalParameter.html#a4be18ce2fe67e89237f74d5e54b04a09">FunctionalParameter::valuePtr</a></div><div class="ttdeci">const double * valuePtr</div><div class="ttdoc">Parameter value pointer.</div><div class="ttdef"><b>Definition:</b> <a href="ParameterStructs_8h_source.html#l00213">ParameterStructs.h:213</a></div></div>
<div class="ttc" id="astructFunctionalParameter_html_a9c6502d6199b3a388998172859cd8031"><div class="ttname"><a href="structFunctionalParameter.html#a9c6502d6199b3a388998172859cd8031">FunctionalParameter::funcPtr</a></div><div class="ttdeci">FuncParFuncType * funcPtr</div><div class="ttdoc">Function pointer.</div><div class="ttdef"><b>Definition:</b> <a href="ParameterStructs_8h_source.html#l00216">ParameterStructs.h:216</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5d4ae325a527df590f54121d51dd0a16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d4ae325a527df590f54121d51dd0a16">&#9670;&nbsp;</a></span>CalcNormsBins()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::CalcNormsBins </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>xsec_norms_bins</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check whether a normalisation systematic affects an event or not. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00799">799</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                                                                                  {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="preprocessor">  #ifdef DEBUG</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  std::vector&lt;int&gt; VerboseCounter(<a class="code" href="classSampleHandlerFD.html#a5bbc930a955e5171d15324d6b2e55f81">norm_parameters</a>.size(), 0);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iEvent = 0; iEvent &lt; <a class="code" href="group__SampleHandlerGetters.html#ga5463cc125470d1f31fbc1ab8f01b60a7">GetNEvents</a>(); ++iEvent){</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    std::vector&lt; int &gt; NormBins = {};</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#a1db89c4df22a237b1cb26a2b55ee0866">ParHandler</a>) {</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="comment">// Skip oscillated NC events</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="comment">// Not strictly needed, but these events don&#39;t get included in oscillated predictions, so</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      <span class="comment">// no need to waste our time calculating and storing information about xsec parameters</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      <span class="comment">// that will never be used.</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].isNC &amp;&amp; (*<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].nupdg != *<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].nupdgUnosc) ) {</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#afc88f0aa23c7127b2ff6e5c7ca3fa892">MACH3LOG_TRACE</a>(<span class="stringliteral">&quot;Event {}, missed NC/signal check&quot;</span>, iEvent);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      } <span class="comment">//DB Abstract check on MaCh3Modes to determine which apply to neutral current</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      <span class="keywordflow">for</span> (std::vector&lt;NormParameter&gt;::iterator it = <a class="code" href="classSampleHandlerFD.html#a5bbc930a955e5171d15324d6b2e55f81">norm_parameters</a>.begin(); it != <a class="code" href="classSampleHandlerFD.html#a5bbc930a955e5171d15324d6b2e55f81">norm_parameters</a>.end(); ++it) {</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        <span class="comment">//Now check that the target of an interaction matches with the normalisation parameters</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <span class="keywordtype">bool</span> TargetMatch = <a class="code" href="classSampleHandlerBase.html#ad16c838d4dc86e98445f199a16cf9bdf">MatchCondition</a>((*it).targets, *(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].Target));</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        <span class="keywordflow">if</span> (!TargetMatch) {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;          <a class="code" href="MaCh3Logger_8h.html#afc88f0aa23c7127b2ff6e5c7ca3fa892">MACH3LOG_TRACE</a>(<span class="stringliteral">&quot;Event {}, missed target check ({}) for dial {}&quot;</span>, iEvent, *(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].Target), (*it).name);</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        }</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160; </div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <span class="comment">//Now check that the neutrino flavour in an interaction matches with the normalisation parameters</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <span class="keywordtype">bool</span> FlavourMatch = <a class="code" href="classSampleHandlerBase.html#ad16c838d4dc86e98445f199a16cf9bdf">MatchCondition</a>((*it).pdgs, *(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].nupdg));</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <span class="keywordflow">if</span> (!FlavourMatch) {</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;          <a class="code" href="MaCh3Logger_8h.html#afc88f0aa23c7127b2ff6e5c7ca3fa892">MACH3LOG_TRACE</a>(<span class="stringliteral">&quot;Event {}, missed PDG check ({}) for dial {}&quot;</span>, iEvent,(*<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].nupdg), (*it).name);</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        }</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160; </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <span class="comment">//Now check that the unoscillated neutrino flavour in an interaction matches with the normalisation parameters</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        <span class="keywordtype">bool</span> FlavourUnoscMatch = <a class="code" href="classSampleHandlerBase.html#ad16c838d4dc86e98445f199a16cf9bdf">MatchCondition</a>((*it).preoscpdgs, *(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].nupdgUnosc));</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        <span class="keywordflow">if</span> (!FlavourUnoscMatch){</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;          <a class="code" href="MaCh3Logger_8h.html#afc88f0aa23c7127b2ff6e5c7ca3fa892">MACH3LOG_TRACE</a>(<span class="stringliteral">&quot;Event {}, missed FlavourUnosc check ({}) for dial {}&quot;</span>, iEvent,(*<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].nupdgUnosc), (*it).name);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        }</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <span class="comment">//Now check that the mode of an interaction matches with the normalisation parameters</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <span class="keywordtype">bool</span> ModeMatch = <a class="code" href="classSampleHandlerBase.html#ad16c838d4dc86e98445f199a16cf9bdf">MatchCondition</a>((*it).modes, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::round(*(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].mode))));</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <span class="keywordflow">if</span> (!ModeMatch) {</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;          <a class="code" href="MaCh3Logger_8h.html#afc88f0aa23c7127b2ff6e5c7ca3fa892">MACH3LOG_TRACE</a>(<span class="stringliteral">&quot;Event {}, missed Mode check ({}) for dial {}&quot;</span>, iEvent, *(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].mode), (*it).name);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        }</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <span class="comment">//Now check whether the norm has kinematic bounds</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        <span class="comment">//i.e. does it only apply to events in a particular kinematic region?</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        <span class="comment">// Now check whether within kinematic bounds</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <span class="keywordtype">bool</span> IsSelected = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <span class="keywordflow">if</span> ((*it).hasKinBounds) {</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span>&amp; kinVars = (*it).KinematicVarStr;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span>&amp; selection = (*it).Selection;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160; </div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;          <span class="keywordflow">for</span> (std::size_t iKinPar = 0; iKinPar &lt; kinVars.size(); ++iKinPar) {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> kinVal = <a class="code" href="classSampleHandlerFD.html#ad0f549802b5625871e11d86905989697">ReturnKinematicParameter</a>(kinVars[iKinPar], iEvent);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160; </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            <span class="keywordflow">if</span> (kinVal &lt;= selection[iKinPar][0] || kinVal &gt; selection[iKinPar][1]) {</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;              <a class="code" href="MaCh3Logger_8h.html#afc88f0aa23c7127b2ff6e5c7ca3fa892">MACH3LOG_TRACE</a>(<span class="stringliteral">&quot;Event {}, missed kinematic check ({}) for dial {}&quot;</span>,</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                             iEvent, kinVars[iKinPar], (*it).name);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;              IsSelected = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            }</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;          }</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        }</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <span class="comment">// Need to then break the event loop</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        <span class="keywordflow">if</span>(!IsSelected){</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;          <a class="code" href="MaCh3Logger_8h.html#afc88f0aa23c7127b2ff6e5c7ca3fa892">MACH3LOG_TRACE</a>(<span class="stringliteral">&quot;Event {}, missed Kinematic var check for dial {}&quot;</span>, iEvent, (*it).name);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        }</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <span class="comment">// Now set &#39;index bin&#39; for each normalisation parameter</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <span class="comment">// All normalisations are just 1 bin for 2015, so bin = index (where index is just the bin for that normalisation)</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <span class="keywordtype">int</span> bin = (*it).index;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160; </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        NormBins.push_back(bin);</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#afc88f0aa23c7127b2ff6e5c7ca3fa892">MACH3LOG_TRACE</a>(<span class="stringliteral">&quot;Event {}, will be affected by dial {}&quot;</span>, iEvent, (*it).name);</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="preprocessor">        #ifdef DEBUG</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        VerboseCounter[std::distance(<a class="code" href="classSampleHandlerFD.html#a5bbc930a955e5171d15324d6b2e55f81">norm_parameters</a>.begin(), it)]++;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <span class="comment">//}</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      } <span class="comment">// end iteration over norm_parameters</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    } <span class="comment">// end if (ParHandler)</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    xsec_norms_bins[iEvent] = NormBins;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  }<span class="comment">//end loop over events</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="preprocessor">  #ifdef DEBUG</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; <a class="code" href="classSampleHandlerFD.html#a5bbc930a955e5171d15324d6b2e55f81">norm_parameters</a>.size(); ++i) {</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; norm = <a class="code" href="classSampleHandlerFD.html#a5bbc930a955e5171d15324d6b2e55f81">norm_parameters</a>[i];</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keywordtype">double</span> eventRatio = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(VerboseCounter[i]) / <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(<a class="code" href="group__SampleHandlerGetters.html#ga5463cc125470d1f31fbc1ab8f01b60a7">GetNEvents</a>());</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160; </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a>(<span class="stringliteral">&quot; Param {:&lt;15}, affects {:&lt;8} events ({:&gt;6.2f}%) &quot;</span>,</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                  <a class="code" href="classSampleHandlerFD.html#a1db89c4df22a237b1cb26a2b55ee0866">ParHandler</a>-&gt;<a class="code" href="group__ParameterHandlerGetters.html#ga65b61ae6c60d4eadbb06fdef9596cc7f">GetParFancyName</a>(norm.index), VerboseCounter[i], eventRatio);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  }</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_afc88f0aa23c7127b2ff6e5c7ca3fa892"><div class="ttname"><a href="MaCh3Logger_8h.html#afc88f0aa23c7127b2ff6e5c7ca3fa892">MACH3LOG_TRACE</a></div><div class="ttdeci">#define MACH3LOG_TRACE</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00021">MaCh3Logger.h:21</a></div></div>
<div class="ttc" id="aclassSampleHandlerBase_html_ad16c838d4dc86e98445f199a16cf9bdf"><div class="ttname"><a href="classSampleHandlerBase.html#ad16c838d4dc86e98445f199a16cf9bdf">SampleHandlerBase::MatchCondition</a></div><div class="ttdeci">bool MatchCondition(const std::vector&lt; T &gt; &amp;allowedValues, const T &amp;value)</div><div class="ttdoc">check if event is affected by following conditions, for example pdg, or modes etc</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00116">SampleHandlerBase.h:116</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a5bbc930a955e5171d15324d6b2e55f81"><div class="ttname"><a href="classSampleHandlerFD.html#a5bbc930a955e5171d15324d6b2e55f81">SampleHandlerFD::norm_parameters</a></div><div class="ttdeci">std::vector&lt; NormParameter &gt; norm_parameters</div><div class="ttdoc">Information to store for normalisation pars.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00322">SampleHandlerFD.h:322</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ad0f549802b5625871e11d86905989697"><div class="ttname"><a href="classSampleHandlerFD.html#ad0f549802b5625871e11d86905989697">SampleHandlerFD::ReturnKinematicParameter</a></div><div class="ttdeci">virtual double ReturnKinematicParameter(std::string KinematicParamter, int iEvent)=0</div><div class="ttdoc">Return the value of an assocaited kinematic parameter for an event.</div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_af779913cecbf20c194010aa540ac78c8"><div class="ttname"><a href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">SampleHandlerFD::MCSamples</a></div><div class="ttdeci">std::vector&lt; FarDetectorCoreInfo &gt; MCSamples</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00300">SampleHandlerFD.h:300</a></div></div>
<div class="ttc" id="agroup__ParameterHandlerGetters_html_ga65b61ae6c60d4eadbb06fdef9596cc7f"><div class="ttname"><a href="group__ParameterHandlerGetters.html#ga65b61ae6c60d4eadbb06fdef9596cc7f">ParameterHandlerBase::GetParFancyName</a></div><div class="ttdeci">std::string GetParFancyName(const int i) const</div><div class="ttdoc">Get fancy name of the Parameter.</div><div class="ttdef"><b>Definition:</b> <a href="ParameterHandlerBase_8h_source.html#l00171">ParameterHandlerBase.h:171</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_ga5463cc125470d1f31fbc1ab8f01b60a7"><div class="ttname"><a href="group__SampleHandlerGetters.html#ga5463cc125470d1f31fbc1ab8f01b60a7">SampleHandlerBase::GetNEvents</a></div><div class="ttdeci">unsigned int GetNEvents()</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00067">SampleHandlerBase.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1781ff483b5bae72103e9298109c4698"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1781ff483b5bae72103e9298109c4698">&#9670;&nbsp;</a></span>CalcWeightFunc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void SampleHandlerFD::CalcWeightFunc </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iEvent</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate weights for function parameters. </p>
<p>First you need to setup additional pointers in you experiment code in SetupWeightPointers Then in this function you can calculate whatever fancy function you want by filling weight to which you have pointer This way func weight shall be used in GetEventWeight </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00243">243</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;{<span class="keywordflow">return</span>; (void)iEvent;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa412b194cece690a049f44e52ecdae38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa412b194cece690a049f44e52ecdae38">&#9670;&nbsp;</a></span>CalcWeightNorm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> SampleHandlerFD::CalcWeightNorm </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structFarDetectorCoreInfo.html">FarDetectorCoreInfo</a> *&#160;</td>
          <td class="paramname"><em>MCEvent</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the norm weight for a given event. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00747">747</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                                                                                  {</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> xsecw = 1.0;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <span class="comment">//Loop over stored normalisation and function pointers</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="preprocessor">  #pragma omp simd</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iParam = 0; iParam &lt; MCEvent-&gt;<a class="code" href="structFarDetectorCoreInfo.html#a858d37c3e45ff56022e3101da094743c">xsec_norm_pointers</a>.size(); ++iParam)</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="preprocessor">#pragma GCC diagnostic push</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="preprocessor">#pragma GCC diagnostic ignored &quot;-Wuseless-cast&quot;</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    xsecw *= <span class="keyword">static_cast&lt;</span><a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a><span class="keyword">&gt;</span>(*(MCEvent-&gt;<a class="code" href="structFarDetectorCoreInfo.html#a858d37c3e45ff56022e3101da094743c">xsec_norm_pointers</a>[iParam]));</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="preprocessor">#pragma GCC diagnostic pop</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="preprocessor">    #ifdef DEBUG</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keywordflow">if</span> (TMath::IsNaN(xsecw)) <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;iParam= {} xsecweight=nan from norms&quot;</span>, iParam);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  }</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="keywordflow">return</span> xsecw;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;}</div>
<div class="ttc" id="anamespaceM3_html_a1f95274549f25fc19fe7db343c8a7a68"><div class="ttname"><a href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a></div><div class="ttdeci">double float_t</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00028">Core.h:28</a></div></div>
<div class="ttc" id="astructFarDetectorCoreInfo_html_a858d37c3e45ff56022e3101da094743c"><div class="ttname"><a href="structFarDetectorCoreInfo.html#a858d37c3e45ff56022e3101da094743c">FarDetectorCoreInfo::xsec_norm_pointers</a></div><div class="ttdeci">std::vector&lt; const double * &gt; xsec_norm_pointers</div><div class="ttdoc">Pointers to normalisation weights which are being taken from Parameter Handler.</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00060">FarDetectorCoreInfoStruct.h:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab661c52bc446ed7a3ba19f90509ce110"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab661c52bc446ed7a3ba19f90509ce110">&#9670;&nbsp;</a></span>CalcWeightSpline()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> SampleHandlerFD::CalcWeightSpline </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structFarDetectorCoreInfo.html">FarDetectorCoreInfo</a> *&#160;</td>
          <td class="paramname"><em>MCEvent</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the spline weight for a given event. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00731">731</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                                                                                    {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> spline_weight = 1.0;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <span class="comment">//DB Xsec syst</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="comment">//Loop over stored spline pointers</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="preprocessor">  #pragma omp simd</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iSpline = 0; iSpline &lt; MCEvent-&gt;<a class="code" href="structFarDetectorCoreInfo.html#a993998a2c2d82bfeae285d71741ad2f2">xsec_spline_pointers</a>.size(); ++iSpline) {</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    spline_weight *= *(MCEvent-&gt;<a class="code" href="structFarDetectorCoreInfo.html#a993998a2c2d82bfeae285d71741ad2f2">xsec_spline_pointers</a>[iSpline]);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  }</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="keywordflow">return</span> spline_weight;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;}</div>
<div class="ttc" id="astructFarDetectorCoreInfo_html_a993998a2c2d82bfeae285d71741ad2f2"><div class="ttname"><a href="structFarDetectorCoreInfo.html#a993998a2c2d82bfeae285d71741ad2f2">FarDetectorCoreInfo::xsec_spline_pointers</a></div><div class="ttdeci">std::vector&lt; const M3::float_t * &gt; xsec_spline_pointers</div><div class="ttdoc">Pointers to spline weights which are being calculated by Splines Handler.</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00062">FarDetectorCoreInfoStruct.h:62</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3011ffe56e290c5e05781edfee00db43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3011ffe56e290c5e05781edfee00db43">&#9670;&nbsp;</a></span>Fill1DHist()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::Fill1DHist </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fill a 1D histogram with the event-level information used in the fit. </p>

<p>Implements <a class="el" href="classSampleHandlerBase.html#a79bf78796d3e9ebef0a439f91fe7bdad">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00250">250</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;{</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="comment">// DB Commented out by default - Code heading towards GetLikelihood using arrays instead of root objects</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="comment">// Wouldn&#39;t actually need this for GetLikelihood as TH objects wouldn&#39;t be filled</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <a class="code" href="classSampleHandlerBase.html#adcc9b928dce6e7dddf761f0c13e7b409">_hPDF1D</a>-&gt;Reset();</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> yBin=0;yBin&lt;(<a class="code" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a>.size()-1);yBin++) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> xBin=0;xBin&lt;(<a class="code" href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">XBinEdges</a>.size()-1);xBin++) {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <a class="code" href="classSampleHandlerBase.html#adcc9b928dce6e7dddf761f0c13e7b409">_hPDF1D</a>-&gt;AddBinContent(xBin+1,<a class="code" href="classSampleHandlerFD.html#aab040097a0524dd6aa6cad01c991b5ce">SampleHandlerFD_array</a>[yBin][xBin]);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerBase_html_adcc9b928dce6e7dddf761f0c13e7b409"><div class="ttname"><a href="classSampleHandlerBase.html#adcc9b928dce6e7dddf761f0c13e7b409">SampleHandlerBase::_hPDF1D</a></div><div class="ttdeci">TH1D * _hPDF1D</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00146">SampleHandlerBase.h:146</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a1d79462d4aab26cdb603b45addff173a"><div class="ttname"><a href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">SampleHandlerFD::XBinEdges</a></div><div class="ttdeci">std::vector&lt; double &gt; XBinEdges</div><div class="ttdoc">Vector to hold x-axis bin-edges.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00280">SampleHandlerFD.h:280</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a720a0aa689648040dfb8565658d82836"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a720a0aa689648040dfb8565658d82836">&#9670;&nbsp;</a></span>Fill2DHist()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::Fill2DHist </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fill a 2D histogram with the event-level information used in the fit. </p>

<p>Implements <a class="el" href="classSampleHandlerBase.html#a3ba05758626b65dc8a74de1d5a143ccd">SampleHandlerBase</a>.</p>

<p>Reimplemented in <a class="el" href="classPySampleHandlerFD.html#a958bb3c8bf869738d53ab47cd47cf43a">PySampleHandlerFD</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00262">262</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;{</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="comment">// DB Commented out by default - Code heading towards GetLikelihood using arrays instead of root objects</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="comment">// Wouldn&#39;t actually need this for GetLikelihood as TH objects wouldn&#39;t be filled</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <a class="code" href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">_hPDF2D</a>-&gt;Reset();</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> yBin=0;yBin&lt;(<a class="code" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a>.size()-1);yBin++) {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> xBin=0;xBin&lt;(<a class="code" href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">XBinEdges</a>.size()-1);xBin++) {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <a class="code" href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">_hPDF2D</a>-&gt;SetBinContent(xBin+1,yBin+1,<a class="code" href="classSampleHandlerFD.html#aab040097a0524dd6aa6cad01c991b5ce">SampleHandlerFD_array</a>[yBin][xBin]);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerBase_html_abd5728e1c6a21b870ec0a5567bd18389"><div class="ttname"><a href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">SampleHandlerBase::_hPDF2D</a></div><div class="ttdeci">TH2D * _hPDF2D</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00147">SampleHandlerBase.h:147</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeef0f943cb1e0d4c9bba4814cb24a507"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeef0f943cb1e0d4c9bba4814cb24a507">&#9670;&nbsp;</a></span>FillArray()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::FillArray </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>DB Nice new multi-threaded function which calculates the event weights and fills the relevant bins of an array. </p>
<p>fills the SampleHandlerFD_array vector with the weight calculated from reweighting</p>
<p>@function SampleHandlerFD::fillArray() Function which does the core reweighting. This assumes that oscillation weights have already been calculated and stored in SampleHandlerFD.osc_w[iEvent]. This function takes advantage of most of the things called in setupSKMC to reduce reweighting time. It also follows the ND code reweighting pretty closely. This function fills the <a class="el" href="classSampleHandlerFD.html" title="Class responsible for handling implementation of samples used in analysis, reweighting and returning ...">SampleHandlerFD</a> array array which is binned to match the sample binning, such that bin[1][1] is the equivalent of _hPDF2D-&gt;GetBinContent(2,2) {Noticing the offset} </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00381">381</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                                {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">//************************************************</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="comment">//DB Reset which cuts to apply</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a2b0a7ada3c931e66211eebd91de0c0d0">Selection</a> = <a class="code" href="classSampleHandlerFD.html#a402634a2a3f7520228b50bf208c00e78">StoredSelection</a>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a691a4ec2c4c82b3c4437ead052644a54">PrepFunctionalParameters</a>();</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iEvent = 0; iEvent &lt; <a class="code" href="group__SampleHandlerGetters.html#ga5463cc125470d1f31fbc1ab8f01b60a7">GetNEvents</a>(); iEvent++) {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <a class="code" href="classSampleHandlerFD.html#ad2894de183f70f36e5af4e12948a8507">ApplyShifts</a>(iEvent);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSampleHandlerFD.html#a1ce3d6b9d9f6cce379fe1e8dd404369a">IsEventSelected</a>(iEvent)) {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <a class="code" href="structFarDetectorCoreInfo.html">FarDetectorCoreInfo</a>* MCEvent = &amp;<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent];</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> splineweight = <a class="code" href="classSampleHandlerFD.html#ab661c52bc446ed7a3ba19f90509ce110">CalcWeightSpline</a>(MCEvent);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">//DB Catch negative spline weights and skip any event with a negative event. Previously we would set weight to zero and continue but that is inefficient. Do this on a spline-by-spline basis</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">if</span> (splineweight &lt;= 0.){</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      MCEvent-&gt;<a class="code" href="structFarDetectorCoreInfo.html#a91586f67da67dcb925715a94ed04a299">xsec_w</a> = 0.;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    }</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="comment">//Loop over stored normalisation and function pointers</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> normweight = <a class="code" href="classSampleHandlerFD.html#aa412b194cece690a049f44e52ecdae38">CalcWeightNorm</a>(MCEvent);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">// Virtual by default does nothing</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a1781ff483b5bae72103e9298109c4698">CalcWeightFunc</a>(iEvent);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    MCEvent-&gt;<a class="code" href="structFarDetectorCoreInfo.html#a91586f67da67dcb925715a94ed04a299">xsec_w</a> = splineweight*normweight;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">//DB Total weight</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> totalweight = <a class="code" href="classSampleHandlerFD.html#a9e735d294d926fef87a6fc4c0ec54dca">GetEventWeight</a>(iEvent);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="comment">//DB Catch negative weights and skip any event with a negative event</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">if</span> (totalweight &lt;= 0.){</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      MCEvent-&gt;<a class="code" href="structFarDetectorCoreInfo.html#a91586f67da67dcb925715a94ed04a299">xsec_w</a> = 0.;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">//DB Switch on BinningOpt to allow different binning options to be implemented</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">//The alternative would be to have inheritance based on BinningOpt</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> XVar = *(MCEvent-&gt;<a class="code" href="structFarDetectorCoreInfo.html#aec30bcbf46661b421732fa179efcb0d2">x_var</a>);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">//DB Find the relevant bin in the PDF for each event</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordtype">int</span> XBinToFill = -1;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> YBinToFill = MCEvent-&gt;<a class="code" href="structFarDetectorCoreInfo.html#a32448e9a710f56b30b53185575ae2d76">NomYBin</a>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">//DB - First, check to see if the event is still in the nominal bin</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">if</span> (XVar &lt; MCEvent-&gt;rw_upper_xbinedge &amp;&amp; XVar &gt;= MCEvent-&gt;<a class="code" href="structFarDetectorCoreInfo.html#aab21263dc4a65a848430c7f72af0c44d">rw_lower_xbinedge</a>) {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      XBinToFill = MCEvent-&gt;<a class="code" href="structFarDetectorCoreInfo.html#abaa57805bad197bb2a46db12aec54450">NomXBin</a>;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">//DB - Second, check to see if the event is outside of the binning range and skip event if it is</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">//ETA- note that nXBins is XBinEdges.size() - 1</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (XVar &lt; <a class="code" href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">XBinEdges</a>[0] || XVar &gt;= <a class="code" href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">XBinEdges</a>[<a class="code" href="classSampleHandlerFD.html#ab933df667fbccf97b3028297ddd8eae2">nXBins</a>]) {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="comment">//DB - Thirdly, check the adjacent bins first as Eb+CC+EScale shifts aren&#39;t likely to move an Erec more than 1bin width</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="comment">//Shifted down one bin from the event bin at nominal</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (XVar &lt; MCEvent-&gt;rw_lower_xbinedge &amp;&amp; XVar &gt;= MCEvent-&gt;<a class="code" href="structFarDetectorCoreInfo.html#a42f83854dd48874bd6bc9cc089c74582">rw_lower_lower_xbinedge</a>) {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      XBinToFill = MCEvent-&gt;<a class="code" href="structFarDetectorCoreInfo.html#abaa57805bad197bb2a46db12aec54450">NomXBin</a>-1;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="comment">//Shifted up one bin from the event bin at nominal</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (XVar &lt; MCEvent-&gt;rw_upper_upper_xbinedge &amp;&amp; XVar &gt;= MCEvent-&gt;<a class="code" href="structFarDetectorCoreInfo.html#a1d656ca460baeb8ab149a83a585f2694">rw_upper_xbinedge</a>) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      XBinToFill = MCEvent-&gt;<a class="code" href="structFarDetectorCoreInfo.html#abaa57805bad197bb2a46db12aec54450">NomXBin</a>+1;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="comment">//DB - If we end up in this loop, the event has been shifted outside of its nominal bin, but is still within the allowed binning range</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <span class="comment">// KS: Perform binary search to find correct bin. We already checked if isn&#39;t outside of bounds</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      XBinToFill = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::distance(<a class="code" href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">XBinEdges</a>.begin(),</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                                                  std::upper_bound(<a class="code" href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">XBinEdges</a>.begin(), <a class="code" href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">XBinEdges</a>.end(), XVar)) - 1);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="comment">//DB Fill relevant part of thread array</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordflow">if</span> (XBinToFill != -1 &amp;&amp; YBinToFill != -1) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <a class="code" href="classSampleHandlerFD.html#aab040097a0524dd6aa6cad01c991b5ce">SampleHandlerFD_array</a>[YBinToFill][XBinToFill] += totalweight;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#a1ff1ef7d99cee6d6a9fba74296d4d0ea">FirstTimeW2</a>) <a class="code" href="classSampleHandlerFD.html#a3905ae0e2531525dba5d663110f86527">SampleHandlerFD_array_w2</a>[YBinToFill][XBinToFill] += totalweight*totalweight;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a1781ff483b5bae72103e9298109c4698"><div class="ttname"><a href="classSampleHandlerFD.html#a1781ff483b5bae72103e9298109c4698">SampleHandlerFD::CalcWeightFunc</a></div><div class="ttdeci">virtual void CalcWeightFunc(int iEvent)</div><div class="ttdoc">Calculate weights for function parameters.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00243">SampleHandlerFD.h:243</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a1ce3d6b9d9f6cce379fe1e8dd404369a"><div class="ttname"><a href="classSampleHandlerFD.html#a1ce3d6b9d9f6cce379fe1e8dd404369a">SampleHandlerFD::IsEventSelected</a></div><div class="ttdeci">bool IsEventSelected(const int iEvent)</div><div class="ttdoc">DB Function which determines if an event is selected, where Selection double looks like {{ND280Kinema...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00336">SampleHandlerFD.cpp:336</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a2b0a7ada3c931e66211eebd91de0c0d0"><div class="ttname"><a href="classSampleHandlerFD.html#a2b0a7ada3c931e66211eebd91de0c0d0">SampleHandlerFD::Selection</a></div><div class="ttdeci">std::vector&lt; KinematicCut &gt; Selection</div><div class="ttdoc">a way to store selection cuts which you may push back in the get1DVar functions most of the time this...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00336">SampleHandlerFD.h:336</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a402634a2a3f7520228b50bf208c00e78"><div class="ttname"><a href="classSampleHandlerFD.html#a402634a2a3f7520228b50bf208c00e78">SampleHandlerFD::StoredSelection</a></div><div class="ttdeci">std::vector&lt; KinematicCut &gt; StoredSelection</div><div class="ttdoc">What gets pulled from config options, these are constant after loading in this is of length 3: 0th in...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00331">SampleHandlerFD.h:331</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a691a4ec2c4c82b3c4437ead052644a54"><div class="ttname"><a href="classSampleHandlerFD.html#a691a4ec2c4c82b3c4437ead052644a54">SampleHandlerFD::PrepFunctionalParameters</a></div><div class="ttdeci">virtual void PrepFunctionalParameters()</div><div class="ttdoc">Update the functional parameter values to the latest propsed values. Needs to be called before every ...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00205">SampleHandlerFD.h:205</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a9e735d294d926fef87a6fc4c0ec54dca"><div class="ttname"><a href="classSampleHandlerFD.html#a9e735d294d926fef87a6fc4c0ec54dca">SampleHandlerFD::GetEventWeight</a></div><div class="ttdeci">M3::float_t GetEventWeight(const int iEntry) const</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01335">SampleHandlerFD.cpp:1335</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_aa412b194cece690a049f44e52ecdae38"><div class="ttname"><a href="classSampleHandlerFD.html#aa412b194cece690a049f44e52ecdae38">SampleHandlerFD::CalcWeightNorm</a></div><div class="ttdeci">M3::float_t CalcWeightNorm(const FarDetectorCoreInfo *MCEvent) const</div><div class="ttdoc">Calculate the norm weight for a given event.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00747">SampleHandlerFD.cpp:747</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ab661c52bc446ed7a3ba19f90509ce110"><div class="ttname"><a href="classSampleHandlerFD.html#ab661c52bc446ed7a3ba19f90509ce110">SampleHandlerFD::CalcWeightSpline</a></div><div class="ttdeci">M3::float_t CalcWeightSpline(const FarDetectorCoreInfo *MCEvent) const</div><div class="ttdoc">Calculate the spline weight for a given event.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00731">SampleHandlerFD.cpp:731</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ad2894de183f70f36e5af4e12948a8507"><div class="ttname"><a href="classSampleHandlerFD.html#ad2894de183f70f36e5af4e12948a8507">SampleHandlerFD::ApplyShifts</a></div><div class="ttdeci">virtual void ApplyShifts(int iEvent)</div><div class="ttdoc">ETA - generic function applying shifts.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00713">SampleHandlerFD.cpp:713</a></div></div>
<div class="ttc" id="astructFarDetectorCoreInfo_html"><div class="ttname"><a href="structFarDetectorCoreInfo.html">FarDetectorCoreInfo</a></div><div class="ttdoc">constructors are same for all three so put in here</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00040">FarDetectorCoreInfoStruct.h:40</a></div></div>
<div class="ttc" id="astructFarDetectorCoreInfo_html_a1d656ca460baeb8ab149a83a585f2694"><div class="ttname"><a href="structFarDetectorCoreInfo.html#a1d656ca460baeb8ab149a83a585f2694">FarDetectorCoreInfo::rw_upper_xbinedge</a></div><div class="ttdeci">double rw_upper_xbinedge</div><div class="ttdoc">upper to check if Eb has moved the erec bin</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00082">FarDetectorCoreInfoStruct.h:82</a></div></div>
<div class="ttc" id="astructFarDetectorCoreInfo_html_a32448e9a710f56b30b53185575ae2d76"><div class="ttname"><a href="structFarDetectorCoreInfo.html#a32448e9a710f56b30b53185575ae2d76">FarDetectorCoreInfo::NomYBin</a></div><div class="ttdeci">int NomYBin</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00075">FarDetectorCoreInfoStruct.h:75</a></div></div>
<div class="ttc" id="astructFarDetectorCoreInfo_html_a42f83854dd48874bd6bc9cc089c74582"><div class="ttname"><a href="structFarDetectorCoreInfo.html#a42f83854dd48874bd6bc9cc089c74582">FarDetectorCoreInfo::rw_lower_lower_xbinedge</a></div><div class="ttdeci">double rw_lower_lower_xbinedge</div><div class="ttdoc">lower to check if Eb has moved the erec bin</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00081">FarDetectorCoreInfoStruct.h:81</a></div></div>
<div class="ttc" id="astructFarDetectorCoreInfo_html_a91586f67da67dcb925715a94ed04a299"><div class="ttname"><a href="structFarDetectorCoreInfo.html#a91586f67da67dcb925715a94ed04a299">FarDetectorCoreInfo::xsec_w</a></div><div class="ttdeci">M3::float_t xsec_w</div><div class="ttdoc">Total weight of norm and spline parameters.</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00064">FarDetectorCoreInfoStruct.h:64</a></div></div>
<div class="ttc" id="astructFarDetectorCoreInfo_html_aab21263dc4a65a848430c7f72af0c44d"><div class="ttname"><a href="structFarDetectorCoreInfo.html#aab21263dc4a65a848430c7f72af0c44d">FarDetectorCoreInfo::rw_lower_xbinedge</a></div><div class="ttdeci">double rw_lower_xbinedge</div><div class="ttdoc">lower to check if Eb has moved the erec bin</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00080">FarDetectorCoreInfoStruct.h:80</a></div></div>
<div class="ttc" id="astructFarDetectorCoreInfo_html_abaa57805bad197bb2a46db12aec54450"><div class="ttname"><a href="structFarDetectorCoreInfo.html#abaa57805bad197bb2a46db12aec54450">FarDetectorCoreInfo::NomXBin</a></div><div class="ttdeci">int NomXBin</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00074">FarDetectorCoreInfoStruct.h:74</a></div></div>
<div class="ttc" id="astructFarDetectorCoreInfo_html_aec30bcbf46661b421732fa179efcb0d2"><div class="ttname"><a href="structFarDetectorCoreInfo.html#aec30bcbf46661b421732fa179efcb0d2">FarDetectorCoreInfo::x_var</a></div><div class="ttdeci">const double * x_var</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00054">FarDetectorCoreInfoStruct.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a64b2af7680c88713c70f064fb7574184"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64b2af7680c88713c70f064fb7574184">&#9670;&nbsp;</a></span>FillSplineBins()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::FillSplineBins </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Finds the binned spline that an event should apply to and stored them in a a vector for easy evaluation in the fillArray() function. </p>
<p>@func fillSplineBins() </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01350">1350</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                                     {</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  <span class="comment">//Now loop over events and get the spline bin for each event</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="group__SampleHandlerGetters.html#ga5463cc125470d1f31fbc1ab8f01b60a7">GetNEvents</a>(); ++j) {</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> OscIndex = <a class="code" href="FarDetectorCoreInfoStruct_8h.html#afc52c63bc2b15ae30444755579f5beb4">GetOscChannel</a>(<a class="code" href="classSampleHandlerFD.html#a57f378f84f66caa817e52c0bfb5ff0be">OscChannels</a>, (*<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[j].nupdgUnosc), (*<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[j].nupdg));</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160; </div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    std::vector&lt; std::vector&lt;int&gt; &gt; EventSplines;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="keywordflow">switch</span>(<a class="code" href="classSampleHandlerFD.html#af03bf91649d1848a3e531ff7f865c313">nDimensions</a>){</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        EventSplines = <a class="code" href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">SplineHandler</a>-&gt;GetEventSplines(<a class="code" href="group__SampleHandlerGetters.html#ga46ca9963ed2f9b9b337db72bf52d99e6">GetSampleName</a>(), OscIndex, <span class="keywordtype">int</span>(*(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[j].mode)), *(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[j].rw_etru), *(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[j].x_var), 0.);</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        EventSplines = <a class="code" href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">SplineHandler</a>-&gt;GetEventSplines(<a class="code" href="group__SampleHandlerGetters.html#ga46ca9963ed2f9b9b337db72bf52d99e6">GetSampleName</a>(), OscIndex, <span class="keywordtype">int</span>(*(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[j].mode)), *(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[j].rw_etru), *(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[j].x_var), *(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[j].y_var));</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Error in assigning spline bins because nDimensions = {}&quot;</span>, <a class="code" href="classSampleHandlerFD.html#af03bf91649d1848a3e531ff7f865c313">nDimensions</a>);</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;MaCh3 only supports splines binned in Etrue + the sample binning&quot;</span>);</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Please check the sample binning you specified in your sample config &quot;</span>);</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    }</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <span class="keywordtype">int</span> NSplines = int(EventSplines.size());</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="keywordflow">if</span>(NSplines &lt; 0){</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    }</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[j].xsec_spline_pointers.resize(NSplines);</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> spline = 0; spline &lt; <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[j].xsec_spline_pointers.size(); spline++) {</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      <span class="comment">//Event Splines indexed as: sample name, oscillation channel, syst, mode, etrue, var1, var2 (var2 is a dummy 0 for 1D splines)</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[j].xsec_spline_pointers[spline] = <a class="code" href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">SplineHandler</a>-&gt;retPointer(EventSplines[spline][0], EventSplines[spline][1],</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                                                                                EventSplines[spline][2], EventSplines[spline][3],</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                                                                                EventSplines[spline][4], EventSplines[spline][5],</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                                                                                EventSplines[spline][6]);</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    }</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;  }</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;}</div>
<div class="ttc" id="aFarDetectorCoreInfoStruct_8h_html_afc52c63bc2b15ae30444755579f5beb4"><div class="ttname"><a href="FarDetectorCoreInfoStruct_8h.html#afc52c63bc2b15ae30444755579f5beb4">GetOscChannel</a></div><div class="ttdeci">int GetOscChannel(const std::vector&lt; OscChannelInfo &gt; &amp;OscChannel, const int InitFlav, const int FinalFlav)</div><div class="ttdoc">KS: Get Osc Channel Index based on initial and final PDG codes.</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00028">FarDetectorCoreInfoStruct.h:28</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a17193b3fe2b44e6484f9eefda86f97dd"><div class="ttname"><a href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">SampleHandlerFD::SplineHandler</a></div><div class="ttdeci">std::unique_ptr&lt; BinnedSplineHandler &gt; SplineHandler</div><div class="ttdoc">Contains all your binned splines and handles the setup and the returning of weights from spline evalu...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00141">SampleHandlerFD.h:141</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a57f378f84f66caa817e52c0bfb5ff0be"><div class="ttname"><a href="classSampleHandlerFD.html#a57f378f84f66caa817e52c0bfb5ff0be">SampleHandlerFD::OscChannels</a></div><div class="ttdeci">std::vector&lt; OscChannelInfo &gt; OscChannels</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00301">SampleHandlerFD.h:301</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_af03bf91649d1848a3e531ff7f865c313"><div class="ttname"><a href="classSampleHandlerFD.html#af03bf91649d1848a3e531ff7f865c313">SampleHandlerFD::nDimensions</a></div><div class="ttdeci">int nDimensions</div><div class="ttdoc">Keep track of the dimensions of the sample binning.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00314">SampleHandlerFD.h:314</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_ga46ca9963ed2f9b9b337db72bf52d99e6"><div class="ttname"><a href="group__SampleHandlerGetters.html#ga46ca9963ed2f9b9b337db72bf52d99e6">SampleHandlerFD::GetSampleName</a></div><div class="ttdeci">std::string GetSampleName(int iSample=0) const override</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01321">SampleHandlerFD.cpp:1321</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7da9bc1df59603a15e5164112ba4b72c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7da9bc1df59603a15e5164112ba4b72c">&#9670;&nbsp;</a></span>FindNominalBinAndEdges1D()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::FindNominalBinAndEdges1D </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00974">974</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                                               {</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <span class="comment">//Set rw_pdf_bin and rw_upper_xbinedge and rw_lower_xbinedge for each skmc_base</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> event_i = 0; event_i &lt; <a class="code" href="group__SampleHandlerGetters.html#ga5463cc125470d1f31fbc1ab8f01b60a7">GetNEvents</a>(); event_i++){</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="comment">//Set x_var and y_var values based on XVarStr and YVarStr</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[event_i].x_var = <a class="code" href="classSampleHandlerFD.html#a889f8aeb4ab9e6b6441dabcc484c91c2">GetPointerToKinematicParameter</a>(<a class="code" href="classSampleHandlerFD.html#a5cd052288a69d57c215088e666fa4be3">XVarStr</a>, event_i);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="comment">//Give y_var M3::_BAD_DOUBLE_ value for the 1D case since this won&#39;t be used</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[event_i].y_var = &amp;(<a class="code" href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a>);</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="keywordtype">int</span> bin = <a class="code" href="classSampleHandlerBase.html#adcc9b928dce6e7dddf761f0c13e7b409">_hPDF1D</a>-&gt;FindBin(*(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[event_i].x_var));</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160; </div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="keywordtype">double</span> low_lower_edge = <a class="code" href="namespaceM3.html#af048bd7b66216c875643411b319f17b3">M3::_DEFAULT_RETURN_VAL_</a>;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <span class="keywordflow">if</span> (bin == 0) {</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      low_lower_edge = <a class="code" href="classSampleHandlerBase.html#adcc9b928dce6e7dddf761f0c13e7b409">_hPDF1D</a>-&gt;GetXaxis()-&gt;GetBinLowEdge(bin);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      low_lower_edge = <a class="code" href="classSampleHandlerBase.html#adcc9b928dce6e7dddf761f0c13e7b409">_hPDF1D</a>-&gt;GetXaxis()-&gt;GetBinLowEdge(bin-1);</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    }</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160; </div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="keywordtype">double</span> low_edge = <a class="code" href="classSampleHandlerBase.html#adcc9b928dce6e7dddf761f0c13e7b409">_hPDF1D</a>-&gt;GetXaxis()-&gt;GetBinLowEdge(bin);</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="keywordtype">double</span> upper_edge = <a class="code" href="classSampleHandlerBase.html#adcc9b928dce6e7dddf761f0c13e7b409">_hPDF1D</a>-&gt;GetXaxis()-&gt;GetBinUpEdge(bin);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; </div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordtype">double</span> upper_upper_edge = <a class="code" href="namespaceM3.html#af048bd7b66216c875643411b319f17b3">M3::_DEFAULT_RETURN_VAL_</a>;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="keywordflow">if</span> (bin&lt;(<a class="code" href="classSampleHandlerBase.html#adcc9b928dce6e7dddf761f0c13e7b409">_hPDF1D</a>-&gt;GetNbinsX()-2)) {</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      upper_upper_edge = <a class="code" href="classSampleHandlerBase.html#adcc9b928dce6e7dddf761f0c13e7b409">_hPDF1D</a>-&gt;GetXaxis()-&gt;GetBinLowEdge(bin+2);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      upper_upper_edge = <a class="code" href="classSampleHandlerBase.html#adcc9b928dce6e7dddf761f0c13e7b409">_hPDF1D</a>-&gt;GetXaxis()-&gt;GetBinLowEdge(bin+1);</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    }</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160; </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordflow">if</span> ((bin-1) &gt;= 0 &amp;&amp; (bin-1) &lt; <span class="keywordtype">int</span>(<a class="code" href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">XBinEdges</a>.size()-1)) {</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[event_i].NomXBin = bin-1;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[event_i].NomXBin = -1;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      low_edge = <a class="code" href="namespaceM3.html#af048bd7b66216c875643411b319f17b3">M3::_DEFAULT_RETURN_VAL_</a>;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      upper_edge = <a class="code" href="namespaceM3.html#af048bd7b66216c875643411b319f17b3">M3::_DEFAULT_RETURN_VAL_</a>;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      low_lower_edge = <a class="code" href="namespaceM3.html#af048bd7b66216c875643411b319f17b3">M3::_DEFAULT_RETURN_VAL_</a>;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      upper_upper_edge = <a class="code" href="namespaceM3.html#af048bd7b66216c875643411b319f17b3">M3::_DEFAULT_RETURN_VAL_</a>;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    }</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160; </div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[event_i].NomYBin = 0;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[event_i].rw_lower_xbinedge = low_edge;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[event_i].rw_upper_xbinedge = upper_edge;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[event_i].rw_lower_lower_xbinedge = low_lower_edge;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[event_i].rw_upper_upper_xbinedge = upper_upper_edge;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  }</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a5cd052288a69d57c215088e666fa4be3"><div class="ttname"><a href="classSampleHandlerFD.html#a5cd052288a69d57c215088e666fa4be3">SampleHandlerFD::XVarStr</a></div><div class="ttdeci">std::string XVarStr</div><div class="ttdoc">the strings associated with the variables used for the binning e.g. &quot;RecoNeutrinoEnergy&quot;</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00189">SampleHandlerFD.h:189</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a889f8aeb4ab9e6b6441dabcc484c91c2"><div class="ttname"><a href="classSampleHandlerFD.html#a889f8aeb4ab9e6b6441dabcc484c91c2">SampleHandlerFD::GetPointerToKinematicParameter</a></div><div class="ttdeci">virtual const double * GetPointerToKinematicParameter(std::string KinematicParamter, int iEvent)=0</div></div>
<div class="ttc" id="anamespaceM3_html_a2aed672aeeb4fcf51069966193176ff3"><div class="ttname"><a href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a></div><div class="ttdeci">constexpr static const double _BAD_DOUBLE_</div><div class="ttdoc">Default value used for double initialisation.</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00043">Core.h:43</a></div></div>
<div class="ttc" id="anamespaceM3_html_af048bd7b66216c875643411b319f17b3"><div class="ttname"><a href="namespaceM3.html#af048bd7b66216c875643411b319f17b3">M3::_DEFAULT_RETURN_VAL_</a></div><div class="ttdeci">constexpr static const double _DEFAULT_RETURN_VAL_</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00046">Core.h:46</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5b4c3a7f56f3f7bc352555a0d847ec22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b4c3a7f56f3f7bc352555a0d847ec22">&#9670;&nbsp;</a></span>FindNominalBinAndEdges2D()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::FindNominalBinAndEdges2D </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01069">1069</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                                               {</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  <span class="comment">//Set rw_pdf_bin and rw_upper_xbinedge and rw_lower_xbinedge for each skmc_base</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> event_i = 0 ; event_i &lt; <a class="code" href="group__SampleHandlerGetters.html#ga5463cc125470d1f31fbc1ab8f01b60a7">GetNEvents</a>(); event_i++){</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="comment">//Set x_var and y_var values based on XVarStr and YVarStr</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[event_i].x_var = <a class="code" href="classSampleHandlerFD.html#a889f8aeb4ab9e6b6441dabcc484c91c2">GetPointerToKinematicParameter</a>(<a class="code" href="classSampleHandlerFD.html#a5cd052288a69d57c215088e666fa4be3">XVarStr</a>, event_i);</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[event_i].y_var = <a class="code" href="classSampleHandlerFD.html#a889f8aeb4ab9e6b6441dabcc484c91c2">GetPointerToKinematicParameter</a>(<a class="code" href="classSampleHandlerFD.html#a8fda7dea41c730724a5b3e171a572378">YVarStr</a>, event_i);</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160; </div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <span class="comment">//Global bin number</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="keywordtype">int</span> bin = <a class="code" href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">_hPDF2D</a>-&gt;FindBin(*(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[event_i].x_var), *(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[event_i].y_var));</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160; </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <span class="keywordtype">int</span> bin_x = <a class="code" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a>;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="keywordtype">int</span> bin_y = <a class="code" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a>;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="keywordtype">int</span> bin_z = <a class="code" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a>;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <a class="code" href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">_hPDF2D</a>-&gt;GetBinXYZ(bin, bin_x, bin_y, bin_z);</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <span class="comment">//erec is the x-axis so get GetXaxis then find the bin edges using the x bin number</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160; </div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="keywordtype">double</span> low_lower_edge = <a class="code" href="namespaceM3.html#af048bd7b66216c875643411b319f17b3">M3::_DEFAULT_RETURN_VAL_</a>;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <span class="keywordflow">if</span> (bin == 0) {</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      low_lower_edge = <a class="code" href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">_hPDF2D</a>-&gt;GetXaxis()-&gt;GetBinLowEdge(bin_x);</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;      low_lower_edge = <a class="code" href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">_hPDF2D</a>-&gt;GetXaxis()-&gt;GetBinLowEdge(bin_x-1);</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    }</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160; </div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <span class="keywordtype">double</span> low_edge = <a class="code" href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">_hPDF2D</a>-&gt;GetXaxis()-&gt;GetBinLowEdge(bin_x);</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="keywordtype">double</span> upper_edge = <a class="code" href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">_hPDF2D</a>-&gt;GetXaxis()-&gt;GetBinUpEdge(bin_x);</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160; </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="keywordtype">double</span> upper_upper_edge = <a class="code" href="namespaceM3.html#af048bd7b66216c875643411b319f17b3">M3::_DEFAULT_RETURN_VAL_</a>;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <span class="keywordflow">if</span> (bin&lt;(<a class="code" href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">_hPDF2D</a>-&gt;GetNbinsX()-2)) {</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      upper_upper_edge = <a class="code" href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">_hPDF2D</a>-&gt;GetXaxis()-&gt;GetBinLowEdge(bin_x+2);</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;      upper_upper_edge = <a class="code" href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">_hPDF2D</a>-&gt;GetXaxis()-&gt;GetBinLowEdge(bin_x+1);</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    }</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160; </div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="keywordflow">if</span> ((bin_x-1) &gt;= 0 &amp;&amp; (bin_x-1) &lt; <span class="keywordtype">int</span>(<a class="code" href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">XBinEdges</a>.size()-1)) {</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;      <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[event_i].NomXBin = bin_x-1;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;      <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[event_i].NomXBin = -1;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      low_edge = <a class="code" href="namespaceM3.html#af048bd7b66216c875643411b319f17b3">M3::_DEFAULT_RETURN_VAL_</a>;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;      upper_edge = <a class="code" href="namespaceM3.html#af048bd7b66216c875643411b319f17b3">M3::_DEFAULT_RETURN_VAL_</a>;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      low_lower_edge = <a class="code" href="namespaceM3.html#af048bd7b66216c875643411b319f17b3">M3::_DEFAULT_RETURN_VAL_</a>;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      upper_upper_edge = <a class="code" href="namespaceM3.html#af048bd7b66216c875643411b319f17b3">M3::_DEFAULT_RETURN_VAL_</a>;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    }</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[event_i].NomYBin = bin_y-1;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[event_i].NomYBin &lt; 0){</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Nominal YBin PROBLEM, y-bin is {}&quot;</span>, <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[event_i].NomYBin);</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    }</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[event_i].rw_lower_xbinedge = low_edge;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[event_i].rw_upper_xbinedge = upper_edge;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[event_i].rw_lower_lower_xbinedge = low_lower_edge;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[event_i].rw_upper_upper_xbinedge = upper_upper_edge;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  }</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a8fda7dea41c730724a5b3e171a572378"><div class="ttname"><a href="classSampleHandlerFD.html#a8fda7dea41c730724a5b3e171a572378">SampleHandlerFD::YVarStr</a></div><div class="ttdeci">std::string YVarStr</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00189">SampleHandlerFD.h:189</a></div></div>
<div class="ttc" id="anamespaceM3_html_ac289df32a5b3b05c61a87cbac5702b25"><div class="ttname"><a href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a></div><div class="ttdeci">constexpr static const int _BAD_INT_</div><div class="ttdoc">Default value used for int initialisation.</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00045">Core.h:45</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a57505f631ef8a9501b9036b9ff7a7a49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57505f631ef8a9501b9036b9ff7a7a49">&#9670;&nbsp;</a></span>Get2DVarHist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TH2 * SampleHandlerFD::Get2DVarHist </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVarX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVarY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>SelectionVec</em> = <code>std::vector&lt;&#160;<a class="el" href="structKinematicCut.html">KinematicCut</a>&#160;&gt;()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>AxisX</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>AxisY</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01493">1493</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                                                                                {</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  <span class="comment">//DB Grab the associated enum with the argument string</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;  <span class="keywordtype">int</span> ProjectionVar_IntX = <a class="code" href="group__SampleHandlerGetters.html#gae2769d593f34e8356b545af076818f89">ReturnKinematicParameterFromString</a>(ProjectionVar_StrX);</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;  <span class="keywordtype">int</span> ProjectionVar_IntY = <a class="code" href="group__SampleHandlerGetters.html#gae2769d593f34e8356b545af076818f89">ReturnKinematicParameterFromString</a>(ProjectionVar_StrY);</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160; </div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  <span class="comment">//DB Need to overwrite the Selection member variable so that IsEventSelected function operates correctly.</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  <span class="comment">//   Consequently, store the selection cuts already saved in the sample, overwrite the Selection variable, then reset</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  std::vector&lt; KinematicCut &gt; tmp_Selection = <a class="code" href="classSampleHandlerFD.html#a2b0a7ada3c931e66211eebd91de0c0d0">Selection</a>;</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  std::vector&lt; KinematicCut &gt; SelectionVecToApply;</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160; </div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  <span class="comment">//DB Add all the predefined selections to the selection vector which will be applied</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iSelec=0;iSelec&lt;<a class="code" href="classSampleHandlerFD.html#a2b0a7ada3c931e66211eebd91de0c0d0">Selection</a>.size();iSelec++) {</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    SelectionVecToApply.emplace_back(<a class="code" href="classSampleHandlerFD.html#a2b0a7ada3c931e66211eebd91de0c0d0">Selection</a>[iSelec]);</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;  }</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160; </div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  <span class="comment">//DB Add all requested cuts from the argument to the selection vector which will be applied</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iSelec=0;iSelec&lt;SelectionVec.size();iSelec++) {</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    SelectionVecToApply.emplace_back(SelectionVec[iSelec]);</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;  }</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160; </div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  <span class="comment">//DB Set the member variable to be the cuts to apply</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a2b0a7ada3c931e66211eebd91de0c0d0">Selection</a> = SelectionVecToApply;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160; </div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  <span class="comment">//DB Define the histogram which will be returned</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;  TH2D* _h2DVar;</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;  <span class="keywordflow">if</span> (AxisX &amp;&amp; AxisY) {</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    _h2DVar = <span class="keyword">new</span> TH2D(<span class="stringliteral">&quot;&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,AxisX-&gt;GetNbins(),AxisX-&gt;GetXbins()-&gt;GetArray(),AxisY-&gt;GetNbins(),AxisY-&gt;GetXbins()-&gt;GetArray());</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    std::vector&lt;double&gt; xBinEdges = <a class="code" href="classSampleHandlerFD.html#ac7b638d6d2440fc6ac6ded45059bb8b4">ReturnKinematicParameterBinning</a>(ProjectionVar_StrX);</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    std::vector&lt;double&gt; yBinEdges = <a class="code" href="classSampleHandlerFD.html#ac7b638d6d2440fc6ac6ded45059bb8b4">ReturnKinematicParameterBinning</a>(ProjectionVar_StrY);</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    _h2DVar = <span class="keyword">new</span> TH2D(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="keywordtype">int</span>(xBinEdges.size())-1, xBinEdges.data(), <span class="keywordtype">int</span>(yBinEdges.size())-1, yBinEdges.data());</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  }</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160; </div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;  <span class="comment">//DB Loop over all events</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iEvent = 0; iEvent &lt; <a class="code" href="group__SampleHandlerGetters.html#ga5463cc125470d1f31fbc1ab8f01b60a7">GetNEvents</a>(); iEvent++) {</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#a1ce3d6b9d9f6cce379fe1e8dd404369a">IsEventSelected</a>(iEvent)) {</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;      <span class="keywordtype">double</span> Weight = <a class="code" href="classSampleHandlerFD.html#a9e735d294d926fef87a6fc4c0ec54dca">GetEventWeight</a>(iEvent);</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;      <span class="keywordflow">if</span> (WeightStyle == 1) {</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        Weight = 1.;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;      }</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;      <span class="keywordtype">double</span> VarX = <a class="code" href="classSampleHandlerFD.html#ad0f549802b5625871e11d86905989697">ReturnKinematicParameter</a>(ProjectionVar_IntX, iEvent);</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;      <span class="keywordtype">double</span> VarY = <a class="code" href="classSampleHandlerFD.html#ad0f549802b5625871e11d86905989697">ReturnKinematicParameter</a>(ProjectionVar_IntY, iEvent);</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;      _h2DVar-&gt;Fill(VarX,VarY,Weight);</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    }</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  }</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  </div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;  <span class="comment">//DB Reset the saved selection</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a2b0a7ada3c931e66211eebd91de0c0d0">Selection</a> = tmp_Selection;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160; </div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  <span class="keywordflow">return</span> _h2DVar;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_ac7b638d6d2440fc6ac6ded45059bb8b4"><div class="ttname"><a href="classSampleHandlerFD.html#ac7b638d6d2440fc6ac6ded45059bb8b4">SampleHandlerFD::ReturnKinematicParameterBinning</a></div><div class="ttdeci">virtual std::vector&lt; double &gt; ReturnKinematicParameterBinning(std::string KinematicParameter)=0</div><div class="ttdoc">Return the binning used to draw a kinematic parameter.</div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_gae2769d593f34e8356b545af076818f89"><div class="ttname"><a href="group__SampleHandlerGetters.html#gae2769d593f34e8356b545af076818f89">SampleHandlerFD::ReturnKinematicParameterFromString</a></div><div class="ttdeci">int ReturnKinematicParameterFromString(const std::string &amp;KinematicStr) const</div><div class="ttdoc">ETA function to generically convert a string from xsec cov to a kinematic type.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01549">SampleHandlerFD.cpp:1549</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9e735d294d926fef87a6fc4c0ec54dca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e735d294d926fef87a6fc4c0ec54dca">&#9670;&nbsp;</a></span>GetEventWeight()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> SampleHandlerFD::GetEventWeight </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iEntry</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01335">1335</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                                                                {</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;  <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> totalweight = 1.0;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="preprocessor">  #pragma omp simd</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iParam = 0; iParam &lt; <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEntry].total_weight_pointers.size(); ++iParam) {</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    totalweight *= *(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEntry].total_weight_pointers[iParam]);</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  }</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  </div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;  <span class="keywordflow">return</span> totalweight;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4f8116b84ce4dd9f2ab55983f793fe14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f8116b84ce4dd9f2ab55983f793fe14">&#9670;&nbsp;</a></span>GetLikelihood()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SampleHandlerFD::GetLikelihood </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>DB Multi-threaded GetLikelihood. </p>

<p>Implements <a class="el" href="group__SampleHandlerGetters.html#ga65bbd8a3084731b4bdb0c4d3fcaf641e">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01386">1386</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                                      {</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#adce8040b6fe6501aa4833bbb5ca1163f">SampleHandlerFD_data</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Data sample is empty! Can&#39;t calculate a likelihood!&quot;</span>);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;  }</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    </div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;  <span class="keywordtype">double</span> negLogL = 0.;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="preprocessor">  #pragma omp parallel for collapse(2) reduction(+:negLogL)</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> yBin = 0; yBin &lt; <a class="code" href="classSampleHandlerFD.html#ae48ed0755671be986cb04690b4fa6959">nYBins</a>; ++yBin)</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;  {</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> xBin = 0; xBin &lt; <a class="code" href="classSampleHandlerFD.html#ab933df667fbccf97b3028297ddd8eae2">nXBins</a>; ++xBin)</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    {</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> DataVal = <a class="code" href="classSampleHandlerFD.html#adce8040b6fe6501aa4833bbb5ca1163f">SampleHandlerFD_data</a>[yBin][xBin];</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> MCPred = <a class="code" href="classSampleHandlerFD.html#aab040097a0524dd6aa6cad01c991b5ce">SampleHandlerFD_array</a>[yBin][xBin];</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> w2 = <a class="code" href="classSampleHandlerFD.html#a3905ae0e2531525dba5d663110f86527">SampleHandlerFD_array_w2</a>[yBin][xBin];</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      </div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      <span class="comment">//KS: Calculate likelihood using Barlow-Beeston Poisson or even IceCube</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;      negLogL += <a class="code" href="group__SampleHandlerGetters.html#gac0cfbc3d13eafd3b5687ff739b862b80">GetTestStatLLH</a>(DataVal, MCPred, w2);</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    }</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;  }</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;  <span class="keywordflow">return</span> negLogL;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;}</div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_gac0cfbc3d13eafd3b5687ff739b862b80"><div class="ttname"><a href="group__SampleHandlerGetters.html#gac0cfbc3d13eafd3b5687ff739b862b80">SampleHandlerBase::GetTestStatLLH</a></div><div class="ttdeci">double GetTestStatLLH(double data, double mc) const</div><div class="ttdoc">Calculate test statistic for a single bin using Poisson.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8cpp_source.html#l00099">SampleHandlerBase.cpp:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a64100ff9107ef5ed40945063da3b6eda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64100ff9107ef5ed40945063da3b6eda">&#9670;&nbsp;</a></span>GetPointerToKinematicParameter() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual const double* SampleHandlerFD::GetPointerToKinematicParameter </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>KinematicVariable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iEvent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classPySampleHandlerFD.html#ae52e29c2be892338f4d7b6136529c2b5">PySampleHandlerFD</a>.</p>

</div>
</div>
<a id="a889f8aeb4ab9e6b6441dabcc484c91c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a889f8aeb4ab9e6b6441dabcc484c91c2">&#9670;&nbsp;</a></span>GetPointerToKinematicParameter() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual const double* SampleHandlerFD::GetPointerToKinematicParameter </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>KinematicParamter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iEvent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classPySampleHandlerFD.html#a0d4d12ac851b743d8398632635e237bc">PySampleHandlerFD</a>.</p>

</div>
</div>
<a id="a57a1fbb900f450168181af14d1336a21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57a1fbb900f450168181af14d1336a21">&#9670;&nbsp;</a></span>GetPointerToOscChannel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double * SampleHandlerFD::GetPointerToOscChannel </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iEvent</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01892">1892</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;                                                                      {</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> Channel = <a class="code" href="FarDetectorCoreInfoStruct_8h.html#afc52c63bc2b15ae30444755579f5beb4">GetOscChannel</a>(<a class="code" href="classSampleHandlerFD.html#a57f378f84f66caa817e52c0bfb5ff0be">OscChannels</a>, (*<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].nupdgUnosc), (*<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].nupdg));</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160; </div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;  <span class="keywordflow">return</span> &amp;(<a class="code" href="classSampleHandlerFD.html#a57f378f84f66caa817e52c0bfb5ff0be">OscChannels</a>[Channel].ChannelIndex);</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a09cbb146872131227838a06581103c33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09cbb146872131227838a06581103c33">&#9670;&nbsp;</a></span>Init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void SampleHandlerFD::Init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialise any variables that your experiment specific SampleHandler needs. </p>

<p>Implemented in <a class="el" href="classPySampleHandlerFD.html#a3e39054bb83ce3dfe7a9492e0bec3500">PySampleHandlerFD</a>.</p>

</div>
</div>
<a id="a74209f7f52f81dd0663997e63d49d4e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74209f7f52f81dd0663997e63d49d4e1">&#9670;&nbsp;</a></span>Initialise()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::Initialise </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function which does a lot of the lifting regarding the workflow in creating different MC objects. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00178">178</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                                 {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="comment">//First grab all the information from your sample config via your manager</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a12b800763e6bbcfaa6a527de18bc90f5">ReadSampleConfig</a>();</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="comment">//Now initialise all the variables you will need</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a09cbb146872131227838a06581103c33">Init</a>();</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <a class="code" href="classSampleHandlerBase.html#ab497b52d94868283a8a7cedbd1a4d777">nEvents</a> = <a class="code" href="classSampleHandlerFD.html#a330f801dfd7c0d14326048e93c5a51ae">SetupExperimentMC</a>();</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <a class="code" href="classSampleHandlerFD.html#aaf6d02ac82328fdfd6487e3989e3d383">InitialiseSingleFDMCObject</a>();</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a8e112b4f306f7b792da77f6299535c1b">SetupFDMC</a>();</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;=============================================&quot;</span>);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Total number of events is: {}&quot;</span>, <a class="code" href="group__SampleHandlerGetters.html#ga5463cc125470d1f31fbc1ab8f01b60a7">GetNEvents</a>());</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#af118f92cdc227715e60ca7d76778508f">OscParHandler</a>) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Setting up NuOscillator..&quot;</span>);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">Oscillator</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;You have passed an OscillatorBase object through the constructor of a SampleHandlerFD object - this will be used for all oscillation channels&quot;</span>);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">Oscillator</a>-&gt;isEqualBinningPerOscChannel() != <span class="keyword">true</span>) {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Trying to run shared NuOscillator without EqualBinningPerOscChannel, this will not work&quot;</span>);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keyword">auto</span> OscParams = <a class="code" href="classSampleHandlerFD.html#af118f92cdc227715e60ca7d76778508f">OscParHandler</a>-&gt;<a class="code" href="group__ParameterHandlerGetters.html#gac03f852eed2fd266ac31e7b0188c73bb">GetOscParsFromSampleName</a>(<a class="code" href="classSampleHandlerFD.html#afc09fc72a5d00762fa023ab617f9a54d">SampleName</a>);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="keywordflow">if</span>(OscParams.size() != <a class="code" href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">Oscillator</a>-&gt;GetOscParamsSize()){</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Sample {} with {} has {} osc params, while shared NuOsc has {} osc params&quot;</span>, <a class="code" href="group__SampleHandlerGetters.html#ga80a62c0759d4df18e8d641a3cbceea46">GetTitle</a>(), <a class="code" href="group__SampleHandlerGetters.html#ga46ca9963ed2f9b9b337db72bf52d99e6">GetSampleName</a>(),</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                       OscParams.size(), <a class="code" href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">Oscillator</a>-&gt;GetOscParamsSize());</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;This indicate misconfiguration in your Osc yaml&quot;</span>);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <a class="code" href="classSampleHandlerFD.html#a9fe790616b56940869c438822a79b1de">InitialiseNuOscillatorObjects</a>();</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="classSampleHandlerFD.html#ae4bcbd508ec8d14d36f32911e12af1e9">SetupNuOscillatorPointers</a>();</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Setting up Sample Binning..&quot;</span>);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <a class="code" href="classSampleHandlerFD.html#aded32bec26d70281e5f134e10beda79b">SetupSampleBinning</a>();</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Setting up Splines..&quot;</span>);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a1a984c564107c7207a2611d0bf67d9cc">SetupSplines</a>();</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Setting up Normalisation Pointers..&quot;</span>);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a5fa55fd1e82f8c4fccd5cd77b814f86a">SetupNormParameters</a>();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Setting up Functional Pointers..&quot;</span>);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <a class="code" href="classSampleHandlerFD.html#aed15ee1f6209f26e55bb8e53108a9c6a">SetupFunctionalParameters</a>();</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Setting up Weight Pointers..&quot;</span>);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <a class="code" href="classSampleHandlerFD.html#addd28baa3d823f7a9cd69864185fe399">SetupWeightPointers</a>();</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Setting up Kinematic Map..&quot;</span>);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a61a1e9bbc4f812704278bf655d0d0ae2">SetupKinematicMap</a>();</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;=======================================================&quot;</span>);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerBase_html_ab497b52d94868283a8a7cedbd1a4d777"><div class="ttname"><a href="classSampleHandlerBase.html#ab497b52d94868283a8a7cedbd1a4d777">SampleHandlerBase::nEvents</a></div><div class="ttdeci">unsigned int nEvents</div><div class="ttdoc">Number of MC events are there.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00137">SampleHandlerBase.h:137</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a09cbb146872131227838a06581103c33"><div class="ttname"><a href="classSampleHandlerFD.html#a09cbb146872131227838a06581103c33">SampleHandlerFD::Init</a></div><div class="ttdeci">virtual void Init()=0</div><div class="ttdoc">Initialise any variables that your experiment specific SampleHandler needs.</div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a12b800763e6bbcfaa6a527de18bc90f5"><div class="ttname"><a href="classSampleHandlerFD.html#a12b800763e6bbcfaa6a527de18bc90f5">SampleHandlerFD::ReadSampleConfig</a></div><div class="ttdeci">void ReadSampleConfig()</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00067">SampleHandlerFD.cpp:67</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a1a984c564107c7207a2611d0bf67d9cc"><div class="ttname"><a href="classSampleHandlerFD.html#a1a984c564107c7207a2611d0bf67d9cc">SampleHandlerFD::SetupSplines</a></div><div class="ttdeci">virtual void SetupSplines()=0</div><div class="ttdoc">initialise your splineXX object and then use InitialiseSplineObject to conviently setup everything up</div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a330f801dfd7c0d14326048e93c5a51ae"><div class="ttname"><a href="classSampleHandlerFD.html#a330f801dfd7c0d14326048e93c5a51ae">SampleHandlerFD::SetupExperimentMC</a></div><div class="ttdeci">virtual int SetupExperimentMC()=0</div><div class="ttdoc">Experiment specific setup, returns the number of events which were loaded.</div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a5fa55fd1e82f8c4fccd5cd77b814f86a"><div class="ttname"><a href="classSampleHandlerFD.html#a5fa55fd1e82f8c4fccd5cd77b814f86a">SampleHandlerFD::SetupNormParameters</a></div><div class="ttdeci">void SetupNormParameters()</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00770">SampleHandlerFD.cpp:770</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a61a1e9bbc4f812704278bf655d0d0ae2"><div class="ttname"><a href="classSampleHandlerFD.html#a61a1e9bbc4f812704278bf655d0d0ae2">SampleHandlerFD::SetupKinematicMap</a></div><div class="ttdeci">void SetupKinematicMap()</div><div class="ttdoc">Ensure Kinematic Map is setup and make sure it is initialised correctly.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00230">SampleHandlerFD.cpp:230</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a8e112b4f306f7b792da77f6299535c1b"><div class="ttname"><a href="classSampleHandlerFD.html#a8e112b4f306f7b792da77f6299535c1b">SampleHandlerFD::SetupFDMC</a></div><div class="ttdeci">virtual void SetupFDMC()=0</div><div class="ttdoc">Function which translates experiment struct into core struct.</div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a9fe790616b56940869c438822a79b1de"><div class="ttname"><a href="classSampleHandlerFD.html#a9fe790616b56940869c438822a79b1de">SampleHandlerFD::InitialiseNuOscillatorObjects</a></div><div class="ttdeci">void InitialiseNuOscillatorObjects()</div><div class="ttdoc">including Dan's magic NuOscillator</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01225">SampleHandlerFD.cpp:1225</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_aaf6d02ac82328fdfd6487e3989e3d383"><div class="ttname"><a href="classSampleHandlerFD.html#aaf6d02ac82328fdfd6487e3989e3d383">SampleHandlerFD::InitialiseSingleFDMCObject</a></div><div class="ttdeci">void InitialiseSingleFDMCObject()</div><div class="ttdoc">function to create the member of the FarDetectorInfo struct so they are the appropriate size.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01412">SampleHandlerFD.cpp:1412</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_addd28baa3d823f7a9cd69864185fe399"><div class="ttname"><a href="classSampleHandlerFD.html#addd28baa3d823f7a9cd69864185fe399">SampleHandlerFD::SetupWeightPointers</a></div><div class="ttdeci">virtual void SetupWeightPointers()=0</div><div class="ttdoc">DB Function to determine which weights apply to which types of samples pure virtual!...</div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_aded32bec26d70281e5f134e10beda79b"><div class="ttname"><a href="classSampleHandlerFD.html#aded32bec26d70281e5f134e10beda79b">SampleHandlerFD::SetupSampleBinning</a></div><div class="ttdeci">void SetupSampleBinning()</div><div class="ttdoc">wrapper to call set binning functions based on sample config info</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00280">SampleHandlerFD.cpp:280</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ae4bcbd508ec8d14d36f32911e12af1e9"><div class="ttname"><a href="classSampleHandlerFD.html#ae4bcbd508ec8d14d36f32911e12af1e9">SampleHandlerFD::SetupNuOscillatorPointers</a></div><div class="ttdeci">void SetupNuOscillatorPointers()</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01283">SampleHandlerFD.cpp:1283</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_aed15ee1f6209f26e55bb8e53108a9c6a"><div class="ttname"><a href="classSampleHandlerFD.html#aed15ee1f6209f26e55bb8e53108a9c6a">SampleHandlerFD::SetupFunctionalParameters</a></div><div class="ttdeci">virtual void SetupFunctionalParameters()</div><div class="ttdoc">ETA - a function to setup and pass values to functional parameters where you need to pass a value to ...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00648">SampleHandlerFD.cpp:648</a></div></div>
<div class="ttc" id="agroup__ParameterHandlerGetters_html_gac03f852eed2fd266ac31e7b0188c73bb"><div class="ttname"><a href="group__ParameterHandlerGetters.html#gac03f852eed2fd266ac31e7b0188c73bb">ParameterHandlerOsc::GetOscParsFromSampleName</a></div><div class="ttdeci">std::vector&lt; const double * &gt; GetOscParsFromSampleName(const std::string &amp;SampleName)</div><div class="ttdoc">Get pointers to Osc params from Sample name.</div><div class="ttdef"><b>Definition:</b> <a href="ParameterHandlerOsc_8cpp_source.html#l00113">ParameterHandlerOsc.cpp:113</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_ga80a62c0759d4df18e8d641a3cbceea46"><div class="ttname"><a href="group__SampleHandlerGetters.html#ga80a62c0759d4df18e8d641a3cbceea46">SampleHandlerFD::GetTitle</a></div><div class="ttdeci">std::string GetTitle() const override</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00035">SampleHandlerFD.h:35</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9fe790616b56940869c438822a79b1de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fe790616b56940869c438822a79b1de">&#9670;&nbsp;</a></span>InitialiseNuOscillatorObjects()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::InitialiseNuOscillatorObjects </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>including Dan's magic NuOscillator </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01225">1225</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                                                    {</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classSampleHandlerFD.html#af118f92cdc227715e60ca7d76778508f">OscParHandler</a>) {</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Attempted to setup NuOscillator without ParameterHandler object&quot;</span>);</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  }</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  <span class="keyword">auto</span> NuOscillatorConfigFile = Get&lt;std::string&gt;(<a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;NuOsc&quot;</span>][<span class="stringliteral">&quot;NuOscConfigFile&quot;</span>], __FILE__ , __LINE__);</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  <span class="keyword">auto</span> EqualBinningPerOscChannel = Get&lt;bool&gt;(<a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;NuOsc&quot;</span>][<span class="stringliteral">&quot;EqualBinningPerOscChannel&quot;</span>], __FILE__ , __LINE__);</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160; </div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  <span class="comment">// TN override the sample setting if not using binned oscillation</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  <span class="keywordflow">if</span> (EqualBinningPerOscChannel) {</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordflow">if</span> (YAML::LoadFile(NuOscillatorConfigFile)[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;CalculationType&quot;</span>].as&lt;std::string&gt;() == <span class="stringliteral">&quot;Unbinned&quot;</span>) {</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Tried using EqualBinningPerOscChannel while using Unbinned oscillation calculation, changing EqualBinningPerOscChannel to false&quot;</span>);</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      EqualBinningPerOscChannel = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    }</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;  }</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  std::vector&lt;const double*&gt; OscParams = <a class="code" href="classSampleHandlerFD.html#af118f92cdc227715e60ca7d76778508f">OscParHandler</a>-&gt;<a class="code" href="group__ParameterHandlerGetters.html#gac03f852eed2fd266ac31e7b0188c73bb">GetOscParsFromSampleName</a>(<a class="code" href="classSampleHandlerFD.html#afc09fc72a5d00762fa023ab617f9a54d">SampleName</a>);</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  <span class="keywordflow">if</span> (OscParams.empty()) {</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;OscParams is empty for sample &#39;{}&#39;.&quot;</span>, <a class="code" href="group__SampleHandlerGetters.html#ga80a62c0759d4df18e8d641a3cbceea46">GetTitle</a>());</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;This likely indicates an error in your oscillation YAML configuration.&quot;</span>);</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;  }</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  <a class="code" href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">Oscillator</a> = std::make_shared&lt;OscillationHandler&gt;(NuOscillatorConfigFile, EqualBinningPerOscChannel, OscParams, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerFD.html#a57f378f84f66caa817e52c0bfb5ff0be">OscChannels</a>.size()));</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160; </div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  <span class="keywordflow">if</span> (!EqualBinningPerOscChannel) {</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iChannel = 0; iChannel &lt; static_cast&lt;int&gt;(<a class="code" href="classSampleHandlerFD.html#a57f378f84f66caa817e52c0bfb5ff0be">OscChannels</a>.size()); iChannel++) {</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      std::vector&lt;M3::float_t&gt; EnergyArray;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;      std::vector&lt;M3::float_t&gt; CosineZArray;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160; </div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iEvent = 0; iEvent &lt; <a class="code" href="group__SampleHandlerGetters.html#ga5463cc125470d1f31fbc1ab8f01b60a7">GetNEvents</a>(); iEvent++) {</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        <span class="comment">// KS: This is bit weird but we basically loop over all events and push to vector only these which are part of a given OscChannel</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> Channel = <a class="code" href="FarDetectorCoreInfoStruct_8h.html#afc52c63bc2b15ae30444755579f5beb4">GetOscChannel</a>(<a class="code" href="classSampleHandlerFD.html#a57f378f84f66caa817e52c0bfb5ff0be">OscChannels</a>, (*<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].nupdgUnosc), (*<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].nupdg));</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        <span class="comment">//DB Remove NC events from the arrays which are handed to the NuOscillator objects</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].isNC &amp;&amp; Channel == iChannel) {</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;          EnergyArray.push_back(<a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>(*(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].rw_etru)));</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        }</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      }</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      std::sort(EnergyArray.begin(),EnergyArray.end());</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160; </div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      <span class="comment">//============================================================================</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;      <span class="comment">//DB Atmospheric only part, can only happen if truecz has been initialised within the experiment specific code</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;      <span class="keywordflow">if</span> (*(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[0].rw_truecz) != <a class="code" href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a>) {</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iEvent = 0; iEvent &lt; <a class="code" href="group__SampleHandlerGetters.html#ga5463cc125470d1f31fbc1ab8f01b60a7">GetNEvents</a>(); iEvent++) {</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;          <span class="comment">// KS: This is bit weird but we basically loop over all events and push to vector only these which are part of a given OscChannel</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> Channel = <a class="code" href="FarDetectorCoreInfoStruct_8h.html#afc52c63bc2b15ae30444755579f5beb4">GetOscChannel</a>(<a class="code" href="classSampleHandlerFD.html#a57f378f84f66caa817e52c0bfb5ff0be">OscChannels</a>, (*<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].nupdgUnosc), (*<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].nupdg));</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;          <span class="comment">//DB Remove NC events from the arrays which are handed to the NuOscillator objects</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].isNC &amp;&amp; Channel == iChannel) {</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;            CosineZArray.push_back(<a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>(*(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].rw_truecz)));</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;          }</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        }</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        std::sort(CosineZArray.begin(),CosineZArray.end());</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;      }</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;      <a class="code" href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">Oscillator</a>-&gt;SetOscillatorBinning(iChannel, EnergyArray, CosineZArray);</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    } <span class="comment">// end loop over channels</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  }</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aaf6d02ac82328fdfd6487e3989e3d383"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf6d02ac82328fdfd6487e3989e3d383">&#9670;&nbsp;</a></span>InitialiseSingleFDMCObject()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::InitialiseSingleFDMCObject </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>function to create the member of the FarDetectorInfo struct so they are the appropriate size. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01412">1412</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                                                 {</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;  <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>.resize(<a class="code" href="classSampleHandlerBase.html#ab497b52d94868283a8a7cedbd1a4d777">nEvents</a>);</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2918509fadc1dac47d423f161b619cc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2918509fadc1dac47d423f161b619cc4">&#9670;&nbsp;</a></span>InitialiseSplineObject()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::InitialiseSplineObject </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01416">1416</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                                             {</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;  std::vector&lt;std::string&gt; spline_filepaths;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> iChannel = 0 ; iChannel &lt; <a class="code" href="classSampleHandlerFD.html#a57f378f84f66caa817e52c0bfb5ff0be">OscChannels</a>.size() ; iChannel++){</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    spline_filepaths.push_back(<a class="code" href="classSampleHandlerFD.html#a4a02e96c7d7731097c7c10660d23b3a5">spline_files</a>[iChannel]);</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;  }</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160; </div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;  <span class="comment">//Keep a track of the spline variables</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a0d4d75bc7d6611e0eab5501311bd38f0">SplineVarNames</a>.push_back(<span class="stringliteral">&quot;TrueNeutrinoEnergy&quot;</span>);</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#a5cd052288a69d57c215088e666fa4be3">XVarStr</a>.length() &gt; 0){</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a0d4d75bc7d6611e0eab5501311bd38f0">SplineVarNames</a>.push_back(<a class="code" href="classSampleHandlerFD.html#a5cd052288a69d57c215088e666fa4be3">XVarStr</a>);</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  }</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#a8fda7dea41c730724a5b3e171a572378">YVarStr</a>.length() &gt; 0){</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a0d4d75bc7d6611e0eab5501311bd38f0">SplineVarNames</a>.push_back(<a class="code" href="classSampleHandlerFD.html#a8fda7dea41c730724a5b3e171a572378">YVarStr</a>);</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;  }</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;  </div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">SplineHandler</a>-&gt;AddSample(<a class="code" href="classSampleHandlerFD.html#afc09fc72a5d00762fa023ab617f9a54d">SampleName</a>, spline_filepaths, <a class="code" href="classSampleHandlerFD.html#a0d4d75bc7d6611e0eab5501311bd38f0">SplineVarNames</a>);</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">SplineHandler</a>-&gt;CountNumberOfLoadedSplines(<span class="keyword">false</span>, 1);</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">SplineHandler</a>-&gt;TransferToMonolith();</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160; </div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;--------------------------------&quot;</span>);</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Setup Far Detector splines&quot;</span>);</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160; </div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a64b2af7680c88713c70f064fb7574184">FillSplineBins</a>();</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160; </div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">SplineHandler</a>-&gt;cleanUpMemory();</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a0d4d75bc7d6611e0eab5501311bd38f0"><div class="ttname"><a href="classSampleHandlerFD.html#a0d4d75bc7d6611e0eab5501311bd38f0">SampleHandlerFD::SplineVarNames</a></div><div class="ttdeci">std::vector&lt; std::string &gt; SplineVarNames</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00190">SampleHandlerFD.h:190</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a4a02e96c7d7731097c7c10660d23b3a5"><div class="ttname"><a href="classSampleHandlerFD.html#a4a02e96c7d7731097c7c10660d23b3a5">SampleHandlerFD::spline_files</a></div><div class="ttdeci">std::vector&lt; std::string &gt; spline_files</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00352">SampleHandlerFD.h:352</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a64b2af7680c88713c70f064fb7574184"><div class="ttname"><a href="classSampleHandlerFD.html#a64b2af7680c88713c70f064fb7574184">SampleHandlerFD::FillSplineBins</a></div><div class="ttdeci">void FillSplineBins()</div><div class="ttdoc">Finds the binned spline that an event should apply to and stored them in a a vector for easy evaluati...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01350">SampleHandlerFD.cpp:1350</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1ce3d6b9d9f6cce379fe1e8dd404369a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ce3d6b9d9f6cce379fe1e8dd404369a">&#9670;&nbsp;</a></span>IsEventSelected()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool SampleHandlerFD::IsEventSelected </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iEvent</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>DB Function which determines if an event is selected, where Selection double looks like {{ND280KinematicTypes Var1, douuble LowBound}. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00336">336</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                                                      {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iSelection=0;iSelection &lt; <a class="code" href="classSampleHandlerFD.html#a2b0a7ada3c931e66211eebd91de0c0d0">Selection</a>.size() ;iSelection++) {  </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> Val = <a class="code" href="classSampleHandlerFD.html#ad0f549802b5625871e11d86905989697">ReturnKinematicParameter</a>(<a class="code" href="classSampleHandlerFD.html#a2b0a7ada3c931e66211eebd91de0c0d0">Selection</a>[iSelection].ParamToCutOnIt, iEvent);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">if</span> ((Val &lt; <a class="code" href="classSampleHandlerFD.html#a2b0a7ada3c931e66211eebd91de0c0d0">Selection</a>[iSelection].LowerBound) || (Val &gt;= <a class="code" href="classSampleHandlerFD.html#a2b0a7ada3c931e66211eebd91de0c0d0">Selection</a>[iSelection].UpperBound)) {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  }</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="comment">//DB To avoid unnecessary checks, now return false rather than setting bool to true and continuing to check</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a691a4ec2c4c82b3c4437ead052644a54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a691a4ec2c4c82b3c4437ead052644a54">&#9670;&nbsp;</a></span>PrepFunctionalParameters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void SampleHandlerFD::PrepFunctionalParameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update the functional parameter values to the latest propsed values. Needs to be called before every new reweight so is called in fillArray. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00205">205</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;{};</div>
</div><!-- fragment -->
</div>
</div>
<a id="af6873a444da656d651d4ada07345c0ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6873a444da656d651d4ada07345c0ae">&#9670;&nbsp;</a></span>PrintIntegral()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::PrintIntegral </td>
          <td>(</td>
          <td class="paramtype">TString&#160;</td>
          <td class="paramname"><em>OutputName</em> = <code>&quot;/dev/null&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TString&#160;</td>
          <td class="paramname"><em>OutputCSVName</em> = <code>&quot;/dev/null&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01678">1678</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                                                                                                      {</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;  <span class="keywordtype">int</span> space = 14;</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160; </div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;  <span class="keywordtype">bool</span> printToFile=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;  <span class="keywordflow">if</span> (OutputFileName.CompareTo(<span class="stringliteral">&quot;/dev/null&quot;</span>)) {printToFile = <span class="keyword">true</span>;}</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160; </div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;  <span class="keywordtype">bool</span> printToCSV=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;  <span class="keywordflow">if</span>(OutputCSVFileName.CompareTo(<span class="stringliteral">&quot;/dev/null&quot;</span>)) printToCSV=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  </div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;  std::ofstream outfile;</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;  <span class="keywordflow">if</span> (printToFile) {</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    outfile.open(OutputFileName.Data(), std::ios_base::app);</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    outfile.precision(7);</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  }</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160; </div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;  std::ofstream outcsv;</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  <span class="keywordflow">if</span>(printToCSV){</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    outcsv.open(OutputCSVFileName, std::ios_base::app); <span class="comment">// Appened to CSV</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    outcsv.precision(7);</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;  }</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160; </div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  <span class="keywordtype">double</span> PDFIntegral = 0.;</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160; </div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  std::vector&lt; std::vector&lt; TH1* &gt; &gt; IntegralList;</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  IntegralList.resize(<a class="code" href="classSampleHandlerBase.html#ab9f61ca5c8abb03d4d84947e9bfa7943">Modes</a>-&gt;<a class="code" href="classMaCh3Modes.html#a1996581eab0194698a4ddccf3b189d49">GetNModes</a>());</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160; </div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  std::vector&lt;double&gt; ChannelIntegral;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;  ChannelIntegral.resize(<a class="code" href="group__SampleHandlerGetters.html#ga72d58e162b82d2fe895087d91c07c0a2">GetNOscChannels</a>());</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;ChannelIntegral.size();i++) {ChannelIntegral[i] = 0.;}</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  </div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classSampleHandlerBase.html#ab9f61ca5c8abb03d4d84947e9bfa7943">Modes</a>-&gt;<a class="code" href="classMaCh3Modes.html#a1996581eab0194698a4ddccf3b189d49">GetNModes</a>();i++) {</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__SampleHandlerGetters.html#ga3f9eb0131a6e1f7d4bd411902f4425ca">GetNDim</a>()==1) {</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      IntegralList[i] = <a class="code" href="group__SampleHandlerGetters.html#gac7f3dd7b022e7c0714ab12db1184eb47">ReturnHistsBySelection1D</a>(<a class="code" href="classSampleHandlerFD.html#a5cd052288a69d57c215088e666fa4be3">XVarStr</a>,1,i,WeightStyle);</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;      IntegralList[i] = CastVector&lt;TH2, TH1&gt;(<a class="code" href="group__SampleHandlerGetters.html#ga7aa8723e32e056e1247341d41378ab60">ReturnHistsBySelection2D</a>(<a class="code" href="classSampleHandlerFD.html#a5cd052288a69d57c215088e666fa4be3">XVarStr</a>,<a class="code" href="classSampleHandlerFD.html#a8fda7dea41c730724a5b3e171a572378">YVarStr</a>,1,i,WeightStyle));</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    }</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  }</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160; </div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;-------------------------------------------------&quot;</span>);</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160; </div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  <span class="keywordflow">if</span> (printToFile) {</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    outfile &lt;&lt; <span class="stringliteral">&quot;\\begin{table}[ht]&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    outfile &lt;&lt; <span class="stringliteral">&quot;\\begin{center}&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    outfile &lt;&lt; <span class="stringliteral">&quot;\\caption{Integral breakdown for sample: &quot;</span> &lt;&lt; <a class="code" href="group__SampleHandlerGetters.html#ga80a62c0759d4df18e8d641a3cbceea46">GetTitle</a>() &lt;&lt; <span class="stringliteral">&quot;}&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    outfile &lt;&lt; <span class="stringliteral">&quot;\\label{&quot;</span> &lt;&lt; <a class="code" href="group__SampleHandlerGetters.html#ga80a62c0759d4df18e8d641a3cbceea46">GetTitle</a>() &lt;&lt; <span class="stringliteral">&quot;-EventRate}&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    </div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    TString nColumns;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="group__SampleHandlerGetters.html#ga72d58e162b82d2fe895087d91c07c0a2">GetNOscChannels</a>();i++) {nColumns+=<span class="stringliteral">&quot;|c&quot;</span>;}</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    nColumns += <span class="stringliteral">&quot;|c|&quot;</span>;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    outfile &lt;&lt; <span class="stringliteral">&quot;\\begin{tabular}{|l&quot;</span> &lt;&lt; nColumns.Data() &lt;&lt; <span class="stringliteral">&quot;}&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    outfile &lt;&lt; <span class="stringliteral">&quot;\\hline&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  }</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160; </div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  <span class="keywordflow">if</span>(printToCSV){</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    <span class="comment">// HW Probably a better way but oh well, here I go making MaCh3 messy again</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    outcsv&lt;&lt;<span class="stringliteral">&quot;Integral Breakdown for sample :&quot;</span>&lt;&lt;<a class="code" href="group__SampleHandlerGetters.html#ga80a62c0759d4df18e8d641a3cbceea46">GetTitle</a>()&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;  }</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;  </div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Integral breakdown for sample: {}&quot;</span>, <a class="code" href="group__SampleHandlerGetters.html#ga80a62c0759d4df18e8d641a3cbceea46">GetTitle</a>());</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160; </div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;  <span class="keywordflow">if</span> (printToFile) {outfile &lt;&lt; std::setw(space) &lt;&lt; <span class="stringliteral">&quot;Mode:&quot;</span>;}</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;  <span class="keywordflow">if</span>(printToCSV) {outcsv&lt;&lt;<span class="stringliteral">&quot;Mode,&quot;</span>;}</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160; </div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;  std::string table_headings = fmt::format(<span class="stringliteral">&quot;| {:&lt;8} |&quot;</span>, <span class="stringliteral">&quot;Mode&quot;</span>);</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  std::string table_footline = <span class="stringliteral">&quot;------------&quot;</span>; <span class="comment">//Scalable table horizontal line</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0;i &lt; <a class="code" href="classSampleHandlerFD.html#a57f378f84f66caa817e52c0bfb5ff0be">OscChannels</a>.size(); i++) {</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    table_headings += fmt::format(<span class="stringliteral">&quot; {:&lt;17} |&quot;</span>, <a class="code" href="classSampleHandlerFD.html#a57f378f84f66caa817e52c0bfb5ff0be">OscChannels</a>[i].flavourName);</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    table_footline += <span class="stringliteral">&quot;--------------------&quot;</span>;</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    <span class="keywordflow">if</span> (printToFile) {outfile &lt;&lt; <span class="stringliteral">&quot;&amp;&quot;</span> &lt;&lt; std::setw(space) &lt;&lt; <a class="code" href="classSampleHandlerFD.html#a57f378f84f66caa817e52c0bfb5ff0be">OscChannels</a>[i].flavourName_Latex &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;}</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    <span class="keywordflow">if</span> (printToCSV)  {outcsv &lt;&lt; <a class="code" href="classSampleHandlerFD.html#a57f378f84f66caa817e52c0bfb5ff0be">OscChannels</a>[i].flavourName &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;}</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;  }</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;  <span class="keywordflow">if</span> (printToFile) {outfile &lt;&lt; <span class="stringliteral">&quot;&amp;&quot;</span> &lt;&lt; std::setw(space) &lt;&lt; <span class="stringliteral">&quot;Total:&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\\\\ \\hline&quot;</span> &lt;&lt; std::endl;}</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;  <span class="keywordflow">if</span> (printToCSV)  {outcsv &lt;&lt;<span class="stringliteral">&quot;Total\n&quot;</span>;}</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;  table_headings += fmt::format(<span class="stringliteral">&quot; {:&lt;10} |&quot;</span>, <span class="stringliteral">&quot;Total&quot;</span>);</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  table_footline += <span class="stringliteral">&quot;-------------&quot;</span>;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160; </div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{}&quot;</span>, table_headings);</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{}&quot;</span>, table_footline);</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;  </div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;IntegralList.size();i++) {</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <span class="keywordtype">double</span> ModeIntegral = 0;</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <span class="keywordflow">if</span> (printToFile) {outfile &lt;&lt; std::setw(space) &lt;&lt; <a class="code" href="classSampleHandlerBase.html#ab9f61ca5c8abb03d4d84947e9bfa7943">Modes</a>-&gt;<a class="code" href="classMaCh3Modes.html#abf4ac35511787907bc16ae26aa6c2a15">GetMaCh3ModeName</a>(i);}</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    <span class="keywordflow">if</span>(printToCSV)   {outcsv &lt;&lt; <a class="code" href="classSampleHandlerBase.html#ab9f61ca5c8abb03d4d84947e9bfa7943">Modes</a>-&gt;<a class="code" href="classMaCh3Modes.html#abf4ac35511787907bc16ae26aa6c2a15">GetMaCh3ModeName</a>(i) &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;}</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160; </div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    table_headings = fmt::format(<span class="stringliteral">&quot;| {:&lt;8} |&quot;</span>, <a class="code" href="classSampleHandlerBase.html#ab9f61ca5c8abb03d4d84947e9bfa7943">Modes</a>-&gt;<a class="code" href="classMaCh3Modes.html#abf4ac35511787907bc16ae26aa6c2a15">GetMaCh3ModeName</a>(i)); <span class="comment">//Start string with mode name</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160; </div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0;j&lt;IntegralList[i].size();j++) {</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;      <span class="keywordtype">double</span> Integral = IntegralList[i][j]-&gt;Integral();</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160; </div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;      <span class="keywordflow">if</span> (Integral&lt;1e-100) {Integral=0;}</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160; </div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;      ModeIntegral += Integral;</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;      ChannelIntegral[j] += Integral;</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;      PDFIntegral += Integral;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;      </div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;      <span class="keywordflow">if</span> (printToFile) {outfile &lt;&lt; <span class="stringliteral">&quot;&amp;&quot;</span> &lt;&lt; std::setw(space) &lt;&lt; Form(<span class="stringliteral">&quot;%4.5f&quot;</span>,Integral) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;}</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;      <span class="keywordflow">if</span> (printToCSV)  {outcsv &lt;&lt; Form(<span class="stringliteral">&quot;%4.5f&quot;</span>, Integral) &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;}</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160; </div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;      table_headings += fmt::format(<span class="stringliteral">&quot; {:&lt;17.4f} |&quot;</span>, Integral);</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    }</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    <span class="keywordflow">if</span> (printToFile) {outfile &lt;&lt; <span class="stringliteral">&quot;&amp;&quot;</span> &lt;&lt; std::setw(space) &lt;&lt; Form(<span class="stringliteral">&quot;%4.5f&quot;</span>,ModeIntegral) &lt;&lt;  <span class="stringliteral">&quot; \\\\ \\hline&quot;</span> &lt;&lt; std::endl;}</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    <span class="keywordflow">if</span> (printToCSV)  {outcsv &lt;&lt; Form(<span class="stringliteral">&quot;%4.5f&quot;</span>, ModeIntegral) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;}</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    </div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    table_headings += fmt::format(<span class="stringliteral">&quot; {:&lt;10.4f} |&quot;</span>, ModeIntegral);</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    </div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{}&quot;</span>, table_headings);</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;  }</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160; </div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;  <span class="keywordflow">if</span> (printToFile) {outfile &lt;&lt; std::setw(space) &lt;&lt; <span class="stringliteral">&quot;Total:&quot;</span>;}</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;  <span class="keywordflow">if</span> (printToCSV)  {outcsv &lt;&lt; <span class="stringliteral">&quot;Total,&quot;</span>;}</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160; </div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;  <span class="comment">//Clear the table_headings to print last row of totals</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;  table_headings = fmt::format(<span class="stringliteral">&quot;| {:&lt;8} |&quot;</span>, <span class="stringliteral">&quot;Total&quot;</span>);</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;ChannelIntegral.size();i++) {</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    <span class="keywordflow">if</span> (printToFile) {outfile &lt;&lt; <span class="stringliteral">&quot;&amp;&quot;</span> &lt;&lt; std::setw(space) &lt;&lt; Form(<span class="stringliteral">&quot;%4.5f&quot;</span>,ChannelIntegral[i]) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;}</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    <span class="keywordflow">if</span> (printToCSV)  {outcsv &lt;&lt; Form(<span class="stringliteral">&quot;%4.5f&quot;</span>, ChannelIntegral[i]) &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;}</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    table_headings += fmt::format(<span class="stringliteral">&quot; {:&lt;17.4f} |&quot;</span>, ChannelIntegral[i]);</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;  }</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;  <span class="keywordflow">if</span> (printToFile) {outfile &lt;&lt; <span class="stringliteral">&quot;&amp;&quot;</span> &lt;&lt; std::setw(space) &lt;&lt; Form(<span class="stringliteral">&quot;%4.5f&quot;</span>,PDFIntegral) &lt;&lt; <span class="stringliteral">&quot; \\\\ \\hline&quot;</span> &lt;&lt; std::endl;}</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;  <span class="keywordflow">if</span> (printToCSV)  {outcsv &lt;&lt; Form(<span class="stringliteral">&quot;%4.5f&quot;</span>, PDFIntegral) &lt;&lt; <span class="stringliteral">&quot;\n\n\n\n&quot;</span>;} <span class="comment">// Let&#39;s have a few new lines!</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160; </div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;  table_headings += fmt::format(<span class="stringliteral">&quot; {:&lt;10.4f} |&quot;</span>, PDFIntegral);</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{}&quot;</span>, table_headings);</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{}&quot;</span>, table_footline);</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160; </div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;  <span class="keywordflow">if</span> (printToFile) {</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    outfile &lt;&lt; <span class="stringliteral">&quot;\\end{tabular}&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    outfile &lt;&lt; <span class="stringliteral">&quot;\\end{center}&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    outfile &lt;&lt; <span class="stringliteral">&quot;\\end{table}&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;  }</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160; </div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160; </div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;  <span class="keywordflow">if</span> (printToFile) {</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    outfile &lt;&lt; std::endl;</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    outfile.close();</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;  }</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;}</div>
<div class="ttc" id="aclassMaCh3Modes_html_a1996581eab0194698a4ddccf3b189d49"><div class="ttname"><a href="classMaCh3Modes.html#a1996581eab0194698a4ddccf3b189d49">MaCh3Modes::GetNModes</a></div><div class="ttdeci">int GetNModes() const</div><div class="ttdoc">KS: Get number of modes, keep in mind actual number is +1 greater due to unknown category.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Modes_8h_source.html#l00052">MaCh3Modes.h:52</a></div></div>
<div class="ttc" id="aclassMaCh3Modes_html_abf4ac35511787907bc16ae26aa6c2a15"><div class="ttname"><a href="classMaCh3Modes.html#abf4ac35511787907bc16ae26aa6c2a15">MaCh3Modes::GetMaCh3ModeName</a></div><div class="ttdeci">std::string GetMaCh3ModeName(const int Index)</div><div class="ttdoc">KS: Get normal name of mode, if mode not known you will get UNKNOWN_BAD.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Modes_8cpp_source.html#l00138">MaCh3Modes.cpp:138</a></div></div>
<div class="ttc" id="aclassSampleHandlerBase_html_ab9f61ca5c8abb03d4d84947e9bfa7943"><div class="ttname"><a href="classSampleHandlerBase.html#ab9f61ca5c8abb03d4d84947e9bfa7943">SampleHandlerBase::Modes</a></div><div class="ttdeci">MaCh3Modes * Modes</div><div class="ttdoc">Holds information about used Generator and MaCh3 modes.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00140">SampleHandlerBase.h:140</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_ga72d58e162b82d2fe895087d91c07c0a2"><div class="ttname"><a href="group__SampleHandlerGetters.html#ga72d58e162b82d2fe895087d91c07c0a2">SampleHandlerFD::GetNOscChannels</a></div><div class="ttdeci">int GetNOscChannels()</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00069">SampleHandlerFD.h:69</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_ga7aa8723e32e056e1247341d41378ab60"><div class="ttname"><a href="group__SampleHandlerGetters.html#ga7aa8723e32e056e1247341d41378ab60">SampleHandlerFD::ReturnHistsBySelection2D</a></div><div class="ttdeci">std::vector&lt; TH2 * &gt; ReturnHistsBySelection2D(std::string KinematicProjectionX, std::string KinematicProjectionY, int Selection1, int Selection2=-1, int WeightStyle=0, TAxis *XAxis=0, TAxis *YAxis=0)</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01854">SampleHandlerFD.cpp:1854</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_gac7f3dd7b022e7c0714ab12db1184eb47"><div class="ttname"><a href="group__SampleHandlerGetters.html#gac7f3dd7b022e7c0714ab12db1184eb47">SampleHandlerFD::ReturnHistsBySelection1D</a></div><div class="ttdeci">std::vector&lt; TH1 * &gt; ReturnHistsBySelection1D(std::string KinematicProjection, int Selection1, int Selection2=-1, int WeightStyle=0, TAxis *Axis=0)</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01818">SampleHandlerFD.cpp:1818</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a12b800763e6bbcfaa6a527de18bc90f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12b800763e6bbcfaa6a527de18bc90f5">&#9670;&nbsp;</a></span>ReadSampleConfig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::ReadSampleConfig </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00067">67</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;{</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keyword">auto</span> ModeName = Get&lt;std::string&gt;(<a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;MaCh3ModeConfig&quot;</span>], __FILE__ , __LINE__);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <a class="code" href="classSampleHandlerBase.html#ab9f61ca5c8abb03d4d84947e9bfa7943">Modes</a> = <span class="keyword">new</span> <a class="code" href="classMaCh3Modes.html">MaCh3Modes</a>(ModeName);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">//SampleTitle has to be provided in the sample yaml otherwise this will throw an exception</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a1ebc5e194703ef6b9d3c7e4994417d60">SampleTitle</a> = Get&lt;std::string&gt;(<a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;SampleTitle&quot;</span>], __FILE__ , __LINE__);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">//SampleName has to be provided in the sample yaml otherwise this will throw an exception</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="classSampleHandlerFD.html#afc09fc72a5d00762fa023ab617f9a54d">SampleName</a> = Get&lt;std::string&gt;(<a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;SampleName&quot;</span>], __FILE__ , __LINE__);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="classSampleHandlerBase.html#a87670dbcda5d09b09675e8f407fe3a30">fTestStatistic</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67">TestStatistic</a><span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;GetMCStatLLH());</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="YamlHelper_8h.html#ad2340a340fd6649a6d220abc16d4757b">CheckNodeExists</a>(<a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;raw(), <span class="stringliteral">&quot;LikelihoodOptions&quot;</span>)) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="classSampleHandlerFD.html#aa654562842a0da51ff917aaed517310e">UpdateW2</a> = GetFromManager&lt;bool&gt;(<a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;LikelihoodOptions&quot;</span>][<span class="stringliteral">&quot;UpdateW2&quot;</span>], <span class="keyword">false</span>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">//Binning</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <a class="code" href="classSampleHandlerFD.html#af03bf91649d1848a3e531ff7f865c313">nDimensions</a> = 0;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a5cd052288a69d57c215088e666fa4be3">XVarStr</a> = <a class="code" href="YamlHelper_8h.html#a1247d9088f9521c2758d1d7c21dcfa87">GetFromManager</a>(<a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;Binning&quot;</span>][<span class="stringliteral">&quot;XVarStr&quot;</span>], std::string(<span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a8e0ad070b2d5c389350709110ad7e193">SampleXBins</a> = <a class="code" href="YamlHelper_8h.html#a1247d9088f9521c2758d1d7c21dcfa87">GetFromManager</a>(<a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;Binning&quot;</span>][<span class="stringliteral">&quot;XVarBins&quot;</span>], std::vector&lt;double&gt;());</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#a5cd052288a69d57c215088e666fa4be3">XVarStr</a>.length() &gt; 0){</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <a class="code" href="classSampleHandlerFD.html#af03bf91649d1848a3e531ff7f865c313">nDimensions</a>++;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  } <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Please specify an X-variable string in sample config {}&quot;</span>, <a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;GetFileName());</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a8fda7dea41c730724a5b3e171a572378">YVarStr</a> = <a class="code" href="YamlHelper_8h.html#a1247d9088f9521c2758d1d7c21dcfa87">GetFromManager</a>(<a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;Binning&quot;</span>][<span class="stringliteral">&quot;YVarStr&quot;</span>], std::string(<span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a7da646b34085605653acb7965068c4a5">SampleYBins</a> = <a class="code" href="YamlHelper_8h.html#a1247d9088f9521c2758d1d7c21dcfa87">GetFromManager</a>(<a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;Binning&quot;</span>][<span class="stringliteral">&quot;YVarBins&quot;</span>], std::vector&lt;double&gt;());</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#a8fda7dea41c730724a5b3e171a572378">YVarStr</a>.length() &gt; 0){</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#a5cd052288a69d57c215088e666fa4be3">XVarStr</a>.length() == 0){</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Please specify an X-variable string in sample config {}. I won&#39;t work only with a Y-variable&quot;</span>, <a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;GetFileName());</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="classSampleHandlerFD.html#af03bf91649d1848a3e531ff7f865c313">nDimensions</a>++;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#af03bf91649d1848a3e531ff7f865c313">nDimensions</a> == 0){</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Error setting up the sample binning&quot;</span>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Number of dimensions is {}&quot;</span>, <a class="code" href="classSampleHandlerFD.html#af03bf91649d1848a3e531ff7f865c313">nDimensions</a>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Check that an XVarStr has been given in the sample config&quot;</span>);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  } <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Found {} dimensions for sample binning&quot;</span>, <a class="code" href="classSampleHandlerFD.html#af03bf91649d1848a3e531ff7f865c313">nDimensions</a>);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="comment">//Sanity check that some binning has been specified</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#a8e0ad070b2d5c389350709110ad7e193">SampleXBins</a>.size() == 0 &amp;&amp; <a class="code" href="classSampleHandlerFD.html#a7da646b34085605653acb7965068c4a5">SampleYBins</a>.size() == 0){</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;No binning specified for either X or Y of sample binning, please add some binning to the sample config {}&quot;</span>, <a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;GetFileName());</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="comment">//FD file info</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="YamlHelper_8h.html#ad2340a340fd6649a6d220abc16d4757b">CheckNodeExists</a>(<a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;raw(), <span class="stringliteral">&quot;InputFiles&quot;</span>, <span class="stringliteral">&quot;mtupleprefix&quot;</span>)){</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;InputFiles:mtupleprefix not given in {}, please add this&quot;</span>, <a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;GetFileName());</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keyword">auto</span> mtupleprefix  = Get&lt;std::string&gt;(<a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;InputFiles&quot;</span>][<span class="stringliteral">&quot;mtupleprefix&quot;</span>], __FILE__, __LINE__);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keyword">auto</span> mtuplesuffix  = Get&lt;std::string&gt;(<a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;InputFiles&quot;</span>][<span class="stringliteral">&quot;mtuplesuffix&quot;</span>], __FILE__, __LINE__);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keyword">auto</span> splineprefix  = Get&lt;std::string&gt;(<a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;InputFiles&quot;</span>][<span class="stringliteral">&quot;splineprefix&quot;</span>], __FILE__, __LINE__);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keyword">auto</span> splinesuffix  = Get&lt;std::string&gt;(<a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;InputFiles&quot;</span>][<span class="stringliteral">&quot;splinesuffix&quot;</span>], __FILE__, __LINE__);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordtype">int</span> NChannels = <span class="keyword">static_cast&lt;</span><a class="code" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a><span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;SubSamples&quot;</span>].size());</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a57f378f84f66caa817e52c0bfb5ff0be">OscChannels</a>.reserve(NChannels);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> &amp;osc_channel : <a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;SubSamples&quot;</span>]) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="structOscChannelInfo.html">OscChannelInfo</a> OscInfo;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    OscInfo.<a class="code" href="structOscChannelInfo.html#a8e53cc0039dd74b294cea0740af50058">flavourName</a>       = osc_channel[<span class="stringliteral">&quot;Name&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    OscInfo.<a class="code" href="structOscChannelInfo.html#aa3359c3cd440a244cde9970774a9a5a9">flavourName_Latex</a> = osc_channel[<span class="stringliteral">&quot;LatexName&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    OscInfo.<a class="code" href="structOscChannelInfo.html#a05c0f4dbac9e0cf9ce4f35d5117d1414">InitPDG</a>           = <span class="keyword">static_cast&lt;</span><a class="code" href="SampleStructs_8h.html#a0dfdd8cf84b8fa3495e9e5e520fe6cd2">NuPDG</a><span class="keyword">&gt;</span>(osc_channel[<span class="stringliteral">&quot;nutype&quot;</span>].as&lt;<span class="keywordtype">int</span>&gt;());</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    OscInfo.<a class="code" href="structOscChannelInfo.html#a68fbf8d6805b2f6098e13216531e9964">FinalPDG</a>          = <span class="keyword">static_cast&lt;</span><a class="code" href="SampleStructs_8h.html#a0dfdd8cf84b8fa3495e9e5e520fe6cd2">NuPDG</a><span class="keyword">&gt;</span>(osc_channel[<span class="stringliteral">&quot;oscnutype&quot;</span>].as&lt;<span class="keywordtype">int</span>&gt;());</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    OscInfo.<a class="code" href="structOscChannelInfo.html#a5dd80422976729436a31ffb1c449e936">ChannelIndex</a>      = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerFD.html#a57f378f84f66caa817e52c0bfb5ff0be">OscChannels</a>.size());</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a57f378f84f66caa817e52c0bfb5ff0be">OscChannels</a>.push_back(std::move(OscInfo));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="classSampleHandlerFD.html#abd686fdebead1a699d9bad4a1bebaa8f">mc_files</a>.push_back(mtupleprefix+osc_channel[<span class="stringliteral">&quot;mtuplefile&quot;</span>].as&lt;std::string&gt;()+mtuplesuffix);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a4a02e96c7d7731097c7c10660d23b3a5">spline_files</a>.push_back(splineprefix+osc_channel[<span class="stringliteral">&quot;splinefile&quot;</span>].as&lt;std::string&gt;()+splinesuffix);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="comment">//Now grab the selection cuts from the manager</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keywordflow">for</span> ( <span class="keyword">auto</span> <span class="keyword">const</span> &amp;SelectionCuts : <a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;SelectionCuts&quot;</span>]) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="classSampleHandlerFD.html#abe55d06685c38b03a10134019b1aca06">SelectionStr</a>.push_back(SelectionCuts[<span class="stringliteral">&quot;KinematicStr&quot;</span>].as&lt;std::string&gt;());</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keyword">auto</span> TempBoundsVec = <a class="code" href="YamlHelper_8h.html#ae828b8f0cb6b6bbd5fd4e7e5aaf9632f">GetBounds</a>(SelectionCuts[<span class="stringliteral">&quot;Bounds&quot;</span>]);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="structKinematicCut.html">KinematicCut</a> CutObj;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    CutObj.<a class="code" href="structKinematicCut.html#aa654b5f2ef7ca1b57d9238c428fdc11f">LowerBound</a> = TempBoundsVec[0];</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    CutObj.<a class="code" href="structKinematicCut.html#a244bd4ada65739a6984a2039a5a6f200">UpperBound</a> = TempBoundsVec[1];</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    CutObj.<a class="code" href="structKinematicCut.html#aedd261d6e8e3f72e3570cfe3753cbd2f">ParamToCutOnIt</a> = <a class="code" href="group__SampleHandlerGetters.html#gae2769d593f34e8356b545af076818f89">ReturnKinematicParameterFromString</a>(SelectionCuts[<span class="stringliteral">&quot;KinematicStr&quot;</span>].as&lt;std::string&gt;());</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Adding cut on {} with bounds {} to {}&quot;</span>, SelectionCuts[<span class="stringliteral">&quot;KinematicStr&quot;</span>].as&lt;std::string&gt;(), TempBoundsVec[0], TempBoundsVec[1]);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a402634a2a3f7520228b50bf208c00e78">StoredSelection</a>.push_back(CutObj);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="comment">// EM: initialise the mode weight map</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordflow">for</span>( <span class="keywordtype">int</span> iMode=0; iMode &lt; <a class="code" href="classSampleHandlerBase.html#ab9f61ca5c8abb03d4d84947e9bfa7943">Modes</a>-&gt;<a class="code" href="classMaCh3Modes.html#a1996581eab0194698a4ddccf3b189d49">GetNModes</a>(); iMode++ ) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="classSampleHandlerFD.html#ad625af417f4445b9b14710ca3bdc409d">_modeNomWeightMap</a>[<a class="code" href="classSampleHandlerBase.html#ab9f61ca5c8abb03d4d84947e9bfa7943">Modes</a>-&gt;<a class="code" href="classMaCh3Modes.html#abf4ac35511787907bc16ae26aa6c2a15">GetMaCh3ModeName</a>(iMode)] = 1.0;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="comment">// EM: multiply by the nominal weight specified in the sample config file</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;NominalWeights&quot;</span>] ) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> iMode=0; iMode&lt;<a class="code" href="classSampleHandlerBase.html#ab9f61ca5c8abb03d4d84947e9bfa7943">Modes</a>-&gt;<a class="code" href="classMaCh3Modes.html#a1996581eab0194698a4ddccf3b189d49">GetNModes</a>(); iMode++ ) {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      std::string modeStr = <a class="code" href="classSampleHandlerBase.html#ab9f61ca5c8abb03d4d84947e9bfa7943">Modes</a>-&gt;<a class="code" href="classMaCh3Modes.html#abf4ac35511787907bc16ae26aa6c2a15">GetMaCh3ModeName</a>(iMode);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="keywordflow">if</span>( <a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;NominalWeights&quot;</span>][modeStr] ) {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keywordtype">double</span> modeWeight = <a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;NominalWeights&quot;</span>][modeStr].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <a class="code" href="classSampleHandlerFD.html#ad625af417f4445b9b14710ca3bdc409d">_modeNomWeightMap</a>[<a class="code" href="classSampleHandlerBase.html#ab9f61ca5c8abb03d4d84947e9bfa7943">Modes</a>-&gt;<a class="code" href="classMaCh3Modes.html#abf4ac35511787907bc16ae26aa6c2a15">GetMaCh3ModeName</a>(iMode)] *= modeWeight;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="comment">// EM: print em out</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;  Nominal mode weights to apply: &quot;</span>);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iMode=0; iMode&lt;<a class="code" href="classSampleHandlerBase.html#ab9f61ca5c8abb03d4d84947e9bfa7943">Modes</a>-&gt;<a class="code" href="classMaCh3Modes.html#a1996581eab0194698a4ddccf3b189d49">GetNModes</a>(); iMode++ ) {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    std::string modeStr = <a class="code" href="classSampleHandlerBase.html#ab9f61ca5c8abb03d4d84947e9bfa7943">Modes</a>-&gt;<a class="code" href="classMaCh3Modes.html#abf4ac35511787907bc16ae26aa6c2a15">GetMaCh3ModeName</a>(iMode);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;    - {}: {}&quot;</span>, modeStr, <a class="code" href="classSampleHandlerFD.html#ad625af417f4445b9b14710ca3bdc409d">_modeNomWeightMap</a>.at(modeStr));</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;}</div>
<div class="ttc" id="aSampleStructs_8h_html_a0dfdd8cf84b8fa3495e9e5e520fe6cd2"><div class="ttname"><a href="SampleStructs_8h.html#a0dfdd8cf84b8fa3495e9e5e520fe6cd2">NuPDG</a></div><div class="ttdeci">NuPDG</div><div class="ttdoc">Enum to track the incoming neutrino species.</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00101">SampleStructs.h:101</a></div></div>
<div class="ttc" id="aSampleStructs_8h_html_a960da89e33ac45a56f7bbfac3068dc67"><div class="ttname"><a href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67">TestStatistic</a></div><div class="ttdeci">TestStatistic</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00113">SampleStructs.h:113</a></div></div>
<div class="ttc" id="aYamlHelper_8h_html_a1247d9088f9521c2758d1d7c21dcfa87"><div class="ttname"><a href="YamlHelper_8h.html#a1247d9088f9521c2758d1d7c21dcfa87">GetFromManager</a></div><div class="ttdeci">Type GetFromManager(const YAML::Node &amp;node, Type defval, const std::string File=&quot;&quot;, const int Line=1)</div><div class="ttdoc">Get content of config file if node is not found take default value specified.</div><div class="ttdef"><b>Definition:</b> <a href="YamlHelper_8h_source.html#l00287">YamlHelper.h:287</a></div></div>
<div class="ttc" id="aYamlHelper_8h_html_ad2340a340fd6649a6d220abc16d4757b"><div class="ttname"><a href="YamlHelper_8h.html#ad2340a340fd6649a6d220abc16d4757b">CheckNodeExists</a></div><div class="ttdeci">bool CheckNodeExists(const YAML::Node &amp;node, Args... args)</div><div class="ttdoc">KS: Wrapper function to call the recursive helper.</div><div class="ttdef"><b>Definition:</b> <a href="YamlHelper_8h_source.html#l00054">YamlHelper.h:54</a></div></div>
<div class="ttc" id="aYamlHelper_8h_html_ae828b8f0cb6b6bbd5fd4e7e5aaf9632f"><div class="ttname"><a href="YamlHelper_8h.html#ae828b8f0cb6b6bbd5fd4e7e5aaf9632f">GetBounds</a></div><div class="ttdeci">#define GetBounds(filename)</div><div class="ttdef"><b>Definition:</b> <a href="YamlHelper_8h_source.html#l00462">YamlHelper.h:462</a></div></div>
<div class="ttc" id="aclassMaCh3Modes_html"><div class="ttname"><a href="classMaCh3Modes.html">MaCh3Modes</a></div><div class="ttdoc">KS: Class describing MaCh3 modes used in the analysis, it is being initialised from config.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Modes_8h_source.html#l00041">MaCh3Modes.h:41</a></div></div>
<div class="ttc" id="aclassSampleHandlerBase_html_a87670dbcda5d09b09675e8f407fe3a30"><div class="ttname"><a href="classSampleHandlerBase.html#a87670dbcda5d09b09675e8f407fe3a30">SampleHandlerBase::fTestStatistic</a></div><div class="ttdeci">TestStatistic fTestStatistic</div><div class="ttdoc">Test statistic tells what kind of likelihood sample is using.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00124">SampleHandlerBase.h:124</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a1ebc5e194703ef6b9d3c7e4994417d60"><div class="ttname"><a href="classSampleHandlerFD.html#a1ebc5e194703ef6b9d3c7e4994417d60">SampleHandlerFD::SampleTitle</a></div><div class="ttdeci">std::string SampleTitle</div><div class="ttdoc">the name of this sample e.g.&quot;muon-like&quot;</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00319">SampleHandlerFD.h:319</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a7da646b34085605653acb7965068c4a5"><div class="ttname"><a href="classSampleHandlerFD.html#a7da646b34085605653acb7965068c4a5">SampleHandlerFD::SampleYBins</a></div><div class="ttdeci">std::vector&lt; double &gt; SampleYBins</div><div class="ttdoc">vector of the binning used in axis 2 (the y-axis)</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00194">SampleHandlerFD.h:194</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a8e0ad070b2d5c389350709110ad7e193"><div class="ttname"><a href="classSampleHandlerFD.html#a8e0ad070b2d5c389350709110ad7e193">SampleHandlerFD::SampleXBins</a></div><div class="ttdeci">std::vector&lt; double &gt; SampleXBins</div><div class="ttdoc">vector of the binning used in axis 1 (the x-axis)</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00192">SampleHandlerFD.h:192</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_abd686fdebead1a699d9bad4a1bebaa8f"><div class="ttname"><a href="classSampleHandlerFD.html#abd686fdebead1a699d9bad4a1bebaa8f">SampleHandlerFD::mc_files</a></div><div class="ttdeci">std::vector&lt; std::string &gt; mc_files</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00351">SampleHandlerFD.h:351</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_abe55d06685c38b03a10134019b1aca06"><div class="ttname"><a href="classSampleHandlerFD.html#abe55d06685c38b03a10134019b1aca06">SampleHandlerFD::SelectionStr</a></div><div class="ttdeci">std::vector&lt; std::string &gt; SelectionStr</div><div class="ttdoc">the strings grabbed from the sample config specifying the selections</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00333">SampleHandlerFD.h:333</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ad625af417f4445b9b14710ca3bdc409d"><div class="ttname"><a href="classSampleHandlerFD.html#ad625af417f4445b9b14710ca3bdc409d">SampleHandlerFD::_modeNomWeightMap</a></div><div class="ttdeci">std::unordered_map&lt; std::string, double &gt; _modeNomWeightMap</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00354">SampleHandlerFD.h:354</a></div></div>
<div class="ttc" id="anamespaceM3_html_adb59b8ecdc4e1b2d5d4c826a13aa7463"><div class="ttname"><a href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a></div><div class="ttdeci">int int_t</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00029">Core.h:29</a></div></div>
<div class="ttc" id="astructKinematicCut_html"><div class="ttname"><a href="structKinematicCut.html">KinematicCut</a></div><div class="ttdoc">KS: Small struct used for applying kinematic cuts.</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00157">SampleStructs.h:157</a></div></div>
<div class="ttc" id="astructKinematicCut_html_a244bd4ada65739a6984a2039a5a6f200"><div class="ttname"><a href="structKinematicCut.html#a244bd4ada65739a6984a2039a5a6f200">KinematicCut::UpperBound</a></div><div class="ttdeci">double UpperBound</div><div class="ttdoc">Upper bound on which we apply cut.</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00164">SampleStructs.h:164</a></div></div>
<div class="ttc" id="astructKinematicCut_html_aa654b5f2ef7ca1b57d9238c428fdc11f"><div class="ttname"><a href="structKinematicCut.html#aa654b5f2ef7ca1b57d9238c428fdc11f">KinematicCut::LowerBound</a></div><div class="ttdeci">double LowerBound</div><div class="ttdoc">Lower bound on which we apply cut.</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00162">SampleStructs.h:162</a></div></div>
<div class="ttc" id="astructKinematicCut_html_aedd261d6e8e3f72e3570cfe3753cbd2f"><div class="ttname"><a href="structKinematicCut.html#aedd261d6e8e3f72e3570cfe3753cbd2f">KinematicCut::ParamToCutOnIt</a></div><div class="ttdeci">int ParamToCutOnIt</div><div class="ttdoc">Index or enum value identifying the kinematic variable to cut on.</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00160">SampleStructs.h:160</a></div></div>
<div class="ttc" id="astructOscChannelInfo_html"><div class="ttname"><a href="structOscChannelInfo.html">OscChannelInfo</a></div><div class="ttdoc">KS: Store info about used osc channels.</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00008">FarDetectorCoreInfoStruct.h:8</a></div></div>
<div class="ttc" id="astructOscChannelInfo_html_a05c0f4dbac9e0cf9ce4f35d5117d1414"><div class="ttname"><a href="structOscChannelInfo.html#a05c0f4dbac9e0cf9ce4f35d5117d1414">OscChannelInfo::InitPDG</a></div><div class="ttdeci">int InitPDG</div><div class="ttdoc">PDG of initial flavour.</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00015">FarDetectorCoreInfoStruct.h:15</a></div></div>
<div class="ttc" id="astructOscChannelInfo_html_a5dd80422976729436a31ffb1c449e936"><div class="ttname"><a href="structOscChannelInfo.html#a5dd80422976729436a31ffb1c449e936">OscChannelInfo::ChannelIndex</a></div><div class="ttdeci">double ChannelIndex</div><div class="ttdoc">In case experiment specific would like to have pointer to channel after using @GetOscChannel,...</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00020">FarDetectorCoreInfoStruct.h:20</a></div></div>
<div class="ttc" id="astructOscChannelInfo_html_a68fbf8d6805b2f6098e13216531e9964"><div class="ttname"><a href="structOscChannelInfo.html#a68fbf8d6805b2f6098e13216531e9964">OscChannelInfo::FinalPDG</a></div><div class="ttdeci">int FinalPDG</div><div class="ttdoc">PDG of oscillated/final flavour.</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00017">FarDetectorCoreInfoStruct.h:17</a></div></div>
<div class="ttc" id="astructOscChannelInfo_html_a8e53cc0039dd74b294cea0740af50058"><div class="ttname"><a href="structOscChannelInfo.html#a8e53cc0039dd74b294cea0740af50058">OscChannelInfo::flavourName</a></div><div class="ttdeci">std::string flavourName</div><div class="ttdoc">Name of osc channel.</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00010">FarDetectorCoreInfoStruct.h:10</a></div></div>
<div class="ttc" id="astructOscChannelInfo_html_aa3359c3cd440a244cde9970774a9a5a9"><div class="ttname"><a href="structOscChannelInfo.html#aa3359c3cd440a244cde9970774a9a5a9">OscChannelInfo::flavourName_Latex</a></div><div class="ttdeci">std::string flavourName_Latex</div><div class="ttdoc">Fancy channel name (e.g., LaTeX formatted)</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00012">FarDetectorCoreInfoStruct.h:12</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab5a809cfcd1e221ba0094b65f8e748f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5a809cfcd1e221ba0094b65f8e748f8">&#9670;&nbsp;</a></span>RegisterFunctionalParameters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void SampleHandlerFD::RegisterFunctionalParameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>HH - a experiment-specific function where the maps to actual functions are set up. </p>

<p>Implemented in <a class="el" href="classPySampleHandlerFD.html#ad83271c04e185f5e4e6414b3eb3d3226">PySampleHandlerFD</a>.</p>

</div>
</div>
<a id="aa2626d0d48874d1aff1a107f62f1f02d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2626d0d48874d1aff1a107f62f1f02d">&#9670;&nbsp;</a></span>RegisterIndividualFunctionalParameter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::RegisterIndividualFunctionalParameter </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>fpName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fpEnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ParameterStructs_8h.html#a916ddc21f75755739f308b54dd06e0ae">FuncParFuncType</a>&#160;</td>
          <td class="paramname"><em>fpFunc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>HH - a helper function for RegisterFunctionalParameter. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00629">629</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                                                                                                                      {</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="comment">// Add protections to not add the same functional parameter twice</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">funcParsNamesMap</a>.find(fpName) != <a class="code" href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">funcParsNamesMap</a>.end()) {</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Functional parameter {} already registered in funcParsNamesMap with enum {}&quot;</span>, fpName, <a class="code" href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">funcParsNamesMap</a>[fpName]);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  }</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <span class="keywordflow">if</span> (std::find(<a class="code" href="classSampleHandlerFD.html#a888112d7eebd6fdb877c0015e1951f9d">funcParsNamesVec</a>.begin(), <a class="code" href="classSampleHandlerFD.html#a888112d7eebd6fdb877c0015e1951f9d">funcParsNamesVec</a>.end(), fpName) != <a class="code" href="classSampleHandlerFD.html#a888112d7eebd6fdb877c0015e1951f9d">funcParsNamesVec</a>.end()) {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Functional parameter {} already in funcParsNamesVec&quot;</span>, fpName);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  }</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#a577a57992e396a5b34efcd3bb6ed45cf">funcParsFuncMap</a>.find(fpEnum) != <a class="code" href="classSampleHandlerFD.html#a577a57992e396a5b34efcd3bb6ed45cf">funcParsFuncMap</a>.end()) {</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Functional parameter enum {} already registered in funcParsFuncMap&quot;</span>, fpEnum);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  }</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <a class="code" href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">funcParsNamesMap</a>[fpName] = fpEnum;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a888112d7eebd6fdb877c0015e1951f9d">funcParsNamesVec</a>.push_back(fpName);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a577a57992e396a5b34efcd3bb6ed45cf">funcParsFuncMap</a>[fpEnum] = fpFunc;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a577a57992e396a5b34efcd3bb6ed45cf"><div class="ttname"><a href="classSampleHandlerFD.html#a577a57992e396a5b34efcd3bb6ed45cf">SampleHandlerFD::funcParsFuncMap</a></div><div class="ttdeci">std::unordered_map&lt; int, FuncParFuncType &gt; funcParsFuncMap</div><div class="ttdoc">HH - a map that relates the funcpar enum to pointer of the actual function.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00225">SampleHandlerFD.h:225</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a888112d7eebd6fdb877c0015e1951f9d"><div class="ttname"><a href="classSampleHandlerFD.html#a888112d7eebd6fdb877c0015e1951f9d">SampleHandlerFD::funcParsNamesVec</a></div><div class="ttdeci">std::vector&lt; std::string &gt; funcParsNamesVec</div><div class="ttdoc">HH - a vector of string names for each functional parameter.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00229">SampleHandlerFD.h:229</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_af8ed9895a0b2802e45569ce2d1a0a837"><div class="ttname"><a href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">SampleHandlerFD::funcParsNamesMap</a></div><div class="ttdeci">std::unordered_map&lt; std::string, int &gt; funcParsNamesMap</div><div class="ttdoc">HH - a map that relates the name of the functional parameter to funcpar enum.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00217">SampleHandlerFD.h:217</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac1f944f73f43a68be3af388cd17bc5e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1f944f73f43a68be3af388cd17bc5e3">&#9670;&nbsp;</a></span>ResetHistograms()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::ResetHistograms </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function to reset histograms. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00614">614</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                      {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">// **************************************************  </span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="comment">//DB Reset values stored in PDF array to 0.</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="comment">// Don&#39;t openMP this; no significant gain</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> yBin = 0; yBin &lt; <a class="code" href="classSampleHandlerFD.html#ae48ed0755671be986cb04690b4fa6959">nYBins</a>; ++yBin) {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="preprocessor">    #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="preprocessor">    #pragma omp simd</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> xBin = 0; xBin &lt; <a class="code" href="classSampleHandlerFD.html#ab933df667fbccf97b3028297ddd8eae2">nXBins</a>; ++xBin) {</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      <a class="code" href="classSampleHandlerFD.html#aab040097a0524dd6aa6cad01c991b5ce">SampleHandlerFD_array</a>[yBin][xBin] = 0.;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      <a class="code" href="classSampleHandlerFD.html#a3905ae0e2531525dba5d663110f86527">SampleHandlerFD_array_w2</a>[yBin][xBin] = 0.;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;} <span class="comment">// end function</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a06a5cccd7d178bd999dc1e4f3782e9b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06a5cccd7d178bd999dc1e4f3782e9b7">&#9670;&nbsp;</a></span>resetShifts()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void SampleHandlerFD::resetShifts </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iEvent</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>HH - reset the shifted values to the original values. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00212">212</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;{(void)iEvent;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae0000225f48d985e8dd60bc94a1c0425"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0000225f48d985e8dd60bc94a1c0425">&#9670;&nbsp;</a></span>ReturnKinematicParameter() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double SampleHandlerFD::ReturnKinematicParameter </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>KinematicVariable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iEvent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classPySampleHandlerFD.html#a1c451a61109ab8106d9247f9f0e149ef">PySampleHandlerFD</a>.</p>

</div>
</div>
<a id="ad0f549802b5625871e11d86905989697"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0f549802b5625871e11d86905989697">&#9670;&nbsp;</a></span>ReturnKinematicParameter() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double SampleHandlerFD::ReturnKinematicParameter </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>KinematicParamter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iEvent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the value of an assocaited kinematic parameter for an event. </p>

<p>Implemented in <a class="el" href="classPySampleHandlerFD.html#ab7b8b57a202f81731e537c678bf1b33f">PySampleHandlerFD</a>.</p>

</div>
</div>
<a id="ac7b638d6d2440fc6ac6ded45059bb8b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7b638d6d2440fc6ac6ded45059bb8b4">&#9670;&nbsp;</a></span>ReturnKinematicParameterBinning()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::vector&lt;double&gt; SampleHandlerFD::ReturnKinematicParameterBinning </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>KinematicParameter</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the binning used to draw a kinematic parameter. </p>

<p>Implemented in <a class="el" href="classPySampleHandlerFD.html#a9424b8760175e37d1731050e2a34073f">PySampleHandlerFD</a>.</p>

</div>
</div>
<a id="ae3e03bd9beffb8b31acfd3bb5ebb44a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3e03bd9beffb8b31acfd3bb5ebb44a2">&#9670;&nbsp;</a></span>Reweight()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::Reweight </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classSampleHandlerBase.html#a3efb49c2a39d87b71e4dec7c7115fa88">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00350">350</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                               {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">//************************************************</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="comment">//KS: Reset the histograms before reweight </span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <a class="code" href="classSampleHandlerFD.html#ac1f944f73f43a68be3af388cd17bc5e3">ResetHistograms</a>();</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="comment">//You only need to do these things if Oscillator has been initialised</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="comment">//if not then you&#39;re not considering oscillations</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">Oscillator</a>) <a class="code" href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">Oscillator</a>-&gt;Evaluate();</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="comment">// Calculate weight coming from all splines if we initialised handler</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">SplineHandler</a>) <a class="code" href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">SplineHandler</a>-&gt;Evaluate();</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="comment">// Call entirely different routine if we&#39;re running with openMP</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  FillArray_MP();</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="preprocessor">  #else</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <a class="code" href="classSampleHandlerFD.html#aeef0f943cb1e0d4c9bba4814cb24a507">FillArray</a>();</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="comment">//KS: If you want to not update W2 wights then uncomment this line</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="classSampleHandlerFD.html#aa654562842a0da51ff917aaed517310e">UpdateW2</a>) <a class="code" href="classSampleHandlerFD.html#a1ff1ef7d99cee6d6a9fba74296d4d0ea">FirstTimeW2</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_ac1f944f73f43a68be3af388cd17bc5e3"><div class="ttname"><a href="classSampleHandlerFD.html#ac1f944f73f43a68be3af388cd17bc5e3">SampleHandlerFD::ResetHistograms</a></div><div class="ttdeci">void ResetHistograms()</div><div class="ttdoc">Helper function to reset histograms.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00614">SampleHandlerFD.cpp:614</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_aeef0f943cb1e0d4c9bba4814cb24a507"><div class="ttname"><a href="classSampleHandlerFD.html#aeef0f943cb1e0d4c9bba4814cb24a507">SampleHandlerFD::FillArray</a></div><div class="ttdeci">void FillArray()</div><div class="ttdoc">DB Nice new multi-threaded function which calculates the event weights and fills the relevant bins of...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00381">SampleHandlerFD.cpp:381</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af9ea7e245d3bf6098ee49de38cf6d1fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9ea7e245d3bf6098ee49de38cf6d1fe">&#9670;&nbsp;</a></span>Set1DBinning() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::Set1DBinning </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nbins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>boundaries</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>sets the binning used for the likelihood calculation, used for both data and MC </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nbins</td><td>number of total bins </td></tr>
    <tr><td class="paramname">boundaries</td><td>the bin edges e.g. 0, 0.1, 0.2, 0.3 <br  />
 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00922">922</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;{</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <a class="code" href="classSampleHandlerBase.html#adcc9b928dce6e7dddf761f0c13e7b409">_hPDF1D</a>-&gt;Reset();</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <a class="code" href="classSampleHandlerBase.html#adcc9b928dce6e7dddf761f0c13e7b409">_hPDF1D</a>-&gt;SetBins(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(nbins),boundaries);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <a class="code" href="classSampleHandlerBase.html#a7938f32b145ce648d3ce4ae33bc9d560">dathist</a>-&gt;SetBins(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(nbins),boundaries);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160; </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">XBinEdges</a> = std::vector&lt;double&gt;(nbins+1);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0;i&lt;nbins+1;i++) {</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">XBinEdges</a>[i] = <a class="code" href="classSampleHandlerBase.html#adcc9b928dce6e7dddf761f0c13e7b409">_hPDF1D</a>-&gt;GetXaxis()-&gt;GetBinLowEdge(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(i+1));</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  }</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  <a class="code" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a> = std::vector&lt;double&gt;(2);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <a class="code" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a>[0] = -1e8;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <a class="code" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a>[1] = 1e8;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160; </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="keywordtype">double</span> YBinEdges_Arr[2];</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  YBinEdges_Arr[0] = <a class="code" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a>[0];</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  YBinEdges_Arr[1] = <a class="code" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a>[1];</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  <a class="code" href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">_hPDF2D</a>-&gt;Reset();</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <a class="code" href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">_hPDF2D</a>-&gt;SetBins(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(nbins),boundaries,1,YBinEdges_Arr);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <a class="code" href="classSampleHandlerBase.html#aa7ed25798bc8d52dc16b5ea2f6c9d0c3">dathist2d</a>-&gt;SetBins(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(nbins),boundaries,1,YBinEdges_Arr);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <span class="comment">//Set the number of X and Y bins now</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <a class="code" href="classSampleHandlerFD.html#af7c4f1d9510cb3300c8612a95fb1238f">SetupReweightArrays</a>(<a class="code" href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">XBinEdges</a>.size() - 1, <a class="code" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a>.size() - 1);</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160; </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a7da9bc1df59603a15e5164112ba4b72c">FindNominalBinAndEdges1D</a>();</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a7da9bc1df59603a15e5164112ba4b72c"><div class="ttname"><a href="classSampleHandlerFD.html#a7da9bc1df59603a15e5164112ba4b72c">SampleHandlerFD::FindNominalBinAndEdges1D</a></div><div class="ttdeci">void FindNominalBinAndEdges1D()</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00974">SampleHandlerFD.cpp:974</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_af7c4f1d9510cb3300c8612a95fb1238f"><div class="ttname"><a href="classSampleHandlerFD.html#af7c4f1d9510cb3300c8612a95fb1238f">SampleHandlerFD::SetupReweightArrays</a></div><div class="ttdeci">void SetupReweightArrays(const size_t numberXBins, const size_t numberYBins)</div><div class="ttdoc">Initialise data, MC and W2 histograms.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00896">SampleHandlerFD.cpp:896</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a17ee4ecca05819a49470c0492bfcf5c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17ee4ecca05819a49470c0492bfcf5c7">&#9670;&nbsp;</a></span>Set1DBinning() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::Set1DBinning </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nbins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>low</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>high</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>set the binning used for likelihood calculation using uniform binning </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nbins</td><td>number of total bins </td></tr>
    <tr><td class="paramname">low</td><td>lower bound of the binning </td></tr>
    <tr><td class="paramname">high</td><td>upper bound of the binning </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00950">950</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;{</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <a class="code" href="classSampleHandlerBase.html#adcc9b928dce6e7dddf761f0c13e7b409">_hPDF1D</a>-&gt;Reset();</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <a class="code" href="classSampleHandlerBase.html#adcc9b928dce6e7dddf761f0c13e7b409">_hPDF1D</a>-&gt;SetBins(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(nbins),low,high);</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <a class="code" href="classSampleHandlerBase.html#a7938f32b145ce648d3ce4ae33bc9d560">dathist</a>-&gt;SetBins(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(nbins),low,high);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">XBinEdges</a> = std::vector&lt;double&gt;(nbins+1);</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0;i&lt;nbins+1;i++) {</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">XBinEdges</a>[i] = <a class="code" href="classSampleHandlerBase.html#adcc9b928dce6e7dddf761f0c13e7b409">_hPDF1D</a>-&gt;GetXaxis()-&gt;GetBinLowEdge(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(i+1));</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  }</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  <a class="code" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a> = std::vector&lt;double&gt;(2);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  <a class="code" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a>[0] = -1e8;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  <a class="code" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a>[1] = 1e8;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160; </div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  <a class="code" href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">_hPDF2D</a>-&gt;Reset();</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  <a class="code" href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">_hPDF2D</a>-&gt;SetBins(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(nbins),low,high,1,<a class="code" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a>[0],<a class="code" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a>[1]);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <a class="code" href="classSampleHandlerBase.html#aa7ed25798bc8d52dc16b5ea2f6c9d0c3">dathist2d</a>-&gt;SetBins(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(nbins),low,high,1,<a class="code" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a>[0],<a class="code" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a>[1]);</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160; </div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <span class="comment">//Set the number of X and Y bins now</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <a class="code" href="classSampleHandlerFD.html#af7c4f1d9510cb3300c8612a95fb1238f">SetupReweightArrays</a>(<a class="code" href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">XBinEdges</a>.size() - 1, <a class="code" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a>.size() - 1);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160; </div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a7da9bc1df59603a15e5164112ba4b72c">FindNominalBinAndEdges1D</a>();</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aed96d26b4689311ad4fdc8d74c4754d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed96d26b4689311ad4fdc8d74c4754d3">&#9670;&nbsp;</a></span>Set1DBinning() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::Set1DBinning </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>XVec</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>set the binning for 1D sample used for the likelihood calculation </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">XVec</td><td>vector containing the binning in axis 1 (the x-axis) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00178">178</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;{<a class="code" href="classSampleHandlerFD.html#af9ea7e245d3bf6098ee49de38cf6d1fe">Set1DBinning</a>(XVec.size()-1, XVec.data());};</div>
<div class="ttc" id="aclassSampleHandlerFD_html_af9ea7e245d3bf6098ee49de38cf6d1fe"><div class="ttname"><a href="classSampleHandlerFD.html#af9ea7e245d3bf6098ee49de38cf6d1fe">SampleHandlerFD::Set1DBinning</a></div><div class="ttdeci">void Set1DBinning(size_t nbins, double *boundaries)</div><div class="ttdoc">sets the binning used for the likelihood calculation, used for both data and MC</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00922">SampleHandlerFD.cpp:922</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aae57301ae5bf3a8223179c1bd674d73f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae57301ae5bf3a8223179c1bd674d73f">&#9670;&nbsp;</a></span>Set2DBinning() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::Set2DBinning </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nbins1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>boundaries1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nbins2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>boundaries2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>set the binning for 2D sample used for the likelihood calculation </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nbins1</td><td>number of bins in axis 1 (the x-axis) </td></tr>
    <tr><td class="paramname">nbins2</td><td>number of bins in axis 2 (the y-axis) </td></tr>
    <tr><td class="paramname">boundaries1</td><td>the bin boundaries used in axis 1 (the x-axis) </td></tr>
    <tr><td class="paramname">boundaries2</td><td>the bin boundaries used in axis 2 (the y-axis) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01018">1018</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;{</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  <a class="code" href="classSampleHandlerBase.html#adcc9b928dce6e7dddf761f0c13e7b409">_hPDF1D</a>-&gt;Reset();</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <a class="code" href="classSampleHandlerBase.html#adcc9b928dce6e7dddf761f0c13e7b409">_hPDF1D</a>-&gt;SetBins(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(nbins1),boundaries1);</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <a class="code" href="classSampleHandlerBase.html#a7938f32b145ce648d3ce4ae33bc9d560">dathist</a>-&gt;SetBins(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(nbins1),boundaries1);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160; </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  <a class="code" href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">_hPDF2D</a>-&gt;Reset();</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  <a class="code" href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">_hPDF2D</a>-&gt;SetBins(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(nbins1),boundaries1,<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(nbins2),boundaries2);</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <a class="code" href="classSampleHandlerBase.html#aa7ed25798bc8d52dc16b5ea2f6c9d0c3">dathist2d</a>-&gt;SetBins(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(nbins1),boundaries1,<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(nbins2),boundaries2);</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">XBinEdges</a> = std::vector&lt;double&gt;(nbins1+1);</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0;i&lt;nbins1+1;i++) {</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">XBinEdges</a>[i] = <a class="code" href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">_hPDF2D</a>-&gt;GetXaxis()-&gt;GetBinLowEdge(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(i+1));</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  }</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <a class="code" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a> = std::vector&lt;double&gt;(nbins2+1);</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0;i&lt;nbins2+1;i++) {</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <a class="code" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a>[i] = <a class="code" href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">_hPDF2D</a>-&gt;GetYaxis()-&gt;GetBinLowEdge(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(i+1));</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  }</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  <span class="comment">//Set the number of X and Y bins now</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <a class="code" href="classSampleHandlerFD.html#af7c4f1d9510cb3300c8612a95fb1238f">SetupReweightArrays</a>(<a class="code" href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">XBinEdges</a>.size() - 1, <a class="code" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a>.size() - 1);</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160; </div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a5b4c3a7f56f3f7bc352555a0d847ec22">FindNominalBinAndEdges2D</a>();</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a5b4c3a7f56f3f7bc352555a0d847ec22"><div class="ttname"><a href="classSampleHandlerFD.html#a5b4c3a7f56f3f7bc352555a0d847ec22">SampleHandlerFD::FindNominalBinAndEdges2D</a></div><div class="ttdeci">void FindNominalBinAndEdges2D()</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01069">SampleHandlerFD.cpp:1069</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5343d89326adb246a939c060d6da566"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5343d89326adb246a939c060d6da566">&#9670;&nbsp;</a></span>Set2DBinning() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::Set2DBinning </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nbins1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>low1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>high1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nbins2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>low2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>high2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>set the binning for 2D sample used for the likelihood calculation </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nbins1</td><td>number of bins in axis 1 (the x-axis) </td></tr>
    <tr><td class="paramname">low1</td><td>lower bound of binning in axis 1 (the x-axis) </td></tr>
    <tr><td class="paramname">high1</td><td>upper bound of binning in axis 1 (the x-axis) </td></tr>
    <tr><td class="paramname">nbins2</td><td>number of bins in axis 2 (the y-axis) </td></tr>
    <tr><td class="paramname">low2</td><td>lower bound of binning in axis 2 (the y-axis) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01043">1043</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;{</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  <a class="code" href="classSampleHandlerBase.html#adcc9b928dce6e7dddf761f0c13e7b409">_hPDF1D</a>-&gt;Reset();</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  <a class="code" href="classSampleHandlerBase.html#adcc9b928dce6e7dddf761f0c13e7b409">_hPDF1D</a>-&gt;SetBins(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(nbins1),low1,high1);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  <a class="code" href="classSampleHandlerBase.html#a7938f32b145ce648d3ce4ae33bc9d560">dathist</a>-&gt;SetBins(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(nbins1),low1,high1);</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160; </div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <a class="code" href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">_hPDF2D</a>-&gt;Reset();</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  <a class="code" href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">_hPDF2D</a>-&gt;SetBins(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(nbins1),low1,high1,<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(nbins2),low2,high2);</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  <a class="code" href="classSampleHandlerBase.html#aa7ed25798bc8d52dc16b5ea2f6c9d0c3">dathist2d</a>-&gt;SetBins(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(nbins1),low1,high1,<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(nbins2),low2,high2);</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">XBinEdges</a> = std::vector&lt;double&gt;(nbins1+1);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0;i&lt;nbins1+1;i++) {</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">XBinEdges</a>[i] = <a class="code" href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">_hPDF2D</a>-&gt;GetXaxis()-&gt;GetBinLowEdge(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(i+1));</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  }</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  <a class="code" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a> = std::vector&lt;double&gt;(nbins2+1);</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0;i&lt;nbins2+1;i++) {</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <a class="code" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a>[i] = <a class="code" href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">_hPDF2D</a>-&gt;GetYaxis()-&gt;GetBinLowEdge(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(i+1));</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  }</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160; </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  <span class="comment">//Set the number of X and Y bins now</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  <a class="code" href="classSampleHandlerFD.html#af7c4f1d9510cb3300c8612a95fb1238f">SetupReweightArrays</a>(<a class="code" href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">XBinEdges</a>.size() - 1, <a class="code" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a>.size() - 1);</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160; </div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a5b4c3a7f56f3f7bc352555a0d847ec22">FindNominalBinAndEdges2D</a>();</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae9fe6d9954a86f091778161a1d9ed6d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9fe6d9954a86f091778161a1d9ed6d3">&#9670;&nbsp;</a></span>Set2DBinning() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::Set2DBinning </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>XVec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>YVec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>set the binning for 2D sample used for the likelihood calculation </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">XVec</td><td>vector containing the binning in axis 1 (the x-axis) </td></tr>
    <tr><td class="paramname">YVec</td><td>vector containing the binning in axis 2 (the y-axis) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00182">182</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;{<a class="code" href="classSampleHandlerFD.html#aae57301ae5bf3a8223179c1bd674d73f">Set2DBinning</a>(XVec.size()-1, XVec.data(), YVec.size()-1, YVec.data());};</div>
<div class="ttc" id="aclassSampleHandlerFD_html_aae57301ae5bf3a8223179c1bd674d73f"><div class="ttname"><a href="classSampleHandlerFD.html#aae57301ae5bf3a8223179c1bd674d73f">SampleHandlerFD::Set2DBinning</a></div><div class="ttdeci">void Set2DBinning(size_t nbins1, double *boundaries1, size_t nbins2, double *boundaries2)</div><div class="ttdoc">set the binning for 2D sample used for the likelihood calculation</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01018">SampleHandlerFD.cpp:1018</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a330f801dfd7c0d14326048e93c5a51ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a330f801dfd7c0d14326048e93c5a51ae">&#9670;&nbsp;</a></span>SetupExperimentMC()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual int SampleHandlerFD::SetupExperimentMC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Experiment specific setup, returns the number of events which were loaded. </p>

<p>Implemented in <a class="el" href="classPySampleHandlerFD.html#a209d5dc28b6ebd081dea6b013247aca7">PySampleHandlerFD</a>.</p>

</div>
</div>
<a id="a8e112b4f306f7b792da77f6299535c1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e112b4f306f7b792da77f6299535c1b">&#9670;&nbsp;</a></span>SetupFDMC()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void SampleHandlerFD::SetupFDMC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function which translates experiment struct into core struct. </p>

<p>Implemented in <a class="el" href="classPySampleHandlerFD.html#aade41128c58c8592f72487ccebc37596">PySampleHandlerFD</a>.</p>

</div>
</div>
<a id="aed15ee1f6209f26e55bb8e53108a9c6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed15ee1f6209f26e55bb8e53108a9c6a">&#9670;&nbsp;</a></span>SetupFunctionalParameters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::SetupFunctionalParameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>ETA - a function to setup and pass values to functional parameters where you need to pass a value to some custom reweight calc or engine. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00648">648</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                                                {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a02254668e1d1e4417dfd38e416e46bf8">funcParsVec</a> = <a class="code" href="classSampleHandlerFD.html#a1db89c4df22a237b1cb26a2b55ee0866">ParHandler</a>-&gt;<a class="code" href="group__ParameterHandlerGetters.html#ga8f819bf0ef53544c864649d05479d95c">GetFunctionalParametersFromSampleName</a>(<a class="code" href="classSampleHandlerFD.html#afc09fc72a5d00762fa023ab617f9a54d">SampleName</a>);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="comment">// RegisterFunctionalParameters is implemented in experiment-specific code, </span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="comment">// which calls RegisterIndividualFuncPar to populate funcParsNamesMap, funcParsNamesVec, and funcParsFuncMap</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <a class="code" href="classSampleHandlerFD.html#ab5a809cfcd1e221ba0094b65f8e748f8">RegisterFunctionalParameters</a>();</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a06eab1b725605a68cdb75e3826122c47">funcParsMap</a>.resize(<a class="code" href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">funcParsNamesMap</a>.size());</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a00060ee2bbc0e3e5528932705ce690e6">funcParsGrid</a>.resize(<a class="code" href="group__SampleHandlerGetters.html#ga5463cc125470d1f31fbc1ab8f01b60a7">GetNEvents</a>());</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="comment">// For every functional parameter in XsecCov that matches the name in funcParsNames, add it to the map</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="structFunctionalParameter.html">FunctionalParameter</a> &amp; fp : <a class="code" href="classSampleHandlerFD.html#a02254668e1d1e4417dfd38e416e46bf8">funcParsVec</a>) {</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordflow">for</span> (std::string name : <a class="code" href="classSampleHandlerFD.html#a888112d7eebd6fdb877c0015e1951f9d">funcParsNamesVec</a>) {</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <span class="keywordflow">if</span> (fp.name == name) {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Adding functional parameter: {} to funcParsMap with key: {}&quot;</span>, fp.name, <a class="code" href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">funcParsNamesMap</a>[fp.name]);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        fp.funcPtr = &amp;<a class="code" href="classSampleHandlerFD.html#a577a57992e396a5b34efcd3bb6ed45cf">funcParsFuncMap</a>[<a class="code" href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">funcParsNamesMap</a>[fp.name]];</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <a class="code" href="classSampleHandlerFD.html#a06eab1b725605a68cdb75e3826122c47">funcParsMap</a>[<span class="keyword">static_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">funcParsNamesMap</a>[fp.name])] = &amp;fp;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      }</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="comment">// If we don&#39;t find a match, we need to throw an error</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#a06eab1b725605a68cdb75e3826122c47">funcParsMap</a>[<span class="keyword">static_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">funcParsNamesMap</a>[fp.name])] == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Functional parameter {} not found, did you define it in RegisterFunctionalParameters()?&quot;</span>, fp.name);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    }</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="comment">// Mostly the same as CalcXsecNormsBins</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="comment">// For each event, make a vector of pointers to the functional parameters</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  <span class="keywordflow">for</span> (std::size_t iEvent = 0; iEvent &lt; static_cast&lt;std::size_t&gt;(<a class="code" href="group__SampleHandlerGetters.html#ga5463cc125470d1f31fbc1ab8f01b60a7">GetNEvents</a>()); ++iEvent) {</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="comment">// Now loop over the functional parameters and get a vector of enums corresponding to the functional parameters</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">for</span> (std::vector&lt;FunctionalParameter&gt;::iterator it = <a class="code" href="classSampleHandlerFD.html#a02254668e1d1e4417dfd38e416e46bf8">funcParsVec</a>.begin(); it != <a class="code" href="classSampleHandlerFD.html#a02254668e1d1e4417dfd38e416e46bf8">funcParsVec</a>.end(); ++it) {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      <span class="comment">// Check whether the interaction modes match</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="keywordtype">bool</span> ModeMatch = <a class="code" href="classSampleHandlerBase.html#ad16c838d4dc86e98445f199a16cf9bdf">MatchCondition</a>((*it).modes, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::round(*(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].mode))));</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      <span class="keywordflow">if</span> (!ModeMatch) {</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#afc88f0aa23c7127b2ff6e5c7ca3fa892">MACH3LOG_TRACE</a>(<span class="stringliteral">&quot;Event {}, missed Mode check ({}) for dial {}&quot;</span>, iEvent, *(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].mode), (*it).name);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      }</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      <span class="comment">// Now check whether within kinematic bounds</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      <span class="keywordtype">bool</span> IsSelected = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      <span class="keywordflow">if</span> ((*it).hasKinBounds) {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; kinVars = (*it).KinematicVarStr;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; selection = (*it).Selection;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160; </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        <span class="keywordflow">for</span> (std::size_t iKinPar = 0; iKinPar &lt; kinVars.size(); ++iKinPar) {</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span> kinVal = <a class="code" href="classSampleHandlerFD.html#ad0f549802b5625871e11d86905989697">ReturnKinematicParameter</a>(kinVars[iKinPar], <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(iEvent));</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;          <span class="keywordflow">if</span> (kinVal &lt;= selection[iKinPar][0] || kinVal &gt; selection[iKinPar][1]) {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            <a class="code" href="MaCh3Logger_8h.html#afc88f0aa23c7127b2ff6e5c7ca3fa892">MACH3LOG_TRACE</a>(<span class="stringliteral">&quot;Event {}, missed kinematic check ({}) for dial {}&quot;</span>,</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                            iEvent, kinVars[iKinPar], (*it).name);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            IsSelected = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;          }</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      }</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      <span class="comment">// Need to then break the event loop</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      <span class="keywordflow">if</span>(!IsSelected){</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#afc88f0aa23c7127b2ff6e5c7ca3fa892">MACH3LOG_TRACE</a>(<span class="stringliteral">&quot;Event {}, missed Kinematic var check for dial {}&quot;</span>, iEvent, (*it).name);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      }</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      <span class="keyword">auto</span> funcparenum = <a class="code" href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">funcParsNamesMap</a>[(*it).name];</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <a class="code" href="classSampleHandlerFD.html#a00060ee2bbc0e3e5528932705ce690e6">funcParsGrid</a>.at(iEvent).push_back(funcparenum);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    }</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  }</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Finished setting up functional parameters&quot;</span>);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a02254668e1d1e4417dfd38e416e46bf8"><div class="ttname"><a href="classSampleHandlerFD.html#a02254668e1d1e4417dfd38e416e46bf8">SampleHandlerFD::funcParsVec</a></div><div class="ttdeci">std::vector&lt; FunctionalParameter &gt; funcParsVec</div><div class="ttdoc">HH - a vector that stores all the FuncPars struct.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00214">SampleHandlerFD.h:212</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ab5a809cfcd1e221ba0094b65f8e748f8"><div class="ttname"><a href="classSampleHandlerFD.html#ab5a809cfcd1e221ba0094b65f8e748f8">SampleHandlerFD::RegisterFunctionalParameters</a></div><div class="ttdeci">virtual void RegisterFunctionalParameters()=0</div><div class="ttdoc">HH - a experiment-specific function where the maps to actual functions are set up.</div></div>
<div class="ttc" id="agroup__ParameterHandlerGetters_html_ga8f819bf0ef53544c864649d05479d95c"><div class="ttname"><a href="group__ParameterHandlerGetters.html#ga8f819bf0ef53544c864649d05479d95c">ParameterHandlerGeneric::GetFunctionalParametersFromSampleName</a></div><div class="ttdeci">const std::vector&lt; FunctionalParameter &gt; GetFunctionalParametersFromSampleName(const std::string &amp;SampleName) const</div><div class="ttdoc">HH Get functional parameters for the relevant SampleName.</div><div class="ttdef"><b>Definition:</b> <a href="ParameterHandlerGeneric_8cpp_source.html#l00326">ParameterHandlerGeneric.cpp:326</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a61a1e9bbc4f812704278bf655d0d0ae2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61a1e9bbc4f812704278bf655d0d0ae2">&#9670;&nbsp;</a></span>SetupKinematicMap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::SetupKinematicMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Ensure Kinematic Map is setup and make sure it is initialised correctly. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00230">230</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                                        {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#aae37732e76f0b17b6f124bd5543177e4">KinematicParameters</a> == <span class="keyword">nullptr</span> || <a class="code" href="classSampleHandlerFD.html#ad7ac675cc4ce81bec42e0700f1ff2620">ReversedKinematicParameters</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Map KinematicParameters or ReversedKinematicParameters hasn&#39;t been initialised&quot;</span>);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">// KS: Ensure maps exist correctly</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; pair : *<a class="code" href="classSampleHandlerFD.html#aae37732e76f0b17b6f124bd5543177e4">KinematicParameters</a>) {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; key = pair.first;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; value = pair.second;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keyword">auto</span> it = <a class="code" href="classSampleHandlerFD.html#ad7ac675cc4ce81bec42e0700f1ff2620">ReversedKinematicParameters</a>-&gt;find(value);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">if</span> (it == <a class="code" href="classSampleHandlerFD.html#ad7ac675cc4ce81bec42e0700f1ff2620">ReversedKinematicParameters</a>-&gt;end() || it-&gt;second != key) {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Mismatch found: {} -&gt; {} but {} -&gt; {}&quot;</span>,</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                     key, value, value, (it != <a class="code" href="classSampleHandlerFD.html#ad7ac675cc4ce81bec42e0700f1ff2620">ReversedKinematicParameters</a>-&gt;end() ? it-&gt;second : <span class="stringliteral">&quot;NOT FOUND&quot;</span>));</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5fa55fd1e82f8c4fccd5cd77b814f86a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fa55fd1e82f8c4fccd5cd77b814f86a">&#9670;&nbsp;</a></span>SetupNormParameters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::SetupNormParameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00770">770</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                                          {  </div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  std::vector&lt; std::vector&lt; int &gt; &gt; xsec_norms_bins(<a class="code" href="group__SampleHandlerGetters.html#ga5463cc125470d1f31fbc1ab8f01b60a7">GetNEvents</a>());</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a5bbc930a955e5171d15324d6b2e55f81">norm_parameters</a> = <a class="code" href="classSampleHandlerFD.html#a1db89c4df22a237b1cb26a2b55ee0866">ParHandler</a>-&gt;<a class="code" href="group__ParameterHandlerGetters.html#ga1564cde885453c57312f769e57d627ac">GetNormParsFromSampleName</a>(<a class="code" href="group__SampleHandlerGetters.html#ga46ca9963ed2f9b9b337db72bf52d99e6">GetSampleName</a>());</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="classSampleHandlerFD.html#a1db89c4df22a237b1cb26a2b55ee0866">ParHandler</a>){</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;ParHandler is not setup!&quot;</span>);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  }</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <span class="comment">// Assign xsec norm bins in MCSamples tree</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a5d4ae325a527df590f54121d51dd0a16">CalcNormsBins</a>(xsec_norms_bins);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160; </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <span class="comment">//DB Attempt at reducing impact of SystematicHandlerGeneric::calcReweight()</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  <span class="keywordtype">int</span> counter;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iEvent = 0; iEvent &lt; <a class="code" href="group__SampleHandlerGetters.html#ga5463cc125470d1f31fbc1ab8f01b60a7">GetNEvents</a>(); ++iEvent) {</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    counter = 0;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].xsec_norm_pointers.resize(xsec_norms_bins[iEvent].<a class="code" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>());</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordflow">for</span>(<span class="keyword">auto</span> <span class="keyword">const</span> &amp; norm_bin: xsec_norms_bins[iEvent]) {</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].xsec_norm_pointers[counter] = <a class="code" href="classSampleHandlerFD.html#a1db89c4df22a237b1cb26a2b55ee0866">ParHandler</a>-&gt;<a class="code" href="classParameterHandlerBase.html#a2929feac84b65e987bc92448754c5b1b">RetPointer</a>(norm_bin);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      counter += 1;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    }</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  }</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;}</div>
<div class="ttc" id="aGetPenaltyTerm_8cpp_html_a439227feff9d7f55384e8780cfc2eb82"><div class="ttname"><a href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a></div><div class="ttdeci">int size</div><div class="ttdef"><b>Definition:</b> <a href="GetPenaltyTerm_8cpp_source.html#l00037">GetPenaltyTerm.cpp:37</a></div></div>
<div class="ttc" id="aclassParameterHandlerBase_html_a2929feac84b65e987bc92448754c5b1b"><div class="ttname"><a href="classParameterHandlerBase.html#a2929feac84b65e987bc92448754c5b1b">ParameterHandlerBase::RetPointer</a></div><div class="ttdeci">const double * RetPointer(const int iParam)</div><div class="ttdoc">DB Pointer return to param position.</div><div class="ttdef"><b>Definition:</b> <a href="ParameterHandlerBase_8h_source.html#l00237">ParameterHandlerBase.h:237</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a5d4ae325a527df590f54121d51dd0a16"><div class="ttname"><a href="classSampleHandlerFD.html#a5d4ae325a527df590f54121d51dd0a16">SampleHandlerFD::CalcNormsBins</a></div><div class="ttdeci">void CalcNormsBins(std::vector&lt; std::vector&lt; int &gt; &gt; &amp;xsec_norms_bins)</div><div class="ttdoc">Check whether a normalisation systematic affects an event or not.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00799">SampleHandlerFD.cpp:799</a></div></div>
<div class="ttc" id="agroup__ParameterHandlerGetters_html_ga1564cde885453c57312f769e57d627ac"><div class="ttname"><a href="group__ParameterHandlerGetters.html#ga1564cde885453c57312f769e57d627ac">ParameterHandlerGeneric::GetNormParsFromSampleName</a></div><div class="ttdeci">const std::vector&lt; NormParameter &gt; GetNormParsFromSampleName(const std::string &amp;SampleName) const</div><div class="ttdoc">DB Get norm/func parameters depending on given SampleName.</div><div class="ttdef"><b>Definition:</b> <a href="ParameterHandlerGeneric_8cpp_source.html#l00333">ParameterHandlerGeneric.cpp:333</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae4bcbd508ec8d14d36f32911e12af1e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4bcbd508ec8d14d36f32911e12af1e9">&#9670;&nbsp;</a></span>SetupNuOscillatorPointers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::SetupNuOscillatorPointers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01283">1283</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                                                {</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iEvent=0;iEvent&lt;<a class="code" href="group__SampleHandlerGetters.html#ga5463cc125470d1f31fbc1ab8f01b60a7">GetNEvents</a>();iEvent++) {</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].osc_w_pointer = &amp;<a class="code" href="namespaceM3.html#a8b0081813e8f5b1c946821be4f114bd5">M3::Unity</a>;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].isNC) {</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;      <span class="keywordflow">if</span> (*<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].nupdg != *<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].nupdgUnosc) {</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].osc_w_pointer = &amp;<a class="code" href="namespaceM3.html#aa4fe46050b3e557896f8698a75cabeb3">M3::Zero</a>;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;        <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].osc_w_pointer = &amp;<a class="code" href="namespaceM3.html#a8b0081813e8f5b1c946821be4f114bd5">M3::Unity</a>;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      }</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;      <span class="keywordtype">int</span> InitFlav = <a class="code" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a>;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;      <span class="keywordtype">int</span> FinalFlav = <a class="code" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a>;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160; </div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      InitFlav =  <a class="code" href="namespaceMaCh3Utils.html#a8152408c87ebdf1f28204c54f01384d5">MaCh3Utils::PDGToNuOscillatorFlavour</a>((*<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].nupdgUnosc));</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;      FinalFlav = <a class="code" href="namespaceMaCh3Utils.html#a8152408c87ebdf1f28204c54f01384d5">MaCh3Utils::PDGToNuOscillatorFlavour</a>((*<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].nupdg));</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160; </div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      <span class="keywordflow">if</span> (InitFlav == <a class="code" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a> || FinalFlav == <a class="code" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a>) {</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Something has gone wrong in the mapping between MCSamples.nutype and the enum used within NuOscillator&quot;</span>);</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;MCSamples.nupdgUnosc: {}&quot;</span>, (*<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].nupdgUnosc));</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;InitFlav: {}&quot;</span>, InitFlav);</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;MCSamples.nupdg: {}&quot;</span>, (*<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].nupdg));</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;FinalFlav: {}&quot;</span>, FinalFlav);</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;      }</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160; </div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> OscIndex = <a class="code" href="FarDetectorCoreInfoStruct_8h.html#afc52c63bc2b15ae30444755579f5beb4">GetOscChannel</a>(<a class="code" href="classSampleHandlerFD.html#a57f378f84f66caa817e52c0bfb5ff0be">OscChannels</a>, (*<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].nupdgUnosc), (*<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].nupdg));</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      <span class="comment">//Can only happen if truecz has been initialised within the experiment specific code</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;      <span class="keywordflow">if</span> (*(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].rw_truecz) != <a class="code" href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a>) {</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        <span class="comment">//Atmospherics</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].osc_w_pointer = <a class="code" href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">Oscillator</a>-&gt;GetNuOscillatorPointers(OscIndex, InitFlav, FinalFlav, FLOAT_T(*(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].rw_etru)), FLOAT_T(*(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].rw_truecz)));</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        <span class="comment">//Beam</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        <a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].osc_w_pointer = <a class="code" href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">Oscillator</a>-&gt;GetNuOscillatorPointers(OscIndex, InitFlav, FinalFlav, FLOAT_T(*(<a class="code" href="classSampleHandlerFD.html#af779913cecbf20c194010aa540ac78c8">MCSamples</a>[iEvent].rw_etru)));</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      }</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    } <span class="comment">// end if NC</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  } <span class="comment">// end loop over events</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;}</div>
<div class="ttc" id="anamespaceM3_html_a8b0081813e8f5b1c946821be4f114bd5"><div class="ttname"><a href="namespaceM3.html#a8b0081813e8f5b1c946821be4f114bd5">M3::Unity</a></div><div class="ttdeci">constexpr static const float_t Unity</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00054">Core.h:54</a></div></div>
<div class="ttc" id="anamespaceM3_html_aa4fe46050b3e557896f8698a75cabeb3"><div class="ttname"><a href="namespaceM3.html#aa4fe46050b3e557896f8698a75cabeb3">M3::Zero</a></div><div class="ttdeci">constexpr static const float_t Zero</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00061">Core.h:61</a></div></div>
<div class="ttc" id="anamespaceMaCh3Utils_html_a8152408c87ebdf1f28204c54f01384d5"><div class="ttname"><a href="namespaceMaCh3Utils.html#a8152408c87ebdf1f28204c54f01384d5">MaCh3Utils::PDGToNuOscillatorFlavour</a></div><div class="ttdeci">int PDGToNuOscillatorFlavour(int NuPdg)</div><div class="ttdoc">Convert from PDG flavour to NuOscillator type beware that in the case of anti-neutrinos the NuOscilla...</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00241">SampleStructs.h:241</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af7c4f1d9510cb3300c8612a95fb1238f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7c4f1d9510cb3300c8612a95fb1238f">&#9670;&nbsp;</a></span>SetupReweightArrays()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::SetupReweightArrays </td>
          <td>(</td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>numberXBins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>numberYBins</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialise data, MC and W2 histograms. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00896">896</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                                                                                            {</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <span class="comment">//Set the number of X and Y bins now</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <a class="code" href="classSampleHandlerFD.html#ab933df667fbccf97b3028297ddd8eae2">nXBins</a> = numberXBins;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <a class="code" href="classSampleHandlerFD.html#ae48ed0755671be986cb04690b4fa6959">nYBins</a> = numberYBins;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <a class="code" href="classSampleHandlerFD.html#aab040097a0524dd6aa6cad01c991b5ce">SampleHandlerFD_array</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>*[<a class="code" href="classSampleHandlerFD.html#ae48ed0755671be986cb04690b4fa6959">nYBins</a>];</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a3905ae0e2531525dba5d663110f86527">SampleHandlerFD_array_w2</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>*[<a class="code" href="classSampleHandlerFD.html#ae48ed0755671be986cb04690b4fa6959">nYBins</a>];</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <a class="code" href="classSampleHandlerFD.html#adce8040b6fe6501aa4833bbb5ca1163f">SampleHandlerFD_data</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>*[<a class="code" href="classSampleHandlerFD.html#ae48ed0755671be986cb04690b4fa6959">nYBins</a>];</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> yBin=0;yBin&lt;<a class="code" href="classSampleHandlerFD.html#ae48ed0755671be986cb04690b4fa6959">nYBins</a>;yBin++) {</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <a class="code" href="classSampleHandlerFD.html#aab040097a0524dd6aa6cad01c991b5ce">SampleHandlerFD_array</a>[yBin] = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classSampleHandlerFD.html#ab933df667fbccf97b3028297ddd8eae2">nXBins</a>];</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a3905ae0e2531525dba5d663110f86527">SampleHandlerFD_array_w2</a>[yBin] = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classSampleHandlerFD.html#ab933df667fbccf97b3028297ddd8eae2">nXBins</a>];</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <a class="code" href="classSampleHandlerFD.html#adce8040b6fe6501aa4833bbb5ca1163f">SampleHandlerFD_data</a>[yBin] = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classSampleHandlerFD.html#ab933df667fbccf97b3028297ddd8eae2">nXBins</a>];</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> xBin=0;xBin&lt;<a class="code" href="classSampleHandlerFD.html#ab933df667fbccf97b3028297ddd8eae2">nXBins</a>;xBin++) {</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      <a class="code" href="classSampleHandlerFD.html#aab040097a0524dd6aa6cad01c991b5ce">SampleHandlerFD_array</a>[yBin][xBin] = 0.;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      <a class="code" href="classSampleHandlerFD.html#a3905ae0e2531525dba5d663110f86527">SampleHandlerFD_array_w2</a>[yBin][xBin] = 0.;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      <a class="code" href="classSampleHandlerFD.html#adce8040b6fe6501aa4833bbb5ca1163f">SampleHandlerFD_data</a>[yBin][xBin] = 0.;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    }</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  }</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aded32bec26d70281e5f134e10beda79b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aded32bec26d70281e5f134e10beda79b">&#9670;&nbsp;</a></span>SetupSampleBinning()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::SetupSampleBinning </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>wrapper to call set binning functions based on sample config info </p>
<p>Function to setup the binning of your sample histograms and the underlying arrays that get handled in fillArray() and fillArray_MP(). The SampleXBins are filled in the daughter class from the sample config file. This "passing" can be removed. <br  />
</p>
<p>@function <a class="el" href="classSampleHandlerFD.html#aded32bec26d70281e5f134e10beda79b" title="wrapper to call set binning functions based on sample config info">SampleHandlerFD::SetupSampleBinning()</a> </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00280">280</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                        {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Setting up Sample Binning&quot;</span>);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  TString histname1d = (<a class="code" href="classSampleHandlerFD.html#a5cd052288a69d57c215088e666fa4be3">XVarStr</a>).c_str();</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  TString histname2d = (<a class="code" href="classSampleHandlerFD.html#a5cd052288a69d57c215088e666fa4be3">XVarStr</a>+<span class="stringliteral">&quot;_&quot;</span>+<a class="code" href="classSampleHandlerFD.html#a8fda7dea41c730724a5b3e171a572378">YVarStr</a>).c_str();</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  TString histtitle = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="comment">//The binning here is arbitrary, now we get info from cfg so the</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="comment">//set1DBinning and set2Dbinning calls below will make the binning</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="comment">//to be what we actually want</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <a class="code" href="classSampleHandlerBase.html#adcc9b928dce6e7dddf761f0c13e7b409">_hPDF1D</a>   = <span class="keyword">new</span> TH1D(<span class="stringliteral">&quot;h&quot;</span>+histname1d+<a class="code" href="classSampleHandlerFD.html#a1ebc5e194703ef6b9d3c7e4994417d60">SampleTitle</a>,histtitle, 1, 0, 1);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <a class="code" href="classSampleHandlerBase.html#a7938f32b145ce648d3ce4ae33bc9d560">dathist</a>   = <span class="keyword">new</span> TH1D(<span class="stringliteral">&quot;d&quot;</span>+histname1d+<a class="code" href="classSampleHandlerFD.html#a1ebc5e194703ef6b9d3c7e4994417d60">SampleTitle</a>,histtitle, 1, 0, 1);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <a class="code" href="classSampleHandlerBase.html#abd5728e1c6a21b870ec0a5567bd18389">_hPDF2D</a>   = <span class="keyword">new</span> TH2D(<span class="stringliteral">&quot;h&quot;</span>+histname2d+<a class="code" href="classSampleHandlerFD.html#a1ebc5e194703ef6b9d3c7e4994417d60">SampleTitle</a>,histtitle, 1, 0, 1, 1, 0, 1);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <a class="code" href="classSampleHandlerBase.html#aa7ed25798bc8d52dc16b5ea2f6c9d0c3">dathist2d</a> = <span class="keyword">new</span> TH2D(<span class="stringliteral">&quot;d&quot;</span>+histname2d+<a class="code" href="classSampleHandlerFD.html#a1ebc5e194703ef6b9d3c7e4994417d60">SampleTitle</a>,histtitle, 1, 0, 1, 1, 0, 1);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="comment">//Make some arrays so we can initialise _hPDF1D and _hPDF2D with these</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">XBinEdges</a>.reserve(<a class="code" href="classSampleHandlerFD.html#a8e0ad070b2d5c389350709110ad7e193">SampleXBins</a>.size());</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <a class="code" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a>.reserve(<a class="code" href="classSampleHandlerFD.html#a7da646b34085605653acb7965068c4a5">SampleYBins</a>.size());</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="comment">//A string to store the binning for a nice print out</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  std::string XBinEdgesStr = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  std::string YBinEdgesStr = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keywordflow">for</span>(<span class="keyword">auto</span> XBinEdge : <a class="code" href="classSampleHandlerFD.html#a8e0ad070b2d5c389350709110ad7e193">SampleXBins</a>){</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a1d79462d4aab26cdb603b45addff173a">XBinEdges</a>.push_back(XBinEdge);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    XBinEdgesStr += std::to_string(XBinEdge);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    XBinEdgesStr += <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;XBinning:&quot;</span>);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{}&quot;</span>, XBinEdgesStr);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="comment">//And now the YBin Edges</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordflow">for</span>(<span class="keyword">auto</span> YBinEdge : <a class="code" href="classSampleHandlerFD.html#a7da646b34085605653acb7965068c4a5">SampleYBins</a>){</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <a class="code" href="classSampleHandlerFD.html#ac8e54b8d677e132f8d7237495f6fb755">YBinEdges</a>.push_back(YBinEdge);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    YBinEdgesStr += std::to_string(YBinEdge);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    YBinEdgesStr += <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;YBinning:&quot;</span>);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{}&quot;</span>, YBinEdgesStr);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="comment">//Check whether you are setting up 1D or 2D binning</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#af03bf91649d1848a3e531ff7f865c313">nDimensions</a> == 1){</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Setting up 1D binning with {}&quot;</span>, <a class="code" href="classSampleHandlerFD.html#a5cd052288a69d57c215088e666fa4be3">XVarStr</a>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <a class="code" href="classSampleHandlerFD.html#af9ea7e245d3bf6098ee49de38cf6d1fe">Set1DBinning</a>(<a class="code" href="classSampleHandlerFD.html#a8e0ad070b2d5c389350709110ad7e193">SampleXBins</a>);  </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#af03bf91649d1848a3e531ff7f865c313">nDimensions</a> == 2){</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Setting up 2D binning with {} and {}&quot;</span>, <a class="code" href="classSampleHandlerFD.html#a5cd052288a69d57c215088e666fa4be3">XVarStr</a>, <a class="code" href="classSampleHandlerFD.html#a8fda7dea41c730724a5b3e171a572378">YVarStr</a>);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <a class="code" href="classSampleHandlerFD.html#aae57301ae5bf3a8223179c1bd674d73f">Set2DBinning</a>(<a class="code" href="classSampleHandlerFD.html#a8e0ad070b2d5c389350709110ad7e193">SampleXBins</a>, <a class="code" href="classSampleHandlerFD.html#a7da646b34085605653acb7965068c4a5">SampleYBins</a>);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Number of dimensions is not 1 or 2, this is unsupported at the moment&quot;</span>);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1a984c564107c7207a2611d0bf67d9cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a984c564107c7207a2611d0bf67d9cc">&#9670;&nbsp;</a></span>SetupSplines()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void SampleHandlerFD::SetupSplines </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>initialise your splineXX object and then use InitialiseSplineObject to conviently setup everything up </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000006">Todo:</a></b></dt><dd>abstract the spline initialisation completely to core </dd></dl>

<p>Implemented in <a class="el" href="classPySampleHandlerFD.html#a0b69ca72140420ed71397b0dd1ceaebc">PySampleHandlerFD</a>.</p>

</div>
</div>
<a id="addd28baa3d823f7a9cd69864185fe399"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addd28baa3d823f7a9cd69864185fe399">&#9670;&nbsp;</a></span>SetupWeightPointers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void SampleHandlerFD::SetupWeightPointers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>DB Function to determine which weights apply to which types of samples pure virtual!! </p>

<p>Implemented in <a class="el" href="classPySampleHandlerFD.html#a0edc138b054b18f0d5c4c7d9dff10314">PySampleHandlerFD</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ad625af417f4445b9b14710ca3bdc409d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad625af417f4445b9b14710ca3bdc409d">&#9670;&nbsp;</a></span>_modeNomWeightMap</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt;std::string, double&gt; SampleHandlerFD::_modeNomWeightMap</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00354">354</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a1ff1ef7d99cee6d6a9fba74296d4d0ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ff1ef7d99cee6d6a9fba74296d4d0ea">&#9670;&nbsp;</a></span>FirstTimeW2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool SampleHandlerFD::FirstTimeW2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS:Super hacky to update W2 or not. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00362">362</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a577a57992e396a5b34efcd3bb6ed45cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a577a57992e396a5b34efcd3bb6ed45cf">&#9670;&nbsp;</a></span>funcParsFuncMap</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt;int, <a class="el" href="ParameterStructs_8h.html#a916ddc21f75755739f308b54dd06e0ae">FuncParFuncType</a>&gt; SampleHandlerFD::funcParsFuncMap</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>HH - a map that relates the funcpar enum to pointer of the actual function. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00225">225</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a00060ee2bbc0e3e5528932705ce690e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00060ee2bbc0e3e5528932705ce690e6">&#9670;&nbsp;</a></span>funcParsGrid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;int&gt; &gt; SampleHandlerFD::funcParsGrid</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>HH - a grid of vectors of enums for each sample and event. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00227">227</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a06eab1b725605a68cdb75e3826122c47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06eab1b725605a68cdb75e3826122c47">&#9670;&nbsp;</a></span>funcParsMap</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structFunctionalParameter.html">FunctionalParameter</a> *&gt; SampleHandlerFD::funcParsMap</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>HH - a map that relates the funcpar enum to pointer of FuncPars struct. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00222">222</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="af8ed9895a0b2802e45569ce2d1a0a837"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8ed9895a0b2802e45569ce2d1a0a837">&#9670;&nbsp;</a></span>funcParsNamesMap</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt;std::string, int&gt; SampleHandlerFD::funcParsNamesMap</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>HH - a map that relates the name of the functional parameter to funcpar enum. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00217">217</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a888112d7eebd6fdb877c0015e1951f9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a888112d7eebd6fdb877c0015e1951f9d">&#9670;&nbsp;</a></span>funcParsNamesVec</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; SampleHandlerFD::funcParsNamesVec = {}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>HH - a vector of string names for each functional parameter. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00229">229</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a02254668e1d1e4417dfd38e416e46bf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02254668e1d1e4417dfd38e416e46bf8">&#9670;&nbsp;</a></span>funcParsVec</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structFunctionalParameter.html">FunctionalParameter</a>&gt; SampleHandlerFD::funcParsVec</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>HH - a vector that stores all the FuncPars struct. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00214">214</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="aae37732e76f0b17b6f124bd5543177e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae37732e76f0b17b6f124bd5543177e4">&#9670;&nbsp;</a></span>KinematicParameters</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::unordered_map&lt;std::string, int&gt;* SampleHandlerFD::KinematicParameters</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Mapping between string and kinematic enum. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00340">340</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="abd686fdebead1a699d9bad4a1bebaa8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd686fdebead1a699d9bad4a1bebaa8f">&#9670;&nbsp;</a></span>mc_files</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; SampleHandlerFD::mc_files</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00351">351</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="af779913cecbf20c194010aa540ac78c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af779913cecbf20c194010aa540ac78c8">&#9670;&nbsp;</a></span>MCSamples</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structFarDetectorCoreInfo.html">FarDetectorCoreInfo</a>&gt; SampleHandlerFD::MCSamples</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00300">300</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="af03bf91649d1848a3e531ff7f865c313"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af03bf91649d1848a3e531ff7f865c313">&#9670;&nbsp;</a></span>nDimensions</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SampleHandlerFD::nDimensions = <a class="el" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Keep track of the dimensions of the sample binning. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00314">314</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a5bbc930a955e5171d15324d6b2e55f81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bbc930a955e5171d15324d6b2e55f81">&#9670;&nbsp;</a></span>norm_parameters</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structNormParameter.html">NormParameter</a>&gt; SampleHandlerFD::norm_parameters</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Information to store for normalisation pars. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00322">322</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="ab933df667fbccf97b3028297ddd8eae2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab933df667fbccf97b3028297ddd8eae2">&#9670;&nbsp;</a></span>nXBins</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t SampleHandlerFD::nXBins</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of X axis bins in the histogram used for likelihood calculation. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00286">286</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="ae48ed0755671be986cb04690b4fa6959"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae48ed0755671be986cb04690b4fa6959">&#9670;&nbsp;</a></span>nYBins</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t SampleHandlerFD::nYBins</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of Y axis bins in the histogram used for likelihood calculation. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00288">288</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a57f378f84f66caa817e52c0bfb5ff0be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57f378f84f66caa817e52c0bfb5ff0be">&#9670;&nbsp;</a></span>OscChannels</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structOscChannelInfo.html">OscChannelInfo</a>&gt; SampleHandlerFD::OscChannels</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00301">301</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="aa7115dd53d73a45fb64c565561095b6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7115dd53d73a45fb64c565561095b6a">&#9670;&nbsp;</a></span>Oscillator</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="classOscillationHandler.html">OscillationHandler</a>&gt; SampleHandlerFD::Oscillator</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Contains all your binned splines and handles the setup and the returning of weights from spline evaluations. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00144">144</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="af118f92cdc227715e60ca7d76778508f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af118f92cdc227715e60ca7d76778508f">&#9670;&nbsp;</a></span>OscParHandler</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classParameterHandlerOsc.html">ParameterHandlerOsc</a>* SampleHandlerFD::OscParHandler = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00309">309</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a1db89c4df22a237b1cb26a2b55ee0866"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1db89c4df22a237b1cb26a2b55ee0866">&#9670;&nbsp;</a></span>ParHandler</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classParameterHandlerGeneric.html">ParameterHandlerGeneric</a>* SampleHandlerFD::ParHandler = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00308">308</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="ad7ac675cc4ce81bec42e0700f1ff2620"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7ac675cc4ce81bec42e0700f1ff2620">&#9670;&nbsp;</a></span>ReversedKinematicParameters</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::unordered_map&lt;int, std::string&gt;* SampleHandlerFD::ReversedKinematicParameters</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Mapping between kinematic enum and string. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00342">342</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="aab040097a0524dd6aa6cad01c991b5ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab040097a0524dd6aa6cad01c991b5ce">&#9670;&nbsp;</a></span>SampleHandlerFD_array</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double** SampleHandlerFD::SampleHandlerFD_array</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>DB Array to be filled after reweighting. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00291">291</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a3905ae0e2531525dba5d663110f86527"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3905ae0e2531525dba5d663110f86527">&#9670;&nbsp;</a></span>SampleHandlerFD_array_w2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double** SampleHandlerFD::SampleHandlerFD_array_w2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS Array used for MC stat. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00293">293</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="adce8040b6fe6501aa4833bbb5ca1163f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adce8040b6fe6501aa4833bbb5ca1163f">&#9670;&nbsp;</a></span>SampleHandlerFD_data</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double** SampleHandlerFD::SampleHandlerFD_data</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>DB Array to be filled in AddData. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00295">295</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a9ccc0e26810ded77d0615e95e8a9b277"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ccc0e26810ded77d0615e95e8a9b277">&#9670;&nbsp;</a></span>SampleManager</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classmanager.html">manager</a>&gt; SampleHandlerFD::SampleManager</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The manager object used to read the sample yaml file. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00345">345</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="afc09fc72a5d00762fa023ab617f9a54d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc09fc72a5d00762fa023ab617f9a54d">&#9670;&nbsp;</a></span>SampleName</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::SampleName</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A unique ID for each sample based on powers of two for quick binary operator comparisons. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00316">316</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a1ebc5e194703ef6b9d3c7e4994417d60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ebc5e194703ef6b9d3c7e4994417d60">&#9670;&nbsp;</a></span>SampleTitle</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::SampleTitle</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>the name of this sample e.g."muon-like" </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00319">319</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a8e0ad070b2d5c389350709110ad7e193"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e0ad070b2d5c389350709110ad7e193">&#9670;&nbsp;</a></span>SampleXBins</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleHandlerFD::SampleXBins</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>vector of the binning used in axis 1 (the x-axis) </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00192">192</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a7da646b34085605653acb7965068c4a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7da646b34085605653acb7965068c4a5">&#9670;&nbsp;</a></span>SampleYBins</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleHandlerFD::SampleYBins</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>vector of the binning used in axis 2 (the y-axis) </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00194">194</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a2b0a7ada3c931e66211eebd91de0c0d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b0a7ada3c931e66211eebd91de0c0d0">&#9670;&nbsp;</a></span>Selection</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; SampleHandlerFD::Selection</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>a way to store selection cuts which you may push back in the get1DVar functions most of the time this is just the same as StoredSelection </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00336">336</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="abe55d06685c38b03a10134019b1aca06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe55d06685c38b03a10134019b1aca06">&#9670;&nbsp;</a></span>SelectionStr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::string &gt; SampleHandlerFD::SelectionStr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>the strings grabbed from the sample config specifying the selections </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00333">333</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a4a02e96c7d7731097c7c10660d23b3a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a02e96c7d7731097c7c10660d23b3a5">&#9670;&nbsp;</a></span>spline_files</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; SampleHandlerFD::spline_files</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00352">352</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a17193b3fe2b44e6484f9eefda86f97dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17193b3fe2b44e6484f9eefda86f97dd">&#9670;&nbsp;</a></span>SplineHandler</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classBinnedSplineHandler.html">BinnedSplineHandler</a>&gt; SampleHandlerFD::SplineHandler</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Contains all your binned splines and handles the setup and the returning of weights from spline evaluations. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00141">141</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a0d4d75bc7d6611e0eab5501311bd38f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d4d75bc7d6611e0eab5501311bd38f0">&#9670;&nbsp;</a></span>SplineVarNames</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; SampleHandlerFD::SplineVarNames</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00190">190</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a402634a2a3f7520228b50bf208c00e78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a402634a2a3f7520228b50bf208c00e78">&#9670;&nbsp;</a></span>StoredSelection</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; SampleHandlerFD::StoredSelection</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>What gets pulled from config options, these are constant after loading in this is of length 3: 0th index is the value, 1st is lower bound, 2nd is upper bound. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00331">331</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="af60df24f4eb7954a3297c9841c60624b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af60df24f4eb7954a3297c9841c60624b">&#9670;&nbsp;</a></span>THStackLeg</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TLegend* SampleHandlerFD::THStackLeg = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>DB Miscellaneous Variables. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00358">358</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="aa654562842a0da51ff917aaed517310e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa654562842a0da51ff917aaed517310e">&#9670;&nbsp;</a></span>UpdateW2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool SampleHandlerFD::UpdateW2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS:Super hacky to update W2 or not. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00364">364</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a1d79462d4aab26cdb603b45addff173a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d79462d4aab26cdb603b45addff173a">&#9670;&nbsp;</a></span>XBinEdges</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleHandlerFD::XBinEdges</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector to hold x-axis bin-edges. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00280">280</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a5cd052288a69d57c215088e666fa4be3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cd052288a69d57c215088e666fa4be3">&#9670;&nbsp;</a></span>XVarStr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::XVarStr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>the strings associated with the variables used for the binning e.g. "RecoNeutrinoEnergy" </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00189">189</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="ac8e54b8d677e132f8d7237495f6fb755"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8e54b8d677e132f8d7237495f6fb755">&#9670;&nbsp;</a></span>YBinEdges</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleHandlerFD::YBinEdges</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector to hold y-axis bin-edges. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00282">282</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a8fda7dea41c730724a5b3e171a572378"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fda7dea41c730724a5b3e171a572378">&#9670;&nbsp;</a></span>YVarStr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::YVarStr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00189">189</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/hosthome/v2.1.0/Samples/<a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a></li>
<li>/hosthome/v2.1.0/Samples/<a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a></li>
</ul>
</div><!-- contents -->
<footer class="mach3-footer" style="text-align: center;">
    <div style="margin-bottom: 15px;">
        <span style="font-weight: bold;">The MaCh3 Collaboration</span>
    </div>
    <div style="margin-bottom: 10px;">
        <span>Select Software Version: </span>
        <select id="versionSelector" onchange="window.location.href=this.value" style="padding: 5px; border-radius: 4px; border: 1px solid #ccc;">
            <option value="">-- Select --</option>
            <option value="https://mach3-software.github.io/MaCh3/">develop</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.2.0/index.html">v2.2.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.1.0/index.html">v2.1.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.0.0/index.html">v2.0.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.5.0/index.html">v1.5.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.4.0/index.html">v1.4.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.3.0/index.html">v1.3.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.2.0/index.html">v1.2.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.1.0/index.html">v1.1.0</option>
        </select>
    </div>
    <div style="font-size: 0.9em; color: #666; margin-top: 10px;">
        Documentation generated with <a href="https://www.doxygen.nl/" target="_blank" style="color: #666;">Doxygen</a>
    </div>
</footer>
