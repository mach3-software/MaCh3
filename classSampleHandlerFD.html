<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MaCh3: SampleHandlerFD Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="MaCh3.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mach3logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MaCh3
   &#160;<span id="projectnumber">2.4.2</span>
   </div>
   <div id="projectbrief">Reference Guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classSampleHandlerFD-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">SampleHandlerFD Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span><div class="ingroups"><a class="el" href="group__SamplesAndParameters.html">Implementing Samples and Parameters</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Class responsible for handling implementation of samples used in analysis, reweighting and returning LLH.  
 <a href="classSampleHandlerFD.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="SampleHandlerFD_8h_source.html">Samples/SampleHandlerFD.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for SampleHandlerFD:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classSampleHandlerFD__inherit__graph.svg" width="156" height="187"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for SampleHandlerFD:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classSampleHandlerFD__coll__graph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a6a0442b8c11f0a83b18fec8c9222b3e8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a6a0442b8c11f0a83b18fec8c9222b3e8">SampleHandlerFD</a> (std::string ConfigFileName, <a class="el" href="classParameterHandlerGeneric.html">ParameterHandlerGeneric</a> *xsec_cov, const std::shared_ptr&lt; <a class="el" href="classOscillationHandler.html">OscillationHandler</a> &gt; &amp;OscillatorObj_=nullptr)</td></tr>
<tr class="memdesc:a6a0442b8c11f0a83b18fec8c9222b3e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classSampleHandlerFD.html#a6a0442b8c11f0a83b18fec8c9222b3e8">More...</a><br /></td></tr>
<tr class="separator:a6a0442b8c11f0a83b18fec8c9222b3e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7aa8473194b5afccfbf453392b49e580"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a7aa8473194b5afccfbf453392b49e580">~SampleHandlerFD</a> ()</td></tr>
<tr class="memdesc:a7aa8473194b5afccfbf453392b49e580"><td class="mdescLeft">&#160;</td><td class="mdescRight">destructor  <a href="classSampleHandlerFD.html#a7aa8473194b5afccfbf453392b49e580">More...</a><br /></td></tr>
<tr class="separator:a7aa8473194b5afccfbf453392b49e580"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a768fdb89852db345ec267d30bd462cb2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a768fdb89852db345ec267d30bd462cb2">GetNDim</a> (const int Sample) const override</td></tr>
<tr class="memdesc:a768fdb89852db345ec267d30bd462cb2"><td class="mdescLeft">&#160;</td><td class="mdescRight">DB Function to differentiate 1D or 2D binning.  <a href="classSampleHandlerFD.html#a768fdb89852db345ec267d30bd462cb2">More...</a><br /></td></tr>
<tr class="separator:a768fdb89852db345ec267d30bd462cb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6101b46360ae54fe37dd1243f3f7f51e"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a6101b46360ae54fe37dd1243f3f7f51e">GetName</a> () const override</td></tr>
<tr class="separator:a6101b46360ae54fe37dd1243f3f7f51e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfad2507ad845ad36fff3c82231a143c"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#adfad2507ad845ad36fff3c82231a143c">GetSampleTitle</a> (const int Sample) const override</td></tr>
<tr class="separator:adfad2507ad845ad36fff3c82231a143c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f3923d1e2b39df2e1bf2348312925a6"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a7f3923d1e2b39df2e1bf2348312925a6">GetKinVarName</a> (const int iSample, const int Dimension) const override</td></tr>
<tr class="memdesc:a7f3923d1e2b39df2e1bf2348312925a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return Kinematic Variable name for specified sample and dimension for example "Reconstructed_Neutrino_Energy".  <a href="classSampleHandlerFD.html#a7f3923d1e2b39df2e1bf2348312925a6">More...</a><br /></td></tr>
<tr class="separator:a7f3923d1e2b39df2e1bf2348312925a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9aebf7da41ad6ddb87e3081a7f4763ec"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a9aebf7da41ad6ddb87e3081a7f4763ec">GetXBinVarName</a> (const int Sample) const</td></tr>
<tr class="separator:a9aebf7da41ad6ddb87e3081a7f4763ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69d66592696bee9e73f61649c681a573"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a69d66592696bee9e73f61649c681a573">GetYBinVarName</a> (const int Sample) const</td></tr>
<tr class="separator:a69d66592696bee9e73f61649c681a573"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3aec6cf33fee2dd2982955f995678e38"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classBinningHandler.html">BinningHandler</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a3aec6cf33fee2dd2982955f995678e38">GetBinningHandler</a> () const</td></tr>
<tr class="memdesc:a3aec6cf33fee2dd2982955f995678e38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get pointer to binning handler.  <a href="classSampleHandlerFD.html#a3aec6cf33fee2dd2982955f995678e38">More...</a><br /></td></tr>
<tr class="separator:a3aec6cf33fee2dd2982955f995678e38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67deb470bd32d96ed126c780a4cb8d69"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a67deb470bd32d96ed126c780a4cb8d69">PrintIntegral</a> (const int iSample, const TString &amp;OutputName=&quot;/dev/null&quot;, const int WeightStyle=0, const TString &amp;OutputCSVName=&quot;/dev/null&quot;)</td></tr>
<tr class="separator:a67deb470bd32d96ed126c780a4cb8d69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a40826e4d1204facbb5b0012cb53bdc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a7a40826e4d1204facbb5b0012cb53bdc">AddData</a> (const int Sample, TH1 *Data)</td></tr>
<tr class="separator:a7a40826e4d1204facbb5b0012cb53bdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afea1a24bb322b7a570ae8081d38cc1ae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#afea1a24bb322b7a570ae8081d38cc1ae">AddData</a> (const int Sample, const std::vector&lt; double &gt; &amp;Data_Array)</td></tr>
<tr class="separator:afea1a24bb322b7a570ae8081d38cc1ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a991deded5e6460cc2f3becaf8d856ae9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a991deded5e6460cc2f3becaf8d856ae9">PrintRates</a> (const bool DataOnly=false) override</td></tr>
<tr class="memdesc:a991deded5e6460cc2f3becaf8d856ae9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to print rates for the samples with LLH.  <a href="classSampleHandlerFD.html#a991deded5e6460cc2f3becaf8d856ae9">More...</a><br /></td></tr>
<tr class="separator:a991deded5e6460cc2f3becaf8d856ae9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25b63e394dab02d0b2d278ff55642fd9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a25b63e394dab02d0b2d278ff55642fd9">GetLikelihood</a> () const override</td></tr>
<tr class="memdesc:a25b63e394dab02d0b2d278ff55642fd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">DB Multi-threaded GetLikelihood.  <a href="classSampleHandlerFD.html#a25b63e394dab02d0b2d278ff55642fd9">More...</a><br /></td></tr>
<tr class="separator:a25b63e394dab02d0b2d278ff55642fd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaac2deb8881a00c85951a3e8a6653393"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#aaac2deb8881a00c85951a3e8a6653393">GetSampleLikelihood</a> (const int isample) const override</td></tr>
<tr class="memdesc:aaac2deb8881a00c85951a3e8a6653393"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get likelihood for single sample.  <a href="classSampleHandlerFD.html#aaac2deb8881a00c85951a3e8a6653393">More...</a><br /></td></tr>
<tr class="separator:aaac2deb8881a00c85951a3e8a6653393"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad83a84cec68b96cb50eaaf1a40f96edf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ad83a84cec68b96cb50eaaf1a40f96edf">GetSampleIndex</a> (const std::string &amp;SampleTitle) const</td></tr>
<tr class="memdesc:ad83a84cec68b96cb50eaaf1a40f96edf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get index of sample based on name.  <a href="classSampleHandlerFD.html#ad83a84cec68b96cb50eaaf1a40f96edf">More...</a><br /></td></tr>
<tr class="separator:ad83a84cec68b96cb50eaaf1a40f96edf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2fa527d43bfe7b5dccf767b2445fbb0"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ac2fa527d43bfe7b5dccf767b2445fbb0">GetDataHist</a> (const int Sample) override</td></tr>
<tr class="memdesc:ac2fa527d43bfe7b5dccf767b2445fbb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get Data histogram.  <a href="classSampleHandlerFD.html#ac2fa527d43bfe7b5dccf767b2445fbb0">More...</a><br /></td></tr>
<tr class="separator:ac2fa527d43bfe7b5dccf767b2445fbb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a634f708ba1d63e8709c6b4919c3fb1c5"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a634f708ba1d63e8709c6b4919c3fb1c5">GetDataHist</a> (const std::string &amp;Sample)</td></tr>
<tr class="separator:a634f708ba1d63e8709c6b4919c3fb1c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef4a66f22b067c8125af5fe799f5a804"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#aef4a66f22b067c8125af5fe799f5a804">GetMCHist</a> (const int Sample) override</td></tr>
<tr class="memdesc:aef4a66f22b067c8125af5fe799f5a804"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get MC histogram.  <a href="classSampleHandlerFD.html#aef4a66f22b067c8125af5fe799f5a804">More...</a><br /></td></tr>
<tr class="separator:aef4a66f22b067c8125af5fe799f5a804"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae61790e0fab1b169050657272e17f4d3"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ae61790e0fab1b169050657272e17f4d3">GetMCHist</a> (const std::string &amp;Sample)</td></tr>
<tr class="separator:ae61790e0fab1b169050657272e17f4d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a47c08f11d5019f5f237cddd279ef9c"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a9a47c08f11d5019f5f237cddd279ef9c">GetW2Hist</a> (const int Sample) override</td></tr>
<tr class="memdesc:a9a47c08f11d5019f5f237cddd279ef9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get W2 histogram.  <a href="classSampleHandlerFD.html#a9a47c08f11d5019f5f237cddd279ef9c">More...</a><br /></td></tr>
<tr class="separator:a9a47c08f11d5019f5f237cddd279ef9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a126596e06b0282f8c2e8ec2806b47aaa"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a126596e06b0282f8c2e8ec2806b47aaa">GetW2Hist</a> (const std::string &amp;Sample)</td></tr>
<tr class="separator:a126596e06b0282f8c2e8ec2806b47aaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3e03bd9beffb8b31acfd3bb5ebb44a2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ae3e03bd9beffb8b31acfd3bb5ebb44a2">Reweight</a> () override</td></tr>
<tr class="separator:ae3e03bd9beffb8b31acfd3bb5ebb44a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6831d91d5bcf1fb5723167736e0082ef"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a6831d91d5bcf1fb5723167736e0082ef">GetEventWeight</a> (const int iEntry)</td></tr>
<tr class="separator:a6831d91d5bcf1fb5723167736e0082ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fe790616b56940869c438822a79b1de"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a9fe790616b56940869c438822a79b1de">InitialiseNuOscillatorObjects</a> ()</td></tr>
<tr class="memdesc:a9fe790616b56940869c438822a79b1de"><td class="mdescLeft">&#160;</td><td class="mdescRight">including Dan's magic NuOscillator  <a href="classSampleHandlerFD.html#a9fe790616b56940869c438822a79b1de">More...</a><br /></td></tr>
<tr class="separator:a9fe790616b56940869c438822a79b1de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4bcbd508ec8d14d36f32911e12af1e9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ae4bcbd508ec8d14d36f32911e12af1e9">SetupNuOscillatorPointers</a> ()</td></tr>
<tr class="separator:ae4bcbd508ec8d14d36f32911e12af1e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b4dc9d2c3c2a1509fe4fcfefefbb3af"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a9b4dc9d2c3c2a1509fe4fcfefefbb3af">GetNuOscillatorPointers</a> (const int iEvent) const</td></tr>
<tr class="separator:a9b4dc9d2c3c2a1509fe4fcfefefbb3af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15a8239722140a814fea0a3d008f97ee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a15a8239722140a814fea0a3d008f97ee">ReadConfig</a> ()</td></tr>
<tr class="separator:a15a8239722140a814fea0a3d008f97ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f26528eac8bb32fc20e88fd00a35f78"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a5f26528eac8bb32fc20e88fd00a35f78">LoadSingleSample</a> (const int iSample, const YAML::Node &amp;Settings)</td></tr>
<tr class="separator:a5f26528eac8bb32fc20e88fd00a35f78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac276e3f10be081ce8e7f94df131490d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#aac276e3f10be081ce8e7f94df131490d">GetNOscChannels</a> (const int iSample) const override</td></tr>
<tr class="separator:aac276e3f10be081ce8e7f94df131490d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a802e5b253f0b23d1e206ef9c0008301a"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a802e5b253f0b23d1e206ef9c0008301a">GetFlavourName</a> (const int iSample, const int iChannel) const override</td></tr>
<tr class="separator:a802e5b253f0b23d1e206ef9c0008301a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78079726d3e96cebfae3a036969e042e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a78079726d3e96cebfae3a036969e042e">ApplyTemporarySelection</a> (const int iSample, const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;ExtraCuts)</td></tr>
<tr class="memdesc:a78079726d3e96cebfae3a036969e042e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Temporarily extend Selection for a given sample with additional cuts. Returns the original Selection so the caller can restore it later.  <a href="classSampleHandlerFD.html#a78079726d3e96cebfae3a036969e042e">More...</a><br /></td></tr>
<tr class="separator:a78079726d3e96cebfae3a036969e042e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a968ebdb74da3d252803215da8cec387e"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a968ebdb74da3d252803215da8cec387e">Get1DVarHist</a> (const int iSample, const std::string &amp;ProjectionVar, const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;EventSelectionVec={}, int WeightStyle=0, TAxis *Axis=nullptr, const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;SubEventSelectionVec={}) override</td></tr>
<tr class="separator:a968ebdb74da3d252803215da8cec387e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ae5d89712796bfe77f985656235c93b"><td class="memItemLeft" align="right" valign="top">TH2 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a9ae5d89712796bfe77f985656235c93b">Get2DVarHist</a> (const int iSample, const std::string &amp;ProjectionVarX, const std::string &amp;ProjectionVarY, const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;EventSelectionVec={}, int WeightStyle=0, TAxis *AxisX=nullptr, TAxis *AxisY=nullptr, const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;SubEventSelectionVec={}) override</td></tr>
<tr class="separator:a9ae5d89712796bfe77f985656235c93b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d9a0e8af47eee94ae9b535d9c7122d4"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a8d9a0e8af47eee94ae9b535d9c7122d4">BuildModeChannelSelection</a> (const int iSample, const int kModeToFill, const int kChannelToFill) const</td></tr>
<tr class="separator:a8d9a0e8af47eee94ae9b535d9c7122d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1ac7cdcad889b0640b06e87da78e3b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ab1ac7cdcad889b0640b06e87da78e3b8">Fill1DSubEventHist</a> (const int iSample, TH1D *_h1DVar, const std::string &amp;ProjectionVar, const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;SubEventSelectionVec={}, int WeightStyle=0)</td></tr>
<tr class="separator:ab1ac7cdcad889b0640b06e87da78e3b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a939d153567948b54843339bbfb77427f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a939d153567948b54843339bbfb77427f">Fill2DSubEventHist</a> (const int iSample, TH2D *_h2DVar, const std::string &amp;ProjectionVarX, const std::string &amp;ProjectionVarY, const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;SubEventSelectionVec={}, int WeightStyle=0)</td></tr>
<tr class="separator:a939d153567948b54843339bbfb77427f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa55768f84faef3f9f438d197dd46194"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#afa55768f84faef3f9f438d197dd46194">Get1DVarHistByModeAndChannel</a> (const int iSample, const std::string &amp;ProjectionVar_Str, int kModeToFill=-1, int kChannelToFill=-1, int WeightStyle=0, TAxis *Axis=nullptr) override</td></tr>
<tr class="separator:afa55768f84faef3f9f438d197dd46194"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86394ef51d6bab1b9943f11774e99c23"><td class="memItemLeft" align="right" valign="top">TH2 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a86394ef51d6bab1b9943f11774e99c23">Get2DVarHistByModeAndChannel</a> (const int iSample, const std::string &amp;ProjectionVar_StrX, const std::string &amp;ProjectionVar_StrY, int kModeToFill=-1, int kChannelToFill=-1, int WeightStyle=0, TAxis *AxisX=nullptr, TAxis *AxisY=nullptr) override</td></tr>
<tr class="separator:a86394ef51d6bab1b9943f11774e99c23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac453c29b475060135d911e4c23d0cb48"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ac453c29b475060135d911e4c23d0cb48">GetModeHist1D</a> (const int iSample, int s, int m, int style=0)</td></tr>
<tr class="separator:ac453c29b475060135d911e4c23d0cb48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a386667b346c7937285076aadf1f7c0a9"><td class="memItemLeft" align="right" valign="top">TH2 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a386667b346c7937285076aadf1f7c0a9">GetModeHist2D</a> (const int iSample, int s, int m, int style=0)</td></tr>
<tr class="separator:a386667b346c7937285076aadf1f7c0a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d5273302853361d5774998fb17805b2"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH1 * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a9d5273302853361d5774998fb17805b2">ReturnHistsBySelection1D</a> (const int iSample, const std::string &amp;KinematicProjection, int Selection1, int Selection2=-1, int WeightStyle=0, TAxis *Axis=nullptr)</td></tr>
<tr class="separator:a9d5273302853361d5774998fb17805b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47a345341de0cd86acababcc2d66cf91"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH2 * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a47a345341de0cd86acababcc2d66cf91">ReturnHistsBySelection2D</a> (const int iSample, const std::string &amp;KinematicProjectionX, const std::string &amp;KinematicProjectionY, int Selection1, int Selection2=-1, int WeightStyle=0, TAxis *XAxis=nullptr, TAxis *YAxis=nullptr)</td></tr>
<tr class="separator:a47a345341de0cd86acababcc2d66cf91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae77ac4a4edcaf3c6b5f7c05ddaed8e25"><td class="memItemLeft" align="right" valign="top">THStack *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ae77ac4a4edcaf3c6b5f7c05ddaed8e25">ReturnStackedHistBySelection1D</a> (const int iSample, const std::string &amp;KinematicProjection, int Selection1, int Selection2=-1, int WeightStyle=0, TAxis *Axis=nullptr)</td></tr>
<tr class="separator:ae77ac4a4edcaf3c6b5f7c05ddaed8e25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8be73835c2d9f0e50d738c4f204a0286"><td class="memItemLeft" align="right" valign="top">TLegend *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a8be73835c2d9f0e50d738c4f204a0286">ReturnStackHistLegend</a> ()</td></tr>
<tr class="separator:a8be73835c2d9f0e50d738c4f204a0286"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2769d593f34e8356b545af076818f89"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ae2769d593f34e8356b545af076818f89">ReturnKinematicParameterFromString</a> (const std::string &amp;KinematicStr) const</td></tr>
<tr class="memdesc:ae2769d593f34e8356b545af076818f89"><td class="mdescLeft">&#160;</td><td class="mdescRight">ETA function to generically convert a string from xsec cov to a kinematic type.  <a href="classSampleHandlerFD.html#ae2769d593f34e8356b545af076818f89">More...</a><br /></td></tr>
<tr class="separator:ae2769d593f34e8356b545af076818f89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e88e3720a6a8d3384a6b8d317795c74"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a3e88e3720a6a8d3384a6b8d317795c74">ReturnStringFromKinematicParameter</a> (const int KinematicVariable) const</td></tr>
<tr class="memdesc:a3e88e3720a6a8d3384a6b8d317795c74"><td class="mdescLeft">&#160;</td><td class="mdescRight">ETA function to generically convert a kinematic type from xsec cov to a string.  <a href="classSampleHandlerFD.html#a3e88e3720a6a8d3384a6b8d317795c74">More...</a><br /></td></tr>
<tr class="separator:a3e88e3720a6a8d3384a6b8d317795c74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90c390753da5f5561c66450440a19beb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a90c390753da5f5561c66450440a19beb">SaveAdditionalInfo</a> (TDirectory *Dir) override</td></tr>
<tr class="memdesc:a90c390753da5f5561c66450440a19beb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Store additional info in a chan.  <a href="classSampleHandlerFD.html#a90c390753da5f5561c66450440a19beb">More...</a><br /></td></tr>
<tr class="separator:a90c390753da5f5561c66450440a19beb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad81e082a5a4c86e51fc748bffd1dfa9e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ad81e082a5a4c86e51fc748bffd1dfa9e">ReturnKinematicVectorFromString</a> (const std::string &amp;KinematicStr) const</td></tr>
<tr class="separator:ad81e082a5a4c86e51fc748bffd1dfa9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c1df0e7858ce64cc2a81fab0e82f3cd"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a0c1df0e7858ce64cc2a81fab0e82f3cd">ReturnStringFromKinematicVector</a> (const int KinematicVariable) const</td></tr>
<tr class="separator:a0c1df0e7858ce64cc2a81fab0e82f3cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad14d9728400a7b87f095aca00761b829"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ad14d9728400a7b87f095aca00761b829">IsSubEventVarString</a> (const std::string &amp;VarStr)</td></tr>
<tr class="memdesc:ad14d9728400a7b87f095aca00761b829"><td class="mdescLeft">&#160;</td><td class="mdescRight">JM Check if a kinematic parameter string corresponds to a subevent-level variable.  <a href="classSampleHandlerFD.html#ad14d9728400a7b87f095aca00761b829">More...</a><br /></td></tr>
<tr class="separator:ad14d9728400a7b87f095aca00761b829"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5661f2accf6e80561699935f86ac9e08"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a5661f2accf6e80561699935f86ac9e08">GetDataArray</a> () const</td></tr>
<tr class="memdesc:a5661f2accf6e80561699935f86ac9e08"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return array storing data entries for every bin.  <a href="classSampleHandlerFD.html#a5661f2accf6e80561699935f86ac9e08">More...</a><br /></td></tr>
<tr class="separator:a5661f2accf6e80561699935f86ac9e08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75a62e3bf834e17992f1ebda3836c300"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a75a62e3bf834e17992f1ebda3836c300">GetMCArray</a> () const</td></tr>
<tr class="memdesc:a75a62e3bf834e17992f1ebda3836c300"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return array storing MC entries for every bin.  <a href="classSampleHandlerFD.html#a75a62e3bf834e17992f1ebda3836c300">More...</a><br /></td></tr>
<tr class="separator:a75a62e3bf834e17992f1ebda3836c300"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ef4127001f81924d2e27e84283c7114"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a8ef4127001f81924d2e27e84283c7114">GetW2Array</a> () const</td></tr>
<tr class="memdesc:a8ef4127001f81924d2e27e84283c7114"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return array storing W2 entries for every bin.  <a href="classSampleHandlerFD.html#a8ef4127001f81924d2e27e84283c7114">More...</a><br /></td></tr>
<tr class="separator:a8ef4127001f81924d2e27e84283c7114"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c05593aae5be71f8a615b0dfe74296b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a0c05593aae5be71f8a615b0dfe74296b">GetArrayForSample</a> (const int Sample, const double *array) const</td></tr>
<tr class="memdesc:a0c05593aae5be71f8a615b0dfe74296b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a sub-array for a given sample.  <a href="classSampleHandlerFD.html#a0c05593aae5be71f8a615b0dfe74296b">More...</a><br /></td></tr>
<tr class="separator:a0c05593aae5be71f8a615b0dfe74296b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25d65d419a907d81850f6cfba43e3c06"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a25d65d419a907d81850f6cfba43e3c06">GetDataArray</a> (const int Sample) const</td></tr>
<tr class="memdesc:a25d65d419a907d81850f6cfba43e3c06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return array storing data entries for every bin.  <a href="classSampleHandlerFD.html#a25d65d419a907d81850f6cfba43e3c06">More...</a><br /></td></tr>
<tr class="separator:a25d65d419a907d81850f6cfba43e3c06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a251b02474ea694909fb1b631845a72"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a1a251b02474ea694909fb1b631845a72">GetMCArray</a> (const int Sample) const</td></tr>
<tr class="memdesc:a1a251b02474ea694909fb1b631845a72"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return array storing MC entries for every bin.  <a href="classSampleHandlerFD.html#a1a251b02474ea694909fb1b631845a72">More...</a><br /></td></tr>
<tr class="separator:a1a251b02474ea694909fb1b631845a72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5885bd4f3fa06560a9536163d8f29627"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a5885bd4f3fa06560a9536163d8f29627">GetW2Array</a> (const int Sample) const</td></tr>
<tr class="memdesc:a5885bd4f3fa06560a9536163d8f29627"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return array storing W2 entries for single sample.  <a href="classSampleHandlerFD.html#a5885bd4f3fa06560a9536163d8f29627">More...</a><br /></td></tr>
<tr class="separator:a5885bd4f3fa06560a9536163d8f29627"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classSampleHandlerBase"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classSampleHandlerBase')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classSampleHandlerBase.html">SampleHandlerBase</a></td></tr>
<tr class="memitem:a6a6d7e5d275154ed550cd6c9dfc36000 inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a6a6d7e5d275154ed550cd6c9dfc36000">SampleHandlerBase</a> ()</td></tr>
<tr class="memdesc:a6a6d7e5d275154ed550cd6c9dfc36000 inherit pub_methods_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">The main constructor.  <a href="classSampleHandlerBase.html#a6a6d7e5d275154ed550cd6c9dfc36000">More...</a><br /></td></tr>
<tr class="separator:a6a6d7e5d275154ed550cd6c9dfc36000 inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07b6726b71241ea71e12cfa78fbc49ed inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a07b6726b71241ea71e12cfa78fbc49ed">~SampleHandlerBase</a> ()</td></tr>
<tr class="memdesc:a07b6726b71241ea71e12cfa78fbc49ed inherit pub_methods_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">destructor  <a href="classSampleHandlerBase.html#a07b6726b71241ea71e12cfa78fbc49ed">More...</a><br /></td></tr>
<tr class="separator:a07b6726b71241ea71e12cfa78fbc49ed inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4b73a8841ff9bab2fb08b578ad4137f inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#ac4b73a8841ff9bab2fb08b578ad4137f">GetNsamples</a> ()</td></tr>
<tr class="separator:ac4b73a8841ff9bab2fb08b578ad4137f inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6e807de9ac80fb9f12722e033c44f7e inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#ab6e807de9ac80fb9f12722e033c44f7e">CleanMemoryBeforeFit</a> ()=0</td></tr>
<tr class="memdesc:ab6e807de9ac80fb9f12722e033c44f7e inherit pub_methods_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allow to clean not used memory before fit starts.  <a href="classSampleHandlerBase.html#ab6e807de9ac80fb9f12722e033c44f7e">More...</a><br /></td></tr>
<tr class="separator:ab6e807de9ac80fb9f12722e033c44f7e inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e232eb59bc09c3f8ff4cbed69fcd688 inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMaCh3Modes.html">MaCh3Modes</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a4e232eb59bc09c3f8ff4cbed69fcd688">GetMaCh3Modes</a> () const</td></tr>
<tr class="memdesc:a4e232eb59bc09c3f8ff4cbed69fcd688 inherit pub_methods_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to MaCh3 modes.  <a href="classSampleHandlerBase.html#a4e232eb59bc09c3f8ff4cbed69fcd688">More...</a><br /></td></tr>
<tr class="separator:a4e232eb59bc09c3f8ff4cbed69fcd688 inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ceca02f83e878ef1aec6e54e7b2f331 inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a6ceca02f83e878ef1aec6e54e7b2f331">GetNEvents</a> () const</td></tr>
<tr class="separator:a6ceca02f83e878ef1aec6e54e7b2f331 inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5849766fbbc7aa71672da8b0f189fe5 inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#ae5849766fbbc7aa71672da8b0f189fe5">GetPoissonLLH</a> (const double data, const double mc) const</td></tr>
<tr class="memdesc:ae5849766fbbc7aa71672da8b0f189fe5 inherit pub_methods_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate test statistic for a single bin using Poisson.  <a href="classSampleHandlerBase.html#ae5849766fbbc7aa71672da8b0f189fe5">More...</a><br /></td></tr>
<tr class="separator:ae5849766fbbc7aa71672da8b0f189fe5 inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a527307a4186e2eb61475ea975108aa65 inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a527307a4186e2eb61475ea975108aa65">GetTestStatLLH</a> (const double data, const double mc, const double w2) const</td></tr>
<tr class="memdesc:a527307a4186e2eb61475ea975108aa65 inherit pub_methods_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate test statistic for a single bin. Calculation depends on setting of <code>fTestStatistic</code>. Data and mc -&gt; 0 cut-offs are defined in <a class="el" href="namespaceM3.html" title="Main namespace for MaCh3 software.">M3</a>::<em>LOW_MC_BOUND</em>.  <a href="classSampleHandlerBase.html#a527307a4186e2eb61475ea975108aa65">More...</a><br /></td></tr>
<tr class="separator:a527307a4186e2eb61475ea975108aa65 inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c81b6b7a7e70b04c6c6ca1c81c70fc5 inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a1c81b6b7a7e70b04c6c6ca1c81c70fc5">SetTestStatistic</a> (<a class="el" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67">TestStatistic</a> testStat)</td></tr>
<tr class="memdesc:a1c81b6b7a7e70b04c6c6ca1c81c70fc5 inherit pub_methods_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the test statistic to be used when calculating the binned likelihoods.  <a href="classSampleHandlerBase.html#a1c81b6b7a7e70b04c6c6ca1c81c70fc5">More...</a><br /></td></tr>
<tr class="separator:a1c81b6b7a7e70b04c6c6ca1c81c70fc5 inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a619c91c640207a243d0868d386359c52 inherit pub_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67">TestStatistic</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a619c91c640207a243d0868d386359c52">GetTestStatistic</a> () const</td></tr>
<tr class="memdesc:a619c91c640207a243d0868d386359c52 inherit pub_methods_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the test statistic used when calculating the binned likelihoods.  <a href="classSampleHandlerBase.html#a619c91c640207a243d0868d386359c52">More...</a><br /></td></tr>
<tr class="separator:a619c91c640207a243d0868d386359c52 inherit pub_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:afbbc56bf8988bb6bf80c5f382f0b603b"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#afbbc56bf8988bb6bf80c5f382f0b603b">AddAdditionalWeightPointers</a> ()=0</td></tr>
<tr class="memdesc:afbbc56bf8988bb6bf80c5f382f0b603b"><td class="mdescLeft">&#160;</td><td class="mdescRight">DB Function to determine which weights apply to which types of samples.  <a href="classSampleHandlerFD.html#afbbc56bf8988bb6bf80c5f382f0b603b">More...</a><br /></td></tr>
<tr class="separator:afbbc56bf8988bb6bf80c5f382f0b603b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61a1e9bbc4f812704278bf655d0d0ae2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a61a1e9bbc4f812704278bf655d0d0ae2">SetupKinematicMap</a> ()</td></tr>
<tr class="memdesc:a61a1e9bbc4f812704278bf655d0d0ae2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ensure Kinematic Map is setup and make sure it is initialised correctly.  <a href="classSampleHandlerFD.html#a61a1e9bbc4f812704278bf655d0d0ae2">More...</a><br /></td></tr>
<tr class="separator:a61a1e9bbc4f812704278bf655d0d0ae2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a984c564107c7207a2611d0bf67d9cc"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a1a984c564107c7207a2611d0bf67d9cc">SetupSplines</a> ()=0</td></tr>
<tr class="memdesc:a1a984c564107c7207a2611d0bf67d9cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">initialise your splineXX object and then use InitialiseSplineObject to conviently setup everything up  <a href="classSampleHandlerFD.html#a1a984c564107c7207a2611d0bf67d9cc">More...</a><br /></td></tr>
<tr class="separator:a1a984c564107c7207a2611d0bf67d9cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09cbb146872131227838a06581103c33"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a09cbb146872131227838a06581103c33">Init</a> ()=0</td></tr>
<tr class="memdesc:a09cbb146872131227838a06581103c33"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise any variables that your experiment specific SampleHandler needs.  <a href="classSampleHandlerFD.html#a09cbb146872131227838a06581103c33">More...</a><br /></td></tr>
<tr class="separator:a09cbb146872131227838a06581103c33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a330f801dfd7c0d14326048e93c5a51ae"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a330f801dfd7c0d14326048e93c5a51ae">SetupExperimentMC</a> ()=0</td></tr>
<tr class="memdesc:a330f801dfd7c0d14326048e93c5a51ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Experiment specific setup, returns the number of events which were loaded.  <a href="classSampleHandlerFD.html#a330f801dfd7c0d14326048e93c5a51ae">More...</a><br /></td></tr>
<tr class="separator:a330f801dfd7c0d14326048e93c5a51ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e112b4f306f7b792da77f6299535c1b"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a8e112b4f306f7b792da77f6299535c1b">SetupFDMC</a> ()=0</td></tr>
<tr class="memdesc:a8e112b4f306f7b792da77f6299535c1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function which translates experiment struct into core struct.  <a href="classSampleHandlerFD.html#a8e112b4f306f7b792da77f6299535c1b">More...</a><br /></td></tr>
<tr class="separator:a8e112b4f306f7b792da77f6299535c1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74209f7f52f81dd0663997e63d49d4e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a74209f7f52f81dd0663997e63d49d4e1">Initialise</a> ()</td></tr>
<tr class="memdesc:a74209f7f52f81dd0663997e63d49d4e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function which does a lot of the lifting regarding the workflow in creating different MC objects.  <a href="classSampleHandlerFD.html#a74209f7f52f81dd0663997e63d49d4e1">More...</a><br /></td></tr>
<tr class="separator:a74209f7f52f81dd0663997e63d49d4e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64b2af7680c88713c70f064fb7574184"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a64b2af7680c88713c70f064fb7574184">FillSplineBins</a> ()</td></tr>
<tr class="memdesc:a64b2af7680c88713c70f064fb7574184"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the binned spline that an event should apply to and stored them in a a vector for easy evaluation in the fillArray() function.  <a href="classSampleHandlerFD.html#a64b2af7680c88713c70f064fb7574184">More...</a><br /></td></tr>
<tr class="separator:a64b2af7680c88713c70f064fb7574184"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a409908a58aae468475a482b3db7c9bea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a409908a58aae468475a482b3db7c9bea">FindNominalBinAndEdges</a> ()</td></tr>
<tr class="separator:a409908a58aae468475a482b3db7c9bea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5fed299058818825839921541e99617"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#aa5fed299058818825839921541e99617">SetBinning</a> ()</td></tr>
<tr class="memdesc:aa5fed299058818825839921541e99617"><td class="mdescLeft">&#160;</td><td class="mdescRight">set the binning for 2D sample used for the likelihood calculation  <a href="classSampleHandlerFD.html#aa5fed299058818825839921541e99617">More...</a><br /></td></tr>
<tr class="separator:aa5fed299058818825839921541e99617"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9ff78dd87844a8aaccb24f1381d2c78"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ae9ff78dd87844a8aaccb24f1381d2c78">SetupReweightArrays</a> ()</td></tr>
<tr class="memdesc:ae9ff78dd87844a8aaccb24f1381d2c78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise data, MC and W2 histograms.  <a href="classSampleHandlerFD.html#ae9ff78dd87844a8aaccb24f1381d2c78">More...</a><br /></td></tr>
<tr class="separator:ae9ff78dd87844a8aaccb24f1381d2c78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed15ee1f6209f26e55bb8e53108a9c6a"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#aed15ee1f6209f26e55bb8e53108a9c6a">SetupFunctionalParameters</a> ()</td></tr>
<tr class="memdesc:aed15ee1f6209f26e55bb8e53108a9c6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">ETA - a function to setup and pass values to functional parameters where you need to pass a value to some custom reweight calc or engine.  <a href="classSampleHandlerFD.html#aed15ee1f6209f26e55bb8e53108a9c6a">More...</a><br /></td></tr>
<tr class="separator:aed15ee1f6209f26e55bb8e53108a9c6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2626d0d48874d1aff1a107f62f1f02d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#aa2626d0d48874d1aff1a107f62f1f02d">RegisterIndividualFunctionalParameter</a> (const std::string &amp;fpName, int fpEnum, <a class="el" href="ParameterStructs_8h.html#a916ddc21f75755739f308b54dd06e0ae">FuncParFuncType</a> fpFunc)</td></tr>
<tr class="memdesc:aa2626d0d48874d1aff1a107f62f1f02d"><td class="mdescLeft">&#160;</td><td class="mdescRight">HH - a helper function for RegisterFunctionalParameter.  <a href="classSampleHandlerFD.html#aa2626d0d48874d1aff1a107f62f1f02d">More...</a><br /></td></tr>
<tr class="separator:aa2626d0d48874d1aff1a107f62f1f02d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5a809cfcd1e221ba0094b65f8e748f8"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ab5a809cfcd1e221ba0094b65f8e748f8">RegisterFunctionalParameters</a> ()=0</td></tr>
<tr class="memdesc:ab5a809cfcd1e221ba0094b65f8e748f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">HH - a experiment-specific function where the maps to actual functions are set up.  <a href="classSampleHandlerFD.html#ab5a809cfcd1e221ba0094b65f8e748f8">More...</a><br /></td></tr>
<tr class="separator:ab5a809cfcd1e221ba0094b65f8e748f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a691a4ec2c4c82b3c4437ead052644a54"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a691a4ec2c4c82b3c4437ead052644a54">PrepFunctionalParameters</a> ()</td></tr>
<tr class="memdesc:a691a4ec2c4c82b3c4437ead052644a54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the functional parameter values to the latest proposed values. Needs to be called before every new reweight so is called in fillArray.  <a href="classSampleHandlerFD.html#a691a4ec2c4c82b3c4437ead052644a54">More...</a><br /></td></tr>
<tr class="separator:a691a4ec2c4c82b3c4437ead052644a54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaa2f3489afd3d80356649d439e88298"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#adaa2f3489afd3d80356649d439e88298">ApplyShifts</a> (const int iEvent)</td></tr>
<tr class="memdesc:adaa2f3489afd3d80356649d439e88298"><td class="mdescLeft">&#160;</td><td class="mdescRight">ETA - generic function applying shifts.  <a href="classSampleHandlerFD.html#adaa2f3489afd3d80356649d439e88298">More...</a><br /></td></tr>
<tr class="separator:adaa2f3489afd3d80356649d439e88298"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af67a9a10193e12526e3284d48f425185"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#af67a9a10193e12526e3284d48f425185">IsEventSelected</a> (const int iSample, const int iEvent) <a class="el" href="Core_8h.html#a2abc3d82639661d84964bed9e2df0e68">_noexcept_</a></td></tr>
<tr class="memdesc:af67a9a10193e12526e3284d48f425185"><td class="mdescLeft">&#160;</td><td class="mdescRight">DB Function which determines if an event is selected, where Selection double looks like {{ND280KinematicTypes Var1, douuble LowBound}.  <a href="classSampleHandlerFD.html#af67a9a10193e12526e3284d48f425185">More...</a><br /></td></tr>
<tr class="separator:af67a9a10193e12526e3284d48f425185"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacc4d573b8e4569269b51ac325bc0092"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#aacc4d573b8e4569269b51ac325bc0092">IsSubEventSelected</a> (const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;SubEventCuts, const int iEvent, unsigned const int iSubEvent, size_t nsubevents)</td></tr>
<tr class="memdesc:aacc4d573b8e4569269b51ac325bc0092"><td class="mdescLeft">&#160;</td><td class="mdescRight">JM Function which determines if a subevent is selected.  <a href="classSampleHandlerFD.html#aacc4d573b8e4569269b51ac325bc0092">More...</a><br /></td></tr>
<tr class="separator:aacc4d573b8e4569269b51ac325bc0092"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ced3ca13adffc1f795b528faba8b3f3"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a3ced3ca13adffc1f795b528faba8b3f3">ResetShifts</a> (const int iEvent)</td></tr>
<tr class="memdesc:a3ced3ca13adffc1f795b528faba8b3f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">HH - reset the shifted values to the original values.  <a href="classSampleHandlerFD.html#a3ced3ca13adffc1f795b528faba8b3f3">More...</a><br /></td></tr>
<tr class="separator:a3ced3ca13adffc1f795b528faba8b3f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37768b8d5fda2e61989f8041a89ef7b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a37768b8d5fda2e61989f8041a89ef7b8">CalcNormsBins</a> (std::vector&lt; <a class="el" href="structNormParameter.html">NormParameter</a> &gt; &amp;norm_parameters, std::vector&lt; std::vector&lt; int &gt; &gt; &amp;norms_bins)</td></tr>
<tr class="memdesc:a37768b8d5fda2e61989f8041a89ef7b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether a normalisation systematic affects an event or not.  <a href="classSampleHandlerFD.html#a37768b8d5fda2e61989f8041a89ef7b8">More...</a><br /></td></tr>
<tr class="separator:a37768b8d5fda2e61989f8041a89ef7b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbc1484d010b021794f44fc1b1594269"><td class="memTemplParams" colspan="2">template&lt;typename ParT &gt; </td></tr>
<tr class="memitem:abbc1484d010b021794f44fc1b1594269"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#abbc1484d010b021794f44fc1b1594269">PassesSelection</a> (const ParT &amp;Par, std::size_t iEvent)</td></tr>
<tr class="separator:abbc1484d010b021794f44fc1b1594269"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1c7c8384fd383170aacf4d83af1b382"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#aa1c7c8384fd383170aacf4d83af1b382">CalcWeightTotal</a> (const <a class="el" href="structEventInfo.html">EventInfo</a> *<a class="el" href="Core_8h.html#ab6a7e23420f0bcfb04f42f45f8283101">_restrict_</a> MCEvent) const</td></tr>
<tr class="memdesc:aa1c7c8384fd383170aacf4d83af1b382"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the total weight weight for a given event.  <a href="classSampleHandlerFD.html#aa1c7c8384fd383170aacf4d83af1b382">More...</a><br /></td></tr>
<tr class="separator:aa1c7c8384fd383170aacf4d83af1b382"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1781ff483b5bae72103e9298109c4698"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a1781ff483b5bae72103e9298109c4698">CalcWeightFunc</a> (int iEvent)</td></tr>
<tr class="memdesc:a1781ff483b5bae72103e9298109c4698"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate weights for function parameters.  <a href="classSampleHandlerFD.html#a1781ff483b5bae72103e9298109c4698">More...</a><br /></td></tr>
<tr class="separator:a1781ff483b5bae72103e9298109c4698"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0f549802b5625871e11d86905989697"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ad0f549802b5625871e11d86905989697">ReturnKinematicParameter</a> (std::string KinematicParamter, int iEvent)=0</td></tr>
<tr class="memdesc:ad0f549802b5625871e11d86905989697"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the value of an associated kinematic parameter for an event.  <a href="classSampleHandlerFD.html#ad0f549802b5625871e11d86905989697">More...</a><br /></td></tr>
<tr class="separator:ad0f549802b5625871e11d86905989697"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0000225f48d985e8dd60bc94a1c0425"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ae0000225f48d985e8dd60bc94a1c0425">ReturnKinematicParameter</a> (int KinematicVariable, int iEvent)=0</td></tr>
<tr class="separator:ae0000225f48d985e8dd60bc94a1c0425"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae98d72c6c30697e32fcb464923456fc0"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ae98d72c6c30697e32fcb464923456fc0">ReturnKinematicVector</a> (std::string KinematicParameter, int iEvent)</td></tr>
<tr class="separator:ae98d72c6c30697e32fcb464923456fc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae638fe05a353bdc6dac8b64150f200bf"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ae638fe05a353bdc6dac8b64150f200bf">ReturnKinematicVector</a> (int KinematicVariable, int iEvent)</td></tr>
<tr class="separator:ae638fe05a353bdc6dac8b64150f200bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cee961e07a80484fe568898f41e4965"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a2cee961e07a80484fe568898f41e4965">ReturnKinematicParameterBinning</a> (const int Sample, const std::string &amp;KinematicParameter) const override</td></tr>
<tr class="memdesc:a2cee961e07a80484fe568898f41e4965"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the binning used to draw a kinematic parameter.  <a href="classSampleHandlerFD.html#a2cee961e07a80484fe568898f41e4965">More...</a><br /></td></tr>
<tr class="separator:a2cee961e07a80484fe568898f41e4965"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a889f8aeb4ab9e6b6441dabcc484c91c2"><td class="memItemLeft" align="right" valign="top">virtual const double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a889f8aeb4ab9e6b6441dabcc484c91c2">GetPointerToKinematicParameter</a> (std::string KinematicParamter, int iEvent)=0</td></tr>
<tr class="separator:a889f8aeb4ab9e6b6441dabcc484c91c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64100ff9107ef5ed40945063da3b6eda"><td class="memItemLeft" align="right" valign="top">virtual const double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a64100ff9107ef5ed40945063da3b6eda">GetPointerToKinematicParameter</a> (double KinematicVariable, int iEvent)=0</td></tr>
<tr class="separator:a64100ff9107ef5ed40945063da3b6eda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57a1fbb900f450168181af14d1336a21"><td class="memItemLeft" align="right" valign="top">const double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a57a1fbb900f450168181af14d1336a21">GetPointerToOscChannel</a> (const int iEvent) const</td></tr>
<tr class="memdesc:a57a1fbb900f450168181af14d1336a21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get pointer to oscillation channel associated with given event. Osc channel is const.  <a href="classSampleHandlerFD.html#a57a1fbb900f450168181af14d1336a21">More...</a><br /></td></tr>
<tr class="separator:a57a1fbb900f450168181af14d1336a21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fa55fd1e82f8c4fccd5cd77b814f86a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a5fa55fd1e82f8c4fccd5cd77b814f86a">SetupNormParameters</a> ()</td></tr>
<tr class="memdesc:a5fa55fd1e82f8c4fccd5cd77b814f86a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup the norm parameters by assigning each event with bin.  <a href="classSampleHandlerFD.html#a5fa55fd1e82f8c4fccd5cd77b814f86a">More...</a><br /></td></tr>
<tr class="separator:a5fa55fd1e82f8c4fccd5cd77b814f86a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5eab24c8508cdd247c23b9bd9b3017b0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a5eab24c8508cdd247c23b9bd9b3017b0">FillHist</a> (const int Sample, TH1 *Hist, double *Array)</td></tr>
<tr class="memdesc:a5eab24c8508cdd247c23b9bd9b3017b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill a histogram with the event-level information used in the fit.  <a href="classSampleHandlerFD.html#a5eab24c8508cdd247c23b9bd9b3017b0">More...</a><br /></td></tr>
<tr class="separator:a5eab24c8508cdd247c23b9bd9b3017b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeef0f943cb1e0d4c9bba4814cb24a507"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#aeef0f943cb1e0d4c9bba4814cb24a507">FillArray</a> ()</td></tr>
<tr class="memdesc:aeef0f943cb1e0d4c9bba4814cb24a507"><td class="mdescLeft">&#160;</td><td class="mdescRight">DB Nice new multi-threaded function which calculates the event weights and fills the relevant bins of an array.  <a href="classSampleHandlerFD.html#aeef0f943cb1e0d4c9bba4814cb24a507">More...</a><br /></td></tr>
<tr class="separator:aeef0f943cb1e0d4c9bba4814cb24a507"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1f944f73f43a68be3af388cd17bc5e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ac1f944f73f43a68be3af388cd17bc5e3">ResetHistograms</a> ()</td></tr>
<tr class="memdesc:ac1f944f73f43a68be3af388cd17bc5e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to reset histograms.  <a href="classSampleHandlerFD.html#ac1f944f73f43a68be3af388cd17bc5e3">More...</a><br /></td></tr>
<tr class="separator:ac1f944f73f43a68be3af388cd17bc5e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2918509fadc1dac47d423f161b619cc4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a2918509fadc1dac47d423f161b619cc4">InitialiseSplineObject</a> ()</td></tr>
<tr class="separator:a2918509fadc1dac47d423f161b619cc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26a50900fafed84dda7423907deea04b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="SampleStructs_8h.html#a0dfdd8cf84b8fa3495e9e5e520fe6cd2">NuPDG</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a26a50900fafed84dda7423907deea04b">GetInitPDGFromFileName</a> (const std::string &amp;FileName) const</td></tr>
<tr class="memdesc:a26a50900fafed84dda7423907deea04b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the initial neutrino PDG code associated with a given input file name.  <a href="classSampleHandlerFD.html#a26a50900fafed84dda7423907deea04b">More...</a><br /></td></tr>
<tr class="separator:a26a50900fafed84dda7423907deea04b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcdcf3c5d75823742f6e0ca3fe3bed80"><td class="memItemLeft" align="right" valign="top"><a class="el" href="SampleStructs_8h.html#a0dfdd8cf84b8fa3495e9e5e520fe6cd2">NuPDG</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#abcdcf3c5d75823742f6e0ca3fe3bed80">GetFinalPDGFromFileName</a> (const std::string &amp;FileName) const</td></tr>
<tr class="memdesc:abcdcf3c5d75823742f6e0ca3fe3bed80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the final neutrino PDG code associated with a given input file name.  <a href="classSampleHandlerFD.html#abcdcf3c5d75823742f6e0ca3fe3bed80">More...</a><br /></td></tr>
<tr class="separator:abcdcf3c5d75823742f6e0ca3fe3bed80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classSampleHandlerBase"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classSampleHandlerBase')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classSampleHandlerBase.html">SampleHandlerBase</a></td></tr>
<tr class="memitem:ad1e91b3accfd9269e794f43aa7f9b979 inherit pro_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#ad1e91b3accfd9269e794f43aa7f9b979">QuietPlease</a> ()</td></tr>
<tr class="memdesc:ad1e91b3accfd9269e794f43aa7f9b979 inherit pro_methods_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Redirect std::cout to silence some experiment specific libraries.  <a href="classSampleHandlerBase.html#ad1e91b3accfd9269e794f43aa7f9b979">More...</a><br /></td></tr>
<tr class="separator:ad1e91b3accfd9269e794f43aa7f9b979 inherit pro_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2da39aacd5ba10a3a745d546eccb859f inherit pro_methods_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a2da39aacd5ba10a3a745d546eccb859f">NowTalk</a> ()</td></tr>
<tr class="memdesc:a2da39aacd5ba10a3a745d546eccb859f inherit pro_methods_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Redirect std::cout to silence some experiment specific libraries.  <a href="classSampleHandlerBase.html#a2da39aacd5ba10a3a745d546eccb859f">More...</a><br /></td></tr>
<tr class="separator:a2da39aacd5ba10a3a745d546eccb859f inherit pro_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad16c838d4dc86e98445f199a16cf9bdf inherit pro_methods_classSampleHandlerBase"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ad16c838d4dc86e98445f199a16cf9bdf inherit pro_methods_classSampleHandlerBase"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#ad16c838d4dc86e98445f199a16cf9bdf">MatchCondition</a> (const std::vector&lt; T &gt; &amp;allowedValues, const T &amp;value)</td></tr>
<tr class="memdesc:ad16c838d4dc86e98445f199a16cf9bdf inherit pro_methods_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">check if event is affected by following conditions, for example pdg, or modes etc  <a href="classSampleHandlerBase.html#ad16c838d4dc86e98445f199a16cf9bdf">More...</a><br /></td></tr>
<tr class="separator:ad16c838d4dc86e98445f199a16cf9bdf inherit pro_methods_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a17193b3fe2b44e6484f9eefda86f97dd"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classBinnedSplineHandler.html">BinnedSplineHandler</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">SplineHandler</a></td></tr>
<tr class="memdesc:a17193b3fe2b44e6484f9eefda86f97dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contains all your binned splines and handles the setup and the returning of weights from spline evaluations.  <a href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">More...</a><br /></td></tr>
<tr class="separator:a17193b3fe2b44e6484f9eefda86f97dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7115dd53d73a45fb64c565561095b6a"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classOscillationHandler.html">OscillationHandler</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">Oscillator</a></td></tr>
<tr class="memdesc:aa7115dd53d73a45fb64c565561095b6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contains all your binned splines and handles the setup and the returning of weights from spline evaluations.  <a href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">More...</a><br /></td></tr>
<tr class="separator:aa7115dd53d73a45fb64c565561095b6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40ff07ee06efb7aeb285a769c2c9b81f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; <a class="el" href="structFunctionalShifter.html">FunctionalShifter</a> * &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a40ff07ee06efb7aeb285a769c2c9b81f">funcParsGrid</a></td></tr>
<tr class="memdesc:a40ff07ee06efb7aeb285a769c2c9b81f"><td class="mdescLeft">&#160;</td><td class="mdescRight">HH - a grid of vectors of enums for each sample and event.  <a href="classSampleHandlerFD.html#a40ff07ee06efb7aeb285a769c2c9b81f">More...</a><br /></td></tr>
<tr class="separator:a40ff07ee06efb7aeb285a769c2c9b81f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15653dd1dd3a1379ef3db56c145a4444"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structFunctionalShifter.html">FunctionalShifter</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a15653dd1dd3a1379ef3db56c145a4444">funcParsMap</a></td></tr>
<tr class="memdesc:a15653dd1dd3a1379ef3db56c145a4444"><td class="mdescLeft">&#160;</td><td class="mdescRight">HH - a map that relates the funcpar enum to pointer of FuncPars struct HH - Changed to a vector of pointers since it's faster than unordered_map and we are using ints as keys.  <a href="classSampleHandlerFD.html#a15653dd1dd3a1379ef3db56c145a4444">More...</a><br /></td></tr>
<tr class="separator:a15653dd1dd3a1379ef3db56c145a4444"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02254668e1d1e4417dfd38e416e46bf8"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structFunctionalParameter.html">FunctionalParameter</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a02254668e1d1e4417dfd38e416e46bf8">funcParsVec</a></td></tr>
<tr class="memdesc:a02254668e1d1e4417dfd38e416e46bf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">HH - a vector that stores all the FuncPars struct.  <a href="classSampleHandlerFD.html#a02254668e1d1e4417dfd38e416e46bf8">More...</a><br /></td></tr>
<tr class="separator:a02254668e1d1e4417dfd38e416e46bf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8ed9895a0b2802e45569ce2d1a0a837"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; std::string, int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">funcParsNamesMap</a></td></tr>
<tr class="memdesc:af8ed9895a0b2802e45569ce2d1a0a837"><td class="mdescLeft">&#160;</td><td class="mdescRight">HH - a map that relates the name of the functional parameter to funcpar enum.  <a href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">More...</a><br /></td></tr>
<tr class="separator:af8ed9895a0b2802e45569ce2d1a0a837"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a577a57992e396a5b34efcd3bb6ed45cf"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; int, <a class="el" href="ParameterStructs_8h.html#a916ddc21f75755739f308b54dd06e0ae">FuncParFuncType</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a577a57992e396a5b34efcd3bb6ed45cf">funcParsFuncMap</a></td></tr>
<tr class="memdesc:a577a57992e396a5b34efcd3bb6ed45cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">HH - a map that relates the funcpar enum to pointer of the actual function.  <a href="classSampleHandlerFD.html#a577a57992e396a5b34efcd3bb6ed45cf">More...</a><br /></td></tr>
<tr class="separator:a577a57992e396a5b34efcd3bb6ed45cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a888112d7eebd6fdb877c0015e1951f9d"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a888112d7eebd6fdb877c0015e1951f9d">funcParsNamesVec</a> = {}</td></tr>
<tr class="memdesc:a888112d7eebd6fdb877c0015e1951f9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">HH - a vector of string names for each functional parameter.  <a href="classSampleHandlerFD.html#a888112d7eebd6fdb877c0015e1951f9d">More...</a><br /></td></tr>
<tr class="separator:a888112d7eebd6fdb877c0015e1951f9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a231b4b5b9b5e5f0d1cb9a3ba96c85ec5"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classBinningHandler.html">BinningHandler</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a></td></tr>
<tr class="memdesc:a231b4b5b9b5e5f0d1cb9a3ba96c85ec5"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: This stores binning information, in future could be come vector to store binning for every used sample.  <a href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">More...</a><br /></td></tr>
<tr class="separator:a231b4b5b9b5e5f0d1cb9a3ba96c85ec5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85415d4ac54a5aefe78e5ab4d7bdb769"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a85415d4ac54a5aefe78e5ab4d7bdb769">SampleHandlerFD_array</a></td></tr>
<tr class="memdesc:a85415d4ac54a5aefe78e5ab4d7bdb769"><td class="mdescLeft">&#160;</td><td class="mdescRight">DB Array to be filled after reweighting.  <a href="classSampleHandlerFD.html#a85415d4ac54a5aefe78e5ab4d7bdb769">More...</a><br /></td></tr>
<tr class="separator:a85415d4ac54a5aefe78e5ab4d7bdb769"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5c6a3701c6ac76a96886ff13300a53b"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#af5c6a3701c6ac76a96886ff13300a53b">SampleHandlerFD_array_w2</a></td></tr>
<tr class="memdesc:af5c6a3701c6ac76a96886ff13300a53b"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS Array used for MC stat.  <a href="classSampleHandlerFD.html#af5c6a3701c6ac76a96886ff13300a53b">More...</a><br /></td></tr>
<tr class="separator:af5c6a3701c6ac76a96886ff13300a53b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b16ed4f91f2f37ff707ca048d8d6927"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a2b16ed4f91f2f37ff707ca048d8d6927">SampleHandlerFD_data</a></td></tr>
<tr class="memdesc:a2b16ed4f91f2f37ff707ca048d8d6927"><td class="mdescLeft">&#160;</td><td class="mdescRight">DB Array to be filled in AddData.  <a href="classSampleHandlerFD.html#a2b16ed4f91f2f37ff707ca048d8d6927">More...</a><br /></td></tr>
<tr class="separator:a2b16ed4f91f2f37ff707ca048d8d6927"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae422410559d7f3af0e0a80cc15fbfbff"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structEventInfo.html">EventInfo</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a></td></tr>
<tr class="memdesc:ae422410559d7f3af0e0a80cc15fbfbff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores information about every MC event.  <a href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">More...</a><br /></td></tr>
<tr class="separator:ae422410559d7f3af0e0a80cc15fbfbff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a115728f4ba502c93ffd447fb5457aac6"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structSampleInfo.html">SampleInfo</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a></td></tr>
<tr class="memdesc:a115728f4ba502c93ffd447fb5457aac6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores info about currently initialised sample.  <a href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">More...</a><br /></td></tr>
<tr class="separator:a115728f4ba502c93ffd447fb5457aac6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1db89c4df22a237b1cb26a2b55ee0866"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classParameterHandlerGeneric.html">ParameterHandlerGeneric</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a1db89c4df22a237b1cb26a2b55ee0866">ParHandler</a> = nullptr</td></tr>
<tr class="memdesc:a1db89c4df22a237b1cb26a2b55ee0866"><td class="mdescLeft">&#160;</td><td class="mdescRight">ETA - All experiments will need an xsec, det and osc cov.  <a href="classSampleHandlerFD.html#a1db89c4df22a237b1cb26a2b55ee0866">More...</a><br /></td></tr>
<tr class="separator:a1db89c4df22a237b1cb26a2b55ee0866"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a7fccdf8392ee06495902fab60e9858"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a9a7fccdf8392ee06495902fab60e9858">SampleHandlerName</a></td></tr>
<tr class="memdesc:a9a7fccdf8392ee06495902fab60e9858"><td class="mdescLeft">&#160;</td><td class="mdescRight">A unique ID for each sample based on which we can define what systematic should be applied.  <a href="classSampleHandlerFD.html#a9a7fccdf8392ee06495902fab60e9858">More...</a><br /></td></tr>
<tr class="separator:a9a7fccdf8392ee06495902fab60e9858"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3832a3e2c438d4810811d83e1323cff"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#aa3832a3e2c438d4810811d83e1323cff">StoredSelection</a></td></tr>
<tr class="memdesc:aa3832a3e2c438d4810811d83e1323cff"><td class="mdescLeft">&#160;</td><td class="mdescRight">What gets pulled from config options, these are constant after loading in this is of length 3: 0th index is the value, 1st is lower bound, 2nd is upper bound.  <a href="classSampleHandlerFD.html#aa3832a3e2c438d4810811d83e1323cff">More...</a><br /></td></tr>
<tr class="separator:aa3832a3e2c438d4810811d83e1323cff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07b3357278429dfe809d7d9d27682bf9"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a07b3357278429dfe809d7d9d27682bf9">Selection</a></td></tr>
<tr class="memdesc:a07b3357278429dfe809d7d9d27682bf9"><td class="mdescLeft">&#160;</td><td class="mdescRight">a way to store selection cuts which you may push back in the get1DVar functions most of the time this is just the same as StoredSelection  <a href="classSampleHandlerFD.html#a07b3357278429dfe809d7d9d27682bf9">More...</a><br /></td></tr>
<tr class="separator:a07b3357278429dfe809d7d9d27682bf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae37732e76f0b17b6f124bd5543177e4"><td class="memItemLeft" align="right" valign="top">const std::unordered_map&lt; std::string, int &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#aae37732e76f0b17b6f124bd5543177e4">KinematicParameters</a></td></tr>
<tr class="memdesc:aae37732e76f0b17b6f124bd5543177e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mapping between string and kinematic enum.  <a href="classSampleHandlerFD.html#aae37732e76f0b17b6f124bd5543177e4">More...</a><br /></td></tr>
<tr class="separator:aae37732e76f0b17b6f124bd5543177e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7ac675cc4ce81bec42e0700f1ff2620"><td class="memItemLeft" align="right" valign="top">const std::unordered_map&lt; int, std::string &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ad7ac675cc4ce81bec42e0700f1ff2620">ReversedKinematicParameters</a></td></tr>
<tr class="memdesc:ad7ac675cc4ce81bec42e0700f1ff2620"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mapping between kinematic enum and string.  <a href="classSampleHandlerFD.html#ad7ac675cc4ce81bec42e0700f1ff2620">More...</a><br /></td></tr>
<tr class="separator:ad7ac675cc4ce81bec42e0700f1ff2620"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d762b169bab4454bbdb1b387c09f4a7"><td class="memItemLeft" align="right" valign="top">const std::unordered_map&lt; std::string, int &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a5d762b169bab4454bbdb1b387c09f4a7">KinematicVectors</a></td></tr>
<tr class="separator:a5d762b169bab4454bbdb1b387c09f4a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a341f7bf83eb74ba5d27a2c9616202eba"><td class="memItemLeft" align="right" valign="top">const std::unordered_map&lt; int, std::string &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a341f7bf83eb74ba5d27a2c9616202eba">ReversedKinematicVectors</a></td></tr>
<tr class="separator:a341f7bf83eb74ba5d27a2c9616202eba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46fa97953e811328fe125560ed5c809e"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classManager.html">Manager</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleManager</a></td></tr>
<tr class="memdesc:a46fa97953e811328fe125560ed5c809e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The manager object used to read the sample yaml file.  <a href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">More...</a><br /></td></tr>
<tr class="separator:a46fa97953e811328fe125560ed5c809e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad625af417f4445b9b14710ca3bdc409d"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; std::string, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#ad625af417f4445b9b14710ca3bdc409d">_modeNomWeightMap</a></td></tr>
<tr class="separator:ad625af417f4445b9b14710ca3bdc409d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af60df24f4eb7954a3297c9841c60624b"><td class="memItemLeft" align="right" valign="top">TLegend *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">THStackLeg</a> = nullptr</td></tr>
<tr class="memdesc:af60df24f4eb7954a3297c9841c60624b"><td class="mdescLeft">&#160;</td><td class="mdescRight">DB Miscellaneous Variables.  <a href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">More...</a><br /></td></tr>
<tr class="separator:af60df24f4eb7954a3297c9841c60624b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ff1ef7d99cee6d6a9fba74296d4d0ea"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a1ff1ef7d99cee6d6a9fba74296d4d0ea">FirstTimeW2</a></td></tr>
<tr class="memdesc:a1ff1ef7d99cee6d6a9fba74296d4d0ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS:Super hacky to update W2 or not.  <a href="classSampleHandlerFD.html#a1ff1ef7d99cee6d6a9fba74296d4d0ea">More...</a><br /></td></tr>
<tr class="separator:a1ff1ef7d99cee6d6a9fba74296d4d0ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa654562842a0da51ff917aaed517310e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#aa654562842a0da51ff917aaed517310e">UpdateW2</a></td></tr>
<tr class="memdesc:aa654562842a0da51ff917aaed517310e"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS:Super hacky to update W2 or not.  <a href="classSampleHandlerFD.html#aa654562842a0da51ff917aaed517310e">More...</a><br /></td></tr>
<tr class="separator:aa654562842a0da51ff917aaed517310e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classSampleHandlerBase"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classSampleHandlerBase')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classSampleHandlerBase.html">SampleHandlerBase</a></td></tr>
<tr class="memitem:a87670dbcda5d09b09675e8f407fe3a30 inherit pro_attribs_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67">TestStatistic</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a87670dbcda5d09b09675e8f407fe3a30">fTestStatistic</a></td></tr>
<tr class="memdesc:a87670dbcda5d09b09675e8f407fe3a30 inherit pro_attribs_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test statistic tells what kind of likelihood sample is using.  <a href="classSampleHandlerBase.html#a87670dbcda5d09b09675e8f407fe3a30">More...</a><br /></td></tr>
<tr class="separator:a87670dbcda5d09b09675e8f407fe3a30 inherit pro_attribs_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47d291148fa6153a7e05beebde6cfdb9 inherit pro_attribs_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">std::streambuf *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a47d291148fa6153a7e05beebde6cfdb9">buf</a></td></tr>
<tr class="memdesc:a47d291148fa6153a7e05beebde6cfdb9 inherit pro_attribs_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Keep the cout buffer.  <a href="classSampleHandlerBase.html#a47d291148fa6153a7e05beebde6cfdb9">More...</a><br /></td></tr>
<tr class="separator:a47d291148fa6153a7e05beebde6cfdb9 inherit pro_attribs_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b884367733c4f3a93c75127ed6e9df9 inherit pro_attribs_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">std::streambuf *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a6b884367733c4f3a93c75127ed6e9df9">errbuf</a></td></tr>
<tr class="memdesc:a6b884367733c4f3a93c75127ed6e9df9 inherit pro_attribs_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Keep the cerr buffer.  <a href="classSampleHandlerBase.html#a6b884367733c4f3a93c75127ed6e9df9">More...</a><br /></td></tr>
<tr class="separator:a6b884367733c4f3a93c75127ed6e9df9 inherit pro_attribs_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7a13af22c2314c718fb6438d493d3d1 inherit pro_attribs_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#aa7a13af22c2314c718fb6438d493d3d1">nSamples</a></td></tr>
<tr class="memdesc:aa7a13af22c2314c718fb6438d493d3d1 inherit pro_attribs_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contains how many samples we've got.  <a href="classSampleHandlerBase.html#aa7a13af22c2314c718fb6438d493d3d1">More...</a><br /></td></tr>
<tr class="separator:aa7a13af22c2314c718fb6438d493d3d1 inherit pro_attribs_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab497b52d94868283a8a7cedbd1a4d777 inherit pro_attribs_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#ab497b52d94868283a8a7cedbd1a4d777">nEvents</a></td></tr>
<tr class="memdesc:ab497b52d94868283a8a7cedbd1a4d777 inherit pro_attribs_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of MC events are there.  <a href="classSampleHandlerBase.html#ab497b52d94868283a8a7cedbd1a4d777">More...</a><br /></td></tr>
<tr class="separator:ab497b52d94868283a8a7cedbd1a4d777 inherit pro_attribs_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f86c6158b755b9d2d400415ccac45f2 inherit pro_attribs_classSampleHandlerBase"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classMaCh3Modes.html">MaCh3Modes</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a></td></tr>
<tr class="memdesc:a2f86c6158b755b9d2d400415ccac45f2 inherit pro_attribs_classSampleHandlerBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds information about used Generator and MaCh3 modes.  <a href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">More...</a><br /></td></tr>
<tr class="separator:a2f86c6158b755b9d2d400415ccac45f2 inherit pro_attribs_classSampleHandlerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:a275ef31fcf386fcd3c594fc2762f9fda"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a275ef31fcf386fcd3c594fc2762f9fda">FDPlotType</a> { <a class="el" href="classSampleHandlerFD.html#a275ef31fcf386fcd3c594fc2762f9fdaae986eb261f3bb8175a1160ddca806e84">kModePlot</a> = 0
, <a class="el" href="classSampleHandlerFD.html#a275ef31fcf386fcd3c594fc2762f9fdaa41eaf103a2e447ae4c984567ea4f6940">kOscChannelPlot</a> = 1
 }</td></tr>
<tr class="separator:a275ef31fcf386fcd3c594fc2762f9fda"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a251743beb6b3e6884fef871a8aef9156"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; std::string, <a class="el" href="SampleStructs_8h.html#a0dfdd8cf84b8fa3495e9e5e520fe6cd2">NuPDG</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a251743beb6b3e6884fef871a8aef9156">FileToInitPDGMap</a></td></tr>
<tr class="separator:a251743beb6b3e6884fef871a8aef9156"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52a69295c2c47e621a5f2b2b1bd9f82e"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; std::string, <a class="el" href="SampleStructs_8h.html#a0dfdd8cf84b8fa3495e9e5e520fe6cd2">NuPDG</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerFD.html#a52a69295c2c47e621a5f2b2b1bd9f82e">FileToFinalPDGMap</a></td></tr>
<tr class="separator:a52a69295c2c47e621a5f2b2b1bd9f82e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class responsible for handling implementation of samples used in analysis, reweighting and returning LLH. </p>
<dl class="section author"><dt>Author</dt><dd>Dan Barrow </dd>
<dd>
Ed Atkin </dd></dl>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00021">21</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a275ef31fcf386fcd3c594fc2762f9fda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a275ef31fcf386fcd3c594fc2762f9fda">&#9670;&nbsp;</a></span>FDPlotType</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classSampleHandlerFD.html#a275ef31fcf386fcd3c594fc2762f9fda">SampleHandlerFD::FDPlotType</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a275ef31fcf386fcd3c594fc2762f9fdaae986eb261f3bb8175a1160ddca806e84"></a>kModePlot&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a275ef31fcf386fcd3c594fc2762f9fdaa41eaf103a2e447ae4c984567ea4f6940"></a>kOscChannelPlot&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00406">406</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                  {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a275ef31fcf386fcd3c594fc2762f9fdaae986eb261f3bb8175a1160ddca806e84">kModePlot</a> = 0,</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a275ef31fcf386fcd3c594fc2762f9fdaa41eaf103a2e447ae4c984567ea4f6940">kOscChannelPlot</a> = 1</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  };</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a275ef31fcf386fcd3c594fc2762f9fdaa41eaf103a2e447ae4c984567ea4f6940"><div class="ttname"><a href="classSampleHandlerFD.html#a275ef31fcf386fcd3c594fc2762f9fdaa41eaf103a2e447ae4c984567ea4f6940">SampleHandlerFD::kOscChannelPlot</a></div><div class="ttdeci">@ kOscChannelPlot</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00409">SampleHandlerFD.h:408</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a275ef31fcf386fcd3c594fc2762f9fdaae986eb261f3bb8175a1160ddca806e84"><div class="ttname"><a href="classSampleHandlerFD.html#a275ef31fcf386fcd3c594fc2762f9fdaae986eb261f3bb8175a1160ddca806e84">SampleHandlerFD::kModePlot</a></div><div class="ttdeci">@ kModePlot</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00407">SampleHandlerFD.h:407</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a6a0442b8c11f0a83b18fec8c9222b3e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a0442b8c11f0a83b18fec8c9222b3e8">&#9670;&nbsp;</a></span>SampleHandlerFD()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SampleHandlerFD::SampleHandlerFD </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>ConfigFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classParameterHandlerGeneric.html">ParameterHandlerGeneric</a> *&#160;</td>
          <td class="paramname"><em>xsec_cov</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classOscillationHandler.html">OscillationHandler</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>OscillatorObj_</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ConfigFileName</td><td>Name of config to initialise the sample object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00011">11</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;                                                                                          : <a class="code" href="classSampleHandlerBase.html#a6a6d7e5d275154ed550cd6c9dfc36000">SampleHandlerBase</a>() {</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;-------------------------------------------------------------------&quot;</span>);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Creating SampleHandlerFD object&quot;</span>);</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <span class="comment">//ETA - safety feature so you can&#39;t pass a NULL xsec_cov</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  <span class="keywordflow">if</span>(!xsec_cov){</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;You&#39;ve passed me a nullptr to a SystematicHandlerGeneric... I need this to setup splines!&quot;</span>);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  }</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a1db89c4df22a237b1cb26a2b55ee0866">ParHandler</a> = xsec_cov;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <a class="code" href="classSampleHandlerBase.html#aa7a13af22c2314c718fb6438d493d3d1">nSamples</a> = 1;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordflow">if</span> (OscillatorObj_ != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;You have passed an Oscillator object through the constructor of a SampleHandlerFD object - this will be used for all oscillation channels&quot;</span>);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">Oscillator</a> = OscillatorObj_;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  }</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <a class="code" href="classSampleHandlerFD.html#aae37732e76f0b17b6f124bd5543177e4">KinematicParameters</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <a class="code" href="classSampleHandlerFD.html#ad7ac675cc4ce81bec42e0700f1ff2620">ReversedKinematicParameters</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a5d762b169bab4454bbdb1b387c09f4a7">KinematicVectors</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a341f7bf83eb74ba5d27a2c9616202eba">ReversedKinematicVectors</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a85415d4ac54a5aefe78e5ab4d7bdb769">SampleHandlerFD_array</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a2b16ed4f91f2f37ff707ca048d8d6927">SampleHandlerFD_data</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <a class="code" href="classSampleHandlerFD.html#af5c6a3701c6ac76a96886ff13300a53b">SampleHandlerFD_array_w2</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a9a7fccdf8392ee06495902fab60e9858">SampleHandlerName</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleManager</a> = std::make_unique&lt;Manager&gt;(ConfigFileName.c_str());</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a> = std::make_unique&lt;BinningHandler&gt;();</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="comment">// Variables related to MC stat</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a1ff1ef7d99cee6d6a9fba74296d4d0ea">FirstTimeW2</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <a class="code" href="classSampleHandlerFD.html#aa654562842a0da51ff917aaed517310e">UpdateW2</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a61052119a625282d0ec6d4a97adf3ee2"><div class="ttname"><a href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a></div><div class="ttdeci">#define MACH3LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00037">MaCh3Logger.h:37</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_a95fa4dffc648e4c5536c9292c2bdcac3"><div class="ttname"><a href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a></div><div class="ttdeci">#define MACH3LOG_INFO</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00035">MaCh3Logger.h:35</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_ad5b2eb6377721e3ac95def22c2386bb1"><div class="ttname"><a href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a></div><div class="ttdeci">#define MACH3LOG_WARN</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00036">MaCh3Logger.h:36</a></div></div>
<div class="ttc" id="aclassMaCh3Exception_html"><div class="ttname"><a href="classMaCh3Exception.html">MaCh3Exception</a></div><div class="ttdoc">Custom exception class used throughout MaCh3.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Exception_8h_source.html#l00023">MaCh3Exception.h:23</a></div></div>
<div class="ttc" id="aclassSampleHandlerBase_html_a6a6d7e5d275154ed550cd6c9dfc36000"><div class="ttname"><a href="classSampleHandlerBase.html#a6a6d7e5d275154ed550cd6c9dfc36000">SampleHandlerBase::SampleHandlerBase</a></div><div class="ttdeci">SampleHandlerBase()</div><div class="ttdoc">The main constructor.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8cpp_source.html#l00004">SampleHandlerBase.cpp:4</a></div></div>
<div class="ttc" id="aclassSampleHandlerBase_html_aa7a13af22c2314c718fb6438d493d3d1"><div class="ttname"><a href="classSampleHandlerBase.html#aa7a13af22c2314c718fb6438d493d3d1">SampleHandlerBase::nSamples</a></div><div class="ttdeci">M3::int_t nSamples</div><div class="ttdoc">Contains how many samples we've got.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00210">SampleHandlerBase.h:210</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a1db89c4df22a237b1cb26a2b55ee0866"><div class="ttname"><a href="classSampleHandlerFD.html#a1db89c4df22a237b1cb26a2b55ee0866">SampleHandlerFD::ParHandler</a></div><div class="ttdeci">ParameterHandlerGeneric * ParHandler</div><div class="ttdoc">ETA - All experiments will need an xsec, det and osc cov.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00351">SampleHandlerFD.h:351</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a1ff1ef7d99cee6d6a9fba74296d4d0ea"><div class="ttname"><a href="classSampleHandlerFD.html#a1ff1ef7d99cee6d6a9fba74296d4d0ea">SampleHandlerFD::FirstTimeW2</a></div><div class="ttdeci">bool FirstTimeW2</div><div class="ttdoc">KS:Super hacky to update W2 or not.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00393">SampleHandlerFD.h:393</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a231b4b5b9b5e5f0d1cb9a3ba96c85ec5"><div class="ttname"><a href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">SampleHandlerFD::Binning</a></div><div class="ttdeci">std::unique_ptr&lt; BinningHandler &gt; Binning</div><div class="ttdoc">KS: This stores binning information, in future could be come vector to store binning for every used s...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00332">SampleHandlerFD.h:332</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a2b16ed4f91f2f37ff707ca048d8d6927"><div class="ttname"><a href="classSampleHandlerFD.html#a2b16ed4f91f2f37ff707ca048d8d6927">SampleHandlerFD::SampleHandlerFD_data</a></div><div class="ttdeci">double * SampleHandlerFD_data</div><div class="ttdoc">DB Array to be filled in AddData.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00338">SampleHandlerFD.h:338</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a341f7bf83eb74ba5d27a2c9616202eba"><div class="ttname"><a href="classSampleHandlerFD.html#a341f7bf83eb74ba5d27a2c9616202eba">SampleHandlerFD::ReversedKinematicVectors</a></div><div class="ttdeci">const std::unordered_map&lt; int, std::string &gt; * ReversedKinematicVectors</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00378">SampleHandlerFD.h:378</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a46fa97953e811328fe125560ed5c809e"><div class="ttname"><a href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleHandlerFD::SampleManager</a></div><div class="ttdeci">std::unique_ptr&lt; Manager &gt; SampleManager</div><div class="ttdoc">The manager object used to read the sample yaml file.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00382">SampleHandlerFD.h:382</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a5d762b169bab4454bbdb1b387c09f4a7"><div class="ttname"><a href="classSampleHandlerFD.html#a5d762b169bab4454bbdb1b387c09f4a7">SampleHandlerFD::KinematicVectors</a></div><div class="ttdeci">const std::unordered_map&lt; std::string, int &gt; * KinematicVectors</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00377">SampleHandlerFD.h:377</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a85415d4ac54a5aefe78e5ab4d7bdb769"><div class="ttname"><a href="classSampleHandlerFD.html#a85415d4ac54a5aefe78e5ab4d7bdb769">SampleHandlerFD::SampleHandlerFD_array</a></div><div class="ttdeci">double * SampleHandlerFD_array</div><div class="ttdoc">DB Array to be filled after reweighting.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00334">SampleHandlerFD.h:334</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a9a7fccdf8392ee06495902fab60e9858"><div class="ttname"><a href="classSampleHandlerFD.html#a9a7fccdf8392ee06495902fab60e9858">SampleHandlerFD::SampleHandlerName</a></div><div class="ttdeci">std::string SampleHandlerName</div><div class="ttdoc">A unique ID for each sample based on which we can define what systematic should be applied.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00355">SampleHandlerFD.h:355</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_aa654562842a0da51ff917aaed517310e"><div class="ttname"><a href="classSampleHandlerFD.html#aa654562842a0da51ff917aaed517310e">SampleHandlerFD::UpdateW2</a></div><div class="ttdeci">bool UpdateW2</div><div class="ttdoc">KS:Super hacky to update W2 or not.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00395">SampleHandlerFD.h:395</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_aa7115dd53d73a45fb64c565561095b6a"><div class="ttname"><a href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">SampleHandlerFD::Oscillator</a></div><div class="ttdeci">std::shared_ptr&lt; OscillationHandler &gt; Oscillator</div><div class="ttdoc">Contains all your binned splines and handles the setup and the returning of weights from spline evalu...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00217">SampleHandlerFD.h:217</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_aae37732e76f0b17b6f124bd5543177e4"><div class="ttname"><a href="classSampleHandlerFD.html#aae37732e76f0b17b6f124bd5543177e4">SampleHandlerFD::KinematicParameters</a></div><div class="ttdeci">const std::unordered_map&lt; std::string, int &gt; * KinematicParameters</div><div class="ttdoc">Mapping between string and kinematic enum.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00372">SampleHandlerFD.h:372</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ad7ac675cc4ce81bec42e0700f1ff2620"><div class="ttname"><a href="classSampleHandlerFD.html#ad7ac675cc4ce81bec42e0700f1ff2620">SampleHandlerFD::ReversedKinematicParameters</a></div><div class="ttdeci">const std::unordered_map&lt; int, std::string &gt; * ReversedKinematicParameters</div><div class="ttdoc">Mapping between kinematic enum and string.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00374">SampleHandlerFD.h:374</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_af5c6a3701c6ac76a96886ff13300a53b"><div class="ttname"><a href="classSampleHandlerFD.html#af5c6a3701c6ac76a96886ff13300a53b">SampleHandlerFD::SampleHandlerFD_array_w2</a></div><div class="ttdeci">double * SampleHandlerFD_array_w2</div><div class="ttdoc">KS Array used for MC stat.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00336">SampleHandlerFD.h:336</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7aa8473194b5afccfbf453392b49e580"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7aa8473194b5afccfbf453392b49e580">&#9670;&nbsp;</a></span>~SampleHandlerFD()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SampleHandlerFD::~SampleHandlerFD </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>destructor </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00047">47</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                  {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a>(<span class="stringliteral">&quot;I&#39;m deleting SampleHandlerFD&quot;</span>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#a85415d4ac54a5aefe78e5ab4d7bdb769">SampleHandlerFD_array</a> != <span class="keyword">nullptr</span>) <span class="keyword">delete</span>[] <a class="code" href="classSampleHandlerFD.html#a85415d4ac54a5aefe78e5ab4d7bdb769">SampleHandlerFD_array</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#af5c6a3701c6ac76a96886ff13300a53b">SampleHandlerFD_array_w2</a> != <span class="keyword">nullptr</span>) <span class="keyword">delete</span>[] <a class="code" href="classSampleHandlerFD.html#af5c6a3701c6ac76a96886ff13300a53b">SampleHandlerFD_array_w2</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="comment">//ETA - there is a chance that you haven&#39;t added any data...</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#a2b16ed4f91f2f37ff707ca048d8d6927">SampleHandlerFD_data</a> != <span class="keyword">nullptr</span>) <span class="keyword">delete</span>[] <a class="code" href="classSampleHandlerFD.html#a2b16ed4f91f2f37ff707ca048d8d6927">SampleHandlerFD_data</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">THStackLeg</a> != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code" href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">THStackLeg</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a4db4657acad5c79ac4bbb66a9d1c5905"><div class="ttname"><a href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a></div><div class="ttdeci">#define MACH3LOG_DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00034">MaCh3Logger.h:34</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_af60df24f4eb7954a3297c9841c60624b"><div class="ttname"><a href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">SampleHandlerFD::THStackLeg</a></div><div class="ttdeci">TLegend * THStackLeg</div><div class="ttdoc">DB Miscellaneous Variables.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00389">SampleHandlerFD.h:389</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="afbbc56bf8988bb6bf80c5f382f0b603b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbbc56bf8988bb6bf80c5f382f0b603b">&#9670;&nbsp;</a></span>AddAdditionalWeightPointers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void SampleHandlerFD::AddAdditionalWeightPointers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>DB Function to determine which weights apply to which types of samples. </p>

<p>Implemented in <a class="el" href="classPySampleHandlerFD.html#afae033f041fbf509b690d216d654983d">PySampleHandlerFD</a>.</p>

</div>
</div>
<a id="afea1a24bb322b7a570ae8081d38cc1ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afea1a24bb322b7a570ae8081d38cc1ae">&#9670;&nbsp;</a></span>AddData() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::AddData </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Data_Array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00995">995</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                                                                                   {</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> Start = <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetSampleStartBin(Sample);</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> End = <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetSampleEndBin(Sample);</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> ExpectedSize = End - Start;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160; </div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(Data_Array.size()) != ExpectedSize) {</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Data_Array size mismatch for sample &#39;{}&#39;.&quot;</span>, <a class="code" href="classSampleHandlerFD.html#adfad2507ad845ad36fff3c82231a143c">GetSampleTitle</a>(Sample));</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Expected size: {}, received size: {}.&quot;</span>, ExpectedSize, Data_Array.size());</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Start bin: {}, End bin: {}.&quot;</span>, Start, End);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;This likely indicates a binning or sample slicing bug.&quot;</span>);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  }</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; </div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idx = Start; idx &lt; End; ++idx) {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a2b16ed4f91f2f37ff707ca048d8d6927">SampleHandlerFD_data</a>[idx] = Data_Array[idx - Start];</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  }</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160; </div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a5eab24c8508cdd247c23b9bd9b3017b0">FillHist</a>(Sample, <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].DataHist, <a class="code" href="classSampleHandlerFD.html#a2b16ed4f91f2f37ff707ca048d8d6927">SampleHandlerFD_data</a>);</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a115728f4ba502c93ffd447fb5457aac6"><div class="ttname"><a href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleHandlerFD::SampleDetails</a></div><div class="ttdeci">std::vector&lt; SampleInfo &gt; SampleDetails</div><div class="ttdoc">Stores info about currently initialised sample.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00345">SampleHandlerFD.h:345</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a5eab24c8508cdd247c23b9bd9b3017b0"><div class="ttname"><a href="classSampleHandlerFD.html#a5eab24c8508cdd247c23b9bd9b3017b0">SampleHandlerFD::FillHist</a></div><div class="ttdeci">void FillHist(const int Sample, TH1 *Hist, double *Array)</div><div class="ttdoc">Fill a histogram with the event-level information used in the fit.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00263">SampleHandlerFD.cpp:263</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_adfad2507ad845ad36fff3c82231a143c"><div class="ttname"><a href="classSampleHandlerFD.html#adfad2507ad845ad36fff3c82231a143c">SampleHandlerFD::GetSampleTitle</a></div><div class="ttdeci">std::string GetSampleTitle(const int Sample) const override</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00035">SampleHandlerFD.h:35</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a40826e4d1204facbb5b0012cb53bdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a40826e4d1204facbb5b0012cb53bdc">&#9670;&nbsp;</a></span>AddData() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::AddData </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *&#160;</td>
          <td class="paramname"><em>Data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00932">932</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                                                         {</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <span class="keywordtype">int</span> Dim = <a class="code" href="classSampleHandlerFD.html#a768fdb89852db345ec267d30bd462cb2">GetNDim</a>(Sample);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Adding {}D data histogram: {} with {:.2f} events&quot;</span>, Dim, Data-&gt;GetTitle(), Data-&gt;Integral());</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <span class="comment">// delete old histogram</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="keyword">delete</span> <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].DataHist;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].DataHist = <span class="keyword">static_cast&lt;</span>TH1*<span class="keyword">&gt;</span>(Data-&gt;Clone());</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#a2b16ed4f91f2f37ff707ca048d8d6927">SampleHandlerFD_data</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;SampleHandlerFD_data haven&#39;t been initialised yet&quot;</span>);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  }</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <span class="keyword">auto</span> ChecHistType = [&amp;](<span class="keyword">const</span> std::string&amp; Type, <span class="keyword">const</span> <span class="keywordtype">int</span> Dimen, <span class="keyword">const</span> TH1* Hist,</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                          <span class="keyword">const</span> std::string&amp; file, <span class="keyword">const</span> <span class="keywordtype">int</span> line) {</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keywordflow">if</span> (std::string(Hist-&gt;ClassName()) != Type) {</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Expected {} for {}D sample, got {}&quot;</span>, Type, Dimen, Hist-&gt;ClassName());</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(file, line);</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    }</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  };</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160; </div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <span class="keywordflow">if</span> (Dim == 1) {</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="comment">// Ensure we really have a TH1D</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    ChecHistType(<span class="stringliteral">&quot;TH1D&quot;</span>, Dim, <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].DataHist, __FILE__, __LINE__);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> xBin = 0; xBin &lt; <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetNAxisBins(Sample, 0); ++xBin) {</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> idx = <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetGlobalBinSafe(Sample, {xBin});</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      <span class="comment">// ROOT histograms are 1-based, so bin index + 1</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      <a class="code" href="classSampleHandlerFD.html#a2b16ed4f91f2f37ff707ca048d8d6927">SampleHandlerFD_data</a>[idx] = <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].DataHist-&gt;GetBinContent(xBin + 1);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    }</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].DataHist-&gt;GetXaxis()-&gt;SetTitle(<a class="code" href="classSampleHandlerFD.html#a9aebf7da41ad6ddb87e3081a7f4763ec">GetXBinVarName</a>(Sample).c_str());</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].DataHist-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Number of Events&quot;</span>);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Dim == 2) {</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;IsUniform(Sample)) {</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      ChecHistType(<span class="stringliteral">&quot;TH2D&quot;</span>, Dim, <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].DataHist, __FILE__, __LINE__);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yBin = 0; yBin &lt; <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetNAxisBins(Sample, 1); ++yBin) {</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> xBin = 0; xBin &lt; <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetNAxisBins(Sample, 0); ++xBin) {</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> idx = <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetGlobalBinSafe(Sample, {xBin, yBin});</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;          <span class="comment">//Need to do +1 for the bin, this is to be consistent with ROOTs binning scheme</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;          <a class="code" href="classSampleHandlerFD.html#a2b16ed4f91f2f37ff707ca048d8d6927">SampleHandlerFD_data</a>[idx] = <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].DataHist-&gt;GetBinContent(xBin + 1, yBin + 1);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        }</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      }</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    } <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      ChecHistType(<span class="stringliteral">&quot;TH2Poly&quot;</span>, Dim, <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].DataHist, __FILE__, __LINE__);</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iBin = 0; iBin &lt; <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetNBins(Sample); ++iBin) {</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> idx = iBin + <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetSampleStartBin(Sample);</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <span class="comment">//Need to do +1 for the bin, this is to be consistent with ROOTs binning scheme</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <a class="code" href="classSampleHandlerFD.html#a2b16ed4f91f2f37ff707ca048d8d6927">SampleHandlerFD_data</a>[idx] = <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].DataHist-&gt;GetBinContent(iBin + 1);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      }</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    }</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160; </div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].DataHist-&gt;GetXaxis()-&gt;SetTitle(<a class="code" href="classSampleHandlerFD.html#a9aebf7da41ad6ddb87e3081a7f4763ec">GetXBinVarName</a>(Sample).c_str());</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].DataHist-&gt;GetYaxis()-&gt;SetTitle(<a class="code" href="classSampleHandlerFD.html#a69d66592696bee9e73f61649c681a573">GetYBinVarName</a>(Sample).c_str());</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].DataHist-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Number of Events&quot;</span>);</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    ChecHistType(<span class="stringliteral">&quot;TH1D&quot;</span>, Dim, <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].DataHist, __FILE__, __LINE__);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iBin = 0; iBin &lt; <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetNBins(Sample); ++iBin) {</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> idx = iBin + <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetSampleStartBin(Sample);</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      <span class="comment">//Need to do +1 for the bin, this is to be consistent with ROOTs binning scheme</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      <a class="code" href="classSampleHandlerFD.html#a2b16ed4f91f2f37ff707ca048d8d6927">SampleHandlerFD_data</a>[idx] = <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].DataHist-&gt;GetBinContent(iBin + 1);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    }</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  }</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a69d66592696bee9e73f61649c681a573"><div class="ttname"><a href="classSampleHandlerFD.html#a69d66592696bee9e73f61649c681a573">SampleHandlerFD::GetYBinVarName</a></div><div class="ttdeci">std::string GetYBinVarName(const int Sample) const</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00043">SampleHandlerFD.h:43</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a768fdb89852db345ec267d30bd462cb2"><div class="ttname"><a href="classSampleHandlerFD.html#a768fdb89852db345ec267d30bd462cb2">SampleHandlerFD::GetNDim</a></div><div class="ttdeci">int GetNDim(const int Sample) const override</div><div class="ttdoc">DB Function to differentiate 1D or 2D binning.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00033">SampleHandlerFD.h:33</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a9aebf7da41ad6ddb87e3081a7f4763ec"><div class="ttname"><a href="classSampleHandlerFD.html#a9aebf7da41ad6ddb87e3081a7f4763ec">SampleHandlerFD::GetXBinVarName</a></div><div class="ttdeci">std::string GetXBinVarName(const int Sample) const</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00042">SampleHandlerFD.h:42</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adaa2f3489afd3d80356649d439e88298"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adaa2f3489afd3d80356649d439e88298">&#9670;&nbsp;</a></span>ApplyShifts()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::ApplyShifts </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iEvent</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>ETA - generic function applying shifts. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00559">559</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                                                  {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; shifts = <a class="code" href="classSampleHandlerFD.html#a40ff07ee06efb7aeb285a769c2c9b81f">funcParsGrid</a>[iEvent];</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> nShifts = shifts.size();</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="comment">// KS: If there are no shifts then there is no point in resetting which can be costly.</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="keywordflow">if</span>(nShifts == 0) {</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  }</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="comment">// Given a sample and event, apply the shifts to the event based on the vector of functional parameter enums</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="comment">// First reset shifted array back to nominal values</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a3ced3ca13adffc1f795b528faba8b3f3">ResetShifts</a>(iEvent);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="keywordflow">for</span> (std::size_t iShift = 0; iShift &lt; nShifts; ++iShift) {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>* <a class="code" href="Core_8h.html#ab6a7e23420f0bcfb04f42f45f8283101">_restrict_</a> fp = shifts[iShift];</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    (*fp-&gt;funcPtr)(fp-&gt;valuePtr, iEvent);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;}</div>
<div class="ttc" id="aCore_8h_html_ab6a7e23420f0bcfb04f42f45f8283101"><div class="ttname"><a href="Core_8h.html#ab6a7e23420f0bcfb04f42f45f8283101">_restrict_</a></div><div class="ttdeci">#define _restrict_</div><div class="ttdoc">KS: Using restrict limits the effects of pointer aliasing, aiding optimizations. While reading I foun...</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00108">Core.h:108</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a3ced3ca13adffc1f795b528faba8b3f3"><div class="ttname"><a href="classSampleHandlerFD.html#a3ced3ca13adffc1f795b528faba8b3f3">SampleHandlerFD::ResetShifts</a></div><div class="ttdeci">virtual void ResetShifts(const int iEvent)</div><div class="ttdoc">HH - reset the shifted values to the original values.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00250">SampleHandlerFD.h:250</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a40ff07ee06efb7aeb285a769c2c9b81f"><div class="ttname"><a href="classSampleHandlerFD.html#a40ff07ee06efb7aeb285a769c2c9b81f">SampleHandlerFD::funcParsGrid</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; FunctionalShifter * &gt; &gt; funcParsGrid</div><div class="ttdoc">HH - a grid of vectors of enums for each sample and event.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00252">SampleHandlerFD.h:250</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a78079726d3e96cebfae3a036969e042e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78079726d3e96cebfae3a036969e042e">&#9670;&nbsp;</a></span>ApplyTemporarySelection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &gt; SampleHandlerFD::ApplyTemporarySelection </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>ExtraCuts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Temporarily extend Selection for a given sample with additional cuts. Returns the original Selection so the caller can restore it later. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01337">1337</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                                                                                   {</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  <span class="comment">// Backup current selection</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  <span class="keyword">auto</span> originalSelection = <a class="code" href="classSampleHandlerFD.html#a07b3357278429dfe809d7d9d27682bf9">Selection</a>;</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160; </div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  <span class="comment">//DB Add all the predefined selections to the selection vector which will be applied</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;  <span class="keyword">auto</span> selectionToApply = <a class="code" href="classSampleHandlerFD.html#a07b3357278429dfe809d7d9d27682bf9">Selection</a>;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160; </div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;  <span class="comment">//DB Add all requested cuts from the argument to the selection vector which will be applied</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; cut : ExtraCuts) {</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    selectionToApply[iSample].emplace_back(cut);</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;  }</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160; </div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  <span class="comment">//DB Set the member variable to be the cuts to apply</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a07b3357278429dfe809d7d9d27682bf9">Selection</a> = std::move(selectionToApply);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160; </div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;  <span class="keywordflow">return</span> originalSelection;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a07b3357278429dfe809d7d9d27682bf9"><div class="ttname"><a href="classSampleHandlerFD.html#a07b3357278429dfe809d7d9d27682bf9">SampleHandlerFD::Selection</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; KinematicCut &gt; &gt; Selection</div><div class="ttdoc">a way to store selection cuts which you may push back in the get1DVar functions most of the time this...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00368">SampleHandlerFD.h:368</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8d9a0e8af47eee94ae9b535d9c7122d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d9a0e8af47eee94ae9b535d9c7122d4">&#9670;&nbsp;</a></span>BuildModeChannelSelection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; SampleHandlerFD::BuildModeChannelSelection </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>kModeToFill</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>kChannelToFill</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01666">1666</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;                                                                                                                                           {</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;  <span class="keywordtype">bool</span> fChannel;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  <span class="keywordtype">bool</span> fMode;</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160; </div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;  <span class="keywordflow">if</span> (kChannelToFill != -1) {</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    <span class="keywordflow">if</span> (kChannelToFill &gt; <a class="code" href="classSampleHandlerFD.html#aac276e3f10be081ce8e7f94df131490d">GetNOscChannels</a>(iSample)) {</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Required channel is not available. kChannelToFill should be between 0 and {}&quot;</span>, <a class="code" href="classSampleHandlerFD.html#aac276e3f10be081ce8e7f94df131490d">GetNOscChannels</a>(iSample));</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;kChannelToFill given:{}&quot;</span>, kChannelToFill);</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Exiting.&quot;</span>);</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    }</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    fChannel = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    fChannel = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;  }</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160; </div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;  <span class="keywordflow">if</span> (kModeToFill != -1) {</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    <span class="keywordflow">if</span> (!(kModeToFill &gt;= 0) &amp;&amp; (kModeToFill &lt; Modes-&gt;GetNModes())) {</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Required mode is not available. kModeToFill should be between 0 and {}&quot;</span>, <a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetNModes());</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;kModeToFill given:{}&quot;</span>, kModeToFill);</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Exiting..&quot;</span>);</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    }</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    fMode = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    fMode = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;  }</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160; </div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  std::vector&lt; KinematicCut &gt; SelectionVec;</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160; </div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;  <span class="keywordflow">if</span> (fMode) {</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    <a class="code" href="structKinematicCut.html">KinematicCut</a> SelecMode;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    SelecMode.<a class="code" href="structKinematicCut.html#aedd261d6e8e3f72e3570cfe3753cbd2f">ParamToCutOnIt</a> = <a class="code" href="classSampleHandlerFD.html#ae2769d593f34e8356b545af076818f89">ReturnKinematicParameterFromString</a>(<span class="stringliteral">&quot;Mode&quot;</span>);</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    SelecMode.<a class="code" href="structKinematicCut.html#aa654b5f2ef7ca1b57d9238c428fdc11f">LowerBound</a> = kModeToFill;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    SelecMode.<a class="code" href="structKinematicCut.html#a244bd4ada65739a6984a2039a5a6f200">UpperBound</a> = kModeToFill+1;</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    SelectionVec.push_back(SelecMode);</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;  }</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160; </div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;  <span class="keywordflow">if</span> (fChannel) {</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    <a class="code" href="structKinematicCut.html">KinematicCut</a> SelecChannel;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    SelecChannel.<a class="code" href="structKinematicCut.html#aedd261d6e8e3f72e3570cfe3753cbd2f">ParamToCutOnIt</a> = <a class="code" href="classSampleHandlerFD.html#ae2769d593f34e8356b545af076818f89">ReturnKinematicParameterFromString</a>(<span class="stringliteral">&quot;OscillationChannel&quot;</span>);</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    SelecChannel.<a class="code" href="structKinematicCut.html#aa654b5f2ef7ca1b57d9238c428fdc11f">LowerBound</a> = kChannelToFill;</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    SelecChannel.<a class="code" href="structKinematicCut.html#a244bd4ada65739a6984a2039a5a6f200">UpperBound</a> = kChannelToFill+1;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    SelectionVec.push_back(SelecChannel);</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;  }</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160; </div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;  <span class="keywordflow">return</span> SelectionVec;</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerBase_html_a2f86c6158b755b9d2d400415ccac45f2"><div class="ttname"><a href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">SampleHandlerBase::Modes</a></div><div class="ttdeci">std::unique_ptr&lt; MaCh3Modes &gt; Modes</div><div class="ttdoc">Holds information about used Generator and MaCh3 modes.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00216">SampleHandlerBase.h:216</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_aac276e3f10be081ce8e7f94df131490d"><div class="ttname"><a href="classSampleHandlerFD.html#aac276e3f10be081ce8e7f94df131490d">SampleHandlerFD::GetNOscChannels</a></div><div class="ttdeci">int GetNOscChannels(const int iSample) const override</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00093">SampleHandlerFD.h:93</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ae2769d593f34e8356b545af076818f89"><div class="ttname"><a href="classSampleHandlerFD.html#ae2769d593f34e8356b545af076818f89">SampleHandlerFD::ReturnKinematicParameterFromString</a></div><div class="ttdeci">int ReturnKinematicParameterFromString(const std::string &amp;KinematicStr) const</div><div class="ttdoc">ETA function to generically convert a string from xsec cov to a kinematic type.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01544">SampleHandlerFD.cpp:1544</a></div></div>
<div class="ttc" id="astructKinematicCut_html"><div class="ttname"><a href="structKinematicCut.html">KinematicCut</a></div><div class="ttdoc">KS: Small struct used for applying kinematic cuts.</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00149">SampleStructs.h:149</a></div></div>
<div class="ttc" id="astructKinematicCut_html_a244bd4ada65739a6984a2039a5a6f200"><div class="ttname"><a href="structKinematicCut.html#a244bd4ada65739a6984a2039a5a6f200">KinematicCut::UpperBound</a></div><div class="ttdeci">double UpperBound</div><div class="ttdoc">Upper bound on which we apply cut.</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00156">SampleStructs.h:156</a></div></div>
<div class="ttc" id="astructKinematicCut_html_aa654b5f2ef7ca1b57d9238c428fdc11f"><div class="ttname"><a href="structKinematicCut.html#aa654b5f2ef7ca1b57d9238c428fdc11f">KinematicCut::LowerBound</a></div><div class="ttdeci">double LowerBound</div><div class="ttdoc">Lower bound on which we apply cut.</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00154">SampleStructs.h:154</a></div></div>
<div class="ttc" id="astructKinematicCut_html_aedd261d6e8e3f72e3570cfe3753cbd2f"><div class="ttname"><a href="structKinematicCut.html#aedd261d6e8e3f72e3570cfe3753cbd2f">KinematicCut::ParamToCutOnIt</a></div><div class="ttdeci">int ParamToCutOnIt</div><div class="ttdoc">Index or enum value identifying the kinematic variable to cut on.</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00152">SampleStructs.h:152</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a37768b8d5fda2e61989f8041a89ef7b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37768b8d5fda2e61989f8041a89ef7b8">&#9670;&nbsp;</a></span>CalcNormsBins()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::CalcNormsBins </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="structNormParameter.html">NormParameter</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>norm_parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>norms_bins</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check whether a normalisation systematic affects an event or not. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00639">639</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                                                                                                                        {</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="preprocessor">  #ifdef DEBUG</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  std::vector&lt;int&gt; VerboseCounter(norm_parameters.size(), 0);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iEvent = 0; iEvent &lt; <a class="code" href="classSampleHandlerBase.html#a6ceca02f83e878ef1aec6e54e7b2f331">GetNEvents</a>(); ++iEvent){</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    std::vector&lt; int &gt; NormBins = {};</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#a1db89c4df22a237b1cb26a2b55ee0866">ParHandler</a>) {</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <span class="comment">// Skip oscillated NC events</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      <span class="comment">// Not strictly needed, but these events don&#39;t get included in oscillated predictions, so</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      <span class="comment">// no need to waste our time calculating and storing information about xsec parameters</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      <span class="comment">// that will never be used.</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].isNC &amp;&amp; (*<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].nupdg != *<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].nupdgUnosc) ) {</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#afc88f0aa23c7127b2ff6e5c7ca3fa892">MACH3LOG_TRACE</a>(<span class="stringliteral">&quot;Event {}, missed NC/signal check&quot;</span>, iEvent);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      } <span class="comment">//DB Abstract check on MaCh3Modes to determine which apply to neutral current</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      <span class="keywordflow">for</span> (std::vector&lt;NormParameter&gt;::iterator it = norm_parameters.begin(); it != norm_parameters.end(); ++it) {</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="comment">//Now check that the target of an interaction matches with the normalisation parameters</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <span class="keywordtype">bool</span> TargetMatch = <a class="code" href="classSampleHandlerBase.html#ad16c838d4dc86e98445f199a16cf9bdf">MatchCondition</a>((*it).targets, *(<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].Target));</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        <span class="keywordflow">if</span> (!TargetMatch) {</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;          <a class="code" href="MaCh3Logger_8h.html#afc88f0aa23c7127b2ff6e5c7ca3fa892">MACH3LOG_TRACE</a>(<span class="stringliteral">&quot;Event {}, missed target check ({}) for dial {}&quot;</span>, iEvent, *(<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].Target), (*it).name);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="comment">//Now check that the neutrino flavour in an interaction matches with the normalisation parameters</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <span class="keywordtype">bool</span> FlavourMatch = <a class="code" href="classSampleHandlerBase.html#ad16c838d4dc86e98445f199a16cf9bdf">MatchCondition</a>((*it).pdgs, *(<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].nupdg));</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <span class="keywordflow">if</span> (!FlavourMatch) {</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;          <a class="code" href="MaCh3Logger_8h.html#afc88f0aa23c7127b2ff6e5c7ca3fa892">MACH3LOG_TRACE</a>(<span class="stringliteral">&quot;Event {}, missed PDG check ({}) for dial {}&quot;</span>, iEvent,(*<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].nupdg), (*it).name);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        }</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <span class="comment">//Now check that the unoscillated neutrino flavour in an interaction matches with the normalisation parameters</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="keywordtype">bool</span> FlavourUnoscMatch = <a class="code" href="classSampleHandlerBase.html#ad16c838d4dc86e98445f199a16cf9bdf">MatchCondition</a>((*it).preoscpdgs, *(<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].nupdgUnosc));</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="keywordflow">if</span> (!FlavourUnoscMatch){</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;          <a class="code" href="MaCh3Logger_8h.html#afc88f0aa23c7127b2ff6e5c7ca3fa892">MACH3LOG_TRACE</a>(<span class="stringliteral">&quot;Event {}, missed FlavourUnosc check ({}) for dial {}&quot;</span>, iEvent,(*<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].nupdgUnosc), (*it).name);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <span class="comment">//Now check that the mode of an interaction matches with the normalisation parameters</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <span class="keywordtype">bool</span> ModeMatch = <a class="code" href="classSampleHandlerBase.html#ad16c838d4dc86e98445f199a16cf9bdf">MatchCondition</a>((*it).modes, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::round(*(<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].mode))));</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <span class="keywordflow">if</span> (!ModeMatch) {</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;          <a class="code" href="MaCh3Logger_8h.html#afc88f0aa23c7127b2ff6e5c7ca3fa892">MACH3LOG_TRACE</a>(<span class="stringliteral">&quot;Event {}, missed Mode check ({}) for dial {}&quot;</span>, iEvent, *(<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].mode), (*it).name);</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        }</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160; </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="comment">//Now check whether the norm has kinematic bounds</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        <span class="comment">//i.e. does it only apply to events in a particular kinematic region?</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <span class="comment">// Now check whether within kinematic bounds</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="keywordtype">bool</span> IsSelected = <a class="code" href="classSampleHandlerFD.html#abbc1484d010b021794f44fc1b1594269">PassesSelection</a>((*it), iEvent);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        <span class="comment">// Need to then break the event loop</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <span class="keywordflow">if</span>(!IsSelected){</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;          <a class="code" href="MaCh3Logger_8h.html#afc88f0aa23c7127b2ff6e5c7ca3fa892">MACH3LOG_TRACE</a>(<span class="stringliteral">&quot;Event {}, missed Kinematic var check for dial {}&quot;</span>, iEvent, (*it).name);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        }</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <span class="comment">// Now set &#39;index bin&#39; for each normalisation parameter</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <span class="comment">// All normalisations are just 1 bin for 2015, so bin = index (where index is just the bin for that normalisation)</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="keywordtype">int</span> bin = (*it).index;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160; </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        NormBins.push_back(bin);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#afc88f0aa23c7127b2ff6e5c7ca3fa892">MACH3LOG_TRACE</a>(<span class="stringliteral">&quot;Event {}, will be affected by dial {}&quot;</span>, iEvent, (*it).name);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="preprocessor">        #ifdef DEBUG</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        VerboseCounter[std::distance(norm_parameters.begin(), it)]++;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <span class="comment">//}</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      } <span class="comment">// end iteration over norm_parameters</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    } <span class="comment">// end if (ParHandler)</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    norms_bins[iEvent] = NormBins;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  }<span class="comment">//end loop over events</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="preprocessor">  #ifdef DEBUG</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; norm_parameters.size(); ++i) {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; norm = norm_parameters[i];</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordtype">double</span> eventRatio = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(VerboseCounter[i]) / <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerBase.html#a6ceca02f83e878ef1aec6e54e7b2f331">GetNEvents</a>());</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a>(<span class="stringliteral">&quot; Param {:&lt;15}, affects {:&lt;8} events ({:&gt;6.2f}%) &quot;</span>,</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                  <a class="code" href="classSampleHandlerFD.html#a1db89c4df22a237b1cb26a2b55ee0866">ParHandler</a>-&gt;<a class="code" href="classParameterHandlerBase.html#a65b61ae6c60d4eadbb06fdef9596cc7f">GetParFancyName</a>(norm.index), VerboseCounter[i], eventRatio);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  }</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_afc88f0aa23c7127b2ff6e5c7ca3fa892"><div class="ttname"><a href="MaCh3Logger_8h.html#afc88f0aa23c7127b2ff6e5c7ca3fa892">MACH3LOG_TRACE</a></div><div class="ttdeci">#define MACH3LOG_TRACE</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00033">MaCh3Logger.h:33</a></div></div>
<div class="ttc" id="aclassParameterHandlerBase_html_a65b61ae6c60d4eadbb06fdef9596cc7f"><div class="ttname"><a href="classParameterHandlerBase.html#a65b61ae6c60d4eadbb06fdef9596cc7f">ParameterHandlerBase::GetParFancyName</a></div><div class="ttdeci">std::string GetParFancyName(const int i) const</div><div class="ttdoc">Get fancy name of the Parameter.</div><div class="ttdef"><b>Definition:</b> <a href="ParameterHandlerBase_8h_source.html#l00148">ParameterHandlerBase.h:148</a></div></div>
<div class="ttc" id="aclassSampleHandlerBase_html_a6ceca02f83e878ef1aec6e54e7b2f331"><div class="ttname"><a href="classSampleHandlerBase.html#a6ceca02f83e878ef1aec6e54e7b2f331">SampleHandlerBase::GetNEvents</a></div><div class="ttdeci">unsigned int GetNEvents() const</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00052">SampleHandlerBase.h:52</a></div></div>
<div class="ttc" id="aclassSampleHandlerBase_html_ad16c838d4dc86e98445f199a16cf9bdf"><div class="ttname"><a href="classSampleHandlerBase.html#ad16c838d4dc86e98445f199a16cf9bdf">SampleHandlerBase::MatchCondition</a></div><div class="ttdeci">bool MatchCondition(const std::vector&lt; T &gt; &amp;allowedValues, const T &amp;value)</div><div class="ttdoc">check if event is affected by following conditions, for example pdg, or modes etc</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00194">SampleHandlerBase.h:194</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_abbc1484d010b021794f44fc1b1594269"><div class="ttname"><a href="classSampleHandlerFD.html#abbc1484d010b021794f44fc1b1594269">SampleHandlerFD::PassesSelection</a></div><div class="ttdeci">bool PassesSelection(const ParT &amp;Par, std::size_t iEvent)</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l02040">SampleHandlerFD.cpp:2040</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ae422410559d7f3af0e0a80cc15fbfbff"><div class="ttname"><a href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">SampleHandlerFD::MCSamples</a></div><div class="ttdeci">std::vector&lt; EventInfo &gt; MCSamples</div><div class="ttdoc">Stores information about every MC event.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00343">SampleHandlerFD.h:343</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1781ff483b5bae72103e9298109c4698"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1781ff483b5bae72103e9298109c4698">&#9670;&nbsp;</a></span>CalcWeightFunc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void SampleHandlerFD::CalcWeightFunc </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iEvent</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate weights for function parameters. </p>
<p>First you need to setup additional pointers in you experiment code in SetupWeightPointers Then in this function you can calculate whatever fancy function you want by filling weight to which you have pointer This way func weight shall be used in GetEventWeight </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00284">284</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;{<span class="keywordflow">return</span>; (void)iEvent;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa1c7c8384fd383170aacf4d83af1b382"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1c7c8384fd383170aacf4d83af1b382">&#9670;&nbsp;</a></span>CalcWeightTotal()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> SampleHandlerFD::CalcWeightTotal </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structEventInfo.html">EventInfo</a> *<a class="el" href="Core_8h.html#ab6a7e23420f0bcfb04f42f45f8283101">_restrict_</a>&#160;</td>
          <td class="paramname"><em>MCEvent</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the total weight weight for a given event. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00580">580</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                                                                                    {</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> TotalWeight = 1.0;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> nNorms = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(MCEvent-&gt;<a class="code" href="structEventInfo.html#a3c119a4760e4380b1d6ec89700bf0b07">norm_pointers</a>.size());</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <span class="comment">//Loop over stored normalisation and function pointers</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="preprocessor">  #pragma omp simd reduction(*:TotalWeight)</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iParam = 0; iParam &lt; nNorms; ++iParam)</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="preprocessor">    #pragma GCC diagnostic push</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="preprocessor">    #pragma GCC diagnostic ignored &quot;-Wuseless-cast&quot;</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    TotalWeight *= <span class="keyword">static_cast&lt;</span><a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a><span class="keyword">&gt;</span>(*(MCEvent-&gt;<a class="code" href="structEventInfo.html#a3c119a4760e4380b1d6ec89700bf0b07">norm_pointers</a>[iParam]));</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="preprocessor">    #pragma GCC diagnostic pop</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> TotalWeights = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(MCEvent-&gt;<a class="code" href="structEventInfo.html#ad6f452fc2566a229ca7dfc166d5f5f96">total_weight_pointers</a>.size());</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="comment">//DB Loop over stored pointers</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="preprocessor">  #pragma omp simd reduction(*:TotalWeight)</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iWeight = 0; iWeight &lt; TotalWeights; ++iWeight) {</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    TotalWeight *= *(MCEvent-&gt;<a class="code" href="structEventInfo.html#ad6f452fc2566a229ca7dfc166d5f5f96">total_weight_pointers</a>[iWeight]);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  }</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="keywordflow">return</span> TotalWeight;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;}</div>
<div class="ttc" id="anamespaceM3_html_a1f95274549f25fc19fe7db343c8a7a68"><div class="ttname"><a href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a></div><div class="ttdeci">double float_t</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00037">Core.h:37</a></div></div>
<div class="ttc" id="astructEventInfo_html_a3c119a4760e4380b1d6ec89700bf0b07"><div class="ttname"><a href="structEventInfo.html#a3c119a4760e4380b1d6ec89700bf0b07">EventInfo::norm_pointers</a></div><div class="ttdeci">std::vector&lt; const double * &gt; norm_pointers</div><div class="ttdoc">Pointers to normalisation weights which are being taken from Parameter Handler.</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00109">FarDetectorCoreInfoStruct.h:109</a></div></div>
<div class="ttc" id="astructEventInfo_html_ad6f452fc2566a229ca7dfc166d5f5f96"><div class="ttname"><a href="structEventInfo.html#ad6f452fc2566a229ca7dfc166d5f5f96">EventInfo::total_weight_pointers</a></div><div class="ttdeci">std::vector&lt; const M3::float_t * &gt; total_weight_pointers</div><div class="ttdoc">Pointers to weights like oscillation spline etc.</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00112">FarDetectorCoreInfoStruct.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab1ac7cdcad889b0640b06e87da78e3b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1ac7cdcad889b0640b06e87da78e3b8">&#9670;&nbsp;</a></span>Fill1DSubEventHist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::Fill1DSubEventHist </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1D *&#160;</td>
          <td class="paramname"><em>_h1DVar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>SubEventSelectionVec</em> = <code>{}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01403">1403</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                                                                                                                 {</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;  <span class="keywordtype">int</span> ProjectionVar_Int = <a class="code" href="classSampleHandlerFD.html#ad81e082a5a4c86e51fc748bffd1dfa9e">ReturnKinematicVectorFromString</a>(ProjectionVar_Str);</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160; </div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;  <span class="comment">//JM Loop over all events</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iEvent = 0; iEvent &lt; <a class="code" href="classSampleHandlerBase.html#a6ceca02f83e878ef1aec6e54e7b2f331">GetNEvents</a>(); iEvent++) {</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> EventSample = <a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].NominalSample;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <span class="keywordflow">if</span>(EventSample != iSample) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#af67a9a10193e12526e3284d48f425185">IsEventSelected</a>(EventSample, iEvent)) {</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;      <span class="keywordtype">double</span> Weight = <a class="code" href="classSampleHandlerFD.html#a6831d91d5bcf1fb5723167736e0082ef">GetEventWeight</a>(iEvent);</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      <span class="keywordflow">if</span> (WeightStyle == 1) {</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        Weight = 1.;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;      }</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      std::vector&lt;double&gt; Vec = <a class="code" href="classSampleHandlerFD.html#ae98d72c6c30697e32fcb464923456fc0">ReturnKinematicVector</a>(ProjectionVar_Int,iEvent);</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      <span class="keywordtype">size_t</span> nsubevents = Vec.size();</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      <span class="comment">//JM Loop over all subevents in event</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iSubEvent = 0; iSubEvent &lt; nsubevents; iSubEvent++) {</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#aacc4d573b8e4569269b51ac325bc0092">IsSubEventSelected</a>(SubEventSelectionVec, iEvent, iSubEvent, nsubevents)) {</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;          <span class="keywordtype">double</span> Var = Vec[iSubEvent];</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;          _h1DVar-&gt;Fill(Var,Weight);</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;        }</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      }</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    }</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;  }</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a6831d91d5bcf1fb5723167736e0082ef"><div class="ttname"><a href="classSampleHandlerFD.html#a6831d91d5bcf1fb5723167736e0082ef">SampleHandlerFD::GetEventWeight</a></div><div class="ttdeci">M3::float_t GetEventWeight(const int iEntry)</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01148">SampleHandlerFD.cpp:1148</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_aacc4d573b8e4569269b51ac325bc0092"><div class="ttname"><a href="classSampleHandlerFD.html#aacc4d573b8e4569269b51ac325bc0092">SampleHandlerFD::IsSubEventSelected</a></div><div class="ttdeci">bool IsSubEventSelected(const std::vector&lt; KinematicCut &gt; &amp;SubEventCuts, const int iEvent, unsigned const int iSubEvent, size_t nsubevents)</div><div class="ttdoc">JM Function which determines if a subevent is selected.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00318">SampleHandlerFD.cpp:318</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ad81e082a5a4c86e51fc748bffd1dfa9e"><div class="ttname"><a href="classSampleHandlerFD.html#ad81e082a5a4c86e51fc748bffd1dfa9e">SampleHandlerFD::ReturnKinematicVectorFromString</a></div><div class="ttdeci">int ReturnKinematicVectorFromString(const std::string &amp;KinematicStr) const</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01571">SampleHandlerFD.cpp:1571</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ae98d72c6c30697e32fcb464923456fc0"><div class="ttname"><a href="classSampleHandlerFD.html#ae98d72c6c30697e32fcb464923456fc0">SampleHandlerFD::ReturnKinematicVector</a></div><div class="ttdeci">virtual std::vector&lt; double &gt; ReturnKinematicVector(std::string KinematicParameter, int iEvent)</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00291">SampleHandlerFD.h:291</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_af67a9a10193e12526e3284d48f425185"><div class="ttname"><a href="classSampleHandlerFD.html#af67a9a10193e12526e3284d48f425185">SampleHandlerFD::IsEventSelected</a></div><div class="ttdeci">bool IsEventSelected(const int iSample, const int iEvent) _noexcept_</div><div class="ttdoc">DB Function which determines if an event is selected, where Selection double looks like {{ND280Kinema...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00302">SampleHandlerFD.cpp:302</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a939d153567948b54843339bbfb77427f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a939d153567948b54843339bbfb77427f">&#9670;&nbsp;</a></span>Fill2DSubEventHist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::Fill2DSubEventHist </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH2D *&#160;</td>
          <td class="paramname"><em>_h2DVar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVarX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVarY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>SubEventSelectionVec</em> = <code>{}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01483">1483</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                                                          {</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160; </div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;  <span class="keywordtype">bool</span> IsSubEventVarX = <a class="code" href="classSampleHandlerFD.html#ad14d9728400a7b87f095aca00761b829">IsSubEventVarString</a>(ProjectionVar_StrX);</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  <span class="keywordtype">bool</span> IsSubEventVarY = <a class="code" href="classSampleHandlerFD.html#ad14d9728400a7b87f095aca00761b829">IsSubEventVarString</a>(ProjectionVar_StrY);   </div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160; </div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;  <span class="keywordtype">int</span> ProjectionVar_IntX, ProjectionVar_IntY;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  <span class="keywordflow">if</span> (IsSubEventVarX) ProjectionVar_IntX = <a class="code" href="classSampleHandlerFD.html#ad81e082a5a4c86e51fc748bffd1dfa9e">ReturnKinematicVectorFromString</a>(ProjectionVar_StrX);</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;  <span class="keywordflow">else</span> ProjectionVar_IntX = <a class="code" href="classSampleHandlerFD.html#ae2769d593f34e8356b545af076818f89">ReturnKinematicParameterFromString</a>(ProjectionVar_StrX);</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;  <span class="keywordflow">if</span> (IsSubEventVarY) ProjectionVar_IntY = <a class="code" href="classSampleHandlerFD.html#ad81e082a5a4c86e51fc748bffd1dfa9e">ReturnKinematicVectorFromString</a>(ProjectionVar_StrY);</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  <span class="keywordflow">else</span> ProjectionVar_IntY = <a class="code" href="classSampleHandlerFD.html#ae2769d593f34e8356b545af076818f89">ReturnKinematicParameterFromString</a>(ProjectionVar_StrY); </div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160; </div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;  <span class="comment">//JM Loop over all events</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iEvent = 0; iEvent &lt; <a class="code" href="classSampleHandlerBase.html#a6ceca02f83e878ef1aec6e54e7b2f331">GetNEvents</a>(); iEvent++) {</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> EventSample = <a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].NominalSample;</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    <span class="keywordflow">if</span>(EventSample != iSample) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#af67a9a10193e12526e3284d48f425185">IsEventSelected</a>(EventSample, iEvent)) {</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;      <span class="keywordtype">double</span> Weight = <a class="code" href="classSampleHandlerFD.html#a6831d91d5bcf1fb5723167736e0082ef">GetEventWeight</a>(iEvent);</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;      <span class="keywordflow">if</span> (WeightStyle == 1) {</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        Weight = 1.;</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;      }</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;      std::vector&lt;double&gt; VecX = {}, VecY = {};</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;      <span class="keywordtype">double</span> VarX = <a class="code" href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a>, VarY = <a class="code" href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a>;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;      <span class="keywordtype">size_t</span> nsubevents = 0;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;      <span class="comment">// JM Three cases: subeventX vs eventY || eventX vs subeventY || subeventX vs subeventY</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;      <span class="keywordflow">if</span> (IsSubEventVarX &amp;&amp; !IsSubEventVarY) {</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        VecX = <a class="code" href="classSampleHandlerFD.html#ae98d72c6c30697e32fcb464923456fc0">ReturnKinematicVector</a>(ProjectionVar_IntX, iEvent);</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;        VarY = <a class="code" href="classSampleHandlerFD.html#ad0f549802b5625871e11d86905989697">ReturnKinematicParameter</a>(ProjectionVar_IntY, iEvent);</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        nsubevents = VecX.size();</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;      }</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!IsSubEventVarX &amp;&amp; IsSubEventVarY) {</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;        VecY = <a class="code" href="classSampleHandlerFD.html#ae98d72c6c30697e32fcb464923456fc0">ReturnKinematicVector</a>(ProjectionVar_IntY, iEvent);</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        VarX = <a class="code" href="classSampleHandlerFD.html#ad0f549802b5625871e11d86905989697">ReturnKinematicParameter</a>(ProjectionVar_IntX, iEvent);</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        nsubevents = VecY.size();</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;      }</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        VecX = <a class="code" href="classSampleHandlerFD.html#ae98d72c6c30697e32fcb464923456fc0">ReturnKinematicVector</a>(ProjectionVar_IntX, iEvent);</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        VecY = <a class="code" href="classSampleHandlerFD.html#ae98d72c6c30697e32fcb464923456fc0">ReturnKinematicVector</a>(ProjectionVar_IntY, iEvent);</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;        <span class="keywordflow">if</span> (VecX.size() != VecY.size()) {</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;          <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Cannot plot {} of size {} against {} of size {}&quot;</span>, ProjectionVar_StrX, VecX.size(), ProjectionVar_StrY, VecY.size());</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;          <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;        }</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;        nsubevents = VecX.size();</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      }</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      <span class="comment">//JM Loop over all subevents in event</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iSubEvent = 0; iSubEvent &lt; nsubevents; iSubEvent++) {</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#aacc4d573b8e4569269b51ac325bc0092">IsSubEventSelected</a>(SubEventSelectionVec, iEvent, iSubEvent, nsubevents)) {</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;          <span class="keywordflow">if</span> (IsSubEventVarX) VarX = VecX[iSubEvent];</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;          <span class="keywordflow">if</span> (IsSubEventVarY) VarY = VecY[iSubEvent];</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;          _h2DVar-&gt;Fill(VarX,VarY,Weight);</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        }</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;      } </div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    }</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  }</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_ad0f549802b5625871e11d86905989697"><div class="ttname"><a href="classSampleHandlerFD.html#ad0f549802b5625871e11d86905989697">SampleHandlerFD::ReturnKinematicParameter</a></div><div class="ttdeci">virtual double ReturnKinematicParameter(std::string KinematicParamter, int iEvent)=0</div><div class="ttdoc">Return the value of an associated kinematic parameter for an event.</div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ad14d9728400a7b87f095aca00761b829"><div class="ttname"><a href="classSampleHandlerFD.html#ad14d9728400a7b87f095aca00761b829">SampleHandlerFD::IsSubEventVarString</a></div><div class="ttdeci">bool IsSubEventVarString(const std::string &amp;VarStr)</div><div class="ttdoc">JM Check if a kinematic parameter string corresponds to a subevent-level variable.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01651">SampleHandlerFD.cpp:1651</a></div></div>
<div class="ttc" id="anamespaceM3_html_a2aed672aeeb4fcf51069966193176ff3"><div class="ttname"><a href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a></div><div class="ttdeci">constexpr static const double _BAD_DOUBLE_</div><div class="ttdoc">Default value used for double initialisation.</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00053">Core.h:53</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeef0f943cb1e0d4c9bba4814cb24a507"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeef0f943cb1e0d4c9bba4814cb24a507">&#9670;&nbsp;</a></span>FillArray()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::FillArray </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>DB Nice new multi-threaded function which calculates the event weights and fills the relevant bins of an array. </p>
<p>Function which does the core reweighting. This assumes that oscillation weights have already been calculated and stored in SampleHandlerFD.osc_w[iEvent]. This function takes advantage of most of the things called in setupSKMC to reduce reweighting time. It also follows the ND code reweighting pretty closely. This function fills the <a class="el" href="classSampleHandlerFD.html" title="Class responsible for handling implementation of samples used in analysis, reweighting and returning ...">SampleHandlerFD</a> array array which is binned to match the sample binning, such that bin[1][1] is the equivalent of SampleDetails._hPDF2D-&gt;GetBinContent(2,2) {Noticing the offset} </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00367">367</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                                {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">//************************************************</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="comment">//DB Reset which cuts to apply</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a07b3357278429dfe809d7d9d27682bf9">Selection</a> = <a class="code" href="classSampleHandlerFD.html#aa3832a3e2c438d4810811d83e1323cff">StoredSelection</a>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a691a4ec2c4c82b3c4437ead052644a54">PrepFunctionalParameters</a>();</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iEvent = 0; iEvent &lt; <a class="code" href="classSampleHandlerBase.html#a6ceca02f83e878ef1aec6e54e7b2f331">GetNEvents</a>(); iEvent++) {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <a class="code" href="classSampleHandlerFD.html#adaa2f3489afd3d80356649d439e88298">ApplyShifts</a>(iEvent);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keyword">const</span> <a class="code" href="structEventInfo.html">EventInfo</a>* <a class="code" href="Core_8h.html#ab6a7e23420f0bcfb04f42f45f8283101">_restrict_</a> MCEvent = &amp;<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent];</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSampleHandlerFD.html#af67a9a10193e12526e3284d48f425185">IsEventSelected</a>(MCEvent-&gt;NominalSample, iEvent)) {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="comment">// Virtual by default does nothing, has to happen before CalcWeightTotal</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a1781ff483b5bae72103e9298109c4698">CalcWeightFunc</a>(iEvent);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> totalweight = <a class="code" href="classSampleHandlerFD.html#aa1c7c8384fd383170aacf4d83af1b382">CalcWeightTotal</a>(MCEvent);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">//DB Catch negative total weights and skip any event with a negative weight. Previously we would set weight to zero and continue but that is inefficient</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">if</span> (totalweight &lt;= 0.){</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="comment">//DB Find the relevant bin in the PDF for each event</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> GlobalBin = <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;FindGlobalBin(MCEvent-&gt;NominalSample, MCEvent-&gt;KinVar, MCEvent-&gt;NomBin);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="comment">//DB Fill relevant part of thread array</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">if</span> (GlobalBin &gt; <a class="code" href="namespaceM3.html#aadca64372617e10cf9fdf70d0b0eb23f">M3::UnderOverFlowBin</a>) {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <a class="code" href="classSampleHandlerFD.html#a85415d4ac54a5aefe78e5ab4d7bdb769">SampleHandlerFD_array</a>[GlobalBin] += totalweight;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#a1ff1ef7d99cee6d6a9fba74296d4d0ea">FirstTimeW2</a>) <a class="code" href="classSampleHandlerFD.html#af5c6a3701c6ac76a96886ff13300a53b">SampleHandlerFD_array_w2</a>[GlobalBin] += totalweight*totalweight;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  }</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a1781ff483b5bae72103e9298109c4698"><div class="ttname"><a href="classSampleHandlerFD.html#a1781ff483b5bae72103e9298109c4698">SampleHandlerFD::CalcWeightFunc</a></div><div class="ttdeci">virtual void CalcWeightFunc(int iEvent)</div><div class="ttdoc">Calculate weights for function parameters.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00284">SampleHandlerFD.h:284</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a691a4ec2c4c82b3c4437ead052644a54"><div class="ttname"><a href="classSampleHandlerFD.html#a691a4ec2c4c82b3c4437ead052644a54">SampleHandlerFD::PrepFunctionalParameters</a></div><div class="ttdeci">virtual void PrepFunctionalParameters()</div><div class="ttdoc">Update the functional parameter values to the latest proposed values. Needs to be called before every...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00241">SampleHandlerFD.h:241</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_aa1c7c8384fd383170aacf4d83af1b382"><div class="ttname"><a href="classSampleHandlerFD.html#aa1c7c8384fd383170aacf4d83af1b382">SampleHandlerFD::CalcWeightTotal</a></div><div class="ttdeci">M3::float_t CalcWeightTotal(const EventInfo *_restrict_ MCEvent) const</div><div class="ttdoc">Calculate the total weight weight for a given event.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00580">SampleHandlerFD.cpp:580</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_aa3832a3e2c438d4810811d83e1323cff"><div class="ttname"><a href="classSampleHandlerFD.html#aa3832a3e2c438d4810811d83e1323cff">SampleHandlerFD::StoredSelection</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; KinematicCut &gt; &gt; StoredSelection</div><div class="ttdoc">What gets pulled from config options, these are constant after loading in this is of length 3: 0th in...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00365">SampleHandlerFD.h:365</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_adaa2f3489afd3d80356649d439e88298"><div class="ttname"><a href="classSampleHandlerFD.html#adaa2f3489afd3d80356649d439e88298">SampleHandlerFD::ApplyShifts</a></div><div class="ttdeci">virtual void ApplyShifts(const int iEvent)</div><div class="ttdoc">ETA - generic function applying shifts.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00559">SampleHandlerFD.cpp:559</a></div></div>
<div class="ttc" id="anamespaceM3_html_aadca64372617e10cf9fdf70d0b0eb23f"><div class="ttname"><a href="namespaceM3.html#aadca64372617e10cf9fdf70d0b0eb23f">M3::UnderOverFlowBin</a></div><div class="ttdeci">constexpr static const int UnderOverFlowBin</div><div class="ttdoc">Mark bin which is overflow or underflow in MaCh3 binning.</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00091">Core.h:91</a></div></div>
<div class="ttc" id="astructEventInfo_html"><div class="ttname"><a href="structEventInfo.html">EventInfo</a></div><div class="ttdoc">Stores info about each MC event used during reweighting routine.</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00082">FarDetectorCoreInfoStruct.h:82</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5eab24c8508cdd247c23b9bd9b3017b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5eab24c8508cdd247c23b9bd9b3017b0">&#9670;&nbsp;</a></span>FillHist()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::FillHist </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *&#160;</td>
          <td class="paramname"><em>Hist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fill a histogram with the event-level information used in the fit. </p>
<p>DB Functions required for reweighting functions DB Replace previous implementation with reading bin contents from SampleHandlerFD_array </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00263">263</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                                                                         {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordtype">int</span> Dimension = <a class="code" href="classSampleHandlerFD.html#a768fdb89852db345ec267d30bd462cb2">GetNDim</a>(Sample);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="comment">// DB Commented out by default - Code heading towards GetLikelihood using arrays instead of root objects</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="comment">// Wouldn&#39;t actually need this for GetLikelihood as TH objects wouldn&#39;t be filled</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keywordflow">if</span>(Dimension == 1) {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    Hist-&gt;Reset();</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> xBin = 0; xBin &lt; <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetNAxisBins(Sample, 0); ++xBin) {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> idx = <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetGlobalBinSafe(Sample, {xBin});</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      Hist-&gt;SetBinContent(xBin + 1, Array[idx]);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Dimension == 2) {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    Hist-&gt;Reset();</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;IsUniform(Sample)) {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yBin = 0; yBin &lt; <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetNAxisBins(Sample, 1); ++yBin) {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> xBin = 0; xBin &lt; <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetNAxisBins(Sample, 0); ++xBin) {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> idx = <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetGlobalBinSafe(Sample, {xBin, yBin});</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;          Hist-&gt;SetBinContent(xBin + 1, yBin + 1, Array[idx]);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iBin = 0; iBin &lt; <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetNBins(Sample); ++iBin) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> idx = iBin + <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetSampleStartBin(Sample);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="comment">//Need to do +1 for the bin, this is to be consistent with ROOTs binning scheme</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        Hist-&gt;SetBinContent(iBin + 1, Array[idx]);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iBin = 0; iBin &lt; <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetNBins(Sample); ++iBin) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> idx = iBin + <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetSampleStartBin(Sample);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <span class="comment">//Need to do +1 for the bin, this is to be consistent with ROOTs binning scheme</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      Hist-&gt;SetBinContent(iBin + 1, Array[idx]);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a64b2af7680c88713c70f064fb7574184"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64b2af7680c88713c70f064fb7574184">&#9670;&nbsp;</a></span>FillSplineBins()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::FillSplineBins </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Finds the binned spline that an event should apply to and stored them in a a vector for easy evaluation in the fillArray() function. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01168">1168</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                                     {</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <span class="comment">//Now loop over events and get the spline bin for each event</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  <span class="keywordtype">bool</span> ThrowCrititcal = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classSampleHandlerBase.html#a6ceca02f83e878ef1aec6e54e7b2f331">GetNEvents</a>(); ++j) {</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> SampleIndex = <a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[j].NominalSample;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> SampleTitle = <a class="code" href="classSampleHandlerFD.html#adfad2507ad845ad36fff3c82231a143c">GetSampleTitle</a>(SampleIndex);</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> OscIndex = <a class="code" href="FarDetectorCoreInfoStruct_8h.html#afc52c63bc2b15ae30444755579f5beb4">GetOscChannel</a>(<a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[SampleIndex].OscChannels, (*<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[j].nupdgUnosc), (*<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[j].nupdg));</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> Mode = int(*(<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[j].mode));</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> Etrue = *(<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[j].rw_etru);</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    std::vector&lt; std::vector&lt;int&gt; &gt; EventSplines;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="keywordflow">switch</span>(<a class="code" href="classSampleHandlerFD.html#a768fdb89852db345ec267d30bd462cb2">GetNDim</a>(SampleIndex)) {</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;      <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        EventSplines = <a class="code" href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">SplineHandler</a>-&gt;GetEventSplines(SampleTitle, OscIndex, Mode, Etrue, *(<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[j].KinVar[0]), 0.);</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        EventSplines = <a class="code" href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">SplineHandler</a>-&gt;GetEventSplines(SampleTitle, OscIndex, Mode, Etrue, *(<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[j].KinVar[0]), *(<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[j].KinVar[1]));</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        <span class="keywordflow">if</span>(ThrowCrititcal) {</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;          <a class="code" href="MaCh3Logger_8h.html#a07ff6d6a15b24f94afc88a1b89779beb">MACH3LOG_CRITICAL</a>(<span class="stringliteral">&quot;MaCh3 doesn&#39;t support binned splines for more than 2D while you use {}&quot;</span>, <a class="code" href="classSampleHandlerFD.html#a768fdb89852db345ec267d30bd462cb2">GetNDim</a>(SampleIndex));</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;          <a class="code" href="MaCh3Logger_8h.html#a07ff6d6a15b24f94afc88a1b89779beb">MACH3LOG_CRITICAL</a>(<span class="stringliteral">&quot;Will use 2D like approach&quot;</span>);</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;          ThrowCrititcal = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        }</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        EventSplines = <a class="code" href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">SplineHandler</a>-&gt;GetEventSplines(SampleTitle, OscIndex, Mode, Etrue, *(<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[j].KinVar[0]), *(<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[j].KinVar[1]));</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    }</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> NSplines = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(EventSplines.size());</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="keywordflow">if</span>(NSplines == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> PointersBefore = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[j].total_weight_pointers.size());</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[j].total_weight_pointers.resize(PointersBefore + NSplines);</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160; </div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> spline = 0; spline &lt; NSplines; spline++) {</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      <span class="comment">//Event Splines indexed as: sample name, oscillation channel, syst, mode, etrue, var1, var2 (var2 is a dummy 0 for 1D splines)</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;      <a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[j].total_weight_pointers[PointersBefore+spline] = <a class="code" href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">SplineHandler</a>-&gt;retPointer(EventSplines[spline][0], EventSplines[spline][1],</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                                                                    EventSplines[spline][2], EventSplines[spline][3],</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                                                                    EventSplines[spline][4], EventSplines[spline][5],</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                                                                    EventSplines[spline][6]);</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    } <span class="comment">// end loop over splines</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  } <span class="comment">// end loop over events</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;}</div>
<div class="ttc" id="aFarDetectorCoreInfoStruct_8h_html_afc52c63bc2b15ae30444755579f5beb4"><div class="ttname"><a href="FarDetectorCoreInfoStruct_8h.html#afc52c63bc2b15ae30444755579f5beb4">GetOscChannel</a></div><div class="ttdeci">int GetOscChannel(const std::vector&lt; OscChannelInfo &gt; &amp;OscChannel, const int InitFlav, const int FinalFlav)</div><div class="ttdoc">KS: Get Osc Channel Index based on initial and final PDG codes.</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00028">FarDetectorCoreInfoStruct.h:28</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_a07ff6d6a15b24f94afc88a1b89779beb"><div class="ttname"><a href="MaCh3Logger_8h.html#a07ff6d6a15b24f94afc88a1b89779beb">MACH3LOG_CRITICAL</a></div><div class="ttdeci">#define MACH3LOG_CRITICAL</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00038">MaCh3Logger.h:38</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a17193b3fe2b44e6484f9eefda86f97dd"><div class="ttname"><a href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">SampleHandlerFD::SplineHandler</a></div><div class="ttdeci">std::unique_ptr&lt; BinnedSplineHandler &gt; SplineHandler</div><div class="ttdoc">Contains all your binned splines and handles the setup and the returning of weights from spline evalu...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00214">SampleHandlerFD.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a409908a58aae468475a482b3db7c9bea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a409908a58aae468475a482b3db7c9bea">&#9670;&nbsp;</a></span>FindNominalBinAndEdges()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::FindNominalBinAndEdges </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00836">836</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                                             {</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> event_i = 0; event_i &lt; <a class="code" href="classSampleHandlerBase.html#a6ceca02f83e878ef1aec6e54e7b2f331">GetNEvents</a>(); event_i++) {</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordtype">int</span> Sample = <a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[event_i].NominalSample;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> dim = <a class="code" href="classSampleHandlerFD.html#a768fdb89852db345ec267d30bd462cb2">GetNDim</a>(Sample);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[event_i].KinVar.resize(dim);</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[event_i].NomBin.resize(dim);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keyword">auto</span> SetNominalBin = [&amp;](<span class="keywordtype">int</span> bin, <span class="keywordtype">int</span> max_bins, <span class="keywordtype">int</span>&amp; out_bin) {</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      <span class="keywordflow">if</span> (bin &gt;= 0 &amp;&amp; bin &lt; max_bins) {</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        out_bin = bin;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        out_bin = <a class="code" href="namespaceM3.html#aadca64372617e10cf9fdf70d0b0eb23f">M3::UnderOverFlowBin</a>;  <span class="comment">// Out of bounds</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      }</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    };</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160; </div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="comment">// Find nominal bin for each dimension</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iDim = 0; iDim &lt; dim; iDim++) {</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      <a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[event_i].KinVar[iDim] = <a class="code" href="classSampleHandlerFD.html#a889f8aeb4ab9e6b6441dabcc484c91c2">GetPointerToKinematicParameter</a>(<a class="code" href="classSampleHandlerFD.html#a7f3923d1e2b39df2e1bf2348312925a6">GetKinVarName</a>(Sample, iDim), event_i);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      <span class="keywordflow">if</span> (std::isnan(*<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[event_i].KinVar[iDim]) || std::isinf(*<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[event_i].KinVar[iDim])) {</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Variable {} for sample {} and dimension {} is ill-defined and equal to {}&quot;</span>,</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                       <a class="code" href="classSampleHandlerFD.html#a7f3923d1e2b39df2e1bf2348312925a6">GetKinVarName</a>(Sample, iDim), <a class="code" href="classSampleHandlerFD.html#adfad2507ad845ad36fff3c82231a143c">GetSampleTitle</a>(Sample), dim, *<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[event_i].KinVar[iDim]);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      }</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> bin = <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;FindNominalBin(Sample, iDim, *<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[event_i].KinVar[iDim]);</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <span class="keywordtype">int</span> NBins_i = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetBinEdges(Sample, iDim).size() - 1);</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      SetNominalBin(bin, NBins_i, <a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[event_i].NomBin[iDim]);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    }</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a7f3923d1e2b39df2e1bf2348312925a6"><div class="ttname"><a href="classSampleHandlerFD.html#a7f3923d1e2b39df2e1bf2348312925a6">SampleHandlerFD::GetKinVarName</a></div><div class="ttdeci">std::string GetKinVarName(const int iSample, const int Dimension) const override</div><div class="ttdoc">Return Kinematic Variable name for specified sample and dimension for example &quot;Reconstructed_Neutrino...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l02020">SampleHandlerFD.cpp:2020</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a889f8aeb4ab9e6b6441dabcc484c91c2"><div class="ttname"><a href="classSampleHandlerFD.html#a889f8aeb4ab9e6b6441dabcc484c91c2">SampleHandlerFD::GetPointerToKinematicParameter</a></div><div class="ttdeci">virtual const double * GetPointerToKinematicParameter(std::string KinematicParamter, int iEvent)=0</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a968ebdb74da3d252803215da8cec387e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a968ebdb74da3d252803215da8cec387e">&#9670;&nbsp;</a></span>Get1DVarHist()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH1 * SampleHandlerFD::Get1DVarHist </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>EventSelectionVec</em> = <code>{}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>Axis</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>SubEventSelectionVec</em> = <code>{}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classSampleHandlerBase.html#a7e2aa3101b5f41d0fe6a08e2668bfc09">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01359">1359</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                                                                                                                        {</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;  <span class="comment">//DB Need to overwrite the Selection member variable so that IsEventSelected function operates correctly.</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;  <span class="comment">//   Consequently, store the selection cuts already saved in the sample, overwrite the Selection variable, then reset</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  <span class="keyword">auto</span> tmp_Selection = <a class="code" href="classSampleHandlerFD.html#a78079726d3e96cebfae3a036969e042e">ApplyTemporarySelection</a>(iSample, EventSelectionVec);</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160; </div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  <span class="comment">//DB Define the histogram which will be returned</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  TH1D* _h1DVar = <span class="keyword">nullptr</span>;;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  <span class="keywordflow">if</span> (Axis) {</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    _h1DVar = <span class="keyword">new</span> TH1D(<span class="stringliteral">&quot;&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,Axis-&gt;GetNbins(),Axis-&gt;GetXbins()-&gt;GetArray());</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    std::vector&lt;double&gt; xBinEdges = <a class="code" href="classSampleHandlerFD.html#a2cee961e07a80484fe568898f41e4965">ReturnKinematicParameterBinning</a>(iSample, ProjectionVar_Str);</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    _h1DVar = <span class="keyword">new</span> TH1D(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="keywordtype">int</span>(xBinEdges.size())-1, xBinEdges.data());</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  }</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  _h1DVar-&gt;GetXaxis()-&gt;SetTitle(ProjectionVar_Str.c_str());</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160; </div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#ad14d9728400a7b87f095aca00761b829">IsSubEventVarString</a>(ProjectionVar_Str)) {</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <a class="code" href="classSampleHandlerFD.html#ab1ac7cdcad889b0640b06e87da78e3b8">Fill1DSubEventHist</a>(iSample, _h1DVar, ProjectionVar_Str, SubEventSelectionVec, WeightStyle);</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <span class="comment">//DB Grab the associated enum with the argument string</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <span class="keywordtype">int</span> ProjectionVar_Int = <a class="code" href="classSampleHandlerFD.html#ae2769d593f34e8356b545af076818f89">ReturnKinematicParameterFromString</a>(ProjectionVar_Str);</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160; </div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <span class="comment">//DB Loop over all events</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iEvent = 0; iEvent &lt; <a class="code" href="classSampleHandlerBase.html#a6ceca02f83e878ef1aec6e54e7b2f331">GetNEvents</a>(); iEvent++) {</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> EventSample = <a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].NominalSample;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;      <span class="keywordflow">if</span>(EventSample != iSample) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#af67a9a10193e12526e3284d48f425185">IsEventSelected</a>(EventSample, iEvent)) {</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;        <span class="keywordtype">double</span> Weight = <a class="code" href="classSampleHandlerFD.html#a6831d91d5bcf1fb5723167736e0082ef">GetEventWeight</a>(iEvent);</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        <span class="keywordflow">if</span> (WeightStyle == 1) {</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;          Weight = 1.;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;        }</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        <span class="keywordtype">double</span> Var = <a class="code" href="classSampleHandlerFD.html#ad0f549802b5625871e11d86905989697">ReturnKinematicParameter</a>(ProjectionVar_Int, iEvent);</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;        _h1DVar-&gt;Fill(Var, Weight);</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      }</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    }</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;  }</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;  <span class="comment">//DB Reset the saved selection</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a07b3357278429dfe809d7d9d27682bf9">Selection</a> = tmp_Selection;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160; </div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;  <span class="keywordflow">return</span> _h1DVar;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a2cee961e07a80484fe568898f41e4965"><div class="ttname"><a href="classSampleHandlerFD.html#a2cee961e07a80484fe568898f41e4965">SampleHandlerFD::ReturnKinematicParameterBinning</a></div><div class="ttdeci">std::vector&lt; double &gt; ReturnKinematicParameterBinning(const int Sample, const std::string &amp;KinematicParameter) const override</div><div class="ttdoc">Return the binning used to draw a kinematic parameter.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01597">SampleHandlerFD.cpp:1597</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a78079726d3e96cebfae3a036969e042e"><div class="ttname"><a href="classSampleHandlerFD.html#a78079726d3e96cebfae3a036969e042e">SampleHandlerFD::ApplyTemporarySelection</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; KinematicCut &gt; &gt; ApplyTemporarySelection(const int iSample, const std::vector&lt; KinematicCut &gt; &amp;ExtraCuts)</div><div class="ttdoc">Temporarily extend Selection for a given sample with additional cuts. Returns the original Selection ...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01337">SampleHandlerFD.cpp:1337</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ab1ac7cdcad889b0640b06e87da78e3b8"><div class="ttname"><a href="classSampleHandlerFD.html#ab1ac7cdcad889b0640b06e87da78e3b8">SampleHandlerFD::Fill1DSubEventHist</a></div><div class="ttdeci">void Fill1DSubEventHist(const int iSample, TH1D *_h1DVar, const std::string &amp;ProjectionVar, const std::vector&lt; KinematicCut &gt; &amp;SubEventSelectionVec={}, int WeightStyle=0)</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01403">SampleHandlerFD.cpp:1403</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afa55768f84faef3f9f438d197dd46194"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa55768f84faef3f9f438d197dd46194">&#9670;&nbsp;</a></span>Get1DVarHistByModeAndChannel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH1 * SampleHandlerFD::Get1DVarHistByModeAndChannel </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVar_Str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kModeToFill</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kChannelToFill</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>Axis</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classSampleHandlerBase.html#a764b98b3c56f3bd04a279b0810b87a21">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01717">1717</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;                                                                       {</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;  <span class="keyword">auto</span> SelectionVec = <a class="code" href="classSampleHandlerFD.html#a8d9a0e8af47eee94ae9b535d9c7122d4">BuildModeChannelSelection</a>(iSample, kModeToFill, kChannelToFill);</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a968ebdb74da3d252803215da8cec387e">Get1DVarHist</a>(iSample, ProjectionVar_Str, SelectionVec, WeightStyle, Axis);</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a8d9a0e8af47eee94ae9b535d9c7122d4"><div class="ttname"><a href="classSampleHandlerFD.html#a8d9a0e8af47eee94ae9b535d9c7122d4">SampleHandlerFD::BuildModeChannelSelection</a></div><div class="ttdeci">std::vector&lt; KinematicCut &gt; BuildModeChannelSelection(const int iSample, const int kModeToFill, const int kChannelToFill) const</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01666">SampleHandlerFD.cpp:1666</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a968ebdb74da3d252803215da8cec387e"><div class="ttname"><a href="classSampleHandlerFD.html#a968ebdb74da3d252803215da8cec387e">SampleHandlerFD::Get1DVarHist</a></div><div class="ttdeci">TH1 * Get1DVarHist(const int iSample, const std::string &amp;ProjectionVar, const std::vector&lt; KinematicCut &gt; &amp;EventSelectionVec={}, int WeightStyle=0, TAxis *Axis=nullptr, const std::vector&lt; KinematicCut &gt; &amp;SubEventSelectionVec={}) override</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01359">SampleHandlerFD.cpp:1359</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9ae5d89712796bfe77f985656235c93b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ae5d89712796bfe77f985656235c93b">&#9670;&nbsp;</a></span>Get2DVarHist()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH2 * SampleHandlerFD::Get2DVarHist </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVarX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVarY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>EventSelectionVec</em> = <code>{}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>AxisX</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>AxisY</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>SubEventSelectionVec</em> = <code>{}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classSampleHandlerBase.html#a6198a3752b7965d7548efb708f0b7df1">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01431">1431</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;                                                                                          {</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  <span class="comment">//DB Need to overwrite the Selection member variable so that IsEventSelected function operates correctly.</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;  <span class="comment">//   Consequently, store the selection cuts already saved in the sample, overwrite the Selection variable, then reset</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  <span class="keyword">auto</span> tmp_Selection = <a class="code" href="classSampleHandlerFD.html#a78079726d3e96cebfae3a036969e042e">ApplyTemporarySelection</a>(iSample, EventSelectionVec);</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160; </div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  <span class="comment">//DB Define the histogram which will be returned</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;  TH2D* _h2DVar = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;  <span class="keywordflow">if</span> (AxisX &amp;&amp; AxisY) {</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    _h2DVar = <span class="keyword">new</span> TH2D(<span class="stringliteral">&quot;&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,AxisX-&gt;GetNbins(),AxisX-&gt;GetXbins()-&gt;GetArray(),AxisY-&gt;GetNbins(),AxisY-&gt;GetXbins()-&gt;GetArray());</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    std::vector&lt;double&gt; xBinEdges = <a class="code" href="classSampleHandlerFD.html#a2cee961e07a80484fe568898f41e4965">ReturnKinematicParameterBinning</a>(iSample, ProjectionVar_StrX);</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    std::vector&lt;double&gt; yBinEdges = <a class="code" href="classSampleHandlerFD.html#a2cee961e07a80484fe568898f41e4965">ReturnKinematicParameterBinning</a>(iSample, ProjectionVar_StrY);</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    _h2DVar = <span class="keyword">new</span> TH2D(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="keywordtype">int</span>(xBinEdges.size())-1, xBinEdges.data(), <span class="keywordtype">int</span>(yBinEdges.size())-1, yBinEdges.data());</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;  }</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  _h2DVar-&gt;GetXaxis()-&gt;SetTitle(ProjectionVar_StrX.c_str());</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;  _h2DVar-&gt;GetYaxis()-&gt;SetTitle(ProjectionVar_StrY.c_str());</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160; </div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;  <span class="keywordtype">bool</span> IsSubEventHist = <a class="code" href="classSampleHandlerFD.html#ad14d9728400a7b87f095aca00761b829">IsSubEventVarString</a>(ProjectionVar_StrX) || <a class="code" href="classSampleHandlerFD.html#ad14d9728400a7b87f095aca00761b829">IsSubEventVarString</a>(ProjectionVar_StrY);</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;  <span class="keywordflow">if</span> (IsSubEventHist) <a class="code" href="classSampleHandlerFD.html#a939d153567948b54843339bbfb77427f">Fill2DSubEventHist</a>(iSample, _h2DVar, ProjectionVar_StrX, ProjectionVar_StrY, SubEventSelectionVec, WeightStyle);</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="comment">//DB Grab the associated enum with the argument string</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <span class="keywordtype">int</span> ProjectionVar_IntX = <a class="code" href="classSampleHandlerFD.html#ae2769d593f34e8356b545af076818f89">ReturnKinematicParameterFromString</a>(ProjectionVar_StrX);</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    <span class="keywordtype">int</span> ProjectionVar_IntY = <a class="code" href="classSampleHandlerFD.html#ae2769d593f34e8356b545af076818f89">ReturnKinematicParameterFromString</a>(ProjectionVar_StrY);</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160; </div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="comment">//DB Loop over all events</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iEvent = 0; iEvent &lt; <a class="code" href="classSampleHandlerBase.html#a6ceca02f83e878ef1aec6e54e7b2f331">GetNEvents</a>(); iEvent++) {</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> EventSample = <a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].NominalSample;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      <span class="keywordflow">if</span>(EventSample != iSample) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#af67a9a10193e12526e3284d48f425185">IsEventSelected</a>(EventSample, iEvent)) {</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        <span class="keywordtype">double</span> Weight = <a class="code" href="classSampleHandlerFD.html#a6831d91d5bcf1fb5723167736e0082ef">GetEventWeight</a>(iEvent);</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        <span class="keywordflow">if</span> (WeightStyle == 1) {</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;          Weight = 1.;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        }</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        <span class="keywordtype">double</span> VarX = <a class="code" href="classSampleHandlerFD.html#ad0f549802b5625871e11d86905989697">ReturnKinematicParameter</a>(ProjectionVar_IntX, iEvent);</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;        <span class="keywordtype">double</span> VarY = <a class="code" href="classSampleHandlerFD.html#ad0f549802b5625871e11d86905989697">ReturnKinematicParameter</a>(ProjectionVar_IntY, iEvent);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        _h2DVar-&gt;Fill(VarX,VarY,Weight);</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;      }</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    }</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  }</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  <span class="comment">//DB Reset the saved selection</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a07b3357278429dfe809d7d9d27682bf9">Selection</a> = tmp_Selection;</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160; </div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  <span class="keywordflow">return</span> _h2DVar;</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a939d153567948b54843339bbfb77427f"><div class="ttname"><a href="classSampleHandlerFD.html#a939d153567948b54843339bbfb77427f">SampleHandlerFD::Fill2DSubEventHist</a></div><div class="ttdeci">void Fill2DSubEventHist(const int iSample, TH2D *_h2DVar, const std::string &amp;ProjectionVarX, const std::string &amp;ProjectionVarY, const std::vector&lt; KinematicCut &gt; &amp;SubEventSelectionVec={}, int WeightStyle=0)</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01483">SampleHandlerFD.cpp:1483</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a86394ef51d6bab1b9943f11774e99c23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86394ef51d6bab1b9943f11774e99c23">&#9670;&nbsp;</a></span>Get2DVarHistByModeAndChannel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH2 * SampleHandlerFD::Get2DVarHistByModeAndChannel </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVar_StrX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVar_StrY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kModeToFill</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kChannelToFill</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>AxisX</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>AxisY</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classSampleHandlerBase.html#ae2ae5fc7a84bce5c570a9a1aae0ba126">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01725">1725</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;                                                                                      {</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  <span class="keyword">auto</span> SelectionVec = <a class="code" href="classSampleHandlerFD.html#a8d9a0e8af47eee94ae9b535d9c7122d4">BuildModeChannelSelection</a>(iSample, kModeToFill, kChannelToFill);</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a9ae5d89712796bfe77f985656235c93b">Get2DVarHist</a>(iSample, ProjectionVar_StrX, ProjectionVar_StrY, SelectionVec, WeightStyle, AxisX,AxisY);</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a9ae5d89712796bfe77f985656235c93b"><div class="ttname"><a href="classSampleHandlerFD.html#a9ae5d89712796bfe77f985656235c93b">SampleHandlerFD::Get2DVarHist</a></div><div class="ttdeci">TH2 * Get2DVarHist(const int iSample, const std::string &amp;ProjectionVarX, const std::string &amp;ProjectionVarY, const std::vector&lt; KinematicCut &gt; &amp;EventSelectionVec={}, int WeightStyle=0, TAxis *AxisX=nullptr, TAxis *AxisY=nullptr, const std::vector&lt; KinematicCut &gt; &amp;SubEventSelectionVec={}) override</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01431">SampleHandlerFD.cpp:1431</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0c05593aae5be71f8a615b0dfe74296b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c05593aae5be71f8a615b0dfe74296b">&#9670;&nbsp;</a></span>GetArrayForSample()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; SampleHandlerFD::GetArrayForSample </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return a sub-array for a given sample. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l02030">2030</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;                                                                                                {</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;<span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> Start = <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetSampleStartBin(Sample);</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> End   = <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetSampleEndBin(Sample);</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160; </div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;  <span class="keywordflow">return</span> std::vector&lt;double&gt;(array + Start, array + End);</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3aec6cf33fee2dd2982955f995678e38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3aec6cf33fee2dd2982955f995678e38">&#9670;&nbsp;</a></span>GetBinningHandler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classBinningHandler.html">BinningHandler</a>* SampleHandlerFD::GetBinningHandler </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get pointer to binning handler. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00045">45</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>.get();}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5661f2accf6e80561699935f86ac9e08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5661f2accf6e80561699935f86ac9e08">&#9670;&nbsp;</a></span>GetDataArray() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleHandlerFD::GetDataArray </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return array storing data entries for every bin. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00162">162</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                                         {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">return</span> std::vector&lt;double&gt;(<a class="code" href="classSampleHandlerFD.html#a2b16ed4f91f2f37ff707ca048d8d6927">SampleHandlerFD_data</a>, <a class="code" href="classSampleHandlerFD.html#a2b16ed4f91f2f37ff707ca048d8d6927">SampleHandlerFD_data</a> + <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetNBins());</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a25d65d419a907d81850f6cfba43e3c06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25d65d419a907d81850f6cfba43e3c06">&#9670;&nbsp;</a></span>GetDataArray() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleHandlerFD::GetDataArray </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return array storing data entries for every bin. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00177">177</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                                                         {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a0c05593aae5be71f8a615b0dfe74296b">GetArrayForSample</a>(Sample, <a class="code" href="classSampleHandlerFD.html#a2b16ed4f91f2f37ff707ca048d8d6927">SampleHandlerFD_data</a>);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  }</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a0c05593aae5be71f8a615b0dfe74296b"><div class="ttname"><a href="classSampleHandlerFD.html#a0c05593aae5be71f8a615b0dfe74296b">SampleHandlerFD::GetArrayForSample</a></div><div class="ttdeci">std::vector&lt; double &gt; GetArrayForSample(const int Sample, const double *array) const</div><div class="ttdoc">Return a sub-array for a given sample.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l02030">SampleHandlerFD.cpp:2030</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac2fa527d43bfe7b5dccf767b2445fbb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2fa527d43bfe7b5dccf767b2445fbb0">&#9670;&nbsp;</a></span>GetDataHist() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH1 * SampleHandlerFD::GetDataHist </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get Data histogram. </p>

<p>Implements <a class="el" href="classSampleHandlerBase.html#ae30e9cf2ee9dfa805f9a87432558e600">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00916">916</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                                                  {</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].DataHist == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Can&#39;t access {} for {}Dimensions&quot;</span>, __func__, <a class="code" href="classSampleHandlerFD.html#a768fdb89852db345ec267d30bd462cb2">GetNDim</a>(Sample));</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  }</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].DataHist;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a634f708ba1d63e8709c6b4919c3fb1c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a634f708ba1d63e8709c6b4919c3fb1c5">&#9670;&nbsp;</a></span>GetDataHist() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TH1 * SampleHandlerFD::GetDataHist </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00926">926</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                                                         {</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <span class="keywordtype">int</span> Index = <a class="code" href="classSampleHandlerFD.html#ad83a84cec68b96cb50eaaf1a40f96edf">GetSampleIndex</a>(Sample);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#ac2fa527d43bfe7b5dccf767b2445fbb0">GetDataHist</a>(Index);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_ac2fa527d43bfe7b5dccf767b2445fbb0"><div class="ttname"><a href="classSampleHandlerFD.html#ac2fa527d43bfe7b5dccf767b2445fbb0">SampleHandlerFD::GetDataHist</a></div><div class="ttdeci">TH1 * GetDataHist(const int Sample) override</div><div class="ttdoc">Get Data histogram.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00916">SampleHandlerFD.cpp:916</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ad83a84cec68b96cb50eaaf1a40f96edf"><div class="ttname"><a href="classSampleHandlerFD.html#ad83a84cec68b96cb50eaaf1a40f96edf">SampleHandlerFD::GetSampleIndex</a></div><div class="ttdeci">int GetSampleIndex(const std::string &amp;SampleTitle) const</div><div class="ttdoc">Get index of sample based on name.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00868">SampleHandlerFD.cpp:868</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6831d91d5bcf1fb5723167736e0082ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6831d91d5bcf1fb5723167736e0082ef">&#9670;&nbsp;</a></span>GetEventWeight()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> SampleHandlerFD::GetEventWeight </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iEntry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>KS: </p><dl class="section warning"><dt>Warning</dt><dd>we have to here recalculate weight and cap because there is possibility weight wasn't calculated during FillArray because it didn't fulfil IsEventSelected</dd></dl>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01148">1148</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                                                          {</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <span class="comment">// Virtual by default does nothing, has to happen before CalcWeightTotal</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a1781ff483b5bae72103e9298109c4698">CalcWeightFunc</a>(iEntry);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160; </div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <span class="keyword">const</span> <a class="code" href="structEventInfo.html">EventInfo</a>* <a class="code" href="Core_8h.html#ab6a7e23420f0bcfb04f42f45f8283101">_restrict_</a> MCEvent = &amp;<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEntry];</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> totalweight = <a class="code" href="classSampleHandlerFD.html#aa1c7c8384fd383170aacf4d83af1b382">CalcWeightTotal</a>(MCEvent);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160; </div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  <span class="comment">//DB Catch negative total weights and skip any event with a negative weight. Previously we would set weight to zero and continue but that is inefficient</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  <span class="keywordflow">if</span> (totalweight &lt;= 0.){</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    totalweight = 0.;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  }</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  <span class="keywordflow">return</span> totalweight;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abcdcf3c5d75823742f6e0ca3fe3bed80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcdcf3c5d75823742f6e0ca3fe3bed80">&#9670;&nbsp;</a></span>GetFinalPDGFromFileName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="SampleStructs_8h.html#a0dfdd8cf84b8fa3495e9e5e520fe6cd2">NuPDG</a> SampleHandlerFD::GetFinalPDGFromFileName </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>FileName</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve the final neutrino PDG code associated with a given input file name. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00400">400</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a52a69295c2c47e621a5f2b2b1bd9f82e">FileToFinalPDGMap</a>.at(FileName);}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a52a69295c2c47e621a5f2b2b1bd9f82e"><div class="ttname"><a href="classSampleHandlerFD.html#a52a69295c2c47e621a5f2b2b1bd9f82e">SampleHandlerFD::FileToFinalPDGMap</a></div><div class="ttdeci">std::unordered_map&lt; std::string, NuPDG &gt; FileToFinalPDGMap</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00404">SampleHandlerFD.h:404</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a802e5b253f0b23d1e206ef9c0008301a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a802e5b253f0b23d1e206ef9c0008301a">&#9670;&nbsp;</a></span>GetFlavourName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::GetFlavourName </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iChannel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classSampleHandlerBase.html#a5ece7768a8c337d89f6841865b7e2ff9">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00095">95</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                                                                                 {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">if</span> (iChannel &lt; 0 || iChannel &gt; <a class="code" href="classSampleHandlerFD.html#aac276e3f10be081ce8e7f94df131490d">GetNOscChannels</a>(iSample)) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Invalid Channel Requested: {}&quot;</span>, iChannel);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__);      </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[iSample].OscChannels[iChannel].flavourName;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a26a50900fafed84dda7423907deea04b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26a50900fafed84dda7423907deea04b">&#9670;&nbsp;</a></span>GetInitPDGFromFileName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="SampleStructs_8h.html#a0dfdd8cf84b8fa3495e9e5e520fe6cd2">NuPDG</a> SampleHandlerFD::GetInitPDGFromFileName </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>FileName</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve the initial neutrino PDG code associated with a given input file name. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00398">398</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a251743beb6b3e6884fef871a8aef9156">FileToInitPDGMap</a>.at(FileName);}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a251743beb6b3e6884fef871a8aef9156"><div class="ttname"><a href="classSampleHandlerFD.html#a251743beb6b3e6884fef871a8aef9156">SampleHandlerFD::FileToInitPDGMap</a></div><div class="ttdeci">std::unordered_map&lt; std::string, NuPDG &gt; FileToInitPDGMap</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00403">SampleHandlerFD.h:403</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7f3923d1e2b39df2e1bf2348312925a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f3923d1e2b39df2e1bf2348312925a6">&#9670;&nbsp;</a></span>GetKinVarName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::GetKinVarName </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Dimension</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return Kinematic Variable name for specified sample and dimension for example "Reconstructed_Neutrino_Energy". </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iSample</td><td>Sample index </td></tr>
    <tr><td class="paramname">Dimension</td><td>Dimension index </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classSampleHandlerBase.html#a1e55d089cbc7f13fbe43308e654e723d">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l02020">2020</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;                                                                                     {</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;<span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;  <span class="keywordflow">if</span>(Dimension &gt; <a class="code" href="classSampleHandlerFD.html#a768fdb89852db345ec267d30bd462cb2">GetNDim</a>(iSample)) {</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Asking for dimension {}, while sample: {} only has {}&quot;</span>, Dimension, <a class="code" href="classSampleHandlerFD.html#adfad2507ad845ad36fff3c82231a143c">GetSampleTitle</a>(iSample), <a class="code" href="classSampleHandlerFD.html#a768fdb89852db345ec267d30bd462cb2">GetNDim</a>(iSample));</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;  }</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[iSample].VarStr[Dimension];</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a25b63e394dab02d0b2d278ff55642fd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25b63e394dab02d0b2d278ff55642fd9">&#9670;&nbsp;</a></span>GetLikelihood()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SampleHandlerFD::GetLikelihood </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>DB Multi-threaded GetLikelihood. </p>

<p>Implements <a class="el" href="classSampleHandlerBase.html#ac4cd44c594061bfc45da228220dcd950">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01233">1233</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                                            {</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  <span class="keywordtype">double</span> negLogL = 0.;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;<span class="preprocessor">  #pragma omp parallel for reduction(+:negLogL)</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idx = 0; idx &lt; <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetNBins(); ++idx)</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  {</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> DataVal = <a class="code" href="classSampleHandlerFD.html#a2b16ed4f91f2f37ff707ca048d8d6927">SampleHandlerFD_data</a>[idx];</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> MCPred = <a class="code" href="classSampleHandlerFD.html#a85415d4ac54a5aefe78e5ab4d7bdb769">SampleHandlerFD_array</a>[idx];</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> w2 = <a class="code" href="classSampleHandlerFD.html#af5c6a3701c6ac76a96886ff13300a53b">SampleHandlerFD_array_w2</a>[idx];</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160; </div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="comment">//KS: Calculate likelihood using Barlow-Beeston Poisson or even IceCube</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    negLogL += <a class="code" href="classSampleHandlerBase.html#a527307a4186e2eb61475ea975108aa65">GetTestStatLLH</a>(DataVal, MCPred, w2);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;  }</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  <span class="keywordflow">return</span> negLogL;</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerBase_html_a527307a4186e2eb61475ea975108aa65"><div class="ttname"><a href="classSampleHandlerBase.html#a527307a4186e2eb61475ea975108aa65">SampleHandlerBase::GetTestStatLLH</a></div><div class="ttdeci">double GetTestStatLLH(const double data, const double mc, const double w2) const</div><div class="ttdoc">Calculate test statistic for a single bin. Calculation depends on setting of fTestStatistic....</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8cpp_source.html#l00035">SampleHandlerBase.cpp:35</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a75a62e3bf834e17992f1ebda3836c300"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75a62e3bf834e17992f1ebda3836c300">&#9670;&nbsp;</a></span>GetMCArray() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleHandlerFD::GetMCArray </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return array storing MC entries for every bin. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00166">166</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                       {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">return</span> std::vector&lt;double&gt;(<a class="code" href="classSampleHandlerFD.html#a85415d4ac54a5aefe78e5ab4d7bdb769">SampleHandlerFD_array</a>, <a class="code" href="classSampleHandlerFD.html#a85415d4ac54a5aefe78e5ab4d7bdb769">SampleHandlerFD_array</a> + <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetNBins());</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1a251b02474ea694909fb1b631845a72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a251b02474ea694909fb1b631845a72">&#9670;&nbsp;</a></span>GetMCArray() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleHandlerFD::GetMCArray </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return array storing MC entries for every bin. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00181">181</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                                                       {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a0c05593aae5be71f8a615b0dfe74296b">GetArrayForSample</a>(Sample, <a class="code" href="classSampleHandlerFD.html#a85415d4ac54a5aefe78e5ab4d7bdb769">SampleHandlerFD_array</a>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aef4a66f22b067c8125af5fe799f5a804"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef4a66f22b067c8125af5fe799f5a804">&#9670;&nbsp;</a></span>GetMCHist() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH1 * SampleHandlerFD::GetMCHist </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get MC histogram. </p>

<p>Implements <a class="el" href="classSampleHandlerBase.html#a7a6f0525d4e4f941fc1af4709042add3">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00898">898</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                                                {</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a5eab24c8508cdd247c23b9bd9b3017b0">FillHist</a>(Sample, <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].MCHist, <a class="code" href="classSampleHandlerFD.html#a85415d4ac54a5aefe78e5ab4d7bdb769">SampleHandlerFD_array</a>);</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].MCHist == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Can&#39;t access {} for {}Dimensions&quot;</span>, __func__, <a class="code" href="classSampleHandlerFD.html#a768fdb89852db345ec267d30bd462cb2">GetNDim</a>(Sample));</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  }</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].MCHist;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae61790e0fab1b169050657272e17f4d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae61790e0fab1b169050657272e17f4d3">&#9670;&nbsp;</a></span>GetMCHist() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TH1 * SampleHandlerFD::GetMCHist </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00909">909</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                                                       {</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> Index = <a class="code" href="classSampleHandlerFD.html#ad83a84cec68b96cb50eaaf1a40f96edf">GetSampleIndex</a>(Sample);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#aef4a66f22b067c8125af5fe799f5a804">GetMCHist</a>(Index);</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_aef4a66f22b067c8125af5fe799f5a804"><div class="ttname"><a href="classSampleHandlerFD.html#aef4a66f22b067c8125af5fe799f5a804">SampleHandlerFD::GetMCHist</a></div><div class="ttdeci">TH1 * GetMCHist(const int Sample) override</div><div class="ttdoc">Get MC histogram.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00898">SampleHandlerFD.cpp:898</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac453c29b475060135d911e4c23d0cb48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac453c29b475060135d911e4c23d0cb48">&#9670;&nbsp;</a></span>GetModeHist1D()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH1* SampleHandlerFD::GetModeHist1D </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>style</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00128">128</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                                                                     {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#afa55768f84faef3f9f438d197dd46194">Get1DVarHistByModeAndChannel</a>(iSample, <a class="code" href="classSampleHandlerFD.html#a9aebf7da41ad6ddb87e3081a7f4763ec">GetXBinVarName</a>(iSample), m, s, style);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  }</div>
<div class="ttc" id="aclassSampleHandlerFD_html_afa55768f84faef3f9f438d197dd46194"><div class="ttname"><a href="classSampleHandlerFD.html#afa55768f84faef3f9f438d197dd46194">SampleHandlerFD::Get1DVarHistByModeAndChannel</a></div><div class="ttdeci">TH1 * Get1DVarHistByModeAndChannel(const int iSample, const std::string &amp;ProjectionVar_Str, int kModeToFill=-1, int kChannelToFill=-1, int WeightStyle=0, TAxis *Axis=nullptr) override</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01717">SampleHandlerFD.cpp:1717</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a386667b346c7937285076aadf1f7c0a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a386667b346c7937285076aadf1f7c0a9">&#9670;&nbsp;</a></span>GetModeHist2D()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH2* SampleHandlerFD::GetModeHist2D </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>style</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00131">131</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                                                     {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a86394ef51d6bab1b9943f11774e99c23">Get2DVarHistByModeAndChannel</a>(iSample, <a class="code" href="classSampleHandlerFD.html#a9aebf7da41ad6ddb87e3081a7f4763ec">GetXBinVarName</a>(iSample),<a class="code" href="classSampleHandlerFD.html#a69d66592696bee9e73f61649c681a573">GetYBinVarName</a>(iSample), m, s, style);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  }</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a86394ef51d6bab1b9943f11774e99c23"><div class="ttname"><a href="classSampleHandlerFD.html#a86394ef51d6bab1b9943f11774e99c23">SampleHandlerFD::Get2DVarHistByModeAndChannel</a></div><div class="ttdeci">TH2 * Get2DVarHistByModeAndChannel(const int iSample, const std::string &amp;ProjectionVar_StrX, const std::string &amp;ProjectionVar_StrY, int kModeToFill=-1, int kChannelToFill=-1, int WeightStyle=0, TAxis *AxisX=nullptr, TAxis *AxisY=nullptr) override</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01725">SampleHandlerFD.cpp:1725</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6101b46360ae54fe37dd1243f3f7f51e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6101b46360ae54fe37dd1243f3f7f51e">&#9670;&nbsp;</a></span>GetName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::GetName </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classSampleHandlerBase.html#adc0365a430cbe628f5ec63ef49bf6f5e">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01135">1135</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                                         {</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  <span class="comment">//ETA - extra safety to make sure SampleHandlerName is actually set</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  <span class="comment">// probably unnecessary due to the requirement for it to be in the yaml config</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#a9a7fccdf8392ee06495902fab60e9858">SampleHandlerName</a>.length() == 0) {</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;No sample name provided&quot;</span>);</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Please provide a SampleHandlerName in your configuration file: {}&quot;</span>, <a class="code" href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleManager</a>-&gt;GetFileName());</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  }</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a9a7fccdf8392ee06495902fab60e9858">SampleHandlerName</a>;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a768fdb89852db345ec267d30bd462cb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a768fdb89852db345ec267d30bd462cb2">&#9670;&nbsp;</a></span>GetNDim()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SampleHandlerFD::GetNDim </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>DB Function to differentiate 1D or 2D binning. </p>

<p>Implements <a class="el" href="classSampleHandlerBase.html#ae2eca1fb4ee3bc3a4852fce4d0abb5b3">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00033">33</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].nDimensions; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aac276e3f10be081ce8e7f94df131490d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac276e3f10be081ce8e7f94df131490d">&#9670;&nbsp;</a></span>GetNOscChannels()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SampleHandlerFD::GetNOscChannels </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classSampleHandlerBase.html#a9d9a63f16c4acc2ab7bdd39df77712d4">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00093">93</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;{<span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[iSample].OscChannels.size());};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9b4dc9d2c3c2a1509fe4fcfefefbb3af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b4dc9d2c3c2a1509fe4fcfefefbb3af">&#9670;&nbsp;</a></span>GetNuOscillatorPointers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> * SampleHandlerFD::GetNuOscillatorPointers </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iEvent</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01095">1095</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                                                                                {</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>* osc_w_pointer = &amp;<a class="code" href="namespaceM3.html#a8b0081813e8f5b1c946821be4f114bd5">M3::Unity</a>;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].isNC) {</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="keywordflow">if</span> (*<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].nupdg != *<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].nupdgUnosc) {</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;      osc_w_pointer = &amp;<a class="code" href="namespaceM3.html#aa4fe46050b3e557896f8698a75cabeb3">M3::Zero</a>;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;      osc_w_pointer = &amp;<a class="code" href="namespaceM3.html#a8b0081813e8f5b1c946821be4f114bd5">M3::Unity</a>;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    }</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="keywordtype">int</span> InitFlav = <a class="code" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a>;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="keywordtype">int</span> FinalFlav = <a class="code" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a>;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160; </div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    InitFlav =  <a class="code" href="namespaceMaCh3Utils.html#a6be7338cc227b739251d75b6ec3f4b6d">MaCh3Utils::PDGToNuOscillatorFlavour</a>((*<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].nupdgUnosc));</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    FinalFlav = <a class="code" href="namespaceMaCh3Utils.html#a6be7338cc227b739251d75b6ec3f4b6d">MaCh3Utils::PDGToNuOscillatorFlavour</a>((*<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].nupdg));</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160; </div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="keywordflow">if</span> (InitFlav == <a class="code" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a> || FinalFlav == <a class="code" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a>) {</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Something has gone wrong in the mapping between MCSamples.nutype and the enum used within NuOscillator&quot;</span>);</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;MCSamples.nupdgUnosc: {}&quot;</span>, (*<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].nupdgUnosc));</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;InitFlav: {}&quot;</span>, InitFlav);</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;MCSamples.nupdg: {}&quot;</span>, (*<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].nupdg));</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;FinalFlav: {}&quot;</span>, FinalFlav);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    }</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> Sample = <a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].NominalSample;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160; </div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> OscIndex = <a class="code" href="FarDetectorCoreInfoStruct_8h.html#afc52c63bc2b15ae30444755579f5beb4">GetOscChannel</a>(<a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].OscChannels, (*<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].nupdgUnosc), (*<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].nupdg));</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="comment">//Can only happen if truecz has been initialised within the experiment specific code</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <span class="keywordflow">if</span> (*(<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].rw_truecz) != <a class="code" href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a>) {</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      <span class="comment">//Atmospherics</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      osc_w_pointer = <a class="code" href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">Oscillator</a>-&gt;GetNuOscillatorPointers(Sample, OscIndex, InitFlav, FinalFlav, FLOAT_T(*(<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].rw_etru)), FLOAT_T(*(<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].rw_truecz)));</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      <span class="comment">//Beam</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      osc_w_pointer = <a class="code" href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">Oscillator</a>-&gt;GetNuOscillatorPointers(Sample, OscIndex, InitFlav, FinalFlav, FLOAT_T(*(<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].rw_etru)));</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    }</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  } <span class="comment">// end if NC</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  <span class="keywordflow">return</span> osc_w_pointer;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;}</div>
<div class="ttc" id="anamespaceM3_html_a8b0081813e8f5b1c946821be4f114bd5"><div class="ttname"><a href="namespaceM3.html#a8b0081813e8f5b1c946821be4f114bd5">M3::Unity</a></div><div class="ttdeci">constexpr static const float_t Unity</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00064">Core.h:64</a></div></div>
<div class="ttc" id="anamespaceM3_html_aa4fe46050b3e557896f8698a75cabeb3"><div class="ttname"><a href="namespaceM3.html#aa4fe46050b3e557896f8698a75cabeb3">M3::Zero</a></div><div class="ttdeci">constexpr static const float_t Zero</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00071">Core.h:71</a></div></div>
<div class="ttc" id="anamespaceM3_html_ac289df32a5b3b05c61a87cbac5702b25"><div class="ttname"><a href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a></div><div class="ttdeci">constexpr static const int _BAD_INT_</div><div class="ttdoc">Default value used for int initialisation.</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00055">Core.h:55</a></div></div>
<div class="ttc" id="anamespaceMaCh3Utils_html_a6be7338cc227b739251d75b6ec3f4b6d"><div class="ttname"><a href="namespaceMaCh3Utils.html#a6be7338cc227b739251d75b6ec3f4b6d">MaCh3Utils::PDGToNuOscillatorFlavour</a></div><div class="ttdeci">int PDGToNuOscillatorFlavour(const int NuPdg)</div><div class="ttdoc">Convert from PDG flavour to NuOscillator type beware that in the case of anti-neutrinos the NuOscilla...</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00783">SampleStructs.h:783</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a64100ff9107ef5ed40945063da3b6eda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64100ff9107ef5ed40945063da3b6eda">&#9670;&nbsp;</a></span>GetPointerToKinematicParameter() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual const double* SampleHandlerFD::GetPointerToKinematicParameter </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>KinematicVariable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iEvent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classPySampleHandlerFD.html#ae52e29c2be892338f4d7b6136529c2b5">PySampleHandlerFD</a>.</p>

</div>
</div>
<a id="a889f8aeb4ab9e6b6441dabcc484c91c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a889f8aeb4ab9e6b6441dabcc484c91c2">&#9670;&nbsp;</a></span>GetPointerToKinematicParameter() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual const double* SampleHandlerFD::GetPointerToKinematicParameter </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>KinematicParamter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iEvent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classPySampleHandlerFD.html#a0d4d12ac851b743d8398632635e237bc">PySampleHandlerFD</a>.</p>

</div>
</div>
<a id="a57a1fbb900f450168181af14d1336a21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57a1fbb900f450168181af14d1336a21">&#9670;&nbsp;</a></span>GetPointerToOscChannel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double * SampleHandlerFD::GetPointerToOscChannel </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iEvent</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get pointer to oscillation channel associated with given event. Osc channel is const. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01958">1958</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;                                                                            {</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;  <span class="keyword">auto</span>&amp; OscillationChannels = <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].NominalSample].OscChannels;</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> Channel = <a class="code" href="FarDetectorCoreInfoStruct_8h.html#afc52c63bc2b15ae30444755579f5beb4">GetOscChannel</a>(OscillationChannels, (*<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].nupdgUnosc), (*<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].nupdg));</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160; </div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;  <span class="keywordflow">return</span> &amp;(OscillationChannels[Channel].ChannelIndex);</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad83a84cec68b96cb50eaaf1a40f96edf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad83a84cec68b96cb50eaaf1a40f96edf">&#9670;&nbsp;</a></span>GetSampleIndex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SampleHandlerFD::GetSampleIndex </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>SampleTitle</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get index of sample based on name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">SampleTitle</td><td>The title of the sample to search for. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00868">868</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                                                                      {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a> iSample = 0; iSample &lt; <a class="code" href="classSampleHandlerBase.html#aa7a13af22c2314c718fb6438d493d3d1">nSamples</a>; ++iSample) {</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordflow">if</span> (SampleTitle == <a class="code" href="classSampleHandlerFD.html#adfad2507ad845ad36fff3c82231a143c">GetSampleTitle</a>(iSample)) {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      <span class="keywordflow">return</span> iSample;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    }</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  }</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Sample name not found: {}&quot;</span>, SampleTitle);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;}</div>
<div class="ttc" id="anamespaceM3_html_adb59b8ecdc4e1b2d5d4c826a13aa7463"><div class="ttname"><a href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a></div><div class="ttdeci">int int_t</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00038">Core.h:38</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaac2deb8881a00c85951a3e8a6653393"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaac2deb8881a00c85951a3e8a6653393">&#9670;&nbsp;</a></span>GetSampleLikelihood()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SampleHandlerFD::GetSampleLikelihood </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>isample</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get likelihood for single sample. </p>

<p>Implements <a class="el" href="classSampleHandlerBase.html#a60ce18ee8d7adbc78b9be1269f081aa3">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01211">1211</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                                                                   {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> Start = <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetSampleStartBin(isample);</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> End = <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetSampleEndBin(isample);</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160; </div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  <span class="keywordtype">double</span> negLogL = 0.;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="preprocessor">  #pragma omp parallel for reduction(+:negLogL)</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idx = Start; idx &lt; End; ++idx)</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;  {</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> DataVal = <a class="code" href="classSampleHandlerFD.html#a2b16ed4f91f2f37ff707ca048d8d6927">SampleHandlerFD_data</a>[idx];</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> MCPred = <a class="code" href="classSampleHandlerFD.html#a85415d4ac54a5aefe78e5ab4d7bdb769">SampleHandlerFD_array</a>[idx];</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> w2 = <a class="code" href="classSampleHandlerFD.html#af5c6a3701c6ac76a96886ff13300a53b">SampleHandlerFD_array_w2</a>[idx];</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160; </div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="comment">//KS: Calculate likelihood using Barlow-Beeston Poisson or even IceCube</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    negLogL += <a class="code" href="classSampleHandlerBase.html#a527307a4186e2eb61475ea975108aa65">GetTestStatLLH</a>(DataVal, MCPred, w2);</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;  }</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  <span class="keywordflow">return</span> negLogL;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="adfad2507ad845ad36fff3c82231a143c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfad2507ad845ad36fff3c82231a143c">&#9670;&nbsp;</a></span>GetSampleTitle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::GetSampleTitle </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classSampleHandlerBase.html#ad3df6900450be4bbb05453e3b166e09e">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00035">35</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].SampleTitle;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8ef4127001f81924d2e27e84283c7114"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ef4127001f81924d2e27e84283c7114">&#9670;&nbsp;</a></span>GetW2Array() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleHandlerFD::GetW2Array </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return array storing W2 entries for every bin. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00170">170</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                       {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">return</span> std::vector&lt;double&gt;(<a class="code" href="classSampleHandlerFD.html#af5c6a3701c6ac76a96886ff13300a53b">SampleHandlerFD_array_w2</a>, <a class="code" href="classSampleHandlerFD.html#af5c6a3701c6ac76a96886ff13300a53b">SampleHandlerFD_array_w2</a> + <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetNBins());</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5885bd4f3fa06560a9536163d8f29627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5885bd4f3fa06560a9536163d8f29627">&#9670;&nbsp;</a></span>GetW2Array() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleHandlerFD::GetW2Array </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return array storing W2 entries for single sample. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00185">185</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                                                       {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a0c05593aae5be71f8a615b0dfe74296b">GetArrayForSample</a>(Sample, <a class="code" href="classSampleHandlerFD.html#af5c6a3701c6ac76a96886ff13300a53b">SampleHandlerFD_array_w2</a>);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9a47c08f11d5019f5f237cddd279ef9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a47c08f11d5019f5f237cddd279ef9c">&#9670;&nbsp;</a></span>GetW2Hist() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH1 * SampleHandlerFD::GetW2Hist </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get W2 histogram. </p>

<p>Implements <a class="el" href="classSampleHandlerBase.html#a5ea53e5e6adb5b4e6281a3d1ce910c3a">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00880">880</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                                                {</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a5eab24c8508cdd247c23b9bd9b3017b0">FillHist</a>(Sample, <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].W2Hist, <a class="code" href="classSampleHandlerFD.html#af5c6a3701c6ac76a96886ff13300a53b">SampleHandlerFD_array_w2</a>);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].W2Hist == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Can&#39;t access {} for {}Dimensions&quot;</span>, __func__, <a class="code" href="classSampleHandlerFD.html#a768fdb89852db345ec267d30bd462cb2">GetNDim</a>(Sample));</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  }</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].W2Hist;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a126596e06b0282f8c2e8ec2806b47aaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a126596e06b0282f8c2e8ec2806b47aaa">&#9670;&nbsp;</a></span>GetW2Hist() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TH1 * SampleHandlerFD::GetW2Hist </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00891">891</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                                                       {</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> Index = <a class="code" href="classSampleHandlerFD.html#ad83a84cec68b96cb50eaaf1a40f96edf">GetSampleIndex</a>(Sample);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a9a47c08f11d5019f5f237cddd279ef9c">GetW2Hist</a>(Index);</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a9a47c08f11d5019f5f237cddd279ef9c"><div class="ttname"><a href="classSampleHandlerFD.html#a9a47c08f11d5019f5f237cddd279ef9c">SampleHandlerFD::GetW2Hist</a></div><div class="ttdeci">TH1 * GetW2Hist(const int Sample) override</div><div class="ttdoc">Get W2 histogram.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00880">SampleHandlerFD.cpp:880</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9aebf7da41ad6ddb87e3081a7f4763ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9aebf7da41ad6ddb87e3081a7f4763ec">&#9670;&nbsp;</a></span>GetXBinVarName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::GetXBinVarName </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00042">42</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a7f3923d1e2b39df2e1bf2348312925a6">GetKinVarName</a>(Sample, 0);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a69d66592696bee9e73f61649c681a573"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69d66592696bee9e73f61649c681a573">&#9670;&nbsp;</a></span>GetYBinVarName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::GetYBinVarName </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00043">43</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a7f3923d1e2b39df2e1bf2348312925a6">GetKinVarName</a>(Sample, 1);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a09cbb146872131227838a06581103c33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09cbb146872131227838a06581103c33">&#9670;&nbsp;</a></span>Init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void SampleHandlerFD::Init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialise any variables that your experiment specific SampleHandler needs. </p>

<p>Implemented in <a class="el" href="classPySampleHandlerFD.html#a3e39054bb83ce3dfe7a9492e0bec3500">PySampleHandlerFD</a>.</p>

</div>
</div>
<a id="a74209f7f52f81dd0663997e63d49d4e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74209f7f52f81dd0663997e63d49d4e1">&#9670;&nbsp;</a></span>Initialise()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::Initialise </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function which does a lot of the lifting regarding the workflow in creating different MC objects. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00162">162</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                                 {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  TStopwatch clock;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  clock.Start();</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="comment">//First grab all the information from your sample config via your manager</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a15a8239722140a814fea0a3d008f97ee">ReadConfig</a>();</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="comment">//Now initialise all the variables you will need</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a09cbb146872131227838a06581103c33">Init</a>();</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <a class="code" href="classSampleHandlerBase.html#ab497b52d94868283a8a7cedbd1a4d777">nEvents</a> = <a class="code" href="classSampleHandlerFD.html#a330f801dfd7c0d14326048e93c5a51ae">SetupExperimentMC</a>();</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>.resize(<a class="code" href="classSampleHandlerBase.html#ab497b52d94868283a8a7cedbd1a4d777">nEvents</a>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a8e112b4f306f7b792da77f6299535c1b">SetupFDMC</a>();</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;=============================================&quot;</span>);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Total number of events is: {}&quot;</span>, <a class="code" href="classSampleHandlerBase.html#a6ceca02f83e878ef1aec6e54e7b2f331">GetNEvents</a>());</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keyword">auto</span> OscParams = <a class="code" href="classSampleHandlerFD.html#a1db89c4df22a237b1cb26a2b55ee0866">ParHandler</a>-&gt;<a class="code" href="classParameterHandlerGeneric.html#af23d9cf44cd74cd00db919880d4ca913">GetOscParsFromSampleName</a>(<a class="code" href="classSampleHandlerFD.html#a9a7fccdf8392ee06495902fab60e9858">SampleHandlerName</a>);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordflow">if</span> (OscParams.size() &gt; 0) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Setting up NuOscillator..&quot;</span>);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">Oscillator</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;You have passed an OscillatorBase object through the constructor of a SampleHandlerFD object - this will be used for all oscillation channels&quot;</span>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">Oscillator</a>-&gt;isEqualBinningPerOscChannel() != <span class="keyword">true</span>) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Trying to run shared NuOscillator without EqualBinningPerOscChannel, this will not work&quot;</span>);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keywordflow">if</span>(OscParams.size() != <a class="code" href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">Oscillator</a>-&gt;GetOscParamsSize()){</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;SampleHandler {} has {} osc params, while shared NuOsc has {} osc params&quot;</span>, <a class="code" href="classSampleHandlerFD.html#a6101b46360ae54fe37dd1243f3f7f51e">GetName</a>(),</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                       OscParams.size(), <a class="code" href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">Oscillator</a>-&gt;GetOscParamsSize());</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;This indicate misconfiguration in your Osc yaml&quot;</span>);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <a class="code" href="classSampleHandlerFD.html#a9fe790616b56940869c438822a79b1de">InitialiseNuOscillatorObjects</a>();</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <a class="code" href="classSampleHandlerFD.html#ae4bcbd508ec8d14d36f32911e12af1e9">SetupNuOscillatorPointers</a>();</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  } <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Didn&#39;t find any oscillation params, thus will not enable oscillations&quot;</span>);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="YamlHelper_8h.html#ad2340a340fd6649a6d220abc16d4757b">CheckNodeExists</a>(<a class="code" href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleManager</a>-&gt;raw(), <span class="stringliteral">&quot;NuOsc&quot;</span>)){</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;However config for SampleHandler {} has &#39;NuOsc&#39; field&quot;</span>, <a class="code" href="classSampleHandlerFD.html#a6101b46360ae54fe37dd1243f3f7f51e">GetName</a>());</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;This may indicate misconfiguration&quot;</span>);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Either remove &#39;NuOsc&#39; field from SampleHandler config or check your model.yaml and include oscillation for sample&quot;</span>);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Setting up Sample Binning..&quot;</span>);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <a class="code" href="classSampleHandlerFD.html#aa5fed299058818825839921541e99617">SetBinning</a>();</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Setting up Splines..&quot;</span>);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a1a984c564107c7207a2611d0bf67d9cc">SetupSplines</a>();</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Setting up Normalisation Pointers..&quot;</span>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a5fa55fd1e82f8c4fccd5cd77b814f86a">SetupNormParameters</a>();</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Setting up Functional Pointers..&quot;</span>);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <a class="code" href="classSampleHandlerFD.html#aed15ee1f6209f26e55bb8e53108a9c6a">SetupFunctionalParameters</a>();</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Setting up Additional Weight Pointers..&quot;</span>);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <a class="code" href="classSampleHandlerFD.html#afbbc56bf8988bb6bf80c5f382f0b603b">AddAdditionalWeightPointers</a>();</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Setting up Kinematic Map..&quot;</span>);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a61a1e9bbc4f812704278bf655d0d0ae2">SetupKinematicMap</a>();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  clock.Stop();</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Finished loading MC for {}, it took {:.2f}s to finish&quot;</span>, <a class="code" href="classSampleHandlerFD.html#a6101b46360ae54fe37dd1243f3f7f51e">GetName</a>(), clock.RealTime());</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;=======================================================&quot;</span>);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;}</div>
<div class="ttc" id="aYamlHelper_8h_html_ad2340a340fd6649a6d220abc16d4757b"><div class="ttname"><a href="YamlHelper_8h.html#ad2340a340fd6649a6d220abc16d4757b">CheckNodeExists</a></div><div class="ttdeci">bool CheckNodeExists(const YAML::Node &amp;node, Args... args)</div><div class="ttdoc">KS: Wrapper function to call the recursive helper.</div><div class="ttdef"><b>Definition:</b> <a href="YamlHelper_8h_source.html#l00060">YamlHelper.h:60</a></div></div>
<div class="ttc" id="aclassParameterHandlerGeneric_html_af23d9cf44cd74cd00db919880d4ca913"><div class="ttname"><a href="classParameterHandlerGeneric.html#af23d9cf44cd74cd00db919880d4ca913">ParameterHandlerGeneric::GetOscParsFromSampleName</a></div><div class="ttdeci">std::vector&lt; const double * &gt; GetOscParsFromSampleName(const std::string &amp;SampleName)</div><div class="ttdoc">Get pointers to Osc params from Sample name.</div><div class="ttdef"><b>Definition:</b> <a href="ParameterHandlerGeneric_8cpp_source.html#l00792">ParameterHandlerGeneric.cpp:792</a></div></div>
<div class="ttc" id="aclassSampleHandlerBase_html_ab497b52d94868283a8a7cedbd1a4d777"><div class="ttname"><a href="classSampleHandlerBase.html#ab497b52d94868283a8a7cedbd1a4d777">SampleHandlerBase::nEvents</a></div><div class="ttdeci">unsigned int nEvents</div><div class="ttdoc">Number of MC events are there.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00213">SampleHandlerBase.h:213</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a09cbb146872131227838a06581103c33"><div class="ttname"><a href="classSampleHandlerFD.html#a09cbb146872131227838a06581103c33">SampleHandlerFD::Init</a></div><div class="ttdeci">virtual void Init()=0</div><div class="ttdoc">Initialise any variables that your experiment specific SampleHandler needs.</div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a15a8239722140a814fea0a3d008f97ee"><div class="ttname"><a href="classSampleHandlerFD.html#a15a8239722140a814fea0a3d008f97ee">SampleHandlerFD::ReadConfig</a></div><div class="ttdeci">void ReadConfig()</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00058">SampleHandlerFD.cpp:58</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a1a984c564107c7207a2611d0bf67d9cc"><div class="ttname"><a href="classSampleHandlerFD.html#a1a984c564107c7207a2611d0bf67d9cc">SampleHandlerFD::SetupSplines</a></div><div class="ttdeci">virtual void SetupSplines()=0</div><div class="ttdoc">initialise your splineXX object and then use InitialiseSplineObject to conviently setup everything up</div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a330f801dfd7c0d14326048e93c5a51ae"><div class="ttname"><a href="classSampleHandlerFD.html#a330f801dfd7c0d14326048e93c5a51ae">SampleHandlerFD::SetupExperimentMC</a></div><div class="ttdeci">virtual int SetupExperimentMC()=0</div><div class="ttdoc">Experiment specific setup, returns the number of events which were loaded.</div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a5fa55fd1e82f8c4fccd5cd77b814f86a"><div class="ttname"><a href="classSampleHandlerFD.html#a5fa55fd1e82f8c4fccd5cd77b814f86a">SampleHandlerFD::SetupNormParameters</a></div><div class="ttdeci">void SetupNormParameters()</div><div class="ttdoc">Setup the norm parameters by assigning each event with bin.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00610">SampleHandlerFD.cpp:610</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a6101b46360ae54fe37dd1243f3f7f51e"><div class="ttname"><a href="classSampleHandlerFD.html#a6101b46360ae54fe37dd1243f3f7f51e">SampleHandlerFD::GetName</a></div><div class="ttdeci">std::string GetName() const override</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01135">SampleHandlerFD.cpp:1135</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a61a1e9bbc4f812704278bf655d0d0ae2"><div class="ttname"><a href="classSampleHandlerFD.html#a61a1e9bbc4f812704278bf655d0d0ae2">SampleHandlerFD::SetupKinematicMap</a></div><div class="ttdeci">void SetupKinematicMap()</div><div class="ttdoc">Ensure Kinematic Map is setup and make sure it is initialised correctly.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00226">SampleHandlerFD.cpp:226</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a8e112b4f306f7b792da77f6299535c1b"><div class="ttname"><a href="classSampleHandlerFD.html#a8e112b4f306f7b792da77f6299535c1b">SampleHandlerFD::SetupFDMC</a></div><div class="ttdeci">virtual void SetupFDMC()=0</div><div class="ttdoc">Function which translates experiment struct into core struct.</div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a9fe790616b56940869c438822a79b1de"><div class="ttname"><a href="classSampleHandlerFD.html#a9fe790616b56940869c438822a79b1de">SampleHandlerFD::InitialiseNuOscillatorObjects</a></div><div class="ttdeci">void InitialiseNuOscillatorObjects()</div><div class="ttdoc">including Dan's magic NuOscillator</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01017">SampleHandlerFD.cpp:1017</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_aa5fed299058818825839921541e99617"><div class="ttname"><a href="classSampleHandlerFD.html#aa5fed299058818825839921541e99617">SampleHandlerFD::SetBinning</a></div><div class="ttdeci">void SetBinning()</div><div class="ttdoc">set the binning for 2D sample used for the likelihood calculation</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00735">SampleHandlerFD.cpp:735</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ae4bcbd508ec8d14d36f32911e12af1e9"><div class="ttname"><a href="classSampleHandlerFD.html#ae4bcbd508ec8d14d36f32911e12af1e9">SampleHandlerFD::SetupNuOscillatorPointers</a></div><div class="ttdeci">void SetupNuOscillatorPointers()</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01078">SampleHandlerFD.cpp:1078</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_aed15ee1f6209f26e55bb8e53108a9c6a"><div class="ttname"><a href="classSampleHandlerFD.html#aed15ee1f6209f26e55bb8e53108a9c6a">SampleHandlerFD::SetupFunctionalParameters</a></div><div class="ttdeci">virtual void SetupFunctionalParameters()</div><div class="ttdoc">ETA - a function to setup and pass values to functional parameters where you need to pass a value to ...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00500">SampleHandlerFD.cpp:500</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_afbbc56bf8988bb6bf80c5f382f0b603b"><div class="ttname"><a href="classSampleHandlerFD.html#afbbc56bf8988bb6bf80c5f382f0b603b">SampleHandlerFD::AddAdditionalWeightPointers</a></div><div class="ttdeci">virtual void AddAdditionalWeightPointers()=0</div><div class="ttdoc">DB Function to determine which weights apply to which types of samples.</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9fe790616b56940869c438822a79b1de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fe790616b56940869c438822a79b1de">&#9670;&nbsp;</a></span>InitialiseNuOscillatorObjects()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::InitialiseNuOscillatorObjects </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>including Dan's magic NuOscillator </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01017">1017</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                                                    {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <span class="keyword">auto</span> NuOscillatorConfigFile = Get&lt;std::string&gt;(<a class="code" href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;NuOsc&quot;</span>][<span class="stringliteral">&quot;NuOscConfigFile&quot;</span>], __FILE__ , __LINE__);</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  <span class="keyword">auto</span> EqualBinningPerOscChannel = Get&lt;bool&gt;(<a class="code" href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;NuOsc&quot;</span>][<span class="stringliteral">&quot;EqualBinningPerOscChannel&quot;</span>], __FILE__ , __LINE__);</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160; </div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <span class="comment">// TN override the sample setting if not using binned oscillation</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  <span class="keywordflow">if</span> (EqualBinningPerOscChannel) {</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="keywordflow">if</span> (YAML::LoadFile(NuOscillatorConfigFile)[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;CalculationType&quot;</span>].as&lt;std::string&gt;() == <span class="stringliteral">&quot;Unbinned&quot;</span>) {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Tried using EqualBinningPerOscChannel while using Unbinned oscillation calculation, changing EqualBinningPerOscChannel to false&quot;</span>);</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;      EqualBinningPerOscChannel = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    }</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  }</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  std::vector&lt;const double*&gt; OscParams = <a class="code" href="classSampleHandlerFD.html#a1db89c4df22a237b1cb26a2b55ee0866">ParHandler</a>-&gt;<a class="code" href="classParameterHandlerGeneric.html#af23d9cf44cd74cd00db919880d4ca913">GetOscParsFromSampleName</a>(<a class="code" href="classSampleHandlerFD.html#a9a7fccdf8392ee06495902fab60e9858">SampleHandlerName</a>);</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <span class="keywordflow">if</span> (OscParams.empty()) {</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;OscParams is empty for sample &#39;{}&#39;.&quot;</span>, <a class="code" href="classSampleHandlerFD.html#a6101b46360ae54fe37dd1243f3f7f51e">GetName</a>());</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;This likely indicates an error in your oscillation YAML configuration.&quot;</span>);</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  }</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  <a class="code" href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">Oscillator</a> = std::make_shared&lt;OscillationHandler&gt;(NuOscillatorConfigFile, EqualBinningPerOscChannel, OscParams, <a class="code" href="classSampleHandlerFD.html#aac276e3f10be081ce8e7f94df131490d">GetNOscChannels</a>(0));</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  <span class="comment">// Add samples only if we don&#39;t use same binning</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  <span class="keywordflow">if</span>(!EqualBinningPerOscChannel) {</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <span class="comment">// KS: Start from 1 because sample 0 already added</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iSample = 1; iSample &lt; <a class="code" href="classSampleHandlerBase.html#ac4b73a8841ff9bab2fb08b578ad4137f">GetNsamples</a>(); iSample++) {</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      <a class="code" href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">Oscillator</a>-&gt;AddSample(NuOscillatorConfigFile, <a class="code" href="classSampleHandlerFD.html#aac276e3f10be081ce8e7f94df131490d">GetNOscChannels</a>(iSample));</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    }</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iSample = 0; iSample &lt; <a class="code" href="classSampleHandlerBase.html#ac4b73a8841ff9bab2fb08b578ad4137f">GetNsamples</a>(); iSample++) {</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iChannel = 0; iChannel &lt; <a class="code" href="classSampleHandlerFD.html#aac276e3f10be081ce8e7f94df131490d">GetNOscChannels</a>(iSample); iChannel++) {</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        std::vector&lt;M3::float_t&gt; EnergyArray;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        std::vector&lt;M3::float_t&gt; CosineZArray;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160; </div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iEvent = 0; iEvent &lt; <a class="code" href="classSampleHandlerBase.html#a6ceca02f83e878ef1aec6e54e7b2f331">GetNEvents</a>(); iEvent++) {</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].NominalSample != iSample) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;          <span class="comment">// KS: This is bit weird but we basically loop over all events and push to vector only these which are part of a given OscChannel</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> Channel = <a class="code" href="FarDetectorCoreInfoStruct_8h.html#afc52c63bc2b15ae30444755579f5beb4">GetOscChannel</a>(<a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].NominalSample].OscChannels, (*<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].nupdgUnosc), (*<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].nupdg));</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;          <span class="comment">//DB Remove NC events from the arrays which are handed to the NuOscillator objects</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].isNC &amp;&amp; Channel == iChannel) {</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;            EnergyArray.push_back(<a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>(*(<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].rw_etru)));</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;          }</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        }</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        std::sort(EnergyArray.begin(),EnergyArray.end());</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160; </div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <span class="comment">//============================================================================</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        <span class="comment">//DB Atmospheric only part, can only happen if truecz has been initialised within the experiment specific code</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        <span class="keywordflow">if</span> (*(<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[0].rw_truecz) != <a class="code" href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a>) {</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iEvent = 0; iEvent &lt; <a class="code" href="classSampleHandlerBase.html#a6ceca02f83e878ef1aec6e54e7b2f331">GetNEvents</a>(); iEvent++) {</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].NominalSample != iSample) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            <span class="comment">// KS: This is bit weird but we basically loop over all events and push to vector only these which are part of a given OscChannel</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> Channel = <a class="code" href="FarDetectorCoreInfoStruct_8h.html#afc52c63bc2b15ae30444755579f5beb4">GetOscChannel</a>(<a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].NominalSample].OscChannels, (*<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].nupdgUnosc), (*<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].nupdg));</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;            <span class="comment">//DB Remove NC events from the arrays which are handed to the NuOscillator objects</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].isNC &amp;&amp; Channel == iChannel) {</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;              CosineZArray.push_back(<a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>(*(<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].rw_truecz)));</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;            }</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;          }</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;          std::sort(CosineZArray.begin(),CosineZArray.end());</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        }</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        <a class="code" href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">Oscillator</a>-&gt;SetOscillatorBinning(iSample, iChannel, EnergyArray, CosineZArray);</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      } <span class="comment">// end loop over channels</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    } <span class="comment">// end loop over samples</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  }</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerBase_html_ac4b73a8841ff9bab2fb08b578ad4137f"><div class="ttname"><a href="classSampleHandlerBase.html#ac4b73a8841ff9bab2fb08b578ad4137f">SampleHandlerBase::GetNsamples</a></div><div class="ttdeci">virtual M3::int_t GetNsamples()</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00034">SampleHandlerBase.h:34</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2918509fadc1dac47d423f161b619cc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2918509fadc1dac47d423f161b619cc4">&#9670;&nbsp;</a></span>InitialiseSplineObject()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::InitialiseSplineObject </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01297">1297</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                                             {</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <span class="keywordtype">bool</span> LoadSplineFile = GetFromManager&lt;bool&gt;(<a class="code" href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;InputFiles&quot;</span>][<span class="stringliteral">&quot;LoadSplineFile&quot;</span>], <span class="keyword">false</span>, __FILE__, __LINE__);</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  <span class="keywordtype">bool</span> PrepSplineFile = GetFromManager&lt;bool&gt;(<a class="code" href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;InputFiles&quot;</span>][<span class="stringliteral">&quot;PrepSplineFile&quot;</span>], <span class="keyword">false</span>, __FILE__, __LINE__);</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  <span class="keyword">auto</span> SplineFileName = GetFromManager&lt;std::string&gt;(<a class="code" href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;InputFiles&quot;</span>][<span class="stringliteral">&quot;SplineFileName&quot;</span>],</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                                                    (<a class="code" href="classSampleHandlerFD.html#a9a7fccdf8392ee06495902fab60e9858">SampleHandlerName</a> + <span class="stringliteral">&quot;_SplineFile.root&quot;</span>), __FILE__, __LINE__);</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  <span class="keywordflow">if</span>(!LoadSplineFile) {</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iSample = 0; iSample &lt; <a class="code" href="classSampleHandlerBase.html#ac4b73a8841ff9bab2fb08b578ad4137f">GetNsamples</a>(); iSample++) {</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      std::vector&lt;std::string&gt; spline_filepaths = <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[iSample].spline_files;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160; </div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;      <span class="comment">//Keep a track of the spline variables</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      std::vector&lt;std::string&gt; SplineVarNames = {<span class="stringliteral">&quot;TrueNeutrinoEnergy&quot;</span>};</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#a768fdb89852db345ec267d30bd462cb2">GetNDim</a>(iSample) == 1) {</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        SplineVarNames.push_back(<a class="code" href="classSampleHandlerFD.html#a7f3923d1e2b39df2e1bf2348312925a6">GetKinVarName</a>(iSample, 0));</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#a768fdb89852db345ec267d30bd462cb2">GetNDim</a>(iSample) == 2) {</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        SplineVarNames.push_back(<a class="code" href="classSampleHandlerFD.html#a7f3923d1e2b39df2e1bf2348312925a6">GetKinVarName</a>(iSample, 0));</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        SplineVarNames.push_back(<a class="code" href="classSampleHandlerFD.html#a7f3923d1e2b39df2e1bf2348312925a6">GetKinVarName</a>(iSample, 1));</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a07ff6d6a15b24f94afc88a1b89779beb">MACH3LOG_CRITICAL</a>(<span class="stringliteral">&quot;{} Not implemented for dimension {}, will use 2D&quot;</span>, __func__, <a class="code" href="classSampleHandlerFD.html#a768fdb89852db345ec267d30bd462cb2">GetNDim</a>(iSample));</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        SplineVarNames.push_back(<a class="code" href="classSampleHandlerFD.html#a7f3923d1e2b39df2e1bf2348312925a6">GetKinVarName</a>(iSample, 0));</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        SplineVarNames.push_back(<a class="code" href="classSampleHandlerFD.html#a7f3923d1e2b39df2e1bf2348312925a6">GetKinVarName</a>(iSample, 1));</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;      }</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      <a class="code" href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">SplineHandler</a>-&gt;AddSample(<a class="code" href="classSampleHandlerFD.html#a9a7fccdf8392ee06495902fab60e9858">SampleHandlerName</a>, <a class="code" href="classSampleHandlerFD.html#adfad2507ad845ad36fff3c82231a143c">GetSampleTitle</a>(iSample), spline_filepaths, SplineVarNames);</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    }</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">SplineHandler</a>-&gt;CountNumberOfLoadedSplines(<span class="keyword">false</span>, 1);</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">SplineHandler</a>-&gt;TransferToMonolith();</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keywordflow">if</span>(PrepSplineFile) <a class="code" href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">SplineHandler</a>-&gt;PrepareSplineFile(SplineFileName);</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="comment">// KS: Skip default spline loading and use flattened spline format allowing to read stuff much faster</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">SplineHandler</a>-&gt;LoadSplineFile(SplineFileName);</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  }</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;--------------------------------&quot;</span>);</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Setup Far Detector splines&quot;</span>);</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160; </div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a64b2af7680c88713c70f064fb7574184">FillSplineBins</a>();</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160; </div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">SplineHandler</a>-&gt;cleanUpMemory();</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a64b2af7680c88713c70f064fb7574184"><div class="ttname"><a href="classSampleHandlerFD.html#a64b2af7680c88713c70f064fb7574184">SampleHandlerFD::FillSplineBins</a></div><div class="ttdeci">void FillSplineBins()</div><div class="ttdoc">Finds the binned spline that an event should apply to and stored them in a a vector for easy evaluati...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01168">SampleHandlerFD.cpp:1168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af67a9a10193e12526e3284d48f425185"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af67a9a10193e12526e3284d48f425185">&#9670;&nbsp;</a></span>IsEventSelected()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool SampleHandlerFD::IsEventSelected </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iEvent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>DB Function which determines if an event is selected, where Selection double looks like {{ND280KinematicTypes Var1, douuble LowBound}. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00302">302</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                                                                    {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; SampleSelection = <a class="code" href="classSampleHandlerFD.html#a07b3357278429dfe809d7d9d27682bf9">Selection</a>[iSample];</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> SelectionSize = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(SampleSelection.size());</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iSelection = 0; iSelection &lt; SelectionSize; ++iSelection) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; Cut = SampleSelection[iSelection];</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> Val = <a class="code" href="classSampleHandlerFD.html#ad0f549802b5625871e11d86905989697">ReturnKinematicParameter</a>(Cut.ParamToCutOnIt, iEvent);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">if</span> ((Val &lt; Cut.LowerBound) || (Val &gt;= Cut.UpperBound)) {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="comment">//DB To avoid unnecessary checks, now return false rather than setting bool to true and continuing to check</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aacc4d573b8e4569269b51ac325bc0092"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacc4d573b8e4569269b51ac325bc0092">&#9670;&nbsp;</a></span>IsSubEventSelected()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool SampleHandlerFD::IsSubEventSelected </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>SubEventCuts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iEvent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned const int&#160;</td>
          <td class="paramname"><em>iSubEvent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nsubevents</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>JM Function which determines if a subevent is selected. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00318">318</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                                                                                                                                                       {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iSelection=0;iSelection &lt; SubEventCuts.size() ;iSelection++) {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    std::vector&lt;double&gt; Vec = <a class="code" href="classSampleHandlerFD.html#ae98d72c6c30697e32fcb464923456fc0">ReturnKinematicVector</a>(SubEventCuts[iSelection].ParamToCutOnIt, iEvent);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">if</span> (nsubevents != Vec.size()) {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Cannot apply kinematic cut on {} as it is of different size to plotting variable&quot;</span>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> Val = Vec[iSubEvent];</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">if</span> ((Val &lt; SubEventCuts[iSelection].LowerBound) || (Val &gt;= SubEventCuts[iSelection].UpperBound)) {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="comment">//DB To avoid unnecessary checks, now return false rather than setting bool to true and continuing to check</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad14d9728400a7b87f095aca00761b829"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad14d9728400a7b87f095aca00761b829">&#9670;&nbsp;</a></span>IsSubEventVarString()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SampleHandlerFD::IsSubEventVarString </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>VarStr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>JM Check if a kinematic parameter string corresponds to a subevent-level variable. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01651">1651</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                                                                 {</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#a5d762b169bab4454bbdb1b387c09f4a7">KinematicVectors</a> == <span class="keyword">nullptr</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160; </div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#a5d762b169bab4454bbdb1b387c09f4a7">KinematicVectors</a>-&gt;count(VarStr)) {</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSampleHandlerFD.html#aae37732e76f0b17b6f124bd5543177e4">KinematicParameters</a>-&gt;count(VarStr)) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Attempted to plot kinematic variable {}, but it appears in both KinematicVectors and KinematicParameters&quot;</span>, VarStr);</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__,__LINE__);</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    }</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;  }</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5f26528eac8bb32fc20e88fd00a35f78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f26528eac8bb32fc20e88fd00a35f78">&#9670;&nbsp;</a></span>LoadSingleSample()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::LoadSingleSample </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const YAML::Node &amp;&#160;</td>
          <td class="paramname"><em>Settings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add new sample</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00112">112</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                                                                                        {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="structSampleInfo.html">SampleInfo</a> SingleSample;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="comment">//SampleTitle has to be provided in the sample yaml otherwise this will throw an exception</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  SingleSample.<a class="code" href="structSampleInfo.html#aa08cf57ea6717add258666f4966cde6d">SampleTitle</a> = Get&lt;std::string&gt;(SampleSettings[<span class="stringliteral">&quot;SampleTitle&quot;</span>], __FILE__ , __LINE__);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;SetupSampleBinning(SampleSettings[<span class="stringliteral">&quot;Binning&quot;</span>], SingleSample);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keyword">auto</span> mtupleprefix  = Get&lt;std::string&gt;(SampleSettings[<span class="stringliteral">&quot;InputFiles&quot;</span>][<span class="stringliteral">&quot;mtupleprefix&quot;</span>], __FILE__, __LINE__);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keyword">auto</span> mtuplesuffix  = Get&lt;std::string&gt;(SampleSettings[<span class="stringliteral">&quot;InputFiles&quot;</span>][<span class="stringliteral">&quot;mtuplesuffix&quot;</span>], __FILE__, __LINE__);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keyword">auto</span> splineprefix  = Get&lt;std::string&gt;(SampleSettings[<span class="stringliteral">&quot;InputFiles&quot;</span>][<span class="stringliteral">&quot;splineprefix&quot;</span>], __FILE__, __LINE__);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keyword">auto</span> splinesuffix  = Get&lt;std::string&gt;(SampleSettings[<span class="stringliteral">&quot;InputFiles&quot;</span>][<span class="stringliteral">&quot;splinesuffix&quot;</span>], __FILE__, __LINE__);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordtype">int</span> NChannels = <span class="keyword">static_cast&lt;</span><a class="code" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a><span class="keyword">&gt;</span>(SampleSettings[<span class="stringliteral">&quot;SubSamples&quot;</span>].size());</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  SingleSample.<a class="code" href="structSampleInfo.html#a4ce072b7de4e67ba232e3196731790ea">OscChannels</a>.reserve(NChannels);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordtype">int</span> OscChannelCounter = 0;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> &amp;osc_channel : SampleSettings[<span class="stringliteral">&quot;SubSamples&quot;</span>]) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    std::string MTupleFileName = mtupleprefix+osc_channel[<span class="stringliteral">&quot;mtuplefile&quot;</span>].as&lt;std::string&gt;()+mtuplesuffix;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="structOscChannelInfo.html">OscChannelInfo</a> OscInfo;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    OscInfo.<a class="code" href="structOscChannelInfo.html#a8e53cc0039dd74b294cea0740af50058">flavourName</a>       = osc_channel[<span class="stringliteral">&quot;Name&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    OscInfo.flavourName_Latex = osc_channel[<span class="stringliteral">&quot;LatexName&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    OscInfo.InitPDG           = <span class="keyword">static_cast&lt;</span><a class="code" href="SampleStructs_8h.html#a0dfdd8cf84b8fa3495e9e5e520fe6cd2">NuPDG</a><span class="keyword">&gt;</span>(osc_channel[<span class="stringliteral">&quot;nutype&quot;</span>].as&lt;<span class="keywordtype">int</span>&gt;());</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    OscInfo.FinalPDG          = <span class="keyword">static_cast&lt;</span><a class="code" href="SampleStructs_8h.html#a0dfdd8cf84b8fa3495e9e5e520fe6cd2">NuPDG</a><span class="keyword">&gt;</span>(osc_channel[<span class="stringliteral">&quot;oscnutype&quot;</span>].as&lt;<span class="keywordtype">int</span>&gt;());</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    OscInfo.ChannelIndex      = OscChannelCounter;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    SingleSample.<a class="code" href="structSampleInfo.html#a4ce072b7de4e67ba232e3196731790ea">OscChannels</a>.push_back(std::move(OscInfo));</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a251743beb6b3e6884fef871a8aef9156">FileToInitPDGMap</a>[MTupleFileName] = <span class="keyword">static_cast&lt;</span><a class="code" href="SampleStructs_8h.html#a0dfdd8cf84b8fa3495e9e5e520fe6cd2">NuPDG</a><span class="keyword">&gt;</span>(osc_channel[<span class="stringliteral">&quot;nutype&quot;</span>].as&lt;<span class="keywordtype">int</span>&gt;());</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a52a69295c2c47e621a5f2b2b1bd9f82e">FileToFinalPDGMap</a>[MTupleFileName] = <span class="keyword">static_cast&lt;</span><a class="code" href="SampleStructs_8h.html#a0dfdd8cf84b8fa3495e9e5e520fe6cd2">NuPDG</a><span class="keyword">&gt;</span>(osc_channel[<span class="stringliteral">&quot;oscnutype&quot;</span>].as&lt;<span class="keywordtype">int</span>&gt;());</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    SingleSample.<a class="code" href="structSampleInfo.html#a79cdb16f1294d9ef3524801367a2531a">mc_files</a>.push_back(MTupleFileName);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    SingleSample.<a class="code" href="structSampleInfo.html#ac3914beef03de94be8dd2e31e660831a">spline_files</a>.push_back(splineprefix+osc_channel[<span class="stringliteral">&quot;splinefile&quot;</span>].as&lt;std::string&gt;()+splinesuffix);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    OscChannelCounter++;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="comment">//Now grab the selection cuts from the manager</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordflow">for</span> ( <span class="keyword">auto</span> <span class="keyword">const</span> &amp;SelectionCuts : SampleSettings[<span class="stringliteral">&quot;SelectionCuts&quot;</span>]) {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keyword">auto</span> TempBoundsVec = <a class="code" href="YamlHelper_8h.html#ae828b8f0cb6b6bbd5fd4e7e5aaf9632f">GetBounds</a>(SelectionCuts[<span class="stringliteral">&quot;Bounds&quot;</span>]);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="structKinematicCut.html">KinematicCut</a> CutObj;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    CutObj.<a class="code" href="structKinematicCut.html#aa654b5f2ef7ca1b57d9238c428fdc11f">LowerBound</a> = TempBoundsVec[0];</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    CutObj.<a class="code" href="structKinematicCut.html#a244bd4ada65739a6984a2039a5a6f200">UpperBound</a> = TempBoundsVec[1];</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    CutObj.<a class="code" href="structKinematicCut.html#aedd261d6e8e3f72e3570cfe3753cbd2f">ParamToCutOnIt</a> = <a class="code" href="classSampleHandlerFD.html#ae2769d593f34e8356b545af076818f89">ReturnKinematicParameterFromString</a>(SelectionCuts[<span class="stringliteral">&quot;KinematicStr&quot;</span>].as&lt;std::string&gt;());</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Adding cut on {} with bounds {} to {}&quot;</span>, SelectionCuts[<span class="stringliteral">&quot;KinematicStr&quot;</span>].as&lt;std::string&gt;(), TempBoundsVec[0], TempBoundsVec[1]);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="classSampleHandlerFD.html#aa3832a3e2c438d4810811d83e1323cff">StoredSelection</a>[iSample].emplace_back(CutObj);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[iSample] = std::move(SingleSample);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;}</div>
<div class="ttc" id="aSampleStructs_8h_html_a0dfdd8cf84b8fa3495e9e5e520fe6cd2"><div class="ttname"><a href="SampleStructs_8h.html#a0dfdd8cf84b8fa3495e9e5e520fe6cd2">NuPDG</a></div><div class="ttdeci">NuPDG</div><div class="ttdoc">Enum to track the incoming neutrino species.</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00094">SampleStructs.h:94</a></div></div>
<div class="ttc" id="aYamlHelper_8h_html_ae828b8f0cb6b6bbd5fd4e7e5aaf9632f"><div class="ttname"><a href="YamlHelper_8h.html#ae828b8f0cb6b6bbd5fd4e7e5aaf9632f">GetBounds</a></div><div class="ttdeci">#define GetBounds(filename)</div><div class="ttdef"><b>Definition:</b> <a href="YamlHelper_8h_source.html#l00590">YamlHelper.h:590</a></div></div>
<div class="ttc" id="astructOscChannelInfo_html"><div class="ttname"><a href="structOscChannelInfo.html">OscChannelInfo</a></div><div class="ttdoc">KS: Store info about used osc channels.</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00008">FarDetectorCoreInfoStruct.h:8</a></div></div>
<div class="ttc" id="astructOscChannelInfo_html_a8e53cc0039dd74b294cea0740af50058"><div class="ttname"><a href="structOscChannelInfo.html#a8e53cc0039dd74b294cea0740af50058">OscChannelInfo::flavourName</a></div><div class="ttdeci">std::string flavourName</div><div class="ttdoc">Name of osc channel.</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00010">FarDetectorCoreInfoStruct.h:10</a></div></div>
<div class="ttc" id="astructSampleInfo_html"><div class="ttname"><a href="structSampleInfo.html">SampleInfo</a></div><div class="ttdoc">KS: Store info about MC sample.</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00040">FarDetectorCoreInfoStruct.h:40</a></div></div>
<div class="ttc" id="astructSampleInfo_html_a4ce072b7de4e67ba232e3196731790ea"><div class="ttname"><a href="structSampleInfo.html#a4ce072b7de4e67ba232e3196731790ea">SampleInfo::OscChannels</a></div><div class="ttdeci">std::vector&lt; OscChannelInfo &gt; OscChannels</div><div class="ttdoc">Stores info about oscillation channel for a single sample.</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00066">FarDetectorCoreInfoStruct.h:66</a></div></div>
<div class="ttc" id="astructSampleInfo_html_a79cdb16f1294d9ef3524801367a2531a"><div class="ttname"><a href="structSampleInfo.html#a79cdb16f1294d9ef3524801367a2531a">SampleInfo::mc_files</a></div><div class="ttdeci">std::vector&lt; std::string &gt; mc_files</div><div class="ttdoc">names of mc files associated associated with this object</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00061">FarDetectorCoreInfoStruct.h:61</a></div></div>
<div class="ttc" id="astructSampleInfo_html_aa08cf57ea6717add258666f4966cde6d"><div class="ttname"><a href="structSampleInfo.html#aa08cf57ea6717add258666f4966cde6d">SampleInfo::SampleTitle</a></div><div class="ttdeci">std::string SampleTitle</div><div class="ttdoc">the name of this sample e.g.&quot;muon-like&quot;</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00055">FarDetectorCoreInfoStruct.h:55</a></div></div>
<div class="ttc" id="astructSampleInfo_html_ac3914beef03de94be8dd2e31e660831a"><div class="ttname"><a href="structSampleInfo.html#ac3914beef03de94be8dd2e31e660831a">SampleInfo::spline_files</a></div><div class="ttdeci">std::vector&lt; std::string &gt; spline_files</div><div class="ttdoc">names of spline files associated associated with this object</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00063">FarDetectorCoreInfoStruct.h:63</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abbc1484d010b021794f44fc1b1594269"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbc1484d010b021794f44fc1b1594269">&#9670;&nbsp;</a></span>PassesSelection()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename ParT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool SampleHandlerFD::PassesSelection </td>
          <td>(</td>
          <td class="paramtype">const ParT &amp;&#160;</td>
          <td class="paramname"><em>Par</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>iEvent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l02040">2040</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;                                                                       {</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;<span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;  <span class="keywordtype">bool</span> IsSelected = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;  <span class="keywordflow">if</span> (Par.hasKinBounds) {</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; kinVars = Par.KinematicVarStr;</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; selection = Par.Selection;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160; </div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    <span class="keywordflow">for</span> (std::size_t iKinPar = 0; iKinPar &lt; kinVars.size(); ++iKinPar) {</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> kinVal = <a class="code" href="classSampleHandlerFD.html#ad0f549802b5625871e11d86905989697">ReturnKinematicParameter</a>(kinVars[iKinPar], <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(iEvent));</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160; </div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;      <span class="keywordtype">bool</span> passedAnyBound = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; boundsList = selection[iKinPar];</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160; </div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; bounds : boundsList) {</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;        <span class="keywordflow">if</span> (kinVal &gt; bounds[0] &amp;&amp; kinVal &lt;= bounds[1]) {</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;          passedAnyBound = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;        }</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;      }</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160; </div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;      <span class="keywordflow">if</span> (!passedAnyBound) {</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#afc88f0aa23c7127b2ff6e5c7ca3fa892">MACH3LOG_TRACE</a>(<span class="stringliteral">&quot;Event {}, missed kinematic check ({}) for dial {}&quot;</span>,</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;                       iEvent, kinVars[iKinPar], Par.name);</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;        IsSelected = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;      }</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    }</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;  }</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;  <span class="keywordflow">return</span> IsSelected;</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a691a4ec2c4c82b3c4437ead052644a54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a691a4ec2c4c82b3c4437ead052644a54">&#9670;&nbsp;</a></span>PrepFunctionalParameters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void SampleHandlerFD::PrepFunctionalParameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update the functional parameter values to the latest proposed values. Needs to be called before every new reweight so is called in fillArray. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00241">241</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;{};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a67deb470bd32d96ed126c780a4cb8d69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67deb470bd32d96ed126c780a4cb8d69">&#9670;&nbsp;</a></span>PrintIntegral()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::PrintIntegral </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TString &amp;&#160;</td>
          <td class="paramname"><em>OutputName</em> = <code>&quot;/dev/null&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TString &amp;&#160;</td>
          <td class="paramname"><em>OutputCSVName</em> = <code>&quot;/dev/null&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01732">1732</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                                                                                                                                             {</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;  constexpr <span class="keywordtype">int</span> space = 14;</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160; </div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;  <span class="keywordtype">bool</span> printToFile=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;  <span class="keywordflow">if</span> (OutputFileName.CompareTo(<span class="stringliteral">&quot;/dev/null&quot;</span>)) {printToFile = <span class="keyword">true</span>;}</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160; </div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;  <span class="keywordtype">bool</span> printToCSV=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;  <span class="keywordflow">if</span>(OutputCSVFileName.CompareTo(<span class="stringliteral">&quot;/dev/null&quot;</span>)) printToCSV=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160; </div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  std::ofstream outfile;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;  <span class="keywordflow">if</span> (printToFile) {</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    outfile.open(OutputFileName.Data(), std::ios_base::app);</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    outfile.precision(7);</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  }</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160; </div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;  std::ofstream outcsv;</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;  <span class="keywordflow">if</span>(printToCSV){</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    outcsv.open(OutputCSVFileName, std::ios_base::app); <span class="comment">// Appened to CSV</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    outcsv.precision(7);</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;  }</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160; </div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  <span class="keywordtype">double</span> PDFIntegral = 0.;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160; </div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;  std::vector&lt; std::vector&lt; TH1* &gt; &gt; IntegralList;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;  IntegralList.resize(<a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetNModes());</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160; </div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;  std::vector&lt;double&gt; ChannelIntegral;</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;  ChannelIntegral.resize(<a class="code" href="classSampleHandlerFD.html#aac276e3f10be081ce8e7f94df131490d">GetNOscChannels</a>(iSample));</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;ChannelIntegral.size();i++) {ChannelIntegral[i] = 0.;}</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160; </div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetNModes();i++) {</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#a768fdb89852db345ec267d30bd462cb2">GetNDim</a>(iSample) == 1) {</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;      IntegralList[i] = <a class="code" href="classSampleHandlerFD.html#a9d5273302853361d5774998fb17805b2">ReturnHistsBySelection1D</a>(iSample, <a class="code" href="classSampleHandlerFD.html#a9aebf7da41ad6ddb87e3081a7f4763ec">GetXBinVarName</a>(iSample),1,i,WeightStyle);</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;      IntegralList[i] = CastVector&lt;TH2, TH1&gt;(<a class="code" href="classSampleHandlerFD.html#a47a345341de0cd86acababcc2d66cf91">ReturnHistsBySelection2D</a>(iSample, <a class="code" href="classSampleHandlerFD.html#a9aebf7da41ad6ddb87e3081a7f4763ec">GetXBinVarName</a>(iSample), <a class="code" href="classSampleHandlerFD.html#a69d66592696bee9e73f61649c681a573">GetYBinVarName</a>(iSample),1,i,WeightStyle));</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    }</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;  }</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160; </div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;-------------------------------------------------&quot;</span>);</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160; </div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;  <span class="keywordflow">if</span> (printToFile) {</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    outfile &lt;&lt; <span class="stringliteral">&quot;\\begin{table}[ht]&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    outfile &lt;&lt; <span class="stringliteral">&quot;\\begin{center}&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    outfile &lt;&lt; <span class="stringliteral">&quot;\\caption{Integral breakdown for sample: &quot;</span> &lt;&lt; <a class="code" href="classSampleHandlerFD.html#adfad2507ad845ad36fff3c82231a143c">GetSampleTitle</a>(iSample) &lt;&lt; <span class="stringliteral">&quot;}&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    outfile &lt;&lt; <span class="stringliteral">&quot;\\label{&quot;</span> &lt;&lt; <a class="code" href="classSampleHandlerFD.html#adfad2507ad845ad36fff3c82231a143c">GetSampleTitle</a>(iSample) &lt;&lt; <span class="stringliteral">&quot;-EventRate}&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160; </div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    TString nColumns;</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classSampleHandlerFD.html#aac276e3f10be081ce8e7f94df131490d">GetNOscChannels</a>(iSample);i++) {nColumns+=<span class="stringliteral">&quot;|c&quot;</span>;}</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    nColumns += <span class="stringliteral">&quot;|c|&quot;</span>;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    outfile &lt;&lt; <span class="stringliteral">&quot;\\begin{tabular}{|l&quot;</span> &lt;&lt; nColumns.Data() &lt;&lt; <span class="stringliteral">&quot;}&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    outfile &lt;&lt; <span class="stringliteral">&quot;\\hline&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;  }</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160; </div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;  <span class="keywordflow">if</span>(printToCSV){</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <span class="comment">// HW Probably a better way but oh well, here I go making MaCh3 messy again</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    outcsv&lt;&lt;<span class="stringliteral">&quot;Integral Breakdown for sample :&quot;</span>&lt;&lt;<a class="code" href="classSampleHandlerFD.html#adfad2507ad845ad36fff3c82231a143c">GetSampleTitle</a>(iSample)&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;  }</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160; </div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Integral breakdown for sample: {}&quot;</span>, <a class="code" href="classSampleHandlerFD.html#adfad2507ad845ad36fff3c82231a143c">GetSampleTitle</a>(iSample));</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160; </div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;  <span class="keywordflow">if</span> (printToFile) {outfile &lt;&lt; std::setw(space) &lt;&lt; <span class="stringliteral">&quot;Mode:&quot;</span>;}</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;  <span class="keywordflow">if</span>(printToCSV) {outcsv&lt;&lt;<span class="stringliteral">&quot;Mode,&quot;</span>;}</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160; </div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;  std::string table_headings = fmt::format(<span class="stringliteral">&quot;| {:&lt;8} |&quot;</span>, <span class="stringliteral">&quot;Mode&quot;</span>);</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;  std::string table_footline = <span class="stringliteral">&quot;------------&quot;</span>; <span class="comment">//Scalable table horizontal line</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0;i &lt; <a class="code" href="classSampleHandlerFD.html#aac276e3f10be081ce8e7f94df131490d">GetNOscChannels</a>(iSample); i++) {</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    table_headings += fmt::format(<span class="stringliteral">&quot; {:&lt;17} |&quot;</span>, <a class="code" href="classSampleHandlerFD.html#a802e5b253f0b23d1e206ef9c0008301a">GetFlavourName</a>(iSample, i));</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    table_footline += <span class="stringliteral">&quot;--------------------&quot;</span>;</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    <span class="keywordflow">if</span> (printToFile) {outfile &lt;&lt; <span class="stringliteral">&quot;&amp;&quot;</span> &lt;&lt; std::setw(space) &lt;&lt; <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[iSample].OscChannels[i].flavourName_Latex &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;}</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    <span class="keywordflow">if</span> (printToCSV)  {outcsv &lt;&lt; <a class="code" href="classSampleHandlerFD.html#a802e5b253f0b23d1e206ef9c0008301a">GetFlavourName</a>(iSample, i) &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;}</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;  }</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;  <span class="keywordflow">if</span> (printToFile) {outfile &lt;&lt; <span class="stringliteral">&quot;&amp;&quot;</span> &lt;&lt; std::setw(space) &lt;&lt; <span class="stringliteral">&quot;Total:&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\\\\ \\hline&quot;</span> &lt;&lt; std::endl;}</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;  <span class="keywordflow">if</span> (printToCSV)  {outcsv &lt;&lt;<span class="stringliteral">&quot;Total\n&quot;</span>;}</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;  table_headings += fmt::format(<span class="stringliteral">&quot; {:&lt;10} |&quot;</span>, <span class="stringliteral">&quot;Total&quot;</span>);</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;  table_footline += <span class="stringliteral">&quot;-------------&quot;</span>;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160; </div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{}&quot;</span>, table_headings);</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{}&quot;</span>, table_footline);</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160; </div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;IntegralList.size();i++) {</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    <span class="keywordtype">double</span> ModeIntegral = 0;</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    <span class="keywordflow">if</span> (printToFile) {outfile &lt;&lt; std::setw(space) &lt;&lt; <a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetMaCh3ModeName(i);}</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    <span class="keywordflow">if</span>(printToCSV)   {outcsv &lt;&lt; <a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetMaCh3ModeName(i) &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;}</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160; </div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    table_headings = fmt::format(<span class="stringliteral">&quot;| {:&lt;8} |&quot;</span>, <a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetMaCh3ModeName(i)); <span class="comment">//Start string with mode name</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160; </div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0;j&lt;IntegralList[i].size();j++) {</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;      <span class="keywordtype">double</span> Integral = IntegralList[i][j]-&gt;Integral();</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160; </div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;      <span class="keywordflow">if</span> (Integral &lt; 1e-100) {Integral=0;}</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160; </div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;      ModeIntegral += Integral;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;      ChannelIntegral[j] += Integral;</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;      PDFIntegral += Integral;</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160; </div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;      <span class="keywordflow">if</span> (printToFile) {outfile &lt;&lt; <span class="stringliteral">&quot;&amp;&quot;</span> &lt;&lt; std::setw(space) &lt;&lt; Form(<span class="stringliteral">&quot;%4.5f&quot;</span>,Integral) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;}</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;      <span class="keywordflow">if</span> (printToCSV)  {outcsv &lt;&lt; Form(<span class="stringliteral">&quot;%4.5f&quot;</span>, Integral) &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;}</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160; </div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;      table_headings += fmt::format(<span class="stringliteral">&quot; {:&lt;17.4f} |&quot;</span>, Integral);</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    }</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    <span class="keywordflow">if</span> (printToFile) {outfile &lt;&lt; <span class="stringliteral">&quot;&amp;&quot;</span> &lt;&lt; std::setw(space) &lt;&lt; Form(<span class="stringliteral">&quot;%4.5f&quot;</span>,ModeIntegral) &lt;&lt;  <span class="stringliteral">&quot; \\\\ \\hline&quot;</span> &lt;&lt; std::endl;}</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    <span class="keywordflow">if</span> (printToCSV)  {outcsv &lt;&lt; Form(<span class="stringliteral">&quot;%4.5f&quot;</span>, ModeIntegral) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;}</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160; </div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    table_headings += fmt::format(<span class="stringliteral">&quot; {:&lt;10.4f} |&quot;</span>, ModeIntegral);</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160; </div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{}&quot;</span>, table_headings);</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;  }</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160; </div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;  <span class="keywordflow">if</span> (printToFile) {outfile &lt;&lt; std::setw(space) &lt;&lt; <span class="stringliteral">&quot;Total:&quot;</span>;}</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;  <span class="keywordflow">if</span> (printToCSV)  {outcsv &lt;&lt; <span class="stringliteral">&quot;Total,&quot;</span>;}</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160; </div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;  <span class="comment">//Clear the table_headings to print last row of totals</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;  table_headings = fmt::format(<span class="stringliteral">&quot;| {:&lt;8} |&quot;</span>, <span class="stringliteral">&quot;Total&quot;</span>);</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;ChannelIntegral.size();i++) {</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <span class="keywordflow">if</span> (printToFile) {outfile &lt;&lt; <span class="stringliteral">&quot;&amp;&quot;</span> &lt;&lt; std::setw(space) &lt;&lt; Form(<span class="stringliteral">&quot;%4.5f&quot;</span>,ChannelIntegral[i]) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;}</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <span class="keywordflow">if</span> (printToCSV)  {outcsv &lt;&lt; Form(<span class="stringliteral">&quot;%4.5f&quot;</span>, ChannelIntegral[i]) &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;}</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    table_headings += fmt::format(<span class="stringliteral">&quot; {:&lt;17.4f} |&quot;</span>, ChannelIntegral[i]);</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;  }</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;  <span class="keywordflow">if</span> (printToFile) {outfile &lt;&lt; <span class="stringliteral">&quot;&amp;&quot;</span> &lt;&lt; std::setw(space) &lt;&lt; Form(<span class="stringliteral">&quot;%4.5f&quot;</span>,PDFIntegral) &lt;&lt; <span class="stringliteral">&quot; \\\\ \\hline&quot;</span> &lt;&lt; std::endl;}</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;  <span class="keywordflow">if</span> (printToCSV)  {outcsv &lt;&lt; Form(<span class="stringliteral">&quot;%4.5f&quot;</span>, PDFIntegral) &lt;&lt; <span class="stringliteral">&quot;\n\n\n\n&quot;</span>;} <span class="comment">// Let&#39;s have a few new lines!</span></div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160; </div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;  table_headings += fmt::format(<span class="stringliteral">&quot; {:&lt;10.4f} |&quot;</span>, PDFIntegral);</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{}&quot;</span>, table_headings);</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{}&quot;</span>, table_footline);</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160; </div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;  <span class="keywordflow">if</span> (printToFile) {</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    outfile &lt;&lt; <span class="stringliteral">&quot;\\end{tabular}&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    outfile &lt;&lt; <span class="stringliteral">&quot;\\end{center}&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    outfile &lt;&lt; <span class="stringliteral">&quot;\\end{table}&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;  }</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160; </div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160; </div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;  <span class="keywordflow">if</span> (printToFile) {</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    outfile &lt;&lt; std::endl;</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    outfile.close();</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;  }</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;  <span class="comment">// KS: Clean memory we could use smart pointers in future</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;  <a class="code" href="ParameterStructs_8h.html#a569a3f763b3cca77ecc85e5a685b182c">CleanContainer</a>(IntegralList);</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;}</div>
<div class="ttc" id="aParameterStructs_8h_html_a569a3f763b3cca77ecc85e5a685b182c"><div class="ttname"><a href="ParameterStructs_8h.html#a569a3f763b3cca77ecc85e5a685b182c">CleanContainer</a></div><div class="ttdeci">void CleanContainer(T &amp;)</div><div class="ttdoc">Base case: do nothing for non-pointer types.</div><div class="ttdef"><b>Definition:</b> <a href="ParameterStructs_8h_source.html#l00064">ParameterStructs.h:64</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a47a345341de0cd86acababcc2d66cf91"><div class="ttname"><a href="classSampleHandlerFD.html#a47a345341de0cd86acababcc2d66cf91">SampleHandlerFD::ReturnHistsBySelection2D</a></div><div class="ttdeci">std::vector&lt; TH2 * &gt; ReturnHistsBySelection2D(const int iSample, const std::string &amp;KinematicProjectionX, const std::string &amp;KinematicProjectionY, int Selection1, int Selection2=-1, int WeightStyle=0, TAxis *XAxis=nullptr, TAxis *YAxis=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01913">SampleHandlerFD.cpp:1913</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a802e5b253f0b23d1e206ef9c0008301a"><div class="ttname"><a href="classSampleHandlerFD.html#a802e5b253f0b23d1e206ef9c0008301a">SampleHandlerFD::GetFlavourName</a></div><div class="ttdeci">std::string GetFlavourName(const int iSample, const int iChannel) const override</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00095">SampleHandlerFD.h:95</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a9d5273302853361d5774998fb17805b2"><div class="ttname"><a href="classSampleHandlerFD.html#a9d5273302853361d5774998fb17805b2">SampleHandlerFD::ReturnHistsBySelection1D</a></div><div class="ttdeci">std::vector&lt; TH1 * &gt; ReturnHistsBySelection1D(const int iSample, const std::string &amp;KinematicProjection, int Selection1, int Selection2=-1, int WeightStyle=0, TAxis *Axis=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01875">SampleHandlerFD.cpp:1875</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a991deded5e6460cc2f3becaf8d856ae9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a991deded5e6460cc2f3becaf8d856ae9">&#9670;&nbsp;</a></span>PrintRates()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::PrintRates </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>DataOnly</em> = <code>false</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function to print rates for the samples with LLH. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">DataOnly</td><td>whether to print data only rates </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classSampleHandlerBase.html#afd2dfe54e6c99965f68ee08c2deba7d7">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01968">1968</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;                                                    {</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;<span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#a2b16ed4f91f2f37ff707ca048d8d6927">SampleHandlerFD_data</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Data sample is empty!&quot;</span>);</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;  }</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Printing for {}&quot;</span>, <a class="code" href="classSampleHandlerFD.html#a6101b46360ae54fe37dd1243f3f7f51e">GetName</a>());</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160; </div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;  <span class="keywordflow">if</span> (!DataOnly) {</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    <span class="keyword">const</span> std::string sep_full(71, <span class="charliteral">&#39;-&#39;</span>);</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{}&quot;</span>, sep_full);</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{:&lt;40}{:&lt;10}{:&lt;10}{:&lt;10}|&quot;</span>, <span class="stringliteral">&quot;Sample&quot;</span>, <span class="stringliteral">&quot;Data&quot;</span>, <span class="stringliteral">&quot;MC&quot;</span>, <span class="stringliteral">&quot;-LLH&quot;</span>);</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    <span class="keyword">const</span> std::string sep_data(51, <span class="charliteral">&#39;-&#39;</span>);</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{}&quot;</span>, sep_data);</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{:&lt;40}{:&lt;10}|&quot;</span>, <span class="stringliteral">&quot;Sample&quot;</span>, <span class="stringliteral">&quot;Data&quot;</span>);</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;  }</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160; </div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;  <span class="keywordtype">double</span> sumData = 0.0;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;  <span class="keywordtype">double</span> sumMC = 0.0;</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;  <span class="keywordtype">double</span> likelihood = 0.0;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160; </div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iSample = 0; iSample &lt; <a class="code" href="classSampleHandlerBase.html#ac4b73a8841ff9bab2fb08b578ad4137f">GetNsamples</a>(); ++iSample) {</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;    std::string name = <a class="code" href="classSampleHandlerFD.html#adfad2507ad845ad36fff3c82231a143c">GetSampleTitle</a>(iSample);</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    std::vector&lt;double&gt; DataArray = <a class="code" href="classSampleHandlerFD.html#a5661f2accf6e80561699935f86ac9e08">GetDataArray</a>(iSample);</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    <span class="keywordtype">double</span> dataIntegral = std::accumulate(DataArray.begin(), DataArray.end(), 0.0);</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    sumData += dataIntegral;</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    <span class="keywordflow">if</span> (!DataOnly) {</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;      std::vector&lt;double&gt; MCArray = <a class="code" href="classSampleHandlerFD.html#a75a62e3bf834e17992f1ebda3836c300">GetMCArray</a>(iSample);</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;      <span class="keywordtype">double</span> mcIntegral = std::accumulate(MCArray.begin(), MCArray.end(), 0.0);</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;      sumMC += mcIntegral;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;      likelihood = <a class="code" href="classSampleHandlerFD.html#aaac2deb8881a00c85951a3e8a6653393">GetSampleLikelihood</a>(iSample);</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160; </div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{:&lt;40}{:&lt;10.2f}{:&lt;10.2f}{:&lt;10.2f}|&quot;</span>, name, dataIntegral, mcIntegral, likelihood);</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{:&lt;40}{:&lt;10.2f}|&quot;</span>, name, dataIntegral);</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    }</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;  }</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;  <span class="keywordflow">if</span> (!DataOnly) {</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    likelihood = <a class="code" href="classSampleHandlerFD.html#a25b63e394dab02d0b2d278ff55642fd9">GetLikelihood</a>();</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{:&lt;40}{:&lt;10.2f}{:&lt;10.2f}{:&lt;10.2f}|&quot;</span>, <span class="stringliteral">&quot;Total&quot;</span>, sumData, sumMC, likelihood);</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    <span class="keyword">const</span> std::string sep_full(71, <span class="charliteral">&#39;-&#39;</span>);</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{}&quot;</span>, sep_full);</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{:&lt;40}{:&lt;10.2f}|&quot;</span>, <span class="stringliteral">&quot;Total&quot;</span>, sumData);</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    <span class="keyword">const</span> std::string sep_data(51, <span class="charliteral">&#39;-&#39;</span>);</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{}&quot;</span>, sep_data);</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;  }</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a25b63e394dab02d0b2d278ff55642fd9"><div class="ttname"><a href="classSampleHandlerFD.html#a25b63e394dab02d0b2d278ff55642fd9">SampleHandlerFD::GetLikelihood</a></div><div class="ttdeci">double GetLikelihood() const override</div><div class="ttdoc">DB Multi-threaded GetLikelihood.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01233">SampleHandlerFD.cpp:1233</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a5661f2accf6e80561699935f86ac9e08"><div class="ttname"><a href="classSampleHandlerFD.html#a5661f2accf6e80561699935f86ac9e08">SampleHandlerFD::GetDataArray</a></div><div class="ttdeci">std::vector&lt; double &gt; GetDataArray() const</div><div class="ttdoc">Return array storing data entries for every bin.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00162">SampleHandlerFD.h:162</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a75a62e3bf834e17992f1ebda3836c300"><div class="ttname"><a href="classSampleHandlerFD.html#a75a62e3bf834e17992f1ebda3836c300">SampleHandlerFD::GetMCArray</a></div><div class="ttdeci">std::vector&lt; double &gt; GetMCArray() const</div><div class="ttdoc">Return array storing MC entries for every bin.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00166">SampleHandlerFD.h:166</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_aaac2deb8881a00c85951a3e8a6653393"><div class="ttname"><a href="classSampleHandlerFD.html#aaac2deb8881a00c85951a3e8a6653393">SampleHandlerFD::GetSampleLikelihood</a></div><div class="ttdeci">double GetSampleLikelihood(const int isample) const override</div><div class="ttdoc">Get likelihood for single sample.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01211">SampleHandlerFD.cpp:1211</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a15a8239722140a814fea0a3d008f97ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15a8239722140a814fea0a3d008f97ee">&#9670;&nbsp;</a></span>ReadConfig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::ReadConfig </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00058">58</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;{</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keyword">auto</span> ModeName = Get&lt;std::string&gt;(<a class="code" href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;MaCh3ModeConfig&quot;</span>], __FILE__ , __LINE__);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a> = std::make_unique&lt;MaCh3Modes&gt;(ModeName);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="comment">//SampleName has to be provided in the sample yaml otherwise this will throw an exception</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a9a7fccdf8392ee06495902fab60e9858">SampleHandlerName</a> = Get&lt;std::string&gt;(<a class="code" href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;SampleHandlerName&quot;</span>], __FILE__ , __LINE__);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="classSampleHandlerBase.html#a87670dbcda5d09b09675e8f407fe3a30">fTestStatistic</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67">TestStatistic</a><span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleManager</a>-&gt;GetMCStatLLH());</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="YamlHelper_8h.html#ad2340a340fd6649a6d220abc16d4757b">CheckNodeExists</a>(<a class="code" href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleManager</a>-&gt;raw(), <span class="stringliteral">&quot;LikelihoodOptions&quot;</span>)) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="classSampleHandlerFD.html#aa654562842a0da51ff917aaed517310e">UpdateW2</a> = GetFromManager&lt;bool&gt;(<a class="code" href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;LikelihoodOptions&quot;</span>][<span class="stringliteral">&quot;UpdateW2&quot;</span>], <span class="keyword">false</span>);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="YamlHelper_8h.html#ad2340a340fd6649a6d220abc16d4757b">CheckNodeExists</a>(<a class="code" href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleManager</a>-&gt;raw(), <span class="stringliteral">&quot;BinningFile&quot;</span>)){</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;BinningFile not given in for sample handler {}, ReturnKinematicParameterBinning will not work&quot;</span>, <a class="code" href="classSampleHandlerFD.html#a9a7fccdf8392ee06495902fab60e9858">SampleHandlerName</a>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keyword">auto</span> EnabledSasmples = Get&lt;std::vector&lt;std::string&gt;&gt;(<a class="code" href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;Samples&quot;</span>], __FILE__ , __LINE__);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="comment">// Get number of samples and resize relevant objects</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <a class="code" href="classSampleHandlerBase.html#aa7a13af22c2314c718fb6438d493d3d1">nSamples</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a><span class="keyword">&gt;</span>(EnabledSasmples.size());</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>.resize(<a class="code" href="classSampleHandlerBase.html#aa7a13af22c2314c718fb6438d493d3d1">nSamples</a>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <a class="code" href="classSampleHandlerFD.html#aa3832a3e2c438d4810811d83e1323cff">StoredSelection</a>.resize(<a class="code" href="classSampleHandlerBase.html#aa7a13af22c2314c718fb6438d493d3d1">nSamples</a>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iSample = 0; iSample &lt; <a class="code" href="classSampleHandlerBase.html#aa7a13af22c2314c718fb6438d493d3d1">nSamples</a>; iSample++)</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keyword">auto</span> SampleSettings = <a class="code" href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleManager</a>-&gt;raw()[EnabledSasmples[iSample]];</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a5f26528eac8bb32fc20e88fd00a35f78">LoadSingleSample</a>(iSample, SampleSettings);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  } <span class="comment">// end loop over enabling samples</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="comment">// EM: initialise the mode weight map</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordflow">for</span>( <span class="keywordtype">int</span> iMode=0; iMode &lt; <a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetNModes(); iMode++ ) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="classSampleHandlerFD.html#ad625af417f4445b9b14710ca3bdc409d">_modeNomWeightMap</a>[<a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetMaCh3ModeName(iMode)] = 1.0;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="comment">// EM: multiply by the nominal weight specified in the sample config file</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;NominalWeights&quot;</span>] ) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> iMode=0; iMode&lt;<a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetNModes(); iMode++ ) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      std::string modeStr = <a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetMaCh3ModeName(iMode);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="keywordflow">if</span>( <a class="code" href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;NominalWeights&quot;</span>][modeStr] ) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordtype">double</span> modeWeight = <a class="code" href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;NominalWeights&quot;</span>][modeStr].as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <a class="code" href="classSampleHandlerFD.html#ad625af417f4445b9b14710ca3bdc409d">_modeNomWeightMap</a>[<a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetMaCh3ModeName(iMode)] *= modeWeight;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="comment">// EM: print em out</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;  Nominal mode weights to apply: &quot;</span>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iMode=0; iMode&lt;<a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetNModes(); iMode++ ) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    std::string modeStr = <a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetMaCh3ModeName(iMode);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;    - {}: {}&quot;</span>, modeStr, <a class="code" href="classSampleHandlerFD.html#ad625af417f4445b9b14710ca3bdc409d">_modeNomWeightMap</a>.at(modeStr));</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;}</div>
<div class="ttc" id="aSampleStructs_8h_html_a960da89e33ac45a56f7bbfac3068dc67"><div class="ttname"><a href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67">TestStatistic</a></div><div class="ttdeci">TestStatistic</div><div class="ttdoc">Make an enum of the test statistic that we're using.</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00105">SampleStructs.h:105</a></div></div>
<div class="ttc" id="aclassSampleHandlerBase_html_a87670dbcda5d09b09675e8f407fe3a30"><div class="ttname"><a href="classSampleHandlerBase.html#a87670dbcda5d09b09675e8f407fe3a30">SampleHandlerBase::fTestStatistic</a></div><div class="ttdeci">TestStatistic fTestStatistic</div><div class="ttdoc">Test statistic tells what kind of likelihood sample is using.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00202">SampleHandlerBase.h:202</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a5f26528eac8bb32fc20e88fd00a35f78"><div class="ttname"><a href="classSampleHandlerFD.html#a5f26528eac8bb32fc20e88fd00a35f78">SampleHandlerFD::LoadSingleSample</a></div><div class="ttdeci">void LoadSingleSample(const int iSample, const YAML::Node &amp;Settings)</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00112">SampleHandlerFD.cpp:112</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ad625af417f4445b9b14710ca3bdc409d"><div class="ttname"><a href="classSampleHandlerFD.html#ad625af417f4445b9b14710ca3bdc409d">SampleHandlerFD::_modeNomWeightMap</a></div><div class="ttdeci">std::unordered_map&lt; std::string, double &gt; _modeNomWeightMap</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00385">SampleHandlerFD.h:385</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab5a809cfcd1e221ba0094b65f8e748f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5a809cfcd1e221ba0094b65f8e748f8">&#9670;&nbsp;</a></span>RegisterFunctionalParameters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void SampleHandlerFD::RegisterFunctionalParameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>HH - a experiment-specific function where the maps to actual functions are set up. </p>

<p>Implemented in <a class="el" href="classPySampleHandlerFD.html#ad83271c04e185f5e4e6414b3eb3d3226">PySampleHandlerFD</a>.</p>

</div>
</div>
<a id="aa2626d0d48874d1aff1a107f62f1f02d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2626d0d48874d1aff1a107f62f1f02d">&#9670;&nbsp;</a></span>RegisterIndividualFunctionalParameter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::RegisterIndividualFunctionalParameter </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>fpName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fpEnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ParameterStructs_8h.html#a916ddc21f75755739f308b54dd06e0ae">FuncParFuncType</a>&#160;</td>
          <td class="paramname"><em>fpFunc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>HH - a helper function for RegisterFunctionalParameter. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00480">480</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                                                                                                                      {</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="comment">// Add protections to not add the same functional parameter twice</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">funcParsNamesMap</a>.find(fpName) != <a class="code" href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">funcParsNamesMap</a>.end()) {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Functional parameter {} already registered in funcParsNamesMap with enum {}&quot;</span>, fpName, <a class="code" href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">funcParsNamesMap</a>[fpName]);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  }</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keywordflow">if</span> (std::find(<a class="code" href="classSampleHandlerFD.html#a888112d7eebd6fdb877c0015e1951f9d">funcParsNamesVec</a>.begin(), <a class="code" href="classSampleHandlerFD.html#a888112d7eebd6fdb877c0015e1951f9d">funcParsNamesVec</a>.end(), fpName) != <a class="code" href="classSampleHandlerFD.html#a888112d7eebd6fdb877c0015e1951f9d">funcParsNamesVec</a>.end()) {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Functional parameter {} already in funcParsNamesVec&quot;</span>, fpName);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  }</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#a577a57992e396a5b34efcd3bb6ed45cf">funcParsFuncMap</a>.find(fpEnum) != <a class="code" href="classSampleHandlerFD.html#a577a57992e396a5b34efcd3bb6ed45cf">funcParsFuncMap</a>.end()) {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Functional parameter enum {} already registered in funcParsFuncMap&quot;</span>, fpEnum);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <a class="code" href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">funcParsNamesMap</a>[fpName] = fpEnum;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a888112d7eebd6fdb877c0015e1951f9d">funcParsNamesVec</a>.push_back(fpName);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a577a57992e396a5b34efcd3bb6ed45cf">funcParsFuncMap</a>[fpEnum] = fpFunc;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a577a57992e396a5b34efcd3bb6ed45cf"><div class="ttname"><a href="classSampleHandlerFD.html#a577a57992e396a5b34efcd3bb6ed45cf">SampleHandlerFD::funcParsFuncMap</a></div><div class="ttdeci">std::unordered_map&lt; int, FuncParFuncType &gt; funcParsFuncMap</div><div class="ttdoc">HH - a map that relates the funcpar enum to pointer of the actual function.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00269">SampleHandlerFD.h:269</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a888112d7eebd6fdb877c0015e1951f9d"><div class="ttname"><a href="classSampleHandlerFD.html#a888112d7eebd6fdb877c0015e1951f9d">SampleHandlerFD::funcParsNamesVec</a></div><div class="ttdeci">std::vector&lt; std::string &gt; funcParsNamesVec</div><div class="ttdoc">HH - a vector of string names for each functional parameter.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00271">SampleHandlerFD.h:271</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_af8ed9895a0b2802e45569ce2d1a0a837"><div class="ttname"><a href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">SampleHandlerFD::funcParsNamesMap</a></div><div class="ttdeci">std::unordered_map&lt; std::string, int &gt; funcParsNamesMap</div><div class="ttdoc">HH - a map that relates the name of the functional parameter to funcpar enum.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00266">SampleHandlerFD.h:266</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac1f944f73f43a68be3af388cd17bc5e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1f944f73f43a68be3af388cd17bc5e3">&#9670;&nbsp;</a></span>ResetHistograms()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::ResetHistograms </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function to reset histograms. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00469">469</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                                      {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">// **************************************************  </span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="comment">// DB Reset values stored in PDF array to 0.</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="comment">// Don&#39;t openMP this; no significant gain</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="GetPostfitParamPlots_8cpp.html#ae4842c1619a902b2761696f3849889a1">nBins</a> = <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetNBins();</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  std::fill(<a class="code" href="classSampleHandlerFD.html#a85415d4ac54a5aefe78e5ab4d7bdb769">SampleHandlerFD_array</a>, <a class="code" href="classSampleHandlerFD.html#a85415d4ac54a5aefe78e5ab4d7bdb769">SampleHandlerFD_array</a> + <a class="code" href="GetPostfitParamPlots_8cpp.html#ae4842c1619a902b2761696f3849889a1">nBins</a>, 0.0);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#a1ff1ef7d99cee6d6a9fba74296d4d0ea">FirstTimeW2</a>) {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    std::fill(<a class="code" href="classSampleHandlerFD.html#af5c6a3701c6ac76a96886ff13300a53b">SampleHandlerFD_array_w2</a>, <a class="code" href="classSampleHandlerFD.html#af5c6a3701c6ac76a96886ff13300a53b">SampleHandlerFD_array_w2</a> + <a class="code" href="GetPostfitParamPlots_8cpp.html#ae4842c1619a902b2761696f3849889a1">nBins</a>, 0.0);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  }</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;} <span class="comment">// end function</span></div>
<div class="ttc" id="aGetPostfitParamPlots_8cpp_html_ae4842c1619a902b2761696f3849889a1"><div class="ttname"><a href="GetPostfitParamPlots_8cpp.html#ae4842c1619a902b2761696f3849889a1">nBins</a></div><div class="ttdeci">int nBins</div><div class="ttdef"><b>Definition:</b> <a href="GetPostfitParamPlots_8cpp_source.html#l00059">GetPostfitParamPlots.cpp:59</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3ced3ca13adffc1f795b528faba8b3f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ced3ca13adffc1f795b528faba8b3f3">&#9670;&nbsp;</a></span>ResetShifts()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void SampleHandlerFD::ResetShifts </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iEvent</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>HH - reset the shifted values to the original values. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00250">250</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;{(void)iEvent;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9d5273302853361d5774998fb17805b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d5273302853361d5774998fb17805b2">&#9670;&nbsp;</a></span>ReturnHistsBySelection1D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; TH1 * &gt; SampleHandlerFD::ReturnHistsBySelection1D </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>KinematicProjection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Selection1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Selection2</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>Axis</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01875">1875</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;                                                                                                                           {</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;  std::vector&lt;TH1*&gt; hHistList;</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;  std::string legendEntry;</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160; </div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">THStackLeg</a> != <span class="keyword">nullptr</span>) {<span class="keyword">delete</span> <a class="code" href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">THStackLeg</a>;}</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;  <a class="code" href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">THStackLeg</a> = <span class="keyword">new</span> TLegend(0.1,0.1,0.9,0.9);</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160; </div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;  <span class="keywordtype">int</span> iMax = -1;</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;  <span class="keywordflow">if</span> (Selection1 == FDPlotType::kModePlot) {</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    iMax = <a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetNModes();</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;  }</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;  <span class="keywordflow">if</span> (Selection1 == FDPlotType::kOscChannelPlot) {</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    iMax = <a class="code" href="classSampleHandlerFD.html#aac276e3f10be081ce8e7f94df131490d">GetNOscChannels</a>(iSample);</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;  }</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;  <span class="keywordflow">if</span> (iMax == -1) {</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;You&#39;ve passed me a Selection1 which was not implemented in ReturnHistsBySelection1D. Selection1 and Selection2 are counters for different indexable quantities&quot;</span>);</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;  }</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160; </div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;iMax;i++) {</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    <span class="keywordflow">if</span> (Selection1 == FDPlotType::kModePlot) {</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;      hHistList.push_back(<a class="code" href="classSampleHandlerFD.html#afa55768f84faef3f9f438d197dd46194">Get1DVarHistByModeAndChannel</a>(iSample, KinematicProjection,i,Selection2,WeightStyle,XAxis));</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;      <a class="code" href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">THStackLeg</a>-&gt;AddEntry(hHistList[i],(<a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetMaCh3ModeName(i)+Form(<span class="stringliteral">&quot; : (%4.2f)&quot;</span>,hHistList[i]-&gt;Integral())).c_str(),<span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160; </div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;      hHistList[i]-&gt;SetFillColor(<span class="keyword">static_cast&lt;</span>Color_t<span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetMaCh3ModePlotColor(i)));</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;      hHistList[i]-&gt;SetLineColor(<span class="keyword">static_cast&lt;</span>Color_t<span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetMaCh3ModePlotColor(i)));</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    }</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    <span class="keywordflow">if</span> (Selection1 == FDPlotType::kOscChannelPlot) {</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;      hHistList.push_back(<a class="code" href="classSampleHandlerFD.html#afa55768f84faef3f9f438d197dd46194">Get1DVarHistByModeAndChannel</a>(iSample, KinematicProjection,Selection2,i,WeightStyle,XAxis));</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;      <a class="code" href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">THStackLeg</a>-&gt;AddEntry(hHistList[i],(<a class="code" href="classSampleHandlerFD.html#a802e5b253f0b23d1e206ef9c0008301a">GetFlavourName</a>(iSample, i)+Form(<span class="stringliteral">&quot; | %4.2f&quot;</span>,hHistList[i]-&gt;Integral())).c_str(),<span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    }</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;  }</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160; </div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;  <span class="keywordflow">return</span> hHistList;</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a47a345341de0cd86acababcc2d66cf91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47a345341de0cd86acababcc2d66cf91">&#9670;&nbsp;</a></span>ReturnHistsBySelection2D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; TH2 * &gt; SampleHandlerFD::ReturnHistsBySelection2D </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>KinematicProjectionX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>KinematicProjectionY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Selection1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Selection2</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>XAxis</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>YAxis</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01913">1913</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;                                                                                        {</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;  std::vector&lt;TH2*&gt; hHistList;</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160; </div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;  <span class="keywordtype">int</span> iMax = -1;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;  <span class="keywordflow">if</span> (Selection1 == FDPlotType::kModePlot) {</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    iMax = <a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetNModes();</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;  }</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;  <span class="keywordflow">if</span> (Selection1 == FDPlotType::kOscChannelPlot) {</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    iMax = <a class="code" href="classSampleHandlerFD.html#aac276e3f10be081ce8e7f94df131490d">GetNOscChannels</a>(iSample);</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;  }</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;  <span class="keywordflow">if</span> (iMax == -1) {</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;You&#39;ve passed me a Selection1 which was not implemented in ReturnHistsBySelection1D. Selection1 and Selection2 are counters for different indexable quantities&quot;</span>);</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;  }</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160; </div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;iMax;i++) {</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <span class="keywordflow">if</span> (Selection1 == FDPlotType::kModePlot) {</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;      hHistList.push_back(<a class="code" href="classSampleHandlerFD.html#a86394ef51d6bab1b9943f11774e99c23">Get2DVarHistByModeAndChannel</a>(iSample, KinematicProjectionX,KinematicProjectionY,i,Selection2,WeightStyle,XAxis,YAxis));</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    }</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    <span class="keywordflow">if</span> (Selection1 == FDPlotType::kOscChannelPlot) {</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;      hHistList.push_back(<a class="code" href="classSampleHandlerFD.html#a86394ef51d6bab1b9943f11774e99c23">Get2DVarHistByModeAndChannel</a>(iSample, KinematicProjectionX,KinematicProjectionY,Selection2,i,WeightStyle,XAxis,YAxis));</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    }</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;  }</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160; </div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;  <span class="keywordflow">return</span> hHistList;</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae0000225f48d985e8dd60bc94a1c0425"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0000225f48d985e8dd60bc94a1c0425">&#9670;&nbsp;</a></span>ReturnKinematicParameter() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double SampleHandlerFD::ReturnKinematicParameter </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>KinematicVariable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iEvent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classPySampleHandlerFD.html#a1c451a61109ab8106d9247f9f0e149ef">PySampleHandlerFD</a>.</p>

</div>
</div>
<a id="ad0f549802b5625871e11d86905989697"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0f549802b5625871e11d86905989697">&#9670;&nbsp;</a></span>ReturnKinematicParameter() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double SampleHandlerFD::ReturnKinematicParameter </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>KinematicParamter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iEvent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the value of an associated kinematic parameter for an event. </p>

<p>Implemented in <a class="el" href="classPySampleHandlerFD.html#ab7b8b57a202f81731e537c678bf1b33f">PySampleHandlerFD</a>.</p>

</div>
</div>
<a id="a2cee961e07a80484fe568898f41e4965"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cee961e07a80484fe568898f41e4965">&#9670;&nbsp;</a></span>ReturnKinematicParameterBinning()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; SampleHandlerFD::ReturnKinematicParameterBinning </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>KinematicParameter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the binning used to draw a kinematic parameter. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000008">Todo:</a></b></dt><dd>might be useful to allow overwriting this </dd></dl>

<p>Implements <a class="el" href="classSampleHandlerBase.html#aab140c97a440fec2ea4a62a481992c81">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01597">1597</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;                                                                                                                              {</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;  <span class="comment">// If any of fit based variables return them</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="comment"></span>  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;IsUniform(Sample)) {</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iDim = 0; iDim &lt; <a class="code" href="classSampleHandlerFD.html#a768fdb89852db345ec267d30bd462cb2">GetNDim</a>(Sample); iDim++) {</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;      <span class="keywordflow">if</span>(KinematicParameter == <a class="code" href="classSampleHandlerFD.html#a7f3923d1e2b39df2e1bf2348312925a6">GetKinVarName</a>(Sample, iDim)) {</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetBinEdges(Sample, iDim);</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;      }</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    } <span class="comment">// end loop over Dimension</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  } <span class="comment">// end loop over IsUniform</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160; </div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;  <span class="keyword">auto</span> MakeBins = [](<span class="keywordtype">int</span> <a class="code" href="GetPostfitParamPlots_8cpp.html#ae4842c1619a902b2761696f3849889a1">nBins</a>) {</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    std::vector&lt;double&gt; bins(<a class="code" href="GetPostfitParamPlots_8cpp.html#ae4842c1619a902b2761696f3849889a1">nBins</a> + 1);</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= <a class="code" href="GetPostfitParamPlots_8cpp.html#ae4842c1619a902b2761696f3849889a1">nBins</a>; ++i)</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;      bins[i] = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(i) - 0.5;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    <span class="keywordflow">return</span> bins;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;  };</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160; </div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;  <span class="keywordflow">if</span> (KinematicParameter == <span class="stringliteral">&quot;OscillationChannel&quot;</span>) {</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    <span class="keywordflow">return</span> MakeBins(<a class="code" href="classSampleHandlerFD.html#aac276e3f10be081ce8e7f94df131490d">GetNOscChannels</a>(Sample));</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (KinematicParameter == <span class="stringliteral">&quot;Mode&quot;</span>) {</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    <span class="keywordflow">return</span> MakeBins(<a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetNModes());</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  }</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160; </div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160; </div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  std::vector&lt;double&gt; BinningVect;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  <span class="comment">// We first check if binning for a sample has been specified</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  <span class="keyword">auto</span> BinningConfig = <a class="code" href="YamlHelper_8h.html#ad802d5a5acdc16a796b21af74f6f5f59">M3OpenConfig</a>(<a class="code" href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;BinningFile&quot;</span>].as&lt;std::string&gt;());</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  <span class="keywordflow">if</span>(BinningConfig[<a class="code" href="classSampleHandlerFD.html#adfad2507ad845ad36fff3c82231a143c">GetSampleTitle</a>(Sample)] &amp;&amp; BinningConfig[<a class="code" href="classSampleHandlerFD.html#adfad2507ad845ad36fff3c82231a143c">GetSampleTitle</a>(Sample)][KinematicParameter]){</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    BinningVect = Get&lt;std::vector&lt;double&gt;&gt;(BinningConfig[<a class="code" href="classSampleHandlerFD.html#adfad2507ad845ad36fff3c82231a143c">GetSampleTitle</a>(Sample)][KinematicParameter], __FILE__, __LINE__);</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    BinningVect = Get&lt;std::vector&lt;double&gt;&gt;(BinningConfig[KinematicParameter], __FILE__, __LINE__);</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  }</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160; </div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  <span class="comment">// Ensure binning is increasing</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;  <span class="keyword">auto</span> IsIncreasing = [](<span class="keyword">const</span> std::vector&lt;double&gt;&amp; vec) {</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 1; i &lt; vec.size(); ++i) {</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;      <span class="keywordflow">if</span> (vec[i] &lt;= vec[i-1]) {</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;      }</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    }</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;  };</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160; </div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;  <span class="keywordflow">if</span> (!IsIncreasing(BinningVect)) {</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Binning for {} is not increasing [{}]&quot;</span>, KinematicParameter, fmt::join(BinningVect, <span class="stringliteral">&quot;, &quot;</span>));</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__,__LINE__);</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;  }</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160; </div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;  <span class="keywordflow">return</span> BinningVect;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;}</div>
<div class="ttc" id="aYamlHelper_8h_html_ad802d5a5acdc16a796b21af74f6f5f59"><div class="ttname"><a href="YamlHelper_8h.html#ad802d5a5acdc16a796b21af74f6f5f59">M3OpenConfig</a></div><div class="ttdeci">#define M3OpenConfig(filename)</div><div class="ttdoc">Macro to simplify calling LoadYaml with file and line info.</div><div class="ttdef"><b>Definition:</b> <a href="YamlHelper_8h_source.html#l00589">YamlHelper.h:589</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae2769d593f34e8356b545af076818f89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2769d593f34e8356b545af076818f89">&#9670;&nbsp;</a></span>ReturnKinematicParameterFromString()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SampleHandlerFD::ReturnKinematicParameterFromString </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>KinematicStr</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ETA function to generically convert a string from xsec cov to a kinematic type. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01544">1544</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                                                                                                    {</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;  <span class="keyword">auto</span> it = <a class="code" href="classSampleHandlerFD.html#aae37732e76f0b17b6f124bd5543177e4">KinematicParameters</a>-&gt;find(KinematicParameterStr);</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;  <span class="keywordflow">if</span> (it != <a class="code" href="classSampleHandlerFD.html#aae37732e76f0b17b6f124bd5543177e4">KinematicParameters</a>-&gt;end()) <span class="keywordflow">return</span> it-&gt;second;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160; </div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Did not recognise Kinematic Parameter type: {}&quot;</span>, KinematicParameterStr);</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160; </div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a>;</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae638fe05a353bdc6dac8b64150f200bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae638fe05a353bdc6dac8b64150f200bf">&#9670;&nbsp;</a></span>ReturnKinematicVector() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::vector&lt;double&gt; SampleHandlerFD::ReturnKinematicVector </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>KinematicVariable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iEvent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00292">292</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;{<span class="keywordflow">return</span> {}; (void)KinematicVariable; (void)iEvent;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae98d72c6c30697e32fcb464923456fc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae98d72c6c30697e32fcb464923456fc0">&#9670;&nbsp;</a></span>ReturnKinematicVector() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::vector&lt;double&gt; SampleHandlerFD::ReturnKinematicVector </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>KinematicParameter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iEvent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00291">291</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;{<span class="keywordflow">return</span> {}; (void)KinematicParameter; (void)iEvent;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad81e082a5a4c86e51fc748bffd1dfa9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad81e082a5a4c86e51fc748bffd1dfa9e">&#9670;&nbsp;</a></span>ReturnKinematicVectorFromString()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SampleHandlerFD::ReturnKinematicVectorFromString </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>KinematicStr</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01571">1571</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                                                                                              {</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;  <span class="keyword">auto</span> it = <a class="code" href="classSampleHandlerFD.html#a5d762b169bab4454bbdb1b387c09f4a7">KinematicVectors</a>-&gt;find(KinematicVectorStr);</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  <span class="keywordflow">if</span> (it != <a class="code" href="classSampleHandlerFD.html#a5d762b169bab4454bbdb1b387c09f4a7">KinematicVectors</a>-&gt;end()) <span class="keywordflow">return</span> it-&gt;second;</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160; </div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Did not recognise Kinematic Vector: {}&quot;</span>, KinematicVectorStr);</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;  <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160; </div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a>;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae77ac4a4edcaf3c6b5f7c05ddaed8e25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae77ac4a4edcaf3c6b5f7c05ddaed8e25">&#9670;&nbsp;</a></span>ReturnStackedHistBySelection1D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">THStack * SampleHandlerFD::ReturnStackedHistBySelection1D </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>KinematicProjection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Selection1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Selection2</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>Axis</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01945">1945</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;                                                                                                                        {</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  std::vector&lt;TH1*&gt; HistList = <a class="code" href="classSampleHandlerFD.html#a9d5273302853361d5774998fb17805b2">ReturnHistsBySelection1D</a>(iSample, KinematicProjection, Selection1, Selection2, WeightStyle, XAxis);</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;  THStack* StackHist = <span class="keyword">new</span> THStack((<a class="code" href="classSampleHandlerFD.html#adfad2507ad845ad36fff3c82231a143c">GetSampleTitle</a>(iSample)+<span class="stringliteral">&quot;_&quot;</span>+KinematicProjection+<span class="stringliteral">&quot;_Stack&quot;</span>).c_str(),<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;HistList.size();i++) {</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    StackHist-&gt;Add(HistList[i]);</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;  }</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;  <span class="keywordflow">return</span> StackHist;</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8be73835c2d9f0e50d738c4f204a0286"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8be73835c2d9f0e50d738c4f204a0286">&#9670;&nbsp;</a></span>ReturnStackHistLegend()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TLegend* SampleHandlerFD::ReturnStackHistLegend </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00144">144</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">THStackLeg</a>;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3e88e3720a6a8d3384a6b8d317795c74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e88e3720a6a8d3384a6b8d317795c74">&#9670;&nbsp;</a></span>ReturnStringFromKinematicParameter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::ReturnStringFromKinematicParameter </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>KinematicVariable</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ETA function to generically convert a kinematic type from xsec cov to a string. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01556">1556</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                                                                                                {</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  <span class="keyword">auto</span> it = <a class="code" href="classSampleHandlerFD.html#ad7ac675cc4ce81bec42e0700f1ff2620">ReversedKinematicParameters</a>-&gt;find(KinematicParameter);</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  <span class="keywordflow">if</span> (it != <a class="code" href="classSampleHandlerFD.html#ad7ac675cc4ce81bec42e0700f1ff2620">ReversedKinematicParameters</a>-&gt;end()) {</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    <span class="keywordflow">return</span> it-&gt;second;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;  }</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160; </div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Did not recognise Kinematic Parameter type: {}&quot;</span>, KinematicParameter);</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160; </div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0c1df0e7858ce64cc2a81fab0e82f3cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c1df0e7858ce64cc2a81fab0e82f3cd">&#9670;&nbsp;</a></span>ReturnStringFromKinematicVector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::ReturnStringFromKinematicVector </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>KinematicVariable</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01583">1583</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;                                                                                          {</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;  <span class="keyword">auto</span> it = <a class="code" href="classSampleHandlerFD.html#a341f7bf83eb74ba5d27a2c9616202eba">ReversedKinematicVectors</a>-&gt;find(KinematicVector);</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  <span class="keywordflow">if</span> (it != <a class="code" href="classSampleHandlerFD.html#a341f7bf83eb74ba5d27a2c9616202eba">ReversedKinematicVectors</a>-&gt;end()) {</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    <span class="keywordflow">return</span> it-&gt;second;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;  }</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160; </div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Did not recognise Kinematic Vector: {}&quot;</span>, KinematicVector);</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;  <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160; </div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae3e03bd9beffb8b31acfd3bb5ebb44a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3e03bd9beffb8b31acfd3bb5ebb44a2">&#9670;&nbsp;</a></span>Reweight()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::Reweight </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classSampleHandlerBase.html#a3efb49c2a39d87b71e4dec7c7115fa88">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00337">337</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                               {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">//************************************************</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="comment">//KS: Reset the histograms before reweight </span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <a class="code" href="classSampleHandlerFD.html#ac1f944f73f43a68be3af388cd17bc5e3">ResetHistograms</a>();</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="comment">//You only need to do these things if Oscillator has been initialised</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="comment">//if not then you&#39;re not considering oscillations</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">Oscillator</a>) <a class="code" href="classSampleHandlerFD.html#aa7115dd53d73a45fb64c565561095b6a">Oscillator</a>-&gt;Evaluate();</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="comment">// Calculate weight coming from all splines if we initialised handler</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">SplineHandler</a>) <a class="code" href="classSampleHandlerFD.html#a17193b3fe2b44e6484f9eefda86f97dd">SplineHandler</a>-&gt;Evaluate();</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="comment">// Call entirely different routine if we&#39;re running with openMP</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  FillArray_MP();</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="preprocessor">  #else</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <a class="code" href="classSampleHandlerFD.html#aeef0f943cb1e0d4c9bba4814cb24a507">FillArray</a>();</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="comment">//KS: If you want to not update W2 wights then uncomment this line</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="classSampleHandlerFD.html#aa654562842a0da51ff917aaed517310e">UpdateW2</a>) <a class="code" href="classSampleHandlerFD.html#a1ff1ef7d99cee6d6a9fba74296d4d0ea">FirstTimeW2</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_ac1f944f73f43a68be3af388cd17bc5e3"><div class="ttname"><a href="classSampleHandlerFD.html#ac1f944f73f43a68be3af388cd17bc5e3">SampleHandlerFD::ResetHistograms</a></div><div class="ttdeci">void ResetHistograms()</div><div class="ttdoc">Helper function to reset histograms.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00469">SampleHandlerFD.cpp:469</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_aeef0f943cb1e0d4c9bba4814cb24a507"><div class="ttname"><a href="classSampleHandlerFD.html#aeef0f943cb1e0d4c9bba4814cb24a507">SampleHandlerFD::FillArray</a></div><div class="ttdeci">void FillArray()</div><div class="ttdoc">DB Nice new multi-threaded function which calculates the event weights and fills the relevant bins of...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00367">SampleHandlerFD.cpp:367</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a90c390753da5f5561c66450440a19beb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90c390753da5f5561c66450440a19beb">&#9670;&nbsp;</a></span>SaveAdditionalInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::SaveAdditionalInfo </td>
          <td>(</td>
          <td class="paramtype">TDirectory *&#160;</td>
          <td class="paramname"><em>Dir</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Store additional info in a chan. </p>

<p>Reimplemented from <a class="el" href="classSampleHandlerBase.html#abaee29f1c5b8229417a0de3b5a36ddb0">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01252">1252</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                                                        {</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  Dir-&gt;cd();</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160; </div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  YAML::Node Config = <a class="code" href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleManager</a>-&gt;raw();</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  TMacro ConfigSave = <a class="code" href="YamlHelper_8h.html#a2d4f3247b6e13ef8c127ff66e699d3cb">YAMLtoTMacro</a>(Config, (std::string(<span class="stringliteral">&quot;Config_&quot;</span>) + <a class="code" href="classSampleHandlerFD.html#a6101b46360ae54fe37dd1243f3f7f51e">GetName</a>()));</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;  ConfigSave.Write();</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160; </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iSample = 0; iSample &lt; <a class="code" href="classSampleHandlerBase.html#ac4b73a8841ff9bab2fb08b578ad4137f">GetNsamples</a>(); iSample++)</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  {</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    std::unique_ptr&lt;TH1&gt; data_hist;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160; </div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#a768fdb89852db345ec267d30bd462cb2">GetNDim</a>(iSample) == 1) {</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      data_hist = M3::Clone&lt;TH1D&gt;(<span class="keyword">dynamic_cast&lt;</span>TH1D*<span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerFD.html#ac2fa527d43bfe7b5dccf767b2445fbb0">GetDataHist</a>(iSample)), <span class="stringliteral">&quot;data_&quot;</span> + <a class="code" href="classSampleHandlerFD.html#adfad2507ad845ad36fff3c82231a143c">GetSampleTitle</a>(iSample));</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;      data_hist-&gt;GetXaxis()-&gt;SetTitle(<a class="code" href="classSampleHandlerFD.html#a9aebf7da41ad6ddb87e3081a7f4763ec">GetXBinVarName</a>(iSample).c_str());</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;      data_hist-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Number of Events&quot;</span>);</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#a768fdb89852db345ec267d30bd462cb2">GetNDim</a>(iSample) == 2) {</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;IsUniform(iSample)) {</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        data_hist = M3::Clone&lt;TH2D&gt;(<span class="keyword">dynamic_cast&lt;</span>TH2D*<span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerFD.html#ac2fa527d43bfe7b5dccf767b2445fbb0">GetDataHist</a>(iSample)), <span class="stringliteral">&quot;data_&quot;</span> + <a class="code" href="classSampleHandlerFD.html#adfad2507ad845ad36fff3c82231a143c">GetSampleTitle</a>(iSample));</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        data_hist = M3::Clone&lt;TH2Poly&gt;(<span class="keyword">dynamic_cast&lt;</span>TH2Poly*<span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerFD.html#ac2fa527d43bfe7b5dccf767b2445fbb0">GetDataHist</a>(iSample)), <span class="stringliteral">&quot;data_&quot;</span> + <a class="code" href="classSampleHandlerFD.html#adfad2507ad845ad36fff3c82231a143c">GetSampleTitle</a>(iSample));</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;      }</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;      data_hist-&gt;GetXaxis()-&gt;SetTitle(<a class="code" href="classSampleHandlerFD.html#a9aebf7da41ad6ddb87e3081a7f4763ec">GetXBinVarName</a>(iSample).c_str());</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;      data_hist-&gt;GetYaxis()-&gt;SetTitle(<a class="code" href="classSampleHandlerFD.html#a69d66592696bee9e73f61649c681a573">GetYBinVarName</a>(iSample).c_str());</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;      data_hist-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Number of Events&quot;</span>);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;      data_hist = M3::Clone&lt;TH1D&gt;(<span class="keyword">dynamic_cast&lt;</span>TH1D*<span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerFD.html#ac2fa527d43bfe7b5dccf767b2445fbb0">GetDataHist</a>(iSample)), <span class="stringliteral">&quot;data_&quot;</span> + <a class="code" href="classSampleHandlerFD.html#adfad2507ad845ad36fff3c82231a143c">GetSampleTitle</a>(iSample));</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;      <span class="keywordtype">int</span> nbins = <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetNBins(iSample);</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iBin = 0; iBin &lt; nbins; iBin++) {</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        <span class="keyword">auto</span> BinName = <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetBinName(iSample, iBin);</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        data_hist-&gt;GetXaxis()-&gt;SetBinLabel(iBin+1, BinName.c_str());</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;      }</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;      data_hist-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Number of Events&quot;</span>);</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    }</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160; </div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <span class="keywordflow">if</span> (!data_hist) {</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;nullptr data hist :(&quot;</span>);</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    }</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160; </div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    data_hist-&gt;SetTitle((<span class="stringliteral">&quot;data_&quot;</span> + <a class="code" href="classSampleHandlerFD.html#adfad2507ad845ad36fff3c82231a143c">GetSampleTitle</a>(iSample)).c_str());</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    data_hist-&gt;Write();</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  }</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;}</div>
<div class="ttc" id="aYamlHelper_8h_html_a2d4f3247b6e13ef8c127ff66e699d3cb"><div class="ttname"><a href="YamlHelper_8h.html#a2d4f3247b6e13ef8c127ff66e699d3cb">YAMLtoTMacro</a></div><div class="ttdeci">TMacro YAMLtoTMacro(const YAML::Node &amp;yaml_node, const std::string &amp;name)</div><div class="ttdoc">Convert a YAML node to a ROOT TMacro object.</div><div class="ttdef"><b>Definition:</b> <a href="YamlHelper_8h_source.html#l00167">YamlHelper.h:167</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa5fed299058818825839921541e99617"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5fed299058818825839921541e99617">&#9670;&nbsp;</a></span>SetBinning()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::SetBinning </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>set the binning for 2D sample used for the likelihood calculation </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00735">735</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                                 {</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iSample = 0; iSample &lt; <a class="code" href="classSampleHandlerBase.html#ac4b73a8841ff9bab2fb08b578ad4137f">GetNsamples</a>(); iSample++)</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  {</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keywordtype">int</span> Dimension = <a class="code" href="classSampleHandlerFD.html#a768fdb89852db345ec267d30bd462cb2">GetNDim</a>(iSample);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    std::string HistTitle = <a class="code" href="classSampleHandlerFD.html#adfad2507ad845ad36fff3c82231a143c">GetSampleTitle</a>(iSample);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="keyword">auto</span>* SamDet = &amp;<a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[iSample];</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keywordflow">if</span>(Dimension == 1) {</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      <span class="keyword">auto</span> XVec = <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetBinEdges(iSample, 0);</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      SamDet-&gt;DataHist = <span class="keyword">new</span> TH1D((<span class="stringliteral">&quot;d&quot;</span> + HistTitle).c_str(), HistTitle.c_str(), <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(XVec.size()-1), XVec.data());</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      SamDet-&gt;MCHist   = <span class="keyword">new</span> TH1D((<span class="stringliteral">&quot;h&quot;</span> + HistTitle).c_str(), HistTitle.c_str(), <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(XVec.size()-1), XVec.data());</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      SamDet-&gt;W2Hist   = <span class="keyword">new</span> TH1D((<span class="stringliteral">&quot;w&quot;</span> + HistTitle).c_str(), HistTitle.c_str(), <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(XVec.size()-1), XVec.data());</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160; </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <span class="comment">// Set all titles so most of projections don&#39;t have empty titles...</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      SamDet-&gt;DataHist-&gt;GetXaxis()-&gt;SetTitle(SamDet-&gt;VarStr[0].c_str());</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      SamDet-&gt;DataHist-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Events&quot;</span>);</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      SamDet-&gt;MCHist-&gt;GetXaxis()-&gt;SetTitle(SamDet-&gt;VarStr[0].c_str());</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      SamDet-&gt;MCHist-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Events&quot;</span>);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      SamDet-&gt;W2Hist-&gt;GetXaxis()-&gt;SetTitle(SamDet-&gt;VarStr[0].c_str());</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      SamDet-&gt;W2Hist-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Events&quot;</span>);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Dimension == 2){</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;IsUniform(iSample)) {</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <span class="keyword">auto</span> XVec = <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetBinEdges(iSample, 0);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="keyword">auto</span> YVec = <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetBinEdges(iSample, 1);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="keywordtype">int</span> nX = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(XVec.size() - 1);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="keywordtype">int</span> nY = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(YVec.size() - 1);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        SamDet-&gt;DataHist = <span class="keyword">new</span> TH2D((<span class="stringliteral">&quot;d&quot;</span> + HistTitle).c_str(), HistTitle.c_str(), nX, XVec.data(), nY, YVec.data());</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        SamDet-&gt;MCHist   = <span class="keyword">new</span> TH2D((<span class="stringliteral">&quot;h&quot;</span> + HistTitle).c_str(), HistTitle.c_str(), nX, XVec.data(), nY, YVec.data());</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        SamDet-&gt;W2Hist   = <span class="keyword">new</span> TH2D((<span class="stringliteral">&quot;w&quot;</span> + HistTitle).c_str(), HistTitle.c_str(), nX, XVec.data(), nY, YVec.data());</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        <span class="keyword">auto</span> AddBinsToTH2Poly = [](TH2Poly* hist, <span class="keyword">const</span> std::vector&lt;BinInfo&gt;&amp; bins) {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; bin : bins) {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            <span class="keywordtype">double</span> xLow  = bin.Extent[0][0];</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            <span class="keywordtype">double</span> xHigh = bin.Extent[0][1];</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            <span class="keywordtype">double</span> yLow  = bin.Extent[1][0];</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            <span class="keywordtype">double</span> yHigh = bin.Extent[1][1];</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            <span class="keywordtype">double</span> x[4] = {xLow, xHigh, xHigh, xLow};</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            <span class="keywordtype">double</span> y[4] = {yLow, yLow, yHigh, yHigh};</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160; </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            hist-&gt;AddBin(4, x, y);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;          }</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        };</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <span class="comment">// Create all three histograms</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        SamDet-&gt;DataHist = <span class="keyword">new</span> TH2Poly();</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        SamDet-&gt;DataHist-&gt;SetName((<span class="stringliteral">&quot;d&quot;</span> + HistTitle).c_str());</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        SamDet-&gt;DataHist-&gt;SetTitle(HistTitle.c_str());</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160; </div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        SamDet-&gt;MCHist = <span class="keyword">new</span> TH2Poly();</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        SamDet-&gt;MCHist-&gt;SetName((<span class="stringliteral">&quot;h&quot;</span> + HistTitle).c_str());</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        SamDet-&gt;MCHist-&gt;SetTitle(HistTitle.c_str());</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        SamDet-&gt;W2Hist = <span class="keyword">new</span> TH2Poly();</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        SamDet-&gt;W2Hist-&gt;SetName((<span class="stringliteral">&quot;w&quot;</span> + HistTitle).c_str());</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        SamDet-&gt;W2Hist-&gt;SetTitle(HistTitle.c_str());</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160; </div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <span class="comment">// Add bins to each</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        AddBinsToTH2Poly(<span class="keyword">static_cast&lt;</span>TH2Poly*<span class="keyword">&gt;</span>(SamDet-&gt;DataHist), <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetNonUniformBins(iSample));</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        AddBinsToTH2Poly(<span class="keyword">static_cast&lt;</span>TH2Poly*<span class="keyword">&gt;</span>(SamDet-&gt;MCHist),   <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetNonUniformBins(iSample));</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        AddBinsToTH2Poly(<span class="keyword">static_cast&lt;</span>TH2Poly*<span class="keyword">&gt;</span>(SamDet-&gt;W2Hist),   <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetNonUniformBins(iSample));</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      }</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160; </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <span class="comment">// Set all titles so most of projections don&#39;t have empty titles...</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      SamDet-&gt;DataHist-&gt;GetXaxis()-&gt;SetTitle(SamDet-&gt;VarStr[0].c_str());</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      SamDet-&gt;DataHist-&gt;GetYaxis()-&gt;SetTitle(SamDet-&gt;VarStr[1].c_str());</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      SamDet-&gt;MCHist-&gt;GetXaxis()-&gt;SetTitle(SamDet-&gt;VarStr[0].c_str());</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      SamDet-&gt;MCHist-&gt;GetYaxis()-&gt;SetTitle(SamDet-&gt;VarStr[1].c_str());</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      SamDet-&gt;W2Hist-&gt;GetXaxis()-&gt;SetTitle(SamDet-&gt;VarStr[0].c_str());</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      SamDet-&gt;W2Hist-&gt;GetYaxis()-&gt;SetTitle(SamDet-&gt;VarStr[1].c_str());</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="keywordtype">int</span> nbins = <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetNBins(iSample);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      SamDet-&gt;DataHist = <span class="keyword">new</span> TH1D((<span class="stringliteral">&quot;d&quot;</span> + HistTitle).c_str(), HistTitle.c_str(), nbins, 0, nbins);</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      SamDet-&gt;MCHist   = <span class="keyword">new</span> TH1D((<span class="stringliteral">&quot;h&quot;</span> + HistTitle).c_str(), HistTitle.c_str(), nbins, 0, nbins);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      SamDet-&gt;W2Hist   = <span class="keyword">new</span> TH1D((<span class="stringliteral">&quot;w&quot;</span> + HistTitle).c_str(), HistTitle.c_str(), nbins, 0, nbins);</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160; </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iBin = 0; iBin &lt; nbins; iBin++) {</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <span class="keyword">auto</span> BinName = <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetBinName(iSample, iBin);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        SamDet-&gt;DataHist-&gt;GetXaxis()-&gt;SetBinLabel(iBin+1, BinName.c_str());</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        SamDet-&gt;MCHist-&gt;GetXaxis()-&gt;SetBinLabel(iBin+1, BinName.c_str());</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        SamDet-&gt;W2Hist-&gt;GetXaxis()-&gt;SetBinLabel(iBin+1, BinName.c_str());</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      }</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      <span class="comment">// Set all titles so most of projections don&#39;t have empty titles...</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      SamDet-&gt;DataHist-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Events&quot;</span>);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      SamDet-&gt;MCHist-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Events&quot;</span>);</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      SamDet-&gt;W2Hist-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Events&quot;</span>);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    }</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    SamDet-&gt;DataHist-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    SamDet-&gt;MCHist-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    SamDet-&gt;W2Hist-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  }</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160; </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <span class="comment">//Set the number of X and Y bins now</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <a class="code" href="classSampleHandlerFD.html#ae9ff78dd87844a8aaccb24f1381d2c78">SetupReweightArrays</a>();</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a409908a58aae468475a482b3db7c9bea">FindNominalBinAndEdges</a>();</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a409908a58aae468475a482b3db7c9bea"><div class="ttname"><a href="classSampleHandlerFD.html#a409908a58aae468475a482b3db7c9bea">SampleHandlerFD::FindNominalBinAndEdges</a></div><div class="ttdeci">void FindNominalBinAndEdges()</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00836">SampleHandlerFD.cpp:836</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ae9ff78dd87844a8aaccb24f1381d2c78"><div class="ttname"><a href="classSampleHandlerFD.html#ae9ff78dd87844a8aaccb24f1381d2c78">SampleHandlerFD::SetupReweightArrays</a></div><div class="ttdeci">void SetupReweightArrays()</div><div class="ttdoc">Initialise data, MC and W2 histograms.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00721">SampleHandlerFD.cpp:721</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a330f801dfd7c0d14326048e93c5a51ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a330f801dfd7c0d14326048e93c5a51ae">&#9670;&nbsp;</a></span>SetupExperimentMC()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual int SampleHandlerFD::SetupExperimentMC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Experiment specific setup, returns the number of events which were loaded. </p>

<p>Implemented in <a class="el" href="classPySampleHandlerFD.html#a209d5dc28b6ebd081dea6b013247aca7">PySampleHandlerFD</a>.</p>

</div>
</div>
<a id="a8e112b4f306f7b792da77f6299535c1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e112b4f306f7b792da77f6299535c1b">&#9670;&nbsp;</a></span>SetupFDMC()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void SampleHandlerFD::SetupFDMC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function which translates experiment struct into core struct. </p>

<p>Implemented in <a class="el" href="classPySampleHandlerFD.html#aade41128c58c8592f72487ccebc37596">PySampleHandlerFD</a>.</p>

</div>
</div>
<a id="aed15ee1f6209f26e55bb8e53108a9c6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed15ee1f6209f26e55bb8e53108a9c6a">&#9670;&nbsp;</a></span>SetupFunctionalParameters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::SetupFunctionalParameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>ETA - a function to setup and pass values to functional parameters where you need to pass a value to some custom reweight calc or engine. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000007">Todo:</a></b></dt><dd>KS: Instead of clearing it they should not be class members, so we must fix it in future </dd></dl>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00500">500</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                                                {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">// **************************************************</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a02254668e1d1e4417dfd38e416e46bf8">funcParsVec</a> = <a class="code" href="classSampleHandlerFD.html#a1db89c4df22a237b1cb26a2b55ee0866">ParHandler</a>-&gt;<a class="code" href="classParameterHandlerGeneric.html#a8f819bf0ef53544c864649d05479d95c">GetFunctionalParametersFromSampleName</a>(<a class="code" href="classSampleHandlerFD.html#a9a7fccdf8392ee06495902fab60e9858">SampleHandlerName</a>);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="comment">// RegisterFunctionalParameters is implemented in experiment-specific code, </span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="comment">// which calls RegisterIndividualFuncPar to populate funcParsNamesMap, funcParsNamesVec, and funcParsFuncMap</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <a class="code" href="classSampleHandlerFD.html#ab5a809cfcd1e221ba0094b65f8e748f8">RegisterFunctionalParameters</a>();</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a15653dd1dd3a1379ef3db56c145a4444">funcParsMap</a>.resize(<a class="code" href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">funcParsNamesMap</a>.size());</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a40ff07ee06efb7aeb285a769c2c9b81f">funcParsGrid</a>.resize(<a class="code" href="classSampleHandlerBase.html#a6ceca02f83e878ef1aec6e54e7b2f331">GetNEvents</a>());</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="comment">// For every functional parameter in XsecCov that matches the name in funcParsNames, add it to the map</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="structFunctionalParameter.html">FunctionalParameter</a>&amp; fp : <a class="code" href="classSampleHandlerFD.html#a02254668e1d1e4417dfd38e416e46bf8">funcParsVec</a>) {</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keyword">auto</span> it = <a class="code" href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">funcParsNamesMap</a>.find(fp.name);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="comment">// If we don&#39;t find a match, we need to throw an error</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">if</span> (it == <a class="code" href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">funcParsNamesMap</a>.end()) {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Functional parameter {} not found, did you define it in RegisterFunctionalParameters()?&quot;</span>, fp.name);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keyword">const</span> std::size_t key = <span class="keyword">static_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(it-&gt;second);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Adding functional parameter: {} to funcParsMap with key: {}&quot;</span>,fp.name, key);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> ikey = it-&gt;second;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    fp.funcPtr = &amp;<a class="code" href="classSampleHandlerFD.html#a577a57992e396a5b34efcd3bb6ed45cf">funcParsFuncMap</a>[ikey];</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a15653dd1dd3a1379ef3db56c145a4444">funcParsMap</a>[key].valuePtr = fp.valuePtr;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a15653dd1dd3a1379ef3db56c145a4444">funcParsMap</a>[key].funcPtr  = fp.funcPtr;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  }</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="comment">// Mostly the same as CalcNormsBins</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="comment">// For each event, make a vector of pointers to the functional parameters</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keywordflow">for</span> (std::size_t iEvent = 0; iEvent &lt; static_cast&lt;std::size_t&gt;(<a class="code" href="classSampleHandlerBase.html#a6ceca02f83e878ef1aec6e54e7b2f331">GetNEvents</a>()); ++iEvent) {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="comment">// Now loop over the functional parameters and get a vector of enums corresponding to the functional parameters</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">for</span> (std::vector&lt;FunctionalParameter&gt;::iterator it = <a class="code" href="classSampleHandlerFD.html#a02254668e1d1e4417dfd38e416e46bf8">funcParsVec</a>.begin(); it != <a class="code" href="classSampleHandlerFD.html#a02254668e1d1e4417dfd38e416e46bf8">funcParsVec</a>.end(); ++it) {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      <span class="comment">// Check whether the interaction modes match</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <span class="keywordtype">bool</span> ModeMatch = <a class="code" href="classSampleHandlerBase.html#ad16c838d4dc86e98445f199a16cf9bdf">MatchCondition</a>((*it).modes, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::round(*(<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].mode))));</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      <span class="keywordflow">if</span> (!ModeMatch) {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#afc88f0aa23c7127b2ff6e5c7ca3fa892">MACH3LOG_TRACE</a>(<span class="stringliteral">&quot;Event {}, missed Mode check ({}) for dial {}&quot;</span>, iEvent, *(<a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].mode), (*it).name);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      }</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <span class="comment">// Now check whether within kinematic bounds</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <span class="keywordtype">bool</span> IsSelected = <a class="code" href="classSampleHandlerFD.html#abbc1484d010b021794f44fc1b1594269">PassesSelection</a>((*it), iEvent);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      <span class="comment">// Need to then break the event loop</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      <span class="keywordflow">if</span>(!IsSelected){</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#afc88f0aa23c7127b2ff6e5c7ca3fa892">MACH3LOG_TRACE</a>(<span class="stringliteral">&quot;Event {}, missed Kinematic var check for dial {}&quot;</span>, iEvent, (*it).name);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <span class="keyword">const</span> std::size_t key = <span class="keyword">static_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">funcParsNamesMap</a>[it-&gt;name]);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      <a class="code" href="classSampleHandlerFD.html#a40ff07ee06efb7aeb285a769c2c9b81f">funcParsGrid</a>[iEvent].push_back(&amp;<a class="code" href="classSampleHandlerFD.html#a15653dd1dd3a1379ef3db56c145a4444">funcParsMap</a>[key]);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  }</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Finished setting up functional parameters&quot;</span>);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <a class="code" href="ParameterStructs_8h.html#ad0ad271345b43361a90efe977486167b">CleanVector</a>(<a class="code" href="classSampleHandlerFD.html#a888112d7eebd6fdb877c0015e1951f9d">funcParsNamesVec</a>);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <a class="code" href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">funcParsNamesMap</a>.clear();</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <a class="code" href="classSampleHandlerFD.html#af8ed9895a0b2802e45569ce2d1a0a837">funcParsNamesMap</a>.rehash(0);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;}</div>
<div class="ttc" id="aParameterStructs_8h_html_ad0ad271345b43361a90efe977486167b"><div class="ttname"><a href="ParameterStructs_8h.html#ad0ad271345b43361a90efe977486167b">CleanVector</a></div><div class="ttdeci">void CleanVector(T &amp;)</div><div class="ttdoc">Base case: do nothing for non-vector types.</div><div class="ttdef"><b>Definition:</b> <a href="ParameterStructs_8h_source.html#l00042">ParameterStructs.h:42</a></div></div>
<div class="ttc" id="aclassParameterHandlerGeneric_html_a8f819bf0ef53544c864649d05479d95c"><div class="ttname"><a href="classParameterHandlerGeneric.html#a8f819bf0ef53544c864649d05479d95c">ParameterHandlerGeneric::GetFunctionalParametersFromSampleName</a></div><div class="ttdeci">const std::vector&lt; FunctionalParameter &gt; GetFunctionalParametersFromSampleName(const std::string &amp;SampleName) const</div><div class="ttdoc">HH Get functional parameters for the relevant SampleName.</div><div class="ttdef"><b>Definition:</b> <a href="ParameterHandlerGeneric_8cpp_source.html#l00341">ParameterHandlerGeneric.cpp:341</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a02254668e1d1e4417dfd38e416e46bf8"><div class="ttname"><a href="classSampleHandlerFD.html#a02254668e1d1e4417dfd38e416e46bf8">SampleHandlerFD::funcParsVec</a></div><div class="ttdeci">std::vector&lt; FunctionalParameter &gt; funcParsVec</div><div class="ttdoc">HH - a vector that stores all the FuncPars struct.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00263">SampleHandlerFD.h:263</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a15653dd1dd3a1379ef3db56c145a4444"><div class="ttname"><a href="classSampleHandlerFD.html#a15653dd1dd3a1379ef3db56c145a4444">SampleHandlerFD::funcParsMap</a></div><div class="ttdeci">std::vector&lt; FunctionalShifter &gt; funcParsMap</div><div class="ttdoc">HH - a map that relates the funcpar enum to pointer of FuncPars struct HH - Changed to a vector of po...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00257">SampleHandlerFD.h:257</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ab5a809cfcd1e221ba0094b65f8e748f8"><div class="ttname"><a href="classSampleHandlerFD.html#ab5a809cfcd1e221ba0094b65f8e748f8">SampleHandlerFD::RegisterFunctionalParameters</a></div><div class="ttdeci">virtual void RegisterFunctionalParameters()=0</div><div class="ttdoc">HH - a experiment-specific function where the maps to actual functions are set up.</div></div>
<div class="ttc" id="astructFunctionalParameter_html"><div class="ttname"><a href="structFunctionalParameter.html">FunctionalParameter</a></div><div class="ttdoc">HH - Functional parameters Carrier for whether you want to apply a systematic to an event or not.</div><div class="ttdef"><b>Definition:</b> <a href="ParameterStructs_8h_source.html#l00139">ParameterStructs.h:139</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a61a1e9bbc4f812704278bf655d0d0ae2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61a1e9bbc4f812704278bf655d0d0ae2">&#9670;&nbsp;</a></span>SetupKinematicMap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::SetupKinematicMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Ensure Kinematic Map is setup and make sure it is initialised correctly. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00226">226</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                                        {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#aae37732e76f0b17b6f124bd5543177e4">KinematicParameters</a> == <span class="keyword">nullptr</span> || <a class="code" href="classSampleHandlerFD.html#ad7ac675cc4ce81bec42e0700f1ff2620">ReversedKinematicParameters</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Map KinematicParameters or ReversedKinematicParameters hasn&#39;t been initialised&quot;</span>);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="comment">// KS: Ensure maps exist correctly</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; pair : *<a class="code" href="classSampleHandlerFD.html#aae37732e76f0b17b6f124bd5543177e4">KinematicParameters</a>) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; key = pair.first;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; value = pair.second;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keyword">auto</span> it = <a class="code" href="classSampleHandlerFD.html#ad7ac675cc4ce81bec42e0700f1ff2620">ReversedKinematicParameters</a>-&gt;find(value);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">if</span> (it == <a class="code" href="classSampleHandlerFD.html#ad7ac675cc4ce81bec42e0700f1ff2620">ReversedKinematicParameters</a>-&gt;end() || it-&gt;second != key) {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Mismatch found: {} -&gt; {} but {} -&gt; {}&quot;</span>,</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                     key, value, value, (it != <a class="code" href="classSampleHandlerFD.html#ad7ac675cc4ce81bec42e0700f1ff2620">ReversedKinematicParameters</a>-&gt;end() ? it-&gt;second : <span class="stringliteral">&quot;NOT FOUND&quot;</span>));</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="comment">// KS: Ensure some MaCh3 specific variables are defined</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  std::vector&lt;std::string&gt; Vars = {<span class="stringliteral">&quot;Mode&quot;</span>, <span class="stringliteral">&quot;OscillationChannel&quot;</span>};</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> iVar = 0; iVar &lt; Vars.size(); iVar++) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <a class="code" href="classSampleHandlerFD.html#ae2769d593f34e8356b545af076818f89">ReturnKinematicParameterFromString</a>(Vars[iVar]);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>&amp;) {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;MaCh3 expected variable: {} not found in KinematicParameters.&quot;</span>, Vars[iVar]);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;All keys in KinematicParameters:&quot;</span>);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; pair : *<a class="code" href="classSampleHandlerFD.html#aae37732e76f0b17b6f124bd5543177e4">KinematicParameters</a>) {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Key: {}&quot;</span>, pair.first);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5fa55fd1e82f8c4fccd5cd77b814f86a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fa55fd1e82f8c4fccd5cd77b814f86a">&#9670;&nbsp;</a></span>SetupNormParameters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::SetupNormParameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Setup the norm parameters by assigning each event with bin. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00610">610</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                                          {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  std::vector&lt; std::vector&lt; int &gt; &gt; norms_bins(<a class="code" href="classSampleHandlerBase.html#a6ceca02f83e878ef1aec6e54e7b2f331">GetNEvents</a>());</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  std::vector&lt;NormParameter&gt; norm_parameters = <a class="code" href="classSampleHandlerFD.html#a1db89c4df22a237b1cb26a2b55ee0866">ParHandler</a>-&gt;<a class="code" href="classParameterHandlerGeneric.html#a1564cde885453c57312f769e57d627ac">GetNormParsFromSampleName</a>(<a class="code" href="classSampleHandlerFD.html#a6101b46360ae54fe37dd1243f3f7f51e">GetName</a>());</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="classSampleHandlerFD.html#a1db89c4df22a237b1cb26a2b55ee0866">ParHandler</a>){</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;ParHandler is not setup!&quot;</span>);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="comment">// Assign norm bins in MCSamples tree</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a37768b8d5fda2e61989f8041a89ef7b8">CalcNormsBins</a>(norm_parameters, norms_bins);</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="comment">//DB Attempt at reducing impact of SystematicHandlerGeneric::calcReweight()</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="keywordtype">int</span> counter;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iEvent = 0; iEvent &lt; <a class="code" href="classSampleHandlerBase.html#a6ceca02f83e878ef1aec6e54e7b2f331">GetNEvents</a>(); ++iEvent) {</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    counter = 0;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].norm_pointers.resize(norms_bins[iEvent].size());</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keywordflow">for</span>(<span class="keyword">auto</span> <span class="keyword">const</span> &amp; norm_bin: norms_bins[iEvent]) {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].norm_pointers[counter] = <a class="code" href="classSampleHandlerFD.html#a1db89c4df22a237b1cb26a2b55ee0866">ParHandler</a>-&gt;<a class="code" href="classParameterHandlerBase.html#a2929feac84b65e987bc92448754c5b1b">RetPointer</a>(norm_bin);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      counter += 1;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    }</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  }</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;}</div>
<div class="ttc" id="aclassParameterHandlerBase_html_a2929feac84b65e987bc92448754c5b1b"><div class="ttname"><a href="classParameterHandlerBase.html#a2929feac84b65e987bc92448754c5b1b">ParameterHandlerBase::RetPointer</a></div><div class="ttdeci">const double * RetPointer(const int iParam)</div><div class="ttdoc">DB Pointer return to param position.</div><div class="ttdef"><b>Definition:</b> <a href="ParameterHandlerBase_8h_source.html#l00205">ParameterHandlerBase.h:205</a></div></div>
<div class="ttc" id="aclassParameterHandlerGeneric_html_a1564cde885453c57312f769e57d627ac"><div class="ttname"><a href="classParameterHandlerGeneric.html#a1564cde885453c57312f769e57d627ac">ParameterHandlerGeneric::GetNormParsFromSampleName</a></div><div class="ttdeci">const std::vector&lt; NormParameter &gt; GetNormParsFromSampleName(const std::string &amp;SampleName) const</div><div class="ttdoc">DB Get norm/func parameters depending on given SampleName.</div><div class="ttdef"><b>Definition:</b> <a href="ParameterHandlerGeneric_8cpp_source.html#l00348">ParameterHandlerGeneric.cpp:348</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a37768b8d5fda2e61989f8041a89ef7b8"><div class="ttname"><a href="classSampleHandlerFD.html#a37768b8d5fda2e61989f8041a89ef7b8">SampleHandlerFD::CalcNormsBins</a></div><div class="ttdeci">void CalcNormsBins(std::vector&lt; NormParameter &gt; &amp;norm_parameters, std::vector&lt; std::vector&lt; int &gt; &gt; &amp;norms_bins)</div><div class="ttdoc">Check whether a normalisation systematic affects an event or not.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00639">SampleHandlerFD.cpp:639</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae4bcbd508ec8d14d36f32911e12af1e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4bcbd508ec8d14d36f32911e12af1e9">&#9670;&nbsp;</a></span>SetupNuOscillatorPointers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::SetupNuOscillatorPointers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01078">1078</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                                                {</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  <span class="keyword">auto</span> AddOscPointer = GetFromManager&lt;bool&gt;(<a class="code" href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleManager</a>-&gt;raw()[<span class="stringliteral">&quot;NuOsc&quot;</span>][<span class="stringliteral">&quot;AddOscPointer&quot;</span>], <span class="keyword">true</span>, __FILE__ , __LINE__);</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <span class="comment">// Sometimes we don&#39;t want to add osc pointer to allow for some experiment specific handling of osc weight, like for example being able to shift osc weigh</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  <span class="keywordflow">if</span>(!AddOscPointer) {</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  }</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iEvent=0;iEvent&lt;<a class="code" href="classSampleHandlerBase.html#a6ceca02f83e878ef1aec6e54e7b2f331">GetNEvents</a>();iEvent++) {</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;   <span class="keyword">const</span> <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>* osc_w_pointer = <a class="code" href="classSampleHandlerFD.html#a9b4dc9d2c3c2a1509fe4fcfefefbb3af">GetNuOscillatorPointers</a>(iEvent);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160; </div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;   <span class="comment">// KS: Do not add unity</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;   <span class="keywordflow">if</span> (osc_w_pointer != &amp;<a class="code" href="namespaceM3.html#a8b0081813e8f5b1c946821be4f114bd5">M3::Unity</a>) {</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;     <a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].total_weight_pointers.push_back(osc_w_pointer);</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;   }</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  }</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a9b4dc9d2c3c2a1509fe4fcfefefbb3af"><div class="ttname"><a href="classSampleHandlerFD.html#a9b4dc9d2c3c2a1509fe4fcfefefbb3af">SampleHandlerFD::GetNuOscillatorPointers</a></div><div class="ttdeci">const M3::float_t * GetNuOscillatorPointers(const int iEvent) const</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01095">SampleHandlerFD.cpp:1095</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae9ff78dd87844a8aaccb24f1381d2c78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9ff78dd87844a8aaccb24f1381d2c78">&#9670;&nbsp;</a></span>SetupReweightArrays()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::SetupReweightArrays </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialise data, MC and W2 histograms. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00721">721</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                                          {</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a85415d4ac54a5aefe78e5ab4d7bdb769">SampleHandlerFD_array</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetNBins()];</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <a class="code" href="classSampleHandlerFD.html#af5c6a3701c6ac76a96886ff13300a53b">SampleHandlerFD_array_w2</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetNBins()];</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a2b16ed4f91f2f37ff707ca048d8d6927">SampleHandlerFD_data</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetNBins()];</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetNBins(); ++i) {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a85415d4ac54a5aefe78e5ab4d7bdb769">SampleHandlerFD_array</a>[i] = 0.0;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <a class="code" href="classSampleHandlerFD.html#af5c6a3701c6ac76a96886ff13300a53b">SampleHandlerFD_array_w2</a>[i] = 0.0;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <a class="code" href="classSampleHandlerFD.html#a2b16ed4f91f2f37ff707ca048d8d6927">SampleHandlerFD_data</a>[i] = 0.0;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  }</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1a984c564107c7207a2611d0bf67d9cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a984c564107c7207a2611d0bf67d9cc">&#9670;&nbsp;</a></span>SetupSplines()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void SampleHandlerFD::SetupSplines </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>initialise your splineXX object and then use InitialiseSplineObject to conviently setup everything up </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000009">Todo:</a></b></dt><dd>abstract the spline initialisation completely to core </dd></dl>

<p>Implemented in <a class="el" href="classPySampleHandlerFD.html#a0b69ca72140420ed71397b0dd1ceaebc">PySampleHandlerFD</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ad625af417f4445b9b14710ca3bdc409d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad625af417f4445b9b14710ca3bdc409d">&#9670;&nbsp;</a></span>_modeNomWeightMap</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt;std::string, double&gt; SampleHandlerFD::_modeNomWeightMap</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00385">385</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a231b4b5b9b5e5f0d1cb9a3ba96c85ec5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">&#9670;&nbsp;</a></span>Binning</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classBinningHandler.html">BinningHandler</a>&gt; SampleHandlerFD::Binning</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: This stores binning information, in future could be come vector to store binning for every used sample. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00332">332</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a52a69295c2c47e621a5f2b2b1bd9f82e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52a69295c2c47e621a5f2b2b1bd9f82e">&#9670;&nbsp;</a></span>FileToFinalPDGMap</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt;std::string, <a class="el" href="SampleStructs_8h.html#a0dfdd8cf84b8fa3495e9e5e520fe6cd2">NuPDG</a>&gt; SampleHandlerFD::FileToFinalPDGMap</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00404">404</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a251743beb6b3e6884fef871a8aef9156"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a251743beb6b3e6884fef871a8aef9156">&#9670;&nbsp;</a></span>FileToInitPDGMap</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt;std::string, <a class="el" href="SampleStructs_8h.html#a0dfdd8cf84b8fa3495e9e5e520fe6cd2">NuPDG</a>&gt; SampleHandlerFD::FileToInitPDGMap</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00403">403</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a1ff1ef7d99cee6d6a9fba74296d4d0ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ff1ef7d99cee6d6a9fba74296d4d0ea">&#9670;&nbsp;</a></span>FirstTimeW2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool SampleHandlerFD::FirstTimeW2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS:Super hacky to update W2 or not. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00393">393</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a577a57992e396a5b34efcd3bb6ed45cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a577a57992e396a5b34efcd3bb6ed45cf">&#9670;&nbsp;</a></span>funcParsFuncMap</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt;int, <a class="el" href="ParameterStructs_8h.html#a916ddc21f75755739f308b54dd06e0ae">FuncParFuncType</a>&gt; SampleHandlerFD::funcParsFuncMap</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>HH - a map that relates the funcpar enum to pointer of the actual function. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00269">269</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a40ff07ee06efb7aeb285a769c2c9b81f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40ff07ee06efb7aeb285a769c2c9b81f">&#9670;&nbsp;</a></span>funcParsGrid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;<a class="el" href="structFunctionalShifter.html">FunctionalShifter</a>*&gt; &gt; SampleHandlerFD::funcParsGrid</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>HH - a grid of vectors of enums for each sample and event. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00252">252</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a15653dd1dd3a1379ef3db56c145a4444"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15653dd1dd3a1379ef3db56c145a4444">&#9670;&nbsp;</a></span>funcParsMap</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structFunctionalShifter.html">FunctionalShifter</a>&gt; SampleHandlerFD::funcParsMap</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>HH - a map that relates the funcpar enum to pointer of FuncPars struct HH - Changed to a vector of pointers since it's faster than unordered_map and we are using ints as keys. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00257">257</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="af8ed9895a0b2802e45569ce2d1a0a837"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8ed9895a0b2802e45569ce2d1a0a837">&#9670;&nbsp;</a></span>funcParsNamesMap</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt;std::string, int&gt; SampleHandlerFD::funcParsNamesMap</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>HH - a map that relates the name of the functional parameter to funcpar enum. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00266">266</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a888112d7eebd6fdb877c0015e1951f9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a888112d7eebd6fdb877c0015e1951f9d">&#9670;&nbsp;</a></span>funcParsNamesVec</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; SampleHandlerFD::funcParsNamesVec = {}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>HH - a vector of string names for each functional parameter. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00271">271</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a02254668e1d1e4417dfd38e416e46bf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02254668e1d1e4417dfd38e416e46bf8">&#9670;&nbsp;</a></span>funcParsVec</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structFunctionalParameter.html">FunctionalParameter</a>&gt; SampleHandlerFD::funcParsVec</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>HH - a vector that stores all the FuncPars struct. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000010">Todo:</a></b></dt><dd>KS: Below functional variables are used only on setup, thus we should refactor them in such a way that they are removed as class members but this would be breaking change thus keep it for the time being. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00263">263</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="aae37732e76f0b17b6f124bd5543177e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae37732e76f0b17b6f124bd5543177e4">&#9670;&nbsp;</a></span>KinematicParameters</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::unordered_map&lt;std::string, int&gt;* SampleHandlerFD::KinematicParameters</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Mapping between string and kinematic enum. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00372">372</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a5d762b169bab4454bbdb1b387c09f4a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d762b169bab4454bbdb1b387c09f4a7">&#9670;&nbsp;</a></span>KinematicVectors</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::unordered_map&lt;std::string, int&gt;* SampleHandlerFD::KinematicVectors</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00377">377</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="ae422410559d7f3af0e0a80cc15fbfbff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae422410559d7f3af0e0a80cc15fbfbff">&#9670;&nbsp;</a></span>MCSamples</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structEventInfo.html">EventInfo</a>&gt; SampleHandlerFD::MCSamples</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stores information about every MC event. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00343">343</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="aa7115dd53d73a45fb64c565561095b6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7115dd53d73a45fb64c565561095b6a">&#9670;&nbsp;</a></span>Oscillator</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="classOscillationHandler.html">OscillationHandler</a>&gt; SampleHandlerFD::Oscillator</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Contains all your binned splines and handles the setup and the returning of weights from spline evaluations. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00217">217</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a1db89c4df22a237b1cb26a2b55ee0866"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1db89c4df22a237b1cb26a2b55ee0866">&#9670;&nbsp;</a></span>ParHandler</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classParameterHandlerGeneric.html">ParameterHandlerGeneric</a>* SampleHandlerFD::ParHandler = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>ETA - All experiments will need an xsec, det and osc cov. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00351">351</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="ad7ac675cc4ce81bec42e0700f1ff2620"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7ac675cc4ce81bec42e0700f1ff2620">&#9670;&nbsp;</a></span>ReversedKinematicParameters</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::unordered_map&lt;int, std::string&gt;* SampleHandlerFD::ReversedKinematicParameters</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Mapping between kinematic enum and string. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00374">374</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a341f7bf83eb74ba5d27a2c9616202eba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a341f7bf83eb74ba5d27a2c9616202eba">&#9670;&nbsp;</a></span>ReversedKinematicVectors</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::unordered_map&lt;int, std::string&gt;* SampleHandlerFD::ReversedKinematicVectors</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00378">378</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a115728f4ba502c93ffd447fb5457aac6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a115728f4ba502c93ffd447fb5457aac6">&#9670;&nbsp;</a></span>SampleDetails</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structSampleInfo.html">SampleInfo</a>&gt; SampleHandlerFD::SampleDetails</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stores info about currently initialised sample. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00345">345</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a85415d4ac54a5aefe78e5ab4d7bdb769"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85415d4ac54a5aefe78e5ab4d7bdb769">&#9670;&nbsp;</a></span>SampleHandlerFD_array</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double* SampleHandlerFD::SampleHandlerFD_array</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>DB Array to be filled after reweighting. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00334">334</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="af5c6a3701c6ac76a96886ff13300a53b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5c6a3701c6ac76a96886ff13300a53b">&#9670;&nbsp;</a></span>SampleHandlerFD_array_w2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double* SampleHandlerFD::SampleHandlerFD_array_w2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS Array used for MC stat. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00336">336</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a2b16ed4f91f2f37ff707ca048d8d6927"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b16ed4f91f2f37ff707ca048d8d6927">&#9670;&nbsp;</a></span>SampleHandlerFD_data</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double* SampleHandlerFD::SampleHandlerFD_data</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>DB Array to be filled in AddData. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00338">338</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a9a7fccdf8392ee06495902fab60e9858"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a7fccdf8392ee06495902fab60e9858">&#9670;&nbsp;</a></span>SampleHandlerName</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::SampleHandlerName</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A unique ID for each sample based on which we can define what systematic should be applied. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00355">355</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a46fa97953e811328fe125560ed5c809e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46fa97953e811328fe125560ed5c809e">&#9670;&nbsp;</a></span>SampleManager</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classManager.html">Manager</a>&gt; SampleHandlerFD::SampleManager</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The manager object used to read the sample yaml file. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00382">382</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a07b3357278429dfe809d7d9d27682bf9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07b3357278429dfe809d7d9d27682bf9">&#9670;&nbsp;</a></span>Selection</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &gt; SampleHandlerFD::Selection</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>a way to store selection cuts which you may push back in the get1DVar functions most of the time this is just the same as StoredSelection </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00368">368</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="a17193b3fe2b44e6484f9eefda86f97dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17193b3fe2b44e6484f9eefda86f97dd">&#9670;&nbsp;</a></span>SplineHandler</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classBinnedSplineHandler.html">BinnedSplineHandler</a>&gt; SampleHandlerFD::SplineHandler</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Contains all your binned splines and handles the setup and the returning of weights from spline evaluations. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00214">214</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="aa3832a3e2c438d4810811d83e1323cff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3832a3e2c438d4810811d83e1323cff">&#9670;&nbsp;</a></span>StoredSelection</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &gt; SampleHandlerFD::StoredSelection</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>What gets pulled from config options, these are constant after loading in this is of length 3: 0th index is the value, 1st is lower bound, 2nd is upper bound. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00365">365</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="af60df24f4eb7954a3297c9841c60624b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af60df24f4eb7954a3297c9841c60624b">&#9670;&nbsp;</a></span>THStackLeg</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TLegend* SampleHandlerFD::THStackLeg = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>DB Miscellaneous Variables. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00389">389</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<a id="aa654562842a0da51ff917aaed517310e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa654562842a0da51ff917aaed517310e">&#9670;&nbsp;</a></span>UpdateW2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool SampleHandlerFD::UpdateW2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS:Super hacky to update W2 or not. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00395">395</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>Samples/<a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a></li>
<li>Samples/<a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- Footer for MaCh3 Doxygen documentation -->
<footer class="mach3-footer" style="text-align: center;">
    <div style="margin-bottom: 15px;">
        <span style="font-weight: bold;">The MaCh3 Collaboration</span>
    </div>
    <!-- Dropdown to jump between doc versions -->
    <div style="margin-bottom: 10px;">
        <span>Select Software Version: </span>
        <select id="versionSelector" onchange="window.location.href=this.value" style="padding: 5px; border-radius: 4px; border: 1px solid #ccc;">
            <option value="">-- Select --</option>
            <option value="https://mach3-software.github.io/MaCh3/">develop</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.4.0/index.html">v2.4.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.3.0/index.html">v2.3.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.2.0/index.html">v2.2.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.1.0/index.html">v2.1.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.0.0/index.html">v2.0.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.5.0/index.html">v1.5.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.4.0/index.html">v1.4.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.3.0/index.html">v1.3.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.2.0/index.html">v1.2.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.1.0/index.html">v1.1.0</option>
        </select>
    </div>
    <!-- Footer info about doxygen -->
    <div style="font-size: 0.9em; color: #666; margin-top: 10px;">
        Documentation generated with
        <a href="https://www.doxygen.nl/" target="_blank" style="color: #666;">Doxygen</a>
        <span id="doxygenVersion"></span>
    </div>
    <!-- Now grab doxygen version from metadata -->
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        const meta = document.querySelector('meta[name="generator"]');
        if (meta) {
            const version = meta.getAttribute("content").replace("Doxygen ", "");
            document.getElementById("doxygenVersion").textContent = " " + version;
        }
    });
    </script>
</footer>
