<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MaCh3: FitterBase Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="MaCh3.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="mach3logo_small.png"/></td>
  <td id="projectalign">
   <div id="projectname">MaCh3<span id="projectnumber">&#160;1.2.0</span>
   </div>
   <div id="projectbrief">Reference Guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classFitterBase-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">FitterBase Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div></div>
</div><!--header-->
<div class="contents">

<p>Base class for implementing fitting algorithms.  
 <a href="classFitterBase.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="FitterBase_8h_source.html">mcmc/FitterBase.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for FitterBase:</div>
<div class="dyncontent">
<div class="center"><img src="classFitterBase__inherit__graph.png" border="0" usemap="#aFitterBase_inherit__map" alt="Inheritance graph"/></div>
<map name="aFitterBase_inherit__map" id="aFitterBase_inherit__map">
<area shape="rect" title="Base class for implementing fitting algorithms." alt="" coords="91,5,172,31"/>
<area shape="rect" href="classLikelihoodFit.html" title="Implementation of base Likelihood Fit class, it is mostly responsible for likelihood calculation whil..." alt="" coords="35,79,130,105"/>
<area shape="poly" title=" " alt="" coords="117,45,93,80,88,77,113,42"/>
<area shape="rect" href="classmcmc.html" title="Implementation of MR2T2 algorithm." alt="" coords="154,79,211,105"/>
<area shape="poly" title=" " alt="" coords="151,42,176,77,172,80,147,45"/>
<area shape="rect" href="classMinuitFit.html" title="Implementation of Minuit fitting algorithm ." alt="" coords="5,153,77,178"/>
<area shape="poly" title=" " alt="" coords="70,119,50,154,46,151,66,117"/>
<area shape="rect" href="classPSO.html" title="Class PSO, consist of a vector of object Class Particle and global best Takes in the size (number of ..." alt="" coords="100,153,150,178"/>
<area shape="poly" title=" " alt="" coords="99,116,120,151,116,154,95,119"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for FitterBase:</div>
<div class="dyncontent">
<div class="center"><img src="classFitterBase__coll__graph.png" border="0" usemap="#aFitterBase_coll__map" alt="Collaboration graph"/></div>
<map name="aFitterBase_coll__map" id="aFitterBase_coll__map">
<area shape="rect" title="Base class for implementing fitting algorithms." alt="" coords="2042,365,2124,391"/>
<area shape="rect" href="classmanager.html" title="The manager class is responsible for managing configurations and settings." alt="" coords="1513,40,1584,65"/>
<area shape="poly" title=" " alt="" coords="1599,37,1687,23,1742,18,1800,18,1859,24,1917,37,1971,60,2020,93,2035,114,2048,144,2066,224,2078,305,2083,364,2078,365,2072,306,2061,225,2042,146,2030,116,2016,97,1969,64,1915,42,1858,29,1799,23,1742,24,1688,28,1599,43"/>
<area shape="rect" title=" " alt="" coords="198,165,275,191"/>
<area shape="poly" title=" " alt="" coords="254,150,282,118,318,88,365,58,405,38,447,28,502,24,1215,24,1382,32,1512,45,1512,51,1382,37,1215,30,502,30,448,33,406,43,367,62,321,92,286,122,258,154"/>
<area shape="rect" href="classMaCh3Modes.html" title="KS: Class describing MaCh3 modes used in the analysis, it is being initialised from config." alt="" coords="1163,136,1265,161"/>
<area shape="poly" title=" " alt="" coords="290,169,319,167,567,155,810,149,1163,146,1163,151,811,154,568,161,319,172,291,175"/>
<area shape="rect" title=" " alt="" coords="586,71,727,111"/>
<area shape="poly" title=" " alt="" coords="269,154,318,130,388,112,459,100,585,89,585,94,460,105,389,117,320,135,271,159"/>
<area shape="rect" href="structMaCh3ModeInfo.html" title="KS: Class containing information for a single MaCh3Mode." alt="" coords="445,196,562,221"/>
<area shape="poly" title=" " alt="" coords="291,191,320,197,384,204,445,206,445,211,384,209,319,202,290,196"/>
<area shape="rect" title=" " alt="" coords="1134,186,1294,212"/>
<area shape="poly" title=" " alt="" coords="279,195,320,211,382,225,446,231,577,242,679,247,781,245,912,238,1030,225,1136,210,1137,215,1031,231,913,243,781,251,679,252,576,247,445,236,381,230,319,216,277,200"/>
<area shape="rect" href="classcovarianceBase.html" title="Base class responsible for handling of systematic error parameters. Capable of using PCA or using ada..." alt="" coords="1491,492,1606,517"/>
<area shape="poly" title=" " alt="" coords="267,198,321,235,380,268,432,293,524,329,616,365,669,390,729,423,740,433,752,441,855,475,944,493,1024,501,1100,501,1261,492,1355,490,1465,495,1491,497,1491,502,1465,500,1355,495,1261,497,1101,506,1024,506,943,498,853,480,750,446,737,438,725,428,666,395,614,370,522,334,430,298,378,273,318,240,264,203"/>
<area shape="rect" title=" " alt="" coords="5,157,129,198"/>
<area shape="poly" title=" " alt="" coords="144,175,198,175,198,180,144,180"/>
<area shape="poly" title=" " alt="" coords="1280,142,1368,141,1465,147,1596,162,1698,177,1798,203,1922,247,1974,271,2020,305,2051,335,2074,363,2070,366,2047,339,2017,309,1971,276,1920,252,1797,208,1697,182,1596,167,1464,152,1368,147,1280,148"/>
<area shape="poly" title=" " alt="" coords="1263,127,1365,92,1512,57,1513,62,1366,98,1264,132"/>
<area shape="rect" href="classsamplePDFBase.html" title="Class responsible for handling implementation of samples used in analysis, reweighting and returning ..." alt="" coords="1489,226,1608,252"/>
<area shape="poly" title=" " alt="" coords="1281,152,1370,166,1466,191,1499,206,1528,223,1526,228,1497,211,1464,196,1369,171,1280,157"/>
<area shape="poly" title=" " alt="" coords="743,97,1063,130,1163,140,1163,146,1062,135,742,102"/>
<area shape="rect" title=" " alt="" coords="751,188,912,229"/>
<area shape="poly" title=" " alt="" coords="927,203,994,196,1062,182,1085,171,1162,153,1163,158,1087,176,1063,187,995,201,928,208"/>
<area shape="poly" title=" " alt="" coords="577,206,751,206,751,211,577,211"/>
<area shape="rect" title=" " alt="" coords="178,468,295,493"/>
<area shape="poly" title=" " alt="" coords="310,461,485,416,707,354,817,318,917,282,1001,245,1061,209,1068,200,1072,191,1076,181,1085,171,1123,154,1162,147,1163,152,1125,159,1088,176,1080,184,1077,193,1073,203,1064,213,1004,249,919,287,819,323,708,359,486,422,311,466"/>
<area shape="poly" title=" " alt="" coords="260,454,488,219,492,223,264,458"/>
<area shape="poly" title=" " alt="" coords="246,508,270,599,291,657,318,715,352,770,394,815,418,832,444,845,472,853,502,856,1215,856,1290,861,1351,867,1378,865,1405,859,1433,845,1463,822,1479,800,1494,765,1518,675,1534,582,1543,517,1548,518,1540,583,1523,676,1499,767,1484,803,1467,826,1436,849,1407,864,1379,871,1351,872,1290,867,1215,862,502,862,471,859,442,850,415,836,390,819,348,773,313,718,286,659,265,601,241,509"/>
<area shape="rect" href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html" title="Contains information about adaptive covariance matrix." alt="" coords="1086,796,1342,821"/>
<area shape="poly" title=" " alt="" coords="284,497,418,553,614,630,846,712,967,751,1087,784,1122,792,1121,797,1086,790,966,756,845,717,612,635,416,558,282,502"/>
<area shape="rect" title=" " alt="" coords="761,376,902,401"/>
<area shape="poly" title=" " alt="" coords="918,382,1213,375,1818,375,2042,375,2042,380,1818,380,1213,380,918,387"/>
<area shape="poly" title=" " alt="" coords="895,369,936,360,988,356,1053,354,1204,354,1353,347,1416,338,1464,323,1487,308,1508,289,1537,251,1541,254,1512,292,1491,312,1466,328,1417,344,1354,353,1204,359,1053,359,988,361,937,366,896,374"/>
<area shape="rect" title=" " alt="" coords="1138,236,1290,277"/>
<area shape="poly" title=" " alt="" coords="864,365,898,345,935,327,970,315,998,309,1062,297,1141,275,1142,280,1063,302,999,315,971,321,937,332,900,350,867,369"/>
<area shape="poly" title=" " alt="" coords="881,405,937,427,975,436,1007,440,1036,449,1050,458,1065,474,1074,497,1078,529,1074,608,1072,684,1077,714,1088,733,1119,757,1148,771,1177,778,1206,778,1237,773,1269,763,1340,733,1378,712,1412,685,1443,655,1470,623,1513,561,1538,516,1543,519,1517,564,1474,626,1447,659,1415,689,1381,716,1343,737,1271,768,1238,778,1207,784,1176,783,1146,776,1116,761,1084,737,1072,715,1067,685,1069,607,1072,530,1069,498,1060,476,1047,462,1034,453,1006,445,974,442,936,432,879,410"/>
<area shape="rect" href="classPCAHandler.html" title="Class responsible for handling Principal Component Analysis (PCA) of covariance matrix." alt="" coords="1167,416,1261,441"/>
<area shape="poly" title=" " alt="" coords="901,402,937,409,1061,421,1167,425,1167,430,1061,426,936,414,900,408"/>
<area shape="poly" title=" " alt="" coords="885,406,914,429,924,445,927,459,930,473,938,488,954,505,970,517,1003,532,1035,548,1051,561,1065,580,1076,608,1079,635,1072,683,1068,706,1067,729,1073,751,1088,775,1113,793,1110,797,1084,778,1068,753,1062,729,1062,706,1067,682,1074,635,1071,610,1060,583,1047,565,1032,552,1001,536,968,521,951,509,934,492,925,475,922,461,919,447,910,433,882,411"/>
<area shape="rect" title=" " alt="" coords="1712,262,1921,288"/>
<area shape="poly" title=" " alt="" coords="1868,291,2048,362,2046,367,1866,296"/>
<area shape="poly" title=" " alt="" coords="1624,246,1716,259,1715,264,1623,252"/>
<area shape="poly" title=" " alt="" coords="1306,249,1488,239,1488,245,1306,254"/>
<area shape="poly" title=" " alt="" coords="1309,204,1465,222,1489,225,1488,231,1464,227,1309,209"/>
<area shape="poly" title=" " alt="" coords="1310,204,1343,222,1355,237,1359,251,1361,266,1368,282,1411,346,1459,406,1535,489,1532,493,1455,409,1407,350,1363,285,1356,267,1354,252,1350,239,1340,226,1308,209"/>
<area shape="rect" title=" " alt="" coords="1715,416,1919,441"/>
<area shape="poly" title=" " alt="" coords="1934,424,1976,418,2017,409,2060,389,2063,394,2019,414,1977,423,1935,429"/>
<area shape="poly" title=" " alt="" coords="1602,484,1711,450,1753,439,1755,444,1713,455,1603,489"/>
<area shape="rect" title=" " alt="" coords="1150,517,1278,543"/>
<area shape="poly" title=" " alt="" coords="1292,522,1464,510,1491,508,1491,513,1465,515,1293,528"/>
<area shape="poly" title=" " alt="" coords="1276,427,1367,436,1417,445,1466,458,1499,472,1528,489,1526,493,1497,477,1464,463,1416,450,1366,441,1276,433"/>
<area shape="poly" title=" " alt="" coords="1356,818,1413,806,1439,794,1463,779,1490,750,1510,715,1525,678,1535,639,1544,568,1545,517,1550,517,1550,568,1540,640,1530,680,1515,718,1494,753,1466,783,1442,799,1415,811,1358,823"/>
<area shape="rect" title=" " alt="" coords="1718,465,1915,491"/>
<area shape="poly" title=" " alt="" coords="1930,482,1975,475,2017,459,2037,444,2053,425,2074,389,2078,392,2057,429,2040,448,2020,463,1977,480,1931,487"/>
<area shape="rect" title=" " alt="" coords="1722,514,1912,540"/>
<area shape="poly" title=" " alt="" coords="1927,530,1974,521,1996,513,2017,501,2041,476,2059,446,2077,390,2082,392,2064,448,2046,480,2020,505,1999,518,1976,526,1928,536"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a2d45811f9bcb9719f312048bbd36a423" id="r_a2d45811f9bcb9719f312048bbd36a423"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a2d45811f9bcb9719f312048bbd36a423">FitterBase</a> (<a class="el" href="classmanager.html">manager</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>)</td></tr>
<tr class="memdesc:a2d45811f9bcb9719f312048bbd36a423"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <br /></td></tr>
<tr class="separator:a2d45811f9bcb9719f312048bbd36a423"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8677b449e49ca86bafee685e8dbe93f" id="r_ae8677b449e49ca86bafee685e8dbe93f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">virtual</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#ae8677b449e49ca86bafee685e8dbe93f">~FitterBase</a> ()</td></tr>
<tr class="memdesc:ae8677b449e49ca86bafee685e8dbe93f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor for the <a class="el" href="classFitterBase.html" title="Base class for implementing fitting algorithms.">FitterBase</a> class.  <br /></td></tr>
<tr class="separator:ae8677b449e49ca86bafee685e8dbe93f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe93c6d49aa079d811a9021de59691b1" id="r_abe93c6d49aa079d811a9021de59691b1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#abe93c6d49aa079d811a9021de59691b1">addSamplePDF</a> (<a class="el" href="classsamplePDFBase.html">samplePDFBase</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sample</a>)</td></tr>
<tr class="memdesc:abe93c6d49aa079d811a9021de59691b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function adds a sample PDF object to the analysis framework. The sample PDF object will be utilized in fitting procedures or likelihood scans.  <br /></td></tr>
<tr class="separator:abe93c6d49aa079d811a9021de59691b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d0068193922448a6fed0e0d3ff4305a" id="r_a1d0068193922448a6fed0e0d3ff4305a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a1d0068193922448a6fed0e0d3ff4305a">addSystObj</a> (<a class="el" href="classcovarianceBase.html">covarianceBase</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>)</td></tr>
<tr class="memdesc:a1d0068193922448a6fed0e0d3ff4305a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function adds a Covariance object to the analysis framework. The Covariance object will be utilized in fitting procedures or likelihood scans.  <br /></td></tr>
<tr class="separator:a1d0068193922448a6fed0e0d3ff4305a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a9666dc09f91af804954e8968bc7b24" id="r_a1a9666dc09f91af804954e8968bc7b24"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">virtual</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a1a9666dc09f91af804954e8968bc7b24">runMCMC</a> ()=0</td></tr>
<tr class="memdesc:a1a9666dc09f91af804954e8968bc7b24"><td class="mdescLeft">&#160;</td><td class="mdescRight">The specific fitting algorithm implemented in this function depends on the derived class. It could be Markov Chain Monte Carlo (MCMC), <a class="el" href="classMinuitFit.html" title="Implementation of Minuit fitting algorithm .">MinuitFit</a>, or another algorithm.  <br /></td></tr>
<tr class="separator:a1a9666dc09f91af804954e8968bc7b24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3db1d0bb7364e70cd432a3e1c0a600e" id="r_ab3db1d0bb7364e70cd432a3e1c0a600e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#ab3db1d0bb7364e70cd432a3e1c0a600e">DragRace</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NLaps</a>=100)</td></tr>
<tr class="memdesc:ab3db1d0bb7364e70cd432a3e1c0a600e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the required time for each sample or covariance object in a drag race simulation. Inspired by Dan's feature.  <br /></td></tr>
<tr class="separator:ab3db1d0bb7364e70cd432a3e1c0a600e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a018e8d09a62bca19840e1321b49df2c0" id="r_a018e8d09a62bca19840e1321b49df2c0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a018e8d09a62bca19840e1321b49df2c0">RunLLHScan</a> ()</td></tr>
<tr class="memdesc:a018e8d09a62bca19840e1321b49df2c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a 1D likelihood scan.  <br /></td></tr>
<tr class="separator:a018e8d09a62bca19840e1321b49df2c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63820450a9089d5281769288c007db55" id="r_a63820450a9089d5281769288c007db55"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a63820450a9089d5281769288c007db55">GetStepScaleBasedOnLLHScan</a> ()</td></tr>
<tr class="memdesc:a63820450a9089d5281769288c007db55"><td class="mdescLeft">&#160;</td><td class="mdescRight">LLH scan is good first estimate of step scale.  <br /></td></tr>
<tr class="separator:a63820450a9089d5281769288c007db55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8b32ca268c20dd643eaf92dae04cd0a" id="r_ab8b32ca268c20dd643eaf92dae04cd0a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#ab8b32ca268c20dd643eaf92dae04cd0a">Run2DLLHScan</a> ()</td></tr>
<tr class="memdesc:ab8b32ca268c20dd643eaf92dae04cd0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a 2D likelihood scan.  <br /></td></tr>
<tr class="separator:ab8b32ca268c20dd643eaf92dae04cd0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71e43b96395568e54879d9bd1b57c0f8" id="r_a71e43b96395568e54879d9bd1b57c0f8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a71e43b96395568e54879d9bd1b57c0f8">RunSigmaVar</a> ()</td></tr>
<tr class="memdesc:a71e43b96395568e54879d9bd1b57c0f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a 2D and 1D sigma var for all samples.  <br /></td></tr>
<tr class="separator:a71e43b96395568e54879d9bd1b57c0f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a655ccea31627627e2b36745c97e5c0f0" id="r_a655ccea31627627e2b36745c97e5c0f0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">virtual</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a655ccea31627627e2b36745c97e5c0f0">StartFromPreviousFit</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> std::string &amp;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">FitName</a>)</td></tr>
<tr class="memdesc:a655ccea31627627e2b36745c97e5c0f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allow to start from previous fit/chain.  <br /></td></tr>
<tr class="separator:a655ccea31627627e2b36745c97e5c0f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3706f6d722073b447b3de8c3a6516601" id="r_a3706f6d722073b447b3de8c3a6516601"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">virtual</a> std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a3706f6d722073b447b3de8c3a6516601">GetName</a> () <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a></td></tr>
<tr class="memdesc:a3706f6d722073b447b3de8c3a6516601"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get name of class.  <br /></td></tr>
<tr class="separator:a3706f6d722073b447b3de8c3a6516601"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a1dccdac8611e70c759c47a65f2b1aea7" id="r_a1dccdac8611e70c759c47a65f2b1aea7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a1dccdac8611e70c759c47a65f2b1aea7">ProcessMCMC</a> ()</td></tr>
<tr class="memdesc:a1dccdac8611e70c759c47a65f2b1aea7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process MCMC output.  <br /></td></tr>
<tr class="separator:a1dccdac8611e70c759c47a65f2b1aea7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53715760edd8c7640432f31793fd28f9" id="r_a53715760edd8c7640432f31793fd28f9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a53715760edd8c7640432f31793fd28f9">PrepareOutput</a> ()</td></tr>
<tr class="memdesc:a53715760edd8c7640432f31793fd28f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare the output file.  <br /></td></tr>
<tr class="separator:a53715760edd8c7640432f31793fd28f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a418f581b688f035211107ddd83168c08" id="r_a418f581b688f035211107ddd83168c08"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a418f581b688f035211107ddd83168c08">SaveOutput</a> ()</td></tr>
<tr class="memdesc:a418f581b688f035211107ddd83168c08"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save output and close files.  <br /></td></tr>
<tr class="separator:a418f581b688f035211107ddd83168c08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48f38bfa8996fe00d51f35b05dd16b46" id="r_a48f38bfa8996fe00d51f35b05dd16b46"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a48f38bfa8996fe00d51f35b05dd16b46">SaveSettings</a> ()</td></tr>
<tr class="memdesc:a48f38bfa8996fe00d51f35b05dd16b46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save the settings that the MCMC was run with.  <br /></td></tr>
<tr class="separator:a48f38bfa8996fe00d51f35b05dd16b46"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a4fceb68f242feeb04a0ddf42a5a37095" id="r_a4fceb68f242feeb04a0ddf42a5a37095"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmanager.html">manager</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a></td></tr>
<tr class="memdesc:a4fceb68f242feeb04a0ddf42a5a37095"><td class="mdescLeft">&#160;</td><td class="mdescRight">The manager.  <br /></td></tr>
<tr class="separator:a4fceb68f242feeb04a0ddf42a5a37095"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a004cb6e6168032d9280ce3db912f1a43" id="r_a004cb6e6168032d9280ce3db912f1a43"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMaCh3Modes.html">MaCh3Modes</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a004cb6e6168032d9280ce3db912f1a43">Modes</a></td></tr>
<tr class="memdesc:a004cb6e6168032d9280ce3db912f1a43"><td class="mdescLeft">&#160;</td><td class="mdescRight">MaCh3 Modes.  <br /></td></tr>
<tr class="separator:a004cb6e6168032d9280ce3db912f1a43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50df1bd75b20a953f81ab9c2bab6b42c" id="r_a50df1bd75b20a953f81ab9c2bab6b42c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a50df1bd75b20a953f81ab9c2bab6b42c">step</a></td></tr>
<tr class="memdesc:a50df1bd75b20a953f81ab9c2bab6b42c"><td class="mdescLeft">&#160;</td><td class="mdescRight">current state  <br /></td></tr>
<tr class="separator:a50df1bd75b20a953f81ab9c2bab6b42c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfb6f10720764d8bbbe43754fd5cd976" id="r_abfb6f10720764d8bbbe43754fd5cd976"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#abfb6f10720764d8bbbe43754fd5cd976">logLCurr</a></td></tr>
<tr class="memdesc:abfb6f10720764d8bbbe43754fd5cd976"><td class="mdescLeft">&#160;</td><td class="mdescRight">current likelihood  <br /></td></tr>
<tr class="separator:abfb6f10720764d8bbbe43754fd5cd976"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a187dd22c17f9e96e5a7e2fb2371abace" id="r_a187dd22c17f9e96e5a7e2fb2371abace"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a187dd22c17f9e96e5a7e2fb2371abace">logLProp</a></td></tr>
<tr class="memdesc:a187dd22c17f9e96e5a7e2fb2371abace"><td class="mdescLeft">&#160;</td><td class="mdescRight">proposed likelihood  <br /></td></tr>
<tr class="separator:a187dd22c17f9e96e5a7e2fb2371abace"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6319d2ea50984860475bbc6c708b0d90" id="r_a6319d2ea50984860475bbc6c708b0d90"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a6319d2ea50984860475bbc6c708b0d90">accProb</a></td></tr>
<tr class="memdesc:a6319d2ea50984860475bbc6c708b0d90"><td class="mdescLeft">&#160;</td><td class="mdescRight">current acceptance prob  <br /></td></tr>
<tr class="separator:a6319d2ea50984860475bbc6c708b0d90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2774f3a0047c4347ee0db05406425f79" id="r_a2774f3a0047c4347ee0db05406425f79"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a2774f3a0047c4347ee0db05406425f79">accCount</a></td></tr>
<tr class="memdesc:a2774f3a0047c4347ee0db05406425f79"><td class="mdescLeft">&#160;</td><td class="mdescRight">counts accepted steps  <br /></td></tr>
<tr class="separator:a2774f3a0047c4347ee0db05406425f79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f435e161c96eea778aba844115428d4" id="r_a6f435e161c96eea778aba844115428d4"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a6f435e161c96eea778aba844115428d4">sample_llh</a></td></tr>
<tr class="memdesc:a6f435e161c96eea778aba844115428d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">store the llh breakdowns  <br /></td></tr>
<tr class="separator:a6f435e161c96eea778aba844115428d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace2eeca9829f63200c3f956c600d09ff" id="r_ace2eeca9829f63200c3f956c600d09ff"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#ace2eeca9829f63200c3f956c600d09ff">syst_llh</a></td></tr>
<tr class="memdesc:ace2eeca9829f63200c3f956c600d09ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">systematic llh breakdowns  <br /></td></tr>
<tr class="separator:ace2eeca9829f63200c3f956c600d09ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afac0dcceb1df194159c07945e8dc0069" id="r_afac0dcceb1df194159c07945e8dc0069"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classsamplePDFBase.html">samplePDFBase</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a></td></tr>
<tr class="memdesc:afac0dcceb1df194159c07945e8dc0069"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sample holder.  <br /></td></tr>
<tr class="separator:afac0dcceb1df194159c07945e8dc0069"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe9814558b8ff1bccdde3b4c894467e6" id="r_abe9814558b8ff1bccdde3b4c894467e6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a></td></tr>
<tr class="memdesc:abe9814558b8ff1bccdde3b4c894467e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of samples used.  <br /></td></tr>
<tr class="separator:abe9814558b8ff1bccdde3b4c894467e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a15d2348b7bf0a639aaab52b9294bbf" id="r_a3a15d2348b7bf0a639aaab52b9294bbf"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classcovarianceBase.html">covarianceBase</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a></td></tr>
<tr class="memdesc:a3a15d2348b7bf0a639aaab52b9294bbf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Systematic holder.  <br /></td></tr>
<tr class="separator:a3a15d2348b7bf0a639aaab52b9294bbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a858edb45544f690e90b60b9e041394a6" id="r_a858edb45544f690e90b60b9e041394a6"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TStopwatch</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a858edb45544f690e90b60b9e041394a6">clock</a></td></tr>
<tr class="memdesc:a858edb45544f690e90b60b9e041394a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">tells global time how long fit took  <br /></td></tr>
<tr class="separator:a858edb45544f690e90b60b9e041394a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fe01b2b6f7f0d6a7b04675a099e1a4f" id="r_a9fe01b2b6f7f0d6a7b04675a099e1a4f"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TStopwatch</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a9fe01b2b6f7f0d6a7b04675a099e1a4f">stepClock</a></td></tr>
<tr class="memdesc:a9fe01b2b6f7f0d6a7b04675a099e1a4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">tells how long single step/fit iteration took  <br /></td></tr>
<tr class="separator:a9fe01b2b6f7f0d6a7b04675a099e1a4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8354e9a7a9cc534277ff76ab37c9a763" id="r_a8354e9a7a9cc534277ff76ab37c9a763"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a8354e9a7a9cc534277ff76ab37c9a763">stepTime</a></td></tr>
<tr class="memdesc:a8354e9a7a9cc534277ff76ab37c9a763"><td class="mdescLeft">&#160;</td><td class="mdescRight">Time of single step.  <br /></td></tr>
<tr class="separator:a8354e9a7a9cc534277ff76ab37c9a763"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a138f250d9204a30204e4ca5b973008b2" id="r_a138f250d9204a30204e4ca5b973008b2"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TRandom3</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a138f250d9204a30204e4ca5b973008b2">random</a></td></tr>
<tr class="memdesc:a138f250d9204a30204e4ca5b973008b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Random number.  <br /></td></tr>
<tr class="separator:a138f250d9204a30204e4ca5b973008b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4260b312e3f35cf01fc73b02239f8990" id="r_a4260b312e3f35cf01fc73b02239f8990"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TFile</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a></td></tr>
<tr class="memdesc:a4260b312e3f35cf01fc73b02239f8990"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output.  <br /></td></tr>
<tr class="separator:a4260b312e3f35cf01fc73b02239f8990"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacc46437245ba8a9817f2ed2e86a96e0" id="r_aacc46437245ba8a9817f2ed2e86a96e0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TDirectory</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#aacc46437245ba8a9817f2ed2e86a96e0">CovFolder</a></td></tr>
<tr class="memdesc:aacc46437245ba8a9817f2ed2e86a96e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output cov folder.  <br /></td></tr>
<tr class="separator:aacc46437245ba8a9817f2ed2e86a96e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed2032b9c4a4f2248abe548f54f8dcc8" id="r_aed2032b9c4a4f2248abe548f54f8dcc8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a></td></tr>
<tr class="memdesc:aed2032b9c4a4f2248abe548f54f8dcc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output tree with posteriors.  <br /></td></tr>
<tr class="separator:aed2032b9c4a4f2248abe548f54f8dcc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad955982e63066918cba9c53381608d09" id="r_ad955982e63066918cba9c53381608d09"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#ad955982e63066918cba9c53381608d09">auto_save</a></td></tr>
<tr class="memdesc:ad955982e63066918cba9c53381608d09"><td class="mdescLeft">&#160;</td><td class="mdescRight">auto save every N steps  <br /></td></tr>
<tr class="separator:ad955982e63066918cba9c53381608d09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada898e35bab22af470f2cd1e28af609b" id="r_ada898e35bab22af470f2cd1e28af609b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#ada898e35bab22af470f2cd1e28af609b">fTestLikelihood</a></td></tr>
<tr class="memdesc:ada898e35bab22af470f2cd1e28af609b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Necessary for some fitting algorithms like <a class="el" href="classPSO.html" title="Class PSO, consist of a vector of object Class Particle and global best Takes in the size (number of ...">PSO</a>.  <br /></td></tr>
<tr class="separator:ada898e35bab22af470f2cd1e28af609b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedd882d8e4d0da0f89cf94e3a008affe" id="r_aedd882d8e4d0da0f89cf94e3a008affe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#aedd882d8e4d0da0f89cf94e3a008affe">save_nominal</a></td></tr>
<tr class="memdesc:aedd882d8e4d0da0f89cf94e3a008affe"><td class="mdescLeft">&#160;</td><td class="mdescRight">save nominal matrix info or not  <br /></td></tr>
<tr class="separator:aedd882d8e4d0da0f89cf94e3a008affe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a490b8614c4089c6db10ff357e7aaab67" id="r_a490b8614c4089c6db10ff357e7aaab67"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a490b8614c4089c6db10ff357e7aaab67">SaveProposal</a></td></tr>
<tr class="memdesc:a490b8614c4089c6db10ff357e7aaab67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save proposal at each step.  <br /></td></tr>
<tr class="separator:a490b8614c4089c6db10ff357e7aaab67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a699abe6a2c89706b54544212152d613a" id="r_a699abe6a2c89706b54544212152d613a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a699abe6a2c89706b54544212152d613a">FileSaved</a></td></tr>
<tr class="memdesc:a699abe6a2c89706b54544212152d613a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if file saved not repeat some operations.  <br /></td></tr>
<tr class="separator:a699abe6a2c89706b54544212152d613a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a588678c71d816f48ba3c140543dbe916" id="r_a588678c71d816f48ba3c140543dbe916"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a588678c71d816f48ba3c140543dbe916">SettingsSaved</a></td></tr>
<tr class="memdesc:a588678c71d816f48ba3c140543dbe916"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if setting saved not repeat some operations.  <br /></td></tr>
<tr class="separator:a588678c71d816f48ba3c140543dbe916"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bfd8f69df891d03bae0587cd1a1e1b7" id="r_a3bfd8f69df891d03bae0587cd1a1e1b7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a3bfd8f69df891d03bae0587cd1a1e1b7">OutputPrepared</a></td></tr>
<tr class="memdesc:a3bfd8f69df891d03bae0587cd1a1e1b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if output prepared not repeat some operations.  <br /></td></tr>
<tr class="separator:a3bfd8f69df891d03bae0587cd1a1e1b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Base class for implementing fitting algorithms. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c" title="Get content of config file if node is not found take default value specified.">For</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c" title="Get content of config file if node is not found take default value specified.">more</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c" title="Get content of config file if node is not found take default value specified.">details</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c" title="Get content of config file if node is not found take default value specified.">visit</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c" title="Get content of config file if node is not found take default value specified.">the</a> <a href="https://github.com/mach3-software/MaCh3/wiki/06.-Fitting-Algorithms">Wiki</a>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00023">23</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a2d45811f9bcb9719f312048bbd36a423" name="a2d45811f9bcb9719f312048bbd36a423"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d45811f9bcb9719f312048bbd36a423">&#9670;&#160;</a></span>FitterBase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FitterBase::FitterBase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmanager.html">manager</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a>&#160;</td>
          <td class="paramname"><em>fitMan</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fitMan</td><td>A pointer to a manager object, which will handle all settings. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00013">13</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   13</span>                                          : <a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>(<a class="code hl_variable" href="GetPostfitParamPlots_8cpp.html#aa6f3c9a8cee8f72f6f8ce65b720a2d40">man</a>) {</div>
<div class="line"><span class="lineno">   14</span><span class="comment">// *************************</span></div>
<div class="line"><span class="lineno">   15</span> </div>
<div class="line"><span class="lineno">   16</span>  <span class="comment">//Get mach3 modes from manager</span></div>
<div class="line"><span class="lineno">   17</span>  <a class="code hl_variable" href="classFitterBase.html#a004cb6e6168032d9280ce3db912f1a43">Modes</a> = <a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#a297a81517f0a46bda90f42b211e42cf5">GetMaCh3Modes</a>();</div>
<div class="line"><span class="lineno">   18</span>  <a class="code hl_variable" href="classFitterBase.html#a138f250d9204a30204e4ca5b973008b2">random</a> = std::make_unique&lt;TRandom3&gt;(<a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;Seed&quot;</span>].as&lt;<span class="keywordtype">int</span>&gt;());</div>
<div class="line"><span class="lineno">   19</span> </div>
<div class="line"><span class="lineno">   20</span>  <span class="comment">// Counter of the accepted # of steps</span></div>
<div class="line"><span class="lineno">   21</span>  <a class="code hl_variable" href="classFitterBase.html#a2774f3a0047c4347ee0db05406425f79">accCount</a> = 0;</div>
<div class="line"><span class="lineno">   22</span>  <a class="code hl_variable" href="classFitterBase.html#a50df1bd75b20a953f81ab9c2bab6b42c">step</a> = 0;</div>
<div class="line"><span class="lineno">   23</span> </div>
<div class="line"><span class="lineno">   24</span>  <a class="code hl_variable" href="classFitterBase.html#a858edb45544f690e90b60b9e041394a6">clock</a> = std::make_unique&lt;TStopwatch&gt;();</div>
<div class="line"><span class="lineno">   25</span>  <a class="code hl_variable" href="classFitterBase.html#a9fe01b2b6f7f0d6a7b04675a099e1a4f">stepClock</a> = std::make_unique&lt;TStopwatch&gt;();</div>
<div class="line"><span class="lineno">   26</span><span class="preprocessor">  #ifdef DEBUG</span></div>
<div class="line"><span class="lineno">   27</span>  <span class="comment">// Fit summary and debug info</span></div>
<div class="line"><span class="lineno">   28</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">debug</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">GetFromManager&lt;bool&gt;</a>(<a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;Debug&quot;</span>], <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">   29</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">   30</span> </div>
<div class="line"><span class="lineno">   31</span>  <span class="keyword">auto</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">outfile</a> = <a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;OutputFile&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><span class="lineno">   32</span>  <span class="comment">// Save output every auto_save steps</span></div>
<div class="line"><span class="lineno">   33</span>  <span class="comment">//you don&#39;t want this too often https://root.cern/root/html606/TTree_8cxx_source.html#l01229</span></div>
<div class="line"><span class="lineno">   34</span>  <a class="code hl_variable" href="classFitterBase.html#ad955982e63066918cba9c53381608d09">auto_save</a> = <a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;MCMC&quot;</span>][<span class="stringliteral">&quot;AutoSave&quot;</span>].as&lt;<span class="keywordtype">int</span>&gt;();</div>
<div class="line"><span class="lineno">   35</span>  <span class="comment">// Do we want to save the nominal parameters to output</span></div>
<div class="line"><span class="lineno">   36</span>  <a class="code hl_variable" href="classFitterBase.html#aedd882d8e4d0da0f89cf94e3a008affe">save_nominal</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   37</span> </div>
<div class="line"><span class="lineno">   38</span>  <span class="comment">// Do we want to save proposal? This will break plotting scripts and is heave for disk space and step time. Only use when debugging</span></div>
<div class="line"><span class="lineno">   39</span>  <a class="code hl_variable" href="classFitterBase.html#a490b8614c4089c6db10ff357e7aaab67">SaveProposal</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   40</span> </div>
<div class="line"><span class="lineno">   41</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">   42</span>  <span class="comment">//KS: TODO This should help with performance when saving entries to ROOT file. I didn&#39;t have time to validate hence commented out</span></div>
<div class="line"><span class="lineno">   43</span>  <span class="comment">//Based on other tests it is really helpful</span></div>
<div class="line"><span class="lineno">   44</span>  <span class="comment">//ROOT::EnableImplicitMT();</span></div>
<div class="line"><span class="lineno">   45</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">   46</span>  <span class="comment">// Set the output file</span></div>
<div class="line"><span class="lineno">   47</span>  <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a> = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TFile</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">outfile</a>.c_str(), <span class="stringliteral">&quot;RECREATE&quot;</span>);</div>
<div class="line"><span class="lineno">   48</span>  <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">   49</span>  <span class="comment">// Set output tree</span></div>
<div class="line"><span class="lineno">   50</span>  <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a> = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a>(<span class="stringliteral">&quot;posteriors&quot;</span>, <span class="stringliteral">&quot;Posterior_Distributions&quot;</span>);</div>
<div class="line"><span class="lineno">   51</span>  <span class="comment">// Auto-save every 200MB, the bigger the better https://root.cern/root/html606/TTree_8cxx_source.html#l01229</span></div>
<div class="line"><span class="lineno">   52</span>  <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>-&gt;SetAutoSave(-200<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">E6</a>);</div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span>  <a class="code hl_variable" href="classFitterBase.html#a699abe6a2c89706b54544212152d613a">FileSaved</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   55</span>  <a class="code hl_variable" href="classFitterBase.html#a588678c71d816f48ba3c140543dbe916">SettingsSaved</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   56</span>  <a class="code hl_variable" href="classFitterBase.html#a3bfd8f69df891d03bae0587cd1a1e1b7">OutputPrepared</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span>  <span class="comment">//Create TDirectory</span></div>
<div class="line"><span class="lineno">   59</span>  <a class="code hl_variable" href="classFitterBase.html#aacc46437245ba8a9817f2ed2e86a96e0">CovFolder</a> = <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;CovarianceFolder&quot;</span>);</div>
<div class="line"><span class="lineno">   60</span>  <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">   61</span> </div>
<div class="line"><span class="lineno">   62</span><span class="preprocessor">  #ifdef DEBUG</span></div>
<div class="line"><span class="lineno">   63</span>  <span class="comment">// Prepare the output log file</span></div>
<div class="line"><span class="lineno">   64</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">debug</a>) <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">debugFile</a>.open((<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">outfile</a>+<span class="stringliteral">&quot;.log&quot;</span>).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>());</div>
<div class="line"><span class="lineno">   65</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>  <a class="code hl_variable" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a> = 0;</div>
<div class="line"><span class="lineno">   68</span>  <a class="code hl_variable" href="classFitterBase.html#ada898e35bab22af470f2cd1e28af609b">fTestLikelihood</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">GetFromManager&lt;bool&gt;</a>(<a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;Fitter&quot;</span>][<span class="stringliteral">&quot;FitTestLikelihood&quot;</span>], <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">   69</span>}</div>
<div class="ttc" id="aGetPostfitParamPlots_8cpp_html_aa6f3c9a8cee8f72f6f8ce65b720a2d40"><div class="ttname"><a href="GetPostfitParamPlots_8cpp.html#aa6f3c9a8cee8f72f6f8ce65b720a2d40">man</a></div><div class="ttdeci">MaCh3Plotting::PlottingManager * man</div><div class="ttdef"><b>Definition</b> <a href="GetPostfitParamPlots_8cpp_source.html#l00039">GetPostfitParamPlots.cpp:39</a></div></div>
<div class="ttc" id="aYamlHelper_8h_html_a1a6adcb8b24bfbdcb936ced6812e1b0c"><div class="ttname"><a href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">GetFromManager</a></div><div class="ttdeci">Type GetFromManager(const YAML::Node &amp;node, Type defval)</div><div class="ttdoc">Get content of config file if node is not found take default value specified.</div><div class="ttdef"><b>Definition</b> <a href="YamlHelper_8h_source.html#l00021">YamlHelper.h:21</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a004cb6e6168032d9280ce3db912f1a43"><div class="ttname"><a href="classFitterBase.html#a004cb6e6168032d9280ce3db912f1a43">FitterBase::Modes</a></div><div class="ttdeci">MaCh3Modes * Modes</div><div class="ttdoc">MaCh3 Modes.</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00084">FitterBase.h:84</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a138f250d9204a30204e4ca5b973008b2"><div class="ttname"><a href="classFitterBase.html#a138f250d9204a30204e4ca5b973008b2">FitterBase::random</a></div><div class="ttdeci">std::unique_ptr&lt; TRandom3 &gt; random</div><div class="ttdoc">Random number.</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00118">FitterBase.h:118</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a2774f3a0047c4347ee0db05406425f79"><div class="ttname"><a href="classFitterBase.html#a2774f3a0047c4347ee0db05406425f79">FitterBase::accCount</a></div><div class="ttdeci">int accCount</div><div class="ttdoc">counts accepted steps</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00095">FitterBase.h:95</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a3bfd8f69df891d03bae0587cd1a1e1b7"><div class="ttname"><a href="classFitterBase.html#a3bfd8f69df891d03bae0587cd1a1e1b7">FitterBase::OutputPrepared</a></div><div class="ttdeci">bool OutputPrepared</div><div class="ttdoc">Checks if output prepared not repeat some operations.</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00141">FitterBase.h:141</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a4260b312e3f35cf01fc73b02239f8990"><div class="ttname"><a href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">FitterBase::outputFile</a></div><div class="ttdeci">TFile * outputFile</div><div class="ttdoc">Output.</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00121">FitterBase.h:121</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a490b8614c4089c6db10ff357e7aaab67"><div class="ttname"><a href="classFitterBase.html#a490b8614c4089c6db10ff357e7aaab67">FitterBase::SaveProposal</a></div><div class="ttdeci">bool SaveProposal</div><div class="ttdoc">Save proposal at each step.</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00134">FitterBase.h:134</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a4fceb68f242feeb04a0ddf42a5a37095"><div class="ttname"><a href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">FitterBase::fitMan</a></div><div class="ttdeci">manager * fitMan</div><div class="ttdoc">The manager.</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00081">FitterBase.h:81</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a50df1bd75b20a953f81ab9c2bab6b42c"><div class="ttname"><a href="classFitterBase.html#a50df1bd75b20a953f81ab9c2bab6b42c">FitterBase::step</a></div><div class="ttdeci">unsigned int step</div><div class="ttdoc">current state</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00087">FitterBase.h:87</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a588678c71d816f48ba3c140543dbe916"><div class="ttname"><a href="classFitterBase.html#a588678c71d816f48ba3c140543dbe916">FitterBase::SettingsSaved</a></div><div class="ttdeci">bool SettingsSaved</div><div class="ttdoc">Checks if setting saved not repeat some operations.</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00139">FitterBase.h:139</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a699abe6a2c89706b54544212152d613a"><div class="ttname"><a href="classFitterBase.html#a699abe6a2c89706b54544212152d613a">FitterBase::FileSaved</a></div><div class="ttdeci">bool FileSaved</div><div class="ttdoc">Checks if file saved not repeat some operations.</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00137">FitterBase.h:137</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a858edb45544f690e90b60b9e041394a6"><div class="ttname"><a href="classFitterBase.html#a858edb45544f690e90b60b9e041394a6">FitterBase::clock</a></div><div class="ttdeci">std::unique_ptr&lt; TStopwatch &gt; clock</div><div class="ttdoc">tells global time how long fit took</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00111">FitterBase.h:111</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a9fe01b2b6f7f0d6a7b04675a099e1a4f"><div class="ttname"><a href="classFitterBase.html#a9fe01b2b6f7f0d6a7b04675a099e1a4f">FitterBase::stepClock</a></div><div class="ttdeci">std::unique_ptr&lt; TStopwatch &gt; stepClock</div><div class="ttdoc">tells how long single step/fit iteration took</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00113">FitterBase.h:113</a></div></div>
<div class="ttc" id="aclassFitterBase_html_aacc46437245ba8a9817f2ed2e86a96e0"><div class="ttname"><a href="classFitterBase.html#aacc46437245ba8a9817f2ed2e86a96e0">FitterBase::CovFolder</a></div><div class="ttdeci">TDirectory * CovFolder</div><div class="ttdoc">Output cov folder.</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00123">FitterBase.h:123</a></div></div>
<div class="ttc" id="aclassFitterBase_html_abe9814558b8ff1bccdde3b4c894467e6"><div class="ttname"><a href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">FitterBase::TotalNSamples</a></div><div class="ttdeci">unsigned int TotalNSamples</div><div class="ttdoc">Total number of samples used.</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00105">FitterBase.h:105</a></div></div>
<div class="ttc" id="aclassFitterBase_html_ad955982e63066918cba9c53381608d09"><div class="ttname"><a href="classFitterBase.html#ad955982e63066918cba9c53381608d09">FitterBase::auto_save</a></div><div class="ttdeci">int auto_save</div><div class="ttdoc">auto save every N steps</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00127">FitterBase.h:127</a></div></div>
<div class="ttc" id="aclassFitterBase_html_ada898e35bab22af470f2cd1e28af609b"><div class="ttname"><a href="classFitterBase.html#ada898e35bab22af470f2cd1e28af609b">FitterBase::fTestLikelihood</a></div><div class="ttdeci">bool fTestLikelihood</div><div class="ttdoc">Necessary for some fitting algorithms like PSO.</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00130">FitterBase.h:130</a></div></div>
<div class="ttc" id="aclassFitterBase_html_aed2032b9c4a4f2248abe548f54f8dcc8"><div class="ttname"><a href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">FitterBase::outTree</a></div><div class="ttdeci">TTree * outTree</div><div class="ttdoc">Output tree with posteriors.</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00125">FitterBase.h:125</a></div></div>
<div class="ttc" id="aclassFitterBase_html_aedd882d8e4d0da0f89cf94e3a008affe"><div class="ttname"><a href="classFitterBase.html#aedd882d8e4d0da0f89cf94e3a008affe">FitterBase::save_nominal</a></div><div class="ttdeci">bool save_nominal</div><div class="ttdoc">save nominal matrix info or not</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00132">FitterBase.h:132</a></div></div>
<div class="ttc" id="aclassmanager_html_a297a81517f0a46bda90f42b211e42cf5"><div class="ttname"><a href="classmanager.html#a297a81517f0a46bda90f42b211e42cf5">manager::GetMaCh3Modes</a></div><div class="ttdeci">MaCh3Modes * GetMaCh3Modes() const</div><div class="ttdoc">Return pointer to MaCh3 modes.</div><div class="ttdef"><b>Definition</b> <a href="manager_8h_source.html#l00038">manager.h:38</a></div></div>
<div class="ttc" id="aclassmanager_html_ab3999cc856ede72b37f68bdb28bd5520"><div class="ttname"><a href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">manager::raw</a></div><div class="ttdeci">YAML::Node const &amp; raw()</div><div class="ttdoc">Return config.</div><div class="ttdef"><b>Definition</b> <a href="manager_8h_source.html#l00036">manager.h:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae8677b449e49ca86bafee685e8dbe93f" name="ae8677b449e49ca86bafee685e8dbe93f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8677b449e49ca86bafee685e8dbe93f">&#9670;&#160;</a></span>~FitterBase()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">FitterBase::~FitterBase </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor for the <a class="el" href="classFitterBase.html" title="Base class for implementing fitting algorithms.">FitterBase</a> class. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00073">73</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   73</span>                        {</div>
<div class="line"><span class="lineno">   74</span><span class="comment">// *************************</span></div>
<div class="line"><span class="lineno">   75</span>  <a class="code hl_function" href="classFitterBase.html#a418f581b688f035211107ddd83168c08">SaveOutput</a>();</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a> != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>;</div>
<div class="line"><span class="lineno">   78</span>  <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   79</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a>(<span class="stringliteral">&quot;Closing MaCh3 Fitter Engine&quot;</span>);</div>
<div class="line"><span class="lineno">   80</span>}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a4db4657acad5c79ac4bbb66a9d1c5905"><div class="ttname"><a href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a></div><div class="ttdeci">#define MACH3LOG_DEBUG</div><div class="ttdef"><b>Definition</b> <a href="MaCh3Logger_8h_source.html#l00015">MaCh3Logger.h:15</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a418f581b688f035211107ddd83168c08"><div class="ttname"><a href="classFitterBase.html#a418f581b688f035211107ddd83168c08">FitterBase::SaveOutput</a></div><div class="ttdeci">void SaveOutput()</div><div class="ttdoc">Save output and close files.</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8cpp_source.html#l00215">FitterBase.cpp:215</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="abe93c6d49aa079d811a9021de59691b1" name="abe93c6d49aa079d811a9021de59691b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe93c6d49aa079d811a9021de59691b1">&#9670;&#160;</a></span>addSamplePDF()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> FitterBase::addSamplePDF </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsamplePDFBase.html">samplePDFBase</a> *&#160;</td>
          <td class="paramname"><em>sample</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function adds a sample PDF object to the analysis framework. The sample PDF object will be utilized in fitting procedures or likelihood scans. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sample</td><td>A pointer to a sample PDF object derived from <a class="el" href="classsamplePDFBase.html" title="Class responsible for handling implementation of samples used in analysis, reweighting and returning ...">samplePDFBase</a>. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00240">240</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  240</span>                                                          {</div>
<div class="line"><span class="lineno">  241</span><span class="comment">// *************************</span></div>
<div class="line"><span class="lineno">  242</span>  <a class="code hl_variable" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a> += <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sample</a>-&gt;GetNsamples();</div>
<div class="line"><span class="lineno">  243</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Adding {} object, with {} samples&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sample</a>-&gt;GetName(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sample</a>-&gt;GetNsamples());</div>
<div class="line"><span class="lineno">  244</span>  <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.push_back(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sample</a>);</div>
<div class="line"><span class="lineno">  245</span> </div>
<div class="line"><span class="lineno">  246</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  247</span>}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a95fa4dffc648e4c5536c9292c2bdcac3"><div class="ttname"><a href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a></div><div class="ttdeci">#define MACH3LOG_INFO</div><div class="ttdef"><b>Definition</b> <a href="MaCh3Logger_8h_source.html#l00016">MaCh3Logger.h:16</a></div></div>
<div class="ttc" id="aclassFitterBase_html_afac0dcceb1df194159c07945e8dc0069"><div class="ttname"><a href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">FitterBase::samples</a></div><div class="ttdeci">std::vector&lt; samplePDFBase * &gt; samples</div><div class="ttdoc">Sample holder.</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00103">FitterBase.h:103</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1d0068193922448a6fed0e0d3ff4305a" name="a1d0068193922448a6fed0e0d3ff4305a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d0068193922448a6fed0e0d3ff4305a">&#9670;&#160;</a></span>addSystObj()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> FitterBase::addSystObj </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcovarianceBase.html">covarianceBase</a> *&#160;</td>
          <td class="paramname"><em>cov</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function adds a Covariance object to the analysis framework. The Covariance object will be utilized in fitting procedures or likelihood scans. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cov</td><td>A pointer to a Covariance object derived from <a class="el" href="classcovarianceBase.html" title="Base class responsible for handling of systematic error parameters. Capable of using PCA or using ada...">covarianceBase</a>. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00251">251</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  251</span>                                                      {</div>
<div class="line"><span class="lineno">  252</span><span class="comment">// *************************</span></div>
<div class="line"><span class="lineno">  253</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Adding systematic object {}, with {} params&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getName(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetNumParams());</div>
<div class="line"><span class="lineno">  254</span>  <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.push_back(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>);</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>  <a class="code hl_variable" href="classFitterBase.html#aacc46437245ba8a9817f2ed2e86a96e0">CovFolder</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  257</span>  std::vector&lt;double&gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_vec</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetNumParams());</div>
<div class="line"><span class="lineno">  258</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetNumParams(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>)</div>
<div class="line"><span class="lineno">  259</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_vec</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getParInit(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno">  260</span> </div>
<div class="line"><span class="lineno">  261</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TVectorT&lt;double&gt;</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">t_vec</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetNumParams(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_vec</a>.data());</div>
<div class="line"><span class="lineno">  262</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">t_vec</a>.Write((<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getName() + <span class="stringliteral">&quot;_prior&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getCovMatrix()-&gt;Write(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getName().c_str());</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH2D</a>* <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CorrMatrix</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetCorrelationMatrix();</div>
<div class="line"><span class="lineno">  267</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CorrMatrix</a>-&gt;Write((<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getName() + std::string(<span class="stringliteral">&quot;_Corr&quot;</span>)).c_str());</div>
<div class="line"><span class="lineno">  268</span>  <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CorrMatrix</a>;</div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span>  <span class="comment">// If we have yaml config file for covariance let&#39;s save it</span></div>
<div class="line"><span class="lineno">  271</span>  YAML::Node <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Config</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetConfig();</div>
<div class="line"><span class="lineno">  272</span>  <span class="keywordflow">if</span>(!<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Config</a>.IsNull())</div>
<div class="line"><span class="lineno">  273</span>  {</div>
<div class="line"><span class="lineno">  274</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TMacro</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ConfigSave</a> = <a class="code hl_function" href="YamlHelper_8h.html#a2d4f3247b6e13ef8c127ff66e699d3cb">YAMLtoTMacro</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Config</a>, (std::string(<span class="stringliteral">&quot;Config_&quot;</span>) + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getName()));</div>
<div class="line"><span class="lineno">  275</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ConfigSave</a>.Write();</div>
<div class="line"><span class="lineno">  276</span>  }</div>
<div class="line"><span class="lineno">  277</span> </div>
<div class="line"><span class="lineno">  278</span>  <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  279</span> </div>
<div class="line"><span class="lineno">  280</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  281</span>}</div>
<div class="ttc" id="aYamlHelper_8h_html_a2d4f3247b6e13ef8c127ff66e699d3cb"><div class="ttname"><a href="YamlHelper_8h.html#a2d4f3247b6e13ef8c127ff66e699d3cb">YAMLtoTMacro</a></div><div class="ttdeci">TMacro YAMLtoTMacro(const YAML::Node &amp;yaml_node, const std::string &amp;name)</div><div class="ttdoc">Convert a YAML node to a ROOT TMacro object.</div><div class="ttdef"><b>Definition</b> <a href="YamlHelper_8h_source.html#l00162">YamlHelper.h:162</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a3a15d2348b7bf0a639aaab52b9294bbf"><div class="ttname"><a href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">FitterBase::systematics</a></div><div class="ttdeci">std::vector&lt; covarianceBase * &gt; systematics</div><div class="ttdoc">Systematic holder.</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00108">FitterBase.h:108</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab3db1d0bb7364e70cd432a3e1c0a600e" name="ab3db1d0bb7364e70cd432a3e1c0a600e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3db1d0bb7364e70cd432a3e1c0a600e">&#9670;&#160;</a></span>DragRace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> FitterBase::DragRace </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>NLaps</em> = <code>100</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the required time for each sample or covariance object in a drag race simulation. Inspired by Dan's feature. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">NLaps</td><td>number of laps, every part of Fitter will be tested with given number of laps and you will get total and average time </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00403">403</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  403</span>                                         {</div>
<div class="line"><span class="lineno">  404</span><span class="comment">// *************************</span></div>
<div class="line"><span class="lineno">  405</span> </div>
<div class="line"><span class="lineno">  406</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Let the Race Begin!&quot;</span>);</div>
<div class="line"><span class="lineno">  407</span>  <span class="comment">// Reweight the MC</span></div>
<div class="line"><span class="lineno">  408</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>++ )</div>
<div class="line"><span class="lineno">  409</span>  {</div>
<div class="line"><span class="lineno">  410</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TStopwatch</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">clockRace</a>;</div>
<div class="line"><span class="lineno">  411</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">clockRace</a>.Start();</div>
<div class="line"><span class="lineno">  412</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Lap</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Lap</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NLaps</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Lap</a>++) {</div>
<div class="line"><span class="lineno">  413</span>      <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;reweight();</div>
<div class="line"><span class="lineno">  414</span>    }</div>
<div class="line"><span class="lineno">  415</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">clockRace</a>.Stop();</div>
<div class="line"><span class="lineno">  416</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;It took {:.4f} s to reweights {} times sample: {}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">clockRace</a>.RealTime(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NLaps</a>, <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;GetName());</div>
<div class="line"><span class="lineno">  417</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;On average {:.6f}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">clockRace</a>.RealTime()/<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NLaps</a>);</div>
<div class="line"><span class="lineno">  418</span>  }</div>
<div class="line"><span class="lineno">  419</span> </div>
<div class="line"><span class="lineno">  420</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>++ )</div>
<div class="line"><span class="lineno">  421</span>  {</div>
<div class="line"><span class="lineno">  422</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TStopwatch</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">clockRace</a>;</div>
<div class="line"><span class="lineno">  423</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">clockRace</a>.Start();</div>
<div class="line"><span class="lineno">  424</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Lap</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Lap</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NLaps</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Lap</a>++) {</div>
<div class="line"><span class="lineno">  425</span>      <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;GetLikelihood();</div>
<div class="line"><span class="lineno">  426</span>    }</div>
<div class="line"><span class="lineno">  427</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">clockRace</a>.Stop();</div>
<div class="line"><span class="lineno">  428</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;It took {:.4f} s to calculate  GetLikelihood {} times sample:  {}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">clockRace</a>.RealTime(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NLaps</a>, <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;GetName());</div>
<div class="line"><span class="lineno">  429</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;On average {:.6f}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">clockRace</a>.RealTime()/<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NLaps</a>);</div>
<div class="line"><span class="lineno">  430</span>  }</div>
<div class="line"><span class="lineno">  431</span>  <span class="comment">// Get vector of proposed steps. If we want to run LLH scan or something else after we need to revert changes after proposing steps multiple times</span></div>
<div class="line"><span class="lineno">  432</span>  std::vector&lt;std::vector&lt;double&gt;&gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">StepsValuesBefore</a>(<a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size());</div>
<div class="line"><span class="lineno">  433</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a> &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>) {</div>
<div class="line"><span class="lineno">  434</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">StepsValuesBefore</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>] = <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>]-&gt;getProposed();</div>
<div class="line"><span class="lineno">  435</span>  }</div>
<div class="line"><span class="lineno">  436</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a> &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>) {</div>
<div class="line"><span class="lineno">  437</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TStopwatch</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">clockRace</a>;</div>
<div class="line"><span class="lineno">  438</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">clockRace</a>.Start();</div>
<div class="line"><span class="lineno">  439</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Lap</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Lap</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NLaps</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Lap</a>++) {</div>
<div class="line"><span class="lineno">  440</span>      <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>]-&gt;proposeStep();</div>
<div class="line"><span class="lineno">  441</span>    }</div>
<div class="line"><span class="lineno">  442</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">clockRace</a>.Stop();</div>
<div class="line"><span class="lineno">  443</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;It took {:.4f} s to propose step {} times cov:  {}&quot;</span>,  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">clockRace</a>.RealTime(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NLaps</a>, <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>]-&gt;getName());</div>
<div class="line"><span class="lineno">  444</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;On average {:.6f}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">clockRace</a>.RealTime()/<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NLaps</a>);</div>
<div class="line"><span class="lineno">  445</span>  }</div>
<div class="line"><span class="lineno">  446</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a> &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>) {</div>
<div class="line"><span class="lineno">  447</span>    <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>]-&gt;setParameters(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">StepsValuesBefore</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>]);</div>
<div class="line"><span class="lineno">  448</span>  }</div>
<div class="line"><span class="lineno">  449</span> </div>
<div class="line"><span class="lineno">  450</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a> &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>) {</div>
<div class="line"><span class="lineno">  451</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TStopwatch</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">clockRace</a>;</div>
<div class="line"><span class="lineno">  452</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">clockRace</a>.Start();</div>
<div class="line"><span class="lineno">  453</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Lap</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Lap</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NLaps</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Lap</a>++) {</div>
<div class="line"><span class="lineno">  454</span>      <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>]-&gt;GetLikelihood();</div>
<div class="line"><span class="lineno">  455</span>    }</div>
<div class="line"><span class="lineno">  456</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">clockRace</a>.Stop();</div>
<div class="line"><span class="lineno">  457</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;It took {:.4f} s to calculate  get likelihood {} times cov:  {}&quot;</span>,  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">clockRace</a>.RealTime(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NLaps</a>, <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>]-&gt;getName());</div>
<div class="line"><span class="lineno">  458</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;On average {:.6f}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">clockRace</a>.RealTime()/<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NLaps</a>);</div>
<div class="line"><span class="lineno">  459</span>  }</div>
<div class="line"><span class="lineno">  460</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;End of race&quot;</span>);</div>
<div class="line"><span class="lineno">  461</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3706f6d722073b447b3de8c3a6516601" name="a3706f6d722073b447b3de8c3a6516601"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3706f6d722073b447b3de8c3a6516601">&#9670;&#160;</a></span>GetName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">virtual</a> std::string FitterBase::GetName </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get name of class. </p>

<p>Reimplemented in <a class="el" href="classLikelihoodFit.html#aff5ac0361aa016cebb24d4687e0da4ac">LikelihoodFit</a>, <a class="el" href="classmcmc.html#a0446e3c1f2af2173ffd6f017fdf6f1ba">mcmc</a>, <a class="el" href="classMinuitFit.html#a21eb79a3aa06baf99b0e5bd86e9d5c7c">MinuitFit</a>, and <a class="el" href="classPSO.html#a95d9cbbfdcdc4d453254a3b1477cbbab">PSO</a>.</p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00066">66</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   66</span>{<span class="keywordflow">return</span> <span class="stringliteral">&quot;FitterBase&quot;</span>;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a63820450a9089d5281769288c007db55" name="a63820450a9089d5281769288c007db55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63820450a9089d5281769288c007db55">&#9670;&#160;</a></span>GetStepScaleBasedOnLLHScan()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> FitterBase::GetStepScaleBasedOnLLHScan </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>LLH scan is good first estimate of step scale. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00790">790</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  790</span>                                            {</div>
<div class="line"><span class="lineno">  791</span><span class="comment">// *************************</span></div>
<div class="line"><span class="lineno">  792</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TDirectory</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Sample_LLH</a> = <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;Get&lt;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TDirectory</a>&gt;(<span class="stringliteral">&quot;Sample_LLH&quot;</span>);</div>
<div class="line"><span class="lineno">  793</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Starting Get Step Scale Based On LLHScan&quot;</span>);</div>
<div class="line"><span class="lineno">  794</span> </div>
<div class="line"><span class="lineno">  795</span>  <span class="keywordflow">if</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Sample_LLH</a>-&gt;IsZombie())</div>
<div class="line"><span class="lineno">  796</span>  {</div>
<div class="line"><span class="lineno">  797</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Couldn&#39;t find Sample_LLH, it looks like LLH scan wasn&#39;t run, will do this now&quot;</span>);</div>
<div class="line"><span class="lineno">  798</span>    <a class="code hl_function" href="classFitterBase.html#a018e8d09a62bca19840e1321b49df2c0">RunLLHScan</a>();</div>
<div class="line"><span class="lineno">  799</span>  }</div>
<div class="line"><span class="lineno">  800</span> </div>
<div class="line"><span class="lineno">  801</span>  <span class="keywordflow">for</span> (<a class="code hl_class" href="classcovarianceBase.html">covarianceBase</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a> : <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>)</div>
<div class="line"><span class="lineno">  802</span>  {</div>
<div class="line"><span class="lineno">  803</span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">isxsec</a> = (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getName() == <span class="stringliteral">&quot;xsec_cov&quot;</span>);</div>
<div class="line"><span class="lineno">  804</span> </div>
<div class="line"><span class="lineno">  805</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">npars</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetNumParams();</div>
<div class="line"><span class="lineno">  806</span>    std::vector&lt;double&gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">StepScale</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">npars</a>);</div>
<div class="line"><span class="lineno">  807</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">npars</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>)</div>
<div class="line"><span class="lineno">  808</span>    {</div>
<div class="line"><span class="lineno">  809</span>      std::string name = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetParName(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno">  810</span>      <span class="comment">// For xsec we can get the actual name, hurray for being informative</span></div>
<div class="line"><span class="lineno">  811</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">isxsec</a>) name = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetParFancyName(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno">  812</span> </div>
<div class="line"><span class="lineno">  813</span> </div>
<div class="line"><span class="lineno">  814</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">StepScale</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetIndivStepScale(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno">  815</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a>* <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">LLHScan</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Sample_LLH</a>-&gt;Get&lt;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a>&gt;((name+<span class="stringliteral">&quot;_sam&quot;</span>).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>());</div>
<div class="line"><span class="lineno">  816</span>      <span class="keywordflow">if</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">LLHScan</a> == <span class="keyword">nullptr</span>)</div>
<div class="line"><span class="lineno">  817</span>      {</div>
<div class="line"><span class="lineno">  818</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Couldn&#39;t find LLH scan, for {}, skipping&quot;</span>, name);</div>
<div class="line"><span class="lineno">  819</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  820</span>      }</div>
<div class="line"><span class="lineno">  821</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">LLH_val</a> = std::max(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">LLHScan</a>-&gt;GetBinContent(1), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">LLHScan</a>-&gt;GetBinContent(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">LLHScan</a>-&gt;GetNbinsX()));</div>
<div class="line"><span class="lineno">  822</span>      <span class="comment">//If there is no sensitivity leave it</span></div>
<div class="line"><span class="lineno">  823</span>      <span class="keywordflow">if</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">LLH_val</a> &lt; 0.001) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  824</span> </div>
<div class="line"><span class="lineno">  825</span>      <span class="comment">// EM: assuming that the likelihood is gaussian, approximate sigma value is given by variation/sqrt(-2LLH)</span></div>
<div class="line"><span class="lineno">  826</span>      <span class="comment">// can evaluate this at any point, simple to evaluate it in the first bin of the LLH scan</span></div>
<div class="line"><span class="lineno">  827</span>      <span class="comment">// KS: We assume variation is 1 sigma, each dial has different scale so it becomes faff...</span></div>
<div class="line"><span class="lineno">  828</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Var</a> = 1.;</div>
<div class="line"><span class="lineno">  829</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">approxSigma</a> = TMath::Abs(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Var</a>)/std::sqrt(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">LLH_val</a>);</div>
<div class="line"><span class="lineno">  830</span> </div>
<div class="line"><span class="lineno">  831</span>      <span class="comment">// Based on Ewan comment I just took the 1sigma width from the LLH, assuming it was Gaussian, but then had to also scale by 2.38/sqrt(N_params)</span></div>
<div class="line"><span class="lineno">  832</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NewStepScale</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">approxSigma</a> * 2.38/std::sqrt(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">npars</a>);</div>
<div class="line"><span class="lineno">  833</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">StepScale</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NewStepScale</a>;</div>
<div class="line"><span class="lineno">  834</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a>(<span class="stringliteral">&quot;Sigma: {}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">approxSigma</a>);</div>
<div class="line"><span class="lineno">  835</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a>(<span class="stringliteral">&quot;optimal Step Size: {}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NewStepScale</a>);</div>
<div class="line"><span class="lineno">  836</span>    }</div>
<div class="line"><span class="lineno">  837</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;setIndivStepScale(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">StepScale</a>);</div>
<div class="line"><span class="lineno">  838</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;SaveUpdatedMatrixConfig();</div>
<div class="line"><span class="lineno">  839</span>  }</div>
<div class="line"><span class="lineno">  840</span>}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_ad5b2eb6377721e3ac95def22c2386bb1"><div class="ttname"><a href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a></div><div class="ttdeci">#define MACH3LOG_WARN</div><div class="ttdef"><b>Definition</b> <a href="MaCh3Logger_8h_source.html#l00017">MaCh3Logger.h:17</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a018e8d09a62bca19840e1321b49df2c0"><div class="ttname"><a href="classFitterBase.html#a018e8d09a62bca19840e1321b49df2c0">FitterBase::RunLLHScan</a></div><div class="ttdeci">void RunLLHScan()</div><div class="ttdoc">Perform a 1D likelihood scan.</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8cpp_source.html#l00465">FitterBase.cpp:465</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html"><div class="ttname"><a href="classcovarianceBase.html">covarianceBase</a></div><div class="ttdoc">Base class responsible for handling of systematic error parameters. Capable of using PCA or using ada...</div><div class="ttdef"><b>Definition</b> <a href="covarianceBase_8h_source.html#l00017">covarianceBase.h:17</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a53715760edd8c7640432f31793fd28f9" name="a53715760edd8c7640432f31793fd28f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53715760edd8c7640432f31793fd28f9">&#9670;&#160;</a></span>PrepareOutput()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> FitterBase::PrepareOutput </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prepare the output file. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00149">149</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  149</span>                               {</div>
<div class="line"><span class="lineno">  150</span><span class="comment">// *******************</span></div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classFitterBase.html#a3bfd8f69df891d03bae0587cd1a1e1b7">OutputPrepared</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  153</span>  <span class="comment">//MS: Check if we are fitting the test likelihood, rather than T2K likelihood, and only setup T2K output if not</span></div>
<div class="line"><span class="lineno">  154</span>  <span class="keywordflow">if</span>(!<a class="code hl_variable" href="classFitterBase.html#ada898e35bab22af470f2cd1e28af609b">fTestLikelihood</a>)</div>
<div class="line"><span class="lineno">  155</span>  {</div>
<div class="line"><span class="lineno">  156</span>    <span class="comment">// Check that we have added samples</span></div>
<div class="line"><span class="lineno">  157</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size()) {</div>
<div class="line"><span class="lineno">  158</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a07ff6d6a15b24f94afc88a1b89779beb">MACH3LOG_CRITICAL</a>(<span class="stringliteral">&quot;No samples Found! Is this really what you wanted?&quot;</span>);</div>
<div class="line"><span class="lineno">  159</span>      <span class="comment">//throw MaCh3Exception(__FILE__ , __LINE__ );</span></div>
<div class="line"><span class="lineno">  160</span>    }</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>    <span class="comment">// Prepare the output trees</span></div>
<div class="line"><span class="lineno">  163</span>    <span class="keywordflow">for</span> (<a class="code hl_class" href="classcovarianceBase.html">covarianceBase</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a> : <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>) {</div>
<div class="line"><span class="lineno">  164</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;SetBranches(*<a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>, <a class="code hl_variable" href="classFitterBase.html#a490b8614c4089c6db10ff357e7aaab67">SaveProposal</a>);</div>
<div class="line"><span class="lineno">  165</span>    }</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>    <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>-&gt;Branch(<span class="stringliteral">&quot;LogL&quot;</span>, &amp;<a class="code hl_variable" href="classFitterBase.html#abfb6f10720764d8bbbe43754fd5cd976">logLCurr</a>, <span class="stringliteral">&quot;LogL/D&quot;</span>);</div>
<div class="line"><span class="lineno">  168</span>    <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>-&gt;Branch(<span class="stringliteral">&quot;accProb&quot;</span>, &amp;<a class="code hl_variable" href="classFitterBase.html#a6319d2ea50984860475bbc6c708b0d90">accProb</a>, <span class="stringliteral">&quot;accProb/D&quot;</span>);</div>
<div class="line"><span class="lineno">  169</span>    <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>-&gt;Branch(<span class="stringliteral">&quot;step&quot;</span>, &amp;<a class="code hl_variable" href="classFitterBase.html#a50df1bd75b20a953f81ab9c2bab6b42c">step</a>, <span class="stringliteral">&quot;step/I&quot;</span>);</div>
<div class="line"><span class="lineno">  170</span>    <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>-&gt;Branch(<span class="stringliteral">&quot;stepTime&quot;</span>, &amp;<a class="code hl_variable" href="classFitterBase.html#a8354e9a7a9cc534277ff76ab37c9a763">stepTime</a>, <span class="stringliteral">&quot;stepTime/D&quot;</span>);</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>    <span class="comment">// Store individual likelihood components</span></div>
<div class="line"><span class="lineno">  173</span>    <span class="comment">// Using double means double as large output file!</span></div>
<div class="line"><span class="lineno">  174</span>    <a class="code hl_variable" href="classFitterBase.html#a6f435e161c96eea778aba844115428d4">sample_llh</a>.resize(<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size());</div>
<div class="line"><span class="lineno">  175</span>    <a class="code hl_variable" href="classFitterBase.html#ace2eeca9829f63200c3f956c600d09ff">syst_llh</a>.resize(<a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size());</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>) {</div>
<div class="line"><span class="lineno">  178</span>      std::stringstream <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">oss</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">oss2</a>;</div>
<div class="line"><span class="lineno">  179</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">oss</a> &lt;&lt; <span class="stringliteral">&quot;LogL_sample_&quot;</span> &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>;</div>
<div class="line"><span class="lineno">  180</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">oss2</a> &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">oss</a>.str() &lt;&lt; <span class="stringliteral">&quot;/D&quot;</span>;</div>
<div class="line"><span class="lineno">  181</span>      <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>-&gt;Branch(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">oss</a>.str().c_str(), &amp;<a class="code hl_variable" href="classFitterBase.html#a6f435e161c96eea778aba844115428d4">sample_llh</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>], <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">oss2</a>.str().c_str());</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>      <span class="comment">// For adding sample dependent branches to the posteriors tree</span></div>
<div class="line"><span class="lineno">  184</span>      <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>]-&gt;setMCMCBranches(<a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>);</div>
<div class="line"><span class="lineno">  185</span>    }</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>) {</div>
<div class="line"><span class="lineno">  188</span>      std::stringstream <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">oss</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">oss2</a>;</div>
<div class="line"><span class="lineno">  189</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">oss</a> &lt;&lt; <span class="stringliteral">&quot;LogL_systematic_&quot;</span> &lt;&lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>]-&gt;getName();</div>
<div class="line"><span class="lineno">  190</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">oss2</a> &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">oss</a>.str() &lt;&lt; <span class="stringliteral">&quot;/D&quot;</span>;</div>
<div class="line"><span class="lineno">  191</span>      <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>-&gt;Branch(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">oss</a>.str().c_str(), &amp;<a class="code hl_variable" href="classFitterBase.html#ace2eeca9829f63200c3f956c600d09ff">syst_llh</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>], <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">oss2</a>.str().c_str());</div>
<div class="line"><span class="lineno">  192</span>    }</div>
<div class="line"><span class="lineno">  193</span>  }</div>
<div class="line"><span class="lineno">  194</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  195</span>  {</div>
<div class="line"><span class="lineno">  196</span>    <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>-&gt;Branch(<span class="stringliteral">&quot;LogL&quot;</span>, &amp;<a class="code hl_variable" href="classFitterBase.html#abfb6f10720764d8bbbe43754fd5cd976">logLCurr</a>, <span class="stringliteral">&quot;LogL/D&quot;</span>);</div>
<div class="line"><span class="lineno">  197</span>    <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>-&gt;Branch(<span class="stringliteral">&quot;accProb&quot;</span>, &amp;<a class="code hl_variable" href="classFitterBase.html#a6319d2ea50984860475bbc6c708b0d90">accProb</a>, <span class="stringliteral">&quot;accProb/D&quot;</span>);</div>
<div class="line"><span class="lineno">  198</span>    <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>-&gt;Branch(<span class="stringliteral">&quot;step&quot;</span>, &amp;<a class="code hl_variable" href="classFitterBase.html#a50df1bd75b20a953f81ab9c2bab6b42c">step</a>, <span class="stringliteral">&quot;step/I&quot;</span>);</div>
<div class="line"><span class="lineno">  199</span>    <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>-&gt;Branch(<span class="stringliteral">&quot;stepTime&quot;</span>, &amp;<a class="code hl_variable" href="classFitterBase.html#a8354e9a7a9cc534277ff76ab37c9a763">stepTime</a>, <span class="stringliteral">&quot;stepTime/D&quot;</span>);</div>
<div class="line"><span class="lineno">  200</span>  }</div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;-------------------- Starting MCMC --------------------&quot;</span>);</div>
<div class="line"><span class="lineno">  203</span><span class="preprocessor">  #ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  204</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">debug</a>) {</div>
<div class="line"><span class="lineno">  205</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">debugFile</a> &lt;&lt; <span class="stringliteral">&quot;----- Starting MCMC -----&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  206</span>  }</div>
<div class="line"><span class="lineno">  207</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  208</span>  <span class="comment">// Time the progress</span></div>
<div class="line"><span class="lineno">  209</span>  <a class="code hl_variable" href="classFitterBase.html#a858edb45544f690e90b60b9e041394a6">clock</a>-&gt;Start();</div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span>  <a class="code hl_variable" href="classFitterBase.html#a3bfd8f69df891d03bae0587cd1a1e1b7">OutputPrepared</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  212</span>}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a07ff6d6a15b24f94afc88a1b89779beb"><div class="ttname"><a href="MaCh3Logger_8h.html#a07ff6d6a15b24f94afc88a1b89779beb">MACH3LOG_CRITICAL</a></div><div class="ttdeci">#define MACH3LOG_CRITICAL</div><div class="ttdef"><b>Definition</b> <a href="MaCh3Logger_8h_source.html#l00019">MaCh3Logger.h:19</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a6319d2ea50984860475bbc6c708b0d90"><div class="ttname"><a href="classFitterBase.html#a6319d2ea50984860475bbc6c708b0d90">FitterBase::accProb</a></div><div class="ttdeci">double accProb</div><div class="ttdoc">current acceptance prob</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00093">FitterBase.h:93</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a6f435e161c96eea778aba844115428d4"><div class="ttname"><a href="classFitterBase.html#a6f435e161c96eea778aba844115428d4">FitterBase::sample_llh</a></div><div class="ttdeci">std::vector&lt; double &gt; sample_llh</div><div class="ttdoc">store the llh breakdowns</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00098">FitterBase.h:98</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a8354e9a7a9cc534277ff76ab37c9a763"><div class="ttname"><a href="classFitterBase.html#a8354e9a7a9cc534277ff76ab37c9a763">FitterBase::stepTime</a></div><div class="ttdeci">double stepTime</div><div class="ttdoc">Time of single step.</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00115">FitterBase.h:115</a></div></div>
<div class="ttc" id="aclassFitterBase_html_abfb6f10720764d8bbbe43754fd5cd976"><div class="ttname"><a href="classFitterBase.html#abfb6f10720764d8bbbe43754fd5cd976">FitterBase::logLCurr</a></div><div class="ttdeci">double logLCurr</div><div class="ttdoc">current likelihood</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00089">FitterBase.h:89</a></div></div>
<div class="ttc" id="aclassFitterBase_html_ace2eeca9829f63200c3f956c600d09ff"><div class="ttname"><a href="classFitterBase.html#ace2eeca9829f63200c3f956c600d09ff">FitterBase::syst_llh</a></div><div class="ttdeci">std::vector&lt; double &gt; syst_llh</div><div class="ttdoc">systematic llh breakdowns</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00100">FitterBase.h:100</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1dccdac8611e70c759c47a65f2b1aea7" name="a1dccdac8611e70c759c47a65f2b1aea7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dccdac8611e70c759c47a65f2b1aea7">&#9670;&#160;</a></span>ProcessMCMC()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> FitterBase::ProcessMCMC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process MCMC output. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00355">355</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  355</span>                             {</div>
<div class="line"><span class="lineno">  356</span><span class="comment">// *******************</span></div>
<div class="line"><span class="lineno">  357</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a> == <span class="keyword">nullptr</span>) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  358</span> </div>
<div class="line"><span class="lineno">  359</span>  <span class="comment">// Process the MCMC</span></div>
<div class="line"><span class="lineno">  360</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;ProcessMCMC&quot;</span>].as&lt;<span class="keywordtype">bool</span>&gt;()) {</div>
<div class="line"><span class="lineno">  361</span> </div>
<div class="line"><span class="lineno">  362</span>    <span class="comment">// Make the processor</span></div>
<div class="line"><span class="lineno">  363</span>    <a class="code hl_class" href="classMCMCProcessor.html">MCMCProcessor</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Processor</a>(std::string(<a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;GetName()));</div>
<div class="line"><span class="lineno">  364</span> </div>
<div class="line"><span class="lineno">  365</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Processor</a>.Initialise();</div>
<div class="line"><span class="lineno">  366</span>    <span class="comment">// Make the TVectorD pointers which hold the processed output</span></div>
<div class="line"><span class="lineno">  367</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TVectorD</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Central</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  368</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TVectorD</a> *Errors = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  369</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TVectorD</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Central_Gauss</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  370</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TVectorD</a> *Errors_Gauss = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  371</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TVectorD</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Peaks</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span>    <span class="comment">// Make the postfit</span></div>
<div class="line"><span class="lineno">  374</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Processor</a>.GetPostfit(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Central</a>, Errors, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Central_Gauss</a>, Errors_Gauss, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Peaks</a>);</div>
<div class="line"><span class="lineno">  375</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Processor</a>.DrawPostfit();</div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span>    <span class="comment">// Make the TMatrix pointers which hold the processed output</span></div>
<div class="line"><span class="lineno">  378</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TMatrixDSym</a> *Covariance = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  379</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TMatrixDSym</a> *Correlation = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  380</span> </div>
<div class="line"><span class="lineno">  381</span>    <span class="comment">// Make the covariance matrix</span></div>
<div class="line"><span class="lineno">  382</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Processor</a>.GetCovariance(Covariance, Correlation);</div>
<div class="line"><span class="lineno">  383</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Processor</a>.DrawCovariance();</div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span>    std::vector&lt;TString&gt; <a class="code hl_variable" href="GetPenaltyTerm_8cpp.html#a871d6466cea2597401bdb203293f4033">BranchNames</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Processor</a>.GetBranchNames();</div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span>    <span class="comment">// Re-open the TFile</span></div>
<div class="line"><span class="lineno">  388</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;IsOpen()) {</div>
<div class="line"><span class="lineno">  389</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Opening output again to update with means..&quot;</span>);</div>
<div class="line"><span class="lineno">  390</span>      <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a> = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TFile</a>(<a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;Output&quot;</span>][<span class="stringliteral">&quot;Filename&quot;</span>].as&lt;std::string&gt;().c_str(), <span class="stringliteral">&quot;UPDATE&quot;</span>);</div>
<div class="line"><span class="lineno">  391</span>    }</div>
<div class="line"><span class="lineno">  392</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Central</a>-&gt;Write(<span class="stringliteral">&quot;PDF_Means&quot;</span>);</div>
<div class="line"><span class="lineno">  393</span>    Errors-&gt;Write(<span class="stringliteral">&quot;PDF_Errors&quot;</span>);</div>
<div class="line"><span class="lineno">  394</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Central_Gauss</a>-&gt;Write(<span class="stringliteral">&quot;Gauss_Means&quot;</span>);</div>
<div class="line"><span class="lineno">  395</span>    Errors_Gauss-&gt;Write(<span class="stringliteral">&quot;Errors_Gauss&quot;</span>);</div>
<div class="line"><span class="lineno">  396</span>    Covariance-&gt;Write(<span class="stringliteral">&quot;Covariance&quot;</span>);</div>
<div class="line"><span class="lineno">  397</span>    Correlation-&gt;Write(<span class="stringliteral">&quot;Correlation&quot;</span>);</div>
<div class="line"><span class="lineno">  398</span>  }</div>
<div class="line"><span class="lineno">  399</span>}</div>
<div class="ttc" id="aGetPenaltyTerm_8cpp_html_a871d6466cea2597401bdb203293f4033"><div class="ttname"><a href="GetPenaltyTerm_8cpp.html#a871d6466cea2597401bdb203293f4033">BranchNames</a></div><div class="ttdeci">std::vector&lt; TString &gt; BranchNames</div><div class="ttdef"><b>Definition</b> <a href="GetPenaltyTerm_8cpp_source.html#l00036">GetPenaltyTerm.cpp:36</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html"><div class="ttname"><a href="classMCMCProcessor.html">MCMCProcessor</a></div><div class="ttdoc">Class responsible for processing MCMC chains, performing diagnostics, generating plots,...</div><div class="ttdef"><b>Definition</b> <a href="MCMCProcessor_8h_source.html#l00062">MCMCProcessor.h:62</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab8b32ca268c20dd643eaf92dae04cd0a" name="ab8b32ca268c20dd643eaf92dae04cd0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8b32ca268c20dd643eaf92dae04cd0a">&#9670;&#160;</a></span>Run2DLLHScan()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> FitterBase::Run2DLLHScan </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform a 2D likelihood scan. </p>
<dl class="section warning"><dt>Warning</dt><dd>This operation may take a significant amount of time, especially for complex models. </dd></dl>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00844">844</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  844</span>                              {</div>
<div class="line"><span class="lineno">  845</span><span class="comment">// *************************</span></div>
<div class="line"><span class="lineno">  846</span> </div>
<div class="line"><span class="lineno">  847</span>  <span class="comment">// Save the settings into the output file</span></div>
<div class="line"><span class="lineno">  848</span>  <a class="code hl_function" href="classFitterBase.html#a48f38bfa8996fe00d51f35b05dd16b46">SaveSettings</a>();</div>
<div class="line"><span class="lineno">  849</span> </div>
<div class="line"><span class="lineno">  850</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Starting 2D LLH Scan&quot;</span>);</div>
<div class="line"><span class="lineno">  851</span> </div>
<div class="line"><span class="lineno">  852</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TDirectory</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Sample_2DLLH</a> = <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Sample_2DLLH&quot;</span>);</div>
<div class="line"><span class="lineno">  853</span>  std::vector&lt;std::string&gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SkipVector</a>;</div>
<div class="line"><span class="lineno">  854</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;LLHScanSkipVector&quot;</span>])</div>
<div class="line"><span class="lineno">  855</span>  {</div>
<div class="line"><span class="lineno">  856</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SkipVector</a> = <a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;LLHScanSkipVector&quot;</span>].as&lt;std::vector&lt;std::string&gt;&gt;();</div>
<div class="line"><span class="lineno">  857</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Found skip vector with {} entries&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SkipVector</a>.size());</div>
<div class="line"><span class="lineno">  858</span>  }</div>
<div class="line"><span class="lineno">  859</span> </div>
<div class="line"><span class="lineno">  860</span>  <span class="comment">// Number of points we do for each LLH scan</span></div>
<div class="line"><span class="lineno">  861</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_points</a> = 20;</div>
<div class="line"><span class="lineno">  862</span>  <span class="comment">// We print 5 reweights</span></div>
<div class="line"><span class="lineno">  863</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">countwidth</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">double</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_points</a>)/<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">double</a>(5);</div>
<div class="line"><span class="lineno">  864</span> </div>
<div class="line"><span class="lineno">  865</span>  <span class="keywordtype">bool</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">isxsec</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  866</span>  <span class="comment">// Loop over the covariance classes</span></div>
<div class="line"><span class="lineno">  867</span>  <span class="keywordflow">for</span> (<a class="code hl_class" href="classcovarianceBase.html">covarianceBase</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a> : <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>)</div>
<div class="line"><span class="lineno">  868</span>  {</div>
<div class="line"><span class="lineno">  869</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getName() == <span class="stringliteral">&quot;xsec_cov&quot;</span>)</div>
<div class="line"><span class="lineno">  870</span>    {</div>
<div class="line"><span class="lineno">  871</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">isxsec</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  872</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  873</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">isxsec</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  874</span>    }</div>
<div class="line"><span class="lineno">  875</span>    <span class="comment">// Scan over all the parameters</span></div>
<div class="line"><span class="lineno">  876</span>    <span class="comment">// Get the number of parameters</span></div>
<div class="line"><span class="lineno">  877</span>    <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">npars</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetNumParams();</div>
<div class="line"><span class="lineno">  878</span>    <span class="keywordtype">bool</span> IsPCA = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;IsPCA();</div>
<div class="line"><span class="lineno">  879</span>    <span class="keywordflow">if</span> (IsPCA) <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">npars</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getNpars();</div>
<div class="line"><span class="lineno">  880</span> </div>
<div class="line"><span class="lineno">  881</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">npars</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>)</div>
<div class="line"><span class="lineno">  882</span>    {</div>
<div class="line"><span class="lineno">  883</span>      std::string <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">name_x</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetParName(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno">  884</span>      <span class="keywordflow">if</span> (IsPCA) <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">name_x</a> += <span class="stringliteral">&quot;_PCA&quot;</span>;</div>
<div class="line"><span class="lineno">  885</span>      <span class="comment">// For xsec we can get the actual name, hurray for being informative</span></div>
<div class="line"><span class="lineno">  886</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">isxsec</a>) <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">name_x</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetParFancyName(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno">  887</span> </div>
<div class="line"><span class="lineno">  888</span>      <span class="comment">// Get the parameter priors and bounds</span></div>
<div class="line"><span class="lineno">  889</span>      <span class="keywordtype">double</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">prior_x</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getParInit(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno">  890</span>      <span class="keywordflow">if</span> (IsPCA) <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">prior_x</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getParCurr_PCA(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno">  891</span> </div>
<div class="line"><span class="lineno">  892</span>      <span class="comment">// Get the covariance matrix and do the +/- nSigma</span></div>
<div class="line"><span class="lineno">  893</span>      <span class="keywordtype">double</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSigma</a> = 1;</div>
<div class="line"><span class="lineno">  894</span>      <span class="keywordflow">if</span> (IsPCA) <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSigma</a> = 0.5;</div>
<div class="line"><span class="lineno">  895</span>      <span class="comment">// Set lower and upper bounds relative the prior</span></div>
<div class="line"><span class="lineno">  896</span>      <span class="keywordtype">double</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">lower_x</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">prior_x</a> - <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSigma</a>*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getDiagonalError(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno">  897</span>      <span class="keywordtype">double</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">upper_x</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">prior_x</a> + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSigma</a>*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getDiagonalError(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno">  898</span>      <span class="comment">// If PCA, transform these parameter values to the PCA basis</span></div>
<div class="line"><span class="lineno">  899</span>      <span class="keywordflow">if</span> (IsPCA) {</div>
<div class="line"><span class="lineno">  900</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">lower_x</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">prior_x</a> - <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSigma</a>*std::sqrt((<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getEigenValues())(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>));</div>
<div class="line"><span class="lineno">  901</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">upper_x</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">prior_x</a> + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSigma</a>*std::sqrt((<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getEigenValues())(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>));</div>
<div class="line"><span class="lineno">  902</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;eval {} = {:.2f}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getEigenValues()(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>));</div>
<div class="line"><span class="lineno">  903</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;prior {} = {:.2f}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">prior_x</a>);</div>
<div class="line"><span class="lineno">  904</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;lower {} = {:.2f}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">lower_x</a>);</div>
<div class="line"><span class="lineno">  905</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;upper {} = {:.2f}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">upper_x</a>);</div>
<div class="line"><span class="lineno">  906</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;nSigma = {:.2f}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSigma</a>);</div>
<div class="line"><span class="lineno">  907</span>      }</div>
<div class="line"><span class="lineno">  908</span> </div>
<div class="line"><span class="lineno">  909</span>      <span class="comment">// Cross-section and flux parameters have boundaries that we scan between, check that these are respected in setting lower and upper variables</span></div>
<div class="line"><span class="lineno">  910</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">lower_x &lt; cov-&gt;</a>GetLowerBound(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>)) {</div>
<div class="line"><span class="lineno">  911</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">lower_x</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetLowerBound(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno">  912</span>      }</div>
<div class="line"><span class="lineno">  913</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">upper_x</a> &gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetUpperBound(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>)) {</div>
<div class="line"><span class="lineno">  914</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">upper_x</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetUpperBound(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno">  915</span>      }</div>
<div class="line"><span class="lineno">  916</span> </div>
<div class="line"><span class="lineno">  917</span>      <span class="keywordtype">bool</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">skip</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  918</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SkipVector</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a>++)</div>
<div class="line"><span class="lineno">  919</span>      {</div>
<div class="line"><span class="lineno">  920</span>        <span class="keywordflow">if</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">name_x</a>.substr(0, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SkipVector</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a>].length()) == <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SkipVector</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a>])</div>
<div class="line"><span class="lineno">  921</span>        {</div>
<div class="line"><span class="lineno">  922</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">skip</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  923</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  924</span>        }</div>
<div class="line"><span class="lineno">  925</span>      }</div>
<div class="line"><span class="lineno">  926</span>      <span class="keywordflow">if</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">skip</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  927</span> </div>
<div class="line"><span class="lineno">  928</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>)</div>
<div class="line"><span class="lineno">  929</span>      {</div>
<div class="line"><span class="lineno">  930</span>        std::string <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">name_y</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetParName(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>);</div>
<div class="line"><span class="lineno">  931</span>        <span class="keywordflow">if</span> (IsPCA) <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">name_y</a> += <span class="stringliteral">&quot;_PCA&quot;</span>;</div>
<div class="line"><span class="lineno">  932</span>        <span class="comment">// For xsec we can get the actual name, hurray for being informative</span></div>
<div class="line"><span class="lineno">  933</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">isxsec</a>) <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">name_y</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetParFancyName(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>);</div>
<div class="line"><span class="lineno">  934</span> </div>
<div class="line"><span class="lineno">  935</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">skip</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  936</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SkipVector</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a>++)</div>
<div class="line"><span class="lineno">  937</span>        {</div>
<div class="line"><span class="lineno">  938</span>          <span class="keywordflow">if</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">name_y</a>.substr(0, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SkipVector</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a>].length()) == <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SkipVector</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a>])</div>
<div class="line"><span class="lineno">  939</span>          {</div>
<div class="line"><span class="lineno">  940</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">skip</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  941</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  942</span>          }</div>
<div class="line"><span class="lineno">  943</span>        }</div>
<div class="line"><span class="lineno">  944</span>        <span class="keywordflow">if</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">skip</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  945</span> </div>
<div class="line"><span class="lineno">  946</span>        <span class="comment">// Get the parameter priors and bounds</span></div>
<div class="line"><span class="lineno">  947</span>        <span class="keywordtype">double</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">prior_y</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getParInit(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>);</div>
<div class="line"><span class="lineno">  948</span>        <span class="keywordflow">if</span> (IsPCA) <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">prior_y</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getParCurr_PCA(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>);</div>
<div class="line"><span class="lineno">  949</span> </div>
<div class="line"><span class="lineno">  950</span>        <span class="comment">// Set lower and upper bounds relative the prior</span></div>
<div class="line"><span class="lineno">  951</span>        <span class="keywordtype">double</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">lower_y</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">prior_y</a> - <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSigma</a>*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getDiagonalError(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>);</div>
<div class="line"><span class="lineno">  952</span>        <span class="keywordtype">double</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">upper_y</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">prior_y</a> + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSigma</a>*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getDiagonalError(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>);</div>
<div class="line"><span class="lineno">  953</span>        <span class="comment">// If PCA, transform these parameter values to the PCA basis</span></div>
<div class="line"><span class="lineno">  954</span>        <span class="keywordflow">if</span> (IsPCA) {</div>
<div class="line"><span class="lineno">  955</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">lower_y</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">prior_y</a> - <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSigma</a>*std::sqrt((<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getEigenValues())(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>));</div>
<div class="line"><span class="lineno">  956</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">upper_y</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">prior_y</a> + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSigma</a>*std::sqrt((<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getEigenValues())(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>));</div>
<div class="line"><span class="lineno">  957</span>          <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;eval {} = {:.2f}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getEigenValues()(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>));</div>
<div class="line"><span class="lineno">  958</span>          <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;prior {} = {:.2f}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">prior_y</a>);</div>
<div class="line"><span class="lineno">  959</span>          <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;lower {} = {:.2f}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">lower_y</a>);</div>
<div class="line"><span class="lineno">  960</span>          <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;upper {} = {:.2f}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">upper_y</a>);</div>
<div class="line"><span class="lineno">  961</span>          <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;nSigma = {:.2f}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSigma</a>);</div>
<div class="line"><span class="lineno">  962</span> </div>
<div class="line"><span class="lineno">  963</span>        }</div>
<div class="line"><span class="lineno">  964</span> </div>
<div class="line"><span class="lineno">  965</span>        <span class="comment">// Cross-section and flux parameters have boundaries that we scan between, check that these are respected in setting lower and upper variables</span></div>
<div class="line"><span class="lineno">  966</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">lower_y &lt; cov-&gt;</a>GetLowerBound(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>)) {</div>
<div class="line"><span class="lineno">  967</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">lower_y</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetLowerBound(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>);</div>
<div class="line"><span class="lineno">  968</span>        }</div>
<div class="line"><span class="lineno">  969</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">upper_y</a> &gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetUpperBound(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>)) {</div>
<div class="line"><span class="lineno">  970</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">upper_y</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetUpperBound(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>);</div>
<div class="line"><span class="lineno">  971</span>        }</div>
<div class="line"><span class="lineno">  972</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Scanning X {} with {} steps, from {} - {}, prior = {}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">name_x</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_points</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">lower_x</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">upper_x</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">prior_x</a>);</div>
<div class="line"><span class="lineno">  973</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Scanning Y {} with {} steps, from {} - {}, prior = {}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">name_y</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_points</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">lower_y</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">upper_y</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">prior_y</a>);</div>
<div class="line"><span class="lineno">  974</span> </div>
<div class="line"><span class="lineno">  975</span>        <span class="keyword">auto</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSam</a> = std::make_unique&lt;TH2D&gt;((<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">name_x</a> + <span class="stringliteral">&quot;_&quot;</span> + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">name_y</a> + <span class="stringliteral">&quot;_sam&quot;</span>).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>(), (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">name_x</a> + <span class="stringliteral">&quot;_&quot;</span> + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">name_y</a> + <span class="stringliteral">&quot;_sam&quot;</span>).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>(),</div>
<div class="line"><span class="lineno">  976</span>                                                <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_points</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">lower_x</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">upper_x</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_points</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">lower_y</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">upper_y</a>);</div>
<div class="line"><span class="lineno">  977</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSam</a>-&gt;GetXaxis()-&gt;SetTitle(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">name_x</a>.c_str());</div>
<div class="line"><span class="lineno">  978</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSam</a>-&gt;GetYaxis()-&gt;SetTitle(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">name_y</a>.c_str());</div>
<div class="line"><span class="lineno">  979</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSam</a>-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;2LLH_sam&quot;</span>);</div>
<div class="line"><span class="lineno">  980</span> </div>
<div class="line"><span class="lineno">  981</span>        <span class="comment">// Scan over the parameter space</span></div>
<div class="line"><span class="lineno">  982</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">x</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">x</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_points</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">x</a>++)</div>
<div class="line"><span class="lineno">  983</span>        {</div>
<div class="line"><span class="lineno">  984</span>          <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">x</a> % <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">countwidth</a> == 0)</div>
<div class="line"><span class="lineno">  985</span>            <a class="code hl_function" href="namespaceMaCh3Utils.html#a4c8bdeb1d34606aed192e9f1311a72f5">MaCh3Utils::PrintProgressBar</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">x</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_points</a>);</div>
<div class="line"><span class="lineno">  986</span> </div>
<div class="line"><span class="lineno">  987</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">y</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">y</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_points</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">y</a>++)</div>
<div class="line"><span class="lineno">  988</span>          {</div>
<div class="line"><span class="lineno">  989</span>            <span class="comment">// For PCA we have to do it differently</span></div>
<div class="line"><span class="lineno">  990</span>            <span class="keywordflow">if</span> (IsPCA) {</div>
<div class="line"><span class="lineno">  991</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;setParProp_PCA(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSam</a>-&gt;GetXaxis()-&gt;GetBinCenter(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">x</a>+1));</div>
<div class="line"><span class="lineno">  992</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;setParProp_PCA(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSam</a>-&gt;GetYaxis()-&gt;GetBinCenter(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">y</a>+1));</div>
<div class="line"><span class="lineno">  993</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  994</span>              <span class="comment">// Set the parameter</span></div>
<div class="line"><span class="lineno">  995</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;setParProp(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSam</a>-&gt;GetXaxis()-&gt;GetBinCenter(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">x</a>+1));</div>
<div class="line"><span class="lineno">  996</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;setParProp(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSam</a>-&gt;GetYaxis()-&gt;GetBinCenter(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">y</a>+1));</div>
<div class="line"><span class="lineno">  997</span>            }</div>
<div class="line"><span class="lineno">  998</span> </div>
<div class="line"><span class="lineno">  999</span>            <span class="comment">// Reweight the MC</span></div>
<div class="line"><span class="lineno"> 1000</span>            <span class="comment">//double *fake = 0;</span></div>
<div class="line"><span class="lineno"> 1001</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>++) {</div>
<div class="line"><span class="lineno"> 1002</span>              <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;reweight();</div>
<div class="line"><span class="lineno"> 1003</span>            }</div>
<div class="line"><span class="lineno"> 1004</span> </div>
<div class="line"><span class="lineno"> 1005</span>            <span class="comment">// Get the -log L likelihoods</span></div>
<div class="line"><span class="lineno"> 1006</span>            <span class="keywordtype">double</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">samplellh</a> = 0;</div>
<div class="line"><span class="lineno"> 1007</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>++) {</div>
<div class="line"><span class="lineno"> 1008</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">samplellh</a> += <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;GetLikelihood();</div>
<div class="line"><span class="lineno"> 1009</span>            }</div>
<div class="line"><span class="lineno"> 1010</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSam</a>-&gt;SetBinContent(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">x</a>+1, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">y</a>+1, 2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">samplellh</a>);</div>
<div class="line"><span class="lineno"> 1011</span>          }<span class="comment">// end loop over y points</span></div>
<div class="line"><span class="lineno"> 1012</span>        } <span class="comment">// end loop over x points</span></div>
<div class="line"><span class="lineno"> 1013</span> </div>
<div class="line"><span class="lineno"> 1014</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Sample_2DLLH</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 1015</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSam</a>-&gt;Write();</div>
<div class="line"><span class="lineno"> 1016</span>        <span class="comment">// Reset the parameters to their prior central values</span></div>
<div class="line"><span class="lineno"> 1017</span>        <span class="keywordflow">if</span> (IsPCA) {</div>
<div class="line"><span class="lineno"> 1018</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;setParProp_PCA(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">prior_x</a>);</div>
<div class="line"><span class="lineno"> 1019</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;setParProp_PCA(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">prior_y</a>);</div>
<div class="line"><span class="lineno"> 1020</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1021</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;setParProp(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">prior_x</a>);</div>
<div class="line"><span class="lineno"> 1022</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;setParProp(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">prior_y</a>);</div>
<div class="line"><span class="lineno"> 1023</span>        }</div>
<div class="line"><span class="lineno"> 1024</span>      } <span class="comment">//end loop over systematics y</span></div>
<div class="line"><span class="lineno"> 1025</span>    }<span class="comment">//end loop over systematics X</span></div>
<div class="line"><span class="lineno"> 1026</span>  }<span class="comment">//end loop covariance classes</span></div>
<div class="line"><span class="lineno"> 1027</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Sample_2DLLH</a>-&gt;Write();</div>
<div class="line"><span class="lineno"> 1028</span>  <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Sample_2DLLH</a>;</div>
<div class="line"><span class="lineno"> 1029</span>}</div>
<div class="ttc" id="aclassFitterBase_html_a48f38bfa8996fe00d51f35b05dd16b46"><div class="ttname"><a href="classFitterBase.html#a48f38bfa8996fe00d51f35b05dd16b46">FitterBase::SaveSettings</a></div><div class="ttdeci">void SaveSettings()</div><div class="ttdoc">Save the settings that the MCMC was run with.</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8cpp_source.html#l00084">FitterBase.cpp:84</a></div></div>
<div class="ttc" id="anamespaceMaCh3Utils_html_a4c8bdeb1d34606aed192e9f1311a72f5"><div class="ttname"><a href="namespaceMaCh3Utils.html#a4c8bdeb1d34606aed192e9f1311a72f5">MaCh3Utils::PrintProgressBar</a></div><div class="ttdeci">void PrintProgressBar(const Long64_t Done, const Long64_t All)</div><div class="ttdoc">KS: Simply print progress bar.</div><div class="ttdef"><b>Definition</b> <a href="Monitor_8cpp_source.html#l00189">Monitor.cpp:189</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a018e8d09a62bca19840e1321b49df2c0" name="a018e8d09a62bca19840e1321b49df2c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a018e8d09a62bca19840e1321b49df2c0">&#9670;&#160;</a></span>RunLLHScan()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> FitterBase::RunLLHScan </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform a 1D likelihood scan. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00465">465</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  465</span>                            {</div>
<div class="line"><span class="lineno">  466</span><span class="comment">// *************************</span></div>
<div class="line"><span class="lineno">  467</span> </div>
<div class="line"><span class="lineno">  468</span>  <span class="comment">// Save the settings into the output file</span></div>
<div class="line"><span class="lineno">  469</span>  <a class="code hl_function" href="classFitterBase.html#a48f38bfa8996fe00d51f35b05dd16b46">SaveSettings</a>();</div>
<div class="line"><span class="lineno">  470</span> </div>
<div class="line"><span class="lineno">  471</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Starting LLH Scan&quot;</span>);</div>
<div class="line"><span class="lineno">  472</span> </div>
<div class="line"><span class="lineno">  473</span>  <span class="comment">//KS: Turn it on if you want LLH scan for each ND sample separately, which increase time significantly but can be useful for validating new samples or dials.</span></div>
<div class="line"><span class="lineno">  474</span>  <span class="keywordtype">bool</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">PlotAllNDsamplesLLH</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  475</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;LLHScanBySample&quot;</span>])</div>
<div class="line"><span class="lineno">  476</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">PlotAllNDsamplesLLH</a> = <a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;LLHScanBySample&quot;</span>].as&lt;<span class="keywordtype">bool</span>&gt;();</div>
<div class="line"><span class="lineno">  477</span> </div>
<div class="line"><span class="lineno">  478</span>  std::vector&lt;std::string&gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SkipVector</a>;</div>
<div class="line"><span class="lineno">  479</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;LLHScanSkipVector&quot;</span>])</div>
<div class="line"><span class="lineno">  480</span>  {</div>
<div class="line"><span class="lineno">  481</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SkipVector</a> = <a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;LLHScanSkipVector&quot;</span>].as&lt;std::vector&lt;std::string&gt;&gt;();</div>
<div class="line"><span class="lineno">  482</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Found skip vector with {} entries&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SkipVector</a>.size());</div>
<div class="line"><span class="lineno">  483</span>  }</div>
<div class="line"><span class="lineno">  484</span> </div>
<div class="line"><span class="lineno">  485</span>  <span class="comment">// Now finally get onto the LLH scan stuff</span></div>
<div class="line"><span class="lineno">  486</span>  <span class="comment">// Very similar code to MCMC but never start MCMC; just scan over the parameter space</span></div>
<div class="line"><span class="lineno">  487</span>  std::vector&lt;TDirectory *&gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Cov_LLH</a>(<a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size());</div>
<div class="line"><span class="lineno">  488</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a> &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a>++ )</div>
<div class="line"><span class="lineno">  489</span>  {</div>
<div class="line"><span class="lineno">  490</span>    std::string <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NameTemp</a> = <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a>]-&gt;getName();</div>
<div class="line"><span class="lineno">  491</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NameTemp</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NameTemp</a>.substr(0, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NameTemp</a>.find(<span class="stringliteral">&quot;_cov&quot;</span>)) + <span class="stringliteral">&quot;_LLH&quot;</span>;</div>
<div class="line"><span class="lineno">  492</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Cov_LLH</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a>] = <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;mkdir(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NameTemp</a>.c_str());</div>
<div class="line"><span class="lineno">  493</span>  }</div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span>  std::vector&lt;TDirectory *&gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleClass_LLH</a>(<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size());</div>
<div class="line"><span class="lineno">  496</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>++ )</div>
<div class="line"><span class="lineno">  497</span>  {</div>
<div class="line"><span class="lineno">  498</span>    std::string <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NameTemp</a> = <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;GetName();</div>
<div class="line"><span class="lineno">  499</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleClass_LLH</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>] = <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;mkdir(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NameTemp</a>.c_str());</div>
<div class="line"><span class="lineno">  500</span>  }</div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TDirectory</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Sample_LLH</a> = <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Sample_LLH&quot;</span>);</div>
<div class="line"><span class="lineno">  503</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TDirectory</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Total_LLH</a> = <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Total_LLH&quot;</span>);</div>
<div class="line"><span class="lineno">  504</span> </div>
<div class="line"><span class="lineno">  505</span>  std::vector&lt;TDirectory *&gt;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleSplit_LLH</a>;</div>
<div class="line"><span class="lineno">  506</span>  <span class="keywordflow">if</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">PlotAllNDsamplesLLH</a>)</div>
<div class="line"><span class="lineno">  507</span>  {</div>
<div class="line"><span class="lineno">  508</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleSplit_LLH</a>.resize(<a class="code hl_variable" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a>);</div>
<div class="line"><span class="lineno">  509</span>    <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a> = 0;</div>
<div class="line"><span class="lineno">  510</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>++ )</div>
<div class="line"><span class="lineno">  511</span>    {</div>
<div class="line"><span class="lineno">  512</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;GetNsamples(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a>++ )</div>
<div class="line"><span class="lineno">  513</span>      {</div>
<div class="line"><span class="lineno">  514</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleSplit_LLH</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>] = <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;mkdir((<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;GetSampleName(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a>)+ <span class="stringliteral">&quot;_LLH&quot;</span>).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>());</div>
<div class="line"><span class="lineno">  515</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>++;</div>
<div class="line"><span class="lineno">  516</span>      }</div>
<div class="line"><span class="lineno">  517</span>    }</div>
<div class="line"><span class="lineno">  518</span>  }</div>
<div class="line"><span class="lineno">  519</span>  <span class="comment">// Number of points we do for each LLH scan</span></div>
<div class="line"><span class="lineno">  520</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_points</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">GetFromManager&lt;int&gt;</a>(<a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;LLHScanPoints&quot;</span>], 100);</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>  <span class="comment">// We print 5 reweights</span></div>
<div class="line"><span class="lineno">  523</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">countwidth</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>(<span class="keywordtype">double</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_points</a>)/<span class="keywordtype">double</span>(5));</div>
<div class="line"><span class="lineno">  524</span> </div>
<div class="line"><span class="lineno">  525</span>  <span class="keywordtype">bool</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">isxsec</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  526</span>  <span class="comment">// Loop over the covariance classes</span></div>
<div class="line"><span class="lineno">  527</span>  <span class="keywordflow">for</span> (<a class="code hl_class" href="classcovarianceBase.html">covarianceBase</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a> : <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>)</div>
<div class="line"><span class="lineno">  528</span>  {</div>
<div class="line"><span class="lineno">  529</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getName() == <span class="stringliteral">&quot;xsec_cov&quot;</span>)</div>
<div class="line"><span class="lineno">  530</span>    {</div>
<div class="line"><span class="lineno">  531</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">isxsec</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  532</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  533</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">isxsec</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  534</span>    }</div>
<div class="line"><span class="lineno">  535</span> </div>
<div class="line"><span class="lineno">  536</span>    <span class="comment">// Scan over all the parameters</span></div>
<div class="line"><span class="lineno">  537</span>    <span class="comment">// Get the number of parameters</span></div>
<div class="line"><span class="lineno">  538</span>    <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">npars</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetNumParams();</div>
<div class="line"><span class="lineno">  539</span>    <span class="keywordtype">bool</span> IsPCA = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;IsPCA();</div>
<div class="line"><span class="lineno">  540</span>    <span class="keywordflow">if</span> (IsPCA) <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">npars</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getNpars();</div>
<div class="line"><span class="lineno">  541</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">npars</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>)</div>
<div class="line"><span class="lineno">  542</span>    {</div>
<div class="line"><span class="lineno">  543</span>      <span class="comment">// Get the parameter name</span></div>
<div class="line"><span class="lineno">  544</span>      std::string name = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetParName(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno">  545</span>      <span class="keywordflow">if</span> (IsPCA) name += <span class="stringliteral">&quot;_PCA&quot;</span>;</div>
<div class="line"><span class="lineno">  546</span>      <span class="comment">// For xsec we can get the actual name, hurray for being informative</span></div>
<div class="line"><span class="lineno">  547</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">isxsec</a>) name = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetParFancyName(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno">  548</span>      <span class="keywordtype">bool</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">skip</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  549</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SkipVector</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a>++)</div>
<div class="line"><span class="lineno">  550</span>      {</div>
<div class="line"><span class="lineno">  551</span>        <span class="keywordflow">if</span>(name.substr(0, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SkipVector</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a>].length()) == <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SkipVector</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a>])</div>
<div class="line"><span class="lineno">  552</span>        {</div>
<div class="line"><span class="lineno">  553</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">skip</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  554</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  555</span>        }</div>
<div class="line"><span class="lineno">  556</span>      }</div>
<div class="line"><span class="lineno">  557</span>      <span class="keywordflow">if</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">skip</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  558</span> </div>
<div class="line"><span class="lineno">  559</span>      <span class="comment">// Get the parameter priors and bounds</span></div>
<div class="line"><span class="lineno">  560</span>      <span class="keywordtype">double</span> prior = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getParInit(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno">  561</span>      <span class="keywordflow">if</span> (IsPCA) prior = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getParCurr_PCA(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno">  562</span> </div>
<div class="line"><span class="lineno">  563</span>      <span class="comment">// Get the covariance matrix and do the +/- nSigma</span></div>
<div class="line"><span class="lineno">  564</span>      <span class="keywordtype">double</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSigma</a> = 1;</div>
<div class="line"><span class="lineno">  565</span>      <span class="keywordflow">if</span> (IsPCA) <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSigma</a> = 0.5;</div>
<div class="line"><span class="lineno">  566</span>      <span class="comment">// Set lower and upper bounds relative the prior</span></div>
<div class="line"><span class="lineno">  567</span>      <span class="keywordtype">double</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">lower</a> = prior - <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSigma</a>*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getDiagonalError(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno">  568</span>      <span class="keywordtype">double</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">upper</a> = prior + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSigma</a>*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getDiagonalError(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno">  569</span>      <span class="comment">// If PCA, transform these parameter values to the PCA basis</span></div>
<div class="line"><span class="lineno">  570</span>      <span class="keywordflow">if</span> (IsPCA) {</div>
<div class="line"><span class="lineno">  571</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">lower</a> = prior - <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSigma</a>*std::sqrt((<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getEigenValues())(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>));</div>
<div class="line"><span class="lineno">  572</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">upper</a> = prior + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSigma</a>*std::sqrt((<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getEigenValues())(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>));</div>
<div class="line"><span class="lineno">  573</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;eval {} = {:.2f}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getEigenValues()(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>));</div>
<div class="line"><span class="lineno">  574</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;prior {} = {:.2f}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, prior);</div>
<div class="line"><span class="lineno">  575</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;lower {} = {:.2f}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">lower</a>);</div>
<div class="line"><span class="lineno">  576</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;upper {} = {:.2f}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">upper</a>);</div>
<div class="line"><span class="lineno">  577</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;nSigma = {:.2f}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSigma</a>);</div>
<div class="line"><span class="lineno">  578</span>      }</div>
<div class="line"><span class="lineno">  579</span> </div>
<div class="line"><span class="lineno">  580</span>      <span class="comment">// Cross-section and flux parameters have boundaries that we scan between, check that these are respected in setting lower and upper variables</span></div>
<div class="line"><span class="lineno">  581</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">lower &lt; cov-&gt;</a>GetLowerBound(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>)) {</div>
<div class="line"><span class="lineno">  582</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">lower</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetLowerBound(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno">  583</span>      }</div>
<div class="line"><span class="lineno">  584</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">upper</a> &gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetUpperBound(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>)) {</div>
<div class="line"><span class="lineno">  585</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">upper</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetUpperBound(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno">  586</span>      }</div>
<div class="line"><span class="lineno">  587</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Scanning {} with {} steps, from {:.2f} - {:.2f}, prior = {:.2f}&quot;</span>, name, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_points</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">lower</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">upper</a>, prior);</div>
<div class="line"><span class="lineno">  588</span> </div>
<div class="line"><span class="lineno">  589</span>      <span class="comment">// Make the TH1D</span></div>
<div class="line"><span class="lineno">  590</span>      <span class="keyword">auto</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScan</a> = std::make_unique&lt;TH1D&gt;((name + <span class="stringliteral">&quot;_full&quot;</span>).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>(), (name + <span class="stringliteral">&quot;_full&quot;</span>).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_points</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">lower</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">upper</a>);</div>
<div class="line"><span class="lineno">  591</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScan</a>-&gt;SetTitle((std::string(<span class="stringliteral">&quot;2LLH_full, &quot;</span>) + name + <span class="stringliteral">&quot;;&quot;</span> + name + <span class="stringliteral">&quot;; -2(ln L_{sample} + ln L_{xsec+flux} + ln L_{det})&quot;</span>).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>());</div>
<div class="line"><span class="lineno">  592</span> </div>
<div class="line"><span class="lineno">  593</span>      <span class="keyword">auto</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSam</a> = std::make_unique&lt;TH1D&gt;((name + <span class="stringliteral">&quot;_sam&quot;</span>).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>(), (name + <span class="stringliteral">&quot;_sam&quot;</span>).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_points</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">lower</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">upper</a>);</div>
<div class="line"><span class="lineno">  594</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSam</a>-&gt;SetTitle((std::string(<span class="stringliteral">&quot;2LLH_sam, &quot;</span>) + name + <span class="stringliteral">&quot;;&quot;</span> + name + <span class="stringliteral">&quot;; -2(ln L_{sample})&quot;</span>).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>());</div>
<div class="line"><span class="lineno">  595</span> </div>
<div class="line"><span class="lineno">  596</span>      std::vector&lt;TH1D*&gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSample</a>(<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size());</div>
<div class="line"><span class="lineno">  597</span>      std::vector&lt;double&gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSamLLH</a>(<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size());</div>
<div class="line"><span class="lineno">  598</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>++ )</div>
<div class="line"><span class="lineno">  599</span>      {</div>
<div class="line"><span class="lineno">  600</span>        std::string <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NameTemp</a> = <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;GetName();</div>
<div class="line"><span class="lineno">  601</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSample</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>] = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a>((name+<span class="stringliteral">&quot;_&quot;</span>+<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NameTemp</a>).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>(), (name+<span class="stringliteral">&quot;_&quot;</span> + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NameTemp</a>).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_points</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">lower</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">upper</a>);</div>
<div class="line"><span class="lineno">  602</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSample</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;SetTitle((<span class="stringliteral">&quot;2LLH_&quot;</span> + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NameTemp</a> + <span class="stringliteral">&quot;, &quot;</span> + name + <span class="stringliteral">&quot;;&quot;</span> + name + <span class="stringliteral">&quot;; -2(ln L_{&quot;</span> + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NameTemp</a> +<span class="stringliteral">&quot;})&quot;</span>).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>());</div>
<div class="line"><span class="lineno">  603</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSamLLH</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>] = 0.;</div>
<div class="line"><span class="lineno">  604</span>      }</div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>      std::vector&lt;TH1D*&gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanCov</a>(<a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size());</div>
<div class="line"><span class="lineno">  607</span>      std::vector&lt;double&gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nCovLLH</a>(<a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size());</div>
<div class="line"><span class="lineno">  608</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a> &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a>++ )</div>
<div class="line"><span class="lineno">  609</span>      {</div>
<div class="line"><span class="lineno">  610</span>        std::string <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NameTemp</a> = <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a>]-&gt;getName();</div>
<div class="line"><span class="lineno">  611</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NameTemp</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NameTemp</a>.substr(0, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NameTemp</a>.find(<span class="stringliteral">&quot;_cov&quot;</span>));</div>
<div class="line"><span class="lineno">  612</span> </div>
<div class="line"><span class="lineno">  613</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanCov</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a>] = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a>((name+<span class="stringliteral">&quot;_&quot;</span>+<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NameTemp</a>).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>(), (name+<span class="stringliteral">&quot;_&quot;</span> + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NameTemp</a>).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_points</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">lower</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">upper</a>);</div>
<div class="line"><span class="lineno">  614</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanCov</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a>]-&gt;SetTitle((<span class="stringliteral">&quot;2LLH_&quot;</span> + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NameTemp</a> + <span class="stringliteral">&quot;, &quot;</span> + name + <span class="stringliteral">&quot;;&quot;</span> + name + <span class="stringliteral">&quot;; -2(ln L_{&quot;</span> + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NameTemp</a> +<span class="stringliteral">&quot;})&quot;</span>).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>());</div>
<div class="line"><span class="lineno">  615</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nCovLLH</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a>] = 0.;</div>
<div class="line"><span class="lineno">  616</span>      }</div>
<div class="line"><span class="lineno">  617</span> </div>
<div class="line"><span class="lineno">  618</span>      std::vector&lt;TH1D *&gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSamSplit</a>;</div>
<div class="line"><span class="lineno">  619</span>      std::vector&lt;double&gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sampleSplitllh</a>;</div>
<div class="line"><span class="lineno">  620</span>      <span class="keywordflow">if</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">PlotAllNDsamplesLLH</a>)</div>
<div class="line"><span class="lineno">  621</span>      {</div>
<div class="line"><span class="lineno">  622</span>        <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a> = 0;</div>
<div class="line"><span class="lineno">  623</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>++ )</div>
<div class="line"><span class="lineno">  624</span>        {</div>
<div class="line"><span class="lineno">  625</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSamSplit</a>.resize(<a class="code hl_variable" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a>);</div>
<div class="line"><span class="lineno">  626</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sampleSplitllh</a>.resize(<a class="code hl_variable" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a>);</div>
<div class="line"><span class="lineno">  627</span>          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;GetNsamples(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a>++ )</div>
<div class="line"><span class="lineno">  628</span>          {</div>
<div class="line"><span class="lineno">  629</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSamSplit</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>] = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a>((name+<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;GetSampleName(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a>)).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>(), (name+<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;GetSampleName(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a>)).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_points</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">lower</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">upper</a>);</div>
<div class="line"><span class="lineno">  630</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSamSplit</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>]-&gt;SetTitle((std::string(<span class="stringliteral">&quot;2LLH_sam, &quot;</span>) + name + <span class="stringliteral">&quot;;&quot;</span> + name + <span class="stringliteral">&quot;; -2(ln L_{sample})&quot;</span>).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>());</div>
<div class="line"><span class="lineno">  631</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>++;</div>
<div class="line"><span class="lineno">  632</span>          }</div>
<div class="line"><span class="lineno">  633</span>        }</div>
<div class="line"><span class="lineno">  634</span>      }</div>
<div class="line"><span class="lineno">  635</span> </div>
<div class="line"><span class="lineno">  636</span>      <span class="comment">// Scan over the parameter space</span></div>
<div class="line"><span class="lineno">  637</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_points</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>++)</div>
<div class="line"><span class="lineno">  638</span>      {</div>
<div class="line"><span class="lineno">  639</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> % <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">countwidth</a> == 0)</div>
<div class="line"><span class="lineno">  640</span>          <a class="code hl_function" href="namespaceMaCh3Utils.html#a4c8bdeb1d34606aed192e9f1311a72f5">MaCh3Utils::PrintProgressBar</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_points</a>);</div>
<div class="line"><span class="lineno">  641</span> </div>
<div class="line"><span class="lineno">  642</span>        <span class="comment">// For PCA we have to do it differently</span></div>
<div class="line"><span class="lineno">  643</span>        <span class="keywordflow">if</span> (IsPCA) {</div>
<div class="line"><span class="lineno">  644</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;setParProp_PCA(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScan</a>-&gt;GetBinCenter(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>+1));</div>
<div class="line"><span class="lineno">  645</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  646</span>          <span class="comment">// Set the parameter</span></div>
<div class="line"><span class="lineno">  647</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;setParProp(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScan</a>-&gt;GetBinCenter(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>+1));</div>
<div class="line"><span class="lineno">  648</span>        }</div>
<div class="line"><span class="lineno">  649</span> </div>
<div class="line"><span class="lineno">  650</span>        <span class="comment">// Reweight the MC</span></div>
<div class="line"><span class="lineno">  651</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>++ )</div>
<div class="line"><span class="lineno">  652</span>        {</div>
<div class="line"><span class="lineno">  653</span>          <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;reweight();</div>
<div class="line"><span class="lineno">  654</span>        }</div>
<div class="line"><span class="lineno">  655</span>        <span class="comment">//Total LLH</span></div>
<div class="line"><span class="lineno">  656</span>        <span class="keywordtype">double</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">totalllh</a> = 0;</div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span>        <span class="comment">// Get the -log L likelihoods</span></div>
<div class="line"><span class="lineno">  659</span>        <span class="keywordtype">double</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">samplellh</a> = 0;</div>
<div class="line"><span class="lineno">  660</span> </div>
<div class="line"><span class="lineno">  661</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>++ )</div>
<div class="line"><span class="lineno">  662</span>        {</div>
<div class="line"><span class="lineno">  663</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSamLLH</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>] = <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;GetLikelihood();</div>
<div class="line"><span class="lineno">  664</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">samplellh</a> += <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSamLLH</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>];</div>
<div class="line"><span class="lineno">  665</span>        }</div>
<div class="line"><span class="lineno">  666</span> </div>
<div class="line"><span class="lineno">  667</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a> &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a>++ )</div>
<div class="line"><span class="lineno">  668</span>        {</div>
<div class="line"><span class="lineno">  669</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nCovLLH</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a>] = <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a>]-&gt;GetLikelihood();</div>
<div class="line"><span class="lineno">  670</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">totalllh</a> += <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nCovLLH</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a>];</div>
<div class="line"><span class="lineno">  671</span>        }</div>
<div class="line"><span class="lineno">  672</span> </div>
<div class="line"><span class="lineno">  673</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">totalllh</a> += <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">samplellh</a>;</div>
<div class="line"><span class="lineno">  674</span> </div>
<div class="line"><span class="lineno">  675</span>        <span class="keywordflow">if</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">PlotAllNDsamplesLLH</a>)</div>
<div class="line"><span class="lineno">  676</span>        {</div>
<div class="line"><span class="lineno">  677</span>          <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a> = 0;</div>
<div class="line"><span class="lineno">  678</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>++ )</div>
<div class="line"><span class="lineno">  679</span>          {</div>
<div class="line"><span class="lineno">  680</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;GetNsamples(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a>++)</div>
<div class="line"><span class="lineno">  681</span>            {</div>
<div class="line"><span class="lineno">  682</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sampleSplitllh</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>] = <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;getSampleLikelihood(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a>);</div>
<div class="line"><span class="lineno">  683</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>++;</div>
<div class="line"><span class="lineno">  684</span>            }</div>
<div class="line"><span class="lineno">  685</span>          }</div>
<div class="line"><span class="lineno">  686</span>        }</div>
<div class="line"><span class="lineno">  687</span> </div>
<div class="line"><span class="lineno">  688</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>++ )</div>
<div class="line"><span class="lineno">  689</span>        {</div>
<div class="line"><span class="lineno">  690</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSample</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;SetBinContent(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>+1, 2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSamLLH</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]);</div>
<div class="line"><span class="lineno">  691</span>        }</div>
<div class="line"><span class="lineno">  692</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a> &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a>++ )</div>
<div class="line"><span class="lineno">  693</span>        {</div>
<div class="line"><span class="lineno">  694</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanCov</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a>]-&gt;SetBinContent(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>+1, 2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nCovLLH</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a>]);</div>
<div class="line"><span class="lineno">  695</span>        }</div>
<div class="line"><span class="lineno">  696</span> </div>
<div class="line"><span class="lineno">  697</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSam</a>-&gt;SetBinContent(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>+1, 2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">samplellh</a>);</div>
<div class="line"><span class="lineno">  698</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScan</a>-&gt;SetBinContent(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>+1, 2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">totalllh</a>);</div>
<div class="line"><span class="lineno">  699</span> </div>
<div class="line"><span class="lineno">  700</span>        <span class="keywordflow">if</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">PlotAllNDsamplesLLH</a>)</div>
<div class="line"><span class="lineno">  701</span>        {</div>
<div class="line"><span class="lineno">  702</span>          <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a> = 0;</div>
<div class="line"><span class="lineno">  703</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>++ )</div>
<div class="line"><span class="lineno">  704</span>          {</div>
<div class="line"><span class="lineno">  705</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;GetNsamples(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a>++)</div>
<div class="line"><span class="lineno">  706</span>            {</div>
<div class="line"><span class="lineno">  707</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSamSplit</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a>]-&gt;SetBinContent(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>+1, 2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sampleSplitllh</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a>]);</div>
<div class="line"><span class="lineno">  708</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>++;</div>
<div class="line"><span class="lineno">  709</span>            }</div>
<div class="line"><span class="lineno">  710</span>          }</div>
<div class="line"><span class="lineno">  711</span>        }</div>
<div class="line"><span class="lineno">  712</span>      }</div>
<div class="line"><span class="lineno">  713</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a> &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a>++ )</div>
<div class="line"><span class="lineno">  714</span>      {</div>
<div class="line"><span class="lineno">  715</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Cov_LLH</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a>]-&gt;cd();</div>
<div class="line"><span class="lineno">  716</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanCov</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a>]-&gt;Write();</div>
<div class="line"><span class="lineno">  717</span>        <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanCov</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a>];</div>
<div class="line"><span class="lineno">  718</span>      }</div>
<div class="line"><span class="lineno">  719</span> </div>
<div class="line"><span class="lineno">  720</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>++ )</div>
<div class="line"><span class="lineno">  721</span>      {</div>
<div class="line"><span class="lineno">  722</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleClass_LLH</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;cd();</div>
<div class="line"><span class="lineno">  723</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSample</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;Write();</div>
<div class="line"><span class="lineno">  724</span>        <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSample</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>];</div>
<div class="line"><span class="lineno">  725</span>      }</div>
<div class="line"><span class="lineno">  726</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Sample_LLH</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  727</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSam</a>-&gt;Write();</div>
<div class="line"><span class="lineno">  728</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Total_LLH</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  729</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScan</a>-&gt;Write();</div>
<div class="line"><span class="lineno">  730</span> </div>
<div class="line"><span class="lineno">  731</span>      <span class="keywordflow">if</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">PlotAllNDsamplesLLH</a>)</div>
<div class="line"><span class="lineno">  732</span>      {</div>
<div class="line"><span class="lineno">  733</span>        <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a> = 0;</div>
<div class="line"><span class="lineno">  734</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>++ )</div>
<div class="line"><span class="lineno">  735</span>        {</div>
<div class="line"><span class="lineno">  736</span>          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;GetNsamples(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a>++)</div>
<div class="line"><span class="lineno">  737</span>          {</div>
<div class="line"><span class="lineno">  738</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleSplit_LLH</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>]-&gt;cd();</div>
<div class="line"><span class="lineno">  739</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSamSplit</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>]-&gt;Write();</div>
<div class="line"><span class="lineno">  740</span>            <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">hScanSamSplit</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>];</div>
<div class="line"><span class="lineno">  741</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>++;</div>
<div class="line"><span class="lineno">  742</span>          }</div>
<div class="line"><span class="lineno">  743</span>        }</div>
<div class="line"><span class="lineno">  744</span>      }</div>
<div class="line"><span class="lineno">  745</span> </div>
<div class="line"><span class="lineno">  746</span>      <span class="comment">// Reset the parameters to their prior central values</span></div>
<div class="line"><span class="lineno">  747</span>      <span class="keywordflow">if</span> (IsPCA) {</div>
<div class="line"><span class="lineno">  748</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;setParProp_PCA(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, prior);</div>
<div class="line"><span class="lineno">  749</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  750</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;setParProp(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, prior);</div>
<div class="line"><span class="lineno">  751</span>      }</div>
<div class="line"><span class="lineno">  752</span>    }<span class="comment">//end loop over systematics</span></div>
<div class="line"><span class="lineno">  753</span>  }<span class="comment">//end loop covariance classes</span></div>
<div class="line"><span class="lineno">  754</span> </div>
<div class="line"><span class="lineno">  755</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a> &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a>++ )</div>
<div class="line"><span class="lineno">  756</span>  {</div>
<div class="line"><span class="lineno">  757</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Cov_LLH</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a>]-&gt;Write();</div>
<div class="line"><span class="lineno">  758</span>    <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Cov_LLH</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivc</a>];</div>
<div class="line"><span class="lineno">  759</span>  }</div>
<div class="line"><span class="lineno">  760</span> </div>
<div class="line"><span class="lineno">  761</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>++ )</div>
<div class="line"><span class="lineno">  762</span>  {</div>
<div class="line"><span class="lineno">  763</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleClass_LLH</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;Write();</div>
<div class="line"><span class="lineno">  764</span>    <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleClass_LLH</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>];</div>
<div class="line"><span class="lineno">  765</span>  }</div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Sample_LLH</a>-&gt;Write();</div>
<div class="line"><span class="lineno">  768</span>  <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Sample_LLH</a>;</div>
<div class="line"><span class="lineno">  769</span> </div>
<div class="line"><span class="lineno">  770</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Total_LLH</a>-&gt;Write();</div>
<div class="line"><span class="lineno">  771</span>  <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Total_LLH</a>;</div>
<div class="line"><span class="lineno">  772</span> </div>
<div class="line"><span class="lineno">  773</span>  <span class="keywordflow">if</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">PlotAllNDsamplesLLH</a>)</div>
<div class="line"><span class="lineno">  774</span>  {</div>
<div class="line"><span class="lineno">  775</span>    <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a> = 0;</div>
<div class="line"><span class="lineno">  776</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>++ )</div>
<div class="line"><span class="lineno">  777</span>    {</div>
<div class="line"><span class="lineno">  778</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;GetNsamples(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a>++ )</div>
<div class="line"><span class="lineno">  779</span>      {</div>
<div class="line"><span class="lineno">  780</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleSplit_LLH</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>]-&gt;Write();</div>
<div class="line"><span class="lineno">  781</span>        <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleSplit_LLH</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>];</div>
<div class="line"><span class="lineno">  782</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>++;</div>
<div class="line"><span class="lineno">  783</span>      }</div>
<div class="line"><span class="lineno">  784</span>    }</div>
<div class="line"><span class="lineno">  785</span>  }</div>
<div class="line"><span class="lineno">  786</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1a9666dc09f91af804954e8968bc7b24" name="a1a9666dc09f91af804954e8968bc7b24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a9666dc09f91af804954e8968bc7b24">&#9670;&#160;</a></span>runMCMC()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">virtual</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> FitterBase::runMCMC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The specific fitting algorithm implemented in this function depends on the derived class. It could be Markov Chain Monte Carlo (MCMC), <a class="el" href="classMinuitFit.html" title="Implementation of Minuit fitting algorithm .">MinuitFit</a>, or another algorithm. </p>

<p>Implemented in <a class="el" href="classmcmc.html#a8a9cc0e0aa65c8573fca703a42b2ee31">mcmc</a>, <a class="el" href="classMinuitFit.html#a8e746fb17d4bc75a9d308398a4a0229e">MinuitFit</a>, <a class="el" href="classPSO.html#afcd534dbf737430c8ab1e921e8730b81">PSO</a>, and <a class="el" href="classLikelihoodFit.html#a97f28cf4797fd2f6e3fac267dcdafb27">LikelihoodFit</a>.</p>

</div>
</div>
<a id="a71e43b96395568e54879d9bd1b57c0f8" name="a71e43b96395568e54879d9bd1b57c0f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71e43b96395568e54879d9bd1b57c0f8">&#9670;&#160;</a></span>RunSigmaVar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> FitterBase::RunSigmaVar </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform a 2D and 1D sigma var for all samples. </p>
<dl class="section warning"><dt>Warning</dt><dd>Code uses TH2Poly </dd></dl>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l01032">1032</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1032</span>                             {</div>
<div class="line"><span class="lineno"> 1033</span><span class="comment">// *************************</span></div>
<div class="line"><span class="lineno"> 1034</span>  <span class="comment">// Save the settings into the output file</span></div>
<div class="line"><span class="lineno"> 1035</span>  <a class="code hl_function" href="classFitterBase.html#a48f38bfa8996fe00d51f35b05dd16b46">SaveSettings</a>();</div>
<div class="line"><span class="lineno"> 1036</span> </div>
<div class="line"><span class="lineno"> 1037</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Starting Sigma Variation&quot;</span>);</div>
<div class="line"><span class="lineno"> 1038</span> </div>
<div class="line"><span class="lineno"> 1039</span>  <span class="comment">// Number of variations we want</span></div>
<div class="line"><span class="lineno"> 1040</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">numVar</a> = 5;</div>
<div class="line"><span class="lineno"> 1041</span>  <span class="comment">//-3 -1 0 +1 +3 sigma variation</span></div>
<div class="line"><span class="lineno"> 1042</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">numVar</a>] = {-3, -1, 0, 1, 3};</div>
<div class="line"><span class="lineno"> 1043</span> </div>
<div class="line"><span class="lineno"> 1044</span>  <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 1045</span> </div>
<div class="line"><span class="lineno"> 1046</span>  <span class="comment">//KS: this is only relevant if PlotByMode is turned on</span></div>
<div class="line"><span class="lineno"> 1047</span>  <span class="comment">//Checking each mode is time consuming so we only consider one which are relevant for particular analysis</span></div>
<div class="line"><span class="lineno"> 1048</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nRelevantModes</a> = 2;</div>
<div class="line"><span class="lineno"> 1049</span>  <a class="code hl_typedef" href="MaCh3Modes_8h.html#adf43f6c73c9598abc381855d31ef5682">MaCh3Modes_t</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">RelevantModes</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nRelevantModes</a>] = {<a class="code hl_variable" href="classFitterBase.html#a004cb6e6168032d9280ce3db912f1a43">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#a21af1738d7b145f08d76aa0c163e0486">GetMode</a>(<span class="stringliteral">&quot;CCQE&quot;</span>), <a class="code hl_variable" href="classFitterBase.html#a004cb6e6168032d9280ce3db912f1a43">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#a21af1738d7b145f08d76aa0c163e0486">GetMode</a>(<span class="stringliteral">&quot;2p2h&quot;</span>)};</div>
<div class="line"><span class="lineno"> 1050</span>  <span class="keywordtype">bool</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">DoByMode</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">GetFromManager&lt;int&gt;</a>(<a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;DoByMode&quot;</span>], <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1051</span> </div>
<div class="line"><span class="lineno"> 1052</span>  <span class="comment">//KS: If true it will make additional plots with LLH sample contribution in each bin, should make it via config file...</span></div>
<div class="line"><span class="lineno"> 1053</span>  <span class="keywordtype">bool</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">PlotLLHperBin</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1054</span> </div>
<div class="line"><span class="lineno"> 1055</span>  std::vector&lt;std::string&gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SkipVector</a>;</div>
<div class="line"><span class="lineno"> 1056</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;LLHScanSkipVector&quot;</span>])</div>
<div class="line"><span class="lineno"> 1057</span>  {</div>
<div class="line"><span class="lineno"> 1058</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SkipVector</a> = <a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;LLHScanSkipVector&quot;</span>].as&lt;std::vector&lt;std::string&gt;&gt;();</div>
<div class="line"><span class="lineno"> 1059</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Found skip vector with {} entries&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SkipVector</a>.size());</div>
<div class="line"><span class="lineno"> 1060</span>  }</div>
<div class="line"><span class="lineno"> 1061</span> </div>
<div class="line"><span class="lineno"> 1062</span>  <span class="keywordtype">bool</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">isxsec</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1063</span>  <span class="keywordflow">for</span> (<a class="code hl_class" href="classcovarianceBase.html">covarianceBase</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a> : <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>)</div>
<div class="line"><span class="lineno"> 1064</span>  {</div>
<div class="line"><span class="lineno"> 1065</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TMatrixDSym</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Cov</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getCovMatrix();</div>
<div class="line"><span class="lineno"> 1066</span> </div>
<div class="line"><span class="lineno"> 1067</span>    <span class="keywordflow">if</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;IsPCA())</div>
<div class="line"><span class="lineno"> 1068</span>    {</div>
<div class="line"><span class="lineno"> 1069</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Using PCAed matrix not implemented within sigma var code, I am sorry :(&quot;</span>);</div>
<div class="line"><span class="lineno"> 1070</span>      <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__FILE__</a> , <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__LINE__</a> );</div>
<div class="line"><span class="lineno"> 1071</span>    }</div>
<div class="line"><span class="lineno"> 1072</span> </div>
<div class="line"><span class="lineno"> 1073</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getName() == <span class="stringliteral">&quot;xsec_cov&quot;</span>)</div>
<div class="line"><span class="lineno"> 1074</span>    {</div>
<div class="line"><span class="lineno"> 1075</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">isxsec</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1076</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1077</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">isxsec</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1078</span>    }</div>
<div class="line"><span class="lineno"> 1079</span> </div>
<div class="line"><span class="lineno"> 1080</span>    <span class="comment">// Loop over xsec parameters</span></div>
<div class="line"><span class="lineno"> 1081</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetNumParams(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>)</div>
<div class="line"><span class="lineno"> 1082</span>    {</div>
<div class="line"><span class="lineno"> 1083</span>      <span class="comment">// Get the parameter name</span></div>
<div class="line"><span class="lineno"> 1084</span>      std::string name = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetParName(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno"> 1085</span>      <span class="comment">// For xsec we can get the actual name, hurray for being informative</span></div>
<div class="line"><span class="lineno"> 1086</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">isxsec</a>) name = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetParFancyName(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno"> 1087</span>      <span class="keywordtype">bool</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">skip</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1088</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SkipVector</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a>++)</div>
<div class="line"><span class="lineno"> 1089</span>      {</div>
<div class="line"><span class="lineno"> 1090</span>        <span class="keywordflow">if</span>(name.substr(0, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SkipVector</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a>].length()) == <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SkipVector</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">is</a>])</div>
<div class="line"><span class="lineno"> 1091</span>        {</div>
<div class="line"><span class="lineno"> 1092</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">skip</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1093</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1094</span>        }</div>
<div class="line"><span class="lineno"> 1095</span>      }</div>
<div class="line"><span class="lineno"> 1096</span>      <span class="keywordflow">if</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">skip</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1097</span> </div>
<div class="line"><span class="lineno"> 1098</span>      <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 1099</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TDirectory</a> * <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dirArryDial</a> = <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;mkdir(name.c_str());</div>
<div class="line"><span class="lineno"> 1100</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TDirectory</a> **<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dirArrySample</a> = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TDirectory</a>*[<a class="code hl_variable" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a>];</div>
<div class="line"><span class="lineno"> 1101</span> </div>
<div class="line"><span class="lineno"> 1102</span>      <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a> = 0;</div>
<div class="line"><span class="lineno"> 1103</span>      <span class="comment">// Get each sample and how it&#39;s responded to our reweighted parameter</span></div>
<div class="line"><span class="lineno"> 1104</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>++ )</div>
<div class="line"><span class="lineno"> 1105</span>      {</div>
<div class="line"><span class="lineno"> 1106</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;GetNsamples(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>++ )</div>
<div class="line"><span class="lineno"> 1107</span>        {</div>
<div class="line"><span class="lineno"> 1108</span>          std::string <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">title</a> = std::string(<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;getPDF(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>)-&gt;<a class="code hl_function" href="classFitterBase.html#a3706f6d722073b447b3de8c3a6516601">GetName</a>());</div>
<div class="line"><span class="lineno"> 1109</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dirArryDial</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 1110</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dirArrySample</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dirArryDial</a>-&gt;mkdir(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">title</a>.c_str());</div>
<div class="line"><span class="lineno"> 1111</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>++;</div>
<div class="line"><span class="lineno"> 1112</span>        }</div>
<div class="line"><span class="lineno"> 1113</span>      }</div>
<div class="line"><span class="lineno"> 1114</span> </div>
<div class="line"><span class="lineno"> 1115</span>      <span class="comment">// Get the initial value of ith parameter</span></div>
<div class="line"><span class="lineno"> 1116</span>      <span class="keywordtype">double</span> init = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getParInit(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno"> 1117</span> </div>
<div class="line"><span class="lineno"> 1118</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a> ***<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_x</a> = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a>**[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">numVar</a>]();</div>
<div class="line"><span class="lineno"> 1119</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a> ***<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_y</a> = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a>**[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">numVar</a>]();</div>
<div class="line"><span class="lineno"> 1120</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a> ***<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_x_norm</a> = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a>**[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">numVar</a>]();</div>
<div class="line"><span class="lineno"> 1121</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a> ***<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_y_norm</a> = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a>**[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">numVar</a>]();</div>
<div class="line"><span class="lineno"> 1122</span> </div>
<div class="line"><span class="lineno"> 1123</span>      <span class="comment">// Set up for single mode</span></div>
<div class="line"><span class="lineno"> 1124</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a> ****<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_mode_x</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 1125</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a> ****<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_mode_y</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 1126</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">DoByMode</a>)</div>
<div class="line"><span class="lineno"> 1127</span>      {</div>
<div class="line"><span class="lineno"> 1128</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_mode_x</a> = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a>***[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">numVar</a>]();</div>
<div class="line"><span class="lineno"> 1129</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_mode_y</a> = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a>***[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">numVar</a>]();</div>
<div class="line"><span class="lineno"> 1130</span>      }</div>
<div class="line"><span class="lineno"> 1131</span> </div>
<div class="line"><span class="lineno"> 1132</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{:&lt;20}{}&quot;</span>, name, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 1133</span> </div>
<div class="line"><span class="lineno"> 1134</span>      <span class="comment">// Make asymmetric errors just in case</span></div>
<div class="line"><span class="lineno"> 1135</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">numVar</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>)</div>
<div class="line"><span class="lineno"> 1136</span>      {</div>
<div class="line"><span class="lineno"> 1137</span>        <span class="comment">// New value = prior + variation*1sigma uncertainty</span></div>
<div class="line"><span class="lineno"> 1138</span>        <span class="keywordtype">double</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramVal</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;getParInit(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>)+<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>]*std::sqrt((*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Cov</a>)(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>,<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>));</div>
<div class="line"><span class="lineno"> 1139</span> </div>
<div class="line"><span class="lineno"> 1140</span>        <span class="comment">// Check the bounds on the parameter</span></div>
<div class="line"><span class="lineno"> 1141</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramVal</a> &gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetUpperBound(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>)) {</div>
<div class="line"><span class="lineno"> 1142</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramVal</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetUpperBound(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno"> 1143</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramVal &lt; cov-&gt;</a>GetLowerBound(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>)) {</div>
<div class="line"><span class="lineno"> 1144</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramVal</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;GetLowerBound(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno"> 1145</span>        }</div>
<div class="line"><span class="lineno"> 1146</span> </div>
<div class="line"><span class="lineno"> 1147</span>        <span class="comment">// Set the parameter</span></div>
<div class="line"><span class="lineno"> 1148</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;setParProp(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramVal</a>);</div>
<div class="line"><span class="lineno"> 1149</span>        <span class="comment">// And reweight the sample</span></div>
<div class="line"><span class="lineno"> 1150</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>++) {</div>
<div class="line"><span class="lineno"> 1151</span>          <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;reweight();</div>
<div class="line"><span class="lineno"> 1152</span>        }</div>
<div class="line"><span class="lineno"> 1153</span> </div>
<div class="line"><span class="lineno"> 1154</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_x</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a>*[<a class="code hl_variable" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a>]();</div>
<div class="line"><span class="lineno"> 1155</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_y</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a>*[<a class="code hl_variable" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a>]();</div>
<div class="line"><span class="lineno"> 1156</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_x_norm</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a>*[<a class="code hl_variable" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a>]();</div>
<div class="line"><span class="lineno"> 1157</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_y_norm</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a>*[<a class="code hl_variable" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a>]();</div>
<div class="line"><span class="lineno"> 1158</span> </div>
<div class="line"><span class="lineno"> 1159</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">DoByMode</a>)</div>
<div class="line"><span class="lineno"> 1160</span>        {</div>
<div class="line"><span class="lineno"> 1161</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_mode_x</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a>**[<a class="code hl_variable" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a>]();</div>
<div class="line"><span class="lineno"> 1162</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_mode_y</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a>**[<a class="code hl_variable" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a>]();</div>
<div class="line"><span class="lineno"> 1163</span>        }</div>
<div class="line"><span class="lineno"> 1164</span> </div>
<div class="line"><span class="lineno"> 1165</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a> = 0;</div>
<div class="line"><span class="lineno"> 1166</span>        <span class="comment">// Get each sample and how it&#39;s responded to our reweighted parameter</span></div>
<div class="line"><span class="lineno"> 1167</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>++ )</div>
<div class="line"><span class="lineno"> 1168</span>        {</div>
<div class="line"><span class="lineno"> 1169</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;GetNsamples(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>)</div>
<div class="line"><span class="lineno"> 1170</span>          {</div>
<div class="line"><span class="lineno"> 1171</span>            <span class="comment">// Make a string of the double</span></div>
<div class="line"><span class="lineno"> 1172</span>            std::ostringstream <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ss</a>;</div>
<div class="line"><span class="lineno"> 1173</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ss</a> &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramVal</a>;</div>
<div class="line"><span class="lineno"> 1174</span>            std::string <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">parVarTitle</a> = name + <span class="stringliteral">&quot;_&quot;</span> + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ss</a>.str();</div>
<div class="line"><span class="lineno"> 1175</span> </div>
<div class="line"><span class="lineno"> 1176</span>            <span class="comment">// This is a TH2D</span></div>
<div class="line"><span class="lineno"> 1177</span> </div>
<div class="line"><span class="lineno"> 1178</span>            std::unique_ptr&lt;TH2Poly&gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">currSamp</a>(<span class="keyword">static_cast&lt;</span><a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH2Poly</a>*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;getPDF(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>)-&gt;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Clone</a>()));</div>
<div class="line"><span class="lineno"> 1179</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">currSamp</a>-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1180</span>            <span class="comment">// Set a descriptiv-ish title</span></div>
<div class="line"><span class="lineno"> 1181</span>            std::string <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">title_long</a> = std::string(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">currSamp</a>-&gt;GetName())+<span class="stringliteral">&quot;_&quot;</span>+<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">parVarTitle</a>;</div>
<div class="line"><span class="lineno"> 1182</span> </div>
<div class="line"><span class="lineno"> 1183</span>            <span class="comment">// Enable the mode histograms AFTER addSelection is called</span></div>
<div class="line"><span class="lineno"> 1184</span>            <span class="comment">//Get the 1d binning we want. Let&#39;s just use SetupBinning to get this as it already exists</span></div>
<div class="line"><span class="lineno"> 1185</span>            std::vector&lt;double&gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xbins</a>;</div>
<div class="line"><span class="lineno"> 1186</span>            std::vector&lt;double&gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ybins</a>;</div>
<div class="line"><span class="lineno"> 1187</span>            <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;SetupBinning(<a class="code hl_typedef" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xbins</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ybins</a>);</div>
<div class="line"><span class="lineno"> 1188</span> </div>
<div class="line"><span class="lineno"> 1189</span>            <span class="comment">//KS:here we loop over all reaction modes defined in &quot;RelevantModes[nRelevantModes]&quot;</span></div>
<div class="line"><span class="lineno"> 1190</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">DoByMode</a>)</div>
<div class="line"><span class="lineno"> 1191</span>            {</div>
<div class="line"><span class="lineno"> 1192</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_mode_x</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>] = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a>*[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nRelevantModes</a>]();</div>
<div class="line"><span class="lineno"> 1193</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_mode_y</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>] = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a>*[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nRelevantModes</a>]();</div>
<div class="line"><span class="lineno"> 1194</span>              <span class="comment">// Now get the TH2D mode variations</span></div>
<div class="line"><span class="lineno"> 1195</span>              std::string <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">mode_title_long</a>;</div>
<div class="line"><span class="lineno"> 1196</span>              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ir</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ir</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nRelevantModes</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ir</a>++)</div>
<div class="line"><span class="lineno"> 1197</span>              {</div>
<div class="line"><span class="lineno"> 1198</span>                std::unique_ptr&lt;TH2Poly&gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">currSampMode</a>(<span class="keyword">static_cast&lt;</span><a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH2Poly</a>*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;getPDFMode(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">RelevantModes</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ir</a>])-&gt;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Clone</a>()));</div>
<div class="line"><span class="lineno"> 1199</span>                <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">currSampMode</a>-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1200</span> </div>
<div class="line"><span class="lineno"> 1201</span>                <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">mode_title_long</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">title_long</a> + <span class="stringliteral">&quot;_&quot;</span> + <a class="code hl_variable" href="classFitterBase.html#a004cb6e6168032d9280ce3db912f1a43">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#abf4ac35511787907bc16ae26aa6c2a15">GetMaCh3ModeName</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">RelevantModes</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ir</a>]);</div>
<div class="line"><span class="lineno"> 1202</span>                <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">currSampMode</a>-&gt;SetNameTitle(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">mode_title_long</a>.c_str(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">mode_title_long</a>.c_str());</div>
<div class="line"><span class="lineno"> 1203</span>                <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dirArrySample</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>]-&gt;cd();</div>
<div class="line"><span class="lineno"> 1204</span>                <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">currSampMode</a>-&gt;Write();</div>
<div class="line"><span class="lineno"> 1205</span> </div>
<div class="line"><span class="lineno"> 1206</span>                <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_mode_x</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ir</a>] = <a class="code hl_function" href="Structs_8cpp.html#a1ab7c868447cffff71227e07655b47ad">PolyProjectionX</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">currSampMode</a>.get(), (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">mode_title_long</a>+<span class="stringliteral">&quot;_xProj&quot;</span>).c_str(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xbins</a>);</div>
<div class="line"><span class="lineno"> 1207</span>                <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_mode_x</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ir</a>]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1208</span>                <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_mode_y</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ir</a>] = <a class="code hl_function" href="Structs_8cpp.html#aa26af438a657c81f2fb3f1506c6e35f6">PolyProjectionY</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">currSampMode</a>.get(), (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">mode_title_long</a>+<span class="stringliteral">&quot;_yProj&quot;</span>).c_str(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ybins</a>);</div>
<div class="line"><span class="lineno"> 1209</span>                <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_mode_y</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ir</a>]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1210</span>              }</div>
<div class="line"><span class="lineno"> 1211</span>            }</div>
<div class="line"><span class="lineno"> 1212</span> </div>
<div class="line"><span class="lineno"> 1213</span>            <span class="comment">//KS: This will give different results depending if data or Asimov, both have their uses</span></div>
<div class="line"><span class="lineno"> 1214</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">PlotLLHperBin</a>)</div>
<div class="line"><span class="lineno"> 1215</span>            {</div>
<div class="line"><span class="lineno"> 1216</span>              std::unique_ptr&lt;TH2Poly&gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">currLLHSamp</a>(<span class="keyword">static_cast&lt;</span><a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH2Poly</a>*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;getPDF(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>)-&gt;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Clone</a>()));</div>
<div class="line"><span class="lineno"> 1217</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">currLLHSamp</a>-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1218</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">currLLHSamp</a>-&gt;Reset(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 1219</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">currLLHSamp</a>-&gt;Fill(0.0, 0.0, 0.0);</div>
<div class="line"><span class="lineno"> 1220</span> </div>
<div class="line"><span class="lineno"> 1221</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH2Poly</a>* <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MCpdf</a> = <span class="keyword">static_cast&lt;</span><a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH2Poly</a>*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;getPDF(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>));</div>
<div class="line"><span class="lineno"> 1222</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH2Poly</a>* <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Datapdf</a> = <span class="keyword">static_cast&lt;</span><a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH2Poly</a>*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;getData(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>));</div>
<div class="line"><span class="lineno"> 1223</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH2Poly</a>* <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">W2pdf</a> = <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;getW2(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>);</div>
<div class="line"><span class="lineno"> 1224</span> </div>
<div class="line"><span class="lineno"> 1225</span>              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">bin</a> = 1; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">bin</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">currLLHSamp</a>-&gt;GetNumberOfBins()+1; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">bin</a>++)</div>
<div class="line"><span class="lineno"> 1226</span>              {</div>
<div class="line"><span class="lineno"> 1227</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">mc</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MCpdf</a>-&gt;GetBinContent(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">bin</a>);</div>
<div class="line"><span class="lineno"> 1228</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dat</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Datapdf</a>-&gt;GetBinContent(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">bin</a>);</div>
<div class="line"><span class="lineno"> 1229</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">w2</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">W2pdf</a>-&gt;GetBinContent(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">bin</a>);</div>
<div class="line"><span class="lineno"> 1230</span>                <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">currLLHSamp</a>-&gt;SetBinContent(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">bin</a>, <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;getTestStatLLH(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dat</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">mc</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">w2</a>));</div>
<div class="line"><span class="lineno"> 1231</span>              }</div>
<div class="line"><span class="lineno"> 1232</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">currLLHSamp</a>-&gt;SetNameTitle((<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">title_long</a>+<span class="stringliteral">&quot;_LLH&quot;</span>).c_str() ,(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">title_long</a>+<span class="stringliteral">&quot;_LLH&quot;</span>).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>());</div>
<div class="line"><span class="lineno"> 1233</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dirArrySample</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>]-&gt;cd();</div>
<div class="line"><span class="lineno"> 1234</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">currLLHSamp</a>-&gt;Write();</div>
<div class="line"><span class="lineno"> 1235</span>            }</div>
<div class="line"><span class="lineno"> 1236</span> </div>
<div class="line"><span class="lineno"> 1237</span>            <span class="comment">// Project down onto x axis</span></div>
<div class="line"><span class="lineno"> 1238</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_x</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>] = <a class="code hl_function" href="Structs_8cpp.html#a1ab7c868447cffff71227e07655b47ad">PolyProjectionX</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">currSamp</a>.get(), (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">title_long</a>+<span class="stringliteral">&quot;_xProj&quot;</span>).c_str(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xbins</a>);</div>
<div class="line"><span class="lineno"> 1239</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_x</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1240</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_x</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>]-&gt;GetXaxis()-&gt;SetTitle(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">currSamp</a>-&gt;GetXaxis()-&gt;GetTitle());</div>
<div class="line"><span class="lineno"> 1241</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_y</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>] = <a class="code hl_function" href="Structs_8cpp.html#aa26af438a657c81f2fb3f1506c6e35f6">PolyProjectionY</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">currSamp</a>.get(), (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">title_long</a>+<span class="stringliteral">&quot;_yProj&quot;</span>).c_str(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ybins</a>);</div>
<div class="line"><span class="lineno"> 1242</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_y</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1243</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_y</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>]-&gt;GetXaxis()-&gt;SetTitle(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">currSamp</a>-&gt;GetYaxis()-&gt;GetTitle());</div>
<div class="line"><span class="lineno"> 1244</span> </div>
<div class="line"><span class="lineno"> 1245</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_x_norm</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>] = <span class="keyword">static_cast&lt;</span><a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a>*<span class="keyword">&gt;</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_x</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>]-&gt;Clone());</div>
<div class="line"><span class="lineno"> 1246</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_x_norm</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1247</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_x_norm</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>]-&gt;Scale(1., <span class="stringliteral">&quot;width&quot;</span>);</div>
<div class="line"><span class="lineno"> 1248</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_y_norm</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>] = <span class="keyword">static_cast&lt;</span><a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TH1D</a>*<span class="keyword">&gt;</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_y</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>]-&gt;Clone());</div>
<div class="line"><span class="lineno"> 1249</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_y_norm</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1250</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_y_norm</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>]-&gt;Scale(1., <span class="stringliteral">&quot;width&quot;</span>);</div>
<div class="line"><span class="lineno"> 1251</span> </div>
<div class="line"><span class="lineno"> 1252</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">currSamp</a>-&gt;SetNameTitle(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">title_long</a>.c_str(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">title_long</a>.c_str());</div>
<div class="line"><span class="lineno"> 1253</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dirArrySample</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>]-&gt;cd();</div>
<div class="line"><span class="lineno"> 1254</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">currSamp</a>-&gt;Write();</div>
<div class="line"><span class="lineno"> 1255</span> </div>
<div class="line"><span class="lineno"> 1256</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_x</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>]-&gt;Write();</div>
<div class="line"><span class="lineno"> 1257</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_y</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>]-&gt;Write();</div>
<div class="line"><span class="lineno"> 1258</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>++;</div>
<div class="line"><span class="lineno"> 1259</span>          }<span class="comment">//End loop over samples</span></div>
<div class="line"><span class="lineno"> 1260</span>        }</div>
<div class="line"><span class="lineno"> 1261</span>      } <span class="comment">// End looping over variation</span></div>
<div class="line"><span class="lineno"> 1262</span> </div>
<div class="line"><span class="lineno"> 1263</span>      <span class="comment">// Restore the parameter to prior value</span></div>
<div class="line"><span class="lineno"> 1264</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cov</a>-&gt;setParProp(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, init);</div>
<div class="line"><span class="lineno"> 1265</span> </div>
<div class="line"><span class="lineno"> 1266</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a> = 0;</div>
<div class="line"><span class="lineno"> 1267</span>      <span class="comment">// Get each sample and how it&#39;s responded to our reweighted parameter</span></div>
<div class="line"><span class="lineno"> 1268</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>++ )</div>
<div class="line"><span class="lineno"> 1269</span>      {</div>
<div class="line"><span class="lineno"> 1270</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;GetNsamples(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>)</div>
<div class="line"><span class="lineno"> 1271</span>        {</div>
<div class="line"><span class="lineno"> 1272</span>          std::string <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">title</a> = std::string(<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;getPDF(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>)-&gt;<a class="code hl_function" href="classFitterBase.html#a3706f6d722073b447b3de8c3a6516601">GetName</a>()) + <span class="stringliteral">&quot;_&quot;</span> + name;</div>
<div class="line"><span class="lineno"> 1273</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TGraphAsymmErrors</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">var_x</a> = <a class="code hl_function" href="Structs_8cpp.html#a3b61160c5ff362348884cb311e827221">MakeAsymGraph</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_x</a>[1][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>], <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_x</a>[2][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>], <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_x</a>[3][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>], (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">title</a>+<span class="stringliteral">&quot;_X&quot;</span>).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>());</div>
<div class="line"><span class="lineno"> 1274</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TGraphAsymmErrors</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">var_y</a> = <a class="code hl_function" href="Structs_8cpp.html#a3b61160c5ff362348884cb311e827221">MakeAsymGraph</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_y</a>[1][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>], <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_y</a>[2][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>], <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_y</a>[3][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>], (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">title</a>+<span class="stringliteral">&quot;_Y&quot;</span>).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>());</div>
<div class="line"><span class="lineno"> 1275</span> </div>
<div class="line"><span class="lineno"> 1276</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TGraphAsymmErrors</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">var_x_norm</a> = <a class="code hl_function" href="Structs_8cpp.html#a3b61160c5ff362348884cb311e827221">MakeAsymGraph</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_x_norm</a>[1][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>], <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_x_norm</a>[2][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>], <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_x_norm</a>[3][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>], (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">title</a>+<span class="stringliteral">&quot;_X_norm&quot;</span>).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>());</div>
<div class="line"><span class="lineno"> 1277</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TGraphAsymmErrors</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">var_y_norm</a> = <a class="code hl_function" href="Structs_8cpp.html#a3b61160c5ff362348884cb311e827221">MakeAsymGraph</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_y_norm</a>[1][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>], <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_y_norm</a>[2][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>], <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_y_norm</a>[3][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>], (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">title</a>+<span class="stringliteral">&quot;_Y_norm&quot;</span>).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>());</div>
<div class="line"><span class="lineno"> 1278</span> </div>
<div class="line"><span class="lineno"> 1279</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dirArrySample</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>]-&gt;cd();</div>
<div class="line"><span class="lineno"> 1280</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">var_x</a>-&gt;Write();</div>
<div class="line"><span class="lineno"> 1281</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">var_y</a>-&gt;Write();</div>
<div class="line"><span class="lineno"> 1282</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">var_x_norm</a>-&gt;Write();</div>
<div class="line"><span class="lineno"> 1283</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">var_y_norm</a>-&gt;Write();</div>
<div class="line"><span class="lineno"> 1284</span>          <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">var_x</a>;</div>
<div class="line"><span class="lineno"> 1285</span>          <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">var_y</a>;</div>
<div class="line"><span class="lineno"> 1286</span>          <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">var_x_norm</a>;</div>
<div class="line"><span class="lineno"> 1287</span>          <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">var_y_norm</a>;</div>
<div class="line"><span class="lineno"> 1288</span> </div>
<div class="line"><span class="lineno"> 1289</span>          <span class="comment">//KS: here we loop over all reaction modes defined in &quot;RelevantModes[nRelevantModes]&quot;</span></div>
<div class="line"><span class="lineno"> 1290</span>          <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">DoByMode</a>)</div>
<div class="line"><span class="lineno"> 1291</span>          {</div>
<div class="line"><span class="lineno"> 1292</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ir</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ir</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nRelevantModes</a>;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ir</a>++)</div>
<div class="line"><span class="lineno"> 1293</span>            {</div>
<div class="line"><span class="lineno"> 1294</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TGraphAsymmErrors</a>* <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">var_mode_x</a> = <a class="code hl_function" href="Structs_8cpp.html#a3b61160c5ff362348884cb311e827221">MakeAsymGraph</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_mode_x</a>[1][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ir</a>], <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_mode_x</a>[2][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ir</a>], <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_mode_x</a>[3][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ir</a>], (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">title</a>+<span class="stringliteral">&quot;_&quot;</span>+<a class="code hl_variable" href="classFitterBase.html#a004cb6e6168032d9280ce3db912f1a43">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#abf4ac35511787907bc16ae26aa6c2a15">GetMaCh3ModeName</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">RelevantModes</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ir</a>])+<span class="stringliteral">&quot;_X&quot;</span>).c_str());</div>
<div class="line"><span class="lineno"> 1295</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TGraphAsymmErrors</a>* <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">var_mode_y</a> = <a class="code hl_function" href="Structs_8cpp.html#a3b61160c5ff362348884cb311e827221">MakeAsymGraph</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_mode_y</a>[1][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ir</a>], <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_mode_y</a>[2][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ir</a>], <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_mode_y</a>[3][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ir</a>], (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">title</a>+<span class="stringliteral">&quot;_&quot;</span>+<a class="code hl_variable" href="classFitterBase.html#a004cb6e6168032d9280ce3db912f1a43">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#abf4ac35511787907bc16ae26aa6c2a15">GetMaCh3ModeName</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">RelevantModes</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ir</a>])+<span class="stringliteral">&quot;_Y&quot;</span>).c_str());</div>
<div class="line"><span class="lineno"> 1296</span> </div>
<div class="line"><span class="lineno"> 1297</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dirArrySample</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>]-&gt;cd();</div>
<div class="line"><span class="lineno"> 1298</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">var_mode_x</a>-&gt;Write();</div>
<div class="line"><span class="lineno"> 1299</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">var_mode_y</a>-&gt;Write();</div>
<div class="line"><span class="lineno"> 1300</span> </div>
<div class="line"><span class="lineno"> 1301</span>              <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">var_mode_x</a>;</div>
<div class="line"><span class="lineno"> 1302</span>              <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">var_mode_y</a>;</div>
<div class="line"><span class="lineno"> 1303</span>            } <span class="comment">// end for nRelevantModes</span></div>
<div class="line"><span class="lineno"> 1304</span>          } <span class="comment">// end if mode</span></div>
<div class="line"><span class="lineno"> 1305</span> </div>
<div class="line"><span class="lineno"> 1306</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>++;</div>
<div class="line"><span class="lineno"> 1307</span>        }<span class="comment">//End loop over samples(k)</span></div>
<div class="line"><span class="lineno"> 1308</span>      }<span class="comment">//end looping over sample object</span></div>
<div class="line"><span class="lineno"> 1309</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a> = 0;</div>
<div class="line"><span class="lineno"> 1310</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>++ )</div>
<div class="line"><span class="lineno"> 1311</span>      {</div>
<div class="line"><span class="lineno"> 1312</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;GetNsamples(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>)</div>
<div class="line"><span class="lineno"> 1313</span>        {</div>
<div class="line"><span class="lineno"> 1314</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dirArrySample</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>]-&gt;Close();</div>
<div class="line"><span class="lineno"> 1315</span>          <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dirArrySample</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>];</div>
<div class="line"><span class="lineno"> 1316</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>++;</div>
<div class="line"><span class="lineno"> 1317</span>        }</div>
<div class="line"><span class="lineno"> 1318</span>      }</div>
<div class="line"><span class="lineno"> 1319</span>      <span class="keyword">delete</span>[] <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dirArrySample</a>;</div>
<div class="line"><span class="lineno"> 1320</span> </div>
<div class="line"><span class="lineno"> 1321</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">numVar</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>)</div>
<div class="line"><span class="lineno"> 1322</span>      {</div>
<div class="line"><span class="lineno"> 1323</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a> = 0;</div>
<div class="line"><span class="lineno"> 1324</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>++ )</div>
<div class="line"><span class="lineno"> 1325</span>        {</div>
<div class="line"><span class="lineno"> 1326</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;GetNsamples(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>)</div>
<div class="line"><span class="lineno"> 1327</span>          {</div>
<div class="line"><span class="lineno"> 1328</span>            <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_x</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>];</div>
<div class="line"><span class="lineno"> 1329</span>            <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_y</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>];</div>
<div class="line"><span class="lineno"> 1330</span>            <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_x_norm</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>];</div>
<div class="line"><span class="lineno"> 1331</span>            <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_y_norm</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>];</div>
<div class="line"><span class="lineno"> 1332</span>            <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>++;</div>
<div class="line"><span class="lineno"> 1333</span>          }</div>
<div class="line"><span class="lineno"> 1334</span>        }</div>
<div class="line"><span class="lineno"> 1335</span>        <span class="keyword">delete</span>[] <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_x</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>];</div>
<div class="line"><span class="lineno"> 1336</span>        <span class="keyword">delete</span>[] <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_y</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>];</div>
<div class="line"><span class="lineno"> 1337</span>        <span class="keyword">delete</span>[] <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_x_norm</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>];</div>
<div class="line"><span class="lineno"> 1338</span>        <span class="keyword">delete</span>[] <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_y_norm</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>];</div>
<div class="line"><span class="lineno"> 1339</span>      }</div>
<div class="line"><span class="lineno"> 1340</span>      <span class="keyword">delete</span>[] <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_x</a>;</div>
<div class="line"><span class="lineno"> 1341</span>      <span class="keyword">delete</span>[] <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_y</a>;</div>
<div class="line"><span class="lineno"> 1342</span>      <span class="keyword">delete</span>[] <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_x_norm</a>;</div>
<div class="line"><span class="lineno"> 1343</span>      <span class="keyword">delete</span>[] <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_y_norm</a>;</div>
<div class="line"><span class="lineno"> 1344</span> </div>
<div class="line"><span class="lineno"> 1345</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dirArryDial</a>-&gt;Close();</div>
<div class="line"><span class="lineno"> 1346</span>      <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dirArryDial</a>;</div>
<div class="line"><span class="lineno"> 1347</span> </div>
<div class="line"><span class="lineno"> 1348</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">DoByMode</a>)</div>
<div class="line"><span class="lineno"> 1349</span>      {</div>
<div class="line"><span class="lineno"> 1350</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">numVar</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>)</div>
<div class="line"><span class="lineno"> 1351</span>        {</div>
<div class="line"><span class="lineno"> 1352</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a> = 0;</div>
<div class="line"><span class="lineno"> 1353</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>++ )</div>
<div class="line"><span class="lineno"> 1354</span>          {</div>
<div class="line"><span class="lineno"> 1355</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ivs</a>]-&gt;GetNsamples(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>)</div>
<div class="line"><span class="lineno"> 1356</span>            {</div>
<div class="line"><span class="lineno"> 1357</span>              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ir</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ir</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nRelevantModes</a>;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ir</a>++)</div>
<div class="line"><span class="lineno"> 1358</span>              {</div>
<div class="line"><span class="lineno"> 1359</span>                <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_mode_x</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ir</a>];</div>
<div class="line"><span class="lineno"> 1360</span>                <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_mode_y</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ir</a>];</div>
<div class="line"><span class="lineno"> 1361</span>              }<span class="comment">// end for nRelevantModes</span></div>
<div class="line"><span class="lineno"> 1362</span>              <span class="keyword">delete</span>[] <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_mode_x</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>];</div>
<div class="line"><span class="lineno"> 1363</span>              <span class="keyword">delete</span>[] <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_mode_y</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>][<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>];</div>
<div class="line"><span class="lineno"> 1364</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SampleIterator</a>++;</div>
<div class="line"><span class="lineno"> 1365</span>            }<span class="comment">// end for samples</span></div>
<div class="line"><span class="lineno"> 1366</span>          }</div>
<div class="line"><span class="lineno"> 1367</span>        }</div>
<div class="line"><span class="lineno"> 1368</span>        <span class="keyword">delete</span>[] <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_mode_x</a>;</div>
<div class="line"><span class="lineno"> 1369</span>        <span class="keyword">delete</span>[] <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sigmaArray_mode_y</a>;</div>
<div class="line"><span class="lineno"> 1370</span>      }</div>
<div class="line"><span class="lineno"> 1371</span>    } <span class="comment">// end looping over xsec parameters (i)</span></div>
<div class="line"><span class="lineno"> 1372</span>  } <span class="comment">// end looping over covarianceBase objects</span></div>
<div class="line"><span class="lineno"> 1373</span>}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a61052119a625282d0ec6d4a97adf3ee2"><div class="ttname"><a href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a></div><div class="ttdeci">#define MACH3LOG_ERROR</div><div class="ttdef"><b>Definition</b> <a href="MaCh3Logger_8h_source.html#l00018">MaCh3Logger.h:18</a></div></div>
<div class="ttc" id="aMaCh3Modes_8h_html_adf43f6c73c9598abc381855d31ef5682"><div class="ttname"><a href="MaCh3Modes_8h.html#adf43f6c73c9598abc381855d31ef5682">MaCh3Modes_t</a></div><div class="ttdeci">int MaCh3Modes_t</div><div class="ttdoc">Enumerator of MaCh3Mode.</div><div class="ttdef"><b>Definition</b> <a href="MaCh3Modes_8h_source.html#l00014">MaCh3Modes.h:14</a></div></div>
<div class="ttc" id="aStructs_8cpp_html_a1ab7c868447cffff71227e07655b47ad"><div class="ttname"><a href="Structs_8cpp.html#a1ab7c868447cffff71227e07655b47ad">PolyProjectionX</a></div><div class="ttdeci">TH1D * PolyProjectionX(TObject *poly, std::string TempName, const std::vector&lt; double &gt; &amp;xbins, const bool computeErrors)</div><div class="ttdoc">WP: Poly Projectors.</div><div class="ttdef"><b>Definition</b> <a href="Structs_8cpp_source.html#l00148">Structs.cpp:148</a></div></div>
<div class="ttc" id="aStructs_8cpp_html_a3b61160c5ff362348884cb311e827221"><div class="ttname"><a href="Structs_8cpp.html#a3b61160c5ff362348884cb311e827221">MakeAsymGraph</a></div><div class="ttdeci">TGraphAsymmErrors * MakeAsymGraph(TH1D *sigmaArrayLeft, TH1D *sigmaArrayCentr, TH1D *sigmaArrayRight, const std::string &amp;title)</div><div class="ttdoc">Used by sigma variation, check how 1 sigma changes spectra.</div><div class="ttdef"><b>Definition</b> <a href="Structs_8cpp_source.html#l00430">Structs.cpp:430</a></div></div>
<div class="ttc" id="aStructs_8cpp_html_aa26af438a657c81f2fb3f1506c6e35f6"><div class="ttname"><a href="Structs_8cpp.html#aa26af438a657c81f2fb3f1506c6e35f6">PolyProjectionY</a></div><div class="ttdeci">TH1D * PolyProjectionY(TObject *poly, std::string TempName, const std::vector&lt; double &gt; &amp;ybins, const bool computeErrors)</div><div class="ttdoc">WP: Poly Projectors.</div><div class="ttdef"><b>Definition</b> <a href="Structs_8cpp_source.html#l00216">Structs.cpp:216</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a3706f6d722073b447b3de8c3a6516601"><div class="ttname"><a href="classFitterBase.html#a3706f6d722073b447b3de8c3a6516601">FitterBase::GetName</a></div><div class="ttdeci">virtual std::string GetName() const</div><div class="ttdoc">Get name of class.</div><div class="ttdef"><b>Definition</b> <a href="FitterBase_8h_source.html#l00066">FitterBase.h:66</a></div></div>
<div class="ttc" id="aclassMaCh3Exception_html"><div class="ttname"><a href="classMaCh3Exception.html">MaCh3Exception</a></div><div class="ttdoc">Custom exception class for MaCh3 errors.</div><div class="ttdef"><b>Definition</b> <a href="MaCh3Exception_8h_source.html#l00012">MaCh3Exception.h:12</a></div></div>
<div class="ttc" id="aclassMaCh3Modes_html_a21af1738d7b145f08d76aa0c163e0486"><div class="ttname"><a href="classMaCh3Modes.html#a21af1738d7b145f08d76aa0c163e0486">MaCh3Modes::GetMode</a></div><div class="ttdeci">MaCh3Modes_t GetMode(const std::string &amp;name)</div><div class="ttdoc">KS: Get mode number based on name, if mode not known you will get UNKNOWN_BAD.</div><div class="ttdef"><b>Definition</b> <a href="MaCh3Modes_8cpp_source.html#l00154">MaCh3Modes.cpp:154</a></div></div>
<div class="ttc" id="aclassMaCh3Modes_html_abf4ac35511787907bc16ae26aa6c2a15"><div class="ttname"><a href="classMaCh3Modes.html#abf4ac35511787907bc16ae26aa6c2a15">MaCh3Modes::GetMaCh3ModeName</a></div><div class="ttdeci">std::string GetMaCh3ModeName(const int Index)</div><div class="ttdoc">KS: Get normal name of mode, if mode not known you will get UNKNOWN_BAD.</div><div class="ttdef"><b>Definition</b> <a href="MaCh3Modes_8cpp_source.html#l00124">MaCh3Modes.cpp:124</a></div></div>
<div class="ttc" id="anamespaceM3_html_adb59b8ecdc4e1b2d5d4c826a13aa7463"><div class="ttname"><a href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a></div><div class="ttdeci">int int_t</div><div class="ttdef"><b>Definition</b> <a href="Structs_8h_source.html#l00016">Structs.h:16</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a418f581b688f035211107ddd83168c08" name="a418f581b688f035211107ddd83168c08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a418f581b688f035211107ddd83168c08">&#9670;&#160;</a></span>SaveOutput()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> FitterBase::SaveOutput </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Save output and close files. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00215">215</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  215</span>                            {</div>
<div class="line"><span class="lineno">  216</span><span class="comment">// *******************</span></div>
<div class="line"><span class="lineno">  217</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classFitterBase.html#a699abe6a2c89706b54544212152d613a">FileSaved</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  218</span>  <span class="comment">//Stop Clock</span></div>
<div class="line"><span class="lineno">  219</span>  <a class="code hl_variable" href="classFitterBase.html#a858edb45544f690e90b60b9e041394a6">clock</a>-&gt;Stop();</div>
<div class="line"><span class="lineno">  220</span> </div>
<div class="line"><span class="lineno">  221</span>  <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  222</span>  <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>-&gt;Write();</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{} steps took {:.2f} seconds to complete. ({:.2f}s / step).&quot;</span>, <a class="code hl_variable" href="classFitterBase.html#a50df1bd75b20a953f81ab9c2bab6b42c">step</a>, <a class="code hl_variable" href="classFitterBase.html#a858edb45544f690e90b60b9e041394a6">clock</a>-&gt;RealTime(), <a class="code hl_variable" href="classFitterBase.html#a858edb45544f690e90b60b9e041394a6">clock</a>-&gt;RealTime() / <a class="code hl_variable" href="classFitterBase.html#a50df1bd75b20a953f81ab9c2bab6b42c">step</a>);</div>
<div class="line"><span class="lineno">  225</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{} steps were accepted.&quot;</span>, <a class="code hl_variable" href="classFitterBase.html#a2774f3a0047c4347ee0db05406425f79">accCount</a>);</div>
<div class="line"><span class="lineno">  226</span><span class="preprocessor">  #ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  227</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">debug</a>)</div>
<div class="line"><span class="lineno">  228</span>  {</div>
<div class="line"><span class="lineno">  229</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">debugFile</a> &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span> &lt;&lt; <a class="code hl_variable" href="classFitterBase.html#a50df1bd75b20a953f81ab9c2bab6b42c">step</a> &lt;&lt; <span class="stringliteral">&quot; steps took &quot;</span> &lt;&lt; <a class="code hl_variable" href="classFitterBase.html#a858edb45544f690e90b60b9e041394a6">clock</a>-&gt;RealTime() &lt;&lt; <span class="stringliteral">&quot; seconds to complete. (&quot;</span> &lt;&lt; <a class="code hl_variable" href="classFitterBase.html#a858edb45544f690e90b60b9e041394a6">clock</a>-&gt;RealTime() / <a class="code hl_variable" href="classFitterBase.html#a50df1bd75b20a953f81ab9c2bab6b42c">step</a> &lt;&lt; <span class="stringliteral">&quot;s / step).\n&quot;</span> &lt;&lt; <a class="code hl_variable" href="classFitterBase.html#a2774f3a0047c4347ee0db05406425f79">accCount</a>&lt;&lt; <span class="stringliteral">&quot; steps were accepted.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  230</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">debugFile</a>.close();</div>
<div class="line"><span class="lineno">  231</span>  }</div>
<div class="line"><span class="lineno">  232</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>  <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;Close();</div>
<div class="line"><span class="lineno">  235</span>  <a class="code hl_variable" href="classFitterBase.html#a699abe6a2c89706b54544212152d613a">FileSaved</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  236</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a48f38bfa8996fe00d51f35b05dd16b46" name="a48f38bfa8996fe00d51f35b05dd16b46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48f38bfa8996fe00d51f35b05dd16b46">&#9670;&#160;</a></span>SaveSettings()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> FitterBase::SaveSettings </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Save the settings that the MCMC was run with. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00084">84</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   84</span>                              {</div>
<div class="line"><span class="lineno">   85</span><span class="comment">// *******************</span></div>
<div class="line"><span class="lineno">   86</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classFitterBase.html#a588678c71d816f48ba3c140543dbe916">SettingsSaved</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span>  <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">   89</span> </div>
<div class="line"><span class="lineno">   90</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TDirectory</a>* <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MaCh3Version</a> = <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;MaCh3Engine&quot;</span>);</div>
<div class="line"><span class="lineno">   91</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MaCh3Version</a>-&gt;cd();</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>  <span class="keywordflow">if</span> (std::getenv(<span class="stringliteral">&quot;MaCh3_ROOT&quot;</span>) == <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>) {</div>
<div class="line"><span class="lineno">   94</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Need MaCh3_ROOT environment variable&quot;</span>);</div>
<div class="line"><span class="lineno">   95</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Please remember about source bin/setup.MaCh3.sh&quot;</span>);</div>
<div class="line"><span class="lineno">   96</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__FILE__</a> , <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__LINE__</a> );</div>
<div class="line"><span class="lineno">   97</span>  }</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>  <span class="keywordflow">if</span> (std::getenv(<span class="stringliteral">&quot;MACH3&quot;</span>) == <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>) {</div>
<div class="line"><span class="lineno">  100</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Need MACH3 environment variable&quot;</span>);</div>
<div class="line"><span class="lineno">  101</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__FILE__</a> , <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__LINE__</a> );</div>
<div class="line"><span class="lineno">  102</span>  }</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>  std::string <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">header_path</a> = std::string(std::getenv(<span class="stringliteral">&quot;MACH3&quot;</span>));</div>
<div class="line"><span class="lineno">  105</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">header_path</a> += <span class="stringliteral">&quot;/version.h&quot;</span>;</div>
<div class="line"><span class="lineno">  106</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">FILE</a>* file = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fopen</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">header_path</a>.c_str(), <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="lineno">  107</span>  <span class="comment">//KS: It is better to use experiment specific header file. If given experiment didn&#39;t provide it we gonna use one given by Core MaCh3.</span></div>
<div class="line"><span class="lineno">  108</span>  <span class="keywordflow">if</span> (!file)</div>
<div class="line"><span class="lineno">  109</span>  {</div>
<div class="line"><span class="lineno">  110</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">header_path</a> = std::string(std::getenv(<span class="stringliteral">&quot;MaCh3_ROOT&quot;</span>));</div>
<div class="line"><span class="lineno">  111</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">header_path</a> += <span class="stringliteral">&quot;/version.h&quot;</span>;</div>
<div class="line"><span class="lineno">  112</span>  }</div>
<div class="line"><span class="lineno">  113</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  114</span>  {</div>
<div class="line"><span class="lineno">  115</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fclose</a>(file);</div>
<div class="line"><span class="lineno">  116</span>  }</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>  <span class="comment">// EM: embed the cmake generated version.h file</span></div>
<div class="line"><span class="lineno">  119</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TMacro</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">versionHeader</a>(<span class="stringliteral">&quot;version_header&quot;</span>, <span class="stringliteral">&quot;version_header&quot;</span>);</div>
<div class="line"><span class="lineno">  120</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">versionHeader</a>.ReadFile(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">header_path</a>.c_str());</div>
<div class="line"><span class="lineno">  121</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">versionHeader</a>.Write();</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TNamed</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Engine</a>(<a class="code hl_function" href="classFitterBase.html#a3706f6d722073b447b3de8c3a6516601">GetName</a>(), <a class="code hl_function" href="classFitterBase.html#a3706f6d722073b447b3de8c3a6516601">GetName</a>());</div>
<div class="line"><span class="lineno">  124</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Engine</a>.Write(<a class="code hl_function" href="classFitterBase.html#a3706f6d722073b447b3de8c3a6516601">GetName</a>().<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>());</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MaCh3Version</a>-&gt;Write();</div>
<div class="line"><span class="lineno">  127</span>  <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MaCh3Version</a>;</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span>  <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>  <a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#a0990af01a220479a19ead5d0231aaf94">SaveSettings</a>(<a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>);</div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;\033[0;31mCurrent Total RAM usage is {:.2f} GB\033[0m&quot;</span>, <a class="code hl_function" href="namespaceMaCh3Utils.html#aa406fc13341d99d4ca7a4f43bbb38019">MaCh3Utils::getValue</a>(<span class="stringliteral">&quot;VmRSS&quot;</span>) / 1048576.0);</div>
<div class="line"><span class="lineno">  134</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;\033[0;31mOut of Total available RAM {:.2f} GB\033[0m&quot;</span>, <a class="code hl_function" href="namespaceMaCh3Utils.html#aa406fc13341d99d4ca7a4f43bbb38019">MaCh3Utils::getValue</a>(<span class="stringliteral">&quot;MemTotal&quot;</span>) / 1048576.0);</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;#####Current Setup#####&quot;</span>);</div>
<div class="line"><span class="lineno">  137</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Number of covariances: {}&quot;</span>, <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size());</div>
<div class="line"><span class="lineno">  138</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>)</div>
<div class="line"><span class="lineno">  139</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{}: Cov name: {}, it has {} params&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>]-&gt;getName(), <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>]-&gt;GetNumParams());</div>
<div class="line"><span class="lineno">  140</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Number of SamplePDFs: {}&quot;</span>, <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size());</div>
<div class="line"><span class="lineno">  141</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>)</div>
<div class="line"><span class="lineno">  142</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{}: SamplePDF name: {}, it has {} samples&quot;</span>,<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> , <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>]-&gt;<a class="code hl_function" href="classFitterBase.html#a3706f6d722073b447b3de8c3a6516601">GetName</a>(), <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>]-&gt;GetNsamples());</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>  <a class="code hl_variable" href="classFitterBase.html#a588678c71d816f48ba3c140543dbe916">SettingsSaved</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  145</span>}</div>
<div class="ttc" id="aclassmanager_html_a0990af01a220479a19ead5d0231aaf94"><div class="ttname"><a href="classmanager.html#a0990af01a220479a19ead5d0231aaf94">manager::SaveSettings</a></div><div class="ttdeci">void SaveSettings(TFile *const OutputFile)</div><div class="ttdoc">Add manager useful information's to TFile, in most cases to Fitter.</div><div class="ttdef"><b>Definition</b> <a href="manager_8cpp_source.html#l00057">manager.cpp:57</a></div></div>
<div class="ttc" id="anamespaceMaCh3Utils_html_aa406fc13341d99d4ca7a4f43bbb38019"><div class="ttname"><a href="namespaceMaCh3Utils.html#aa406fc13341d99d4ca7a4f43bbb38019">MaCh3Utils::getValue</a></div><div class="ttdeci">int getValue(const std::string &amp;Type)</div><div class="ttdoc">CW: Get info like RAM.</div><div class="ttdef"><b>Definition</b> <a href="Monitor_8cpp_source.html#l00213">Monitor.cpp:213</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a655ccea31627627e2b36745c97e5c0f0" name="a655ccea31627627e2b36745c97e5c0f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a655ccea31627627e2b36745c97e5c0f0">&#9670;&#160;</a></span>StartFromPreviousFit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> FitterBase::StartFromPreviousFit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> std::string &amp;&#160;</td>
          <td class="paramname"><em>FitName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allow to start from previous fit/chain. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">FitName</td><td>Name of previous chain </td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000006">Todo:</a></b></dt><dd>implement some check that number of params matches etc </dd></dl>

<p>Reimplemented in <a class="el" href="classmcmc.html#adf4c80255288c5396da3b95d609ce4b2">mcmc</a>.</p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00285">285</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  285</span>                                                              {</div>
<div class="line"><span class="lineno">  286</span><span class="comment">// *******************</span></div>
<div class="line"><span class="lineno">  287</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Getting starting position from {}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">FitName</a>);</div>
<div class="line"><span class="lineno">  288</span> </div>
<div class="line"><span class="lineno">  289</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TFile</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">infile</a> = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TFile</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">FitName</a>.c_str(), <span class="stringliteral">&quot;READ&quot;</span>);</div>
<div class="line"><span class="lineno">  290</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">posts</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">infile</a>-&gt;Get&lt;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a>&gt;(<span class="stringliteral">&quot;posteriors&quot;</span>);</div>
<div class="line"><span class="lineno">  291</span>  <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">step_val</a> = 0;</div>
<div class="line"><span class="lineno">  292</span>  <span class="keywordtype">double</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">log_val</a> = <a class="code hl_define" href="covarianceBase_8h.html#a194098591fd0bc4afaf13b4fd8fee408">_LARGE_LOGL_</a>;</div>
<div class="line"><span class="lineno">  293</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">posts</a>-&gt;SetBranchAddress(<span class="stringliteral">&quot;step&quot;</span>,&amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">step_val</a>);</div>
<div class="line"><span class="lineno">  294</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">posts</a>-&gt;SetBranchAddress(<span class="stringliteral">&quot;LogL&quot;</span>,&amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">log_val</a>);</div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a> &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>)</div>
<div class="line"><span class="lineno">  297</span>  {</div>
<div class="line"><span class="lineno">  298</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TDirectory</a>* <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CovarianceFolder</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">infile</a>-&gt;Get&lt;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TDirectory</a>&gt;(<span class="stringliteral">&quot;CovarianceFolder&quot;</span>);</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>    std::string <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ConfigName</a> = <span class="stringliteral">&quot;Config_&quot;</span> + <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>]-&gt;getName();</div>
<div class="line"><span class="lineno">  301</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TMacro</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ConfigCov</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CovarianceFolder</a>-&gt;Get&lt;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TMacro</a>&gt;(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ConfigName</a>.c_str());</div>
<div class="line"><span class="lineno">  302</span>    <span class="comment">// KS: Not every covariance uses yaml, if it uses yaml make sure they are identical</span></div>
<div class="line"><span class="lineno">  303</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ConfigCov</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><span class="lineno">  304</span>      <span class="comment">// Config which was in MCMC from which we are starting</span></div>
<div class="line"><span class="lineno">  305</span>      YAML::Node <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CovSettings</a> = <a class="code hl_function" href="YamlHelper_8h.html#a7e0ade2fd295a927676c243c97d0aa64">TMacroToYAML</a>(*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ConfigCov</a>);</div>
<div class="line"><span class="lineno">  306</span>      <span class="comment">// Config from currently used cov object</span></div>
<div class="line"><span class="lineno">  307</span>      YAML::Node <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ConfigCurrent</a> = <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>]-&gt;GetConfig();</div>
<div class="line"><span class="lineno">  308</span> </div>
<div class="line"><span class="lineno">  309</span>      <span class="keywordflow">if</span> (!<a class="code hl_function" href="YamlHelper_8h.html#ab06d2acbecc5692cab63bdf679ef0034">compareYAMLNodes</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CovSettings</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ConfigCurrent</a>))</div>
<div class="line"><span class="lineno">  310</span>      {</div>
<div class="line"><span class="lineno">  311</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Yaml configs in previous chain and current one are different&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">FitName</a>);</div>
<div class="line"><span class="lineno">  312</span>        <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__FILE__</a> , <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__LINE__</a> );</div>
<div class="line"><span class="lineno">  313</span>      }</div>
<div class="line"><span class="lineno">  314</span>    }</div>
<div class="line"><span class="lineno">  315</span>    <span class="keywordflow">if</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ConfigCov</a> == <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ConfigCov</a>;</div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>    std::vector&lt;double&gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">branch_vals</a>(<a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>]-&gt;GetNumParams());</div>
<div class="line"><span class="lineno">  318</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>]-&gt;GetNumParams(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>) {</div>
<div class="line"><span class="lineno">  319</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">branch_vals</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] = <a class="code hl_variable" href="Structs_8h.html#aa2920b946077e971486eaf1b49101f01">_BAD_DOUBLE_</a>;</div>
<div class="line"><span class="lineno">  320</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">posts</a>-&gt;SetBranchAddress(<a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>]-&gt;GetParName(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>).<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c_str</a>(), &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">branch_vals</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>]);</div>
<div class="line"><span class="lineno">  321</span>    }</div>
<div class="line"><span class="lineno">  322</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">posts</a>-&gt;GetEntry(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">posts</a>-&gt;GetEntries()-1);</div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>]-&gt;GetNumParams(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>) {</div>
<div class="line"><span class="lineno">  325</span>      <span class="keywordflow">if</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">branch_vals</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] == <a class="code hl_variable" href="Structs_8h.html#aa2920b946077e971486eaf1b49101f01">_BAD_DOUBLE_</a>)</div>
<div class="line"><span class="lineno">  326</span>      {</div>
<div class="line"><span class="lineno">  327</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Parameter {} is unvitalised with value {}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">branch_vals</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>]);</div>
<div class="line"><span class="lineno">  328</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Please check more precisely chain you passed {}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">FitName</a>);</div>
<div class="line"><span class="lineno">  329</span>        <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__FILE__</a> , <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__LINE__</a> );</div>
<div class="line"><span class="lineno">  330</span>      }</div>
<div class="line"><span class="lineno">  331</span>    }</div>
<div class="line"><span class="lineno">  332</span>    <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>]-&gt;setParameters(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">branch_vals</a>);</div>
<div class="line"><span class="lineno">  333</span>    <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>]-&gt;acceptStep();</div>
<div class="line"><span class="lineno">  334</span> </div>
<div class="line"><span class="lineno">  335</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Printing new starting values for: {}&quot;</span>, <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>]-&gt;getName());</div>
<div class="line"><span class="lineno">  336</span>    <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>]-&gt;printNominalCurrProp();</div>
<div class="line"><span class="lineno">  337</span> </div>
<div class="line"><span class="lineno">  338</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CovarianceFolder</a>-&gt;Close();</div>
<div class="line"><span class="lineno">  339</span>    <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CovarianceFolder</a>;</div>
<div class="line"><span class="lineno">  340</span>  }</div>
<div class="line"><span class="lineno">  341</span>  <a class="code hl_variable" href="classFitterBase.html#abfb6f10720764d8bbbe43754fd5cd976">logLCurr</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">log_val</a>;</div>
<div class="line"><span class="lineno">  342</span> </div>
<div class="line"><span class="lineno">  343</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">infile</a>-&gt;Close();</div>
<div class="line"><span class="lineno">  344</span>  <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">infile</a>;</div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a> &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>) {</div>
<div class="line"><span class="lineno">  347</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>]-&gt;getDoAdaption()){ <span class="comment">//Use separate throw matrix for xsec</span></div>
<div class="line"><span class="lineno">  348</span>      <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">s</a>]-&gt;setNumberOfSteps(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">step_val</a>);</div>
<div class="line"><span class="lineno">  349</span>    }</div>
<div class="line"><span class="lineno">  350</span>  }</div>
<div class="line"><span class="lineno">  351</span>}</div>
<div class="ttc" id="aStructs_8h_html_aa2920b946077e971486eaf1b49101f01"><div class="ttname"><a href="Structs_8h.html#aa2920b946077e971486eaf1b49101f01">_BAD_DOUBLE_</a></div><div class="ttdeci">static constexpr const double _BAD_DOUBLE_</div><div class="ttdef"><b>Definition</b> <a href="Structs_8h_source.html#l00039">Structs.h:39</a></div></div>
<div class="ttc" id="aYamlHelper_8h_html_a7e0ade2fd295a927676c243c97d0aa64"><div class="ttname"><a href="YamlHelper_8h.html#a7e0ade2fd295a927676c243c97d0aa64">TMacroToYAML</a></div><div class="ttdeci">YAML::Node TMacroToYAML(const TMacro &amp;macro)</div><div class="ttdoc">KS: Convert a ROOT TMacro object to a YAML node.</div><div class="ttdef"><b>Definition</b> <a href="YamlHelper_8h_source.html#l00147">YamlHelper.h:147</a></div></div>
<div class="ttc" id="aYamlHelper_8h_html_ab06d2acbecc5692cab63bdf679ef0034"><div class="ttname"><a href="YamlHelper_8h.html#ab06d2acbecc5692cab63bdf679ef0034">compareYAMLNodes</a></div><div class="ttdeci">bool compareYAMLNodes(const YAML::Node &amp;node1, const YAML::Node &amp;node2)</div><div class="ttdoc">Compare if yaml nodes are identical.</div><div class="ttdef"><b>Definition</b> <a href="YamlHelper_8h_source.html#l00180">YamlHelper.h:180</a></div></div>
<div class="ttc" id="acovarianceBase_8h_html_a194098591fd0bc4afaf13b4fd8fee408"><div class="ttname"><a href="covarianceBase_8h.html#a194098591fd0bc4afaf13b4fd8fee408">_LARGE_LOGL_</a></div><div class="ttdeci">#define _LARGE_LOGL_</div><div class="ttdoc">Large Likelihood is used it parameter go out of physical boundary, this indicates in MCMC that such s...</div><div class="ttdef"><b>Definition</b> <a href="covarianceBase_8h_source.html#l00012">covarianceBase.h:12</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a2774f3a0047c4347ee0db05406425f79" name="a2774f3a0047c4347ee0db05406425f79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2774f3a0047c4347ee0db05406425f79">&#9670;&#160;</a></span>accCount</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> FitterBase::accCount</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>counts accepted steps </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00095">95</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a6319d2ea50984860475bbc6c708b0d90" name="a6319d2ea50984860475bbc6c708b0d90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6319d2ea50984860475bbc6c708b0d90">&#9670;&#160;</a></span>accProb</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">double</a> FitterBase::accProb</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>current acceptance prob </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00093">93</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="ad955982e63066918cba9c53381608d09" name="ad955982e63066918cba9c53381608d09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad955982e63066918cba9c53381608d09">&#9670;&#160;</a></span>auto_save</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> FitterBase::auto_save</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>auto save every N steps </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00127">127</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a858edb45544f690e90b60b9e041394a6" name="a858edb45544f690e90b60b9e041394a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a858edb45544f690e90b60b9e041394a6">&#9670;&#160;</a></span>clock</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TStopwatch</a>&gt; FitterBase::clock</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>tells global time how long fit took </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00111">111</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="aacc46437245ba8a9817f2ed2e86a96e0" name="aacc46437245ba8a9817f2ed2e86a96e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacc46437245ba8a9817f2ed2e86a96e0">&#9670;&#160;</a></span>CovFolder</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TDirectory</a>* FitterBase::CovFolder</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Output cov folder. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00123">123</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a699abe6a2c89706b54544212152d613a" name="a699abe6a2c89706b54544212152d613a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a699abe6a2c89706b54544212152d613a">&#9670;&#160;</a></span>FileSaved</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">bool</a> FitterBase::FileSaved</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if file saved not repeat some operations. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00137">137</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a4fceb68f242feeb04a0ddf42a5a37095" name="a4fceb68f242feeb04a0ddf42a5a37095"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fceb68f242feeb04a0ddf42a5a37095">&#9670;&#160;</a></span>fitMan</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmanager.html">manager</a>* FitterBase::fitMan</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The manager. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00081">81</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="ada898e35bab22af470f2cd1e28af609b" name="ada898e35bab22af470f2cd1e28af609b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada898e35bab22af470f2cd1e28af609b">&#9670;&#160;</a></span>fTestLikelihood</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">bool</a> FitterBase::fTestLikelihood</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Necessary for some fitting algorithms like <a class="el" href="classPSO.html" title="Class PSO, consist of a vector of object Class Particle and global best Takes in the size (number of ...">PSO</a>. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00130">130</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="abfb6f10720764d8bbbe43754fd5cd976" name="abfb6f10720764d8bbbe43754fd5cd976"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfb6f10720764d8bbbe43754fd5cd976">&#9670;&#160;</a></span>logLCurr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">double</a> FitterBase::logLCurr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>current likelihood </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00089">89</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a187dd22c17f9e96e5a7e2fb2371abace" name="a187dd22c17f9e96e5a7e2fb2371abace"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a187dd22c17f9e96e5a7e2fb2371abace">&#9670;&#160;</a></span>logLProp</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">double</a> FitterBase::logLProp</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>proposed likelihood </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00091">91</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a004cb6e6168032d9280ce3db912f1a43" name="a004cb6e6168032d9280ce3db912f1a43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a004cb6e6168032d9280ce3db912f1a43">&#9670;&#160;</a></span>Modes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMaCh3Modes.html">MaCh3Modes</a>* FitterBase::Modes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>MaCh3 Modes. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00084">84</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a4260b312e3f35cf01fc73b02239f8990" name="a4260b312e3f35cf01fc73b02239f8990"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4260b312e3f35cf01fc73b02239f8990">&#9670;&#160;</a></span>outputFile</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TFile</a>* FitterBase::outputFile</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Output. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00121">121</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a3bfd8f69df891d03bae0587cd1a1e1b7" name="a3bfd8f69df891d03bae0587cd1a1e1b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bfd8f69df891d03bae0587cd1a1e1b7">&#9670;&#160;</a></span>OutputPrepared</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">bool</a> FitterBase::OutputPrepared</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if output prepared not repeat some operations. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00141">141</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="aed2032b9c4a4f2248abe548f54f8dcc8" name="aed2032b9c4a4f2248abe548f54f8dcc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed2032b9c4a4f2248abe548f54f8dcc8">&#9670;&#160;</a></span>outTree</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a>* FitterBase::outTree</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Output tree with posteriors. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00125">125</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a138f250d9204a30204e4ca5b973008b2" name="a138f250d9204a30204e4ca5b973008b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a138f250d9204a30204e4ca5b973008b2">&#9670;&#160;</a></span>random</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TRandom3</a>&gt; FitterBase::random</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Random number. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00118">118</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a6f435e161c96eea778aba844115428d4" name="a6f435e161c96eea778aba844115428d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f435e161c96eea778aba844115428d4">&#9670;&#160;</a></span>sample_llh</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">double</a>&gt; FitterBase::sample_llh</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>store the llh breakdowns </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00098">98</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="afac0dcceb1df194159c07945e8dc0069" name="afac0dcceb1df194159c07945e8dc0069"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afac0dcceb1df194159c07945e8dc0069">&#9670;&#160;</a></span>samples</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classsamplePDFBase.html">samplePDFBase</a>*&gt; FitterBase::samples</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sample holder. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00103">103</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="aedd882d8e4d0da0f89cf94e3a008affe" name="aedd882d8e4d0da0f89cf94e3a008affe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedd882d8e4d0da0f89cf94e3a008affe">&#9670;&#160;</a></span>save_nominal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">bool</a> FitterBase::save_nominal</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>save nominal matrix info or not </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00132">132</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a490b8614c4089c6db10ff357e7aaab67" name="a490b8614c4089c6db10ff357e7aaab67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a490b8614c4089c6db10ff357e7aaab67">&#9670;&#160;</a></span>SaveProposal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">bool</a> FitterBase::SaveProposal</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Save proposal at each step. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00134">134</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a588678c71d816f48ba3c140543dbe916" name="a588678c71d816f48ba3c140543dbe916"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a588678c71d816f48ba3c140543dbe916">&#9670;&#160;</a></span>SettingsSaved</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">bool</a> FitterBase::SettingsSaved</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if setting saved not repeat some operations. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00139">139</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a50df1bd75b20a953f81ab9c2bab6b42c" name="a50df1bd75b20a953f81ab9c2bab6b42c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50df1bd75b20a953f81ab9c2bab6b42c">&#9670;&#160;</a></span>step</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> FitterBase::step</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>current state </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00087">87</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a9fe01b2b6f7f0d6a7b04675a099e1a4f" name="a9fe01b2b6f7f0d6a7b04675a099e1a4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fe01b2b6f7f0d6a7b04675a099e1a4f">&#9670;&#160;</a></span>stepClock</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TStopwatch</a>&gt; FitterBase::stepClock</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>tells how long single step/fit iteration took </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00113">113</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a8354e9a7a9cc534277ff76ab37c9a763" name="a8354e9a7a9cc534277ff76ab37c9a763"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8354e9a7a9cc534277ff76ab37c9a763">&#9670;&#160;</a></span>stepTime</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">double</a> FitterBase::stepTime</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Time of single step. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00115">115</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="ace2eeca9829f63200c3f956c600d09ff" name="ace2eeca9829f63200c3f956c600d09ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace2eeca9829f63200c3f956c600d09ff">&#9670;&#160;</a></span>syst_llh</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">double</a>&gt; FitterBase::syst_llh</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>systematic llh breakdowns </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00100">100</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a3a15d2348b7bf0a639aaab52b9294bbf" name="a3a15d2348b7bf0a639aaab52b9294bbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a15d2348b7bf0a639aaab52b9294bbf">&#9670;&#160;</a></span>systematics</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classcovarianceBase.html">covarianceBase</a>*&gt; FitterBase::systematics</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Systematic holder. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00108">108</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="abe9814558b8ff1bccdde3b4c894467e6" name="abe9814558b8ff1bccdde3b4c894467e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe9814558b8ff1bccdde3b4c894467e6">&#9670;&#160;</a></span>TotalNSamples</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> FitterBase::TotalNSamples</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total number of samples used. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00105">105</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>mcmc/<a class="el" href="FitterBase_8h_source.html">FitterBase.h</a></li>
<li>mcmc/<a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
