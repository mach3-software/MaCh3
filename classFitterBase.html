<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MaCh3: FitterBase Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="MaCh3.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="mach3logo_small.png"/></td>
  <td id="projectalign">
   <div id="projectname">MaCh3<span id="projectnumber">&#160;1.4.0</span>
   </div>
   <div id="projectbrief">Reference Guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classFitterBase-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">FitterBase Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div></div>
</div><!--header-->
<div class="contents">

<p>Base class for implementing fitting algorithms.  
 <a href="classFitterBase.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="FitterBase_8h_source.html">mcmc/FitterBase.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for FitterBase:</div>
<div class="dyncontent">
<div class="center"><img src="classFitterBase__inherit__graph.png" border="0" usemap="#aFitterBase_inherit__map" alt="Inheritance graph"/></div>
<map name="aFitterBase_inherit__map" id="aFitterBase_inherit__map">
<area shape="rect" title="Base class for implementing fitting algorithms." alt="" coords="217,5,305,31"/>
<area shape="rect" href="classLikelihoodFit.html" title="Implementation of base Likelihood Fit class, it is mostly responsible for likelihood calculation whil..." alt="" coords="81,79,185,104"/>
<area shape="rect" href="classPyFitterBase.html" title=" " alt="" coords="209,79,313,104"/>
<area shape="rect" href="classmcmc.html" title="Implementation of MR2T2 algorithm." alt="" coords="337,79,400,104"/>
<area shape="rect" href="classMinuitFit.html" title="Implementation of Minuit fitting algorithm ." alt="" coords="5,152,84,177"/>
<area shape="rect" href="classPSO.html" title="Class PSO, consist of a vector of object Class Particle and global best Takes in the size (number of ..." alt="" coords="109,152,157,177"/>
<area shape="rect" href="classPyLikelihoodFit.html" title=" " alt="" coords="181,152,301,177"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for FitterBase:</div>
<div class="dyncontent">
<div class="center"><img src="classFitterBase__coll__graph.png" border="0" usemap="#aFitterBase_coll__map" alt="Collaboration graph"/></div>
<map name="aFitterBase_coll__map" id="aFitterBase_coll__map">
<area shape="rect" title="Base class for implementing fitting algorithms." alt="" coords="2429,570,2517,595"/>
<area shape="rect" href="classmanager.html" title="The manager class is responsible for managing configurations and settings." alt="" coords="1841,157,1921,182"/>
<area shape="rect" title=" " alt="" coords="259,150,346,175"/>
<area shape="rect" href="classMaCh3Modes.html" title="KS: Class describing MaCh3 modes used in the analysis, it is being initialised from config." alt="" coords="1424,189,1535,214"/>
<area shape="rect" title=" " alt="" coords="913,112,1076,152"/>
<area shape="rect" href="structMaCh3ModeInfo.html" title="KS: Class containing information for a single MaCh3Mode." alt="" coords="683,189,811,214"/>
<area shape="rect" title=" " alt="" coords="653,297,840,322"/>
<area shape="rect" href="classcovarianceBase.html" title="Base class responsible for handling of systematic error parameters. Capable of using PCA or using ada..." alt="" coords="1129,570,1254,595"/>
<area shape="rect" title=" " alt="" coords="5,143,144,183"/>
<area shape="rect" href="classsamplePDFBase.html" title="Class responsible for handling implementation of samples used in analysis, reweighting and returning ..." alt="" coords="1817,297,1945,322"/>
<area shape="rect" title=" " alt="" coords="1100,181,1283,221"/>
<area shape="rect" title=" " alt="" coords="233,370,372,395"/>
<area shape="rect" href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html" title="Contains information about adaptive covariance matrix ." alt="" coords="604,487,889,513"/>
<area shape="rect" title=" " alt="" coords="220,799,385,825"/>
<area shape="rect" title=" " alt="" coords="659,924,834,964"/>
<area shape="rect" href="classPCAHandler.html" title="Class responsible for handling Principal Component Analysis (PCA) of covariance matrix." alt="" coords="697,537,796,562"/>
<area shape="rect" title=" " alt="" coords="2077,447,2316,473"/>
<area shape="rect" title=" " alt="" coords="1559,570,1793,595"/>
<area shape="rect" title=" " alt="" coords="657,1039,836,1079"/>
<area shape="rect" title=" " alt="" coords="193,1074,412,1099"/>
<area shape="rect" title=" " alt="" coords="672,586,821,611"/>
<area shape="rect" title=" " alt="" coords="659,860,834,900"/>
<area shape="rect" title=" " alt="" coords="2084,1154,2309,1179"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a2d45811f9bcb9719f312048bbd36a423"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a2d45811f9bcb9719f312048bbd36a423">FitterBase</a> (<a class="el" href="classmanager.html">manager</a> *const <a class="el" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>)</td></tr>
<tr class="memdesc:a2d45811f9bcb9719f312048bbd36a423"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <br /></td></tr>
<tr class="separator:a2d45811f9bcb9719f312048bbd36a423"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8677b449e49ca86bafee685e8dbe93f"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#ae8677b449e49ca86bafee685e8dbe93f">~FitterBase</a> ()</td></tr>
<tr class="memdesc:ae8677b449e49ca86bafee685e8dbe93f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor for the <a class="el" href="classFitterBase.html" title="Base class for implementing fitting algorithms.">FitterBase</a> class.  <br /></td></tr>
<tr class="separator:ae8677b449e49ca86bafee685e8dbe93f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe93c6d49aa079d811a9021de59691b1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#abe93c6d49aa079d811a9021de59691b1">addSamplePDF</a> (<a class="el" href="classsamplePDFBase.html">samplePDFBase</a> *sample)</td></tr>
<tr class="memdesc:abe93c6d49aa079d811a9021de59691b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function adds a sample PDF object to the analysis framework. The sample PDF object will be utilized in fitting procedures or likelihood scans.  <br /></td></tr>
<tr class="separator:abe93c6d49aa079d811a9021de59691b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d0068193922448a6fed0e0d3ff4305a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a1d0068193922448a6fed0e0d3ff4305a">addSystObj</a> (<a class="el" href="classcovarianceBase.html">covarianceBase</a> *cov)</td></tr>
<tr class="memdesc:a1d0068193922448a6fed0e0d3ff4305a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function adds a Covariance object to the analysis framework. The Covariance object will be utilized in fitting procedures or likelihood scans.  <br /></td></tr>
<tr class="separator:a1d0068193922448a6fed0e0d3ff4305a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a9666dc09f91af804954e8968bc7b24"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a1a9666dc09f91af804954e8968bc7b24">runMCMC</a> ()=0</td></tr>
<tr class="memdesc:a1a9666dc09f91af804954e8968bc7b24"><td class="mdescLeft">&#160;</td><td class="mdescRight">The specific fitting algorithm implemented in this function depends on the derived class. It could be Markov Chain Monte Carlo (MCMC), <a class="el" href="classMinuitFit.html" title="Implementation of Minuit fitting algorithm .">MinuitFit</a>, or another algorithm.  <br /></td></tr>
<tr class="separator:a1a9666dc09f91af804954e8968bc7b24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3db1d0bb7364e70cd432a3e1c0a600e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#ab3db1d0bb7364e70cd432a3e1c0a600e">DragRace</a> (const int NLaps=100)</td></tr>
<tr class="memdesc:ab3db1d0bb7364e70cd432a3e1c0a600e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the required time for each sample or covariance object in a drag race simulation. Inspired by Dan's feature.  <br /></td></tr>
<tr class="separator:ab3db1d0bb7364e70cd432a3e1c0a600e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a018e8d09a62bca19840e1321b49df2c0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a018e8d09a62bca19840e1321b49df2c0">RunLLHScan</a> ()</td></tr>
<tr class="memdesc:a018e8d09a62bca19840e1321b49df2c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a 1D likelihood scan.  <br /></td></tr>
<tr class="separator:a018e8d09a62bca19840e1321b49df2c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63820450a9089d5281769288c007db55"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a63820450a9089d5281769288c007db55">GetStepScaleBasedOnLLHScan</a> ()</td></tr>
<tr class="memdesc:a63820450a9089d5281769288c007db55"><td class="mdescLeft">&#160;</td><td class="mdescRight">LLH scan is good first estimate of step scale.  <br /></td></tr>
<tr class="separator:a63820450a9089d5281769288c007db55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8b32ca268c20dd643eaf92dae04cd0a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#ab8b32ca268c20dd643eaf92dae04cd0a">Run2DLLHScan</a> ()</td></tr>
<tr class="memdesc:ab8b32ca268c20dd643eaf92dae04cd0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a 2D likelihood scan.  <br /></td></tr>
<tr class="separator:ab8b32ca268c20dd643eaf92dae04cd0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71e43b96395568e54879d9bd1b57c0f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a71e43b96395568e54879d9bd1b57c0f8">RunSigmaVar</a> ()</td></tr>
<tr class="memdesc:a71e43b96395568e54879d9bd1b57c0f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a 2D and 1D sigma var for all samples.  <br /></td></tr>
<tr class="separator:a71e43b96395568e54879d9bd1b57c0f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a655ccea31627627e2b36745c97e5c0f0"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a655ccea31627627e2b36745c97e5c0f0">StartFromPreviousFit</a> (const std::string &amp;FitName)</td></tr>
<tr class="memdesc:a655ccea31627627e2b36745c97e5c0f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allow to start from previous fit/chain.  <br /></td></tr>
<tr class="separator:a655ccea31627627e2b36745c97e5c0f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3706f6d722073b447b3de8c3a6516601"><td class="memItemLeft" align="right" valign="top">virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a3706f6d722073b447b3de8c3a6516601">GetName</a> () const</td></tr>
<tr class="memdesc:a3706f6d722073b447b3de8c3a6516601"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get name of class.  <br /></td></tr>
<tr class="separator:a3706f6d722073b447b3de8c3a6516601"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a1dccdac8611e70c759c47a65f2b1aea7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a1dccdac8611e70c759c47a65f2b1aea7">ProcessMCMC</a> ()</td></tr>
<tr class="memdesc:a1dccdac8611e70c759c47a65f2b1aea7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process MCMC output.  <br /></td></tr>
<tr class="separator:a1dccdac8611e70c759c47a65f2b1aea7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53715760edd8c7640432f31793fd28f9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a53715760edd8c7640432f31793fd28f9">PrepareOutput</a> ()</td></tr>
<tr class="memdesc:a53715760edd8c7640432f31793fd28f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare the output file.  <br /></td></tr>
<tr class="separator:a53715760edd8c7640432f31793fd28f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a418f581b688f035211107ddd83168c08"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a418f581b688f035211107ddd83168c08">SaveOutput</a> ()</td></tr>
<tr class="memdesc:a418f581b688f035211107ddd83168c08"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save output and close files.  <br /></td></tr>
<tr class="separator:a418f581b688f035211107ddd83168c08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48f38bfa8996fe00d51f35b05dd16b46"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a48f38bfa8996fe00d51f35b05dd16b46">SaveSettings</a> ()</td></tr>
<tr class="memdesc:a48f38bfa8996fe00d51f35b05dd16b46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save the settings that the MCMC was run with.  <br /></td></tr>
<tr class="separator:a48f38bfa8996fe00d51f35b05dd16b46"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a4fceb68f242feeb04a0ddf42a5a37095"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmanager.html">manager</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a></td></tr>
<tr class="memdesc:a4fceb68f242feeb04a0ddf42a5a37095"><td class="mdescLeft">&#160;</td><td class="mdescRight">The manager.  <br /></td></tr>
<tr class="separator:a4fceb68f242feeb04a0ddf42a5a37095"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a004cb6e6168032d9280ce3db912f1a43"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMaCh3Modes.html">MaCh3Modes</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a004cb6e6168032d9280ce3db912f1a43">Modes</a></td></tr>
<tr class="memdesc:a004cb6e6168032d9280ce3db912f1a43"><td class="mdescLeft">&#160;</td><td class="mdescRight">MaCh3 Modes.  <br /></td></tr>
<tr class="separator:a004cb6e6168032d9280ce3db912f1a43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50df1bd75b20a953f81ab9c2bab6b42c"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a50df1bd75b20a953f81ab9c2bab6b42c">step</a></td></tr>
<tr class="memdesc:a50df1bd75b20a953f81ab9c2bab6b42c"><td class="mdescLeft">&#160;</td><td class="mdescRight">current state  <br /></td></tr>
<tr class="separator:a50df1bd75b20a953f81ab9c2bab6b42c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfb6f10720764d8bbbe43754fd5cd976"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#abfb6f10720764d8bbbe43754fd5cd976">logLCurr</a></td></tr>
<tr class="memdesc:abfb6f10720764d8bbbe43754fd5cd976"><td class="mdescLeft">&#160;</td><td class="mdescRight">current likelihood  <br /></td></tr>
<tr class="separator:abfb6f10720764d8bbbe43754fd5cd976"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a187dd22c17f9e96e5a7e2fb2371abace"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a187dd22c17f9e96e5a7e2fb2371abace">logLProp</a></td></tr>
<tr class="memdesc:a187dd22c17f9e96e5a7e2fb2371abace"><td class="mdescLeft">&#160;</td><td class="mdescRight">proposed likelihood  <br /></td></tr>
<tr class="separator:a187dd22c17f9e96e5a7e2fb2371abace"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6319d2ea50984860475bbc6c708b0d90"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a6319d2ea50984860475bbc6c708b0d90">accProb</a></td></tr>
<tr class="memdesc:a6319d2ea50984860475bbc6c708b0d90"><td class="mdescLeft">&#160;</td><td class="mdescRight">current acceptance prob  <br /></td></tr>
<tr class="separator:a6319d2ea50984860475bbc6c708b0d90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2774f3a0047c4347ee0db05406425f79"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a2774f3a0047c4347ee0db05406425f79">accCount</a></td></tr>
<tr class="memdesc:a2774f3a0047c4347ee0db05406425f79"><td class="mdescLeft">&#160;</td><td class="mdescRight">counts accepted steps  <br /></td></tr>
<tr class="separator:a2774f3a0047c4347ee0db05406425f79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f435e161c96eea778aba844115428d4"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a6f435e161c96eea778aba844115428d4">sample_llh</a></td></tr>
<tr class="memdesc:a6f435e161c96eea778aba844115428d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">store the llh breakdowns  <br /></td></tr>
<tr class="separator:a6f435e161c96eea778aba844115428d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace2eeca9829f63200c3f956c600d09ff"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#ace2eeca9829f63200c3f956c600d09ff">syst_llh</a></td></tr>
<tr class="memdesc:ace2eeca9829f63200c3f956c600d09ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">systematic llh breakdowns  <br /></td></tr>
<tr class="separator:ace2eeca9829f63200c3f956c600d09ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afac0dcceb1df194159c07945e8dc0069"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classsamplePDFBase.html">samplePDFBase</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a></td></tr>
<tr class="memdesc:afac0dcceb1df194159c07945e8dc0069"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sample holder.  <br /></td></tr>
<tr class="separator:afac0dcceb1df194159c07945e8dc0069"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe9814558b8ff1bccdde3b4c894467e6"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a></td></tr>
<tr class="memdesc:abe9814558b8ff1bccdde3b4c894467e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of samples used.  <br /></td></tr>
<tr class="separator:abe9814558b8ff1bccdde3b4c894467e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a15d2348b7bf0a639aaab52b9294bbf"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classcovarianceBase.html">covarianceBase</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a></td></tr>
<tr class="memdesc:a3a15d2348b7bf0a639aaab52b9294bbf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Systematic holder.  <br /></td></tr>
<tr class="separator:a3a15d2348b7bf0a639aaab52b9294bbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a858edb45544f690e90b60b9e041394a6"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; TStopwatch &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a858edb45544f690e90b60b9e041394a6">clock</a></td></tr>
<tr class="memdesc:a858edb45544f690e90b60b9e041394a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">tells global time how long fit took  <br /></td></tr>
<tr class="separator:a858edb45544f690e90b60b9e041394a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fe01b2b6f7f0d6a7b04675a099e1a4f"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; TStopwatch &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a9fe01b2b6f7f0d6a7b04675a099e1a4f">stepClock</a></td></tr>
<tr class="memdesc:a9fe01b2b6f7f0d6a7b04675a099e1a4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">tells how long single step/fit iteration took  <br /></td></tr>
<tr class="separator:a9fe01b2b6f7f0d6a7b04675a099e1a4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8354e9a7a9cc534277ff76ab37c9a763"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a8354e9a7a9cc534277ff76ab37c9a763">stepTime</a></td></tr>
<tr class="memdesc:a8354e9a7a9cc534277ff76ab37c9a763"><td class="mdescLeft">&#160;</td><td class="mdescRight">Time of single step.  <br /></td></tr>
<tr class="separator:a8354e9a7a9cc534277ff76ab37c9a763"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a138f250d9204a30204e4ca5b973008b2"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; TRandom3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a138f250d9204a30204e4ca5b973008b2">random</a></td></tr>
<tr class="memdesc:a138f250d9204a30204e4ca5b973008b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Random number.  <br /></td></tr>
<tr class="separator:a138f250d9204a30204e4ca5b973008b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4260b312e3f35cf01fc73b02239f8990"><td class="memItemLeft" align="right" valign="top">TFile *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a></td></tr>
<tr class="memdesc:a4260b312e3f35cf01fc73b02239f8990"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output.  <br /></td></tr>
<tr class="separator:a4260b312e3f35cf01fc73b02239f8990"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacc46437245ba8a9817f2ed2e86a96e0"><td class="memItemLeft" align="right" valign="top">TDirectory *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#aacc46437245ba8a9817f2ed2e86a96e0">CovFolder</a></td></tr>
<tr class="memdesc:aacc46437245ba8a9817f2ed2e86a96e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output cov folder.  <br /></td></tr>
<tr class="separator:aacc46437245ba8a9817f2ed2e86a96e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed2032b9c4a4f2248abe548f54f8dcc8"><td class="memItemLeft" align="right" valign="top">TTree *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a></td></tr>
<tr class="memdesc:aed2032b9c4a4f2248abe548f54f8dcc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output tree with posteriors.  <br /></td></tr>
<tr class="separator:aed2032b9c4a4f2248abe548f54f8dcc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad955982e63066918cba9c53381608d09"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#ad955982e63066918cba9c53381608d09">auto_save</a></td></tr>
<tr class="memdesc:ad955982e63066918cba9c53381608d09"><td class="mdescLeft">&#160;</td><td class="mdescRight">auto save every N steps  <br /></td></tr>
<tr class="separator:ad955982e63066918cba9c53381608d09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada898e35bab22af470f2cd1e28af609b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#ada898e35bab22af470f2cd1e28af609b">fTestLikelihood</a></td></tr>
<tr class="memdesc:ada898e35bab22af470f2cd1e28af609b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Necessary for some fitting algorithms like <a class="el" href="classPSO.html" title="Class PSO, consist of a vector of object Class Particle and global best Takes in the size (number of ...">PSO</a>.  <br /></td></tr>
<tr class="separator:ada898e35bab22af470f2cd1e28af609b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedd882d8e4d0da0f89cf94e3a008affe"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#aedd882d8e4d0da0f89cf94e3a008affe">save_nominal</a></td></tr>
<tr class="memdesc:aedd882d8e4d0da0f89cf94e3a008affe"><td class="mdescLeft">&#160;</td><td class="mdescRight">save nominal matrix info or not  <br /></td></tr>
<tr class="separator:aedd882d8e4d0da0f89cf94e3a008affe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a490b8614c4089c6db10ff357e7aaab67"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a490b8614c4089c6db10ff357e7aaab67">SaveProposal</a></td></tr>
<tr class="memdesc:a490b8614c4089c6db10ff357e7aaab67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save proposal at each step.  <br /></td></tr>
<tr class="separator:a490b8614c4089c6db10ff357e7aaab67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a699abe6a2c89706b54544212152d613a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a699abe6a2c89706b54544212152d613a">FileSaved</a></td></tr>
<tr class="memdesc:a699abe6a2c89706b54544212152d613a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if file saved not repeat some operations.  <br /></td></tr>
<tr class="separator:a699abe6a2c89706b54544212152d613a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a588678c71d816f48ba3c140543dbe916"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a588678c71d816f48ba3c140543dbe916">SettingsSaved</a></td></tr>
<tr class="memdesc:a588678c71d816f48ba3c140543dbe916"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if setting saved not repeat some operations.  <br /></td></tr>
<tr class="separator:a588678c71d816f48ba3c140543dbe916"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bfd8f69df891d03bae0587cd1a1e1b7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFitterBase.html#a3bfd8f69df891d03bae0587cd1a1e1b7">OutputPrepared</a></td></tr>
<tr class="memdesc:a3bfd8f69df891d03bae0587cd1a1e1b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if output prepared not repeat some operations.  <br /></td></tr>
<tr class="separator:a3bfd8f69df891d03bae0587cd1a1e1b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Base class for implementing fitting algorithms. </p>
<dl class="section see"><dt>See also</dt><dd>For more details, visit the <a href="https://github.com/mach3-software/MaCh3/wiki/06.-Fitting-Algorithms">Wiki</a>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00023">23</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a2d45811f9bcb9719f312048bbd36a423" name="a2d45811f9bcb9719f312048bbd36a423"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d45811f9bcb9719f312048bbd36a423">&#9670;&#160;</a></span>FitterBase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FitterBase::FitterBase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmanager.html">manager</a> *const&#160;</td>
          <td class="paramname"><em>fitMan</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fitMan</td><td>A pointer to a manager object, which will handle all settings. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00013">13</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   13</span>                                          : <a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>(<a class="code hl_variable" href="GetPostfitParamPlots_8cpp.html#aa6f3c9a8cee8f72f6f8ce65b720a2d40">man</a>) {</div>
<div class="line"><span class="lineno">   14</span><span class="comment">// *************************</span></div>
<div class="line"><span class="lineno">   15</span> </div>
<div class="line"><span class="lineno">   16</span>  <span class="comment">//Get mach3 modes from manager</span></div>
<div class="line"><span class="lineno">   17</span>  <a class="code hl_variable" href="classFitterBase.html#a004cb6e6168032d9280ce3db912f1a43">Modes</a> = <a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#a297a81517f0a46bda90f42b211e42cf5">GetMaCh3Modes</a>();</div>
<div class="line"><span class="lineno">   18</span>  <a class="code hl_variable" href="classFitterBase.html#a138f250d9204a30204e4ca5b973008b2">random</a> = std::make_unique&lt;TRandom3&gt;(<a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;Seed&quot;</span>].as&lt;<span class="keywordtype">int</span>&gt;());</div>
<div class="line"><span class="lineno">   19</span> </div>
<div class="line"><span class="lineno">   20</span>  <span class="comment">// Counter of the accepted # of steps</span></div>
<div class="line"><span class="lineno">   21</span>  <a class="code hl_variable" href="classFitterBase.html#a2774f3a0047c4347ee0db05406425f79">accCount</a> = 0;</div>
<div class="line"><span class="lineno">   22</span>  <a class="code hl_variable" href="classFitterBase.html#a50df1bd75b20a953f81ab9c2bab6b42c">step</a> = 0;</div>
<div class="line"><span class="lineno">   23</span> </div>
<div class="line"><span class="lineno">   24</span>  <a class="code hl_variable" href="classFitterBase.html#a858edb45544f690e90b60b9e041394a6">clock</a> = std::make_unique&lt;TStopwatch&gt;();</div>
<div class="line"><span class="lineno">   25</span>  <a class="code hl_variable" href="classFitterBase.html#a9fe01b2b6f7f0d6a7b04675a099e1a4f">stepClock</a> = std::make_unique&lt;TStopwatch&gt;();</div>
<div class="line"><span class="lineno">   26</span><span class="preprocessor">  #ifdef DEBUG</span></div>
<div class="line"><span class="lineno">   27</span>  <span class="comment">// Fit summary and debug info</span></div>
<div class="line"><span class="lineno">   28</span>  debug = GetFromManager&lt;bool&gt;(<a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;Debug&quot;</span>], <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">   29</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">   30</span> </div>
<div class="line"><span class="lineno">   31</span>  <span class="keyword">auto</span> outfile = <a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;OutputFile&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><span class="lineno">   32</span>  <span class="comment">// Save output every auto_save steps</span></div>
<div class="line"><span class="lineno">   33</span>  <span class="comment">//you don&#39;t want this too often https://root.cern/root/html606/TTree_8cxx_source.html#l01229</span></div>
<div class="line"><span class="lineno">   34</span>  <a class="code hl_variable" href="classFitterBase.html#ad955982e63066918cba9c53381608d09">auto_save</a> = <a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;MCMC&quot;</span>][<span class="stringliteral">&quot;AutoSave&quot;</span>].as&lt;<span class="keywordtype">int</span>&gt;();</div>
<div class="line"><span class="lineno">   35</span>  <span class="comment">// Do we want to save the nominal parameters to output</span></div>
<div class="line"><span class="lineno">   36</span>  <a class="code hl_variable" href="classFitterBase.html#aedd882d8e4d0da0f89cf94e3a008affe">save_nominal</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   37</span> </div>
<div class="line"><span class="lineno">   38</span>  <span class="comment">// Do we want to save proposal? This will break plotting scripts and is heave for disk space and step time. Only use when debugging</span></div>
<div class="line"><span class="lineno">   39</span>  <a class="code hl_variable" href="classFitterBase.html#a490b8614c4089c6db10ff357e7aaab67">SaveProposal</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   40</span> </div>
<div class="line"><span class="lineno">   41</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">   42</span>  <span class="comment">//KS: TODO This should help with performance when saving entries to ROOT file. I didn&#39;t have time to validate hence commented out</span></div>
<div class="line"><span class="lineno">   43</span>  <span class="comment">//Based on other tests it is really helpful</span></div>
<div class="line"><span class="lineno">   44</span>  <span class="comment">//ROOT::EnableImplicitMT();</span></div>
<div class="line"><span class="lineno">   45</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">   46</span>  <span class="comment">// Set the output file</span></div>
<div class="line"><span class="lineno">   47</span>  <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a> = <span class="keyword">new</span> TFile(outfile.c_str(), <span class="stringliteral">&quot;RECREATE&quot;</span>);</div>
<div class="line"><span class="lineno">   48</span>  <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">   49</span>  <span class="comment">// Set output tree</span></div>
<div class="line"><span class="lineno">   50</span>  <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a> = <span class="keyword">new</span> TTree(<span class="stringliteral">&quot;posteriors&quot;</span>, <span class="stringliteral">&quot;Posterior_Distributions&quot;</span>);</div>
<div class="line"><span class="lineno">   51</span>  <span class="comment">// Auto-save every 200MB, the bigger the better https://root.cern/root/html606/TTree_8cxx_source.html#l01229</span></div>
<div class="line"><span class="lineno">   52</span>  <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>-&gt;SetAutoSave(-200E6);</div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span>  <a class="code hl_variable" href="classFitterBase.html#a699abe6a2c89706b54544212152d613a">FileSaved</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   55</span>  <a class="code hl_variable" href="classFitterBase.html#a588678c71d816f48ba3c140543dbe916">SettingsSaved</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   56</span>  <a class="code hl_variable" href="classFitterBase.html#a3bfd8f69df891d03bae0587cd1a1e1b7">OutputPrepared</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span>  <span class="comment">//Create TDirectory</span></div>
<div class="line"><span class="lineno">   59</span>  <a class="code hl_variable" href="classFitterBase.html#aacc46437245ba8a9817f2ed2e86a96e0">CovFolder</a> = <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;CovarianceFolder&quot;</span>);</div>
<div class="line"><span class="lineno">   60</span>  <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">   61</span> </div>
<div class="line"><span class="lineno">   62</span><span class="preprocessor">  #ifdef DEBUG</span></div>
<div class="line"><span class="lineno">   63</span>  <span class="comment">// Prepare the output log file</span></div>
<div class="line"><span class="lineno">   64</span>  <span class="keywordflow">if</span> (debug) debugFile.open((outfile+<span class="stringliteral">&quot;.log&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">   65</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>  <a class="code hl_variable" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a> = 0;</div>
<div class="line"><span class="lineno">   68</span>  <a class="code hl_variable" href="classFitterBase.html#ada898e35bab22af470f2cd1e28af609b">fTestLikelihood</a> = GetFromManager&lt;bool&gt;(<a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;Fitter&quot;</span>][<span class="stringliteral">&quot;FitTestLikelihood&quot;</span>], <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">   69</span>}</div>
<div class="ttc" id="aGetPostfitParamPlots_8cpp_html_aa6f3c9a8cee8f72f6f8ce65b720a2d40"><div class="ttname"><a href="GetPostfitParamPlots_8cpp.html#aa6f3c9a8cee8f72f6f8ce65b720a2d40">man</a></div><div class="ttdeci">MaCh3Plotting::PlottingManager * man</div><div class="ttdef"><b>Definition:</b> <a href="GetPostfitParamPlots_8cpp_source.html#l00055">GetPostfitParamPlots.cpp:55</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a004cb6e6168032d9280ce3db912f1a43"><div class="ttname"><a href="classFitterBase.html#a004cb6e6168032d9280ce3db912f1a43">FitterBase::Modes</a></div><div class="ttdeci">MaCh3Modes * Modes</div><div class="ttdoc">MaCh3 Modes.</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00084">FitterBase.h:84</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a138f250d9204a30204e4ca5b973008b2"><div class="ttname"><a href="classFitterBase.html#a138f250d9204a30204e4ca5b973008b2">FitterBase::random</a></div><div class="ttdeci">std::unique_ptr&lt; TRandom3 &gt; random</div><div class="ttdoc">Random number.</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00118">FitterBase.h:118</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a2774f3a0047c4347ee0db05406425f79"><div class="ttname"><a href="classFitterBase.html#a2774f3a0047c4347ee0db05406425f79">FitterBase::accCount</a></div><div class="ttdeci">int accCount</div><div class="ttdoc">counts accepted steps</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00095">FitterBase.h:95</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a3bfd8f69df891d03bae0587cd1a1e1b7"><div class="ttname"><a href="classFitterBase.html#a3bfd8f69df891d03bae0587cd1a1e1b7">FitterBase::OutputPrepared</a></div><div class="ttdeci">bool OutputPrepared</div><div class="ttdoc">Checks if output prepared not repeat some operations.</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00141">FitterBase.h:141</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a4260b312e3f35cf01fc73b02239f8990"><div class="ttname"><a href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">FitterBase::outputFile</a></div><div class="ttdeci">TFile * outputFile</div><div class="ttdoc">Output.</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00121">FitterBase.h:121</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a490b8614c4089c6db10ff357e7aaab67"><div class="ttname"><a href="classFitterBase.html#a490b8614c4089c6db10ff357e7aaab67">FitterBase::SaveProposal</a></div><div class="ttdeci">bool SaveProposal</div><div class="ttdoc">Save proposal at each step.</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00134">FitterBase.h:134</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a4fceb68f242feeb04a0ddf42a5a37095"><div class="ttname"><a href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">FitterBase::fitMan</a></div><div class="ttdeci">manager * fitMan</div><div class="ttdoc">The manager.</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00081">FitterBase.h:81</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a50df1bd75b20a953f81ab9c2bab6b42c"><div class="ttname"><a href="classFitterBase.html#a50df1bd75b20a953f81ab9c2bab6b42c">FitterBase::step</a></div><div class="ttdeci">unsigned int step</div><div class="ttdoc">current state</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00087">FitterBase.h:87</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a588678c71d816f48ba3c140543dbe916"><div class="ttname"><a href="classFitterBase.html#a588678c71d816f48ba3c140543dbe916">FitterBase::SettingsSaved</a></div><div class="ttdeci">bool SettingsSaved</div><div class="ttdoc">Checks if setting saved not repeat some operations.</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00139">FitterBase.h:139</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a699abe6a2c89706b54544212152d613a"><div class="ttname"><a href="classFitterBase.html#a699abe6a2c89706b54544212152d613a">FitterBase::FileSaved</a></div><div class="ttdeci">bool FileSaved</div><div class="ttdoc">Checks if file saved not repeat some operations.</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00137">FitterBase.h:137</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a858edb45544f690e90b60b9e041394a6"><div class="ttname"><a href="classFitterBase.html#a858edb45544f690e90b60b9e041394a6">FitterBase::clock</a></div><div class="ttdeci">std::unique_ptr&lt; TStopwatch &gt; clock</div><div class="ttdoc">tells global time how long fit took</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00111">FitterBase.h:111</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a9fe01b2b6f7f0d6a7b04675a099e1a4f"><div class="ttname"><a href="classFitterBase.html#a9fe01b2b6f7f0d6a7b04675a099e1a4f">FitterBase::stepClock</a></div><div class="ttdeci">std::unique_ptr&lt; TStopwatch &gt; stepClock</div><div class="ttdoc">tells how long single step/fit iteration took</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00113">FitterBase.h:113</a></div></div>
<div class="ttc" id="aclassFitterBase_html_aacc46437245ba8a9817f2ed2e86a96e0"><div class="ttname"><a href="classFitterBase.html#aacc46437245ba8a9817f2ed2e86a96e0">FitterBase::CovFolder</a></div><div class="ttdeci">TDirectory * CovFolder</div><div class="ttdoc">Output cov folder.</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00123">FitterBase.h:123</a></div></div>
<div class="ttc" id="aclassFitterBase_html_abe9814558b8ff1bccdde3b4c894467e6"><div class="ttname"><a href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">FitterBase::TotalNSamples</a></div><div class="ttdeci">unsigned int TotalNSamples</div><div class="ttdoc">Total number of samples used.</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00105">FitterBase.h:105</a></div></div>
<div class="ttc" id="aclassFitterBase_html_ad955982e63066918cba9c53381608d09"><div class="ttname"><a href="classFitterBase.html#ad955982e63066918cba9c53381608d09">FitterBase::auto_save</a></div><div class="ttdeci">int auto_save</div><div class="ttdoc">auto save every N steps</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00127">FitterBase.h:127</a></div></div>
<div class="ttc" id="aclassFitterBase_html_ada898e35bab22af470f2cd1e28af609b"><div class="ttname"><a href="classFitterBase.html#ada898e35bab22af470f2cd1e28af609b">FitterBase::fTestLikelihood</a></div><div class="ttdeci">bool fTestLikelihood</div><div class="ttdoc">Necessary for some fitting algorithms like PSO.</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00130">FitterBase.h:130</a></div></div>
<div class="ttc" id="aclassFitterBase_html_aed2032b9c4a4f2248abe548f54f8dcc8"><div class="ttname"><a href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">FitterBase::outTree</a></div><div class="ttdeci">TTree * outTree</div><div class="ttdoc">Output tree with posteriors.</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00125">FitterBase.h:125</a></div></div>
<div class="ttc" id="aclassFitterBase_html_aedd882d8e4d0da0f89cf94e3a008affe"><div class="ttname"><a href="classFitterBase.html#aedd882d8e4d0da0f89cf94e3a008affe">FitterBase::save_nominal</a></div><div class="ttdeci">bool save_nominal</div><div class="ttdoc">save nominal matrix info or not</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00132">FitterBase.h:132</a></div></div>
<div class="ttc" id="aclassmanager_html_a297a81517f0a46bda90f42b211e42cf5"><div class="ttname"><a href="classmanager.html#a297a81517f0a46bda90f42b211e42cf5">manager::GetMaCh3Modes</a></div><div class="ttdeci">MaCh3Modes * GetMaCh3Modes() const</div><div class="ttdoc">Return pointer to MaCh3 modes.</div><div class="ttdef"><b>Definition:</b> <a href="manager_8h_source.html#l00040">manager.h:40</a></div></div>
<div class="ttc" id="aclassmanager_html_ab3999cc856ede72b37f68bdb28bd5520"><div class="ttname"><a href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">manager::raw</a></div><div class="ttdeci">YAML::Node const &amp; raw()</div><div class="ttdoc">Return config.</div><div class="ttdef"><b>Definition:</b> <a href="manager_8h_source.html#l00038">manager.h:38</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae8677b449e49ca86bafee685e8dbe93f" name="ae8677b449e49ca86bafee685e8dbe93f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8677b449e49ca86bafee685e8dbe93f">&#9670;&#160;</a></span>~FitterBase()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">FitterBase::~FitterBase </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor for the <a class="el" href="classFitterBase.html" title="Base class for implementing fitting algorithms.">FitterBase</a> class. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00073">73</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   73</span>                        {</div>
<div class="line"><span class="lineno">   74</span><span class="comment">// *************************</span></div>
<div class="line"><span class="lineno">   75</span>  <a class="code hl_function" href="classFitterBase.html#a418f581b688f035211107ddd83168c08">SaveOutput</a>();</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a> != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>;</div>
<div class="line"><span class="lineno">   78</span>  <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   79</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a>(<span class="stringliteral">&quot;Closing MaCh3 Fitter Engine&quot;</span>);</div>
<div class="line"><span class="lineno">   80</span>}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a4db4657acad5c79ac4bbb66a9d1c5905"><div class="ttname"><a href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a></div><div class="ttdeci">#define MACH3LOG_DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00018">MaCh3Logger.h:18</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a418f581b688f035211107ddd83168c08"><div class="ttname"><a href="classFitterBase.html#a418f581b688f035211107ddd83168c08">FitterBase::SaveOutput</a></div><div class="ttdeci">void SaveOutput()</div><div class="ttdoc">Save output and close files.</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8cpp_source.html#l00212">FitterBase.cpp:212</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="abe93c6d49aa079d811a9021de59691b1" name="abe93c6d49aa079d811a9021de59691b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe93c6d49aa079d811a9021de59691b1">&#9670;&#160;</a></span>addSamplePDF()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitterBase::addSamplePDF </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsamplePDFBase.html">samplePDFBase</a> *&#160;</td>
          <td class="paramname"><em>sample</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function adds a sample PDF object to the analysis framework. The sample PDF object will be utilized in fitting procedures or likelihood scans. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sample</td><td>A pointer to a sample PDF object derived from <a class="el" href="classsamplePDFBase.html" title="Class responsible for handling implementation of samples used in analysis, reweighting and returning ...">samplePDFBase</a>. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00237">237</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  237</span>                                                          {</div>
<div class="line"><span class="lineno">  238</span><span class="comment">// *************************</span></div>
<div class="line"><span class="lineno">  239</span>  <a class="code hl_variable" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a> += sample-&gt;<a class="code hl_function" href="classsamplePDFBase.html#a1d691bd9b033f80ebbce926b46972e97">GetNsamples</a>();</div>
<div class="line"><span class="lineno">  240</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Adding {} object, with {} samples&quot;</span>, sample-&gt;<a class="code hl_function" href="classsamplePDFBase.html#a1d89044c7ad25a5782673075842565de">GetName</a>(), sample-&gt;<a class="code hl_function" href="classsamplePDFBase.html#a1d691bd9b033f80ebbce926b46972e97">GetNsamples</a>());</div>
<div class="line"><span class="lineno">  241</span>  <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.push_back(sample);</div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  244</span>}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a95fa4dffc648e4c5536c9292c2bdcac3"><div class="ttname"><a href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a></div><div class="ttdeci">#define MACH3LOG_INFO</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00019">MaCh3Logger.h:19</a></div></div>
<div class="ttc" id="aclassFitterBase_html_afac0dcceb1df194159c07945e8dc0069"><div class="ttname"><a href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">FitterBase::samples</a></div><div class="ttdeci">std::vector&lt; samplePDFBase * &gt; samples</div><div class="ttdoc">Sample holder.</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00103">FitterBase.h:103</a></div></div>
<div class="ttc" id="aclasssamplePDFBase_html_a1d691bd9b033f80ebbce926b46972e97"><div class="ttname"><a href="classsamplePDFBase.html#a1d691bd9b033f80ebbce926b46972e97">samplePDFBase::GetNsamples</a></div><div class="ttdeci">virtual M3::int_t GetNsamples()</div><div class="ttdef"><b>Definition:</b> <a href="samplePDFBase_8h_source.html#l00037">samplePDFBase.h:37</a></div></div>
<div class="ttc" id="aclasssamplePDFBase_html_a1d89044c7ad25a5782673075842565de"><div class="ttname"><a href="classsamplePDFBase.html#a1d89044c7ad25a5782673075842565de">samplePDFBase::GetName</a></div><div class="ttdeci">virtual std::string GetName() const</div><div class="ttdef"><b>Definition:</b> <a href="samplePDFBase_8h_source.html#l00038">samplePDFBase.h:38</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1d0068193922448a6fed0e0d3ff4305a" name="a1d0068193922448a6fed0e0d3ff4305a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d0068193922448a6fed0e0d3ff4305a">&#9670;&#160;</a></span>addSystObj()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitterBase::addSystObj </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcovarianceBase.html">covarianceBase</a> *&#160;</td>
          <td class="paramname"><em>cov</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function adds a Covariance object to the analysis framework. The Covariance object will be utilized in fitting procedures or likelihood scans. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cov</td><td>A pointer to a Covariance object derived from <a class="el" href="classcovarianceBase.html" title="Base class responsible for handling of systematic error parameters. Capable of using PCA or using ada...">covarianceBase</a>. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00248">248</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  248</span>                                                      {</div>
<div class="line"><span class="lineno">  249</span><span class="comment">// *************************</span></div>
<div class="line"><span class="lineno">  250</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Adding systematic object {}, with {} params&quot;</span>, cov-&gt;<a class="code hl_function" href="group__Setters.html#gafae8445e4cdef85c27c4863adb9e7fe4">getName</a>(), cov-&gt;<a class="code hl_function" href="classcovarianceBase.html#a87f80dff42b1f82433aaa7f69966343a">GetNumParams</a>());</div>
<div class="line"><span class="lineno">  251</span>  <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.push_back(cov);</div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span>  <a class="code hl_variable" href="classFitterBase.html#aacc46437245ba8a9817f2ed2e86a96e0">CovFolder</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  254</span>  std::vector&lt;double&gt; n_vec(cov-&gt;<a class="code hl_function" href="classcovarianceBase.html#a87f80dff42b1f82433aaa7f69966343a">GetNumParams</a>());</div>
<div class="line"><span class="lineno">  255</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; cov-&gt;<a class="code hl_function" href="classcovarianceBase.html#a87f80dff42b1f82433aaa7f69966343a">GetNumParams</a>(); ++i)</div>
<div class="line"><span class="lineno">  256</span>    n_vec[i] = cov-&gt;<a class="code hl_function" href="classcovarianceBase.html#add825b13bf6604725577cb229f8372d8">getParInit</a>(i);</div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span>  TVectorT&lt;double&gt; t_vec(cov-&gt;<a class="code hl_function" href="classcovarianceBase.html#a87f80dff42b1f82433aaa7f69966343a">GetNumParams</a>(), n_vec.data());</div>
<div class="line"><span class="lineno">  259</span>  t_vec.Write((cov-&gt;<a class="code hl_function" href="group__Setters.html#gafae8445e4cdef85c27c4863adb9e7fe4">getName</a>() + <span class="stringliteral">&quot;_prior&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  260</span> </div>
<div class="line"><span class="lineno">  261</span>  cov-&gt;<a class="code hl_function" href="classcovarianceBase.html#a5968a05b1139d72344ea08b8cd6c76c6">getCovMatrix</a>()-&gt;Write(cov-&gt;<a class="code hl_function" href="group__Setters.html#gafae8445e4cdef85c27c4863adb9e7fe4">getName</a>().c_str());</div>
<div class="line"><span class="lineno">  262</span> </div>
<div class="line"><span class="lineno">  263</span>  TH2D* CorrMatrix = cov-&gt;<a class="code hl_function" href="classcovarianceBase.html#ac14fabdb87f5101cdbfcecb8e6b6b811">GetCorrelationMatrix</a>();</div>
<div class="line"><span class="lineno">  264</span>  CorrMatrix-&gt;Write((cov-&gt;<a class="code hl_function" href="group__Setters.html#gafae8445e4cdef85c27c4863adb9e7fe4">getName</a>() + std::string(<span class="stringliteral">&quot;_Corr&quot;</span>)).c_str());</div>
<div class="line"><span class="lineno">  265</span>  <span class="keyword">delete</span> CorrMatrix;</div>
<div class="line"><span class="lineno">  266</span> </div>
<div class="line"><span class="lineno">  267</span>  <span class="comment">// If we have yaml config file for covariance let&#39;s save it</span></div>
<div class="line"><span class="lineno">  268</span>  YAML::Node Config = cov-&gt;<a class="code hl_function" href="classcovarianceBase.html#a61936f5c39ad7902624222fc49ad1362">GetConfig</a>();</div>
<div class="line"><span class="lineno">  269</span>  <span class="keywordflow">if</span>(!Config.IsNull())</div>
<div class="line"><span class="lineno">  270</span>  {</div>
<div class="line"><span class="lineno">  271</span>    TMacro ConfigSave = <a class="code hl_function" href="YamlHelper_8h.html#a2d4f3247b6e13ef8c127ff66e699d3cb">YAMLtoTMacro</a>(Config, (std::string(<span class="stringliteral">&quot;Config_&quot;</span>) + cov-&gt;<a class="code hl_function" href="group__Setters.html#gafae8445e4cdef85c27c4863adb9e7fe4">getName</a>()));</div>
<div class="line"><span class="lineno">  272</span>    ConfigSave.Write();</div>
<div class="line"><span class="lineno">  273</span>  }</div>
<div class="line"><span class="lineno">  274</span> </div>
<div class="line"><span class="lineno">  275</span>  <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  276</span> </div>
<div class="line"><span class="lineno">  277</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  278</span>}</div>
<div class="ttc" id="aYamlHelper_8h_html_a2d4f3247b6e13ef8c127ff66e699d3cb"><div class="ttname"><a href="YamlHelper_8h.html#a2d4f3247b6e13ef8c127ff66e699d3cb">YAMLtoTMacro</a></div><div class="ttdeci">TMacro YAMLtoTMacro(const YAML::Node &amp;yaml_node, const std::string &amp;name)</div><div class="ttdoc">Convert a YAML node to a ROOT TMacro object.</div><div class="ttdef"><b>Definition:</b> <a href="YamlHelper_8h_source.html#l00163">YamlHelper.h:163</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a3a15d2348b7bf0a639aaab52b9294bbf"><div class="ttname"><a href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">FitterBase::systematics</a></div><div class="ttdeci">std::vector&lt; covarianceBase * &gt; systematics</div><div class="ttdoc">Systematic holder.</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00108">FitterBase.h:108</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a5968a05b1139d72344ea08b8cd6c76c6"><div class="ttname"><a href="classcovarianceBase.html#a5968a05b1139d72344ea08b8cd6c76c6">covarianceBase::getCovMatrix</a></div><div class="ttdeci">TMatrixDSym * getCovMatrix()</div><div class="ttdoc">Return covariance matrix.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00133">covarianceBase.h:133</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a61936f5c39ad7902624222fc49ad1362"><div class="ttname"><a href="classcovarianceBase.html#a61936f5c39ad7902624222fc49ad1362">covarianceBase::GetConfig</a></div><div class="ttdeci">YAML::Node GetConfig() const</div><div class="ttdoc">Getter to return a copy of the YAML node.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00395">covarianceBase.h:395</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a87f80dff42b1f82433aaa7f69966343a"><div class="ttname"><a href="classcovarianceBase.html#a87f80dff42b1f82433aaa7f69966343a">covarianceBase::GetNumParams</a></div><div class="ttdeci">int GetNumParams() const</div><div class="ttdoc">Get total number of parameters.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00223">covarianceBase.h:223</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_ac14fabdb87f5101cdbfcecb8e6b6b811"><div class="ttname"><a href="classcovarianceBase.html#ac14fabdb87f5101cdbfcecb8e6b6b811">covarianceBase::GetCorrelationMatrix</a></div><div class="ttdeci">TH2D * GetCorrelationMatrix()</div><div class="ttdoc">KS: Convert covariance matrix to correlation matrix and return TH2D which can be used for fancy plott...</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8cpp_source.html#l01257">covarianceBase.cpp:1257</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_add825b13bf6604725577cb229f8372d8"><div class="ttname"><a href="classcovarianceBase.html#add825b13bf6604725577cb229f8372d8">covarianceBase::getParInit</a></div><div class="ttdeci">double getParInit(const int i) const</div><div class="ttdoc">Get prior parameter value.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00240">covarianceBase.h:240</a></div></div>
<div class="ttc" id="agroup__Setters_html_gafae8445e4cdef85c27c4863adb9e7fe4"><div class="ttname"><a href="group__Setters.html#gafae8445e4cdef85c27c4863adb9e7fe4">covarianceBase::getName</a></div><div class="ttdeci">std::string getName() const</div><div class="ttdoc">Get name of covariance.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00149">covarianceBase.h:149</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab3db1d0bb7364e70cd432a3e1c0a600e" name="ab3db1d0bb7364e70cd432a3e1c0a600e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3db1d0bb7364e70cd432a3e1c0a600e">&#9670;&#160;</a></span>DragRace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitterBase::DragRace </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>NLaps</em> = <code>100</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the required time for each sample or covariance object in a drag race simulation. Inspired by Dan's feature. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">NLaps</td><td>number of laps, every part of Fitter will be tested with given number of laps and you will get total and average time </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00399">399</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  399</span>                                         {</div>
<div class="line"><span class="lineno">  400</span><span class="comment">// *************************</span></div>
<div class="line"><span class="lineno">  401</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Let the Race Begin!&quot;</span>);</div>
<div class="line"><span class="lineno">  402</span>  <span class="comment">// Reweight the MC</span></div>
<div class="line"><span class="lineno">  403</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivs = 0; ivs &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ivs++ )</div>
<div class="line"><span class="lineno">  404</span>  {</div>
<div class="line"><span class="lineno">  405</span>    TStopwatch clockRace;</div>
<div class="line"><span class="lineno">  406</span>    clockRace.Start();</div>
<div class="line"><span class="lineno">  407</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> Lap = 0; Lap &lt; NLaps; Lap++) {</div>
<div class="line"><span class="lineno">  408</span>      <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;reweight();</div>
<div class="line"><span class="lineno">  409</span>    }</div>
<div class="line"><span class="lineno">  410</span>    clockRace.Stop();</div>
<div class="line"><span class="lineno">  411</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;It took {:.4f} s to reweights {} times sample: {}&quot;</span>, clockRace.RealTime(), NLaps, <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;GetName());</div>
<div class="line"><span class="lineno">  412</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;On average {:.6f}&quot;</span>, clockRace.RealTime()/NLaps);</div>
<div class="line"><span class="lineno">  413</span>  }</div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivs = 0; ivs &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ivs++ )</div>
<div class="line"><span class="lineno">  416</span>  {</div>
<div class="line"><span class="lineno">  417</span>    TStopwatch clockRace;</div>
<div class="line"><span class="lineno">  418</span>    clockRace.Start();</div>
<div class="line"><span class="lineno">  419</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> Lap = 0; Lap &lt; NLaps; Lap++) {</div>
<div class="line"><span class="lineno">  420</span>      <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;GetLikelihood();</div>
<div class="line"><span class="lineno">  421</span>    }</div>
<div class="line"><span class="lineno">  422</span>    clockRace.Stop();</div>
<div class="line"><span class="lineno">  423</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;It took {:.4f} s to calculate  GetLikelihood {} times sample:  {}&quot;</span>, clockRace.RealTime(), NLaps, <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;GetName());</div>
<div class="line"><span class="lineno">  424</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;On average {:.6f}&quot;</span>, clockRace.RealTime()/NLaps);</div>
<div class="line"><span class="lineno">  425</span>  }</div>
<div class="line"><span class="lineno">  426</span>  <span class="comment">// Get vector of proposed steps. If we want to run LLH scan or something else after we need to revert changes after proposing steps multiple times</span></div>
<div class="line"><span class="lineno">  427</span>  std::vector&lt;std::vector&lt;double&gt;&gt; StepsValuesBefore(<a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size());</div>
<div class="line"><span class="lineno">  428</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> s = 0; s &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); ++s) {</div>
<div class="line"><span class="lineno">  429</span>    StepsValuesBefore[s] = <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[s]-&gt;getProposed();</div>
<div class="line"><span class="lineno">  430</span>  }</div>
<div class="line"><span class="lineno">  431</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> s = 0; s &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); ++s) {</div>
<div class="line"><span class="lineno">  432</span>    TStopwatch clockRace;</div>
<div class="line"><span class="lineno">  433</span>    clockRace.Start();</div>
<div class="line"><span class="lineno">  434</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> Lap = 0; Lap &lt; NLaps; Lap++) {</div>
<div class="line"><span class="lineno">  435</span>      <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[s]-&gt;proposeStep();</div>
<div class="line"><span class="lineno">  436</span>    }</div>
<div class="line"><span class="lineno">  437</span>    clockRace.Stop();</div>
<div class="line"><span class="lineno">  438</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;It took {:.4f} s to propose step {} times cov:  {}&quot;</span>,  clockRace.RealTime(), NLaps, <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[s]-&gt;getName());</div>
<div class="line"><span class="lineno">  439</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;On average {:.6f}&quot;</span>, clockRace.RealTime()/NLaps);</div>
<div class="line"><span class="lineno">  440</span>  }</div>
<div class="line"><span class="lineno">  441</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> s = 0; s &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); ++s) {</div>
<div class="line"><span class="lineno">  442</span>    <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[s]-&gt;setParameters(StepsValuesBefore[s]);</div>
<div class="line"><span class="lineno">  443</span>  }</div>
<div class="line"><span class="lineno">  444</span> </div>
<div class="line"><span class="lineno">  445</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> s = 0; s &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); ++s) {</div>
<div class="line"><span class="lineno">  446</span>    TStopwatch clockRace;</div>
<div class="line"><span class="lineno">  447</span>    clockRace.Start();</div>
<div class="line"><span class="lineno">  448</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> Lap = 0; Lap &lt; NLaps; Lap++) {</div>
<div class="line"><span class="lineno">  449</span>      <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[s]-&gt;GetLikelihood();</div>
<div class="line"><span class="lineno">  450</span>    }</div>
<div class="line"><span class="lineno">  451</span>    clockRace.Stop();</div>
<div class="line"><span class="lineno">  452</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;It took {:.4f} s to calculate  get likelihood {} times cov:  {}&quot;</span>,  clockRace.RealTime(), NLaps, <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[s]-&gt;getName());</div>
<div class="line"><span class="lineno">  453</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;On average {:.6f}&quot;</span>, clockRace.RealTime()/NLaps);</div>
<div class="line"><span class="lineno">  454</span>  }</div>
<div class="line"><span class="lineno">  455</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;End of race&quot;</span>);</div>
<div class="line"><span class="lineno">  456</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3706f6d722073b447b3de8c3a6516601" name="a3706f6d722073b447b3de8c3a6516601"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3706f6d722073b447b3de8c3a6516601">&#9670;&#160;</a></span>GetName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::string FitterBase::GetName </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get name of class. </p>

<p>Reimplemented in <a class="el" href="classLikelihoodFit.html#aff5ac0361aa016cebb24d4687e0da4ac">LikelihoodFit</a>, <a class="el" href="classmcmc.html#a0446e3c1f2af2173ffd6f017fdf6f1ba">mcmc</a>, <a class="el" href="classMinuitFit.html#a21eb79a3aa06baf99b0e5bd86e9d5c7c">MinuitFit</a>, <a class="el" href="classPSO.html#a95d9cbbfdcdc4d453254a3b1477cbbab">PSO</a>, and <a class="el" href="classPyFitterBase.html#ac83e7d3ecb68e2eca466374d8636f7df">PyFitterBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00066">66</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   66</span>{<span class="keywordflow">return</span> <span class="stringliteral">&quot;FitterBase&quot;</span>;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a63820450a9089d5281769288c007db55" name="a63820450a9089d5281769288c007db55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63820450a9089d5281769288c007db55">&#9670;&#160;</a></span>GetStepScaleBasedOnLLHScan()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitterBase::GetStepScaleBasedOnLLHScan </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>LLH scan is good first estimate of step scale. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00784">784</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  784</span>                                            {</div>
<div class="line"><span class="lineno">  785</span><span class="comment">// *************************</span></div>
<div class="line"><span class="lineno">  786</span>  TDirectory *Sample_LLH = <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;Get&lt;TDirectory&gt;(<span class="stringliteral">&quot;Sample_LLH&quot;</span>);</div>
<div class="line"><span class="lineno">  787</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Starting Get Step Scale Based On LLHScan&quot;</span>);</div>
<div class="line"><span class="lineno">  788</span> </div>
<div class="line"><span class="lineno">  789</span>  <span class="keywordflow">if</span>(Sample_LLH-&gt;IsZombie())</div>
<div class="line"><span class="lineno">  790</span>  {</div>
<div class="line"><span class="lineno">  791</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Couldn&#39;t find Sample_LLH, it looks like LLH scan wasn&#39;t run, will do this now&quot;</span>);</div>
<div class="line"><span class="lineno">  792</span>    <a class="code hl_function" href="classFitterBase.html#a018e8d09a62bca19840e1321b49df2c0">RunLLHScan</a>();</div>
<div class="line"><span class="lineno">  793</span>  }</div>
<div class="line"><span class="lineno">  794</span> </div>
<div class="line"><span class="lineno">  795</span>  <span class="keywordflow">for</span> (<a class="code hl_class" href="classcovarianceBase.html">covarianceBase</a> *cov : <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>)</div>
<div class="line"><span class="lineno">  796</span>  {</div>
<div class="line"><span class="lineno">  797</span>    <span class="keywordtype">bool</span> isxsec = (cov-&gt;getName() == <span class="stringliteral">&quot;xsec_cov&quot;</span>);</div>
<div class="line"><span class="lineno">  798</span> </div>
<div class="line"><span class="lineno">  799</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> npars = cov-&gt;GetNumParams();</div>
<div class="line"><span class="lineno">  800</span>    std::vector&lt;double&gt; StepScale(npars);</div>
<div class="line"><span class="lineno">  801</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; npars; ++i)</div>
<div class="line"><span class="lineno">  802</span>    {</div>
<div class="line"><span class="lineno">  803</span>      std::string name = cov-&gt;GetParName(i);</div>
<div class="line"><span class="lineno">  804</span>      <span class="comment">// For xsec we can get the actual name, hurray for being informative</span></div>
<div class="line"><span class="lineno">  805</span>      <span class="keywordflow">if</span> (isxsec) name = cov-&gt;GetParFancyName(i);</div>
<div class="line"><span class="lineno">  806</span> </div>
<div class="line"><span class="lineno">  807</span> </div>
<div class="line"><span class="lineno">  808</span>      StepScale[i] = cov-&gt;GetIndivStepScale(i);</div>
<div class="line"><span class="lineno">  809</span>      TH1D* LLHScan = Sample_LLH-&gt;Get&lt;TH1D&gt;((name+<span class="stringliteral">&quot;_sam&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  810</span>      <span class="keywordflow">if</span>(LLHScan == <span class="keyword">nullptr</span>)</div>
<div class="line"><span class="lineno">  811</span>      {</div>
<div class="line"><span class="lineno">  812</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Couldn&#39;t find LLH scan, for {}, skipping&quot;</span>, name);</div>
<div class="line"><span class="lineno">  813</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  814</span>      }</div>
<div class="line"><span class="lineno">  815</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> LLH_val = std::max(LLHScan-&gt;GetBinContent(1), LLHScan-&gt;GetBinContent(LLHScan-&gt;GetNbinsX()));</div>
<div class="line"><span class="lineno">  816</span>      <span class="comment">//If there is no sensitivity leave it</span></div>
<div class="line"><span class="lineno">  817</span>      <span class="keywordflow">if</span>(LLH_val &lt; 0.001) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  818</span> </div>
<div class="line"><span class="lineno">  819</span>      <span class="comment">// EM: assuming that the likelihood is gaussian, approximate sigma value is given by variation/sqrt(-2LLH)</span></div>
<div class="line"><span class="lineno">  820</span>      <span class="comment">// can evaluate this at any point, simple to evaluate it in the first bin of the LLH scan</span></div>
<div class="line"><span class="lineno">  821</span>      <span class="comment">// KS: We assume variation is 1 sigma, each dial has different scale so it becomes faff...</span></div>
<div class="line"><span class="lineno">  822</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> Var = 1.;</div>
<div class="line"><span class="lineno">  823</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> approxSigma = TMath::Abs(Var)/std::sqrt(LLH_val);</div>
<div class="line"><span class="lineno">  824</span> </div>
<div class="line"><span class="lineno">  825</span>      <span class="comment">// Based on Ewan comment I just took the 1sigma width from the LLH, assuming it was Gaussian, but then had to also scale by 2.38/sqrt(N_params)</span></div>
<div class="line"><span class="lineno">  826</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> NewStepScale = approxSigma * 2.38/std::sqrt(npars);</div>
<div class="line"><span class="lineno">  827</span>      StepScale[i] = NewStepScale;</div>
<div class="line"><span class="lineno">  828</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a>(<span class="stringliteral">&quot;Sigma: {}&quot;</span>, approxSigma);</div>
<div class="line"><span class="lineno">  829</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a>(<span class="stringliteral">&quot;optimal Step Size: {}&quot;</span>, NewStepScale);</div>
<div class="line"><span class="lineno">  830</span>    }</div>
<div class="line"><span class="lineno">  831</span>    cov-&gt;setIndivStepScale(StepScale);</div>
<div class="line"><span class="lineno">  832</span>    cov-&gt;SaveUpdatedMatrixConfig();</div>
<div class="line"><span class="lineno">  833</span>  }</div>
<div class="line"><span class="lineno">  834</span>}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_ad5b2eb6377721e3ac95def22c2386bb1"><div class="ttname"><a href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a></div><div class="ttdeci">#define MACH3LOG_WARN</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00020">MaCh3Logger.h:20</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a018e8d09a62bca19840e1321b49df2c0"><div class="ttname"><a href="classFitterBase.html#a018e8d09a62bca19840e1321b49df2c0">FitterBase::RunLLHScan</a></div><div class="ttdeci">void RunLLHScan()</div><div class="ttdoc">Perform a 1D likelihood scan.</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8cpp_source.html#l00460">FitterBase.cpp:460</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html"><div class="ttname"><a href="classcovarianceBase.html">covarianceBase</a></div><div class="ttdoc">Base class responsible for handling of systematic error parameters. Capable of using PCA or using ada...</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00018">covarianceBase.h:18</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a53715760edd8c7640432f31793fd28f9" name="a53715760edd8c7640432f31793fd28f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53715760edd8c7640432f31793fd28f9">&#9670;&#160;</a></span>PrepareOutput()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void FitterBase::PrepareOutput </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prepare the output file. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00149">149</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  149</span>                               {</div>
<div class="line"><span class="lineno">  150</span><span class="comment">// *******************</span></div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classFitterBase.html#a3bfd8f69df891d03bae0587cd1a1e1b7">OutputPrepared</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  153</span>  <span class="comment">//MS: Check if we are fitting the test likelihood, rather than T2K likelihood, and only setup T2K output if not</span></div>
<div class="line"><span class="lineno">  154</span>  <span class="keywordflow">if</span>(!<a class="code hl_variable" href="classFitterBase.html#ada898e35bab22af470f2cd1e28af609b">fTestLikelihood</a>)</div>
<div class="line"><span class="lineno">  155</span>  {</div>
<div class="line"><span class="lineno">  156</span>    <span class="comment">// Check that we have added samples</span></div>
<div class="line"><span class="lineno">  157</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size()) {</div>
<div class="line"><span class="lineno">  158</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a07ff6d6a15b24f94afc88a1b89779beb">MACH3LOG_CRITICAL</a>(<span class="stringliteral">&quot;No samples Found! Is this really what you wanted?&quot;</span>);</div>
<div class="line"><span class="lineno">  159</span>      <span class="comment">//throw MaCh3Exception(__FILE__ , __LINE__ );</span></div>
<div class="line"><span class="lineno">  160</span>    }</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>    <span class="comment">// Prepare the output trees</span></div>
<div class="line"><span class="lineno">  163</span>    <span class="keywordflow">for</span> (<a class="code hl_class" href="classcovarianceBase.html">covarianceBase</a> *cov : <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>) {</div>
<div class="line"><span class="lineno">  164</span>      cov-&gt;SetBranches(*<a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>, <a class="code hl_variable" href="classFitterBase.html#a490b8614c4089c6db10ff357e7aaab67">SaveProposal</a>);</div>
<div class="line"><span class="lineno">  165</span>    }</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>    <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>-&gt;Branch(<span class="stringliteral">&quot;LogL&quot;</span>, &amp;<a class="code hl_variable" href="classFitterBase.html#abfb6f10720764d8bbbe43754fd5cd976">logLCurr</a>, <span class="stringliteral">&quot;LogL/D&quot;</span>);</div>
<div class="line"><span class="lineno">  168</span>    <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>-&gt;Branch(<span class="stringliteral">&quot;accProb&quot;</span>, &amp;<a class="code hl_variable" href="classFitterBase.html#a6319d2ea50984860475bbc6c708b0d90">accProb</a>, <span class="stringliteral">&quot;accProb/D&quot;</span>);</div>
<div class="line"><span class="lineno">  169</span>    <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>-&gt;Branch(<span class="stringliteral">&quot;step&quot;</span>, &amp;<a class="code hl_variable" href="classFitterBase.html#a50df1bd75b20a953f81ab9c2bab6b42c">step</a>, <span class="stringliteral">&quot;step/I&quot;</span>);</div>
<div class="line"><span class="lineno">  170</span>    <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>-&gt;Branch(<span class="stringliteral">&quot;stepTime&quot;</span>, &amp;<a class="code hl_variable" href="classFitterBase.html#a8354e9a7a9cc534277ff76ab37c9a763">stepTime</a>, <span class="stringliteral">&quot;stepTime/D&quot;</span>);</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>    <span class="comment">// Store individual likelihood components</span></div>
<div class="line"><span class="lineno">  173</span>    <span class="comment">// Using double means double as large output file!</span></div>
<div class="line"><span class="lineno">  174</span>    <a class="code hl_variable" href="classFitterBase.html#a6f435e161c96eea778aba844115428d4">sample_llh</a>.resize(<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size());</div>
<div class="line"><span class="lineno">  175</span>    <a class="code hl_variable" href="classFitterBase.html#ace2eeca9829f63200c3f956c600d09ff">syst_llh</a>.resize(<a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size());</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ++i) {</div>
<div class="line"><span class="lineno">  178</span>      std::stringstream oss, oss2;</div>
<div class="line"><span class="lineno">  179</span>      oss &lt;&lt; <span class="stringliteral">&quot;LogL_sample_&quot;</span> &lt;&lt; i;</div>
<div class="line"><span class="lineno">  180</span>      oss2 &lt;&lt; oss.str() &lt;&lt; <span class="stringliteral">&quot;/D&quot;</span>;</div>
<div class="line"><span class="lineno">  181</span>      <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>-&gt;Branch(oss.str().c_str(), &amp;<a class="code hl_variable" href="classFitterBase.html#a6f435e161c96eea778aba844115428d4">sample_llh</a>[i], oss2.str().c_str());</div>
<div class="line"><span class="lineno">  182</span>    }</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); ++i) {</div>
<div class="line"><span class="lineno">  185</span>      std::stringstream oss, oss2;</div>
<div class="line"><span class="lineno">  186</span>      oss &lt;&lt; <span class="stringliteral">&quot;LogL_systematic_&quot;</span> &lt;&lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[i]-&gt;getName();</div>
<div class="line"><span class="lineno">  187</span>      oss2 &lt;&lt; oss.str() &lt;&lt; <span class="stringliteral">&quot;/D&quot;</span>;</div>
<div class="line"><span class="lineno">  188</span>      <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>-&gt;Branch(oss.str().c_str(), &amp;<a class="code hl_variable" href="classFitterBase.html#ace2eeca9829f63200c3f956c600d09ff">syst_llh</a>[i], oss2.str().c_str());</div>
<div class="line"><span class="lineno">  189</span>    }</div>
<div class="line"><span class="lineno">  190</span>  }</div>
<div class="line"><span class="lineno">  191</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  192</span>  {</div>
<div class="line"><span class="lineno">  193</span>    <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>-&gt;Branch(<span class="stringliteral">&quot;LogL&quot;</span>, &amp;<a class="code hl_variable" href="classFitterBase.html#abfb6f10720764d8bbbe43754fd5cd976">logLCurr</a>, <span class="stringliteral">&quot;LogL/D&quot;</span>);</div>
<div class="line"><span class="lineno">  194</span>    <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>-&gt;Branch(<span class="stringliteral">&quot;accProb&quot;</span>, &amp;<a class="code hl_variable" href="classFitterBase.html#a6319d2ea50984860475bbc6c708b0d90">accProb</a>, <span class="stringliteral">&quot;accProb/D&quot;</span>);</div>
<div class="line"><span class="lineno">  195</span>    <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>-&gt;Branch(<span class="stringliteral">&quot;step&quot;</span>, &amp;<a class="code hl_variable" href="classFitterBase.html#a50df1bd75b20a953f81ab9c2bab6b42c">step</a>, <span class="stringliteral">&quot;step/I&quot;</span>);</div>
<div class="line"><span class="lineno">  196</span>    <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>-&gt;Branch(<span class="stringliteral">&quot;stepTime&quot;</span>, &amp;<a class="code hl_variable" href="classFitterBase.html#a8354e9a7a9cc534277ff76ab37c9a763">stepTime</a>, <span class="stringliteral">&quot;stepTime/D&quot;</span>);</div>
<div class="line"><span class="lineno">  197</span>  }</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;-------------------- Starting MCMC --------------------&quot;</span>);</div>
<div class="line"><span class="lineno">  200</span><span class="preprocessor">  #ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  201</span>  <span class="keywordflow">if</span> (debug) {</div>
<div class="line"><span class="lineno">  202</span>    debugFile &lt;&lt; <span class="stringliteral">&quot;----- Starting MCMC -----&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  203</span>  }</div>
<div class="line"><span class="lineno">  204</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  205</span>  <span class="comment">// Time the progress</span></div>
<div class="line"><span class="lineno">  206</span>  <a class="code hl_variable" href="classFitterBase.html#a858edb45544f690e90b60b9e041394a6">clock</a>-&gt;Start();</div>
<div class="line"><span class="lineno">  207</span> </div>
<div class="line"><span class="lineno">  208</span>  <a class="code hl_variable" href="classFitterBase.html#a3bfd8f69df891d03bae0587cd1a1e1b7">OutputPrepared</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  209</span>}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a07ff6d6a15b24f94afc88a1b89779beb"><div class="ttname"><a href="MaCh3Logger_8h.html#a07ff6d6a15b24f94afc88a1b89779beb">MACH3LOG_CRITICAL</a></div><div class="ttdeci">#define MACH3LOG_CRITICAL</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00022">MaCh3Logger.h:22</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a6319d2ea50984860475bbc6c708b0d90"><div class="ttname"><a href="classFitterBase.html#a6319d2ea50984860475bbc6c708b0d90">FitterBase::accProb</a></div><div class="ttdeci">double accProb</div><div class="ttdoc">current acceptance prob</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00093">FitterBase.h:93</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a6f435e161c96eea778aba844115428d4"><div class="ttname"><a href="classFitterBase.html#a6f435e161c96eea778aba844115428d4">FitterBase::sample_llh</a></div><div class="ttdeci">std::vector&lt; double &gt; sample_llh</div><div class="ttdoc">store the llh breakdowns</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00098">FitterBase.h:98</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a8354e9a7a9cc534277ff76ab37c9a763"><div class="ttname"><a href="classFitterBase.html#a8354e9a7a9cc534277ff76ab37c9a763">FitterBase::stepTime</a></div><div class="ttdeci">double stepTime</div><div class="ttdoc">Time of single step.</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00115">FitterBase.h:115</a></div></div>
<div class="ttc" id="aclassFitterBase_html_abfb6f10720764d8bbbe43754fd5cd976"><div class="ttname"><a href="classFitterBase.html#abfb6f10720764d8bbbe43754fd5cd976">FitterBase::logLCurr</a></div><div class="ttdeci">double logLCurr</div><div class="ttdoc">current likelihood</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00089">FitterBase.h:89</a></div></div>
<div class="ttc" id="aclassFitterBase_html_ace2eeca9829f63200c3f956c600d09ff"><div class="ttname"><a href="classFitterBase.html#ace2eeca9829f63200c3f956c600d09ff">FitterBase::syst_llh</a></div><div class="ttdeci">std::vector&lt; double &gt; syst_llh</div><div class="ttdoc">systematic llh breakdowns</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00100">FitterBase.h:100</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1dccdac8611e70c759c47a65f2b1aea7" name="a1dccdac8611e70c759c47a65f2b1aea7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dccdac8611e70c759c47a65f2b1aea7">&#9670;&#160;</a></span>ProcessMCMC()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void FitterBase::ProcessMCMC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process MCMC output. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00351">351</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  351</span>                             {</div>
<div class="line"><span class="lineno">  352</span><span class="comment">// *******************</span></div>
<div class="line"><span class="lineno">  353</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a> == <span class="keyword">nullptr</span>) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  354</span> </div>
<div class="line"><span class="lineno">  355</span>  <span class="comment">// Process the MCMC</span></div>
<div class="line"><span class="lineno">  356</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;ProcessMCMC&quot;</span>].as&lt;<span class="keywordtype">bool</span>&gt;()) {</div>
<div class="line"><span class="lineno">  357</span> </div>
<div class="line"><span class="lineno">  358</span>    <span class="comment">// Make the processor</span></div>
<div class="line"><span class="lineno">  359</span>    <a class="code hl_class" href="classMCMCProcessor.html">MCMCProcessor</a> Processor(std::string(<a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;GetName()));</div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span>    Processor.Initialise();</div>
<div class="line"><span class="lineno">  362</span>    <span class="comment">// Make the TVectorD pointers which hold the processed output</span></div>
<div class="line"><span class="lineno">  363</span>    TVectorD *Central = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  364</span>    TVectorD *Errors = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  365</span>    TVectorD *Central_Gauss = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  366</span>    TVectorD *Errors_Gauss = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  367</span>    TVectorD *Peaks = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  368</span> </div>
<div class="line"><span class="lineno">  369</span>    <span class="comment">// Make the postfit</span></div>
<div class="line"><span class="lineno">  370</span>    Processor.GetPostfit(Central, Errors, Central_Gauss, Errors_Gauss, Peaks);</div>
<div class="line"><span class="lineno">  371</span>    Processor.DrawPostfit();</div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span>    <span class="comment">// Make the TMatrix pointers which hold the processed output</span></div>
<div class="line"><span class="lineno">  374</span>    TMatrixDSym *Covariance = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  375</span>    TMatrixDSym *Correlation = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span>    <span class="comment">// Make the covariance matrix</span></div>
<div class="line"><span class="lineno">  378</span>    Processor.GetCovariance(Covariance, Correlation);</div>
<div class="line"><span class="lineno">  379</span>    Processor.DrawCovariance();</div>
<div class="line"><span class="lineno">  380</span> </div>
<div class="line"><span class="lineno">  381</span>    std::vector&lt;TString&gt; <a class="code hl_variable" href="GetPenaltyTerm_8cpp.html#a871d6466cea2597401bdb203293f4033">BranchNames</a> = Processor.GetBranchNames();</div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span>    <span class="comment">// Re-open the TFile</span></div>
<div class="line"><span class="lineno">  384</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;IsOpen()) {</div>
<div class="line"><span class="lineno">  385</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Opening output again to update with means..&quot;</span>);</div>
<div class="line"><span class="lineno">  386</span>      <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a> = <span class="keyword">new</span> TFile(<a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;Output&quot;</span>][<span class="stringliteral">&quot;Filename&quot;</span>].as&lt;std::string&gt;().c_str(), <span class="stringliteral">&quot;UPDATE&quot;</span>);</div>
<div class="line"><span class="lineno">  387</span>    }</div>
<div class="line"><span class="lineno">  388</span>    Central-&gt;Write(<span class="stringliteral">&quot;PDF_Means&quot;</span>);</div>
<div class="line"><span class="lineno">  389</span>    Errors-&gt;Write(<span class="stringliteral">&quot;PDF_Errors&quot;</span>);</div>
<div class="line"><span class="lineno">  390</span>    Central_Gauss-&gt;Write(<span class="stringliteral">&quot;Gauss_Means&quot;</span>);</div>
<div class="line"><span class="lineno">  391</span>    Errors_Gauss-&gt;Write(<span class="stringliteral">&quot;Errors_Gauss&quot;</span>);</div>
<div class="line"><span class="lineno">  392</span>    Covariance-&gt;Write(<span class="stringliteral">&quot;Covariance&quot;</span>);</div>
<div class="line"><span class="lineno">  393</span>    Correlation-&gt;Write(<span class="stringliteral">&quot;Correlation&quot;</span>);</div>
<div class="line"><span class="lineno">  394</span>  }</div>
<div class="line"><span class="lineno">  395</span>}</div>
<div class="ttc" id="aGetPenaltyTerm_8cpp_html_a871d6466cea2597401bdb203293f4033"><div class="ttname"><a href="GetPenaltyTerm_8cpp.html#a871d6466cea2597401bdb203293f4033">BranchNames</a></div><div class="ttdeci">std::vector&lt; TString &gt; BranchNames</div><div class="ttdef"><b>Definition:</b> <a href="GetPenaltyTerm_8cpp_source.html#l00044">GetPenaltyTerm.cpp:44</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html"><div class="ttname"><a href="classMCMCProcessor.html">MCMCProcessor</a></div><div class="ttdoc">Class responsible for processing MCMC chains, performing diagnostics, generating plots,...</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00071">MCMCProcessor.h:71</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab8b32ca268c20dd643eaf92dae04cd0a" name="ab8b32ca268c20dd643eaf92dae04cd0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8b32ca268c20dd643eaf92dae04cd0a">&#9670;&#160;</a></span>Run2DLLHScan()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitterBase::Run2DLLHScan </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform a 2D likelihood scan. </p>
<dl class="section warning"><dt>Warning</dt><dd>This operation may take a significant amount of time, especially for complex models. </dd></dl>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00838">838</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  838</span>                              {</div>
<div class="line"><span class="lineno">  839</span><span class="comment">// *************************</span></div>
<div class="line"><span class="lineno">  840</span> </div>
<div class="line"><span class="lineno">  841</span>  <span class="comment">// Save the settings into the output file</span></div>
<div class="line"><span class="lineno">  842</span>  <a class="code hl_function" href="classFitterBase.html#a48f38bfa8996fe00d51f35b05dd16b46">SaveSettings</a>();</div>
<div class="line"><span class="lineno">  843</span> </div>
<div class="line"><span class="lineno">  844</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Starting 2D LLH Scan&quot;</span>);</div>
<div class="line"><span class="lineno">  845</span> </div>
<div class="line"><span class="lineno">  846</span>  TDirectory *Sample_2DLLH = <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Sample_2DLLH&quot;</span>);</div>
<div class="line"><span class="lineno">  847</span>  std::vector&lt;std::string&gt; SkipVector;</div>
<div class="line"><span class="lineno">  848</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;LLHScanSkipVector&quot;</span>])</div>
<div class="line"><span class="lineno">  849</span>  {</div>
<div class="line"><span class="lineno">  850</span>    SkipVector = <a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;LLHScanSkipVector&quot;</span>].as&lt;std::vector&lt;std::string&gt;&gt;();</div>
<div class="line"><span class="lineno">  851</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Found skip vector with {} entries&quot;</span>, SkipVector.size());</div>
<div class="line"><span class="lineno">  852</span>  }</div>
<div class="line"><span class="lineno">  853</span> </div>
<div class="line"><span class="lineno">  854</span>  <span class="comment">// Number of points we do for each LLH scan</span></div>
<div class="line"><span class="lineno">  855</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> n_points = 20;</div>
<div class="line"><span class="lineno">  856</span>  <span class="comment">// We print 5 reweights</span></div>
<div class="line"><span class="lineno">  857</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> countwidth = double(n_points)/double(5);</div>
<div class="line"><span class="lineno">  858</span> </div>
<div class="line"><span class="lineno">  859</span>  <span class="keywordtype">bool</span> isxsec = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  860</span>  <span class="comment">// Loop over the covariance classes</span></div>
<div class="line"><span class="lineno">  861</span>  <span class="keywordflow">for</span> (<a class="code hl_class" href="classcovarianceBase.html">covarianceBase</a> *cov : <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>)</div>
<div class="line"><span class="lineno">  862</span>  {</div>
<div class="line"><span class="lineno">  863</span>    <span class="keywordflow">if</span> (cov-&gt;getName() == <span class="stringliteral">&quot;xsec_cov&quot;</span>)</div>
<div class="line"><span class="lineno">  864</span>    {</div>
<div class="line"><span class="lineno">  865</span>      isxsec = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  866</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  867</span>      isxsec = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  868</span>    }</div>
<div class="line"><span class="lineno">  869</span>    <span class="comment">// Scan over all the parameters</span></div>
<div class="line"><span class="lineno">  870</span>    <span class="comment">// Get the number of parameters</span></div>
<div class="line"><span class="lineno">  871</span>    <span class="keywordtype">int</span> npars = cov-&gt;GetNumParams();</div>
<div class="line"><span class="lineno">  872</span>    <span class="keywordtype">bool</span> IsPCA = cov-&gt;IsPCA();</div>
<div class="line"><span class="lineno">  873</span>    <span class="keywordflow">if</span> (IsPCA) npars = cov-&gt;getNpars();</div>
<div class="line"><span class="lineno">  874</span> </div>
<div class="line"><span class="lineno">  875</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; npars; ++i)</div>
<div class="line"><span class="lineno">  876</span>    {</div>
<div class="line"><span class="lineno">  877</span>      std::string name_x = cov-&gt;GetParName(i);</div>
<div class="line"><span class="lineno">  878</span>      <span class="keywordflow">if</span> (IsPCA) name_x += <span class="stringliteral">&quot;_PCA&quot;</span>;</div>
<div class="line"><span class="lineno">  879</span>      <span class="comment">// For xsec we can get the actual name, hurray for being informative</span></div>
<div class="line"><span class="lineno">  880</span>      <span class="keywordflow">if</span> (isxsec) name_x = cov-&gt;GetParFancyName(i);</div>
<div class="line"><span class="lineno">  881</span> </div>
<div class="line"><span class="lineno">  882</span>      <span class="comment">// Get the parameter priors and bounds</span></div>
<div class="line"><span class="lineno">  883</span>      <span class="keywordtype">double</span> prior_x = cov-&gt;getParInit(i);</div>
<div class="line"><span class="lineno">  884</span>      <span class="keywordflow">if</span> (IsPCA) prior_x = cov-&gt;getParCurr_PCA(i);</div>
<div class="line"><span class="lineno">  885</span> </div>
<div class="line"><span class="lineno">  886</span>      <span class="comment">// Get the covariance matrix and do the +/- nSigma</span></div>
<div class="line"><span class="lineno">  887</span>      <span class="keywordtype">double</span> nSigma = 1;</div>
<div class="line"><span class="lineno">  888</span>      <span class="keywordflow">if</span> (IsPCA) nSigma = 0.5;</div>
<div class="line"><span class="lineno">  889</span>      <span class="comment">// Set lower and upper bounds relative the prior</span></div>
<div class="line"><span class="lineno">  890</span>      <span class="keywordtype">double</span> lower_x = prior_x - nSigma*cov-&gt;getDiagonalError(i);</div>
<div class="line"><span class="lineno">  891</span>      <span class="keywordtype">double</span> upper_x = prior_x + nSigma*cov-&gt;getDiagonalError(i);</div>
<div class="line"><span class="lineno">  892</span>      <span class="comment">// If PCA, transform these parameter values to the PCA basis</span></div>
<div class="line"><span class="lineno">  893</span>      <span class="keywordflow">if</span> (IsPCA) {</div>
<div class="line"><span class="lineno">  894</span>        lower_x = prior_x - nSigma*std::sqrt((cov-&gt;getEigenValues())(i));</div>
<div class="line"><span class="lineno">  895</span>        upper_x = prior_x + nSigma*std::sqrt((cov-&gt;getEigenValues())(i));</div>
<div class="line"><span class="lineno">  896</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;eval {} = {:.2f}&quot;</span>, i, cov-&gt;getEigenValues()(i));</div>
<div class="line"><span class="lineno">  897</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;prior {} = {:.2f}&quot;</span>, i, prior_x);</div>
<div class="line"><span class="lineno">  898</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;lower {} = {:.2f}&quot;</span>, i, lower_x);</div>
<div class="line"><span class="lineno">  899</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;upper {} = {:.2f}&quot;</span>, i, upper_x);</div>
<div class="line"><span class="lineno">  900</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;nSigma = {:.2f}&quot;</span>, nSigma);</div>
<div class="line"><span class="lineno">  901</span>      }</div>
<div class="line"><span class="lineno">  902</span> </div>
<div class="line"><span class="lineno">  903</span>      <span class="comment">// Cross-section and flux parameters have boundaries that we scan between, check that these are respected in setting lower and upper variables</span></div>
<div class="line"><span class="lineno">  904</span>      <span class="keywordflow">if</span> (lower_x &lt; cov-&gt;GetLowerBound(i)) {</div>
<div class="line"><span class="lineno">  905</span>        lower_x = cov-&gt;GetLowerBound(i);</div>
<div class="line"><span class="lineno">  906</span>      }</div>
<div class="line"><span class="lineno">  907</span>      <span class="keywordflow">if</span> (upper_x &gt; cov-&gt;GetUpperBound(i)) {</div>
<div class="line"><span class="lineno">  908</span>        upper_x = cov-&gt;GetUpperBound(i);</div>
<div class="line"><span class="lineno">  909</span>      }</div>
<div class="line"><span class="lineno">  910</span> </div>
<div class="line"><span class="lineno">  911</span>      <span class="keywordtype">bool</span> skip = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  912</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is = 0; is &lt; SkipVector.size(); is++)</div>
<div class="line"><span class="lineno">  913</span>      {</div>
<div class="line"><span class="lineno">  914</span>        <span class="keywordflow">if</span>(name_x.substr(0, SkipVector[is].length()) == SkipVector[is])</div>
<div class="line"><span class="lineno">  915</span>        {</div>
<div class="line"><span class="lineno">  916</span>          skip = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  917</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  918</span>        }</div>
<div class="line"><span class="lineno">  919</span>      }</div>
<div class="line"><span class="lineno">  920</span>      <span class="keywordflow">if</span>(skip) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  921</span> </div>
<div class="line"><span class="lineno">  922</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; i; ++j)</div>
<div class="line"><span class="lineno">  923</span>      {</div>
<div class="line"><span class="lineno">  924</span>        std::string name_y = cov-&gt;GetParName(j);</div>
<div class="line"><span class="lineno">  925</span>        <span class="keywordflow">if</span> (IsPCA) name_y += <span class="stringliteral">&quot;_PCA&quot;</span>;</div>
<div class="line"><span class="lineno">  926</span>        <span class="comment">// For xsec we can get the actual name, hurray for being informative</span></div>
<div class="line"><span class="lineno">  927</span>        <span class="keywordflow">if</span> (isxsec) name_y = cov-&gt;GetParFancyName(j);</div>
<div class="line"><span class="lineno">  928</span> </div>
<div class="line"><span class="lineno">  929</span>        skip = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  930</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is = 0; is &lt; SkipVector.size(); is++)</div>
<div class="line"><span class="lineno">  931</span>        {</div>
<div class="line"><span class="lineno">  932</span>          <span class="keywordflow">if</span>(name_y.substr(0, SkipVector[is].length()) == SkipVector[is])</div>
<div class="line"><span class="lineno">  933</span>          {</div>
<div class="line"><span class="lineno">  934</span>            skip = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  935</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  936</span>          }</div>
<div class="line"><span class="lineno">  937</span>        }</div>
<div class="line"><span class="lineno">  938</span>        <span class="keywordflow">if</span>(skip) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  939</span> </div>
<div class="line"><span class="lineno">  940</span>        <span class="comment">// Get the parameter priors and bounds</span></div>
<div class="line"><span class="lineno">  941</span>        <span class="keywordtype">double</span> prior_y = cov-&gt;getParInit(j);</div>
<div class="line"><span class="lineno">  942</span>        <span class="keywordflow">if</span> (IsPCA) prior_y = cov-&gt;getParCurr_PCA(j);</div>
<div class="line"><span class="lineno">  943</span> </div>
<div class="line"><span class="lineno">  944</span>        <span class="comment">// Set lower and upper bounds relative the prior</span></div>
<div class="line"><span class="lineno">  945</span>        <span class="keywordtype">double</span> lower_y = prior_y - nSigma*cov-&gt;getDiagonalError(j);</div>
<div class="line"><span class="lineno">  946</span>        <span class="keywordtype">double</span> upper_y = prior_y + nSigma*cov-&gt;getDiagonalError(j);</div>
<div class="line"><span class="lineno">  947</span>        <span class="comment">// If PCA, transform these parameter values to the PCA basis</span></div>
<div class="line"><span class="lineno">  948</span>        <span class="keywordflow">if</span> (IsPCA) {</div>
<div class="line"><span class="lineno">  949</span>          lower_y = prior_y - nSigma*std::sqrt((cov-&gt;getEigenValues())(j));</div>
<div class="line"><span class="lineno">  950</span>          upper_y = prior_y + nSigma*std::sqrt((cov-&gt;getEigenValues())(j));</div>
<div class="line"><span class="lineno">  951</span>          <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;eval {} = {:.2f}&quot;</span>, i, cov-&gt;getEigenValues()(j));</div>
<div class="line"><span class="lineno">  952</span>          <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;prior {} = {:.2f}&quot;</span>, i, prior_y);</div>
<div class="line"><span class="lineno">  953</span>          <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;lower {} = {:.2f}&quot;</span>, i, lower_y);</div>
<div class="line"><span class="lineno">  954</span>          <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;upper {} = {:.2f}&quot;</span>, i, upper_y);</div>
<div class="line"><span class="lineno">  955</span>          <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;nSigma = {:.2f}&quot;</span>, nSigma);</div>
<div class="line"><span class="lineno">  956</span>        }</div>
<div class="line"><span class="lineno">  957</span> </div>
<div class="line"><span class="lineno">  958</span>        <span class="comment">// Cross-section and flux parameters have boundaries that we scan between, check that these are respected in setting lower and upper variables</span></div>
<div class="line"><span class="lineno">  959</span>        <span class="keywordflow">if</span> (lower_y &lt; cov-&gt;GetLowerBound(j)) {</div>
<div class="line"><span class="lineno">  960</span>          lower_y = cov-&gt;GetLowerBound(j);</div>
<div class="line"><span class="lineno">  961</span>        }</div>
<div class="line"><span class="lineno">  962</span>        <span class="keywordflow">if</span> (upper_y &gt; cov-&gt;GetUpperBound(j)) {</div>
<div class="line"><span class="lineno">  963</span>          upper_y = cov-&gt;GetUpperBound(j);</div>
<div class="line"><span class="lineno">  964</span>        }</div>
<div class="line"><span class="lineno">  965</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Scanning X {} with {} steps, from {} - {}, prior = {}&quot;</span>, name_x, n_points, lower_x, upper_x, prior_x);</div>
<div class="line"><span class="lineno">  966</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Scanning Y {} with {} steps, from {} - {}, prior = {}&quot;</span>, name_y, n_points, lower_y, upper_y, prior_y);</div>
<div class="line"><span class="lineno">  967</span> </div>
<div class="line"><span class="lineno">  968</span>        <span class="keyword">auto</span> hScanSam = std::make_unique&lt;TH2D&gt;((name_x + <span class="stringliteral">&quot;_&quot;</span> + name_y + <span class="stringliteral">&quot;_sam&quot;</span>).c_str(), (name_x + <span class="stringliteral">&quot;_&quot;</span> + name_y + <span class="stringliteral">&quot;_sam&quot;</span>).c_str(),</div>
<div class="line"><span class="lineno">  969</span>                                                n_points, lower_x, upper_x, n_points, lower_y, upper_y);</div>
<div class="line"><span class="lineno">  970</span>        hScanSam-&gt;GetXaxis()-&gt;SetTitle(name_x.c_str());</div>
<div class="line"><span class="lineno">  971</span>        hScanSam-&gt;GetYaxis()-&gt;SetTitle(name_y.c_str());</div>
<div class="line"><span class="lineno">  972</span>        hScanSam-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;2LLH_sam&quot;</span>);</div>
<div class="line"><span class="lineno">  973</span> </div>
<div class="line"><span class="lineno">  974</span>        <span class="comment">// Scan over the parameter space</span></div>
<div class="line"><span class="lineno">  975</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; n_points; x++)</div>
<div class="line"><span class="lineno">  976</span>        {</div>
<div class="line"><span class="lineno">  977</span>          <span class="keywordflow">if</span> (x % countwidth == 0)</div>
<div class="line"><span class="lineno">  978</span>            <a class="code hl_function" href="namespaceMaCh3Utils.html#a4c8bdeb1d34606aed192e9f1311a72f5">MaCh3Utils::PrintProgressBar</a>(x, n_points);</div>
<div class="line"><span class="lineno">  979</span> </div>
<div class="line"><span class="lineno">  980</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y = 0; y &lt; n_points; y++)</div>
<div class="line"><span class="lineno">  981</span>          {</div>
<div class="line"><span class="lineno">  982</span>            <span class="comment">// For PCA we have to do it differently</span></div>
<div class="line"><span class="lineno">  983</span>            <span class="keywordflow">if</span> (IsPCA) {</div>
<div class="line"><span class="lineno">  984</span>              cov-&gt;setParProp_PCA(i, hScanSam-&gt;GetXaxis()-&gt;GetBinCenter(x+1));</div>
<div class="line"><span class="lineno">  985</span>              cov-&gt;setParProp_PCA(j, hScanSam-&gt;GetYaxis()-&gt;GetBinCenter(y+1));</div>
<div class="line"><span class="lineno">  986</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  987</span>              <span class="comment">// Set the parameter</span></div>
<div class="line"><span class="lineno">  988</span>              cov-&gt;setParProp(i, hScanSam-&gt;GetXaxis()-&gt;GetBinCenter(x+1));</div>
<div class="line"><span class="lineno">  989</span>              cov-&gt;setParProp(j, hScanSam-&gt;GetYaxis()-&gt;GetBinCenter(y+1));</div>
<div class="line"><span class="lineno">  990</span>            }</div>
<div class="line"><span class="lineno">  991</span> </div>
<div class="line"><span class="lineno">  992</span>            <span class="comment">// Reweight the MC</span></div>
<div class="line"><span class="lineno">  993</span>            <span class="comment">//double *fake = 0;</span></div>
<div class="line"><span class="lineno">  994</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivs = 0; ivs &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ivs++) {</div>
<div class="line"><span class="lineno">  995</span>              <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;reweight();</div>
<div class="line"><span class="lineno">  996</span>            }</div>
<div class="line"><span class="lineno">  997</span> </div>
<div class="line"><span class="lineno">  998</span>            <span class="comment">// Get the -log L likelihoods</span></div>
<div class="line"><span class="lineno">  999</span>            <span class="keywordtype">double</span> samplellh = 0;</div>
<div class="line"><span class="lineno"> 1000</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivs = 0; ivs &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ivs++) {</div>
<div class="line"><span class="lineno"> 1001</span>              samplellh += <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;GetLikelihood();</div>
<div class="line"><span class="lineno"> 1002</span>            }</div>
<div class="line"><span class="lineno"> 1003</span>            hScanSam-&gt;SetBinContent(x+1, y+1, 2*samplellh);</div>
<div class="line"><span class="lineno"> 1004</span>          }<span class="comment">// end loop over y points</span></div>
<div class="line"><span class="lineno"> 1005</span>        } <span class="comment">// end loop over x points</span></div>
<div class="line"><span class="lineno"> 1006</span> </div>
<div class="line"><span class="lineno"> 1007</span>        Sample_2DLLH-&gt;cd();</div>
<div class="line"><span class="lineno"> 1008</span>        hScanSam-&gt;Write();</div>
<div class="line"><span class="lineno"> 1009</span>        <span class="comment">// Reset the parameters to their prior central values</span></div>
<div class="line"><span class="lineno"> 1010</span>        <span class="keywordflow">if</span> (IsPCA) {</div>
<div class="line"><span class="lineno"> 1011</span>          cov-&gt;setParProp_PCA(i, prior_x);</div>
<div class="line"><span class="lineno"> 1012</span>          cov-&gt;setParProp_PCA(j, prior_y);</div>
<div class="line"><span class="lineno"> 1013</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1014</span>          cov-&gt;setParProp(i, prior_x);</div>
<div class="line"><span class="lineno"> 1015</span>          cov-&gt;setParProp(j, prior_y);</div>
<div class="line"><span class="lineno"> 1016</span>        }</div>
<div class="line"><span class="lineno"> 1017</span>      } <span class="comment">//end loop over systematics y</span></div>
<div class="line"><span class="lineno"> 1018</span>    }<span class="comment">//end loop over systematics X</span></div>
<div class="line"><span class="lineno"> 1019</span>  }<span class="comment">//end loop covariance classes</span></div>
<div class="line"><span class="lineno"> 1020</span>  Sample_2DLLH-&gt;Write();</div>
<div class="line"><span class="lineno"> 1021</span>  <span class="keyword">delete</span> Sample_2DLLH;</div>
<div class="line"><span class="lineno"> 1022</span>}</div>
<div class="ttc" id="aclassFitterBase_html_a48f38bfa8996fe00d51f35b05dd16b46"><div class="ttname"><a href="classFitterBase.html#a48f38bfa8996fe00d51f35b05dd16b46">FitterBase::SaveSettings</a></div><div class="ttdeci">void SaveSettings()</div><div class="ttdoc">Save the settings that the MCMC was run with.</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8cpp_source.html#l00084">FitterBase.cpp:84</a></div></div>
<div class="ttc" id="anamespaceMaCh3Utils_html_a4c8bdeb1d34606aed192e9f1311a72f5"><div class="ttname"><a href="namespaceMaCh3Utils.html#a4c8bdeb1d34606aed192e9f1311a72f5">MaCh3Utils::PrintProgressBar</a></div><div class="ttdeci">void PrintProgressBar(const Long64_t Done, const Long64_t All)</div><div class="ttdoc">KS: Simply print progress bar.</div><div class="ttdef"><b>Definition:</b> <a href="Monitor_8cpp_source.html#l00184">Monitor.cpp:184</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a018e8d09a62bca19840e1321b49df2c0" name="a018e8d09a62bca19840e1321b49df2c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a018e8d09a62bca19840e1321b49df2c0">&#9670;&#160;</a></span>RunLLHScan()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitterBase::RunLLHScan </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform a 1D likelihood scan. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00460">460</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  460</span>                            {</div>
<div class="line"><span class="lineno">  461</span><span class="comment">// *************************</span></div>
<div class="line"><span class="lineno">  462</span>  <span class="comment">// Save the settings into the output file</span></div>
<div class="line"><span class="lineno">  463</span>  <a class="code hl_function" href="classFitterBase.html#a48f38bfa8996fe00d51f35b05dd16b46">SaveSettings</a>();</div>
<div class="line"><span class="lineno">  464</span> </div>
<div class="line"><span class="lineno">  465</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Starting LLH Scan&quot;</span>);</div>
<div class="line"><span class="lineno">  466</span> </div>
<div class="line"><span class="lineno">  467</span>  <span class="comment">//KS: Turn it on if you want LLH scan for each ND sample separately, which increase time significantly but can be useful for validating new samples or dials.</span></div>
<div class="line"><span class="lineno">  468</span>  <span class="keywordtype">bool</span> PlotAllNDsamplesLLH = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  469</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;LLHScanBySample&quot;</span>])</div>
<div class="line"><span class="lineno">  470</span>    PlotAllNDsamplesLLH = <a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;LLHScanBySample&quot;</span>].as&lt;<span class="keywordtype">bool</span>&gt;();</div>
<div class="line"><span class="lineno">  471</span> </div>
<div class="line"><span class="lineno">  472</span>  std::vector&lt;std::string&gt; SkipVector;</div>
<div class="line"><span class="lineno">  473</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;LLHScanSkipVector&quot;</span>])</div>
<div class="line"><span class="lineno">  474</span>  {</div>
<div class="line"><span class="lineno">  475</span>    SkipVector = <a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;LLHScanSkipVector&quot;</span>].as&lt;std::vector&lt;std::string&gt;&gt;();</div>
<div class="line"><span class="lineno">  476</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Found skip vector with {} entries&quot;</span>, SkipVector.size());</div>
<div class="line"><span class="lineno">  477</span>  }</div>
<div class="line"><span class="lineno">  478</span> </div>
<div class="line"><span class="lineno">  479</span>  <span class="comment">// Now finally get onto the LLH scan stuff</span></div>
<div class="line"><span class="lineno">  480</span>  <span class="comment">// Very similar code to MCMC but never start MCMC; just scan over the parameter space</span></div>
<div class="line"><span class="lineno">  481</span>  std::vector&lt;TDirectory *&gt; Cov_LLH(<a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size());</div>
<div class="line"><span class="lineno">  482</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivc = 0; ivc &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); ivc++ )</div>
<div class="line"><span class="lineno">  483</span>  {</div>
<div class="line"><span class="lineno">  484</span>    std::string NameTemp = <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[ivc]-&gt;getName();</div>
<div class="line"><span class="lineno">  485</span>    NameTemp = NameTemp.substr(0, NameTemp.find(<span class="stringliteral">&quot;_cov&quot;</span>)) + <span class="stringliteral">&quot;_LLH&quot;</span>;</div>
<div class="line"><span class="lineno">  486</span>    Cov_LLH[ivc] = <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;mkdir(NameTemp.c_str());</div>
<div class="line"><span class="lineno">  487</span>  }</div>
<div class="line"><span class="lineno">  488</span> </div>
<div class="line"><span class="lineno">  489</span>  std::vector&lt;TDirectory *&gt; SampleClass_LLH(<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size());</div>
<div class="line"><span class="lineno">  490</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivs = 0; ivs &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ivs++ )</div>
<div class="line"><span class="lineno">  491</span>  {</div>
<div class="line"><span class="lineno">  492</span>    std::string NameTemp = <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;GetName();</div>
<div class="line"><span class="lineno">  493</span>    SampleClass_LLH[ivs] = <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;mkdir(NameTemp.c_str());</div>
<div class="line"><span class="lineno">  494</span>  }</div>
<div class="line"><span class="lineno">  495</span> </div>
<div class="line"><span class="lineno">  496</span>  TDirectory *Sample_LLH = <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Sample_LLH&quot;</span>);</div>
<div class="line"><span class="lineno">  497</span>  TDirectory *Total_LLH = <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Total_LLH&quot;</span>);</div>
<div class="line"><span class="lineno">  498</span> </div>
<div class="line"><span class="lineno">  499</span>  std::vector&lt;TDirectory *&gt;SampleSplit_LLH;</div>
<div class="line"><span class="lineno">  500</span>  <span class="keywordflow">if</span>(PlotAllNDsamplesLLH)</div>
<div class="line"><span class="lineno">  501</span>  {</div>
<div class="line"><span class="lineno">  502</span>    SampleSplit_LLH.resize(<a class="code hl_variable" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a>);</div>
<div class="line"><span class="lineno">  503</span>    <span class="keywordtype">int</span> SampleIterator = 0;</div>
<div class="line"><span class="lineno">  504</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivs = 0; ivs &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ivs++ )</div>
<div class="line"><span class="lineno">  505</span>    {</div>
<div class="line"><span class="lineno">  506</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;GetNsamples(); is++ )</div>
<div class="line"><span class="lineno">  507</span>      {</div>
<div class="line"><span class="lineno">  508</span>        SampleSplit_LLH[SampleIterator] = <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;mkdir((<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;GetSampleName(is)+ <span class="stringliteral">&quot;_LLH&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  509</span>        SampleIterator++;</div>
<div class="line"><span class="lineno">  510</span>      }</div>
<div class="line"><span class="lineno">  511</span>    }</div>
<div class="line"><span class="lineno">  512</span>  }</div>
<div class="line"><span class="lineno">  513</span>  <span class="comment">// Number of points we do for each LLH scan</span></div>
<div class="line"><span class="lineno">  514</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> n_points = GetFromManager&lt;int&gt;(<a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;LLHScanPoints&quot;</span>], 100);</div>
<div class="line"><span class="lineno">  515</span> </div>
<div class="line"><span class="lineno">  516</span>  <span class="comment">// We print 5 reweights</span></div>
<div class="line"><span class="lineno">  517</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> countwidth = int(<span class="keywordtype">double</span>(n_points)/<span class="keywordtype">double</span>(5));</div>
<div class="line"><span class="lineno">  518</span> </div>
<div class="line"><span class="lineno">  519</span>  <span class="keywordtype">bool</span> isxsec = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  520</span>  <span class="comment">// Loop over the covariance classes</span></div>
<div class="line"><span class="lineno">  521</span>  <span class="keywordflow">for</span> (<a class="code hl_class" href="classcovarianceBase.html">covarianceBase</a> *cov : <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>)</div>
<div class="line"><span class="lineno">  522</span>  {</div>
<div class="line"><span class="lineno">  523</span>    <span class="keywordflow">if</span> (cov-&gt;getName() == <span class="stringliteral">&quot;xsec_cov&quot;</span>)</div>
<div class="line"><span class="lineno">  524</span>    {</div>
<div class="line"><span class="lineno">  525</span>      isxsec = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  526</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  527</span>      isxsec = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  528</span>    }</div>
<div class="line"><span class="lineno">  529</span> </div>
<div class="line"><span class="lineno">  530</span>    <span class="comment">// Scan over all the parameters</span></div>
<div class="line"><span class="lineno">  531</span>    <span class="comment">// Get the number of parameters</span></div>
<div class="line"><span class="lineno">  532</span>    <span class="keywordtype">int</span> npars = cov-&gt;GetNumParams();</div>
<div class="line"><span class="lineno">  533</span>    <span class="keywordtype">bool</span> IsPCA = cov-&gt;IsPCA();</div>
<div class="line"><span class="lineno">  534</span>    <span class="keywordflow">if</span> (IsPCA) npars = cov-&gt;getNpars();</div>
<div class="line"><span class="lineno">  535</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; npars; ++i)</div>
<div class="line"><span class="lineno">  536</span>    {</div>
<div class="line"><span class="lineno">  537</span>      <span class="comment">// Get the parameter name</span></div>
<div class="line"><span class="lineno">  538</span>      std::string name = cov-&gt;GetParName(i);</div>
<div class="line"><span class="lineno">  539</span>      <span class="keywordflow">if</span> (IsPCA) name += <span class="stringliteral">&quot;_PCA&quot;</span>;</div>
<div class="line"><span class="lineno">  540</span>      <span class="comment">// For xsec we can get the actual name, hurray for being informative</span></div>
<div class="line"><span class="lineno">  541</span>      <span class="keywordflow">if</span> (isxsec) name = cov-&gt;GetParFancyName(i);</div>
<div class="line"><span class="lineno">  542</span>      <span class="keywordtype">bool</span> skip = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  543</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is = 0; is &lt; SkipVector.size(); is++)</div>
<div class="line"><span class="lineno">  544</span>      {</div>
<div class="line"><span class="lineno">  545</span>        <span class="keywordflow">if</span>(name.substr(0, SkipVector[is].length()) == SkipVector[is])</div>
<div class="line"><span class="lineno">  546</span>        {</div>
<div class="line"><span class="lineno">  547</span>          skip = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  548</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  549</span>        }</div>
<div class="line"><span class="lineno">  550</span>      }</div>
<div class="line"><span class="lineno">  551</span>      <span class="keywordflow">if</span>(skip) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  552</span> </div>
<div class="line"><span class="lineno">  553</span>      <span class="comment">// Get the parameter priors and bounds</span></div>
<div class="line"><span class="lineno">  554</span>      <span class="keywordtype">double</span> prior = cov-&gt;getParInit(i);</div>
<div class="line"><span class="lineno">  555</span>      <span class="keywordflow">if</span> (IsPCA) prior = cov-&gt;getParCurr_PCA(i);</div>
<div class="line"><span class="lineno">  556</span> </div>
<div class="line"><span class="lineno">  557</span>      <span class="comment">// Get the covariance matrix and do the +/- nSigma</span></div>
<div class="line"><span class="lineno">  558</span>      <span class="keywordtype">double</span> nSigma = 1;</div>
<div class="line"><span class="lineno">  559</span>      <span class="keywordflow">if</span> (IsPCA) nSigma = 0.5;</div>
<div class="line"><span class="lineno">  560</span>      <span class="comment">// Set lower and upper bounds relative the prior</span></div>
<div class="line"><span class="lineno">  561</span>      <span class="keywordtype">double</span> lower = prior - nSigma*cov-&gt;getDiagonalError(i);</div>
<div class="line"><span class="lineno">  562</span>      <span class="keywordtype">double</span> upper = prior + nSigma*cov-&gt;getDiagonalError(i);</div>
<div class="line"><span class="lineno">  563</span>      <span class="comment">// If PCA, transform these parameter values to the PCA basis</span></div>
<div class="line"><span class="lineno">  564</span>      <span class="keywordflow">if</span> (IsPCA) {</div>
<div class="line"><span class="lineno">  565</span>        lower = prior - nSigma*std::sqrt((cov-&gt;getEigenValues())(i));</div>
<div class="line"><span class="lineno">  566</span>        upper = prior + nSigma*std::sqrt((cov-&gt;getEigenValues())(i));</div>
<div class="line"><span class="lineno">  567</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;eval {} = {:.2f}&quot;</span>, i, cov-&gt;getEigenValues()(i));</div>
<div class="line"><span class="lineno">  568</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;prior {} = {:.2f}&quot;</span>, i, prior);</div>
<div class="line"><span class="lineno">  569</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;lower {} = {:.2f}&quot;</span>, i, lower);</div>
<div class="line"><span class="lineno">  570</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;upper {} = {:.2f}&quot;</span>, i, upper);</div>
<div class="line"><span class="lineno">  571</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;nSigma = {:.2f}&quot;</span>, nSigma);</div>
<div class="line"><span class="lineno">  572</span>      }</div>
<div class="line"><span class="lineno">  573</span> </div>
<div class="line"><span class="lineno">  574</span>      <span class="comment">// Cross-section and flux parameters have boundaries that we scan between, check that these are respected in setting lower and upper variables</span></div>
<div class="line"><span class="lineno">  575</span>      <span class="keywordflow">if</span> (lower &lt; cov-&gt;GetLowerBound(i)) {</div>
<div class="line"><span class="lineno">  576</span>        lower = cov-&gt;GetLowerBound(i);</div>
<div class="line"><span class="lineno">  577</span>      }</div>
<div class="line"><span class="lineno">  578</span>      <span class="keywordflow">if</span> (upper &gt; cov-&gt;GetUpperBound(i)) {</div>
<div class="line"><span class="lineno">  579</span>        upper = cov-&gt;GetUpperBound(i);</div>
<div class="line"><span class="lineno">  580</span>      }</div>
<div class="line"><span class="lineno">  581</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Scanning {} with {} steps, from {:.2f} - {:.2f}, prior = {:.2f}&quot;</span>, name, n_points, lower, upper, prior);</div>
<div class="line"><span class="lineno">  582</span> </div>
<div class="line"><span class="lineno">  583</span>      <span class="comment">// Make the TH1D</span></div>
<div class="line"><span class="lineno">  584</span>      <span class="keyword">auto</span> hScan = std::make_unique&lt;TH1D&gt;((name + <span class="stringliteral">&quot;_full&quot;</span>).c_str(), (name + <span class="stringliteral">&quot;_full&quot;</span>).c_str(), n_points, lower, upper);</div>
<div class="line"><span class="lineno">  585</span>      hScan-&gt;SetTitle((std::string(<span class="stringliteral">&quot;2LLH_full, &quot;</span>) + name + <span class="stringliteral">&quot;;&quot;</span> + name + <span class="stringliteral">&quot;; -2(ln L_{sample} + ln L_{xsec+flux} + ln L_{det})&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  586</span> </div>
<div class="line"><span class="lineno">  587</span>      <span class="keyword">auto</span> hScanSam = std::make_unique&lt;TH1D&gt;((name + <span class="stringliteral">&quot;_sam&quot;</span>).c_str(), (name + <span class="stringliteral">&quot;_sam&quot;</span>).c_str(), n_points, lower, upper);</div>
<div class="line"><span class="lineno">  588</span>      hScanSam-&gt;SetTitle((std::string(<span class="stringliteral">&quot;2LLH_sam, &quot;</span>) + name + <span class="stringliteral">&quot;;&quot;</span> + name + <span class="stringliteral">&quot;; -2(ln L_{sample})&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  589</span> </div>
<div class="line"><span class="lineno">  590</span>      std::vector&lt;TH1D*&gt; hScanSample(<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size());</div>
<div class="line"><span class="lineno">  591</span>      std::vector&lt;double&gt; nSamLLH(<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size());</div>
<div class="line"><span class="lineno">  592</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivs = 0; ivs &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ivs++ )</div>
<div class="line"><span class="lineno">  593</span>      {</div>
<div class="line"><span class="lineno">  594</span>        std::string NameTemp = <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;GetName();</div>
<div class="line"><span class="lineno">  595</span>        hScanSample[ivs] = <span class="keyword">new</span> TH1D((name+<span class="stringliteral">&quot;_&quot;</span>+NameTemp).c_str(), (name+<span class="stringliteral">&quot;_&quot;</span> + NameTemp).c_str(), n_points, lower, upper);</div>
<div class="line"><span class="lineno">  596</span>        hScanSample[ivs]-&gt;SetTitle((<span class="stringliteral">&quot;2LLH_&quot;</span> + NameTemp + <span class="stringliteral">&quot;, &quot;</span> + name + <span class="stringliteral">&quot;;&quot;</span> + name + <span class="stringliteral">&quot;; -2(ln L_{&quot;</span> + NameTemp +<span class="stringliteral">&quot;})&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  597</span>        nSamLLH[ivs] = 0.;</div>
<div class="line"><span class="lineno">  598</span>      }</div>
<div class="line"><span class="lineno">  599</span> </div>
<div class="line"><span class="lineno">  600</span>      std::vector&lt;TH1D*&gt; hScanCov(<a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size());</div>
<div class="line"><span class="lineno">  601</span>      std::vector&lt;double&gt; nCovLLH(<a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size());</div>
<div class="line"><span class="lineno">  602</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivc = 0; ivc &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); ivc++ )</div>
<div class="line"><span class="lineno">  603</span>      {</div>
<div class="line"><span class="lineno">  604</span>        std::string NameTemp = <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[ivc]-&gt;getName();</div>
<div class="line"><span class="lineno">  605</span>        NameTemp = NameTemp.substr(0, NameTemp.find(<span class="stringliteral">&quot;_cov&quot;</span>));</div>
<div class="line"><span class="lineno">  606</span> </div>
<div class="line"><span class="lineno">  607</span>        hScanCov[ivc] = <span class="keyword">new</span> TH1D((name+<span class="stringliteral">&quot;_&quot;</span>+NameTemp).c_str(), (name+<span class="stringliteral">&quot;_&quot;</span> + NameTemp).c_str(), n_points, lower, upper);</div>
<div class="line"><span class="lineno">  608</span>        hScanCov[ivc]-&gt;SetTitle((<span class="stringliteral">&quot;2LLH_&quot;</span> + NameTemp + <span class="stringliteral">&quot;, &quot;</span> + name + <span class="stringliteral">&quot;;&quot;</span> + name + <span class="stringliteral">&quot;; -2(ln L_{&quot;</span> + NameTemp +<span class="stringliteral">&quot;})&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  609</span>        nCovLLH[ivc] = 0.;</div>
<div class="line"><span class="lineno">  610</span>      }</div>
<div class="line"><span class="lineno">  611</span> </div>
<div class="line"><span class="lineno">  612</span>      std::vector&lt;TH1D *&gt; hScanSamSplit;</div>
<div class="line"><span class="lineno">  613</span>      std::vector&lt;double&gt; sampleSplitllh;</div>
<div class="line"><span class="lineno">  614</span>      <span class="keywordflow">if</span>(PlotAllNDsamplesLLH)</div>
<div class="line"><span class="lineno">  615</span>      {</div>
<div class="line"><span class="lineno">  616</span>        <span class="keywordtype">int</span> SampleIterator = 0;</div>
<div class="line"><span class="lineno">  617</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivs = 0; ivs &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ivs++ )</div>
<div class="line"><span class="lineno">  618</span>        {</div>
<div class="line"><span class="lineno">  619</span>          hScanSamSplit.resize(<a class="code hl_variable" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a>);</div>
<div class="line"><span class="lineno">  620</span>          sampleSplitllh.resize(<a class="code hl_variable" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a>);</div>
<div class="line"><span class="lineno">  621</span>          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;GetNsamples(); is++ )</div>
<div class="line"><span class="lineno">  622</span>          {</div>
<div class="line"><span class="lineno">  623</span>            hScanSamSplit[SampleIterator] = <span class="keyword">new</span> TH1D((name+<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;GetSampleName(is)).c_str(), (name+<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;GetSampleName(is)).c_str(), n_points, lower, upper);</div>
<div class="line"><span class="lineno">  624</span>            hScanSamSplit[SampleIterator]-&gt;SetTitle((std::string(<span class="stringliteral">&quot;2LLH_sam, &quot;</span>) + name + <span class="stringliteral">&quot;;&quot;</span> + name + <span class="stringliteral">&quot;; -2(ln L_{sample})&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  625</span>            SampleIterator++;</div>
<div class="line"><span class="lineno">  626</span>          }</div>
<div class="line"><span class="lineno">  627</span>        }</div>
<div class="line"><span class="lineno">  628</span>      }</div>
<div class="line"><span class="lineno">  629</span> </div>
<div class="line"><span class="lineno">  630</span>      <span class="comment">// Scan over the parameter space</span></div>
<div class="line"><span class="lineno">  631</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; n_points; j++)</div>
<div class="line"><span class="lineno">  632</span>      {</div>
<div class="line"><span class="lineno">  633</span>        <span class="keywordflow">if</span> (j % countwidth == 0)</div>
<div class="line"><span class="lineno">  634</span>          <a class="code hl_function" href="namespaceMaCh3Utils.html#a4c8bdeb1d34606aed192e9f1311a72f5">MaCh3Utils::PrintProgressBar</a>(j, n_points);</div>
<div class="line"><span class="lineno">  635</span> </div>
<div class="line"><span class="lineno">  636</span>        <span class="comment">// For PCA we have to do it differently</span></div>
<div class="line"><span class="lineno">  637</span>        <span class="keywordflow">if</span> (IsPCA) {</div>
<div class="line"><span class="lineno">  638</span>          cov-&gt;setParProp_PCA(i, hScan-&gt;GetBinCenter(j+1));</div>
<div class="line"><span class="lineno">  639</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  640</span>          <span class="comment">// Set the parameter</span></div>
<div class="line"><span class="lineno">  641</span>          cov-&gt;setParProp(i, hScan-&gt;GetBinCenter(j+1));</div>
<div class="line"><span class="lineno">  642</span>        }</div>
<div class="line"><span class="lineno">  643</span> </div>
<div class="line"><span class="lineno">  644</span>        <span class="comment">// Reweight the MC</span></div>
<div class="line"><span class="lineno">  645</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivs = 0; ivs &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ivs++ )</div>
<div class="line"><span class="lineno">  646</span>        {</div>
<div class="line"><span class="lineno">  647</span>          <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;reweight();</div>
<div class="line"><span class="lineno">  648</span>        }</div>
<div class="line"><span class="lineno">  649</span>        <span class="comment">//Total LLH</span></div>
<div class="line"><span class="lineno">  650</span>        <span class="keywordtype">double</span> totalllh = 0;</div>
<div class="line"><span class="lineno">  651</span> </div>
<div class="line"><span class="lineno">  652</span>        <span class="comment">// Get the -log L likelihoods</span></div>
<div class="line"><span class="lineno">  653</span>        <span class="keywordtype">double</span> samplellh = 0;</div>
<div class="line"><span class="lineno">  654</span> </div>
<div class="line"><span class="lineno">  655</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivs = 0; ivs &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ivs++ )</div>
<div class="line"><span class="lineno">  656</span>        {</div>
<div class="line"><span class="lineno">  657</span>          nSamLLH[ivs] = <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;GetLikelihood();</div>
<div class="line"><span class="lineno">  658</span>          samplellh += nSamLLH[ivs];</div>
<div class="line"><span class="lineno">  659</span>        }</div>
<div class="line"><span class="lineno">  660</span> </div>
<div class="line"><span class="lineno">  661</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivc = 0; ivc &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); ivc++ )</div>
<div class="line"><span class="lineno">  662</span>        {</div>
<div class="line"><span class="lineno">  663</span>          nCovLLH[ivc] = <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[ivc]-&gt;GetLikelihood();</div>
<div class="line"><span class="lineno">  664</span>          totalllh += nCovLLH[ivc];</div>
<div class="line"><span class="lineno">  665</span>        }</div>
<div class="line"><span class="lineno">  666</span> </div>
<div class="line"><span class="lineno">  667</span>        totalllh += samplellh;</div>
<div class="line"><span class="lineno">  668</span> </div>
<div class="line"><span class="lineno">  669</span>        <span class="keywordflow">if</span>(PlotAllNDsamplesLLH)</div>
<div class="line"><span class="lineno">  670</span>        {</div>
<div class="line"><span class="lineno">  671</span>          <span class="keywordtype">int</span> SampleIterator = 0;</div>
<div class="line"><span class="lineno">  672</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivs = 0; ivs &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ivs++ )</div>
<div class="line"><span class="lineno">  673</span>          {</div>
<div class="line"><span class="lineno">  674</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;GetNsamples(); is++)</div>
<div class="line"><span class="lineno">  675</span>            {</div>
<div class="line"><span class="lineno">  676</span>              sampleSplitllh[SampleIterator] = <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;getSampleLikelihood(is);</div>
<div class="line"><span class="lineno">  677</span>              SampleIterator++;</div>
<div class="line"><span class="lineno">  678</span>            }</div>
<div class="line"><span class="lineno">  679</span>          }</div>
<div class="line"><span class="lineno">  680</span>        }</div>
<div class="line"><span class="lineno">  681</span> </div>
<div class="line"><span class="lineno">  682</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivs = 0; ivs &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ivs++ )</div>
<div class="line"><span class="lineno">  683</span>        {</div>
<div class="line"><span class="lineno">  684</span>          hScanSample[ivs]-&gt;SetBinContent(j+1, 2*nSamLLH[ivs]);</div>
<div class="line"><span class="lineno">  685</span>        }</div>
<div class="line"><span class="lineno">  686</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivc = 0; ivc &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); ivc++ )</div>
<div class="line"><span class="lineno">  687</span>        {</div>
<div class="line"><span class="lineno">  688</span>          hScanCov[ivc]-&gt;SetBinContent(j+1, 2*nCovLLH[ivc]);</div>
<div class="line"><span class="lineno">  689</span>        }</div>
<div class="line"><span class="lineno">  690</span> </div>
<div class="line"><span class="lineno">  691</span>        hScanSam-&gt;SetBinContent(j+1, 2*samplellh);</div>
<div class="line"><span class="lineno">  692</span>        hScan-&gt;SetBinContent(j+1, 2*totalllh);</div>
<div class="line"><span class="lineno">  693</span> </div>
<div class="line"><span class="lineno">  694</span>        <span class="keywordflow">if</span>(PlotAllNDsamplesLLH)</div>
<div class="line"><span class="lineno">  695</span>        {</div>
<div class="line"><span class="lineno">  696</span>          <span class="keywordtype">int</span> SampleIterator = 0;</div>
<div class="line"><span class="lineno">  697</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivs = 0; ivs &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ivs++ )</div>
<div class="line"><span class="lineno">  698</span>          {</div>
<div class="line"><span class="lineno">  699</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;GetNsamples(); is++)</div>
<div class="line"><span class="lineno">  700</span>            {</div>
<div class="line"><span class="lineno">  701</span>              hScanSamSplit[is]-&gt;SetBinContent(j+1, 2*sampleSplitllh[is]);</div>
<div class="line"><span class="lineno">  702</span>              SampleIterator++;</div>
<div class="line"><span class="lineno">  703</span>            }</div>
<div class="line"><span class="lineno">  704</span>          }</div>
<div class="line"><span class="lineno">  705</span>        }</div>
<div class="line"><span class="lineno">  706</span>      }</div>
<div class="line"><span class="lineno">  707</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivc = 0; ivc &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); ivc++ )</div>
<div class="line"><span class="lineno">  708</span>      {</div>
<div class="line"><span class="lineno">  709</span>        Cov_LLH[ivc]-&gt;cd();</div>
<div class="line"><span class="lineno">  710</span>        hScanCov[ivc]-&gt;Write();</div>
<div class="line"><span class="lineno">  711</span>        <span class="keyword">delete</span> hScanCov[ivc];</div>
<div class="line"><span class="lineno">  712</span>      }</div>
<div class="line"><span class="lineno">  713</span> </div>
<div class="line"><span class="lineno">  714</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivs = 0; ivs &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ivs++ )</div>
<div class="line"><span class="lineno">  715</span>      {</div>
<div class="line"><span class="lineno">  716</span>        SampleClass_LLH[ivs]-&gt;cd();</div>
<div class="line"><span class="lineno">  717</span>        hScanSample[ivs]-&gt;Write();</div>
<div class="line"><span class="lineno">  718</span>        <span class="keyword">delete</span> hScanSample[ivs];</div>
<div class="line"><span class="lineno">  719</span>      }</div>
<div class="line"><span class="lineno">  720</span>      Sample_LLH-&gt;cd();</div>
<div class="line"><span class="lineno">  721</span>      hScanSam-&gt;Write();</div>
<div class="line"><span class="lineno">  722</span>      Total_LLH-&gt;cd();</div>
<div class="line"><span class="lineno">  723</span>      hScan-&gt;Write();</div>
<div class="line"><span class="lineno">  724</span> </div>
<div class="line"><span class="lineno">  725</span>      <span class="keywordflow">if</span>(PlotAllNDsamplesLLH)</div>
<div class="line"><span class="lineno">  726</span>      {</div>
<div class="line"><span class="lineno">  727</span>        <span class="keywordtype">int</span> SampleIterator = 0;</div>
<div class="line"><span class="lineno">  728</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivs = 0; ivs &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ivs++ )</div>
<div class="line"><span class="lineno">  729</span>        {</div>
<div class="line"><span class="lineno">  730</span>          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;GetNsamples(); is++)</div>
<div class="line"><span class="lineno">  731</span>          {</div>
<div class="line"><span class="lineno">  732</span>            SampleSplit_LLH[SampleIterator]-&gt;cd();</div>
<div class="line"><span class="lineno">  733</span>            hScanSamSplit[SampleIterator]-&gt;Write();</div>
<div class="line"><span class="lineno">  734</span>            <span class="keyword">delete</span> hScanSamSplit[SampleIterator];</div>
<div class="line"><span class="lineno">  735</span>            SampleIterator++;</div>
<div class="line"><span class="lineno">  736</span>          }</div>
<div class="line"><span class="lineno">  737</span>        }</div>
<div class="line"><span class="lineno">  738</span>      }</div>
<div class="line"><span class="lineno">  739</span> </div>
<div class="line"><span class="lineno">  740</span>      <span class="comment">// Reset the parameters to their prior central values</span></div>
<div class="line"><span class="lineno">  741</span>      <span class="keywordflow">if</span> (IsPCA) {</div>
<div class="line"><span class="lineno">  742</span>        cov-&gt;setParProp_PCA(i, prior);</div>
<div class="line"><span class="lineno">  743</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  744</span>        cov-&gt;setParProp(i, prior);</div>
<div class="line"><span class="lineno">  745</span>      }</div>
<div class="line"><span class="lineno">  746</span>    }<span class="comment">//end loop over systematics</span></div>
<div class="line"><span class="lineno">  747</span>  }<span class="comment">//end loop covariance classes</span></div>
<div class="line"><span class="lineno">  748</span> </div>
<div class="line"><span class="lineno">  749</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivc = 0; ivc &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); ivc++ )</div>
<div class="line"><span class="lineno">  750</span>  {</div>
<div class="line"><span class="lineno">  751</span>    Cov_LLH[ivc]-&gt;Write();</div>
<div class="line"><span class="lineno">  752</span>    <span class="keyword">delete</span> Cov_LLH[ivc];</div>
<div class="line"><span class="lineno">  753</span>  }</div>
<div class="line"><span class="lineno">  754</span> </div>
<div class="line"><span class="lineno">  755</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivs = 0; ivs &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ivs++ )</div>
<div class="line"><span class="lineno">  756</span>  {</div>
<div class="line"><span class="lineno">  757</span>    SampleClass_LLH[ivs]-&gt;Write();</div>
<div class="line"><span class="lineno">  758</span>    <span class="keyword">delete</span> SampleClass_LLH[ivs];</div>
<div class="line"><span class="lineno">  759</span>  }</div>
<div class="line"><span class="lineno">  760</span> </div>
<div class="line"><span class="lineno">  761</span>  Sample_LLH-&gt;Write();</div>
<div class="line"><span class="lineno">  762</span>  <span class="keyword">delete</span> Sample_LLH;</div>
<div class="line"><span class="lineno">  763</span> </div>
<div class="line"><span class="lineno">  764</span>  Total_LLH-&gt;Write();</div>
<div class="line"><span class="lineno">  765</span>  <span class="keyword">delete</span> Total_LLH;</div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span>  <span class="keywordflow">if</span>(PlotAllNDsamplesLLH)</div>
<div class="line"><span class="lineno">  768</span>  {</div>
<div class="line"><span class="lineno">  769</span>    <span class="keywordtype">int</span> SampleIterator = 0;</div>
<div class="line"><span class="lineno">  770</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivs = 0; ivs &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ivs++ )</div>
<div class="line"><span class="lineno">  771</span>    {</div>
<div class="line"><span class="lineno">  772</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;GetNsamples(); is++ )</div>
<div class="line"><span class="lineno">  773</span>      {</div>
<div class="line"><span class="lineno">  774</span>        SampleSplit_LLH[SampleIterator]-&gt;Write();</div>
<div class="line"><span class="lineno">  775</span>        <span class="keyword">delete</span> SampleSplit_LLH[SampleIterator];</div>
<div class="line"><span class="lineno">  776</span>        SampleIterator++;</div>
<div class="line"><span class="lineno">  777</span>      }</div>
<div class="line"><span class="lineno">  778</span>    }</div>
<div class="line"><span class="lineno">  779</span>  }</div>
<div class="line"><span class="lineno">  780</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1a9666dc09f91af804954e8968bc7b24" name="a1a9666dc09f91af804954e8968bc7b24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a9666dc09f91af804954e8968bc7b24">&#9670;&#160;</a></span>runMCMC()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void FitterBase::runMCMC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The specific fitting algorithm implemented in this function depends on the derived class. It could be Markov Chain Monte Carlo (MCMC), <a class="el" href="classMinuitFit.html" title="Implementation of Minuit fitting algorithm .">MinuitFit</a>, or another algorithm. </p>

<p>Implemented in <a class="el" href="classmcmc.html#a8a9cc0e0aa65c8573fca703a42b2ee31">mcmc</a>, <a class="el" href="classMinuitFit.html#a8e746fb17d4bc75a9d308398a4a0229e">MinuitFit</a>, <a class="el" href="classPSO.html#afcd534dbf737430c8ab1e921e8730b81">PSO</a>, <a class="el" href="classPyFitterBase.html#a4b2d51a6162bf496b7f37a5fa81963f6">PyFitterBase</a>, <a class="el" href="classPyLikelihoodFit.html#a9f42c4f0b739d09d4c63238753dd7e9a">PyLikelihoodFit</a>, and <a class="el" href="classLikelihoodFit.html#a97f28cf4797fd2f6e3fac267dcdafb27">LikelihoodFit</a>.</p>

</div>
</div>
<a id="a71e43b96395568e54879d9bd1b57c0f8" name="a71e43b96395568e54879d9bd1b57c0f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71e43b96395568e54879d9bd1b57c0f8">&#9670;&#160;</a></span>RunSigmaVar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FitterBase::RunSigmaVar </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform a 2D and 1D sigma var for all samples. </p>
<dl class="section warning"><dt>Warning</dt><dd>Code uses TH2Poly </dd></dl>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l01025">1025</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1025</span>                             {</div>
<div class="line"><span class="lineno"> 1026</span><span class="comment">// *************************</span></div>
<div class="line"><span class="lineno"> 1027</span>  <span class="comment">// Save the settings into the output file</span></div>
<div class="line"><span class="lineno"> 1028</span>  <a class="code hl_function" href="classFitterBase.html#a48f38bfa8996fe00d51f35b05dd16b46">SaveSettings</a>();</div>
<div class="line"><span class="lineno"> 1029</span> </div>
<div class="line"><span class="lineno"> 1030</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Starting Sigma Variation&quot;</span>);</div>
<div class="line"><span class="lineno"> 1031</span> </div>
<div class="line"><span class="lineno"> 1032</span>  <span class="comment">// Number of variations we want</span></div>
<div class="line"><span class="lineno"> 1033</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> numVar = 5;</div>
<div class="line"><span class="lineno"> 1034</span>  <span class="comment">//-3 -1 0 +1 +3 sigma variation</span></div>
<div class="line"><span class="lineno"> 1035</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> sigmaArray[numVar] = {-3, -1, 0, 1, 3};</div>
<div class="line"><span class="lineno"> 1036</span> </div>
<div class="line"><span class="lineno"> 1037</span>  <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 1038</span> </div>
<div class="line"><span class="lineno"> 1039</span>  <span class="comment">//KS: this is only relevant if PlotByMode is turned on</span></div>
<div class="line"><span class="lineno"> 1040</span>  <span class="comment">//Checking each mode is time consuming so we only consider one which are relevant for particular analysis</span></div>
<div class="line"><span class="lineno"> 1041</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> nRelevantModes = 2;</div>
<div class="line"><span class="lineno"> 1042</span>  <a class="code hl_typedef" href="MaCh3Modes_8h.html#adf43f6c73c9598abc381855d31ef5682">MaCh3Modes_t</a> RelevantModes[nRelevantModes] = {<a class="code hl_variable" href="classFitterBase.html#a004cb6e6168032d9280ce3db912f1a43">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#a21af1738d7b145f08d76aa0c163e0486">GetMode</a>(<span class="stringliteral">&quot;CCQE&quot;</span>), <a class="code hl_variable" href="classFitterBase.html#a004cb6e6168032d9280ce3db912f1a43">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#a21af1738d7b145f08d76aa0c163e0486">GetMode</a>(<span class="stringliteral">&quot;2p2h&quot;</span>)};</div>
<div class="line"><span class="lineno"> 1043</span>  <span class="keywordtype">bool</span> DoByMode = GetFromManager&lt;int&gt;(<a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;DoByMode&quot;</span>], <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1044</span> </div>
<div class="line"><span class="lineno"> 1045</span>  <span class="comment">//KS: If true it will make additional plots with LLH sample contribution in each bin, should make it via config file...</span></div>
<div class="line"><span class="lineno"> 1046</span>  <span class="keywordtype">bool</span> PlotLLHperBin = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1047</span> </div>
<div class="line"><span class="lineno"> 1048</span>  std::vector&lt;std::string&gt; SkipVector;</div>
<div class="line"><span class="lineno"> 1049</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;LLHScanSkipVector&quot;</span>])</div>
<div class="line"><span class="lineno"> 1050</span>  {</div>
<div class="line"><span class="lineno"> 1051</span>    SkipVector = <a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#ab3999cc856ede72b37f68bdb28bd5520">raw</a>()[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;LLHScanSkipVector&quot;</span>].as&lt;std::vector&lt;std::string&gt;&gt;();</div>
<div class="line"><span class="lineno"> 1052</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Found skip vector with {} entries&quot;</span>, SkipVector.size());</div>
<div class="line"><span class="lineno"> 1053</span>  }</div>
<div class="line"><span class="lineno"> 1054</span> </div>
<div class="line"><span class="lineno"> 1055</span>  <span class="keywordtype">bool</span> isxsec = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1056</span>  <span class="keywordflow">for</span> (<a class="code hl_class" href="classcovarianceBase.html">covarianceBase</a> *cov : <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>)</div>
<div class="line"><span class="lineno"> 1057</span>  {</div>
<div class="line"><span class="lineno"> 1058</span>    TMatrixDSym *Cov = cov-&gt;getCovMatrix();</div>
<div class="line"><span class="lineno"> 1059</span> </div>
<div class="line"><span class="lineno"> 1060</span>    <span class="keywordflow">if</span>(cov-&gt;IsPCA())</div>
<div class="line"><span class="lineno"> 1061</span>    {</div>
<div class="line"><span class="lineno"> 1062</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Using PCAed matrix not implemented within sigma var code, I am sorry :(&quot;</span>);</div>
<div class="line"><span class="lineno"> 1063</span>      <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno"> 1064</span>    }</div>
<div class="line"><span class="lineno"> 1065</span> </div>
<div class="line"><span class="lineno"> 1066</span>    <span class="keywordflow">if</span> (cov-&gt;getName() == <span class="stringliteral">&quot;xsec_cov&quot;</span>)</div>
<div class="line"><span class="lineno"> 1067</span>    {</div>
<div class="line"><span class="lineno"> 1068</span>      isxsec = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1069</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1070</span>      isxsec = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1071</span>    }</div>
<div class="line"><span class="lineno"> 1072</span> </div>
<div class="line"><span class="lineno"> 1073</span>    <span class="comment">// Loop over xsec parameters</span></div>
<div class="line"><span class="lineno"> 1074</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; cov-&gt;GetNumParams(); ++i)</div>
<div class="line"><span class="lineno"> 1075</span>    {</div>
<div class="line"><span class="lineno"> 1076</span>      <span class="comment">// Get the parameter name</span></div>
<div class="line"><span class="lineno"> 1077</span>      std::string name = cov-&gt;GetParName(i);</div>
<div class="line"><span class="lineno"> 1078</span>      <span class="comment">// For xsec we can get the actual name, hurray for being informative</span></div>
<div class="line"><span class="lineno"> 1079</span>      <span class="keywordflow">if</span> (isxsec) name = cov-&gt;GetParFancyName(i);</div>
<div class="line"><span class="lineno"> 1080</span>      <span class="keywordtype">bool</span> skip = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1081</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is = 0; is &lt; SkipVector.size(); is++)</div>
<div class="line"><span class="lineno"> 1082</span>      {</div>
<div class="line"><span class="lineno"> 1083</span>        <span class="keywordflow">if</span>(name.substr(0, SkipVector[is].length()) == SkipVector[is])</div>
<div class="line"><span class="lineno"> 1084</span>        {</div>
<div class="line"><span class="lineno"> 1085</span>          skip = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1086</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1087</span>        }</div>
<div class="line"><span class="lineno"> 1088</span>      }</div>
<div class="line"><span class="lineno"> 1089</span>      <span class="keywordflow">if</span>(skip) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1090</span> </div>
<div class="line"><span class="lineno"> 1091</span>      <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 1092</span>      TDirectory * dirArryDial = <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;mkdir(name.c_str());</div>
<div class="line"><span class="lineno"> 1093</span>      TDirectory **dirArrySample = <span class="keyword">new</span> TDirectory*[<a class="code hl_variable" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a>];</div>
<div class="line"><span class="lineno"> 1094</span> </div>
<div class="line"><span class="lineno"> 1095</span>      <span class="keywordtype">int</span> SampleIterator = 0;</div>
<div class="line"><span class="lineno"> 1096</span>      <span class="comment">// Get each sample and how it&#39;s responded to our reweighted parameter</span></div>
<div class="line"><span class="lineno"> 1097</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivs = 0; ivs &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ivs++ )</div>
<div class="line"><span class="lineno"> 1098</span>      {</div>
<div class="line"><span class="lineno"> 1099</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;GetNsamples(); k++ )</div>
<div class="line"><span class="lineno"> 1100</span>        {</div>
<div class="line"><span class="lineno"> 1101</span>          std::string title = std::string(<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;getPDF(k)-&gt;<a class="code hl_function" href="classFitterBase.html#a3706f6d722073b447b3de8c3a6516601">GetName</a>());</div>
<div class="line"><span class="lineno"> 1102</span>          dirArryDial-&gt;cd();</div>
<div class="line"><span class="lineno"> 1103</span>          dirArrySample[SampleIterator] = dirArryDial-&gt;mkdir(title.c_str());</div>
<div class="line"><span class="lineno"> 1104</span>          SampleIterator++;</div>
<div class="line"><span class="lineno"> 1105</span>        }</div>
<div class="line"><span class="lineno"> 1106</span>      }</div>
<div class="line"><span class="lineno"> 1107</span> </div>
<div class="line"><span class="lineno"> 1108</span>      <span class="comment">// Get the initial value of ith parameter</span></div>
<div class="line"><span class="lineno"> 1109</span>      <span class="keywordtype">double</span> init = cov-&gt;getParInit(i);</div>
<div class="line"><span class="lineno"> 1110</span> </div>
<div class="line"><span class="lineno"> 1111</span>      TH1D ***sigmaArray_x = <span class="keyword">new</span> TH1D**[numVar]();</div>
<div class="line"><span class="lineno"> 1112</span>      TH1D ***sigmaArray_y = <span class="keyword">new</span> TH1D**[numVar]();</div>
<div class="line"><span class="lineno"> 1113</span>      TH1D ***sigmaArray_x_norm = <span class="keyword">new</span> TH1D**[numVar]();</div>
<div class="line"><span class="lineno"> 1114</span>      TH1D ***sigmaArray_y_norm = <span class="keyword">new</span> TH1D**[numVar]();</div>
<div class="line"><span class="lineno"> 1115</span> </div>
<div class="line"><span class="lineno"> 1116</span>      <span class="comment">// Set up for single mode</span></div>
<div class="line"><span class="lineno"> 1117</span>      TH1D ****sigmaArray_mode_x = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 1118</span>      TH1D ****sigmaArray_mode_y = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 1119</span>      <span class="keywordflow">if</span> (DoByMode)</div>
<div class="line"><span class="lineno"> 1120</span>      {</div>
<div class="line"><span class="lineno"> 1121</span>        sigmaArray_mode_x = <span class="keyword">new</span> TH1D***[numVar]();</div>
<div class="line"><span class="lineno"> 1122</span>        sigmaArray_mode_y = <span class="keyword">new</span> TH1D***[numVar]();</div>
<div class="line"><span class="lineno"> 1123</span>      }</div>
<div class="line"><span class="lineno"> 1124</span> </div>
<div class="line"><span class="lineno"> 1125</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{:&lt;20}{}&quot;</span>, name, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 1126</span> </div>
<div class="line"><span class="lineno"> 1127</span>      <span class="comment">// Make asymmetric errors just in case</span></div>
<div class="line"><span class="lineno"> 1128</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; numVar; ++j)</div>
<div class="line"><span class="lineno"> 1129</span>      {</div>
<div class="line"><span class="lineno"> 1130</span>        <span class="comment">// New value = prior + variation*1sigma uncertainty</span></div>
<div class="line"><span class="lineno"> 1131</span>        <span class="keywordtype">double</span> paramVal = cov-&gt;getParInit(i)+sigmaArray[j]*std::sqrt((*Cov)(i,i));</div>
<div class="line"><span class="lineno"> 1132</span> </div>
<div class="line"><span class="lineno"> 1133</span>        <span class="comment">// Check the bounds on the parameter</span></div>
<div class="line"><span class="lineno"> 1134</span>        paramVal = std::max(cov-&gt;GetLowerBound(i), std::min(paramVal, cov-&gt;GetUpperBound(i)));</div>
<div class="line"><span class="lineno"> 1135</span> </div>
<div class="line"><span class="lineno"> 1136</span>        <span class="comment">// Set the parameter</span></div>
<div class="line"><span class="lineno"> 1137</span>        cov-&gt;setParProp(i, paramVal);</div>
<div class="line"><span class="lineno"> 1138</span>        <span class="comment">// And reweight the sample</span></div>
<div class="line"><span class="lineno"> 1139</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivs = 0; ivs &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ivs++) {</div>
<div class="line"><span class="lineno"> 1140</span>          <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;reweight();</div>
<div class="line"><span class="lineno"> 1141</span>        }</div>
<div class="line"><span class="lineno"> 1142</span> </div>
<div class="line"><span class="lineno"> 1143</span>        sigmaArray_x[j] = <span class="keyword">new</span> TH1D*[<a class="code hl_variable" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a>]();</div>
<div class="line"><span class="lineno"> 1144</span>        sigmaArray_y[j] = <span class="keyword">new</span> TH1D*[<a class="code hl_variable" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a>]();</div>
<div class="line"><span class="lineno"> 1145</span>        sigmaArray_x_norm[j] = <span class="keyword">new</span> TH1D*[<a class="code hl_variable" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a>]();</div>
<div class="line"><span class="lineno"> 1146</span>        sigmaArray_y_norm[j] = <span class="keyword">new</span> TH1D*[<a class="code hl_variable" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a>]();</div>
<div class="line"><span class="lineno"> 1147</span> </div>
<div class="line"><span class="lineno"> 1148</span>        <span class="keywordflow">if</span> (DoByMode)</div>
<div class="line"><span class="lineno"> 1149</span>        {</div>
<div class="line"><span class="lineno"> 1150</span>          sigmaArray_mode_x[j] = <span class="keyword">new</span> TH1D**[<a class="code hl_variable" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a>]();</div>
<div class="line"><span class="lineno"> 1151</span>          sigmaArray_mode_y[j] = <span class="keyword">new</span> TH1D**[<a class="code hl_variable" href="classFitterBase.html#abe9814558b8ff1bccdde3b4c894467e6">TotalNSamples</a>]();</div>
<div class="line"><span class="lineno"> 1152</span>        }</div>
<div class="line"><span class="lineno"> 1153</span> </div>
<div class="line"><span class="lineno"> 1154</span>        SampleIterator = 0;</div>
<div class="line"><span class="lineno"> 1155</span>        <span class="comment">// Get each sample and how it&#39;s responded to our reweighted parameter</span></div>
<div class="line"><span class="lineno"> 1156</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivs = 0; ivs &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ivs++ )</div>
<div class="line"><span class="lineno"> 1157</span>        {</div>
<div class="line"><span class="lineno"> 1158</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;GetNsamples(); ++k)</div>
<div class="line"><span class="lineno"> 1159</span>          {</div>
<div class="line"><span class="lineno"> 1160</span>            <span class="comment">// Make a string of the double</span></div>
<div class="line"><span class="lineno"> 1161</span>            std::ostringstream ss;</div>
<div class="line"><span class="lineno"> 1162</span>            ss &lt;&lt; paramVal;</div>
<div class="line"><span class="lineno"> 1163</span>            std::string parVarTitle = name + <span class="stringliteral">&quot;_&quot;</span> + ss.str();</div>
<div class="line"><span class="lineno"> 1164</span> </div>
<div class="line"><span class="lineno"> 1165</span>            <span class="comment">// This is a TH2D</span></div>
<div class="line"><span class="lineno"> 1166</span> </div>
<div class="line"><span class="lineno"> 1167</span>            std::unique_ptr&lt;TH2Poly&gt; currSamp(<span class="keyword">static_cast&lt;</span>TH2Poly*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;getPDF(k)-&gt;Clone()));</div>
<div class="line"><span class="lineno"> 1168</span>            currSamp-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1169</span>            <span class="comment">// Set a descriptiv-ish title</span></div>
<div class="line"><span class="lineno"> 1170</span>            std::string title_long = std::string(currSamp-&gt;GetName())+<span class="stringliteral">&quot;_&quot;</span>+parVarTitle;</div>
<div class="line"><span class="lineno"> 1171</span> </div>
<div class="line"><span class="lineno"> 1172</span>            <span class="comment">// Enable the mode histograms AFTER addSelection is called</span></div>
<div class="line"><span class="lineno"> 1173</span>            <span class="comment">//Get the 1d binning we want. Let&#39;s just use SetupBinning to get this as it already exists</span></div>
<div class="line"><span class="lineno"> 1174</span>            std::vector&lt;double&gt; xbins;</div>
<div class="line"><span class="lineno"> 1175</span>            std::vector&lt;double&gt; ybins;</div>
<div class="line"><span class="lineno"> 1176</span>            <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;SetupBinning(<a class="code hl_typedef" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a>(k), xbins, ybins);</div>
<div class="line"><span class="lineno"> 1177</span> </div>
<div class="line"><span class="lineno"> 1178</span>            <span class="comment">//KS:here we loop over all reaction modes defined in &quot;RelevantModes[nRelevantModes]&quot;</span></div>
<div class="line"><span class="lineno"> 1179</span>            <span class="keywordflow">if</span> (DoByMode)</div>
<div class="line"><span class="lineno"> 1180</span>            {</div>
<div class="line"><span class="lineno"> 1181</span>              sigmaArray_mode_x[j][SampleIterator] = <span class="keyword">new</span> TH1D*[nRelevantModes]();</div>
<div class="line"><span class="lineno"> 1182</span>              sigmaArray_mode_y[j][SampleIterator] = <span class="keyword">new</span> TH1D*[nRelevantModes]();</div>
<div class="line"><span class="lineno"> 1183</span>              <span class="comment">// Now get the TH2D mode variations</span></div>
<div class="line"><span class="lineno"> 1184</span>              std::string mode_title_long;</div>
<div class="line"><span class="lineno"> 1185</span>              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ir = 0; ir &lt; nRelevantModes; ir++)</div>
<div class="line"><span class="lineno"> 1186</span>              {</div>
<div class="line"><span class="lineno"> 1187</span>                std::unique_ptr&lt;TH2Poly&gt; currSampMode(<span class="keyword">static_cast&lt;</span>TH2Poly*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;getPDFMode(k, RelevantModes[ir])-&gt;Clone()));</div>
<div class="line"><span class="lineno"> 1188</span>                currSampMode-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1189</span> </div>
<div class="line"><span class="lineno"> 1190</span>                mode_title_long = title_long + <span class="stringliteral">&quot;_&quot;</span> + <a class="code hl_variable" href="classFitterBase.html#a004cb6e6168032d9280ce3db912f1a43">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#abf4ac35511787907bc16ae26aa6c2a15">GetMaCh3ModeName</a>(RelevantModes[ir]);</div>
<div class="line"><span class="lineno"> 1191</span>                currSampMode-&gt;SetNameTitle(mode_title_long.c_str(), mode_title_long.c_str());</div>
<div class="line"><span class="lineno"> 1192</span>                dirArrySample[SampleIterator]-&gt;cd();</div>
<div class="line"><span class="lineno"> 1193</span>                currSampMode-&gt;Write();</div>
<div class="line"><span class="lineno"> 1194</span> </div>
<div class="line"><span class="lineno"> 1195</span>                sigmaArray_mode_x[j][SampleIterator][ir] = <a class="code hl_function" href="HistogramUtils_8cpp.html#a1ab7c868447cffff71227e07655b47ad">PolyProjectionX</a>(currSampMode.get(), (mode_title_long+<span class="stringliteral">&quot;_xProj&quot;</span>).c_str(), xbins);</div>
<div class="line"><span class="lineno"> 1196</span>                sigmaArray_mode_x[j][SampleIterator][ir]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1197</span>                sigmaArray_mode_y[j][SampleIterator][ir] = <a class="code hl_function" href="HistogramUtils_8cpp.html#aa26af438a657c81f2fb3f1506c6e35f6">PolyProjectionY</a>(currSampMode.get(), (mode_title_long+<span class="stringliteral">&quot;_yProj&quot;</span>).c_str(), ybins);</div>
<div class="line"><span class="lineno"> 1198</span>                sigmaArray_mode_y[j][SampleIterator][ir]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1199</span>              }</div>
<div class="line"><span class="lineno"> 1200</span>            }</div>
<div class="line"><span class="lineno"> 1201</span> </div>
<div class="line"><span class="lineno"> 1202</span>            <span class="comment">//KS: This will give different results depending if data or Asimov, both have their uses</span></div>
<div class="line"><span class="lineno"> 1203</span>            <span class="keywordflow">if</span> (PlotLLHperBin)</div>
<div class="line"><span class="lineno"> 1204</span>            {</div>
<div class="line"><span class="lineno"> 1205</span>              std::unique_ptr&lt;TH2Poly&gt; currLLHSamp(<span class="keyword">static_cast&lt;</span>TH2Poly*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;getPDF(k)-&gt;Clone()));</div>
<div class="line"><span class="lineno"> 1206</span>              currLLHSamp-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1207</span>              currLLHSamp-&gt;Reset(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 1208</span>              currLLHSamp-&gt;Fill(0.0, 0.0, 0.0);</div>
<div class="line"><span class="lineno"> 1209</span> </div>
<div class="line"><span class="lineno"> 1210</span>              TH2Poly* MCpdf = <span class="keyword">static_cast&lt;</span>TH2Poly*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;getPDF(k));</div>
<div class="line"><span class="lineno"> 1211</span>              TH2Poly* Datapdf = <span class="keyword">static_cast&lt;</span>TH2Poly*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;getData(k));</div>
<div class="line"><span class="lineno"> 1212</span>              TH2Poly* W2pdf = <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;getW2(k);</div>
<div class="line"><span class="lineno"> 1213</span> </div>
<div class="line"><span class="lineno"> 1214</span>              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> bin = 1; bin &lt; currLLHSamp-&gt;GetNumberOfBins()+1; bin++)</div>
<div class="line"><span class="lineno"> 1215</span>              {</div>
<div class="line"><span class="lineno"> 1216</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> mc = MCpdf-&gt;GetBinContent(bin);</div>
<div class="line"><span class="lineno"> 1217</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> dat = Datapdf-&gt;GetBinContent(bin);</div>
<div class="line"><span class="lineno"> 1218</span>                <span class="keyword">const</span> <span class="keywordtype">double</span> w2 = W2pdf-&gt;GetBinContent(bin);</div>
<div class="line"><span class="lineno"> 1219</span>                currLLHSamp-&gt;SetBinContent(bin, <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;getTestStatLLH(dat, mc, w2));</div>
<div class="line"><span class="lineno"> 1220</span>              }</div>
<div class="line"><span class="lineno"> 1221</span>              currLLHSamp-&gt;SetNameTitle((title_long+<span class="stringliteral">&quot;_LLH&quot;</span>).c_str() ,(title_long+<span class="stringliteral">&quot;_LLH&quot;</span>).c_str());</div>
<div class="line"><span class="lineno"> 1222</span>              dirArrySample[SampleIterator]-&gt;cd();</div>
<div class="line"><span class="lineno"> 1223</span>              currLLHSamp-&gt;Write();</div>
<div class="line"><span class="lineno"> 1224</span>            }</div>
<div class="line"><span class="lineno"> 1225</span> </div>
<div class="line"><span class="lineno"> 1226</span>            <span class="comment">// Project down onto x axis</span></div>
<div class="line"><span class="lineno"> 1227</span>            sigmaArray_x[j][SampleIterator] = <a class="code hl_function" href="HistogramUtils_8cpp.html#a1ab7c868447cffff71227e07655b47ad">PolyProjectionX</a>(currSamp.get(), (title_long+<span class="stringliteral">&quot;_xProj&quot;</span>).c_str(), xbins);</div>
<div class="line"><span class="lineno"> 1228</span>            sigmaArray_x[j][SampleIterator]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1229</span>            sigmaArray_x[j][SampleIterator]-&gt;GetXaxis()-&gt;SetTitle(currSamp-&gt;GetXaxis()-&gt;GetTitle());</div>
<div class="line"><span class="lineno"> 1230</span>            sigmaArray_y[j][SampleIterator] = <a class="code hl_function" href="HistogramUtils_8cpp.html#aa26af438a657c81f2fb3f1506c6e35f6">PolyProjectionY</a>(currSamp.get(), (title_long+<span class="stringliteral">&quot;_yProj&quot;</span>).c_str(), ybins);</div>
<div class="line"><span class="lineno"> 1231</span>            sigmaArray_y[j][SampleIterator]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1232</span>            sigmaArray_y[j][SampleIterator]-&gt;GetXaxis()-&gt;SetTitle(currSamp-&gt;GetYaxis()-&gt;GetTitle());</div>
<div class="line"><span class="lineno"> 1233</span> </div>
<div class="line"><span class="lineno"> 1234</span>            sigmaArray_x_norm[j][SampleIterator] = <span class="keyword">static_cast&lt;</span>TH1D*<span class="keyword">&gt;</span>(sigmaArray_x[j][SampleIterator]-&gt;Clone());</div>
<div class="line"><span class="lineno"> 1235</span>            sigmaArray_x_norm[j][SampleIterator]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1236</span>            sigmaArray_x_norm[j][SampleIterator]-&gt;Scale(1., <span class="stringliteral">&quot;width&quot;</span>);</div>
<div class="line"><span class="lineno"> 1237</span>            sigmaArray_y_norm[j][SampleIterator] = <span class="keyword">static_cast&lt;</span>TH1D*<span class="keyword">&gt;</span>(sigmaArray_y[j][SampleIterator]-&gt;Clone());</div>
<div class="line"><span class="lineno"> 1238</span>            sigmaArray_y_norm[j][SampleIterator]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1239</span>            sigmaArray_y_norm[j][SampleIterator]-&gt;Scale(1., <span class="stringliteral">&quot;width&quot;</span>);</div>
<div class="line"><span class="lineno"> 1240</span> </div>
<div class="line"><span class="lineno"> 1241</span>            currSamp-&gt;SetNameTitle(title_long.c_str(), title_long.c_str());</div>
<div class="line"><span class="lineno"> 1242</span>            dirArrySample[k]-&gt;cd();</div>
<div class="line"><span class="lineno"> 1243</span>            currSamp-&gt;Write();</div>
<div class="line"><span class="lineno"> 1244</span> </div>
<div class="line"><span class="lineno"> 1245</span>            sigmaArray_x[j][k]-&gt;Write();</div>
<div class="line"><span class="lineno"> 1246</span>            sigmaArray_y[j][k]-&gt;Write();</div>
<div class="line"><span class="lineno"> 1247</span>            SampleIterator++;</div>
<div class="line"><span class="lineno"> 1248</span>          }<span class="comment">//End loop over samples</span></div>
<div class="line"><span class="lineno"> 1249</span>        }</div>
<div class="line"><span class="lineno"> 1250</span>      } <span class="comment">// End looping over variation</span></div>
<div class="line"><span class="lineno"> 1251</span> </div>
<div class="line"><span class="lineno"> 1252</span>      <span class="comment">// Restore the parameter to prior value</span></div>
<div class="line"><span class="lineno"> 1253</span>      cov-&gt;setParProp(i, init);</div>
<div class="line"><span class="lineno"> 1254</span> </div>
<div class="line"><span class="lineno"> 1255</span>      SampleIterator = 0;</div>
<div class="line"><span class="lineno"> 1256</span>      <span class="comment">// Get each sample and how it&#39;s responded to our reweighted parameter</span></div>
<div class="line"><span class="lineno"> 1257</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivs = 0; ivs &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ivs++ )</div>
<div class="line"><span class="lineno"> 1258</span>      {</div>
<div class="line"><span class="lineno"> 1259</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;GetNsamples(); ++k)</div>
<div class="line"><span class="lineno"> 1260</span>        {</div>
<div class="line"><span class="lineno"> 1261</span>          std::string title = std::string(<a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;getPDF(k)-&gt;<a class="code hl_function" href="classFitterBase.html#a3706f6d722073b447b3de8c3a6516601">GetName</a>()) + <span class="stringliteral">&quot;_&quot;</span> + name;</div>
<div class="line"><span class="lineno"> 1262</span>          TGraphAsymmErrors *var_x = <a class="code hl_function" href="HistogramUtils_8cpp.html#a3b61160c5ff362348884cb311e827221">MakeAsymGraph</a>(sigmaArray_x[1][SampleIterator], sigmaArray_x[2][SampleIterator], sigmaArray_x[3][SampleIterator], (title+<span class="stringliteral">&quot;_X&quot;</span>).c_str());</div>
<div class="line"><span class="lineno"> 1263</span>          TGraphAsymmErrors *var_y = <a class="code hl_function" href="HistogramUtils_8cpp.html#a3b61160c5ff362348884cb311e827221">MakeAsymGraph</a>(sigmaArray_y[1][SampleIterator], sigmaArray_y[2][SampleIterator], sigmaArray_y[3][SampleIterator], (title+<span class="stringliteral">&quot;_Y&quot;</span>).c_str());</div>
<div class="line"><span class="lineno"> 1264</span> </div>
<div class="line"><span class="lineno"> 1265</span>          TGraphAsymmErrors *var_x_norm = <a class="code hl_function" href="HistogramUtils_8cpp.html#a3b61160c5ff362348884cb311e827221">MakeAsymGraph</a>(sigmaArray_x_norm[1][SampleIterator], sigmaArray_x_norm[2][SampleIterator], sigmaArray_x_norm[3][SampleIterator], (title+<span class="stringliteral">&quot;_X_norm&quot;</span>).c_str());</div>
<div class="line"><span class="lineno"> 1266</span>          TGraphAsymmErrors *var_y_norm = <a class="code hl_function" href="HistogramUtils_8cpp.html#a3b61160c5ff362348884cb311e827221">MakeAsymGraph</a>(sigmaArray_y_norm[1][SampleIterator], sigmaArray_y_norm[2][SampleIterator], sigmaArray_y_norm[3][SampleIterator], (title+<span class="stringliteral">&quot;_Y_norm&quot;</span>).c_str());</div>
<div class="line"><span class="lineno"> 1267</span> </div>
<div class="line"><span class="lineno"> 1268</span>          dirArrySample[SampleIterator]-&gt;cd();</div>
<div class="line"><span class="lineno"> 1269</span>          var_x-&gt;Write();</div>
<div class="line"><span class="lineno"> 1270</span>          var_y-&gt;Write();</div>
<div class="line"><span class="lineno"> 1271</span>          var_x_norm-&gt;Write();</div>
<div class="line"><span class="lineno"> 1272</span>          var_y_norm-&gt;Write();</div>
<div class="line"><span class="lineno"> 1273</span>          <span class="keyword">delete</span> var_x;</div>
<div class="line"><span class="lineno"> 1274</span>          <span class="keyword">delete</span> var_y;</div>
<div class="line"><span class="lineno"> 1275</span>          <span class="keyword">delete</span> var_x_norm;</div>
<div class="line"><span class="lineno"> 1276</span>          <span class="keyword">delete</span> var_y_norm;</div>
<div class="line"><span class="lineno"> 1277</span> </div>
<div class="line"><span class="lineno"> 1278</span>          <span class="comment">//KS: here we loop over all reaction modes defined in &quot;RelevantModes[nRelevantModes]&quot;</span></div>
<div class="line"><span class="lineno"> 1279</span>          <span class="keywordflow">if</span> (DoByMode)</div>
<div class="line"><span class="lineno"> 1280</span>          {</div>
<div class="line"><span class="lineno"> 1281</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ir = 0; ir &lt; nRelevantModes;ir++)</div>
<div class="line"><span class="lineno"> 1282</span>            {</div>
<div class="line"><span class="lineno"> 1283</span>              TGraphAsymmErrors* var_mode_x = <a class="code hl_function" href="HistogramUtils_8cpp.html#a3b61160c5ff362348884cb311e827221">MakeAsymGraph</a>(sigmaArray_mode_x[1][SampleIterator][ir], sigmaArray_mode_x[2][SampleIterator][ir], sigmaArray_mode_x[3][SampleIterator][ir], (title+<span class="stringliteral">&quot;_&quot;</span>+<a class="code hl_variable" href="classFitterBase.html#a004cb6e6168032d9280ce3db912f1a43">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#abf4ac35511787907bc16ae26aa6c2a15">GetMaCh3ModeName</a>(RelevantModes[ir])+<span class="stringliteral">&quot;_X&quot;</span>).c_str());</div>
<div class="line"><span class="lineno"> 1284</span>              TGraphAsymmErrors* var_mode_y = <a class="code hl_function" href="HistogramUtils_8cpp.html#a3b61160c5ff362348884cb311e827221">MakeAsymGraph</a>(sigmaArray_mode_y[1][SampleIterator][ir], sigmaArray_mode_y[2][SampleIterator][ir], sigmaArray_mode_y[3][SampleIterator][ir], (title+<span class="stringliteral">&quot;_&quot;</span>+<a class="code hl_variable" href="classFitterBase.html#a004cb6e6168032d9280ce3db912f1a43">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#abf4ac35511787907bc16ae26aa6c2a15">GetMaCh3ModeName</a>(RelevantModes[ir])+<span class="stringliteral">&quot;_Y&quot;</span>).c_str());</div>
<div class="line"><span class="lineno"> 1285</span> </div>
<div class="line"><span class="lineno"> 1286</span>              dirArrySample[SampleIterator]-&gt;cd();</div>
<div class="line"><span class="lineno"> 1287</span>              var_mode_x-&gt;Write();</div>
<div class="line"><span class="lineno"> 1288</span>              var_mode_y-&gt;Write();</div>
<div class="line"><span class="lineno"> 1289</span> </div>
<div class="line"><span class="lineno"> 1290</span>              <span class="keyword">delete</span> var_mode_x;</div>
<div class="line"><span class="lineno"> 1291</span>              <span class="keyword">delete</span> var_mode_y;</div>
<div class="line"><span class="lineno"> 1292</span>            } <span class="comment">// end for nRelevantModes</span></div>
<div class="line"><span class="lineno"> 1293</span>          } <span class="comment">// end if mode</span></div>
<div class="line"><span class="lineno"> 1294</span> </div>
<div class="line"><span class="lineno"> 1295</span>          SampleIterator++;</div>
<div class="line"><span class="lineno"> 1296</span>        }<span class="comment">//End loop over samples(k)</span></div>
<div class="line"><span class="lineno"> 1297</span>      }<span class="comment">//end looping over sample object</span></div>
<div class="line"><span class="lineno"> 1298</span>      SampleIterator = 0;</div>
<div class="line"><span class="lineno"> 1299</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivs = 0; ivs &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ivs++ )</div>
<div class="line"><span class="lineno"> 1300</span>      {</div>
<div class="line"><span class="lineno"> 1301</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;GetNsamples(); ++k)</div>
<div class="line"><span class="lineno"> 1302</span>        {</div>
<div class="line"><span class="lineno"> 1303</span>          dirArrySample[SampleIterator]-&gt;Close();</div>
<div class="line"><span class="lineno"> 1304</span>          <span class="keyword">delete</span> dirArrySample[SampleIterator];</div>
<div class="line"><span class="lineno"> 1305</span>          SampleIterator++;</div>
<div class="line"><span class="lineno"> 1306</span>        }</div>
<div class="line"><span class="lineno"> 1307</span>      }</div>
<div class="line"><span class="lineno"> 1308</span>      <span class="keyword">delete</span>[] dirArrySample;</div>
<div class="line"><span class="lineno"> 1309</span> </div>
<div class="line"><span class="lineno"> 1310</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; numVar; ++j)</div>
<div class="line"><span class="lineno"> 1311</span>      {</div>
<div class="line"><span class="lineno"> 1312</span>        SampleIterator = 0;</div>
<div class="line"><span class="lineno"> 1313</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivs = 0; ivs &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ivs++ )</div>
<div class="line"><span class="lineno"> 1314</span>        {</div>
<div class="line"><span class="lineno"> 1315</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;GetNsamples(); ++k)</div>
<div class="line"><span class="lineno"> 1316</span>          {</div>
<div class="line"><span class="lineno"> 1317</span>            <span class="keyword">delete</span> sigmaArray_x[j][SampleIterator];</div>
<div class="line"><span class="lineno"> 1318</span>            <span class="keyword">delete</span> sigmaArray_y[j][SampleIterator];</div>
<div class="line"><span class="lineno"> 1319</span>            <span class="keyword">delete</span> sigmaArray_x_norm[j][SampleIterator];</div>
<div class="line"><span class="lineno"> 1320</span>            <span class="keyword">delete</span> sigmaArray_y_norm[j][SampleIterator];</div>
<div class="line"><span class="lineno"> 1321</span>            SampleIterator++;</div>
<div class="line"><span class="lineno"> 1322</span>          }</div>
<div class="line"><span class="lineno"> 1323</span>        }</div>
<div class="line"><span class="lineno"> 1324</span>        <span class="keyword">delete</span>[] sigmaArray_x[j];</div>
<div class="line"><span class="lineno"> 1325</span>        <span class="keyword">delete</span>[] sigmaArray_y[j];</div>
<div class="line"><span class="lineno"> 1326</span>        <span class="keyword">delete</span>[] sigmaArray_x_norm[j];</div>
<div class="line"><span class="lineno"> 1327</span>        <span class="keyword">delete</span>[] sigmaArray_y_norm[j];</div>
<div class="line"><span class="lineno"> 1328</span>      }</div>
<div class="line"><span class="lineno"> 1329</span>      <span class="keyword">delete</span>[] sigmaArray_x;</div>
<div class="line"><span class="lineno"> 1330</span>      <span class="keyword">delete</span>[] sigmaArray_y;</div>
<div class="line"><span class="lineno"> 1331</span>      <span class="keyword">delete</span>[] sigmaArray_x_norm;</div>
<div class="line"><span class="lineno"> 1332</span>      <span class="keyword">delete</span>[] sigmaArray_y_norm;</div>
<div class="line"><span class="lineno"> 1333</span> </div>
<div class="line"><span class="lineno"> 1334</span>      dirArryDial-&gt;Close();</div>
<div class="line"><span class="lineno"> 1335</span>      <span class="keyword">delete</span> dirArryDial;</div>
<div class="line"><span class="lineno"> 1336</span> </div>
<div class="line"><span class="lineno"> 1337</span>      <span class="keywordflow">if</span> (DoByMode)</div>
<div class="line"><span class="lineno"> 1338</span>      {</div>
<div class="line"><span class="lineno"> 1339</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; numVar; ++j)</div>
<div class="line"><span class="lineno"> 1340</span>        {</div>
<div class="line"><span class="lineno"> 1341</span>          SampleIterator = 0;</div>
<div class="line"><span class="lineno"> 1342</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ivs = 0; ivs &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ivs++ )</div>
<div class="line"><span class="lineno"> 1343</span>          {</div>
<div class="line"><span class="lineno"> 1344</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[ivs]-&gt;GetNsamples(); ++k)</div>
<div class="line"><span class="lineno"> 1345</span>            {</div>
<div class="line"><span class="lineno"> 1346</span>              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ir = 0; ir &lt; nRelevantModes;ir++)</div>
<div class="line"><span class="lineno"> 1347</span>              {</div>
<div class="line"><span class="lineno"> 1348</span>                <span class="keyword">delete</span> sigmaArray_mode_x[j][SampleIterator][ir];</div>
<div class="line"><span class="lineno"> 1349</span>                <span class="keyword">delete</span> sigmaArray_mode_y[j][SampleIterator][ir];</div>
<div class="line"><span class="lineno"> 1350</span>              }<span class="comment">// end for nRelevantModes</span></div>
<div class="line"><span class="lineno"> 1351</span>              <span class="keyword">delete</span>[] sigmaArray_mode_x[j][SampleIterator];</div>
<div class="line"><span class="lineno"> 1352</span>              <span class="keyword">delete</span>[] sigmaArray_mode_y[j][SampleIterator];</div>
<div class="line"><span class="lineno"> 1353</span>              SampleIterator++;</div>
<div class="line"><span class="lineno"> 1354</span>            }<span class="comment">// end for samples</span></div>
<div class="line"><span class="lineno"> 1355</span>          }</div>
<div class="line"><span class="lineno"> 1356</span>        }</div>
<div class="line"><span class="lineno"> 1357</span>        <span class="keyword">delete</span>[] sigmaArray_mode_x;</div>
<div class="line"><span class="lineno"> 1358</span>        <span class="keyword">delete</span>[] sigmaArray_mode_y;</div>
<div class="line"><span class="lineno"> 1359</span>      }</div>
<div class="line"><span class="lineno"> 1360</span>    } <span class="comment">// end looping over xsec parameters (i)</span></div>
<div class="line"><span class="lineno"> 1361</span>  } <span class="comment">// end looping over covarianceBase objects</span></div>
<div class="line"><span class="lineno"> 1362</span>}</div>
<div class="ttc" id="aHistogramUtils_8cpp_html_a1ab7c868447cffff71227e07655b47ad"><div class="ttname"><a href="HistogramUtils_8cpp.html#a1ab7c868447cffff71227e07655b47ad">PolyProjectionX</a></div><div class="ttdeci">TH1D * PolyProjectionX(TObject *poly, std::string TempName, const std::vector&lt; double &gt; &amp;xbins, const bool computeErrors)</div><div class="ttdoc">WP: Poly Projectors.</div><div class="ttdef"><b>Definition:</b> <a href="HistogramUtils_8cpp_source.html#l00069">HistogramUtils.cpp:69</a></div></div>
<div class="ttc" id="aHistogramUtils_8cpp_html_a3b61160c5ff362348884cb311e827221"><div class="ttname"><a href="HistogramUtils_8cpp.html#a3b61160c5ff362348884cb311e827221">MakeAsymGraph</a></div><div class="ttdeci">TGraphAsymmErrors * MakeAsymGraph(TH1D *sigmaArrayLeft, TH1D *sigmaArrayCentr, TH1D *sigmaArrayRight, const std::string &amp;title)</div><div class="ttdoc">Used by sigma variation, check how 1 sigma changes spectra.</div><div class="ttdef"><b>Definition:</b> <a href="HistogramUtils_8cpp_source.html#l00522">HistogramUtils.cpp:522</a></div></div>
<div class="ttc" id="aHistogramUtils_8cpp_html_aa26af438a657c81f2fb3f1506c6e35f6"><div class="ttname"><a href="HistogramUtils_8cpp.html#aa26af438a657c81f2fb3f1506c6e35f6">PolyProjectionY</a></div><div class="ttdeci">TH1D * PolyProjectionY(TObject *poly, std::string TempName, const std::vector&lt; double &gt; &amp;ybins, const bool computeErrors)</div><div class="ttdoc">WP: Poly Projectors.</div><div class="ttdef"><b>Definition:</b> <a href="HistogramUtils_8cpp_source.html#l00137">HistogramUtils.cpp:137</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_a61052119a625282d0ec6d4a97adf3ee2"><div class="ttname"><a href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a></div><div class="ttdeci">#define MACH3LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00021">MaCh3Logger.h:21</a></div></div>
<div class="ttc" id="aMaCh3Modes_8h_html_adf43f6c73c9598abc381855d31ef5682"><div class="ttname"><a href="MaCh3Modes_8h.html#adf43f6c73c9598abc381855d31ef5682">MaCh3Modes_t</a></div><div class="ttdeci">int MaCh3Modes_t</div><div class="ttdoc">Enumerator of MaCh3Mode.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Modes_8h_source.html#l00014">MaCh3Modes.h:14</a></div></div>
<div class="ttc" id="aclassFitterBase_html_a3706f6d722073b447b3de8c3a6516601"><div class="ttname"><a href="classFitterBase.html#a3706f6d722073b447b3de8c3a6516601">FitterBase::GetName</a></div><div class="ttdeci">virtual std::string GetName() const</div><div class="ttdoc">Get name of class.</div><div class="ttdef"><b>Definition:</b> <a href="FitterBase_8h_source.html#l00066">FitterBase.h:66</a></div></div>
<div class="ttc" id="aclassMaCh3Exception_html"><div class="ttname"><a href="classMaCh3Exception.html">MaCh3Exception</a></div><div class="ttdoc">Custom exception class for MaCh3 errors.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Exception_8h_source.html#l00012">MaCh3Exception.h:12</a></div></div>
<div class="ttc" id="aclassMaCh3Modes_html_a21af1738d7b145f08d76aa0c163e0486"><div class="ttname"><a href="classMaCh3Modes.html#a21af1738d7b145f08d76aa0c163e0486">MaCh3Modes::GetMode</a></div><div class="ttdeci">MaCh3Modes_t GetMode(const std::string &amp;name)</div><div class="ttdoc">KS: Get mode number based on name, if mode not known you will get UNKNOWN_BAD.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Modes_8cpp_source.html#l00154">MaCh3Modes.cpp:154</a></div></div>
<div class="ttc" id="aclassMaCh3Modes_html_abf4ac35511787907bc16ae26aa6c2a15"><div class="ttname"><a href="classMaCh3Modes.html#abf4ac35511787907bc16ae26aa6c2a15">MaCh3Modes::GetMaCh3ModeName</a></div><div class="ttdeci">std::string GetMaCh3ModeName(const int Index)</div><div class="ttdoc">KS: Get normal name of mode, if mode not known you will get UNKNOWN_BAD.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Modes_8cpp_source.html#l00124">MaCh3Modes.cpp:124</a></div></div>
<div class="ttc" id="anamespaceM3_html_adb59b8ecdc4e1b2d5d4c826a13aa7463"><div class="ttname"><a href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a></div><div class="ttdeci">int int_t</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00016">Structs.h:16</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a418f581b688f035211107ddd83168c08" name="a418f581b688f035211107ddd83168c08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a418f581b688f035211107ddd83168c08">&#9670;&#160;</a></span>SaveOutput()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void FitterBase::SaveOutput </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Save output and close files. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00212">212</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  212</span>                            {</div>
<div class="line"><span class="lineno">  213</span><span class="comment">// *******************</span></div>
<div class="line"><span class="lineno">  214</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classFitterBase.html#a699abe6a2c89706b54544212152d613a">FileSaved</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  215</span>  <span class="comment">//Stop Clock</span></div>
<div class="line"><span class="lineno">  216</span>  <a class="code hl_variable" href="classFitterBase.html#a858edb45544f690e90b60b9e041394a6">clock</a>-&gt;Stop();</div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>  <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  219</span>  <a class="code hl_variable" href="classFitterBase.html#aed2032b9c4a4f2248abe548f54f8dcc8">outTree</a>-&gt;Write();</div>
<div class="line"><span class="lineno">  220</span> </div>
<div class="line"><span class="lineno">  221</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{} steps took {:.2f} seconds to complete. ({:.2f}s / step).&quot;</span>, <a class="code hl_variable" href="classFitterBase.html#a50df1bd75b20a953f81ab9c2bab6b42c">step</a>, <a class="code hl_variable" href="classFitterBase.html#a858edb45544f690e90b60b9e041394a6">clock</a>-&gt;RealTime(), <a class="code hl_variable" href="classFitterBase.html#a858edb45544f690e90b60b9e041394a6">clock</a>-&gt;RealTime() / <a class="code hl_variable" href="classFitterBase.html#a50df1bd75b20a953f81ab9c2bab6b42c">step</a>);</div>
<div class="line"><span class="lineno">  222</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{} steps were accepted.&quot;</span>, <a class="code hl_variable" href="classFitterBase.html#a2774f3a0047c4347ee0db05406425f79">accCount</a>);</div>
<div class="line"><span class="lineno">  223</span><span class="preprocessor">  #ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  224</span>  <span class="keywordflow">if</span> (debug)</div>
<div class="line"><span class="lineno">  225</span>  {</div>
<div class="line"><span class="lineno">  226</span>    debugFile &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span> &lt;&lt; <a class="code hl_variable" href="classFitterBase.html#a50df1bd75b20a953f81ab9c2bab6b42c">step</a> &lt;&lt; <span class="stringliteral">&quot; steps took &quot;</span> &lt;&lt; <a class="code hl_variable" href="classFitterBase.html#a858edb45544f690e90b60b9e041394a6">clock</a>-&gt;RealTime() &lt;&lt; <span class="stringliteral">&quot; seconds to complete. (&quot;</span> &lt;&lt; <a class="code hl_variable" href="classFitterBase.html#a858edb45544f690e90b60b9e041394a6">clock</a>-&gt;RealTime() / <a class="code hl_variable" href="classFitterBase.html#a50df1bd75b20a953f81ab9c2bab6b42c">step</a> &lt;&lt; <span class="stringliteral">&quot;s / step).\n&quot;</span> &lt;&lt; <a class="code hl_variable" href="classFitterBase.html#a2774f3a0047c4347ee0db05406425f79">accCount</a>&lt;&lt; <span class="stringliteral">&quot; steps were accepted.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  227</span>    debugFile.close();</div>
<div class="line"><span class="lineno">  228</span>  }</div>
<div class="line"><span class="lineno">  229</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  230</span> </div>
<div class="line"><span class="lineno">  231</span>  <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;Close();</div>
<div class="line"><span class="lineno">  232</span>  <a class="code hl_variable" href="classFitterBase.html#a699abe6a2c89706b54544212152d613a">FileSaved</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  233</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a48f38bfa8996fe00d51f35b05dd16b46" name="a48f38bfa8996fe00d51f35b05dd16b46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48f38bfa8996fe00d51f35b05dd16b46">&#9670;&#160;</a></span>SaveSettings()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void FitterBase::SaveSettings </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Save the settings that the MCMC was run with. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00084">84</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   84</span>                              {</div>
<div class="line"><span class="lineno">   85</span><span class="comment">// *******************</span></div>
<div class="line"><span class="lineno">   86</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classFitterBase.html#a588678c71d816f48ba3c140543dbe916">SettingsSaved</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span>  <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">   89</span> </div>
<div class="line"><span class="lineno">   90</span>  TDirectory* MaCh3Version = <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;MaCh3Engine&quot;</span>);</div>
<div class="line"><span class="lineno">   91</span>  MaCh3Version-&gt;cd();</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>  <span class="keywordflow">if</span> (std::getenv(<span class="stringliteral">&quot;MaCh3_ROOT&quot;</span>) == NULL) {</div>
<div class="line"><span class="lineno">   94</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Need MaCh3_ROOT environment variable&quot;</span>);</div>
<div class="line"><span class="lineno">   95</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Please remember about source bin/setup.MaCh3.sh&quot;</span>);</div>
<div class="line"><span class="lineno">   96</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">   97</span>  }</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>  <span class="keywordflow">if</span> (std::getenv(<span class="stringliteral">&quot;MACH3&quot;</span>) == NULL) {</div>
<div class="line"><span class="lineno">  100</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Need MACH3 environment variable&quot;</span>);</div>
<div class="line"><span class="lineno">  101</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">  102</span>  }</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>  std::string header_path = std::string(std::getenv(<span class="stringliteral">&quot;MACH3&quot;</span>));</div>
<div class="line"><span class="lineno">  105</span>  header_path += <span class="stringliteral">&quot;/version.h&quot;</span>;</div>
<div class="line"><span class="lineno">  106</span>  FILE* file = fopen(header_path.c_str(), <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="lineno">  107</span>  <span class="comment">//KS: It is better to use experiment specific header file. If given experiment didn&#39;t provide it we gonna use one given by Core MaCh3.</span></div>
<div class="line"><span class="lineno">  108</span>  <span class="keywordflow">if</span> (!file)</div>
<div class="line"><span class="lineno">  109</span>  {</div>
<div class="line"><span class="lineno">  110</span>    header_path = std::string(std::getenv(<span class="stringliteral">&quot;MaCh3_ROOT&quot;</span>));</div>
<div class="line"><span class="lineno">  111</span>    header_path += <span class="stringliteral">&quot;/version.h&quot;</span>;</div>
<div class="line"><span class="lineno">  112</span>  }</div>
<div class="line"><span class="lineno">  113</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  114</span>  {</div>
<div class="line"><span class="lineno">  115</span>    fclose(file);</div>
<div class="line"><span class="lineno">  116</span>  }</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>  <span class="comment">// EM: embed the cmake generated version.h file</span></div>
<div class="line"><span class="lineno">  119</span>  TMacro versionHeader(<span class="stringliteral">&quot;version_header&quot;</span>, <span class="stringliteral">&quot;version_header&quot;</span>);</div>
<div class="line"><span class="lineno">  120</span>  versionHeader.ReadFile(header_path.c_str());</div>
<div class="line"><span class="lineno">  121</span>  versionHeader.Write();</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>  TNamed Engine(<a class="code hl_function" href="classFitterBase.html#a3706f6d722073b447b3de8c3a6516601">GetName</a>(), <a class="code hl_function" href="classFitterBase.html#a3706f6d722073b447b3de8c3a6516601">GetName</a>());</div>
<div class="line"><span class="lineno">  124</span>  Engine.Write(<a class="code hl_function" href="classFitterBase.html#a3706f6d722073b447b3de8c3a6516601">GetName</a>().c_str());</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>  MaCh3Version-&gt;Write();</div>
<div class="line"><span class="lineno">  127</span>  <span class="keyword">delete</span> MaCh3Version;</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span>  <a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>  <a class="code hl_variable" href="classFitterBase.html#a4fceb68f242feeb04a0ddf42a5a37095">fitMan</a>-&gt;<a class="code hl_function" href="classmanager.html#a0990af01a220479a19ead5d0231aaf94">SaveSettings</a>(<a class="code hl_variable" href="classFitterBase.html#a4260b312e3f35cf01fc73b02239f8990">outputFile</a>);</div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;\033[0;31mCurrent Total RAM usage is {:.2f} GB\033[0m&quot;</span>, <a class="code hl_function" href="namespaceMaCh3Utils.html#aa406fc13341d99d4ca7a4f43bbb38019">MaCh3Utils::getValue</a>(<span class="stringliteral">&quot;VmRSS&quot;</span>) / 1048576.0);</div>
<div class="line"><span class="lineno">  134</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;\033[0;31mOut of Total available RAM {:.2f} GB\033[0m&quot;</span>, <a class="code hl_function" href="namespaceMaCh3Utils.html#aa406fc13341d99d4ca7a4f43bbb38019">MaCh3Utils::getValue</a>(<span class="stringliteral">&quot;MemTotal&quot;</span>) / 1048576.0);</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;#####Current Setup#####&quot;</span>);</div>
<div class="line"><span class="lineno">  137</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Number of covariances: {}&quot;</span>, <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size());</div>
<div class="line"><span class="lineno">  138</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); ++i)</div>
<div class="line"><span class="lineno">  139</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{}: Cov name: {}, it has {} params&quot;</span>, i, <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[i]-&gt;getName(), <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[i]-&gt;GetNumParams());</div>
<div class="line"><span class="lineno">  140</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Number of SamplePDFs: {}&quot;</span>, <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size());</div>
<div class="line"><span class="lineno">  141</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>.size(); ++i)</div>
<div class="line"><span class="lineno">  142</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{}: SamplePDF name: {}, it has {} samples&quot;</span>,i , <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[i]-&gt;<a class="code hl_function" href="classFitterBase.html#a3706f6d722073b447b3de8c3a6516601">GetName</a>(), <a class="code hl_variable" href="classFitterBase.html#afac0dcceb1df194159c07945e8dc0069">samples</a>[i]-&gt;GetNsamples());</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>  <a class="code hl_variable" href="classFitterBase.html#a588678c71d816f48ba3c140543dbe916">SettingsSaved</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  145</span>}</div>
<div class="ttc" id="aclassmanager_html_a0990af01a220479a19ead5d0231aaf94"><div class="ttname"><a href="classmanager.html#a0990af01a220479a19ead5d0231aaf94">manager::SaveSettings</a></div><div class="ttdeci">void SaveSettings(TFile *const OutputFile)</div><div class="ttdoc">Add manager useful information's to TFile, in most cases to Fitter.</div><div class="ttdef"><b>Definition:</b> <a href="manager_2manager_8cpp_source.html#l00042">manager.cpp:42</a></div></div>
<div class="ttc" id="anamespaceMaCh3Utils_html_aa406fc13341d99d4ca7a4f43bbb38019"><div class="ttname"><a href="namespaceMaCh3Utils.html#aa406fc13341d99d4ca7a4f43bbb38019">MaCh3Utils::getValue</a></div><div class="ttdeci">int getValue(const std::string &amp;Type)</div><div class="ttdoc">CW: Get info like RAM.</div><div class="ttdef"><b>Definition:</b> <a href="Monitor_8cpp_source.html#l00207">Monitor.cpp:207</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a655ccea31627627e2b36745c97e5c0f0" name="a655ccea31627627e2b36745c97e5c0f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a655ccea31627627e2b36745c97e5c0f0">&#9670;&#160;</a></span>StartFromPreviousFit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void FitterBase::StartFromPreviousFit </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>FitName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allow to start from previous fit/chain. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">FitName</td><td>Name of previous chain </td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000006">Todo:</a></b></dt><dd>implement some check that number of params matches etc </dd></dl>

<p>Reimplemented in <a class="el" href="classmcmc.html#adf4c80255288c5396da3b95d609ce4b2">mcmc</a>.</p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8cpp_source.html#l00281">281</a> of file <a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  281</span>                                                              {</div>
<div class="line"><span class="lineno">  282</span><span class="comment">// *******************</span></div>
<div class="line"><span class="lineno">  283</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Getting starting position from {}&quot;</span>, FitName);</div>
<div class="line"><span class="lineno">  284</span> </div>
<div class="line"><span class="lineno">  285</span>  TFile *infile = <span class="keyword">new</span> TFile(FitName.c_str(), <span class="stringliteral">&quot;READ&quot;</span>);</div>
<div class="line"><span class="lineno">  286</span>  TTree *posts = infile-&gt;Get&lt;TTree&gt;(<span class="stringliteral">&quot;posteriors&quot;</span>);</div>
<div class="line"><span class="lineno">  287</span>  <span class="keywordtype">int</span> step_val = 0;</div>
<div class="line"><span class="lineno">  288</span>  <span class="keywordtype">double</span> log_val = <a class="code hl_variable" href="covarianceBase_8h.html#abca890bf9293ecdebfc0494ce32cee96">_LARGE_LOGL_</a>;</div>
<div class="line"><span class="lineno">  289</span>  posts-&gt;SetBranchAddress(<span class="stringliteral">&quot;step&quot;</span>,&amp;step_val);</div>
<div class="line"><span class="lineno">  290</span>  posts-&gt;SetBranchAddress(<span class="stringliteral">&quot;LogL&quot;</span>,&amp;log_val);</div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  292</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> s = 0; s &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); ++s)</div>
<div class="line"><span class="lineno">  293</span>  {</div>
<div class="line"><span class="lineno">  294</span>    TDirectory* CovarianceFolder = infile-&gt;Get&lt;TDirectory&gt;(<span class="stringliteral">&quot;CovarianceFolder&quot;</span>);</div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span>    std::string ConfigName = <span class="stringliteral">&quot;Config_&quot;</span> + <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[s]-&gt;getName();</div>
<div class="line"><span class="lineno">  297</span>    TMacro *ConfigCov = CovarianceFolder-&gt;Get&lt;TMacro&gt;(ConfigName.c_str());</div>
<div class="line"><span class="lineno">  298</span>    <span class="comment">// KS: Not every covariance uses yaml, if it uses yaml make sure they are identical</span></div>
<div class="line"><span class="lineno">  299</span>    <span class="keywordflow">if</span> (ConfigCov != <span class="keyword">nullptr</span>) {</div>
<div class="line"><span class="lineno">  300</span>      <span class="comment">// Config which was in MCMC from which we are starting</span></div>
<div class="line"><span class="lineno">  301</span>      YAML::Node CovSettings = <a class="code hl_function" href="YamlHelper_8h.html#a7e0ade2fd295a927676c243c97d0aa64">TMacroToYAML</a>(*ConfigCov);</div>
<div class="line"><span class="lineno">  302</span>      <span class="comment">// Config from currently used cov object</span></div>
<div class="line"><span class="lineno">  303</span>      YAML::Node ConfigCurrent = <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[s]-&gt;GetConfig();</div>
<div class="line"><span class="lineno">  304</span> </div>
<div class="line"><span class="lineno">  305</span>      <span class="keywordflow">if</span> (!<a class="code hl_function" href="YamlHelper_8h.html#ab06d2acbecc5692cab63bdf679ef0034">compareYAMLNodes</a>(CovSettings, ConfigCurrent))</div>
<div class="line"><span class="lineno">  306</span>      {</div>
<div class="line"><span class="lineno">  307</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Yaml configs in previous chain and current one are different&quot;</span>, FitName);</div>
<div class="line"><span class="lineno">  308</span>        <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">  309</span>      }</div>
<div class="line"><span class="lineno">  310</span>    }</div>
<div class="line"><span class="lineno">  311</span>    <span class="keywordflow">if</span>(ConfigCov == <span class="keyword">nullptr</span>) <span class="keyword">delete</span> ConfigCov;</div>
<div class="line"><span class="lineno">  312</span> </div>
<div class="line"><span class="lineno">  313</span>    std::vector&lt;double&gt; branch_vals(<a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[s]-&gt;GetNumParams());</div>
<div class="line"><span class="lineno">  314</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[s]-&gt;GetNumParams(); ++i) {</div>
<div class="line"><span class="lineno">  315</span>      branch_vals[i] = <a class="code hl_variable" href="Structs_8h.html#aa2920b946077e971486eaf1b49101f01">_BAD_DOUBLE_</a>;</div>
<div class="line"><span class="lineno">  316</span>      posts-&gt;SetBranchAddress(<a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[s]-&gt;GetParName(i).c_str(), &amp;branch_vals[i]);</div>
<div class="line"><span class="lineno">  317</span>    }</div>
<div class="line"><span class="lineno">  318</span>    posts-&gt;GetEntry(posts-&gt;GetEntries()-1);</div>
<div class="line"><span class="lineno">  319</span> </div>
<div class="line"><span class="lineno">  320</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[s]-&gt;GetNumParams(); ++i) {</div>
<div class="line"><span class="lineno">  321</span>      <span class="keywordflow">if</span>(branch_vals[i] == <a class="code hl_variable" href="Structs_8h.html#aa2920b946077e971486eaf1b49101f01">_BAD_DOUBLE_</a>)</div>
<div class="line"><span class="lineno">  322</span>      {</div>
<div class="line"><span class="lineno">  323</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Parameter {} is unvitalised with value {}&quot;</span>, i, branch_vals[i]);</div>
<div class="line"><span class="lineno">  324</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Please check more precisely chain you passed {}&quot;</span>, FitName);</div>
<div class="line"><span class="lineno">  325</span>        <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">  326</span>      }</div>
<div class="line"><span class="lineno">  327</span>    }</div>
<div class="line"><span class="lineno">  328</span>    <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[s]-&gt;setParameters(branch_vals);</div>
<div class="line"><span class="lineno">  329</span>    <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[s]-&gt;acceptStep();</div>
<div class="line"><span class="lineno">  330</span> </div>
<div class="line"><span class="lineno">  331</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Printing new starting values for: {}&quot;</span>, <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[s]-&gt;getName());</div>
<div class="line"><span class="lineno">  332</span>    <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[s]-&gt;printNominalCurrProp();</div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span>    CovarianceFolder-&gt;Close();</div>
<div class="line"><span class="lineno">  335</span>    <span class="keyword">delete</span> CovarianceFolder;</div>
<div class="line"><span class="lineno">  336</span>  }</div>
<div class="line"><span class="lineno">  337</span>  <a class="code hl_variable" href="classFitterBase.html#abfb6f10720764d8bbbe43754fd5cd976">logLCurr</a> = log_val;</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>  infile-&gt;Close();</div>
<div class="line"><span class="lineno">  340</span>  <span class="keyword">delete</span> infile;</div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> s = 0; s &lt; <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>.size(); ++s) {</div>
<div class="line"><span class="lineno">  343</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[s]-&gt;getDoAdaption()){ <span class="comment">//Use separate throw matrix for xsec</span></div>
<div class="line"><span class="lineno">  344</span>      <a class="code hl_variable" href="classFitterBase.html#a3a15d2348b7bf0a639aaab52b9294bbf">systematics</a>[s]-&gt;setNumberOfSteps(step_val);</div>
<div class="line"><span class="lineno">  345</span>    }</div>
<div class="line"><span class="lineno">  346</span>  }</div>
<div class="line"><span class="lineno">  347</span>}</div>
<div class="ttc" id="aStructs_8h_html_aa2920b946077e971486eaf1b49101f01"><div class="ttname"><a href="Structs_8h.html#aa2920b946077e971486eaf1b49101f01">_BAD_DOUBLE_</a></div><div class="ttdeci">static constexpr const double _BAD_DOUBLE_</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00039">Structs.h:39</a></div></div>
<div class="ttc" id="aYamlHelper_8h_html_a7e0ade2fd295a927676c243c97d0aa64"><div class="ttname"><a href="YamlHelper_8h.html#a7e0ade2fd295a927676c243c97d0aa64">TMacroToYAML</a></div><div class="ttdeci">YAML::Node TMacroToYAML(const TMacro &amp;macro)</div><div class="ttdoc">KS: Convert a ROOT TMacro object to a YAML node.</div><div class="ttdef"><b>Definition:</b> <a href="YamlHelper_8h_source.html#l00148">YamlHelper.h:148</a></div></div>
<div class="ttc" id="aYamlHelper_8h_html_ab06d2acbecc5692cab63bdf679ef0034"><div class="ttname"><a href="YamlHelper_8h.html#ab06d2acbecc5692cab63bdf679ef0034">compareYAMLNodes</a></div><div class="ttdeci">bool compareYAMLNodes(const YAML::Node &amp;node1, const YAML::Node &amp;node2)</div><div class="ttdoc">Compare if yaml nodes are identical.</div><div class="ttdef"><b>Definition:</b> <a href="YamlHelper_8h_source.html#l00181">YamlHelper.h:181</a></div></div>
<div class="ttc" id="acovarianceBase_8h_html_abca890bf9293ecdebfc0494ce32cee96"><div class="ttname"><a href="covarianceBase_8h.html#abca890bf9293ecdebfc0494ce32cee96">_LARGE_LOGL_</a></div><div class="ttdeci">static constexpr const double _LARGE_LOGL_</div><div class="ttdoc">Large Likelihood is used it parameter go out of physical boundary, this indicates in MCMC that such s...</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00011">covarianceBase.h:11</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a2774f3a0047c4347ee0db05406425f79" name="a2774f3a0047c4347ee0db05406425f79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2774f3a0047c4347ee0db05406425f79">&#9670;&#160;</a></span>accCount</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int FitterBase::accCount</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>counts accepted steps </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00095">95</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a6319d2ea50984860475bbc6c708b0d90" name="a6319d2ea50984860475bbc6c708b0d90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6319d2ea50984860475bbc6c708b0d90">&#9670;&#160;</a></span>accProb</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double FitterBase::accProb</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>current acceptance prob </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00093">93</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="ad955982e63066918cba9c53381608d09" name="ad955982e63066918cba9c53381608d09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad955982e63066918cba9c53381608d09">&#9670;&#160;</a></span>auto_save</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int FitterBase::auto_save</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>auto save every N steps </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00127">127</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a858edb45544f690e90b60b9e041394a6" name="a858edb45544f690e90b60b9e041394a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a858edb45544f690e90b60b9e041394a6">&#9670;&#160;</a></span>clock</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;TStopwatch&gt; FitterBase::clock</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>tells global time how long fit took </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00111">111</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="aacc46437245ba8a9817f2ed2e86a96e0" name="aacc46437245ba8a9817f2ed2e86a96e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacc46437245ba8a9817f2ed2e86a96e0">&#9670;&#160;</a></span>CovFolder</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TDirectory* FitterBase::CovFolder</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Output cov folder. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00123">123</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a699abe6a2c89706b54544212152d613a" name="a699abe6a2c89706b54544212152d613a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a699abe6a2c89706b54544212152d613a">&#9670;&#160;</a></span>FileSaved</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool FitterBase::FileSaved</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if file saved not repeat some operations. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00137">137</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a4fceb68f242feeb04a0ddf42a5a37095" name="a4fceb68f242feeb04a0ddf42a5a37095"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fceb68f242feeb04a0ddf42a5a37095">&#9670;&#160;</a></span>fitMan</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmanager.html">manager</a>* FitterBase::fitMan</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The manager. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00081">81</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="ada898e35bab22af470f2cd1e28af609b" name="ada898e35bab22af470f2cd1e28af609b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada898e35bab22af470f2cd1e28af609b">&#9670;&#160;</a></span>fTestLikelihood</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool FitterBase::fTestLikelihood</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Necessary for some fitting algorithms like <a class="el" href="classPSO.html" title="Class PSO, consist of a vector of object Class Particle and global best Takes in the size (number of ...">PSO</a>. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00130">130</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="abfb6f10720764d8bbbe43754fd5cd976" name="abfb6f10720764d8bbbe43754fd5cd976"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfb6f10720764d8bbbe43754fd5cd976">&#9670;&#160;</a></span>logLCurr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double FitterBase::logLCurr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>current likelihood </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00089">89</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a187dd22c17f9e96e5a7e2fb2371abace" name="a187dd22c17f9e96e5a7e2fb2371abace"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a187dd22c17f9e96e5a7e2fb2371abace">&#9670;&#160;</a></span>logLProp</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double FitterBase::logLProp</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>proposed likelihood </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00091">91</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a004cb6e6168032d9280ce3db912f1a43" name="a004cb6e6168032d9280ce3db912f1a43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a004cb6e6168032d9280ce3db912f1a43">&#9670;&#160;</a></span>Modes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMaCh3Modes.html">MaCh3Modes</a>* FitterBase::Modes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>MaCh3 Modes. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00084">84</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a4260b312e3f35cf01fc73b02239f8990" name="a4260b312e3f35cf01fc73b02239f8990"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4260b312e3f35cf01fc73b02239f8990">&#9670;&#160;</a></span>outputFile</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TFile* FitterBase::outputFile</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Output. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00121">121</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a3bfd8f69df891d03bae0587cd1a1e1b7" name="a3bfd8f69df891d03bae0587cd1a1e1b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bfd8f69df891d03bae0587cd1a1e1b7">&#9670;&#160;</a></span>OutputPrepared</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool FitterBase::OutputPrepared</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if output prepared not repeat some operations. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00141">141</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="aed2032b9c4a4f2248abe548f54f8dcc8" name="aed2032b9c4a4f2248abe548f54f8dcc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed2032b9c4a4f2248abe548f54f8dcc8">&#9670;&#160;</a></span>outTree</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TTree* FitterBase::outTree</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Output tree with posteriors. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00125">125</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a138f250d9204a30204e4ca5b973008b2" name="a138f250d9204a30204e4ca5b973008b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a138f250d9204a30204e4ca5b973008b2">&#9670;&#160;</a></span>random</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;TRandom3&gt; FitterBase::random</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Random number. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00118">118</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a6f435e161c96eea778aba844115428d4" name="a6f435e161c96eea778aba844115428d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f435e161c96eea778aba844115428d4">&#9670;&#160;</a></span>sample_llh</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; FitterBase::sample_llh</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>store the llh breakdowns </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00098">98</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="afac0dcceb1df194159c07945e8dc0069" name="afac0dcceb1df194159c07945e8dc0069"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afac0dcceb1df194159c07945e8dc0069">&#9670;&#160;</a></span>samples</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classsamplePDFBase.html">samplePDFBase</a>*&gt; FitterBase::samples</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sample holder. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00103">103</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="aedd882d8e4d0da0f89cf94e3a008affe" name="aedd882d8e4d0da0f89cf94e3a008affe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedd882d8e4d0da0f89cf94e3a008affe">&#9670;&#160;</a></span>save_nominal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool FitterBase::save_nominal</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>save nominal matrix info or not </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00132">132</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a490b8614c4089c6db10ff357e7aaab67" name="a490b8614c4089c6db10ff357e7aaab67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a490b8614c4089c6db10ff357e7aaab67">&#9670;&#160;</a></span>SaveProposal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool FitterBase::SaveProposal</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Save proposal at each step. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00134">134</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a588678c71d816f48ba3c140543dbe916" name="a588678c71d816f48ba3c140543dbe916"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a588678c71d816f48ba3c140543dbe916">&#9670;&#160;</a></span>SettingsSaved</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool FitterBase::SettingsSaved</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if setting saved not repeat some operations. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00139">139</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a50df1bd75b20a953f81ab9c2bab6b42c" name="a50df1bd75b20a953f81ab9c2bab6b42c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50df1bd75b20a953f81ab9c2bab6b42c">&#9670;&#160;</a></span>step</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int FitterBase::step</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>current state </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00087">87</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a9fe01b2b6f7f0d6a7b04675a099e1a4f" name="a9fe01b2b6f7f0d6a7b04675a099e1a4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fe01b2b6f7f0d6a7b04675a099e1a4f">&#9670;&#160;</a></span>stepClock</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;TStopwatch&gt; FitterBase::stepClock</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>tells how long single step/fit iteration took </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00113">113</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a8354e9a7a9cc534277ff76ab37c9a763" name="a8354e9a7a9cc534277ff76ab37c9a763"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8354e9a7a9cc534277ff76ab37c9a763">&#9670;&#160;</a></span>stepTime</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double FitterBase::stepTime</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Time of single step. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00115">115</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="ace2eeca9829f63200c3f956c600d09ff" name="ace2eeca9829f63200c3f956c600d09ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace2eeca9829f63200c3f956c600d09ff">&#9670;&#160;</a></span>syst_llh</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; FitterBase::syst_llh</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>systematic llh breakdowns </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00100">100</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="a3a15d2348b7bf0a639aaab52b9294bbf" name="a3a15d2348b7bf0a639aaab52b9294bbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a15d2348b7bf0a639aaab52b9294bbf">&#9670;&#160;</a></span>systematics</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classcovarianceBase.html">covarianceBase</a>*&gt; FitterBase::systematics</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Systematic holder. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00108">108</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<a id="abe9814558b8ff1bccdde3b4c894467e6" name="abe9814558b8ff1bccdde3b4c894467e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe9814558b8ff1bccdde3b4c894467e6">&#9670;&#160;</a></span>TotalNSamples</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int FitterBase::TotalNSamples</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total number of samples used. </p>

<p class="definition">Definition at line <a class="el" href="FitterBase_8h_source.html#l00105">105</a> of file <a class="el" href="FitterBase_8h_source.html">FitterBase.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>mcmc/<a class="el" href="FitterBase_8h_source.html">FitterBase.h</a></li>
<li>mcmc/<a class="el" href="FitterBase_8cpp_source.html">FitterBase.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
