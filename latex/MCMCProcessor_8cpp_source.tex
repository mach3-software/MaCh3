\hypertarget{MCMCProcessor_8cpp_source}{}\doxysection{MCMCProcessor.\+cpp}
\label{MCMCProcessor_8cpp_source}\index{/home/runner/work/MaCh3/MaCh3/mcmc/MCMCProcessor.cpp@{/home/runner/work/MaCh3/MaCh3/mcmc/MCMCProcessor.cpp}}
\mbox{\hyperlink{MCMCProcessor_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00001}00001\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{MCMCProcessor_8h}{MCMCProcessor.h}}"{}}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00003}00003\ \textcolor{preprocessor}{\#include\ "{}TChain.h"{}}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00004}00004\ \textcolor{preprocessor}{\#include\ "{}TF1.h"{}}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00005}00005\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00006}00006\ \textcolor{comment}{//Only\ if\ GPU\ is\ enabled}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00007}00007\ \textcolor{preprocessor}{\#ifdef\ CUDA}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00008}00008\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{gpuMCMCProcessorUtils_8cuh}{mcmc/gpuMCMCProcessorUtils.cuh}}"{}}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00009}00009\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00011}00011\ \textcolor{comment}{//this\ file\ has\ lots\ of\ usage\ of\ the\ ROOT\ plotting\ interface\ that\ only\ takes\ floats,\ turn\ this\ warning\ off\ for\ this\ CU\ for\ now}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00012}00012\ \textcolor{preprocessor}{\#pragma\ GCC\ diagnostic\ ignored\ "{}-\/Wfloat-\/conversion"{}}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00013}00013\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00014}00014\ \textcolor{comment}{//\ ****************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00015}\mbox{\hyperlink{classMCMCProcessor_afb50150dcb6d1d75f3c08b5ee8d3d77c}{00015}}\ \mbox{\hyperlink{classMCMCProcessor_afb50150dcb6d1d75f3c08b5ee8d3d77c}{MCMCProcessor::MCMCProcessor}}(\textcolor{keyword}{const}\ std::string\ \&InputFile)\ :}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00016}00016\ \ \ Chain(nullptr),\ StepCut(\textcolor{stringliteral}{"{}"{}}),\ MadePostfit(false)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00017}00017\ \textcolor{comment}{//\ ****************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00018}00018\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}}\ =\ InputFile;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00019}00019\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00020}00020\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_aa603c55ea73cd86d1994901227883e1e}{SetMaCh3LoggerFormat}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00021}00021\ \ \ \mbox{\hyperlink{namespaceMaCh3Utils_ac6f4a3b6a7749967ff9a011469352f6c}{MaCh3Utils::MaCh3Welcome}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00022}00022\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ post-\/fit\ processor\ for:\ \{\}"{}},\ \mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00024}00024\ \ \ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00025}00025\ \ \ \mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00026}00026\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00027}00027\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00028}00028\ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00029}00029\ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00030}00030\ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00031}00031\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00032}00032\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00033}00033\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00034}00034\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00035}00035\ \ \ \mbox{\hyperlink{classMCMCProcessor_a7db98c7cf390b050f1acb927b4f55cab}{ParamSums}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00036}00036\ \ \ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00037}00037\ \ \ \mbox{\hyperlink{classMCMCProcessor_a28e89498420221149ec97c353c430bf8}{SampleValues}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00038}00038\ \ \ \mbox{\hyperlink{classMCMCProcessor_a4eb2748c81b0aef9bd7e14785559e301}{SystValues}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00039}00039\ \ \ \mbox{\hyperlink{classMCMCProcessor_a88cab29770fd6098a674a0ab3628a251}{AccProbValues}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00040}00040\ \ \ \mbox{\hyperlink{classMCMCProcessor_a523a223a4754c133121796f4591c7be3}{AccProbBatchedAverages}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00041}00041\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00042}00042\ \ \ \textcolor{comment}{//KS:\ WARNING\ this\ only\ work\ when\ you\ project\ from\ Chain,\ will\ nor\ work\ when\ you\ try\ SetBranchAddress\ etc.\ Turn\ it\ on\ only\ if\ you\ know\ how\ to\ use\ it}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00043}00043\ \ \ \mbox{\hyperlink{classMCMCProcessor_af1392c6cff68e9f0a27e2c9a4e52cf4c}{PlotJarlskog}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00044}00044\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00045}00045\ \ \ \textcolor{comment}{//KS:Hardcoded\ should\ be\ a\ way\ to\ get\ it\ via\ config\ or\ something}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00046}00046\ \ \ \mbox{\hyperlink{classMCMCProcessor_afbac2a114c15ca7db4abe71dd549504c}{plotRelativeToPrior}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00047}00047\ \ \ \mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00048}00048\ \ \ \mbox{\hyperlink{classMCMCProcessor_aa7611f55ac3c0ea70607761d037fbd91}{plotBinValue}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00049}00049\ \ \ \mbox{\hyperlink{classMCMCProcessor_ad24411a2556504c440ff0af045e8e7aa}{PlotFlatPrior}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00050}00050\ \ \ \mbox{\hyperlink{classMCMCProcessor_aea84f0315695aa05ec41fcf965b1b031}{CacheMCMC}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00051}00051\ \ \ \mbox{\hyperlink{classMCMCProcessor_a682c1c47626542f5820d633ba2bc010c}{ApplySmoothing}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00052}00052\ \ \ \mbox{\hyperlink{classMCMCProcessor_ad25fe818c94163b0c4a8fcdfd387c148}{FancyPlotNames}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00053}00053\ \ \ \mbox{\hyperlink{classMCMCProcessor_adf449e50cf358f737fe4a2b65d9668e9}{doDiagMCMC}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00054}00054\ \ \ \mbox{\hyperlink{classMCMCProcessor_aa34b50ce33fb2cb7d9e9ef2d9f2f67c1}{OutputSuffix}}\ =\ \textcolor{stringliteral}{"{}\_Process"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00055}00055\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25e4685b6299181021b02ac0e0b74681}{Post2DPlotThreshold}}\ =\ 1.e-\/5;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00056}00056\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00057}00057\ \ \ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00058}00058\ \ \ \mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00059}00059\ \ \ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00060}00060\ \ \ \mbox{\hyperlink{classMCMCProcessor_a840c686f15f419c0156df01c4ed62931}{UpperCut}}\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00061}00061\ \ \ \mbox{\hyperlink{classMCMCProcessor_aae0016a4e1d105d5d65243438c622a97}{nSteps}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00062}00062\ \ \ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00063}00063\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6156bba72e1f076e66f0356e48506a36}{AutoCorrLag}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00064}00064\ \ \ \mbox{\hyperlink{classMCMCProcessor_adf518be96278f1d3901404cfbe767b67}{nSysts}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00065}00065\ \ \ \mbox{\hyperlink{classMCMCProcessor_a419d3669dbb54a55a635e35691134cc1}{nSamples}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00066}00066\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00067}00067\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}{nBins}}\ =\ 70;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00068}00068\ \ \ \mbox{\hyperlink{classMCMCProcessor_a4abe633b264acd9b0459c7b8ccd8b9df}{DrawRange}}\ =\ 1.5;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00069}00069\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00070}00070\ \ \ \mbox{\hyperlink{classMCMCProcessor_a85917e25c4f5b5b966c50cccd9ddd6a0}{Posterior1DCut}}\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00071}00071\ \ \ \textcolor{comment}{//KS:Those\ keep\ basic\ information\ for\ ParameterEnum}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00072}00072\ \ \ \mbox{\hyperlink{classMCMCProcessor_adecc55689f7d37b9412f8886fe3480dc}{ParamNames}}.resize(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a}{kNParameterEnum}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00073}00073\ \ \ \mbox{\hyperlink{classMCMCProcessor_a3a6614826ae320e462211e38e96d9d02}{ParamCentral}}.resize(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a}{kNParameterEnum}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00074}00074\ \ \ \mbox{\hyperlink{classMCMCProcessor_a4c4c6aa4827a2fe54ce37defbb3d0475}{ParamNom}}.resize(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a}{kNParameterEnum}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00075}00075\ \ \ \mbox{\hyperlink{classMCMCProcessor_a3a97e3cb4be3ceb9eb721eac51d82d60}{ParamErrors}}.resize(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a}{kNParameterEnum}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00076}00076\ \ \ \mbox{\hyperlink{classMCMCProcessor_a4be1eedb743e4ea410009a4fa45720f7}{ParamFlat}}.resize(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a}{kNParameterEnum}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00077}00077\ \ \ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}.resize(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a}{kNParameterEnum}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00078}00078\ \ \ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}.resize(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a}{kNParameterEnum}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00079}00079\ \ \ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}.resize(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a}{kNParameterEnum}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00080}00080\ \ \ \mbox{\hyperlink{classMCMCProcessor_a4c1330a025c0b91e382bdc29c960424a}{CovConfig}}.resize(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a}{kNParameterEnum}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00081}00081\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00082}00082\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a}{kNParameterEnum}};\ i++)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00083}00083\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00084}00084\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[i]\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00085}00085\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[i]\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00086}00086\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00087}00087\ \ \ \textcolor{comment}{//Only\ if\ GPU\ is\ enabled}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00088}00088\ \textcolor{preprocessor}{\ \ \#ifdef\ CUDA}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00089}00089\ \ \ \ ParStep\_cpu\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00090}00090\ \ \ \ NumeratorSum\_cpu\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00091}00091\ \ \ \ ParamSums\_cpu\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00092}00092\ \ \ \ DenomSum\_cpu\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00093}00093\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00094}00094\ \ \ \ ParStep\_gpu\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00095}00095\ \ \ \ NumeratorSum\_gpu\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00096}00096\ \ \ \ ParamSums\_gpu\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00097}00097\ \ \ \ DenomSum\_gpu\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00098}00098\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00099}00099\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00100}00100\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00101}00101\ \textcolor{comment}{//\ ****************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00102}00102\ \textcolor{comment}{//\ The\ destructor}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00103}\mbox{\hyperlink{classMCMCProcessor_a50810cd50c5a4545bd5c1e486aae7b1c}{00103}}\ \mbox{\hyperlink{classMCMCProcessor_a50810cd50c5a4545bd5c1e486aae7b1c}{MCMCProcessor::\string~MCMCProcessor}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00104}00104\ \textcolor{comment}{//\ ****************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00105}00105\ \ \ \textcolor{comment}{//\ Close\ the\ pdf\ file}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00106}00106\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Closing\ pdf\ in\ MCMCProcessor:\ \{\}"{}},\ \mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}}.Data());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00107}00107\ \ \ \mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}}\ +=\ \textcolor{stringliteral}{"{}]"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00108}00108\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00109}00109\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}\ !=\ \textcolor{keyword}{nullptr})\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00110}00110\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00111}00111\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a92c1d9b0ebdf90951221cdaf2ac4cc2c}{Gauss}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00112}00112\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}{Covariance}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00113}00113\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00114}00114\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_aad661c6d53f9f891e18ff8ccdbd08479}{Central\_Value}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00115}00115\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_acaf7f239136dfa3506d095b612323d0a}{Means}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00116}00116\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a5174aaa900edf16ddc6e841ea4adae83}{Errors}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00117}00117\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a600fc8c39af2750df91fb7a0ff85ac74}{Means\_Gauss}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00118}00118\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_aa78b7ed1bb9966f84f4eaf8cedf5e688}{Errors\_Gauss}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00119}00119\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a32657dc39a7fc0d04804f6195a3d8c3e}{Means\_HPD}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00120}00120\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_abb5c6ad85c89227bbb9bc5de2eb71272}{Errors\_HPD}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00121}00121\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_af96664fa8cc51c49ad1385da07a343b8}{Errors\_HPD\_Positive}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00122}00122\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a7b85df39f22390dac24f4d66a89518e5}{Errors\_HPD\_Negative}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00123}00123\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00124}00124\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}\ !=\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00125}00125\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00126}00126\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00127}00127\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00128}00128\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00129}00129\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00130}00130\ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00131}00131\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00132}00132\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aea84f0315695aa05ec41fcf965b1b031}{CacheMCMC}})}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00133}00133\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00134}00134\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00135}00135\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00136}00136\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00137}00137\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00138}00138\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00139}00139\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00140}00140\ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[i];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00141}00141\ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00142}00142\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00143}00143\ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00144}00144\ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00145}00145\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00146}00146\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}\ !=\ \textcolor{keyword}{nullptr})\ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00147}00147\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00148}00148\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}\ !=\ \textcolor{keyword}{nullptr})\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00149}00149\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}\ !=\ \textcolor{keyword}{nullptr})\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00150}00150\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}\ !=\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>Close();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00151}00151\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}\ !=\ \textcolor{keyword}{nullptr})\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00152}00152\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00153}00153\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00154}00154\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00155}00155\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00156}\mbox{\hyperlink{classMCMCProcessor_a224995a0b47bd9cbd04e099cc3ca634c}{00156}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_a224995a0b47bd9cbd04e099cc3ca634c}{MCMCProcessor::Initialise}}()\{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00157}00157\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00158}00158\ \ \ \textcolor{comment}{//\ Scan\ the\ ROOT\ file\ for\ useful\ branches}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00159}00159\ \ \ \mbox{\hyperlink{classMCMCProcessor_aeff2174617268c1e55333529459bffb6}{ScanInput}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00160}00160\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00161}00161\ \ \ \textcolor{comment}{//\ Setup\ the\ output}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00162}00162\ \ \ \mbox{\hyperlink{classMCMCProcessor_aa4761be1345f1be3defe162b278a9d8e}{SetupOutput}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00163}00163\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00164}00164\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00165}00165\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00166}\mbox{\hyperlink{classMCMCProcessor_a5fc015740496b821648f0e5ca8cffe80}{00166}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_a5fc015740496b821648f0e5ca8cffe80}{MCMCProcessor::GetPostfit}}(TVectorD\ *\&Central\_PDF,\ TVectorD\ *\&Errors\_PDF,\ TVectorD\ *\&Central\_G,\ TVectorD\ *\&Errors\_G,\ TVectorD\ *\&Peak\_Values)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00167}00167\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00168}00168\ \ \ \textcolor{comment}{//\ Make\ the\ post\ fit}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00169}00169\ \ \ \mbox{\hyperlink{classMCMCProcessor_a8667510132aa01395520f028287f511b}{MakePostfit}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00170}00170\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00171}00171\ \ \ \textcolor{comment}{//\ We\ now\ have\ the\ private\ members}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00172}00172\ \ \ Central\_PDF\ =\ \mbox{\hyperlink{classMCMCProcessor_acaf7f239136dfa3506d095b612323d0a}{Means}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00173}00173\ \ \ Errors\_PDF\ =\ \mbox{\hyperlink{classMCMCProcessor_a5174aaa900edf16ddc6e841ea4adae83}{Errors}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00174}00174\ \ \ Central\_G\ =\ \mbox{\hyperlink{classMCMCProcessor_a600fc8c39af2750df91fb7a0ff85ac74}{Means\_Gauss}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00175}00175\ \ \ Errors\_G\ =\ \mbox{\hyperlink{classMCMCProcessor_aa78b7ed1bb9966f84f4eaf8cedf5e688}{Errors\_Gauss}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00176}00176\ \ \ Peak\_Values\ =\ \mbox{\hyperlink{classMCMCProcessor_a32657dc39a7fc0d04804f6195a3d8c3e}{Means\_HPD}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00177}00177\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00178}00178\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00179}00179\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00180}00180\ \textcolor{comment}{//\ Get\ post-\/fits\ for\ the\ ParameterEnum\ type,\ e.g.\ xsec\ params,\ ND\ params\ or\ flux\ params\ etc}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00181}\mbox{\hyperlink{classMCMCProcessor_a59fa9550b7c69c616929217ae89c2f42}{00181}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_a59fa9550b7c69c616929217ae89c2f42}{MCMCProcessor::GetPostfit\_Ind}}(TVectorD\ *\&PDF\_Central,\ TVectorD\ *\&PDF\_Errors,\ TVectorD\ *\&Peak\_Values,\ \mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20b}{ParameterEnum}}\ kParam)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00182}00182\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00183}00183\ \ \ \textcolor{comment}{//\ Make\ the\ post\ fit}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00184}00184\ \ \ \mbox{\hyperlink{classMCMCProcessor_a8667510132aa01395520f028287f511b}{MakePostfit}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00185}00185\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00186}00186\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ loaded\ param\ types}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00187}00187\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ ParamTypeSize\ =\ int(\mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}.size());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00188}00188\ \ \ \textcolor{keywordtype}{int}\ ParamNumber\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00189}00189\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ ParamTypeSize;\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00190}00190\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}[i]\ !=\ kParam)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00191}00191\ \ \ \ \ (*PDF\_Central)(ParamNumber)\ =\ (*\mbox{\hyperlink{classMCMCProcessor_acaf7f239136dfa3506d095b612323d0a}{Means}})(i);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00192}00192\ \ \ \ \ (*PDF\_Errors)(ParamNumber)\ =\ (*\mbox{\hyperlink{classMCMCProcessor_a5174aaa900edf16ddc6e841ea4adae83}{Errors}})(i);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00193}00193\ \ \ \ \ (*Peak\_Values)(ParamNumber)\ =\ (*\mbox{\hyperlink{classMCMCProcessor_a32657dc39a7fc0d04804f6195a3d8c3e}{Means\_HPD}})(i);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00194}00194\ \ \ \ \ ++ParamNumber;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00195}00195\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00196}00196\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00197}00197\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00198}00198\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00199}\mbox{\hyperlink{classMCMCProcessor_ac9e4fdea5d2de92a1abad5b79b7daf88}{00199}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_ac9e4fdea5d2de92a1abad5b79b7daf88}{MCMCProcessor::GetCovariance}}(TMatrixDSym\ *\&Cov,\ TMatrixDSym\ *\&Corr)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00200}00200\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00201}00201\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_aea84f0315695aa05ec41fcf965b1b031}{CacheMCMC}})\ \mbox{\hyperlink{classMCMCProcessor_ab367cb5f56606338bb1fce780f2414e8}{MakeCovariance\_MP}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00202}00202\ \ \ \textcolor{keywordflow}{else}\ \mbox{\hyperlink{classMCMCProcessor_afc94f21ffd599b1e2dd7e62f24f6c4de}{MakeCovariance}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00203}00203\ \ \ Cov\ =\ \textcolor{keyword}{static\_cast<}TMatrixDSym*\textcolor{keyword}{>}(\mbox{\hyperlink{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}{Covariance}}-\/>Clone());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00204}00204\ \ \ Corr\ =\ \textcolor{keyword}{static\_cast<}TMatrixDSym*\textcolor{keyword}{>}(\mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}}-\/>Clone());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00205}00205\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00206}00206\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00207}00207\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00208}\mbox{\hyperlink{classMCMCProcessor_aa5a7761e97cf2e24c7d877a5374b7333}{00208}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_aa5a7761e97cf2e24c7d877a5374b7333}{MCMCProcessor::MakeOutputFile}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00209}00209\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00210}00210\ \ \ \textcolor{comment}{//KS:\ ROOT\ hates\ me...\ but\ we\ can\ create\ several\ instances\ of\ MCMC\ Processor,\ each\ with\ own\ TCanvas\ ROOT\ is\ mad\ and\ will\ delete\ if\ there\ is\ more\ than\ one\ canvas\ with\ the\ same\ name,\ so\ we\ add\ random\ number\ to\ avoid\ issue}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00211}00211\ \ \ \textcolor{keyword}{auto}\ rand\ =\ std::make\_unique<TRandom3>(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00212}00212\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ uniform\ =\ int(rand-\/>Uniform(0,\ 10000));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00213}00213\ \ \ \textcolor{comment}{//\ Open\ a\ TCanvas\ to\ write\ the\ posterior\ onto}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00214}00214\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}\ =\ \textcolor{keyword}{new}\ TCanvas((\textcolor{stringliteral}{"{}Posterior"{}}\ +\ std::to\_string(uniform)).c\_str(),\ (\textcolor{stringliteral}{"{}Posterior"{}}\ +\ std::to\_string(uniform)).c\_str(),\ 0,\ 0,\ 1024,\ 1024);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00215}00215\ \ \ \textcolor{comment}{//KS:\ No\ idea\ why\ but\ ROOT\ changed\ treatment\ of\ violin\ in\ R6.\ If\ you\ have\ non\ uniform\ binning\ this\ will\ results\ in\ very\ hard\ to\ see\ violin\ plots.}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00216}00216\ \ \ TCandle::SetScaledViolin(\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00217}00217\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00218}00218\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetGrid();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00219}00219\ \ \ gStyle-\/>SetOptStat(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00220}00220\ \ \ gStyle-\/>SetOptTitle(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00221}00221\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTickx();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00222}00222\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTicky();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00223}00223\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00224}00224\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetBottomMargin(0.1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00225}00225\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTopMargin(0.05);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00226}00226\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetRightMargin(0.03);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00227}00227\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetLeftMargin(0.15);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00228}00228\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00229}00229\ \ \ \textcolor{comment}{//To\ avoid\ TCanvas::Print>\ messages}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00230}00230\ \ \ gErrorIgnoreLevel\ =\ kWarning;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00231}00231\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00232}00232\ \ \ \textcolor{comment}{//\ Output\ file\ to\ write\ to}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00233}00233\ \ \ \mbox{\hyperlink{classMCMCProcessor_a3d17c1720b91d6d0361da0b5dabfbbff}{OutputName}}\ =\ \mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}}\ +\ \mbox{\hyperlink{classMCMCProcessor_aa34b50ce33fb2cb7d9e9ef2d9f2f67c1}{OutputSuffix}}\ +\textcolor{stringliteral}{"{}.root"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00234}00234\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00235}00235\ \ \ \textcolor{comment}{//\ Output\ file}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00236}00236\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}\ =\ \textcolor{keyword}{new}\ TFile(\mbox{\hyperlink{classMCMCProcessor_a3d17c1720b91d6d0361da0b5dabfbbff}{OutputName}}.c\_str(),\ \textcolor{stringliteral}{"{}recreate"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00237}00237\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00238}00238\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00239}00239\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00240}00240\ \textcolor{comment}{//\ ****************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00241}00241\ \textcolor{comment}{//CW:\ Function\ to\ make\ the\ post-\/fit}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00242}\mbox{\hyperlink{classMCMCProcessor_a8667510132aa01395520f028287f511b}{00242}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_a8667510132aa01395520f028287f511b}{MCMCProcessor::MakePostfit}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00243}00243\ \textcolor{comment}{//\ ****************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00244}00244\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00245}00245\ \ \ \textcolor{comment}{//\ Check\ if\ we've\ already\ made\ post-\/fit}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00246}00246\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_aecc35d4ea7d2c7e020e50388ba0ffb64}{MadePostfit}}\ ==\ \textcolor{keyword}{true})\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00247}00247\ \ \ \mbox{\hyperlink{classMCMCProcessor_aecc35d4ea7d2c7e020e50388ba0ffb64}{MadePostfit}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00248}00248\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00249}00249\ \ \ \textcolor{comment}{//\ Check\ if\ the\ output\ file\ is\ ready}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00250}00250\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_aa5a7761e97cf2e24c7d877a5374b7333}{MakeOutputFile}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00251}00251\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00252}00252\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}MCMCProcessor\ is\ making\ post-\/fit\ plots..."{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00253}00253\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00254}00254\ \ \ \textcolor{comment}{//\ Directory\ for\ posteriors}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00255}00255\ \ \ TDirectory\ *PostDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}Post"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00256}00256\ \ \ TDirectory\ *PostHistDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}Post\_1d\_hists"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00257}00257\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00258}00258\ \ \ \textcolor{comment}{//\ We\ fit\ with\ this\ Gaussian}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00259}00259\ \ \ \mbox{\hyperlink{classMCMCProcessor_a92c1d9b0ebdf90951221cdaf2ac4cc2c}{Gauss}}\ =\ \textcolor{keyword}{new}\ TF1(\textcolor{stringliteral}{"{}Gauss"{}},\textcolor{stringliteral}{"{}[0]/sqrt(2.0*3.14159)/[2]*TMath::Exp(-\/0.5*pow(x-\/[1],2)/[2]/[2])"{}},-\/5,5);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00260}00260\ \ \ \mbox{\hyperlink{classMCMCProcessor_a92c1d9b0ebdf90951221cdaf2ac4cc2c}{Gauss}}-\/>SetLineWidth(2);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00261}00261\ \ \ \mbox{\hyperlink{classMCMCProcessor_a92c1d9b0ebdf90951221cdaf2ac4cc2c}{Gauss}}-\/>SetLineColor(kOrange-\/5);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00262}00262\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00263}00263\ \ \ \textcolor{comment}{//\ nDraw\ is\ number\ of\ draws\ we\ want\ to\ do}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00264}00264\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00265}00265\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00266}00266\ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ \%\ (\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}/5)\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00267}00267\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00268}00268\ \ \ \ \ \ \ \mbox{\hyperlink{namespaceMaCh3Utils_a4c8bdeb1d34606aed192e9f1311a72f5}{MaCh3Utils::PrintProgressBar}}(i,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00269}00269\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00270}00270\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00271}00271\ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00272}00272\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00273}00273\ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00274}00274\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00275}00275\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(i,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00276}00276\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00277}00277\ \ \ \ \ \textcolor{comment}{//\ This\ holds\ the\ posterior\ density}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00278}00278\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ maxi\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMaximum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00279}00279\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ mini\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMinimum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00280}00280\ \ \ \ \ \textcolor{comment}{//\ This\ holds\ the\ posterior\ density}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00281}00281\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]\ =\ \textcolor{keyword}{new}\ TH1D(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i],\ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i],\ \mbox{\hyperlink{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}{nBins}},\ mini,\ maxi);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00282}00282\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>SetMinimum(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00283}00283\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Steps"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00284}00284\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetYaxis()-\/>SetNoExponent(\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00285}00285\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00286}00286\ \ \ \ \ \textcolor{comment}{//KS:\ Apply\ additional\ Cuts,\ like\ mass\ ordering}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00287}00287\ \ \ \ \ std::string\ CutPosterior1D\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00288}00288\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a85917e25c4f5b5b966c50cccd9ddd6a0}{Posterior1DCut}}\ !=\ \textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00289}00289\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00290}00290\ \ \ \ \ \ \ CutPosterior1D\ =\ \mbox{\hyperlink{classMCMCProcessor_a576f0eb874afaf7e31ff5c86b9e5b8f9}{StepCut}}\ +\textcolor{stringliteral}{"{}\ \&\&\ "{}}\ +\ \mbox{\hyperlink{classMCMCProcessor_a85917e25c4f5b5b966c50cccd9ddd6a0}{Posterior1DCut}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00291}00291\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00292}00292\ \ \ \ \ \textcolor{keywordflow}{else}\ CutPosterior1D\ =\ \mbox{\hyperlink{classMCMCProcessor_a576f0eb874afaf7e31ff5c86b9e5b8f9}{StepCut}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00293}00293\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00294}00294\ \ \ \ \ \textcolor{comment}{//\ Project\ BranchNames[i]\ onto\ hpost,\ applying\ stepcut}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00295}00295\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>Project(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i],\ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i],\ CutPosterior1D.c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00296}00296\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00297}00297\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a682c1c47626542f5820d633ba2bc010c}{ApplySmoothing}})\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>Smooth();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00298}00298\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00299}00299\ \ \ \ \ (*Central\_Value)(i)\ =\ Prior;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00300}00300\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00301}00301\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}},\ Err,\ Err\_p,\ Err\_m;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00302}00302\ \ \ \ \ \mbox{\hyperlink{StatisticalUtils_8h_ab4dc9e4455015e55031e2cc8a076349d}{GetArithmetic}}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i],\ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}},\ Err);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00303}00303\ \ \ \ \ (*Means)(i)\ =\ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00304}00304\ \ \ \ \ (*Errors)(i)\ =\ Err;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00305}00305\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00306}00306\ \ \ \ \ \mbox{\hyperlink{StatisticalUtils_8h_a7237fc819d10a341c286a5597f584a96}{GetGaussian}}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i],\ \mbox{\hyperlink{classMCMCProcessor_a92c1d9b0ebdf90951221cdaf2ac4cc2c}{Gauss}},\ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}},\ Err);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00307}00307\ \ \ \ \ (*Means\_Gauss)(i)\ =\ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00308}00308\ \ \ \ \ (*Errors\_Gauss)(i)\ =\ Err;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00309}00309\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00310}00310\ \ \ \ \ \mbox{\hyperlink{StatisticalUtils_8h_aadbb121e8fc7db8e4e28d6b04d351460}{GetHPD}}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i],\ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}},\ Err,\ Err\_p,\ Err\_m);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00311}00311\ \ \ \ \ (*Means\_HPD)(i)\ =\ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00312}00312\ \ \ \ \ (*Errors\_HPD)(i)\ =\ Err;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00313}00313\ \ \ \ \ (*Errors\_HPD\_Positive)(i)\ =\ Err\_p;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00314}00314\ \ \ \ \ (*Errors\_HPD\_Negative)(i)\ =\ Err\_m;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00315}00315\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00316}00316\ \ \ \ \ \textcolor{comment}{//\ Write\ the\ results\ from\ the\ projection\ into\ the\ TVectors\ and\ TMatrices}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00317}00317\ \ \ \ \ (*Covariance)(i,i)\ =\ (*\mbox{\hyperlink{classMCMCProcessor_a5174aaa900edf16ddc6e841ea4adae83}{Errors}})(i)*(*\mbox{\hyperlink{classMCMCProcessor_a5174aaa900edf16ddc6e841ea4adae83}{Errors}})(i);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00318}00318\ \ \ \ \ (*Correlation)(i,i)\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00319}00319\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00320}00320\ \ \ \ \ \textcolor{comment}{//KS:\ This\ need\ to\ be\ before\ SetMaximum(),\ this\ way\ plot\ is\ nicer\ as\ line\ end\ at\ the\ maximum}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00321}00321\ \ \ \ \ \textcolor{keyword}{auto}\ hpd\ =\ std::make\_unique<TLine>((*\mbox{\hyperlink{classMCMCProcessor_a32657dc39a7fc0d04804f6195a3d8c3e}{Means\_HPD}})(i),\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetMinimum(),\ (*\mbox{\hyperlink{classMCMCProcessor_a32657dc39a7fc0d04804f6195a3d8c3e}{Means\_HPD}})(i),\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetMaximum());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00322}00322\ \ \ \ \ hpd-\/>SetLineColor(kBlack);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00323}00323\ \ \ \ \ hpd-\/>SetLineWidth(2);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00324}00324\ \ \ \ \ hpd-\/>SetLineStyle(kSolid);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00325}00325\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00326}00326\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>SetLineWidth(2);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00327}00327\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>SetLineColor(kBlue-\/1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00328}00328\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>SetMaximum(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetMaximum()*\mbox{\hyperlink{classMCMCProcessor_a4abe633b264acd9b0459c7b8ccd8b9df}{DrawRange}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00329}00329\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>SetTitle(Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00330}00330\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetXaxis()-\/>SetTitle(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetTitle());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00331}00331\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00332}00332\ \ \ \ \ \textcolor{comment}{//\ Now\ make\ the\ TLine\ for\ the\ Asimov}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00333}00333\ \ \ \ \ \textcolor{keyword}{auto}\ Asimov\ =\ std::make\_unique<TLine>(Prior,\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetMinimum(),\ Prior,\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetMaximum());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00334}00334\ \ \ \ \ Asimov-\/>SetLineColor(kRed-\/3);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00335}00335\ \ \ \ \ Asimov-\/>SetLineWidth(2);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00336}00336\ \ \ \ \ Asimov-\/>SetLineStyle(kDashed);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00337}00337\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00338}00338\ \ \ \ \ \textcolor{keyword}{auto}\ leg\ =\ std::make\_unique<TLegend>(0.12,\ 0.6,\ 0.6,\ 0.97);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00339}00339\ \ \ \ \ leg-\/>SetTextSize(0.04);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00340}00340\ \ \ \ \ leg-\/>AddEntry(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i],\ Form(\textcolor{stringliteral}{"{}\#splitline\{PDF\}\{\#mu\ =\ \%.2f,\ \#sigma\ =\ \%.2f\}"{}},\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetMean(),\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetRMS()),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00341}00341\ \ \ \ \ leg-\/>AddEntry(\mbox{\hyperlink{classMCMCProcessor_a92c1d9b0ebdf90951221cdaf2ac4cc2c}{Gauss}},\ Form(\textcolor{stringliteral}{"{}\#splitline\{Gauss\}\{\#mu\ =\ \%.2f,\ \#sigma\ =\ \%.2f\}"{}},\ \mbox{\hyperlink{classMCMCProcessor_a92c1d9b0ebdf90951221cdaf2ac4cc2c}{Gauss}}-\/>GetParameter(1),\ \mbox{\hyperlink{classMCMCProcessor_a92c1d9b0ebdf90951221cdaf2ac4cc2c}{Gauss}}-\/>GetParameter(2)),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00342}00342\ \ \ \ \ leg-\/>AddEntry(hpd.get(),\ Form(\textcolor{stringliteral}{"{}\#splitline\{HPD\}\{\#mu\ =\ \%.2f,\ \#sigma\ =\ \%.2f\ (+\%.2f-\/\%.2f)\}"{}},\ (*\mbox{\hyperlink{classMCMCProcessor_a32657dc39a7fc0d04804f6195a3d8c3e}{Means\_HPD}})(i),\ (*\mbox{\hyperlink{classMCMCProcessor_abb5c6ad85c89227bbb9bc5de2eb71272}{Errors\_HPD}})(i),\ (*\mbox{\hyperlink{classMCMCProcessor_af96664fa8cc51c49ad1385da07a343b8}{Errors\_HPD\_Positive}})(i),\ (*\mbox{\hyperlink{classMCMCProcessor_a7b85df39f22390dac24f4d66a89518e5}{Errors\_HPD\_Negative}})(i)),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00343}00343\ \ \ \ \ leg-\/>AddEntry(Asimov.get(),\ Form(\textcolor{stringliteral}{"{}\#splitline\{Prior\}\{x\ =\ \%.2f\ ,\ \#sigma\ =\ \%.2f\}"{}},\ Prior,\ PriorError),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00344}00344\ \ \ \ \ leg-\/>SetLineColor(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00345}00345\ \ \ \ \ leg-\/>SetLineStyle(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00346}00346\ \ \ \ \ leg-\/>SetFillColor(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00347}00347\ \ \ \ \ leg-\/>SetFillStyle(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00348}00348\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00349}00349\ \ \ \ \ \textcolor{comment}{//CW:\ Don't\ plot\ if\ this\ is\ a\ fixed\ histogram\ (i.e.\ the\ peak\ is\ the\ whole\ integral)}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00350}00350\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetMaximum()\ ==\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>Integral()*\mbox{\hyperlink{classMCMCProcessor_a4abe633b264acd9b0459c7b8ccd8b9df}{DrawRange}})\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00351}00351\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00352}00352\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Found\ fixed\ parameter,\ moving\ on"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00353}00353\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a95fa49737432818bc830a44898d0d850}{IamVaried}}[i]\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00354}00354\ \ \ \ \ \ \ \textcolor{comment}{//KS:Set\ mean\ and\ error\ to\ prior\ for\ fixed\ parameters,\ it\ looks\ much\ better\ when\ fixed\ parameter\ has\ mean\ on\ prior\ rather\ than\ on\ 0\ with\ 0\ error.}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00355}00355\ \ \ \ \ \ \ (*Means\_HPD)(i)\ \ =\ Prior;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00356}00356\ \ \ \ \ \ \ (*Errors\_HPD)(i)\ =\ PriorError;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00357}00357\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00358}00358\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00359}00359\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00360}00360\ \ \ \ \ \textcolor{comment}{//\ Store\ that\ this\ parameter\ is\ indeed\ being\ varied}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00361}00361\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a95fa49737432818bc830a44898d0d850}{IamVaried}}[i]\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00362}00362\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00363}00363\ \ \ \ \ \textcolor{comment}{//\ Write\ to\ file}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00364}00364\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetName(Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00365}00365\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTitle(Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00366}00366\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00367}00367\ \ \ \ \ \textcolor{comment}{//\ Draw\ onto\ the\ TCanvas}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00368}00368\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>Draw();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00369}00369\ \ \ \ \ hpd-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00370}00370\ \ \ \ \ Asimov-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00371}00371\ \ \ \ \ leg-\/>Draw(\textcolor{stringliteral}{"{}same"{}});\ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00372}00372\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00373}00373\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00374}00374\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00375}00375\ \ \ \ \ \textcolor{comment}{//\ cd\ into\ params\ directory\ in\ root\ file}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00376}00376\ \ \ \ \ PostDir-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00377}00377\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Write();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00378}00378\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00379}00379\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>SetName(Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00380}00380\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>SetTitle(Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00381}00381\ \ \ \ \ PostHistDir-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00382}00382\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>Write();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00383}00383\ \ \ \}\ \textcolor{comment}{//\ end\ the\ for\ loop\ over\ nDraw}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00384}00384\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00385}00385\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00386}00386\ \ \ TTree\ *SettingsBranch\ =\ \textcolor{keyword}{new}\ TTree(\textcolor{stringliteral}{"{}Settings"{}},\ \textcolor{stringliteral}{"{}Settings"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00387}00387\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{GetPostfitParamPlots_8cpp_a5307771642312031f0050189b493a621}{CrossSectionParameters}}\ =\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00388}00388\ \ \ SettingsBranch-\/>Branch(\textcolor{stringliteral}{"{}CrossSectionParameters"{}},\ \&\mbox{\hyperlink{GetPostfitParamPlots_8cpp_a5307771642312031f0050189b493a621}{CrossSectionParameters}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00389}00389\ \ \ \textcolor{keywordtype}{int}\ CrossSectionParametersStartingPos\ =\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00390}00390\ \ \ SettingsBranch-\/>Branch(\textcolor{stringliteral}{"{}CrossSectionParametersStartingPos"{}},\ \&CrossSectionParametersStartingPos);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00391}00391\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{GetPostfitParamPlots_8cpp_adf4147e2ac31f2cb321121a90cb8c853}{FluxParameters}}\ =\ \mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00392}00392\ \ \ SettingsBranch-\/>Branch(\textcolor{stringliteral}{"{}FluxParameters"{}},\ \&\mbox{\hyperlink{GetPostfitParamPlots_8cpp_adf4147e2ac31f2cb321121a90cb8c853}{FluxParameters}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00393}00393\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00394}00394\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{GetPostfitParamPlots_8cpp_adb4ee3a874472b4ffccc8734da66250e}{NDParameters}}\ =\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00395}00395\ \ \ SettingsBranch-\/>Branch(\textcolor{stringliteral}{"{}NDParameters"{}},\ \&\mbox{\hyperlink{GetPostfitParamPlots_8cpp_adb4ee3a874472b4ffccc8734da66250e}{NDParameters}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00396}00396\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{GetPostfitParamPlots_8cpp_aa7bc6e5554391b57acf10c691b6374e0}{NDParametersStartingPos}}\ =\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00397}00397\ \ \ SettingsBranch-\/>Branch(\textcolor{stringliteral}{"{}NDParametersStartingPos"{}},\ \&\mbox{\hyperlink{GetPostfitParamPlots_8cpp_aa7bc6e5554391b57acf10c691b6374e0}{NDParametersStartingPos}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00398}00398\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00399}00399\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{GetPostfitParamPlots_8cpp_a15657a5f07a9fde98fc9210b7ae80f9e}{FDParameters}}\ =\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00400}00400\ \ \ SettingsBranch-\/>Branch(\textcolor{stringliteral}{"{}FDParameters"{}},\ \&\mbox{\hyperlink{GetPostfitParamPlots_8cpp_a15657a5f07a9fde98fc9210b7ae80f9e}{FDParameters}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00401}00401\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{GetPostfitParamPlots_8cpp_a6dfe886b2ff4881ee2434479a9028985}{FDParametersStartingPos}}\ =\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00402}00402\ \ \ SettingsBranch-\/>Branch(\textcolor{stringliteral}{"{}FDParametersStartingPos"{}},\ \&\mbox{\hyperlink{GetPostfitParamPlots_8cpp_a6dfe886b2ff4881ee2434479a9028985}{FDParametersStartingPos}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00403}00403\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00404}00404\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{GetPostfitParamPlots_8cpp_a5aedbc0849506477d31e20d345c967eb}{OscParameters}}\ =\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00405}00405\ \ \ SettingsBranch-\/>Branch(\textcolor{stringliteral}{"{}OscParameters"{}},\ \&\mbox{\hyperlink{GetPostfitParamPlots_8cpp_a5aedbc0849506477d31e20d345c967eb}{OscParameters}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00406}00406\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{GetPostfitParamPlots_8cpp_a3ec8e00c5c17bd6768473b08156f6c1c}{OscParametersStartingPos}}\ =\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00407}00407\ \ \ SettingsBranch-\/>Branch(\textcolor{stringliteral}{"{}OscParametersStartingPos"{}},\ \&\mbox{\hyperlink{GetPostfitParamPlots_8cpp_a3ec8e00c5c17bd6768473b08156f6c1c}{OscParametersStartingPos}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00408}00408\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00409}00409\ \ \ SettingsBranch-\/>Branch(\textcolor{stringliteral}{"{}NDSamplesBins"{}},\ \&\mbox{\hyperlink{classMCMCProcessor_ae76b02ce85737d30c778698ba127933b}{NDSamplesBins}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00410}00410\ \ \ SettingsBranch-\/>Branch(\textcolor{stringliteral}{"{}NDSamplesNames"{}},\ \&\mbox{\hyperlink{classMCMCProcessor_a27c8a25155baab660fc9658861c433ab}{NDSamplesNames}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00411}00411\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00412}00412\ \ \ SettingsBranch-\/>Fill();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00413}00413\ \ \ SettingsBranch-\/>Write();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00414}00414\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00415}00415\ \ \ \textcolor{keyword}{delete}\ SettingsBranch;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00416}00416\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00417}00417\ \ \ TDirectory\ *Names\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}Names"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00418}00418\ \ \ Names-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00419}00419\ \ \ \textcolor{keywordflow}{for}\ (std::vector<TString>::iterator\ it\ =\ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}.begin();\ it\ !=\ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}.end();\ ++it)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00420}00420\ \ \ \ \ TObjString((*it)).Write();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00421}00421\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00422}00422\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00423}00423\ \ \ \mbox{\hyperlink{classMCMCProcessor_aad661c6d53f9f891e18ff8ccdbd08479}{Central\_Value}}-\/>Write(\textcolor{stringliteral}{"{}Central\_Value"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00424}00424\ \ \ \mbox{\hyperlink{classMCMCProcessor_acaf7f239136dfa3506d095b612323d0a}{Means}}-\/>Write(\textcolor{stringliteral}{"{}PDF\_Means"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00425}00425\ \ \ \mbox{\hyperlink{classMCMCProcessor_a5174aaa900edf16ddc6e841ea4adae83}{Errors}}-\/>Write(\textcolor{stringliteral}{"{}PDF\_Error"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00426}00426\ \ \ \mbox{\hyperlink{classMCMCProcessor_a600fc8c39af2750df91fb7a0ff85ac74}{Means\_Gauss}}-\/>Write(\textcolor{stringliteral}{"{}Gauss\_Means"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00427}00427\ \ \ \mbox{\hyperlink{classMCMCProcessor_aa78b7ed1bb9966f84f4eaf8cedf5e688}{Errors\_Gauss}}-\/>Write(\textcolor{stringliteral}{"{}Gauss\_Errors"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00428}00428\ \ \ \mbox{\hyperlink{classMCMCProcessor_a32657dc39a7fc0d04804f6195a3d8c3e}{Means\_HPD}}-\/>Write(\textcolor{stringliteral}{"{}Means\_HPD"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00429}00429\ \ \ \mbox{\hyperlink{classMCMCProcessor_abb5c6ad85c89227bbb9bc5de2eb71272}{Errors\_HPD}}-\/>Write(\textcolor{stringliteral}{"{}Errors\_HPD"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00430}00430\ \ \ \mbox{\hyperlink{classMCMCProcessor_af96664fa8cc51c49ad1385da07a343b8}{Errors\_HPD\_Positive}}-\/>Write(\textcolor{stringliteral}{"{}Errors\_HPD\_Positive"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00431}00431\ \ \ \mbox{\hyperlink{classMCMCProcessor_a7b85df39f22390dac24f4d66a89518e5}{Errors\_HPD\_Negative}}-\/>Write(\textcolor{stringliteral}{"{}Errors\_HPD\_Negative"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00432}00432\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00433}00433\ \ \ PostDir-\/>Close();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00434}00434\ \ \ \textcolor{keyword}{delete}\ PostDir;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00435}00435\ \ \ PostHistDir-\/>Close();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00436}00436\ \ \ \textcolor{keyword}{delete}\ PostHistDir;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00437}00437\ \}\ \textcolor{comment}{//\ Have\ now\ written\ the\ postfit\ projections}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00438}00438\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00439}00439\ \textcolor{comment}{//\ *******************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00440}00440\ \textcolor{comment}{//CW:\ Draw\ the\ postfit}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00441}\mbox{\hyperlink{classMCMCProcessor_ab420de77e598da4b02ba74cdc20f2ea9}{00441}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_ab420de77e598da4b02ba74cdc20f2ea9}{MCMCProcessor::DrawPostfit}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00442}00442\ \textcolor{comment}{//\ *******************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00443}00443\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_aa5a7761e97cf2e24c7d877a5374b7333}{MakeOutputFile}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00444}00444\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00445}00445\ \ \ \textcolor{comment}{//\ Make\ the\ prefit\ plot}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00446}00446\ \ \ TH1D*\ prefit\ =\ \mbox{\hyperlink{classMCMCProcessor_a03267ff95cb0f4dab0882db852893768}{MakePrefit}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00447}00447\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00448}00448\ \ \ \textcolor{comment}{//\ cd\ into\ the\ output\ file}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00449}00449\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00450}00450\ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00451}00451\ \ \ std::string\ CutPosterior1D\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00452}00452\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a85917e25c4f5b5b966c50cccd9ddd6a0}{Posterior1DCut}}\ !=\ \textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00453}00453\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00454}00454\ \ \ \ \ CutPosterior1D\ =\ \mbox{\hyperlink{classMCMCProcessor_a576f0eb874afaf7e31ff5c86b9e5b8f9}{StepCut}}\ +\textcolor{stringliteral}{"{}\ \&\&\ "{}}\ +\ \mbox{\hyperlink{classMCMCProcessor_a85917e25c4f5b5b966c50cccd9ddd6a0}{Posterior1DCut}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00455}00455\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00456}00456\ \ \ \textcolor{keywordflow}{else}\ CutPosterior1D\ =\ \mbox{\hyperlink{classMCMCProcessor_a576f0eb874afaf7e31ff5c86b9e5b8f9}{StepCut}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00457}00457\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00458}00458\ \ \ \textcolor{comment}{//\ Make\ a\ TH1D\ of\ the\ central\ values\ and\ the\ errors}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00459}00459\ \ \ TH1D\ *paramPlot\ =\ \textcolor{keyword}{new}\ TH1D(\textcolor{stringliteral}{"{}paramPlot"{}},\ \textcolor{stringliteral}{"{}paramPlot"{}},\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00460}00460\ \ \ paramPlot-\/>SetName(\textcolor{stringliteral}{"{}mach3params"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00461}00461\ \ \ paramPlot-\/>SetTitle(CutPosterior1D.c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00462}00462\ \ \ paramPlot-\/>SetFillStyle(3001);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00463}00463\ \ \ paramPlot-\/>SetFillColor(kBlue-\/1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00464}00464\ \ \ paramPlot-\/>SetMarkerColor(paramPlot-\/>GetFillColor());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00465}00465\ \ \ paramPlot-\/>SetMarkerStyle(20);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00466}00466\ \ \ paramPlot-\/>SetLineColor(paramPlot-\/>GetFillColor());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00467}00467\ \ \ paramPlot-\/>SetMarkerSize(prefit-\/>GetMarkerSize());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00468}00468\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00469}00469\ \ \ \textcolor{comment}{//\ Same\ but\ with\ Gaussian\ output}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00470}00470\ \ \ TH1D\ *paramPlot\_Gauss\ =\ \textcolor{keyword}{static\_cast<}TH1D*\textcolor{keyword}{>}(paramPlot-\/>Clone());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00471}00471\ \ \ paramPlot\_Gauss-\/>SetMarkerColor(kOrange-\/5);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00472}00472\ \ \ paramPlot\_Gauss-\/>SetMarkerStyle(23);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00473}00473\ \ \ paramPlot\_Gauss-\/>SetLineWidth(2);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00474}00474\ \ \ paramPlot\_Gauss-\/>SetMarkerSize((prefit-\/>GetMarkerSize())*0.75);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00475}00475\ \ \ paramPlot\_Gauss-\/>SetFillColor(paramPlot\_Gauss-\/>GetMarkerColor());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00476}00476\ \ \ paramPlot\_Gauss-\/>SetFillStyle(3244);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00477}00477\ \ \ paramPlot\_Gauss-\/>SetLineColor(paramPlot\_Gauss-\/>GetMarkerColor());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00478}00478\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00479}00479\ \ \ \textcolor{comment}{//\ Same\ but\ with\ Gaussian\ output}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00480}00480\ \ \ TH1D\ *paramPlot\_HPD\ =\ \textcolor{keyword}{static\_cast<}TH1D*\textcolor{keyword}{>}(paramPlot-\/>Clone());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00481}00481\ \ \ paramPlot\_HPD-\/>SetMarkerColor(kBlack);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00482}00482\ \ \ paramPlot\_HPD-\/>SetMarkerStyle(25);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00483}00483\ \ \ paramPlot\_HPD-\/>SetLineWidth(2);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00484}00484\ \ \ paramPlot\_HPD-\/>SetMarkerSize((prefit-\/>GetMarkerSize())*0.5);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00485}00485\ \ \ paramPlot\_HPD-\/>SetFillColor(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00486}00486\ \ \ paramPlot\_HPD-\/>SetFillStyle(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00487}00487\ \ \ paramPlot\_HPD-\/>SetLineColor(paramPlot\_HPD-\/>GetMarkerColor());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00488}00488\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00489}00489\ \ \ \textcolor{comment}{//\ Set\ labels\ and\ data}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00490}00490\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00491}00491\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00492}00492\ \ \ \ \ \textcolor{comment}{//Those\ keep\ which\ parameter\ type\ we\ run\ currently\ and\ realtive\ number\ \ }}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00493}00493\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamEnu\ =\ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}[i];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00494}00494\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamNo\ =\ i\ -\/\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20b}{ParameterEnum}}(ParamEnu)];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00495}00495\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00496}00496\ \ \ \ \ \textcolor{comment}{//KS:\ Slightly\ hacky\ way\ to\ get\ relative\ to\ prior\ or\ nominal\ as\ this\ is\ convention\ we\ use}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00497}00497\ \ \ \ \ \textcolor{comment}{//This\ only\ applies\ for\ xsec\ for\ other\ systematic\ types\ doesn't\ matter}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00498}00498\ \ \ \ \ \textcolor{keywordtype}{double}\ CentralValueTemp\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00499}00499\ \ \ \ \ \textcolor{keywordtype}{double}\ Central,\ Central\_gauss,\ Central\_HPD;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00500}00500\ \ \ \ \ \textcolor{keywordtype}{double}\ Err,\ Err\_Gauss,\ Err\_HPD;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00501}00501\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00502}00502\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_afbac2a114c15ca7db4abe71dd549504c}{plotRelativeToPrior}})}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00503}00503\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00504}00504\ \ \ \ \ \ \ CentralValueTemp\ =\ \mbox{\hyperlink{classMCMCProcessor_a3a6614826ae320e462211e38e96d9d02}{ParamCentral}}[ParamEnu][ParamNo];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00505}00505\ \ \ \ \ \ \ \textcolor{comment}{//\ Normalise\ the\ prior\ relative\ the\ nominal/prior,\ just\ the\ way\ we\ get\ our\ fit\ results\ in\ MaCh3}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00506}00506\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ CentralValueTemp\ !=\ 0)\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00507}00507\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00508}00508\ \ \ \ \ \ \ \ \ Central\ =\ (*Means)(i)\ /\ CentralValueTemp;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00509}00509\ \ \ \ \ \ \ \ \ Err\ =\ (*Errors)(i)\ /\ CentralValueTemp;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00510}00510\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00511}00511\ \ \ \ \ \ \ \ \ Central\_gauss\ =\ (*Means\_Gauss)(i)\ /\ CentralValueTemp;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00512}00512\ \ \ \ \ \ \ \ \ Err\_Gauss\ =\ (*Errors\_Gauss)(i)\ /\ CentralValueTemp;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00513}00513\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00514}00514\ \ \ \ \ \ \ \ \ Central\_HPD\ =\ (*Means\_HPD)(i)\ /\ CentralValueTemp;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00515}00515\ \ \ \ \ \ \ \ \ Err\_HPD\ =\ (*Errors\_HPD)(i)\ /\ CentralValueTemp;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00516}00516\ \ \ \ \ \ \ \}\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00517}00517\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00518}00518\ \ \ \ \ \ \ \ \ Central\ =\ 1+(*Means)(i);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00519}00519\ \ \ \ \ \ \ \ \ Err\ =\ (*Errors)(i);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00520}00520\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00521}00521\ \ \ \ \ \ \ \ \ Central\_gauss\ =\ 1+(*Means\_Gauss)(i);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00522}00522\ \ \ \ \ \ \ \ \ Err\_Gauss\ =\ (*Errors\_Gauss)(i);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00523}00523\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00524}00524\ \ \ \ \ \ \ \ \ Central\_HPD\ =\ 1+(*Means\_HPD)(i)\ ;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00525}00525\ \ \ \ \ \ \ \ \ Err\_HPD\ =\ (*Errors\_HPD)(i);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00526}00526\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00527}00527\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00528}00528\ \ \ \ \ \textcolor{comment}{//KS:\ Just\ get\ value\ of\ each\ parameter\ without\ dividing\ by\ prior}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00529}00529\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00530}00530\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00531}00531\ \ \ \ \ \ \ Central\ =\ (*Means)(i);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00532}00532\ \ \ \ \ \ \ Err\ =\ (*Errors)(i);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00533}00533\ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00534}00534\ \ \ \ \ \ \ Central\_gauss\ =\ (*Means\_Gauss)(i);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00535}00535\ \ \ \ \ \ \ Err\_Gauss\ =\ (*Errors\_Gauss)(i);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00536}00536\ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00537}00537\ \ \ \ \ \ \ Central\_HPD\ =\ (*Means\_HPD)(i)\ ;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00538}00538\ \ \ \ \ \ \ Err\_HPD\ =\ (*Errors\_HPD)(i);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00539}00539\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00540}00540\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00541}00541\ \ \ \ \ paramPlot-\/>SetBinContent(i+1,\ Central);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00542}00542\ \ \ \ \ paramPlot-\/>SetBinError(i+1,\ Err);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00543}00543\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00544}00544\ \ \ \ \ paramPlot\_Gauss-\/>SetBinContent(i+1,\ Central\_gauss);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00545}00545\ \ \ \ \ paramPlot\_Gauss-\/>SetBinError(i+1,\ Err\_Gauss);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00546}00546\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00547}00547\ \ \ \ \ paramPlot\_HPD-\/>SetBinContent(i+1,\ Central\_HPD);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00548}00548\ \ \ \ \ paramPlot\_HPD-\/>SetBinError(i+1,\ Err\_HPD);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00549}00549\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00550}00550\ \ \ \ \ paramPlot-\/>GetXaxis()-\/>SetBinLabel(i+1,\ prefit-\/>GetXaxis()-\/>GetBinLabel(i+1));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00551}00551\ \ \ \ \ paramPlot\_Gauss-\/>GetXaxis()-\/>SetBinLabel(i+1,\ prefit-\/>GetXaxis()-\/>GetBinLabel(i+1));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00552}00552\ \ \ \ \ paramPlot\_HPD-\/>GetXaxis()-\/>SetBinLabel(i+1,\ prefit-\/>GetXaxis()-\/>GetBinLabel(i+1));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00553}00553\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00554}00554\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00555}00555\ \ \ \textcolor{comment}{//\ Make\ a\ TLegend}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00556}00556\ \ \ \textcolor{keyword}{auto}\ CompLeg\ =\ std::make\_unique<TLegend>(0.33,\ 0.73,\ 0.76,\ 0.95);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00557}00557\ \ \ CompLeg-\/>AddEntry(prefit,\ \textcolor{stringliteral}{"{}Prefit"{}},\ \textcolor{stringliteral}{"{}fp"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00558}00558\ \ \ CompLeg-\/>AddEntry(paramPlot,\ \textcolor{stringliteral}{"{}Postfit\ PDF"{}},\ \textcolor{stringliteral}{"{}fp"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00559}00559\ \ \ CompLeg-\/>AddEntry(paramPlot\_Gauss,\ \textcolor{stringliteral}{"{}Postfit\ Gauss"{}},\ \textcolor{stringliteral}{"{}fp"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00560}00560\ \ \ CompLeg-\/>AddEntry(paramPlot\_HPD,\ \textcolor{stringliteral}{"{}Postfit\ HPD"{}},\ \textcolor{stringliteral}{"{}lfep"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00561}00561\ \ \ CompLeg-\/>SetFillColor(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00562}00562\ \ \ CompLeg-\/>SetFillStyle(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00563}00563\ \ \ CompLeg-\/>SetLineWidth(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00564}00564\ \ \ CompLeg-\/>SetLineStyle(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00565}00565\ \ \ CompLeg-\/>SetBorderSize(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00566}00566\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00567}00567\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ BottomMargin\ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetBottomMargin();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00568}00568\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetBottomMargin(0.2);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00569}00569\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00570}00570\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00571}00571\ \ \ \textcolor{comment}{//KS:\ Plot\ Xsec\ and\ Flux}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00572}00572\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]\ >\ 0)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00573}00573\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00574}00574\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ Start\ =\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00575}00575\ \ \ \ \ \textcolor{comment}{//\ Plot\ the\ xsec\ parameters\ (0\ to\ \string~nXsec-\/nFlux)\ nXsec\ ==\ xsec\ +\ flux,\ quite\ confusing\ I\ know}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00576}00576\ \ \ \ \ \textcolor{comment}{//\ Have\ already\ looked\ through\ the\ branches\ earlier}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00577}00577\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_afbac2a114c15ca7db4abe71dd549504c}{plotRelativeToPrior}})\ \ prefit-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Variation\ rel.\ prior"{}});\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00578}00578\ \ \ \ \ \textcolor{keywordflow}{else}\ prefit-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Parameter\ Value"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00579}00579\ \ \ \ \ prefit-\/>GetYaxis()-\/>SetRangeUser(-\/2.5,\ 2.5);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00580}00580\ \ \ \ \ prefit-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00581}00581\ \ \ \ \ prefit-\/>GetXaxis()-\/>LabelsOption(\textcolor{stringliteral}{"{}v"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00582}00582\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00583}00583\ \ \ \ \ prefit-\/>GetXaxis()-\/>SetRangeUser(Start,\ Start\ +\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]-\/\mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00584}00584\ \ \ \ \ paramPlot-\/>GetXaxis()-\/>SetRangeUser(Start,\ Start\ +\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]-\/\mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00585}00585\ \ \ \ \ paramPlot\_Gauss-\/>GetXaxis()-\/>SetRangeUser(Start,\ Start+\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]-\/\mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00586}00586\ \ \ \ \ paramPlot\_HPD-\/>GetXaxis()-\/>SetRangeUser(Start,\ Start\ +\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]-\/\mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00587}00587\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00588}00588\ \ \ \ \ \textcolor{comment}{//\ Write\ the\ individual\ ones}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00589}00589\ \ \ \ \ prefit-\/>Write(\textcolor{stringliteral}{"{}param\_xsec\_prefit"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00590}00590\ \ \ \ \ paramPlot-\/>Write(\textcolor{stringliteral}{"{}param\_xsec"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00591}00591\ \ \ \ \ paramPlot\_Gauss-\/>Write(\textcolor{stringliteral}{"{}param\_xsec\_gaus"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00592}00592\ \ \ \ \ paramPlot\_HPD-\/>Write(\textcolor{stringliteral}{"{}param\_xsec\_HPD"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00593}00593\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00594}00594\ \ \ \ \ \textcolor{comment}{//\ And\ the\ combined}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00595}00595\ \ \ \ \ prefit-\/>Draw(\textcolor{stringliteral}{"{}e2"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00596}00596\ \ \ \ \ paramPlot-\/>Draw(\textcolor{stringliteral}{"{}e2,\ same"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00597}00597\ \ \ \ \ paramPlot\_Gauss-\/>Draw(\textcolor{stringliteral}{"{}e2,\ same"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00598}00598\ \ \ \ \ paramPlot\_HPD-\/>Draw(\textcolor{stringliteral}{"{}e1,\ same"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00599}00599\ \ \ \ \ CompLeg-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00600}00600\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Write(\textcolor{stringliteral}{"{}param\_xsec\_canv"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00601}00601\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00602}00602\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Clear();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00603}00603\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00604}00604\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00605}00605\ \ \ \ \ \textcolor{comment}{//\ Plot\ the\ flux\ parameters\ (nXSec\ to\ nxsec+nflux)\ if\ enabled}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00606}00606\ \ \ \ \ \textcolor{comment}{//\ Have\ already\ looked\ through\ the\ branches\ earlier}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00607}00607\ \ \ \ \ prefit-\/>GetYaxis()-\/>SetRangeUser(0.7,\ 1.3);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00608}00608\ \ \ \ \ paramPlot-\/>GetYaxis()-\/>SetRangeUser(0.7,\ 1.3);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00609}00609\ \ \ \ \ paramPlot\_Gauss-\/>GetYaxis()-\/>SetRangeUser(0.7,\ 1.3);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00610}00610\ \ \ \ \ paramPlot\_HPD-\/>GetYaxis()-\/>SetRangeUser(0.7,\ 1.3);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00611}00611\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00612}00612\ \ \ \ \ prefit-\/>GetXaxis()-\/>SetRangeUser(Start\ +\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]-\/\mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}},\ Start\ +\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00613}00613\ \ \ \ \ paramPlot-\/>GetXaxis()-\/>SetRangeUser(Start\ +\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]-\/\mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}},\ Start\ +\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00614}00614\ \ \ \ \ paramPlot\_Gauss-\/>GetXaxis()-\/>SetRangeUser(Start\ +\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]-\/\mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}},\ Start\ +\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00615}00615\ \ \ \ \ paramPlot\_HPD-\/>GetXaxis()-\/>SetRangeUser(Start\ +\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]-\/\mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}},\ Start\ +\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00616}00616\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00617}00617\ \ \ \ \ prefit-\/>Write(\textcolor{stringliteral}{"{}param\_flux\_prefit"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00618}00618\ \ \ \ \ paramPlot-\/>Write(\textcolor{stringliteral}{"{}param\_flux"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00619}00619\ \ \ \ \ paramPlot\_Gauss-\/>Write(\textcolor{stringliteral}{"{}param\_flux\_gaus"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00620}00620\ \ \ \ \ paramPlot\_HPD-\/>Write(\textcolor{stringliteral}{"{}param\_flux\_HPD"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00621}00621\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00622}00622\ \ \ \ \ prefit-\/>Draw(\textcolor{stringliteral}{"{}e2"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00623}00623\ \ \ \ \ paramPlot-\/>Draw(\textcolor{stringliteral}{"{}e2,\ same"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00624}00624\ \ \ \ \ paramPlot\_Gauss-\/>Draw(\textcolor{stringliteral}{"{}e1,\ same"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00625}00625\ \ \ \ \ paramPlot\_HPD-\/>Draw(\textcolor{stringliteral}{"{}e1,\ same"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00626}00626\ \ \ \ \ CompLeg-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00627}00627\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Write(\textcolor{stringliteral}{"{}param\_flux\_canv"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00628}00628\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00629}00629\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Clear();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00630}00630\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00631}00631\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}]\ >\ 0)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00632}00632\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00633}00633\ \ \ \ \ \textcolor{keywordtype}{int}\ Start\ =\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00634}00634\ \ \ \ \ \textcolor{keywordtype}{int}\ NDbinCounter\ =\ Start;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00635}00635\ \ \ \ \ \textcolor{comment}{//KS:\ Make\ prefit\ postfit\ for\ each\ ND\ sample,\ having\ all\ of\ them\ at\ the\ same\ plot\ is\ unreadable}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00636}00636\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a27c8a25155baab660fc9658861c433ab}{NDSamplesNames}}.size();\ i++\ )}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00637}00637\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00638}00638\ \ \ \ \ \ \ std::string\ NDname\ =\ \mbox{\hyperlink{classMCMCProcessor_a27c8a25155baab660fc9658861c433ab}{NDSamplesNames}}[i];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00639}00639\ \ \ \ \ \ \ NDbinCounter\ +=\ \mbox{\hyperlink{classMCMCProcessor_ae76b02ce85737d30c778698ba127933b}{NDSamplesBins}}[i];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00640}00640\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00641}00641\ \ \ \ \ \ \ prefit-\/>GetYaxis()-\/>SetTitle((\textcolor{stringliteral}{"{}Variation\ for\ "{}}+NDname).c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00642}00642\ \ \ \ \ \ \ prefit-\/>GetYaxis()-\/>SetRangeUser(0.6,\ 1.4);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00643}00643\ \ \ \ \ \ \ prefit-\/>GetXaxis()-\/>SetRangeUser(Start,\ NDbinCounter);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00644}00644\ \ \ \ \ \ \ prefit-\/>GetXaxis()-\/>SetTitle();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00645}00645\ \ \ \ \ \ \ prefit-\/>GetXaxis()-\/>LabelsOption(\textcolor{stringliteral}{"{}v"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00646}00646\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00647}00647\ \ \ \ \ \ \ paramPlot-\/>GetYaxis()-\/>SetTitle((\textcolor{stringliteral}{"{}Variation\ for\ "{}}+NDname).c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00648}00648\ \ \ \ \ \ \ paramPlot-\/>GetYaxis()-\/>SetRangeUser(0.6,\ 1.4);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00649}00649\ \ \ \ \ \ \ paramPlot-\/>GetXaxis()-\/>SetRangeUser(Start,\ NDbinCounter);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00650}00650\ \ \ \ \ \ \ paramPlot-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00651}00651\ \ \ \ \ \ \ paramPlot-\/>SetTitle(CutPosterior1D.c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00652}00652\ \ \ \ \ \ \ paramPlot-\/>GetXaxis()-\/>LabelsOption(\textcolor{stringliteral}{"{}v"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00653}00653\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00654}00654\ \ \ \ \ \ \ paramPlot\_Gauss-\/>GetYaxis()-\/>SetTitle((\textcolor{stringliteral}{"{}Variation\ for\ "{}}+NDname).c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00655}00655\ \ \ \ \ \ \ paramPlot\_Gauss-\/>GetYaxis()-\/>SetRangeUser(0.6,\ 1.4);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00656}00656\ \ \ \ \ \ \ paramPlot\_Gauss-\/>GetXaxis()-\/>SetRangeUser(Start,\ NDbinCounter);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00657}00657\ \ \ \ \ \ \ paramPlot\_Gauss-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00658}00658\ \ \ \ \ \ \ paramPlot\_Gauss-\/>SetTitle(CutPosterior1D.c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00659}00659\ \ \ \ \ \ \ paramPlot\_Gauss-\/>GetXaxis()-\/>LabelsOption(\textcolor{stringliteral}{"{}v"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00660}00660\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00661}00661\ \ \ \ \ \ \ paramPlot\_HPD-\/>GetYaxis()-\/>SetTitle((\textcolor{stringliteral}{"{}Variation\ for\ "{}}+NDname).c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00662}00662\ \ \ \ \ \ \ paramPlot\_HPD-\/>GetYaxis()-\/>SetRangeUser(0.6,\ 1.4);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00663}00663\ \ \ \ \ \ \ paramPlot\_HPD-\/>GetXaxis()-\/>SetRangeUser(Start,\ NDbinCounter);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00664}00664\ \ \ \ \ \ \ paramPlot\_HPD-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00665}00665\ \ \ \ \ \ \ paramPlot\_HPD-\/>SetTitle(CutPosterior1D.c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00666}00666\ \ \ \ \ \ \ paramPlot\_HPD-\/>GetXaxis()-\/>LabelsOption(\textcolor{stringliteral}{"{}v"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00667}00667\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00668}00668\ \ \ \ \ \ \ prefit-\/>Write((\textcolor{stringliteral}{"{}param\_"{}}+NDname+\textcolor{stringliteral}{"{}\_prefit"{}}).c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00669}00669\ \ \ \ \ \ \ paramPlot-\/>Write((\textcolor{stringliteral}{"{}param\_"{}}+NDname).c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00670}00670\ \ \ \ \ \ \ paramPlot\_Gauss-\/>Write((\textcolor{stringliteral}{"{}param\_"{}}+NDname+\textcolor{stringliteral}{"{}\_gaus"{}}).c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00671}00671\ \ \ \ \ \ \ paramPlot\_HPD-\/>Write((\textcolor{stringliteral}{"{}param\_"{}}+NDname+\textcolor{stringliteral}{"{}\_HPD"{}}).c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00672}00672\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00673}00673\ \ \ \ \ \ \ prefit-\/>Draw(\textcolor{stringliteral}{"{}e2"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00674}00674\ \ \ \ \ \ \ paramPlot-\/>Draw(\textcolor{stringliteral}{"{}e2,\ same"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00675}00675\ \ \ \ \ \ \ paramPlot\_Gauss-\/>Draw(\textcolor{stringliteral}{"{}e1,\ same"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00676}00676\ \ \ \ \ \ \ paramPlot\_HPD-\/>Draw(\textcolor{stringliteral}{"{}e1,\ same"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00677}00677\ \ \ \ \ \ \ CompLeg-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00678}00678\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Write((\textcolor{stringliteral}{"{}param\_"{}}+NDname+\textcolor{stringliteral}{"{}\_canv"{}}).c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00679}00679\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00680}00680\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Clear();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00681}00681\ \ \ \ \ \ \ Start\ +=\ \mbox{\hyperlink{classMCMCProcessor_ae76b02ce85737d30c778698ba127933b}{NDSamplesBins}}[i];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00682}00682\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00683}00683\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00684}00684\ \ \ \textcolor{keyword}{delete}\ prefit;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00685}00685\ \ \ \textcolor{keyword}{delete}\ paramPlot;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00686}00686\ \ \ \textcolor{keyword}{delete}\ paramPlot\_Gauss;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00687}00687\ \ \ \textcolor{keyword}{delete}\ paramPlot\_HPD;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00688}00688\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00689}00689\ \ \ \textcolor{comment}{//KS:\ Return\ Margin\ to\ default\ one}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00690}00690\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetBottomMargin(BottomMargin);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00691}00691\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00692}00692\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00693}00693\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00694}00694\ \textcolor{comment}{//\ Make\ fancy\ Credible\ Intervals\ plots}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00695}\mbox{\hyperlink{classMCMCProcessor_a17c0f09bfce82d1701a83645f748988a}{00695}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_a17c0f09bfce82d1701a83645f748988a}{MCMCProcessor::MakeCredibleIntervals}}(\textcolor{keyword}{const}\ std::vector<double>\&\ CredibleIntervals,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00696}00696\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<Color\_t>\&\ CredibleIntervalsColours,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00697}00697\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ CredibleInSigmas)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00698}00698\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00699}00699\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[0]\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_a8667510132aa01395520f028287f511b}{MakePostfit}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00700}00700\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00701}00701\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ Credible\ Intervals\ "{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00702}00702\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00703}00703\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ LeftMargin\ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetLeftMargin();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00704}00704\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetLeftMargin(0.15);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00705}00705\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00706}00706\ \ \ \textcolor{keywordflow}{if}(CredibleIntervals.size()\ !=\ CredibleIntervalsColours.size())}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00707}00707\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00708}00708\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Size\ of\ \ CredibleIntervals\ is\ not\ equal\ to\ size\ of\ CredibleIntervalsColours"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00709}00709\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00710}00710\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00711}00711\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00712}00712\ \ \ \textcolor{keywordflow}{if}(CredibleIntervals.size()\ >\ 1)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00713}00713\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00714}00714\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ CredibleIntervals.size();\ i++\ )}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00715}00715\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00716}00716\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(CredibleIntervals[i]\ >\ CredibleIntervals[i-\/1])}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00717}00717\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00718}00718\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Interval\ \{\}\ is\ smaller\ than\ \{\}"{}},\ i,\ i-\/1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00719}00719\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}\{:.2f\}\ \{:.2f\}"{}},\ CredibleIntervals[i],\ CredibleIntervals[i-\/1]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00720}00720\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}They\ should\ be\ grouped\ in\ decreasing\ order"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00721}00721\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00722}00722\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00723}00723\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00724}00724\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00725}00725\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00726}00726\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nCredible\ =\ int(CredibleIntervals.size());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00727}00727\ \ \ std::vector<TH1D*>\ hpost\_copy(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00728}00728\ \ \ std::vector<std::vector<TH1D*>>\ hpost\_cl(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00729}00729\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00730}00730\ \ \ \textcolor{comment}{//KS:\ Copy\ all\ histograms\ to\ be\ thread\ safe}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00731}00731\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00732}00732\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00733}00733\ \ \ \ \ hpost\_copy[i]\ =\ \textcolor{keyword}{static\_cast<}TH1D*\textcolor{keyword}{>}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>Clone(Form(\textcolor{stringliteral}{"{}hpost\_copy\_\%i"{}},\ i)));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00734}00734\ \ \ \ \ hpost\_cl[i].resize(nCredible);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00735}00735\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nCredible;\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00736}00736\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00737}00737\ \ \ \ \ \ \ hpost\_cl[i][j]\ =\ \textcolor{keyword}{static\_cast<}TH1D*\textcolor{keyword}{>}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>Clone(Form(\textcolor{stringliteral}{"{}hpost\_copy\_\%i\_CL\_\%f"{}},\ i,\ CredibleIntervals[j])));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00738}00738\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00739}00739\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Reset\ to\ get\ rid\ to\ TF1\ otherwise\ we\ run\ into\ segfault\ :(}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00740}00740\ \ \ \ \ \ \ hpost\_cl[i][j]-\/>Reset(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00741}00741\ \ \ \ \ \ \ hpost\_cl[i][j]-\/>Fill(0.0,\ 0.0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00742}00742\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00743}00743\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00744}00744\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00745}00745\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00746}00746\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00747}00747\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00748}00748\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00749}00749\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00751}00751\ \ \ \ \ hpost\_copy[i]-\/>Scale(1.\ /\ hpost\_copy[i]-\/>Integral());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00752}00752\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nCredible;\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00753}00753\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00754}00754\ \ \ \ \ \ \ \textcolor{comment}{//\ Scale\ the\ histograms\ before\ gettindg\ credible\ intervals}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00755}00755\ \ \ \ \ \ \ hpost\_cl[i][j]-\/>Scale(1.\ /\ hpost\_cl[i][j]-\/>Integral());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00756}00756\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00757}00757\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ We\ have\ slightly\ different\ approach\ depending\ if\ you\ passed\ percentage\ or\ sigmas}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00758}00758\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(CredibleInSigmas)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00759}00759\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00760}00760\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Convert\ sigmas\ into\ percentage}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00761}00761\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ CredInter\ =\ \mbox{\hyperlink{StatisticalUtils_8h_a04394b98587b44b98b003bd1226606ed}{GetSigmaValue}}(\textcolor{keywordtype}{int}(std::round(CredibleIntervals[j])));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00762}00762\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{StatisticalUtils_8h_aac24043cc7a5ef6a05fc1b10d3860875}{GetCredibleInterval}}(hpost\_copy[i],\ hpost\_cl[i][j],\ CredInter);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00763}00763\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00764}00764\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00765}00765\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00766}00766\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{StatisticalUtils_8h_aac24043cc7a5ef6a05fc1b10d3860875}{GetCredibleInterval}}(hpost\_copy[i],\ hpost\_cl[i][j],\ CredibleIntervals[j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00767}00767\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00768}00768\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00769}00769\ \ \ \ \ \ \ hpost\_cl[i][j]-\/>SetFillColor(CredibleIntervalsColours[j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00770}00770\ \ \ \ \ \ \ hpost\_cl[i][j]-\/>SetLineWidth(1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00771}00771\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00772}00772\ \ \ \ \ hpost\_copy[i]-\/>GetYaxis()-\/>SetTitleOffset(1.8);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00773}00773\ \ \ \ \ hpost\_copy[i]-\/>SetLineWidth(1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00774}00774\ \ \ \ \ hpost\_copy[i]-\/>SetMaximum(hpost\_copy[i]-\/>GetMaximum()*1.2);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00775}00775\ \ \ \ \ hpost\_copy[i]-\/>SetLineWidth(2);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00776}00776\ \ \ \ \ hpost\_copy[i]-\/>SetLineColor(kBlack);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00777}00777\ \ \ \ \ hpost\_copy[i]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Posterior\ Probability"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00778}00778\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00779}00779\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00780}00780\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00781}00781\ \ \ TDirectory\ *CredibleDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}Credible"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00782}00782\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00783}00783\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00784}00784\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00785}00785\ \ \ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{classMCMCProcessor_a95fa49737432818bc830a44898d0d850}{IamVaried}}[i])\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00786}00786\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00787}00787\ \ \ \ \ \textcolor{comment}{//\ Now\ make\ the\ TLine\ for\ the\ Asimov}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00788}00788\ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00789}00789\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00790}00790\ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00791}00791\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00792}00792\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(i,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00793}00793\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00794}00794\ \ \ \ \ \textcolor{keyword}{auto}\ Asimov\ =\ std::make\_unique<TLine>(Prior,\ hpost\_copy[i]-\/>GetMinimum(),\ Prior,\ hpost\_copy[i]-\/>GetMaximum());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00795}00795\ \ \ \ \ Asimov-\/>SetLineColor(kRed-\/3);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00796}00796\ \ \ \ \ Asimov-\/>SetLineWidth(2);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00797}00797\ \ \ \ \ Asimov-\/>SetLineStyle(kDashed);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00798}00798\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00799}00799\ \ \ \ \ \textcolor{keyword}{auto}\ legend\ =\ std::make\_unique<TLegend>(0.20,\ 0.7,\ 0.4,\ 0.92);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00800}00800\ \ \ \ \ legend-\/>SetTextSize(0.03);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00801}00801\ \ \ \ \ legend-\/>SetFillColor(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00802}00802\ \ \ \ \ legend-\/>SetFillStyle(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00803}00803\ \ \ \ \ legend-\/>SetLineColor(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00804}00804\ \ \ \ \ legend-\/>SetLineStyle(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00805}00805\ \ \ \ \ legend-\/>SetBorderSize(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00806}00806\ \ \ \ \ hpost\_copy[i]-\/>Draw(\textcolor{stringliteral}{"{}HIST"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00807}00807\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00808}00808\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nCredible;\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00809}00809\ \ \ \ \ \ \ \ \ hpost\_cl[i][j]-\/>Draw(\textcolor{stringliteral}{"{}HIST\ SAME"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00810}00810\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ nCredible-\/1;\ j\ >=\ 0;\ -\/-\/j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00811}00811\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00812}00812\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(CredibleInSigmas)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00813}00813\ \ \ \ \ \ \ \ \ legend-\/>AddEntry(hpost\_cl[i][j],\ Form(\textcolor{stringliteral}{"{}\%.0f\#sigma\ Credible\ Interval"{}},\ CredibleIntervals[j]),\ \textcolor{stringliteral}{"{}f"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00814}00814\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00815}00815\ \ \ \ \ \ \ \ \ legend-\/>AddEntry(hpost\_cl[i][j],\ Form(\textcolor{stringliteral}{"{}\%.0f\%\%\ Credible\ Interval"{}},\ CredibleIntervals[j]*100),\ \textcolor{stringliteral}{"{}f"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00816}00816\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00817}00817\ \ \ \ \ legend-\/>AddEntry(Asimov.get(),\ Form(\textcolor{stringliteral}{"{}\#splitline\{Prior\}\{x\ =\ \%.2f\ ,\ \#sigma\ =\ \%.2f\}"{}},\ Prior,\ PriorError),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00818}00818\ \ \ \ \ legend-\/>Draw(\textcolor{stringliteral}{"{}SAME"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00819}00819\ \ \ \ \ Asimov-\/>Draw(\textcolor{stringliteral}{"{}SAME"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00820}00820\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00821}00821\ \ \ \ \ \textcolor{comment}{//\ Write\ to\ file}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00822}00822\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetName(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetName());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00823}00823\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTitle(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetTitle());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00824}00824\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00825}00825\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00826}00826\ \ \ \ \ \textcolor{comment}{//\ cd\ into\ directory\ in\ root\ file}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00827}00827\ \ \ \ \ CredibleDir-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00828}00828\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Write();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00829}00829\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00830}00830\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00831}00831\ \ \ \textcolor{comment}{//KS:\ Remove\ histograms}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00832}00832\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00833}00833\ \ \ \ \ \textcolor{keyword}{delete}\ hpost\_copy[i];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00834}00834\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nCredible;\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00835}00835\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ hpost\_cl[i][j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00836}00836\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00837}00837\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00838}00838\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00839}00839\ \ \ CredibleDir-\/>Close();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00840}00840\ \ \ \textcolor{keyword}{delete}\ CredibleDir;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00841}00841\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00842}00842\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00843}00843\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00844}00844\ \ \ \textcolor{comment}{//Set\ back\ to\ normal}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00845}00845\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetLeftMargin(LeftMargin);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00846}00846\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00847}00847\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00848}00848\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00849}00849\ \textcolor{comment}{//\ Make\ fancy\ violin\ plots}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00850}\mbox{\hyperlink{classMCMCProcessor_a04976c69f0ef0b3f39edcf5f25f90981}{00850}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_a04976c69f0ef0b3f39edcf5f25f90981}{MCMCProcessor::MakeViolin}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00851}00851\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00852}00852\ \ \ \textcolor{comment}{//KS:\ Make\ sure\ we\ have\ steps}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00853}00853\ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{classMCMCProcessor_aea84f0315695aa05ec41fcf965b1b031}{CacheMCMC}})\ \mbox{\hyperlink{classMCMCProcessor_ace48a54fb08e2a3943d4e2ed1f8c4a4b}{CacheSteps}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00854}00854\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00855}00855\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Producing\ Violin\ Plot"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00856}00856\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00857}00857\ \ \ \textcolor{comment}{//KS:\ Find\ min\ and\ max\ to\ make\ histogram\ in\ range}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00858}00858\ \ \ \textcolor{keywordtype}{double}\ maxi\_y\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMaximum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[0]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00859}00859\ \ \ \textcolor{keywordtype}{double}\ mini\_y\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMinimum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[0]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00860}00860\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00861}00861\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00862}00862\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMaximum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i])\ >\ maxi\_y)\ maxi\_y\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMaximum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00863}00863\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMinimum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i])\ <\ mini\_y)\ mini\_y\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMinimum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00864}00864\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00865}00865\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00866}00866\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ vBins\ =\ (maxi\_y-\/mini\_y)*25;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00867}00867\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00868}00868\ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}\ =\ \textcolor{keyword}{new}\ TH2D(\textcolor{stringliteral}{"{}hviolin"{}},\ \textcolor{stringliteral}{"{}hviolin"{}},\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ vBins,\ mini\_y,\ maxi\_y);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00869}00869\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00870}00870\ \ \ \textcolor{comment}{//KS:\ Prior\ has\ larger\ errors\ so\ we\ increase\ range\ and\ number\ of\ bins}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00871}00871\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ PriorFactor\ =\ 4;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00872}00872\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}\ =\ \textcolor{keyword}{new}\ TH2D(\textcolor{stringliteral}{"{}hviolin\_prior"{}},\ \textcolor{stringliteral}{"{}hviolin\_prior"{}},\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ PriorFactor*vBins,\ PriorFactor*mini\_y,\ PriorFactor*maxi\_y);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00873}00873\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00874}00874\ \ \ \textcolor{keyword}{auto}\ rand\ =\ std::make\_unique<TRandom3>(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00875}00875\ \ \ std::vector<double>\ PriorVec(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00876}00876\ \ \ std::vector<double>\ PriorErrorVec(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00877}00877\ \ \ std::vector<bool>\ PriorFlatVec(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00878}00878\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00879}00879\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++x)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00880}00880\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00881}00881\ \ \ \ \ TString\ Title;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00882}00882\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior,\ PriorError;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00883}00883\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00884}00884\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(x,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00885}00885\ \ \ \ \ \textcolor{comment}{//Set\ fancy\ labels}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00886}00886\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>GetXaxis()-\/>SetBinLabel(x+1,\ Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00887}00887\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>GetXaxis()-\/>SetBinLabel(x+1,\ Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00888}00888\ \ \ \ \ PriorVec[x]\ =\ Prior;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00889}00889\ \ \ \ \ PriorErrorVec[x]\ =\ PriorError;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00890}00890\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00891}00891\ \ \ \ \ \mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20b}{ParameterEnum}}\ ParType\ =\ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}[x];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00892}00892\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamTemp\ =\ x\ -\/\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[ParType];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00893}00893\ \ \ \ \ PriorFlatVec[x]\ =\ \mbox{\hyperlink{classMCMCProcessor_a4be1eedb743e4ea410009a4fa45720f7}{ParamFlat}}[ParType][ParamTemp];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00894}00894\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00895}00895\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00896}00896\ \ \ TStopwatch\ clock;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00897}00897\ \ \ clock.Start();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00898}00898\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00899}00899\ \ \ \textcolor{comment}{//\ nDraw\ is\ number\ of\ draws\ we\ want\ to\ do}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00900}00900\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00901}00901\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00902}00902\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00903}00903\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++x)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00904}00904\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00905}00905\ \ \ \ \ \textcolor{comment}{//KS:\ Consider\ another\ treatment\ for\ fixed\ params}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00906}00906\ \ \ \ \ \textcolor{comment}{//if\ (IamVaried[x]\ ==\ false)\ continue;}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00907}00907\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++k)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00908}00908\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00909}00909\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Burn\ in\ cut}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00910}00910\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}[k]\ <\ \mbox{\hyperlink{classMCMCProcessor_a22f82dadceccbe87dd8c5b7daa8432e8}{BurnInCut}})\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00911}00911\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00912}00912\ \ \ \ \ \ \ \textcolor{comment}{//Only\ used\ for\ Suboptimatlity}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00913}00913\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}[k]\ >\ \mbox{\hyperlink{classMCMCProcessor_a840c686f15f419c0156df01c4ed62931}{UpperCut}})\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00914}00914\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00915}00915\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ We\ know\ exactly\ which\ x\ bin\ we\ will\ end\ up,\ find\ y\ bin.\ This\ allow\ to\ avoid\ coslty\ Fill()\ and\ enable\ multithreading\ becasue\ I\ am\ master\ of\ faster}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00916}00916\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ y\ =\ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>GetYaxis()-\/>FindBin(\mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[x][k]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00917}00917\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>SetBinContent(x+1,\ y,\ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>GetBinContent(x+1,\ y)+1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00918}00918\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00919}00919\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00920}00920\ \ \ \ \ \textcolor{comment}{//KS:\ If\ we\ set\ option\ to\ not\ plot\ flat\ prior\ and\ param\ has\ flat\ prior\ then\ we\ skip\ this\ step}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00921}00921\ \ \ \ \ \textcolor{keywordflow}{if}(!(!\mbox{\hyperlink{classMCMCProcessor_ad24411a2556504c440ff0af045e8e7aa}{PlotFlatPrior}}\ \&\&\ PriorFlatVec[x]))}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00922}00922\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00923}00923\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++k)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00924}00924\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00925}00925\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Entry\ =\ rand-\/>Gaus(PriorVec[x],\ PriorErrorVec[x]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00926}00926\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ y\ =\ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>GetYaxis()-\/>FindBin(Entry);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00927}00927\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>SetBinContent(x+1,\ y,\ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>GetBinContent(x+1,\ y)+1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00928}00928\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00929}00929\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00930}00930\ \ \ \}\ \textcolor{comment}{//\ end\ the\ for\ loop\ over\ nDraw}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00931}00931\ \ \ clock.Stop();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00932}00932\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ Violin\ plot\ took\ \{:.2f\}s\ to\ finish\ for\ \{\}\ steps"{}},\ clock.RealTime(),\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00933}00933\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00934}00934\ \ \ \textcolor{comment}{//KS:\ Tells\ how\ many\ parameters\ in\ one\ canvas\ we\ want}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00935}00935\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ IntervalsSize\ =\ 10;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00936}00936\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ NIntervals\ =\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}/IntervalsSize;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00937}00937\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00938}00938\ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Parameter\ Value"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00939}00939\ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>GetXaxis()-\/>SetTitle();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00940}00940\ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>GetXaxis()-\/>LabelsOption(\textcolor{stringliteral}{"{}v"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00941}00941\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00942}00942\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Parameter\ Value"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00943}00943\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>GetXaxis()-\/>SetTitle();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00944}00944\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>GetXaxis()-\/>LabelsOption(\textcolor{stringliteral}{"{}v"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00945}00945\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00946}00946\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>SetLineColor(kRed);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00947}00947\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>SetMarkerColor(kRed);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00948}00948\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>SetFillColorAlpha(kRed,\ 0.35);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00949}00949\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>SetMarkerStyle(20);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00950}00950\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>SetMarkerSize(0.5);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00951}00951\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00952}00952\ \ \ \textcolor{comment}{//\ These\ control\ violin\ width,\ if\ you\ use\ larger\ then\ 1\ they\ will\ most\ likely\ overlay,\ so\ be\ cautious}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00953}00953\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>SetBarWidth(1.0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00954}00954\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>SetBarOffset(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00955}00955\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00956}00956\ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>SetLineColor(kBlue);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00957}00957\ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>SetMarkerColor(kBlue);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00958}00958\ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>SetFillColorAlpha(kBlue,\ 0.35);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00959}00959\ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>SetMarkerStyle(20);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00960}00960\ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>SetMarkerSize(1.0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00961}00961\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00962}00962\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ BottomMargin\ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetBottomMargin();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00963}00963\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetBottomMargin(0.2);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00964}00964\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00965}00965\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00966}00966\ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>Write(\textcolor{stringliteral}{"{}param\_violin"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00967}00967\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>Write(\textcolor{stringliteral}{"{}param\_violin\_prior"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00968}00968\ \ \ \textcolor{comment}{//KS:\ This\ is\ mostly\ for\ example\ plots,\ we\ have\ full\ file\ in\ the\ ROOT\ file\ so\ can\ do\ much\ better\ plot\ later}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00969}00969\ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>GetYaxis()-\/>SetRangeUser(-\/1,\ +2);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00970}00970\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>GetYaxis()-\/>SetRangeUser(-\/1,\ +2);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00971}00971\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ NIntervals+1;\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00972}00972\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00973}00973\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>GetXaxis()-\/>SetRangeUser(i*IntervalsSize,\ i*IntervalsSize+IntervalsSize);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00974}00974\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>GetXaxis()-\/>SetRangeUser(i*IntervalsSize,\ i*IntervalsSize+IntervalsSize);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00975}00975\ \ \ \ \ \textcolor{keywordflow}{if}(i\ ==\ NIntervals+1)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00976}00976\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00977}00977\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>GetXaxis()-\/>SetRangeUser(i*IntervalsSize,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00978}00978\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>GetXaxis()-\/>SetRangeUser(i*IntervalsSize,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00979}00979\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00980}00980\ \ \ \ \ \textcolor{comment}{//KS:\ ROOT6\ has\ some\ additional\ options,\ consider\ updating\ it.\ more\ https://root.cern/doc/master/classTHistPainter.html\#HP140b}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00981}00981\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>Draw(\textcolor{stringliteral}{"{}violinX(03100300)"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00982}00982\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>Draw(\textcolor{stringliteral}{"{}violinX(03100300)\ SAME"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00983}00983\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00984}00984\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00985}00985\ \ \ \textcolor{comment}{//KS:\ Return\ Margin\ to\ default\ one}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00986}00986\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetBottomMargin(BottomMargin);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00987}00987\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00988}00988\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00989}00989\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00990}00990\ \textcolor{comment}{//\ Make\ the\ post-\/fit\ covariance\ matrix\ in\ all\ dimensions}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00991}\mbox{\hyperlink{classMCMCProcessor_afc94f21ffd599b1e2dd7e62f24f6c4de}{00991}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_afc94f21ffd599b1e2dd7e62f24f6c4de}{MCMCProcessor::MakeCovariance}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00992}00992\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00993}00993\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_aa5a7761e97cf2e24c7d877a5374b7333}{MakeOutputFile}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00994}00994\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00995}00995\ \ \ \textcolor{keywordtype}{bool}\ HaveMadeDiagonal\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00996}00996\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ post-\/fit\ covariances..."{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00997}00997\ \ \ \textcolor{comment}{//\ Check\ that\ the\ diagonal\ entries\ have\ been\ filled}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00998}00998\ \ \ \textcolor{comment}{//\ i.e.\ MakePostfit()\ has\ been\ called}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l00999}00999\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01000}01000\ \ \ \ \ \textcolor{keywordflow}{if}\ ((*\mbox{\hyperlink{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}{Covariance}})(i,i)\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}})\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01001}01001\ \ \ \ \ \ \ HaveMadeDiagonal\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01002}01002\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Have\ not\ run\ diagonal\ elements\ in\ covariance,\ will\ do\ so\ now\ by\ calling\ MakePostfit()"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01003}01003\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01004}01004\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01005}01005\ \ \ \ \ \ \ HaveMadeDiagonal\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01006}01006\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01007}01007\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01008}01008\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01009}01009\ \ \ \textcolor{keywordflow}{if}\ (HaveMadeDiagonal\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01010}01010\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a8667510132aa01395520f028287f511b}{MakePostfit}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01011}01011\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01012}01012\ \ \ gStyle-\/>SetPalette(55);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01013}01013\ \ \ \textcolor{comment}{//\ Now\ we\ are\ sure\ we\ have\ the\ diagonal\ elements,\ let's\ make\ the\ off-\/diagonals}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01014}01014\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01015}01015\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01016}01016\ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ \%\ (\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}/5)\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01017}01017\ \ \ \ \ \ \ \mbox{\hyperlink{namespaceMaCh3Utils_a4c8bdeb1d34606aed192e9f1311a72f5}{MaCh3Utils::PrintProgressBar}}(i,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01018}01018\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01019}01019\ \ \ \ \ TString\ Title\_i\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01020}01020\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\_i,\ PriorError;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01021}01021\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01022}01022\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(i,\ Prior\_i,\ PriorError,\ Title\_i);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01023}01023\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01024}01024\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ min\_i\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMinimum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01025}01025\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ max\_i\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMaximum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01026}01026\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01027}01027\ \ \ \ \ \textcolor{comment}{//\ Loop\ over\ the\ other\ parameters\ to\ get\ the\ correlations}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01028}01028\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01029}01029\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01030}01030\ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ the\ diagonal\ elements\ which\ we've\ already\ done\ above}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01031}01031\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ ==\ i)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01032}01032\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01033}01033\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ this\ parameter\ isn't\ varied}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01034}01034\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a95fa49737432818bc830a44898d0d850}{IamVaried}}[j]\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01035}01035\ \ \ \ \ \ \ \ \ (*Covariance)(i,j)\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01036}01036\ \ \ \ \ \ \ \ \ (*Covariance)(j,i)\ =\ (*\mbox{\hyperlink{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}{Covariance}})(i,j);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01037}01037\ \ \ \ \ \ \ \ \ (*Correlation)(i,j)\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01038}01038\ \ \ \ \ \ \ \ \ (*Correlation)(j,i)\ =\ (*\mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}})(i,j);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01039}01039\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01040}01040\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01041}01041\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01042}01042\ \ \ \ \ \ \ TString\ Title\_j\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01043}01043\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\_j,\ PriorError\_j;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01044}01044\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(j,\ Prior\_j,\ PriorError\_j,\ Title\_j);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01045}01045\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01046}01046\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01047}01047\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01048}01048\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ draw\ which\ we\ want\ to\ perform}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01049}01049\ \ \ \ \ \ \ TString\ DrawMe\ =\ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[j]+\textcolor{stringliteral}{"{}:"{}}+\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01050}01050\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01051}01051\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ max\_j\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMaximum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01052}01052\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ min\_j\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMinimum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01053}01053\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01054}01054\ \ \ \ \ \ \ \textcolor{comment}{//\ TH2F\ to\ hold\ the\ Correlation\ }}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01055}01055\ \ \ \ \ \ \ std::unique\_ptr<TH2D>\ hpost\_2D\ =\ std::make\_unique<TH2D>(DrawMe,\ DrawMe,\ \mbox{\hyperlink{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}{nBins}},\ min\_i,\ max\_i,\ \mbox{\hyperlink{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}{nBins}},\ min\_j,\ max\_j);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01056}01056\ \ \ \ \ \ \ hpost\_2D-\/>SetMinimum(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01057}01057\ \ \ \ \ \ \ hpost\_2D-\/>GetXaxis()-\/>SetTitle(Title\_i);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01058}01058\ \ \ \ \ \ \ hpost\_2D-\/>GetYaxis()-\/>SetTitle(Title\_j);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01059}01059\ \ \ \ \ \ \ hpost\_2D-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Steps"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01060}01060\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01061}01061\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ draw\ command\ we\ want,\ i.e.\ draw\ param\ j\ vs\ param\ i}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01062}01062\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>Project(DrawMe,\ DrawMe,\ \mbox{\hyperlink{classMCMCProcessor_a576f0eb874afaf7e31ff5c86b9e5b8f9}{StepCut}}.c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01063}01063\ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01064}01064\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a682c1c47626542f5820d633ba2bc010c}{ApplySmoothing}})\ hpost\_2D-\/>Smooth();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01065}01065\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ Covariance\ for\ these\ two\ parameters}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01066}01066\ \ \ \ \ \ \ (*Covariance)(i,j)\ =\ hpost\_2D-\/>GetCovariance();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01067}01067\ \ \ \ \ \ \ (*Covariance)(j,i)\ =\ (*\mbox{\hyperlink{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}{Covariance}})(i,j);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01068}01068\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01069}01069\ \ \ \ \ \ \ (*Correlation)(i,j)\ =\ hpost\_2D-\/>GetCorrelationFactor();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01070}01070\ \ \ \ \ \ \ (*Correlation)(j,i)\ =\ (*\mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}})(i,j);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01071}01071\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01072}01072\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01073}01073\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01074}01074\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Skip\ Flux\ Params}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01075}01075\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}[i]\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}\ \&\&\ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}[j]\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}})}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01076}01076\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01077}01077\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a2c06d64020e9246e720cc131a9f4986d}{IsXsec}}[j]\ \&\&\ \mbox{\hyperlink{classMCMCProcessor_a2c06d64020e9246e720cc131a9f4986d}{IsXsec}}[i]\ \&\&\ std::fabs((*\mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}})(i,j))\ >\ \mbox{\hyperlink{classMCMCProcessor_a25e4685b6299181021b02ac0e0b74681}{Post2DPlotThreshold}})}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01078}01078\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01079}01079\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01080}01080\ \ \ \ \ \ \ \ \ \ \ \ \ hpost\_2D-\/>Draw(\textcolor{stringliteral}{"{}colz"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01081}01081\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetName(hpost\_2D-\/>GetName());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01082}01082\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTitle(hpost\_2D-\/>GetTitle());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01083}01083\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01084}01084\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01085}01085\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01086}01086\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01087}01087\ \ \ \ \ \ \ \textcolor{comment}{//\ Write\ it\ to\ root\ file}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01088}01088\ \ \ \ \ \ \ \textcolor{comment}{//OutputFile-\/>cd();}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01089}01089\ \ \ \ \ \ \ \textcolor{comment}{//if(\ std::fabs((*Correlation)(i,j))\ >\ Post2DPlotThreshold\ )\ hpost\_2D-\/>Write();}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01090}01090\ \ \ \ \ \}\ \textcolor{comment}{//\ End\ j\ loop}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01091}01091\ \ \ \}\ \textcolor{comment}{//\ End\ i\ loop}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01092}01092\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01093}01093\ \ \ \mbox{\hyperlink{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}{Covariance}}-\/>Write(\textcolor{stringliteral}{"{}Covariance"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01094}01094\ \ \ \mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}}-\/>Write(\textcolor{stringliteral}{"{}Correlation"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01095}01095\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01096}01096\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01097}01097\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01098}01098\ \textcolor{comment}{//KS:\ Cache\ all\ steps\ to\ allow\ multithreading,\ hit\ RAM\ quite\ a\ bit}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01099}\mbox{\hyperlink{classMCMCProcessor_ace48a54fb08e2a3943d4e2ed1f8c4a4b}{01099}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_ace48a54fb08e2a3943d4e2ed1f8c4a4b}{MCMCProcessor::CacheSteps}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01100}01100\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01101}01101\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aea84f0315695aa05ec41fcf965b1b031}{CacheMCMC}}\ ==\ \textcolor{keyword}{true})\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01102}01102\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01103}01103\ \ \ \mbox{\hyperlink{classMCMCProcessor_aea84f0315695aa05ec41fcf965b1b031}{CacheMCMC}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01104}01104\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01105}01105\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}\ !=\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01106}01106\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01107}01107\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}It\ look\ like\ ParStep\ was\ already\ filled\ "{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01108}01108\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Even\ though\ it\ is\ used\ for\ MakeCovariance\_MP\ and\ for\ DiagMCMC\ "{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01109}01109\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}it\ has\ different\ structure\ in\ both\ for\ cache\ hits,\ sorry\ "{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01110}01110\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01111}01111\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01112}01112\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01113}01113\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Caching\ input\ tree..."{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01114}01114\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Allocating\ \{:.2f\}\ MB"{}},\ \textcolor{keywordtype}{double}(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double})*\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}*\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}})/1.E6);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01115}01115\ \ \ TStopwatch\ clock;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01116}01116\ \ \ clock.Start();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01117}01117\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01118}01118\ \ \ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01119}01119\ \ \ \mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{int}[\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01120}01120\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01121}01121\ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}\ =\ \textcolor{keyword}{new}\ TH2D**[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}]();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01122}01122\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01123}01123\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01124}01124\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01125}01125\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[i]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01126}01126\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i]\ =\ \textcolor{keyword}{new}\ TH2D*[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}]();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01127}01127\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01128}01128\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01129}01129\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01130}01130\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[i][j]\ =\ -\/999.99;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01131}01131\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Set\ this\ only\ once}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01132}01132\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(i\ ==\ 0)\ \mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}[j]\ =\ -\/999.99;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01133}01133\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01134}01134\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01135}01135\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01136}01136\ \ \ \textcolor{comment}{//\ Set\ all\ the\ branches\ to\ off}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01137}01137\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchStatus(\textcolor{stringliteral}{"{}*"{}},\ \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01138}01138\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01139}01139\ \ \ \textcolor{comment}{//\ Turn\ on\ the\ branches\ which\ we\ want\ for\ parameters}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01140}01140\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01141}01141\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01142}01142\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchStatus(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i].Data(),\ \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01143}01143\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01144}01144\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchStatus(\textcolor{stringliteral}{"{}step"{}},\ \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01145}01145\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01146}01146\ \ \ \textcolor{keyword}{const}\ Long64\_t\ countwidth\ =\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}/10;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01147}01147\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ entries}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01148}01148\ \ \ \textcolor{comment}{//KS:\ This\ is\ really\ a\ bottleneck\ right\ now,\ thus\ revisit\ with\ ROOT6\ https://pep-\/root6.github.io/docs/analysis/parallell/root.html}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01149}01149\ \ \ \textcolor{keywordflow}{for}\ (Long64\_t\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++j)\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01150}01150\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01151}01151\ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ \%\ countwidth\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01152}01152\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceMaCh3Utils_a4c8bdeb1d34606aed192e9f1311a72f5}{MaCh3Utils::PrintProgressBar}}(j,\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01153}01153\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01154}01154\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchAddress(\textcolor{stringliteral}{"{}step"{}},\ \&\mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}[j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01155}01155\ \ \ \ \ \textcolor{comment}{//\ Set\ the\ branch\ addresses\ for\ params}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01156}01156\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01157}01157\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01158}01158\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchAddress(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i].Data(),\ \&\mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[i][j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01159}01159\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01160}01160\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01161}01161\ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ \%\ countwidth\ ==\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01162}01162\ \ \ \ \ \ \ \mbox{\hyperlink{namespaceMaCh3Utils_afb0be593dc0d5e481b78afa4625c858c}{MaCh3Utils::EstimateDataTransferRate}}(\mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}},\ j);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01163}01163\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01164}01164\ \ \ \ \ \ \ \textcolor{comment}{//\ Fill\ up\ the\ ParStep\ array}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01165}01165\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetEntry(j);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01166}01166\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01167}01167\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01168}01168\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01169}01169\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01170}01170\ \ \ \textcolor{comment}{//\ Set\ all\ the\ branches\ to\ on}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01171}01171\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchStatus(\textcolor{stringliteral}{"{}*"{}},\ \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01172}01172\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01173}01173\ \ \ \textcolor{comment}{//\ Cache\ max\ and\ min\ in\ chain\ for\ covariance\ matrix}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01174}01174\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01175}01175\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01176}01176\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Min\_Chain\_i\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMinimum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01177}01177\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Max\_Chain\_i\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMaximum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01178}01178\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01179}01179\ \ \ \ \ TString\ Title\_i\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01180}01180\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\_i,\ PriorError\_i;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01181}01181\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(i,\ Prior\_i,\ PriorError\_i,\ Title\_i);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01182}01182\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01183}01183\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01184}01184\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01185}01185\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Min\_Chain\_j\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMinimum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01186}01186\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Max\_Chain\_j\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMaximum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01187}01187\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01188}01188\ \ \ \ \ \ \ \textcolor{comment}{//\ TH2D\ to\ hold\ the\ Correlation\ }}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01189}01189\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]\ =\ \textcolor{keyword}{new}\ TH2D(Form(\textcolor{stringliteral}{"{}hpost2D\_\%i\_\%i"{}},i,j),\ Form(\textcolor{stringliteral}{"{}hpost2D\_\%i\_\%i"{}},i,j),\ \mbox{\hyperlink{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}{nBins}},\ Min\_Chain\_i,\ Max\_Chain\_i,\ \mbox{\hyperlink{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}{nBins}},\ Min\_Chain\_j,\ Max\_Chain\_j);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01190}01190\ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01191}01191\ \ \ \ \ \ \ TString\ Title\_j\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01192}01192\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\_j,\ PriorError\_j;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01193}01193\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(j,\ Prior\_j,\ PriorError\_j,\ Title\_j);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01194}01194\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01195}01195\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>SetMinimum(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01196}01196\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>GetXaxis()-\/>SetTitle(Title\_i);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01197}01197\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>GetYaxis()-\/>SetTitle(Title\_j);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01198}01198\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Steps"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01199}01199\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01200}01200\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01201}01201\ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01202}01202\ \ \ clock.Stop();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01203}01203\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Caching\ steps\ took\ \{:.2f\}s\ to\ finish\ for\ \{\}\ steps"{}},\ clock.RealTime(),\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01204}01204\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01205}01205\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01206}01206\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01207}01207\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01208}01208\ \textcolor{comment}{//\ Make\ the\ post-\/fit\ covariance\ matrix\ in\ all\ dimensions}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01209}\mbox{\hyperlink{classMCMCProcessor_ab367cb5f56606338bb1fce780f2414e8}{01209}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_ab367cb5f56606338bb1fce780f2414e8}{MCMCProcessor::MakeCovariance\_MP}}(\textcolor{keywordtype}{bool}\ Mute)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01210}01210\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01211}01211\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_aa5a7761e97cf2e24c7d877a5374b7333}{MakeOutputFile}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01212}01212\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01213}01213\ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{classMCMCProcessor_aea84f0315695aa05ec41fcf965b1b031}{CacheMCMC}})\ \mbox{\hyperlink{classMCMCProcessor_ace48a54fb08e2a3943d4e2ed1f8c4a4b}{CacheSteps}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01214}01214\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01215}01215\ \ \ \textcolor{keywordtype}{bool}\ HaveMadeDiagonal\ =\ \textcolor{keyword}{false};\ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01216}01216\ \ \ \textcolor{comment}{//\ Check\ that\ the\ diagonal\ entries\ have\ been\ filled}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01217}01217\ \ \ \textcolor{comment}{//\ i.e.\ MakePostfit()\ has\ been\ called}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01218}01218\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01219}01219\ \ \ \ \ \textcolor{keywordflow}{if}\ ((*\mbox{\hyperlink{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}{Covariance}})(i,i)\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}})\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01220}01220\ \ \ \ \ \ \ HaveMadeDiagonal\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01221}01221\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Have\ not\ run\ diagonal\ elements\ in\ covariance,\ will\ do\ so\ now\ by\ calling\ MakePostfit()"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01222}01222\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01223}01223\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01224}01224\ \ \ \ \ \ \ HaveMadeDiagonal\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01225}01225\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01226}01226\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01227}01227\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01228}01228\ \ \ \textcolor{keywordflow}{if}\ (HaveMadeDiagonal\ ==\ \textcolor{keyword}{false})\ \mbox{\hyperlink{classMCMCProcessor_a8667510132aa01395520f028287f511b}{MakePostfit}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01229}01229\ \ \ \textcolor{keywordflow}{if}(!Mute)\ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Calculating\ covariance\ matrix"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01230}01230\ \ \ TStopwatch\ clock;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01231}01231\ \ \ \textcolor{keywordflow}{if}(!Mute)\ clock.Start();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01232}01232\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01233}01233\ \ \ gStyle-\/>SetPalette(55);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01234}01234\ \ \ \textcolor{comment}{//\ Now\ we\ are\ sure\ we\ have\ the\ diagonal\ elements,\ let's\ make\ the\ off-\/diagonals}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01235}01235\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01236}01236\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01237}01237\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01238}01238\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01239}01239\ \ \ \{\ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01240}01240\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01241}01241\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01242}01242\ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ the\ diagonal\ elements\ which\ we've\ already\ done\ above}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01243}01243\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ ==\ i)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01244}01244\ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01245}01245\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ this\ parameter\ isn't\ varied}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01246}01246\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a95fa49737432818bc830a44898d0d850}{IamVaried}}[j]\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01247}01247\ \ \ \ \ \ \ \ \ (*Covariance)(i,j)\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01248}01248\ \ \ \ \ \ \ \ \ (*Covariance)(j,i)\ =\ (*\mbox{\hyperlink{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}{Covariance}})(i,j);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01249}01249\ \ \ \ \ \ \ \ \ (*Correlation)(i,j)\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01250}01250\ \ \ \ \ \ \ \ \ (*Correlation)(j,i)\ =\ (*\mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}})(i,j);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01251}01251\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01252}01252\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01253}01253\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>SetMinimum(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01254}01254\ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01255}01255\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++k)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01256}01256\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01257}01257\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Burn\ in\ cut}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01258}01258\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}[k]\ <\ \mbox{\hyperlink{classMCMCProcessor_a22f82dadceccbe87dd8c5b7daa8432e8}{BurnInCut}})\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01259}01259\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01260}01260\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Fill\ histogram\ with\ cached\ steps}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01261}01261\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>Fill(\mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[i][k],\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][k]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01262}01262\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01263}01263\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a682c1c47626542f5820d633ba2bc010c}{ApplySmoothing}})\ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>Smooth();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01264}01264\ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01265}01265\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ Covariance\ for\ these\ two\ parameters}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01266}01266\ \ \ \ \ \ \ (*Covariance)(i,j)\ =\ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>\mbox{\hyperlink{classMCMCProcessor_ac9e4fdea5d2de92a1abad5b79b7daf88}{GetCovariance}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01267}01267\ \ \ \ \ \ \ (*Covariance)(j,i)\ =\ (*\mbox{\hyperlink{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}{Covariance}})(i,j);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01268}01268\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01269}01269\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Since\ we\ already\ have\ covariance\ consider\ calculating\ correlation\ using\ it,\ right\ now\ we\ effectively\ calculate\ covariance\ twice}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01270}01270\ \ \ \ \ \ \ \textcolor{comment}{//https://root.cern.ch/doc/master/TH2\_8cxx\_source.html\#l01099}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01271}01271\ \ \ \ \ \ \ (*Correlation)(i,j)\ =\ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>GetCorrelationFactor();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01272}01272\ \ \ \ \ \ \ (*Correlation)(j,i)\ =\ (*\mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}})(i,j);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01273}01273\ \ \ \ \ \}\textcolor{comment}{//\ End\ j\ loop}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01274}01274\ \ \ \}\textcolor{comment}{//\ End\ i\ loop}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01275}01275\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01276}01276\ \ \ \textcolor{keywordflow}{if}(!Mute)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01277}01277\ \ \ \ \ clock.Stop();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01278}01278\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ Covariance\ took\ \{:.2f\}s\ to\ finish\ for\ \{\}\ steps"{}},\ clock.RealTime(),\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01279}01279\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01280}01280\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01281}01281\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01282}01282\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01283}01283\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01284}01284\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01285}01285\ \ \ \ \ \{\ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01286}01286\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01287}01287\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01288}01288\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ the\ diagonal\ elements\ which\ we've\ already\ done\ above}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01289}01289\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ ==\ i)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01290}01290\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a95fa49737432818bc830a44898d0d850}{IamVaried}}[j]\ ==\ \textcolor{keyword}{false})\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01291}01291\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01292}01292\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}[i]\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}\ \&\&\ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}[j]\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}})}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01293}01293\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01294}01294\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Skip\ Flux\ Params}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01295}01295\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a2c06d64020e9246e720cc131a9f4986d}{IsXsec}}[j]\ \&\&\ \mbox{\hyperlink{classMCMCProcessor_a2c06d64020e9246e720cc131a9f4986d}{IsXsec}}[i]\ \&\&\ std::fabs((*\mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}})(i,j))\ >\ \mbox{\hyperlink{classMCMCProcessor_a25e4685b6299181021b02ac0e0b74681}{Post2DPlotThreshold}})}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01296}01296\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01297}01297\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>Draw(\textcolor{stringliteral}{"{}colz"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01298}01298\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetName(\mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>GetName());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01299}01299\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTitle(\mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>GetTitle());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01300}01300\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01301}01301\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01302}01302\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01303}01303\ \ \ \ \ \ \ \ \ \textcolor{comment}{//if(\ std::fabs((*Correlation)(i,j))\ >\ Post2DPlotThreshold)\ hpost2D[i][j]-\/>Write();}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01304}01304\ \ \ \ \ \ \ \}\textcolor{comment}{//\ End\ j\ loop}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01305}01305\ \ \ \ \ \}\textcolor{comment}{//\ End\ i\ loop}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01306}01306\ \ \ \}\ \textcolor{comment}{//end\ if\ pdf}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01307}01307\ \ \ \textcolor{keywordflow}{if}(!Mute)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01308}01308\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}{Covariance}}-\/>Write(\textcolor{stringliteral}{"{}Covariance"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01309}01309\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}}-\/>Write(\textcolor{stringliteral}{"{}Correlation"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01310}01310\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01311}01311\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01312}01312\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01313}01313\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01314}01314\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01315}01315\ \textcolor{comment}{//\ Based\ on\ @cite\ roberts2009adaptive}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01316}01316\ \textcolor{comment}{//\ all\ credits\ for\ finding\ and\ studying\ it\ goes\ to\ Henry}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01317}\mbox{\hyperlink{classMCMCProcessor_afac304b884238cc3624f5471b43f1a7e}{01317}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_afac304b884238cc3624f5471b43f1a7e}{MCMCProcessor::MakeSubOptimality}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ NIntervals)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01318}01318\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01319}01319\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01320}01320\ \ \ \textcolor{comment}{//Save\ burn\ in\ cut,\ at\ the\ end\ of\ the\ loop\ we\ will\ return\ to\ default\ values}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01321}01321\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ DefaultUpperCut\ =\ \mbox{\hyperlink{classMCMCProcessor_a840c686f15f419c0156df01c4ed62931}{UpperCut}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01322}01322\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ DefaultBurnInCut\ =\ \mbox{\hyperlink{classMCMCProcessor_a22f82dadceccbe87dd8c5b7daa8432e8}{BurnInCut}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01323}01323\ \ \ \textcolor{keywordtype}{bool}\ defaultPrintToPDF\ =\ \mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01324}01324\ \ \ \mbox{\hyperlink{classMCMCProcessor_a22f82dadceccbe87dd8c5b7daa8432e8}{BurnInCut}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01325}01325\ \ \ \mbox{\hyperlink{classMCMCProcessor_a840c686f15f419c0156df01c4ed62931}{UpperCut}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01326}01326\ \ \ \mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01327}01327\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01328}01328\ \ \ \textcolor{comment}{//Set\ via\ config\ in\ future}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01329}01329\ \ \ \textcolor{keywordtype}{int}\ MaxStep\ =\ \mbox{\hyperlink{classMCMCProcessor_aae0016a4e1d105d5d65243438c622a97}{nSteps}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01330}01330\ \ \ \textcolor{keywordtype}{int}\ MinStep\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01331}01331\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ IntervalsSize\ =\ \mbox{\hyperlink{classMCMCProcessor_aae0016a4e1d105d5d65243438c622a97}{nSteps}}/NIntervals;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01332}01332\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01333}01333\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ Suboptimality"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01334}01334\ \ \ TStopwatch\ clock;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01335}01335\ \ \ clock.Start();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01336}01336\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01337}01337\ \ \ std::unique\_ptr<TH1D>\ SubOptimality\ =\ std::make\_unique<TH1D>(\textcolor{stringliteral}{"{}Suboptimality"{}},\ \textcolor{stringliteral}{"{}Suboptimality"{}},\ NIntervals,\ MinStep,\ MaxStep);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01338}01338\ \ \ SubOptimality-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Step"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01339}01339\ \ \ SubOptimality-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Suboptimality"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01340}01340\ \ \ SubOptimality-\/>SetLineWidth(2);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01341}01341\ \ \ SubOptimality-\/>SetLineColor(kBlue);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01342}01342\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01343}01343\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ NIntervals;\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01344}01344\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01345}01345\ \ \ \ \ \textcolor{comment}{//Reset\ our\ cov\ matrix}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01346}01346\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a36441ec3d5b0e24e48040282ffcda3eb}{ResetHistograms}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01347}01347\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01348}01348\ \ \ \ \ \textcolor{comment}{//Set\ threshold\ for\ calculating\ new\ matrix}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01349}01349\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a840c686f15f419c0156df01c4ed62931}{UpperCut}}\ =\ i*IntervalsSize;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01350}01350\ \ \ \ \ \textcolor{comment}{//Calculate\ cov\ matrix}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01351}01351\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ab367cb5f56606338bb1fce780f2414e8}{MakeCovariance\_MP}}(\textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01352}01352\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01353}01353\ \ \ \ \ \textcolor{comment}{//Calculate\ eigen\ values}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01354}01354\ \ \ \ \ TMatrixDSymEigen\ eigen(*\mbox{\hyperlink{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}{Covariance}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01355}01355\ \ \ \ \ TVectorD\ eigen\_values;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01356}01356\ \ \ \ \ eigen\_values.ResizeTo(eigen.GetEigenValues());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01357}01357\ \ \ \ \ eigen\_values\ =\ eigen.GetEigenValues();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01358}01358\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01359}01359\ \ \ \ \ \textcolor{comment}{//KS:\ Converting\ from\ ROOT\ to\ vector\ as\ to\ make\ using\ other\ libraires\ (Eigen)\ easier\ in\ future}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01360}01360\ \ \ \ \ std::vector<double>\ EigenValues(eigen\_values.GetNrows());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01361}01361\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ EigenValues.size();\ j++)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01362}01362\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01363}01363\ \ \ \ \ \ \ EigenValues[j]\ =\ eigen\_values(j);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01364}01364\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01365}01365\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ SubOptimalityValue\ =\ \mbox{\hyperlink{StatisticalUtils_8h_a34d5232bfb12e29ec9d63acaa8744b58}{GetSubOptimality}}(EigenValues,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01366}01366\ \ \ \ \ SubOptimality-\/>SetBinContent(i+1,\ SubOptimalityValue);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01367}01367\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01368}01368\ \ \ clock.Stop();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01369}01369\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ Suboptimality\ took\ \{:.2f\}s\ to\ finish\ for\ \{\}\ steps"{}},\ clock.RealTime(),\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01370}01370\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01371}01371\ \ \ \mbox{\hyperlink{classMCMCProcessor_a840c686f15f419c0156df01c4ed62931}{UpperCut}}\ =\ DefaultUpperCut;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01372}01372\ \ \ \mbox{\hyperlink{classMCMCProcessor_a22f82dadceccbe87dd8c5b7daa8432e8}{BurnInCut}}\ =\ DefaultBurnInCut;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01373}01373\ \ \ \mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}}\ =\ defaultPrintToPDF;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01374}01374\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01375}01375\ \ \ SubOptimality-\/>Draw(\textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01376}01376\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetName(SubOptimality-\/>GetName());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01377}01377\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTitle(SubOptimality-\/>GetTitle());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01378}01378\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01379}01379\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01380}01380\ \ \ \textcolor{comment}{//\ Write\ it\ to\ root\ file}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01381}01381\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01382}01382\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Write();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01383}01383\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01384}01384\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01385}01385\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01386}01386\ \textcolor{comment}{//\ Make\ the\ covariance\ plots}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01387}\mbox{\hyperlink{classMCMCProcessor_a8d9b9c1c780a51b130fe528583dc5019}{01387}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_a8d9b9c1c780a51b130fe528583dc5019}{MCMCProcessor::DrawCovariance}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01388}01388\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01389}01389\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ RightMargin\ \ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetRightMargin();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01390}01390\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetRightMargin(0.15);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01391}01391\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01392}01392\ \ \ \textcolor{comment}{//\ The\ Covariance\ matrix\ from\ the\ fit}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01393}01393\ \ \ std::unique\_ptr<TH2D>\ hCov\ =\ std::make\_unique<TH2D>(\textcolor{stringliteral}{"{}hCov"{}},\ \textcolor{stringliteral}{"{}hCov"{}},\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01394}01394\ \ \ hCov-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Covariance"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01395}01395\ \ \ \textcolor{comment}{//\ The\ Covariance\ matrix\ square\ root,\ with\ correct\ sign}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01396}01396\ \ \ std::unique\_ptr<TH2D>\ hCovSq\ =\ std::make\_unique<TH2D>(\textcolor{stringliteral}{"{}hCovSq"{}},\ \textcolor{stringliteral}{"{}hCovSq"{}},\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01397}01397\ \ \ hCovSq-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Covariance"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01398}01398\ \ \ \textcolor{comment}{//\ The\ Correlation}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01399}01399\ \ \ std::unique\_ptr<TH2D>\ hCorr\ =\ std::make\_unique<TH2D>(\textcolor{stringliteral}{"{}hCorr"{}},\ \textcolor{stringliteral}{"{}hCorr"{}},\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01400}01400\ \ \ hCorr-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Correlation"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01401}01401\ \ \ hCorr-\/>SetMinimum(-\/1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01402}01402\ \ \ hCorr-\/>SetMaximum(1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01403}01403\ \ \ hCov-\/>GetXaxis()-\/>SetLabelSize(0.015);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01404}01404\ \ \ hCov-\/>GetYaxis()-\/>SetLabelSize(0.015);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01405}01405\ \ \ hCovSq-\/>GetXaxis()-\/>SetLabelSize(0.015);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01406}01406\ \ \ hCovSq-\/>GetYaxis()-\/>SetLabelSize(0.015);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01407}01407\ \ \ hCorr-\/>GetXaxis()-\/>SetLabelSize(0.015);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01408}01408\ \ \ hCorr-\/>GetYaxis()-\/>SetLabelSize(0.015);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01409}01409\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01410}01410\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ Covariance\ matrix\ entries}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01411}01411\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01412}01412\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01413}01413\ \ \ \ \ TString\ titlex\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01414}01414\ \ \ \ \ \textcolor{keywordtype}{double}\ nom,\ err;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01415}01415\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(i,\ nom,\ err,\ titlex);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01416}01416\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01417}01417\ \ \ \ \ hCov-\/>GetXaxis()-\/>SetBinLabel(i+1,\ titlex);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01418}01418\ \ \ \ \ hCovSq-\/>GetXaxis()-\/>SetBinLabel(i+1,\ titlex);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01419}01419\ \ \ \ \ hCorr-\/>GetXaxis()-\/>SetBinLabel(i+1,\ titlex);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01420}01420\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01421}01421\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01422}01422\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01423}01423\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ value\ of\ the\ Covariance}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01424}01424\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ cov\ =\ (*Covariance)(i,j);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01425}01425\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ corr\ =\ (*Correlation)(i,j);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01426}01426\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01427}01427\ \ \ \ \ \ \ hCov-\/>SetBinContent(i+1,\ j+1,\ cov);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01428}01428\ \ \ \ \ \ \ hCovSq-\/>SetBinContent(i+1,\ j+1,\ ((cov\ >\ 0)\ -\/\ (cov\ <\ 0))*std::sqrt(std::fabs(cov)));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01429}01429\ \ \ \ \ \ \ hCorr-\/>SetBinContent(i+1,\ j+1,\ corr);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01430}01430\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01431}01431\ \ \ \ \ \ \ TString\ titley\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01432}01432\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ nom\_j,\ err\_j;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01433}01433\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(j,\ nom\_j,\ err\_j,\ titley);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01434}01434\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01435}01435\ \ \ \ \ \ \ hCov-\/>GetYaxis()-\/>SetBinLabel(j+1,\ titley);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01436}01436\ \ \ \ \ \ \ hCovSq-\/>GetYaxis()-\/>SetBinLabel(j+1,\ titley);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01437}01437\ \ \ \ \ \ \ hCorr-\/>GetYaxis()-\/>SetBinLabel(j+1,\ titley);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01438}01438\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01439}01439\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01440}01440\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01441}01441\ \ \ \textcolor{comment}{//\ Take\ away\ the\ stat\ box}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01442}01442\ \ \ gStyle-\/>SetOptStat(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01443}01443\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aa7611f55ac3c0ea70607761d037fbd91}{plotBinValue}})gStyle-\/>SetPaintTextFormat(\textcolor{stringliteral}{"{}4.1f"{}});\ \textcolor{comment}{//Precision\ of\ value\ in\ matrix\ element}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01444}01444\ \ \ \textcolor{comment}{//\ Make\ pretty\ Correlation\ colors\ (red\ to\ blue)}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01445}01445\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ NRGBs\ =\ 5;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01446}01446\ \ \ TColor::InitializeColors();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01447}01447\ \ \ Double\_t\ stops[NRGBs]\ =\ \{\ 0.00,\ 0.25,\ 0.50,\ 0.75,\ 1.00\ \};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01448}01448\ \ \ Double\_t\ red[NRGBs]\ \ \ =\ \{\ 0.00,\ 0.25,\ 1.00,\ 1.00,\ 0.50\ \};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01449}01449\ \ \ Double\_t\ green[NRGBs]\ =\ \{\ 0.00,\ 0.25,\ 1.00,\ 0.25,\ 0.00\ \};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01450}01450\ \ \ Double\_t\ blue[NRGBs]\ \ =\ \{\ 0.50,\ 1.00,\ 1.00,\ 0.25,\ 0.00\ \};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01451}01451\ \ \ TColor::CreateGradientColorTable(5,\ stops,\ red,\ green,\ blue,\ 255);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01452}01452\ \ \ gStyle-\/>SetNumberContours(255);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01453}01453\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01454}01454\ \ \ \textcolor{comment}{//\ cd\ into\ the\ correlation\ directory}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01455}01455\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01456}01456\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01457}01457\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01458}01458\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Clear();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01459}01459\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aa7611f55ac3c0ea70607761d037fbd91}{plotBinValue}})\ hCov-\/>Draw(\textcolor{stringliteral}{"{}colz\ text"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01460}01460\ \ \ \textcolor{keywordflow}{else}\ hCov-\/>Draw(\textcolor{stringliteral}{"{}colz"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01461}01461\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01462}01462\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01463}01463\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01464}01464\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Clear();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01465}01465\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aa7611f55ac3c0ea70607761d037fbd91}{plotBinValue}})\ hCorr-\/>Draw(\textcolor{stringliteral}{"{}colz\ text"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01466}01466\ \ \ \textcolor{keywordflow}{else}\ hCorr-\/>Draw(\textcolor{stringliteral}{"{}colz"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01467}01467\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01468}01468\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01469}01469\ \ \ hCov-\/>Write(\textcolor{stringliteral}{"{}Covariance\_plot"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01470}01470\ \ \ hCovSq-\/>Write(\textcolor{stringliteral}{"{}Covariance\_sq\_plot"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01471}01471\ \ \ hCorr-\/>Write(\textcolor{stringliteral}{"{}Correlation\_plot"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01472}01472\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01473}01473\ \ \ \textcolor{comment}{//Back\ to\ normal}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01474}01474\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetRightMargin(RightMargin);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01475}01475\ \ \ \mbox{\hyperlink{classMCMCProcessor_a5b0961bcb0eea7a347e6a29ef7738d80}{DrawCorrelations1D}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01476}01476\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01477}01477\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01478}01478\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01479}01479\ \textcolor{comment}{//KS:\ Make\ the\ 1D\ projections\ of\ Correlations\ inspired\ by\ Henry's\ slides\ (page\ 28)\ https://www.t2k.org/asg/oagroup/meeting/2023/2023-\/07-\/10-\/oa-\/pre-\/meeting/MaCh3FDUpdate}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01480}\mbox{\hyperlink{classMCMCProcessor_a5b0961bcb0eea7a347e6a29ef7738d80}{01480}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_a5b0961bcb0eea7a347e6a29ef7738d80}{MCMCProcessor::DrawCorrelations1D}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01481}01481\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01482}01482\ \ \ \textcolor{comment}{//KS:\ Store\ it\ as\ we\ go\ back\ to\ them\ at\ the\ end}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01483}01483\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ TopMargin\ \ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetTopMargin();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01484}01484\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ BottomMargin\ \ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetBottomMargin();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01485}01485\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ OptTitle\ =\ gStyle-\/>GetOptTitle();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01486}01486\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01487}01487\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTopMargin(0.1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01488}01488\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetBottomMargin(0.2);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01489}01489\ \ \ gStyle-\/>SetOptTitle(1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01490}01490\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01491}01491\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ Nhists\ =\ 3;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01492}01492\ \ \ \textcolor{comment}{//KS:\ Highest\ value\ is\ just\ meant\ bo\ be\ sliglhy\ higher\ than\ 1\ to\ catch\ >,}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01493}01493\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{double}\ Thresholds[Nhists+1]\ =\ \{0,\ 0.25,\ 0.5,\ 1.0001\};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01494}01494\ \ \ \textcolor{keyword}{constexpr}\ Color\_t\ CorrColours[Nhists]\ =\ \{kRed-\/10,\ kRed-\/6,\ \ kRed\};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01495}01495\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01496}01496\ \ \ \textcolor{comment}{//KS:\ This\ strore\ neccesary\ entires\ for\ stripped\ covariance\ which\ strore\ only\ "{}menaingfull\ correlations}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01497}01497\ \ \ std::vector<std::vector<double>>\ CorrOfInterest;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01498}01498\ \ \ CorrOfInterest.resize(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01499}01499\ \ \ std::vector<std::vector<std::string>>\ NameCorrOfInterest;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01500}01500\ \ \ NameCorrOfInterest.resize(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01501}01501\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01502}01502\ \ \ std::vector<std::vector<std::unique\_ptr<TH1D>>>\ Corr1DHist(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01503}01503\ \ \ \textcolor{comment}{//KS:\ Initialising\ ROOT\ objects\ is\ never\ safe\ in\ MP\ loop}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01504}01504\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01505}01505\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01506}01506\ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01507}01507\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01508}01508\ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01509}01509\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(i,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01510}01510\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01511}01511\ \ \ \ \ Corr1DHist[i].resize(Nhists);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01512}01512\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ Nhists;\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01513}01513\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01514}01514\ \ \ \ \ \ \ Corr1DHist[i][j]\ =\ std::make\_unique<TH1D>(Form(\textcolor{stringliteral}{"{}Corr1DHist\_\%i\_\%i"{}},\ i,\ j),\ Form(\textcolor{stringliteral}{"{}Corr1DHist\_\%i\_\%i"{}},\ i,\ j),\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01515}01515\ \ \ \ \ \ \ Corr1DHist[i][j]-\/>SetTitle(Form(\textcolor{stringliteral}{"{}\%s"{}},Title.Data()));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01516}01516\ \ \ \ \ \ \ Corr1DHist[i][j]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Correlation"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01517}01517\ \ \ \ \ \ \ Corr1DHist[i][j]-\/>SetFillColor(CorrColours[j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01518}01518\ \ \ \ \ \ \ Corr1DHist[i][j]-\/>SetLineColor(kBlack);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01519}01519\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01520}01520\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++k)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01521}01521\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01522}01522\ \ \ \ \ \ \ \ \ TString\ Title\_y\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01523}01523\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\_y\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01524}01524\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\_y\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01525}01525\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(k,\ Prior\_y,\ PriorError\_y,\ Title\_y);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01526}01526\ \ \ \ \ \ \ \ \ Corr1DHist[i][j]-\/>GetXaxis()-\/>SetBinLabel(k+1,\ Title\_y.Data());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01527}01527\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01528}01528\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01529}01529\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01530}01530\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01531}01531\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01532}01532\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01533}01533\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01534}01534\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01535}01535\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01536}01536\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01537}01537\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01538}01538\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ Nhists;\ ++k)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01539}01539\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01540}01540\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ TempEntry\ =\ std::fabs((*\mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}})(i,j));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01541}01541\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(Thresholds[k+1]\ >\ TempEntry\ \&\&\ TempEntry\ >=\ Thresholds[k])}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01542}01542\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01543}01543\ \ \ \ \ \ \ \ \ \ \ Corr1DHist[i][k]-\/>SetBinContent(j+1,\ (*\mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}})(i,j));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01544}01544\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01545}01545\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01546}01546\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(std::fabs((*\mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}})(i,j))\ >\ \mbox{\hyperlink{classMCMCProcessor_a25e4685b6299181021b02ac0e0b74681}{Post2DPlotThreshold}}\ \&\&\ i\ !=\ j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01547}01547\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01548}01548\ \ \ \ \ \ \ \ \ CorrOfInterest[i].push\_back((*\mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}})(i,j));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01549}01549\ \ \ \ \ \ \ \ \ NameCorrOfInterest[i].push\_back(Corr1DHist[i][0]-\/>GetXaxis()-\/>GetBinLabel(j+1));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01550}01550\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01551}01551\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01552}01552\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01553}01553\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01554}01554\ \ \ TDirectory\ *CorrDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}Corr1D"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01555}01555\ \ \ CorrDir-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01556}01556\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01557}01557\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ i++)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01558}01558\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01559}01559\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a95fa49737432818bc830a44898d0d850}{IamVaried}}[i]\ ==\ \textcolor{keyword}{false})\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01560}01560\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01561}01561\ \ \ \ \ Corr1DHist[i][0]-\/>SetMaximum(+1.);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01562}01562\ \ \ \ \ Corr1DHist[i][0]-\/>SetMinimum(-\/1.);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01563}01563\ \ \ \ \ Corr1DHist[i][0]-\/>Draw();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01564}01564\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ k\ =\ 1;\ k\ <\ Nhists;\ k++)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01565}01565\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01566}01566\ \ \ \ \ \ \ Corr1DHist[i][k]-\/>Draw(\textcolor{stringliteral}{"{}SAME"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01567}01567\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01568}01568\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01569}01569\ \ \ \ \ \textcolor{keyword}{auto}\ leg\ =\ std::make\_unique<TLegend>(0.3,\ 0.75,\ 0.6,\ 0.90);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01570}01570\ \ \ \ \ leg-\/>SetTextSize(0.02);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01571}01571\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ Nhists;\ k++)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01572}01572\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01573}01573\ \ \ \ \ \ \ leg-\/>AddEntry(Corr1DHist[i][k].get(),\ Form(\textcolor{stringliteral}{"{}\%.2f\ >\ |Corr|\ >=\ \%.2f"{}},\ Thresholds[k+1],\ Thresholds[k]),\ \textcolor{stringliteral}{"{}f"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01574}01574\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01575}01575\ \ \ \ \ leg-\/>SetLineColor(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01576}01576\ \ \ \ \ leg-\/>SetLineStyle(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01577}01577\ \ \ \ \ leg-\/>SetFillColor(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01578}01578\ \ \ \ \ leg-\/>SetFillStyle(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01579}01579\ \ \ \ \ leg-\/>Draw(\textcolor{stringliteral}{"{}SAME"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01580}01580\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01581}01581\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Write(Corr1DHist[i][0]-\/>GetTitle());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01582}01582\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01583}01583\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01584}01584\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01585}01585\ \ \ \textcolor{comment}{//KS:\ Plot\ only\ meaningful\ correlations}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01586}01586\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ i++)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01587}01587\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01588}01588\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}}\ =\ int(CorrOfInterest[i].\mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}}());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01589}01589\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01590}01590\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}}\ ==\ 0)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01591}01591\ \ \ \ \ TH1D*\ Corr1DHist\_Reduced\ =\ \textcolor{keyword}{new}\ TH1D(\textcolor{stringliteral}{"{}Corr1DHist\_Reduced"{}},\ \textcolor{stringliteral}{"{}Corr1DHist\_Reduced"{}},\ \mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}},\ 0,\ \mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01592}01592\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01593}01593\ \ \ \ \ Corr1DHist\_Reduced-\/>SetTitle(Corr1DHist[i][0]-\/>GetTitle());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01594}01594\ \ \ \ \ Corr1DHist\_Reduced-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Correlation"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01595}01595\ \ \ \ \ Corr1DHist\_Reduced-\/>SetFillColor(kBlue);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01596}01596\ \ \ \ \ Corr1DHist\_Reduced-\/>SetLineColor(kBlue);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01597}01597\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01598}01598\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}};\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01599}01599\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01600}01600\ \ \ \ \ \ \ Corr1DHist\_Reduced-\/>GetXaxis()-\/>SetBinLabel(j+1,\ NameCorrOfInterest[i][j].c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01601}01601\ \ \ \ \ \ \ Corr1DHist\_Reduced-\/>SetBinContent(j+1,\ CorrOfInterest[i][j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01602}01602\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01603}01603\ \ \ \ \ Corr1DHist\_Reduced-\/>GetXaxis()-\/>LabelsOption(\textcolor{stringliteral}{"{}v"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01604}01604\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01605}01605\ \ \ \ \ Corr1DHist\_Reduced-\/>SetMaximum(+1.);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01606}01606\ \ \ \ \ Corr1DHist\_Reduced-\/>SetMinimum(-\/1.);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01607}01607\ \ \ \ \ Corr1DHist\_Reduced-\/>Draw();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01608}01608\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01609}01609\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Write(Form(\textcolor{stringliteral}{"{}\%s\_Red"{}},\ Corr1DHist\_Reduced-\/>GetTitle()));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01610}01610\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01611}01611\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01612}01612\ \ \ \ \ \textcolor{keyword}{delete}\ Corr1DHist\_Reduced;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01613}01613\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01614}01614\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01615}01615\ \ \ CorrDir-\/>Close();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01616}01616\ \ \ \textcolor{keyword}{delete}\ CorrDir;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01617}01617\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01618}01618\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01619}01619\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01620}01620\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTopMargin(TopMargin);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01621}01621\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetBottomMargin(BottomMargin);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01622}01622\ \ \ gStyle-\/>SetOptTitle(OptTitle);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01623}01623\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01624}01624\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01625}01625\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01626}01626\ \textcolor{comment}{//\ Make\ fancy\ Credible\ Intervals\ plots}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01627}\mbox{\hyperlink{classMCMCProcessor_a304adbe4407166ec42d76329c4bd17ff}{01627}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_a304adbe4407166ec42d76329c4bd17ff}{MCMCProcessor::MakeCredibleRegions}}(\textcolor{keyword}{const}\ std::vector<double>\&\ CredibleRegions,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01628}01628\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<Style\_t>\&\ CredibleRegionStyle,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01629}01629\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<Color\_t>\&\ CredibleRegionColor,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01630}01630\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ CredibleInSigmas)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01631}01631\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01632}01632\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01633}01633\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_ab367cb5f56606338bb1fce780f2414e8}{MakeCovariance\_MP}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01634}01634\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ Credible\ Regions"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01635}01635\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01636}01636\ \ \ \textcolor{keywordflow}{if}(\ (CredibleRegions.size()\ !=\ CredibleRegionStyle.size())\ ||\ (CredibleRegionStyle.size()\ !=\ CredibleRegionColor.size())\ )}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01637}01637\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01638}01638\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Size\ of\ \ CredibleRegions\ is\ not\ equat\ to\ size\ of\ CredibleRegionStyle"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01639}01639\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01640}01640\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01641}01641\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nCredible\ =\ int(CredibleRegions.size());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01642}01642\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01643}01643\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01644}01644\ \ \ std::vector<std::vector<TH2D*>>\ hpost\_2D\_copy(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01645}01645\ \ \ std::vector<std::vector<std::vector<TH2D*>>>\ hpost\_2D\_cl(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01646}01646\ \ \ \textcolor{comment}{//KS:\ Copy\ all\ histograms\ to\ be\ thread\ safe}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01647}01647\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01648}01648\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01649}01649\ \ \ \ \ hpost\_2D\_copy[i].resize(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01650}01650\ \ \ \ \ hpost\_2D\_cl[i].resize(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01651}01651\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01652}01652\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01653}01653\ \ \ \ \ \ \ hpost\_2D\_copy[i][j]\ =\ \textcolor{keyword}{static\_cast<}TH2D*\textcolor{keyword}{>}(\mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>Clone(Form(\textcolor{stringliteral}{"{}hpost\_copy\_\%i\_\%i"{}},\ i,\ j)));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01654}01654\ \ \ \ \ \ \ hpost\_2D\_cl[i][j].resize(nCredible);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01655}01655\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ nCredible;\ ++k)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01656}01656\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01657}01657\ \ \ \ \ \ \ \ \ hpost\_2D\_cl[i][j][k]\ =\ \textcolor{keyword}{static\_cast<}TH2D*\textcolor{keyword}{>}(\mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>Clone(Form(\textcolor{stringliteral}{"{}hpost\_copy\_\%i\_\%i\_CL\_\%f"{}},\ i,\ j,\ CredibleRegions[k])));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01658}01658\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01659}01659\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01660}01660\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01661}01661\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01662}01662\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01663}01663\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01664}01664\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01665}01665\ \ \ \textcolor{comment}{//Calculate\ credible\ histogram}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01666}01666\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01667}01667\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01668}01668\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01669}01669\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01670}01670\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ nCredible;\ ++k)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01671}01671\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01672}01672\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(CredibleInSigmas)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01673}01673\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01674}01674\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Convert\ sigmas\ into\ percentage}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01675}01675\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ CredReg\ =\ \mbox{\hyperlink{StatisticalUtils_8h_a04394b98587b44b98b003bd1226606ed}{GetSigmaValue}}(\textcolor{keywordtype}{int}(std::round(CredibleRegions[k])));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01676}01676\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{StatisticalUtils_8h_add6570517afa2cca738b9aca56aa3883}{GetCredibleRegion}}(hpost\_2D\_cl[i][j][k],\ CredReg);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01677}01677\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01678}01678\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01679}01679\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01680}01680\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{StatisticalUtils_8h_add6570517afa2cca738b9aca56aa3883}{GetCredibleRegion}}(hpost\_2D\_cl[i][j][k],\ CredibleRegions[k]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01681}01681\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01682}01682\ \ \ \ \ \ \ \ \ hpost\_2D\_cl[i][j][k]-\/>SetLineColor(CredibleRegionColor[k]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01683}01683\ \ \ \ \ \ \ \ \ hpost\_2D\_cl[i][j][k]-\/>SetLineWidth(2);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01684}01684\ \ \ \ \ \ \ \ \ hpost\_2D\_cl[i][j][k]-\/>SetLineStyle(CredibleRegionStyle[k]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01685}01685\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01686}01686\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01687}01687\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01688}01688\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01689}01689\ \ \ gStyle-\/>SetPalette(51);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01690}01690\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01691}01691\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01692}01692\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01693}01693\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01694}01694\ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ the\ diagonal\ elements\ which\ we've\ already\ done\ above}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01695}01695\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ ==\ i)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01696}01696\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a95fa49737432818bc830a44898d0d850}{IamVaried}}[j]\ ==\ \textcolor{keyword}{false})\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01697}01697\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01698}01698\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ legend\ =\ std::make\_unique<TLegend>(0.20,\ 0.7,\ 0.4,\ 0.92);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01699}01699\ \ \ \ \ \ \ legend-\/>SetTextColor(kRed);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01700}01700\ \ \ \ \ \ \ legend-\/>SetTextSize(0.03);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01701}01701\ \ \ \ \ \ \ legend-\/>SetFillColor(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01702}01702\ \ \ \ \ \ \ legend-\/>SetFillStyle(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01703}01703\ \ \ \ \ \ \ legend-\/>SetLineColor(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01704}01704\ \ \ \ \ \ \ legend-\/>SetLineStyle(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01705}01705\ \ \ \ \ \ \ legend-\/>SetBorderSize(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01706}01706\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01707}01707\ \ \ \ \ \ \ \textcolor{comment}{//Get\ Best\ point}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01708}01708\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ bestfitM\ =\ std::make\_unique<TGraph>(1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01709}01709\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ MaxBin\ =\ hpost\_2D\_copy[i][j]-\/>GetMaximumBin();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01710}01710\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ Mbx,\ Mby,\ Mbz;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01711}01711\ \ \ \ \ \ \ hpost\_2D\_copy[i][j]-\/>GetBinXYZ(MaxBin,\ Mbx,\ Mby,\ Mbz);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01712}01712\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Mx\ =\ hpost\_2D\_copy[i][j]-\/>GetXaxis()-\/>GetBinCenter(Mbx);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01713}01713\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ My\ =\ hpost\_2D\_copy[i][j]-\/>GetYaxis()-\/>GetBinCenter(Mby);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01714}01714\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01715}01715\ \ \ \ \ \ \ bestfitM-\/>SetPoint(0,\ Mx,\ My);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01716}01716\ \ \ \ \ \ \ bestfitM-\/>SetMarkerStyle(22);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01717}01717\ \ \ \ \ \ \ bestfitM-\/>SetMarkerSize(1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01718}01718\ \ \ \ \ \ \ bestfitM-\/>SetMarkerColor(kMagenta);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01719}01719\ \ \ \ \ \ \ legend-\/>AddEntry(bestfitM.get(),\textcolor{stringliteral}{"{}Best\ Fit"{}},\textcolor{stringliteral}{"{}p"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01720}01720\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01721}01721\ \ \ \ \ \ \ \textcolor{comment}{//Plot\ default\ 2D\ posterior}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01722}01722\ \ \ \ \ \ \ hpost\_2D\_copy[i][j]-\/>Draw(\textcolor{stringliteral}{"{}COLZ"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01723}01723\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01724}01724\ \ \ \ \ \ \ \textcolor{comment}{//Now\ credible\ regions}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01725}01725\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ nCredible;\ ++k)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01726}01726\ \ \ \ \ \ \ \ \ hpost\_2D\_cl[i][j][k]-\/>Draw(\textcolor{stringliteral}{"{}CONT3\ SAME"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01727}01727\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ nCredible-\/1;\ k\ >=\ 0;\ -\/-\/k)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01728}01728\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01729}01729\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(CredibleInSigmas)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01730}01730\ \ \ \ \ \ \ \ \ \ \ legend-\/>AddEntry(hpost\_2D\_cl[i][j][k],\ Form(\textcolor{stringliteral}{"{}\%.0f\#sigma\ Credible\ Interval"{}},\ CredibleRegions[k]),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01731}01731\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01732}01732\ \ \ \ \ \ \ \ \ \ \ legend-\/>AddEntry(hpost\_2D\_cl[i][j][k],\ Form(\textcolor{stringliteral}{"{}\%.0f\%\%\ Credible\ Region"{}},\ CredibleRegions[k]*100),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01733}01733\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01734}01734\ \ \ \ \ \ \ legend-\/>Draw(\textcolor{stringliteral}{"{}SAME"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01735}01735\ \ \ \ \ \ \ bestfitM-\/>Draw(\textcolor{stringliteral}{"{}SAME.P"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01736}01736\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01737}01737\ \ \ \ \ \ \ \textcolor{comment}{//\ Write\ to\ file}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01738}01738\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetName(\mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>GetName());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01739}01739\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTitle(\mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>GetTitle());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01740}01740\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01741}01741\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Print\ only\ regions\ with\ correlation\ greater\ than\ specified\ value,\ by\ defualt\ 0.2.\ This\ is\ done\ to\ avoid\ dumping\ thousands\ of\ plots}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01742}01742\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}}\ \&\&\ std::fabs((*\mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}})(i,j))\ >\ \mbox{\hyperlink{classMCMCProcessor_a25e4685b6299181021b02ac0e0b74681}{Post2DPlotThreshold}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01743}01743\ \ \ \ \ \ \ \textcolor{comment}{//\ Write\ it\ to\ root\ file}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01744}01744\ \ \ \ \ \ \ \textcolor{comment}{//OutputFile-\/>cd();}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01745}01745\ \ \ \ \ \ \ \textcolor{comment}{//if(\ std::fabs((*Correlation)(i,j))\ >\ Post2DPlotThreshold\ )\ Posterior-\/>Write();}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01746}01746\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01747}01747\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01748}01748\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01749}01749\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01750}01750\ \ \ \textcolor{comment}{//KS:\ Remove\ histograms}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01751}01751\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01752}01752\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01753}01753\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01754}01754\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01755}01755\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ hpost\_2D\_copy[i][j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01756}01756\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ nCredible;\ ++k)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01757}01757\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01758}01758\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ hpost\_2D\_cl[i][j][k];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01759}01759\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01760}01760\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01761}01761\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01762}01762\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01763}01763\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01764}01764\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01765}01765\ \textcolor{comment}{//\ Make\ fancy\ triangle\ plot\ for\ selected\ parameters}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01766}\mbox{\hyperlink{classMCMCProcessor_a3ae80722efa0c94eec066ee91f3cf997}{01766}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_a3ae80722efa0c94eec066ee91f3cf997}{MCMCProcessor::MakeTrianglePlot}}(\textcolor{keyword}{const}\ std::vector<std::string>\&\ ParNames,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01767}01767\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ 1D}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01768}01768\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<double>\&\ CredibleIntervals,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01769}01769\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<Color\_t>\&\ CredibleIntervalsColours,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01770}01770\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//2D}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01771}01771\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<double>\&\ CredibleRegions,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01772}01772\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<Style\_t>\&\ CredibleRegionStyle,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01773}01773\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<Color\_t>\&\ CredibleRegionColor,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01774}01774\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Other}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01775}01775\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ CredibleInSigmas)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01776}01776\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01777}01777\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01778}01778\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_ab367cb5f56606338bb1fce780f2414e8}{MakeCovariance\_MP}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01779}01779\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ Triangle\ Plot"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01780}01780\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01781}01781\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nParamPlot\ =\ int(ParNames.size());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01782}01782\ \ \ std::vector<int>\ ParamNumber;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01783}01783\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nParamPlot;\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01784}01784\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01785}01785\ \ \ \ \ \textcolor{comment}{//KS:\ First\ we\ need\ to\ find\ parameter\ number\ based\ on\ name}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01786}01786\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamNo\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01787}01787\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01788}01788\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01789}01789\ \ \ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01790}01790\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01791}01791\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01792}01792\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01793}01793\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(i,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01794}01794\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01795}01795\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(ParNames[j]\ ==\ Title)\ ParamNo\ =\ i;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01796}01796\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01797}01797\ \ \ \ \ \textcolor{keywordflow}{if}(ParamNo\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}})}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01798}01798\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01799}01799\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Couldn't\ find\ param\ \{\}.\ Will\ not\ plot\ Triangle\ plot"{}},\ ParNames[j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01800}01800\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01801}01801\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01802}01802\ \ \ \ \ ParamNumber.push\_back(ParamNo);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01803}01803\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01804}01804\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01805}01805\ \ \ \textcolor{comment}{//KS:\ Store\ it\ as\ we\ go\ back\ to\ them\ at\ the\ end}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01806}01806\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ TopMargin\ \ \ \ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetTopMargin();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01807}01807\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ BottomMargin\ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetBottomMargin();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01808}01808\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ LeftMargin\ \ \ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetLeftMargin();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01809}01809\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ RighMargin\ \ \ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetRightMargin();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01810}01810\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTopMargin(0.001);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01811}01811\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetBottomMargin(0.001);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01812}01812\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetLeftMargin(0.001);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01813}01813\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetRightMargin(0.001);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01814}01814\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01815}01815\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01816}01816\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Clear();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01817}01817\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Update();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01818}01818\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01819}01819\ \ \ \textcolor{comment}{//KS:\ We\ sort\ to\ have\ parameters\ from\ highest\ to\ lowest,\ this\ is\ related\ to\ how\ we\ make\ 2D\ projections\ in\ MakeCovariance\_MP}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01820}01820\ \ \ std::sort(ParamNumber.begin(),\ ParamNumber.end(),\ \ std::greater<int>());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01821}01821\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01822}01822\ \ \ \textcolor{comment}{//KS:\ Calculate\ how\ many\ pads/plots\ we\ need}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01823}01823\ \ \ \textcolor{keywordtype}{int}\ Npad\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01824}01824\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 1;\ j\ <\ nParamPlot+1;\ j++)\ Npad\ +=\ j;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01825}01825\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01826}01826\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01827}01827\ \ \ \textcolor{keywordflow}{if}(CredibleIntervals.size()\ !=\ CredibleIntervalsColours.size())}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01828}01828\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01829}01829\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}size\ of\ \ CredibleIntervals\ is\ not\ equat\ to\ size\ of\ CredibleIntervalsColours"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01830}01830\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01831}01831\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01832}01832\ \ \ \textcolor{keywordflow}{if}(CredibleIntervals.size()\ >\ 1)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01833}01833\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01834}01834\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ CredibleIntervals.size();\ i++\ )}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01835}01835\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01836}01836\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(CredibleIntervals[i]\ >\ CredibleIntervals[i-\/1])}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01837}01837\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01838}01838\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Interval\ \{\}\ is\ smaller\ than\ \{\}"{}},\ i,\ i-\/1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01839}01839\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}\{:.2f\}\ \{:.2f\}"{}},\ CredibleIntervals[i],\ CredibleIntervals[i-\/1]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01840}01840\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}They\ should\ be\ grouped\ in\ decreasing\ order"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01841}01841\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01842}01842\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01843}01843\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01844}01844\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01845}01845\ \ \ \textcolor{keywordflow}{if}(\ (CredibleRegions.size()\ !=\ CredibleRegionStyle.size())\ ||\ (CredibleRegionStyle.size()\ !=\ CredibleRegionColor.size())\ )}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01846}01846\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01847}01847\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}size\ of\ \ CredibleRegions\ is\ not\ equat\ to\ size\ of\ CredibleRegionStyle"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01848}01848\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01849}01849\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01850}01850\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ CredibleRegions.size();\ i++\ )}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01851}01851\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01852}01852\ \ \ \ \ \textcolor{keywordflow}{if}(CredibleRegions[i]\ >\ CredibleRegions[i-\/1])}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01853}01853\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01854}01854\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Interval\ \{\}\ is\ smaller\ than\ \{\}"{}},\ i,\ i-\/1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01855}01855\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}\{:.2f\}\ \{:.2f\}"{}},\ CredibleRegions[i],\ CredibleRegions[i-\/1]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01856}01856\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}They\ should\ be\ grouped\ in\ decreasing\ order"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01857}01857\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01858}01858\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01859}01859\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01860}01860\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nCredibleIntervals\ =\ int(CredibleIntervals.size());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01861}01861\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nCredibleRegions\ =\ int(CredibleRegions.size());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01862}01862\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01863}01863\ \ \ \textcolor{comment}{//KS:\ Initialise\ Tpad\ histograms\ etc\ we\ will\ need}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01864}01864\ \ \ TPad**\ TrianglePad\ =\ \textcolor{keyword}{new}\ TPad*[Npad];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01865}01865\ \ \ \textcolor{comment}{//KS:\ 1D\ copy\ of\ posterior,\ we\ need\ it\ as\ we\ modify\ them}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01866}01866\ \ \ TH1D**\ hpost\_copy\ =\ \textcolor{keyword}{new}\ TH1D*[nParamPlot];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01867}01867\ \ \ TH1D***\ hpost\_cl\ =\ \textcolor{keyword}{new}\ TH1D**[nParamPlot];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01868}01868\ \ \ TText\ **TriangleText\ =\ \textcolor{keyword}{new}\ TText\ *[nParamPlot*2];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01869}01869\ \ \ TH2D**\ hpost\_2D\_copy\ =\ \textcolor{keyword}{new}\ TH2D*[Npad-\/nParamPlot];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01870}01870\ \ \ TH2D***\ hpost\_2D\_cl\ =\ \textcolor{keyword}{new}\ TH2D**[Npad-\/nParamPlot];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01871}01871\ \ \ gStyle-\/>SetPalette(51);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01872}01872\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01873}01873\ \ \ \textcolor{comment}{//KS:\ Super\ convoluted\ way\ of\ calculating\ ranges\ for\ our\ pads,\ trust\ me\ it\ works...}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01874}01874\ \ \ std::vector<double>\ X\_Min(nParamPlot);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01875}01875\ \ \ std::vector<double>\ X\_Max(nParamPlot);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01876}01876\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01877}01877\ \ \ X\_Min[0]\ =\ 0.10;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01878}01878\ \ \ \textcolor{keywordtype}{double}\ xScale\ =\ (0.95\ -\/\ (X\_Min[0]+0.05))/nParamPlot;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01879}01879\ \ \ \textcolor{comment}{//KS:\ 0.05\ is\ because\ we\ need\ additional\ offset\ for\ labels}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01880}01880\ \ \ X\_Max[0]\ =\ X\_Min[0]+xScale+0.05;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01881}01881\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ nParamPlot;\ i++)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01882}01882\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01883}01883\ \ \ \ \ X\_Min[i]\ =\ X\_Max[i-\/1];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01884}01884\ \ \ \ \ X\_Max[i]\ =\ X\_Min[i]+xScale;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01885}01885\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01886}01886\ \ \ std::vector<double>\ Y\_Min(nParamPlot);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01887}01887\ \ \ std::vector<double>\ Y\_Max(nParamPlot);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01888}01888\ \ \ Y\_Max[0]\ =\ 0.95;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01889}01889\ \ \ \textcolor{comment}{//KS:\ 0.10\ is\ becasue\ we\ need\ additional\ offset\ for\ labels}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01890}01890\ \ \ \textcolor{keywordtype}{double}\ yScale\ =\ std::fabs(0.10\ -\/\ (Y\_Max[0]))/nParamPlot;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01891}01891\ \ \ Y\_Min[0]\ =\ Y\_Max[0]-\/yScale;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01892}01892\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ nParamPlot;\ i++)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01893}01893\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01894}01894\ \ \ \ \ Y\_Max[i]\ =\ Y\_Min[i-\/1];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01895}01895\ \ \ \ \ Y\_Min[i]\ =\ Y\_Max[i]-\/yScale;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01896}01896\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01897}01897\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01898}01898\ \ \ \textcolor{comment}{//KS:\ We\ store\ as\ numbering\ of\ isn't\ straightforward}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01899}01899\ \ \ \textcolor{keywordtype}{int}\ counterPad\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01900}01900\ \ \ \textcolor{keywordtype}{int}\ counterText\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01901}01901\ \ \ \textcolor{keywordtype}{int}\ counterPost\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01902}01902\ \ \ \textcolor{keywordtype}{int}\ counter2DPost\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01903}01903\ \ \ \textcolor{comment}{//KS:\ We\ start\ from\ top\ of\ the\ plot,\ might\ be\ confusing\ but\ works\ very\ well}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01904}01904\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ y\ =\ 0;\ y\ <\ nParamPlot;\ y++)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01905}01905\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01906}01906\ \ \ \ \ \textcolor{comment}{//KS:\ start\ from\ left\ and\ go\ right,\ depending\ on\ y}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01907}01907\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <=\ y;\ x++)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01908}01908\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01909}01909\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Need\ to\ go\ to\ canvas\ every\ time\ to\ have\ our\ pads\ in\ the\ same\ canvas,\ not\ pads\ in\ the\ pads}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01910}01910\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01911}01911\ \ \ \ \ \ \ TrianglePad[counterPad]\ =\ \textcolor{keyword}{new}\ TPad(Form(\textcolor{stringliteral}{"{}TPad\_\%i"{}},\ counterPad),\ Form(\textcolor{stringliteral}{"{}TPad\_\%i"{}},\ counterPad),}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01912}01912\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ X\_Min[x],\ Y\_Min[y],\ X\_Max[x],\ Y\_Max[y]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01913}01913\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01914}01914\ \ \ \ \ \ \ TrianglePad[counterPad]-\/>SetTopMargin(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01915}01915\ \ \ \ \ \ \ TrianglePad[counterPad]-\/>SetRightMargin(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01916}01916\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01917}01917\ \ \ \ \ \ \ TrianglePad[counterPad]-\/>SetGrid();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01918}01918\ \ \ \ \ \ \ TrianglePad[counterPad]-\/>SetFrameBorderMode(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01919}01919\ \ \ \ \ \ \ TrianglePad[counterPad]-\/>SetBorderMode(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01920}01920\ \ \ \ \ \ \ TrianglePad[counterPad]-\/>SetBorderSize(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01921}01921\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01922}01922\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Corresponds\ to\ bottom\ part\ of\ the\ plot,\ need\ margins\ for\ labels}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01923}01923\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(y\ ==\ (nParamPlot-\/1))\ TrianglePad[counterPad]-\/>SetBottomMargin(0.1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01924}01924\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ TrianglePad[counterPad]-\/>SetBottomMargin(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01925}01925\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01926}01926\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Corresponds\ to\ left\ part,\ need\ margins\ for\ labels}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01927}01927\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(x\ ==\ 0)\ TrianglePad[counterPad]-\/>SetLeftMargin(0.15);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01928}01928\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ TrianglePad[counterPad]-\/>SetLeftMargin(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01929}01929\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01930}01930\ \ \ \ \ \ \ TrianglePad[counterPad]-\/>Draw();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01931}01931\ \ \ \ \ \ \ TrianglePad[counterPad]-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01932}01932\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01933}01933\ \ \ \ \ \ \ \textcolor{comment}{//KS:if\ diagonal\ plot\ main\ posterior}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01934}01934\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(x\ ==\ y)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01935}01935\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01936}01936\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]\ =\ \textcolor{keyword}{static\_cast<}TH1D*\textcolor{keyword}{>}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNumber[x]]-\/>Clone(Form(\textcolor{stringliteral}{"{}hpost\_copy\_\%i"{}},\ ParamNumber[x])));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01937}01937\ \ \ \ \ \ \ \ \ hpost\_cl[counterPost]\ =\ \textcolor{keyword}{new}\ TH1D*[nCredibleIntervals];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01939}01939\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]-\/>Scale(1.\ /\ hpost\_copy[counterPost]-\/>Integral());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01940}01940\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nCredibleIntervals;\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01941}01941\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01942}01942\ \ \ \ \ \ \ \ \ \ \ hpost\_cl[counterPost][j]\ =\ \textcolor{keyword}{static\_cast<}TH1D*\textcolor{keyword}{>}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNumber[x]]-\/>Clone(Form(\textcolor{stringliteral}{"{}hpost\_copy\_\%i\_CL\_\%f"{}},\ ParamNumber[x],\ CredibleIntervals[j])));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01943}01943\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Reset\ to\ get\ rid\ to\ TF1\ otherwise\ we\ run\ into\ segfault\ :(}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01944}01944\ \ \ \ \ \ \ \ \ \ \ hpost\_cl[counterPost][j]-\/>Reset(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01945}01945\ \ \ \ \ \ \ \ \ \ \ hpost\_cl[counterPost][j]-\/>Fill(0.0,\ 0.0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01946}01946\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01947}01947\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Scale\ the\ histograms\ before\ gettindg\ credible\ intervals}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01948}01948\ \ \ \ \ \ \ \ \ \ \ hpost\_cl[counterPost][j]-\/>Scale(1.\ /\ hpost\_cl[counterPost][j]-\/>Integral());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01949}01949\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Slightly\ different\ approach\ depending\ if\ intervals\ are\ in\ percentage\ or\ sigmas}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01950}01950\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(CredibleInSigmas)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01951}01951\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01952}01952\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Convert\ sigmas\ into\ percentage}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01953}01953\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ CredReg\ =\ \mbox{\hyperlink{StatisticalUtils_8h_a04394b98587b44b98b003bd1226606ed}{GetSigmaValue}}(\textcolor{keywordtype}{int}(std::round(CredibleIntervals[j])));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01954}01954\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{StatisticalUtils_8h_aac24043cc7a5ef6a05fc1b10d3860875}{GetCredibleInterval}}(hpost\_copy[counterPost],\ hpost\_cl[counterPost][j],\ CredReg);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01955}01955\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01956}01956\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01957}01957\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01958}01958\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{StatisticalUtils_8h_aac24043cc7a5ef6a05fc1b10d3860875}{GetCredibleInterval}}(hpost\_copy[counterPost],\ hpost\_cl[counterPost][j],\ CredibleIntervals[j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01959}01959\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01960}01960\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01961}01961\ \ \ \ \ \ \ \ \ \ \ hpost\_cl[counterPost][j]-\/>SetFillColor(CredibleIntervalsColours[j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01962}01962\ \ \ \ \ \ \ \ \ \ \ hpost\_cl[counterPost][j]-\/>SetLineWidth(1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01963}01963\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01964}01964\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01965}01965\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]-\/>SetMaximum(hpost\_copy[counterPost]-\/>GetMaximum()*1.2);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01966}01966\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]-\/>SetLineWidth(2);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01967}01967\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]-\/>SetLineColor(kBlack);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01968}01968\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01969}01969\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Don't\ want\ any\ titles}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01970}01970\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01971}01971\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01972}01972\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]-\/>SetTitle(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01973}01973\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01974}01974\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]-\/>GetXaxis()-\/>SetLabelSize(0.1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01975}01975\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]-\/>GetYaxis()-\/>SetLabelSize(0.1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01976}01976\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01977}01977\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]-\/>GetXaxis()-\/>SetNdivisions(4);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01978}01978\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]-\/>GetYaxis()-\/>SetNdivisions(4);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01979}01979\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01980}01980\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]-\/>Draw(\textcolor{stringliteral}{"{}HIST"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01981}01981\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nCredibleIntervals;\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01982}01982\ \ \ \ \ \ \ \ \ \ \ hpost\_cl[counterPost][j]-\/>Draw(\textcolor{stringliteral}{"{}HIST\ SAME"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01983}01983\ \ \ \ \ \ \ \ \ counterPost++;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01984}01984\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01985}01985\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Here\ we\ plot\ 2D\ credible\ regions}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01986}01986\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01987}01987\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01988}01988\ \ \ \ \ \ \ \ \ hpost\_2D\_copy[counter2DPost]\ =\ \textcolor{keyword}{static\_cast<}TH2D*\textcolor{keyword}{>}(\mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[ParamNumber[x]][ParamNumber[y]]-\/>Clone(}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01989}01989\ \ \ \ \ \ \ \ \ \ \ Form(\textcolor{stringliteral}{"{}hpost\_copy\_\%i\_\%i"{}},\ ParamNumber[x],\ ParamNumber[y])));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01990}01990\ \ \ \ \ \ \ \ \ hpost\_2D\_cl[counter2DPost]\ =\ \textcolor{keyword}{new}\ TH2D*[nCredibleRegions];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01991}01991\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Now\ copy\ for\ every\ credible\ region}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01992}01992\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ nCredibleRegions;\ ++k)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01993}01993\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01994}01994\ \ \ \ \ \ \ \ \ \ \ hpost\_2D\_cl[counter2DPost][k]\ =\ \textcolor{keyword}{static\_cast<}TH2D*\textcolor{keyword}{>}(\mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[ParamNumber[x]][ParamNumber[y]]-\/>Clone(}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01995}01995\ \ \ \ \ \ \ \ \ \ \ \ \ Form(\textcolor{stringliteral}{"{}hpost\_copy\_\%i\_\%i\_CL\_\%f"{}},\ ParamNumber[x],\ ParamNumber[y],\ CredibleRegions[k])));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01996}01996\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(CredibleInSigmas)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01997}01997\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01998}01998\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Convert\ sigmas\ into\ percentage}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l01999}01999\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ CredReg\ =\ \mbox{\hyperlink{StatisticalUtils_8h_a04394b98587b44b98b003bd1226606ed}{GetSigmaValue}}(\textcolor{keywordtype}{int}(std::round(CredibleRegions[k])));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02000}02000\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{StatisticalUtils_8h_add6570517afa2cca738b9aca56aa3883}{GetCredibleRegion}}(hpost\_2D\_cl[counter2DPost][k],\ CredReg);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02001}02001\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02002}02002\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02003}02003\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02004}02004\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{StatisticalUtils_8h_add6570517afa2cca738b9aca56aa3883}{GetCredibleRegion}}(hpost\_2D\_cl[counter2DPost][k],\ CredibleRegions[k]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02005}02005\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02006}02006\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02007}02007\ \ \ \ \ \ \ \ \ \ \ hpost\_2D\_cl[counter2DPost][k]-\/>SetLineColor(CredibleRegionColor[k]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02008}02008\ \ \ \ \ \ \ \ \ \ \ hpost\_2D\_cl[counter2DPost][k]-\/>SetLineWidth(2);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02009}02009\ \ \ \ \ \ \ \ \ \ \ hpost\_2D\_cl[counter2DPost][k]-\/>SetLineStyle(CredibleRegionStyle[k]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02010}02010\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02011}02011\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02012}02012\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Don't\ want\ any\ titles}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02013}02013\ \ \ \ \ \ \ \ \ hpost\_2D\_copy[counter2DPost]-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02014}02014\ \ \ \ \ \ \ \ \ hpost\_2D\_copy[counter2DPost]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02015}02015\ \ \ \ \ \ \ \ \ hpost\_2D\_copy[counter2DPost]-\/>SetTitle(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02016}02016\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02017}02017\ \ \ \ \ \ \ \ \ hpost\_2D\_copy[counter2DPost]-\/>GetXaxis()-\/>SetLabelSize(0.1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02018}02018\ \ \ \ \ \ \ \ \ hpost\_2D\_copy[counter2DPost]-\/>GetYaxis()-\/>SetLabelSize(0.1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02019}02019\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02020}02020\ \ \ \ \ \ \ \ \ hpost\_2D\_copy[counter2DPost]-\/>\ GetXaxis()-\/>SetNdivisions(4);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02021}02021\ \ \ \ \ \ \ \ \ hpost\_2D\_copy[counter2DPost]-\/>\ GetYaxis()-\/>SetNdivisions(4);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02022}02022\ \ \ \ \ \ \ \ \ hpost\_2D\_copy[counter2DPost]-\/>Draw(\textcolor{stringliteral}{"{}COL"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02023}02023\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Now\ credible\ regions}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02024}02024\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ nCredibleRegions;\ ++k)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02025}02025\ \ \ \ \ \ \ \ \ \ \ hpost\_2D\_cl[counter2DPost][k]-\/>Draw(\textcolor{stringliteral}{"{}CONT3\ SAME"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02026}02026\ \ \ \ \ \ \ \ \ counter2DPost++;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02027}02027\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02028}02028\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Corresponds\ to\ bottom\ part\ of\ the\ plot}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02029}02029\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(y\ ==\ (nParamPlot-\/1))}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02030}02030\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02031}02031\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02032}02032\ \ \ \ \ \ \ \ \ TriangleText[counterText]\ =\ \textcolor{keyword}{new}\ TText(X\_Min[x]+\ (X\_Max[x]-\/X\_Min[x])/4,\ 0.04,\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNumber[x]]-\/>GetTitle());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02033}02033\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Unfortunately\ for\ many\ plots\ or\ long\ names\ this\ can\ go\ out\ of\ bounds\ :(}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02034}02034\ \ \ \ \ \ \ \ \ TriangleText[counterText]-\/>SetTextSize(0.015);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02035}02035\ \ \ \ \ \ \ \ \ TriangleText[counterText]-\/>SetNDC(\textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02036}02036\ \ \ \ \ \ \ \ \ TriangleText[counterText]-\/>Draw();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02037}02037\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02038}02038\ \ \ \ \ \ \ \ \ counterText++;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02039}02039\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02040}02040\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Corresponds\ to\ left\ part}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02041}02041\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(x\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02042}02042\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02043}02043\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02044}02044\ \ \ \ \ \ \ \ \ TriangleText[counterText]\ =\ \textcolor{keyword}{new}\ TText(0.04,\ Y\_Min[y]\ +\ (Y\_Max[y]-\/Y\_Min[y])/4,\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNumber[y]]-\/>GetTitle());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02045}02045\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Rotate\ as\ this\ is\ y\ axis}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02046}02046\ \ \ \ \ \ \ \ \ TriangleText[counterText]-\/>SetTextAngle(90);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02047}02047\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Unfortunately\ for\ many\ plots\ or\ long\ names\ this\ can\ go\ out\ of\ bounds\ :(}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02048}02048\ \ \ \ \ \ \ \ \ TriangleText[counterText]-\/>SetTextSize(0.015);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02049}02049\ \ \ \ \ \ \ \ \ TriangleText[counterText]-\/>SetNDC(\textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02050}02050\ \ \ \ \ \ \ \ \ TriangleText[counterText]-\/>Draw();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02051}02051\ \ \ \ \ \ \ \ \ counterText++;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02052}02052\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02053}02053\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Update();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02054}02054\ \ \ \ \ \ \ counterPad++;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02055}02055\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02056}02056\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02057}02057\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02058}02058\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02059}02059\ \ \ \textcolor{keyword}{auto}\ legend\ =\ std::make\_unique<TLegend>(0.60,\ 0.7,\ 0.9,\ 0.9);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02060}02060\ \ \ legend-\/>SetTextSize(0.03);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02061}02061\ \ \ legend-\/>SetFillColor(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02062}02062\ \ \ legend-\/>SetFillStyle(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02063}02063\ \ \ legend-\/>SetLineColor(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02064}02064\ \ \ legend-\/>SetLineStyle(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02065}02065\ \ \ legend-\/>SetBorderSize(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02066}02066\ \ \ \textcolor{comment}{//KS:\ Legend\ is\ shared\ so\ just\ take\ first\ histograms}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02067}02067\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ nCredibleIntervals-\/1;\ j\ >=\ 0;\ -\/-\/j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02068}02068\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02069}02069\ \ \ \ \ \textcolor{keywordflow}{if}(CredibleInSigmas)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02070}02070\ \ \ \ \ \ \ legend-\/>AddEntry(hpost\_cl[0][j],\ Form(\textcolor{stringliteral}{"{}\%.0f\#sigma\ Credible\ Interval"{}},\ CredibleIntervals[j]),\ \textcolor{stringliteral}{"{}f"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02071}02071\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02072}02072\ \ \ \ \ \ \ legend-\/>AddEntry(hpost\_cl[0][j],\ Form(\textcolor{stringliteral}{"{}\%.0f\%\%\ Credible\ Interval"{}},\ CredibleRegions[j]*100),\ \textcolor{stringliteral}{"{}f"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02073}02073\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02074}02074\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ nCredibleRegions-\/1;\ k\ >=\ 0;\ -\/-\/k)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02075}02075\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02076}02076\ \ \ \ \ \textcolor{keywordflow}{if}(CredibleInSigmas)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02077}02077\ \ \ \ \ \ \ legend-\/>AddEntry(hpost\_2D\_cl[0][k],\ Form(\textcolor{stringliteral}{"{}\%.0f\#sigma\ Credible\ Region"{}},\ CredibleRegions[k]),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02078}02078\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02079}02079\ \ \ \ \ \ \ legend-\/>AddEntry(hpost\_2D\_cl[0][k],\ Form(\textcolor{stringliteral}{"{}\%.0f\%\%\ Credible\ Region"{}},\ CredibleRegions[k]*100),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02080}02080\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02081}02081\ \ \ legend-\/>Draw(\textcolor{stringliteral}{"{}SAME"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02082}02082\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Update();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02083}02083\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02084}02084\ \ \ \textcolor{comment}{//\ Write\ to\ file}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02085}02085\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetName(\textcolor{stringliteral}{"{}TrianglePlot"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02086}02086\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTitle(\textcolor{stringliteral}{"{}TrianglePlot"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02087}02087\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02088}02088\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02089}02089\ \ \ \textcolor{comment}{//\ Write\ it\ to\ root\ file}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02090}02090\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02091}02091\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Write();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02092}02092\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02093}02093\ \ \ \textcolor{comment}{//KS:\ Remove\ allocated\ structures}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02094}02094\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ Npad;\ i++)\ \textcolor{keyword}{delete}\ TrianglePad[i];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02095}02095\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ nParamPlot*2;\ i++)\ \textcolor{keyword}{delete}\ TriangleText[i];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02096}02096\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ nParamPlot;\ i++)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02097}02097\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02098}02098\ \ \ \ \ \textcolor{keyword}{delete}\ hpost\_copy[i];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02099}02099\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nCredibleIntervals;\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02100}02100\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02101}02101\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ hpost\_cl[i][j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02102}02102\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02103}02103\ \ \ \ \ \textcolor{keyword}{delete}[]\ hpost\_cl[i];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02104}02104\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02105}02105\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ Npad\ -\/\ nParamPlot;\ i++)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02106}02106\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02107}02107\ \ \ \ \ \textcolor{keyword}{delete}\ hpost\_2D\_copy[i];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02108}02108\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nCredibleRegions;\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02109}02109\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02110}02110\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ hpost\_2D\_cl[i][j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02111}02111\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02112}02112\ \ \ \ \ \textcolor{keyword}{delete}[]\ hpost\_2D\_cl[i];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02113}02113\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02114}02114\ \ \ \textcolor{keyword}{delete}[]\ hpost\_copy;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02115}02115\ \ \ \textcolor{keyword}{delete}[]\ hpost\_cl;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02116}02116\ \ \ \textcolor{keyword}{delete}[]\ hpost\_2D\_copy;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02117}02117\ \ \ \textcolor{keyword}{delete}[]\ hpost\_2D\_cl;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02118}02118\ \ \ \textcolor{keyword}{delete}[]\ TrianglePad;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02119}02119\ \ \ \textcolor{keyword}{delete}[]\ TriangleText;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02120}02120\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02121}02121\ \ \ \textcolor{comment}{//KS:\ Restore\ margin}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02122}02122\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTopMargin(TopMargin);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02123}02123\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetLeftMargin(BottomMargin);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02124}02124\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetLeftMargin(LeftMargin);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02125}02125\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetRightMargin(RighMargin);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02126}02126\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02127}02127\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02128}02128\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02129}02129\ \textcolor{comment}{//\ Scan\ the\ input\ trees}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02130}\mbox{\hyperlink{classMCMCProcessor_aeff2174617268c1e55333529459bffb6}{02130}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_aeff2174617268c1e55333529459bffb6}{MCMCProcessor::ScanInput}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02131}02131\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02132}02132\ \ \ \textcolor{comment}{//\ KS:\ This\ can\ reduce\ time\ necessary\ for\ caching\ even\ by\ half}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02133}02133\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02134}02134\ \ \ \textcolor{comment}{//ROOT::EnableImplicitMT();}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02135}02135\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02136}02136\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02137}02137\ \ \ \textcolor{comment}{//\ Open\ the\ Chain}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02138}02138\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}\ =\ \textcolor{keyword}{new}\ TChain(\textcolor{stringliteral}{"{}posteriors"{}},\textcolor{stringliteral}{"{}posteriors"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02139}02139\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>Add(\mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}}.c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02140}02140\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02141}02141\ \ \ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}\ =\ int(\mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetEntries());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02142}02142\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02143}02143\ \ \ \textcolor{comment}{//Only\ is\ suboptimality\ we\ might\ want\ to\ change\ it,\ therefore\ set\ it\ high\ enough\ so\ it\ doesn't\ affect\ other\ functionality}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02144}02144\ \ \ \mbox{\hyperlink{classMCMCProcessor_a840c686f15f419c0156df01c4ed62931}{UpperCut}}\ =\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}+1;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02145}02145\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02146}02146\ \ \ \textcolor{comment}{//\ Get\ the\ list\ of\ branches}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02147}02147\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02148}02148\ \ \ TObjArray*\ brlis\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetListOfBranches();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02149}02149\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02150}02150\ \ \ \textcolor{comment}{//\ Get\ the\ number\ of\ branches}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02151}02151\ \ \ \mbox{\hyperlink{classMCMCProcessor_af6ba5d9aec5350fafebbf81309e813cb}{nBranches}}\ =\ brlis-\/>GetEntries();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02152}02152\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02153}02153\ \ \ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}.reserve(\mbox{\hyperlink{classMCMCProcessor_af6ba5d9aec5350fafebbf81309e813cb}{nBranches}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02154}02154\ \ \ \mbox{\hyperlink{classMCMCProcessor_a95fa49737432818bc830a44898d0d850}{IamVaried}}.reserve(\mbox{\hyperlink{classMCMCProcessor_af6ba5d9aec5350fafebbf81309e813cb}{nBranches}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02155}02155\ \ \ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}.reserve(\mbox{\hyperlink{classMCMCProcessor_af6ba5d9aec5350fafebbf81309e813cb}{nBranches}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02156}02156\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02157}02157\ \ \ \textcolor{comment}{//\ Set\ all\ the\ branches\ to\ off}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02158}02158\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchStatus(\textcolor{stringliteral}{"{}*"{}},\ \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02159}02159\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02160}02160\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ number\ of\ branches}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02161}02161\ \ \ \textcolor{comment}{//\ Find\ the\ name\ and\ how\ many\ of\ each\ systematic\ we\ have}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02162}02162\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_af6ba5d9aec5350fafebbf81309e813cb}{nBranches}};\ i++)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02163}02163\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02164}02164\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ TBranch\ and\ its\ name}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02165}02165\ \ \ \ \ TBranch*\ br\ =\ \textcolor{keyword}{static\_cast<}TBranch*\textcolor{keyword}{>}(brlis-\/>At(i));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02166}02166\ \ \ \ \ \textcolor{keywordflow}{if}(!br)\{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02167}02167\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Invalid\ branch\ at\ position\ \{\}"{}},\ i);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02168}02168\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_,\_\_LINE\_\_);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02169}02169\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02170}02170\ \ \ \ \ TString\ bname\ =\ br-\/>GetName();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02171}02171\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02172}02172\ \ \ \ \ \textcolor{comment}{//KS:\ Exclude\ parameter\ types}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02173}02173\ \ \ \ \ \textcolor{keywordtype}{bool}\ rejected\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02174}02174\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ik\ =\ 0;\ ik\ <\ \mbox{\hyperlink{classMCMCProcessor_aada4aadea10661586b46c1013a9d018f}{ExcludedTypes}}.size();\ ++ik\ )}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02175}02175\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02176}02176\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(bname.BeginsWith(\mbox{\hyperlink{classMCMCProcessor_aada4aadea10661586b46c1013a9d018f}{ExcludedTypes}}[ik]))}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02177}02177\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02178}02178\ \ \ \ \ \ \ \ \ rejected\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02179}02179\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02180}02180\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02181}02181\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02182}02182\ \ \ \ \ \textcolor{keywordflow}{if}(rejected)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02183}02183\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02184}02184\ \ \ \ \ \textcolor{comment}{//\ Turn\ on\ the\ branches\ which\ we\ want\ for\ parameters}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02185}02185\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchStatus(bname.Data(),\ \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02186}02186\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02187}02187\ \ \ \ \ \textcolor{comment}{//\ If\ we're\ on\ beam\ systematics}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02188}02188\ \ \ \ \ \textcolor{keywordflow}{if}(bname.BeginsWith(\textcolor{stringliteral}{"{}xsec\_"{}}))\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02189}02189\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02190}02190\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}.push\_back(bname);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02191}02191\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}.push\_back(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02192}02192\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]++;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02193}02193\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02194}02194\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (bname.BeginsWith(\textcolor{stringliteral}{"{}ndd\_"{}}))}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02195}02195\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02196}02196\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}.push\_back(bname);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02197}02197\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}.push\_back(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02198}02198\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}]++;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02199}02199\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02200}02200\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (bname.BeginsWith(\textcolor{stringliteral}{"{}skd\_joint\_"{}}))}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02201}02201\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02202}02202\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}.push\_back(bname);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02203}02203\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}.push\_back(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02204}02204\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}]++;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02205}02205\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02206}02206\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (bname.BeginsWith(\textcolor{stringliteral}{"{}sin2th\_"{}})\ \ ||}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02207}02207\ \ \ \ \ \ \ \ \ \ \ \ \ \ bname.BeginsWith(\textcolor{stringliteral}{"{}delm2\_"{}})\ \ \ ||}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02208}02208\ \ \ \ \ \ \ \ \ \ \ \ \ \ bname.BeginsWith(\textcolor{stringliteral}{"{}delta\_"{}})\ \ \ ||}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02209}02209\ \ \ \ \ \ \ \ \ \ \ \ \ \ bname.BeginsWith(\textcolor{stringliteral}{"{}baseline"{}})\ ||}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02210}02210\ \ \ \ \ \ \ \ \ \ \ \ \ \ bname.BeginsWith(\textcolor{stringliteral}{"{}density"{}})\ \ \ )}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02211}02211\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02212}02212\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}.push\_back(bname);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02213}02213\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}.push\_back(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02214}02214\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}]++;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02215}02215\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02216}02216\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02217}02217\ \ \ \ \ \textcolor{comment}{//KS:\ as\ a\ bonus\ get\ LogL\ systematic}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02218}02218\ \ \ \ \ \textcolor{keywordflow}{if}\ (bname.BeginsWith(\textcolor{stringliteral}{"{}LogL\_sample\_"{}}))\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02219}02219\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a3660e404a6631cfa913a815481730a9b}{SampleName\_v}}.push\_back(bname);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02220}02220\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a419d3669dbb54a55a635e35691134cc1}{nSamples}}++;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02221}02221\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02222}02222\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (bname.BeginsWith(\textcolor{stringliteral}{"{}LogL\_systematic\_"{}}))\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02223}02223\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_acb1871575fdd3ae156aed4bf7c7a0a73}{SystName\_v}}.push\_back(bname);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02224}02224\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_adf518be96278f1d3901404cfbe767b67}{nSysts}}++;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02225}02225\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02226}02226\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02227}02227\ \ \ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}\ =\ int(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}.size());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02228}02228\ \ \ \textcolor{comment}{//\ Read\ the\ input\ Covariances}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02229}02229\ \ \ \mbox{\hyperlink{classMCMCProcessor_afef48d4fccf7551dc1845f8f6c08864f}{ReadInputCov}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02230}02230\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02231}02231\ \ \ \textcolor{comment}{//\ Check\ order\ of\ parameter\ types}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02232}02232\ \ \ \mbox{\hyperlink{classMCMCProcessor_a015cf0d6925d026e5bd9d82aa31083b6}{ScanParameterOrder}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02233}02233\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}************************************************"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02234}02234\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Scanning\ output\ branches..."{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02235}02235\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\#\ useful\ entries\ in\ tree:\ \(\backslash\)033[1;32m\ \{\}\ \(\backslash\)033[0m\ "{}},\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02236}02236\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\#\ XSec\ params:\ \ \(\backslash\)033[1;32m\ \{\}\ starting\ at\ \{\}\ \(\backslash\)033[0m\ "{}},\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}},\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02237}02237\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\#\ Flux\ params:\ \ \ \{\}"{}},\ \mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02238}02238\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\#\ ND\ params:\ \ \ \ \(\backslash\)033[1;32m\ \{\}\ starting\ at\ \{\}\ \(\backslash\)033[0m\ "{}},\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}],\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02239}02239\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\#\ FD\ params:\ \ \ \ \(\backslash\)033[1;32m\ \{\}\ starting\ at\ \{\}\ \(\backslash\)033[0m\ "{}},\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}],\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02240}02240\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\#\ Osc\ params:\ \ \ \(\backslash\)033[1;32m\ \{\}\ starting\ at\ \{\}\ \(\backslash\)033[0m\ "{}},\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}],\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02241}02241\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}************************************************"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02242}02242\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02243}02243\ \ \ \mbox{\hyperlink{classMCMCProcessor_aae0016a4e1d105d5d65243438c622a97}{nSteps}}\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMaximum(\textcolor{stringliteral}{"{}step"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02244}02244\ \ \ \textcolor{comment}{//\ Set\ the\ step\ cut\ to\ be\ 20\%}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02245}02245\ \ \ \textcolor{keywordtype}{int}\ cut\ =\ \mbox{\hyperlink{classMCMCProcessor_aae0016a4e1d105d5d65243438c622a97}{nSteps}}/5;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02246}02246\ \ \ \mbox{\hyperlink{classMCMCProcessor_ad610d8e835031872b428e759ef4045f1}{SetStepCut}}(cut);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02247}02247\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02248}02248\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02249}02249\ \textcolor{comment}{//\ ****************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02250}02250\ \textcolor{comment}{//\ Set\ up\ the\ output\ files\ and\ canvases}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02251}\mbox{\hyperlink{classMCMCProcessor_aa4761be1345f1be3defe162b278a9d8e}{02251}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_aa4761be1345f1be3defe162b278a9d8e}{MCMCProcessor::SetupOutput}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02252}02252\ \textcolor{comment}{//\ ****************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02253}02253\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02254}02254\ \ \ \textcolor{comment}{//\ Make\ sure\ we\ can\ read\ files\ located\ anywhere\ and\ strip\ the\ .root\ ending}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02255}02255\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}}\ =\ \mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}}.substr(0,\ \mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}}.find(\textcolor{stringliteral}{"{}.root"{}}));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02256}02256\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02257}02257\ \ \ \textcolor{comment}{//\ Check\ if\ the\ output\ file\ is\ ready}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02258}02258\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_aa5a7761e97cf2e24c7d877a5374b7333}{MakeOutputFile}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02259}02259\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02260}02260\ \ \ \mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}}\ =\ \mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}}\ +\ \mbox{\hyperlink{classMCMCProcessor_aa34b50ce33fb2cb7d9e9ef2d9f2f67c1}{OutputSuffix}}\ +\ \textcolor{stringliteral}{"{}.pdf["{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02261}02261\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02262}02262\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02263}02263\ \ \ \textcolor{comment}{//\ Once\ the\ pdf\ file\ is\ open\ no\ longer\ need\ to\ bracket}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02264}02264\ \ \ \mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}}.ReplaceAll(\textcolor{stringliteral}{"{}["{}},\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02265}02265\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02266}02266\ \ \ \textcolor{comment}{//\ We\ fit\ with\ this\ Gaussian}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02267}02267\ \ \ \mbox{\hyperlink{classMCMCProcessor_a92c1d9b0ebdf90951221cdaf2ac4cc2c}{Gauss}}\ =\ \textcolor{keyword}{new}\ TF1(\textcolor{stringliteral}{"{}gauss"{}},\textcolor{stringliteral}{"{}[0]/sqrt(2.0*3.14159)/[2]*TMath::Exp(-\/0.5*pow(x-\/[1],2)/[2]/[2])"{}},\ -\/5,\ 5);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02268}02268\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02269}02269\ \ \ \textcolor{comment}{//\ Declare\ the\ TVectors}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02270}02270\ \ \ \mbox{\hyperlink{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}{Covariance}}\ =\ \textcolor{keyword}{new}\ TMatrixDSym(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02271}02271\ \ \ \mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}}\ =\ \textcolor{keyword}{new}\ TMatrixDSym(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02272}02272\ \ \ \mbox{\hyperlink{classMCMCProcessor_aad661c6d53f9f891e18ff8ccdbd08479}{Central\_Value}}\ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02273}02273\ \ \ \mbox{\hyperlink{classMCMCProcessor_acaf7f239136dfa3506d095b612323d0a}{Means}}\ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02274}02274\ \ \ \mbox{\hyperlink{classMCMCProcessor_a5174aaa900edf16ddc6e841ea4adae83}{Errors}}\ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02275}02275\ \ \ \mbox{\hyperlink{classMCMCProcessor_a600fc8c39af2750df91fb7a0ff85ac74}{Means\_Gauss}}\ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02276}02276\ \ \ \mbox{\hyperlink{classMCMCProcessor_aa78b7ed1bb9966f84f4eaf8cedf5e688}{Errors\_Gauss}}\ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02277}02277\ \ \ \mbox{\hyperlink{classMCMCProcessor_a32657dc39a7fc0d04804f6195a3d8c3e}{Means\_HPD}}\ \ \ \ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02278}02278\ \ \ \mbox{\hyperlink{classMCMCProcessor_abb5c6ad85c89227bbb9bc5de2eb71272}{Errors\_HPD}}\ \ \ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02279}02279\ \ \ \mbox{\hyperlink{classMCMCProcessor_af96664fa8cc51c49ad1385da07a343b8}{Errors\_HPD\_Positive}}\ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02280}02280\ \ \ \mbox{\hyperlink{classMCMCProcessor_a7b85df39f22390dac24f4d66a89518e5}{Errors\_HPD\_Negative}}\ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02281}02281\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02282}02282\ \ \ \textcolor{comment}{//\ Initialise\ to\ something\ silly}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02283}02283\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02284}02284\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02285}02285\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02286}02286\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02287}02287\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02288}02288\ \ \ \ \ (*Central\_Value)(i)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02289}02289\ \ \ \ \ (*Means)(i)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02290}02290\ \ \ \ \ (*Errors)(i)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02291}02291\ \ \ \ \ (*Means\_Gauss)(i)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02292}02292\ \ \ \ \ (*Errors\_Gauss)(i)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02293}02293\ \ \ \ \ (*Means\_HPD)(i)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02294}02294\ \ \ \ \ (*Errors\_HPD)(i)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02295}02295\ \ \ \ \ (*Errors\_HPD\_Positive)(i)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02296}02296\ \ \ \ \ (*Errors\_HPD\_Negative)(i)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02297}02297\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02298}02298\ \ \ \ \ \ \ (*Covariance)(i,\ j)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02299}02299\ \ \ \ \ \ \ (*Correlation)(i,\ j)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02300}02300\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02301}02301\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02302}02302\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02303}02303\ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}]();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02304}02304\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02305}02305\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02306}02306\ \textcolor{comment}{//\ ****************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02307}02307\ \textcolor{comment}{//\ Check\ order\ of\ parameter\ types}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02308}\mbox{\hyperlink{classMCMCProcessor_a015cf0d6925d026e5bd9d82aa31083b6}{02308}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_a015cf0d6925d026e5bd9d82aa31083b6}{MCMCProcessor::ScanParameterOrder}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02309}02309\ \textcolor{comment}{//\ *****************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02310}02310\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a}{kNParameterEnum}};\ i++)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02311}02311\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02312}02312\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}.size();\ j++)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02313}02313\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02314}02314\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}[j]\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20b}{ParameterEnum}}(i))\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02315}02315\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02316}02316\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ When\ we\ find\ that\ i-\/th\ parameter\ types\ start\ at\ j,\ save\ and\ move\ to\ the\ next\ parameter.}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02317}02317\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[i]\ =\ j;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02318}02318\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02319}02319\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02320}02320\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02321}02321\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02322}02322\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02323}02323\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02324}02324\ \textcolor{comment}{//\ *****************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02325}02325\ \textcolor{comment}{//\ Make\ the\ prefit\ plots}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02326}\mbox{\hyperlink{classMCMCProcessor_a03267ff95cb0f4dab0882db852893768}{02326}}\ TH1D*\ \mbox{\hyperlink{classMCMCProcessor_a03267ff95cb0f4dab0882db852893768}{MCMCProcessor::MakePrefit}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02327}02327\ \textcolor{comment}{//\ *****************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02328}02328\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_aa5a7761e97cf2e24c7d877a5374b7333}{MakeOutputFile}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02329}02329\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02330}02330\ \ \ TH1D\ *PreFitPlot\ =\ \textcolor{keyword}{new}\ TH1D(\textcolor{stringliteral}{"{}Prefit"{}},\ \textcolor{stringliteral}{"{}Prefit"{}},\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02331}02331\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ PreFitPlot-\/>GetNbinsX()\ +\ 1;\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02332}02332\ \ \ \ \ PreFitPlot-\/>SetBinContent(i+1,\ 0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02333}02333\ \ \ \ \ PreFitPlot-\/>SetBinError(i+1,\ 0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02334}02334\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02335}02335\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02336}02336\ \ \ \textcolor{comment}{//KS:\ Slightly\ hacky\ way\ to\ get\ relative\ to\ prior\ or\ nominal\ as\ this\ is\ convention\ we\ use,}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02337}02337\ \ \ \textcolor{comment}{//Only\ applies\ for\ xsec,\ for\ other\ systematic\ it\ make\ no\ difference}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02338}02338\ \ \ \textcolor{keywordtype}{double}\ CentralValueTemp,\ Central,\ Error;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02339}02339\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02340}02340\ \ \ \textcolor{comment}{//\ Set\ labels\ and\ data}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02341}02341\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02342}02342\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02343}02343\ \ \ \ \ \textcolor{comment}{//Those\ keep\ which\ parameter\ type\ we\ run\ currently\ and\ relative\ number}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02344}02344\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamEnum\ =\ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}[i];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02345}02345\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamNo\ =\ i\ -\/\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20b}{ParameterEnum}}(ParamEnum)];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02346}02346\ \ \ \ \ CentralValueTemp\ =\ \mbox{\hyperlink{classMCMCProcessor_a3a6614826ae320e462211e38e96d9d02}{ParamCentral}}[ParamEnum][ParamNo];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02347}02347\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_afbac2a114c15ca7db4abe71dd549504c}{plotRelativeToPrior}})\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02348}02348\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02349}02349\ \ \ \ \ \ \ \textcolor{comment}{//\ Normalise\ the\ prior\ relative\ the\ nominal/prior,\ just\ the\ way\ we\ get\ our\ fit\ results\ in\ MaCh3}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02350}02350\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ CentralValueTemp\ !=\ 0)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02351}02351\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02352}02352\ \ \ \ \ \ \ \ \ Central\ =\ \mbox{\hyperlink{classMCMCProcessor_a3a6614826ae320e462211e38e96d9d02}{ParamCentral}}[ParamEnum][ParamNo]\ /\ CentralValueTemp;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02353}02353\ \ \ \ \ \ \ \ \ Error\ =\ \mbox{\hyperlink{classMCMCProcessor_a3a97e3cb4be3ceb9eb721eac51d82d60}{ParamErrors}}[ParamEnum][ParamNo]/CentralValueTemp;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02354}02354\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02355}02355\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02356}02356\ \ \ \ \ \ \ \ \ Central\ =\ CentralValueTemp\ +\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02357}02357\ \ \ \ \ \ \ \ \ Error\ =\ \mbox{\hyperlink{classMCMCProcessor_a3a97e3cb4be3ceb9eb721eac51d82d60}{ParamErrors}}[ParamEnum][ParamNo];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02358}02358\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02359}02359\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02360}02360\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02361}02361\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02362}02362\ \ \ \ \ \ \ Central\ =\ CentralValueTemp;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02363}02363\ \ \ \ \ \ \ Error\ =\ \mbox{\hyperlink{classMCMCProcessor_a3a97e3cb4be3ceb9eb721eac51d82d60}{ParamErrors}}[ParamEnum][ParamNo];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02364}02364\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02365}02365\ \ \ \ \ \textcolor{comment}{//KS:\ If\ plotting\ error\ for\ param\ with\ flat\ prior\ is\ turned\ off\ and\ given\ param\ really\ has\ flat\ prior\ set\ error\ to\ 0}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02366}02366\ \ \ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{classMCMCProcessor_ad24411a2556504c440ff0af045e8e7aa}{PlotFlatPrior}}\ \&\&\ \mbox{\hyperlink{classMCMCProcessor_a4be1eedb743e4ea410009a4fa45720f7}{ParamFlat}}[ParamEnum][ParamNo])}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02367}02367\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02368}02368\ \ \ \ \ \ \ Error\ =\ 0.;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02369}02369\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02370}02370\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02371}02371\ \ \ \ \ PreFitPlot-\/>SetBinContent(i+1,\ Central);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02372}02372\ \ \ \ \ PreFitPlot-\/>SetBinError(i+1,\ Error);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02373}02373\ \ \ \ \ PreFitPlot-\/>GetXaxis()-\/>SetBinLabel(i+1,\ \mbox{\hyperlink{classMCMCProcessor_adecc55689f7d37b9412f8886fe3480dc}{ParamNames}}[ParamEnum][ParamNo]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02374}02374\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02375}02375\ \ \ PreFitPlot-\/>SetDirectory(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02376}02376\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02377}02377\ \ \ PreFitPlot-\/>SetFillStyle(1001);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02378}02378\ \ \ PreFitPlot-\/>SetFillColor(kRed-\/3);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02379}02379\ \ \ PreFitPlot-\/>SetMarkerStyle(21);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02380}02380\ \ \ PreFitPlot-\/>SetMarkerSize(2.4);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02381}02381\ \ \ PreFitPlot-\/>SetMarkerColor(kWhite);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02382}02382\ \ \ PreFitPlot-\/>SetLineColor(PreFitPlot-\/>GetFillColor());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02383}02383\ \ \ PreFitPlot-\/>GetXaxis()-\/>LabelsOption(\textcolor{stringliteral}{"{}v"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02384}02384\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02385}02385\ \ \ \textcolor{keywordflow}{return}\ PreFitPlot;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02386}02386\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02387}02387\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02388}02388\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02389}02389\ \textcolor{comment}{//CW:\ Read\ the\ input\ Covariance\ matrix\ entries}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02390}02390\ \textcolor{comment}{//\ Get\ stuff\ like\ parameter\ input\ errors,\ names,\ and\ so\ on}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02391}\mbox{\hyperlink{classMCMCProcessor_afef48d4fccf7551dc1845f8f6c08864f}{02391}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_afef48d4fccf7551dc1845f8f6c08864f}{MCMCProcessor::ReadInputCov}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02392}02392\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02393}02393\ \ \ \mbox{\hyperlink{classMCMCProcessor_aea15e730ff77556bb93bc4cff675744c}{FindInputFiles}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02394}02394\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]\ >\ 0)\ \ \mbox{\hyperlink{classMCMCProcessor_a2b0b4afbf45adb93357abe96d108170b}{ReadXSecFile}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02395}02395\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}]\ >\ 0)\ \mbox{\hyperlink{classMCMCProcessor_a66dd0f1f88dbeb2b6a1976d42f77e136}{ReadNDFile}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02396}02396\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}]\ >\ 0)\ \mbox{\hyperlink{classMCMCProcessor_ae5ea421c8dd77ceac2e748008633b573}{ReadFDFile}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02397}02397\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}]\ >\ 0)\ \ \ \mbox{\hyperlink{classMCMCProcessor_a3733b3b753c73f79e6846bc92c4da11b}{ReadOSCFile}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02398}02398\ \ \ \textcolor{comment}{//KS:\ Remove\ parameters\ which\ were\ removed}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02399}02399\ \ \ \mbox{\hyperlink{classMCMCProcessor_a9a29c1cb64589ac136f7f927cafa18aa}{RemoveParameters}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02400}02400\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02401}02401\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02402}02402\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02403}02403\ \textcolor{comment}{//\ Read\ the\ output\ MCMC\ file\ and\ find\ what\ inputs\ were\ used}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02404}\mbox{\hyperlink{classMCMCProcessor_aea15e730ff77556bb93bc4cff675744c}{02404}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_aea15e730ff77556bb93bc4cff675744c}{MCMCProcessor::FindInputFiles}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02405}02405\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02406}02406\ \ \ \textcolor{comment}{//\ Now\ read\ the\ MCMC\ file}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02407}02407\ \ \ TFile\ *TempFile\ =\ \textcolor{keyword}{new}\ TFile(\mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}}.c\_str(),\ \textcolor{stringliteral}{"{}open"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02408}02408\ \ \ TDirectory*\ CovarianceFolder\ =\ TempFile-\/>Get<TDirectory>(\textcolor{stringliteral}{"{}CovarianceFolder"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02409}02409\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02410}02410\ \ \ \textcolor{comment}{//\ Get\ the\ settings\ for\ the\ MCMC}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02411}02411\ \ \ TMacro\ *Config\ =\ TempFile-\/>Get<TMacro>(\textcolor{stringliteral}{"{}MaCh3\_Config"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02412}02412\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02413}02413\ \ \ \textcolor{keywordflow}{if}\ (Config\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02414}02414\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Didn't\ find\ MaCh3\_Config\ tree\ in\ MCMC\ file!\ \{\}"{}},\ \mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02415}02415\ \ \ \ \ TempFile-\/>ls();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02416}02416\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02417}02417\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02418}02418\ \ \ \textcolor{comment}{//KS:Most\ inputs\ are\ in\ \$\{MACH3\}/inputs/blarb.root}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02419}02419\ \ \ \textcolor{keywordflow}{if}\ (std::getenv(\textcolor{stringliteral}{"{}MACH3"{}})\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02420}02420\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Found\ MACH3\ environment\ variable:\ \{\}"{}},\ std::getenv(\textcolor{stringliteral}{"{}MACH3"{}}));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02421}02421\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02422}02422\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02423}02423\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Loading\ YAML\ config\ from\ MCMC\ chain"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02424}02424\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02425}02425\ \ \ YAML::Node\ Settings\ =\ \mbox{\hyperlink{YamlHelper_8h_a7e0ade2fd295a927676c243c97d0aa64}{TMacroToYAML}}(*Config);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02426}02426\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02427}02427\ \ \ \textcolor{keywordtype}{bool}\ InputNotFound\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02428}02428\ \ \ \textcolor{comment}{//CW:\ Get\ the\ xsec\ Covariance\ matrix}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02429}02429\ \ \ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]\ =\ GetFromManager<std::vector<std::string>>(Settings[\textcolor{stringliteral}{"{}General"{}}][\textcolor{stringliteral}{"{}Systematics"{}}][\textcolor{stringliteral}{"{}XsecCovFile"{}}],\ \{\textcolor{stringliteral}{"{}none"{}}\});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02430}02430\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}].back()\ ==\ \textcolor{stringliteral}{"{}none"{}})}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02431}02431\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02432}02432\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Couldn't\ find\ XsecCov\ branch\ in\ output"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02433}02433\ \ \ \ \ InputNotFound\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02434}02434\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02435}02435\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02436}02436\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02437}02437\ \ \ TMacro\ *XsecConfig\ =\ CovarianceFolder-\/>Get<TMacro>(\textcolor{stringliteral}{"{}Config\_xsec\_cov"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02438}02438\ \ \ \textcolor{keywordflow}{if}\ (XsecConfig\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02439}02439\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Didn't\ find\ Config\_xsec\_cov\ tree\ in\ MCMC\ file!\ \{\}"{}},\ \mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02440}02440\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02441}02441\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4c1330a025c0b91e382bdc29c960424a}{CovConfig}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]\ =\ \mbox{\hyperlink{YamlHelper_8h_a7e0ade2fd295a927676c243c97d0aa64}{TMacroToYAML}}(*XsecConfig);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02442}02442\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02443}02443\ \ \ \textcolor{comment}{//CW:\ And\ the\ ND\ Covariance\ matrix}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02444}02444\ \ \ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}].push\_back(GetFromManager<std::string>(Settings[\textcolor{stringliteral}{"{}General"{}}][\textcolor{stringliteral}{"{}Systematics"{}}][\textcolor{stringliteral}{"{}NDCovFile"{}}],\ \textcolor{stringliteral}{"{}none"{}}));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02445}02445\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}].back()\ ==\ \textcolor{stringliteral}{"{}none"{}})\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02446}02446\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Couldn't\ find\ NDCov\ branch\ in\ output"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02447}02447\ \ \ \ \ InputNotFound\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02448}02448\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02449}02449\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02450}02450\ \ \ \textcolor{comment}{//CW:\ And\ the\ FD\ Covariance\ matrix}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02451}02451\ \ \ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}].push\_back(GetFromManager<std::string>(Settings[\textcolor{stringliteral}{"{}General"{}}][\textcolor{stringliteral}{"{}Systematics"{}}][\textcolor{stringliteral}{"{}FDCovFile"{}}],\ \textcolor{stringliteral}{"{}none"{}}));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02452}02452\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}].back()\ ==\ \textcolor{stringliteral}{"{}none"{}})\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02453}02453\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Couldn't\ find\ FDCov\ branch\ in\ output"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02454}02454\ \ \ \ \ InputNotFound\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02455}02455\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02456}02456\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02457}02457\ \ \ \textcolor{comment}{//CW:\ And\ the\ Osc\ Covariance\ matrix}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02458}02458\ \ \ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}]\ =\ GetFromManager<std::vector<std::string>>(Settings[\textcolor{stringliteral}{"{}General"{}}][\textcolor{stringliteral}{"{}Systematics"{}}][\textcolor{stringliteral}{"{}OscCovFile"{}}],\ \{\textcolor{stringliteral}{"{}none"{}}\});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02459}02459\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}].back()\ ==\ \textcolor{stringliteral}{"{}none"{}})\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02460}02460\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Couldn't\ find\ OscCov\ branch\ in\ output"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02461}02461\ \ \ \ \ InputNotFound\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02462}02462\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02463}02463\ \ \ TMacro\ *OscConfig\ =\ CovarianceFolder-\/>Get<TMacro>(\textcolor{stringliteral}{"{}Config\_osc\_cov"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02464}02464\ \ \ \textcolor{keywordflow}{if}\ (OscConfig\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02465}02465\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Didn't\ find\ Config\_osc\_cov\ tree\ in\ MCMC\ file!\ \{\}"{}},\ \mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02466}02466\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02467}02467\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4c1330a025c0b91e382bdc29c960424a}{CovConfig}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}]\ =\ \ \mbox{\hyperlink{YamlHelper_8h_a7e0ade2fd295a927676c243c97d0aa64}{TMacroToYAML}}(*OscConfig);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02468}02468\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02469}02469\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02470}02470\ \ \ \textcolor{keywordflow}{if}(InputNotFound)\ \mbox{\hyperlink{namespaceMaCh3Utils_aaf39f873ebf93550a417418e583ebcf8}{MaCh3Utils::PrintConfig}}(Settings);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02471}02471\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02472}02472\ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\ mach3\_env\ =\ std::getenv(\textcolor{stringliteral}{"{}MACH3"{}}))}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02473}02473\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02474}02474\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}].size();\ i++)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02475}02475\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}][i].insert(0,\ std::string(mach3\_env)+\textcolor{stringliteral}{"{}/"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02476}02476\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02477}02477\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}].size();\ i++)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02478}02478\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}][i].insert(0,\ std::string(mach3\_env)+\textcolor{stringliteral}{"{}/"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02479}02479\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02480}02480\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}].size();\ i++)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02481}02481\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}][i].insert(0,\ std::string(mach3\_env)+\textcolor{stringliteral}{"{}/"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02482}02482\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02483}02483\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}].size();\ i++)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02484}02484\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}][i].insert(0,\ std::string(mach3\_env)+\textcolor{stringliteral}{"{}/"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02485}02485\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02486}02486\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02487}02487\ \ \ \textcolor{comment}{//\ Delete\ the\ TTrees\ and\ the\ input\ file\ handle\ since\ we've\ now\ got\ the\ settings\ we\ need}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02488}02488\ \ \ \textcolor{keyword}{delete}\ Config;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02489}02489\ \ \ \textcolor{keyword}{delete}\ XsecConfig;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02490}02490\ \ \ \textcolor{keyword}{delete}\ OscConfig;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02491}02491\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02492}02492\ \ \ \textcolor{comment}{//\ Delete\ the\ MCMCFile\ pointer\ we're\ reading}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02493}02493\ \ \ CovarianceFolder-\/>Close();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02494}02494\ \ \ \textcolor{keyword}{delete}\ CovarianceFolder;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02495}02495\ \ \ TempFile-\/>Close();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02496}02496\ \ \ \textcolor{keyword}{delete}\ TempFile;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02497}02497\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02498}02498\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02499}02499\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02500}02500\ \textcolor{comment}{//\ Read\ the\ xsec\ file\ and\ get\ the\ input\ central\ values\ and\ errors}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02501}\mbox{\hyperlink{classMCMCProcessor_a2b0b4afbf45adb93357abe96d108170b}{02501}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_a2b0b4afbf45adb93357abe96d108170b}{MCMCProcessor::ReadXSecFile}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02502}02502\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02503}02503\ \ \ YAML::Node\ XSecFile\ =\ \mbox{\hyperlink{classMCMCProcessor_a4c1330a025c0b91e382bdc29c960424a}{CovConfig}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02504}02504\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02505}02505\ \ \ \textcolor{keyword}{auto}\ systematics\ =\ XSecFile[\textcolor{stringliteral}{"{}Systematics"{}}];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02506}02506\ \ \ \textcolor{keywordtype}{int}\ i\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02507}02507\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ it\ =\ systematics.begin();\ it\ !=\ systematics.end();\ ++it,\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02508}02508\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02509}02509\ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}\ \&param\ =\ *it;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02510}02510\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02511}02511\ \ \ \ \ \textcolor{comment}{//\ Push\ back\ the\ name}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02512}02512\ \ \ \ \ std::string\ TempString\ =\ (param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}Names"{}}][\textcolor{stringliteral}{"{}FancyName"{}}].as<std::string>());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02513}02513\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02514}02514\ \ \ \ \ \textcolor{comment}{//KS:Reject\ particular\ parameter\ names,\ noticed\ that\ sometimes\ string\ comparison\ doesn't\ work\ becasue\ of\ some\ weird\ casting\ of\ TObjString\ into\ std::string.\ This\ is\ rare\ and\ sooner\ or\ later\ we\ move\ away\ from\ TObjString\ so\ this\ is\ fine}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02515}02515\ \ \ \ \ \textcolor{keywordtype}{bool}\ rejected\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02516}02516\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ik\ =\ 0;\ ik\ <\ \mbox{\hyperlink{classMCMCProcessor_a7425f7802e50bcb5ff4b38e20157c423}{ExcludedNames}}.size();\ ++ik)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02517}02517\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02518}02518\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (TempString.rfind(\mbox{\hyperlink{classMCMCProcessor_a7425f7802e50bcb5ff4b38e20157c423}{ExcludedNames}}.at(ik),\ 0)\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02519}02519\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02520}02520\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ Tracker\ =\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]\ +\ i;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02521}02521\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[Tracker]\ =\ \textcolor{stringliteral}{"{}delete"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02522}02522\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]-\/-\/;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02523}02523\ \ \ \ \ \ \ \ \ rejected\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02524}02524\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02525}02525\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02526}02526\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02527}02527\ \ \ \ \ \textcolor{keywordflow}{if}(rejected)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02528}02528\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_adecc55689f7d37b9412f8886fe3480dc}{ParamNames}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}].push\_back(TempString);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02529}02529\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_adecc55689f7d37b9412f8886fe3480dc}{ParamNames}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}][i].BeginsWith(\textcolor{stringliteral}{"{}b\_"{}}))}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02530}02530\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02531}02531\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a2c06d64020e9246e720cc131a9f4986d}{IsXsec}}.push\_back(\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02532}02532\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}}++;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02533}02533\ \ \ \ \ \}\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02534}02534\ \ \ \ \ \textcolor{keywordflow}{else}\ \mbox{\hyperlink{classMCMCProcessor_a2c06d64020e9246e720cc131a9f4986d}{IsXsec}}.push\_back(\textcolor{keyword}{true});\ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02535}02535\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02536}02536\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a3a6614826ae320e462211e38e96d9d02}{ParamCentral}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}].push\_back(\ param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}ParameterValues"{}}][\textcolor{stringliteral}{"{}PreFitValue"{}}].as<double>()\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02537}02537\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4c4c6aa4827a2fe54ce37defbb3d0475}{ParamNom}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}].push\_back(\ param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}ParameterValues"{}}][\textcolor{stringliteral}{"{}Generated"{}}].as<double>()\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02538}02538\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a3a97e3cb4be3ceb9eb721eac51d82d60}{ParamErrors}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}].push\_back(\ param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}Error"{}}].as<double>()\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02539}02539\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02540}02540\ \ \ \ \ \textcolor{keywordtype}{bool}\ flat\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02541}02541\ \ \ \ \ \textcolor{keywordflow}{if}\ (param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}FlatPrior"{}}])\ \{\ flat\ =\ param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}FlatPrior"{}}].as<\textcolor{keywordtype}{bool}>();\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02542}02542\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4be1eedb743e4ea410009a4fa45720f7}{ParamFlat}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}].push\_back(\ flat\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02543}02543\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02544}02544\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02545}02545\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02546}02546\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02547}02547\ \textcolor{comment}{//\ Read\ the\ ND\ cov\ file\ and\ get\ the\ input\ central\ values\ and\ errors}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02548}\mbox{\hyperlink{classMCMCProcessor_a66dd0f1f88dbeb2b6a1976d42f77e136}{02548}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_a66dd0f1f88dbeb2b6a1976d42f77e136}{MCMCProcessor::ReadNDFile}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02549}02549\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02550}02550\ \ \ \textcolor{comment}{//\ Do\ the\ same\ for\ the\ ND280}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02551}02551\ \ \ TFile\ *NDdetFile\ =\ \textcolor{keyword}{new}\ TFile(\mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}].back().c\_str(),\ \textcolor{stringliteral}{"{}open"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02552}02552\ \ \ \textcolor{keywordflow}{if}\ (NDdetFile-\/>IsZombie())\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02553}02553\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Couldn't\ find\ NDdetFile\ \{\}"{}},\ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}].back());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02554}02554\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02555}02555\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02556}02556\ \ \ NDdetFile-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02557}02557\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02558}02558\ \ \ TMatrixDSym\ *NDdetMatrix\ =\ NDdetFile-\/>Get<TMatrixDSym>(\textcolor{stringliteral}{"{}nddet\_cov"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02559}02559\ \ \ TVectorD\ *NDdetNominal\ =\ NDdetFile-\/>Get<TVectorD>(\textcolor{stringliteral}{"{}det\_weights"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02560}02560\ \ \ TDirectory\ *BinningDirectory\ =\ NDdetFile-\/>Get<TDirectory>(\textcolor{stringliteral}{"{}Binning"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02561}02561\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02562}02562\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ NDdetNominal-\/>GetNrows();\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02563}02563\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02564}02564\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4c4c6aa4827a2fe54ce37defbb3d0475}{ParamNom}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}].push\_back(\ (*NDdetNominal)(i)\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02565}02565\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a3a6614826ae320e462211e38e96d9d02}{ParamCentral}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}].push\_back(\ (*NDdetNominal)(i)\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02566}02566\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02567}02567\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a3a97e3cb4be3ceb9eb721eac51d82d60}{ParamErrors}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}].push\_back(\ std::sqrt((*NDdetMatrix)(i,i))\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02568}02568\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_adecc55689f7d37b9412f8886fe3480dc}{ParamNames}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}].push\_back(\ Form(\textcolor{stringliteral}{"{}ND\ Det\ \%i"{}},\ i)\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02569}02569\ \ \ \ \ \textcolor{comment}{//KS:\ Currently\ we\ can\ only\ set\ it\ via\ config,\ change\ it\ in\ future}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02570}02570\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4be1eedb743e4ea410009a4fa45720f7}{ParamFlat}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}].push\_back(\ \textcolor{keyword}{false}\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02571}02571\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02572}02572\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02573}02573\ \ \ TIter\ next(BinningDirectory-\/>GetListOfKeys());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02574}02574\ \ \ TKey\ *key\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02575}02575\ \ \ \textcolor{comment}{//\ Loop\ through\ all\ entries}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02576}02576\ \ \ \textcolor{keywordflow}{while}\ ((key\ =\ \textcolor{keyword}{static\_cast<}TKey*\textcolor{keyword}{>}(next())))}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02577}02577\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02578}02578\ \ \ \ \ std::string\ name\ =\ std::string(key-\/>GetName());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02579}02579\ \ \ \ \ TH2Poly*\ RefPoly\ =\ BinningDirectory-\/>Get<TH2Poly>((name).c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02580}02580\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}}\ =\ RefPoly-\/>GetNumberOfBins();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02581}02581\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ae76b02ce85737d30c778698ba127933b}{NDSamplesBins}}.push\_back(\mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02582}02582\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a27c8a25155baab660fc9658861c433ab}{NDSamplesNames}}.push\_back(RefPoly-\/>GetTitle());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02583}02583\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02584}02584\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02585}02585\ \ \ NDdetFile-\/>Close();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02586}02586\ \ \ \textcolor{keyword}{delete}\ NDdetFile;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02587}02587\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02588}02588\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02589}02589\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02590}02590\ \textcolor{comment}{//\ Read\ the\ FD\ cov\ file\ and\ get\ the\ input\ central\ values\ and\ errors}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02591}\mbox{\hyperlink{classMCMCProcessor_ae5ea421c8dd77ceac2e748008633b573}{02591}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_ae5ea421c8dd77ceac2e748008633b573}{MCMCProcessor::ReadFDFile}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02592}02592\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02593}02593\ \ \ \textcolor{comment}{//\ Do\ the\ same\ for\ the\ FD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02594}02594\ \ \ TFile\ *FDdetFile\ =\ \textcolor{keyword}{new}\ TFile(\mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}].back().c\_str(),\ \textcolor{stringliteral}{"{}open"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02595}02595\ \ \ \textcolor{keywordflow}{if}\ (FDdetFile-\/>IsZombie())\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02596}02596\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Couldn't\ find\ NDdetFile\ \{\}"{}},\ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}].back());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02597}02597\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02598}02598\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02599}02599\ \ \ FDdetFile-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02600}02600\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02601}02601\ \ \ TMatrixDSym\ *FDdetMatrix\ =\ FDdetFile-\/>Get<TMatrixDSym>(\textcolor{stringliteral}{"{}SKJointError\_Erec\_Total"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02602}02602\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02603}02603\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ FDdetMatrix-\/>GetNrows();\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02604}02604\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02605}02605\ \ \ \ \ \textcolor{comment}{//KS:\ FD\ parameters\ start\ at\ 1.\ in\ contrary\ to\ ND280}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02606}02606\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4c4c6aa4827a2fe54ce37defbb3d0475}{ParamNom}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}].push\_back(1.);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02607}02607\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a3a6614826ae320e462211e38e96d9d02}{ParamCentral}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}].push\_back(1.);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02608}02608\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02609}02609\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a3a97e3cb4be3ceb9eb721eac51d82d60}{ParamErrors}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}].push\_back(\ std::sqrt((*FDdetMatrix)(i,i))\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02610}02610\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_adecc55689f7d37b9412f8886fe3480dc}{ParamNames}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}].push\_back(\ Form(\textcolor{stringliteral}{"{}FD\ Det\ \%i"{}},\ i)\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02611}02611\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02612}02612\ \ \ \ \ \textcolor{comment}{//KS:\ Currently\ we\ can\ only\ set\ it\ via\ config,\ change\ it\ in\ future}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02613}02613\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4be1eedb743e4ea410009a4fa45720f7}{ParamFlat}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}].push\_back(\ \textcolor{keyword}{false}\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02614}02614\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02615}02615\ \ \ \textcolor{comment}{//KS:\ The\ last\ parameter\ is\ p\ scale}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02616}02616\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad25fe818c94163b0c4a8fcdfd387c148}{FancyPlotNames}})\ \mbox{\hyperlink{classMCMCProcessor_adecc55689f7d37b9412f8886fe3480dc}{ParamNames}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}].back()\ =\ \textcolor{stringliteral}{"{}Momentum\ Scale"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02617}02617\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02618}02618\ \ \ FDdetFile-\/>Close();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02619}02619\ \ \ \textcolor{keyword}{delete}\ FDdetFile;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02620}02620\ \ \ \textcolor{keyword}{delete}\ FDdetMatrix;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02621}02621\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02622}02622\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02623}02623\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02624}02624\ \textcolor{comment}{//\ Read\ the\ Osc\ cov\ file\ and\ get\ the\ input\ central\ values\ and\ errors}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02625}\mbox{\hyperlink{classMCMCProcessor_a3733b3b753c73f79e6846bc92c4da11b}{02625}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_a3733b3b753c73f79e6846bc92c4da11b}{MCMCProcessor::ReadOSCFile}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02626}02626\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02627}02627\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02628}02628\ \ \ YAML::Node\ OscFile\ =\ \mbox{\hyperlink{classMCMCProcessor_a4c1330a025c0b91e382bdc29c960424a}{CovConfig}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}];;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02629}02629\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02630}02630\ \ \ \textcolor{keyword}{auto}\ systematics\ =\ OscFile[\textcolor{stringliteral}{"{}Systematics"{}}];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02631}02631\ \ \ \textcolor{keywordtype}{int}\ i\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02632}02632\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ it\ =\ systematics.begin();\ it\ !=\ systematics.end();\ ++it,\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02633}02633\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02634}02634\ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}\ \&param\ =\ *it;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02635}02635\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02636}02636\ \ \ \ \ \textcolor{comment}{//\ Push\ back\ the\ name}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02637}02637\ \ \ \ \ std::string\ TempString\ =\ (param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}Names"{}}][\textcolor{stringliteral}{"{}FancyName"{}}].as<std::string>());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02638}02638\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02639}02639\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_adecc55689f7d37b9412f8886fe3480dc}{ParamNames}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}].push\_back(TempString);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02640}02640\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02641}02641\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a3a6614826ae320e462211e38e96d9d02}{ParamCentral}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}].push\_back(\ param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}ParameterValues"{}}][\textcolor{stringliteral}{"{}PreFitValue"{}}].as<double>()\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02642}02642\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4c4c6aa4827a2fe54ce37defbb3d0475}{ParamNom}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}].push\_back(\ param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}ParameterValues"{}}][\textcolor{stringliteral}{"{}Generated"{}}].as<double>()\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02643}02643\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a3a97e3cb4be3ceb9eb721eac51d82d60}{ParamErrors}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}].push\_back(\ param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}Error"{}}].as<double>()\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02644}02644\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02645}02645\ \ \ \ \ \textcolor{keywordtype}{bool}\ flat\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02646}02646\ \ \ \ \ \textcolor{keywordflow}{if}\ (param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}FlatPrior"{}}])\ \{\ flat\ =\ param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}FlatPrior"{}}].as<\textcolor{keywordtype}{bool}>();\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02647}02647\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4be1eedb743e4ea410009a4fa45720f7}{ParamFlat}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}].push\_back(\ flat\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02648}02648\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02649}02649\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_af1392c6cff68e9f0a27e2c9a4e52cf4c}{PlotJarlskog}})}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02650}02650\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02651}02651\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetAlias(\textcolor{stringliteral}{"{}J\_cp"{}},\ \textcolor{stringliteral}{"{}TMath::Sqrt(sin2th\_13)*TMath::Sqrt(1.-\/sin2th\_13)*TMath::Sqrt(1.-\/sin2th\_13)*TMath::Sqrt(sin2th\_12)*TMath::Sqrt(1.-\/sin2th\_12)*TMath::Sqrt(sin2th\_23)*TMath::Sqrt(1.-\/sin2th\_23)*TMath::Sin(delta\_cp)"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02652}02652\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}.push\_back(\textcolor{stringliteral}{"{}J\_cp"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02653}02653\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}.push\_back(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02654}02654\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}]++;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02655}02655\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}++;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02656}02656\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02658}02658\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4c4c6aa4827a2fe54ce37defbb3d0475}{ParamNom}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}].push\_back(\ 0.\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02659}02659\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a3a6614826ae320e462211e38e96d9d02}{ParamCentral}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}].push\_back(\ 0.\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02660}02660\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a3a97e3cb4be3ceb9eb721eac51d82d60}{ParamErrors}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}].push\_back(\ 1.\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02661}02661\ \ \ \ \ \textcolor{comment}{//\ Push\ back\ the\ name}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02662}02662\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_adecc55689f7d37b9412f8886fe3480dc}{ParamNames}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}].push\_back(\textcolor{stringliteral}{"{}J\_cp"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02663}02663\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4be1eedb743e4ea410009a4fa45720f7}{ParamFlat}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}].push\_back(\ \textcolor{keyword}{false}\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02664}02664\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02665}02665\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02666}02666\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02667}02667\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02668}02668\ \textcolor{comment}{//This\ is\ bit\ messy\ as\ currently\ BranchNames\ is\ taken\ from\ actual\ Chain.root\ file\ while\ proper\ parameter\ name\ from\ matrix.root\ and\ right\ now\ we\ don't\ access\ them\ at\ the\ same\ time.}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02669}\mbox{\hyperlink{classMCMCProcessor_a9a29c1cb64589ac136f7f927cafa18aa}{02669}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_a9a29c1cb64589ac136f7f927cafa18aa}{MCMCProcessor::RemoveParameters}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02670}02670\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02671}02671\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ i++)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02672}02672\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02673}02673\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i]\ ==\ \textcolor{stringliteral}{"{}delete"{}})}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02674}02674\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02675}02675\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}.erase(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}.begin()\ +\ i);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02676}02676\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}.erase(\mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}.begin()\ +\ i);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02677}02677\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}-\/-\/;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02678}02678\ \ \ \ \ \ \ i\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02679}02679\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02680}02680\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02681}02681\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02682}02682\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02683}02683\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02684}02684\ \textcolor{comment}{//\ Make\ the\ step\ cut\ from\ a\ string}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02685}\mbox{\hyperlink{classMCMCProcessor_ad610d8e835031872b428e759ef4045f1}{02685}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_ad610d8e835031872b428e759ef4045f1}{MCMCProcessor::SetStepCut}}(\textcolor{keyword}{const}\ std::string\&\ Cuts)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02686}02686\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02687}02687\ \ \ \mbox{\hyperlink{classMCMCProcessor_a576f0eb874afaf7e31ff5c86b9e5b8f9}{StepCut}}\ =\ Cuts;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02688}02688\ \ \ \mbox{\hyperlink{classMCMCProcessor_a22f82dadceccbe87dd8c5b7daa8432e8}{BurnInCut}}\ =\ std::stoi(\ Cuts\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02689}02689\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02690}02690\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02691}02691\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02692}02692\ \textcolor{comment}{//\ Make\ the\ step\ cut\ from\ an\ int}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02693}\mbox{\hyperlink{classMCMCProcessor_a16f653dcb6358f2a8e393e3946a7e6d2}{02693}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_ad610d8e835031872b428e759ef4045f1}{MCMCProcessor::SetStepCut}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ Cuts)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02694}02694\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02695}02695\ \ \ std::stringstream\ TempStream;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02696}02696\ \ \ TempStream\ <<\ \textcolor{stringliteral}{"{}step\ >\ "{}}\ <<\ Cuts;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02697}02697\ \ \ \mbox{\hyperlink{classMCMCProcessor_a576f0eb874afaf7e31ff5c86b9e5b8f9}{StepCut}}\ =\ TempStream.str();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02698}02698\ \ \ \mbox{\hyperlink{classMCMCProcessor_a22f82dadceccbe87dd8c5b7daa8432e8}{BurnInCut}}\ =\ Cuts;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02699}02699\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02700}02700\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02701}02701\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02702}02702\ \textcolor{comment}{//\ Pass\ central\ value}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02703}\mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{02703}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{MCMCProcessor::GetNthParameter}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ param,\ \textcolor{keywordtype}{double}\ \&Prior,\ \textcolor{keywordtype}{double}\ \&PriorError,\ TString\ \&Title)\{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02704}02704\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02705}02705\ \ \ \mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20b}{ParameterEnum}}\ ParType\ =\ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}[param];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02706}02706\ \ \ \textcolor{keywordtype}{int}\ ParamNo\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02707}02707\ \ \ ParamNo\ =\ param\ -\/\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[ParType];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02708}02708\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02709}02709\ \ \ Prior\ =\ \mbox{\hyperlink{classMCMCProcessor_a3a6614826ae320e462211e38e96d9d02}{ParamCentral}}[ParType][ParamNo];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02710}02710\ \ \ PriorError\ =\ \mbox{\hyperlink{classMCMCProcessor_a3a97e3cb4be3ceb9eb721eac51d82d60}{ParamErrors}}[ParType][ParamNo];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02711}02711\ \ \ Title\ =\ \mbox{\hyperlink{classMCMCProcessor_adecc55689f7d37b9412f8886fe3480dc}{ParamNames}}[ParType][ParamNo];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02712}02712\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02713}02713\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02714}02714\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02715}02715\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02716}02716\ \textcolor{comment}{//\ Find\ Param\ Index\ based\ on\ name}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02717}\mbox{\hyperlink{classMCMCProcessor_a5ab91183fbbf23fff759fefc9954a1a5}{02717}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classMCMCProcessor_a5ab91183fbbf23fff759fefc9954a1a5}{MCMCProcessor::GetParamIndexFromName}}(\textcolor{keyword}{const}\ std::string\&\ Name)\{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02718}02718\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02719}02719\ \ \ \textcolor{keywordtype}{int}\ ParamNo\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02720}02720\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02721}02721\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02722}02722\ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02723}02723\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02724}02724\ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02725}02725\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02726}02726\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(i,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02727}02727\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02728}02728\ \ \ \ \ \textcolor{keywordflow}{if}(Name\ ==\ Title)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02729}02729\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02730}02730\ \ \ \ \ \ \ ParamNo\ =\ i;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02731}02731\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02732}02732\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02733}02733\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02734}02734\ \ \ \textcolor{keywordflow}{return}\ ParamNo;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02735}02735\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02736}02736\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02737}02737\ \textcolor{comment}{//\ **************************************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02738}02738\ \textcolor{comment}{//\ Helper\ function\ to\ reset\ histograms}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02739}\mbox{\hyperlink{classMCMCProcessor_a36441ec3d5b0e24e48040282ffcda3eb}{02739}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_a36441ec3d5b0e24e48040282ffcda3eb}{MCMCProcessor::ResetHistograms}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02740}02740\ \textcolor{comment}{//\ **************************************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02741}02741\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02742}02742\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02743}02743\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02744}02744\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02745}02745\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02746}02746\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02747}02747\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02748}02748\ \ \ \ \ \ \ \textcolor{comment}{//\ TH2D\ to\ hold\ the\ Correlation\ }}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02749}02749\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>Reset(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02750}02750\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>Fill(0.0,\ 0.0,\ 0.0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02751}02751\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02752}02752\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02753}02753\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02754}02754\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02755}02755\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02756}02756\ \textcolor{comment}{//\ KS:\ Get\ Super\ Fancy\ Polar\ Plot}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02757}\mbox{\hyperlink{classMCMCProcessor_ac358c3ffe7c060e8872c762259973c6b}{02757}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_ac358c3ffe7c060e8872c762259973c6b}{MCMCProcessor::GetPolarPlot}}(\textcolor{keyword}{const}\ std::vector<std::string>\&\ ParNames)\{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02758}02758\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02759}02759\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[0]\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_a8667510132aa01395520f028287f511b}{MakePostfit}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02760}02760\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02761}02761\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ TopMargin\ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetTopMargin();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02762}02762\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ BottomMargin\ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetBottomMargin();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02763}02763\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ LeftMargin\ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetLeftMargin();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02764}02764\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ RightMargin\ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetRightMargin();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02765}02765\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02766}02766\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTopMargin(0.1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02767}02767\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetBottomMargin(0.1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02768}02768\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetLeftMargin(0.1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02769}02769\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetRightMargin(0.1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02770}02770\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Update();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02771}02771\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02772}02772\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Calculating\ Polar\ Plot"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02773}02773\ \ \ TDirectory\ *PolarDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}PolarDir"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02774}02774\ \ \ PolarDir-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02775}02775\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02776}02776\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ ParNames.size();\ ++k)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02777}02777\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02778}02778\ \ \ \ \ \textcolor{comment}{//KS:\ First\ we\ need\ to\ find\ parameter\ number\ based\ on\ name}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02779}02779\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamNo\ =\ \mbox{\hyperlink{classMCMCProcessor_a5ab91183fbbf23fff759fefc9954a1a5}{GetParamIndexFromName}}(ParNames[k]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02780}02780\ \ \ \ \ \textcolor{keywordtype}{bool}\ skip\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02781}02781\ \ \ \ \ \textcolor{keywordflow}{if}(ParamNo\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}})}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02782}02782\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02783}02783\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Couldn't\ find\ param\ \{\}.\ Will\ not\ calculate\ Polar\ Plot"{}},\ ParNames[k]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02784}02784\ \ \ \ \ \ \ skip\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02785}02785\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02786}02786\ \ \ \ \ \textcolor{keywordflow}{if}(skip)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02787}02787\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02788}02788\ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02789}02789\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02790}02790\ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02791}02791\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(ParamNo,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02792}02792\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02793}02793\ \ \ \ \ std::vector<double>\ x\_val(\mbox{\hyperlink{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}{nBins}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02794}02794\ \ \ \ \ std::vector<double>\ y\_val(\mbox{\hyperlink{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}{nBins}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02795}02795\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02796}02796\ \ \ \ \ \textcolor{keywordtype}{double}\ xmin\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02797}02797\ \ \ \ \ \textcolor{keywordtype}{double}\ xmax\ =\ 2*TMath::Pi();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02798}02798\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02799}02799\ \ \ \ \ \textcolor{keywordtype}{double}\ Integral\ =\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNo]-\/>Integral();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02800}02800\ \ \ \ \ \textcolor{keywordflow}{for}\ (Int\_t\ ipt\ =\ 0;\ ipt\ <\ \mbox{\hyperlink{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}{nBins}};\ ipt++)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02801}02801\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02802}02802\ \ \ \ \ \ \ x\_val[ipt]\ =\ ipt*(xmax-\/xmin)/\mbox{\hyperlink{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}{nBins}}+xmin;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02803}02803\ \ \ \ \ \ \ y\_val[ipt]\ =\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNo]-\/>GetBinContent(ipt+1)/Integral;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02804}02804\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02805}02805\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02806}02806\ \ \ \ \ \textcolor{keyword}{auto}\ PolarGraph\ =\ std::make\_unique<TGraphPolar>(\mbox{\hyperlink{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}{nBins}},\ x\_val.data(),\ y\_val.data());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02807}02807\ \ \ \ \ PolarGraph-\/>SetLineWidth(2);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02808}02808\ \ \ \ \ PolarGraph-\/>SetFillStyle(3001);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02809}02809\ \ \ \ \ PolarGraph-\/>SetLineColor(kRed);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02810}02810\ \ \ \ \ PolarGraph-\/>SetFillColor(kRed);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02811}02811\ \ \ \ \ PolarGraph-\/>Draw(\textcolor{stringliteral}{"{}AFL"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02812}02812\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02813}02813\ \ \ \ \ \textcolor{keyword}{auto}\ Text\ =\ std::make\_unique<TText>(0.6,\ 0.1,\ Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02814}02814\ \ \ \ \ Text-\/>SetTextSize(0.04);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02815}02815\ \ \ \ \ Text-\/>SetNDC(\textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02816}02816\ \ \ \ \ Text-\/>Draw(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02817}02817\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02818}02818\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02819}02819\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Write(Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02820}02820\ \ \ \}\ \textcolor{comment}{//End\ loop\ over\ parameters}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02821}02821\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02822}02822\ \ \ PolarDir-\/>Close();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02823}02823\ \ \ \textcolor{keyword}{delete}\ PolarDir;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02824}02824\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02825}02825\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02826}02826\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02827}02827\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTopMargin(TopMargin);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02828}02828\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetBottomMargin(BottomMargin);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02829}02829\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetLeftMargin(LeftMargin);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02830}02830\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetRightMargin(RightMargin);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02831}02831\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02832}02832\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02833}02833\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02834}02834\ \textcolor{comment}{//\ Get\ Bayes\ Factor\ for\ particular\ parameter}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02835}\mbox{\hyperlink{classMCMCProcessor_a1fc5adc3c109227e6ead71eb0746ec4d}{02835}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_a1fc5adc3c109227e6ead71eb0746ec4d}{MCMCProcessor::GetBayesFactor}}(\textcolor{keyword}{const}\ std::vector<std::string>\&\ ParNames,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02836}02836\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<std::vector<double>>\&\ Model1Bounds,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02837}02837\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<std::vector<double>>\&\ Model2Bounds,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02838}02838\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<std::vector<std::string>>\&\ ModelNames)\{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02839}02839\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02840}02840\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[0]\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_a8667510132aa01395520f028287f511b}{MakePostfit}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02841}02841\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02842}02842\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Calculating\ Bayes\ Factor"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02843}02843\ \ \ \textcolor{keywordflow}{if}((ParNames.size()\ !=\ Model1Bounds.size())\ ||\ (Model2Bounds.size()\ !=\ Model1Bounds.size())\ \ ||\ (Model2Bounds.size()\ !=\ ModelNames.size()))}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02844}02844\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02845}02845\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Size\ doesn't\ match"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02846}02846\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02847}02847\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02848}02848\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ ParNames.size();\ ++k)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02849}02849\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02850}02850\ \ \ \ \ \textcolor{comment}{//KS:\ First\ we\ need\ to\ find\ parameter\ number\ based\ on\ name}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02851}02851\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamNo\ =\ \mbox{\hyperlink{classMCMCProcessor_a5ab91183fbbf23fff759fefc9954a1a5}{GetParamIndexFromName}}(ParNames[k]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02852}02852\ \ \ \ \ \textcolor{keywordtype}{bool}\ skip\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02853}02853\ \ \ \ \ \textcolor{keywordflow}{if}(ParamNo\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}})}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02854}02854\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02855}02855\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Couldn't\ find\ param\ \{\}.\ Will\ not\ calculate\ Bayes\ Factor"{}},\ ParNames[k]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02856}02856\ \ \ \ \ \ \ skip\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02857}02857\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02858}02858\ \ \ \ \ \textcolor{keywordflow}{if}(skip)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02859}02859\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02860}02860\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ M1\_min\ =\ Model1Bounds[k][0];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02861}02861\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ M2\_min\ =\ Model2Bounds[k][0];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02862}02862\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ M1\_max\ =\ Model1Bounds[k][1];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02863}02863\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ M2\_max\ =\ Model2Bounds[k][1];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02864}02864\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02865}02865\ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double}\ IntegralMode1\ =\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNo]-\/>Integral(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNo]-\/>FindFixBin(M1\_min),\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNo]-\/>FindFixBin(M1\_max));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02866}02866\ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double}\ IntegralMode2\ =\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNo]-\/>Integral(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNo]-\/>FindFixBin(M2\_min),\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNo]-\/>FindFixBin(M2\_max));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02867}02867\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02868}02868\ \ \ \ \ \textcolor{keywordtype}{double}\ BayesFactor\ =\ 0.;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02869}02869\ \ \ \ \ std::string\ Name\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02870}02870\ \ \ \ \ \textcolor{comment}{//KS:\ Calc\ Bayes\ Factor}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02871}02871\ \ \ \ \ \textcolor{comment}{//If\ M1\ is\ more\ likely}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02872}02872\ \ \ \ \ \textcolor{keywordflow}{if}(IntegralMode1\ >=\ IntegralMode2)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02873}02873\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02874}02874\ \ \ \ \ \ \ BayesFactor\ =\ IntegralMode1/IntegralMode2;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02875}02875\ \ \ \ \ \ \ Name\ =\ \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)mathfrak\{B\}("{}}\ +\ ModelNames[k][0]+\ \textcolor{stringliteral}{"{}/"{}}\ +\ ModelNames[k][1]\ +\ \textcolor{stringliteral}{"{})\ =\ "{}}\ +\ std::to\_string(BayesFactor);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02876}02876\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02877}02877\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{comment}{//If\ M2\ is\ more\ likely}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02878}02878\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02879}02879\ \ \ \ \ \ \ BayesFactor\ =\ IntegralMode2/IntegralMode1;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02880}02880\ \ \ \ \ \ \ Name\ =\ \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)mathfrak\{B\}("{}}\ +\ ModelNames[k][1]+\ \textcolor{stringliteral}{"{}/"{}}\ +\ ModelNames[k][0]\ +\ \textcolor{stringliteral}{"{})\ =\ "{}}\ +\ std::to\_string(BayesFactor);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02881}02881\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02882}02882\ \ \ \ \ std::string\ JeffreysScale\ =\ \mbox{\hyperlink{StatisticalUtils_8h_aac0e253784ed2f2a3258d68df22a2568}{GetJeffreysScale}}(BayesFactor);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02883}02883\ \ \ \ \ std::string\ DunneKabothScale\ =\ \mbox{\hyperlink{StatisticalUtils_8h_acf403b05be9baa719893db7449e833c7}{GetDunneKaboth}}(BayesFactor);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02884}02884\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02885}02885\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\{\}\ for\ \{\}"{}},\ Name,\ ParNames[k]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02886}02886\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Following\ Jeffreys\ Scale\ =\ "{}},\ JeffreysScale);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02887}02887\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Following\ Dunne-\/Kaboth\ Scale\ =\ "{}},\ DunneKabothScale);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02888}02888\ \ \ \ \ std::cout<<std::endl;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02889}02889\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02890}02890\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02891}02891\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02892}02892\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02893}02893\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02894}02894\ \textcolor{comment}{//\ KS:\ Get\ Savage\ Dickey\ point\ hypothesis\ test}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02895}\mbox{\hyperlink{classMCMCProcessor_ad09b1ad60fa52fdd87450ab8834e9cd9}{02895}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_ad09b1ad60fa52fdd87450ab8834e9cd9}{MCMCProcessor::GetSavageDickey}}(\textcolor{keyword}{const}\ std::vector<std::string>\&\ ParNames,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02896}02896\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<double>\&\ EvaluationPoint,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02897}02897\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<std::vector<double>>\&\ Bounds)\{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02898}02898\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02899}02899\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02900}02900\ \ \ \textcolor{keywordflow}{if}((ParNames.size()\ !=\ EvaluationPoint.size())\ ||\ (Bounds.size()\ !=\ EvaluationPoint.size()))}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02901}02901\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02902}02902\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Size\ doesn't\ match"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02903}02903\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02904}02904\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02905}02905\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02906}02906\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[0]\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_a8667510132aa01395520f028287f511b}{MakePostfit}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02907}02907\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02908}02908\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Calculating\ Savage\ Dickey"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02909}02909\ \ \ TDirectory\ *SavageDickeyDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}SavageDickey"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02910}02910\ \ \ SavageDickeyDir-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02911}02911\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02912}02912\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ ParNames.size();\ ++k)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02913}02913\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02914}02914\ \ \ \ \ \textcolor{comment}{//KS:\ First\ we\ need\ to\ find\ parameter\ number\ based\ on\ name}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02915}02915\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamNo\ =\ \mbox{\hyperlink{classMCMCProcessor_a5ab91183fbbf23fff759fefc9954a1a5}{GetParamIndexFromName}}(ParNames[k]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02916}02916\ \ \ \ \ \textcolor{keywordtype}{bool}\ skip\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02917}02917\ \ \ \ \ \textcolor{keywordflow}{if}(ParamNo\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}})}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02918}02918\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02919}02919\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Couldn't\ find\ param\ \{\}.\ Will\ not\ calculate\ SavageDickey"{}},\ ParNames[k]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02920}02920\ \ \ \ \ \ \ skip\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02921}02921\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02922}02922\ \ \ \ \ \textcolor{keywordflow}{if}(skip)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02923}02923\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02924}02924\ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02925}02925\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02926}02926\ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02927}02927\ \ \ \ \ \textcolor{keywordtype}{bool}\ FlatPrior\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02928}02928\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(ParamNo,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02929}02929\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02930}02930\ \ \ \ \ \mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20b}{ParameterEnum}}\ ParType\ =\ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}[ParamNo];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02931}02931\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamTemp\ =\ ParamNo\ -\/\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[ParType];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02932}02932\ \ \ \ \ FlatPrior\ =\ \mbox{\hyperlink{classMCMCProcessor_a4be1eedb743e4ea410009a4fa45720f7}{ParamFlat}}[ParType][ParamTemp];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02933}02933\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02934}02934\ \ \ \ \ TH1D*\ PosteriorHist\ =\ \textcolor{keyword}{static\_cast<}TH1D\ *\textcolor{keyword}{>}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNo]-\/>Clone(Title));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02935}02935\ \ \ \ \ \mbox{\hyperlink{Structs_8cpp_a85463c0c6943e3d544d5fcb3f96bf18a}{RemoveFitter}}(PosteriorHist,\ \textcolor{stringliteral}{"{}Gauss"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02936}02936\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02937}02937\ \ \ \ \ TH1D*\ PriorHist\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02938}02938\ \ \ \ \ \textcolor{comment}{//KS:\ If\ flat\ prior\ we\ need\ to\ have\ well\ defined\ bounds\ otherwise\ Prior\ distribution\ will\ not\ make\ sense}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02939}02939\ \ \ \ \ \textcolor{keywordflow}{if}(FlatPrior)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02940}02940\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02941}02941\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ NBins\ =\ PosteriorHist-\/>GetNbinsX();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02942}02942\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(Bounds[k][0]\ >\ Bounds[k][1])}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02943}02943\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02944}02944\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Lower\ bound\ is\ higher\ than\ upper\ bound"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02945}02945\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02946}02946\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02947}02947\ \ \ \ \ \ \ PriorHist\ =\ \textcolor{keyword}{new}\ TH1D(\textcolor{stringliteral}{"{}PriorHist"{}},\ Title,\ NBins,\ Bounds[k][0],\ Bounds[k][1]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02948}02948\ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02949}02949\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ FlatProb\ =\ (\ Bounds[k][1]\ -\/\ Bounds[k][0])\ /\ NBins;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02950}02950\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ g\ =\ 0;\ g\ <\ NBins\ +\ 1;\ ++g)\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02951}02951\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02952}02952\ \ \ \ \ \ \ \ \ PriorHist-\/>SetBinContent(g+1,\ FlatProb);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02953}02953\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02954}02954\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02955}02955\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{comment}{//KS:\ Otherwise\ throw\ from\ Gaussian}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02956}02956\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02957}02957\ \ \ \ \ \ \ PriorHist\ =\ \textcolor{keyword}{static\_cast<}TH1D*\textcolor{keyword}{>}(PosteriorHist-\/>Clone(\textcolor{stringliteral}{"{}Prior"{}}));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02958}02958\ \ \ \ \ \ \ PriorHist-\/>Reset(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02959}02959\ \ \ \ \ \ \ PriorHist-\/>Fill(0.0,\ 0.0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02960}02960\ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02961}02961\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ rand\ =\ std::make\_unique<TRandom3>(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02962}02962\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Throw\ nice\ gaussian,\ just\ need\ big\ number\ to\ have\ smooth\ distribution}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02963}02963\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ g\ =\ 0;\ g\ <\ 1000000;\ ++g)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02964}02964\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02965}02965\ \ \ \ \ \ \ \ \ PriorHist-\/>Fill(rand-\/>Gaus(Prior,\ PriorError));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02966}02966\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02967}02967\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02968}02968\ \ \ \ \ \textcolor{comment}{//\ Area\ normalise\ the\ distributions}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02969}02969\ \ \ \ \ PriorHist-\/>Scale(1./PriorHist-\/>Integral(),\ \textcolor{stringliteral}{"{}width"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02970}02970\ \ \ \ \ PosteriorHist-\/>Scale(1./PosteriorHist-\/>Integral(),\ \textcolor{stringliteral}{"{}width"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02971}02971\ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02972}02972\ \ \ \ \ PriorHist-\/>SetLineColor(kRed);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02973}02973\ \ \ \ \ PriorHist-\/>SetMarkerColor(kRed);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02974}02974\ \ \ \ \ PriorHist-\/>SetFillColorAlpha(kRed,\ 0.35);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02975}02975\ \ \ \ \ PriorHist-\/>SetFillStyle(1001);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02976}02976\ \ \ \ \ PriorHist-\/>GetXaxis()-\/>SetTitle(Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02977}02977\ \ \ \ \ PriorHist-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Posterior\ Probability"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02978}02978\ \ \ \ \ PriorHist-\/>SetMaximum(PosteriorHist-\/>GetMaximum()*1.5);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02979}02979\ \ \ \ \ PriorHist-\/>GetYaxis()-\/>SetLabelOffset(999);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02980}02980\ \ \ \ \ PriorHist-\/>GetYaxis()-\/>SetLabelSize(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02981}02981\ \ \ \ \ PriorHist-\/>SetLineWidth(2);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02982}02982\ \ \ \ \ PriorHist-\/>SetLineStyle(kSolid);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02983}02983\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02984}02984\ \ \ \ \ PosteriorHist-\/>SetLineColor(kBlue);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02985}02985\ \ \ \ \ PosteriorHist-\/>SetMarkerColor(kBlue);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02986}02986\ \ \ \ \ PosteriorHist-\/>SetFillColorAlpha(kBlue,\ 0.35);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02987}02987\ \ \ \ \ PosteriorHist-\/>SetFillStyle(1001);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02988}02988\ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02989}02989\ \ \ \ \ PriorHist-\/>Draw(\textcolor{stringliteral}{"{}hist"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02990}02990\ \ \ \ \ PosteriorHist-\/>Draw(\textcolor{stringliteral}{"{}hist\ same"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02991}02991\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02992}02992\ \ \ \ \ \textcolor{keywordtype}{double}\ ProbPrior\ =\ PriorHist-\/>GetBinContent(PriorHist-\/>FindBin(EvaluationPoint[k]));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02993}02993\ \ \ \ \ \textcolor{comment}{//KS:\ In\ case\ we\ go\ so\ far\ away\ that\ prior\ is\ 0,\ set\ this\ to\ small\ value\ to\ avoid\ dividing\ by\ 0}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02994}02994\ \ \ \ \ \textcolor{keywordflow}{if}(ProbPrior\ <\ 0)\ ProbPrior\ =\ 0.00001;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02995}02995\ \ \ \ \ \textcolor{keywordtype}{double}\ ProbPosterior\ =\ PosteriorHist-\/>GetBinContent(PosteriorHist-\/>FindBin(EvaluationPoint[k]));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02996}02996\ \ \ \ \ \textcolor{keywordtype}{double}\ SavageDickey\ =\ ProbPosterior/ProbPrior;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02997}02997\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02998}02998\ \ \ \ \ std::string\ DunneKabothScale\ =\ \mbox{\hyperlink{StatisticalUtils_8h_acf403b05be9baa719893db7449e833c7}{GetDunneKaboth}}(SavageDickey);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l02999}02999\ \ \ \ \ \textcolor{comment}{//Get\ Best\ point}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03000}03000\ \ \ \ \ std::unique\_ptr<TGraph>\ PostPoint(\textcolor{keyword}{new}\ TGraph(1));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03001}03001\ \ \ \ \ PostPoint-\/>SetPoint(0,\ EvaluationPoint[k],\ ProbPosterior);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03002}03002\ \ \ \ \ PostPoint-\/>SetMarkerStyle(20);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03003}03003\ \ \ \ \ PostPoint-\/>SetMarkerSize(1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03004}03004\ \ \ \ \ PostPoint-\/>Draw(\textcolor{stringliteral}{"{}P\ same"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03005}03005\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03006}03006\ \ \ \ \ std::unique\_ptr<TGraph>\ PriorPoint(\textcolor{keyword}{new}\ TGraph(1));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03007}03007\ \ \ \ \ PriorPoint-\/>SetPoint(0,\ EvaluationPoint[k],\ ProbPrior);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03008}03008\ \ \ \ \ PriorPoint-\/>SetMarkerStyle(20);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03009}03009\ \ \ \ \ PriorPoint-\/>SetMarkerSize(1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03010}03010\ \ \ \ \ PriorPoint-\/>Draw(\textcolor{stringliteral}{"{}P\ same"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03011}03011\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03012}03012\ \ \ \ \ \textcolor{keyword}{auto}\ legend\ =\ std::make\_unique<TLegend>(0.12,\ 0.6,\ 0.6,\ 0.97);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03013}03013\ \ \ \ \ legend-\/>SetTextSize(0.04);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03014}03014\ \ \ \ \ legend-\/>AddEntry(PriorHist,\ \textcolor{stringliteral}{"{}Prior"{}},\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03015}03015\ \ \ \ \ legend-\/>AddEntry(PosteriorHist,\ \textcolor{stringliteral}{"{}Posterior"{}},\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03016}03016\ \ \ \ \ legend-\/>AddEntry(PostPoint.get(),\ Form(\textcolor{stringliteral}{"{}SavageDickey\ =\ \%.2f,\ (\%s)"{}},\ SavageDickey,\ DunneKabothScale.c\_str()),\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03017}03017\ \ \ \ \ legend-\/>SetLineColor(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03018}03018\ \ \ \ \ legend-\/>SetLineStyle(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03019}03019\ \ \ \ \ legend-\/>SetFillColor(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03020}03020\ \ \ \ \ legend-\/>SetFillStyle(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03021}03021\ \ \ \ \ legend-\/>SetBorderSize(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03022}03022\ \ \ \ \ legend-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03023}03023\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03024}03024\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03025}03025\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Write(Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03026}03026\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03027}03027\ \ \ \ \ \textcolor{keyword}{delete}\ PosteriorHist;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03028}03028\ \ \ \ \ \textcolor{keyword}{delete}\ PriorHist;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03029}03029\ \ \ \}\ \textcolor{comment}{//End\ loop\ over\ parameters}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03030}03030\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03031}03031\ \ \ SavageDickeyDir-\/>Close();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03032}03032\ \ \ \textcolor{keyword}{delete}\ SavageDickeyDir;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03033}03033\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03034}03034\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03035}03035\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03036}03036\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03037}03037\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03038}03038\ \textcolor{comment}{//\ KS:\ Reweight\ prior\ of\ MCMC\ chain\ to\ another}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03039}\mbox{\hyperlink{classMCMCProcessor_ad3b1cfab21c7063bc29d1cf5dcca888c}{03039}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_ad3b1cfab21c7063bc29d1cf5dcca888c}{MCMCProcessor::ReweightPrior}}(\textcolor{keyword}{const}\ std::vector<std::string>\&\ Names,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03040}03040\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<double>\&\ NewCentral,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03041}03041\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<double>\&\ NewError)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03042}03042\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03043}03043\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03044}03044\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Reweighting\ Prior"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03045}03045\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03046}03046\ \ \ \textcolor{keywordflow}{if}(\ (Names.size()\ !=\ NewCentral.size())\ ||\ (NewCentral.size()\ !=\ NewError.size()))}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03047}03047\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03048}03048\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Size\ of\ passed\ vectors\ doesn't\ match\ in\ ReweightPrior"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03049}03049\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03050}03050\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03051}03051\ \ \ std::vector<int>\ Param;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03052}03052\ \ \ std::vector<double>\ OldCentral;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03053}03053\ \ \ std::vector<double>\ OldError;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03054}03054\ \ \ std::vector<bool>\ FlatPrior;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03055}03055\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03056}03056\ \ \ \textcolor{comment}{//KS:\ First\ we\ need\ to\ find\ parameter\ number\ based\ on\ name}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03057}03057\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ Names.size();\ ++k)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03058}03058\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03059}03059\ \ \ \ \ \textcolor{comment}{//KS:\ First\ we\ need\ to\ find\ parameter\ number\ based\ on\ name}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03060}03060\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamNo\ =\ \mbox{\hyperlink{classMCMCProcessor_a5ab91183fbbf23fff759fefc9954a1a5}{GetParamIndexFromName}}(Names[k]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03061}03061\ \ \ \ \ \textcolor{keywordflow}{if}(ParamNo\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}})}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03062}03062\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03063}03063\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Couldn't\ find\ param\ \{\}.\ Can't\ reweight\ Prior"{}},\ Names[k]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03064}03064\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03065}03065\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03066}03066\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03067}03067\ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03068}03068\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03069}03069\ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03070}03070\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(ParamNo,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03071}03071\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03072}03072\ \ \ \ \ Param.push\_back(ParamNo);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03073}03073\ \ \ \ \ OldCentral.push\_back(Prior);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03074}03074\ \ \ \ \ OldError.push\_back(PriorError);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03075}03075\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03076}03076\ \ \ \ \ \mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20b}{ParameterEnum}}\ ParType\ =\ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}[ParamNo];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03077}03077\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamTemp\ =\ ParamNo\ -\/\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[ParType];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03078}03078\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03079}03079\ \ \ \ \ FlatPrior.push\_back(\mbox{\hyperlink{classMCMCProcessor_a4be1eedb743e4ea410009a4fa45720f7}{ParamFlat}}[ParType][ParamTemp]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03080}03080\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03081}03081\ \ \ std::vector<double>\ ParameterPos(Names.size());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03082}03082\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03083}03083\ \ \ std::string\ InputFile\ =\ \mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}}+\textcolor{stringliteral}{"{}.root"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03084}03084\ \ \ std::string\ OutputFilename\ =\ \mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}}\ +\ \textcolor{stringliteral}{"{}\_reweighted.root"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03085}03085\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03086}03086\ \ \ \textcolor{comment}{//KS:\ Simply\ create\ copy\ of\ file\ and\ add\ there\ new\ branch}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03087}03087\ \ \ \textcolor{keywordtype}{int}\ ret\ =\ system((\textcolor{stringliteral}{"{}cp\ "{}}\ +\ InputFile\ +\ \textcolor{stringliteral}{"{}\ "{}}\ +\ OutputFilename).c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03088}03088\ \ \ \textcolor{keywordflow}{if}\ (ret\ !=\ 0)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03089}03089\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Error:\ system\ call\ to\ copy\ file\ failed\ with\ code\ \{\}"{}},\ ret);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03090}03090\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03091}03091\ \ \ TFile\ *OutputChain\ =\ \textcolor{keyword}{new}\ TFile(OutputFilename.c\_str(),\ \textcolor{stringliteral}{"{}UPDATE"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03092}03092\ \ \ OutputChain-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03093}03093\ \ \ TTree\ *post\ =\ OutputChain-\/>Get<TTree>(\textcolor{stringliteral}{"{}posteriors"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03094}03094\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03095}03095\ \ \ \textcolor{keywordtype}{double}\ Weight\ =\ 1.;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03096}03096\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03097}03097\ \ \ post-\/>SetBranchStatus(\textcolor{stringliteral}{"{}*"{}},\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03098}03098\ \ \ \textcolor{comment}{//\ Set\ the\ branch\ addresses\ for\ params}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03099}03099\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ Names.size();\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03100}03100\ \ \ \ \ post-\/>SetBranchStatus(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[Param[j]].Data(),\ \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03101}03101\ \ \ \ \ post-\/>SetBranchAddress(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[Param[j]].Data(),\ \&ParameterPos[j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03102}03102\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03103}03103\ \ \ TBranch\ *bpt\ =\ post-\/>Branch(\textcolor{stringliteral}{"{}Weight"{}},\ \&Weight,\ \textcolor{stringliteral}{"{}Weight/D"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03104}03104\ \ \ post-\/>SetBranchStatus(\textcolor{stringliteral}{"{}Weight"{}},\ \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03105}03105\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03106}03106\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03107}03107\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03108}03108\ \ \ \ \ post-\/>GetEntry(i);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03109}03109\ \ \ \ \ Weight\ =\ 1.;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03110}03110\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03111}03111\ \ \ \ \ \textcolor{comment}{//KS:\ Calculate\ reweight\ weight.\ Weights\ are\ multiplicative\ so\ we\ can\ do\ several\ reweights\ at\ once.\ FIXME\ Big\ limitation\ is\ that\ code\ only\ works\ for\ uncorrelated\ parameters\ :(}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03112}03112\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ Names.size();\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03113}03113\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03114}03114\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ new\_chi\ =\ (ParameterPos[j]\ -\/\ NewCentral[j])/NewError[j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03115}03115\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ new\_prior\ =\ std::exp(-\/0.5\ *\ new\_chi\ *\ new\_chi);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03116}03116\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03117}03117\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ old\_chi\ =\ -\/1;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03118}03118\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ old\_prior\ =\ -\/1;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03119}03119\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(FlatPrior[j])}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03120}03120\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03121}03121\ \ \ \ \ \ \ \ \ old\_prior\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03122}03122\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03123}03123\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03124}03124\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03125}03125\ \ \ \ \ \ \ \ \ old\_chi\ =\ (ParameterPos[j]\ -\/\ OldCentral[j])/OldError[j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03126}03126\ \ \ \ \ \ \ \ \ old\_prior\ =\ std::exp(-\/0.5\ *\ old\_chi\ *\ old\_chi);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03127}03127\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03128}03128\ \ \ \ \ \ \ Weight\ *=\ new\_prior/old\_prior;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03129}03129\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03130}03130\ \ \ \ \ bpt-\/>Fill();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03131}03131\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03132}03132\ \ \ post-\/>SetBranchStatus(\textcolor{stringliteral}{"{}*"{}},\textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03133}03133\ \ \ OutputChain-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03134}03134\ \ \ post-\/>Write(\textcolor{stringliteral}{"{}posteriors"{}},\ TObject::kOverwrite);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03135}03135\ \ \ OutputChain-\/>Close();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03136}03136\ \ \ \textcolor{keyword}{delete}\ OutputChain;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03137}03137\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03138}03138\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03139}03139\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03140}03140\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03141}03141\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03142}03142\ \textcolor{comment}{//\ Diagnose\ the\ MCMC}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03143}\mbox{\hyperlink{classMCMCProcessor_ac9a5fc93b5ac3f6ef7850d21f47fd5dd}{03143}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_ac9a5fc93b5ac3f6ef7850d21f47fd5dd}{MCMCProcessor::ParameterEvolution}}(\textcolor{keyword}{const}\ std::vector<std::string>\&\ Names,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03144}03144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<int>\&\ NIntervals)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03145}03145\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03146}03146\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Parameter\ Evolution\ gif"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03147}03147\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03148}03148\ \ \ \textcolor{comment}{//KS:\ First\ we\ need\ to\ find\ parameter\ number\ based\ on\ name}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03149}03149\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ Names.size();\ ++k)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03150}03150\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03151}03151\ \ \ \ \ \textcolor{comment}{//KS:\ First\ we\ need\ to\ find\ parameter\ number\ based\ on\ name}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03152}03152\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamNo\ =\ \mbox{\hyperlink{classMCMCProcessor_a5ab91183fbbf23fff759fefc9954a1a5}{GetParamIndexFromName}}(Names[k]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03153}03153\ \ \ \ \ \textcolor{keywordflow}{if}(ParamNo\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}})}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03154}03154\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03155}03155\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Couldn't\ find\ param\ \{\}.\ Can't\ reweight\ Prior"{}},\ Names[k]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03156}03156\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03157}03157\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03158}03158\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03159}03159\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ IntervalsSize\ =\ \mbox{\hyperlink{classMCMCProcessor_aae0016a4e1d105d5d65243438c622a97}{nSteps}}/NIntervals[k];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03160}03160\ \ \ \ \ \textcolor{comment}{//\ ROOT\ won't\ overwrite\ gifs\ so\ we\ need\ to\ delete\ the\ file\ if\ it's\ there\ already}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03161}03161\ \ \ \ \ system(fmt::format(\textcolor{stringliteral}{"{}rm\ \{\}.gif"{}},Names[k]).c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03162}03162\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03163}03163\ \ \ \ \ \textcolor{comment}{//\ This\ holds\ the\ posterior\ density}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03164}03164\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ maxi\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMaximum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[ParamNo]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03165}03165\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ mini\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMinimum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[ParamNo]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03166}03166\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03167}03167\ \ \ \ \ \textcolor{keywordtype}{int}\ Counter\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03168}03168\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ NIntervals[k]-\/1;\ i\ >=\ 0;\ -\/-\/i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03169}03169\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03170}03170\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ holds\ the\ posterior\ density}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03171}03171\ \ \ \ \ \ \ TH1D*\ EvePlot\ =\ \textcolor{keyword}{new}\ TH1D(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[ParamNo],\ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[ParamNo],\ \mbox{\hyperlink{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}{nBins}},\ mini,\ maxi);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03172}03172\ \ \ \ \ \ \ EvePlot-\/>SetMinimum(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03173}03173\ \ \ \ \ \ \ EvePlot-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}PDF"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03174}03174\ \ \ \ \ \ \ EvePlot-\/>GetYaxis()-\/>SetNoExponent(\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03175}03175\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03176}03176\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Apply\ additional\ Cuts,\ like\ mass\ ordering}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03177}03177\ \ \ \ \ \ \ std::string\ CutPosterior1D\ =\ \textcolor{stringliteral}{"{}step\ >\ "{}}\ +\ std::to\_string(i*IntervalsSize+IntervalsSize);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03178}03178\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03179}03179\ \ \ \ \ \ \ std::string\ TextTitle\ =\ \textcolor{stringliteral}{"{}Steps\ =\ 0\ -\/\ "{}}+std::to\_string(Counter*IntervalsSize+IntervalsSize);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03180}03180\ \ \ \ \ \ \ \textcolor{comment}{//\ Project\ BranchNames[ParamNo]\ onto\ hpost,\ applying\ stepcut}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03181}03181\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>Project(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[ParamNo],\ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[ParamNo],\ CutPosterior1D.c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03182}03182\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03183}03183\ \ \ \ \ \ \ EvePlot-\/>SetLineWidth(2);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03184}03184\ \ \ \ \ \ \ EvePlot-\/>SetLineColor(kBlue-\/1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03185}03185\ \ \ \ \ \ \ EvePlot-\/>SetTitle(Names[k].c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03186}03186\ \ \ \ \ \ \ EvePlot-\/>GetXaxis()-\/>SetTitle(EvePlot-\/>GetTitle());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03187}03187\ \ \ \ \ \ \ EvePlot-\/>GetYaxis()-\/>SetLabelOffset(1000);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03188}03188\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a682c1c47626542f5820d633ba2bc010c}{ApplySmoothing}})\ EvePlot-\/>Smooth();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03189}03189\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03190}03190\ \ \ \ \ \ \ EvePlot-\/>Scale(1.\ /\ EvePlot-\/>Integral());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03191}03191\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03192}03192\ \ \ \ \ \ \ EvePlot-\/>Draw(\textcolor{stringliteral}{"{}HIST"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03193}03193\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03194}03194\ \ \ \ \ \ \ TText\ *text\ =\ \textcolor{keyword}{new}\ TText(0.3,\ 0.8,\ TextTitle.c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03195}03195\ \ \ \ \ \ \ text-\/>SetTextFont\ (43);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03196}03196\ \ \ \ \ \ \ text-\/>SetTextSize\ (40);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03197}03197\ \ \ \ \ \ \ text-\/>SetNDC(\textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03198}03198\ \ \ \ \ \ \ text-\/>Draw(\textcolor{stringliteral}{"{}SAME"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03199}03199\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03200}03200\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(i\ ==\ 0)\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(((Names[k]\ +\ \textcolor{stringliteral}{"{}.gif++20"{}}).c\_str()));\ \textcolor{comment}{//\ produces\ infinite\ loop\ animated\ GIF}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03201}03201\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(((Names[k]+\textcolor{stringliteral}{"{}.gif+20"{}}).c\_str()));\ \textcolor{comment}{//\ add\ picture\ to\ .gif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03202}03202\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03203}03203\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ EvePlot;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03204}03204\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ text;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03205}03205\ \ \ \ \ \ \ Counter++;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03206}03206\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03207}03207\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03208}03208\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03209}03209\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03210}03210\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03211}03211\ \textcolor{comment}{//\ Diagnose\ the\ MCMC}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03212}\mbox{\hyperlink{classMCMCProcessor_a7f8faecae63616ba100cf24ae42ecc08}{03212}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_a7f8faecae63616ba100cf24ae42ecc08}{MCMCProcessor::DiagMCMC}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03213}03213\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03214}03214\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03215}03215\ \ \ \textcolor{comment}{//\ Prepare\ branches\ etc\ for\ DiagMCMC}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03216}03216\ \ \ \mbox{\hyperlink{classMCMCProcessor_a930cadafa41b31b58066dea68628de9f}{PrepareDiagMCMC}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03217}03217\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03218}03218\ \ \ \textcolor{comment}{//\ Draw\ the\ simple\ trace\ matrices}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03219}03219\ \ \ \mbox{\hyperlink{classMCMCProcessor_a929d6efec80bb4de05eea7011257439a}{ParamTraces}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03220}03220\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03221}03221\ \ \ \textcolor{comment}{//\ Get\ the\ batched\ means}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03222}03222\ \ \ \mbox{\hyperlink{classMCMCProcessor_af3658b8adee50f6ef5557ebbd1c87b8e}{BatchedMeans}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03223}03223\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03224}03224\ \ \ \textcolor{comment}{//\ Draw\ the\ auto-\/correlations}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03225}03225\ \ \ \mbox{\hyperlink{classMCMCProcessor_a322bee0c362ba83df8c45769d299ce9f}{AutoCorrelation}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03226}03226\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03227}03227\ \ \ \textcolor{comment}{//\ Calculate\ Power\ Spectrum\ for\ each\ param}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03228}03228\ \ \ \mbox{\hyperlink{classMCMCProcessor_aef760d8c4bb70690a5c4114f4b2409b3}{PowerSpectrumAnalysis}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03229}03229\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03230}03230\ \ \ \textcolor{comment}{//\ Get\ Geweke\ Z\ score\ helping\ select\ burn-\/in}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03231}03231\ \ \ \mbox{\hyperlink{classMCMCProcessor_a03b7c4bb9cd9a90aa7d284b0f1a6156b}{GewekeDiagnostic}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03232}03232\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03233}03233\ \ \ \textcolor{comment}{//\ Draw\ acceptance\ Probability}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03234}03234\ \ \ \mbox{\hyperlink{classMCMCProcessor_a278b82fa945d847e57ae6ed6357d8f61}{AcceptanceProbabilities}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03235}03235\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03236}03236\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03237}03237\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03238}03238\ \textcolor{comment}{//CW:\ Prepare\ branches\ etc.\ for\ DiagMCMC}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03239}\mbox{\hyperlink{classMCMCProcessor_a930cadafa41b31b58066dea68628de9f}{03239}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_a930cadafa41b31b58066dea68628de9f}{MCMCProcessor::PrepareDiagMCMC}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03240}03240\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03241}03241\ \ \ \mbox{\hyperlink{classMCMCProcessor_adf449e50cf358f737fe4a2b65d9668e9}{doDiagMCMC}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03242}03242\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03243}03243\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}\ !=\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03244}03244\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03245}03245\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}It\ look\ like\ ParStep\ was\ already\ filled\ "{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03246}03246\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Even\ though\ it\ is\ used\ for\ MakeCovariance\_MP\ and\ for\ DiagMCMC"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03247}03247\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}it\ has\ different\ structure\ in\ both\ for\ cache\ hits,\ sorry\ "{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03248}03248\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03249}03249\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03250}03250\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03251}03251\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03252}03252\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}nBatches\ is\ equal\ to\ 0"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03253}03253\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}please\ use\ SetnBatches\ to\ set\ other\ value\ fore\ example\ 20"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03254}03254\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03255}03255\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03256}03256\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03257}03257\ \ \ \textcolor{comment}{//\ Initialise\ ParStep}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03258}03258\ \ \ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}]();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03259}03259\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03260}03260\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}]();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03261}03261\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03262}03262\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i]\ =\ -\/999.99;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03263}03263\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03264}03264\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03265}03265\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03266}03266\ \ \ \mbox{\hyperlink{classMCMCProcessor_a28e89498420221149ec97c353c430bf8}{SampleValues}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}]();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03267}03267\ \ \ \mbox{\hyperlink{classMCMCProcessor_a4eb2748c81b0aef9bd7e14785559e301}{SystValues}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}]();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03268}03268\ \ \ \mbox{\hyperlink{classMCMCProcessor_a88cab29770fd6098a674a0ab3628a251}{AccProbValues}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}]();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03269}03269\ \ \ \mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{int}[\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}]();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03270}03270\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03271}03271\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03272}03272\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28e89498420221149ec97c353c430bf8}{SampleValues}}[i]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classMCMCProcessor_a419d3669dbb54a55a635e35691134cc1}{nSamples}}]();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03273}03273\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4eb2748c81b0aef9bd7e14785559e301}{SystValues}}[i]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classMCMCProcessor_adf518be96278f1d3901404cfbe767b67}{nSysts}}]();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03274}03274\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03275}03275\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_a419d3669dbb54a55a635e35691134cc1}{nSamples}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03276}03276\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28e89498420221149ec97c353c430bf8}{SampleValues}}[i][j]\ =\ -\/999.99;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03277}03277\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03278}03278\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_adf518be96278f1d3901404cfbe767b67}{nSysts}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03279}03279\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4eb2748c81b0aef9bd7e14785559e301}{SystValues}}[i][j]\ =\ -\/999.99;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03280}03280\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03281}03281\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a88cab29770fd6098a674a0ab3628a251}{AccProbValues}}[i]\ =\ -\/999.99;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03282}03282\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03283}03283\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}[i]\ =\ -\/999.99;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03284}03284\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03285}03285\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03286}03286\ \ \ \textcolor{comment}{//\ Initialise\ the\ sums}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03287}03287\ \ \ \mbox{\hyperlink{classMCMCProcessor_a7db98c7cf390b050f1acb927b4f55cab}{ParamSums}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}]();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03288}03288\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03289}03289\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a7db98c7cf390b050f1acb927b4f55cab}{ParamSums}}[i]\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03290}03290\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03291}03291\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Reading\ input\ tree..."{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03292}03292\ \ \ TStopwatch\ clock;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03293}03293\ \ \ clock.Start();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03294}03294\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03295}03295\ \ \ \textcolor{comment}{//\ Set\ all\ the\ branches\ to\ off}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03296}03296\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchStatus(\textcolor{stringliteral}{"{}*"{}},\ \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03297}03297\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03298}03298\ \ \ \textcolor{comment}{//\ Turn\ on\ the\ branches\ which\ we\ want\ for\ parameters}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03299}03299\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03300}03300\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchStatus(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i].Data(),\ \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03301}03301\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03302}03302\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03303}03303\ \ \ \textcolor{comment}{//\ Turn\ on\ the\ branches\ which\ we\ want\ for\ LogL\ sample}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03304}03304\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a419d3669dbb54a55a635e35691134cc1}{nSamples}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03305}03305\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchStatus(\mbox{\hyperlink{classMCMCProcessor_a3660e404a6631cfa913a815481730a9b}{SampleName\_v}}[i].Data(),\ \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03306}03306\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03307}03307\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03308}03308\ \ \ \textcolor{comment}{//\ Turn\ on\ the\ branches\ which\ we\ want\ for\ LogL\ systs}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03309}03309\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_adf518be96278f1d3901404cfbe767b67}{nSysts}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03310}03310\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchStatus(\mbox{\hyperlink{classMCMCProcessor_acb1871575fdd3ae156aed4bf7c7a0a73}{SystName\_v}}[i].Data(),\ \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03311}03311\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03312}03312\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03313}03313\ \ \ \textcolor{comment}{//\ Turn\ on\ the\ branches\ which\ we\ want\ for\ acc\ prob}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03314}03314\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchStatus(\textcolor{stringliteral}{"{}accProb"{}},\ \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03315}03315\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03316}03316\ \ \ \textcolor{comment}{//\ Only\ needed\ for\ Geweke\ right\ now}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03317}03317\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchStatus(\textcolor{stringliteral}{"{}step"{}},\ \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03318}03318\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03319}03319\ \ \ \textcolor{comment}{//\ 10\ entries\ output}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03320}03320\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ countwidth\ =\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}/10;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03321}03321\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03322}03322\ \ \ \textcolor{comment}{//\ Can\ also\ do\ the\ batched\ means\ here\ to\ minimize\ excessive\ loops}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03323}03323\ \ \ \textcolor{comment}{//\ The\ length\ of\ each\ batch}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03324}03324\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ BatchLength\ =\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}/\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}+1;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03325}03325\ \ \ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}]();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03326}03326\ \ \ \mbox{\hyperlink{classMCMCProcessor_a523a223a4754c133121796f4591c7be3}{AccProbBatchedAverages}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}]();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03327}03327\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03328}03328\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03329}03329\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a523a223a4754c133121796f4591c7be3}{AccProbBatchedAverages}}[i]\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03330}03330\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03331}03331\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i][j]\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03332}03332\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03333}03333\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03334}03334\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03335}03335\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ entries}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03336}03336\ \ \ \textcolor{comment}{//KS:\ This\ is\ really\ a\ bottleneck\ right\ now,\ thus\ revisit\ with\ ROOT6\ https://pep-\/root6.github.io/docs/analysis/parallell/root.html}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03337}03337\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03338}03338\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03339}03339\ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ \%\ countwidth\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03340}03340\ \ \ \ \ \ \ \mbox{\hyperlink{namespaceMaCh3Utils_a4c8bdeb1d34606aed192e9f1311a72f5}{MaCh3Utils::PrintProgressBar}}(i,\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03341}03341\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03342}03342\ \ \ \ \ \textcolor{comment}{//\ Set\ the\ branch\ addresses\ for\ params}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03343}03343\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03344}03344\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchAddress(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[j].Data(),\ \&\mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03345}03345\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03346}03346\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03347}03347\ \ \ \ \ \textcolor{comment}{//\ Set\ the\ branch\ addresses\ for\ samples}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03348}03348\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_a419d3669dbb54a55a635e35691134cc1}{nSamples}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03349}03349\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchAddress(\mbox{\hyperlink{classMCMCProcessor_a3660e404a6631cfa913a815481730a9b}{SampleName\_v}}[j].Data(),\ \&\mbox{\hyperlink{classMCMCProcessor_a28e89498420221149ec97c353c430bf8}{SampleValues}}[i][j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03350}03350\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03351}03351\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03352}03352\ \ \ \ \ \textcolor{comment}{//\ Set\ the\ branch\ addresses\ for\ systematics}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03353}03353\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_adf518be96278f1d3901404cfbe767b67}{nSysts}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03354}03354\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchAddress(\mbox{\hyperlink{classMCMCProcessor_acb1871575fdd3ae156aed4bf7c7a0a73}{SystName\_v}}[j].Data(),\ \&\mbox{\hyperlink{classMCMCProcessor_a4eb2748c81b0aef9bd7e14785559e301}{SystValues}}[i][j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03355}03355\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03356}03356\ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03357}03357\ \ \ \ \ \textcolor{comment}{//\ Set\ the\ branch\ addresses\ for\ Acceptance\ Probability}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03358}03358\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchAddress(\textcolor{stringliteral}{"{}accProb"{}},\ \&\mbox{\hyperlink{classMCMCProcessor_a88cab29770fd6098a674a0ab3628a251}{AccProbValues}}[i]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03359}03359\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03360}03360\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchAddress(\textcolor{stringliteral}{"{}step"{}},\ \&\mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}[i]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03361}03361\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03362}03362\ \ \ \ \ \textcolor{comment}{//\ Fill\ up\ the\ arrays}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03363}03363\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetEntry(i);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03364}03364\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03365}03365\ \ \ \ \ \textcolor{comment}{//\ Find\ which\ batch\ the\ event\ belongs\ in}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03366}03366\ \ \ \ \ \textcolor{keywordtype}{int}\ BatchNumber\ =\ -\/1;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03367}03367\ \ \ \ \ \textcolor{comment}{//\ I'm\ so\ lazy!\ But\ it's\ OK,\ the\ major\ overhead\ here\ is\ GetEntry:\ saved\ by\ ROOT!}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03368}03368\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03369}03369\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ <\ (j+1)*BatchLength)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03370}03370\ \ \ \ \ \ \ \ \ BatchNumber\ =\ j;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03371}03371\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03372}03372\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03373}03373\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03374}03374\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03375}03375\ \ \ \ \ \textcolor{comment}{//\ Fill\ up\ the\ sum\ for\ each\ j\ param}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03376}03376\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03377}03377\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a7db98c7cf390b050f1acb927b4f55cab}{ParamSums}}[j]\ +=\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03378}03378\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[BatchNumber][j]\ +=\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03379}03379\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03380}03380\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03381}03381\ \ \ \ \ \textcolor{comment}{//KS:\ Could\ easily\ add\ this\ to\ above\ loop\ but\ I\ accProb\ is\ different\ beast\ so\ better\ keep\ it\ like\ this}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03382}03382\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a523a223a4754c133121796f4591c7be3}{AccProbBatchedAverages}}[BatchNumber]\ +=\ \mbox{\hyperlink{classMCMCProcessor_a88cab29770fd6098a674a0ab3628a251}{AccProbValues}}[i];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03383}03383\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03384}03384\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03385}03385\ \ \ clock.Stop();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03386}03386\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Took\ \{:.2f\}s\ to\ finish\ caching\ statistic\ for\ Diag\ MCMC\ with\ \{\}\ steps"{}},\ clock.RealTime(),\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03387}03387\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03388}03388\ \ \ \textcolor{comment}{//\ Make\ the\ sums\ into\ average}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03389}03389\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03390}03390\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03391}03391\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03392}03392\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03393}03393\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a7db98c7cf390b050f1acb927b4f55cab}{ParamSums}}[i]\ /=\ double(\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03394}03394\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03395}03395\ \ \ \ \ \ \ \textcolor{comment}{//\ Divide\ by\ the\ total\ number\ of\ events\ in\ the\ batch}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03396}03396\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[j][i]\ /=\ BatchLength;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03397}03397\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(i\ ==\ 0)\ \mbox{\hyperlink{classMCMCProcessor_a523a223a4754c133121796f4591c7be3}{AccProbBatchedAverages}}[j]\ /=\ BatchLength;\ \textcolor{comment}{//KS:\ we\ have\ only\ one\ accProb,\ keep\ it\ like\ this\ for\ now}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03398}03398\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03399}03399\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03400}03400\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03401}03401\ \ \ \textcolor{comment}{//\ And\ make\ our\ sweet\ output\ file}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03402}03402\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_aa5a7761e97cf2e24c7d877a5374b7333}{MakeOutputFile}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03403}03403\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03404}03404\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03405}03405\ \textcolor{comment}{//\ *****************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03406}03406\ \textcolor{comment}{//CW:\ Draw\ trace\ plots\ of\ the\ parameters\ i.e.\ parameter\ vs\ step}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03407}\mbox{\hyperlink{classMCMCProcessor_a929d6efec80bb4de05eea7011257439a}{03407}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_a929d6efec80bb4de05eea7011257439a}{MCMCProcessor::ParamTraces}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03408}03408\ \textcolor{comment}{//\ *****************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03409}03409\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03410}03410\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_a930cadafa41b31b58066dea68628de9f}{PrepareDiagMCMC}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03411}03411\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ trace\ plots..."{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03412}03412\ \ \ \textcolor{comment}{//\ Make\ the\ TH1Ds}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03413}03413\ \ \ TH1D**\ TraceParamPlots\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03414}03414\ \ \ TH1D**\ TraceSamplePlots\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classMCMCProcessor_a419d3669dbb54a55a635e35691134cc1}{nSamples}}];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03415}03415\ \ \ TH1D**\ TraceSystsPlots\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classMCMCProcessor_adf518be96278f1d3901404cfbe767b67}{nSysts}}];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03416}03416\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03417}03417\ \ \ \textcolor{comment}{//\ Set\ the\ titles\ and\ limits\ for\ TH2Ds}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03418}03418\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03419}03419\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03420}03420\ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03421}03421\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03422}03422\ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03423}03423\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03424}03424\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(j,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03425}03425\ \ \ \ \ std::string\ HistName\ =\ Form(\textcolor{stringliteral}{"{}\%s\_\%s\_Trace"{}},\ Title.Data(),\ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[j].Data());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03426}03426\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03427}03427\ \ \ \ \ TraceParamPlots[j]\ =\ \textcolor{keyword}{new}\ TH1D(HistName.c\_str(),\ HistName.c\_str(),\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03428}03428\ \ \ \ \ TraceParamPlots[j]-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Step"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03429}03429\ \ \ \ \ TraceParamPlots[j]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Parameter\ Variation"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03430}03430\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03431}03431\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03432}03432\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_a419d3669dbb54a55a635e35691134cc1}{nSamples}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03433}03433\ \ \ \ \ std::string\ HistName\ =\ \mbox{\hyperlink{classMCMCProcessor_a3660e404a6631cfa913a815481730a9b}{SampleName\_v}}[j].Data();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03434}03434\ \ \ \ \ TraceSamplePlots[j]\ =\ \textcolor{keyword}{new}\ TH1D(HistName.c\_str(),\ HistName.c\_str(),\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03435}03435\ \ \ \ \ TraceSamplePlots[j]-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Step"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03436}03436\ \ \ \ \ TraceSamplePlots[j]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Sample\ -\/logL"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03437}03437\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03438}03438\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03439}03439\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_adf518be96278f1d3901404cfbe767b67}{nSysts}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03440}03440\ \ \ \ \ std::string\ HistName\ =\ \mbox{\hyperlink{classMCMCProcessor_acb1871575fdd3ae156aed4bf7c7a0a73}{SystName\_v}}[j].Data();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03441}03441\ \ \ \ \ TraceSystsPlots[j]\ =\ \textcolor{keyword}{new}\ TH1D(HistName.c\_str(),\ HistName.c\_str(),\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03442}03442\ \ \ \ \ TraceSystsPlots[j]-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Step"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03443}03443\ \ \ \ \ TraceSystsPlots[j]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Systematic\ -\/logL"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03444}03444\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03445}03445\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03446}03446\ \ \ \textcolor{comment}{//\ Have\ now\ made\ the\ empty\ TH1Ds,\ now\ for\ writing\ content\ to\ them!}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03447}03447\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03448}03448\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ number\ of\ parameters\ to\ draw\ their\ traces}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03449}03449\ \ \ \textcolor{comment}{//\ Each\ histogram}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03450}03450\ \textcolor{preprocessor}{\#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03451}03451\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Using\ multi-\/threading..."{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03452}03452\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03453}03453\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03454}03454\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03455}03455\ \ \ \ \ \textcolor{comment}{//\ Set\ bin\ content\ for\ the\ ith\ bin\ to\ the\ parameter\ values}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03456}03456\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03457}03457\ \ \ \ \ \ \ TraceParamPlots[j]-\/>SetBinContent(i,\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03458}03458\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03459}03459\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03460}03460\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_a419d3669dbb54a55a635e35691134cc1}{nSamples}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03461}03461\ \ \ \ \ \ \ TraceSamplePlots[j]-\/>SetBinContent(i,\ \mbox{\hyperlink{classMCMCProcessor_a28e89498420221149ec97c353c430bf8}{SampleValues}}[i][j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03462}03462\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03463}03463\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03464}03464\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_adf518be96278f1d3901404cfbe767b67}{nSysts}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03465}03465\ \ \ \ \ \ \ TraceSystsPlots[j]-\/>SetBinContent(i,\ \mbox{\hyperlink{classMCMCProcessor_a4eb2748c81b0aef9bd7e14785559e301}{SystValues}}[i][j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03466}03466\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03467}03467\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03468}03468\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03469}03469\ \ \ \textcolor{comment}{//\ Write\ the\ output\ and\ delete\ the\ TH2Ds}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03470}03470\ \ \ TDirectory\ *TraceDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}Trace"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03471}03471\ \ \ TraceDir-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03472}03472\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03473}03473\ \ \ \ \ \textcolor{comment}{//\ Fit\ a\ linear\ function\ to\ the\ traces}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03474}03474\ \ \ \ \ TF1\ *Fitter\ =\ \textcolor{keyword}{new}\ TF1(\textcolor{stringliteral}{"{}Fitter"{}},\textcolor{stringliteral}{"{}[0]"{}},\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}/2,\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03475}03475\ \ \ \ \ Fitter-\/>SetLineColor(kRed);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03476}03476\ \ \ \ \ TraceParamPlots[j]-\/>Fit(\textcolor{stringliteral}{"{}Fitter"{}},\textcolor{stringliteral}{"{}Rq"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03477}03477\ \ \ \ \ TraceParamPlots[j]-\/>Write();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03478}03478\ \ \ \ \ \textcolor{keyword}{delete}\ Fitter;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03479}03479\ \ \ \ \ \textcolor{keyword}{delete}\ TraceParamPlots[j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03480}03480\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03481}03481\ \ \ \textcolor{keyword}{delete}[]\ TraceParamPlots;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03482}03482\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03483}03483\ \ \ TDirectory\ *LLDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}LogL"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03484}03484\ \ \ LLDir-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03485}03485\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_a419d3669dbb54a55a635e35691134cc1}{nSamples}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03486}03486\ \ \ \ \ TraceSamplePlots[j]-\/>Write();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03487}03487\ \ \ \ \ \textcolor{keyword}{delete}\ TraceSamplePlots[j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03488}03488\ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a28e89498420221149ec97c353c430bf8}{SampleValues}}[j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03489}03489\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03490}03490\ \ \ \textcolor{keyword}{delete}[]\ TraceSamplePlots;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03491}03491\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a28e89498420221149ec97c353c430bf8}{SampleValues}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03492}03492\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03493}03493\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_adf518be96278f1d3901404cfbe767b67}{nSysts}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03494}03494\ \ \ \ \ TraceSystsPlots[j]-\/>Write();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03495}03495\ \ \ \ \ \textcolor{keyword}{delete}\ TraceSystsPlots[j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03496}03496\ \ \ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a4eb2748c81b0aef9bd7e14785559e301}{SystValues}}[j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03497}03497\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03498}03498\ \ \ \textcolor{keyword}{delete}[]\ TraceSystsPlots;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03499}03499\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a4eb2748c81b0aef9bd7e14785559e301}{SystValues}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03500}03500\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03501}03501\ \ \ TraceDir-\/>Close();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03502}03502\ \ \ \textcolor{keyword}{delete}\ TraceDir;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03503}03503\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03504}03504\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03505}03505\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03506}03506\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03507}03507\ \textcolor{comment}{//\ *********************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03508}03508\ \textcolor{comment}{//KS:\ Calculate\ autocorrelations\ supports\ both\ OpenMP\ and\ CUDA\ :)}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03509}\mbox{\hyperlink{classMCMCProcessor_a322bee0c362ba83df8c45769d299ce9f}{03509}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_a322bee0c362ba83df8c45769d299ce9f}{MCMCProcessor::AutoCorrelation}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03510}03510\ \textcolor{comment}{//\ *********************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03511}03511\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03512}03512\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_a930cadafa41b31b58066dea68628de9f}{PrepareDiagMCMC}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03513}03513\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03514}03514\ \ \ TStopwatch\ clock;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03515}03515\ \ \ clock.Start();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03516}03516\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nLags\ =\ \mbox{\hyperlink{classMCMCProcessor_a6156bba72e1f076e66f0356e48506a36}{AutoCorrLag}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03517}03517\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ auto-\/correlations\ for\ nLags\ =\ \{\}"{}},\ nLags);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03518}03518\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03519}03519\ \ \ \textcolor{comment}{//\ The\ sum\ of\ (Y-\/Ymean)\string^2\ over\ all\ steps\ for\ each\ parameter}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03520}03520\ \ \ \textcolor{keywordtype}{double}\ **DenomSum\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}]();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03521}03521\ \ \ \textcolor{keywordtype}{double}\ **NumeratorSum\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}]();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03522}03522\ \ \ \textcolor{keywordtype}{double}\ **LagL\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03523}03523\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03524}03524\ \ \ \ \ DenomSum[j]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[nLags];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03525}03525\ \ \ \ \ NumeratorSum[j]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[nLags];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03526}03526\ \ \ \ \ LagL[j]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[nLags];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03527}03527\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03528}03528\ \ \ TH1D**\ LagKPlots\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03529}03529\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ parameters\ of\ interest}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03530}03530\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03531}03531\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03532}03532\ \ \ \ \ \textcolor{comment}{//\ Loop\ over\ each\ lag}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03533}03533\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ nLags;\ ++k)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03534}03534\ \ \ \ \ \ \ NumeratorSum[j][k]\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03535}03535\ \ \ \ \ \ \ DenomSum[j][k]\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03536}03536\ \ \ \ \ \ \ LagL[j][k]\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03537}03537\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03538}03538\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03539}03539\ \ \ \ \ \textcolor{comment}{//\ Make\ TH1Ds\ for\ each\ parameter\ which\ hold\ the\ lag}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03540}03540\ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03541}03541\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03542}03542\ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03543}03543\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03544}03544\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(j,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03545}03545\ \ \ \ \ std::string\ HistName\ =\ Form(\textcolor{stringliteral}{"{}\%s\_\%s\_Lag"{}},\ Title.Data(),\ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[j].Data());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03546}03546\ \ \ \ \ LagKPlots[j]\ =\ \textcolor{keyword}{new}\ TH1D(HistName.c\_str(),\ HistName.c\_str(),\ nLags,\ 0.0,\ nLags);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03547}03547\ \ \ \ \ LagKPlots[j]-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Lag"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03548}03548\ \ \ \ \ LagKPlots[j]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Auto-\/correlation\ function"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03549}03549\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03550}03550\ \textcolor{comment}{//KS:\ If\ CUDA\ is\ not\ enabled\ do\ calculations\ on\ CPU}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03551}03551\ \textcolor{preprocessor}{\#ifndef\ CUDA}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03552}03552\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ lags}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03553}03553\ \ \ \textcolor{comment}{//CW:\ Each\ lag\ is\ independent\ so\ might\ as\ well\ multi-\/thread\ them!}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03554}03554\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03555}03555\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Using\ multi-\/threading..."{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03556}03556\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for\ collapse(2)}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03557}03557\ \textcolor{preprocessor}{\ \ \#endif\ \ \ \ \ \ }\textcolor{comment}{//\ Loop\ over\ the\ number\ of\ parameters}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03558}03558\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03559}03559\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ nLags;\ ++k)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03560}03560\ \ \ \ \ \ \ \textcolor{comment}{//\ Loop\ over\ the\ number\ of\ entries}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03561}03561\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03562}03562\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Diff\ =\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i]-\/\mbox{\hyperlink{classMCMCProcessor_a7db98c7cf390b050f1acb927b4f55cab}{ParamSums}}[j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03563}03563\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03564}03564\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Only\ sum\ the\ numerator\ up\ to\ i\ =\ N-\/k}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03565}03565\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}-\/k)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03566}03566\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ LagTerm\ =\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i+k]-\/\mbox{\hyperlink{classMCMCProcessor_a7db98c7cf390b050f1acb927b4f55cab}{ParamSums}}[j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03567}03567\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Product\ =\ Diff*LagTerm;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03568}03568\ \ \ \ \ \ \ \ \ \ \ NumeratorSum[j][k]\ +=\ Product;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03569}03569\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03570}03570\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03571}03571\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Square\ the\ difference\ to\ form\ the\ denominator}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03572}03572\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Denom\ =\ Diff*Diff;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03573}03573\ \ \ \ \ \ \ \ \ DenomSum[j][k]\ +=\ Denom;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03574}03574\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03575}03575\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03576}03576\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03577}03577\ \textcolor{preprocessor}{\#else\ }\textcolor{comment}{//NOW\ GPU\ specific\ code}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03578}03578\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Using\ GPU"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03579}03579\ \ \ \textcolor{comment}{//KS:\ This\ allocates\ memory\ and\ copy\ data\ from\ CPU\ to\ GPU}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03580}03580\ \ \ PrepareGPU\_AutoCorr(nLags);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03581}03581\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03582}03582\ \ \ \textcolor{comment}{//KS:\ This\ runs\ the\ main\ kernel\ and\ copy\ results\ back\ to\ CPU}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03583}03583\ \ \ \mbox{\hyperlink{gpuMCMCProcessorUtils_8cu_a809672193d24a096e6d4865109357070}{RunGPU\_AutoCorr}}(}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03584}03584\ \ \ \ \ ParStep\_gpu,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03585}03585\ \ \ \ \ ParamSums\_gpu,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03586}03586\ \ \ \ \ NumeratorSum\_gpu,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03587}03587\ \ \ \ \ DenomSum\_gpu,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03588}03588\ \ \ \ \ NumeratorSum\_cpu,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03589}03589\ \ \ \ \ DenomSum\_cpu);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03590}03590\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03591}03591\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03592}03592\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for\ collapse(2)}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03593}03593\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03594}03594\ \ \ \textcolor{comment}{//KS:\ Now\ that\ that\ we\ received\ data\ from\ GPU\ convert\ it\ to\ CPU-\/like\ format}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03595}03595\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03596}03596\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03597}03597\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ nLags;\ ++k)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03598}03598\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03599}03599\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ temp\_index\ =\ j*nLags+k;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03600}03600\ \ \ \ \ \ \ NumeratorSum[j][k]\ =\ NumeratorSum\_cpu[temp\_index];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03601}03601\ \ \ \ \ \ \ DenomSum[j][k]\ =\ DenomSum\_cpu[temp\_index];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03602}03602\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03603}03603\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03604}03604\ \ \ \textcolor{comment}{//delete\ auxiliary\ variables}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03605}03605\ \ \ \textcolor{keyword}{delete}[]\ NumeratorSum\_cpu;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03606}03606\ \ \ \textcolor{keyword}{delete}[]\ DenomSum\_cpu;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03607}03607\ \ \ \textcolor{keyword}{delete}[]\ ParStep\_cpu;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03608}03608\ \ \ \textcolor{keyword}{delete}[]\ ParamSums\_cpu;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03609}03609\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03610}03610\ \ \ \textcolor{comment}{//KS:\ Delete\ stuff\ at\ GPU\ as\ well}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03611}03611\ \ \ \mbox{\hyperlink{gpuMCMCProcessorUtils_8cu_abb46837d774b5be81a6c601c762ab05a}{CleanupGPU\_AutoCorr}}(}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03612}03612\ \ \ \ \ \ \ ParStep\_gpu,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03613}03613\ \ \ \ \ \ \ NumeratorSum\_gpu,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03614}03614\ \ \ \ \ \ \ ParamSums\_gpu,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03615}03615\ \ \ \ \ \ \ DenomSum\_gpu);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03616}03616\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03617}03617\ \textcolor{comment}{//KS:\ End\ of\ GPU\ specific\ code}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03618}03618\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03619}03619\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03620}03620\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03621}03621\ \ \ TDirectory\ *AutoCorrDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}Auto\_corr"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03622}03622\ \ \ \textcolor{comment}{//\ Now\ fill\ the\ LagK\ auto-\/correlation\ plots}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03623}03623\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03624}03624\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ nLags;\ ++k)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03625}03625\ \ \ \ \ \ \ LagL[j][k]\ =\ NumeratorSum[j][k]/DenomSum[j][k];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03626}03626\ \ \ \ \ \ \ LagKPlots[j]-\/>SetBinContent(k,\ NumeratorSum[j][k]/DenomSum[j][k]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03627}03627\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03628}03628\ \ \ \ \ AutoCorrDir-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03629}03629\ \ \ \ \ LagKPlots[j]-\/>Write();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03630}03630\ \ \ \ \ \textcolor{keyword}{delete}\ LagKPlots[j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03631}03631\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03632}03632\ \ \ \textcolor{keyword}{delete}[]\ LagKPlots;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03633}03633\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03634}03634\ \ \ \textcolor{comment}{//KS:\ This\ is\ different\ diagnostic\ however\ it\ relies\ on\ calculated\ Lag,\ thus\ we\ call\ it\ before\ we\ delete\ LagKPlots}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03635}03635\ \ \ \mbox{\hyperlink{classMCMCProcessor_add7add4eeddec946bad2645804aefd88}{CalculateESS}}(nLags,\ LagL);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03636}03636\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03637}03637\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03638}03638\ \ \ \ \ \textcolor{keyword}{delete}[]\ NumeratorSum[j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03639}03639\ \ \ \ \ \textcolor{keyword}{delete}[]\ DenomSum[j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03640}03640\ \ \ \ \ \textcolor{keyword}{delete}[]\ LagL[j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03641}03641\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03642}03642\ \ \ \textcolor{keyword}{delete}[]\ NumeratorSum;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03643}03643\ \ \ \textcolor{keyword}{delete}[]\ DenomSum;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03644}03644\ \ \ \textcolor{keyword}{delete}[]\ LagL;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03645}03645\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a7db98c7cf390b050f1acb927b4f55cab}{ParamSums}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03646}03646\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03647}03647\ \ \ AutoCorrDir-\/>Close();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03648}03648\ \ \ \textcolor{keyword}{delete}\ AutoCorrDir;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03649}03649\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03650}03650\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03651}03651\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03652}03652\ \ \ clock.Stop();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03653}03653\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ auto-\/correlations\ took\ \{:.2f\}s"{}},\ clock.RealTime());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03654}03654\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03655}03655\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03656}03656\ \textcolor{preprocessor}{\#ifdef\ CUDA}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03657}03657\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03658}03658\ \textcolor{comment}{//KS:\ Allocates\ memory\ and\ copy\ data\ from\ CPU\ to\ GPU}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03659}03659\ \textcolor{keywordtype}{void}\ MCMCProcessor::PrepareGPU\_AutoCorr(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nLags)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03660}03660\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03661}03661\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03662}03662\ \ \ \textcolor{comment}{//KS:\ Create\ temporary\ arrays\ that\ will\ communicate\ with\ GPU\ code}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03663}03663\ \ \ ParStep\_cpu\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{float}[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}*\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03664}03664\ \ \ NumeratorSum\_cpu\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{float}[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}*nLags];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03665}03665\ \ \ DenomSum\_cpu\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{float}[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}*nLags];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03666}03666\ \ \ ParamSums\_cpu\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{float}[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03667}03667\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03668}03668\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03669}03669\ \ \ \textcolor{comment}{//KS:\ Open\ parallel\ region}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03670}03670\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03671}03671\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03672}03672\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03673}03673\ \ \ \ \ \textcolor{comment}{//KS:\ Operations\ are\ independent\ thus\ we\ are\ using\ nowait\ close}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03674}03674\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03675}03675\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ for\ nowait}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03676}03676\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03677}03677\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03678}03678\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03679}03679\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ We\ basically\ need\ this\ to\ convert\ from\ double\ to\ float\ for\ GPU}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03680}03680\ \ \ \ \ \ \ ParamSums\_cpu[i]\ \ =\ \mbox{\hyperlink{classMCMCProcessor_a7db98c7cf390b050f1acb927b4f55cab}{ParamSums}}[i];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03681}03681\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03682}03682\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03683}03683\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03684}03684\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ for\ collapse(2)\ nowait}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03685}03685\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03686}03686\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03687}03687\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03688}03688\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ nLags;\ ++k)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03689}03689\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03690}03690\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ temp\ =\ j*nLags+k;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03691}03691\ \ \ \ \ \ \ \ \ NumeratorSum\_cpu[temp]\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03692}03692\ \ \ \ \ \ \ \ \ DenomSum\_cpu[temp]\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03693}03693\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03694}03694\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03695}03695\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03696}03696\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03697}03697\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ for\ collapse(2)}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03698}03698\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03699}03699\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03700}03700\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03701}03701\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03702}03702\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03703}03703\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ temp\ =\ j*\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}+i;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03704}03704\ \ \ \ \ \ \ \ \ ParStep\_cpu[temp]\ =\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03705}03705\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03706}03706\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03707}03707\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03708}03708\ \ \ \textcolor{comment}{//KS:\ End\ parallel\ region}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03709}03709\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03710}03710\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03711}03711\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03712}03712\ \ \ \textcolor{comment}{//KS:\ First\ allocate\ memory\ on\ GPU}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03713}03713\ \ \ \mbox{\hyperlink{gpuMCMCProcessorUtils_8cu_a5f83eaf9a69d10b00a4078608bdd0674}{InitGPU\_AutoCorr}}(\&ParStep\_gpu,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03714}03714\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&NumeratorSum\_gpu,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03715}03715\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&ParamSums\_gpu,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03716}03716\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&DenomSum\_gpu,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03717}03717\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03718}03718\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}},}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03719}03719\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03720}03720\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nLags);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03721}03721\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03722}03722\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03723}03723\ \ \ \textcolor{comment}{//KS:\ Now\ copy\ from\ CPU\ to\ GPU}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03724}03724\ \ \ \mbox{\hyperlink{gpuMCMCProcessorUtils_8cu_a6388d047bba2ea16de2bcb73ca0e398c}{CopyToGPU\_AutoCorr}}(ParStep\_cpu,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03725}03725\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NumeratorSum\_cpu,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03726}03726\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ParamSums\_cpu,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03727}03727\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ DenomSum\_cpu,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03728}03728\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03729}03729\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ParStep\_gpu,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03730}03730\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NumeratorSum\_gpu,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03731}03731\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ParamSums\_gpu,}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03732}03732\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ DenomSum\_gpu);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03733}03733\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03734}03734\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03735}03735\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03736}03736\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03737}03737\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03738}03738\ \textcolor{comment}{//\ KS:\ calc\ Effective\ Sample\ Size\ Following\ @cite\ StanManual}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03739}03739\ \textcolor{comment}{//\ Furthermore\ we\ calculate\ Sampling\ efficiency\ following\ @cite\ hanson2008mcmc}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03740}03740\ \textcolor{comment}{//\ Rule\ of\ thumb\ is\ to\ have\ efficiency\ above\ 25\%}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03741}\mbox{\hyperlink{classMCMCProcessor_add7add4eeddec946bad2645804aefd88}{03741}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_add7add4eeddec946bad2645804aefd88}{MCMCProcessor::CalculateESS}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nLags,\ \textcolor{keywordtype}{double}**\ LagL)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03742}03742\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03743}03743\ \ \ \textcolor{keywordflow}{if}(LagL\ ==\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03744}03744\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03745}03745\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}LagL\ is\ nullptr"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03746}03746\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03747}03747\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03748}03748\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ ESS\ plots..."{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03749}03749\ \ \ TVectorD*\ \mbox{\hyperlink{RHat_8cpp_ae673254e98992bd483de55c6c1d1dcaf}{EffectiveSampleSize}}\ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03750}03750\ \ \ TVectorD*\ SamplingEfficiency\ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03751}03751\ \ \ std::vector<double>\ TempDenominator(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03752}03752\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03753}03753\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ Nhists\ =\ 5;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03754}03754\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{double}\ Thresholds[Nhists\ +\ 1]\ =\ \{1,\ 0.02,\ 0.005,\ 0.001,\ 0.0001,\ 0.0\};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03755}03755\ \ \ \textcolor{keyword}{constexpr}\ Color\_t\ ESSColours[Nhists]\ =\ \{kGreen,\ kGreen\ +\ 2,\ kYellow,\ kOrange,\ kRed\};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03756}03756\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03757}03757\ \ \ \textcolor{comment}{//KS:\ This\ histogram\ is\ inspired\ by\ the\ following:\ @cite\ gabry2024visual}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03758}03758\ \ \ std::vector<std::unique\_ptr<TH1D>>\ EffectiveSampleSizeHist(Nhists);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03759}03759\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ Nhists;\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03760}03760\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03761}03761\ \ \ \ \ EffectiveSampleSizeHist[i]\ =}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03762}03762\ \ \ \ \ \ \ std::make\_unique<TH1D>(Form(\textcolor{stringliteral}{"{}EffectiveSampleSizeHist\_\%i"{}},\ i),\ Form(\textcolor{stringliteral}{"{}EffectiveSampleSizeHist\_\%i"{}},\ i),\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03763}03763\ \ \ \ \ EffectiveSampleSizeHist[i]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}N\_\{eff\}/N"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03764}03764\ \ \ \ \ EffectiveSampleSizeHist[i]-\/>SetFillColor(ESSColours[i]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03765}03765\ \ \ \ \ EffectiveSampleSizeHist[i]-\/>SetLineColor(ESSColours[i]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03766}03766\ \ \ \ \ EffectiveSampleSizeHist[i]-\/>Sumw2();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03767}03767\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03768}03768\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03769}03769\ \ \ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03770}03770\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03771}03771\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03772}03772\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(j,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03773}03773\ \ \ \ \ \ \ EffectiveSampleSizeHist[i]-\/>GetXaxis()-\/>SetBinLabel(j+1,\ Title.Data());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03774}03774\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03775}03775\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03776}03776\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03777}03777\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03778}03778\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03779}03779\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03780}03780\ \ \ \textcolor{comment}{//KS:\ Calculate\ ESS\ and\ MCMC\ efficiency\ for\ each\ parameter}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03781}03781\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03782}03782\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03783}03783\ \ \ \ \ (*EffectiveSampleSize)(j)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03784}03784\ \ \ \ \ (*SamplingEfficiency)(j)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03785}03785\ \ \ \ \ TempDenominator[j]\ =\ 0.;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03786}03786\ \ \ \ \ \textcolor{comment}{//KS:\ Firs\ sum\ over\ all\ Calculated\ autocorrelations}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03787}03787\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ nLags;\ ++k)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03788}03788\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03789}03789\ \ \ \ \ \ \ TempDenominator[j]\ +=\ LagL[j][k];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03790}03790\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03791}03791\ \ \ \ \ TempDenominator[j]\ =\ 1+2*TempDenominator[j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03792}03792\ \ \ \ \ (*EffectiveSampleSize)(j)\ =\ \textcolor{keywordtype}{double}(\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}})/TempDenominator[j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03793}03793\ \ \ \ \ \textcolor{comment}{//\ 100\ because\ we\ convert\ to\ percentage}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03794}03794\ \ \ \ \ (*SamplingEfficiency)(j)\ =\ 100\ *\ 1/TempDenominator[j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03795}03795\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03796}03796\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ Nhists;\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03797}03797\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03798}03798\ \ \ \ \ \ \ EffectiveSampleSizeHist[i]-\/>SetBinContent(j+1,\ 0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03799}03799\ \ \ \ \ \ \ EffectiveSampleSizeHist[i]-\/>SetBinError(j+1,\ 0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03800}03800\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03801}03801\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ TempEntry\ =\ std::fabs((*\mbox{\hyperlink{RHat_8cpp_ae673254e98992bd483de55c6c1d1dcaf}{EffectiveSampleSize}})(j))\ /\ double(\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03802}03802\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(Thresholds[i]\ >=\ TempEntry\ \&\&\ TempEntry\ >\ Thresholds[i+1])}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03803}03803\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03804}03804\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ std::isnan((*\mbox{\hyperlink{RHat_8cpp_ae673254e98992bd483de55c6c1d1dcaf}{EffectiveSampleSize}})(j))\ )\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03805}03805\ \ \ \ \ \ \ \ \ EffectiveSampleSizeHist[i]-\/>SetBinContent(j+1,\ TempEntry);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03806}03806\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03807}03807\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03808}03808\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03809}03809\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03810}03810\ \ \ \textcolor{comment}{//KS\ Write\ to\ the\ output\ tree}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03811}03811\ \ \ \textcolor{comment}{//Save\ to\ file}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03812}03812\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03813}03813\ \ \ \mbox{\hyperlink{RHat_8cpp_ae673254e98992bd483de55c6c1d1dcaf}{EffectiveSampleSize}}-\/>Write(\textcolor{stringliteral}{"{}EffectiveSampleSize"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03814}03814\ \ \ SamplingEfficiency-\/>Write(\textcolor{stringliteral}{"{}SamplingEfficiency"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03815}03815\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03816}03816\ \ \ EffectiveSampleSizeHist[0]-\/>SetTitle(\textcolor{stringliteral}{"{}Effective\ Sample\ Size"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03817}03817\ \ \ EffectiveSampleSizeHist[0]-\/>Draw();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03818}03818\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ Nhists;\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03819}03819\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03820}03820\ \ \ \ \ EffectiveSampleSizeHist[i]-\/>Draw(\textcolor{stringliteral}{"{}SAME"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03821}03821\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03822}03822\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03823}03823\ \ \ \textcolor{keyword}{auto}\ leg\ =\ std::make\_unique<TLegend>(0.2,\ 0.7,\ 0.6,\ 0.95);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03824}03824\ \ \ leg-\/>SetTextSize(0.03);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03825}03825\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ Nhists;\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03826}03826\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03827}03827\ \ \ \ \ leg-\/>AddEntry(EffectiveSampleSizeHist[i].get(),\ Form(\textcolor{stringliteral}{"{}\%.4f\ >=\ N\_\{eff\}/N\ >\ \%.4f"{}},\ Thresholds[i],\ Thresholds[i+1]),\ \textcolor{stringliteral}{"{}f"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03828}03828\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03829}03829\ \ \ leg-\/>SetLineColor(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03830}03830\ \ \ leg-\/>SetLineStyle(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03831}03831\ \ \ leg-\/>SetFillColor(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03832}03832\ \ \ leg-\/>SetFillStyle(0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03833}03833\ \ \ leg-\/>Draw(\textcolor{stringliteral}{"{}SAME"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03834}03834\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03835}03835\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Write(\textcolor{stringliteral}{"{}EffectiveSampleSizeCanvas"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03836}03836\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03837}03837\ \ \ \textcolor{comment}{//Delete\ all\ variables}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03838}03838\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{RHat_8cpp_ae673254e98992bd483de55c6c1d1dcaf}{EffectiveSampleSize}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03839}03839\ \ \ \textcolor{keyword}{delete}\ SamplingEfficiency;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03840}03840\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03841}03841\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03842}03842\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03843}03843\ \textcolor{comment}{//CW:\ Batched\ means,\ literally\ read\ from\ an\ array\ and\ chuck\ into\ TH1D}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03844}\mbox{\hyperlink{classMCMCProcessor_af3658b8adee50f6ef5557ebbd1c87b8e}{03844}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_af3658b8adee50f6ef5557ebbd1c87b8e}{MCMCProcessor::BatchedMeans}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03845}03845\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03846}03846\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03847}03847\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_a930cadafa41b31b58066dea68628de9f}{PrepareDiagMCMC}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03848}03848\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ BatchedMeans\ plots..."{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03849}03849\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03850}03850\ \ \ TH1D\ **\ BatchedParamPlots\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03851}03851\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03852}03852\ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03853}03853\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03854}03854\ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03855}03855\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03856}03856\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(j,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03857}03857\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03858}03858\ \ \ \ \ std::string\ HistName\ =\ Form(\textcolor{stringliteral}{"{}\%s\_\%s\_batch"{}},\ Title.Data(),\ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[j].Data());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03859}03859\ \ \ \ \ BatchedParamPlots[j]\ =\ \textcolor{keyword}{new}\ TH1D(HistName.c\_str(),\ HistName.c\_str(),\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03860}03860\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03861}03861\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03862}03862\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03863}03863\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03864}03864\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03865}03865\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03866}03866\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03867}03867\ \ \ \ \ \ \ BatchedParamPlots[j]-\/>SetBinContent(i+1,\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i][j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03868}03868\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ BatchRangeLow\ =\ double(i)*double(\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}})/double(\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03869}03869\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ BatchRangeHigh\ =\ double(i+1)*double(\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}})/double(\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03870}03870\ \ \ \ \ \ \ std::stringstream\ ss;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03871}03871\ \ \ \ \ \ \ ss\ <<\ BatchRangeLow\ <<\ \textcolor{stringliteral}{"{}\ -\/\ "{}}\ <<\ BatchRangeHigh;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03872}03872\ \ \ \ \ \ \ BatchedParamPlots[j]-\/>GetXaxis()-\/>SetBinLabel(i+1,\ ss.str().c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03873}03873\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03874}03874\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03875}03875\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03876}03876\ \ \ TDirectory\ *BatchDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}Batched\_means"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03877}03877\ \ \ BatchDir-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03878}03878\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03879}03879\ \ \ \ \ TF1\ *Fitter\ =\ \textcolor{keyword}{new}\ TF1(\textcolor{stringliteral}{"{}Fitter"{}},\textcolor{stringliteral}{"{}[0]"{}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03880}03880\ \ \ \ \ Fitter-\/>SetLineColor(kRed);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03881}03881\ \ \ \ \ BatchedParamPlots[j]-\/>Fit(\textcolor{stringliteral}{"{}Fitter"{}},\textcolor{stringliteral}{"{}Rq"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03882}03882\ \ \ \ \ BatchedParamPlots[j]-\/>Write();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03883}03883\ \ \ \ \ \textcolor{keyword}{delete}\ Fitter;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03884}03884\ \ \ \ \ \textcolor{keyword}{delete}\ BatchedParamPlots[j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03885}03885\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03886}03886\ \ \ \textcolor{keyword}{delete}[]\ BatchedParamPlots;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03887}03887\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03888}03888\ \ \ \textcolor{comment}{//KS:\ Get\ the\ batched\ means\ variance\ estimation\ and\ variable\ indicating\ if\ number\ of\ batches\ is\ sensible}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03889}03889\ \ \ \textcolor{comment}{//\ We\ do\ this\ before\ deleting\ BatchedAverages}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03890}03890\ \ \ \mbox{\hyperlink{classMCMCProcessor_a29d492906e0c027d089331a0509cd2c3}{BatchedAnalysis}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03891}03891\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03892}03892\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03893}03893\ \ \ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03894}03894\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03895}03895\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03896}03896\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03897}03897\ \ \ BatchDir-\/>Close();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03898}03898\ \ \ \textcolor{keyword}{delete}\ BatchDir;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03899}03899\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03900}03900\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03901}03901\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03902}03902\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03903}03903\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03904}03904\ \textcolor{comment}{//\ Get\ the\ batched\ means\ variance\ estimation\ and\ variable\ indicating\ if\ number\ of\ batches\ is\ sensible}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03905}\mbox{\hyperlink{classMCMCProcessor_a29d492906e0c027d089331a0509cd2c3}{03905}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_a29d492906e0c027d089331a0509cd2c3}{MCMCProcessor::BatchedAnalysis}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03906}03906\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03907}03907\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}\ ==\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03908}03908\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03909}03909\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}BatchedAverages\ haven't\ been\ initialises\ or\ have\ been\ deleted\ something\ is\ wrong"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03910}03910\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}I\ need\ it\ and\ refuse\ to\ go\ further"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03911}03911\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03912}03912\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03913}03913\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03914}03914\ \ \ \textcolor{comment}{//\ Calculate\ variance\ estimator\ using\ batched\ means\ following\ @cite\ chakraborty2019estimating\ see\ Eq.\ 1.2}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03915}03915\ \ \ TVectorD*\ BatchedVariance\ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03916}03916\ \ \ \textcolor{comment}{//KS:\ The\ hypothesis\ is\ rejected\ if\ C\ >\ z\ α\ for\ a\ given\ confidence\ level\ α.\ If\ the\ batch\ means\ do\ not\ pass\ the\ test,\ Correlated\ is\ reported\ for\ the\ half-\/width\ on\ the\ statistical\ reports\ following\ @cite\ rossetti2024batch\ alternatively\ for\ more\ old-\/school\ see\ Alexopoulos\ and\ Seila\ 1998\ section\ 3.4.3}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03917}03917\ \ \ TVectorD*\ C\_Test\_Statistics\ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03918}03918\ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03919}03919\ \ \ std::vector<double>\ OverallBatchMean(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03920}03920\ \ \ std::vector<double>\ C\_Rho\_Nominator(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03921}03921\ \ \ std::vector<double>\ C\_Rho\_Denominator(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03922}03922\ \ \ std::vector<double>\ C\_Nominator(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03923}03923\ \ \ std::vector<double>\ C\_Denominator(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03924}03924\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ BatchLength\ =\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}/\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}+1;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03925}03925\ \textcolor{comment}{//KS:\ Start\ parallel\ region}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03926}03926\ \textcolor{preprocessor}{\#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03927}03927\ \textcolor{preprocessor}{\#pragma\ omp\ parallel}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03928}03928\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03929}03929\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03930}03930\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03931}03931\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ for}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03932}03932\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03933}03933\ \ \ \textcolor{comment}{//KS:\ First\ calculate\ mean\ of\ batched\ means\ for\ each\ param\ and\ Initialise\ everything\ to\ 0}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03934}03934\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03935}03935\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03936}03936\ \ \ \ \ OverallBatchMean[j]\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03937}03937\ \ \ \ \ C\_Rho\_Nominator[j]\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03938}03938\ \ \ \ \ C\_Rho\_Denominator[j]\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03939}03939\ \ \ \ \ C\_Nominator[j]\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03940}03940\ \ \ \ \ C\_Denominator[j]\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03941}03941\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03942}03942\ \ \ \ \ (*BatchedVariance)(j)\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03943}03943\ \ \ \ \ (*C\_Test\_Statistics)(j)\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03944}03944\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03945}03945\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03946}03946\ \ \ \ \ \ \ OverallBatchMean[j]\ +=\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i][j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03947}03947\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03948}03948\ \ \ \ \ OverallBatchMean[j]\ /=\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03949}03949\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03950}03950\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03951}03951\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03952}03952\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ for\ nowait}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03953}03953\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03954}03954\ \ \ \textcolor{comment}{//KS:\ next\ loop\ is\ completely\ independent\ thus\ nowait\ clause}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03955}03955\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03956}03956\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03957}03957\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03958}03958\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03959}03959\ \ \ \ \ \ \ (*BatchedVariance)(j)\ +=\ (OverallBatchMean[j]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i][j])*(OverallBatchMean[j]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i][j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03960}03960\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03961}03961\ \ \ \ \ (*BatchedVariance)(j)\ =\ (BatchLength/(\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}-\/1))*\ (*BatchedVariance)(j);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03962}03962\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03963}03963\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03964}03964\ \ \ \textcolor{comment}{//KS:\ Now\ we\ focus\ on\ C\ test\ statistic,\ again\ use\ nowait\ as\ next\ is\ calculation\ is\ independent}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03965}03965\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03966}03966\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ for\ nowait}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03967}03967\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03968}03968\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03969}03969\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03970}03970\ \ \ \ \ C\_Nominator[j]\ =\ (OverallBatchMean[j]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[0][j])*(OverallBatchMean[j]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[0][j])\ +\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03971}03971\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (OverallBatchMean[j]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}-\/1][j])*(OverallBatchMean[j]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}-\/1][j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03972}03972\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03973}03973\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03974}03974\ \ \ \ \ \ \ C\_Denominator[j]\ +=\ (OverallBatchMean[j]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i][j])*(OverallBatchMean[j]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i][j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03975}03975\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03976}03976\ \ \ \ \ C\_Denominator[j]\ =\ 2*C\_Denominator[j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03977}03977\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03978}03978\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03979}03979\ \ \ \textcolor{comment}{//KS:\ We\ still\ calculate\ C\ and\ for\ this\ we\ need\ rho\ wee\ need\ autocorrelations\ between\ batches}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03980}03980\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03981}03981\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ for}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03982}03982\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03983}03983\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03984}03984\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03985}03985\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}-\/1;\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03986}03986\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03987}03987\ \ \ \ \ \ \ C\_Rho\_Nominator[j]\ +=\ (OverallBatchMean[j]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i][j])*(OverallBatchMean[j]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i+1][j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03988}03988\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03989}03989\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03990}03990\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03991}03991\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03992}03992\ \ \ \ \ \ \ C\_Rho\_Denominator[j]\ +=\ (OverallBatchMean[j]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i][j])*(OverallBatchMean[j]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i][j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03993}03993\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03994}03994\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03995}03995\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03996}03996\ \ \ \textcolor{comment}{//KS:\ Final\ calculations\ of\ C}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03997}03997\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03998}03998\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ for}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l03999}03999\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04000}04000\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04001}04001\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04002}04002\ \ \ \ \ (*C\_Test\_Statistics)(j)\ =\ std::sqrt((\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}*\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}\ -\/\ 1)/(\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}-\/2))\ *\ (\ C\_Rho\_Nominator[j]/C\_Rho\_Denominator[j]\ +\ C\_Nominator[j]/\ C\_Denominator[j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04003}04003\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04004}04004\ \textcolor{preprocessor}{\#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04005}04005\ \}\ \textcolor{comment}{//End\ parallel\ region}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04006}04006\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04007}04007\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04008}04008\ \ \ \textcolor{comment}{//Save\ to\ file}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04009}04009\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04010}04010\ \ \ BatchedVariance-\/>Write(\textcolor{stringliteral}{"{}BatchedMeansVariance"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04011}04011\ \ \ C\_Test\_Statistics-\/>Write(\textcolor{stringliteral}{"{}C\_Test\_Statistics"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04012}04012\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04013}04013\ \ \ \textcolor{comment}{//Delete\ all\ variables}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04014}04014\ \ \ \textcolor{keyword}{delete}\ BatchedVariance;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04015}04015\ \ \ \textcolor{keyword}{delete}\ C\_Test\_Statistics;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04016}04016\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04017}04017\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04018}04018\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04019}04019\ \textcolor{comment}{//\ RC:\ Perform\ spectral\ analysis\ of\ MCMC\ based\ on\ @cite\ Dunkley:2004sv}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04020}\mbox{\hyperlink{classMCMCProcessor_aef760d8c4bb70690a5c4114f4b2409b3}{04020}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_aef760d8c4bb70690a5c4114f4b2409b3}{MCMCProcessor::PowerSpectrumAnalysis}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04021}04021\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04022}04022\ \ \ TStopwatch\ clock;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04023}04023\ \ \ clock.Start();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04024}04024\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04025}04025\ \ \ \textcolor{comment}{//KS:\ Store\ it\ as\ we\ go\ back\ to\ them\ at\ the\ end}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04026}04026\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ TopMargin\ \ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetTopMargin();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04027}04027\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ OptTitle\ =\ gStyle-\/>GetOptTitle();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04028}04028\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04029}04029\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTopMargin(0.1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04030}04030\ \ \ gStyle-\/>SetOptTitle(1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04031}04031\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04032}04032\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ Power\ Spectrum\ plots..."{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04033}04033\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04034}04034\ \ \ \textcolor{comment}{//\ This\ is\ only\ to\ reduce\ number\ of\ computations...}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04035}04035\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ N\_Coeffs\ =\ std::min(10000,\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04036}04036\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ start\ =\ -\/(N\_Coeffs/2-\/1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04037}04037\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ end\ =\ N\_Coeffs/2-\/1;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04038}04038\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ v\_size\ =\ end\ -\/\ start;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04039}04039\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04040}04040\ \ \ \textcolor{keywordtype}{int}\ nPrams\ =\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04042}04042\ \ \ nPrams\ =\ 2;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04043}04043\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04044}04044\ \ \ std::vector<std::vector<float>>\ k\_j(nPrams,\ std::vector<float>(v\_size,\ 0.0));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04045}04045\ \ \ std::vector<std::vector<float>>\ P\_j(nPrams,\ std::vector<float>(v\_size,\ 0.0));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04046}04046\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04047}04047\ \ \ \textcolor{keywordtype}{int}\ \_N\ =\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04048}04048\ \ \ \textcolor{keywordflow}{if}\ (\_N\ \%\ 2\ !=\ 0)\ \_N\ -\/=\ 1;\ \textcolor{comment}{//\ N\ must\ be\ even}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04049}04049\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04050}04050\ \ \ \textcolor{comment}{//This\ is\ being\ used\ a\ lot\ so\ calculate\ it\ once\ to\ increase\ performance}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04051}04051\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ two\_pi\_over\_N\ =\ 2\ *\ TMath::Pi()\ /\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(\_N);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04052}04052\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04053}04053\ \ \ \textcolor{comment}{//\ KS:\ This\ could\ be\ moved\ to\ GPU\ I\ guess}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04054}04054\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04055}04055\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for\ collapse(2)}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04056}04056\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04057}04057\ \ \ \textcolor{comment}{//\ RC:\ equation\ 11:\ for\ each\ value\ of\ j\ coef,\ from\ range\ -\/N/2\ -\/>\ N/2}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04058}04058\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nPrams;\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04059}04059\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04060}04060\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ jj\ =\ start;\ jj\ <\ end;\ ++jj)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04061}04061\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04062}04062\ \ \ \ \ \ \ std::complex<double>\ a\_j\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04063}04063\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ n\ =\ 0;\ n\ <\ \_N;\ ++n)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04064}04064\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04065}04065\ \ \ \ \ \ \ \ \ \textcolor{comment}{//if(StepNumber[n]\ <\ BurnInCut)\ continue;}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04066}04066\ \ \ \ \ \ \ \ \ std::complex<double>\ exp\_temp(0,\ two\_pi\_over\_N\ *\ jj\ *\ n);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04067}04067\ \ \ \ \ \ \ \ \ a\_j\ +=\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][n]\ *\ std::exp(exp\_temp);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04068}04068\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04069}04069\ \ \ \ \ \ \ a\_j\ /=\ std::sqrt(\textcolor{keywordtype}{float}(\_N));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04070}04070\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \_c\ =\ jj\ -\/\ start;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04071}04071\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04072}04072\ \ \ \ \ \ \ k\_j[j][\_c]\ =\ two\_pi\_over\_N\ *\ jj;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04073}04073\ \ \ \ \ \ \ \textcolor{comment}{//\ Equation\ 13}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04074}04074\ \ \ \ \ \ \ P\_j[j][\_c]\ =\ std::norm(a\_j);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04075}04075\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04076}04076\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04077}04077\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04078}04078\ \ \ TDirectory\ *PowerDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}PowerSpectrum"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04079}04079\ \ \ PowerDir-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04080}04080\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04081}04081\ \ \ TGraph\ **plot\ =\ \textcolor{keyword}{new}\ TGraph*[nPrams];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04082}04082\ \ \ TVectorD*\ PowerSpectrumStepSize\ =\ \textcolor{keyword}{new}\ TVectorD(nPrams);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04083}04083\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nPrams;\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04084}04084\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04085}04085\ \ \ \ \ plot[j]\ =\ \textcolor{keyword}{new}\ TGraph(v\_size,\ k\_j[j].data(),\ P\_j[j].data());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04086}04086\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04087}04087\ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04088}04088\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04089}04089\ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04090}04090\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04091}04091\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(j,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04092}04092\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04093}04093\ \ \ \ \ std::string\ name\ =\ Form(\textcolor{stringliteral}{"{}Power\ Spectrum\ of\ \%s;k;P(k)"{}},\ Title.Data());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04094}04094\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04095}04095\ \ \ \ \ plot[j]-\/>SetTitle(name.c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04096}04096\ \ \ \ \ name\ =\ Form(\textcolor{stringliteral}{"{}\%s\_power\_spectrum"{}},\ Title.Data());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04097}04097\ \ \ \ \ plot[j]-\/>SetName(name.c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04098}04098\ \ \ \ \ plot[j]-\/>SetMarkerStyle(7);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04099}04099\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04100}04100\ \ \ \ \ \textcolor{comment}{//\ Equation\ 18}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04101}04101\ \ \ \ \ TF1\ *func\ =\ \textcolor{keyword}{new}\ TF1(\textcolor{stringliteral}{"{}power\_template"{}},\ \textcolor{stringliteral}{"{}[0]*(\ ([1]\ /\ x)\string^[2]\ /\ (([1]\ /\ x)\string^[2]\ +1)\ )"{}},\ 0.0,\ 1.0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04102}04102\ \ \ \ \ \textcolor{comment}{//\ P0\ gives\ the\ amplitude\ of\ the\ white\ noise\ spectrum\ in\ the\ k\ →\ 0\ limit}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04103}04103\ \ \ \ \ func-\/>SetParameter(0,\ 10.0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04104}04104\ \ \ \ \ \textcolor{comment}{//\ k*\ indicates\ the\ position\ of\ the\ turnover\ to\ a\ different\ power\ law\ behaviour}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04105}04105\ \ \ \ \ func-\/>SetParameter(1,\ 0.1);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04106}04106\ \ \ \ \ \textcolor{comment}{//\ alpha\ free\ parameter}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04107}04107\ \ \ \ \ func-\/>SetParameter(2,\ 2.0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04108}04108\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04109}04109\ \ \ \ \ \textcolor{comment}{//\ Set\ parameter\ limits\ for\ stability}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04110}04110\ \ \ \ \ func-\/>SetParLimits(0,\ 0.0,\ 100.0);\ \textcolor{comment}{//\ Amplitude\ should\ be\ non-\/negative}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04111}04111\ \ \ \ \ func-\/>SetParLimits(1,\ 0.001,\ 1.0);\ \textcolor{comment}{//\ k*\ should\ be\ within\ a\ reasonable\ range}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04112}04112\ \ \ \ \ func-\/>SetParLimits(2,\ 0.0,\ 5.0);\ \ \ \textcolor{comment}{//\ alpha\ should\ be\ positive}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04113}04113\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04114}04114\ \ \ \ \ plot[j]-\/>Fit(\textcolor{stringliteral}{"{}power\_template"{}},\textcolor{stringliteral}{"{}Rq"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04115}04115\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04116}04116\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetLogx();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04117}04117\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetLogy();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04118}04118\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetGrid();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04119}04119\ \ \ \ \ plot[j]-\/>Write(plot[j]-\/>GetName());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04120}04120\ \ \ \ \ plot[j]-\/>Draw(\textcolor{stringliteral}{"{}AL"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04121}04121\ \ \ \ \ func-\/>Draw(\textcolor{stringliteral}{"{}SAME"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04122}04122\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04123}04123\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04124}04124\ \ \ \ \ \textcolor{comment}{//KS:\ I\ have\ no\ clue\ what\ is\ the\ reason\ behind\ this.\ Found\ this\ in\ Rick\ Calland\ code...}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04125}04125\ \ \ \ \ (*PowerSpectrumStepSize)(j)\ =\ std::sqrt(func-\/>GetParameter(0)/float(v\_size*0.5));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04126}04126\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04127}04127\ \ \ \ \ \textcolor{keyword}{delete}\ func;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04128}04128\ \ \ \ \ \textcolor{keyword}{delete}\ plot[j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04129}04129\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04130}04130\ \ \ \textcolor{keyword}{delete}\ []\ plot;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04131}04131\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04132}04132\ \ \ PowerSpectrumStepSize-\/>Write(\textcolor{stringliteral}{"{}PowerSpectrumStepSize"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04133}04133\ \ \ \textcolor{keyword}{delete}\ PowerSpectrumStepSize;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04134}04134\ \ \ PowerDir-\/>Close();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04135}04135\ \ \ \textcolor{keyword}{delete}\ PowerDir;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04136}04136\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04137}04137\ \ \ clock.Stop();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04138}04138\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ Power\ Spectrum\ took\ \{:.2f\}s"{}},\ clock.RealTime());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04139}04139\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04140}04140\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTopMargin(TopMargin);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04141}04141\ \ \ gStyle-\/>SetOptTitle(OptTitle);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04142}04142\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04143}04143\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04144}04144\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04145}04145\ \textcolor{comment}{//\ Geweke\ Diagnostic\ based\ on}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04146}04146\ \textcolor{comment}{//\ @cite\ Fang2014GewekeDiagnostics}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04147}04147\ \textcolor{comment}{//\ @cite\ karlsbakk2011\ Chapter\ 3.1}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04148}\mbox{\hyperlink{classMCMCProcessor_a03b7c4bb9cd9a90aa7d284b0f1a6156b}{04148}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_a03b7c4bb9cd9a90aa7d284b0f1a6156b}{MCMCProcessor::GewekeDiagnostic}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04149}04149\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04150}04150\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ Geweke\ Diagnostic"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04151}04151\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04152}04152\ \ \ \textcolor{comment}{//KS:\ Up\ refers\ to\ upper\ limit\ we\ check,\ it\ stays\ constant,\ in\ literature\ it\ is\ mostly\ 50\%\ thus\ using\ 0.5\ for\ threshold}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04153}04153\ \ \ std::vector<double>\ MeanUp(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0.0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04154}04154\ \ \ std::vector<double>\ SpectralVarianceUp(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0.0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04155}04155\ \ \ std::vector<int>\ DenomCounterUp(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04156}04156\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Threshold\ =\ 0.5\ *\ \mbox{\hyperlink{classMCMCProcessor_aae0016a4e1d105d5d65243438c622a97}{nSteps}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04157}04157\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04158}04158\ \ \ \textcolor{comment}{//KS:\ Select\ values\ between\ which\ you\ want\ to\ scan,\ for\ example\ 0\ means\ 0\%\ burn\ in\ and\ 1\ 100\%\ burn\ in.}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04159}04159\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{double}\ LowerThreshold\ =\ 0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04160}04160\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{double}\ UpperThreshold\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04161}04161\ \ \ \textcolor{comment}{//\ Tells\ how\ many\ intervals\ between\ thresholds\ we\ want\ to\ check}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04162}04162\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ NChecks\ =\ 100;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04163}04163\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{double}\ Division\ =\ (UpperThreshold\ -\/\ LowerThreshold)/NChecks;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04164}04164\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04165}04165\ \ \ std::vector<std::unique\_ptr<TH1D>>\ GewekePlots(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04166}04166\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04167}04167\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04168}04168\ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04169}04169\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04170}04170\ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04171}04171\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(j,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04172}04172\ \ \ \ \ std::string\ HistName\ =\ Form(\textcolor{stringliteral}{"{}\%s\_\%s\_Geweke"{}},\ Title.Data(),\ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[j].Data());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04173}04173\ \ \ \ \ GewekePlots[j]\ =\ std::make\_unique<TH1D>(HistName.c\_str(),\ HistName.c\_str(),\ NChecks,\ 0.0,\ 100\ *\ UpperThreshold);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04174}04174\ \ \ \ \ GewekePlots[j]-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Burn-\/In\ (\%)"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04175}04175\ \ \ \ \ GewekePlots[j]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Geweke\ T\ score"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04176}04176\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04177}04177\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04178}04178\ \textcolor{comment}{//KS:\ Start\ parallel\ region}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04179}04179\ \textcolor{preprocessor}{\#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04180}04180\ \textcolor{preprocessor}{\#pragma\ omp\ parallel}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04181}04181\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04182}04182\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04183}04183\ \ \ \textcolor{comment}{//KS:\ First\ we\ calculate\ mean\ and\ spectral\ variance\ for\ the\ upper\ limit,\ this\ doesn't\ change\ and\ in\ literature\ is\ most\ often\ 50\%}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04184}04184\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04185}04185\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ for}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04186}04186\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04187}04187\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04188}04188\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04189}04189\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04190}04190\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04191}04191\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}[i]\ >\ Threshold)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04192}04192\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04193}04193\ \ \ \ \ \ \ \ \ MeanUp[j]\ +=\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04194}04194\ \ \ \ \ \ \ \ \ DenomCounterUp[j]++;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04195}04195\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04196}04196\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04197}04197\ \ \ \ \ MeanUp[j]\ =\ MeanUp[j]/DenomCounterUp[j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04198}04198\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04199}04199\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04200}04200\ \ \ \textcolor{comment}{//KS:\ now\ Spectral\ variance\ which\ in\ this\ case\ is\ sample\ variance}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04201}04201\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04202}04202\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ for\ collapse(2)}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04203}04203\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04204}04204\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04205}04205\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04206}04206\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04207}04207\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04208}04208\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}[i]\ >\ Threshold)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04209}04209\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04210}04210\ \ \ \ \ \ \ \ \ SpectralVarianceUp[j]\ +=\ (\mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i]\ -\/\ MeanUp[j])*(\mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i]\ -\/\ MeanUp[j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04211}04211\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04212}04212\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04213}04213\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04214}04214\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04215}04215\ \ \ \textcolor{comment}{//Loop\ over\ how\ many\ intervals\ we\ calculate}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04216}04216\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04217}04217\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ for}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04218}04218\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04219}04219\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 1;\ k\ <\ NChecks+1;\ ++k)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04220}04220\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04221}04221\ \ \ \ \ \textcolor{comment}{//KS\ each\ thread\ has\ it's\ own}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04222}04222\ \ \ \ \ std::vector<double>\ MeanDown(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0.0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04223}04223\ \ \ \ \ std::vector<double>\ SpectralVarianceDown(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0.0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04224}04224\ \ \ \ \ std::vector<int>\ DenomCounterDown(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04225}04225\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04226}04226\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ ThresholsCheck\ =\ Division*k*\mbox{\hyperlink{classMCMCProcessor_aae0016a4e1d105d5d65243438c622a97}{nSteps}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04227}04227\ \ \ \ \ \textcolor{comment}{//KS:\ First\ mean}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04228}04228\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04229}04229\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04230}04230\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04231}04231\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04232}04232\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}[i]\ <\ ThresholsCheck)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04233}04233\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04234}04234\ \ \ \ \ \ \ \ \ \ \ MeanDown[j]\ +=\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04235}04235\ \ \ \ \ \ \ \ \ \ \ DenomCounterDown[j]++;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04236}04236\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04237}04237\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04238}04238\ \ \ \ \ \ \ MeanDown[j]\ =\ MeanDown[j]/DenomCounterDown[j];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04239}04239\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04240}04240\ \ \ \ \ \textcolor{comment}{//Now\ spectral\ variance}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04241}04241\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04242}04242\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04243}04243\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++i)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04244}04244\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04245}04245\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}[i]\ <\ ThresholsCheck)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04246}04246\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04247}04247\ \ \ \ \ \ \ \ \ \ \ SpectralVarianceDown[j]\ +=\ (\mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i]\ -\/\ MeanDown[j])*(\mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i]\ -\/\ MeanDown[j]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04248}04248\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04249}04249\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04250}04250\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04251}04251\ \ \ \ \ \textcolor{comment}{//Lastly\ calc\ T\ score\ and\ fill\ histogram\ entry}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04252}04252\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04253}04253\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04254}04254\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ T\_score\ =\ std::fabs((MeanDown[j]\ -\/\ MeanUp[j])/std::sqrt(SpectralVarianceDown[j]/DenomCounterDown[j]\ +\ SpectralVarianceUp[j]/DenomCounterUp[j]));}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04255}04255\ \ \ \ \ \ \ GewekePlots[j]-\/>SetBinContent(k,\ T\_score);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04256}04256\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04257}04257\ \ \ \}\ \textcolor{comment}{//end\ loop\ over\ intervals}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04258}04258\ \textcolor{preprocessor}{\#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04259}04259\ \}\ \textcolor{comment}{//End\ parallel\ region}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04260}04260\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04261}04261\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04262}04262\ \ \ \textcolor{comment}{//Finally\ save\ it\ to\ TFile}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04263}04263\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04264}04264\ \ \ TDirectory\ *GewekeDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}Geweke"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04265}04265\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04266}04266\ \ \ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04267}04267\ \ \ \ \ GewekeDir-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04268}04268\ \ \ \ \ GewekePlots[j]-\/>Write();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04269}04269\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04270}04270\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04271}04271\ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[i];}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04272}04272\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04273}04273\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04274}04274\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04275}04275\ \ \ GewekeDir-\/>Close();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04276}04276\ \ \ \textcolor{keyword}{delete}\ GewekeDir;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04277}04277\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04278}04278\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04279}04279\ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04280}04280\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04281}04281\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04282}04282\ \textcolor{comment}{//\ Acceptance\ Probability}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04283}\mbox{\hyperlink{classMCMCProcessor_a278b82fa945d847e57ae6ed6357d8f61}{04283}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMCMCProcessor_a278b82fa945d847e57ae6ed6357d8f61}{MCMCProcessor::AcceptanceProbabilities}}()\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04284}04284\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04285}04285\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a523a223a4754c133121796f4591c7be3}{AccProbBatchedAverages}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_a930cadafa41b31b58066dea68628de9f}{PrepareDiagMCMC}}();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04286}04286\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04287}04287\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ AccProb\ plots..."{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04288}04288\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04289}04289\ \ \ \textcolor{comment}{//\ Set\ the\ titles\ and\ limits\ for\ TH1Ds}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04290}04290\ \ \ \textcolor{keyword}{auto}\ AcceptanceProbPlot\ =\ std::make\_unique<TH1D>(\textcolor{stringliteral}{"{}AcceptanceProbability"{}},\ \textcolor{stringliteral}{"{}Acceptance\ Probability"{}},\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04291}04291\ \ \ AcceptanceProbPlot-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Step"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04292}04292\ \ \ AcceptanceProbPlot-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Acceptance\ Probability"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04293}04293\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04294}04294\ \ \ \textcolor{keyword}{auto}\ BatchedAcceptanceProblot\ =\ std::make\_unique<TH1D>(\textcolor{stringliteral}{"{}AcceptanceProbability\_Batch"{}},\ \textcolor{stringliteral}{"{}AcceptanceProbability\_Batch"{}},\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04295}04295\ \ \ BatchedAcceptanceProblot-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Acceptance\ Probability"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04296}04296\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04297}04297\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04298}04298\ \ \ \ \ BatchedAcceptanceProblot-\/>SetBinContent(i+1,\ \mbox{\hyperlink{classMCMCProcessor_a523a223a4754c133121796f4591c7be3}{AccProbBatchedAverages}}[i]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04299}04299\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ BatchRangeLow\ =\ double(i)*double(\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}})/double(\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04300}04300\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ BatchRangeHigh\ =\ double(i+1)*double(\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}})/double(\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04301}04301\ \ \ \ \ std::stringstream\ ss;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04302}04302\ \ \ \ \ ss\ <<\ BatchRangeLow\ <<\ \textcolor{stringliteral}{"{}\ -\/\ "{}}\ <<\ BatchRangeHigh;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04303}04303\ \ \ \ \ BatchedAcceptanceProblot-\/>GetXaxis()-\/>SetBinLabel(i+1,\ ss.str().c\_str());}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04304}04304\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04305}04305\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04306}04306\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04307}04307\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04308}04308\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04309}04309\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04310}04310\ \ \ \ \ \textcolor{comment}{//\ Set\ bin\ content\ for\ the\ i-\/th\ bin\ to\ the\ parameter\ values}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04311}04311\ \ \ \ \ AcceptanceProbPlot-\/>SetBinContent(i,\ \mbox{\hyperlink{classMCMCProcessor_a88cab29770fd6098a674a0ab3628a251}{AccProbValues}}[i]);}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04312}04312\ \ \ \}}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04313}04313\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04314}04314\ \ \ TDirectory\ *probDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}AccProb"{}});}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04315}04315\ \ \ probDir-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04316}04316\ \ \ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04317}04317\ \ \ AcceptanceProbPlot-\/>Write();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04318}04318\ \ \ BatchedAcceptanceProblot-\/>Write();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04319}04319\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a88cab29770fd6098a674a0ab3628a251}{AccProbValues}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04320}04320\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a523a223a4754c133121796f4591c7be3}{AccProbBatchedAverages}};}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04321}04321\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04322}04322\ \ \ probDir-\/>Close();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04323}04323\ \ \ \textcolor{keyword}{delete}\ probDir;}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04324}04324\ }
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04325}04325\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{\Hypertarget{MCMCProcessor_8cpp_source_l04326}04326\ \}}

\end{DoxyCode}
