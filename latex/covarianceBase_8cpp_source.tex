\hypertarget{covarianceBase_8cpp_source}{}\doxysection{covariance\+Base.\+cpp}
\label{covarianceBase_8cpp_source}\index{/home/runner/work/MaCh3/MaCh3/covariance/covarianceBase.cpp@{/home/runner/work/MaCh3/MaCh3/covariance/covarianceBase.cpp}}
\mbox{\hyperlink{covarianceBase_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00001}00001\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{covarianceBase_8h}{covariance/covarianceBase.h}}"{}}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00003}00003\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00004}\mbox{\hyperlink{classcovarianceBase_a8ff9c473f7e2ed9289459073a9d3dbe1}{00004}}\ \mbox{\hyperlink{classcovarianceBase_a332cbcc2c262ff3775b56c40724e623e}{covarianceBase::covarianceBase}}(std::string\ name,\ std::string\ file)\ :\ inputFile(file),\ pca(false)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00005}00005\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00006}00006\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Constructing\ instance\ of\ covarianceBase"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00007}00007\ \ \ \mbox{\hyperlink{classcovarianceBase_a2960c489f6aafdb5a2291e1a48b14e9a}{init}}(name,\ file);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00008}00008\ \ \ \mbox{\hyperlink{classcovarianceBase_abba75182305d556818c76974a054a17d}{FirstPCAdpar}}\ =\ -\/999;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00009}00009\ \ \ \mbox{\hyperlink{classcovarianceBase_a5ebdc744b733656972a15f1657915a3f}{LastPCAdpar}}\ =\ -\/999;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00010}00010\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00011}00011\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00012}\mbox{\hyperlink{classcovarianceBase_a332cbcc2c262ff3775b56c40724e623e}{00012}}\ \mbox{\hyperlink{classcovarianceBase_a332cbcc2c262ff3775b56c40724e623e}{covarianceBase::covarianceBase}}(\textcolor{keyword}{const}\ std::vector<std::string>\&\ YAMLFile,\ std::string\ name,\ \textcolor{keywordtype}{double}\ threshold,\ \textcolor{keywordtype}{int}\ FirstPCA,\ \textcolor{keywordtype}{int}\ LastPCA)\ :\ inputFile(YAMLFile[0].c\_str()),\ matrixName(name),\ pca(true),\ eigen\_threshold(threshold),\ FirstPCAdpar(FirstPCA),\ LastPCAdpar(LastPCA)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00013}00013\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00014}00014\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00015}00015\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Constructing\ instance\ of\ covarianceBase\ using\ "{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00016}00016\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ YAMLFile.size();\ i++)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00017}00017\ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00018}00018\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\{\}"{}},\ YAMLFile[i]);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00019}00019\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00020}00020\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}as\ an\ input"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00021}00021\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00022}00022\ \ \ \textcolor{keywordflow}{if}\ (threshold\ <\ 0\ ||\ threshold\ >=\ 1)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00023}00023\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Principal\ component\ analysis\ but\ given\ the\ threshold\ for\ the\ principal\ components\ to\ be\ less\ than\ 0,\ or\ greater\ than\ (or\ equal\ to)\ 1.\ This\ will\ not\ work"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00024}00024\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Please\ specify\ a\ number\ between\ 0\ and\ 1"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00025}00025\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}You\ specified:\ "{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00026}00026\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Am\ instead\ calling\ the\ usual\ non-\/PCA\ constructor..."{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00027}00027\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00028}00028\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00029}00029\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00030}00030\ \ \ \mbox{\hyperlink{classcovarianceBase_a2960c489f6aafdb5a2291e1a48b14e9a}{init}}(YAMLFile);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00031}00031\ \ \ \textcolor{comment}{//\ Call\ the\ innocent\ helper\ function}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00032}00032\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \mbox{\hyperlink{classcovarianceBase_a8ac3a458097817eca534c23554a7635b}{ConstructPCA}}();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00033}00033\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00034}00034\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00035}00035\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00036}00036\ \textcolor{comment}{//Destructor}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00037}\mbox{\hyperlink{classcovarianceBase_a1e7a87a1d7e054475b4b921407e0a2d1}{00037}}\ \mbox{\hyperlink{classcovarianceBase_a1e7a87a1d7e054475b4b921407e0a2d1}{covarianceBase::\string~covarianceBase}}()\{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00038}00038\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00039}00039\ \ \ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}.clear();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00040}00040\ \ \ \mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}.clear();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00041}00041\ \ \ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}.clear();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00042}00042\ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}.clear();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00043}00043\ \ \ \mbox{\hyperlink{classcovarianceBase_a8f1d94838f188cc85c4f82557c0b0b66}{\_fLowBound}}.clear();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00044}00044\ \ \ \mbox{\hyperlink{classcovarianceBase_a31e636cb6de871bd0c2c8e7e299df9e7}{\_fUpBound}}.clear();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00045}00045\ \ \ \mbox{\hyperlink{classcovarianceBase_a3cda39026e336a49cef482efd4062561}{\_fIndivStepScale}}.clear();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00046}00046\ \ \ \mbox{\hyperlink{classcovarianceBase_ad9c47deb7009bff81210f666e80012eb}{\_fFlatPrior}}.clear();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00047}00047\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00048}00048\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00049}00049\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}{corr\_throw}};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00050}00050\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00051}00051\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a6c3fe8db34c06299fd1633951ac00937}{covMatrix}}\ !=\ \textcolor{keyword}{nullptr})\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classcovarianceBase_a6c3fe8db34c06299fd1633951ac00937}{covMatrix}};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00052}00052\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a35c7dc7817eaf4058e9775b6bc792ebc}{invCovMatrix}}\ !=\ \textcolor{keyword}{nullptr})\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classcovarianceBase_a35c7dc7817eaf4058e9775b6bc792ebc}{invCovMatrix}};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00053}00053\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ab95f5e066c2dfb1d20d120bc6c85dda2}{throwMatrix\_CholDecomp}}\ !=\ \textcolor{keyword}{nullptr})\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classcovarianceBase_ab95f5e066c2dfb1d20d120bc6c85dda2}{throwMatrix\_CholDecomp}};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00054}00054\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00055}00055\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00056}00056\ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00057}00057\ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}}[i];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00058}00058\ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}}[i];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00059}00059\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00060}00060\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00061}00061\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00062}00062\ \ \ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00063}00063\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nThreads\ =\ \mbox{\hyperlink{namespaceMaCh3Utils_a5aff908b9241c673e8d05403996e2229}{MaCh3Utils::GetNThreads}}();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00064}00064\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ iThread\ =\ 0;iThread\ <\ nThreads;\ iThread++)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}[iThread];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00065}00065\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00066}00066\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a6cb3d0b4096fbb55b040f70cd5b6e32b}{throwMatrix}}\ !=\ \textcolor{keyword}{nullptr})\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classcovarianceBase_a6cb3d0b4096fbb55b040f70cd5b6e32b}{throwMatrix}};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00067}00067\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00068}00068\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00069}00069\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00070}\mbox{\hyperlink{classcovarianceBase_a8ac3a458097817eca534c23554a7635b}{00070}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_a8ac3a458097817eca534c23554a7635b}{covarianceBase::ConstructPCA}}()\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00071}00071\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00072}00072\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00073}00073\ \ \ \textcolor{comment}{//Check\ whether\ first\ and\ last\ pcadpar\ are\ set\ and\ if\ not\ just\ PCA\ everything}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00074}00074\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classcovarianceBase_abba75182305d556818c76974a054a17d}{FirstPCAdpar}}\ ==\ -\/999\ ||\ \mbox{\hyperlink{classcovarianceBase_a5ebdc744b733656972a15f1657915a3f}{LastPCAdpar}}\ ==\ -\/999)\{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00075}00075\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classcovarianceBase_abba75182305d556818c76974a054a17d}{FirstPCAdpar}}\ ==\ -\/999\ \&\&\ \mbox{\hyperlink{classcovarianceBase_a5ebdc744b733656972a15f1657915a3f}{LastPCAdpar}}\ ==\ -\/999)\{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00076}00076\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_abba75182305d556818c76974a054a17d}{FirstPCAdpar}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00077}00077\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a5ebdc744b733656972a15f1657915a3f}{LastPCAdpar}}\ =\ \mbox{\hyperlink{classcovarianceBase_a6c3fe8db34c06299fd1633951ac00937}{covMatrix}}-\/>GetNrows()-\/1;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00078}00078\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00079}00079\ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00080}00080\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}You\ must\ either\ leave\ FirstPCAdpar\ and\ LastPCAdpar\ at\ -\/999\ or\ set\ them\ both\ to\ something"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00081}00081\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00082}00082\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00083}00083\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00084}00084\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00085}00085\ \ \ \mbox{\hyperlink{classcovarianceBase_ad0022a3e9dd3b2661c9b02a02488759c}{PCAObj}}.\mbox{\hyperlink{classPCAHandler_a361fd5f81ae3bcd915cd598b69e264ba}{ConstructPCA}}(\mbox{\hyperlink{classcovarianceBase_a6c3fe8db34c06299fd1633951ac00937}{covMatrix}},\ \mbox{\hyperlink{classcovarianceBase_abba75182305d556818c76974a054a17d}{FirstPCAdpar}},\ \mbox{\hyperlink{classcovarianceBase_a5ebdc744b733656972a15f1657915a3f}{LastPCAdpar}},\ \mbox{\hyperlink{classcovarianceBase_add54ab1ba46b723fa23d7c95dfad671a}{eigen\_threshold}},\ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00086}00086\ \ \ \textcolor{comment}{//\ Make\ a\ note\ that\ we\ have\ now\ done\ PCA}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00087}00087\ \ \ \mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00088}00088\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00089}00089\ \ \ \textcolor{comment}{//\ Make\ the\ PCA\ parameter\ arrays}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00090}00090\ \ \ \mbox{\hyperlink{classcovarianceBase_aa96f87ab90dc26fc1b5e157149b9dfd3}{fParCurr\_PCA}}.ResizeTo(\mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00091}00091\ \ \ \mbox{\hyperlink{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}{fParProp\_PCA}}.ResizeTo(\mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00092}00092\ \ \ \mbox{\hyperlink{classcovarianceBase_ae6aada94037640a68e3f37898f276019}{\_fPreFitValue\_PCA}}.resize(\mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00093}00093\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00094}00094\ \ \ \textcolor{comment}{//KS:\ make\ easy\ map\ so\ we\ could\ easily\ find\ un-\/decomposed\ parameters}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00095}00095\ \ \ \mbox{\hyperlink{classcovarianceBase_ae9f3cb2a310874b86965903714ef2bd8}{isDecomposed\_PCA}}.resize(\mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00096}00096\ \ \ \mbox{\hyperlink{classcovarianceBase_a7b83a17de68cc7838b93de242d91d9a0}{fParSigma\_PCA}}.resize(\mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00097}00097\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}};\ ++i)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00098}00098\ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00099}00099\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a7b83a17de68cc7838b93de242d91d9a0}{fParSigma\_PCA}}[i]\ =\ 1;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00100}00100\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ae9f3cb2a310874b86965903714ef2bd8}{isDecomposed\_PCA}}[i]\ =\ -\/1;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00101}00101\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00102}00102\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_abba75182305d556818c76974a054a17d}{FirstPCAdpar}};\ ++i)\ \mbox{\hyperlink{classcovarianceBase_ae9f3cb2a310874b86965903714ef2bd8}{isDecomposed\_PCA}}[i]\ =\ i;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00103}00103\ \ \ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00104}00104\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ \mbox{\hyperlink{classcovarianceBase_abba75182305d556818c76974a054a17d}{FirstPCAdpar}}+\mbox{\hyperlink{classcovarianceBase_ad0022a3e9dd3b2661c9b02a02488759c}{PCAObj}}.\mbox{\hyperlink{classPCAHandler_aa39db9118399bebcdb784fe9c9fea458}{nKeptPCApars}}+1;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}};\ ++i)\ \mbox{\hyperlink{classcovarianceBase_ae9f3cb2a310874b86965903714ef2bd8}{isDecomposed\_PCA}}[i]\ =\ i+(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}-\/\mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00105}00105\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00106}00106\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00107}00107\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00108}\mbox{\hyperlink{classcovarianceBase_a2960c489f6aafdb5a2291e1a48b14e9a}{00108}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_a2960c489f6aafdb5a2291e1a48b14e9a}{covarianceBase::init}}(std::string\ name,\ std::string\ file)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00109}00109\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00110}00110\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00111}00111\ \ \ \textcolor{comment}{//\ Set\ the\ covariance\ matrix\ from\ input\ ROOT\ file\ (e.g.\ flux,\ ND280,\ NIWG)}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00112}00112\ \ \ TFile\ *infile\ =\ \textcolor{keyword}{new}\ TFile(file.c\_str(),\ \textcolor{stringliteral}{"{}READ"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00113}00113\ \ \ \textcolor{keywordflow}{if}\ (infile-\/>IsZombie())\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00114}00114\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Could\ not\ open\ input\ covariance\ ROOT\ file\ \{\}\ !!!"{}},\ file);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00115}00115\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Was\ about\ to\ retrieve\ matrix\ with\ name\ \{\}"{}},\ name);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00116}00116\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00117}00117\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00118}00118\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00119}00119\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00120}00120\ \ \ TMatrixDSym\ *CovMat\ =\ infile-\/>Get<TMatrixDSym>(name.c\_str());}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00121}00121\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00122}00122\ \ \ \textcolor{keywordflow}{if}\ (CovMat\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00123}00123\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Could\ not\ find\ covariance\ matrix\ name\ \{\}\ in\ file\ \{\}"{}},\ name,\ file);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00124}00124\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Are\ you\ really\ sure\ \{\}\ exists\ in\ the\ file?"{}},\ name);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00125}00125\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00126}00126\ \ \ \}\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00127}00127\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00128}00128\ \ \ \mbox{\hyperlink{classcovarianceBase_a8d821ce805f2426fe95549170866821f}{PrintLength}}\ =\ 35;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00129}00129\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00130}00130\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nThreads\ =\ \mbox{\hyperlink{namespaceMaCh3Utils_a5aff908b9241c673e8d05403996e2229}{MaCh3Utils::GetNThreads}}();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00131}00131\ \ \ \textcolor{comment}{//KS:\ set\ Random\ numbers\ for\ each\ thread\ so\ each\ thread\ has\ different\ seed}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00132}00132\ \ \ \textcolor{comment}{//or\ for\ one\ thread\ if\ without\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00133}00133\ \ \ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}\ =\ \textcolor{keyword}{new}\ TRandom3*[nThreads]();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00134}00134\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ iThread\ =\ 0;\ iThread\ <\ nThreads;\ iThread++)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00135}00135\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}[iThread]\ =\ \textcolor{keyword}{new}\ TRandom3(0);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00136}00136\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00137}00137\ \ \ \textcolor{comment}{//\ Not\ using\ adaptive\ by\ default}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00138}00138\ \ \ \mbox{\hyperlink{classcovarianceBase_a838731abd6716940043b484b2b266f86}{use\_adaptive}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00139}00139\ \ \ \textcolor{comment}{//\ Set\ the\ covariance\ matrix}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00140}00140\ \ \ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}\ =\ CovMat-\/>GetNrows();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00141}00141\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00142}00142\ \ \ \mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}]();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00143}00143\ \ \ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}]();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00144}00144\ \ \ \textcolor{comment}{//\ Set\ the\ defaults\ to\ true}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00145}00145\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00146}00146\ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00147}00147\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}}[i]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}]();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00148}00148\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}}[i]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}]();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00149}00149\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ j++)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00150}00150\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00151}00151\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}}[i][j]\ =\ 0.;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00152}00152\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}}[i][j]\ =\ 0.;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00153}00153\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00154}00154\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00155}00155\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00156}00156\ \ \ \mbox{\hyperlink{classcovarianceBase_a9f980a259c5952f9ca907832f99ad2a7}{setName}}(name);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00157}00157\ \ \ \mbox{\hyperlink{classcovarianceBase_ae2850c8e2f2d4acfe322b0ebe65b07cf}{MakePosDef}}(CovMat);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00158}00158\ \ \ \mbox{\hyperlink{classcovarianceBase_a5f28f7294d25cca6334f7033a63596b9}{setCovMatrix}}(CovMat);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00159}00159\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}\ <=\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00160}00160\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a07ff6d6a15b24f94afc88a1b89779beb}{MACH3LOG\_CRITICAL}}(\textcolor{stringliteral}{"{}Covariance\ matrix\ \{\}\ has\ \{\}\ entries!"{}},\ \mbox{\hyperlink{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}{getName}}(),\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00161}00161\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00162}00162\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00163}00163\ \ \ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}}\ =\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00164}00164\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00165}00165\ \ \ \mbox{\hyperlink{classcovarianceBase_a75b5553823335bb82026ff46369fb67e}{ReserveMemory}}(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00166}00166\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00167}00167\ \ \ infile-\/>Close();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00168}00168\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00169}00169\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Created\ covariance\ matrix\ named:\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}{getName}}());}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00170}00170\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}from\ file:\ \{\}"{}},\ file);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00171}00171\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00172}00172\ \ \ \textcolor{keyword}{delete}\ infile;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00173}00173\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00174}00174\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00175}00175\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00176}00176\ \textcolor{comment}{//\ ETA}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00177}00177\ \textcolor{comment}{//\ An\ init\ function\ for\ the\ YAML\ constructor}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00178}00178\ \textcolor{comment}{//\ All\ you\ really\ need\ from\ the\ YAML\ file\ is\ the\ number\ of\ Systematics}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00179}00179\ \textcolor{comment}{//\ Then\ get\ all\ the\ info\ from\ the\ YAML\ file\ in\ the\ covarianceXsec::ParseYAML\ function}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00180}\mbox{\hyperlink{classcovarianceBase_acec1e1c7fd83d21e1ad55a03acfeb8c4}{00180}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_a2960c489f6aafdb5a2291e1a48b14e9a}{covarianceBase::init}}(\textcolor{keyword}{const}\ std::vector<std::string>\&\ YAMLFile)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00181}00181\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00182}00182\ \ \ \mbox{\hyperlink{classcovarianceBase_a933ff3dc0af99629ba3582a5d9d89d23}{\_fYAMLDoc}}[\textcolor{stringliteral}{"{}Systematics"{}}]\ =\ YAML::Node(YAML::NodeType::Sequence);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00183}00183\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ YAMLFile.size();\ i++)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00184}00184\ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00185}00185\ \ \ \ \ YAML::Node\ YAMLDocTemp\ =\ YAML::LoadFile(YAMLFile[i]);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00186}00186\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ item\ :\ YAMLDocTemp[\textcolor{stringliteral}{"{}Systematics"{}}])\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00187}00187\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a933ff3dc0af99629ba3582a5d9d89d23}{\_fYAMLDoc}}[\textcolor{stringliteral}{"{}Systematics"{}}].push\_back(item);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00188}00188\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00189}00189\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00190}00190\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00191}00191\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nThreads\ =\ \mbox{\hyperlink{namespaceMaCh3Utils_a5aff908b9241c673e8d05403996e2229}{MaCh3Utils::GetNThreads}}();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00192}00192\ \ \ \textcolor{comment}{//KS:\ set\ Random\ numbers\ for\ each\ thread\ so\ each\ thread\ has\ different\ seed}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00193}00193\ \ \ \textcolor{comment}{//or\ for\ one\ thread\ if\ without\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00194}00194\ \ \ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}\ =\ \textcolor{keyword}{new}\ TRandom3*[nThreads]();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00195}00195\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ iThread\ =\ 0;\ iThread\ <\ nThreads;\ iThread++)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00196}00196\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}[iThread]\ =\ \textcolor{keyword}{new}\ TRandom3(0);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00197}00197\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00198}00198\ \ \ \mbox{\hyperlink{classcovarianceBase_a8d821ce805f2426fe95549170866821f}{PrintLength}}\ =\ 35;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00199}00199\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00200}00200\ \ \ \textcolor{comment}{//\ Set\ the\ covariance\ matrix}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00201}00201\ \ \ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}\ =\ int(\mbox{\hyperlink{classcovarianceBase_a933ff3dc0af99629ba3582a5d9d89d23}{\_fYAMLDoc}}[\textcolor{stringliteral}{"{}Systematics"{}}].\mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}}());}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00202}00202\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00203}00203\ \ \ \mbox{\hyperlink{classcovarianceBase_a838731abd6716940043b484b2b266f86}{use\_adaptive}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00204}00204\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00205}00205\ \ \ \mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}]();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00206}00206\ \ \ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}]();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00207}00207\ \ \ \textcolor{comment}{//\ Set\ the\ defaults\ to\ true}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00208}00208\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00209}00209\ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00210}00210\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}}[i]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}]();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00211}00211\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}}[i]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}]();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00212}00212\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ j++)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00213}00213\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00214}00214\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}}[i][j]\ =\ 0.;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00215}00215\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}}[i][j]\ =\ 0.;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00216}00216\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00217}00217\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00218}00218\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00219}00219\ \ \ \mbox{\hyperlink{classcovarianceBase_a75b5553823335bb82026ff46369fb67e}{ReserveMemory}}(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00220}00220\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00221}00221\ \ \ TMatrixDSym*\ \_fCovMatrix\ =\ \textcolor{keyword}{new}\ TMatrixDSym(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00222}00222\ \ \ \textcolor{comment}{//\_fDetString\ =\ std::vector<std::string>(\_fNumPar);}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00223}00223\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00224}00224\ \ \ \textcolor{keywordtype}{int}\ i\ =\ 0;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00225}00225\ \ \ std::vector<std::map<std::string,double>>\ Correlations(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00226}00226\ \ \ std::map<std::string,\ int>\ CorrNamesMap;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00227}00227\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00228}00228\ \ \ \textcolor{comment}{//ETA\ -\/\ read\ in\ the\ systematics.\ Would\ be\ good\ to\ add\ in\ some\ checks\ to\ make\ sure}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00229}00229\ \ \ \textcolor{comment}{//that\ there\ are\ the\ correct\ number\ of\ entries\ i.e.\ are\ the\ \_fNumPar\ for\ Names,}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00230}00230\ \ \ \textcolor{comment}{//PreFitValues\ etc\ etc.}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00231}00231\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \textcolor{keyword}{const}\ \&param\ :\ \mbox{\hyperlink{classcovarianceBase_a933ff3dc0af99629ba3582a5d9d89d23}{\_fYAMLDoc}}[\textcolor{stringliteral}{"{}Systematics"{}}])}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00232}00232\ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00233}00233\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a973671386a2f8ea924f25f8f5404654c}{\_fFancyNames}}[i]\ =\ (param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}Names"{}}][\textcolor{stringliteral}{"{}FancyName"{}}].as<std::string>());}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00234}00234\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i]\ =\ (param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}ParameterValues"{}}][\textcolor{stringliteral}{"{}PreFitValue"{}}].as<\textcolor{keywordtype}{double}>());}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00235}00235\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a9b753f52711600a9f8d648531d95b044}{\_fGenerated}}[i]\ =\ (param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}ParameterValues"{}}][\textcolor{stringliteral}{"{}Generated"{}}].as<\textcolor{keywordtype}{double}>());}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00236}00236\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a3cda39026e336a49cef482efd4062561}{\_fIndivStepScale}}[i]\ =\ (param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}StepScale"{}}][\textcolor{stringliteral}{"{}MCMC"{}}].as<\textcolor{keywordtype}{double}>());}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00237}00237\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}[i]\ =\ (param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}Error"{}}].as<\textcolor{keywordtype}{double}>());}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00238}00238\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00239}00239\ \ \ \ \ \textcolor{comment}{//ETA\ -\/\ a\ bit\ of\ a\ fudge\ but\ works}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00240}00240\ \ \ \ \ std::vector<double>\ TempBoundsVec\ =\ param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}ParameterBounds"{}}].as<std::vector<double>>();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00241}00241\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a8f1d94838f188cc85c4f82557c0b0b66}{\_fLowBound}}[i]\ =\ TempBoundsVec[0];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00242}00242\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a31e636cb6de871bd0c2c8e7e299df9e7}{\_fUpBound}}[i]\ =\ TempBoundsVec[1];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00243}00243\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00244}00244\ \ \ \ \ \textcolor{comment}{//ETA\ -\/\ now\ for\ parameters\ which\ are\ optional\ and\ have\ default\ values}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00245}00245\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ad9c47deb7009bff81210f666e80012eb}{\_fFlatPrior}}[i]\ =\ GetFromManager<bool>(param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}FlatPrior"{}}],\ \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00246}00246\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00247}00247\ \ \ \ \ \textcolor{comment}{//Fill\ the\ map\ to\ get\ the\ correlations\ later\ as\ well}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00248}00248\ \ \ \ \ CorrNamesMap[param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}Names"{}}][\textcolor{stringliteral}{"{}FancyName"{}}].as<std::string>()]=i;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00249}00249\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00250}00250\ \ \ \ \ \textcolor{comment}{//Also\ loop\ through\ the\ correlations}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00251}00251\ \ \ \ \ \textcolor{keywordflow}{if}(param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}Correlations"{}}])\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00252}00252\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ Corr\_i\ =\ 0;\ Corr\_i\ <\ param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}Correlations"{}}].size();\ ++Corr\_i)\{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00253}00253\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (YAML::const\_iterator\ it=param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}Correlations"{}}][Corr\_i].begin();it!=param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}Correlations"{}}][Corr\_i].end();++it)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00254}00254\ \ \ \ \ \ \ \ \ \ \ Correlations[i][it-\/>first.as<std::string>()]\ =\ it-\/>second.as<\textcolor{keywordtype}{double}>();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00255}00255\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00256}00256\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00257}00257\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00258}00258\ \ \ \ \ i++;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00259}00259\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00260}00260\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00261}00261\ \ \ \textcolor{comment}{//ETA}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00262}00262\ \ \ \textcolor{comment}{//Now\ that\ we've\ been\ through\ all\ systematic\ let's\ fill\ the\ covmatrix}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00263}00263\ \ \ \textcolor{comment}{//This\ makes\ the\ root\ TCov\ from\ YAML}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00264}00264\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};j++)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00265}00265\ \ \ \ \ (*\_fCovMatrix)(j,\ j)=\mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}[j]*\mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}[j];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00266}00266\ \ \ \ \ \textcolor{comment}{//Get\ the\ map\ of\ parameter\ name\ to\ correlation\ from\ the\ Correlations\ object}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00267}00267\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ pair\ :\ Correlations[j])\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00268}00268\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ key\ =\ pair.first;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00269}00269\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ val\ =\ pair.second;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00270}00270\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ index\ =\ -\/1;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00271}00271\ \ \ \ \ \ \ \textcolor{comment}{//If\ you\ found\ the\ parameter\ name\ then\ get\ the\ index}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00272}00272\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (CorrNamesMap.find(key)\ !=\ CorrNamesMap.end())\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00273}00273\ \ \ \ \ \ \ \ \ index\ =\ CorrNamesMap[key];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00274}00274\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00275}00275\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00276}00276\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Parameter\ \{\}\ not\ in\ list!\ Check\ your\ spelling?"{}},\ key);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00277}00277\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00278}00278\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00279}00279\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ Corr1\ =\ val;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00280}00280\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ Corr2\ =\ 0;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00281}00281\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(Correlations[index].find(\mbox{\hyperlink{classcovarianceBase_a973671386a2f8ea924f25f8f5404654c}{\_fFancyNames}}[j])\ !=\ Correlations[index].end())\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00282}00282\ \ \ \ \ \ \ \ \ Corr2\ =\ Correlations[index][\mbox{\hyperlink{classcovarianceBase_a973671386a2f8ea924f25f8f5404654c}{\_fFancyNames}}[j]];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00283}00283\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Do\ they\ agree\ to\ better\ than\ float\ precision?}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00284}00284\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(std::abs(Corr2\ -\/\ Corr1)\ >\ FLT\_EPSILON)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00285}00285\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Correlations\ are\ not\ equal\ between\ \{\}\ and\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a973671386a2f8ea924f25f8f5404654c}{\_fFancyNames}}[j],\ key);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00286}00286\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Got\ :\ \{\}\ and\ \{\}"{}},\ Corr2,\ Corr1);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00287}00287\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00288}00288\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00289}00289\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00290}00290\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Correlation\ does\ not\ appear\ reciprocally\ between\ \{\}\ and\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a973671386a2f8ea924f25f8f5404654c}{\_fFancyNames}}[j],\ key);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00291}00291\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00292}00292\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00293}00293\ \ \ \ \ \ \ (*\_fCovMatrix)(j,\ index)=\ (*\_fCovMatrix)(index,\ j)\ =\ Corr1*\mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}[j]*\mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}[index];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00294}00294\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00295}00295\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00296}00296\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00297}00297\ \ \ \textcolor{comment}{//Now\ make\ positive\ definite}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00298}00298\ \ \ \mbox{\hyperlink{classcovarianceBase_ae2850c8e2f2d4acfe322b0ebe65b07cf}{MakePosDef}}(\_fCovMatrix);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00299}00299\ \ \ \mbox{\hyperlink{classcovarianceBase_a5f28f7294d25cca6334f7033a63596b9}{setCovMatrix}}(\_fCovMatrix);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00300}00300\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00301}00301\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}\ <=\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00302}00302\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Covariance\ object\ has\ \{\}\ systematics!"{}},\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00303}00303\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00304}00304\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00305}00305\ \ \ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}}\ =\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00306}00306\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00307}00307\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Created\ covariance\ matrix\ from\ files:\ "{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00308}00308\ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ \&file\ :\ YAMLFile)\{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00309}00309\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\{\}\ "{}},\ file);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00310}00310\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00311}00311\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00312}00312\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Found\ \{\}\ systematics\ parameters\ in\ total"{}},\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00313}00313\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00314}00314\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00315}00315\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00316}00316\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00317}00317\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00318}00318\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00319}\mbox{\hyperlink{classcovarianceBase_ab5141e2014519c1483788f4995686164}{00319}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_a2960c489f6aafdb5a2291e1a48b14e9a}{covarianceBase::init}}(TMatrixDSym*\ covMat)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00320}00320\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00321}00321\ \ \ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}\ =\ covMat-\/>GetNrows();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00322}00322\ \ \ \mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}]();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00323}00323\ \ \ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}]();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00324}00324\ \ \ \textcolor{comment}{//\ Set\ the\ defaults\ to\ true}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00325}00325\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00326}00326\ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00327}00327\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}}[i]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}]();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00328}00328\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}}[i]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}]();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00329}00329\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ j++)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00330}00330\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00331}00331\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}}[i][j]\ =\ 0.;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00332}00332\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}}[i][j]\ =\ 0.;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00333}00333\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00334}00334\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00335}00335\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00336}00336\ \ \ \mbox{\hyperlink{classcovarianceBase_a838731abd6716940043b484b2b266f86}{use\_adaptive}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00337}00337\ \ \ \mbox{\hyperlink{classcovarianceBase_a5f28f7294d25cca6334f7033a63596b9}{setCovMatrix}}(covMat);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00338}00338\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00339}00339\ \ \ \mbox{\hyperlink{classcovarianceBase_a75b5553823335bb82026ff46369fb67e}{ReserveMemory}}(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00340}00340\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00341}00341\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Created\ covariance\ matrix\ named:\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}{getName}}());}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00342}00342\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00343}00343\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00344}00344\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00345}00345\ \textcolor{comment}{//\ Set\ the\ covariance\ matrix\ for\ this\ class}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00346}\mbox{\hyperlink{classcovarianceBase_a5f28f7294d25cca6334f7033a63596b9}{00346}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_a5f28f7294d25cca6334f7033a63596b9}{covarianceBase::setCovMatrix}}(TMatrixDSym\ *cov)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00347}00347\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00348}00348\ \ \ \textcolor{keywordflow}{if}\ (cov\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00349}00349\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Could\ not\ find\ covariance\ matrix\ you\ provided\ to\ setCovMatrix"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00350}00350\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00351}00351\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00352}00352\ \ \ \mbox{\hyperlink{classcovarianceBase_a6c3fe8db34c06299fd1633951ac00937}{covMatrix}}\ =\ cov;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00353}00353\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00354}00354\ \ \ \mbox{\hyperlink{classcovarianceBase_a35c7dc7817eaf4058e9775b6bc792ebc}{invCovMatrix}}\ =\ \textcolor{keyword}{static\_cast<}TMatrixDSym\ *\textcolor{keyword}{>}(cov-\/>Clone());}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00355}00355\ \ \ \mbox{\hyperlink{classcovarianceBase_a35c7dc7817eaf4058e9775b6bc792ebc}{invCovMatrix}}-\/>Invert();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00356}00356\ \ \ \textcolor{comment}{//KS:\ ROOT\ has\ bad\ memory\ management,\ using\ standard\ double\ means\ we\ can\ decrease\ most\ operation\ by\ factor\ 2\ simply\ due\ to\ cache\ hits}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00357}00357\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00358}00358\ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00359}00359\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++j)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00360}00360\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00361}00361\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}}[i][j]\ =\ (*invCovMatrix)(i,j);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00362}00362\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00363}00363\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00364}00364\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00365}00365\ \ \ \mbox{\hyperlink{classcovarianceBase_af30ca7861452e1446e55700f4b49b608}{setThrowMatrix}}(cov);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00366}00366\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00367}00367\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00368}\mbox{\hyperlink{classcovarianceBase_a75b5553823335bb82026ff46369fb67e}{00368}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_a75b5553823335bb82026ff46369fb67e}{covarianceBase::ReserveMemory}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ SizeVec)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00369}00369\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00370}00370\ \ \ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}\ =\ std::vector<std::string>(SizeVec);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00371}00371\ \ \ \mbox{\hyperlink{classcovarianceBase_a973671386a2f8ea924f25f8f5404654c}{\_fFancyNames}}\ =\ std::vector<std::string>(SizeVec);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00372}00372\ \ \ \mbox{\hyperlink{classcovarianceBase_a9b753f52711600a9f8d648531d95b044}{\_fGenerated}}\ =\ std::vector<double>(SizeVec);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00373}00373\ \ \ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}\ =\ std::vector<double>(SizeVec);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00374}00374\ \ \ \mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}\ =\ std::vector<double>(SizeVec);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00375}00375\ \ \ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}\ =\ std::vector<double>(SizeVec);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00376}00376\ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}\ =\ std::vector<double>(SizeVec);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00377}00377\ \ \ \mbox{\hyperlink{classcovarianceBase_a8f1d94838f188cc85c4f82557c0b0b66}{\_fLowBound}}\ =\ std::vector<double>(SizeVec);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00378}00378\ \ \ \mbox{\hyperlink{classcovarianceBase_a31e636cb6de871bd0c2c8e7e299df9e7}{\_fUpBound}}\ =\ std::vector<double>(SizeVec);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00379}00379\ \ \ \mbox{\hyperlink{classcovarianceBase_ad9c47deb7009bff81210f666e80012eb}{\_fFlatPrior}}\ =\ std::vector<bool>(SizeVec);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00380}00380\ \ \ \mbox{\hyperlink{classcovarianceBase_a3cda39026e336a49cef482efd4062561}{\_fIndivStepScale}}\ =\ std::vector<double>(SizeVec);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00381}00381\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00382}00382\ \ \ \mbox{\hyperlink{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}{corr\_throw}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[SizeVec]();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00383}00383\ \ \ \textcolor{comment}{//\ set\ random\ parameter\ vector\ (for\ correlated\ steps)}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00384}00384\ \ \ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[SizeVec];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00385}00385\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00386}00386\ \ \ \textcolor{comment}{//\ Set\ the\ defaults\ to\ true}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00387}00387\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ SizeVec;\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00388}00388\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a9b753f52711600a9f8d648531d95b044}{\_fGenerated}}.at(i)\ =\ 1.;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00389}00389\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}.at(i)\ =\ 1.;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00390}00390\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}.at(i)\ =\ 0.;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00391}00391\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}.at(i)\ =\ 0.;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00392}00392\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}.at(i)\ =\ 0.;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00393}00393\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a8f1d94838f188cc85c4f82557c0b0b66}{\_fLowBound}}.at(i)\ =\ -\/999.99;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00394}00394\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a31e636cb6de871bd0c2c8e7e299df9e7}{\_fUpBound}}.at(i)\ =\ 999.99;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00395}00395\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ad9c47deb7009bff81210f666e80012eb}{\_fFlatPrior}}.at(i)\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00396}00396\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a3cda39026e336a49cef482efd4062561}{\_fIndivStepScale}}.at(i)\ =\ 1.;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00397}00397\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}{corr\_throw}}[i]\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00398}00398\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00399}00399\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00400}00400\ \ \ \mbox{\hyperlink{classcovarianceBase_a0088413d6a15d12cd34ec06166302f5c}{\_fGlobalStepScale}}\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00401}00401\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00402}00402\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00403}00403\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00404}00404\ \textcolor{comment}{//\ Set\ all\ the\ covariance\ matrix\ parameters\ to\ a\ user-\/defined\ value}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00405}00405\ \textcolor{comment}{//\ Might\ want\ to\ split\ this}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00406}\mbox{\hyperlink{classcovarianceBase_aae3b226cbd6a4c03f291620ebd018bc9}{00406}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_aae3b226cbd6a4c03f291620ebd018bc9}{covarianceBase::setPar}}(\textcolor{keywordtype}{int}\ i\ ,\ \textcolor{keywordtype}{double}\ val)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00407}00407\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00408}00408\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Over-\/riding\ \{\}:\ "{}},\ \mbox{\hyperlink{classcovarianceBase_a033c5b6a8669537acaa6c5fc252899e6}{GetParName}}(i));}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00409}00409\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\_fPropVal\ (\{\}),\ \_fCurrVal\ (\{\}),\ \_fPreFitValue\ (\{\})\ to\ (\{\})"{}},\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i],\ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i],\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i],\ val);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00410}00410\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00411}00411\ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ =\ val;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00412}00412\ \ \ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i]\ =\ val;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00413}00413\ \ \ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i]\ =\ val;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00414}00414\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00415}00415\ \ \ \textcolor{comment}{//\ Transfer\ the\ parameter\ values\ to\ the\ PCA\ basis}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00416}00416\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \mbox{\hyperlink{classcovarianceBase_a651f5ecd8973918d5683606a607fa88c}{TransferToPCA}}();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00417}00417\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00418}00418\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00419}00419\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00420}00420\ \textcolor{comment}{//\ Transfer\ a\ parameter\ variation\ in\ the\ parameter\ basis\ to\ the\ eigen\ basis}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00421}\mbox{\hyperlink{classcovarianceBase_a651f5ecd8973918d5683606a607fa88c}{00421}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_a651f5ecd8973918d5683606a607fa88c}{covarianceBase::TransferToPCA}}()\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00422}00422\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00423}00423\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00424}00424\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Can\ not\ transfer\ to\ PCA\ if\ PCA\ isn't\ enabled"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00425}00425\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00426}00426\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00427}00427\ \ \ \textcolor{comment}{//\ Make\ the\ temporary\ vectors}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00428}00428\ \ \ TVectorD\ fParCurr\_vec(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00429}00429\ \ \ TVectorD\ fParProp\_vec(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00430}00430\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00431}00431\ \ \ \ \ fParCurr\_vec(i)\ =\ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00432}00432\ \ \ \ \ fParProp\_vec(i)\ =\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00433}00433\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00434}00434\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00435}00435\ \ \ \mbox{\hyperlink{classcovarianceBase_aa96f87ab90dc26fc1b5e157149b9dfd3}{fParCurr\_PCA}}\ =\ \mbox{\hyperlink{classcovarianceBase_ad0022a3e9dd3b2661c9b02a02488759c}{PCAObj}}.\mbox{\hyperlink{classPCAHandler_a6f6443a487bb544e6a6e458d86f35f27}{TransferMatT}}*fParCurr\_vec;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00436}00436\ \ \ \mbox{\hyperlink{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}{fParProp\_PCA}}\ =\ \mbox{\hyperlink{classcovarianceBase_ad0022a3e9dd3b2661c9b02a02488759c}{PCAObj}}.\mbox{\hyperlink{classPCAHandler_a6f6443a487bb544e6a6e458d86f35f27}{TransferMatT}}*fParProp\_vec;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00437}00437\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00438}00438\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00439}00439\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00440}00440\ \textcolor{comment}{//\ Transfer\ a\ parameter\ variation\ in\ the\ eigen\ basis\ to\ the\ parameter\ basis}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00441}\mbox{\hyperlink{classcovarianceBase_a65ac4956a782b01768f445732522a450}{00441}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_a65ac4956a782b01768f445732522a450}{covarianceBase::TransferToParam}}()\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00442}00442\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00443}00443\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00444}00444\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Can\ not\ transfer\ to\ PCA\ if\ PCA\ isn't\ enabled"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00445}00445\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00446}00446\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00447}00447\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00448}00448\ \ \ \textcolor{comment}{//\ Make\ the\ temporary\ vectors}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00449}00449\ \ \ TVectorD\ fParProp\_vec\ =\ \mbox{\hyperlink{classcovarianceBase_ad0022a3e9dd3b2661c9b02a02488759c}{PCAObj}}.\mbox{\hyperlink{classPCAHandler_a1d9302633ed96ec57fbe26d25cbcee61}{TransferMat}}*\mbox{\hyperlink{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}{fParProp\_PCA}};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00450}00450\ \ \ TVectorD\ fParCurr\_vec\ =\ \mbox{\hyperlink{classcovarianceBase_ad0022a3e9dd3b2661c9b02a02488759c}{PCAObj}}.\mbox{\hyperlink{classPCAHandler_a1d9302633ed96ec57fbe26d25cbcee61}{TransferMat}}*\mbox{\hyperlink{classcovarianceBase_aa96f87ab90dc26fc1b5e157149b9dfd3}{fParCurr\_PCA}};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00451}00451\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00452}00452\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00453}00453\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00454}00454\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00455}00455\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ =\ fParProp\_vec(i);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00456}00456\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i]\ =\ fParCurr\_vec(i);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00457}00457\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00458}00458\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00459}00459\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00460}\mbox{\hyperlink{classcovarianceBase_a63db139faf1e42d7a1c3c3c661c0b7d9}{00460}}\ std::vector<double>\ \mbox{\hyperlink{classcovarianceBase_a63db139faf1e42d7a1c3c3c661c0b7d9}{covarianceBase::getProposed}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00461}00461\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00462}00462\ \ \ std::vector<double>\ props(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00463}00463\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ props[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00464}00464\ \ \ \textcolor{keywordflow}{return}\ props;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00465}00465\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00466}00466\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00467}00467\ \textcolor{comment}{//\ *************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00468}00468\ \textcolor{comment}{//\ Throw\ the\ parameters\ according\ to\ the\ covariance\ matrix}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00469}00469\ \textcolor{comment}{//\ This\ shouldn't\ be\ used\ in\ MCMC\ code\ ase\ it\ can\ break\ Detailed\ Balance;}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00470}\mbox{\hyperlink{classcovarianceBase_aa5d82895bcbae7773b6813c02cf2f485}{00470}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_aa5d82895bcbae7773b6813c02cf2f485}{covarianceBase::throwParameters}}()\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00471}00471\ \textcolor{comment}{//\ *************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00472}00472\ \ \ \textcolor{comment}{//\ First\ draw\ new\ randParams}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00473}00473\ \ \ \mbox{\hyperlink{classcovarianceBase_a3432b7a9acc1243b8bdb17ec0b40d195}{randomize}}();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00474}00474\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00475}00475\ \ \ \textcolor{comment}{//\ KS:\ We\ use\ PCA\ very\ rarely\ on\ top\ PCA\ functionality\ isn't\ implemented\ for\ this\ function.}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00476}00476\ \ \ \textcolor{comment}{//\ Use\ \_\_builtin\_expect\ to\ give\ compiler\ a\ hint\ which\ option\ is\ more\ likely,\ which\ should\ help}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00477}00477\ \ \ \textcolor{comment}{//\ with\ better\ optimisation.\ This\ isn't\ critical\ but\ more\ to\ have\ example}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00478}00478\ \ \ \textcolor{keywordflow}{if}\ (\_\_builtin\_expect(!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}},\ 1))\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00479}00479\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a64aaa71f81750ba27977c0405c51cd88}{MatrixVectorMulti}}(\mbox{\hyperlink{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}{corr\_throw}},\ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}},\ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}},\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00480}00480\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00481}00481\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00482}00482\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00483}00483\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00484}00484\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00485}00485\ \ \ \ \ \ \ \textcolor{comment}{//\ Check\ if\ parameter\ is\ fixed\ first:\ if\ so\ don't\ randomly\ throw}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00486}00486\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a2424eaebd9daa92b0294b352310770a3}{isParameterFixed}}(i))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00487}00487\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00488}00488\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i]\ +\ \mbox{\hyperlink{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}{corr\_throw}}[i];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00489}00489\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \textcolor{keywordflow}{throws}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00490}00490\ \ \ \ \ \ \ \textcolor{comment}{//\ Try\ again\ if\ we\ the\ initial\ parameter\ proposal\ falls\ outside\ of\ the\ range\ of\ the\ parameter}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00491}00491\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ >\ \mbox{\hyperlink{classcovarianceBase_a31e636cb6de871bd0c2c8e7e299df9e7}{\_fUpBound}}[i]\ ||\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ <\ \mbox{\hyperlink{classcovarianceBase_a8f1d94838f188cc85c4f82557c0b0b66}{\_fLowBound}}[i])\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00492}00492\ \textcolor{preprocessor}{\#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00493}00493\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}[omp\_get\_thread\_num()]-\/>Gaus(0,\ 1);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00494}00494\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00495}00495\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}[0]-\/>Gaus(0,1);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00496}00496\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00497}00497\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ corr\_throw\_single\ =\ \mbox{\hyperlink{classcovarianceBase_a767242ffde1e52dff143889e5534b4e3}{MatrixVectorMultiSingle}}(\mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}},\ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}},\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}},\ i);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00498}00498\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i]\ +\ corr\_throw\_single;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00499}00499\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordflow}{throws}\ >\ 10000)\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00500}00500\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00501}00501\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Since\ we\ are\ multithreading\ there\ is\ danger\ that\ those\ messages}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00502}00502\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//will\ be\ all\ over\ the\ place,\ small\ price\ to\ pay\ for\ faster\ code}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00503}00503\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Tried\ \{\}\ times\ to\ throw\ parameter\ \{\}\ but\ failed"{}},\ \textcolor{keywordflow}{throws},\ i);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00504}00504\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Matrix:\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a26618d3f5633b33ce20e38ce8261b3ee}{matrixName}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00505}00505\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Param:\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}[i]);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00506}00506\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Setting\ \_fPropVal:\ \ \{\}\ to\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i],\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i]);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00507}00507\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}I\ live\ at\ \{\}:\{\}"{}},\ \_\_FILE\_\_,\ \_\_LINE\_\_);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00508}00508\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00509}00509\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//throw\ MaCh3Exception(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00510}00510\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00511}00511\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throws}++;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00512}00512\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00513}00513\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00514}00514\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00515}00515\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00516}00516\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00517}00517\ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00518}00518\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a07ff6d6a15b24f94afc88a1b89779beb}{MACH3LOG\_CRITICAL}}(\textcolor{stringliteral}{"{}Hold\ on,\ you\ are\ trying\ to\ run\ Prior\ Predictive\ Code\ with\ PCA,\ which\ is\ wrong"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00519}00519\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a07ff6d6a15b24f94afc88a1b89779beb}{MACH3LOG\_CRITICAL}}(\textcolor{stringliteral}{"{}Sorry\ I\ have\ to\ kill\ you,\ I\ mean\ your\ job"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00520}00520\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00521}00521\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00522}00522\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00523}00523\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00524}00524\ \textcolor{comment}{//\ *************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00525}00525\ \textcolor{comment}{//\ Throw\ each\ parameter\ within\ their\ 1\ sigma\ range}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00526}00526\ \textcolor{comment}{//\ Used\ to\ start\ the\ chain\ in\ different\ states}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00527}\mbox{\hyperlink{classcovarianceBase_a867bff214af25bba68f921eaea8b5cdd}{00527}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_a867bff214af25bba68f921eaea8b5cdd}{covarianceBase::RandomConfiguration}}()\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00528}00528\ \textcolor{comment}{//\ *************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00529}00529\ \ \ \textcolor{comment}{//\ Have\ the\ 1\ sigma\ for\ each\ parameter\ in\ each\ covariance\ class,\ sweet!}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00530}00530\ \ \ \textcolor{comment}{//\ Don't\ want\ to\ change\ the\ nominal\ array\ because\ that's\ what\ determines\ our\ likelihood}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00531}00531\ \ \ \textcolor{comment}{//\ Want\ to\ change\ the\ fParProp,\ fParCurr,\ fParInit}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00532}00532\ \ \ \textcolor{comment}{//\ fParInit\ and\ the\ others\ will\ already\ be\ set}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00533}00533\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00534}00534\ \ \ \ \ \textcolor{comment}{//\ Check\ if\ parameter\ is\ fixed\ first:\ if\ so\ don't\ randomly\ throw}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00535}00535\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a2424eaebd9daa92b0294b352310770a3}{isParameterFixed}}(i))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00536}00536\ \ \ \ \ \textcolor{comment}{//\ Check\ that\ the\ sigma\ range\ is\ larger\ than\ the\ parameter\ range}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00537}00537\ \ \ \ \ \textcolor{comment}{//\ If\ not,\ throw\ in\ the\ valid\ parameter\ range\ instead}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00538}00538\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ paramrange\ =\ \mbox{\hyperlink{classcovarianceBase_a31e636cb6de871bd0c2c8e7e299df9e7}{\_fUpBound}}[i]\ -\/\ \mbox{\hyperlink{classcovarianceBase_a8f1d94838f188cc85c4f82557c0b0b66}{\_fLowBound}}[i];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00539}00539\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ sigma\ =\ sqrt((*\mbox{\hyperlink{classcovarianceBase_a6c3fe8db34c06299fd1633951ac00937}{covMatrix}})(i,i));}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00540}00540\ \ \ \ \ \textcolor{keywordtype}{double}\ throwrange\ =\ sigma;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00541}00541\ \ \ \ \ \textcolor{keywordflow}{if}\ (paramrange\ <\ sigma)\ throwrange\ =\ paramrange;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00542}00542\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00543}00543\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i]\ +\ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}[0]-\/>Gaus(0,\ 1)*throwrange;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00544}00544\ \ \ \ \ \textcolor{comment}{//\ Try\ again\ if\ we\ the\ initial\ parameter\ proposal\ falls\ outside\ of\ the\ range\ of\ the\ parameter}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00545}00545\ \ \ \ \ \textcolor{comment}{//\ Really\ only\ relevant\ for\ the\ xsec\ parameters;\ the\ flux\ and\ ND280\ have\ -\/999\ and\ 999\ set\ to\ the\ limits!}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00546}00546\ \ \ \ \ \textcolor{keywordtype}{int}\ \textcolor{keywordflow}{throws}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00547}00547\ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ >\ \mbox{\hyperlink{classcovarianceBase_a31e636cb6de871bd0c2c8e7e299df9e7}{\_fUpBound}}[i]\ ||\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ <\ \mbox{\hyperlink{classcovarianceBase_a8f1d94838f188cc85c4f82557c0b0b66}{\_fLowBound}}[i])\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00548}00548\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordflow}{throws}\ >\ 1000)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00549}00549\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Tried\ \{\}\ times\ to\ throw\ parameter\ \{\}\ but\ failed"{}},\ \textcolor{keywordflow}{throws},\ i);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00550}00550\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Matrix:\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a26618d3f5633b33ce20e38ce8261b3ee}{matrixName}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00551}00551\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Param:\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}[i]);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00552}00552\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00553}00553\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00554}00554\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i]\ +\ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}[0]-\/>Gaus(0,\ 1)*throwrange;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00555}00555\ \ \ \ \ \ \ \textcolor{keywordflow}{throws}++;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00556}00556\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00557}00557\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Setting\ current\ step\ in\ \{\}\ param\ \{\}\ =\ \{\}\ from\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a26618d3f5633b33ce20e38ce8261b3ee}{matrixName}},\ i,\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i],\ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i]);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00558}00558\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00559}00559\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00560}00560\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \mbox{\hyperlink{classcovarianceBase_a651f5ecd8973918d5683606a607fa88c}{TransferToPCA}}();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00561}00561\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00562}00562\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00563}00563\ \textcolor{comment}{//\ *************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00564}00564\ \textcolor{comment}{//\ Set\ a\ single\ parameter}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00565}\mbox{\hyperlink{classcovarianceBase_a978483dabf04239f1c475516b5cdab7f}{00565}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_a978483dabf04239f1c475516b5cdab7f}{covarianceBase::setSingleParameter}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ parNo,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ parVal)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00566}00566\ \textcolor{comment}{//\ *************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00567}00567\ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[parNo]\ =\ parVal;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00568}00568\ \ \ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[parNo]\ =\ parVal;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00569}00569\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a4db4657acad5c79ac4bbb66a9d1c5905}{MACH3LOG\_DEBUG}}(\textcolor{stringliteral}{"{}Setting\ \{\}\ (parameter\ \{\})\ to\ \{\})"{}},\ \mbox{\hyperlink{classcovarianceBase_a033c5b6a8669537acaa6c5fc252899e6}{GetParName}}(parNo),\ \ parNo,\ parVal);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00570}00570\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \mbox{\hyperlink{classcovarianceBase_a651f5ecd8973918d5683606a607fa88c}{TransferToPCA}}();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00571}00571\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00572}00572\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00573}\mbox{\hyperlink{classcovarianceBase_a6701f97eb624cef70998773333f96757}{00573}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_a6701f97eb624cef70998773333f96757}{covarianceBase::setParCurrProp}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ parNo,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ parVal)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00574}00574\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00575}00575\ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[parNo]\ =\ parVal;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00576}00576\ \ \ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[parNo]\ =\ parVal;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00577}00577\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a4db4657acad5c79ac4bbb66a9d1c5905}{MACH3LOG\_DEBUG}}(\textcolor{stringliteral}{"{}Setting\ \{\}\ (parameter\ \{\})\ to\ \{\})"{}},\ \mbox{\hyperlink{classcovarianceBase_a033c5b6a8669537acaa6c5fc252899e6}{GetParName}}(parNo),\ \ parNo,\ parVal);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00578}00578\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \mbox{\hyperlink{classcovarianceBase_a651f5ecd8973918d5683606a607fa88c}{TransferToPCA}}();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00579}00579\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00580}00580\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00581}00581\ \textcolor{comment}{//\ ************************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00582}00582\ \textcolor{comment}{//\ Propose\ a\ step\ for\ the\ set\ of\ systematics\ parameters\ this\ covariance\ class\ holds}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00583}\mbox{\hyperlink{classcovarianceBase_a95c7ca23995af579cfa7f199833fe24a}{00583}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_a95c7ca23995af579cfa7f199833fe24a}{covarianceBase::proposeStep}}()\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00584}00584\ \textcolor{comment}{//\ ************************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00585}00585\ \ \ \textcolor{comment}{//\ Make\ the\ random\ numbers\ for\ the\ step\ proposal}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00586}00586\ \ \ \mbox{\hyperlink{classcovarianceBase_a3432b7a9acc1243b8bdb17ec0b40d195}{randomize}}();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00587}00587\ \ \ \mbox{\hyperlink{classcovarianceBase_aba2b2dae2546299c9a4dab618d65e7c0}{CorrelateSteps}}();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00588}00588\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classcovarianceBase_a838731abd6716940043b484b2b266f86}{use\_adaptive}})\ \mbox{\hyperlink{classcovarianceBase_a50ce8ebb96ebd64190dc37e4bf950a9b}{updateAdaptiveCovariance}}();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00589}00589\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00590}00590\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00591}00591\ \textcolor{comment}{//\ ************************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00592}00592\ \textcolor{comment}{//\ "{}Randomize"{}\ the\ parameters\ in\ the\ covariance\ class\ for\ the\ proposed\ step}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00593}00593\ \textcolor{comment}{//\ Used\ the\ proposal\ kernel\ and\ the\ current\ parameter\ value\ to\ set\ proposed\ step}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00594}00594\ \textcolor{comment}{//\ Also\ get\ a\ new\ random\ number\ for\ the\ randParams}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00595}\mbox{\hyperlink{classcovarianceBase_a3432b7a9acc1243b8bdb17ec0b40d195}{00595}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_a3432b7a9acc1243b8bdb17ec0b40d195}{covarianceBase::randomize}}()\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00596}00596\ \textcolor{comment}{//\ ************************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00597}00597\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00598}00598\ \textcolor{comment}{//KS:\ By\ multithreading\ here\ we\ gain\ at\ least\ factor\ 2\ with\ 8\ threads\ with\ ND\ only\ fit\ \ \ \ \ \ }}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00599}00599\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00600}00600\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00601}00601\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00602}00602\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00603}00603\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ parameter\ isn't\ fixed}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00604}00604\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}[i]\ >\ 0.0)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00605}00605\ \textcolor{preprocessor}{\#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00606}00606\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}[omp\_get\_thread\_num()]-\/>Gaus(0,\ 1);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00607}00607\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00608}00608\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}[0]-\/>Gaus(0,\ 1);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00609}00609\ \textcolor{preprocessor}{\#endif\ }}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00610}00610\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ parameter\ IS\ fixed}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00611}00611\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00612}00612\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}}[i]\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00613}00613\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00614}00614\ \ \ \ \ \}\ \textcolor{comment}{//\ end\ for}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00615}00615\ \ \ \textcolor{comment}{//\ If\ we're\ in\ the\ PCA\ basis\ we\ instead\ throw\ parameters\ there\ (only\ \_fNumParPCA\ parameter)}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00616}00616\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00617}00617\ \ \ \ \ \textcolor{comment}{//\ Scale\ the\ random\ parameters\ by\ the\ sqrt\ of\ eigen\ values\ for\ the\ throw}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00618}00618\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00619}00619\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00620}00620\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00621}00621\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00622}00622\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00623}00623\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a7b83a17de68cc7838b93de242d91d9a0}{fParSigma\_PCA}}[i]\ >\ 0.\ \&\&\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}})}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00624}00624\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00625}00625\ \textcolor{preprocessor}{\#ifdef\ MULTITHREAD\ \ \ \ \ \ \ \ }}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00626}00626\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}[omp\_get\_thread\_num()]-\/>Gaus(0,1);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00627}00627\ \textcolor{preprocessor}{\#else\ \ \ \ \ \ \ \ }}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00628}00628\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}[0]-\/>Gaus(0,1);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00629}00629\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00630}00630\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{\ \textcolor{comment}{//\ If\ parameter\ IS\ fixed\ or\ out\ od\ bounds}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00631}00631\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}}[i]\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00632}00632\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00633}00633\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00634}00634\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00635}00635\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00636}00636\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00637}00637\ \textcolor{comment}{//\ ************************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00638}00638\ \textcolor{comment}{//\ Correlate\ the\ steps\ by\ setting\ the\ proposed\ step\ of\ a\ parameter\ to\ its\ current\ value\ +\ some\ correlated\ throw}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00639}\mbox{\hyperlink{classcovarianceBase_aba2b2dae2546299c9a4dab618d65e7c0}{00639}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_aba2b2dae2546299c9a4dab618d65e7c0}{covarianceBase::CorrelateSteps}}()\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00640}00640\ \textcolor{comment}{//\ ************************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00641}00641\ \ \ \textcolor{comment}{//KS:\ Using\ custom\ function\ compared\ to\ ROOT\ one\ with\ 8\ threads\ we\ have\ almost\ factor\ 2\ performance\ increase,\ by\ replacing\ TMatrix\ with\ just\ double\ we\ increase\ it\ even\ more}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00642}00642\ \ \ \mbox{\hyperlink{classcovarianceBase_a64aaa71f81750ba27977c0405c51cd88}{MatrixVectorMulti}}(\mbox{\hyperlink{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}{corr\_throw}},\ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}},\ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}},\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00643}00643\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00644}00644\ \ \ \textcolor{comment}{//\ If\ not\ doing\ PCA}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00645}00645\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00646}00646\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00647}00647\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00648}00648\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00649}00649\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00650}00650\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}[i]\ >\ 0.)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00651}00651\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i]\ +\ \mbox{\hyperlink{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}{corr\_throw}}[i]*\mbox{\hyperlink{classcovarianceBase_a0088413d6a15d12cd34ec06166302f5c}{\_fGlobalStepScale}}*\mbox{\hyperlink{classcovarianceBase_a3cda39026e336a49cef482efd4062561}{\_fIndivStepScale}}[i];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00652}00652\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00653}00653\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00654}00654\ \ \ \ \ \textcolor{comment}{//\ If\ doing\ PCA\ throw\ uncorrelated\ in\ PCA\ basis\ (orthogonal\ basis\ by\ definition)}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00655}00655\ \ \ \}\ \textcolor{keywordflow}{else}\ \{\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00656}00656\ \ \ \ \ \textcolor{comment}{//\ Throw\ around\ the\ current\ step}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00657}00657\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00658}00658\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00659}00659\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00660}00660\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}};\ ++i)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00661}00661\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00662}00662\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a7b83a17de68cc7838b93de242d91d9a0}{fParSigma\_PCA}}[i]\ >\ 0.)\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00663}00663\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00664}00664\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ IndStepScale\ =\ 1.;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00665}00665\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ If\ undecomposed\ parameter\ apply\ individual\ step\ scale\ and\ Cholesky\ for\ better\ acceptance\ rate}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00666}00666\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classcovarianceBase_ae9f3cb2a310874b86965903714ef2bd8}{isDecomposed\_PCA}}[i]\ >=\ 0)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00667}00667\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00668}00668\ \ \ \ \ \ \ \ \ \ \ IndStepScale\ *=\ \mbox{\hyperlink{classcovarianceBase_a3cda39026e336a49cef482efd4062561}{\_fIndivStepScale}}[\mbox{\hyperlink{classcovarianceBase_ae9f3cb2a310874b86965903714ef2bd8}{isDecomposed\_PCA}}[i]];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00669}00669\ \ \ \ \ \ \ \ \ \ \ IndStepScale\ *=\ \mbox{\hyperlink{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}{corr\_throw}}[\mbox{\hyperlink{classcovarianceBase_ae9f3cb2a310874b86965903714ef2bd8}{isDecomposed\_PCA}}[i]];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00670}00670\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00671}00671\ \ \ \ \ \ \ \ \ \textcolor{comment}{//If\ decomposed\ apply\ only\ random\ number}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00672}00672\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00673}00673\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00674}00674\ \ \ \ \ \ \ \ \ \ IndStepScale\ *=\ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}}[i];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00675}00675\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ All\ PCA-\/ed\ parameters\ have\ the\ same\ step\ scale}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00676}00676\ \ \ \ \ \ \ \ \ \ IndStepScale\ *=\ \mbox{\hyperlink{classcovarianceBase_a3cda39026e336a49cef482efd4062561}{\_fIndivStepScale}}[\mbox{\hyperlink{classcovarianceBase_abba75182305d556818c76974a054a17d}{FirstPCAdpar}}];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00677}00677\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00678}00678\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}{fParProp\_PCA}}(i)\ =\ \mbox{\hyperlink{classcovarianceBase_aa96f87ab90dc26fc1b5e157149b9dfd3}{fParCurr\_PCA}}(i)+\mbox{\hyperlink{classcovarianceBase_a0088413d6a15d12cd34ec06166302f5c}{\_fGlobalStepScale}}*IndStepScale*\mbox{\hyperlink{classcovarianceBase_ad0022a3e9dd3b2661c9b02a02488759c}{PCAObj}}.\mbox{\hyperlink{classPCAHandler_a2924386fef0cf65215c51b4f81cdb0d1}{eigen\_values\_master}}[i];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00679}00679\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00680}00680\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00681}00681\ \ \ \ \ \textcolor{comment}{//\ Then\ update\ the\ parameter\ basis}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00682}00682\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a65ac4956a782b01768f445732522a450}{TransferToParam}}();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00683}00683\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00684}00684\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00685}00685\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00686}00686\ \textcolor{comment}{//\ Update\ so\ that\ current\ step\ becomes\ the\ previously\ proposed\ step}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00687}\mbox{\hyperlink{classcovarianceBase_aa2344b1482362eed11d817acdb6befe4}{00687}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_aa2344b1482362eed11d817acdb6befe4}{covarianceBase::acceptStep}}()\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00688}00688\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00689}00689\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00690}00690\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00691}00691\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00692}00692\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00693}00693\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00694}00694\ \ \ \ \ \ \ \textcolor{comment}{//\ Update\ state\ so\ that\ current\ state\ is\ proposed\ state}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00695}00695\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00696}00696\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00697}00697\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00698}00698\ \ \ \textcolor{comment}{//\ Update\ the\ book-\/keeping\ for\ the\ output}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00699}00699\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00700}00700\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00701}00701\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00702}00702\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00703}00703\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_aa96f87ab90dc26fc1b5e157149b9dfd3}{fParCurr\_PCA}}(i)\ =\ \mbox{\hyperlink{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}{fParProp\_PCA}}(i);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00704}00704\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00705}00705\ \ \ \ \ \textcolor{comment}{//\ Then\ update\ the\ parameter\ basis}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00706}00706\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a65ac4956a782b01768f445732522a450}{TransferToParam}}();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00707}00707\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00708}00708\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00709}00709\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00710}00710\ \textcolor{comment}{//\ Throw\ the\ proposed\ parameter\ by\ mag\ sigma}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00711}00711\ \textcolor{comment}{//\ Should\ really\ just\ have\ the\ user\ specify\ this\ throw\ by\ having\ argument\ double}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00712}\mbox{\hyperlink{classcovarianceBase_af4d127ff4761379dd11843523835c4dc}{00712}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_af4d127ff4761379dd11843523835c4dc}{covarianceBase::throwParProp}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ mag)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00713}00713\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00714}00714\ \ \ \mbox{\hyperlink{classcovarianceBase_a3432b7a9acc1243b8bdb17ec0b40d195}{randomize}}();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00715}00715\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00716}00716\ \ \ \ \ \textcolor{comment}{//\ Make\ the\ correlated\ throw}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00717}00717\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a64aaa71f81750ba27977c0405c51cd88}{MatrixVectorMulti}}(\mbox{\hyperlink{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}{corr\_throw}},\ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}},\ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}},\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00718}00718\ \ \ \ \ \textcolor{comment}{//\ Number\ of\ sigmas\ we\ throw}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00719}00719\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00720}00720\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}[i]\ >\ 0.)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00721}00721\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i]\ +\ \mbox{\hyperlink{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}{corr\_throw}}[i]*mag;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00722}00722\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00723}00723\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00724}00724\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00725}00725\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}{fParProp\_PCA}}(i)\ =\ \mbox{\hyperlink{classcovarianceBase_aa96f87ab90dc26fc1b5e157149b9dfd3}{fParCurr\_PCA}}(i)+mag*\mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}}[i];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00726}00726\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00727}00727\ \ \ \ \ \textcolor{comment}{//\ And\ update\ the\ fParCurr\ in\ the\ basis}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00728}00728\ \ \ \ \ \textcolor{comment}{//\ Then\ update\ the\ fParProp\ in\ the\ parameter\ basis\ using\ the\ transfer\ matrix,\ so\ likelihood\ is\ evaluated\ correctly}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00729}00729\ \ \ \ \ TVectorD\ proposed\ =\ \mbox{\hyperlink{classcovarianceBase_ad0022a3e9dd3b2661c9b02a02488759c}{PCAObj}}.\mbox{\hyperlink{classPCAHandler_a1d9302633ed96ec57fbe26d25cbcee61}{TransferMat}}*\mbox{\hyperlink{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}{fParProp\_PCA}};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00730}00730\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00731}00731\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a7b83a17de68cc7838b93de242d91d9a0}{fParSigma\_PCA}}[i]\ >\ 0.)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00732}00732\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ =\ proposed(i);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00733}00733\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00734}00734\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00735}00735\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00736}00736\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00737}00737\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00738}00738\ \textcolor{comment}{//\ Helper\ function\ to\ throw\ the\ current\ parameter\ by\ mag\ sigmas}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00739}00739\ \textcolor{comment}{//\ Can\ study\ bias\ in\ MCMC\ with\ this;\ put\ different\ starting\ parameters}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00740}\mbox{\hyperlink{classcovarianceBase_a4e92a9db846d956473efbe5712c71d31}{00740}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_a4e92a9db846d956473efbe5712c71d31}{covarianceBase::throwParCurr}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ mag)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00741}00741\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00742}00742\ \ \ \mbox{\hyperlink{classcovarianceBase_a3432b7a9acc1243b8bdb17ec0b40d195}{randomize}}();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00743}00743\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00744}00744\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ correlated\ throw\ vector}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00745}00745\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a64aaa71f81750ba27977c0405c51cd88}{MatrixVectorMulti}}(\mbox{\hyperlink{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}{corr\_throw}},\ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}},\ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}},\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00746}00746\ \ \ \ \ \textcolor{comment}{//\ The\ number\ of\ sigmas\ to\ throw}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00747}00747\ \ \ \ \ \textcolor{comment}{//\ Should\ probably\ have\ this\ as\ a\ default\ parameter\ input\ to\ the\ function\ instead}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00748}00748\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00749}00749\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}[i]\ >\ 0.)\{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00750}00750\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}{corr\_throw}}[i]*mag;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00751}00751\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00752}00752\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00753}00753\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00754}00754\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00755}00755\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}{fParProp\_PCA}}(i)\ =\ mag*\mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}}[i];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00756}00756\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00757}00757\ \ \ \ \ \textcolor{comment}{//\ And\ update\ the\ fParCurr\ in\ the\ basis}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00758}00758\ \ \ \ \ \textcolor{comment}{//\ Then\ update\ the\ fParProp\ in\ the\ parameter\ basis\ using\ the\ transfer\ matrix,\ so\ likelihood\ is\ evaluated\ correctly}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00759}00759\ \ \ \ \ TVectorD\ current\ =\ \mbox{\hyperlink{classcovarianceBase_ad0022a3e9dd3b2661c9b02a02488759c}{PCAObj}}.\mbox{\hyperlink{classPCAHandler_a1d9302633ed96ec57fbe26d25cbcee61}{TransferMat}}*\mbox{\hyperlink{classcovarianceBase_aa96f87ab90dc26fc1b5e157149b9dfd3}{fParCurr\_PCA}};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00760}00760\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00761}00761\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a7b83a17de68cc7838b93de242d91d9a0}{fParSigma\_PCA}}[i]\ >\ 0.)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00762}00762\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i]\ =\ current(i);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00763}00763\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00764}00764\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00765}00765\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00766}00766\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00767}00767\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00768}00768\ \textcolor{comment}{//\ Function\ to\ print\ the\ nominal\ values}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00769}\mbox{\hyperlink{classcovarianceBase_aebd37baf2d6551863d810bea83c73020}{00769}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_aebd37baf2d6551863d810bea83c73020}{covarianceBase::printNominal}}()\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00770}00770\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00771}00771\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Prior\ values\ for\ \{\}\ covarianceBase:"{}},\ \mbox{\hyperlink{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}{getName}}());}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00772}00772\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00773}00773\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\ \ \ \ \{\}\ \ \ \{\}\ "{}},\ \mbox{\hyperlink{classcovarianceBase_a6a46b5fed3e7feb6e9e151e90927bdbc}{GetParFancyName}}(i),\ \mbox{\hyperlink{classcovarianceBase_a1cede85accaac2ea7056740893d90c49}{getParInit}}(i));}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00774}00774\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00775}00775\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00776}00776\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00777}00777\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00778}00778\ \textcolor{comment}{//\ Function\ to\ print\ the\ nominal,\ current\ and\ proposed\ values}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00779}\mbox{\hyperlink{classcovarianceBase_a732268706d083b6ae4495e34e703bbda}{00779}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_a732268706d083b6ae4495e34e703bbda}{covarianceBase::printNominalCurrProp}}()\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00780}00780\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00781}00781\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Printing\ parameters\ for\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}{getName}}());}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00782}00782\ \ \ \textcolor{comment}{//\ Dump\ out\ the\ PCA\ parameters\ too}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00783}00783\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00784}00784\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}PCA:"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00785}00785\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00786}00786\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}PCA\ \{:<2\}\ Current:\ \{:<10.2f\}\ Proposed:\ \{:<10.2f\}"{}},\ i,\ \mbox{\hyperlink{classcovarianceBase_aa96f87ab90dc26fc1b5e157149b9dfd3}{fParCurr\_PCA}}(i),\ \mbox{\hyperlink{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}{fParProp\_PCA}}(i));}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00787}00787\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00788}00788\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00789}00789\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\{:<30\}\ \{:<10\}\ \{:<10\}\ \{:<10\}"{}},\ \textcolor{stringliteral}{"{}Name"{}},\ \textcolor{stringliteral}{"{}Prior"{}},\ \textcolor{stringliteral}{"{}Current"{}},\ \textcolor{stringliteral}{"{}Proposed"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00790}00790\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00791}00791\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\{:<30\}\ \{:<10.2f\}\ \{:<10.2f\}\ \{:<10.2f\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a6a46b5fed3e7feb6e9e151e90927bdbc}{GetParFancyName}}(i),\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i],\ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i],\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00792}00792\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00793}00793\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00794}00794\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00795}00795\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00796}00796\ \textcolor{comment}{//\ Get\ the\ likelihood\ in\ the\ case\ where\ we\ want\ to\ include\ priors\ on\ the\ parameters}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00797}00797\ \textcolor{comment}{//\ fParEvalLikelihood\ stores\ if\ we\ want\ to\ evaluate\ the\ likelihood\ for\ the\ given\ parameter}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00798}00798\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ true\ =\ evaluate\ likelihood\ (so\ run\ with\ a\ prior)}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00799}00799\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ false\ =\ don't\ evaluate\ likelihood\ (so\ run\ without\ a\ prior)}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00800}\mbox{\hyperlink{classcovarianceBase_a0056f747843633b2f8408f599f13f89f}{00800}}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classcovarianceBase_a0056f747843633b2f8408f599f13f89f}{covarianceBase::CalcLikelihood}}()\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00801}00801\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00802}00802\ \ \ \textcolor{keywordtype}{double}\ logL\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00803}00803\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00804}00804\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for\ reduction(+:logL)}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00805}00805\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00806}00806\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00807}00807\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00808}00808\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ simd}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00809}00809\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00810}00810\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00811}00811\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_ad9c47deb7009bff81210f666e80012eb}{\_fFlatPrior}}[i]\ \&\&\ !\mbox{\hyperlink{classcovarianceBase_ad9c47deb7009bff81210f666e80012eb}{\_fFlatPrior}}[j])\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00812}00812\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Since\ matrix\ is\ symmetric\ we\ can\ calculate\ non\ diagonal\ elements\ only\ once\ and\ multiply\ by\ 2,\ can\ bring\ up\ to\ factor\ speed\ decrease.}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00813}00813\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \textcolor{keywordtype}{int}\ scale\ =\ (i\ !=\ j)\ ?\ 2\ :\ 1;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00814}00814\ \ \ \ \ \ \ \ \ logL\ +=\ scale\ *\ 0.5*(\mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ -\/\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i])*(\mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[j]\ -\/\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[j])*\mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}}[i][j];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00815}00815\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00816}00816\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00817}00817\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00818}00818\ \ \ \textcolor{keywordflow}{return}\ logL;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00819}00819\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00820}00820\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00821}00821\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00822}\mbox{\hyperlink{classcovarianceBase_ac3c3e322dc06ce6a44a887ae13e522ae}{00822}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classcovarianceBase_ac3c3e322dc06ce6a44a887ae13e522ae}{covarianceBase::CheckBounds}}()\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00823}00823\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00824}00824\ \ \ \textcolor{keywordtype}{int}\ NOutside\ =\ 0;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00825}00825\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00826}00826\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for\ reduction(+:NOutside)}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00827}00827\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00828}00828\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00829}00829\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ >\ \mbox{\hyperlink{classcovarianceBase_a31e636cb6de871bd0c2c8e7e299df9e7}{\_fUpBound}}[i]\ ||\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ <\ \mbox{\hyperlink{classcovarianceBase_a8f1d94838f188cc85c4f82557c0b0b66}{\_fLowBound}}[i])\{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00830}00830\ \ \ \ \ \ \ NOutside++;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00831}00831\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00832}00832\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00833}00833\ \ \ \textcolor{keywordflow}{return}\ NOutside;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00834}00834\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00835}00835\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00836}00836\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00837}\mbox{\hyperlink{classcovarianceBase_a9ee2fbfe0f1ac86c8c129095638e0f76}{00837}}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classcovarianceBase_a9ee2fbfe0f1ac86c8c129095638e0f76}{covarianceBase::GetLikelihood}}()\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00838}00838\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00839}00839\ \ \ \textcolor{comment}{//\ Checkbounds\ and\ calclikelihood\ are\ virtual}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00840}00840\ \ \ \textcolor{comment}{//\ Default\ behaviour\ is\ to\ reject\ negative\ values\ +\ do\ std\ llh\ calculation}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00841}00841\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ NOutside\ =\ \mbox{\hyperlink{classcovarianceBase_ac3c3e322dc06ce6a44a887ae13e522ae}{CheckBounds}}();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00842}00842\ \ \ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00843}00843\ \ \ \textcolor{keywordflow}{if}(NOutside\ >\ 0)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00844}00844\ \ \ \ \ \textcolor{keywordflow}{return}\ NOutside*\mbox{\hyperlink{covarianceBase_8h_a194098591fd0bc4afaf13b4fd8fee408}{\_LARGE\_LOGL\_}};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00845}00845\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00846}00846\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_a0056f747843633b2f8408f599f13f89f}{CalcLikelihood}}();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00847}00847\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00848}00848\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00849}00849\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00850}\mbox{\hyperlink{classcovarianceBase_ac1ff984cbc1b7858af9dd237cc1648d3}{00850}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_ac1ff984cbc1b7858af9dd237cc1648d3}{covarianceBase::printPars}}()\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00851}00851\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00852}00852\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Number\ of\ pars:\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00853}00853\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Current\ \{\}\ parameters:"{}},\ \mbox{\hyperlink{classcovarianceBase_a26618d3f5633b33ce20e38ce8261b3ee}{matrixName}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00854}00854\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00855}00855\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\{:s\}\ current:\ \(\backslash\)t\{:.5f\}\ \ \ \(\backslash\)tproposed:\ \(\backslash\)t\{:.5f\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}[i],\ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i],\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00856}00856\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00857}00857\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00858}00858\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00859}00859\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00860}00860\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00861}00861\ \textcolor{comment}{//\ Sets\ the\ proposed\ parameters\ to\ the\ nominal\ values}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00862}\mbox{\hyperlink{classcovarianceBase_aa4d9eaf56199245332f0b0be2c353944}{00862}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_aa4d9eaf56199245332f0b0be2c353944}{covarianceBase::setParameters}}(\textcolor{keyword}{const}\ std::vector<double>\&\ pars)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00863}00863\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00864}00864\ \ \ \textcolor{comment}{//\ If\ empty,\ set\ the\ proposed\ to\ nominal}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00865}00865\ \ \ \textcolor{keywordflow}{if}\ (pars.empty())\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00866}00866\ \ \ \ \ \textcolor{comment}{//\ For\ xsec\ this\ means\ setting\ to\ the\ prior\ (because\ nominal\ is\ the\ prior)}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00867}00867\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00868}00868\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00869}00869\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00870}00870\ \ \ \ \ \textcolor{comment}{//\ If\ not\ empty,\ set\ the\ parameters\ to\ the\ specified}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00871}00871\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00872}00872\ \ \ \ \ \textcolor{keywordflow}{if}\ (pars.size()\ !=\ \textcolor{keywordtype}{size\_t}(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}))\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00873}00873\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Warning:\ parameter\ arrays\ of\ incompatible\ size!\ Not\ changing\ parameters!\ \{\}\ has\ size\ \{\}\ but\ was\ expecting\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a26618d3f5633b33ce20e38ce8261b3ee}{matrixName}},\ pars.size(),\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00874}00874\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00875}00875\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00876}00876\ \ \ \ \ \textcolor{keywordtype}{int}\ parsSize\ =\ int(pars.size());}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00877}00877\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ parsSize;\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00878}00878\ \ \ \ \ \ \ \textcolor{comment}{//Make\ sure\ that\ you\ are\ actually\ passing\ a\ number\ to\ set\ the\ parameter\ to}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00879}00879\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(std::isnan(pars[i]))\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00880}00880\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Error:\ trying\ to\ set\ parameter\ value\ to\ a\ nan\ for\ parameter\ \{\}\ in\ matrix\ \{\}.\ This\ will\ not\ go\ well!"{}},\ \mbox{\hyperlink{classcovarianceBase_a033c5b6a8669537acaa6c5fc252899e6}{GetParName}}(i),\ \mbox{\hyperlink{classcovarianceBase_a26618d3f5633b33ce20e38ce8261b3ee}{matrixName}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00881}00881\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00882}00882\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00883}00883\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ =\ pars[i];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00884}00884\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00885}00885\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00886}00886\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00887}00887\ \ \ \textcolor{comment}{//\ And\ if\ pca\ make\ the\ transfer}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00888}00888\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00889}00889\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a651f5ecd8973918d5683606a607fa88c}{TransferToPCA}}();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00890}00890\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a65ac4956a782b01768f445732522a450}{TransferToParam}}();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00891}00891\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00892}00892\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00893}00893\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00894}00894\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00895}00895\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00896}\mbox{\hyperlink{classcovarianceBase_aae80acab113ac496a9bc56e28f6ae0c9}{00896}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_aae80acab113ac496a9bc56e28f6ae0c9}{covarianceBase::SetBranches}}(TTree\ \&tree,\ \textcolor{keywordtype}{bool}\ SaveProposal)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00897}00897\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00898}00898\ \ \ \textcolor{comment}{//\ loop\ over\ parameters\ and\ set\ a\ branch}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00899}00899\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00900}00900\ \ \ \ \ tree.Branch(\mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}[i].c\_str(),\ \&\mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i],\ Form(\textcolor{stringliteral}{"{}\%s/D"{}},\ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}[i].c\_str()));}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00901}00901\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00902}00902\ \ \ \textcolor{comment}{//\ When\ running\ PCA,\ also\ save\ PCA\ parameters}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00903}00903\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00904}00904\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00905}00905\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00906}00906\ \ \ \ \ \ \ tree.Branch(Form(\textcolor{stringliteral}{"{}\%s\_PCA"{}},\ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}[i].c\_str()),\ \&\mbox{\hyperlink{classcovarianceBase_aa96f87ab90dc26fc1b5e157149b9dfd3}{fParCurr\_PCA}}.GetMatrixArray()[i],\ Form(\textcolor{stringliteral}{"{}\%s\_PCA/D"{}},\ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}[i].c\_str()));}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00907}00907\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00908}00908\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00909}00909\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00910}00910\ \ \ \textcolor{keywordflow}{if}(SaveProposal)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00911}00911\ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00912}00912\ \ \ \ \ \textcolor{comment}{//\ loop\ over\ parameters\ and\ set\ a\ branch}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00913}00913\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00914}00914\ \ \ \ \ \ \ tree.Branch(Form(\textcolor{stringliteral}{"{}\%s\_Prop"{}},\ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}[i].c\_str()),\ \&\mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i],\ Form(\textcolor{stringliteral}{"{}\%s\_Prop/D"{}},\ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}[i].c\_str()));}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00915}00915\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00916}00916\ \ \ \ \ \textcolor{comment}{//\ When\ running\ PCA,\ also\ save\ PCA\ parameters}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00917}00917\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00918}00918\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00919}00919\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00920}00920\ \ \ \ \ \ \ \ \ tree.Branch(Form(\textcolor{stringliteral}{"{}\%s\_PCA\_Prop"{}},\ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}[i].c\_str()),\ \&\mbox{\hyperlink{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}{fParProp\_PCA}}.GetMatrixArray()[i],\ Form(\textcolor{stringliteral}{"{}\%s\_PCA\_Prop/D"{}},\ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}[i].c\_str()));}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00921}00921\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00922}00922\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00923}00923\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00924}00924\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00925}00925\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00926}00926\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00927}\mbox{\hyperlink{classcovarianceBase_a806cf53a69a35da2426169561f450b85}{00927}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_a806cf53a69a35da2426169561f450b85}{covarianceBase::setStepScale}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ scale)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00928}00928\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00929}00929\ \ \ \textcolor{keywordflow}{if}(scale\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00930}00930\ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00931}00931\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}You\ are\ trying\ so\ set\ StepScale\ to\ 0\ this\ will\ not\ work"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00932}00932\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00933}00933\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00934}00934\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\{\}\ setStepScale()\ =\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}{getName}}(),\ scale);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00935}00935\ \ \ \mbox{\hyperlink{classcovarianceBase_a0088413d6a15d12cd34ec06166302f5c}{\_fGlobalStepScale}}\ =\ scale;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00936}00936\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00937}00937\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00938}00938\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00939}\mbox{\hyperlink{classcovarianceBase_adb2d1a39cd2bd160257bc9e34e32df4c}{00939}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_adb2d1a39cd2bd160257bc9e34e32df4c}{covarianceBase::toggleFixAllParameters}}()\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00940}00940\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00941}00941\ \ \ \textcolor{comment}{//\ fix\ or\ unfix\ all\ parameters\ by\ multiplying\ by\ -\/1}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00942}00942\ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00943}00943\ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00944}00944\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)\ \mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}[i]\ *=\ -\/1.0;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00945}00945\ \ \ \}\ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00946}00946\ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}};\ i++)\ \mbox{\hyperlink{classcovarianceBase_a7b83a17de68cc7838b93de242d91d9a0}{fParSigma\_PCA}}[i]\ *=\ -\/1.0;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00947}00947\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00948}00948\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00949}00949\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00950}00950\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00951}00951\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00952}\mbox{\hyperlink{classcovarianceBase_aafbbdc05b87df882dc341e20fe870603}{00952}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_aafbbdc05b87df882dc341e20fe870603}{covarianceBase::toggleFixParameter}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ i)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00953}00953\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00954}00954\ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00955}00955\ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ >\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}})\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00956}00956\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Can't\ toggleFixParameter\ for\ parameter\ \{\}\ because\ size\ of\ covariance\ =\{\}"{}},\ i,\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00957}00957\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Fix\ this\ in\ your\ config\ file\ please!"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00958}00958\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00959}00959\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00960}00960\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}[i]\ *=\ -\/1.0;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00961}00961\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Setting\ \{\}(parameter\ \{\})\ to\ fixed\ at\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a6a46b5fed3e7feb6e9e151e90927bdbc}{GetParFancyName}}(i),\ i,\ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i]);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00962}00962\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00963}00963\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00964}00964\ \ \ \ \ \textcolor{keywordtype}{int}\ isDecom\ =\ -\/1;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00965}00965\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ im\ =\ 0;\ im\ <\ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}};\ ++im)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00966}00966\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classcovarianceBase_ae9f3cb2a310874b86965903714ef2bd8}{isDecomposed\_PCA}}[im]\ ==\ i)\ \{isDecom\ =\ im;\}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00967}00967\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00968}00968\ \ \ \ \ \textcolor{keywordflow}{if}(isDecom\ <\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00969}00969\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Parameter\ \{\}\ is\ PCA\ decomposed\ can't\ fix\ this"{}},\ \mbox{\hyperlink{classcovarianceBase_a033c5b6a8669537acaa6c5fc252899e6}{GetParName}}(i));}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00970}00970\ \ \ \ \ \ \ \textcolor{comment}{//throw\ MaCh3Exception(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00971}00971\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00972}00972\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a7b83a17de68cc7838b93de242d91d9a0}{fParSigma\_PCA}}[isDecom]\ *=\ -\/1.0;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00973}00973\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Setting\ un-\/decomposed\ \{\}(parameter\ \{\}/\{\}\ in\ PCA\ base)\ to\ fixed\ at\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a033c5b6a8669537acaa6c5fc252899e6}{GetParName}}(i),\ i,\ isDecom,\ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i]);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00974}00974\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00975}00975\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00976}00976\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00977}00977\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00978}00978\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00979}00979\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00980}\mbox{\hyperlink{classcovarianceBase_a41cc8dd2185af7cee380f3c6d463e5a4}{00980}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_aafbbdc05b87df882dc341e20fe870603}{covarianceBase::toggleFixParameter}}(\textcolor{keyword}{const}\ std::string\&\ name)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00981}00981\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00982}00982\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00983}00983\ \ \ \ \ \textcolor{keywordflow}{if}(name\ ==\ \mbox{\hyperlink{classcovarianceBase_a973671386a2f8ea924f25f8f5404654c}{\_fFancyNames}}[i])\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00984}00984\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_aafbbdc05b87df882dc341e20fe870603}{toggleFixParameter}}(i);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00985}00985\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00986}00986\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00987}00987\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00988}00988\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}I\ couldn't\ find\ parameter\ with\ name\ \{\},\ therefore\ will\ not\ fix\ it"{}},\ name);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00989}00989\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00990}00990\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00991}00991\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00992}\mbox{\hyperlink{classcovarianceBase_a1a0ed90bcbc2f932c7a32d26090edbbb}{00992}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classcovarianceBase_a2424eaebd9daa92b0294b352310770a3}{covarianceBase::isParameterFixed}}(\textcolor{keyword}{const}\ std::string\&\ name)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00993}00993\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00994}00994\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00995}00995\ \ \ \ \ \textcolor{keywordflow}{if}(name\ ==\ \mbox{\hyperlink{classcovarianceBase_a973671386a2f8ea924f25f8f5404654c}{\_fFancyNames}}[i])\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00996}00996\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_a2424eaebd9daa92b0294b352310770a3}{isParameterFixed}}(i);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00997}00997\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00998}00998\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l00999}00999\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}I\ couldn't\ find\ parameter\ with\ name\ \{\},\ therefore\ will\ not\ fix\ it"{}},\ name);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01000}01000\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01001}01001\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01002}01002\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01003}01003\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01004}\mbox{\hyperlink{classcovarianceBase_a1e9b4a09866909595a26fb2e1ea94cac}{01004}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_a1e9b4a09866909595a26fb2e1ea94cac}{covarianceBase::setFlatPrior}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ i,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ eL)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01005}01005\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01006}01006\ \ \ \textcolor{keywordflow}{if}\ (i\ >\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}})\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01007}01007\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Can't\ setEvalLikelihood\ for\ Cov=\{\}/Param=\{\}\ because\ size\ of\ Covariance\ =\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}{getName}}(),\ i,\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01008}01008\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Fix\ this\ in\ your\ config\ file\ please!"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01009}01009\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01010}01010\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01011}01011\ \ \ \ \ \textcolor{keywordflow}{if}(eL)\{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01012}01012\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Setting\ \{\}\ (parameter\ \{\})\ to\ flat\ prior"{}},\ \mbox{\hyperlink{classcovarianceBase_a033c5b6a8669537acaa6c5fc252899e6}{GetParName}}(i),\ i);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01013}01013\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01014}01014\ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01015}01015\ \ \ \ \ \ \ \textcolor{comment}{//\ HW\ ::\ This\ is\ useful}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01016}01016\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Setting\ \{\}\ (parameter\ \{\})\ to\ non-\/flat\ prior"{}},\ \mbox{\hyperlink{classcovarianceBase_a033c5b6a8669537acaa6c5fc252899e6}{GetParName}}(i),\ i);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01017}01017\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01018}01018\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ad9c47deb7009bff81210f666e80012eb}{\_fFlatPrior}}[i]\ =\ eL;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01019}01019\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01020}01020\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01021}01021\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01022}01022\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01023}01023\ \textcolor{comment}{//KS:\ Custom\ function\ to\ perform\ multiplication\ of\ matrix\ and\ vector\ with\ multithreading}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01024}\mbox{\hyperlink{classcovarianceBase_a64aaa71f81750ba27977c0405c51cd88}{01024}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_a64aaa71f81750ba27977c0405c51cd88}{covarianceBase::MatrixVectorMulti}}(\textcolor{keywordtype}{double}*\ \mbox{\hyperlink{Structs_8h_ab6a7e23420f0bcfb04f42f45f8283101}{\_restrict\_}}\ VecMulti,\ \textcolor{keywordtype}{double}**\ \mbox{\hyperlink{Structs_8h_ab6a7e23420f0bcfb04f42f45f8283101}{\_restrict\_}}\ matrix,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}*\ \mbox{\hyperlink{Structs_8h_ab6a7e23420f0bcfb04f42f45f8283101}{\_restrict\_}}\ vector,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ n)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01025}01025\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01026}01026\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01027}01027\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01028}01028\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01029}01029\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n;\ ++i)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01030}01030\ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01031}01031\ \ \ \ \ \textcolor{keywordtype}{double}\ result\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01032}01032\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01033}01033\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ simd}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01034}01034\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01035}01035\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ n;\ ++j)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01036}01036\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01037}01037\ \ \ \ \ \ \ result\ +=\ matrix[i][j]*vector[j];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01038}01038\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01039}01039\ \ \ \ \ VecMulti[i]\ =\ result;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01040}01040\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01041}01041\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01042}01042\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01043}01043\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01044}\mbox{\hyperlink{classcovarianceBase_a767242ffde1e52dff143889e5534b4e3}{01044}}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classcovarianceBase_a767242ffde1e52dff143889e5534b4e3}{covarianceBase::MatrixVectorMultiSingle}}(\textcolor{keywordtype}{double}**\ \mbox{\hyperlink{Structs_8h_ab6a7e23420f0bcfb04f42f45f8283101}{\_restrict\_}}\ matrix,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}*\ \mbox{\hyperlink{Structs_8h_ab6a7e23420f0bcfb04f42f45f8283101}{\_restrict\_}}\ vector,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ Length,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ i)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01045}01045\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01046}01046\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01047}01047\ \ \ \textcolor{keywordtype}{double}\ Element\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01048}01048\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01049}01049\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ simd}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01050}01050\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01051}01051\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ Length;\ ++j)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01052}01052\ \ \ \ \ Element\ +=\ matrix[i][j]*vector[j];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01053}01053\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01054}01054\ \ \ \textcolor{keywordflow}{return}\ Element;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01055}01055\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01056}01056\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01057}01057\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01058}\mbox{\hyperlink{classcovarianceBase_a57fcbce7dbdc47e3b6ff9344c215ed9a}{01058}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_a21b912b31c888a2bdae9145a0c10a614}{covarianceBase::setIndivStepScale}}(\textcolor{keyword}{const}\ std::vector<double>\&\ stepscale)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01059}01059\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01060}01060\ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordtype}{int}(stepscale.size())\ !=\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}})}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01061}01061\ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01062}01062\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Stepscale\ vector\ not\ equal\ to\ number\ of\ parameters.\ Quitting.."{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01063}01063\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Size\ of\ argument\ vector:\ \{\}"{}},\ stepscale.size());}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01064}01064\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Expected\ size:\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01065}01065\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01066}01066\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01067}01067\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01068}01068\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ iParam\ =\ 0\ ;\ iParam\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ iParam++)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01069}01069\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a3cda39026e336a49cef482efd4062561}{\_fIndivStepScale}}[iParam]\ =\ stepscale[iParam];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01070}01070\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01071}01071\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01072}01072\ \ \ \mbox{\hyperlink{classcovarianceBase_ad3c0dddbedcf57f06a14ec52800a087b}{printIndivStepScale}}();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01073}01073\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01074}01074\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01075}01075\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01076}01076\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01077}01077\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01078}\mbox{\hyperlink{classcovarianceBase_ad3c0dddbedcf57f06a14ec52800a087b}{01078}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_ad3c0dddbedcf57f06a14ec52800a087b}{covarianceBase::printIndivStepScale}}()\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01079}01079\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01080}01080\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}============================================================"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01081}01081\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\{:<\{\}\}\ |\ \{:<11\}"{}},\ \textcolor{stringliteral}{"{}Parameter:"{}},\ \mbox{\hyperlink{classcovarianceBase_a8d821ce805f2426fe95549170866821f}{PrintLength}},\ \textcolor{stringliteral}{"{}Step\ scale:"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01082}01082\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ iParam\ =\ 0;\ iParam\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ iParam++)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01083}01083\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\{:<\{\}\}\ |\ \{:<11\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}[iParam].c\_str(),\ \mbox{\hyperlink{classcovarianceBase_a8d821ce805f2426fe95549170866821f}{PrintLength}},\ \mbox{\hyperlink{classcovarianceBase_a3cda39026e336a49cef482efd4062561}{\_fIndivStepScale}}[iParam]);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01084}01084\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01085}01085\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}============================================================"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01086}01086\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01087}01087\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01088}01088\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01089}01089\ \textcolor{comment}{//Makes\ sure\ that\ matrix\ is\ positive-\/definite\ by\ adding\ a\ small\ number\ to\ on-\/diagonal\ elements}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01090}\mbox{\hyperlink{classcovarianceBase_ae2850c8e2f2d4acfe322b0ebe65b07cf}{01090}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_ae2850c8e2f2d4acfe322b0ebe65b07cf}{covarianceBase::MakePosDef}}(TMatrixDSym\ *cov)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01091}01091\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01092}01092\ \ \ \textcolor{comment}{//DB\ Save\ original\ warning\ state\ and\ then\ increase\ it\ in\ this\ function\ to\ suppress\ 'matrix\ not\ positive\ definite'\ messages}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01093}01093\ \ \ \textcolor{comment}{//Means\ we\ no\ longer\ need\ to\ overload}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01094}01094\ \ \ \textcolor{keywordflow}{if}(cov\ ==\ \textcolor{keyword}{nullptr})\{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01095}01095\ \ \ \ \ cov\ =\ \&*\mbox{\hyperlink{classcovarianceBase_a6c3fe8db34c06299fd1633951ac00937}{covMatrix}};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01096}01096\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01097}01097\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01098}01098\ \ \ \textcolor{keywordtype}{int}\ originalErrorWarning\ =\ gErrorIgnoreLevel;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01099}01099\ \ \ gErrorIgnoreLevel\ =\ kFatal;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01100}01100\ \ \ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01101}01101\ \ \ \textcolor{comment}{//DB\ Loop\ 1000\ times\ adding\ 1e-\/9\ which\ tops\ out\ at\ 1e-\/6\ shift\ on\ the\ diagonal\ before\ throwing\ error}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01102}01102\ \ \ \textcolor{keywordtype}{int}\ MaxAttempts\ =\ 1e5;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01103}01103\ \ \ \textcolor{keywordtype}{int}\ iAttempt\ =\ 0;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01104}01104\ \ \ \textcolor{keywordtype}{bool}\ CanDecomp\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01105}01105\ \ \ TDecompChol\ chdcmp;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01106}01106\ \ \ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01107}01107\ \ \ \textcolor{keywordflow}{for}\ (iAttempt\ =\ 0;\ iAttempt\ <\ MaxAttempts;\ iAttempt++)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01108}01108\ \ \ \ \ chdcmp\ =\ TDecompChol(*cov);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01109}01109\ \ \ \ \ \textcolor{keywordflow}{if}\ (chdcmp.Decompose())\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01110}01110\ \ \ \ \ \ \ CanDecomp\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01111}01111\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01112}01112\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01113}01113\ \textcolor{preprocessor}{\ \ \ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01114}01114\ \textcolor{preprocessor}{\ \ \ \ \ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01115}01115\ \textcolor{preprocessor}{\ \ \ \ \ \ \#endif}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01116}01116\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ iVar\ =\ 0\ ;\ iVar\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ iVar++)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01117}01117\ \ \ \ \ \ \ \ \ (*cov)(iVar,iVar)\ +=\ pow(10,-\/9);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01118}01118\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01119}01119\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01120}01120\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01121}01121\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01122}01122\ \ \ \textcolor{keywordflow}{if}\ (!CanDecomp)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01123}01123\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Tried\ \{\}\ times\ to\ shift\ diagonal\ but\ still\ can\ not\ decompose\ the\ matrix"{}},\ MaxAttempts);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01124}01124\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}This\ indicates\ that\ something\ is\ wrong\ with\ the\ input\ matrix"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01125}01125\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01126}01126\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01127}01127\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_ab2837af4566e2d62db7b76f9527fb6d7}{total\_steps}}\ <\ 2)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01128}01128\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Had\ to\ shift\ diagonal\ \{\}\ time(s)\ to\ allow\ the\ covariance\ matrix\ to\ be\ decomposed"{}},\ iAttempt);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01129}01129\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01130}01130\ \ \ \textcolor{comment}{//DB\ Resetting\ warning\ level}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01131}01131\ \ \ gErrorIgnoreLevel\ =\ originalErrorWarning;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01132}01132\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01133}01133\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01134}01134\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01135}01135\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01136}01136\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01137}\mbox{\hyperlink{classcovarianceBase_a0993a1ea6c5b06ba834e9e70af87ee9e}{01137}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_a0993a1ea6c5b06ba834e9e70af87ee9e}{covarianceBase::resetIndivStepScale}}()\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01138}01138\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01139}01139\ \ \ std::vector<double>\ stepScales(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01140}01140\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01141}01141\ \ \ \ \ stepScales[i]\ =\ 1.;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01142}01142\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01143}01143\ \ \ \mbox{\hyperlink{classcovarianceBase_a0088413d6a15d12cd34ec06166302f5c}{\_fGlobalStepScale}}\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01144}01144\ \ \ \mbox{\hyperlink{classcovarianceBase_a21b912b31c888a2bdae9145a0c10a614}{setIndivStepScale}}(stepScales);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01145}01145\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01146}01146\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01147}01147\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01148}01148\ \textcolor{comment}{//\ HW:\ Code\ for\ throwing\ from\ separate\ throw\ matrix,\ needs\ to\ be\ set\ after\ init\ to\ ensure\ pos-\/def}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01149}\mbox{\hyperlink{classcovarianceBase_af30ca7861452e1446e55700f4b49b608}{01149}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_af30ca7861452e1446e55700f4b49b608}{covarianceBase::setThrowMatrix}}(TMatrixDSym\ *cov)\{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01150}01150\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01151}01151\ \ \ \ \textcolor{keywordflow}{if}\ (cov\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01152}01152\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Could\ not\ find\ covariance\ matrix\ you\ provided\ to\ setThrowMatrix"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01153}01153\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01154}01154\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01155}01155\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01156}01156\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a6c3fe8db34c06299fd1633951ac00937}{covMatrix}}-\/>GetNrows()\ !=\ cov-\/>GetNrows())\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01157}01157\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Matrix\ given\ for\ throw\ Matrix\ is\ not\ the\ same\ size\ as\ the\ covariance\ matrix\ stored\ in\ object!"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01158}01158\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Stored\ covariance\ matrix\ size:\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a6c3fe8db34c06299fd1633951ac00937}{covMatrix}}-\/>GetNrows());}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01159}01159\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Given\ matrix\ size:\ \{\}"{}},\ cov-\/>GetNrows());}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01160}01160\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01161}01161\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01162}01162\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01163}01163\ \ \ \mbox{\hyperlink{classcovarianceBase_a6cb3d0b4096fbb55b040f70cd5b6e32b}{throwMatrix}}\ =\ \textcolor{keyword}{static\_cast<}TMatrixDSym*\textcolor{keyword}{>}(cov-\/>Clone());}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01164}01164\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classcovarianceBase_a838731abd6716940043b484b2b266f86}{use\_adaptive}}\ \&\&\ \mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_a39a099e5712cf605190a53a4355c700c}{AdaptionUpdate}}())\ \mbox{\hyperlink{classcovarianceBase_a8a709e1c6c58618cf65400eef1741cc7}{makeClosestPosDef}}(\mbox{\hyperlink{classcovarianceBase_a6cb3d0b4096fbb55b040f70cd5b6e32b}{throwMatrix}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01165}01165\ \ \ \textcolor{keywordflow}{else}\ \mbox{\hyperlink{classcovarianceBase_ae2850c8e2f2d4acfe322b0ebe65b07cf}{MakePosDef}}(\mbox{\hyperlink{classcovarianceBase_a6cb3d0b4096fbb55b040f70cd5b6e32b}{throwMatrix}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01166}01166\ \ \ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01167}01167\ \ \ TDecompChol\ TDecompChol\_throwMatrix(*\mbox{\hyperlink{classcovarianceBase_a6cb3d0b4096fbb55b040f70cd5b6e32b}{throwMatrix}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01168}01168\ \ \ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01169}01169\ \ \ \textcolor{keywordflow}{if}(!TDecompChol\_throwMatrix.Decompose())\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01170}01170\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Cholesky\ decomposition\ failed\ for\ \{\}\ trying\ to\ make\ positive\ definite"{}},\ \mbox{\hyperlink{classcovarianceBase_a26618d3f5633b33ce20e38ce8261b3ee}{matrixName}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01171}01171\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01172}01172\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01173}01173\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01174}01174\ \ \ \mbox{\hyperlink{classcovarianceBase_ab95f5e066c2dfb1d20d120bc6c85dda2}{throwMatrix\_CholDecomp}}\ =\ \textcolor{keyword}{new}\ TMatrixD(TDecompChol\_throwMatrix.GetU());}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01175}01175\ \ \ \mbox{\hyperlink{classcovarianceBase_ab95f5e066c2dfb1d20d120bc6c85dda2}{throwMatrix\_CholDecomp}}-\/>T();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01176}01176\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01177}01177\ \ \ \textcolor{comment}{//KS:\ ROOT\ has\ bad\ memory\ management,\ using\ standard\ double\ means\ we\ can\ decrease\ most\ operation\ by\ factor\ 2\ simply\ due\ to\ cache\ hits}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01178}01178\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01179}01179\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for\ collapse(2)}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01180}01180\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01181}01181\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01182}01182\ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01183}01183\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++j)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01184}01184\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01185}01185\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}}[i][j]\ =\ (*throwMatrix\_CholDecomp)(i,j);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01186}01186\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01187}01187\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01188}01188\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01189}01189\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01190}01190\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01191}\mbox{\hyperlink{classcovarianceBase_a7e2d3623bbbf3edee558e04737fe2add}{01191}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_a7e2d3623bbbf3edee558e04737fe2add}{covarianceBase::updateThrowMatrix}}(TMatrixDSym\ *cov)\{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01192}01192\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01193}01193\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classcovarianceBase_a6cb3d0b4096fbb55b040f70cd5b6e32b}{throwMatrix}};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01194}01194\ \ \ \mbox{\hyperlink{classcovarianceBase_a6cb3d0b4096fbb55b040f70cd5b6e32b}{throwMatrix}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01195}01195\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classcovarianceBase_ab95f5e066c2dfb1d20d120bc6c85dda2}{throwMatrix\_CholDecomp}};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01196}01196\ \ \ \mbox{\hyperlink{classcovarianceBase_ab95f5e066c2dfb1d20d120bc6c85dda2}{throwMatrix\_CholDecomp}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01197}01197\ \ \ \mbox{\hyperlink{classcovarianceBase_af30ca7861452e1446e55700f4b49b608}{setThrowMatrix}}(cov);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01198}01198\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01199}01199\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01200}01200\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01201}01201\ \textcolor{comment}{//\ HW\ :\ Here\ be\ adaption}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01202}\mbox{\hyperlink{classcovarianceBase_a715900cc67fcc598090399ee931938e9}{01202}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_a715900cc67fcc598090399ee931938e9}{covarianceBase::initialiseAdaption}}(\textcolor{keyword}{const}\ YAML::Node\&\ adapt\_manager)\{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01203}01203\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01204}01204\ \ \ \textcolor{comment}{//\ need\ to\ cast\ matrixName\ to\ string}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01205}01205\ \ \ std::string\ matrix\_name\_str(\mbox{\hyperlink{classcovarianceBase_a26618d3f5633b33ce20e38ce8261b3ee}{matrixName}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01206}01206\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01207}01207\ \ \ \textcolor{comment}{//\ Now\ we\ read\ the\ general\ settings\ [these\ SHOULD\ be\ common\ across\ all\ matrices!]}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01208}01208\ \ \ \textcolor{keywordtype}{bool}\ success\ =\ \mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_a192304475bc377ef975ef40d2bd2b254}{InitFromConfig}}(adapt\_manager,\ matrix\_name\_str,\ \mbox{\hyperlink{classcovarianceBase_a261941a4c06e5d875174d8769a4d02f1}{getNpars}}());}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01209}01209\ \ \ \textcolor{keywordflow}{if}(!success)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01210}01210\ \ \ \mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_a5997a813faf68d891c62cbaf65984aca}{Print}}();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01211}01211\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01212}01212\ \ \ \textcolor{comment}{//\ Next\ let"{}s\ check\ for\ external\ matrices}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01213}01213\ \ \ \textcolor{comment}{//\ We"{}re\ going\ to\ grab\ this\ info\ from\ the\ YAML\ manager}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01214}01214\ \ \ \textcolor{keywordflow}{if}(!GetFromManager<bool>(adapt\_manager[\textcolor{stringliteral}{"{}AdaptionOptions"{}}][\textcolor{stringliteral}{"{}Covariance"{}}][matrix\_name\_str][\textcolor{stringliteral}{"{}UseExternalMatrix"{}}],\ \textcolor{keyword}{false}))\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01215}01215\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Not\ using\ external\ matrix\ for\ \{\},\ initialising\ adaption\ from\ scratch"{}},\ matrix\_name\_str);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01216}01216\ \ \ \ \ \textcolor{comment}{//\ If\ we\ don't\ have\ a\ covariance\ matrix\ to\ start\ from\ for\ adaptive\ tune\ we\ need\ to\ make\ one!}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01217}01217\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a838731abd6716940043b484b2b266f86}{use\_adaptive}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01218}01218\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_ad7df80045651df99c2d1c375fea4ac74}{CreateNewAdaptiveCovariance}}(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01219}01219\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01220}01220\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01221}01221\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01222}01222\ \ \ \textcolor{comment}{//\ Finally,\ we\ accept\ that\ we\ want\ to\ read\ the\ matrix\ from\ a\ file!}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01223}01223\ \ \ std::string\ external\_file\_name\ =\ GetFromManager<std::string>(adapt\_manager[\textcolor{stringliteral}{"{}AdaptionOptions"{}}][\textcolor{stringliteral}{"{}Covariance"{}}][matrix\_name\_str][\textcolor{stringliteral}{"{}ExternalMatrixFileName"{}}],\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01224}01224\ \ \ std::string\ external\_matrix\_name\ =\ GetFromManager<std::string>(adapt\_manager[\textcolor{stringliteral}{"{}AdaptionOptions"{}}][\textcolor{stringliteral}{"{}Covariance"{}}][matrix\_name\_str][\textcolor{stringliteral}{"{}ExternalMatrixName"{}}],\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01225}01225\ \ \ std::string\ external\_mean\_name\ =\ GetFromManager<std::string>(adapt\_manager[\textcolor{stringliteral}{"{}AdaptionOptions"{}}][\textcolor{stringliteral}{"{}Covariance"{}}][matrix\_name\_str][\textcolor{stringliteral}{"{}ExternalMeansName"{}}],\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01226}01226\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01227}01227\ \ \ \mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_aebd1df26766a9f106fe6ce4255ceb0d9}{SetThrowMatrixFromFile}}(external\_file\_name,\ external\_matrix\_name,\ external\_mean\_name,\ \mbox{\hyperlink{classcovarianceBase_a838731abd6716940043b484b2b266f86}{use\_adaptive}},\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01228}01228\ \ \ \mbox{\hyperlink{classcovarianceBase_af30ca7861452e1446e55700f4b49b608}{setThrowMatrix}}(\mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_afd61e64f18f5c25dbbd6bb2bd619a268}{adaptive\_covariance}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01229}01229\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Successfully\ Set\ External\ Throw\ Matrix\ Stored\ in\ \{\}"{}},\ external\_file\_name);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01230}01230\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01231}01231\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01232}01232\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01233}01233\ \textcolor{comment}{//\ Truely\ adaptive\ MCMC!}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01234}\mbox{\hyperlink{classcovarianceBase_a50ce8ebb96ebd64190dc37e4bf950a9b}{01234}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_a50ce8ebb96ebd64190dc37e4bf950a9b}{covarianceBase::updateAdaptiveCovariance}}()\{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01235}01235\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01236}01236\ \ \ \textcolor{comment}{//\ Updates\ adaptive\ matrix}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01237}01237\ \ \ \textcolor{comment}{//\ First\ we\ update\ the\ total\ means}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01238}01238\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01239}01239\ \ \ \textcolor{comment}{//\ Skip\ this\ if\ we're\ at\ a\ large\ number\ of\ steps}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01240}01240\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_af797ab969eb8c1802afa12df8c2106d8}{SkipAdaption}}())\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01241}01241\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01242}01242\ \ \ \textcolor{comment}{//\ Call\ main\ adaption\ function}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01243}01243\ \ \ \mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_a828e12f4ecb82252341af5f5e54f7ad3}{UpdateAdaptiveCovariance}}(\mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}},\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01244}01244\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01245}01245\ \ \ \textcolor{comment}{//This\ is\ likely\ going\ to\ be\ the\ slow\ bit!}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01246}01246\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_a77726d0255edf32a817339fcbac30bee}{IndivStepScaleAdapt}}())\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01247}01247\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a0993a1ea6c5b06ba834e9e70af87ee9e}{resetIndivStepScale}}();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01248}01248\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01249}01249\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01250}01250\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_a217c72a492c9d3e1b3a7b14626d19ab2}{UpdateMatrixAdapt}}())\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01251}01251\ \ \ \ \ TMatrixDSym*\ update\_matrix\ =\ \textcolor{keyword}{static\_cast<}TMatrixDSym*\textcolor{keyword}{>}(\mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_afd61e64f18f5c25dbbd6bb2bd619a268}{adaptive\_covariance}}-\/>Clone());}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01252}01252\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a7e2d3623bbbf3edee558e04737fe2add}{updateThrowMatrix}}(update\_matrix);\ \textcolor{comment}{//Now\ we\ update\ and\ continue!}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01253}01253\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01254}01254\ \ \ \mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_ab2837af4566e2d62db7b76f9527fb6d7}{total\_steps}}++;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01255}01255\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01256}01256\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01257}01257\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01258}01258\ \textcolor{comment}{//HW:\ Finds\ closest\ possible\ positive\ definite\ matrix\ in\ Frobenius\ Norm\ ||.||\_frob}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01259}01259\ \textcolor{comment}{//\ Where\ ||X||\_frob=sqrt[sum\_ij(x\_ij\string^2)]\ (basically\ just\ turns\ an\ n,n\ matrix\ into\ vector\ in\ n\string^2\ space}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01260}01260\ \textcolor{comment}{//\ then\ does\ Euclidean\ norm)}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01261}\mbox{\hyperlink{classcovarianceBase_a8a709e1c6c58618cf65400eef1741cc7}{01261}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_a8a709e1c6c58618cf65400eef1741cc7}{covarianceBase::makeClosestPosDef}}(TMatrixDSym\ *cov)\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01262}01262\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01263}01263\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01264}01264\ \ \ \textcolor{comment}{//\ Want\ to\ get\ cov'\ =\ (cov\_sym+cov\_polar)/2}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01265}01265\ \ \ \textcolor{comment}{//\ cov\_sym=(cov+cov\string^T)/2}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01266}01266\ \ \ \textcolor{comment}{//\ cov\_polar-\/>\ SVD\ cov\ to\ cov=USV\string^T\ then\ cov\_polar=VSV\string^T}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01267}01267\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01268}01268\ \ \ \textcolor{comment}{//Get\ frob\ norm\ of\ cov}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01269}01269\ \ \ \textcolor{comment}{//\ \ Double\_t\ cov\_norm=cov-\/>E2Norm();}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01270}01270\ \ \ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01271}01271\ \ \ TMatrixDSym*\ cov\_trans\ =\ cov;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01272}01272\ \ \ cov\_trans-\/>T();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01273}01273\ \ \ TMatrixDSym\ cov\_sym\ =\ 0.5*(*cov+*cov\_trans);\ \textcolor{comment}{//If\ cov\ is\ symmetric\ does\ nothing,\ otherwise\ just\ ensures\ symmetry}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01274}01274\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01275}01275\ \ \ \textcolor{comment}{//Do\ SVD\ to\ get\ polar\ form}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01276}01276\ \ \ TDecompSVD\ cov\_sym\_svd=TDecompSVD(cov\_sym);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01277}01277\ \ \ \textcolor{keywordflow}{if}(!cov\_sym\_svd.Decompose())\{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01278}01278\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Cannot\ do\ SVD\ on\ input\ matrix!"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01279}01279\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01280}01280\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01281}01281\ \ \ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01282}01282\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01283}01283\ \ \ TMatrixD\ cov\_sym\_v\ =\ cov\_sym\_svd.GetV();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01284}01284\ \ \ TMatrixD\ cov\_sym\_vt\ =\ cov\_sym\_v;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01285}01285\ \ \ cov\_sym\_vt.T();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01286}01286\ \ \ \textcolor{comment}{//SVD\ returns\ as\ vector\ (grrr)\ so\ need\ to\ get\ into\ matrix\ form\ for\ multiplying!}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01287}01287\ \ \ TVectorD\ cov\_sym\_sigvect\ =\ cov\_sym\_svd.GetSig();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01288}01288\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01289}01289\ \ \ \textcolor{keyword}{const}\ Int\_t\ nCols\ =\ cov\_sym\_v.GetNcols();\ \textcolor{comment}{//square\ so\ only\ need\ rows\ hence\ lack\ of\ cols}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01290}01290\ \ \ TMatrixDSym\ cov\_sym\_sig(nCols);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01291}01291\ \ \ TMatrixDDiag\ cov\_sym\_sig\_diag(cov\_sym\_sig);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01292}01292\ \ \ cov\_sym\_sig\_diag=cov\_sym\_sigvect;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01293}01293\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01294}01294\ \ \ \textcolor{comment}{//Can\ finally\ get\ H=VSV}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01295}01295\ \ \ TMatrixDSym\ cov\_sym\_polar\ =\ cov\_sym\_sig.SimilarityT(cov\_sym\_vt);\textcolor{comment}{//V*S*V\string^T\ (this\ took\ forver\ to\ find!)}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01296}01296\ \ \ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01297}01297\ \ \ \textcolor{comment}{//Now\ we\ can\ construct\ closest\ approximater\ Ahat=0.5*(B+H)}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01298}01298\ \ \ TMatrixDSym\ cov\_closest\_approx\ \ =\ 0.5*(cov\_sym+cov\_sym\_polar);\textcolor{comment}{//Not\ fully\ sure\ why\ this\ is\ even\ needed\ since\ symmetric\ B\ -\/>\ U=V}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01299}01299\ \ \ \textcolor{comment}{//Get\ norm\ of\ transformed}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01300}01300\ \ \ \textcolor{comment}{//\ \ Double\_t\ approx\_norm=cov\_closest\_approx.E2Norm();}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01301}01301\ \ \ \textcolor{comment}{//MACH3LOG\_INFO("{}Initial\ Norm:\ \{:.6f\}\ |\ Norm\ after\ transformation:\ \{:.6f\}\ |\ Ratio:\ \{:.6f\}"{},\ cov\_norm,\ approx\_norm,\ cov\_norm\ /\ approx\_norm);}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01302}01302\ \ \ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01303}01303\ \ \ *cov\ =\ cov\_closest\_approx;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01304}01304\ \ \ \textcolor{comment}{//Now\ can\ just\ add\ a\ makeposdef!}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01305}01305\ \ \ \mbox{\hyperlink{classcovarianceBase_ae2850c8e2f2d4acfe322b0ebe65b07cf}{MakePosDef}}(cov);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01306}01306\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01307}01307\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01308}01308\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01309}\mbox{\hyperlink{classcovarianceBase_ae0a231f87266048a3cd2e0032eaf0f30}{01309}}\ std::vector<double>\ \mbox{\hyperlink{classcovarianceBase_ae0a231f87266048a3cd2e0032eaf0f30}{covarianceBase::getNominalArray}}()\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01310}01310\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01311}01311\ \ \ std::vector<double>\ \mbox{\hyperlink{GetPenaltyTerm_8cpp_a35f9d8ea46badc9ea84d62feaa0e73df}{nominal}}(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01312}01312\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01313}01313\ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01314}01314\ \ \ \ \ \mbox{\hyperlink{GetPenaltyTerm_8cpp_a35f9d8ea46badc9ea84d62feaa0e73df}{nominal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i];}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01315}01315\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01316}01316\ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{GetPenaltyTerm_8cpp_a35f9d8ea46badc9ea84d62feaa0e73df}{nominal}};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01317}01317\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01318}01318\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01319}01319\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01320}01320\ \textcolor{comment}{//\ KS:\ Convert\ covariance\ matrix\ to\ correlation\ matrix\ and\ return\ TH2D\ which\ can\ be\ used\ for\ fancy\ plotting}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01321}\mbox{\hyperlink{classcovarianceBase_ac14fabdb87f5101cdbfcecb8e6b6b811}{01321}}\ TH2D*\ \mbox{\hyperlink{classcovarianceBase_ac14fabdb87f5101cdbfcecb8e6b6b811}{covarianceBase::GetCorrelationMatrix}}()\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01322}01322\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01323}01323\ \ \ TH2D*\ hMatrix\ =\ \textcolor{keyword}{new}\ TH2D(\mbox{\hyperlink{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}{getName}}().c\_str(),\ \mbox{\hyperlink{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}{getName}}().c\_str(),\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}},\ 0.0,\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}},\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}},\ 0.0,\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01324}01324\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01325}01325\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01326}01326\ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01327}01327\ \ \ \ \ hMatrix-\/>SetBinContent(i+1,\ i+1,\ 1.);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01328}01328\ \ \ \ \ hMatrix-\/>GetXaxis()-\/>SetBinLabel(i+1,\ \mbox{\hyperlink{classcovarianceBase_a6a46b5fed3e7feb6e9e151e90927bdbc}{GetParFancyName}}(i).c\_str());}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01329}01329\ \ \ \ \ hMatrix-\/>GetYaxis()-\/>SetBinLabel(i+1,\ \mbox{\hyperlink{classcovarianceBase_a6a46b5fed3e7feb6e9e151e90927bdbc}{GetParFancyName}}(i).c\_str());}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01330}01330\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01331}01331\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01332}01332\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01333}01333\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01334}01334\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01335}01335\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01336}01336\ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01337}01337\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ j++)}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01338}01338\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01339}01339\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Corr\ =\ (*covMatrix)(i,j)\ /\ (\ \mbox{\hyperlink{classcovarianceBase_a01e3ab6a6758fc58b8c695556a39d879}{getDiagonalError}}(i)\ *\ \mbox{\hyperlink{classcovarianceBase_a01e3ab6a6758fc58b8c695556a39d879}{getDiagonalError}}(j));}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01340}01340\ \ \ \ \ \ \ hMatrix-\/>SetBinContent(i+1,\ j+1,\ Corr);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01341}01341\ \ \ \ \ \ \ hMatrix-\/>SetBinContent(j+1,\ i+1,\ Corr);}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01342}01342\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01343}01343\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01344}01344\ \ \ \textcolor{keywordflow}{return}\ hMatrix;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01345}01345\ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01346}01346\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01347}01347\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01348}01348\ \textcolor{comment}{//\ KS:\ After\ step\ scale,\ prefit\ etc.\ value\ were\ modified\ save\ this\ modified\ config.}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01349}\mbox{\hyperlink{classcovarianceBase_ab36f40d40f4747718c98d368c04f41b7}{01349}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcovarianceBase_ab36f40d40f4747718c98d368c04f41b7}{covarianceBase::SaveUpdatedMatrixConfig}}()\ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01350}01350\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01351}01351\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_a933ff3dc0af99629ba3582a5d9d89d23}{\_fYAMLDoc}})}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01352}01352\ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01353}01353\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a07ff6d6a15b24f94afc88a1b89779beb}{MACH3LOG\_CRITICAL}}(\textcolor{stringliteral}{"{}Yaml\ node\ hasn't\ been\ initialised\ for\ matrix\ \{\},\ something\ is\ not\ right"{}},\ \mbox{\hyperlink{classcovarianceBase_a26618d3f5633b33ce20e38ce8261b3ee}{matrixName}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01354}01354\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a07ff6d6a15b24f94afc88a1b89779beb}{MACH3LOG\_CRITICAL}}(\textcolor{stringliteral}{"{}I\ am\ not\ throwing\ error\ but\ should\ be\ investigated"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01355}01355\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01356}01356\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01357}01357\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01358}01358\ \ \ YAML::Node\ copyNode\ =\ \mbox{\hyperlink{classcovarianceBase_a933ff3dc0af99629ba3582a5d9d89d23}{\_fYAMLDoc}};}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01359}01359\ \ \ \textcolor{keywordtype}{int}\ i\ =\ 0;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01360}01360\ }
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01361}01361\ \ \ \textcolor{keywordflow}{for}\ (YAML::Node\ param\ :\ copyNode[\textcolor{stringliteral}{"{}Systematics"{}}])}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01362}01362\ \ \ \{}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01363}01363\ \ \ \ \ \textcolor{comment}{//KS:\ Feel\ free\ to\ update\ it,\ if\ you\ need\ updated\ prefit\ value\ etc}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01364}01364\ \ \ \ \ param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}StepScale"{}}][\textcolor{stringliteral}{"{}MCMC"{}}]\ =\ std::round(\mbox{\hyperlink{classcovarianceBase_a3cda39026e336a49cef482efd4062561}{\_fIndivStepScale}}[i]\ *\ 100.0)\ /\ 100.0;\ \textcolor{comment}{//\ Round\ to\ 2\ decimal\ places}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01365}01365\ \ \ \ \ i++;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01366}01366\ \ \ \}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01367}01367\ \ \ \textcolor{comment}{//\ Save\ the\ modified\ node\ to\ a\ file}}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01368}01368\ \ \ std::ofstream\ fout(\textcolor{stringliteral}{"{}Modified\_Matrix.yaml"{}});}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01369}01369\ \ \ fout\ <<\ copyNode;}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01370}01370\ \ \ fout.close();}
\DoxyCodeLine{\Hypertarget{covarianceBase_8cpp_source_l01371}01371\ \}}

\end{DoxyCode}
