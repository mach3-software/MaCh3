\hypertarget{RHat_8cpp}{}\doxysection{/home/runner/work/\+Ma\+Ch3/\+Ma\+Ch3/\+Diagnostics/\+RHat.cpp File Reference}
\label{RHat_8cpp}\index{/home/runner/work/MaCh3/MaCh3/Diagnostics/RHat.cpp@{/home/runner/work/MaCh3/MaCh3/Diagnostics/RHat.cpp}}


This executable calculates the $ \hat{R} $ estimator for Markov Chain Monte Carlo (MCMC) convergence.  


{\ttfamily \#include \char`\"{}TObj\+Array.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}TChain.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}TFile.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}TBranch.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}TCanvas.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}TLine.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}TLegend.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}TString.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}TH1.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}TRandom3.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}TStopwatch.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}TColor.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}TStyle.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}TROOT.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}manager/manager.\+h\char`\"{}}\newline
Include dependency graph for RHat.\+cpp\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{RHat_8cpp__incl}
\end{center}
\end{figure}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{RHat_8cpp_af40d823e599ba2565e989e4f43c78628}{Prepare\+Chains}} ()
\item 
void \mbox{\hyperlink{RHat_8cpp_a3efe8085dcbead1e66a6cf54fc77ab5e}{Initialise\+Arrays}} ()
\item 
void \mbox{\hyperlink{RHat_8cpp_a4c5629fb030eb27c32cab42a42c6623b}{Run\+Diagnostic}} ()
\item 
void \mbox{\hyperlink{RHat_8cpp_abd5f8455bf73bda17794dc06218e6713}{Calc\+Rhat}} ()
\item 
void \mbox{\hyperlink{RHat_8cpp_a194d97ca48b57a07a9df018a65f3166e}{Save\+Results}} ()
\item 
void \mbox{\hyperlink{RHat_8cpp_abb60917440a91d5a3507fd4059d3e23b}{Destroy\+Arrays}} ()
\item 
double \mbox{\hyperlink{RHat_8cpp_ac038d6f2a074799534fc4a986ca36ef3}{Calc\+Median}} (double arr\mbox{[}$\,$\mbox{]}, int \mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}})
\item 
void \mbox{\hyperlink{RHat_8cpp_a29838c9a1c93843ffd2eb4dc33f2076d}{Cap\+Variable}} (double var, double cap)
\item 
int \mbox{\hyperlink{RHat_8cpp_a0ddf1224851353fc92bfbff6f499fa97}{main}} (int argc, char $\ast$argv\mbox{[}$\,$\mbox{]})
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}}
\item 
int \mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}}
\item 
int \mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{n\+Draw}}
\item 
std\+::vector$<$ TString $>$ \mbox{\hyperlink{RHat_8cpp_a871d6466cea2597401bdb203293f4033}{Branch\+Names}}
\item 
std\+::vector$<$ std\+::string $>$ \mbox{\hyperlink{RHat_8cpp_aa19a5e341d34dce5448ee490dedba8ef}{MCMCFile}}
\item 
std\+::vector$<$ bool $>$ \mbox{\hyperlink{RHat_8cpp_a5217beba3b3cb82269e95bf52c3d62c5}{Valid\+Par}}
\item 
double $\ast$$\ast$$\ast$ \mbox{\hyperlink{RHat_8cpp_a9adc829d645affbb93eff1775ab7c0c6}{Draws}}
\item 
double $\ast$$\ast$ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}}
\item 
double $\ast$$\ast$ \mbox{\hyperlink{RHat_8cpp_a5bdfaf60cce582e30db6bd3001de9935}{Standard\+Deviation}}
\item 
double $\ast$ \mbox{\hyperlink{RHat_8cpp_a4526fa4abfccd1173c87267a0beb6977}{Mean\+Global}}
\item 
double $\ast$ \mbox{\hyperlink{RHat_8cpp_a64de0e32daa60ec4f40e0e741d927334}{Standard\+Deviation\+Global}}
\item 
double $\ast$ \mbox{\hyperlink{RHat_8cpp_a52dcf07f8f740636605516f6c2ab3e40}{Between\+Chain\+Variance}}
\item 
double $\ast$ \mbox{\hyperlink{RHat_8cpp_a68813385f1240d1264e139391b12bf05}{Marginal\+Posterior\+Variance}}
\item 
double $\ast$ \mbox{\hyperlink{RHat_8cpp_ab5cfb5e8741283e8d8252aae184004e4}{RHat}}
\item 
double $\ast$ \mbox{\hyperlink{RHat_8cpp_ae673254e98992bd483de55c6c1d1dcaf}{Effective\+Sample\+Size}}
\item 
double $\ast$$\ast$$\ast$ \mbox{\hyperlink{RHat_8cpp_a7e7fe290fda4362be54b8cf5d56fea51}{Draws\+Folded}}
\item 
double $\ast$ \mbox{\hyperlink{RHat_8cpp_a761fd0b4a970686c00ce3e4daefd7f73}{Median\+Arr}}
\item 
double $\ast$$\ast$ \mbox{\hyperlink{RHat_8cpp_a458eb859b19f20edc7607814bd68d449}{Mean\+Folded}}
\item 
double $\ast$$\ast$ \mbox{\hyperlink{RHat_8cpp_a85509f675b977490fa59bdf037d38ba2}{Standard\+Deviation\+Folded}}
\item 
double $\ast$ \mbox{\hyperlink{RHat_8cpp_a5afb47112913938579beb8b9f385a574}{Mean\+Global\+Folded}}
\item 
double $\ast$ \mbox{\hyperlink{RHat_8cpp_a255f6a2b0ce0d9e0aee2c06645008b0c}{Standard\+Deviation\+Global\+Folded}}
\item 
double $\ast$ \mbox{\hyperlink{RHat_8cpp_a3a65452412d9dd00c1a9e93d0bab1a26}{Between\+Chain\+Variance\+Folded}}
\item 
double $\ast$ \mbox{\hyperlink{RHat_8cpp_af4fae3d323e2f5220b3506386304f8f4}{Marginal\+Posterior\+Variance\+Folded}}
\item 
double $\ast$ \mbox{\hyperlink{RHat_8cpp_a754fbe6088f05d880121693722fe6b99}{RHat\+Folded}}
\item 
double $\ast$ \mbox{\hyperlink{RHat_8cpp_a39a08e7110f564d00239beccded97be8}{Effective\+Sample\+Size\+Folded}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This executable calculates the $ \hat{R} $ estimator for Markov Chain Monte Carlo (MCMC) convergence. 

KS\+: This exe is meant to calculate the $ \hat{R} $ estimator. For a well-\/converged chain, this distribution should be centered at one. The $ \hat{R} $ statistic is used to assess the convergence of MCMC simulations and helps determine whether the chains have reached a stable distribution.

\cite{gelman2019}. 

Definition in file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{RHat_8cpp_ac038d6f2a074799534fc4a986ca36ef3}\label{RHat_8cpp_ac038d6f2a074799534fc4a986ca36ef3}} 
\index{RHat.cpp@{RHat.cpp}!CalcMedian@{CalcMedian}}
\index{CalcMedian@{CalcMedian}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{CalcMedian()}{CalcMedian()}}
{\footnotesize\ttfamily double Calc\+Median (\begin{DoxyParamCaption}\item[{double}]{arr\mbox{[}$\,$\mbox{]},  }\item[{int}]{size }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00815}{815}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00815\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00816\ \textcolor{comment}{//\ *******************\ \ \ }}
\DoxyCodeLine{00817\ \ \ std::sort(arr,\ arr+\mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}});}
\DoxyCodeLine{00818\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}}\ \%\ 2\ !=\ 0)}
\DoxyCodeLine{00819\ \ \ \ \ \textcolor{keywordflow}{return}\ arr[\mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}}/2];}
\DoxyCodeLine{00820\ \ \ \textcolor{keywordflow}{return}\ (arr[(\mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}}-\/1)/2]\ +\ arr[\mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}}/2])/2.0;}
\DoxyCodeLine{00821\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{RHat_8cpp_abd5f8455bf73bda17794dc06218e6713}\label{RHat_8cpp_abd5f8455bf73bda17794dc06218e6713}} 
\index{RHat.cpp@{RHat.cpp}!CalcRhat@{CalcRhat}}
\index{CalcRhat@{CalcRhat}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{CalcRhat()}{CalcRhat()}}
{\footnotesize\ttfamily void Calc\+Rhat (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00431}{431}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00432\ \textcolor{comment}{//\ *******************}}
\DoxyCodeLine{00433\ \ \ \ \ }
\DoxyCodeLine{00434\ \ \ TStopwatch\ clock;}
\DoxyCodeLine{00435\ \ \ clock.Start();}
\DoxyCodeLine{00436\ }
\DoxyCodeLine{00437\ \textcolor{comment}{//KS:\ Start\ parallel\ region}}
\DoxyCodeLine{00438\ \textcolor{comment}{//\ If\ we\ would\ like\ to\ do\ this\ for\ thousands\ of\ chains\ we\ might\ consider\ using\ GPU\ for\ this}}
\DoxyCodeLine{00439\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD }}
\DoxyCodeLine{00440\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel }}
\DoxyCodeLine{00441\ \ \ \{}
\DoxyCodeLine{00442\ \textcolor{preprocessor}{\ \ \#endif }}
\DoxyCodeLine{00443\ \ \ \ \ }
\DoxyCodeLine{00444\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD }}
\DoxyCodeLine{00445\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ for\ collapse(2) }}
\DoxyCodeLine{00446\ \textcolor{preprocessor}{\ \ \ \ \#endif }}
\DoxyCodeLine{00447\ \ \ \ \ \textcolor{comment}{//KS:\ loop\ over\ chains\ and\ draws\ are\ independent\ so\ might\ as\ well\ collapse\ for\ sweet\ cache\ hits}}
\DoxyCodeLine{00448\ \ \ \ \ \textcolor{comment}{//Calculate\ the\ mean\ for\ each\ parameter\ within\ each\ considered\ chain}}
\DoxyCodeLine{00449\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ m\ =\ 0;\ m\ <\ \mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}};\ ++m)}
\DoxyCodeLine{00450\ \ \ \ \ \{}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}};\ ++j)}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}};\ i++)}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}}[m][j]\ +=\ \mbox{\hyperlink{RHat_8cpp_a9adc829d645affbb93eff1775ab7c0c6}{Draws}}[m][i][j];}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a458eb859b19f20edc7607814bd68d449}{MeanFolded}}[m][j]\ +=\ \mbox{\hyperlink{RHat_8cpp_a7e7fe290fda4362be54b8cf5d56fea51}{DrawsFolded}}[m][i][j];}
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}}[m][j]\ =\ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}}[m][j]/\mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}};}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a458eb859b19f20edc7607814bd68d449}{MeanFolded}}[m][j]\ =\ \mbox{\hyperlink{RHat_8cpp_a458eb859b19f20edc7607814bd68d449}{MeanFolded}}[m][j]/\mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}};}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00461\ \ \ \ \ \}}
\DoxyCodeLine{00462\ }
\DoxyCodeLine{00463\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD }}
\DoxyCodeLine{00464\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ for }}
\DoxyCodeLine{00465\ \textcolor{preprocessor}{\ \ \ \ \#endif }}
\DoxyCodeLine{00466\ \ \ \ \ \textcolor{comment}{//Calculate\ the\ mean\ for\ each\ parameter\ global\ means\ we\ include\ information\ from\ several\ chains}}
\DoxyCodeLine{00467\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}};\ ++j)}
\DoxyCodeLine{00468\ \ \ \ \ \{}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ m\ =\ 0;\ m\ <\ \mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}};\ ++m)}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a4526fa4abfccd1173c87267a0beb6977}{MeanGlobal}}[j]\ +=\ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}}[m][j];}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a5afb47112913938579beb8b9f385a574}{MeanGlobalFolded}}[j]\ +=\ \mbox{\hyperlink{RHat_8cpp_a458eb859b19f20edc7607814bd68d449}{MeanFolded}}[m][j];}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00474\ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a4526fa4abfccd1173c87267a0beb6977}{MeanGlobal}}[j]\ =\ \mbox{\hyperlink{RHat_8cpp_a4526fa4abfccd1173c87267a0beb6977}{MeanGlobal}}[j]/\mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}};}
\DoxyCodeLine{00475\ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a5afb47112913938579beb8b9f385a574}{MeanGlobalFolded}}[j]\ =\ \mbox{\hyperlink{RHat_8cpp_a5afb47112913938579beb8b9f385a574}{MeanGlobalFolded}}[j]/\mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}};}
\DoxyCodeLine{00476\ \ \ \ \ \}}
\DoxyCodeLine{00477\ }
\DoxyCodeLine{00478\ }
\DoxyCodeLine{00479\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD }}
\DoxyCodeLine{00480\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ for\ collapse(2) }}
\DoxyCodeLine{00481\ \textcolor{preprocessor}{\ \ \ \ \#endif }}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \textcolor{comment}{//Calculate\ the\ standard\ deviation\ for\ each\ parameter\ within\ each\ considered\ chain}}
\DoxyCodeLine{00483\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ m\ =\ 0;\ m\ <\ \mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}};\ ++m)}
\DoxyCodeLine{00484\ \ \ \ \ \{}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}};\ ++j)}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}};\ i++)}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00489\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a5bdfaf60cce582e30db6bd3001de9935}{StandardDeviation}}[m][j]\ +=\ (\mbox{\hyperlink{RHat_8cpp_a9adc829d645affbb93eff1775ab7c0c6}{Draws}}[m][i][j]\ -\/\ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}}[m][j])*(\mbox{\hyperlink{RHat_8cpp_a9adc829d645affbb93eff1775ab7c0c6}{Draws}}[m][i][j]\ -\/\ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}}[m][j]);}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a85509f675b977490fa59bdf037d38ba2}{StandardDeviationFolded}}[m][j]\ +=\ (\mbox{\hyperlink{RHat_8cpp_a7e7fe290fda4362be54b8cf5d56fea51}{DrawsFolded}}[m][i][j]\ -\/\ \mbox{\hyperlink{RHat_8cpp_a458eb859b19f20edc7607814bd68d449}{MeanFolded}}[m][j])*(\mbox{\hyperlink{RHat_8cpp_a7e7fe290fda4362be54b8cf5d56fea51}{DrawsFolded}}[m][i][j]\ -\/\ \mbox{\hyperlink{RHat_8cpp_a458eb859b19f20edc7607814bd68d449}{MeanFolded}}[m][j]);}
\DoxyCodeLine{00491\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00492\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a5bdfaf60cce582e30db6bd3001de9935}{StandardDeviation}}[m][j]\ =\ \mbox{\hyperlink{RHat_8cpp_a5bdfaf60cce582e30db6bd3001de9935}{StandardDeviation}}[m][j]/(\mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}}-\/1);}
\DoxyCodeLine{00493\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a85509f675b977490fa59bdf037d38ba2}{StandardDeviationFolded}}[m][j]\ =\ \mbox{\hyperlink{RHat_8cpp_a85509f675b977490fa59bdf037d38ba2}{StandardDeviationFolded}}[m][j]/(\mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}}-\/1);}
\DoxyCodeLine{00494\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00495\ \ \ \ \ \}}
\DoxyCodeLine{00496\ }
\DoxyCodeLine{00497\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD }}
\DoxyCodeLine{00498\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ for }}
\DoxyCodeLine{00499\ \textcolor{preprocessor}{\ \ \ \ \#endif }}
\DoxyCodeLine{00500\ \ \ \ \ \textcolor{comment}{//Calculate\ the\ standard\ deviation\ for\ each\ parameter\ combining\ information\ from\ all\ chains}}
\DoxyCodeLine{00501\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}};\ ++j)}
\DoxyCodeLine{00502\ \ \ \ \ \{}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ m\ =\ 0;\ m\ <\ \mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}};\ ++m)}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a64de0e32daa60ec4f40e0e741d927334}{StandardDeviationGlobal}}[j]\ +=\ \mbox{\hyperlink{RHat_8cpp_a5bdfaf60cce582e30db6bd3001de9935}{StandardDeviation}}[m][j];}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a255f6a2b0ce0d9e0aee2c06645008b0c}{StandardDeviationGlobalFolded}}[j]\ +=\ \mbox{\hyperlink{RHat_8cpp_a85509f675b977490fa59bdf037d38ba2}{StandardDeviationFolded}}[m][j];}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a64de0e32daa60ec4f40e0e741d927334}{StandardDeviationGlobal}}[j]\ =\ \mbox{\hyperlink{RHat_8cpp_a64de0e32daa60ec4f40e0e741d927334}{StandardDeviationGlobal}}[j]/\mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}};}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a255f6a2b0ce0d9e0aee2c06645008b0c}{StandardDeviationGlobalFolded}}[j]\ =\ \mbox{\hyperlink{RHat_8cpp_a255f6a2b0ce0d9e0aee2c06645008b0c}{StandardDeviationGlobalFolded}}[j]/\mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}};}
\DoxyCodeLine{00510\ \ \ \ \ \}}
\DoxyCodeLine{00511\ }
\DoxyCodeLine{00512\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD }}
\DoxyCodeLine{00513\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ for }}
\DoxyCodeLine{00514\ \textcolor{preprocessor}{\ \ \ \ \#endif }}
\DoxyCodeLine{00515\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}};\ ++j)}
\DoxyCodeLine{00516\ \ \ \ \ \{}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ This\ term\ only\ makes\ sense\ if\ we\ have\ at\ least\ 2\ chains}}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}}\ ==\ 1)}
\DoxyCodeLine{00519\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00520\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a52dcf07f8f740636605516f6c2ab3e40}{BetweenChainVariance}}[j]\ =\ 0.;}
\DoxyCodeLine{00521\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a3a65452412d9dd00c1a9e93d0bab1a26}{BetweenChainVarianceFolded}}[j]\ =\ 0.;}
\DoxyCodeLine{00522\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00523\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ m\ =\ 0;\ m\ <\ \mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}};\ ++m)}
\DoxyCodeLine{00526\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00527\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a52dcf07f8f740636605516f6c2ab3e40}{BetweenChainVariance}}[j]\ +=\ (\ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}}[m][j]\ -\/\ \mbox{\hyperlink{RHat_8cpp_a4526fa4abfccd1173c87267a0beb6977}{MeanGlobal}}[j])*(\ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}}[m][j]\ -\/\ \mbox{\hyperlink{RHat_8cpp_a4526fa4abfccd1173c87267a0beb6977}{MeanGlobal}}[j]);}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a3a65452412d9dd00c1a9e93d0bab1a26}{BetweenChainVarianceFolded}}[j]\ +=\ (\ \mbox{\hyperlink{RHat_8cpp_a458eb859b19f20edc7607814bd68d449}{MeanFolded}}[m][j]\ -\/\ \mbox{\hyperlink{RHat_8cpp_a5afb47112913938579beb8b9f385a574}{MeanGlobalFolded}}[j])*(\ \mbox{\hyperlink{RHat_8cpp_a458eb859b19f20edc7607814bd68d449}{MeanFolded}}[m][j]\ -\/\ \mbox{\hyperlink{RHat_8cpp_a5afb47112913938579beb8b9f385a574}{MeanGlobalFolded}}[j]);}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00530\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a52dcf07f8f740636605516f6c2ab3e40}{BetweenChainVariance}}[j]\ =\ \mbox{\hyperlink{RHat_8cpp_a52dcf07f8f740636605516f6c2ab3e40}{BetweenChainVariance}}[j]*\mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}}/(\mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}}-\/1);}
\DoxyCodeLine{00531\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a3a65452412d9dd00c1a9e93d0bab1a26}{BetweenChainVarianceFolded}}[j]\ =\ \mbox{\hyperlink{RHat_8cpp_a3a65452412d9dd00c1a9e93d0bab1a26}{BetweenChainVarianceFolded}}[j]*\mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}}/(\mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}}-\/1);}
\DoxyCodeLine{00532\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00533\ \ \ \ \ \}}
\DoxyCodeLine{00534\ }
\DoxyCodeLine{00535\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD }}
\DoxyCodeLine{00536\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ for }}
\DoxyCodeLine{00537\ \textcolor{preprocessor}{\ \ \ \ \#endif }}
\DoxyCodeLine{00538\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}};\ ++j)}
\DoxyCodeLine{00539\ \ \ \ \ \{}
\DoxyCodeLine{00540\ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a68813385f1240d1264e139391b12bf05}{MarginalPosteriorVariance}}[j]\ =\ (\mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}}-\/1)\ *\ \mbox{\hyperlink{RHat_8cpp_a64de0e32daa60ec4f40e0e741d927334}{StandardDeviationGlobal}}[j]\ /(\mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}})\ +\ \mbox{\hyperlink{RHat_8cpp_a52dcf07f8f740636605516f6c2ab3e40}{BetweenChainVariance}}[j]/\mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}};}
\DoxyCodeLine{00541\ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_af4fae3d323e2f5220b3506386304f8f4}{MarginalPosteriorVarianceFolded}}[j]\ =\ (\mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}}-\/1)\ *\ \mbox{\hyperlink{RHat_8cpp_a255f6a2b0ce0d9e0aee2c06645008b0c}{StandardDeviationGlobalFolded}}[j]\ /(\mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}})\ +\ \mbox{\hyperlink{RHat_8cpp_a3a65452412d9dd00c1a9e93d0bab1a26}{BetweenChainVarianceFolded}}[j]/\mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}};}
\DoxyCodeLine{00542\ \ \ \ \ \}}
\DoxyCodeLine{00543\ }
\DoxyCodeLine{00544\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD }}
\DoxyCodeLine{00545\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ for }}
\DoxyCodeLine{00546\ \textcolor{preprocessor}{\ \ \ \ \#endif }}
\DoxyCodeLine{00547\ \ \ \ \ \textcolor{comment}{//Finally\ calculate\ our\ estimator}}
\DoxyCodeLine{00548\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}};\ ++j)}
\DoxyCodeLine{00549\ \ \ \ \ \{}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_ab5cfb5e8741283e8d8252aae184004e4}{RHat}}[j]\ =\ sqrt(\mbox{\hyperlink{RHat_8cpp_a68813385f1240d1264e139391b12bf05}{MarginalPosteriorVariance}}[j]/\mbox{\hyperlink{RHat_8cpp_a64de0e32daa60ec4f40e0e741d927334}{StandardDeviationGlobal}}[j]);}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a754fbe6088f05d880121693722fe6b99}{RHatFolded}}[j]\ =\ sqrt(\mbox{\hyperlink{RHat_8cpp_af4fae3d323e2f5220b3506386304f8f4}{MarginalPosteriorVarianceFolded}}[j]/\mbox{\hyperlink{RHat_8cpp_a255f6a2b0ce0d9e0aee2c06645008b0c}{StandardDeviationGlobalFolded}}[j]);}
\DoxyCodeLine{00552\ }
\DoxyCodeLine{00553\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ For\ flat\ params\ values\ can\ be\ crazy\ so\ cap\ at\ 0}}
\DoxyCodeLine{00554\ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a29838c9a1c93843ffd2eb4dc33f2076d}{CapVariable}}(\mbox{\hyperlink{RHat_8cpp_ab5cfb5e8741283e8d8252aae184004e4}{RHat}}[j],\ 0);}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a29838c9a1c93843ffd2eb4dc33f2076d}{CapVariable}}(\mbox{\hyperlink{RHat_8cpp_a754fbe6088f05d880121693722fe6b99}{RHatFolded}}[j],\ 0);}
\DoxyCodeLine{00556\ \ \ \ \ \}}
\DoxyCodeLine{00557\ }
\DoxyCodeLine{00558\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD }}
\DoxyCodeLine{00559\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ for }}
\DoxyCodeLine{00560\ \textcolor{preprocessor}{\ \ \ \ \#endif }}
\DoxyCodeLine{00561\ \ \ \ \ \textcolor{comment}{//KS:\ Additionally\ calculates\ effective\ step\ size\ which\ is\ an\ estimate\ of\ the\ sample\ size\ required\ to\ achieve\ the\ same\ level\ of\ precision\ if\ that\ sample\ was\ a\ simple\ random\ sample.}}
\DoxyCodeLine{00562\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}};\ ++j)}
\DoxyCodeLine{00563\ \ \ \ \ \{}
\DoxyCodeLine{00564\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}}\ >\ 1)\ \mbox{\hyperlink{RHat_8cpp_ae673254e98992bd483de55c6c1d1dcaf}{EffectiveSampleSize}}[j]\ =\ \mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}}\ *\ \mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}}\ *\ \mbox{\hyperlink{RHat_8cpp_a68813385f1240d1264e139391b12bf05}{MarginalPosteriorVariance}}[j]\ /\ \mbox{\hyperlink{RHat_8cpp_a52dcf07f8f740636605516f6c2ab3e40}{BetweenChainVariance}}[j];}
\DoxyCodeLine{00565\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}}\ >\ 1)\ \mbox{\hyperlink{RHat_8cpp_a39a08e7110f564d00239beccded97be8}{EffectiveSampleSizeFolded}}[j]\ =\ \mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}}\ *\ \mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}}\ *\ \mbox{\hyperlink{RHat_8cpp_af4fae3d323e2f5220b3506386304f8f4}{MarginalPosteriorVarianceFolded}}[j]\ /\ \mbox{\hyperlink{RHat_8cpp_a3a65452412d9dd00c1a9e93d0bab1a26}{BetweenChainVarianceFolded}}[j];}
\DoxyCodeLine{00566\ }
\DoxyCodeLine{00567\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ For\ flat\ params\ values\ can\ be\ crazy\ so\ cap\ at\ 0}}
\DoxyCodeLine{00568\ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a29838c9a1c93843ffd2eb4dc33f2076d}{CapVariable}}(\mbox{\hyperlink{RHat_8cpp_ae673254e98992bd483de55c6c1d1dcaf}{EffectiveSampleSize}}[j],\ 0);}
\DoxyCodeLine{00569\ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a29838c9a1c93843ffd2eb4dc33f2076d}{CapVariable}}(\mbox{\hyperlink{RHat_8cpp_a39a08e7110f564d00239beccded97be8}{EffectiveSampleSizeFolded}}[j],\ 0);}
\DoxyCodeLine{00570\ \ \ \ \ \}}
\DoxyCodeLine{00571\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD }}
\DoxyCodeLine{00572\ \ \ \}\ \textcolor{comment}{//End\ parallel\ region}}
\DoxyCodeLine{00573\ \textcolor{preprocessor}{\ \ \#endif }}
\DoxyCodeLine{00574\ }
\DoxyCodeLine{00575\ \ \ clock.Stop();}
\DoxyCodeLine{00576\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Finished\ calculating\ RHat,\ it\ took\ \{:.2f\}s\ to\ finish"{}},\ clock.RealTime());}
\DoxyCodeLine{00577\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{RHat_8cpp_a29838c9a1c93843ffd2eb4dc33f2076d}\label{RHat_8cpp_a29838c9a1c93843ffd2eb4dc33f2076d}} 
\index{RHat.cpp@{RHat.cpp}!CapVariable@{CapVariable}}
\index{CapVariable@{CapVariable}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{CapVariable()}{CapVariable()}}
{\footnotesize\ttfamily void Cap\+Variable (\begin{DoxyParamCaption}\item[{double}]{var,  }\item[{double}]{cap }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00826}{826}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00826\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00827\ \textcolor{comment}{//\ *******************\ \ \ }}
\DoxyCodeLine{00828\ }
\DoxyCodeLine{00829\ \ \ \textcolor{keywordflow}{if}(std::isnan(var)\ ||\ !std::isfinite(var))\ var\ =\ cap;}
\DoxyCodeLine{00830\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{RHat_8cpp_abb60917440a91d5a3507fd4059d3e23b}\label{RHat_8cpp_abb60917440a91d5a3507fd4059d3e23b}} 
\index{RHat.cpp@{RHat.cpp}!DestroyArrays@{DestroyArrays}}
\index{DestroyArrays@{DestroyArrays}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{DestroyArrays()}{DestroyArrays()}}
{\footnotesize\ttfamily void Destroy\+Arrays (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00770}{770}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00770\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00771\ \textcolor{comment}{//\ *******************}}
\DoxyCodeLine{00772\ \ \ \ \ }
\DoxyCodeLine{00773\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Killing\ all\ arrays"{}});}
\DoxyCodeLine{00774\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_a4526fa4abfccd1173c87267a0beb6977}{MeanGlobal}};}
\DoxyCodeLine{00775\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_a64de0e32daa60ec4f40e0e741d927334}{StandardDeviationGlobal}};}
\DoxyCodeLine{00776\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_a52dcf07f8f740636605516f6c2ab3e40}{BetweenChainVariance}};}
\DoxyCodeLine{00777\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_a68813385f1240d1264e139391b12bf05}{MarginalPosteriorVariance}};}
\DoxyCodeLine{00778\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_ab5cfb5e8741283e8d8252aae184004e4}{RHat}};}
\DoxyCodeLine{00779\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_ae673254e98992bd483de55c6c1d1dcaf}{EffectiveSampleSize}};}
\DoxyCodeLine{00780\ }
\DoxyCodeLine{00781\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_a5afb47112913938579beb8b9f385a574}{MeanGlobalFolded}};}
\DoxyCodeLine{00782\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_a255f6a2b0ce0d9e0aee2c06645008b0c}{StandardDeviationGlobalFolded}};}
\DoxyCodeLine{00783\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_a3a65452412d9dd00c1a9e93d0bab1a26}{BetweenChainVarianceFolded}};}
\DoxyCodeLine{00784\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_af4fae3d323e2f5220b3506386304f8f4}{MarginalPosteriorVarianceFolded}};}
\DoxyCodeLine{00785\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_a754fbe6088f05d880121693722fe6b99}{RHatFolded}};}
\DoxyCodeLine{00786\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_a39a08e7110f564d00239beccded97be8}{EffectiveSampleSizeFolded}};}
\DoxyCodeLine{00787\ }
\DoxyCodeLine{00788\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ m\ =\ 0;\ m\ <\ \mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}};\ m++)}
\DoxyCodeLine{00789\ \ \ \{}
\DoxyCodeLine{00790\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}};\ i++)}
\DoxyCodeLine{00791\ \ \ \ \ \{}
\DoxyCodeLine{00792\ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_a9adc829d645affbb93eff1775ab7c0c6}{Draws}}[m][i];}
\DoxyCodeLine{00793\ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_a7e7fe290fda4362be54b8cf5d56fea51}{DrawsFolded}}[m][i];}
\DoxyCodeLine{00794\ \ \ \ \ \}}
\DoxyCodeLine{00795\ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_a9adc829d645affbb93eff1775ab7c0c6}{Draws}}[m];}
\DoxyCodeLine{00796\ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}}[m];}
\DoxyCodeLine{00797\ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_a5bdfaf60cce582e30db6bd3001de9935}{StandardDeviation}}[m];}
\DoxyCodeLine{00798\ }
\DoxyCodeLine{00799\ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_a7e7fe290fda4362be54b8cf5d56fea51}{DrawsFolded}}[m];}
\DoxyCodeLine{00800\ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_a458eb859b19f20edc7607814bd68d449}{MeanFolded}}[m];}
\DoxyCodeLine{00801\ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_a85509f675b977490fa59bdf037d38ba2}{StandardDeviationFolded}}[m];}
\DoxyCodeLine{00802\ \ \ \}}
\DoxyCodeLine{00803\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_a9adc829d645affbb93eff1775ab7c0c6}{Draws}};}
\DoxyCodeLine{00804\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}};}
\DoxyCodeLine{00805\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_a5bdfaf60cce582e30db6bd3001de9935}{StandardDeviation}};}
\DoxyCodeLine{00806\ }
\DoxyCodeLine{00807\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_a7e7fe290fda4362be54b8cf5d56fea51}{DrawsFolded}};}
\DoxyCodeLine{00808\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_a761fd0b4a970686c00ce3e4daefd7f73}{MedianArr}};}
\DoxyCodeLine{00809\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_a458eb859b19f20edc7607814bd68d449}{MeanFolded}};}
\DoxyCodeLine{00810\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{RHat_8cpp_a85509f675b977490fa59bdf037d38ba2}{StandardDeviationFolded}};}
\DoxyCodeLine{00811\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{RHat_8cpp_a3efe8085dcbead1e66a6cf54fc77ab5e}\label{RHat_8cpp_a3efe8085dcbead1e66a6cf54fc77ab5e}} 
\index{RHat.cpp@{RHat.cpp}!InitialiseArrays@{InitialiseArrays}}
\index{InitialiseArrays@{InitialiseArrays}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{InitialiseArrays()}{InitialiseArrays()}}
{\footnotesize\ttfamily void Initialise\+Arrays (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00361}{361}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00362\ \textcolor{comment}{//\ *******************}}
\DoxyCodeLine{00363\ }
\DoxyCodeLine{00364\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Initialising\ arrays"{}});}
\DoxyCodeLine{00365\ \ \ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}}]();}
\DoxyCodeLine{00366\ \ \ \mbox{\hyperlink{RHat_8cpp_a5bdfaf60cce582e30db6bd3001de9935}{StandardDeviation}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}}]();}
\DoxyCodeLine{00367\ }
\DoxyCodeLine{00368\ \ \ \mbox{\hyperlink{RHat_8cpp_a4526fa4abfccd1173c87267a0beb6977}{MeanGlobal}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}}]();}
\DoxyCodeLine{00369\ \ \ \mbox{\hyperlink{RHat_8cpp_a64de0e32daa60ec4f40e0e741d927334}{StandardDeviationGlobal}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}}]();}
\DoxyCodeLine{00370\ \ \ \mbox{\hyperlink{RHat_8cpp_a52dcf07f8f740636605516f6c2ab3e40}{BetweenChainVariance}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}}]();}
\DoxyCodeLine{00371\ }
\DoxyCodeLine{00372\ \ \ \mbox{\hyperlink{RHat_8cpp_a68813385f1240d1264e139391b12bf05}{MarginalPosteriorVariance}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}}]();}
\DoxyCodeLine{00373\ \ \ \mbox{\hyperlink{RHat_8cpp_ab5cfb5e8741283e8d8252aae184004e4}{RHat}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}}]();}
\DoxyCodeLine{00374\ \ \ \mbox{\hyperlink{RHat_8cpp_ae673254e98992bd483de55c6c1d1dcaf}{EffectiveSampleSize}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}}]();}
\DoxyCodeLine{00375\ }
\DoxyCodeLine{00376\ \ \ \mbox{\hyperlink{RHat_8cpp_a458eb859b19f20edc7607814bd68d449}{MeanFolded}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}}]();}
\DoxyCodeLine{00377\ \ \ \mbox{\hyperlink{RHat_8cpp_a85509f675b977490fa59bdf037d38ba2}{StandardDeviationFolded}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}}]();}
\DoxyCodeLine{00378\ }
\DoxyCodeLine{00379\ \ \ \mbox{\hyperlink{RHat_8cpp_a5afb47112913938579beb8b9f385a574}{MeanGlobalFolded}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}}]();}
\DoxyCodeLine{00380\ \ \ \mbox{\hyperlink{RHat_8cpp_a255f6a2b0ce0d9e0aee2c06645008b0c}{StandardDeviationGlobalFolded}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}}]();}
\DoxyCodeLine{00381\ \ \ \mbox{\hyperlink{RHat_8cpp_a3a65452412d9dd00c1a9e93d0bab1a26}{BetweenChainVarianceFolded}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}}]();}
\DoxyCodeLine{00382\ }
\DoxyCodeLine{00383\ \ \ \mbox{\hyperlink{RHat_8cpp_af4fae3d323e2f5220b3506386304f8f4}{MarginalPosteriorVarianceFolded}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}}]();}
\DoxyCodeLine{00384\ \ \ \mbox{\hyperlink{RHat_8cpp_a754fbe6088f05d880121693722fe6b99}{RHatFolded}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}}]();}
\DoxyCodeLine{00385\ \ \ \mbox{\hyperlink{RHat_8cpp_a39a08e7110f564d00239beccded97be8}{EffectiveSampleSizeFolded}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}}]();}
\DoxyCodeLine{00386\ }
\DoxyCodeLine{00387\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ m\ =\ 0;\ m\ <\ \mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}};\ ++m)}
\DoxyCodeLine{00388\ \ \ \{}
\DoxyCodeLine{00389\ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}}[m]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}}]();}
\DoxyCodeLine{00390\ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a5bdfaf60cce582e30db6bd3001de9935}{StandardDeviation}}[m]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}}]();}
\DoxyCodeLine{00391\ }
\DoxyCodeLine{00392\ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a458eb859b19f20edc7607814bd68d449}{MeanFolded}}[m]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}}]();}
\DoxyCodeLine{00393\ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a85509f675b977490fa59bdf037d38ba2}{StandardDeviationFolded}}[m]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}}]();}
\DoxyCodeLine{00394\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}};\ ++j)}
\DoxyCodeLine{00395\ \ \ \ \ \{}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}}[m][j]\ =\ 0.;}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a5bdfaf60cce582e30db6bd3001de9935}{StandardDeviation}}[m][j]\ =\ 0.;}
\DoxyCodeLine{00398\ }
\DoxyCodeLine{00399\ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a458eb859b19f20edc7607814bd68d449}{MeanFolded}}[m][j]\ =\ 0.;}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a85509f675b977490fa59bdf037d38ba2}{StandardDeviationFolded}}[m][j]\ =\ 0.;}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(m\ ==\ 0)}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a4526fa4abfccd1173c87267a0beb6977}{MeanGlobal}}[j]\ =\ 0.;}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a64de0e32daa60ec4f40e0e741d927334}{StandardDeviationGlobal}}[j]\ =\ 0.;}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a52dcf07f8f740636605516f6c2ab3e40}{BetweenChainVariance}}[j]\ =\ 0.;}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a68813385f1240d1264e139391b12bf05}{MarginalPosteriorVariance}}[j]\ =\ 0.;}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_ab5cfb5e8741283e8d8252aae184004e4}{RHat}}[j]\ =\ 0.;}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_ae673254e98992bd483de55c6c1d1dcaf}{EffectiveSampleSize}}[j]\ =\ 0.;}
\DoxyCodeLine{00409\ }
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a5afb47112913938579beb8b9f385a574}{MeanGlobalFolded}}[j]\ =\ 0.;}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a255f6a2b0ce0d9e0aee2c06645008b0c}{StandardDeviationGlobalFolded}}[j]\ =\ 0.;}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a3a65452412d9dd00c1a9e93d0bab1a26}{BetweenChainVarianceFolded}}[j]\ =\ 0.;}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_af4fae3d323e2f5220b3506386304f8f4}{MarginalPosteriorVarianceFolded}}[j]\ =\ 0.;}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a754fbe6088f05d880121693722fe6b99}{RHatFolded}}[j]\ =\ 0.;}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a39a08e7110f564d00239beccded97be8}{EffectiveSampleSizeFolded}}[j]\ =\ 0.;}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00417\ \ \ \ \ \}}
\DoxyCodeLine{00418\ \ \ \}}
\DoxyCodeLine{00419\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{RHat_8cpp_a0ddf1224851353fc92bfbff6f499fa97}\label{RHat_8cpp_a0ddf1224851353fc92bfbff6f499fa97}} 
\index{RHat.cpp@{RHat.cpp}!main@{main}}
\index{main@{main}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}\item[{int}]{argc,  }\item[{char $\ast$}]{argv\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00083}{83}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00084\ \textcolor{comment}{//\ *******************\ \ \ \ }}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_aa603c55ea73cd86d1994901227883e1e}{SetMaCh3LoggerFormat}}();}
\DoxyCodeLine{00087\ \ \ \mbox{\hyperlink{namespaceMaCh3Utils_ac6f4a3b6a7749967ff9a011469352f6c}{MaCh3Utils::MaCh3Welcome}}();}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \ \ \mbox{\hyperlink{RHat_8cpp_a9adc829d645affbb93eff1775ab7c0c6}{Draws}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00090\ \ \ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00091\ \ \ \mbox{\hyperlink{RHat_8cpp_a5bdfaf60cce582e30db6bd3001de9935}{StandardDeviation}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \mbox{\hyperlink{RHat_8cpp_a4526fa4abfccd1173c87267a0beb6977}{MeanGlobal}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00094\ \ \ \mbox{\hyperlink{RHat_8cpp_a64de0e32daa60ec4f40e0e741d927334}{StandardDeviationGlobal}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \ \ \mbox{\hyperlink{RHat_8cpp_a52dcf07f8f740636605516f6c2ab3e40}{BetweenChainVariance}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00097\ \ \ \mbox{\hyperlink{RHat_8cpp_a68813385f1240d1264e139391b12bf05}{MarginalPosteriorVariance}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00098\ \ \ \mbox{\hyperlink{RHat_8cpp_ab5cfb5e8741283e8d8252aae184004e4}{RHat}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00099\ \ \ \mbox{\hyperlink{RHat_8cpp_ae673254e98992bd483de55c6c1d1dcaf}{EffectiveSampleSize}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ \mbox{\hyperlink{RHat_8cpp_a7e7fe290fda4362be54b8cf5d56fea51}{DrawsFolded}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00102\ \ \ \mbox{\hyperlink{RHat_8cpp_a761fd0b4a970686c00ce3e4daefd7f73}{MedianArr}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00103\ \ \ \mbox{\hyperlink{RHat_8cpp_a458eb859b19f20edc7607814bd68d449}{MeanFolded}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00104\ \ \ \mbox{\hyperlink{RHat_8cpp_a85509f675b977490fa59bdf037d38ba2}{StandardDeviationFolded}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \ \ \mbox{\hyperlink{RHat_8cpp_a5afb47112913938579beb8b9f385a574}{MeanGlobalFolded}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00107\ \ \ \mbox{\hyperlink{RHat_8cpp_a255f6a2b0ce0d9e0aee2c06645008b0c}{StandardDeviationGlobalFolded}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ \ \ \mbox{\hyperlink{RHat_8cpp_a3a65452412d9dd00c1a9e93d0bab1a26}{BetweenChainVarianceFolded}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00110\ \ \ \mbox{\hyperlink{RHat_8cpp_af4fae3d323e2f5220b3506386304f8f4}{MarginalPosteriorVarianceFolded}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00111\ \ \ \mbox{\hyperlink{RHat_8cpp_a754fbe6088f05d880121693722fe6b99}{RHatFolded}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00112\ \ \ \mbox{\hyperlink{RHat_8cpp_a39a08e7110f564d00239beccded97be8}{EffectiveSampleSizeFolded}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \ \ \mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}}\ =\ 0;}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \ \ \textcolor{keywordflow}{if}\ (argc\ ==\ 1\ ||\ argc\ ==\ 2)}
\DoxyCodeLine{00117\ \ \ \{}
\DoxyCodeLine{00118\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Wrong\ arguments"{}});}
\DoxyCodeLine{00119\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}./RHat\ Ntoys\ MCMCchain\_1.root\ MCMCchain\_2.root\ MCMCchain\_3.root\ ...\ [how\ many\ you\ like]"{}});}
\DoxyCodeLine{00120\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00121\ \ \ \}}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \ \ \mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}}\ =\ atoi(argv[1]);}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \textcolor{comment}{//KS\ Gelman\ suggests\ to\ diagnose\ on\ more\ than\ one\ chain}}
\DoxyCodeLine{00126\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 2;\ i\ <\ argc;\ i++)}
\DoxyCodeLine{00127\ \ \ \{}
\DoxyCodeLine{00128\ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_aa19a5e341d34dce5448ee490dedba8ef}{MCMCFile}}.push\_back(std::string(argv[i]));}
\DoxyCodeLine{00129\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Adding\ file:\ \{\}"{}},\ \mbox{\hyperlink{RHat_8cpp_aa19a5e341d34dce5448ee490dedba8ef}{MCMCFile}}.back());}
\DoxyCodeLine{00130\ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}}++;}
\DoxyCodeLine{00131\ \ \ \}}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}}\ <\ 1)}
\DoxyCodeLine{00134\ \ \ \{}
\DoxyCodeLine{00135\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}You\ specified\ \{\}\ specify\ larger\ greater\ than\ 0"{}},\ \mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}});}
\DoxyCodeLine{00136\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00137\ \ \ \}}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}}\ ==\ 1)}
\DoxyCodeLine{00140\ \ \ \{}
\DoxyCodeLine{00141\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Gelman\ is\ going\ to\ be\ sad\ :(.\ He\ suggested\ you\ should\ use\ more\ than\ one\ chain\ (at\ least\ 4).\ Code\ works\ fine\ for\ one\ chain,\ however,\ estimator\ might\ be\ biased."{}});}
\DoxyCodeLine{00142\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Multiple\ chains\ are\ more\ likely\ to\ reveal\ multimodality\ and\ poor\ adaptation\ or\ mixing:"{}});}
\DoxyCodeLine{00143\ \ \ \}}
\DoxyCodeLine{00144\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Diagnosing\ \{\}\ chains,\ with\ \{\}\ toys"{}},\ \mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}},\ \mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}});}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \ \ \mbox{\hyperlink{RHat_8cpp_af40d823e599ba2565e989e4f43c78628}{PrepareChains}}();}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00148\ \ \ \mbox{\hyperlink{RHat_8cpp_a3efe8085dcbead1e66a6cf54fc77ab5e}{InitialiseArrays}}();}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \ \ \textcolor{comment}{//KS:\ Main\ function}}
\DoxyCodeLine{00151\ \ \ \mbox{\hyperlink{RHat_8cpp_a4c5629fb030eb27c32cab42a42c6623b}{RunDiagnostic}}();}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \ \ \mbox{\hyperlink{RHat_8cpp_a194d97ca48b57a07a9df018a65f3166e}{SaveResults}}();}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \ \ \mbox{\hyperlink{RHat_8cpp_abb60917440a91d5a3507fd4059d3e23b}{DestroyArrays}}();}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00157\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00158\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{RHat_8cpp_af40d823e599ba2565e989e4f43c78628}\label{RHat_8cpp_af40d823e599ba2565e989e4f43c78628}} 
\index{RHat.cpp@{RHat.cpp}!PrepareChains@{PrepareChains}}
\index{PrepareChains@{PrepareChains}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{PrepareChains()}{PrepareChains()}}
{\footnotesize\ttfamily void Prepare\+Chains (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00162}{162}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00163\ \textcolor{comment}{//\ *******************}}
\DoxyCodeLine{00164\ \ \ \textcolor{keyword}{auto}\ rnd\ =\ std::make\_unique<TRandom3>(0);}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Generating\ \{\}"{}},\ \mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}});}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00168\ \ \ TStopwatch\ clock;}
\DoxyCodeLine{00169\ \ \ clock.Start();}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00171\ \ \ std::vector<int>\ BurnIn(\mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}});}
\DoxyCodeLine{00172\ \ \ std::vector<int>\ nEntries(\mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}});}
\DoxyCodeLine{00173\ \ \ std::vector<int>\ nBranches(\mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}});}
\DoxyCodeLine{00174\ \ \ std::vector<int>\ step(\mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}});}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \ \ \mbox{\hyperlink{RHat_8cpp_a9adc829d645affbb93eff1775ab7c0c6}{Draws}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}**[\mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}}]();}
\DoxyCodeLine{00177\ \ \ \mbox{\hyperlink{RHat_8cpp_a7e7fe290fda4362be54b8cf5d56fea51}{DrawsFolded}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}**[\mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}}]();}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \ \ \textcolor{comment}{//\ KS:\ This\ can\ reduce\ time\ necessary\ for\ caching\ even\ by\ half}}
\DoxyCodeLine{00180\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD }}
\DoxyCodeLine{00181\ \ \ \textcolor{comment}{//ROOT::EnableImplicitMT();}}
\DoxyCodeLine{00182\ \textcolor{preprocessor}{\ \ \#endif }}
\DoxyCodeLine{00183\ }
\DoxyCodeLine{00184\ \ \ \textcolor{comment}{//\ Open\ the\ Chain}}
\DoxyCodeLine{00185\ \ \ \textcolor{comment}{//It\ is\ tempting\ to\ multithread\ here\ but\ unfortunately,\ ROOT\ files\ are\ not\ thread\ safe\ :(}}
\DoxyCodeLine{00186\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ m\ =\ 0;\ m\ <\ \mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}};\ m++)}
\DoxyCodeLine{00187\ \ \ \{}
\DoxyCodeLine{00188\ \ \ \ \ TChain*\ Chain\ =\ \textcolor{keyword}{new}\ TChain(\textcolor{stringliteral}{"{}posteriors"{}});}
\DoxyCodeLine{00189\ \ \ \ \ Chain-\/>Add(\mbox{\hyperlink{RHat_8cpp_aa19a5e341d34dce5448ee490dedba8ef}{MCMCFile}}[m].c\_str());}
\DoxyCodeLine{00190\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}On\ file:\ \{\}"{}},\ \mbox{\hyperlink{RHat_8cpp_aa19a5e341d34dce5448ee490dedba8ef}{MCMCFile}}[m].c\_str());}
\DoxyCodeLine{00191\ \ \ \ \ nEntries[m]\ =\ int(Chain-\/>GetEntries());}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \ \ \ \ \textcolor{comment}{//\ Set\ the\ step\ cut\ to\ be\ 20\%}}
\DoxyCodeLine{00194\ \ \ \ \ BurnIn[m]\ =\ nEntries[m]/5;}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00196\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ list\ of\ branches}}
\DoxyCodeLine{00197\ \ \ \ \ TObjArray*\ brlis\ =\ Chain-\/>GetListOfBranches();}
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00199\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ number\ of\ branches}}
\DoxyCodeLine{00200\ \ \ \ \ nBranches[m]\ =\ brlis-\/>GetEntries();}
\DoxyCodeLine{00201\ }
\DoxyCodeLine{00202\ \ \ \ \ \textcolor{keywordflow}{if}(m\ ==\ 0)\ \mbox{\hyperlink{RHat_8cpp_a871d6466cea2597401bdb203293f4033}{BranchNames}}.reserve(nBranches[m]);}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ \ \ \ \ \textcolor{comment}{//\ Set\ all\ the\ branches\ to\ off}}
\DoxyCodeLine{00205\ \ \ \ \ Chain-\/>SetBranchStatus(\textcolor{stringliteral}{"{}*"{}},\ \textcolor{keyword}{false});}
\DoxyCodeLine{00206\ }
\DoxyCodeLine{00207\ \ \ \ \ \textcolor{comment}{//\ Loop\ over\ the\ number\ of\ branches}}
\DoxyCodeLine{00208\ \ \ \ \ \textcolor{comment}{//\ Find\ the\ name\ and\ how\ many\ of\ each\ systematic\ we\ have}}
\DoxyCodeLine{00209\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ nBranches[m];\ i++)}
\DoxyCodeLine{00210\ \ \ \ \ \{}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ TBranch\ and\ its\ name}}
\DoxyCodeLine{00212\ \ \ \ \ \ \ TBranch*\ br\ =\ \textcolor{keyword}{static\_cast<}TBranch\ *\textcolor{keyword}{>}(brlis-\/>At(i));}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!br)\{}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Invalid\ branch\ at\ position\ \{\}"{}},\ i);}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_,\_\_LINE\_\_);}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00217\ \ \ \ \ \ \ TString\ bname\ =\ br-\/>GetName();}
\DoxyCodeLine{00218\ }
\DoxyCodeLine{00219\ \ \ \ \ \ \ \textcolor{comment}{//\ Read\ in\ the\ step}}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (bname\ ==\ \textcolor{stringliteral}{"{}step"{}})\ \{}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ Chain-\/>SetBranchStatus(bname,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ Chain-\/>SetBranchAddress(bname,\ \&step[m]);}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \textcolor{comment}{//Count\ all\ branches}}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (bname.BeginsWith(\textcolor{stringliteral}{"{}PCA\_"{}})\ ||\ bname.BeginsWith(\textcolor{stringliteral}{"{}accProb"{}})\ ||\ bname.BeginsWith(\textcolor{stringliteral}{"{}stepTime"{}})\ )}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Save\ branch\ name\ only\ for\ one\ chain,\ we\ assume\ all\ chains\ have\ the\ same\ branches,\ otherwise\ this\ doesn't\ make\ sense\ either\ way}}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(m\ ==\ 0)}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a871d6466cea2597401bdb203293f4033}{BranchNames}}.push\_back(bname);}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ We\ calculate\ R\ Hat\ also\ for\ LogL,\ just\ in\ case,\ however\ we\ plot\ them\ separately}}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(bname.BeginsWith(\textcolor{stringliteral}{"{}LogL"{}}))}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a5217beba3b3cb82269e95bf52c3d62c5}{ValidPar}}.push\_back(\textcolor{keyword}{false});}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a5217beba3b3cb82269e95bf52c3d62c5}{ValidPar}}.push\_back(\textcolor{keyword}{true});}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ Chain-\/>SetBranchStatus(bname,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a4db4657acad5c79ac4bbb66a9d1c5905}{MACH3LOG\_DEBUG}}(\textcolor{stringliteral}{"{}\{\}"{}},\ bname);}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00248\ \ \ \ \ \}}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00250\ \ \ \ \ \textcolor{keywordflow}{if}(m\ ==\ 0)\ \mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}}\ =\ int(\mbox{\hyperlink{RHat_8cpp_a871d6466cea2597401bdb203293f4033}{BranchNames}}.size());}
\DoxyCodeLine{00251\ }
\DoxyCodeLine{00252\ \ \ \ \ \textcolor{comment}{//TN:\ Qualitatively\ faster\ sanity\ check,\ with\ the\ very\ same\ outcome\ (all\ chains\ have\ the\ same\ \#branches)}}
\DoxyCodeLine{00253\ \ \ \ \ \textcolor{keywordflow}{if}(m\ >\ 0)}
\DoxyCodeLine{00254\ \ \ \ \ \{}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(nBranches[m]\ !=\ nBranches[0])}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Ups,\ something\ went\ wrong,\ chain\ \{\}\ called\ \{\}\ has\ \{\}\ branches,\ while\ 0\ called\ \{\}\ has\ \{\}\ branches"{}},\ m,\ \mbox{\hyperlink{RHat_8cpp_aa19a5e341d34dce5448ee490dedba8ef}{MCMCFile}}[m],\ nBranches[m],\ \mbox{\hyperlink{RHat_8cpp_aa19a5e341d34dce5448ee490dedba8ef}{MCMCFile}}[0],\ nBranches[0]);}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}All\ chains\ should\ have\ the\ same\ number\ of\ branches"{}});}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00261\ \ \ \ \ \}}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00263\ \ \ \ \ \textcolor{comment}{//TN:\ move\ the\ Draws\ here,\ so\ we\ need\ to\ iterate\ over\ every\ chain\ only\ once}}
\DoxyCodeLine{00264\ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a9adc829d645affbb93eff1775ab7c0c6}{Draws}}[m]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}}]();}
\DoxyCodeLine{00265\ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a7e7fe290fda4362be54b8cf5d56fea51}{DrawsFolded}}[m]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}}]();}
\DoxyCodeLine{00266\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}};\ i++)}
\DoxyCodeLine{00267\ \ \ \ \ \{}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a9adc829d645affbb93eff1775ab7c0c6}{Draws}}[m][i]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}}]();}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a7e7fe290fda4362be54b8cf5d56fea51}{DrawsFolded}}[m][i]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}}]();}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}};\ j++)}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a9adc829d645affbb93eff1775ab7c0c6}{Draws}}[m][i][j]\ =\ 0.;}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a7e7fe290fda4362be54b8cf5d56fea51}{DrawsFolded}}[m][i][j]\ =\ 0.;}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00275\ \ \ \ \ \}}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00277\ \ \ \ \ \textcolor{comment}{//TN:\ move\ looping\ over\ toys\ here,\ so\ we\ don't\ need\ to\ loop\ over\ chains\ more\ than\ once}}
\DoxyCodeLine{00278\ \ \ \ \ \textcolor{keywordflow}{if}(BurnIn[m]\ >=\ nEntries[m])}
\DoxyCodeLine{00279\ \ \ \ \ \{}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}You\ are\ running\ on\ a\ chain\ shorter\ than\ BurnIn\ cut"{}});}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Number\ of\ entries\ \{\}\ BurnIn\ cut\ \{\}"{}},\ nEntries[m],\ BurnIn[m]);}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}You\ will\ run\ into\ the\ infinite\ loop"{}});}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}You\ can\ make\ a\ new\ chain\ or\ modify\ BurnIn\ cut"{}});}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00285\ \ \ \ \ \}}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00287\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}};\ i++)}
\DoxyCodeLine{00288\ \ \ \ \ \{}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ a\ random\ entry\ after\ burn\ in}}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ entry\ =\ int(nEntries[m]*rnd-\/>Rndm());}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00292\ \ \ \ \ \ \ Chain-\/>GetEntry(entry);}
\DoxyCodeLine{00293\ }
\DoxyCodeLine{00294\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ we\ have\ combined\ chains\ by\ hadd\ need\ to\ check\ the\ step\ in\ the\ chain}}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \textcolor{comment}{//\ Note,\ entry\ is\ not\ necessarily\ the\ same\ as\ the\ step\ due\ to\ merged\ ROOT\ files,\ so\ can't\ choose\ an\ entry\ in\ the\ range\ BurnIn\ -\/\ nEntries\ :(}}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (step[m]\ <\ BurnIn[m])}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ i-\/-\/;}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00302\ \ \ \ \ \ \ \textcolor{comment}{//\ Output\ some\ info\ for\ the\ user}}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}}\ >\ 10\ \&\&\ i\ \%\ (\mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}}/10)\ ==\ 0)\ \{}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceMaCh3Utils_a4c8bdeb1d34606aed192e9f1311a72f5}{MaCh3Utils::PrintProgressBar}}(i+m*\mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}},\ \mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}}*\mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}});}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a4db4657acad5c79ac4bbb66a9d1c5905}{MACH3LOG\_DEBUG}}(\textcolor{stringliteral}{"{}Getting\ random\ entry\ \{\}"{}},\ entry);}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00307\ }
\DoxyCodeLine{00308\ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ the\ branch\ addresses\ for\ params}}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}};\ ++j)}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ Chain-\/>SetBranchAddress(\mbox{\hyperlink{RHat_8cpp_a871d6466cea2597401bdb203293f4033}{BranchNames}}[j].Data(),\ \&\mbox{\hyperlink{RHat_8cpp_a9adc829d645affbb93eff1775ab7c0c6}{Draws}}[m][i][j]);}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00313\ \ \ \ \ \ \ Chain-\/>GetEntry(entry);}
\DoxyCodeLine{00314\ }
\DoxyCodeLine{00315\ \ \ \ \ \}\textcolor{comment}{//end\ loop\ over\ toys}}
\DoxyCodeLine{00316\ }
\DoxyCodeLine{00317\ \ \ \ \ \textcolor{comment}{//TN:\ There,\ we\ now\ don't\ need\ to\ keep\ the\ chain\ in\ memory\ anymore}}
\DoxyCodeLine{00318\ \ \ \ \ \textcolor{keyword}{delete}\ Chain;}
\DoxyCodeLine{00319\ \ \ \}}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ \ \ \textcolor{comment}{//KS:\ Now\ prepare\ folded\ draws,\ quoting\ Gelman}}
\DoxyCodeLine{00322\ \ \ \textcolor{comment}{//"{}We\ propose\ to\ report\ the\ maximum\ of\ rank\ normalized\ split-\/Rb\ and\ rank\ normalized\ folded-\/split-\/Rb\ for\ each\ parameter"{}}}
\DoxyCodeLine{00323\ \ \ \mbox{\hyperlink{RHat_8cpp_a761fd0b4a970686c00ce3e4daefd7f73}{MedianArr}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}}]();}
\DoxyCodeLine{00324\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD }}
\DoxyCodeLine{00325\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for }}
\DoxyCodeLine{00326\ \textcolor{preprocessor}{\ \ \#endif }}
\DoxyCodeLine{00327\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}};\ j++)}
\DoxyCodeLine{00328\ \ \ \{}
\DoxyCodeLine{00329\ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a761fd0b4a970686c00ce3e4daefd7f73}{MedianArr}}[j]\ =\ 0.;}
\DoxyCodeLine{00330\ \ \ \ \ std::vector<double>\ TempDraws(\mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}}\ *\ \mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}});}
\DoxyCodeLine{00331\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ m\ =\ 0;\ m\ <\ \mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}};\ m++)}
\DoxyCodeLine{00332\ \ \ \ \ \{}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}};\ i++)}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ im\ =\ i+m;}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ TempDraws[im]\ =\ \mbox{\hyperlink{RHat_8cpp_a9adc829d645affbb93eff1775ab7c0c6}{Draws}}[m][i][j];}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00338\ \ \ \ \ \}}
\DoxyCodeLine{00339\ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a761fd0b4a970686c00ce3e4daefd7f73}{MedianArr}}[j]\ =\ \mbox{\hyperlink{RHat_8cpp_ac038d6f2a074799534fc4a986ca36ef3}{CalcMedian}}(TempDraws.data(),\ \mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}}*\mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}});}
\DoxyCodeLine{00340\ \ \ \}}
\DoxyCodeLine{00341\ }
\DoxyCodeLine{00342\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD }}
\DoxyCodeLine{00343\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for\ collapse(3) }}
\DoxyCodeLine{00344\ \textcolor{preprocessor}{\ \ \#endif }}
\DoxyCodeLine{00345\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ m\ =\ 0;\ m\ <\ \mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}};\ m++)}
\DoxyCodeLine{00346\ \ \ \{}
\DoxyCodeLine{00347\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}};\ i++)}
\DoxyCodeLine{00348\ \ \ \ \ \{}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}};\ j++)}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{RHat_8cpp_a7e7fe290fda4362be54b8cf5d56fea51}{DrawsFolded}}[m][i][j]\ =\ std::fabs(\mbox{\hyperlink{RHat_8cpp_a9adc829d645affbb93eff1775ab7c0c6}{Draws}}[m][i][j]\ -\/\ \mbox{\hyperlink{RHat_8cpp_a761fd0b4a970686c00ce3e4daefd7f73}{MedianArr}}[j]);}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00353\ \ \ \ \ \}}
\DoxyCodeLine{00354\ \ \ \}}
\DoxyCodeLine{00355\ \ \ clock.Stop();}
\DoxyCodeLine{00356\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Finished\ calculating\ Toys,\ it\ took\ \{:.2f\}s\ to\ finish"{}},\ clock.RealTime());}
\DoxyCodeLine{00357\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{RHat_8cpp_a4c5629fb030eb27c32cab42a42c6623b}\label{RHat_8cpp_a4c5629fb030eb27c32cab42a42c6623b}} 
\index{RHat.cpp@{RHat.cpp}!RunDiagnostic@{RunDiagnostic}}
\index{RunDiagnostic@{RunDiagnostic}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{RunDiagnostic()}{RunDiagnostic()}}
{\footnotesize\ttfamily void Run\+Diagnostic (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00422}{422}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00423\ \textcolor{comment}{//\ *******************\ \ \ \ }}
\DoxyCodeLine{00424\ \ \ \mbox{\hyperlink{RHat_8cpp_abd5f8455bf73bda17794dc06218e6713}{CalcRhat}}();}
\DoxyCodeLine{00425\ \ \ \textcolor{comment}{//In\ case\ in\ future\ we\ expand\ this}}
\DoxyCodeLine{00426\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{RHat_8cpp_a194d97ca48b57a07a9df018a65f3166e}\label{RHat_8cpp_a194d97ca48b57a07a9df018a65f3166e}} 
\index{RHat.cpp@{RHat.cpp}!SaveResults@{SaveResults}}
\index{SaveResults@{SaveResults}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{SaveResults()}{SaveResults()}}
{\footnotesize\ttfamily void Save\+Results (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00580}{580}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00580\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00581\ \textcolor{comment}{//\ *******************\ \ \ \ }}
\DoxyCodeLine{00582\ \textcolor{preprocessor}{\#pragma\ GCC\ diagnostic\ ignored\ "{}-\/Wfloat-\/conversion"{}}}
\DoxyCodeLine{00583\ }
\DoxyCodeLine{00584\ \ \ std::string\ NameTemp\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00585\ \ \ \textcolor{comment}{//KS:\ If\ we\ run\ over\ many\ many\ chains\ there\ is\ danger\ that\ name\ will\ be\ so\ absurdly\ long\ we\ run\ over\ system\ limit\ and\ job\ will\ be\ killed\ :(}}
\DoxyCodeLine{00586\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}}\ <\ 5)}
\DoxyCodeLine{00587\ \ \ \{}
\DoxyCodeLine{00588\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}};\ i++)}
\DoxyCodeLine{00589\ \ \ \ \ \{}
\DoxyCodeLine{00590\ \ \ \ \ \ \ std::string\ temp\ =\ \mbox{\hyperlink{RHat_8cpp_aa19a5e341d34dce5448ee490dedba8ef}{MCMCFile}}[i];}
\DoxyCodeLine{00591\ }
\DoxyCodeLine{00592\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (temp.find(\textcolor{stringliteral}{"{}.root"{}})\ !=\ std::string::npos)\ \{}
\DoxyCodeLine{00593\ \ \ \ \ \ \ \ \ \ \ temp\ =\ temp.substr(0,\ temp.find(\textcolor{stringliteral}{"{}.root"{}}));}
\DoxyCodeLine{00594\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00595\ }
\DoxyCodeLine{00596\ \ \ \ \ \ \ NameTemp\ =\ NameTemp\ +\ temp\ +\ \textcolor{stringliteral}{"{}\_"{}};}
\DoxyCodeLine{00597\ \ \ \ \ \}}
\DoxyCodeLine{00598\ \ \ \}}
\DoxyCodeLine{00599\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00600\ \ \ \ \ NameTemp\ =\ std::to\_string(\mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}})\ +\ \textcolor{stringliteral}{"{}Chains"{}}\ +\ \textcolor{stringliteral}{"{}\_"{}};}
\DoxyCodeLine{00601\ \ \ \}}
\DoxyCodeLine{00602\ \ \ NameTemp\ +=\ \textcolor{stringliteral}{"{}diag.root"{}};}
\DoxyCodeLine{00603\ }
\DoxyCodeLine{00604\ \ \ TFile*\ DiagFile\ =\ \textcolor{keyword}{new}\ TFile(NameTemp.c\_str(),\ \textcolor{stringliteral}{"{}recreate"{}});}
\DoxyCodeLine{00605\ }
\DoxyCodeLine{00606\ \ \ DiagFile-\/>cd();}
\DoxyCodeLine{00607\ }
\DoxyCodeLine{00608\ \ \ \textcolor{keyword}{auto}\ StandardDeviationGlobalPlot\ =\ std::make\_unique<TH1D>(\textcolor{stringliteral}{"{}StandardDeviationGlobalPlot"{}},\ \textcolor{stringliteral}{"{}StandardDeviationGlobalPlot"{}},\ 200,\ 0,\ 2);}
\DoxyCodeLine{00609\ \ \ \textcolor{keyword}{auto}\ BetweenChainVariancePlot\ =\ std::make\_unique<TH1D>(\textcolor{stringliteral}{"{}BetweenChainVariancePlot"{}},\ \textcolor{stringliteral}{"{}BetweenChainVariancePlot"{}},\ 200,\ 0,\ 2);}
\DoxyCodeLine{00610\ \ \ \textcolor{keyword}{auto}\ MarginalPosteriorVariancePlot\ =\ std::make\_unique<TH1D>(\textcolor{stringliteral}{"{}MarginalPosteriorVariancePlot"{}},\ \textcolor{stringliteral}{"{}MarginalPosteriorVariancePlot"{}},\ 200,\ 0,\ 2);}
\DoxyCodeLine{00611\ \ \ \textcolor{keyword}{auto}\ RhatPlot\ =\ std::make\_unique<TH1D>(\textcolor{stringliteral}{"{}RhatPlot"{}},\ \textcolor{stringliteral}{"{}RhatPlot"{}},\ 200,\ 0,\ 2);}
\DoxyCodeLine{00612\ \ \ \textcolor{keyword}{auto}\ EffectiveSampleSizePlot\ =\ std::make\_unique<TH1D>(\textcolor{stringliteral}{"{}EffectiveSampleSizePlot"{}},\ \textcolor{stringliteral}{"{}EffectiveSampleSizePlot"{}},\ 400,\ 0,\ 10000);}
\DoxyCodeLine{00613\ }
\DoxyCodeLine{00614\ \ \ \textcolor{keyword}{auto}\ StandardDeviationGlobalFoldedPlot\ =\ std::make\_unique<TH1D>(\textcolor{stringliteral}{"{}StandardDeviationGlobalFoldedPlot"{}},\ \textcolor{stringliteral}{"{}StandardDeviationGlobalFoldedPlot"{}},\ 200,\ 0,\ 2);}
\DoxyCodeLine{00615\ \ \ \textcolor{keyword}{auto}\ BetweenChainVarianceFoldedPlot\ =\ std::make\_unique<TH1D>(\textcolor{stringliteral}{"{}BetweenChainVarianceFoldedPlot"{}},\ \textcolor{stringliteral}{"{}BetweenChainVarianceFoldedPlot"{}},\ 200,\ 0,\ 2);}
\DoxyCodeLine{00616\ \ \ \textcolor{keyword}{auto}\ MarginalPosteriorVarianceFoldedPlot\ =\ std::make\_unique<TH1D>(\textcolor{stringliteral}{"{}MarginalPosteriorVarianceFoldedPlot"{}},\ \textcolor{stringliteral}{"{}MarginalPosteriorVarianceFoldedPlot"{}},\ 200,\ 0,\ 2);}
\DoxyCodeLine{00617\ \ \ \textcolor{keyword}{auto}\ RhatFoldedPlot\ =\ std::make\_unique<TH1D>(\textcolor{stringliteral}{"{}RhatFoldedPlot"{}},\ \textcolor{stringliteral}{"{}RhatFoldedPlot"{}},\ 200,\ 0,\ 2);}
\DoxyCodeLine{00618\ \ \ \textcolor{keyword}{auto}\ EffectiveSampleSizeFoldedPlot\ =\ std::make\_unique<TH1D>(\textcolor{stringliteral}{"{}EffectiveSampleSizeFoldedPlot"{}},\ \textcolor{stringliteral}{"{}EffectiveSampleSizeFoldedPlot"{}},\ 400,\ 0,\ 10000);}
\DoxyCodeLine{00619\ }
\DoxyCodeLine{00620\ \ \ \textcolor{keyword}{auto}\ RhatLogPlot\ =\ std::make\_unique<TH1D>(\textcolor{stringliteral}{"{}RhatLogPlot"{}},\ \textcolor{stringliteral}{"{}RhatLogPlot"{}},\ 200,\ 0,\ 2);}
\DoxyCodeLine{00621\ \ \ \textcolor{keyword}{auto}\ RhatFoldedLogPlot\ =\ std::make\_unique<TH1D>(\textcolor{stringliteral}{"{}RhatFoldedLogPlot"{}},\ \textcolor{stringliteral}{"{}RhatFoldedLogPlot"{}},\ 200,\ 0,\ 2);}
\DoxyCodeLine{00622\ }
\DoxyCodeLine{00623\ \ \ \textcolor{keywordtype}{int}\ Criterium\ =\ 0;}
\DoxyCodeLine{00624\ \ \ \textcolor{keywordtype}{int}\ CiteriumFolded\ =\ 0;}
\DoxyCodeLine{00625\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}};\ j++)}
\DoxyCodeLine{00626\ \ \ \{}
\DoxyCodeLine{00627\ \ \ \ \ \textcolor{comment}{//KS:\ Fill\ only\ valid\ parameters}}
\DoxyCodeLine{00628\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{RHat_8cpp_a5217beba3b3cb82269e95bf52c3d62c5}{ValidPar}}[j])}
\DoxyCodeLine{00629\ \ \ \ \ \{}
\DoxyCodeLine{00630\ \ \ \ \ \ \ StandardDeviationGlobalPlot-\/>Fill(\mbox{\hyperlink{RHat_8cpp_a64de0e32daa60ec4f40e0e741d927334}{StandardDeviationGlobal}}[j]);}
\DoxyCodeLine{00631\ \ \ \ \ \ \ BetweenChainVariancePlot-\/>Fill(\mbox{\hyperlink{RHat_8cpp_a52dcf07f8f740636605516f6c2ab3e40}{BetweenChainVariance}}[j]);}
\DoxyCodeLine{00632\ \ \ \ \ \ \ MarginalPosteriorVariancePlot-\/>Fill(\mbox{\hyperlink{RHat_8cpp_a68813385f1240d1264e139391b12bf05}{MarginalPosteriorVariance}}[j]);}
\DoxyCodeLine{00633\ \ \ \ \ \ \ RhatPlot-\/>Fill(\mbox{\hyperlink{RHat_8cpp_ab5cfb5e8741283e8d8252aae184004e4}{RHat}}[j]);}
\DoxyCodeLine{00634\ \ \ \ \ \ \ EffectiveSampleSizePlot-\/>Fill(\mbox{\hyperlink{RHat_8cpp_ae673254e98992bd483de55c6c1d1dcaf}{EffectiveSampleSize}}[j]);}
\DoxyCodeLine{00635\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{RHat_8cpp_ab5cfb5e8741283e8d8252aae184004e4}{RHat}}[j]\ >\ 1.1)\ Criterium++;}
\DoxyCodeLine{00636\ }
\DoxyCodeLine{00637\ }
\DoxyCodeLine{00638\ \ \ \ \ \ \ StandardDeviationGlobalFoldedPlot-\/>Fill(\mbox{\hyperlink{RHat_8cpp_a255f6a2b0ce0d9e0aee2c06645008b0c}{StandardDeviationGlobalFolded}}[j]);}
\DoxyCodeLine{00639\ \ \ \ \ \ \ BetweenChainVarianceFoldedPlot-\/>Fill(\mbox{\hyperlink{RHat_8cpp_a3a65452412d9dd00c1a9e93d0bab1a26}{BetweenChainVarianceFolded}}[j]);}
\DoxyCodeLine{00640\ \ \ \ \ \ \ MarginalPosteriorVarianceFoldedPlot-\/>Fill(\mbox{\hyperlink{RHat_8cpp_af4fae3d323e2f5220b3506386304f8f4}{MarginalPosteriorVarianceFolded}}[j]);}
\DoxyCodeLine{00641\ \ \ \ \ \ \ RhatFoldedPlot-\/>Fill(\mbox{\hyperlink{RHat_8cpp_a754fbe6088f05d880121693722fe6b99}{RHatFolded}}[j]);}
\DoxyCodeLine{00642\ \ \ \ \ \ \ EffectiveSampleSizeFoldedPlot-\/>Fill(\mbox{\hyperlink{RHat_8cpp_a39a08e7110f564d00239beccded97be8}{EffectiveSampleSizeFolded}}[j]);}
\DoxyCodeLine{00643\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{RHat_8cpp_a754fbe6088f05d880121693722fe6b99}{RHatFolded}}[j]\ >\ 1.1)\ CiteriumFolded++;}
\DoxyCodeLine{00644\ \ \ \ \ \}}
\DoxyCodeLine{00645\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00646\ \ \ \ \ \{}
\DoxyCodeLine{00647\ \ \ \ \ \ \ RhatLogPlot-\/>Fill(\mbox{\hyperlink{RHat_8cpp_ab5cfb5e8741283e8d8252aae184004e4}{RHat}}[j]);}
\DoxyCodeLine{00648\ \ \ \ \ \ \ RhatFoldedLogPlot-\/>Fill(\mbox{\hyperlink{RHat_8cpp_a754fbe6088f05d880121693722fe6b99}{RHatFolded}}[j]);}
\DoxyCodeLine{00649\ \ \ \ \ \}}
\DoxyCodeLine{00650\ \ \ \}}
\DoxyCodeLine{00651\ \ \ \textcolor{comment}{//KS:\ We\ set\ criterium\ of\ 1.1\ based\ on\ Gelman\ et\ al.\ (2003)\ Bayesian\ Data\ Analysis}}
\DoxyCodeLine{00652\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Number\ of\ parameters\ which\ has\ R\ hat\ greater\ than\ 1.1\ is\ \{\}(\{:.2f\}\%)\ while\ for\ R\ hat\ folded\ \{\}(\{:.2f\}\%)"{}},\ Criterium,\ 100*\textcolor{keywordtype}{double}(Criterium)/\textcolor{keywordtype}{double}(\mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}}),\ CiteriumFolded,\ 100*\textcolor{keywordtype}{double}(CiteriumFolded)/\textcolor{keywordtype}{double}(\mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}}));}
\DoxyCodeLine{00653\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{RHat_8cpp_ae2faf756e30936102294777663fae31d}{nDraw}};\ j++)}
\DoxyCodeLine{00654\ \ \ \{}
\DoxyCodeLine{00655\ \ \ \ \ \textcolor{keywordflow}{if}(\ (\mbox{\hyperlink{RHat_8cpp_ab5cfb5e8741283e8d8252aae184004e4}{RHat}}[j]\ >\ 1.1\ ||\ \mbox{\hyperlink{RHat_8cpp_a754fbe6088f05d880121693722fe6b99}{RHatFolded}}[j]\ >\ 1.1)\ \&\&\ \mbox{\hyperlink{RHat_8cpp_a5217beba3b3cb82269e95bf52c3d62c5}{ValidPar}}[j])}
\DoxyCodeLine{00656\ \ \ \ \ \{}
\DoxyCodeLine{00657\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a07ff6d6a15b24f94afc88a1b89779beb}{MACH3LOG\_CRITICAL}}(\textcolor{stringliteral}{"{}Parameter\ \{\}\ has\ R\ hat\ higher\ than\ 1.1"{}},\ \mbox{\hyperlink{RHat_8cpp_a871d6466cea2597401bdb203293f4033}{BranchNames}}[j]);}
\DoxyCodeLine{00658\ \ \ \ \ \}}
\DoxyCodeLine{00659\ \ \ \}}
\DoxyCodeLine{00660\ \ \ StandardDeviationGlobalPlot-\/>Write();}
\DoxyCodeLine{00661\ \ \ BetweenChainVariancePlot-\/>Write();}
\DoxyCodeLine{00662\ \ \ MarginalPosteriorVariancePlot-\/>Write();}
\DoxyCodeLine{00663\ \ \ RhatPlot-\/>Write();}
\DoxyCodeLine{00664\ \ \ EffectiveSampleSizePlot-\/>Write();}
\DoxyCodeLine{00665\ }
\DoxyCodeLine{00666\ \ \ StandardDeviationGlobalFoldedPlot-\/>Write();}
\DoxyCodeLine{00667\ \ \ BetweenChainVarianceFoldedPlot-\/>Write();}
\DoxyCodeLine{00668\ \ \ MarginalPosteriorVarianceFoldedPlot-\/>Write();}
\DoxyCodeLine{00669\ \ \ RhatFoldedPlot-\/>Write();}
\DoxyCodeLine{00670\ \ \ EffectiveSampleSizeFoldedPlot-\/>Write();}
\DoxyCodeLine{00671\ }
\DoxyCodeLine{00672\ \ \ RhatLogPlot-\/>Write();}
\DoxyCodeLine{00673\ \ \ RhatFoldedLogPlot-\/>Write();}
\DoxyCodeLine{00674\ }
\DoxyCodeLine{00675\ \ \ \textcolor{comment}{//KS:\ Now\ we\ make\ fancy\ canvases,\ consider\ some\ function\ to\ have\ less\ copy\ pasting}}
\DoxyCodeLine{00676\ \ \ \textcolor{keyword}{auto}\ TempCanvas\ =\ std::make\_unique<TCanvas>(\textcolor{stringliteral}{"{}Canvas"{}},\ \textcolor{stringliteral}{"{}Canvas"{}},\ 1024,\ 1024);}
\DoxyCodeLine{00677\ \ \ gStyle-\/>SetOptStat(0);}
\DoxyCodeLine{00678\ \ \ TempCanvas-\/>SetGridx();}
\DoxyCodeLine{00679\ \ \ TempCanvas-\/>SetGridy();}
\DoxyCodeLine{00680\ }
\DoxyCodeLine{00681\ \ \ \textcolor{comment}{//\ Random\ line\ to\ write\ useful\ information\ to\ TLegend}}
\DoxyCodeLine{00682\ \ \ \textcolor{keyword}{auto}\ TempLine\ =\ std::make\_unique<TLine>(0,\ 0,\ 0,\ 0);}
\DoxyCodeLine{00683\ \ \ TempLine-\/>SetLineColor(kBlack);}
\DoxyCodeLine{00684\ }
\DoxyCodeLine{00685\ \ \ RhatPlot-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}R\ hat"{}});}
\DoxyCodeLine{00686\ \ \ RhatPlot-\/>SetLineColor(kRed);}
\DoxyCodeLine{00687\ \ \ RhatPlot-\/>SetFillColor(kRed);}
\DoxyCodeLine{00688\ \ \ RhatFoldedPlot-\/>SetLineColor(kBlue);}
\DoxyCodeLine{00689\ \ \ RhatFoldedPlot-\/>SetFillColor(kBlue);}
\DoxyCodeLine{00690\ }
\DoxyCodeLine{00691\ \ \ TLegend\ *Legend\ =\ \textcolor{keyword}{new}\ TLegend(0.55,\ 0.6,\ 0.9,\ 0.9);}
\DoxyCodeLine{00692\ \ \ Legend-\/>SetTextSize(0.04);}
\DoxyCodeLine{00693\ \ \ Legend-\/>SetFillColor(0);}
\DoxyCodeLine{00694\ \ \ Legend-\/>SetFillStyle(0);}
\DoxyCodeLine{00695\ \ \ Legend-\/>SetLineWidth(0);}
\DoxyCodeLine{00696\ \ \ Legend-\/>SetLineColor(0);}
\DoxyCodeLine{00697\ }
\DoxyCodeLine{00698\ \ \ Legend-\/>AddEntry(TempLine.get(),\ Form(\textcolor{stringliteral}{"{}Number\ of\ throws=\%.0i,\ Number\ of\ chains=\%.1i"{}},\ \mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}},\ \mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}}),\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00699\ \ \ Legend-\/>AddEntry(RhatPlot.get(),\ \textcolor{stringliteral}{"{}Rhat\ Gelman\ 2013"{}},\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{00700\ \ \ Legend-\/>AddEntry(RhatFoldedPlot.get(),\ \textcolor{stringliteral}{"{}Rhat-\/Folded\ Gelman\ 2021"{}},\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{00701\ }
\DoxyCodeLine{00702\ \ \ RhatPlot-\/>Draw();}
\DoxyCodeLine{00703\ \ \ RhatFoldedPlot-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{00704\ \ \ Legend-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{00705\ \ \ TempCanvas-\/>Write(\textcolor{stringliteral}{"{}Rhat"{}});}
\DoxyCodeLine{00706\ \ \ \textcolor{keyword}{delete}\ Legend;}
\DoxyCodeLine{00707\ \ \ Legend\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00708\ }
\DoxyCodeLine{00709\ \ \ \textcolor{comment}{//Now\ R\ hat\ for\ log\ L}}
\DoxyCodeLine{00710\ \ \ RhatLogPlot-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}R\ hat\ for\ LogL"{}});}
\DoxyCodeLine{00711\ \ \ RhatLogPlot-\/>SetLineColor(kRed);}
\DoxyCodeLine{00712\ \ \ RhatLogPlot-\/>SetFillColor(kRed);}
\DoxyCodeLine{00713\ \ \ RhatFoldedLogPlot-\/>SetLineColor(kBlue);}
\DoxyCodeLine{00714\ \ \ RhatFoldedLogPlot-\/>SetFillColor(kBlue);}
\DoxyCodeLine{00715\ }
\DoxyCodeLine{00716\ \ \ Legend\ =\ \textcolor{keyword}{new}\ TLegend(0.55,\ 0.6,\ 0.9,\ 0.9);}
\DoxyCodeLine{00717\ \ \ Legend-\/>SetTextSize(0.04);}
\DoxyCodeLine{00718\ \ \ Legend-\/>SetFillColor(0);}
\DoxyCodeLine{00719\ \ \ Legend-\/>SetFillStyle(0);}
\DoxyCodeLine{00720\ \ \ Legend-\/>SetLineWidth(0);}
\DoxyCodeLine{00721\ \ \ Legend-\/>SetLineColor(0);}
\DoxyCodeLine{00722\ }
\DoxyCodeLine{00723\ \ \ Legend-\/>AddEntry(TempLine.get(),\ Form(\textcolor{stringliteral}{"{}Number\ of\ throws=\%.0i,\ Number\ of\ chains=\%.1i"{}},\ \mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}},\ \mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}}),\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00724\ \ \ Legend-\/>AddEntry(RhatLogPlot.get(),\ \textcolor{stringliteral}{"{}Rhat\ Gelman\ 2013"{}},\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{00725\ \ \ Legend-\/>AddEntry(RhatFoldedLogPlot.get(),\ \textcolor{stringliteral}{"{}Rhat-\/Folded\ Gelman\ 2021"{}},\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{00726\ }
\DoxyCodeLine{00727\ \ \ RhatLogPlot-\/>Draw();}
\DoxyCodeLine{00728\ \ \ RhatFoldedLogPlot-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{00729\ \ \ Legend-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{00730\ \ \ TempCanvas-\/>Write(\textcolor{stringliteral}{"{}RhatLog"{}});}
\DoxyCodeLine{00731\ \ \ \textcolor{keyword}{delete}\ Legend;}
\DoxyCodeLine{00732\ \ \ Legend\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00733\ }
\DoxyCodeLine{00734\ \ \ \textcolor{comment}{//Now\ canvas\ for\ effective\ sample\ size}}
\DoxyCodeLine{00735\ \ \ EffectiveSampleSizePlot-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}S\_\{eff,\ BDA2\}"{}});}
\DoxyCodeLine{00736\ \ \ EffectiveSampleSizePlot-\/>SetLineColor(kRed);}
\DoxyCodeLine{00737\ \ \ EffectiveSampleSizeFoldedPlot-\/>SetLineColor(kBlue);}
\DoxyCodeLine{00738\ }
\DoxyCodeLine{00739\ \ \ Legend\ =\ \textcolor{keyword}{new}\ TLegend(0.45,\ 0.6,\ 0.9,\ 0.9);}
\DoxyCodeLine{00740\ \ \ Legend-\/>SetTextSize(0.03);}
\DoxyCodeLine{00741\ \ \ Legend-\/>SetFillColor(0);}
\DoxyCodeLine{00742\ \ \ Legend-\/>SetFillStyle(0);}
\DoxyCodeLine{00743\ \ \ Legend-\/>SetLineWidth(0);}
\DoxyCodeLine{00744\ \ \ Legend-\/>SetLineColor(0);}
\DoxyCodeLine{00745\ }
\DoxyCodeLine{00746\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Mean1\ =\ EffectiveSampleSizePlot-\/>GetMean();}
\DoxyCodeLine{00747\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ RMS1\ =\ EffectiveSampleSizePlot-\/>GetRMS();}
\DoxyCodeLine{00748\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Mean2\ =\ EffectiveSampleSizeFoldedPlot-\/>GetMean();}
\DoxyCodeLine{00749\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ RMS2\ =\ EffectiveSampleSizeFoldedPlot-\/>GetRMS();}
\DoxyCodeLine{00750\ }
\DoxyCodeLine{00751\ \ \ Legend-\/>AddEntry(TempLine.get(),\ Form(\textcolor{stringliteral}{"{}Number\ of\ throws=\%.0i,\ Number\ of\ chains=\%.1i"{}},\ \mbox{\hyperlink{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}{Ntoys}},\ \mbox{\hyperlink{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}{Nchains}}),\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00752\ \ \ Legend-\/>AddEntry(EffectiveSampleSizePlot.get(),\ Form(\textcolor{stringliteral}{"{}S\_\{eff,\ BDA2\}\ \#mu\ =\ \%.2f,\ \#sigma\ =\ \%.2f"{}},Mean1\ ,RMS1),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{00753\ \ \ Legend-\/>AddEntry(EffectiveSampleSizeFoldedPlot.get(),\ Form(\textcolor{stringliteral}{"{}S\_\{eff,\ BDA2\}\ Folded,\ \#mu\ =\ \%.2f,\ \#sigma\ =\ \%.2f"{}},Mean2\ ,RMS2),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{00754\ }
\DoxyCodeLine{00755\ \ \ EffectiveSampleSizePlot-\/>Draw();}
\DoxyCodeLine{00756\ \ \ EffectiveSampleSizeFoldedPlot-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{00757\ \ \ Legend-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{00758\ \ \ TempCanvas-\/>Write(\textcolor{stringliteral}{"{}EffectiveSampleSize"{}});}
\DoxyCodeLine{00759\ }
\DoxyCodeLine{00760\ \ \ \textcolor{keyword}{delete}\ Legend;}
\DoxyCodeLine{00761\ }
\DoxyCodeLine{00762\ \ \ DiagFile-\/>Close();}
\DoxyCodeLine{00763\ \ \ \textcolor{keyword}{delete}\ DiagFile;}
\DoxyCodeLine{00764\ }
\DoxyCodeLine{00765\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Finished\ and\ wrote\ results\ to\ \{\}"{}},\ NameTemp);}
\DoxyCodeLine{00766\ \}}

\end{DoxyCode}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{RHat_8cpp_a52dcf07f8f740636605516f6c2ab3e40}\label{RHat_8cpp_a52dcf07f8f740636605516f6c2ab3e40}} 
\index{RHat.cpp@{RHat.cpp}!BetweenChainVariance@{BetweenChainVariance}}
\index{BetweenChainVariance@{BetweenChainVariance}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{BetweenChainVariance}{BetweenChainVariance}}
{\footnotesize\ttfamily double$\ast$ Between\+Chain\+Variance}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00051}{51}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.

\mbox{\Hypertarget{RHat_8cpp_a3a65452412d9dd00c1a9e93d0bab1a26}\label{RHat_8cpp_a3a65452412d9dd00c1a9e93d0bab1a26}} 
\index{RHat.cpp@{RHat.cpp}!BetweenChainVarianceFolded@{BetweenChainVarianceFolded}}
\index{BetweenChainVarianceFolded@{BetweenChainVarianceFolded}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{BetweenChainVarianceFolded}{BetweenChainVarianceFolded}}
{\footnotesize\ttfamily double$\ast$ Between\+Chain\+Variance\+Folded}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00065}{65}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.

\mbox{\Hypertarget{RHat_8cpp_a871d6466cea2597401bdb203293f4033}\label{RHat_8cpp_a871d6466cea2597401bdb203293f4033}} 
\index{RHat.cpp@{RHat.cpp}!BranchNames@{BranchNames}}
\index{BranchNames@{BranchNames}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{BranchNames}{BranchNames}}
{\footnotesize\ttfamily std\+::vector$<$TString$>$ Branch\+Names}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00039}{39}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.

\mbox{\Hypertarget{RHat_8cpp_a9adc829d645affbb93eff1775ab7c0c6}\label{RHat_8cpp_a9adc829d645affbb93eff1775ab7c0c6}} 
\index{RHat.cpp@{RHat.cpp}!Draws@{Draws}}
\index{Draws@{Draws}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{Draws}{Draws}}
{\footnotesize\ttfamily double$\ast$$\ast$$\ast$ Draws}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00043}{43}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.

\mbox{\Hypertarget{RHat_8cpp_a7e7fe290fda4362be54b8cf5d56fea51}\label{RHat_8cpp_a7e7fe290fda4362be54b8cf5d56fea51}} 
\index{RHat.cpp@{RHat.cpp}!DrawsFolded@{DrawsFolded}}
\index{DrawsFolded@{DrawsFolded}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{DrawsFolded}{DrawsFolded}}
{\footnotesize\ttfamily double$\ast$$\ast$$\ast$ Draws\+Folded}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00056}{56}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.

\mbox{\Hypertarget{RHat_8cpp_ae673254e98992bd483de55c6c1d1dcaf}\label{RHat_8cpp_ae673254e98992bd483de55c6c1d1dcaf}} 
\index{RHat.cpp@{RHat.cpp}!EffectiveSampleSize@{EffectiveSampleSize}}
\index{EffectiveSampleSize@{EffectiveSampleSize}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{EffectiveSampleSize}{EffectiveSampleSize}}
{\footnotesize\ttfamily double$\ast$ Effective\+Sample\+Size}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00054}{54}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.

\mbox{\Hypertarget{RHat_8cpp_a39a08e7110f564d00239beccded97be8}\label{RHat_8cpp_a39a08e7110f564d00239beccded97be8}} 
\index{RHat.cpp@{RHat.cpp}!EffectiveSampleSizeFolded@{EffectiveSampleSizeFolded}}
\index{EffectiveSampleSizeFolded@{EffectiveSampleSizeFolded}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{EffectiveSampleSizeFolded}{EffectiveSampleSizeFolded}}
{\footnotesize\ttfamily double$\ast$ Effective\+Sample\+Size\+Folded}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00068}{68}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.

\mbox{\Hypertarget{RHat_8cpp_a68813385f1240d1264e139391b12bf05}\label{RHat_8cpp_a68813385f1240d1264e139391b12bf05}} 
\index{RHat.cpp@{RHat.cpp}!MarginalPosteriorVariance@{MarginalPosteriorVariance}}
\index{MarginalPosteriorVariance@{MarginalPosteriorVariance}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{MarginalPosteriorVariance}{MarginalPosteriorVariance}}
{\footnotesize\ttfamily double$\ast$ Marginal\+Posterior\+Variance}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00052}{52}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.

\mbox{\Hypertarget{RHat_8cpp_af4fae3d323e2f5220b3506386304f8f4}\label{RHat_8cpp_af4fae3d323e2f5220b3506386304f8f4}} 
\index{RHat.cpp@{RHat.cpp}!MarginalPosteriorVarianceFolded@{MarginalPosteriorVarianceFolded}}
\index{MarginalPosteriorVarianceFolded@{MarginalPosteriorVarianceFolded}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{MarginalPosteriorVarianceFolded}{MarginalPosteriorVarianceFolded}}
{\footnotesize\ttfamily double$\ast$ Marginal\+Posterior\+Variance\+Folded}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00066}{66}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.

\mbox{\Hypertarget{RHat_8cpp_aa19a5e341d34dce5448ee490dedba8ef}\label{RHat_8cpp_aa19a5e341d34dce5448ee490dedba8ef}} 
\index{RHat.cpp@{RHat.cpp}!MCMCFile@{MCMCFile}}
\index{MCMCFile@{MCMCFile}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{MCMCFile}{MCMCFile}}
{\footnotesize\ttfamily std\+::vector$<$std\+::string$>$ MCMCFile}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00040}{40}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.

\mbox{\Hypertarget{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}\label{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}} 
\index{RHat.cpp@{RHat.cpp}!Mean@{Mean}}
\index{Mean@{Mean}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{Mean}{Mean}}
{\footnotesize\ttfamily double$\ast$$\ast$ Mean}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00045}{45}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.

\mbox{\Hypertarget{RHat_8cpp_a458eb859b19f20edc7607814bd68d449}\label{RHat_8cpp_a458eb859b19f20edc7607814bd68d449}} 
\index{RHat.cpp@{RHat.cpp}!MeanFolded@{MeanFolded}}
\index{MeanFolded@{MeanFolded}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{MeanFolded}{MeanFolded}}
{\footnotesize\ttfamily double$\ast$$\ast$ Mean\+Folded}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00059}{59}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.

\mbox{\Hypertarget{RHat_8cpp_a4526fa4abfccd1173c87267a0beb6977}\label{RHat_8cpp_a4526fa4abfccd1173c87267a0beb6977}} 
\index{RHat.cpp@{RHat.cpp}!MeanGlobal@{MeanGlobal}}
\index{MeanGlobal@{MeanGlobal}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{MeanGlobal}{MeanGlobal}}
{\footnotesize\ttfamily double$\ast$ Mean\+Global}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00048}{48}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.

\mbox{\Hypertarget{RHat_8cpp_a5afb47112913938579beb8b9f385a574}\label{RHat_8cpp_a5afb47112913938579beb8b9f385a574}} 
\index{RHat.cpp@{RHat.cpp}!MeanGlobalFolded@{MeanGlobalFolded}}
\index{MeanGlobalFolded@{MeanGlobalFolded}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{MeanGlobalFolded}{MeanGlobalFolded}}
{\footnotesize\ttfamily double$\ast$ Mean\+Global\+Folded}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00062}{62}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.

\mbox{\Hypertarget{RHat_8cpp_a761fd0b4a970686c00ce3e4daefd7f73}\label{RHat_8cpp_a761fd0b4a970686c00ce3e4daefd7f73}} 
\index{RHat.cpp@{RHat.cpp}!MedianArr@{MedianArr}}
\index{MedianArr@{MedianArr}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{MedianArr}{MedianArr}}
{\footnotesize\ttfamily double$\ast$ Median\+Arr}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00057}{57}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.

\mbox{\Hypertarget{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}\label{RHat_8cpp_a231bc179b5599c7e29d5ba28ff2b4b70}} 
\index{RHat.cpp@{RHat.cpp}!Nchains@{Nchains}}
\index{Nchains@{Nchains}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{Nchains}{Nchains}}
{\footnotesize\ttfamily int Nchains}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00035}{35}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.

\mbox{\Hypertarget{RHat_8cpp_ae2faf756e30936102294777663fae31d}\label{RHat_8cpp_ae2faf756e30936102294777663fae31d}} 
\index{RHat.cpp@{RHat.cpp}!nDraw@{nDraw}}
\index{nDraw@{nDraw}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{nDraw}{nDraw}}
{\footnotesize\ttfamily int n\+Draw}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00037}{37}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.

\mbox{\Hypertarget{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}\label{RHat_8cpp_afa110f35953074d3cc7ad452d003fd7a}} 
\index{RHat.cpp@{RHat.cpp}!Ntoys@{Ntoys}}
\index{Ntoys@{Ntoys}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{Ntoys}{Ntoys}}
{\footnotesize\ttfamily int Ntoys}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00034}{34}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.

\mbox{\Hypertarget{RHat_8cpp_ab5cfb5e8741283e8d8252aae184004e4}\label{RHat_8cpp_ab5cfb5e8741283e8d8252aae184004e4}} 
\index{RHat.cpp@{RHat.cpp}!RHat@{RHat}}
\index{RHat@{RHat}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{RHat}{RHat}}
{\footnotesize\ttfamily double$\ast$ RHat}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00053}{53}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.

\mbox{\Hypertarget{RHat_8cpp_a754fbe6088f05d880121693722fe6b99}\label{RHat_8cpp_a754fbe6088f05d880121693722fe6b99}} 
\index{RHat.cpp@{RHat.cpp}!RHatFolded@{RHatFolded}}
\index{RHatFolded@{RHatFolded}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{RHatFolded}{RHatFolded}}
{\footnotesize\ttfamily double$\ast$ RHat\+Folded}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00067}{67}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.

\mbox{\Hypertarget{RHat_8cpp_a5bdfaf60cce582e30db6bd3001de9935}\label{RHat_8cpp_a5bdfaf60cce582e30db6bd3001de9935}} 
\index{RHat.cpp@{RHat.cpp}!StandardDeviation@{StandardDeviation}}
\index{StandardDeviation@{StandardDeviation}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{StandardDeviation}{StandardDeviation}}
{\footnotesize\ttfamily double$\ast$$\ast$ Standard\+Deviation}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00046}{46}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.

\mbox{\Hypertarget{RHat_8cpp_a85509f675b977490fa59bdf037d38ba2}\label{RHat_8cpp_a85509f675b977490fa59bdf037d38ba2}} 
\index{RHat.cpp@{RHat.cpp}!StandardDeviationFolded@{StandardDeviationFolded}}
\index{StandardDeviationFolded@{StandardDeviationFolded}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{StandardDeviationFolded}{StandardDeviationFolded}}
{\footnotesize\ttfamily double$\ast$$\ast$ Standard\+Deviation\+Folded}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00060}{60}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.

\mbox{\Hypertarget{RHat_8cpp_a64de0e32daa60ec4f40e0e741d927334}\label{RHat_8cpp_a64de0e32daa60ec4f40e0e741d927334}} 
\index{RHat.cpp@{RHat.cpp}!StandardDeviationGlobal@{StandardDeviationGlobal}}
\index{StandardDeviationGlobal@{StandardDeviationGlobal}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{StandardDeviationGlobal}{StandardDeviationGlobal}}
{\footnotesize\ttfamily double$\ast$ Standard\+Deviation\+Global}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00049}{49}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.

\mbox{\Hypertarget{RHat_8cpp_a255f6a2b0ce0d9e0aee2c06645008b0c}\label{RHat_8cpp_a255f6a2b0ce0d9e0aee2c06645008b0c}} 
\index{RHat.cpp@{RHat.cpp}!StandardDeviationGlobalFolded@{StandardDeviationGlobalFolded}}
\index{StandardDeviationGlobalFolded@{StandardDeviationGlobalFolded}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{StandardDeviationGlobalFolded}{StandardDeviationGlobalFolded}}
{\footnotesize\ttfamily double$\ast$ Standard\+Deviation\+Global\+Folded}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00063}{63}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.

\mbox{\Hypertarget{RHat_8cpp_a5217beba3b3cb82269e95bf52c3d62c5}\label{RHat_8cpp_a5217beba3b3cb82269e95bf52c3d62c5}} 
\index{RHat.cpp@{RHat.cpp}!ValidPar@{ValidPar}}
\index{ValidPar@{ValidPar}!RHat.cpp@{RHat.cpp}}
\doxysubsubsection{\texorpdfstring{ValidPar}{ValidPar}}
{\footnotesize\ttfamily std\+::vector$<$bool$>$ Valid\+Par}



Definition at line \mbox{\hyperlink{RHat_8cpp_source_l00041}{41}} of file \mbox{\hyperlink{RHat_8cpp_source}{RHat.\+cpp}}.

