\hypertarget{classMCMCProcessor}{}\doxysection{MCMCProcessor Class Reference}
\label{classMCMCProcessor}\index{MCMCProcessor@{MCMCProcessor}}


Class responsible for processing MCMC chains, performing diagnostics, generating plots, and managing Bayesian analysis.  




{\ttfamily \#include $<$/home/runner/work/\+Ma\+Ch3/\+Ma\+Ch3/mcmc/\+MCMCProcessor.\+h$>$}



Collaboration diagram for MCMCProcessor\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classMCMCProcessor__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classMCMCProcessor_afb50150dcb6d1d75f3c08b5ee8d3d77c}{MCMCProcessor}} (const std\+::string \&Input\+File)
\begin{DoxyCompactList}\small\item\em Constructs an \mbox{\hyperlink{classMCMCProcessor}{MCMCProcessor}} object with the specified input file and options. \end{DoxyCompactList}\item 
virtual \mbox{\hyperlink{classMCMCProcessor_a50810cd50c5a4545bd5c1e486aae7b1c}{$\sim$\+MCMCProcessor}} ()
\begin{DoxyCompactList}\small\item\em Destroys the \mbox{\hyperlink{classMCMCProcessor}{MCMCProcessor}} object. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a224995a0b47bd9cbd04e099cc3ca634c}{Initialise}} ()
\begin{DoxyCompactList}\small\item\em Scan chain, what parameters we have and load information from covariance matrices. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a8667510132aa01395520f028287f511b}{Make\+Postfit}} ()
\begin{DoxyCompactList}\small\item\em Make 1D projection for each parameter and prepare structure. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_afc94f21ffd599b1e2dd7e62f24f6c4de}{Make\+Covariance}} ()
\begin{DoxyCompactList}\small\item\em Calculate covariance by making 2D projection of each combination of parameters. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_ace48a54fb08e2a3943d4e2ed1f8c4a4b}{Cache\+Steps}} ()
\begin{DoxyCompactList}\small\item\em KS\+:By caching each step we use multithreading. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_ab367cb5f56606338bb1fce780f2414e8}{Make\+Covariance\+\_\+\+MP}} (const bool Mute=false)
\begin{DoxyCompactList}\small\item\em Calculate covariance by making 2D projection of each combination of parameters using multithreading. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_afac304b884238cc3624f5471b43f1a7e}{Make\+Sub\+Optimality}} (const int NIntervals=10)
\begin{DoxyCompactList}\small\item\em Make and Draw Sub\+Optimality \cite{roberts2009adaptive}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a36441ec3d5b0e24e48040282ffcda3eb}{Reset\+Histograms}} ()
\begin{DoxyCompactList}\small\item\em Reset 2D posteriors, in case we would like to calculate in again with different Burn\+In\+Cut. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_ab420de77e598da4b02ba74cdc20f2ea9}{Draw\+Postfit}} ()
\begin{DoxyCompactList}\small\item\em Draw the post-\/fit comparisons. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a04976c69f0ef0b3f39edcf5f25f90981}{Make\+Violin}} ()
\begin{DoxyCompactList}\small\item\em Make and Draw Violin. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a17c0f09bfce82d1701a83645f748988a}{Make\+Credible\+Intervals}} (const std\+::vector$<$ double $>$ \&Credible\+Intervals=\{0.\+99, 0.\+90, 0.\+68 \}, const std\+::vector$<$ Color\+\_\+t $>$ \&Credible\+Intervals\+Colours=\{k\+Cyan+4, k\+Cyan-\/2, k\+Cyan-\/10\}, const bool Credible\+In\+Sigmas=false)
\begin{DoxyCompactList}\small\item\em Make and Draw Credible intervals. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a8d9b9c1c780a51b130fe528583dc5019}{Draw\+Covariance}} ()
\begin{DoxyCompactList}\small\item\em Draw the post-\/fit covariances. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a304adbe4407166ec42d76329c4bd17ff}{Make\+Credible\+Regions}} (const std\+::vector$<$ double $>$ \&Credible\+Regions=\{0.\+99, 0.\+90, 0.\+68\}, const std\+::vector$<$ Style\+\_\+t $>$ \&Credible\+Region\+Style=\{k\+Dashed, k\+Solid, k\+Dotted\}, const std\+::vector$<$ Color\+\_\+t $>$ \&Credible\+Region\+Color=\{k\+Green-\/3, k\+Green-\/10, k\+Green\}, const bool Credible\+In\+Sigmas=false)
\begin{DoxyCompactList}\small\item\em Make and Draw Credible Regions. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a3ae80722efa0c94eec066ee91f3cf997}{Make\+Triangle\+Plot}} (const std\+::vector$<$ std\+::string $>$ \&Par\+Names, const std\+::vector$<$ double $>$ \&Credible\+Intervals=\{0.\+99, 0.\+90, 0.\+68 \}, const std\+::vector$<$ Color\+\_\+t $>$ \&Credible\+Intervals\+Colours=\{k\+Cyan+4, k\+Cyan-\/2, k\+Cyan-\/10\}, const std\+::vector$<$ double $>$ \&Credible\+Regions=\{0.\+99, 0.\+90, 0.\+68\}, const std\+::vector$<$ Style\+\_\+t $>$ \&Credible\+Region\+Style=\{k\+Dashed, k\+Solid, k\+Dotted\}, const std\+::vector$<$ Color\+\_\+t $>$ \&Credible\+Region\+Color=\{k\+Green-\/3, k\+Green-\/10, k\+Green\}, const bool Credible\+In\+Sigmas=false)
\begin{DoxyCompactList}\small\item\em Make fancy triangle plot for selected parameters. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_ac358c3ffe7c060e8872c762259973c6b}{Get\+Polar\+Plot}} (const std\+::vector$<$ std\+::string $>$ \&Par\+Names)
\begin{DoxyCompactList}\small\item\em Make funny polar plot. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a1fc5adc3c109227e6ead71eb0746ec4d}{Get\+Bayes\+Factor}} (const std\+::vector$<$ std\+::string $>$ \&Par\+Name, const std\+::vector$<$ std\+::vector$<$ double $>$ $>$ \&Model1\+Bounds, const std\+::vector$<$ std\+::vector$<$ double $>$ $>$ \&Model2\+Bounds, const std\+::vector$<$ std\+::vector$<$ std\+::string $>$ $>$ \&Model\+Names)
\begin{DoxyCompactList}\small\item\em Calculate Bayes factor for vector of params, and model boundaries. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_ad09b1ad60fa52fdd87450ab8834e9cd9}{Get\+Savage\+Dickey}} (const std\+::vector$<$ std\+::string $>$ \&Par\+Name, const std\+::vector$<$ double $>$ \&Evaluation\+Point, const std\+::vector$<$ std\+::vector$<$ double $>$ $>$ \&Bounds)
\begin{DoxyCompactList}\small\item\em Calculate Bayes factor for point like hypothesis using Savage\+Dickey. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_ad3b1cfab21c7063bc29d1cf5dcca888c}{Reweight\+Prior}} (const std\+::vector$<$ std\+::string $>$ \&Names, const std\+::vector$<$ double $>$ \&New\+Central, const std\+::vector$<$ double $>$ \&New\+Error)
\begin{DoxyCompactList}\small\item\em Reweight Prior by giving new central value and new error. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_ac9a5fc93b5ac3f6ef7850d21f47fd5dd}{Parameter\+Evolution}} (const std\+::vector$<$ std\+::string $>$ \&Names, const std\+::vector$<$ int $>$ \&NIntervals)
\begin{DoxyCompactList}\small\item\em Make .gif of parameter evolution. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a7f8faecae63616ba100cf24ae42ecc08}{Diag\+MCMC}} ()
\begin{DoxyCompactList}\small\item\em KS\+: Perform MCMC diagnostic including Autocorrelation, Trace etc. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classMCMCProcessor_adbde2f115d983b233d0a9ea896187586}{Get\+NParams}} ()
\begin{DoxyCompactList}\small\item\em Get total number of used parameters. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classMCMCProcessor_a82e67c2a28b286aae353636782c93a23}{Get\+NFlux}} ()
\item 
int \mbox{\hyperlink{classMCMCProcessor_ae5ba9ac70fefcd01afd5066281438883}{Get\+NXSec}} ()
\item 
int \mbox{\hyperlink{classMCMCProcessor_af92fab1bce506912ae00d1aa5d9b7233}{Get\+NND}} ()
\item 
int \mbox{\hyperlink{classMCMCProcessor_ad376c15dcf60a4284dfa23368e097450}{Get\+NFD}} ()
\item 
int \mbox{\hyperlink{classMCMCProcessor_a6aaa70eeca8d40c94f9836b3108cf579}{Get\+OSC}} ()
\item 
TH1D $\ast$ \mbox{\hyperlink{classMCMCProcessor_a70f5590946414af43c3b6c3a5cd315de}{Get\+Hpost}} (const int i)
\begin{DoxyCompactList}\small\item\em Get 1D posterior for a given parameter. \end{DoxyCompactList}\item 
TH2D $\ast$ \mbox{\hyperlink{classMCMCProcessor_a7882d6c6a54bb345df394ef13b2962d1}{Get\+Hpost2D}} (const int i, const int j)
\begin{DoxyCompactList}\small\item\em Get 2D posterior for a given parameter combination. \end{DoxyCompactList}\item 
TH2D $\ast$ \mbox{\hyperlink{classMCMCProcessor_a4ecd30520854d1379946bd8b1f2992f2}{Get\+Violin}} ()
\begin{DoxyCompactList}\small\item\em Get Violin plot for all parameters with posterior values. \end{DoxyCompactList}\item 
TH2D $\ast$ \mbox{\hyperlink{classMCMCProcessor_a0489e9f57b847389bc0c9f8af5a0abdb}{Get\+Violin\+Prior}} ()
\begin{DoxyCompactList}\small\item\em Get Violin plot for all parameters with prior values. \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::string $>$ \mbox{\hyperlink{classMCMCProcessor_ad4fa1cfa19aad913c370143b4dc2fa6b}{Get\+XSec\+Cov}} () const
\item 
std\+::string \mbox{\hyperlink{classMCMCProcessor_ad26a853f53f50f5625b1c8043534dbe0}{Get\+NDCov}} () const
\item 
std\+::string \mbox{\hyperlink{classMCMCProcessor_ab831ff0257b1f3137e1711df115a8b8d}{Get\+FDCov}} () const
\item 
std\+::vector$<$ std\+::string $>$ \mbox{\hyperlink{classMCMCProcessor_ae1d255f2216d4f4e9bc64c300d396d1e}{Get\+Osc\+Cov}} () const
\item 
void \mbox{\hyperlink{classMCMCProcessor_a5fc015740496b821648f0e5ca8cffe80}{Get\+Postfit}} (TVectorD $\ast$\&Central, TVectorD $\ast$\&\mbox{\hyperlink{classMCMCProcessor_a5174aaa900edf16ddc6e841ea4adae83}{Errors}}, TVectorD $\ast$\&Central\+\_\+\+Gauss, TVectorD $\ast$\&\mbox{\hyperlink{classMCMCProcessor_aa78b7ed1bb9966f84f4eaf8cedf5e688}{Errors\+\_\+\+Gauss}}, TVectorD $\ast$\&Peaks)
\begin{DoxyCompactList}\small\item\em Get the post-\/fit results (arithmetic and Gaussian) \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_ac9e4fdea5d2de92a1abad5b79b7daf88}{Get\+Covariance}} (TMatrix\+DSym $\ast$\&Cov, TMatrix\+DSym $\ast$\&Corr)
\begin{DoxyCompactList}\small\item\em Get the post-\/fit covariances and correlations. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a59fa9550b7c69c616929217ae89c2f42}{Get\+Postfit\+\_\+\+Ind}} (TVectorD $\ast$\&Central, TVectorD $\ast$\&\mbox{\hyperlink{classMCMCProcessor_a5174aaa900edf16ddc6e841ea4adae83}{Errors}}, TVectorD $\ast$\&Peaks, \mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20b}{Parameter\+Enum}} k\+Param)
\begin{DoxyCompactList}\small\item\em Or the individual post-\/fits. \end{DoxyCompactList}\item 
const std\+::vector$<$ TString $>$ \& \mbox{\hyperlink{classMCMCProcessor_a3905a8c1e333cb52a192c0cfaf1a0949}{Get\+Branch\+Names}} () const
\begin{DoxyCompactList}\small\item\em Get the vector of branch names from root file. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{Get\+Nth\+Parameter}} (const int param, double \&Prior, double \&Prior\+Error, TString \&Title)
\begin{DoxyCompactList}\small\item\em Get properties of parameter by passing it number. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classMCMCProcessor_a5ab91183fbbf23fff759fefc9954a1a5}{Get\+Param\+Index\+From\+Name}} (const std\+::string \&Name)
\begin{DoxyCompactList}\small\item\em Get parameter number based on name. \end{DoxyCompactList}\item 
Long64\+\_\+t \mbox{\hyperlink{classMCMCProcessor_a7f00ad66e9eb7a910ef6e9e081c4154d}{Getn\+Entries}} ()
\begin{DoxyCompactList}\small\item\em Get Number of entries that Chain has, for merged chains will not be the same Nsteps. \end{DoxyCompactList}\item 
Long64\+\_\+t \mbox{\hyperlink{classMCMCProcessor_aa2ebe9262f7f28778d92148164a54d4b}{Getn\+Steps}} ()
\begin{DoxyCompactList}\small\item\em Get Number of Steps that Chain has, for merged chains will not be the same n\+Entries. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_ad610d8e835031872b428e759ef4045f1}{Set\+Step\+Cut}} (const std\+::string \&Cuts)
\begin{DoxyCompactList}\small\item\em Set the step cutting by string. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a16f653dcb6358f2a8e393e3946a7e6d2}{Set\+Step\+Cut}} (const int Cuts)
\begin{DoxyCompactList}\small\item\em Set the step cutting by int. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a6ea549289949ac19d2fc768d82c8f1c9}{Set\+Plot\+Relative\+To\+Prior}} (const bool Plot\+Or\+Not)
\begin{DoxyCompactList}\small\item\em You can set relative to prior or relative to generated. It is advised to use relate to prior. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a9db87211d9f066011daed18af7f4631e}{Set\+Print\+To\+PDF}} (const bool Plot\+Or\+Not)
\item 
void \mbox{\hyperlink{classMCMCProcessor_adbe0ec06ce30447cb1c03a961364b929}{Set\+Plot\+Error\+For\+Flat\+Prior}} (const bool Plot\+Or\+Not)
\begin{DoxyCompactList}\small\item\em Set whether you want to plot error for parameters which have flat prior. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_aed120fafdfe97615f4c2a30aedde03dd}{Set\+Plot\+Bin\+Value}} (const bool Plot\+Or\+Not)
\item 
void \mbox{\hyperlink{classMCMCProcessor_a7f61cf0a51670f24f16dd7d77b7f5ae4}{Set\+Fancy\+Names}} (const bool Plot\+Or\+Not)
\item 
void \mbox{\hyperlink{classMCMCProcessor_a4bec41cdc9af977a51b269e2a07fe961}{Set\+Smoothing}} (const bool Plot\+Or\+Not)
\begin{DoxyCompactList}\small\item\em Set whether want to use smoothing for histograms using ROOT algorithm. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_ab605f4d7bf4e2b24b4c0b1c5853b479f}{Set\+Post2\+DPlot\+Threshold}} (const double Threshold)
\begin{DoxyCompactList}\small\item\em Code will only plot 2D posteriors if Correlation are larger than defined threshold. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a4364a8ab084906c8925c9db9dc110485}{Set\+Excluded\+Types}} (std\+::vector$<$ std\+::string $>$ Name)
\begin{DoxyCompactList}\small\item\em Setter related what parameters we want to exclude from analysis, for example if cross-\/section parameters look like xsec\+\_\+, then passing \char`\"{}xsec\+\_\+\char`\"{} will. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a09a6fa6cefcb20c00bee22c1dc5718c5}{Set\+Excluded\+Names}} (std\+::vector$<$ std\+::string $>$ Name)
\item 
void \mbox{\hyperlink{classMCMCProcessor_a5b13f1879f84d13b7d139432a9b993c6}{Setn\+Batches}} (const int Batches)
\begin{DoxyCompactList}\small\item\em Set value of Nbatches used for batched mean, this need to be done earlier as batches are made when reading tree. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a173d37d528ff201e66db8f92c156e3bb}{Setn\+Lags}} (const int n\+Lags)
\item 
void \mbox{\hyperlink{classMCMCProcessor_a2f4bf14c95b830c457a73be5399403ad}{Set\+Output\+Suffix}} (const std\+::string Suffix)
\begin{DoxyCompactList}\small\item\em Sett output suffix, this way jobs using the same file will have different names. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a641da7f5e018d48d480638fbad6406a4}{Set\+Posterior1\+DCut}} (const std\+::string Cut)
\end{DoxyCompactItemize}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
TH1D $\ast$ \mbox{\hyperlink{classMCMCProcessor_a03267ff95cb0f4dab0882db852893768}{Make\+Prefit}} ()
\begin{DoxyCompactList}\small\item\em Prepare prefit histogram for parameter overlay plot. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_aa5a7761e97cf2e24c7d877a5374b7333}{Make\+Output\+File}} ()
\begin{DoxyCompactList}\small\item\em prepare output root file and canvas to which we will save EVERYTHING \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a5b0961bcb0eea7a347e6a29ef7738d80}{Draw\+Correlations1D}} ()
\begin{DoxyCompactList}\small\item\em Draw 1D correlations which might be more helpful than looking at huge 2D Corr matrix. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_afef48d4fccf7551dc1845f8f6c08864f}{Read\+Input\+Cov}} ()
\begin{DoxyCompactList}\small\item\em CW\+: Read the input Covariance matrix entries. Get stuff like parameter input errors, names, and so on. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_aea15e730ff77556bb93bc4cff675744c}{Find\+Input\+Files}} ()
\begin{DoxyCompactList}\small\item\em Read the output MCMC file and find what inputs were used. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a2b0b4afbf45adb93357abe96d108170b}{Read\+XSec\+File}} ()
\begin{DoxyCompactList}\small\item\em Read the xsec file and get the input central values and errors. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a66dd0f1f88dbeb2b6a1976d42f77e136}{Read\+NDFile}} ()
\begin{DoxyCompactList}\small\item\em Read the ND cov file and get the input central values and errors. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_ae5ea421c8dd77ceac2e748008633b573}{Read\+FDFile}} ()
\begin{DoxyCompactList}\small\item\em Read the FD cov file and get the input central values and errors. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a3733b3b753c73f79e6846bc92c4da11b}{Read\+OSCFile}} ()
\begin{DoxyCompactList}\small\item\em Read the Osc cov file and get the input central values and errors. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a9a29c1cb64589ac136f7f927cafa18aa}{Remove\+Parameters}} ()
\begin{DoxyCompactList}\small\item\em Remove parameter specified in config. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_aeff2174617268c1e55333529459bffb6}{Scan\+Input}} ()
\begin{DoxyCompactList}\small\item\em Scan Input etc. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a015cf0d6925d026e5bd9d82aa31083b6}{Scan\+Parameter\+Order}} ()
\begin{DoxyCompactList}\small\item\em Scan order of params from a different groups. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_aa4761be1345f1be3defe162b278a9d8e}{Setup\+Output}} ()
\begin{DoxyCompactList}\small\item\em Prepare all objects used for output. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a930cadafa41b31b58066dea68628de9f}{Prepare\+Diag\+MCMC}} ()
\begin{DoxyCompactList}\small\item\em CW\+: Prepare branches etc. for Diag\+MCMC. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a929d6efec80bb4de05eea7011257439a}{Param\+Traces}} ()
\begin{DoxyCompactList}\small\item\em CW\+: Draw trace plots of the parameters i.\+e. parameter vs step. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a322bee0c362ba83df8c45769d299ce9f}{Auto\+Correlation}} ()
\begin{DoxyCompactList}\small\item\em KS\+: Calculate autocorrelations supports both Open\+MP and CUDA \+:) \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_add7add4eeddec946bad2645804aefd88}{Calculate\+ESS}} (const int n\+Lags, double $\ast$$\ast$LagL)
\begin{DoxyCompactList}\small\item\em KS\+: calc Effective Sample Size. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a29d492906e0c027d089331a0509cd2c3}{Batched\+Analysis}} ()
\begin{DoxyCompactList}\small\item\em Get the batched means variance estimation and variable indicating if number of batches is sensible \cite{chakraborty2019estimating} \cite{rossetti2024batch}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_af3658b8adee50f6ef5557ebbd1c87b8e}{Batched\+Means}} ()
\begin{DoxyCompactList}\small\item\em CW\+: Batched means, literally read from an array and chuck into TH1D. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a03b7c4bb9cd9a90aa7d284b0f1a6156b}{Geweke\+Diagnostic}} ()
\begin{DoxyCompactList}\small\item\em Geweke Diagnostic based on the methods described by Fang (2014) and Karlsbakk (2011). \cite{Fang2014GewekeDiagnostics} \cite{karlsbakk2011}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_a278b82fa945d847e57ae6ed6357d8f61}{Acceptance\+Probabilities}} ()
\begin{DoxyCompactList}\small\item\em Acceptance Probability. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classMCMCProcessor_aef760d8c4bb70690a5c4114f4b2409b3}{Power\+Spectrum\+Analysis}} ()
\begin{DoxyCompactList}\small\item\em RC\+: Perform spectral analysis of MCMC based on \cite{Dunkley:2004sv}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
std\+::string \mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}}
\begin{DoxyCompactList}\small\item\em Name of MCMC file. \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{classMCMCProcessor_aa34b50ce33fb2cb7d9e9ef2d9f2f67c1}{Output\+Suffix}}
\begin{DoxyCompactList}\small\item\em Output file suffix useful when running over same file with different settings. \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::vector$<$ std\+::string $>$ $>$ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{Cov\+Pos}}
\begin{DoxyCompactList}\small\item\em Covariance matrix name position. \end{DoxyCompactList}\item 
std\+::vector$<$ YAML\+::\+Node $>$ \mbox{\hyperlink{classMCMCProcessor_a4c1330a025c0b91e382bdc29c960424a}{Cov\+Config}}
\begin{DoxyCompactList}\small\item\em Covariance matrix config. \end{DoxyCompactList}\item 
TChain $\ast$ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}
\begin{DoxyCompactList}\small\item\em Main chain storing all steps etc. \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{classMCMCProcessor_a576f0eb874afaf7e31ff5c86b9e5b8f9}{Step\+Cut}}
\begin{DoxyCompactList}\small\item\em Burn\+In Cuts. \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{classMCMCProcessor_a85917e25c4f5b5b966c50cccd9ddd6a0}{Posterior1\+DCut}}
\begin{DoxyCompactList}\small\item\em Cut used when making 1D Posterior distribution. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classMCMCProcessor_a840c686f15f419c0156df01c4ed62931}{Upper\+Cut}}
\begin{DoxyCompactList}\small\item\em KS\+: Used only for Sub\+Optimality. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classMCMCProcessor_a22f82dadceccbe87dd8c5b7daa8432e8}{Burn\+In\+Cut}}
\begin{DoxyCompactList}\small\item\em Value of burn in cut. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classMCMCProcessor_af6ba5d9aec5350fafebbf81309e813cb}{n\+Branches}}
\begin{DoxyCompactList}\small\item\em Number of branches in a TTree. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{n\+Entries}}
\begin{DoxyCompactList}\small\item\em KS\+: For merged chains number of entries will be different from n\+Steps. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classMCMCProcessor_aae0016a4e1d105d5d65243438c622a97}{n\+Steps}}
\begin{DoxyCompactList}\small\item\em KS\+: For merged chains number of entries will be different from n\+Steps. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classMCMCProcessor_a419d3669dbb54a55a635e35691134cc1}{n\+Samples}}
\begin{DoxyCompactList}\small\item\em Number of sample PDF objects. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classMCMCProcessor_adf518be96278f1d3901404cfbe767b67}{n\+Systs}}
\begin{DoxyCompactList}\small\item\em Number of covariance objects. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{n\+Draw}}
\begin{DoxyCompactList}\small\item\em Number of all parameters used in the analysis. \end{DoxyCompactList}\item 
std\+::vector$<$ TString $>$ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{Branch\+Names}}
\item 
std\+::vector$<$ std\+::string $>$ \mbox{\hyperlink{classMCMCProcessor_aada4aadea10661586b46c1013a9d018f}{Excluded\+Types}}
\item 
std\+::vector$<$ std\+::string $>$ \mbox{\hyperlink{classMCMCProcessor_a7425f7802e50bcb5ff4b38e20157c423}{Excluded\+Names}}
\item 
std\+::vector$<$ bool $>$ \mbox{\hyperlink{classMCMCProcessor_a95fa49737432818bc830a44898d0d850}{Iam\+Varied}}
\begin{DoxyCompactList}\small\item\em Is the ith parameter varied. \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::vector$<$ TString $>$ $>$ \mbox{\hyperlink{classMCMCProcessor_adecc55689f7d37b9412f8886fe3480dc}{Param\+Names}}
\begin{DoxyCompactList}\small\item\em Name of parameters which we are going to analyse. \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::vector$<$ double $>$ $>$ \mbox{\hyperlink{classMCMCProcessor_a3a6614826ae320e462211e38e96d9d02}{Param\+Central}}
\begin{DoxyCompactList}\small\item\em Parameters central values which we are going to analyse. \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::vector$<$ double $>$ $>$ \mbox{\hyperlink{classMCMCProcessor_a4c4c6aa4827a2fe54ce37defbb3d0475}{Param\+Nom}}
\item 
std\+::vector$<$ std\+::vector$<$ double $>$ $>$ \mbox{\hyperlink{classMCMCProcessor_a3a97e3cb4be3ceb9eb721eac51d82d60}{Param\+Errors}}
\item 
std\+::vector$<$ std\+::vector$<$ bool $>$ $>$ \mbox{\hyperlink{classMCMCProcessor_a4be1eedb743e4ea410009a4fa45720f7}{Param\+Flat}}
\item 
std\+::vector$<$ int $>$ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{n\+Param}}
\begin{DoxyCompactList}\small\item\em Number of parameters per type. \end{DoxyCompactList}\item 
std\+::vector$<$ \mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20b}{Parameter\+Enum}} $>$ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{Param\+Type}}
\begin{DoxyCompactList}\small\item\em Make an enum for which class this parameter belongs to so we don\textquotesingle{}t have to keep string comparing. \end{DoxyCompactList}\item 
std\+::vector$<$ int $>$ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{Param\+Type\+Start\+Pos}}
\item 
std\+::vector$<$ bool $>$ \mbox{\hyperlink{classMCMCProcessor_a2c06d64020e9246e720cc131a9f4986d}{Is\+Xsec}}
\item 
int \mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{n\+Flux}}
\item 
std\+::vector$<$ TString $>$ \mbox{\hyperlink{classMCMCProcessor_a3660e404a6631cfa913a815481730a9b}{Sample\+Name\+\_\+v}}
\begin{DoxyCompactList}\small\item\em Vector of each systematic. \end{DoxyCompactList}\item 
std\+::vector$<$ TString $>$ \mbox{\hyperlink{classMCMCProcessor_acb1871575fdd3ae156aed4bf7c7a0a73}{Syst\+Name\+\_\+v}}
\begin{DoxyCompactList}\small\item\em Vector of each sample PDF object. \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{classMCMCProcessor_a3d17c1720b91d6d0361da0b5dabfbbff}{Output\+Name}}
\begin{DoxyCompactList}\small\item\em Name of output files. \end{DoxyCompactList}\item 
TString \mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{Canvas\+Name}}
\begin{DoxyCompactList}\small\item\em Name of canvas which help to save to the sample pdf. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classMCMCProcessor_ad24411a2556504c440ff0af045e8e7aa}{Plot\+Flat\+Prior}}
\begin{DoxyCompactList}\small\item\em Whether we plot flat prior or not, we usually provide error even for flat prior params. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classMCMCProcessor_af1392c6cff68e9f0a27e2c9a4e52cf4c}{Plot\+Jarlskog}}
\begin{DoxyCompactList}\small\item\em Will plot Jarlskog Invariant using information in the chain. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classMCMCProcessor_afbac2a114c15ca7db4abe71dd549504c}{plot\+Relative\+To\+Prior}}
\begin{DoxyCompactList}\small\item\em Whether we plot relative to prior or nominal, in most cases is prior. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classMCMCProcessor_aecc35d4ea7d2c7e020e50388ba0ffb64}{Made\+Postfit}}
\begin{DoxyCompactList}\small\item\em Sanity check if Postfit is already done to not make several times. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{print\+To\+PDF}}
\begin{DoxyCompactList}\small\item\em Will plot all plot to PDF not only to root file. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classMCMCProcessor_ad25fe818c94163b0c4a8fcdfd387c148}{Fancy\+Plot\+Names}}
\begin{DoxyCompactList}\small\item\em Whether we want fancy plot names or not. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classMCMCProcessor_aa7611f55ac3c0ea70607761d037fbd91}{plot\+Bin\+Value}}
\begin{DoxyCompactList}\small\item\em If true it will print value on each bin of covariance matrix. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classMCMCProcessor_a682c1c47626542f5820d633ba2bc010c}{Apply\+Smoothing}}
\begin{DoxyCompactList}\small\item\em Apply smoothing for 2D histos using root algorithm. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classMCMCProcessor_a25e4685b6299181021b02ac0e0b74681}{Post2\+DPlot\+Threshold}}
\begin{DoxyCompactList}\small\item\em KS\+: Set Threshold when to plot 2D posterior as by default we get a LOT of plots. \end{DoxyCompactList}\item 
std\+::vector$<$ int $>$ \mbox{\hyperlink{classMCMCProcessor_ae76b02ce85737d30c778698ba127933b}{NDSamples\+Bins}}
\item 
std\+::vector$<$ std\+::string $>$ \mbox{\hyperlink{classMCMCProcessor_a27c8a25155baab660fc9658861c433ab}{NDSamples\+Names}}
\item 
TF1 $\ast$ \mbox{\hyperlink{classMCMCProcessor_a92c1d9b0ebdf90951221cdaf2ac4cc2c}{Gauss}}
\begin{DoxyCompactList}\small\item\em Gaussian fitter. \end{DoxyCompactList}\item 
TFile $\ast$ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{Output\+File}}
\begin{DoxyCompactList}\small\item\em The output file. \end{DoxyCompactList}\item 
TCanvas $\ast$ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}
\begin{DoxyCompactList}\small\item\em Fancy canvas used for our beautiful plots. \end{DoxyCompactList}\item 
TVectorD $\ast$ \mbox{\hyperlink{classMCMCProcessor_aad661c6d53f9f891e18ff8ccdbd08479}{Central\+\_\+\+Value}}
\begin{DoxyCompactList}\small\item\em Vector with central value for each parameter. \end{DoxyCompactList}\item 
TVectorD $\ast$ \mbox{\hyperlink{classMCMCProcessor_acaf7f239136dfa3506d095b612323d0a}{Means}}
\begin{DoxyCompactList}\small\item\em Vector with mean values using Arithmetic Mean. \end{DoxyCompactList}\item 
TVectorD $\ast$ \mbox{\hyperlink{classMCMCProcessor_a5174aaa900edf16ddc6e841ea4adae83}{Errors}}
\begin{DoxyCompactList}\small\item\em Vector with errors values using RMS. \end{DoxyCompactList}\item 
TVectorD $\ast$ \mbox{\hyperlink{classMCMCProcessor_a600fc8c39af2750df91fb7a0ff85ac74}{Means\+\_\+\+Gauss}}
\begin{DoxyCompactList}\small\item\em Vector with mean values using Gaussian fit. \end{DoxyCompactList}\item 
TVectorD $\ast$ \mbox{\hyperlink{classMCMCProcessor_aa78b7ed1bb9966f84f4eaf8cedf5e688}{Errors\+\_\+\+Gauss}}
\begin{DoxyCompactList}\small\item\em Vector with error values using Gaussian fit. \end{DoxyCompactList}\item 
TVectorD $\ast$ \mbox{\hyperlink{classMCMCProcessor_a32657dc39a7fc0d04804f6195a3d8c3e}{Means\+\_\+\+HPD}}
\begin{DoxyCompactList}\small\item\em Vector with mean values using Highest Posterior Density. \end{DoxyCompactList}\item 
TVectorD $\ast$ \mbox{\hyperlink{classMCMCProcessor_abb5c6ad85c89227bbb9bc5de2eb71272}{Errors\+\_\+\+HPD}}
\begin{DoxyCompactList}\small\item\em Vector with error values using Highest Posterior Density. \end{DoxyCompactList}\item 
TVectorD $\ast$ \mbox{\hyperlink{classMCMCProcessor_af96664fa8cc51c49ad1385da07a343b8}{Errors\+\_\+\+HPD\+\_\+\+Positive}}
\begin{DoxyCompactList}\small\item\em Vector with positive error (right hand side) values using Highest Posterior Density. \end{DoxyCompactList}\item 
TVectorD $\ast$ \mbox{\hyperlink{classMCMCProcessor_a7b85df39f22390dac24f4d66a89518e5}{Errors\+\_\+\+HPD\+\_\+\+Negative}}
\begin{DoxyCompactList}\small\item\em Vector with negative error (left hand side) values using Highest Posterior Density. \end{DoxyCompactList}\item 
TMatrix\+DSym $\ast$ \mbox{\hyperlink{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}{Covariance}}
\begin{DoxyCompactList}\small\item\em Posterior Covariance Matrix. \end{DoxyCompactList}\item 
TMatrix\+DSym $\ast$ \mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}}
\begin{DoxyCompactList}\small\item\em Posterior Correlation Matrix. \end{DoxyCompactList}\item 
TH1D $\ast$$\ast$ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}
\begin{DoxyCompactList}\small\item\em Holds 1D Posterior Distributions. \end{DoxyCompactList}\item 
TH2D $\ast$$\ast$$\ast$ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}
\begin{DoxyCompactList}\small\item\em Holds 2D Posterior Distributions. \end{DoxyCompactList}\item 
TH2D $\ast$ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}
\begin{DoxyCompactList}\small\item\em Holds violin plot for all dials. \end{DoxyCompactList}\item 
TH2D $\ast$ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\+\_\+prior}}
\begin{DoxyCompactList}\small\item\em Holds prior violin plot for all dials,. \end{DoxyCompactList}\item 
double $\ast$$\ast$ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{Par\+Step}}
\begin{DoxyCompactList}\small\item\em Array holding values for all parameters. \end{DoxyCompactList}\item 
int $\ast$ \mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{Step\+Number}}
\begin{DoxyCompactList}\small\item\em Step number for step, important if chains were merged. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}{n\+Bins}}
\begin{DoxyCompactList}\small\item\em Number of bins. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classMCMCProcessor_a4abe633b264acd9b0459c7b8ccd8b9df}{Draw\+Range}}
\begin{DoxyCompactList}\small\item\em Drawrange for Set\+Maximum. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classMCMCProcessor_aea84f0315695aa05ec41fcf965b1b031}{Cache\+MCMC}}
\begin{DoxyCompactList}\small\item\em MCMC Chain has been cached. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classMCMCProcessor_adf449e50cf358f737fe4a2b65d9668e9}{do\+Diag\+MCMC}}
\begin{DoxyCompactList}\small\item\em Doing MCMC Diagnostic. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{n\+Batches}}
\begin{DoxyCompactList}\small\item\em Number of batches for Batched Mean. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classMCMCProcessor_a6156bba72e1f076e66f0356e48506a36}{Auto\+Corr\+Lag}}
\begin{DoxyCompactList}\small\item\em LagL used in Auto\+Correlation. \end{DoxyCompactList}\item 
double $\ast$ \mbox{\hyperlink{classMCMCProcessor_a7db98c7cf390b050f1acb927b4f55cab}{Param\+Sums}}
\begin{DoxyCompactList}\small\item\em Total parameter sum for each param. \end{DoxyCompactList}\item 
double $\ast$$\ast$ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{Batched\+Averages}}
\begin{DoxyCompactList}\small\item\em Values of batched average for every param and batch. \end{DoxyCompactList}\item 
double $\ast$$\ast$ \mbox{\hyperlink{classMCMCProcessor_a28e89498420221149ec97c353c430bf8}{Sample\+Values}}
\begin{DoxyCompactList}\small\item\em Holds the sample values. \end{DoxyCompactList}\item 
double $\ast$$\ast$ \mbox{\hyperlink{classMCMCProcessor_a4eb2748c81b0aef9bd7e14785559e301}{Syst\+Values}}
\begin{DoxyCompactList}\small\item\em Holds the systs values. \end{DoxyCompactList}\item 
double $\ast$ \mbox{\hyperlink{classMCMCProcessor_a88cab29770fd6098a674a0ab3628a251}{Acc\+Prob\+Values}}
\begin{DoxyCompactList}\small\item\em Holds all acc\+Prob. \end{DoxyCompactList}\item 
double $\ast$ \mbox{\hyperlink{classMCMCProcessor_a523a223a4754c133121796f4591c7be3}{Acc\+Prob\+Batched\+Averages}}
\begin{DoxyCompactList}\small\item\em Holds all acc\+Prob in batches. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Class responsible for processing MCMC chains, performing diagnostics, generating plots, and managing Bayesian analysis. 

This class provides utilities to handle MCMC output generated by \mbox{\hyperlink{classmcmc_a8a9cc0e0aa65c8573fca703a42b2ee31}{mcmc\+::run\+MCMC}}. It is particularly useful for extracting values from previous MCMC runs and initiating new MCMC runs with those values. Inspired by nd280\+\_\+utils/\+Draw\+Comp.\+cpp. \begin{DoxySeeAlso}{See also}
For more details and examples, visit the \href{https://github.com/mach3-software/MaCh3/wiki/09.-Bayesian-Analysis,-Plotting-and-MCMC-Processor}{\texttt{ Wiki}}. 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00062}{62}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classMCMCProcessor_afb50150dcb6d1d75f3c08b5ee8d3d77c}\label{classMCMCProcessor_afb50150dcb6d1d75f3c08b5ee8d3d77c}} 
\index{MCMCProcessor@{MCMCProcessor}!MCMCProcessor@{MCMCProcessor}}
\index{MCMCProcessor@{MCMCProcessor}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{MCMCProcessor()}{MCMCProcessor()}}
{\footnotesize\ttfamily MCMCProcessor\+::\+MCMCProcessor (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{Input\+File }\end{DoxyParamCaption})}



Constructs an \mbox{\hyperlink{classMCMCProcessor}{MCMCProcessor}} object with the specified input file and options. 


\begin{DoxyParams}{Parameters}
{\em Input\+File} & The path to the input file containing MCMC data. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l00015}{15}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00015\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :}
\DoxyCodeLine{00016\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}(\textcolor{keyword}{nullptr}),\ \mbox{\hyperlink{classMCMCProcessor_a576f0eb874afaf7e31ff5c86b9e5b8f9}{StepCut}}(\textcolor{stringliteral}{"{}"{}}),\ \mbox{\hyperlink{classMCMCProcessor_aecc35d4ea7d2c7e020e50388ba0ffb64}{MadePostfit}}(\textcolor{keyword}{false})\ \{}
\DoxyCodeLine{00017\ \textcolor{comment}{//\ ****************************}}
\DoxyCodeLine{00018\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}}\ =\ InputFile;}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_aa603c55ea73cd86d1994901227883e1e}{SetMaCh3LoggerFormat}}();}
\DoxyCodeLine{00021\ \ \ \mbox{\hyperlink{namespaceMaCh3Utils_ac6f4a3b6a7749967ff9a011469352f6c}{MaCh3Utils::MaCh3Welcome}}();}
\DoxyCodeLine{00022\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ post-\/fit\ processor\ for:\ \{\}"{}},\ \mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}});}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \ \ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00025\ \ \ \mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00026\ \ \ \ \ }
\DoxyCodeLine{00027\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00028\ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00029\ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00030\ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00031\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00034\ \ \ }
\DoxyCodeLine{00035\ \ \ \mbox{\hyperlink{classMCMCProcessor_a7db98c7cf390b050f1acb927b4f55cab}{ParamSums}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00036\ \ \ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00037\ \ \ \mbox{\hyperlink{classMCMCProcessor_a28e89498420221149ec97c353c430bf8}{SampleValues}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00038\ \ \ \mbox{\hyperlink{classMCMCProcessor_a4eb2748c81b0aef9bd7e14785559e301}{SystValues}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00039\ \ \ \mbox{\hyperlink{classMCMCProcessor_a88cab29770fd6098a674a0ab3628a251}{AccProbValues}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00040\ \ \ \mbox{\hyperlink{classMCMCProcessor_a523a223a4754c133121796f4591c7be3}{AccProbBatchedAverages}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00041\ \ \ \ \ }
\DoxyCodeLine{00042\ \ \ \textcolor{comment}{//KS:\ WARNING\ this\ only\ work\ when\ you\ project\ from\ Chain,\ will\ nor\ work\ when\ you\ try\ SetBranchAddress\ etc.\ Turn\ it\ on\ only\ if\ you\ know\ how\ to\ use\ it}}
\DoxyCodeLine{00043\ \ \ \mbox{\hyperlink{classMCMCProcessor_af1392c6cff68e9f0a27e2c9a4e52cf4c}{PlotJarlskog}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00044\ \ \ }
\DoxyCodeLine{00045\ \ \ \textcolor{comment}{//KS:Hardcoded\ should\ be\ a\ way\ to\ get\ it\ via\ config\ or\ something}}
\DoxyCodeLine{00046\ \ \ \mbox{\hyperlink{classMCMCProcessor_afbac2a114c15ca7db4abe71dd549504c}{plotRelativeToPrior}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00047\ \ \ \mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00048\ \ \ \mbox{\hyperlink{classMCMCProcessor_aa7611f55ac3c0ea70607761d037fbd91}{plotBinValue}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00049\ \ \ \mbox{\hyperlink{classMCMCProcessor_ad24411a2556504c440ff0af045e8e7aa}{PlotFlatPrior}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00050\ \ \ \mbox{\hyperlink{classMCMCProcessor_aea84f0315695aa05ec41fcf965b1b031}{CacheMCMC}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00051\ \ \ \mbox{\hyperlink{classMCMCProcessor_a682c1c47626542f5820d633ba2bc010c}{ApplySmoothing}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00052\ \ \ \mbox{\hyperlink{classMCMCProcessor_ad25fe818c94163b0c4a8fcdfd387c148}{FancyPlotNames}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00053\ \ \ \mbox{\hyperlink{classMCMCProcessor_adf449e50cf358f737fe4a2b65d9668e9}{doDiagMCMC}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00054\ \ \ \mbox{\hyperlink{classMCMCProcessor_aa34b50ce33fb2cb7d9e9ef2d9f2f67c1}{OutputSuffix}}\ =\ \textcolor{stringliteral}{"{}\_Process"{}};}
\DoxyCodeLine{00055\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25e4685b6299181021b02ac0e0b74681}{Post2DPlotThreshold}}\ =\ 1.e-\/5;}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}\ =\ 0;}
\DoxyCodeLine{00058\ \ \ \mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}}\ =\ 0;}
\DoxyCodeLine{00059\ \ \ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}\ =\ 0;}
\DoxyCodeLine{00060\ \ \ \mbox{\hyperlink{classMCMCProcessor_a840c686f15f419c0156df01c4ed62931}{UpperCut}}\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{00061\ \ \ \mbox{\hyperlink{classMCMCProcessor_aae0016a4e1d105d5d65243438c622a97}{nSteps}}\ =\ 0;}
\DoxyCodeLine{00062\ \ \ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}\ =\ 0;}
\DoxyCodeLine{00063\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6156bba72e1f076e66f0356e48506a36}{AutoCorrLag}}\ =\ 0;}
\DoxyCodeLine{00064\ \ \ \mbox{\hyperlink{classMCMCProcessor_adf518be96278f1d3901404cfbe767b67}{nSysts}}\ =\ 0;}
\DoxyCodeLine{00065\ \ \ \mbox{\hyperlink{classMCMCProcessor_a419d3669dbb54a55a635e35691134cc1}{nSamples}}\ =\ 0;}
\DoxyCodeLine{00066\ \ \ }
\DoxyCodeLine{00067\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}{nBins}}\ =\ 70;}
\DoxyCodeLine{00068\ \ \ \mbox{\hyperlink{classMCMCProcessor_a4abe633b264acd9b0459c7b8ccd8b9df}{DrawRange}}\ =\ 1.5;}
\DoxyCodeLine{00069\ \ \ }
\DoxyCodeLine{00070\ \ \ \mbox{\hyperlink{classMCMCProcessor_a85917e25c4f5b5b966c50cccd9ddd6a0}{Posterior1DCut}}\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00071\ \ \ \textcolor{comment}{//KS:Those\ keep\ basic\ information\ for\ ParameterEnum}}
\DoxyCodeLine{00072\ \ \ \mbox{\hyperlink{classMCMCProcessor_adecc55689f7d37b9412f8886fe3480dc}{ParamNames}}.resize(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a}{kNParameterEnum}});}
\DoxyCodeLine{00073\ \ \ \mbox{\hyperlink{classMCMCProcessor_a3a6614826ae320e462211e38e96d9d02}{ParamCentral}}.resize(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a}{kNParameterEnum}});}
\DoxyCodeLine{00074\ \ \ \mbox{\hyperlink{classMCMCProcessor_a4c4c6aa4827a2fe54ce37defbb3d0475}{ParamNom}}.resize(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a}{kNParameterEnum}});}
\DoxyCodeLine{00075\ \ \ \mbox{\hyperlink{classMCMCProcessor_a3a97e3cb4be3ceb9eb721eac51d82d60}{ParamErrors}}.resize(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a}{kNParameterEnum}});}
\DoxyCodeLine{00076\ \ \ \mbox{\hyperlink{classMCMCProcessor_a4be1eedb743e4ea410009a4fa45720f7}{ParamFlat}}.resize(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a}{kNParameterEnum}});}
\DoxyCodeLine{00077\ \ \ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}.resize(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a}{kNParameterEnum}});}
\DoxyCodeLine{00078\ \ \ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}.resize(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a}{kNParameterEnum}});}
\DoxyCodeLine{00079\ \ \ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}.resize(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a}{kNParameterEnum}});}
\DoxyCodeLine{00080\ \ \ \mbox{\hyperlink{classMCMCProcessor_a4c1330a025c0b91e382bdc29c960424a}{CovConfig}}.resize(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a}{kNParameterEnum}});}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a}{kNParameterEnum}};\ i++)}
\DoxyCodeLine{00083\ \ \ \{}
\DoxyCodeLine{00084\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[i]\ =\ 0;}
\DoxyCodeLine{00085\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[i]\ =\ 0;}
\DoxyCodeLine{00086\ \ \ \}}
\DoxyCodeLine{00087\ \ \ \textcolor{comment}{//Only\ if\ GPU\ is\ enabled}}
\DoxyCodeLine{00088\ \textcolor{preprocessor}{\ \ \#ifdef\ CUDA}}
\DoxyCodeLine{00089\ \ \ \ ParStep\_cpu\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00090\ \ \ \ NumeratorSum\_cpu\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00091\ \ \ \ ParamSums\_cpu\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00092\ \ \ \ DenomSum\_cpu\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ \ ParStep\_gpu\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00095\ \ \ \ NumeratorSum\_gpu\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00096\ \ \ \ ParamSums\_gpu\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00097\ \ \ \ DenomSum\_gpu\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00098\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{00099\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a50810cd50c5a4545bd5c1e486aae7b1c}\label{classMCMCProcessor_a50810cd50c5a4545bd5c1e486aae7b1c}} 
\index{MCMCProcessor@{MCMCProcessor}!````~MCMCProcessor@{$\sim$MCMCProcessor}}
\index{````~MCMCProcessor@{$\sim$MCMCProcessor}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{$\sim$MCMCProcessor()}{~MCMCProcessor()}}
{\footnotesize\ttfamily MCMCProcessor\+::$\sim$\+MCMCProcessor (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Destroys the \mbox{\hyperlink{classMCMCProcessor}{MCMCProcessor}} object. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l00103}{103}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00104\ \textcolor{comment}{//\ ****************************}}
\DoxyCodeLine{00105\ \ \ \textcolor{comment}{//\ Close\ the\ pdf\ file}}
\DoxyCodeLine{00106\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Closing\ pdf\ in\ MCMCProcessor:\ \{\}"{}},\ \mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}}.Data());}
\DoxyCodeLine{00107\ \ \ \mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}}\ +=\ \textcolor{stringliteral}{"{}]"{}};}
\DoxyCodeLine{00108\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{00109\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}\ !=\ \textcolor{keyword}{nullptr})\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}};}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a92c1d9b0ebdf90951221cdaf2ac4cc2c}{Gauss}};}
\DoxyCodeLine{00112\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}{Covariance}};}
\DoxyCodeLine{00113\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}};}
\DoxyCodeLine{00114\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_aad661c6d53f9f891e18ff8ccdbd08479}{Central\_Value}};}
\DoxyCodeLine{00115\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_acaf7f239136dfa3506d095b612323d0a}{Means}};}
\DoxyCodeLine{00116\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a5174aaa900edf16ddc6e841ea4adae83}{Errors}};}
\DoxyCodeLine{00117\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a600fc8c39af2750df91fb7a0ff85ac74}{Means\_Gauss}};}
\DoxyCodeLine{00118\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_aa78b7ed1bb9966f84f4eaf8cedf5e688}{Errors\_Gauss}};}
\DoxyCodeLine{00119\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a32657dc39a7fc0d04804f6195a3d8c3e}{Means\_HPD}};}
\DoxyCodeLine{00120\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_abb5c6ad85c89227bbb9bc5de2eb71272}{Errors\_HPD}};}
\DoxyCodeLine{00121\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_af96664fa8cc51c49ad1385da07a343b8}{Errors\_HPD\_Positive}};}
\DoxyCodeLine{00122\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a7b85df39f22390dac24f4d66a89518e5}{Errors\_HPD\_Negative}};}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}\ !=\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00125\ \ \ \{}
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ }
\DoxyCodeLine{00127\ \ \ \ \ \{}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i];}
\DoxyCodeLine{00129\ \ \ \ \ \}}
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}};}
\DoxyCodeLine{00131\ \ \ \}}
\DoxyCodeLine{00132\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aea84f0315695aa05ec41fcf965b1b031}{CacheMCMC}})}
\DoxyCodeLine{00133\ \ \ \{}
\DoxyCodeLine{00134\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ }
\DoxyCodeLine{00135\ \ \ \ \ \{}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ }
\DoxyCodeLine{00137\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j];}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[i];}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i];}
\DoxyCodeLine{00142\ \ \ \ \ \}}
\DoxyCodeLine{00143\ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}};}
\DoxyCodeLine{00144\ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}};}
\DoxyCodeLine{00145\ \ \ \}}
\DoxyCodeLine{00146\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}\ !=\ \textcolor{keyword}{nullptr})\ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}};}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00148\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}\ !=\ \textcolor{keyword}{nullptr})\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}};}
\DoxyCodeLine{00149\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}\ !=\ \textcolor{keyword}{nullptr})\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}};}
\DoxyCodeLine{00150\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}\ !=\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>Close();}
\DoxyCodeLine{00151\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}\ !=\ \textcolor{keyword}{nullptr})\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}};}
\DoxyCodeLine{00152\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}};}
\DoxyCodeLine{00153\ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classMCMCProcessor_a278b82fa945d847e57ae6ed6357d8f61}\label{classMCMCProcessor_a278b82fa945d847e57ae6ed6357d8f61}} 
\index{MCMCProcessor@{MCMCProcessor}!AcceptanceProbabilities@{AcceptanceProbabilities}}
\index{AcceptanceProbabilities@{AcceptanceProbabilities}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{AcceptanceProbabilities()}{AcceptanceProbabilities()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Acceptance\+Probabilities (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Acceptance Probability. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l04283}{4283}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{04283\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04284\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{04285\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a523a223a4754c133121796f4591c7be3}{AccProbBatchedAverages}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_a930cadafa41b31b58066dea68628de9f}{PrepareDiagMCMC}}();}
\DoxyCodeLine{04286\ }
\DoxyCodeLine{04287\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ AccProb\ plots..."{}});}
\DoxyCodeLine{04288\ }
\DoxyCodeLine{04289\ \ \ \textcolor{comment}{//\ Set\ the\ titles\ and\ limits\ for\ TH1Ds}}
\DoxyCodeLine{04290\ \ \ \textcolor{keyword}{auto}\ AcceptanceProbPlot\ =\ std::make\_unique<TH1D>(\textcolor{stringliteral}{"{}AcceptanceProbability"{}},\ \textcolor{stringliteral}{"{}Acceptance\ Probability"{}},\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{04291\ \ \ AcceptanceProbPlot-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Step"{}});}
\DoxyCodeLine{04292\ \ \ AcceptanceProbPlot-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Acceptance\ Probability"{}});}
\DoxyCodeLine{04293\ }
\DoxyCodeLine{04294\ \ \ \textcolor{keyword}{auto}\ BatchedAcceptanceProblot\ =\ std::make\_unique<TH1D>(\textcolor{stringliteral}{"{}AcceptanceProbability\_Batch"{}},\ \textcolor{stringliteral}{"{}AcceptanceProbability\_Batch"{}},\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}});}
\DoxyCodeLine{04295\ \ \ BatchedAcceptanceProblot-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Acceptance\ Probability"{}});}
\DoxyCodeLine{04296\ \ \ }
\DoxyCodeLine{04297\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}};\ ++i)\ \{}
\DoxyCodeLine{04298\ \ \ \ \ BatchedAcceptanceProblot-\/>SetBinContent(i+1,\ \mbox{\hyperlink{classMCMCProcessor_a523a223a4754c133121796f4591c7be3}{AccProbBatchedAverages}}[i]);}
\DoxyCodeLine{04299\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ BatchRangeLow\ =\ double(i)*double(\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}})/double(\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}});}
\DoxyCodeLine{04300\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ BatchRangeHigh\ =\ double(i+1)*double(\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}})/double(\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}});}
\DoxyCodeLine{04301\ \ \ \ \ std::stringstream\ ss;}
\DoxyCodeLine{04302\ \ \ \ \ ss\ <<\ BatchRangeLow\ <<\ \textcolor{stringliteral}{"{}\ -\/\ "{}}\ <<\ BatchRangeHigh;}
\DoxyCodeLine{04303\ \ \ \ \ BatchedAcceptanceProblot-\/>GetXaxis()-\/>SetBinLabel(i+1,\ ss.str().c\_str());}
\DoxyCodeLine{04304\ \ \ \}}
\DoxyCodeLine{04305\ \ \ }
\DoxyCodeLine{04306\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{04307\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{04308\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{04309\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++i)\ \{}
\DoxyCodeLine{04310\ \ \ \ \ \textcolor{comment}{//\ Set\ bin\ content\ for\ the\ i-\/th\ bin\ to\ the\ parameter\ values}}
\DoxyCodeLine{04311\ \ \ \ \ AcceptanceProbPlot-\/>SetBinContent(i,\ \mbox{\hyperlink{classMCMCProcessor_a88cab29770fd6098a674a0ab3628a251}{AccProbValues}}[i]);}
\DoxyCodeLine{04312\ \ \ \}}
\DoxyCodeLine{04313\ \ \ \ \ }
\DoxyCodeLine{04314\ \ \ TDirectory\ *probDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}AccProb"{}});}
\DoxyCodeLine{04315\ \ \ probDir-\/>cd();}
\DoxyCodeLine{04316\ \ \ }
\DoxyCodeLine{04317\ \ \ AcceptanceProbPlot-\/>Write();}
\DoxyCodeLine{04318\ \ \ BatchedAcceptanceProblot-\/>Write();}
\DoxyCodeLine{04319\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a88cab29770fd6098a674a0ab3628a251}{AccProbValues}};}
\DoxyCodeLine{04320\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a523a223a4754c133121796f4591c7be3}{AccProbBatchedAverages}};}
\DoxyCodeLine{04321\ }
\DoxyCodeLine{04322\ \ \ probDir-\/>Close();}
\DoxyCodeLine{04323\ \ \ \textcolor{keyword}{delete}\ probDir;}
\DoxyCodeLine{04324\ }
\DoxyCodeLine{04325\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{04326\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a322bee0c362ba83df8c45769d299ce9f}\label{classMCMCProcessor_a322bee0c362ba83df8c45769d299ce9f}} 
\index{MCMCProcessor@{MCMCProcessor}!AutoCorrelation@{AutoCorrelation}}
\index{AutoCorrelation@{AutoCorrelation}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{AutoCorrelation()}{AutoCorrelation()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Auto\+Correlation (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



KS\+: Calculate autocorrelations supports both Open\+MP and CUDA \+:) 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l03509}{3509}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{03509\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03510\ \textcolor{comment}{//\ *********************************}}
\DoxyCodeLine{03511\ }
\DoxyCodeLine{03512\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_a930cadafa41b31b58066dea68628de9f}{PrepareDiagMCMC}}();}
\DoxyCodeLine{03513\ }
\DoxyCodeLine{03514\ \ \ TStopwatch\ clock;}
\DoxyCodeLine{03515\ \ \ clock.Start();}
\DoxyCodeLine{03516\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nLags\ =\ \mbox{\hyperlink{classMCMCProcessor_a6156bba72e1f076e66f0356e48506a36}{AutoCorrLag}};}
\DoxyCodeLine{03517\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ auto-\/correlations\ for\ nLags\ =\ \{\}"{}},\ nLags);}
\DoxyCodeLine{03518\ }
\DoxyCodeLine{03519\ \ \ \textcolor{comment}{//\ The\ sum\ of\ (Y-\/Ymean)\string^2\ over\ all\ steps\ for\ each\ parameter}}
\DoxyCodeLine{03520\ \ \ \textcolor{keywordtype}{double}\ **DenomSum\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}]();}
\DoxyCodeLine{03521\ \ \ \textcolor{keywordtype}{double}\ **NumeratorSum\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}]();}
\DoxyCodeLine{03522\ \ \ \textcolor{keywordtype}{double}\ **LagL\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}];}
\DoxyCodeLine{03523\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{03524\ \ \ \ \ DenomSum[j]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[nLags];}
\DoxyCodeLine{03525\ \ \ \ \ NumeratorSum[j]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[nLags];}
\DoxyCodeLine{03526\ \ \ \ \ LagL[j]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[nLags];}
\DoxyCodeLine{03527\ \ \ \}}
\DoxyCodeLine{03528\ \ \ TH1D**\ LagKPlots\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}];}
\DoxyCodeLine{03529\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ parameters\ of\ interest}}
\DoxyCodeLine{03530\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{03531\ \ \ \{}
\DoxyCodeLine{03532\ \ \ \ \ \textcolor{comment}{//\ Loop\ over\ each\ lag}}
\DoxyCodeLine{03533\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ nLags;\ ++k)\ \{}
\DoxyCodeLine{03534\ \ \ \ \ \ \ NumeratorSum[j][k]\ =\ 0.0;}
\DoxyCodeLine{03535\ \ \ \ \ \ \ DenomSum[j][k]\ =\ 0.0;}
\DoxyCodeLine{03536\ \ \ \ \ \ \ LagL[j][k]\ =\ 0.0;}
\DoxyCodeLine{03537\ \ \ \ \ \}}
\DoxyCodeLine{03538\ }
\DoxyCodeLine{03539\ \ \ \ \ \textcolor{comment}{//\ Make\ TH1Ds\ for\ each\ parameter\ which\ hold\ the\ lag}}
\DoxyCodeLine{03540\ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{03541\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{03542\ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{03543\ \ \ \ \ }
\DoxyCodeLine{03544\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(j,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{03545\ \ \ \ \ std::string\ HistName\ =\ Form(\textcolor{stringliteral}{"{}\%s\_\%s\_Lag"{}},\ Title.Data(),\ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[j].Data());}
\DoxyCodeLine{03546\ \ \ \ \ LagKPlots[j]\ =\ \textcolor{keyword}{new}\ TH1D(HistName.c\_str(),\ HistName.c\_str(),\ nLags,\ 0.0,\ nLags);}
\DoxyCodeLine{03547\ \ \ \ \ LagKPlots[j]-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Lag"{}});}
\DoxyCodeLine{03548\ \ \ \ \ LagKPlots[j]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Auto-\/correlation\ function"{}});}
\DoxyCodeLine{03549\ \ \ \}}
\DoxyCodeLine{03550\ \textcolor{comment}{//KS:\ If\ CUDA\ is\ not\ enabled\ do\ calculations\ on\ CPU}}
\DoxyCodeLine{03551\ \textcolor{preprocessor}{\#ifndef\ CUDA}}
\DoxyCodeLine{03552\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ lags}}
\DoxyCodeLine{03553\ \ \ \textcolor{comment}{//CW:\ Each\ lag\ is\ independent\ so\ might\ as\ well\ multi-\/thread\ them!}}
\DoxyCodeLine{03554\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{03555\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Using\ multi-\/threading..."{}});}
\DoxyCodeLine{03556\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for\ collapse(2)}}
\DoxyCodeLine{03557\ \textcolor{preprocessor}{\ \ \#endif\ \ \ \ \ \ }\textcolor{comment}{//\ Loop\ over\ the\ number\ of\ parameters}}
\DoxyCodeLine{03558\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{03559\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ nLags;\ ++k)\ \{}
\DoxyCodeLine{03560\ \ \ \ \ \ \ \textcolor{comment}{//\ Loop\ over\ the\ number\ of\ entries}}
\DoxyCodeLine{03561\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++i)\ \{}
\DoxyCodeLine{03562\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Diff\ =\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i]-\/\mbox{\hyperlink{classMCMCProcessor_a7db98c7cf390b050f1acb927b4f55cab}{ParamSums}}[j];}
\DoxyCodeLine{03563\ }
\DoxyCodeLine{03564\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Only\ sum\ the\ numerator\ up\ to\ i\ =\ N-\/k}}
\DoxyCodeLine{03565\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}-\/k)\ \{}
\DoxyCodeLine{03566\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ LagTerm\ =\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i+k]-\/\mbox{\hyperlink{classMCMCProcessor_a7db98c7cf390b050f1acb927b4f55cab}{ParamSums}}[j];}
\DoxyCodeLine{03567\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Product\ =\ Diff*LagTerm;}
\DoxyCodeLine{03568\ \ \ \ \ \ \ \ \ \ \ NumeratorSum[j][k]\ +=\ Product;}
\DoxyCodeLine{03569\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03570\ }
\DoxyCodeLine{03571\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Square\ the\ difference\ to\ form\ the\ denominator}}
\DoxyCodeLine{03572\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Denom\ =\ Diff*Diff;}
\DoxyCodeLine{03573\ \ \ \ \ \ \ \ \ DenomSum[j][k]\ +=\ Denom;}
\DoxyCodeLine{03574\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03575\ \ \ \ \ \}}
\DoxyCodeLine{03576\ \ \ \}}
\DoxyCodeLine{03577\ \textcolor{preprocessor}{\#else\ }\textcolor{comment}{//NOW\ GPU\ specific\ code}}
\DoxyCodeLine{03578\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Using\ GPU"{}});}
\DoxyCodeLine{03579\ \ \ \textcolor{comment}{//KS:\ This\ allocates\ memory\ and\ copy\ data\ from\ CPU\ to\ GPU}}
\DoxyCodeLine{03580\ \ \ PrepareGPU\_AutoCorr(nLags);}
\DoxyCodeLine{03581\ }
\DoxyCodeLine{03582\ \ \ \textcolor{comment}{//KS:\ This\ runs\ the\ main\ kernel\ and\ copy\ results\ back\ to\ CPU}}
\DoxyCodeLine{03583\ \ \ \mbox{\hyperlink{gpuMCMCProcessorUtils_8cu_a809672193d24a096e6d4865109357070}{RunGPU\_AutoCorr}}(}
\DoxyCodeLine{03584\ \ \ \ \ ParStep\_gpu,}
\DoxyCodeLine{03585\ \ \ \ \ ParamSums\_gpu,}
\DoxyCodeLine{03586\ \ \ \ \ NumeratorSum\_gpu,}
\DoxyCodeLine{03587\ \ \ \ \ DenomSum\_gpu,}
\DoxyCodeLine{03588\ \ \ \ \ NumeratorSum\_cpu,}
\DoxyCodeLine{03589\ \ \ \ \ DenomSum\_cpu);}
\DoxyCodeLine{03590\ }
\DoxyCodeLine{03591\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{03592\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for\ collapse(2)}}
\DoxyCodeLine{03593\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{03594\ \ \ \textcolor{comment}{//KS:\ Now\ that\ that\ we\ received\ data\ from\ GPU\ convert\ it\ to\ CPU-\/like\ format}}
\DoxyCodeLine{03595\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{03596\ \ \ \{}
\DoxyCodeLine{03597\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ nLags;\ ++k)}
\DoxyCodeLine{03598\ \ \ \ \ \{}
\DoxyCodeLine{03599\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ temp\_index\ =\ j*nLags+k;}
\DoxyCodeLine{03600\ \ \ \ \ \ \ NumeratorSum[j][k]\ =\ NumeratorSum\_cpu[temp\_index];}
\DoxyCodeLine{03601\ \ \ \ \ \ \ DenomSum[j][k]\ =\ DenomSum\_cpu[temp\_index];}
\DoxyCodeLine{03602\ \ \ \ \ \}}
\DoxyCodeLine{03603\ \ \ \}}
\DoxyCodeLine{03604\ \ \ \textcolor{comment}{//delete\ auxiliary\ variables}}
\DoxyCodeLine{03605\ \ \ \textcolor{keyword}{delete}[]\ NumeratorSum\_cpu;}
\DoxyCodeLine{03606\ \ \ \textcolor{keyword}{delete}[]\ DenomSum\_cpu;}
\DoxyCodeLine{03607\ \ \ \textcolor{keyword}{delete}[]\ ParStep\_cpu;}
\DoxyCodeLine{03608\ \ \ \textcolor{keyword}{delete}[]\ ParamSums\_cpu;}
\DoxyCodeLine{03609\ }
\DoxyCodeLine{03610\ \ \ \textcolor{comment}{//KS:\ Delete\ stuff\ at\ GPU\ as\ well}}
\DoxyCodeLine{03611\ \ \ \mbox{\hyperlink{gpuMCMCProcessorUtils_8cu_abb46837d774b5be81a6c601c762ab05a}{CleanupGPU\_AutoCorr}}(}
\DoxyCodeLine{03612\ \ \ \ \ \ \ ParStep\_gpu,}
\DoxyCodeLine{03613\ \ \ \ \ \ \ NumeratorSum\_gpu,}
\DoxyCodeLine{03614\ \ \ \ \ \ \ ParamSums\_gpu,}
\DoxyCodeLine{03615\ \ \ \ \ \ \ DenomSum\_gpu);}
\DoxyCodeLine{03616\ }
\DoxyCodeLine{03617\ \textcolor{comment}{//KS:\ End\ of\ GPU\ specific\ code}}
\DoxyCodeLine{03618\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03619\ }
\DoxyCodeLine{03620\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{03621\ \ \ TDirectory\ *AutoCorrDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}Auto\_corr"{}});}
\DoxyCodeLine{03622\ \ \ \textcolor{comment}{//\ Now\ fill\ the\ LagK\ auto-\/correlation\ plots}}
\DoxyCodeLine{03623\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{03624\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ nLags;\ ++k)\ \{}
\DoxyCodeLine{03625\ \ \ \ \ \ \ LagL[j][k]\ =\ NumeratorSum[j][k]/DenomSum[j][k];}
\DoxyCodeLine{03626\ \ \ \ \ \ \ LagKPlots[j]-\/>SetBinContent(k,\ NumeratorSum[j][k]/DenomSum[j][k]);}
\DoxyCodeLine{03627\ \ \ \ \ \}}
\DoxyCodeLine{03628\ \ \ \ \ AutoCorrDir-\/>cd();}
\DoxyCodeLine{03629\ \ \ \ \ LagKPlots[j]-\/>Write();}
\DoxyCodeLine{03630\ \ \ \ \ \textcolor{keyword}{delete}\ LagKPlots[j];}
\DoxyCodeLine{03631\ \ \ \}}
\DoxyCodeLine{03632\ \ \ \textcolor{keyword}{delete}[]\ LagKPlots;}
\DoxyCodeLine{03633\ }
\DoxyCodeLine{03634\ \ \ \textcolor{comment}{//KS:\ This\ is\ different\ diagnostic\ however\ it\ relies\ on\ calculated\ Lag,\ thus\ we\ call\ it\ before\ we\ delete\ LagKPlots}}
\DoxyCodeLine{03635\ \ \ \mbox{\hyperlink{classMCMCProcessor_add7add4eeddec946bad2645804aefd88}{CalculateESS}}(nLags,\ LagL);}
\DoxyCodeLine{03636\ }
\DoxyCodeLine{03637\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{03638\ \ \ \ \ \textcolor{keyword}{delete}[]\ NumeratorSum[j];}
\DoxyCodeLine{03639\ \ \ \ \ \textcolor{keyword}{delete}[]\ DenomSum[j];}
\DoxyCodeLine{03640\ \ \ \ \ \textcolor{keyword}{delete}[]\ LagL[j];}
\DoxyCodeLine{03641\ \ \ \}}
\DoxyCodeLine{03642\ \ \ \textcolor{keyword}{delete}[]\ NumeratorSum;}
\DoxyCodeLine{03643\ \ \ \textcolor{keyword}{delete}[]\ DenomSum;}
\DoxyCodeLine{03644\ \ \ \textcolor{keyword}{delete}[]\ LagL;}
\DoxyCodeLine{03645\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a7db98c7cf390b050f1acb927b4f55cab}{ParamSums}};}
\DoxyCodeLine{03646\ }
\DoxyCodeLine{03647\ \ \ AutoCorrDir-\/>Close();}
\DoxyCodeLine{03648\ \ \ \textcolor{keyword}{delete}\ AutoCorrDir;}
\DoxyCodeLine{03649\ }
\DoxyCodeLine{03650\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{03651\ }
\DoxyCodeLine{03652\ \ \ clock.Stop();}
\DoxyCodeLine{03653\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ auto-\/correlations\ took\ \{:.2f\}s"{}},\ clock.RealTime());}
\DoxyCodeLine{03654\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a29d492906e0c027d089331a0509cd2c3}\label{classMCMCProcessor_a29d492906e0c027d089331a0509cd2c3}} 
\index{MCMCProcessor@{MCMCProcessor}!BatchedAnalysis@{BatchedAnalysis}}
\index{BatchedAnalysis@{BatchedAnalysis}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{BatchedAnalysis()}{BatchedAnalysis()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Batched\+Analysis (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Get the batched means variance estimation and variable indicating if number of batches is sensible \cite{chakraborty2019estimating} \cite{rossetti2024batch}. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l03905}{3905}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{03905\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03906\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{03907\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}\ ==\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{03908\ \ \ \{}
\DoxyCodeLine{03909\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}BatchedAverages\ haven't\ been\ initialises\ or\ have\ been\ deleted\ something\ is\ wrong"{}});}
\DoxyCodeLine{03910\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}I\ need\ it\ and\ refuse\ to\ go\ further"{}});}
\DoxyCodeLine{03911\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{03912\ \ \ \}}
\DoxyCodeLine{03913\ }
\DoxyCodeLine{03914\ \ \ \textcolor{comment}{//\ Calculate\ variance\ estimator\ using\ batched\ means\ following\ @cite\ chakraborty2019estimating\ see\ Eq.\ 1.2}}
\DoxyCodeLine{03915\ \ \ TVectorD*\ BatchedVariance\ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{03916\ \ \ \textcolor{comment}{//KS:\ The\ hypothesis\ is\ rejected\ if\ C\ >\ z\ α\ for\ a\ given\ confidence\ level\ α.\ If\ the\ batch\ means\ do\ not\ pass\ the\ test,\ Correlated\ is\ reported\ for\ the\ half-\/width\ on\ the\ statistical\ reports\ following\ @cite\ rossetti2024batch\ alternatively\ for\ more\ old-\/school\ see\ Alexopoulos\ and\ Seila\ 1998\ section\ 3.4.3}}
\DoxyCodeLine{03917\ \ \ TVectorD*\ C\_Test\_Statistics\ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{03918\ \ }
\DoxyCodeLine{03919\ \ \ std::vector<double>\ OverallBatchMean(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{03920\ \ \ std::vector<double>\ C\_Rho\_Nominator(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{03921\ \ \ std::vector<double>\ C\_Rho\_Denominator(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{03922\ \ \ std::vector<double>\ C\_Nominator(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{03923\ \ \ std::vector<double>\ C\_Denominator(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{03924\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ BatchLength\ =\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}/\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}+1;}
\DoxyCodeLine{03925\ \textcolor{comment}{//KS:\ Start\ parallel\ region}}
\DoxyCodeLine{03926\ \textcolor{preprocessor}{\#ifdef\ MULTITHREAD}}
\DoxyCodeLine{03927\ \textcolor{preprocessor}{\#pragma\ omp\ parallel}}
\DoxyCodeLine{03928\ \{}
\DoxyCodeLine{03929\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03930\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{03931\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ for}}
\DoxyCodeLine{03932\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{03933\ \ \ \textcolor{comment}{//KS:\ First\ calculate\ mean\ of\ batched\ means\ for\ each\ param\ and\ Initialise\ everything\ to\ 0}}
\DoxyCodeLine{03934\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{03935\ \ \ \{}
\DoxyCodeLine{03936\ \ \ \ \ OverallBatchMean[j]\ =\ 0.0;}
\DoxyCodeLine{03937\ \ \ \ \ C\_Rho\_Nominator[j]\ =\ 0.0;}
\DoxyCodeLine{03938\ \ \ \ \ C\_Rho\_Denominator[j]\ =\ 0.0;}
\DoxyCodeLine{03939\ \ \ \ \ C\_Nominator[j]\ =\ 0.0;}
\DoxyCodeLine{03940\ \ \ \ \ C\_Denominator[j]\ =\ 0.0;}
\DoxyCodeLine{03941\ }
\DoxyCodeLine{03942\ \ \ \ \ (*BatchedVariance)(j)\ =\ 0.0;}
\DoxyCodeLine{03943\ \ \ \ \ (*C\_Test\_Statistics)(j)\ =\ 0.0;}
\DoxyCodeLine{03944\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}};\ ++i)}
\DoxyCodeLine{03945\ \ \ \ \ \{}
\DoxyCodeLine{03946\ \ \ \ \ \ \ OverallBatchMean[j]\ +=\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i][j];}
\DoxyCodeLine{03947\ \ \ \ \ \}}
\DoxyCodeLine{03948\ \ \ \ \ OverallBatchMean[j]\ /=\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}};}
\DoxyCodeLine{03949\ \ \ \}}
\DoxyCodeLine{03950\ }
\DoxyCodeLine{03951\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{03952\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ for\ nowait}}
\DoxyCodeLine{03953\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{03954\ \ \ \textcolor{comment}{//KS:\ next\ loop\ is\ completely\ independent\ thus\ nowait\ clause}}
\DoxyCodeLine{03955\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{03956\ \ \ \{}
\DoxyCodeLine{03957\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}};\ ++i)}
\DoxyCodeLine{03958\ \ \ \ \ \{}
\DoxyCodeLine{03959\ \ \ \ \ \ \ (*BatchedVariance)(j)\ +=\ (OverallBatchMean[j]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i][j])*(OverallBatchMean[j]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i][j]);}
\DoxyCodeLine{03960\ \ \ \ \ \}}
\DoxyCodeLine{03961\ \ \ \ \ (*BatchedVariance)(j)\ =\ (BatchLength/(\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}-\/1))*\ (*BatchedVariance)(j);}
\DoxyCodeLine{03962\ \ \ \}}
\DoxyCodeLine{03963\ \ \ }
\DoxyCodeLine{03964\ \ \ \textcolor{comment}{//KS:\ Now\ we\ focus\ on\ C\ test\ statistic,\ again\ use\ nowait\ as\ next\ is\ calculation\ is\ independent}}
\DoxyCodeLine{03965\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{03966\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ for\ nowait}}
\DoxyCodeLine{03967\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{03968\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{03969\ \ \ \{}
\DoxyCodeLine{03970\ \ \ \ \ C\_Nominator[j]\ =\ (OverallBatchMean[j]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[0][j])*(OverallBatchMean[j]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[0][j])\ +\ }
\DoxyCodeLine{03971\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (OverallBatchMean[j]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}-\/1][j])*(OverallBatchMean[j]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}-\/1][j]);}
\DoxyCodeLine{03972\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}};\ ++i)}
\DoxyCodeLine{03973\ \ \ \ \ \{}
\DoxyCodeLine{03974\ \ \ \ \ \ \ C\_Denominator[j]\ +=\ (OverallBatchMean[j]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i][j])*(OverallBatchMean[j]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i][j]);}
\DoxyCodeLine{03975\ \ \ \ \ \}}
\DoxyCodeLine{03976\ \ \ \ \ C\_Denominator[j]\ =\ 2*C\_Denominator[j];}
\DoxyCodeLine{03977\ \ \ \}}
\DoxyCodeLine{03978\ \ \ }
\DoxyCodeLine{03979\ \ \ \textcolor{comment}{//KS:\ We\ still\ calculate\ C\ and\ for\ this\ we\ need\ rho\ wee\ need\ autocorrelations\ between\ batches}}
\DoxyCodeLine{03980\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{03981\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ for}}
\DoxyCodeLine{03982\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{03983\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{03984\ \ \ \{}
\DoxyCodeLine{03985\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}-\/1;\ ++i)}
\DoxyCodeLine{03986\ \ \ \ \ \{}
\DoxyCodeLine{03987\ \ \ \ \ \ \ C\_Rho\_Nominator[j]\ +=\ (OverallBatchMean[j]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i][j])*(OverallBatchMean[j]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i+1][j]);}
\DoxyCodeLine{03988\ \ \ \ \ \}}
\DoxyCodeLine{03989\ \ \ \ \ }
\DoxyCodeLine{03990\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}};\ ++i)}
\DoxyCodeLine{03991\ \ \ \ \ \{}
\DoxyCodeLine{03992\ \ \ \ \ \ \ C\_Rho\_Denominator[j]\ +=\ (OverallBatchMean[j]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i][j])*(OverallBatchMean[j]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i][j]);}
\DoxyCodeLine{03993\ \ \ \ \ \}}
\DoxyCodeLine{03994\ \ \ \}}
\DoxyCodeLine{03995\ \ \ }
\DoxyCodeLine{03996\ \ \ \textcolor{comment}{//KS:\ Final\ calculations\ of\ C}}
\DoxyCodeLine{03997\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{03998\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ for}}
\DoxyCodeLine{03999\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{04000\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{04001\ \ \ \{}
\DoxyCodeLine{04002\ \ \ \ \ (*C\_Test\_Statistics)(j)\ =\ std::sqrt((\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}*\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}\ -\/\ 1)/(\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}-\/2))\ *\ (\ C\_Rho\_Nominator[j]/C\_Rho\_Denominator[j]\ +\ C\_Nominator[j]/\ C\_Denominator[j]);}
\DoxyCodeLine{04003\ \ \ \}}
\DoxyCodeLine{04004\ \textcolor{preprocessor}{\#ifdef\ MULTITHREAD}}
\DoxyCodeLine{04005\ \}\ \textcolor{comment}{//End\ parallel\ region}}
\DoxyCodeLine{04006\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04007\ }
\DoxyCodeLine{04008\ \ \ \textcolor{comment}{//Save\ to\ file}}
\DoxyCodeLine{04009\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{04010\ \ \ BatchedVariance-\/>Write(\textcolor{stringliteral}{"{}BatchedMeansVariance"{}});}
\DoxyCodeLine{04011\ \ \ C\_Test\_Statistics-\/>Write(\textcolor{stringliteral}{"{}C\_Test\_Statistics"{}});}
\DoxyCodeLine{04012\ }
\DoxyCodeLine{04013\ \ \ \textcolor{comment}{//Delete\ all\ variables}}
\DoxyCodeLine{04014\ \ \ \textcolor{keyword}{delete}\ BatchedVariance;}
\DoxyCodeLine{04015\ \ \ \textcolor{keyword}{delete}\ C\_Test\_Statistics;}
\DoxyCodeLine{04016\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_af3658b8adee50f6ef5557ebbd1c87b8e}\label{classMCMCProcessor_af3658b8adee50f6ef5557ebbd1c87b8e}} 
\index{MCMCProcessor@{MCMCProcessor}!BatchedMeans@{BatchedMeans}}
\index{BatchedMeans@{BatchedMeans}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{BatchedMeans()}{BatchedMeans()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Batched\+Means (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



CW\+: Batched means, literally read from an array and chuck into TH1D. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l03844}{3844}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{03844\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03845\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{03846\ }
\DoxyCodeLine{03847\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_a930cadafa41b31b58066dea68628de9f}{PrepareDiagMCMC}}();}
\DoxyCodeLine{03848\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ BatchedMeans\ plots..."{}});}
\DoxyCodeLine{03849\ \ \ }
\DoxyCodeLine{03850\ \ \ TH1D\ **\ BatchedParamPlots\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}];}
\DoxyCodeLine{03851\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{03852\ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{03853\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{03854\ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{03855\ \ \ \ \ }
\DoxyCodeLine{03856\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(j,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{03857\ \ \ \ \ }
\DoxyCodeLine{03858\ \ \ \ \ std::string\ HistName\ =\ Form(\textcolor{stringliteral}{"{}\%s\_\%s\_batch"{}},\ Title.Data(),\ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[j].Data());}
\DoxyCodeLine{03859\ \ \ \ \ BatchedParamPlots[j]\ =\ \textcolor{keyword}{new}\ TH1D(HistName.c\_str(),\ HistName.c\_str(),\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}});}
\DoxyCodeLine{03860\ \ \ \}}
\DoxyCodeLine{03861\ }
\DoxyCodeLine{03862\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{03863\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{03864\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{03865\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{03866\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}};\ ++i)\ \{}
\DoxyCodeLine{03867\ \ \ \ \ \ \ BatchedParamPlots[j]-\/>SetBinContent(i+1,\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i][j]);}
\DoxyCodeLine{03868\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ BatchRangeLow\ =\ double(i)*double(\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}})/double(\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}});}
\DoxyCodeLine{03869\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ BatchRangeHigh\ =\ double(i+1)*double(\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}})/double(\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}});}
\DoxyCodeLine{03870\ \ \ \ \ \ \ std::stringstream\ ss;}
\DoxyCodeLine{03871\ \ \ \ \ \ \ ss\ <<\ BatchRangeLow\ <<\ \textcolor{stringliteral}{"{}\ -\/\ "{}}\ <<\ BatchRangeHigh;}
\DoxyCodeLine{03872\ \ \ \ \ \ \ BatchedParamPlots[j]-\/>GetXaxis()-\/>SetBinLabel(i+1,\ ss.str().c\_str());}
\DoxyCodeLine{03873\ \ \ \ \ \}}
\DoxyCodeLine{03874\ \ \ \}}
\DoxyCodeLine{03875\ }
\DoxyCodeLine{03876\ \ \ TDirectory\ *BatchDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}Batched\_means"{}});}
\DoxyCodeLine{03877\ \ \ BatchDir-\/>cd();}
\DoxyCodeLine{03878\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{03879\ \ \ \ \ TF1\ *Fitter\ =\ \textcolor{keyword}{new}\ TF1(\textcolor{stringliteral}{"{}Fitter"{}},\textcolor{stringliteral}{"{}[0]"{}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}});}
\DoxyCodeLine{03880\ \ \ \ \ Fitter-\/>SetLineColor(kRed);}
\DoxyCodeLine{03881\ \ \ \ \ BatchedParamPlots[j]-\/>Fit(\textcolor{stringliteral}{"{}Fitter"{}},\textcolor{stringliteral}{"{}Rq"{}});}
\DoxyCodeLine{03882\ \ \ \ \ BatchedParamPlots[j]-\/>Write();}
\DoxyCodeLine{03883\ \ \ \ \ \textcolor{keyword}{delete}\ Fitter;}
\DoxyCodeLine{03884\ \ \ \ \ \textcolor{keyword}{delete}\ BatchedParamPlots[j];}
\DoxyCodeLine{03885\ \ \ \}}
\DoxyCodeLine{03886\ \ \ \textcolor{keyword}{delete}[]\ BatchedParamPlots;}
\DoxyCodeLine{03887\ }
\DoxyCodeLine{03888\ \ \ \textcolor{comment}{//KS:\ Get\ the\ batched\ means\ variance\ estimation\ and\ variable\ indicating\ if\ number\ of\ batches\ is\ sensible}}
\DoxyCodeLine{03889\ \ \ \textcolor{comment}{//\ We\ do\ this\ before\ deleting\ BatchedAverages}}
\DoxyCodeLine{03890\ \ \ \mbox{\hyperlink{classMCMCProcessor_a29d492906e0c027d089331a0509cd2c3}{BatchedAnalysis}}();}
\DoxyCodeLine{03891\ }
\DoxyCodeLine{03892\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}};\ ++i)\ \{}
\DoxyCodeLine{03893\ \ \ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i];}
\DoxyCodeLine{03894\ \ \ \}}
\DoxyCodeLine{03895\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}};}
\DoxyCodeLine{03896\ }
\DoxyCodeLine{03897\ \ \ BatchDir-\/>Close();}
\DoxyCodeLine{03898\ \ \ \textcolor{keyword}{delete}\ BatchDir;}
\DoxyCodeLine{03899\ }
\DoxyCodeLine{03900\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{03901\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_ace48a54fb08e2a3943d4e2ed1f8c4a4b}\label{classMCMCProcessor_ace48a54fb08e2a3943d4e2ed1f8c4a4b}} 
\index{MCMCProcessor@{MCMCProcessor}!CacheSteps@{CacheSteps}}
\index{CacheSteps@{CacheSteps}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{CacheSteps()}{CacheSteps()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Cache\+Steps (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



KS\+:By caching each step we use multithreading. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l01099}{1099}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01099\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01100\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{01101\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aea84f0315695aa05ec41fcf965b1b031}{CacheMCMC}}\ ==\ \textcolor{keyword}{true})\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01102\ \ \ }
\DoxyCodeLine{01103\ \ \ \mbox{\hyperlink{classMCMCProcessor_aea84f0315695aa05ec41fcf965b1b031}{CacheMCMC}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01104\ \ \ }
\DoxyCodeLine{01105\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}\ !=\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{01106\ \ \ \{}
\DoxyCodeLine{01107\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}It\ look\ like\ ParStep\ was\ already\ filled\ "{}});}
\DoxyCodeLine{01108\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Even\ though\ it\ is\ used\ for\ MakeCovariance\_MP\ and\ for\ DiagMCMC\ "{}});}
\DoxyCodeLine{01109\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}it\ has\ different\ structure\ in\ both\ for\ cache\ hits,\ sorry\ "{}});}
\DoxyCodeLine{01110\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{01111\ \ \ \}}
\DoxyCodeLine{01112\ }
\DoxyCodeLine{01113\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Caching\ input\ tree..."{}});}
\DoxyCodeLine{01114\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Allocating\ \{:.2f\}\ MB"{}},\ \textcolor{keywordtype}{double}(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double})*\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}*\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}})/1.E6);}
\DoxyCodeLine{01115\ \ \ TStopwatch\ clock;}
\DoxyCodeLine{01116\ \ \ clock.Start();}
\DoxyCodeLine{01117\ \ \ }
\DoxyCodeLine{01118\ \ \ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}];}
\DoxyCodeLine{01119\ \ \ \mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{int}[\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}];}
\DoxyCodeLine{01120\ \ \ }
\DoxyCodeLine{01121\ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}\ =\ \textcolor{keyword}{new}\ TH2D**[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}]();}
\DoxyCodeLine{01122\ }
\DoxyCodeLine{01123\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ }
\DoxyCodeLine{01124\ \ \ \{}
\DoxyCodeLine{01125\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[i]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}];}
\DoxyCodeLine{01126\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i]\ =\ \textcolor{keyword}{new}\ TH2D*[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}]();}
\DoxyCodeLine{01127\ }
\DoxyCodeLine{01128\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++j)}
\DoxyCodeLine{01129\ \ \ \ \ \{}
\DoxyCodeLine{01130\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[i][j]\ =\ -\/999.99;}
\DoxyCodeLine{01131\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Set\ this\ only\ once}}
\DoxyCodeLine{01132\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(i\ ==\ 0)\ \mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}[j]\ =\ -\/999.99;}
\DoxyCodeLine{01133\ \ \ \ \ \}}
\DoxyCodeLine{01134\ \ \ \}}
\DoxyCodeLine{01135\ }
\DoxyCodeLine{01136\ \ \ \textcolor{comment}{//\ Set\ all\ the\ branches\ to\ off}}
\DoxyCodeLine{01137\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchStatus(\textcolor{stringliteral}{"{}*"{}},\ \textcolor{keyword}{false});}
\DoxyCodeLine{01138\ \ \ }
\DoxyCodeLine{01139\ \ \ \textcolor{comment}{//\ Turn\ on\ the\ branches\ which\ we\ want\ for\ parameters}}
\DoxyCodeLine{01140\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ }
\DoxyCodeLine{01141\ \ \ \{}
\DoxyCodeLine{01142\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchStatus(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i].Data(),\ \textcolor{keyword}{true});}
\DoxyCodeLine{01143\ \ \ \}}
\DoxyCodeLine{01144\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchStatus(\textcolor{stringliteral}{"{}step"{}},\ \textcolor{keyword}{true});}
\DoxyCodeLine{01145\ }
\DoxyCodeLine{01146\ \ \ \textcolor{keyword}{const}\ Long64\_t\ countwidth\ =\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}/10;}
\DoxyCodeLine{01147\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ entries}}
\DoxyCodeLine{01148\ \ \ \textcolor{comment}{//KS:\ This\ is\ really\ a\ bottleneck\ right\ now,\ thus\ revisit\ with\ ROOT6\ https://pep-\/root6.github.io/docs/analysis/parallell/root.html}}
\DoxyCodeLine{01149\ \ \ \textcolor{keywordflow}{for}\ (Long64\_t\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++j)\ }
\DoxyCodeLine{01150\ \ \ \{}
\DoxyCodeLine{01151\ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ \%\ countwidth\ ==\ 0)}
\DoxyCodeLine{01152\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceMaCh3Utils_a4c8bdeb1d34606aed192e9f1311a72f5}{MaCh3Utils::PrintProgressBar}}(j,\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{01153\ }
\DoxyCodeLine{01154\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchAddress(\textcolor{stringliteral}{"{}step"{}},\ \&\mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}[j]);}
\DoxyCodeLine{01155\ \ \ \ \ \textcolor{comment}{//\ Set\ the\ branch\ addresses\ for\ params}}
\DoxyCodeLine{01156\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ }
\DoxyCodeLine{01157\ \ \ \ \ \{}
\DoxyCodeLine{01158\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchAddress(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i].Data(),\ \&\mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[i][j]);}
\DoxyCodeLine{01159\ \ \ \ \ \}}
\DoxyCodeLine{01160\ \ \ \ \ }
\DoxyCodeLine{01161\ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ \%\ countwidth\ ==\ 0)\ \{}
\DoxyCodeLine{01162\ \ \ \ \ \ \ \mbox{\hyperlink{namespaceMaCh3Utils_afb0be593dc0d5e481b78afa4625c858c}{MaCh3Utils::EstimateDataTransferRate}}(\mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}},\ j);}
\DoxyCodeLine{01163\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01164\ \ \ \ \ \ \ \textcolor{comment}{//\ Fill\ up\ the\ ParStep\ array}}
\DoxyCodeLine{01165\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetEntry(j);}
\DoxyCodeLine{01166\ \ \ \ \ \}}
\DoxyCodeLine{01167\ }
\DoxyCodeLine{01168\ \ \ \}}
\DoxyCodeLine{01169\ \ \ }
\DoxyCodeLine{01170\ \ \ \textcolor{comment}{//\ Set\ all\ the\ branches\ to\ on}}
\DoxyCodeLine{01171\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchStatus(\textcolor{stringliteral}{"{}*"{}},\ \textcolor{keyword}{true});}
\DoxyCodeLine{01172\ \ \ }
\DoxyCodeLine{01173\ \ \ \textcolor{comment}{//\ Cache\ max\ and\ min\ in\ chain\ for\ covariance\ matrix}}
\DoxyCodeLine{01174\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ }
\DoxyCodeLine{01175\ \ \ \{}
\DoxyCodeLine{01176\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Min\_Chain\_i\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMinimum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i]);}
\DoxyCodeLine{01177\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Max\_Chain\_i\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMaximum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i]);}
\DoxyCodeLine{01178\ \ \ \ \ }
\DoxyCodeLine{01179\ \ \ \ \ TString\ Title\_i\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{01180\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\_i,\ PriorError\_i;}
\DoxyCodeLine{01181\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(i,\ Prior\_i,\ PriorError\_i,\ Title\_i);}
\DoxyCodeLine{01182\ \ \ \ \ }
\DoxyCodeLine{01183\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ ++j)}
\DoxyCodeLine{01184\ \ \ \ \ \{}
\DoxyCodeLine{01185\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Min\_Chain\_j\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMinimum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[j]);}
\DoxyCodeLine{01186\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Max\_Chain\_j\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMaximum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[j]);}
\DoxyCodeLine{01187\ \ \ }
\DoxyCodeLine{01188\ \ \ \ \ \ \ \textcolor{comment}{//\ TH2D\ to\ hold\ the\ Correlation\ }}
\DoxyCodeLine{01189\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]\ =\ \textcolor{keyword}{new}\ TH2D(Form(\textcolor{stringliteral}{"{}hpost2D\_\%i\_\%i"{}},i,j),\ Form(\textcolor{stringliteral}{"{}hpost2D\_\%i\_\%i"{}},i,j),\ \mbox{\hyperlink{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}{nBins}},\ Min\_Chain\_i,\ Max\_Chain\_i,\ \mbox{\hyperlink{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}{nBins}},\ Min\_Chain\_j,\ Max\_Chain\_j);}
\DoxyCodeLine{01190\ \ \ \ \ \ \ }
\DoxyCodeLine{01191\ \ \ \ \ \ \ TString\ Title\_j\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{01192\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\_j,\ PriorError\_j;}
\DoxyCodeLine{01193\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(j,\ Prior\_j,\ PriorError\_j,\ Title\_j);}
\DoxyCodeLine{01194\ \ \ }
\DoxyCodeLine{01195\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>SetMinimum(0);}
\DoxyCodeLine{01196\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>GetXaxis()-\/>SetTitle(Title\_i);}
\DoxyCodeLine{01197\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>GetYaxis()-\/>SetTitle(Title\_j);}
\DoxyCodeLine{01198\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Steps"{}});}
\DoxyCodeLine{01199\ \ \ \ \ \}}
\DoxyCodeLine{01200\ \ \ \}}
\DoxyCodeLine{01201\ \ \ \ \ \ \ }
\DoxyCodeLine{01202\ \ \ clock.Stop();}
\DoxyCodeLine{01203\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Caching\ steps\ took\ \{:.2f\}s\ to\ finish\ for\ \{\}\ steps"{}},\ clock.RealTime(),\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}\ );}
\DoxyCodeLine{01204\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_add7add4eeddec946bad2645804aefd88}\label{classMCMCProcessor_add7add4eeddec946bad2645804aefd88}} 
\index{MCMCProcessor@{MCMCProcessor}!CalculateESS@{CalculateESS}}
\index{CalculateESS@{CalculateESS}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{CalculateESS()}{CalculateESS()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Calculate\+ESS (\begin{DoxyParamCaption}\item[{const int}]{n\+Lags,  }\item[{double $\ast$$\ast$}]{LagL }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



KS\+: calc Effective Sample Size. 


\begin{DoxyParams}{Parameters}
{\em n\+Lags} & Should be the same n\+Lags as used in \mbox{\hyperlink{classMCMCProcessor_a322bee0c362ba83df8c45769d299ce9f}{Auto\+Correlation()}} \\
\hline
{\em LagL} & Value of LagL for each dial and each Lag\\
\hline
\end{DoxyParams}
This function computes the Effective Sample Size (ESS) using the autocorrelations calculated by \mbox{\hyperlink{classMCMCProcessor_a322bee0c362ba83df8c45769d299ce9f}{Auto\+Correlation()}}. Ensure that the parameter n\+Lags here matches the number of lags used in \mbox{\hyperlink{classMCMCProcessor_a322bee0c362ba83df8c45769d299ce9f}{Auto\+Correlation()}} to obtain accurate results. \cite{StanManual} \cite{hanson2008mcmc} \cite{gabry2024visual} 

Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l03741}{3741}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{03741\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03742\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{03743\ \ \ \textcolor{keywordflow}{if}(LagL\ ==\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{03744\ \ \ \{}
\DoxyCodeLine{03745\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}LagL\ is\ nullptr"{}});}
\DoxyCodeLine{03746\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{03747\ \ \ \}}
\DoxyCodeLine{03748\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ ESS\ plots..."{}});}
\DoxyCodeLine{03749\ \ \ TVectorD*\ \mbox{\hyperlink{RHat_8cpp_ae673254e98992bd483de55c6c1d1dcaf}{EffectiveSampleSize}}\ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{03750\ \ \ TVectorD*\ SamplingEfficiency\ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{03751\ \ \ std::vector<double>\ TempDenominator(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{03752\ }
\DoxyCodeLine{03753\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ Nhists\ =\ 5;}
\DoxyCodeLine{03754\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{double}\ Thresholds[Nhists\ +\ 1]\ =\ \{1,\ 0.02,\ 0.005,\ 0.001,\ 0.0001,\ 0.0\};}
\DoxyCodeLine{03755\ \ \ \textcolor{keyword}{constexpr}\ Color\_t\ ESSColours[Nhists]\ =\ \{kGreen,\ kGreen\ +\ 2,\ kYellow,\ kOrange,\ kRed\};}
\DoxyCodeLine{03756\ }
\DoxyCodeLine{03757\ \ \ \textcolor{comment}{//KS:\ This\ histogram\ is\ inspired\ by\ the\ following:\ @cite\ gabry2024visual}}
\DoxyCodeLine{03758\ \ \ std::vector<std::unique\_ptr<TH1D>>\ EffectiveSampleSizeHist(Nhists);}
\DoxyCodeLine{03759\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ Nhists;\ ++i)}
\DoxyCodeLine{03760\ \ \ \{}
\DoxyCodeLine{03761\ \ \ \ \ EffectiveSampleSizeHist[i]\ =}
\DoxyCodeLine{03762\ \ \ \ \ \ \ std::make\_unique<TH1D>(Form(\textcolor{stringliteral}{"{}EffectiveSampleSizeHist\_\%i"{}},\ i),\ Form(\textcolor{stringliteral}{"{}EffectiveSampleSizeHist\_\%i"{}},\ i),\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{03763\ \ \ \ \ EffectiveSampleSizeHist[i]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}N\_\{eff\}/N"{}});}
\DoxyCodeLine{03764\ \ \ \ \ EffectiveSampleSizeHist[i]-\/>SetFillColor(ESSColours[i]);}
\DoxyCodeLine{03765\ \ \ \ \ EffectiveSampleSizeHist[i]-\/>SetLineColor(ESSColours[i]);}
\DoxyCodeLine{03766\ \ \ \ \ EffectiveSampleSizeHist[i]-\/>Sumw2();}
\DoxyCodeLine{03767\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{03768\ \ \ \ \ \{}
\DoxyCodeLine{03769\ \ \ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{03770\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{03771\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{03772\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(j,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{03773\ \ \ \ \ \ \ EffectiveSampleSizeHist[i]-\/>GetXaxis()-\/>SetBinLabel(j+1,\ Title.Data());}
\DoxyCodeLine{03774\ \ \ \ \ \}}
\DoxyCodeLine{03775\ \ \ \}}
\DoxyCodeLine{03776\ }
\DoxyCodeLine{03777\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{03778\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{03779\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{03780\ \ \ \textcolor{comment}{//KS:\ Calculate\ ESS\ and\ MCMC\ efficiency\ for\ each\ parameter}}
\DoxyCodeLine{03781\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{03782\ \ \ \{}
\DoxyCodeLine{03783\ \ \ \ \ (*EffectiveSampleSize)(j)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{03784\ \ \ \ \ (*SamplingEfficiency)(j)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{03785\ \ \ \ \ TempDenominator[j]\ =\ 0.;}
\DoxyCodeLine{03786\ \ \ \ \ \textcolor{comment}{//KS:\ Firs\ sum\ over\ all\ Calculated\ autocorrelations}}
\DoxyCodeLine{03787\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ nLags;\ ++k)}
\DoxyCodeLine{03788\ \ \ \ \ \{}
\DoxyCodeLine{03789\ \ \ \ \ \ \ TempDenominator[j]\ +=\ LagL[j][k];}
\DoxyCodeLine{03790\ \ \ \ \ \}}
\DoxyCodeLine{03791\ \ \ \ \ TempDenominator[j]\ =\ 1+2*TempDenominator[j];}
\DoxyCodeLine{03792\ \ \ \ \ (*EffectiveSampleSize)(j)\ =\ \textcolor{keywordtype}{double}(\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}})/TempDenominator[j];}
\DoxyCodeLine{03793\ \ \ \ \ \textcolor{comment}{//\ 100\ because\ we\ convert\ to\ percentage}}
\DoxyCodeLine{03794\ \ \ \ \ (*SamplingEfficiency)(j)\ =\ 100\ *\ 1/TempDenominator[j];}
\DoxyCodeLine{03795\ }
\DoxyCodeLine{03796\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ Nhists;\ ++i)}
\DoxyCodeLine{03797\ \ \ \ \ \{}
\DoxyCodeLine{03798\ \ \ \ \ \ \ EffectiveSampleSizeHist[i]-\/>SetBinContent(j+1,\ 0);}
\DoxyCodeLine{03799\ \ \ \ \ \ \ EffectiveSampleSizeHist[i]-\/>SetBinError(j+1,\ 0);}
\DoxyCodeLine{03800\ }
\DoxyCodeLine{03801\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ TempEntry\ =\ std::fabs((*\mbox{\hyperlink{RHat_8cpp_ae673254e98992bd483de55c6c1d1dcaf}{EffectiveSampleSize}})(j))\ /\ double(\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{03802\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(Thresholds[i]\ >=\ TempEntry\ \&\&\ TempEntry\ >\ Thresholds[i+1])}
\DoxyCodeLine{03803\ \ \ \ \ \ \ \{}
\DoxyCodeLine{03804\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ std::isnan((*\mbox{\hyperlink{RHat_8cpp_ae673254e98992bd483de55c6c1d1dcaf}{EffectiveSampleSize}})(j))\ )\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{03805\ \ \ \ \ \ \ \ \ EffectiveSampleSizeHist[i]-\/>SetBinContent(j+1,\ TempEntry);}
\DoxyCodeLine{03806\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03807\ \ \ \ \ \}}
\DoxyCodeLine{03808\ \ \ \}}
\DoxyCodeLine{03809\ }
\DoxyCodeLine{03810\ \ \ \textcolor{comment}{//KS\ Write\ to\ the\ output\ tree}}
\DoxyCodeLine{03811\ \ \ \textcolor{comment}{//Save\ to\ file}}
\DoxyCodeLine{03812\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{03813\ \ \ \mbox{\hyperlink{RHat_8cpp_ae673254e98992bd483de55c6c1d1dcaf}{EffectiveSampleSize}}-\/>Write(\textcolor{stringliteral}{"{}EffectiveSampleSize"{}});}
\DoxyCodeLine{03814\ \ \ SamplingEfficiency-\/>Write(\textcolor{stringliteral}{"{}SamplingEfficiency"{}});}
\DoxyCodeLine{03815\ }
\DoxyCodeLine{03816\ \ \ EffectiveSampleSizeHist[0]-\/>SetTitle(\textcolor{stringliteral}{"{}Effective\ Sample\ Size"{}});}
\DoxyCodeLine{03817\ \ \ EffectiveSampleSizeHist[0]-\/>Draw();}
\DoxyCodeLine{03818\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ Nhists;\ ++i)}
\DoxyCodeLine{03819\ \ \ \{}
\DoxyCodeLine{03820\ \ \ \ \ EffectiveSampleSizeHist[i]-\/>Draw(\textcolor{stringliteral}{"{}SAME"{}});}
\DoxyCodeLine{03821\ \ \ \}}
\DoxyCodeLine{03822\ }
\DoxyCodeLine{03823\ \ \ \textcolor{keyword}{auto}\ leg\ =\ std::make\_unique<TLegend>(0.2,\ 0.7,\ 0.6,\ 0.95);}
\DoxyCodeLine{03824\ \ \ leg-\/>SetTextSize(0.03);}
\DoxyCodeLine{03825\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ Nhists;\ ++i)}
\DoxyCodeLine{03826\ \ \ \{}
\DoxyCodeLine{03827\ \ \ \ \ leg-\/>AddEntry(EffectiveSampleSizeHist[i].get(),\ Form(\textcolor{stringliteral}{"{}\%.4f\ >=\ N\_\{eff\}/N\ >\ \%.4f"{}},\ Thresholds[i],\ Thresholds[i+1]),\ \textcolor{stringliteral}{"{}f"{}});}
\DoxyCodeLine{03828\ \ \ \}}
\DoxyCodeLine{03829\ \ \ leg-\/>SetLineColor(0);}
\DoxyCodeLine{03830\ \ \ leg-\/>SetLineStyle(0);}
\DoxyCodeLine{03831\ \ \ leg-\/>SetFillColor(0);}
\DoxyCodeLine{03832\ \ \ leg-\/>SetFillStyle(0);}
\DoxyCodeLine{03833\ \ \ leg-\/>Draw(\textcolor{stringliteral}{"{}SAME"{}});}
\DoxyCodeLine{03834\ }
\DoxyCodeLine{03835\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Write(\textcolor{stringliteral}{"{}EffectiveSampleSizeCanvas"{}});}
\DoxyCodeLine{03836\ }
\DoxyCodeLine{03837\ \ \ \textcolor{comment}{//Delete\ all\ variables}}
\DoxyCodeLine{03838\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{RHat_8cpp_ae673254e98992bd483de55c6c1d1dcaf}{EffectiveSampleSize}};}
\DoxyCodeLine{03839\ \ \ \textcolor{keyword}{delete}\ SamplingEfficiency;}
\DoxyCodeLine{03840\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a7f8faecae63616ba100cf24ae42ecc08}\label{classMCMCProcessor_a7f8faecae63616ba100cf24ae42ecc08}} 
\index{MCMCProcessor@{MCMCProcessor}!DiagMCMC@{DiagMCMC}}
\index{DiagMCMC@{DiagMCMC}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{DiagMCMC()}{DiagMCMC()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Diag\+MCMC (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



KS\+: Perform MCMC diagnostic including Autocorrelation, Trace etc. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l03212}{3212}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{03212\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03213\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{03214\ }
\DoxyCodeLine{03215\ \ \ \textcolor{comment}{//\ Prepare\ branches\ etc\ for\ DiagMCMC}}
\DoxyCodeLine{03216\ \ \ \mbox{\hyperlink{classMCMCProcessor_a930cadafa41b31b58066dea68628de9f}{PrepareDiagMCMC}}();}
\DoxyCodeLine{03217\ }
\DoxyCodeLine{03218\ \ \ \textcolor{comment}{//\ Draw\ the\ simple\ trace\ matrices}}
\DoxyCodeLine{03219\ \ \ \mbox{\hyperlink{classMCMCProcessor_a929d6efec80bb4de05eea7011257439a}{ParamTraces}}();}
\DoxyCodeLine{03220\ }
\DoxyCodeLine{03221\ \ \ \textcolor{comment}{//\ Get\ the\ batched\ means}}
\DoxyCodeLine{03222\ \ \ \mbox{\hyperlink{classMCMCProcessor_af3658b8adee50f6ef5557ebbd1c87b8e}{BatchedMeans}}();}
\DoxyCodeLine{03223\ }
\DoxyCodeLine{03224\ \ \ \textcolor{comment}{//\ Draw\ the\ auto-\/correlations}}
\DoxyCodeLine{03225\ \ \ \mbox{\hyperlink{classMCMCProcessor_a322bee0c362ba83df8c45769d299ce9f}{AutoCorrelation}}();}
\DoxyCodeLine{03226\ }
\DoxyCodeLine{03227\ \ \ \textcolor{comment}{//\ Calculate\ Power\ Spectrum\ for\ each\ param}}
\DoxyCodeLine{03228\ \ \ \mbox{\hyperlink{classMCMCProcessor_aef760d8c4bb70690a5c4114f4b2409b3}{PowerSpectrumAnalysis}}();}
\DoxyCodeLine{03229\ }
\DoxyCodeLine{03230\ \ \ \textcolor{comment}{//\ Get\ Geweke\ Z\ score\ helping\ select\ burn-\/in}}
\DoxyCodeLine{03231\ \ \ \mbox{\hyperlink{classMCMCProcessor_a03b7c4bb9cd9a90aa7d284b0f1a6156b}{GewekeDiagnostic}}();}
\DoxyCodeLine{03232\ }
\DoxyCodeLine{03233\ \ \ \textcolor{comment}{//\ Draw\ acceptance\ Probability}}
\DoxyCodeLine{03234\ \ \ \mbox{\hyperlink{classMCMCProcessor_a278b82fa945d847e57ae6ed6357d8f61}{AcceptanceProbabilities}}();}
\DoxyCodeLine{03235\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a5b0961bcb0eea7a347e6a29ef7738d80}\label{classMCMCProcessor_a5b0961bcb0eea7a347e6a29ef7738d80}} 
\index{MCMCProcessor@{MCMCProcessor}!DrawCorrelations1D@{DrawCorrelations1D}}
\index{DrawCorrelations1D@{DrawCorrelations1D}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{DrawCorrelations1D()}{DrawCorrelations1D()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Draw\+Correlations1D (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Draw 1D correlations which might be more helpful than looking at huge 2D Corr matrix. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l01480}{1480}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01480\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01481\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{01482\ \ \ \textcolor{comment}{//KS:\ Store\ it\ as\ we\ go\ back\ to\ them\ at\ the\ end}}
\DoxyCodeLine{01483\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ TopMargin\ \ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetTopMargin();}
\DoxyCodeLine{01484\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ BottomMargin\ \ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetBottomMargin();}
\DoxyCodeLine{01485\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ OptTitle\ =\ gStyle-\/>GetOptTitle();}
\DoxyCodeLine{01486\ }
\DoxyCodeLine{01487\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTopMargin(0.1);}
\DoxyCodeLine{01488\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetBottomMargin(0.2);}
\DoxyCodeLine{01489\ \ \ gStyle-\/>SetOptTitle(1);}
\DoxyCodeLine{01490\ }
\DoxyCodeLine{01491\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ Nhists\ =\ 3;}
\DoxyCodeLine{01492\ \ \ \textcolor{comment}{//KS:\ Highest\ value\ is\ just\ meant\ bo\ be\ sliglhy\ higher\ than\ 1\ to\ catch\ >,}}
\DoxyCodeLine{01493\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{double}\ Thresholds[Nhists+1]\ =\ \{0,\ 0.25,\ 0.5,\ 1.0001\};}
\DoxyCodeLine{01494\ \ \ \textcolor{keyword}{constexpr}\ Color\_t\ CorrColours[Nhists]\ =\ \{kRed-\/10,\ kRed-\/6,\ \ kRed\};}
\DoxyCodeLine{01495\ }
\DoxyCodeLine{01496\ \ \ \textcolor{comment}{//KS:\ This\ strore\ neccesary\ entires\ for\ stripped\ covariance\ which\ strore\ only\ "{}menaingfull\ correlations}}
\DoxyCodeLine{01497\ \ \ std::vector<std::vector<double>>\ CorrOfInterest;}
\DoxyCodeLine{01498\ \ \ CorrOfInterest.resize(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{01499\ \ \ std::vector<std::vector<std::string>>\ NameCorrOfInterest;}
\DoxyCodeLine{01500\ \ \ NameCorrOfInterest.resize(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{01501\ }
\DoxyCodeLine{01502\ \ \ std::vector<std::vector<std::unique\_ptr<TH1D>>>\ Corr1DHist(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{01503\ \ \ \textcolor{comment}{//KS:\ Initialising\ ROOT\ objects\ is\ never\ safe\ in\ MP\ loop}}
\DoxyCodeLine{01504\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{01505\ \ \ \{}
\DoxyCodeLine{01506\ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{01507\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{01508\ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{01509\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(i,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{01510\ }
\DoxyCodeLine{01511\ \ \ \ \ Corr1DHist[i].resize(Nhists);}
\DoxyCodeLine{01512\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ Nhists;\ ++j)}
\DoxyCodeLine{01513\ \ \ \ \ \{}
\DoxyCodeLine{01514\ \ \ \ \ \ \ Corr1DHist[i][j]\ =\ std::make\_unique<TH1D>(Form(\textcolor{stringliteral}{"{}Corr1DHist\_\%i\_\%i"{}},\ i,\ j),\ Form(\textcolor{stringliteral}{"{}Corr1DHist\_\%i\_\%i"{}},\ i,\ j),\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{01515\ \ \ \ \ \ \ Corr1DHist[i][j]-\/>SetTitle(Form(\textcolor{stringliteral}{"{}\%s"{}},Title.Data()));}
\DoxyCodeLine{01516\ \ \ \ \ \ \ Corr1DHist[i][j]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Correlation"{}});}
\DoxyCodeLine{01517\ \ \ \ \ \ \ Corr1DHist[i][j]-\/>SetFillColor(CorrColours[j]);}
\DoxyCodeLine{01518\ \ \ \ \ \ \ Corr1DHist[i][j]-\/>SetLineColor(kBlack);}
\DoxyCodeLine{01519\ }
\DoxyCodeLine{01520\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++k)}
\DoxyCodeLine{01521\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01522\ \ \ \ \ \ \ \ \ TString\ Title\_y\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{01523\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\_y\ =\ 1.0;}
\DoxyCodeLine{01524\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\_y\ =\ 1.0;}
\DoxyCodeLine{01525\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(k,\ Prior\_y,\ PriorError\_y,\ Title\_y);}
\DoxyCodeLine{01526\ \ \ \ \ \ \ \ \ Corr1DHist[i][j]-\/>GetXaxis()-\/>SetBinLabel(k+1,\ Title\_y.Data());}
\DoxyCodeLine{01527\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01528\ \ \ \ \ \}}
\DoxyCodeLine{01529\ \ \ \}}
\DoxyCodeLine{01530\ }
\DoxyCodeLine{01531\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{01532\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{01533\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{01534\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{01535\ \ \ \{}
\DoxyCodeLine{01536\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{01537\ \ \ \ \ \{}
\DoxyCodeLine{01538\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ Nhists;\ ++k)}
\DoxyCodeLine{01539\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01540\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ TempEntry\ =\ std::fabs((*\mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}})(i,j));}
\DoxyCodeLine{01541\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(Thresholds[k+1]\ >\ TempEntry\ \&\&\ TempEntry\ >=\ Thresholds[k])}
\DoxyCodeLine{01542\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01543\ \ \ \ \ \ \ \ \ \ \ Corr1DHist[i][k]-\/>SetBinContent(j+1,\ (*\mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}})(i,j));}
\DoxyCodeLine{01544\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01545\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01546\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(std::fabs((*\mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}})(i,j))\ >\ \mbox{\hyperlink{classMCMCProcessor_a25e4685b6299181021b02ac0e0b74681}{Post2DPlotThreshold}}\ \&\&\ i\ !=\ j)}
\DoxyCodeLine{01547\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01548\ \ \ \ \ \ \ \ \ CorrOfInterest[i].push\_back((*\mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}})(i,j));}
\DoxyCodeLine{01549\ \ \ \ \ \ \ \ \ NameCorrOfInterest[i].push\_back(Corr1DHist[i][0]-\/>GetXaxis()-\/>GetBinLabel(j+1));}
\DoxyCodeLine{01550\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01551\ \ \ \ \ \}}
\DoxyCodeLine{01552\ \ \ \}}
\DoxyCodeLine{01553\ }
\DoxyCodeLine{01554\ \ \ TDirectory\ *CorrDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}Corr1D"{}});}
\DoxyCodeLine{01555\ \ \ CorrDir-\/>cd();}
\DoxyCodeLine{01556\ }
\DoxyCodeLine{01557\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ i++)}
\DoxyCodeLine{01558\ \ \ \{}
\DoxyCodeLine{01559\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a95fa49737432818bc830a44898d0d850}{IamVaried}}[i]\ ==\ \textcolor{keyword}{false})\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01560\ }
\DoxyCodeLine{01561\ \ \ \ \ Corr1DHist[i][0]-\/>SetMaximum(+1.);}
\DoxyCodeLine{01562\ \ \ \ \ Corr1DHist[i][0]-\/>SetMinimum(-\/1.);}
\DoxyCodeLine{01563\ \ \ \ \ Corr1DHist[i][0]-\/>Draw();}
\DoxyCodeLine{01564\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ k\ =\ 1;\ k\ <\ Nhists;\ k++)}
\DoxyCodeLine{01565\ \ \ \ \ \{}
\DoxyCodeLine{01566\ \ \ \ \ \ \ Corr1DHist[i][k]-\/>Draw(\textcolor{stringliteral}{"{}SAME"{}});}
\DoxyCodeLine{01567\ \ \ \ \ \}}
\DoxyCodeLine{01568\ }
\DoxyCodeLine{01569\ \ \ \ \ \textcolor{keyword}{auto}\ leg\ =\ std::make\_unique<TLegend>(0.3,\ 0.75,\ 0.6,\ 0.90);}
\DoxyCodeLine{01570\ \ \ \ \ leg-\/>SetTextSize(0.02);}
\DoxyCodeLine{01571\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ Nhists;\ k++)}
\DoxyCodeLine{01572\ \ \ \ \ \{}
\DoxyCodeLine{01573\ \ \ \ \ \ \ leg-\/>AddEntry(Corr1DHist[i][k].get(),\ Form(\textcolor{stringliteral}{"{}\%.2f\ >\ |Corr|\ >=\ \%.2f"{}},\ Thresholds[k+1],\ Thresholds[k]),\ \textcolor{stringliteral}{"{}f"{}});}
\DoxyCodeLine{01574\ \ \ \ \ \}}
\DoxyCodeLine{01575\ \ \ \ \ leg-\/>SetLineColor(0);}
\DoxyCodeLine{01576\ \ \ \ \ leg-\/>SetLineStyle(0);}
\DoxyCodeLine{01577\ \ \ \ \ leg-\/>SetFillColor(0);}
\DoxyCodeLine{01578\ \ \ \ \ leg-\/>SetFillStyle(0);}
\DoxyCodeLine{01579\ \ \ \ \ leg-\/>Draw(\textcolor{stringliteral}{"{}SAME"{}});}
\DoxyCodeLine{01580\ }
\DoxyCodeLine{01581\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Write(Corr1DHist[i][0]-\/>GetTitle());}
\DoxyCodeLine{01582\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{01583\ \ \ \}}
\DoxyCodeLine{01584\ }
\DoxyCodeLine{01585\ \ \ \textcolor{comment}{//KS:\ Plot\ only\ meaningful\ correlations}}
\DoxyCodeLine{01586\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ i++)}
\DoxyCodeLine{01587\ \ \ \{}
\DoxyCodeLine{01588\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}}\ =\ int(CorrOfInterest[i].\mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}}());}
\DoxyCodeLine{01589\ }
\DoxyCodeLine{01590\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}}\ ==\ 0)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01591\ \ \ \ \ TH1D*\ Corr1DHist\_Reduced\ =\ \textcolor{keyword}{new}\ TH1D(\textcolor{stringliteral}{"{}Corr1DHist\_Reduced"{}},\ \textcolor{stringliteral}{"{}Corr1DHist\_Reduced"{}},\ \mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}},\ 0,\ \mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}});}
\DoxyCodeLine{01592\ }
\DoxyCodeLine{01593\ \ \ \ \ Corr1DHist\_Reduced-\/>SetTitle(Corr1DHist[i][0]-\/>GetTitle());}
\DoxyCodeLine{01594\ \ \ \ \ Corr1DHist\_Reduced-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Correlation"{}});}
\DoxyCodeLine{01595\ \ \ \ \ Corr1DHist\_Reduced-\/>SetFillColor(kBlue);}
\DoxyCodeLine{01596\ \ \ \ \ Corr1DHist\_Reduced-\/>SetLineColor(kBlue);}
\DoxyCodeLine{01597\ }
\DoxyCodeLine{01598\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}};\ ++j)}
\DoxyCodeLine{01599\ \ \ \ \ \{}
\DoxyCodeLine{01600\ \ \ \ \ \ \ Corr1DHist\_Reduced-\/>GetXaxis()-\/>SetBinLabel(j+1,\ NameCorrOfInterest[i][j].c\_str());}
\DoxyCodeLine{01601\ \ \ \ \ \ \ Corr1DHist\_Reduced-\/>SetBinContent(j+1,\ CorrOfInterest[i][j]);}
\DoxyCodeLine{01602\ \ \ \ \ \}}
\DoxyCodeLine{01603\ \ \ \ \ Corr1DHist\_Reduced-\/>GetXaxis()-\/>LabelsOption(\textcolor{stringliteral}{"{}v"{}});}
\DoxyCodeLine{01604\ }
\DoxyCodeLine{01605\ \ \ \ \ Corr1DHist\_Reduced-\/>SetMaximum(+1.);}
\DoxyCodeLine{01606\ \ \ \ \ Corr1DHist\_Reduced-\/>SetMinimum(-\/1.);}
\DoxyCodeLine{01607\ \ \ \ \ Corr1DHist\_Reduced-\/>Draw();}
\DoxyCodeLine{01608\ }
\DoxyCodeLine{01609\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Write(Form(\textcolor{stringliteral}{"{}\%s\_Red"{}},\ Corr1DHist\_Reduced-\/>GetTitle()));}
\DoxyCodeLine{01610\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{01611\ }
\DoxyCodeLine{01612\ \ \ \ \ \textcolor{keyword}{delete}\ Corr1DHist\_Reduced;}
\DoxyCodeLine{01613\ \ \ \}}
\DoxyCodeLine{01614\ }
\DoxyCodeLine{01615\ \ \ CorrDir-\/>Close();}
\DoxyCodeLine{01616\ \ \ \textcolor{keyword}{delete}\ CorrDir;}
\DoxyCodeLine{01617\ }
\DoxyCodeLine{01618\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{01619\ }
\DoxyCodeLine{01620\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTopMargin(TopMargin);}
\DoxyCodeLine{01621\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetBottomMargin(BottomMargin);}
\DoxyCodeLine{01622\ \ \ gStyle-\/>SetOptTitle(OptTitle);}
\DoxyCodeLine{01623\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a8d9b9c1c780a51b130fe528583dc5019}\label{classMCMCProcessor_a8d9b9c1c780a51b130fe528583dc5019}} 
\index{MCMCProcessor@{MCMCProcessor}!DrawCovariance@{DrawCovariance}}
\index{DrawCovariance@{DrawCovariance}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{DrawCovariance()}{DrawCovariance()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Draw\+Covariance (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Draw the post-\/fit covariances. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l01387}{1387}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01388\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{01389\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ RightMargin\ \ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetRightMargin();}
\DoxyCodeLine{01390\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetRightMargin(0.15);}
\DoxyCodeLine{01391\ }
\DoxyCodeLine{01392\ \ \ \textcolor{comment}{//\ The\ Covariance\ matrix\ from\ the\ fit}}
\DoxyCodeLine{01393\ \ \ std::unique\_ptr<TH2D>\ hCov\ =\ std::make\_unique<TH2D>(\textcolor{stringliteral}{"{}hCov"{}},\ \textcolor{stringliteral}{"{}hCov"{}},\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{01394\ \ \ hCov-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Covariance"{}});}
\DoxyCodeLine{01395\ \ \ \textcolor{comment}{//\ The\ Covariance\ matrix\ square\ root,\ with\ correct\ sign}}
\DoxyCodeLine{01396\ \ \ std::unique\_ptr<TH2D>\ hCovSq\ =\ std::make\_unique<TH2D>(\textcolor{stringliteral}{"{}hCovSq"{}},\ \textcolor{stringliteral}{"{}hCovSq"{}},\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{01397\ \ \ hCovSq-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Covariance"{}});}
\DoxyCodeLine{01398\ \ \ \textcolor{comment}{//\ The\ Correlation}}
\DoxyCodeLine{01399\ \ \ std::unique\_ptr<TH2D>\ hCorr\ =\ std::make\_unique<TH2D>(\textcolor{stringliteral}{"{}hCorr"{}},\ \textcolor{stringliteral}{"{}hCorr"{}},\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{01400\ \ \ hCorr-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Correlation"{}});}
\DoxyCodeLine{01401\ \ \ hCorr-\/>SetMinimum(-\/1);}
\DoxyCodeLine{01402\ \ \ hCorr-\/>SetMaximum(1);}
\DoxyCodeLine{01403\ \ \ hCov-\/>GetXaxis()-\/>SetLabelSize(0.015);}
\DoxyCodeLine{01404\ \ \ hCov-\/>GetYaxis()-\/>SetLabelSize(0.015);}
\DoxyCodeLine{01405\ \ \ hCovSq-\/>GetXaxis()-\/>SetLabelSize(0.015);}
\DoxyCodeLine{01406\ \ \ hCovSq-\/>GetYaxis()-\/>SetLabelSize(0.015);}
\DoxyCodeLine{01407\ \ \ hCorr-\/>GetXaxis()-\/>SetLabelSize(0.015);}
\DoxyCodeLine{01408\ \ \ hCorr-\/>GetYaxis()-\/>SetLabelSize(0.015);}
\DoxyCodeLine{01409\ }
\DoxyCodeLine{01410\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ Covariance\ matrix\ entries}}
\DoxyCodeLine{01411\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{01412\ \ \ \{}
\DoxyCodeLine{01413\ \ \ \ \ TString\ titlex\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{01414\ \ \ \ \ \textcolor{keywordtype}{double}\ nom,\ err;}
\DoxyCodeLine{01415\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(i,\ nom,\ err,\ titlex);}
\DoxyCodeLine{01416\ \ \ \ \ }
\DoxyCodeLine{01417\ \ \ \ \ hCov-\/>GetXaxis()-\/>SetBinLabel(i+1,\ titlex);}
\DoxyCodeLine{01418\ \ \ \ \ hCovSq-\/>GetXaxis()-\/>SetBinLabel(i+1,\ titlex);}
\DoxyCodeLine{01419\ \ \ \ \ hCorr-\/>GetXaxis()-\/>SetBinLabel(i+1,\ titlex);}
\DoxyCodeLine{01420\ }
\DoxyCodeLine{01421\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{01422\ \ \ \ \ \{}
\DoxyCodeLine{01423\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ value\ of\ the\ Covariance}}
\DoxyCodeLine{01424\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ cov\ =\ (*Covariance)(i,j);}
\DoxyCodeLine{01425\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ corr\ =\ (*Correlation)(i,j);}
\DoxyCodeLine{01426\ }
\DoxyCodeLine{01427\ \ \ \ \ \ \ hCov-\/>SetBinContent(i+1,\ j+1,\ cov);}
\DoxyCodeLine{01428\ \ \ \ \ \ \ hCovSq-\/>SetBinContent(i+1,\ j+1,\ ((cov\ >\ 0)\ -\/\ (cov\ <\ 0))*std::sqrt(std::fabs(cov)));}
\DoxyCodeLine{01429\ \ \ \ \ \ \ hCorr-\/>SetBinContent(i+1,\ j+1,\ corr);}
\DoxyCodeLine{01430\ }
\DoxyCodeLine{01431\ \ \ \ \ \ \ TString\ titley\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{01432\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ nom\_j,\ err\_j;}
\DoxyCodeLine{01433\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(j,\ nom\_j,\ err\_j,\ titley);}
\DoxyCodeLine{01434\ }
\DoxyCodeLine{01435\ \ \ \ \ \ \ hCov-\/>GetYaxis()-\/>SetBinLabel(j+1,\ titley);}
\DoxyCodeLine{01436\ \ \ \ \ \ \ hCovSq-\/>GetYaxis()-\/>SetBinLabel(j+1,\ titley);}
\DoxyCodeLine{01437\ \ \ \ \ \ \ hCorr-\/>GetYaxis()-\/>SetBinLabel(j+1,\ titley);}
\DoxyCodeLine{01438\ \ \ \ \ \}}
\DoxyCodeLine{01439\ \ \ \}}
\DoxyCodeLine{01440\ }
\DoxyCodeLine{01441\ \ \ \textcolor{comment}{//\ Take\ away\ the\ stat\ box}}
\DoxyCodeLine{01442\ \ \ gStyle-\/>SetOptStat(0);}
\DoxyCodeLine{01443\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aa7611f55ac3c0ea70607761d037fbd91}{plotBinValue}})gStyle-\/>SetPaintTextFormat(\textcolor{stringliteral}{"{}4.1f"{}});\ \textcolor{comment}{//Precision\ of\ value\ in\ matrix\ element}}
\DoxyCodeLine{01444\ \ \ \textcolor{comment}{//\ Make\ pretty\ Correlation\ colors\ (red\ to\ blue)}}
\DoxyCodeLine{01445\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ NRGBs\ =\ 5;}
\DoxyCodeLine{01446\ \ \ TColor::InitializeColors();}
\DoxyCodeLine{01447\ \ \ Double\_t\ stops[NRGBs]\ =\ \{\ 0.00,\ 0.25,\ 0.50,\ 0.75,\ 1.00\ \};}
\DoxyCodeLine{01448\ \ \ Double\_t\ red[NRGBs]\ \ \ =\ \{\ 0.00,\ 0.25,\ 1.00,\ 1.00,\ 0.50\ \};}
\DoxyCodeLine{01449\ \ \ Double\_t\ green[NRGBs]\ =\ \{\ 0.00,\ 0.25,\ 1.00,\ 0.25,\ 0.00\ \};}
\DoxyCodeLine{01450\ \ \ Double\_t\ blue[NRGBs]\ \ =\ \{\ 0.50,\ 1.00,\ 1.00,\ 0.25,\ 0.00\ \};}
\DoxyCodeLine{01451\ \ \ TColor::CreateGradientColorTable(5,\ stops,\ red,\ green,\ blue,\ 255);}
\DoxyCodeLine{01452\ \ \ gStyle-\/>SetNumberContours(255);}
\DoxyCodeLine{01453\ }
\DoxyCodeLine{01454\ \ \ \textcolor{comment}{//\ cd\ into\ the\ correlation\ directory}}
\DoxyCodeLine{01455\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{01456\ }
\DoxyCodeLine{01457\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>cd();}
\DoxyCodeLine{01458\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Clear();}
\DoxyCodeLine{01459\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aa7611f55ac3c0ea70607761d037fbd91}{plotBinValue}})\ hCov-\/>Draw(\textcolor{stringliteral}{"{}colz\ text"{}});}
\DoxyCodeLine{01460\ \ \ \textcolor{keywordflow}{else}\ hCov-\/>Draw(\textcolor{stringliteral}{"{}colz"{}});}
\DoxyCodeLine{01461\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{01462\ }
\DoxyCodeLine{01463\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>cd();}
\DoxyCodeLine{01464\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Clear();}
\DoxyCodeLine{01465\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aa7611f55ac3c0ea70607761d037fbd91}{plotBinValue}})\ hCorr-\/>Draw(\textcolor{stringliteral}{"{}colz\ text"{}});}
\DoxyCodeLine{01466\ \ \ \textcolor{keywordflow}{else}\ hCorr-\/>Draw(\textcolor{stringliteral}{"{}colz"{}});}
\DoxyCodeLine{01467\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{01468\ }
\DoxyCodeLine{01469\ \ \ hCov-\/>Write(\textcolor{stringliteral}{"{}Covariance\_plot"{}});}
\DoxyCodeLine{01470\ \ \ hCovSq-\/>Write(\textcolor{stringliteral}{"{}Covariance\_sq\_plot"{}});}
\DoxyCodeLine{01471\ \ \ hCorr-\/>Write(\textcolor{stringliteral}{"{}Correlation\_plot"{}});}
\DoxyCodeLine{01472\ \ \ }
\DoxyCodeLine{01473\ \ \ \textcolor{comment}{//Back\ to\ normal}}
\DoxyCodeLine{01474\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetRightMargin(RightMargin);}
\DoxyCodeLine{01475\ \ \ \mbox{\hyperlink{classMCMCProcessor_a5b0961bcb0eea7a347e6a29ef7738d80}{DrawCorrelations1D}}();}
\DoxyCodeLine{01476\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_ab420de77e598da4b02ba74cdc20f2ea9}\label{classMCMCProcessor_ab420de77e598da4b02ba74cdc20f2ea9}} 
\index{MCMCProcessor@{MCMCProcessor}!DrawPostfit@{DrawPostfit}}
\index{DrawPostfit@{DrawPostfit}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{DrawPostfit()}{DrawPostfit()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Draw\+Postfit (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Draw the post-\/fit comparisons. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l00441}{441}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00442\ \textcolor{comment}{//\ *******************}}
\DoxyCodeLine{00443\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_aa5a7761e97cf2e24c7d877a5374b7333}{MakeOutputFile}}();}
\DoxyCodeLine{00444\ }
\DoxyCodeLine{00445\ \ \ \textcolor{comment}{//\ Make\ the\ prefit\ plot}}
\DoxyCodeLine{00446\ \ \ TH1D*\ prefit\ =\ \mbox{\hyperlink{classMCMCProcessor_a03267ff95cb0f4dab0882db852893768}{MakePrefit}}();}
\DoxyCodeLine{00447\ }
\DoxyCodeLine{00448\ \ \ \textcolor{comment}{//\ cd\ into\ the\ output\ file}}
\DoxyCodeLine{00449\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{00450\ \ }
\DoxyCodeLine{00451\ \ \ std::string\ CutPosterior1D\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00452\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a85917e25c4f5b5b966c50cccd9ddd6a0}{Posterior1DCut}}\ !=\ \textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{00453\ \ \ \{}
\DoxyCodeLine{00454\ \ \ \ \ CutPosterior1D\ =\ \mbox{\hyperlink{classMCMCProcessor_a576f0eb874afaf7e31ff5c86b9e5b8f9}{StepCut}}\ +\textcolor{stringliteral}{"{}\ \&\&\ "{}}\ +\ \mbox{\hyperlink{classMCMCProcessor_a85917e25c4f5b5b966c50cccd9ddd6a0}{Posterior1DCut}};}
\DoxyCodeLine{00455\ \ \ \}}
\DoxyCodeLine{00456\ \ \ \textcolor{keywordflow}{else}\ CutPosterior1D\ =\ \mbox{\hyperlink{classMCMCProcessor_a576f0eb874afaf7e31ff5c86b9e5b8f9}{StepCut}};}
\DoxyCodeLine{00457\ }
\DoxyCodeLine{00458\ \ \ \textcolor{comment}{//\ Make\ a\ TH1D\ of\ the\ central\ values\ and\ the\ errors}}
\DoxyCodeLine{00459\ \ \ TH1D\ *paramPlot\ =\ \textcolor{keyword}{new}\ TH1D(\textcolor{stringliteral}{"{}paramPlot"{}},\ \textcolor{stringliteral}{"{}paramPlot"{}},\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{00460\ \ \ paramPlot-\/>SetName(\textcolor{stringliteral}{"{}mach3params"{}});}
\DoxyCodeLine{00461\ \ \ paramPlot-\/>SetTitle(CutPosterior1D.c\_str());}
\DoxyCodeLine{00462\ \ \ paramPlot-\/>SetFillStyle(3001);}
\DoxyCodeLine{00463\ \ \ paramPlot-\/>SetFillColor(kBlue-\/1);}
\DoxyCodeLine{00464\ \ \ paramPlot-\/>SetMarkerColor(paramPlot-\/>GetFillColor());}
\DoxyCodeLine{00465\ \ \ paramPlot-\/>SetMarkerStyle(20);}
\DoxyCodeLine{00466\ \ \ paramPlot-\/>SetLineColor(paramPlot-\/>GetFillColor());}
\DoxyCodeLine{00467\ \ \ paramPlot-\/>SetMarkerSize(prefit-\/>GetMarkerSize());}
\DoxyCodeLine{00468\ }
\DoxyCodeLine{00469\ \ \ \textcolor{comment}{//\ Same\ but\ with\ Gaussian\ output}}
\DoxyCodeLine{00470\ \ \ TH1D\ *paramPlot\_Gauss\ =\ \textcolor{keyword}{static\_cast<}TH1D*\textcolor{keyword}{>}(paramPlot-\/>Clone());}
\DoxyCodeLine{00471\ \ \ paramPlot\_Gauss-\/>SetMarkerColor(kOrange-\/5);}
\DoxyCodeLine{00472\ \ \ paramPlot\_Gauss-\/>SetMarkerStyle(23);}
\DoxyCodeLine{00473\ \ \ paramPlot\_Gauss-\/>SetLineWidth(2);}
\DoxyCodeLine{00474\ \ \ paramPlot\_Gauss-\/>SetMarkerSize((prefit-\/>GetMarkerSize())*0.75);}
\DoxyCodeLine{00475\ \ \ paramPlot\_Gauss-\/>SetFillColor(paramPlot\_Gauss-\/>GetMarkerColor());}
\DoxyCodeLine{00476\ \ \ paramPlot\_Gauss-\/>SetFillStyle(3244);}
\DoxyCodeLine{00477\ \ \ paramPlot\_Gauss-\/>SetLineColor(paramPlot\_Gauss-\/>GetMarkerColor());}
\DoxyCodeLine{00478\ }
\DoxyCodeLine{00479\ \ \ \textcolor{comment}{//\ Same\ but\ with\ Gaussian\ output}}
\DoxyCodeLine{00480\ \ \ TH1D\ *paramPlot\_HPD\ =\ \textcolor{keyword}{static\_cast<}TH1D*\textcolor{keyword}{>}(paramPlot-\/>Clone());}
\DoxyCodeLine{00481\ \ \ paramPlot\_HPD-\/>SetMarkerColor(kBlack);}
\DoxyCodeLine{00482\ \ \ paramPlot\_HPD-\/>SetMarkerStyle(25);}
\DoxyCodeLine{00483\ \ \ paramPlot\_HPD-\/>SetLineWidth(2);}
\DoxyCodeLine{00484\ \ \ paramPlot\_HPD-\/>SetMarkerSize((prefit-\/>GetMarkerSize())*0.5);}
\DoxyCodeLine{00485\ \ \ paramPlot\_HPD-\/>SetFillColor(0);}
\DoxyCodeLine{00486\ \ \ paramPlot\_HPD-\/>SetFillStyle(0);}
\DoxyCodeLine{00487\ \ \ paramPlot\_HPD-\/>SetLineColor(paramPlot\_HPD-\/>GetMarkerColor());}
\DoxyCodeLine{00488\ \ \ }
\DoxyCodeLine{00489\ \ \ \textcolor{comment}{//\ Set\ labels\ and\ data}}
\DoxyCodeLine{00490\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{00491\ \ \ \{}
\DoxyCodeLine{00492\ \ \ \ \ \textcolor{comment}{//Those\ keep\ which\ parameter\ type\ we\ run\ currently\ and\ realtive\ number\ \ }}
\DoxyCodeLine{00493\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamEnu\ =\ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}[i];}
\DoxyCodeLine{00494\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamNo\ =\ i\ -\/\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20b}{ParameterEnum}}(ParamEnu)];}
\DoxyCodeLine{00495\ }
\DoxyCodeLine{00496\ \ \ \ \ \textcolor{comment}{//KS:\ Slightly\ hacky\ way\ to\ get\ relative\ to\ prior\ or\ nominal\ as\ this\ is\ convention\ we\ use}}
\DoxyCodeLine{00497\ \ \ \ \ \textcolor{comment}{//This\ only\ applies\ for\ xsec\ for\ other\ systematic\ types\ doesn't\ matter}}
\DoxyCodeLine{00498\ \ \ \ \ \textcolor{keywordtype}{double}\ CentralValueTemp\ =\ 0;}
\DoxyCodeLine{00499\ \ \ \ \ \textcolor{keywordtype}{double}\ Central,\ Central\_gauss,\ Central\_HPD;}
\DoxyCodeLine{00500\ \ \ \ \ \textcolor{keywordtype}{double}\ Err,\ Err\_Gauss,\ Err\_HPD;}
\DoxyCodeLine{00501\ \ \ \ \ }
\DoxyCodeLine{00502\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_afbac2a114c15ca7db4abe71dd549504c}{plotRelativeToPrior}})}
\DoxyCodeLine{00503\ \ \ \ \ \{}
\DoxyCodeLine{00504\ \ \ \ \ \ \ CentralValueTemp\ =\ \mbox{\hyperlink{classMCMCProcessor_a3a6614826ae320e462211e38e96d9d02}{ParamCentral}}[ParamEnu][ParamNo];}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \textcolor{comment}{//\ Normalise\ the\ prior\ relative\ the\ nominal/prior,\ just\ the\ way\ we\ get\ our\ fit\ results\ in\ MaCh3}}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ CentralValueTemp\ !=\ 0)\ }
\DoxyCodeLine{00507\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \ \ Central\ =\ (*Means)(i)\ /\ CentralValueTemp;}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ Err\ =\ (*Errors)(i)\ /\ CentralValueTemp;}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00511\ \ \ \ \ \ \ \ \ Central\_gauss\ =\ (*Means\_Gauss)(i)\ /\ CentralValueTemp;}
\DoxyCodeLine{00512\ \ \ \ \ \ \ \ \ Err\_Gauss\ =\ (*Errors\_Gauss)(i)\ /\ CentralValueTemp;}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ Central\_HPD\ =\ (*Means\_HPD)(i)\ /\ CentralValueTemp;}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \ \ Err\_HPD\ =\ (*Errors\_HPD)(i)\ /\ CentralValueTemp;}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \}\ }
\DoxyCodeLine{00517\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \ \ Central\ =\ 1+(*Means)(i);}
\DoxyCodeLine{00519\ \ \ \ \ \ \ \ \ Err\ =\ (*Errors)(i);}
\DoxyCodeLine{00520\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00521\ \ \ \ \ \ \ \ \ Central\_gauss\ =\ 1+(*Means\_Gauss)(i);}
\DoxyCodeLine{00522\ \ \ \ \ \ \ \ \ Err\_Gauss\ =\ (*Errors\_Gauss)(i);}
\DoxyCodeLine{00523\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00524\ \ \ \ \ \ \ \ \ Central\_HPD\ =\ 1+(*Means\_HPD)(i)\ ;}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \ \ Err\_HPD\ =\ (*Errors\_HPD)(i);}
\DoxyCodeLine{00526\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00527\ \ \ \ \ \}}
\DoxyCodeLine{00528\ \ \ \ \ \textcolor{comment}{//KS:\ Just\ get\ value\ of\ each\ parameter\ without\ dividing\ by\ prior}}
\DoxyCodeLine{00529\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00530\ \ \ \ \ \{}
\DoxyCodeLine{00531\ \ \ \ \ \ \ Central\ =\ (*Means)(i);}
\DoxyCodeLine{00532\ \ \ \ \ \ \ Err\ =\ (*Errors)(i);}
\DoxyCodeLine{00533\ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00534\ \ \ \ \ \ \ Central\_gauss\ =\ (*Means\_Gauss)(i);}
\DoxyCodeLine{00535\ \ \ \ \ \ \ Err\_Gauss\ =\ (*Errors\_Gauss)(i);}
\DoxyCodeLine{00536\ \ \ \ \ \ \ }
\DoxyCodeLine{00537\ \ \ \ \ \ \ Central\_HPD\ =\ (*Means\_HPD)(i)\ ;}
\DoxyCodeLine{00538\ \ \ \ \ \ \ Err\_HPD\ =\ (*Errors\_HPD)(i);}
\DoxyCodeLine{00539\ \ \ \ \ \}}
\DoxyCodeLine{00540\ \ \ \ \ }
\DoxyCodeLine{00541\ \ \ \ \ paramPlot-\/>SetBinContent(i+1,\ Central);}
\DoxyCodeLine{00542\ \ \ \ \ paramPlot-\/>SetBinError(i+1,\ Err);}
\DoxyCodeLine{00543\ }
\DoxyCodeLine{00544\ \ \ \ \ paramPlot\_Gauss-\/>SetBinContent(i+1,\ Central\_gauss);}
\DoxyCodeLine{00545\ \ \ \ \ paramPlot\_Gauss-\/>SetBinError(i+1,\ Err\_Gauss);}
\DoxyCodeLine{00546\ }
\DoxyCodeLine{00547\ \ \ \ \ paramPlot\_HPD-\/>SetBinContent(i+1,\ Central\_HPD);}
\DoxyCodeLine{00548\ \ \ \ \ paramPlot\_HPD-\/>SetBinError(i+1,\ Err\_HPD);}
\DoxyCodeLine{00549\ \ \ \ \ }
\DoxyCodeLine{00550\ \ \ \ \ paramPlot-\/>GetXaxis()-\/>SetBinLabel(i+1,\ prefit-\/>GetXaxis()-\/>GetBinLabel(i+1));}
\DoxyCodeLine{00551\ \ \ \ \ paramPlot\_Gauss-\/>GetXaxis()-\/>SetBinLabel(i+1,\ prefit-\/>GetXaxis()-\/>GetBinLabel(i+1));}
\DoxyCodeLine{00552\ \ \ \ \ paramPlot\_HPD-\/>GetXaxis()-\/>SetBinLabel(i+1,\ prefit-\/>GetXaxis()-\/>GetBinLabel(i+1));}
\DoxyCodeLine{00553\ \ \ \}}
\DoxyCodeLine{00554\ }
\DoxyCodeLine{00555\ \ \ \textcolor{comment}{//\ Make\ a\ TLegend}}
\DoxyCodeLine{00556\ \ \ \textcolor{keyword}{auto}\ CompLeg\ =\ std::make\_unique<TLegend>(0.33,\ 0.73,\ 0.76,\ 0.95);}
\DoxyCodeLine{00557\ \ \ CompLeg-\/>AddEntry(prefit,\ \textcolor{stringliteral}{"{}Prefit"{}},\ \textcolor{stringliteral}{"{}fp"{}});}
\DoxyCodeLine{00558\ \ \ CompLeg-\/>AddEntry(paramPlot,\ \textcolor{stringliteral}{"{}Postfit\ PDF"{}},\ \textcolor{stringliteral}{"{}fp"{}});}
\DoxyCodeLine{00559\ \ \ CompLeg-\/>AddEntry(paramPlot\_Gauss,\ \textcolor{stringliteral}{"{}Postfit\ Gauss"{}},\ \textcolor{stringliteral}{"{}fp"{}});}
\DoxyCodeLine{00560\ \ \ CompLeg-\/>AddEntry(paramPlot\_HPD,\ \textcolor{stringliteral}{"{}Postfit\ HPD"{}},\ \textcolor{stringliteral}{"{}lfep"{}});}
\DoxyCodeLine{00561\ \ \ CompLeg-\/>SetFillColor(0);}
\DoxyCodeLine{00562\ \ \ CompLeg-\/>SetFillStyle(0);}
\DoxyCodeLine{00563\ \ \ CompLeg-\/>SetLineWidth(0);}
\DoxyCodeLine{00564\ \ \ CompLeg-\/>SetLineStyle(0);}
\DoxyCodeLine{00565\ \ \ CompLeg-\/>SetBorderSize(0);}
\DoxyCodeLine{00566\ }
\DoxyCodeLine{00567\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ BottomMargin\ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetBottomMargin();}
\DoxyCodeLine{00568\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetBottomMargin(0.2);}
\DoxyCodeLine{00569\ }
\DoxyCodeLine{00570\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{00571\ \ \ \textcolor{comment}{//KS:\ Plot\ Xsec\ and\ Flux}}
\DoxyCodeLine{00572\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]\ >\ 0)}
\DoxyCodeLine{00573\ \ \ \{}
\DoxyCodeLine{00574\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ Start\ =\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}];}
\DoxyCodeLine{00575\ \ \ \ \ \textcolor{comment}{//\ Plot\ the\ xsec\ parameters\ (0\ to\ \string~nXsec-\/nFlux)\ nXsec\ ==\ xsec\ +\ flux,\ quite\ confusing\ I\ know}}
\DoxyCodeLine{00576\ \ \ \ \ \textcolor{comment}{//\ Have\ already\ looked\ through\ the\ branches\ earlier}}
\DoxyCodeLine{00577\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_afbac2a114c15ca7db4abe71dd549504c}{plotRelativeToPrior}})\ \ prefit-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Variation\ rel.\ prior"{}});\ }
\DoxyCodeLine{00578\ \ \ \ \ \textcolor{keywordflow}{else}\ prefit-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Parameter\ Value"{}});}
\DoxyCodeLine{00579\ \ \ \ \ prefit-\/>GetYaxis()-\/>SetRangeUser(-\/2.5,\ 2.5);}
\DoxyCodeLine{00580\ \ \ \ \ prefit-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00581\ \ \ \ \ prefit-\/>GetXaxis()-\/>LabelsOption(\textcolor{stringliteral}{"{}v"{}});}
\DoxyCodeLine{00582\ }
\DoxyCodeLine{00583\ \ \ \ \ prefit-\/>GetXaxis()-\/>SetRangeUser(Start,\ Start\ +\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]-\/\mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}});}
\DoxyCodeLine{00584\ \ \ \ \ paramPlot-\/>GetXaxis()-\/>SetRangeUser(Start,\ Start\ +\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]-\/\mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}});}
\DoxyCodeLine{00585\ \ \ \ \ paramPlot\_Gauss-\/>GetXaxis()-\/>SetRangeUser(Start,\ Start+\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]-\/\mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}});}
\DoxyCodeLine{00586\ \ \ \ \ paramPlot\_HPD-\/>GetXaxis()-\/>SetRangeUser(Start,\ Start\ +\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]-\/\mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}});}
\DoxyCodeLine{00587\ }
\DoxyCodeLine{00588\ \ \ \ \ \textcolor{comment}{//\ Write\ the\ individual\ ones}}
\DoxyCodeLine{00589\ \ \ \ \ prefit-\/>Write(\textcolor{stringliteral}{"{}param\_xsec\_prefit"{}});}
\DoxyCodeLine{00590\ \ \ \ \ paramPlot-\/>Write(\textcolor{stringliteral}{"{}param\_xsec"{}});}
\DoxyCodeLine{00591\ \ \ \ \ paramPlot\_Gauss-\/>Write(\textcolor{stringliteral}{"{}param\_xsec\_gaus"{}});}
\DoxyCodeLine{00592\ \ \ \ \ paramPlot\_HPD-\/>Write(\textcolor{stringliteral}{"{}param\_xsec\_HPD"{}});}
\DoxyCodeLine{00593\ \ \ \ \ }
\DoxyCodeLine{00594\ \ \ \ \ \textcolor{comment}{//\ And\ the\ combined}}
\DoxyCodeLine{00595\ \ \ \ \ prefit-\/>Draw(\textcolor{stringliteral}{"{}e2"{}});}
\DoxyCodeLine{00596\ \ \ \ \ paramPlot-\/>Draw(\textcolor{stringliteral}{"{}e2,\ same"{}});}
\DoxyCodeLine{00597\ \ \ \ \ paramPlot\_Gauss-\/>Draw(\textcolor{stringliteral}{"{}e2,\ same"{}});}
\DoxyCodeLine{00598\ \ \ \ \ paramPlot\_HPD-\/>Draw(\textcolor{stringliteral}{"{}e1,\ same"{}});}
\DoxyCodeLine{00599\ \ \ \ \ CompLeg-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{00600\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Write(\textcolor{stringliteral}{"{}param\_xsec\_canv"{}});}
\DoxyCodeLine{00601\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{00602\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Clear();}
\DoxyCodeLine{00603\ \ \ }
\DoxyCodeLine{00604\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{00605\ \ \ \ \ \textcolor{comment}{//\ Plot\ the\ flux\ parameters\ (nXSec\ to\ nxsec+nflux)\ if\ enabled}}
\DoxyCodeLine{00606\ \ \ \ \ \textcolor{comment}{//\ Have\ already\ looked\ through\ the\ branches\ earlier}}
\DoxyCodeLine{00607\ \ \ \ \ prefit-\/>GetYaxis()-\/>SetRangeUser(0.7,\ 1.3);}
\DoxyCodeLine{00608\ \ \ \ \ paramPlot-\/>GetYaxis()-\/>SetRangeUser(0.7,\ 1.3);}
\DoxyCodeLine{00609\ \ \ \ \ paramPlot\_Gauss-\/>GetYaxis()-\/>SetRangeUser(0.7,\ 1.3);}
\DoxyCodeLine{00610\ \ \ \ \ paramPlot\_HPD-\/>GetYaxis()-\/>SetRangeUser(0.7,\ 1.3);}
\DoxyCodeLine{00611\ \ \ \ \ }
\DoxyCodeLine{00612\ \ \ \ \ prefit-\/>GetXaxis()-\/>SetRangeUser(Start\ +\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]-\/\mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}},\ Start\ +\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]);}
\DoxyCodeLine{00613\ \ \ \ \ paramPlot-\/>GetXaxis()-\/>SetRangeUser(Start\ +\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]-\/\mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}},\ Start\ +\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]);}
\DoxyCodeLine{00614\ \ \ \ \ paramPlot\_Gauss-\/>GetXaxis()-\/>SetRangeUser(Start\ +\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]-\/\mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}},\ Start\ +\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]);}
\DoxyCodeLine{00615\ \ \ \ \ paramPlot\_HPD-\/>GetXaxis()-\/>SetRangeUser(Start\ +\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]-\/\mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}},\ Start\ +\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]);}
\DoxyCodeLine{00616\ }
\DoxyCodeLine{00617\ \ \ \ \ prefit-\/>Write(\textcolor{stringliteral}{"{}param\_flux\_prefit"{}});}
\DoxyCodeLine{00618\ \ \ \ \ paramPlot-\/>Write(\textcolor{stringliteral}{"{}param\_flux"{}});}
\DoxyCodeLine{00619\ \ \ \ \ paramPlot\_Gauss-\/>Write(\textcolor{stringliteral}{"{}param\_flux\_gaus"{}});}
\DoxyCodeLine{00620\ \ \ \ \ paramPlot\_HPD-\/>Write(\textcolor{stringliteral}{"{}param\_flux\_HPD"{}});}
\DoxyCodeLine{00621\ }
\DoxyCodeLine{00622\ \ \ \ \ prefit-\/>Draw(\textcolor{stringliteral}{"{}e2"{}});}
\DoxyCodeLine{00623\ \ \ \ \ paramPlot-\/>Draw(\textcolor{stringliteral}{"{}e2,\ same"{}});}
\DoxyCodeLine{00624\ \ \ \ \ paramPlot\_Gauss-\/>Draw(\textcolor{stringliteral}{"{}e1,\ same"{}});}
\DoxyCodeLine{00625\ \ \ \ \ paramPlot\_HPD-\/>Draw(\textcolor{stringliteral}{"{}e1,\ same"{}});}
\DoxyCodeLine{00626\ \ \ \ \ CompLeg-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{00627\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Write(\textcolor{stringliteral}{"{}param\_flux\_canv"{}});}
\DoxyCodeLine{00628\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{00629\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Clear();}
\DoxyCodeLine{00630\ \ \ \}}
\DoxyCodeLine{00631\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}]\ >\ 0)}
\DoxyCodeLine{00632\ \ \ \{}
\DoxyCodeLine{00633\ \ \ \ \ \textcolor{keywordtype}{int}\ Start\ =\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}];}
\DoxyCodeLine{00634\ \ \ \ \ \textcolor{keywordtype}{int}\ NDbinCounter\ =\ Start;}
\DoxyCodeLine{00635\ \ \ \ \ \textcolor{comment}{//KS:\ Make\ prefit\ postfit\ for\ each\ ND\ sample,\ having\ all\ of\ them\ at\ the\ same\ plot\ is\ unreadable}}
\DoxyCodeLine{00636\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a27c8a25155baab660fc9658861c433ab}{NDSamplesNames}}.size();\ i++\ )}
\DoxyCodeLine{00637\ \ \ \ \ \{}
\DoxyCodeLine{00638\ \ \ \ \ \ \ std::string\ NDname\ =\ \mbox{\hyperlink{classMCMCProcessor_a27c8a25155baab660fc9658861c433ab}{NDSamplesNames}}[i];}
\DoxyCodeLine{00639\ \ \ \ \ \ \ NDbinCounter\ +=\ \mbox{\hyperlink{classMCMCProcessor_ae76b02ce85737d30c778698ba127933b}{NDSamplesBins}}[i];}
\DoxyCodeLine{00640\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{00641\ \ \ \ \ \ \ prefit-\/>GetYaxis()-\/>SetTitle((\textcolor{stringliteral}{"{}Variation\ for\ "{}}+NDname).c\_str());}
\DoxyCodeLine{00642\ \ \ \ \ \ \ prefit-\/>GetYaxis()-\/>SetRangeUser(0.6,\ 1.4);}
\DoxyCodeLine{00643\ \ \ \ \ \ \ prefit-\/>GetXaxis()-\/>SetRangeUser(Start,\ NDbinCounter);}
\DoxyCodeLine{00644\ \ \ \ \ \ \ prefit-\/>GetXaxis()-\/>SetTitle();}
\DoxyCodeLine{00645\ \ \ \ \ \ \ prefit-\/>GetXaxis()-\/>LabelsOption(\textcolor{stringliteral}{"{}v"{}});}
\DoxyCodeLine{00646\ }
\DoxyCodeLine{00647\ \ \ \ \ \ \ paramPlot-\/>GetYaxis()-\/>SetTitle((\textcolor{stringliteral}{"{}Variation\ for\ "{}}+NDname).c\_str());}
\DoxyCodeLine{00648\ \ \ \ \ \ \ paramPlot-\/>GetYaxis()-\/>SetRangeUser(0.6,\ 1.4);}
\DoxyCodeLine{00649\ \ \ \ \ \ \ paramPlot-\/>GetXaxis()-\/>SetRangeUser(Start,\ NDbinCounter);}
\DoxyCodeLine{00650\ \ \ \ \ \ \ paramPlot-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00651\ \ \ \ \ \ \ paramPlot-\/>SetTitle(CutPosterior1D.c\_str());}
\DoxyCodeLine{00652\ \ \ \ \ \ \ paramPlot-\/>GetXaxis()-\/>LabelsOption(\textcolor{stringliteral}{"{}v"{}});}
\DoxyCodeLine{00653\ }
\DoxyCodeLine{00654\ \ \ \ \ \ \ paramPlot\_Gauss-\/>GetYaxis()-\/>SetTitle((\textcolor{stringliteral}{"{}Variation\ for\ "{}}+NDname).c\_str());}
\DoxyCodeLine{00655\ \ \ \ \ \ \ paramPlot\_Gauss-\/>GetYaxis()-\/>SetRangeUser(0.6,\ 1.4);}
\DoxyCodeLine{00656\ \ \ \ \ \ \ paramPlot\_Gauss-\/>GetXaxis()-\/>SetRangeUser(Start,\ NDbinCounter);}
\DoxyCodeLine{00657\ \ \ \ \ \ \ paramPlot\_Gauss-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00658\ \ \ \ \ \ \ paramPlot\_Gauss-\/>SetTitle(CutPosterior1D.c\_str());}
\DoxyCodeLine{00659\ \ \ \ \ \ \ paramPlot\_Gauss-\/>GetXaxis()-\/>LabelsOption(\textcolor{stringliteral}{"{}v"{}});}
\DoxyCodeLine{00660\ }
\DoxyCodeLine{00661\ \ \ \ \ \ \ paramPlot\_HPD-\/>GetYaxis()-\/>SetTitle((\textcolor{stringliteral}{"{}Variation\ for\ "{}}+NDname).c\_str());}
\DoxyCodeLine{00662\ \ \ \ \ \ \ paramPlot\_HPD-\/>GetYaxis()-\/>SetRangeUser(0.6,\ 1.4);}
\DoxyCodeLine{00663\ \ \ \ \ \ \ paramPlot\_HPD-\/>GetXaxis()-\/>SetRangeUser(Start,\ NDbinCounter);}
\DoxyCodeLine{00664\ \ \ \ \ \ \ paramPlot\_HPD-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00665\ \ \ \ \ \ \ paramPlot\_HPD-\/>SetTitle(CutPosterior1D.c\_str());}
\DoxyCodeLine{00666\ \ \ \ \ \ \ paramPlot\_HPD-\/>GetXaxis()-\/>LabelsOption(\textcolor{stringliteral}{"{}v"{}});}
\DoxyCodeLine{00667\ }
\DoxyCodeLine{00668\ \ \ \ \ \ \ prefit-\/>Write((\textcolor{stringliteral}{"{}param\_"{}}+NDname+\textcolor{stringliteral}{"{}\_prefit"{}}).c\_str());}
\DoxyCodeLine{00669\ \ \ \ \ \ \ paramPlot-\/>Write((\textcolor{stringliteral}{"{}param\_"{}}+NDname).c\_str());}
\DoxyCodeLine{00670\ \ \ \ \ \ \ paramPlot\_Gauss-\/>Write((\textcolor{stringliteral}{"{}param\_"{}}+NDname+\textcolor{stringliteral}{"{}\_gaus"{}}).c\_str());}
\DoxyCodeLine{00671\ \ \ \ \ \ \ paramPlot\_HPD-\/>Write((\textcolor{stringliteral}{"{}param\_"{}}+NDname+\textcolor{stringliteral}{"{}\_HPD"{}}).c\_str());}
\DoxyCodeLine{00672\ }
\DoxyCodeLine{00673\ \ \ \ \ \ \ prefit-\/>Draw(\textcolor{stringliteral}{"{}e2"{}});}
\DoxyCodeLine{00674\ \ \ \ \ \ \ paramPlot-\/>Draw(\textcolor{stringliteral}{"{}e2,\ same"{}});}
\DoxyCodeLine{00675\ \ \ \ \ \ \ paramPlot\_Gauss-\/>Draw(\textcolor{stringliteral}{"{}e1,\ same"{}});}
\DoxyCodeLine{00676\ \ \ \ \ \ \ paramPlot\_HPD-\/>Draw(\textcolor{stringliteral}{"{}e1,\ same"{}});}
\DoxyCodeLine{00677\ \ \ \ \ \ \ CompLeg-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{00678\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Write((\textcolor{stringliteral}{"{}param\_"{}}+NDname+\textcolor{stringliteral}{"{}\_canv"{}}).c\_str());}
\DoxyCodeLine{00679\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{00680\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Clear();}
\DoxyCodeLine{00681\ \ \ \ \ \ \ Start\ +=\ \mbox{\hyperlink{classMCMCProcessor_ae76b02ce85737d30c778698ba127933b}{NDSamplesBins}}[i];}
\DoxyCodeLine{00682\ \ \ \ \ \}}
\DoxyCodeLine{00683\ \ \ \}}
\DoxyCodeLine{00684\ \ \ \textcolor{keyword}{delete}\ prefit;}
\DoxyCodeLine{00685\ \ \ \textcolor{keyword}{delete}\ paramPlot;}
\DoxyCodeLine{00686\ \ \ \textcolor{keyword}{delete}\ paramPlot\_Gauss;}
\DoxyCodeLine{00687\ \ \ \textcolor{keyword}{delete}\ paramPlot\_HPD;}
\DoxyCodeLine{00688\ }
\DoxyCodeLine{00689\ \ \ \textcolor{comment}{//KS:\ Return\ Margin\ to\ default\ one}}
\DoxyCodeLine{00690\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetBottomMargin(BottomMargin);}
\DoxyCodeLine{00691\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_aea15e730ff77556bb93bc4cff675744c}\label{classMCMCProcessor_aea15e730ff77556bb93bc4cff675744c}} 
\index{MCMCProcessor@{MCMCProcessor}!FindInputFiles@{FindInputFiles}}
\index{FindInputFiles@{FindInputFiles}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{FindInputFiles()}{FindInputFiles()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Find\+Input\+Files (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Read the output MCMC file and find what inputs were used. 

\begin{DoxyWarning}{Warning}
There is bit of hardcoding for names so we should revisit it 
\end{DoxyWarning}


Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l02404}{2404}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02404\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02405\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{02406\ \ \ \textcolor{comment}{//\ Now\ read\ the\ MCMC\ file}}
\DoxyCodeLine{02407\ \ \ TFile\ *TempFile\ =\ \textcolor{keyword}{new}\ TFile(\mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}}.c\_str(),\ \textcolor{stringliteral}{"{}open"{}});}
\DoxyCodeLine{02408\ \ \ TDirectory*\ CovarianceFolder\ =\ TempFile-\/>Get<TDirectory>(\textcolor{stringliteral}{"{}CovarianceFolder"{}});}
\DoxyCodeLine{02409\ }
\DoxyCodeLine{02410\ \ \ \textcolor{comment}{//\ Get\ the\ settings\ for\ the\ MCMC}}
\DoxyCodeLine{02411\ \ \ TMacro\ *Config\ =\ TempFile-\/>Get<TMacro>(\textcolor{stringliteral}{"{}MaCh3\_Config"{}});}
\DoxyCodeLine{02412\ }
\DoxyCodeLine{02413\ \ \ \textcolor{keywordflow}{if}\ (Config\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{02414\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Didn't\ find\ MaCh3\_Config\ tree\ in\ MCMC\ file!\ \{\}"{}},\ \mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}});}
\DoxyCodeLine{02415\ \ \ \ \ TempFile-\/>ls();}
\DoxyCodeLine{02416\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{02417\ \ \ \}}
\DoxyCodeLine{02418\ \ \ \textcolor{comment}{//KS:Most\ inputs\ are\ in\ \$\{MACH3\}/inputs/blarb.root}}
\DoxyCodeLine{02419\ \ \ \textcolor{keywordflow}{if}\ (std::getenv(\textcolor{stringliteral}{"{}MACH3"{}})\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{02420\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Found\ MACH3\ environment\ variable:\ \{\}"{}},\ std::getenv(\textcolor{stringliteral}{"{}MACH3"{}}));}
\DoxyCodeLine{02421\ \ \ \}}
\DoxyCodeLine{02422\ }
\DoxyCodeLine{02423\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Loading\ YAML\ config\ from\ MCMC\ chain"{}});}
\DoxyCodeLine{02424\ }
\DoxyCodeLine{02425\ \ \ YAML::Node\ Settings\ =\ \mbox{\hyperlink{YamlHelper_8h_a7e0ade2fd295a927676c243c97d0aa64}{TMacroToYAML}}(*Config);}
\DoxyCodeLine{02426\ }
\DoxyCodeLine{02427\ \ \ \textcolor{keywordtype}{bool}\ InputNotFound\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02428\ \ \ \textcolor{comment}{//CW:\ Get\ the\ xsec\ Covariance\ matrix}}
\DoxyCodeLine{02429\ \ \ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]\ =\ GetFromManager<std::vector<std::string>>(Settings[\textcolor{stringliteral}{"{}General"{}}][\textcolor{stringliteral}{"{}Systematics"{}}][\textcolor{stringliteral}{"{}XsecCovFile"{}}],\ \{\textcolor{stringliteral}{"{}none"{}}\});}
\DoxyCodeLine{02430\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}].back()\ ==\ \textcolor{stringliteral}{"{}none"{}})}
\DoxyCodeLine{02431\ \ \ \{}
\DoxyCodeLine{02432\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Couldn't\ find\ XsecCov\ branch\ in\ output"{}});}
\DoxyCodeLine{02433\ \ \ \ \ InputNotFound\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02434\ \ \ \}}
\DoxyCodeLine{02435\ }
\DoxyCodeLine{02436\ }
\DoxyCodeLine{02437\ \ \ TMacro\ *XsecConfig\ =\ CovarianceFolder-\/>Get<TMacro>(\textcolor{stringliteral}{"{}Config\_xsec\_cov"{}});}
\DoxyCodeLine{02438\ \ \ \textcolor{keywordflow}{if}\ (XsecConfig\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{02439\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Didn't\ find\ Config\_xsec\_cov\ tree\ in\ MCMC\ file!\ \{\}"{}},\ \mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}});}
\DoxyCodeLine{02440\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02441\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4c1330a025c0b91e382bdc29c960424a}{CovConfig}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]\ =\ \mbox{\hyperlink{YamlHelper_8h_a7e0ade2fd295a927676c243c97d0aa64}{TMacroToYAML}}(*XsecConfig);}
\DoxyCodeLine{02442\ \ \ \}}
\DoxyCodeLine{02443\ \ \ \textcolor{comment}{//CW:\ And\ the\ ND\ Covariance\ matrix}}
\DoxyCodeLine{02444\ \ \ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}].push\_back(GetFromManager<std::string>(Settings[\textcolor{stringliteral}{"{}General"{}}][\textcolor{stringliteral}{"{}Systematics"{}}][\textcolor{stringliteral}{"{}NDCovFile"{}}],\ \textcolor{stringliteral}{"{}none"{}}));}
\DoxyCodeLine{02445\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}].back()\ ==\ \textcolor{stringliteral}{"{}none"{}})\ \{}
\DoxyCodeLine{02446\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Couldn't\ find\ NDCov\ branch\ in\ output"{}});}
\DoxyCodeLine{02447\ \ \ \ \ InputNotFound\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02448\ \ \ \}}
\DoxyCodeLine{02449\ }
\DoxyCodeLine{02450\ \ \ \textcolor{comment}{//CW:\ And\ the\ FD\ Covariance\ matrix}}
\DoxyCodeLine{02451\ \ \ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}].push\_back(GetFromManager<std::string>(Settings[\textcolor{stringliteral}{"{}General"{}}][\textcolor{stringliteral}{"{}Systematics"{}}][\textcolor{stringliteral}{"{}FDCovFile"{}}],\ \textcolor{stringliteral}{"{}none"{}}));}
\DoxyCodeLine{02452\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}].back()\ ==\ \textcolor{stringliteral}{"{}none"{}})\ \{}
\DoxyCodeLine{02453\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Couldn't\ find\ FDCov\ branch\ in\ output"{}});}
\DoxyCodeLine{02454\ \ \ \ \ InputNotFound\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02455\ \ \ \}}
\DoxyCodeLine{02456\ }
\DoxyCodeLine{02457\ \ \ \textcolor{comment}{//CW:\ And\ the\ Osc\ Covariance\ matrix}}
\DoxyCodeLine{02458\ \ \ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}]\ =\ GetFromManager<std::vector<std::string>>(Settings[\textcolor{stringliteral}{"{}General"{}}][\textcolor{stringliteral}{"{}Systematics"{}}][\textcolor{stringliteral}{"{}OscCovFile"{}}],\ \{\textcolor{stringliteral}{"{}none"{}}\});}
\DoxyCodeLine{02459\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}].back()\ ==\ \textcolor{stringliteral}{"{}none"{}})\ \{}
\DoxyCodeLine{02460\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Couldn't\ find\ OscCov\ branch\ in\ output"{}});}
\DoxyCodeLine{02461\ \ \ \ \ InputNotFound\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02462\ \ \ \}}
\DoxyCodeLine{02463\ \ \ TMacro\ *OscConfig\ =\ CovarianceFolder-\/>Get<TMacro>(\textcolor{stringliteral}{"{}Config\_osc\_cov"{}});}
\DoxyCodeLine{02464\ \ \ \textcolor{keywordflow}{if}\ (OscConfig\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{02465\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Didn't\ find\ Config\_osc\_cov\ tree\ in\ MCMC\ file!\ \{\}"{}},\ \mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}});}
\DoxyCodeLine{02466\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02467\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4c1330a025c0b91e382bdc29c960424a}{CovConfig}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}]\ =\ \ \mbox{\hyperlink{YamlHelper_8h_a7e0ade2fd295a927676c243c97d0aa64}{TMacroToYAML}}(*OscConfig);}
\DoxyCodeLine{02468\ \ \ \}}
\DoxyCodeLine{02469\ }
\DoxyCodeLine{02470\ \ \ \textcolor{keywordflow}{if}(InputNotFound)\ \mbox{\hyperlink{namespaceMaCh3Utils_aaf39f873ebf93550a417418e583ebcf8}{MaCh3Utils::PrintConfig}}(Settings);}
\DoxyCodeLine{02471\ }
\DoxyCodeLine{02472\ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\ mach3\_env\ =\ std::getenv(\textcolor{stringliteral}{"{}MACH3"{}}))}
\DoxyCodeLine{02473\ \ \ \{}
\DoxyCodeLine{02474\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}].size();\ i++)}
\DoxyCodeLine{02475\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}][i].insert(0,\ std::string(mach3\_env)+\textcolor{stringliteral}{"{}/"{}});}
\DoxyCodeLine{02476\ }
\DoxyCodeLine{02477\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}].size();\ i++)}
\DoxyCodeLine{02478\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}][i].insert(0,\ std::string(mach3\_env)+\textcolor{stringliteral}{"{}/"{}});}
\DoxyCodeLine{02479\ }
\DoxyCodeLine{02480\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}].size();\ i++)}
\DoxyCodeLine{02481\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}][i].insert(0,\ std::string(mach3\_env)+\textcolor{stringliteral}{"{}/"{}});}
\DoxyCodeLine{02482\ }
\DoxyCodeLine{02483\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}].size();\ i++)}
\DoxyCodeLine{02484\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}][i].insert(0,\ std::string(mach3\_env)+\textcolor{stringliteral}{"{}/"{}});}
\DoxyCodeLine{02485\ \ \ \}}
\DoxyCodeLine{02486\ }
\DoxyCodeLine{02487\ \ \ \textcolor{comment}{//\ Delete\ the\ TTrees\ and\ the\ input\ file\ handle\ since\ we've\ now\ got\ the\ settings\ we\ need}}
\DoxyCodeLine{02488\ \ \ \textcolor{keyword}{delete}\ Config;}
\DoxyCodeLine{02489\ \ \ \textcolor{keyword}{delete}\ XsecConfig;}
\DoxyCodeLine{02490\ \ \ \textcolor{keyword}{delete}\ OscConfig;}
\DoxyCodeLine{02491\ }
\DoxyCodeLine{02492\ \ \ \textcolor{comment}{//\ Delete\ the\ MCMCFile\ pointer\ we're\ reading}}
\DoxyCodeLine{02493\ \ \ CovarianceFolder-\/>Close();}
\DoxyCodeLine{02494\ \ \ \textcolor{keyword}{delete}\ CovarianceFolder;}
\DoxyCodeLine{02495\ \ \ TempFile-\/>Close();}
\DoxyCodeLine{02496\ \ \ \textcolor{keyword}{delete}\ TempFile;}
\DoxyCodeLine{02497\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a1fc5adc3c109227e6ead71eb0746ec4d}\label{classMCMCProcessor_a1fc5adc3c109227e6ead71eb0746ec4d}} 
\index{MCMCProcessor@{MCMCProcessor}!GetBayesFactor@{GetBayesFactor}}
\index{GetBayesFactor@{GetBayesFactor}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GetBayesFactor()}{GetBayesFactor()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Get\+Bayes\+Factor (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ std\+::string $>$ \&}]{Par\+Name,  }\item[{const std\+::vector$<$ std\+::vector$<$ double $>$ $>$ \&}]{Model1\+Bounds,  }\item[{const std\+::vector$<$ std\+::vector$<$ double $>$ $>$ \&}]{Model2\+Bounds,  }\item[{const std\+::vector$<$ std\+::vector$<$ std\+::string $>$ $>$ \&}]{Model\+Names }\end{DoxyParamCaption})}



Calculate Bayes factor for vector of params, and model boundaries. 


\begin{DoxyParams}{Parameters}
{\em Par\+Name} & Vector with parameter names for which we calculate Bayes factor \\
\hline
{\em Model1\+Bounds} & Lower and upper bound for hypothesis 1. Within this bound we calculate integral used later for Bayes Factor \\
\hline
{\em Model2\+Bounds} & Lower and upper bound for hypothesis 2. Within this bound we calculate integral used later for Bayes Factor \\
\hline
{\em Model\+Names} & Names for hypothesis 1 and 2 \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l02835}{2835}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02838\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02839\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{02840\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[0]\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_a8667510132aa01395520f028287f511b}{MakePostfit}}();}
\DoxyCodeLine{02841\ }
\DoxyCodeLine{02842\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Calculating\ Bayes\ Factor"{}});}
\DoxyCodeLine{02843\ \ \ \textcolor{keywordflow}{if}((ParNames.size()\ !=\ Model1Bounds.size())\ ||\ (Model2Bounds.size()\ !=\ Model1Bounds.size())\ \ ||\ (Model2Bounds.size()\ !=\ ModelNames.size()))}
\DoxyCodeLine{02844\ \ \ \{}
\DoxyCodeLine{02845\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Size\ doesn't\ match"{}});}
\DoxyCodeLine{02846\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{02847\ \ \ \}}
\DoxyCodeLine{02848\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ ParNames.size();\ ++k)}
\DoxyCodeLine{02849\ \ \ \{}
\DoxyCodeLine{02850\ \ \ \ \ \textcolor{comment}{//KS:\ First\ we\ need\ to\ find\ parameter\ number\ based\ on\ name}}
\DoxyCodeLine{02851\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamNo\ =\ \mbox{\hyperlink{classMCMCProcessor_a5ab91183fbbf23fff759fefc9954a1a5}{GetParamIndexFromName}}(ParNames[k]);}
\DoxyCodeLine{02852\ \ \ \ \ \textcolor{keywordtype}{bool}\ skip\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02853\ \ \ \ \ \textcolor{keywordflow}{if}(ParamNo\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}})}
\DoxyCodeLine{02854\ \ \ \ \ \{}
\DoxyCodeLine{02855\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Couldn't\ find\ param\ \{\}.\ Will\ not\ calculate\ Bayes\ Factor"{}},\ ParNames[k]);}
\DoxyCodeLine{02856\ \ \ \ \ \ \ skip\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02857\ \ \ \ \ \}}
\DoxyCodeLine{02858\ \ \ \ \ \textcolor{keywordflow}{if}(skip)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02859\ }
\DoxyCodeLine{02860\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ M1\_min\ =\ Model1Bounds[k][0];}
\DoxyCodeLine{02861\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ M2\_min\ =\ Model2Bounds[k][0];}
\DoxyCodeLine{02862\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ M1\_max\ =\ Model1Bounds[k][1];}
\DoxyCodeLine{02863\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ M2\_max\ =\ Model2Bounds[k][1];}
\DoxyCodeLine{02864\ }
\DoxyCodeLine{02865\ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double}\ IntegralMode1\ =\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNo]-\/>Integral(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNo]-\/>FindFixBin(M1\_min),\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNo]-\/>FindFixBin(M1\_max));}
\DoxyCodeLine{02866\ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double}\ IntegralMode2\ =\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNo]-\/>Integral(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNo]-\/>FindFixBin(M2\_min),\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNo]-\/>FindFixBin(M2\_max));}
\DoxyCodeLine{02867\ }
\DoxyCodeLine{02868\ \ \ \ \ \textcolor{keywordtype}{double}\ BayesFactor\ =\ 0.;}
\DoxyCodeLine{02869\ \ \ \ \ std::string\ Name\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{02870\ \ \ \ \ \textcolor{comment}{//KS:\ Calc\ Bayes\ Factor}}
\DoxyCodeLine{02871\ \ \ \ \ \textcolor{comment}{//If\ M1\ is\ more\ likely}}
\DoxyCodeLine{02872\ \ \ \ \ \textcolor{keywordflow}{if}(IntegralMode1\ >=\ IntegralMode2)}
\DoxyCodeLine{02873\ \ \ \ \ \{}
\DoxyCodeLine{02874\ \ \ \ \ \ \ BayesFactor\ =\ IntegralMode1/IntegralMode2;}
\DoxyCodeLine{02875\ \ \ \ \ \ \ Name\ =\ \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)mathfrak\{B\}("{}}\ +\ ModelNames[k][0]+\ \textcolor{stringliteral}{"{}/"{}}\ +\ ModelNames[k][1]\ +\ \textcolor{stringliteral}{"{})\ =\ "{}}\ +\ std::to\_string(BayesFactor);}
\DoxyCodeLine{02876\ \ \ \ \ \}}
\DoxyCodeLine{02877\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{comment}{//If\ M2\ is\ more\ likely}}
\DoxyCodeLine{02878\ \ \ \ \ \{}
\DoxyCodeLine{02879\ \ \ \ \ \ \ BayesFactor\ =\ IntegralMode2/IntegralMode1;}
\DoxyCodeLine{02880\ \ \ \ \ \ \ Name\ =\ \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)mathfrak\{B\}("{}}\ +\ ModelNames[k][1]+\ \textcolor{stringliteral}{"{}/"{}}\ +\ ModelNames[k][0]\ +\ \textcolor{stringliteral}{"{})\ =\ "{}}\ +\ std::to\_string(BayesFactor);}
\DoxyCodeLine{02881\ \ \ \ \ \}}
\DoxyCodeLine{02882\ \ \ \ \ std::string\ JeffreysScale\ =\ \mbox{\hyperlink{StatisticalUtils_8h_aac0e253784ed2f2a3258d68df22a2568}{GetJeffreysScale}}(BayesFactor);}
\DoxyCodeLine{02883\ \ \ \ \ std::string\ DunneKabothScale\ =\ \mbox{\hyperlink{StatisticalUtils_8h_acf403b05be9baa719893db7449e833c7}{GetDunneKaboth}}(BayesFactor);}
\DoxyCodeLine{02884\ }
\DoxyCodeLine{02885\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\{\}\ for\ \{\}"{}},\ Name,\ ParNames[k]);}
\DoxyCodeLine{02886\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Following\ Jeffreys\ Scale\ =\ "{}},\ JeffreysScale);}
\DoxyCodeLine{02887\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Following\ Dunne-\/Kaboth\ Scale\ =\ "{}},\ DunneKabothScale);}
\DoxyCodeLine{02888\ \ \ \ \ std::cout<<std::endl;}
\DoxyCodeLine{02889\ \ \ \}}
\DoxyCodeLine{02890\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02891\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a3905a8c1e333cb52a192c0cfaf1a0949}\label{classMCMCProcessor_a3905a8c1e333cb52a192c0cfaf1a0949}} 
\index{MCMCProcessor@{MCMCProcessor}!GetBranchNames@{GetBranchNames}}
\index{GetBranchNames@{GetBranchNames}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GetBranchNames()}{GetBranchNames()}}
{\footnotesize\ttfamily const std\+::vector$<$ TString $>$ \& MCMCProcessor\+::\+Get\+Branch\+Names (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Get the vector of branch names from root file. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00202}{202}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00202\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}};\};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_ac9e4fdea5d2de92a1abad5b79b7daf88}\label{classMCMCProcessor_ac9e4fdea5d2de92a1abad5b79b7daf88}} 
\index{MCMCProcessor@{MCMCProcessor}!GetCovariance@{GetCovariance}}
\index{GetCovariance@{GetCovariance}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GetCovariance()}{GetCovariance()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Get\+Covariance (\begin{DoxyParamCaption}\item[{TMatrix\+DSym $\ast$\&}]{Cov,  }\item[{TMatrix\+DSym $\ast$\&}]{Corr }\end{DoxyParamCaption})}



Get the post-\/fit covariances and correlations. 


\begin{DoxyParams}{Parameters}
{\em Cov} & Covariance matrix \\
\hline
{\em Corr} & Correlation matrix \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l00199}{199}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00200\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{00201\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_aea84f0315695aa05ec41fcf965b1b031}{CacheMCMC}})\ \mbox{\hyperlink{classMCMCProcessor_ab367cb5f56606338bb1fce780f2414e8}{MakeCovariance\_MP}}();}
\DoxyCodeLine{00202\ \ \ \textcolor{keywordflow}{else}\ \mbox{\hyperlink{classMCMCProcessor_afc94f21ffd599b1e2dd7e62f24f6c4de}{MakeCovariance}}();}
\DoxyCodeLine{00203\ \ \ Cov\ =\ \textcolor{keyword}{static\_cast<}TMatrixDSym*\textcolor{keyword}{>}(\mbox{\hyperlink{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}{Covariance}}-\/>Clone());}
\DoxyCodeLine{00204\ \ \ Corr\ =\ \textcolor{keyword}{static\_cast<}TMatrixDSym*\textcolor{keyword}{>}(\mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}}-\/>Clone());}
\DoxyCodeLine{00205\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_ab831ff0257b1f3137e1711df115a8b8d}\label{classMCMCProcessor_ab831ff0257b1f3137e1711df115a8b8d}} 
\index{MCMCProcessor@{MCMCProcessor}!GetFDCov@{GetFDCov}}
\index{GetFDCov@{GetFDCov}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GetFDCov()}{GetFDCov()}}
{\footnotesize\ttfamily std\+::string MCMCProcessor\+::\+Get\+FDCov (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00189}{189}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00189\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}].back();\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a70f5590946414af43c3b6c3a5cd315de}\label{classMCMCProcessor_a70f5590946414af43c3b6c3a5cd315de}} 
\index{MCMCProcessor@{MCMCProcessor}!GetHpost@{GetHpost}}
\index{GetHpost@{GetHpost}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GetHpost()}{GetHpost()}}
{\footnotesize\ttfamily TH1D $\ast$ MCMCProcessor\+::\+Get\+Hpost (\begin{DoxyParamCaption}\item[{const int}]{i }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get 1D posterior for a given parameter. 


\begin{DoxyParams}{Parameters}
{\em i} & parameter index \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00176}{176}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00176\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i];\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a7882d6c6a54bb345df394ef13b2962d1}\label{classMCMCProcessor_a7882d6c6a54bb345df394ef13b2962d1}} 
\index{MCMCProcessor@{MCMCProcessor}!GetHpost2D@{GetHpost2D}}
\index{GetHpost2D@{GetHpost2D}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GetHpost2D()}{GetHpost2D()}}
{\footnotesize\ttfamily TH2D $\ast$ MCMCProcessor\+::\+Get\+Hpost2D (\begin{DoxyParamCaption}\item[{const int}]{i,  }\item[{const int}]{j }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get 2D posterior for a given parameter combination. 


\begin{DoxyParams}{Parameters}
{\em i} & parameter index X \\
\hline
{\em j} & parameter index Y \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00180}{180}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00180\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j];\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_ad26a853f53f50f5625b1c8043534dbe0}\label{classMCMCProcessor_ad26a853f53f50f5625b1c8043534dbe0}} 
\index{MCMCProcessor@{MCMCProcessor}!GetNDCov@{GetNDCov}}
\index{GetNDCov@{GetNDCov}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GetNDCov()}{GetNDCov()}}
{\footnotesize\ttfamily std\+::string MCMCProcessor\+::\+Get\+NDCov (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00188}{188}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00188\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}].back();\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a7f00ad66e9eb7a910ef6e9e081c4154d}\label{classMCMCProcessor_a7f00ad66e9eb7a910ef6e9e081c4154d}} 
\index{MCMCProcessor@{MCMCProcessor}!GetnEntries@{GetnEntries}}
\index{GetnEntries@{GetnEntries}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GetnEntries()}{GetnEntries()}}
{\footnotesize\ttfamily Long64\+\_\+t MCMCProcessor\+::\+Getn\+Entries (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get Number of entries that Chain has, for merged chains will not be the same Nsteps. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00208}{208}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00208\ \{\textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_ad376c15dcf60a4284dfa23368e097450}\label{classMCMCProcessor_ad376c15dcf60a4284dfa23368e097450}} 
\index{MCMCProcessor@{MCMCProcessor}!GetNFD@{GetNFD}}
\index{GetNFD@{GetNFD}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GetNFD()}{GetNFD()}}
{\footnotesize\ttfamily int MCMCProcessor\+::\+Get\+NFD (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00171}{171}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00171\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}];\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a82e67c2a28b286aae353636782c93a23}\label{classMCMCProcessor_a82e67c2a28b286aae353636782c93a23}} 
\index{MCMCProcessor@{MCMCProcessor}!GetNFlux@{GetNFlux}}
\index{GetNFlux@{GetNFlux}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GetNFlux()}{GetNFlux()}}
{\footnotesize\ttfamily int MCMCProcessor\+::\+Get\+NFlux (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00168}{168}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00168\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}};\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_af92fab1bce506912ae00d1aa5d9b7233}\label{classMCMCProcessor_af92fab1bce506912ae00d1aa5d9b7233}} 
\index{MCMCProcessor@{MCMCProcessor}!GetNND@{GetNND}}
\index{GetNND@{GetNND}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GetNND()}{GetNND()}}
{\footnotesize\ttfamily int MCMCProcessor\+::\+Get\+NND (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00170}{170}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00170\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}];\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_adbde2f115d983b233d0a9ea896187586}\label{classMCMCProcessor_adbde2f115d983b233d0a9ea896187586}} 
\index{MCMCProcessor@{MCMCProcessor}!GetNParams@{GetNParams}}
\index{GetNParams@{GetNParams}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GetNParams()}{GetNParams()}}
{\footnotesize\ttfamily int MCMCProcessor\+::\+Get\+NParams (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get total number of used parameters. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00167}{167}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00167\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_aa2ebe9262f7f28778d92148164a54d4b}\label{classMCMCProcessor_aa2ebe9262f7f28778d92148164a54d4b}} 
\index{MCMCProcessor@{MCMCProcessor}!GetnSteps@{GetnSteps}}
\index{GetnSteps@{GetnSteps}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GetnSteps()}{GetnSteps()}}
{\footnotesize\ttfamily Long64\+\_\+t MCMCProcessor\+::\+Getn\+Steps (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get Number of Steps that Chain has, for merged chains will not be the same n\+Entries. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00210}{210}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00210\ \{\textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMCMCProcessor_aae0016a4e1d105d5d65243438c622a97}{nSteps}};\};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}\label{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}} 
\index{MCMCProcessor@{MCMCProcessor}!GetNthParameter@{GetNthParameter}}
\index{GetNthParameter@{GetNthParameter}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GetNthParameter()}{GetNthParameter()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Get\+Nth\+Parameter (\begin{DoxyParamCaption}\item[{const int}]{param,  }\item[{double \&}]{Prior,  }\item[{double \&}]{Prior\+Error,  }\item[{TString \&}]{Title }\end{DoxyParamCaption})}



Get properties of parameter by passing it number. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l02703}{2703}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02703\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02704\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{02705\ \ \ \mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20b}{ParameterEnum}}\ ParType\ =\ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}[param];}
\DoxyCodeLine{02706\ \ \ \textcolor{keywordtype}{int}\ ParamNo\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{02707\ \ \ ParamNo\ =\ param\ -\/\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[ParType];}
\DoxyCodeLine{02708\ }
\DoxyCodeLine{02709\ \ \ Prior\ =\ \mbox{\hyperlink{classMCMCProcessor_a3a6614826ae320e462211e38e96d9d02}{ParamCentral}}[ParType][ParamNo];}
\DoxyCodeLine{02710\ \ \ PriorError\ =\ \mbox{\hyperlink{classMCMCProcessor_a3a97e3cb4be3ceb9eb721eac51d82d60}{ParamErrors}}[ParType][ParamNo];}
\DoxyCodeLine{02711\ \ \ Title\ =\ \mbox{\hyperlink{classMCMCProcessor_adecc55689f7d37b9412f8886fe3480dc}{ParamNames}}[ParType][ParamNo];}
\DoxyCodeLine{02712\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02713\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_ae5ba9ac70fefcd01afd5066281438883}\label{classMCMCProcessor_ae5ba9ac70fefcd01afd5066281438883}} 
\index{MCMCProcessor@{MCMCProcessor}!GetNXSec@{GetNXSec}}
\index{GetNXSec@{GetNXSec}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GetNXSec()}{GetNXSec()}}
{\footnotesize\ttfamily int MCMCProcessor\+::\+Get\+NXSec (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00169}{169}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00169\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}];\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a6aaa70eeca8d40c94f9836b3108cf579}\label{classMCMCProcessor_a6aaa70eeca8d40c94f9836b3108cf579}} 
\index{MCMCProcessor@{MCMCProcessor}!GetOSC@{GetOSC}}
\index{GetOSC@{GetOSC}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GetOSC()}{GetOSC()}}
{\footnotesize\ttfamily int MCMCProcessor\+::\+Get\+OSC (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00172}{172}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00172\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}];\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_ae1d255f2216d4f4e9bc64c300d396d1e}\label{classMCMCProcessor_ae1d255f2216d4f4e9bc64c300d396d1e}} 
\index{MCMCProcessor@{MCMCProcessor}!GetOscCov@{GetOscCov}}
\index{GetOscCov@{GetOscCov}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GetOscCov()}{GetOscCov()}}
{\footnotesize\ttfamily std\+::vector$<$ std\+::string $>$ MCMCProcessor\+::\+Get\+Osc\+Cov (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00190}{190}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00190\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}];\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a5ab91183fbbf23fff759fefc9954a1a5}\label{classMCMCProcessor_a5ab91183fbbf23fff759fefc9954a1a5}} 
\index{MCMCProcessor@{MCMCProcessor}!GetParamIndexFromName@{GetParamIndexFromName}}
\index{GetParamIndexFromName@{GetParamIndexFromName}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GetParamIndexFromName()}{GetParamIndexFromName()}}
{\footnotesize\ttfamily int MCMCProcessor\+::\+Get\+Param\+Index\+From\+Name (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{Name }\end{DoxyParamCaption})}



Get parameter number based on name. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l02717}{2717}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02717\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02718\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{02719\ \ \ \textcolor{keywordtype}{int}\ ParamNo\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{02720\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{02721\ \ \ \{}
\DoxyCodeLine{02722\ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{02723\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{02724\ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{02725\ }
\DoxyCodeLine{02726\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(i,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{02727\ }
\DoxyCodeLine{02728\ \ \ \ \ \textcolor{keywordflow}{if}(Name\ ==\ Title)}
\DoxyCodeLine{02729\ \ \ \ \ \{}
\DoxyCodeLine{02730\ \ \ \ \ \ \ ParamNo\ =\ i;}
\DoxyCodeLine{02731\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02732\ \ \ \ \ \}}
\DoxyCodeLine{02733\ \ \ \}}
\DoxyCodeLine{02734\ \ \ \textcolor{keywordflow}{return}\ ParamNo;}
\DoxyCodeLine{02735\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_ac358c3ffe7c060e8872c762259973c6b}\label{classMCMCProcessor_ac358c3ffe7c060e8872c762259973c6b}} 
\index{MCMCProcessor@{MCMCProcessor}!GetPolarPlot@{GetPolarPlot}}
\index{GetPolarPlot@{GetPolarPlot}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GetPolarPlot()}{GetPolarPlot()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Get\+Polar\+Plot (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ std\+::string $>$ \&}]{Par\+Names }\end{DoxyParamCaption})}



Make funny polar plot. 


\begin{DoxyParams}{Parameters}
{\em Par\+Names} & Vector with parameter names for which Polar Plot will be made \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l02757}{2757}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02757\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02758\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{02759\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[0]\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_a8667510132aa01395520f028287f511b}{MakePostfit}}();}
\DoxyCodeLine{02760\ }
\DoxyCodeLine{02761\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ TopMargin\ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetTopMargin();}
\DoxyCodeLine{02762\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ BottomMargin\ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetBottomMargin();}
\DoxyCodeLine{02763\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ LeftMargin\ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetLeftMargin();}
\DoxyCodeLine{02764\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ RightMargin\ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetRightMargin();}
\DoxyCodeLine{02765\ }
\DoxyCodeLine{02766\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTopMargin(0.1);}
\DoxyCodeLine{02767\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetBottomMargin(0.1);}
\DoxyCodeLine{02768\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetLeftMargin(0.1);}
\DoxyCodeLine{02769\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetRightMargin(0.1);}
\DoxyCodeLine{02770\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Update();}
\DoxyCodeLine{02771\ }
\DoxyCodeLine{02772\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Calculating\ Polar\ Plot"{}});}
\DoxyCodeLine{02773\ \ \ TDirectory\ *PolarDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}PolarDir"{}});}
\DoxyCodeLine{02774\ \ \ PolarDir-\/>cd();}
\DoxyCodeLine{02775\ }
\DoxyCodeLine{02776\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ ParNames.size();\ ++k)}
\DoxyCodeLine{02777\ \ \ \{}
\DoxyCodeLine{02778\ \ \ \ \ \textcolor{comment}{//KS:\ First\ we\ need\ to\ find\ parameter\ number\ based\ on\ name}}
\DoxyCodeLine{02779\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamNo\ =\ \mbox{\hyperlink{classMCMCProcessor_a5ab91183fbbf23fff759fefc9954a1a5}{GetParamIndexFromName}}(ParNames[k]);}
\DoxyCodeLine{02780\ \ \ \ \ \textcolor{keywordtype}{bool}\ skip\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02781\ \ \ \ \ \textcolor{keywordflow}{if}(ParamNo\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}})}
\DoxyCodeLine{02782\ \ \ \ \ \{}
\DoxyCodeLine{02783\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Couldn't\ find\ param\ \{\}.\ Will\ not\ calculate\ Polar\ Plot"{}},\ ParNames[k]);}
\DoxyCodeLine{02784\ \ \ \ \ \ \ skip\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02785\ \ \ \ \ \}}
\DoxyCodeLine{02786\ \ \ \ \ \textcolor{keywordflow}{if}(skip)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02787\ }
\DoxyCodeLine{02788\ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{02789\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{02790\ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{02791\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(ParamNo,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{02792\ }
\DoxyCodeLine{02793\ \ \ \ \ std::vector<double>\ x\_val(\mbox{\hyperlink{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}{nBins}});}
\DoxyCodeLine{02794\ \ \ \ \ std::vector<double>\ y\_val(\mbox{\hyperlink{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}{nBins}});}
\DoxyCodeLine{02795\ }
\DoxyCodeLine{02796\ \ \ \ \ \textcolor{keywordtype}{double}\ xmin\ =\ 0;}
\DoxyCodeLine{02797\ \ \ \ \ \textcolor{keywordtype}{double}\ xmax\ =\ 2*TMath::Pi();}
\DoxyCodeLine{02798\ }
\DoxyCodeLine{02799\ \ \ \ \ \textcolor{keywordtype}{double}\ Integral\ =\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNo]-\/>Integral();}
\DoxyCodeLine{02800\ \ \ \ \ \textcolor{keywordflow}{for}\ (Int\_t\ ipt\ =\ 0;\ ipt\ <\ \mbox{\hyperlink{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}{nBins}};\ ipt++)}
\DoxyCodeLine{02801\ \ \ \ \ \{}
\DoxyCodeLine{02802\ \ \ \ \ \ \ x\_val[ipt]\ =\ ipt*(xmax-\/xmin)/\mbox{\hyperlink{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}{nBins}}+xmin;}
\DoxyCodeLine{02803\ \ \ \ \ \ \ y\_val[ipt]\ =\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNo]-\/>GetBinContent(ipt+1)/Integral;}
\DoxyCodeLine{02804\ \ \ \ \ \}}
\DoxyCodeLine{02805\ }
\DoxyCodeLine{02806\ \ \ \ \ \textcolor{keyword}{auto}\ PolarGraph\ =\ std::make\_unique<TGraphPolar>(\mbox{\hyperlink{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}{nBins}},\ x\_val.data(),\ y\_val.data());}
\DoxyCodeLine{02807\ \ \ \ \ PolarGraph-\/>SetLineWidth(2);}
\DoxyCodeLine{02808\ \ \ \ \ PolarGraph-\/>SetFillStyle(3001);}
\DoxyCodeLine{02809\ \ \ \ \ PolarGraph-\/>SetLineColor(kRed);}
\DoxyCodeLine{02810\ \ \ \ \ PolarGraph-\/>SetFillColor(kRed);}
\DoxyCodeLine{02811\ \ \ \ \ PolarGraph-\/>Draw(\textcolor{stringliteral}{"{}AFL"{}});}
\DoxyCodeLine{02812\ }
\DoxyCodeLine{02813\ \ \ \ \ \textcolor{keyword}{auto}\ Text\ =\ std::make\_unique<TText>(0.6,\ 0.1,\ Title);}
\DoxyCodeLine{02814\ \ \ \ \ Text-\/>SetTextSize(0.04);}
\DoxyCodeLine{02815\ \ \ \ \ Text-\/>SetNDC(\textcolor{keyword}{true});}
\DoxyCodeLine{02816\ \ \ \ \ Text-\/>Draw(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{02817\ }
\DoxyCodeLine{02818\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{02819\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Write(Title);}
\DoxyCodeLine{02820\ \ \ \}\ \textcolor{comment}{//End\ loop\ over\ parameters}}
\DoxyCodeLine{02821\ }
\DoxyCodeLine{02822\ \ \ PolarDir-\/>Close();}
\DoxyCodeLine{02823\ \ \ \textcolor{keyword}{delete}\ PolarDir;}
\DoxyCodeLine{02824\ }
\DoxyCodeLine{02825\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{02826\ }
\DoxyCodeLine{02827\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTopMargin(TopMargin);}
\DoxyCodeLine{02828\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetBottomMargin(BottomMargin);}
\DoxyCodeLine{02829\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetLeftMargin(LeftMargin);}
\DoxyCodeLine{02830\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetRightMargin(RightMargin);}
\DoxyCodeLine{02831\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a5fc015740496b821648f0e5ca8cffe80}\label{classMCMCProcessor_a5fc015740496b821648f0e5ca8cffe80}} 
\index{MCMCProcessor@{MCMCProcessor}!GetPostfit@{GetPostfit}}
\index{GetPostfit@{GetPostfit}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GetPostfit()}{GetPostfit()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Get\+Postfit (\begin{DoxyParamCaption}\item[{TVectorD $\ast$\&}]{Central,  }\item[{TVectorD $\ast$\&}]{Errors,  }\item[{TVectorD $\ast$\&}]{Central\+\_\+\+Gauss,  }\item[{TVectorD $\ast$\&}]{Errors\+\_\+\+Gauss,  }\item[{TVectorD $\ast$\&}]{Peaks }\end{DoxyParamCaption})}



Get the post-\/fit results (arithmetic and Gaussian) 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l00166}{166}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00167\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{00168\ \ \ \textcolor{comment}{//\ Make\ the\ post\ fit}}
\DoxyCodeLine{00169\ \ \ \mbox{\hyperlink{classMCMCProcessor_a8667510132aa01395520f028287f511b}{MakePostfit}}();}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00171\ \ \ \textcolor{comment}{//\ We\ now\ have\ the\ private\ members}}
\DoxyCodeLine{00172\ \ \ Central\_PDF\ =\ \mbox{\hyperlink{classMCMCProcessor_acaf7f239136dfa3506d095b612323d0a}{Means}};}
\DoxyCodeLine{00173\ \ \ Errors\_PDF\ =\ \mbox{\hyperlink{classMCMCProcessor_a5174aaa900edf16ddc6e841ea4adae83}{Errors}};}
\DoxyCodeLine{00174\ \ \ Central\_G\ =\ \mbox{\hyperlink{classMCMCProcessor_a600fc8c39af2750df91fb7a0ff85ac74}{Means\_Gauss}};}
\DoxyCodeLine{00175\ \ \ Errors\_G\ =\ \mbox{\hyperlink{classMCMCProcessor_aa78b7ed1bb9966f84f4eaf8cedf5e688}{Errors\_Gauss}};}
\DoxyCodeLine{00176\ \ \ Peak\_Values\ =\ \mbox{\hyperlink{classMCMCProcessor_a32657dc39a7fc0d04804f6195a3d8c3e}{Means\_HPD}};}
\DoxyCodeLine{00177\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a59fa9550b7c69c616929217ae89c2f42}\label{classMCMCProcessor_a59fa9550b7c69c616929217ae89c2f42}} 
\index{MCMCProcessor@{MCMCProcessor}!GetPostfit\_Ind@{GetPostfit\_Ind}}
\index{GetPostfit\_Ind@{GetPostfit\_Ind}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GetPostfit\_Ind()}{GetPostfit\_Ind()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Get\+Postfit\+\_\+\+Ind (\begin{DoxyParamCaption}\item[{TVectorD $\ast$\&}]{Central,  }\item[{TVectorD $\ast$\&}]{Errors,  }\item[{TVectorD $\ast$\&}]{Peaks,  }\item[{\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20b}{Parameter\+Enum}}}]{k\+Param }\end{DoxyParamCaption})}



Or the individual post-\/fits. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l00181}{181}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00182\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{00183\ \ \ \textcolor{comment}{//\ Make\ the\ post\ fit}}
\DoxyCodeLine{00184\ \ \ \mbox{\hyperlink{classMCMCProcessor_a8667510132aa01395520f028287f511b}{MakePostfit}}();}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00186\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ loaded\ param\ types}}
\DoxyCodeLine{00187\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ ParamTypeSize\ =\ int(\mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}.size());}
\DoxyCodeLine{00188\ \ \ \textcolor{keywordtype}{int}\ ParamNumber\ =\ 0;}
\DoxyCodeLine{00189\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ ParamTypeSize;\ ++i)\ \{}
\DoxyCodeLine{00190\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}[i]\ !=\ kParam)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00191\ \ \ \ \ (*PDF\_Central)(ParamNumber)\ =\ (*\mbox{\hyperlink{classMCMCProcessor_acaf7f239136dfa3506d095b612323d0a}{Means}})(i);}
\DoxyCodeLine{00192\ \ \ \ \ (*PDF\_Errors)(ParamNumber)\ =\ (*\mbox{\hyperlink{classMCMCProcessor_a5174aaa900edf16ddc6e841ea4adae83}{Errors}})(i);}
\DoxyCodeLine{00193\ \ \ \ \ (*Peak\_Values)(ParamNumber)\ =\ (*\mbox{\hyperlink{classMCMCProcessor_a32657dc39a7fc0d04804f6195a3d8c3e}{Means\_HPD}})(i);}
\DoxyCodeLine{00194\ \ \ \ \ ++ParamNumber;}
\DoxyCodeLine{00195\ \ \ \}}
\DoxyCodeLine{00196\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_ad09b1ad60fa52fdd87450ab8834e9cd9}\label{classMCMCProcessor_ad09b1ad60fa52fdd87450ab8834e9cd9}} 
\index{MCMCProcessor@{MCMCProcessor}!GetSavageDickey@{GetSavageDickey}}
\index{GetSavageDickey@{GetSavageDickey}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GetSavageDickey()}{GetSavageDickey()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Get\+Savage\+Dickey (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ std\+::string $>$ \&}]{Par\+Name,  }\item[{const std\+::vector$<$ double $>$ \&}]{Evaluation\+Point,  }\item[{const std\+::vector$<$ std\+::vector$<$ double $>$ $>$ \&}]{Bounds }\end{DoxyParamCaption})}



Calculate Bayes factor for point like hypothesis using Savage\+Dickey. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l02895}{2895}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02897\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02898\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{02899\ }
\DoxyCodeLine{02900\ \ \ \textcolor{keywordflow}{if}((ParNames.size()\ !=\ EvaluationPoint.size())\ ||\ (Bounds.size()\ !=\ EvaluationPoint.size()))}
\DoxyCodeLine{02901\ \ \ \{}
\DoxyCodeLine{02902\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Size\ doesn't\ match"{}});}
\DoxyCodeLine{02903\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{02904\ \ \ \}}
\DoxyCodeLine{02905\ \ \ }
\DoxyCodeLine{02906\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[0]\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_a8667510132aa01395520f028287f511b}{MakePostfit}}();}
\DoxyCodeLine{02907\ }
\DoxyCodeLine{02908\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Calculating\ Savage\ Dickey"{}});}
\DoxyCodeLine{02909\ \ \ TDirectory\ *SavageDickeyDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}SavageDickey"{}});}
\DoxyCodeLine{02910\ \ \ SavageDickeyDir-\/>cd();}
\DoxyCodeLine{02911\ \ \ }
\DoxyCodeLine{02912\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ ParNames.size();\ ++k)}
\DoxyCodeLine{02913\ \ \ \{}
\DoxyCodeLine{02914\ \ \ \ \ \textcolor{comment}{//KS:\ First\ we\ need\ to\ find\ parameter\ number\ based\ on\ name}}
\DoxyCodeLine{02915\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamNo\ =\ \mbox{\hyperlink{classMCMCProcessor_a5ab91183fbbf23fff759fefc9954a1a5}{GetParamIndexFromName}}(ParNames[k]);}
\DoxyCodeLine{02916\ \ \ \ \ \textcolor{keywordtype}{bool}\ skip\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02917\ \ \ \ \ \textcolor{keywordflow}{if}(ParamNo\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}})}
\DoxyCodeLine{02918\ \ \ \ \ \{}
\DoxyCodeLine{02919\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Couldn't\ find\ param\ \{\}.\ Will\ not\ calculate\ SavageDickey"{}},\ ParNames[k]);}
\DoxyCodeLine{02920\ \ \ \ \ \ \ skip\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02921\ \ \ \ \ \}}
\DoxyCodeLine{02922\ \ \ \ \ \textcolor{keywordflow}{if}(skip)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02923\ \ \ \ \ }
\DoxyCodeLine{02924\ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{02925\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{02926\ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{02927\ \ \ \ \ \textcolor{keywordtype}{bool}\ FlatPrior\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02928\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(ParamNo,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{02929\ \ \ \ \ }
\DoxyCodeLine{02930\ \ \ \ \ \mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20b}{ParameterEnum}}\ ParType\ =\ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}[ParamNo];}
\DoxyCodeLine{02931\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamTemp\ =\ ParamNo\ -\/\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[ParType];}
\DoxyCodeLine{02932\ \ \ \ \ FlatPrior\ =\ \mbox{\hyperlink{classMCMCProcessor_a4be1eedb743e4ea410009a4fa45720f7}{ParamFlat}}[ParType][ParamTemp];}
\DoxyCodeLine{02933\ \ \ \ \ }
\DoxyCodeLine{02934\ \ \ \ \ TH1D*\ PosteriorHist\ =\ \textcolor{keyword}{static\_cast<}TH1D\ *\textcolor{keyword}{>}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNo]-\/>Clone(Title));}
\DoxyCodeLine{02935\ \ \ \ \ \mbox{\hyperlink{Structs_8cpp_a85463c0c6943e3d544d5fcb3f96bf18a}{RemoveFitter}}(PosteriorHist,\ \textcolor{stringliteral}{"{}Gauss"{}});}
\DoxyCodeLine{02936\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{02937\ \ \ \ \ TH1D*\ PriorHist\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02938\ \ \ \ \ \textcolor{comment}{//KS:\ If\ flat\ prior\ we\ need\ to\ have\ well\ defined\ bounds\ otherwise\ Prior\ distribution\ will\ not\ make\ sense}}
\DoxyCodeLine{02939\ \ \ \ \ \textcolor{keywordflow}{if}(FlatPrior)}
\DoxyCodeLine{02940\ \ \ \ \ \{}
\DoxyCodeLine{02941\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ NBins\ =\ PosteriorHist-\/>GetNbinsX();}
\DoxyCodeLine{02942\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(Bounds[k][0]\ >\ Bounds[k][1])}
\DoxyCodeLine{02943\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02944\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Lower\ bound\ is\ higher\ than\ upper\ bound"{}});}
\DoxyCodeLine{02945\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{02946\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02947\ \ \ \ \ \ \ PriorHist\ =\ \textcolor{keyword}{new}\ TH1D(\textcolor{stringliteral}{"{}PriorHist"{}},\ Title,\ NBins,\ Bounds[k][0],\ Bounds[k][1]);}
\DoxyCodeLine{02948\ \ \ \ \ \ \ }
\DoxyCodeLine{02949\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ FlatProb\ =\ (\ Bounds[k][1]\ -\/\ Bounds[k][0])\ /\ NBins;}
\DoxyCodeLine{02950\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ g\ =\ 0;\ g\ <\ NBins\ +\ 1;\ ++g)\ }
\DoxyCodeLine{02951\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02952\ \ \ \ \ \ \ \ \ PriorHist-\/>SetBinContent(g+1,\ FlatProb);}
\DoxyCodeLine{02953\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02954\ \ \ \ \ \}}
\DoxyCodeLine{02955\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{comment}{//KS:\ Otherwise\ throw\ from\ Gaussian}}
\DoxyCodeLine{02956\ \ \ \ \ \{}
\DoxyCodeLine{02957\ \ \ \ \ \ \ PriorHist\ =\ \textcolor{keyword}{static\_cast<}TH1D*\textcolor{keyword}{>}(PosteriorHist-\/>Clone(\textcolor{stringliteral}{"{}Prior"{}}));}
\DoxyCodeLine{02958\ \ \ \ \ \ \ PriorHist-\/>Reset(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{02959\ \ \ \ \ \ \ PriorHist-\/>Fill(0.0,\ 0.0);}
\DoxyCodeLine{02960\ \ \ \ \ \ \ }
\DoxyCodeLine{02961\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ rand\ =\ std::make\_unique<TRandom3>(0);}
\DoxyCodeLine{02962\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Throw\ nice\ gaussian,\ just\ need\ big\ number\ to\ have\ smooth\ distribution}}
\DoxyCodeLine{02963\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ g\ =\ 0;\ g\ <\ 1000000;\ ++g)}
\DoxyCodeLine{02964\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02965\ \ \ \ \ \ \ \ \ PriorHist-\/>Fill(rand-\/>Gaus(Prior,\ PriorError));}
\DoxyCodeLine{02966\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02967\ \ \ \ \ \}}
\DoxyCodeLine{02968\ \ \ \ \ \textcolor{comment}{//\ Area\ normalise\ the\ distributions}}
\DoxyCodeLine{02969\ \ \ \ \ PriorHist-\/>Scale(1./PriorHist-\/>Integral(),\ \textcolor{stringliteral}{"{}width"{}});}
\DoxyCodeLine{02970\ \ \ \ \ PosteriorHist-\/>Scale(1./PosteriorHist-\/>Integral(),\ \textcolor{stringliteral}{"{}width"{}});}
\DoxyCodeLine{02971\ \ \ \ \ \ \ }
\DoxyCodeLine{02972\ \ \ \ \ PriorHist-\/>SetLineColor(kRed);}
\DoxyCodeLine{02973\ \ \ \ \ PriorHist-\/>SetMarkerColor(kRed);}
\DoxyCodeLine{02974\ \ \ \ \ PriorHist-\/>SetFillColorAlpha(kRed,\ 0.35);}
\DoxyCodeLine{02975\ \ \ \ \ PriorHist-\/>SetFillStyle(1001);}
\DoxyCodeLine{02976\ \ \ \ \ PriorHist-\/>GetXaxis()-\/>SetTitle(Title);}
\DoxyCodeLine{02977\ \ \ \ \ PriorHist-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Posterior\ Probability"{}});}
\DoxyCodeLine{02978\ \ \ \ \ PriorHist-\/>SetMaximum(PosteriorHist-\/>GetMaximum()*1.5);}
\DoxyCodeLine{02979\ \ \ \ \ PriorHist-\/>GetYaxis()-\/>SetLabelOffset(999);}
\DoxyCodeLine{02980\ \ \ \ \ PriorHist-\/>GetYaxis()-\/>SetLabelSize(0);}
\DoxyCodeLine{02981\ \ \ \ \ PriorHist-\/>SetLineWidth(2);}
\DoxyCodeLine{02982\ \ \ \ \ PriorHist-\/>SetLineStyle(kSolid);}
\DoxyCodeLine{02983\ \ \ \ \ }
\DoxyCodeLine{02984\ \ \ \ \ PosteriorHist-\/>SetLineColor(kBlue);}
\DoxyCodeLine{02985\ \ \ \ \ PosteriorHist-\/>SetMarkerColor(kBlue);}
\DoxyCodeLine{02986\ \ \ \ \ PosteriorHist-\/>SetFillColorAlpha(kBlue,\ 0.35);}
\DoxyCodeLine{02987\ \ \ \ \ PosteriorHist-\/>SetFillStyle(1001);}
\DoxyCodeLine{02988\ \ \ \ }
\DoxyCodeLine{02989\ \ \ \ \ PriorHist-\/>Draw(\textcolor{stringliteral}{"{}hist"{}});}
\DoxyCodeLine{02990\ \ \ \ \ PosteriorHist-\/>Draw(\textcolor{stringliteral}{"{}hist\ same"{}});}
\DoxyCodeLine{02991\ }
\DoxyCodeLine{02992\ \ \ \ \ \textcolor{keywordtype}{double}\ ProbPrior\ =\ PriorHist-\/>GetBinContent(PriorHist-\/>FindBin(EvaluationPoint[k]));}
\DoxyCodeLine{02993\ \ \ \ \ \textcolor{comment}{//KS:\ In\ case\ we\ go\ so\ far\ away\ that\ prior\ is\ 0,\ set\ this\ to\ small\ value\ to\ avoid\ dividing\ by\ 0}}
\DoxyCodeLine{02994\ \ \ \ \ \textcolor{keywordflow}{if}(ProbPrior\ <\ 0)\ ProbPrior\ =\ 0.00001;}
\DoxyCodeLine{02995\ \ \ \ \ \textcolor{keywordtype}{double}\ ProbPosterior\ =\ PosteriorHist-\/>GetBinContent(PosteriorHist-\/>FindBin(EvaluationPoint[k]));}
\DoxyCodeLine{02996\ \ \ \ \ \textcolor{keywordtype}{double}\ SavageDickey\ =\ ProbPosterior/ProbPrior;}
\DoxyCodeLine{02997\ \ \ \ \ }
\DoxyCodeLine{02998\ \ \ \ \ std::string\ DunneKabothScale\ =\ \mbox{\hyperlink{StatisticalUtils_8h_acf403b05be9baa719893db7449e833c7}{GetDunneKaboth}}(SavageDickey);}
\DoxyCodeLine{02999\ \ \ \ \ \textcolor{comment}{//Get\ Best\ point}}
\DoxyCodeLine{03000\ \ \ \ \ std::unique\_ptr<TGraph>\ PostPoint(\textcolor{keyword}{new}\ TGraph(1));}
\DoxyCodeLine{03001\ \ \ \ \ PostPoint-\/>SetPoint(0,\ EvaluationPoint[k],\ ProbPosterior);}
\DoxyCodeLine{03002\ \ \ \ \ PostPoint-\/>SetMarkerStyle(20);}
\DoxyCodeLine{03003\ \ \ \ \ PostPoint-\/>SetMarkerSize(1);}
\DoxyCodeLine{03004\ \ \ \ \ PostPoint-\/>Draw(\textcolor{stringliteral}{"{}P\ same"{}});}
\DoxyCodeLine{03005\ \ \ \ \ }
\DoxyCodeLine{03006\ \ \ \ \ std::unique\_ptr<TGraph>\ PriorPoint(\textcolor{keyword}{new}\ TGraph(1));}
\DoxyCodeLine{03007\ \ \ \ \ PriorPoint-\/>SetPoint(0,\ EvaluationPoint[k],\ ProbPrior);}
\DoxyCodeLine{03008\ \ \ \ \ PriorPoint-\/>SetMarkerStyle(20);}
\DoxyCodeLine{03009\ \ \ \ \ PriorPoint-\/>SetMarkerSize(1);}
\DoxyCodeLine{03010\ \ \ \ \ PriorPoint-\/>Draw(\textcolor{stringliteral}{"{}P\ same"{}});}
\DoxyCodeLine{03011\ \ \ \ \ }
\DoxyCodeLine{03012\ \ \ \ \ \textcolor{keyword}{auto}\ legend\ =\ std::make\_unique<TLegend>(0.12,\ 0.6,\ 0.6,\ 0.97);}
\DoxyCodeLine{03013\ \ \ \ \ legend-\/>SetTextSize(0.04);}
\DoxyCodeLine{03014\ \ \ \ \ legend-\/>AddEntry(PriorHist,\ \textcolor{stringliteral}{"{}Prior"{}},\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{03015\ \ \ \ \ legend-\/>AddEntry(PosteriorHist,\ \textcolor{stringliteral}{"{}Posterior"{}},\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{03016\ \ \ \ \ legend-\/>AddEntry(PostPoint.get(),\ Form(\textcolor{stringliteral}{"{}SavageDickey\ =\ \%.2f,\ (\%s)"{}},\ SavageDickey,\ DunneKabothScale.c\_str()),\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{03017\ \ \ \ \ legend-\/>SetLineColor(0);}
\DoxyCodeLine{03018\ \ \ \ \ legend-\/>SetLineStyle(0);}
\DoxyCodeLine{03019\ \ \ \ \ legend-\/>SetFillColor(0);}
\DoxyCodeLine{03020\ \ \ \ \ legend-\/>SetFillStyle(0);}
\DoxyCodeLine{03021\ \ \ \ \ legend-\/>SetBorderSize(0);}
\DoxyCodeLine{03022\ \ \ \ \ legend-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{03023\ \ \ }
\DoxyCodeLine{03024\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{03025\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Write(Title);}
\DoxyCodeLine{03026\ \ \ \ \ }
\DoxyCodeLine{03027\ \ \ \ \ \textcolor{keyword}{delete}\ PosteriorHist;}
\DoxyCodeLine{03028\ \ \ \ \ \textcolor{keyword}{delete}\ PriorHist;}
\DoxyCodeLine{03029\ \ \ \}\ \textcolor{comment}{//End\ loop\ over\ parameters}}
\DoxyCodeLine{03030\ }
\DoxyCodeLine{03031\ \ \ SavageDickeyDir-\/>Close();}
\DoxyCodeLine{03032\ \ \ \textcolor{keyword}{delete}\ SavageDickeyDir;}
\DoxyCodeLine{03033\ }
\DoxyCodeLine{03034\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{03035\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a4ecd30520854d1379946bd8b1f2992f2}\label{classMCMCProcessor_a4ecd30520854d1379946bd8b1f2992f2}} 
\index{MCMCProcessor@{MCMCProcessor}!GetViolin@{GetViolin}}
\index{GetViolin@{GetViolin}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GetViolin()}{GetViolin()}}
{\footnotesize\ttfamily TH2D $\ast$ MCMCProcessor\+::\+Get\+Violin (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get Violin plot for all parameters with posterior values. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00182}{182}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00182\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}};\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a0489e9f57b847389bc0c9f8af5a0abdb}\label{classMCMCProcessor_a0489e9f57b847389bc0c9f8af5a0abdb}} 
\index{MCMCProcessor@{MCMCProcessor}!GetViolinPrior@{GetViolinPrior}}
\index{GetViolinPrior@{GetViolinPrior}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GetViolinPrior()}{GetViolinPrior()}}
{\footnotesize\ttfamily TH2D $\ast$ MCMCProcessor\+::\+Get\+Violin\+Prior (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get Violin plot for all parameters with prior values. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00184}{184}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00184\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}};\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_ad4fa1cfa19aad913c370143b4dc2fa6b}\label{classMCMCProcessor_ad4fa1cfa19aad913c370143b4dc2fa6b}} 
\index{MCMCProcessor@{MCMCProcessor}!GetXSecCov@{GetXSecCov}}
\index{GetXSecCov@{GetXSecCov}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GetXSecCov()}{GetXSecCov()}}
{\footnotesize\ttfamily std\+::vector$<$ std\+::string $>$ MCMCProcessor\+::\+Get\+XSec\+Cov (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00187}{187}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00187\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}];\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a03b7c4bb9cd9a90aa7d284b0f1a6156b}\label{classMCMCProcessor_a03b7c4bb9cd9a90aa7d284b0f1a6156b}} 
\index{MCMCProcessor@{MCMCProcessor}!GewekeDiagnostic@{GewekeDiagnostic}}
\index{GewekeDiagnostic@{GewekeDiagnostic}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{GewekeDiagnostic()}{GewekeDiagnostic()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Geweke\+Diagnostic (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Geweke Diagnostic based on the methods described by Fang (2014) and Karlsbakk (2011). \cite{Fang2014GewekeDiagnostics} \cite{karlsbakk2011}. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l04148}{4148}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{04148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04149\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{04150\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ Geweke\ Diagnostic"{}});}
\DoxyCodeLine{04151\ }
\DoxyCodeLine{04152\ \ \ \textcolor{comment}{//KS:\ Up\ refers\ to\ upper\ limit\ we\ check,\ it\ stays\ constant,\ in\ literature\ it\ is\ mostly\ 50\%\ thus\ using\ 0.5\ for\ threshold}}
\DoxyCodeLine{04153\ \ \ std::vector<double>\ MeanUp(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0.0);}
\DoxyCodeLine{04154\ \ \ std::vector<double>\ SpectralVarianceUp(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0.0);}
\DoxyCodeLine{04155\ \ \ std::vector<int>\ DenomCounterUp(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0);}
\DoxyCodeLine{04156\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Threshold\ =\ 0.5\ *\ \mbox{\hyperlink{classMCMCProcessor_aae0016a4e1d105d5d65243438c622a97}{nSteps}};}
\DoxyCodeLine{04157\ }
\DoxyCodeLine{04158\ \ \ \textcolor{comment}{//KS:\ Select\ values\ between\ which\ you\ want\ to\ scan,\ for\ example\ 0\ means\ 0\%\ burn\ in\ and\ 1\ 100\%\ burn\ in.}}
\DoxyCodeLine{04159\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{double}\ LowerThreshold\ =\ 0;}
\DoxyCodeLine{04160\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{double}\ UpperThreshold\ =\ 1.0;}
\DoxyCodeLine{04161\ \ \ \textcolor{comment}{//\ Tells\ how\ many\ intervals\ between\ thresholds\ we\ want\ to\ check}}
\DoxyCodeLine{04162\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ NChecks\ =\ 100;}
\DoxyCodeLine{04163\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{double}\ Division\ =\ (UpperThreshold\ -\/\ LowerThreshold)/NChecks;}
\DoxyCodeLine{04164\ }
\DoxyCodeLine{04165\ \ \ std::vector<std::unique\_ptr<TH1D>>\ GewekePlots(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{04166\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{04167\ \ \ \{}
\DoxyCodeLine{04168\ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{04169\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{04170\ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{04171\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(j,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{04172\ \ \ \ \ std::string\ HistName\ =\ Form(\textcolor{stringliteral}{"{}\%s\_\%s\_Geweke"{}},\ Title.Data(),\ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[j].Data());}
\DoxyCodeLine{04173\ \ \ \ \ GewekePlots[j]\ =\ std::make\_unique<TH1D>(HistName.c\_str(),\ HistName.c\_str(),\ NChecks,\ 0.0,\ 100\ *\ UpperThreshold);}
\DoxyCodeLine{04174\ \ \ \ \ GewekePlots[j]-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Burn-\/In\ (\%)"{}});}
\DoxyCodeLine{04175\ \ \ \ \ GewekePlots[j]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Geweke\ T\ score"{}});}
\DoxyCodeLine{04176\ \ \ \}}
\DoxyCodeLine{04177\ }
\DoxyCodeLine{04178\ \textcolor{comment}{//KS:\ Start\ parallel\ region}}
\DoxyCodeLine{04179\ \textcolor{preprocessor}{\#ifdef\ MULTITHREAD}}
\DoxyCodeLine{04180\ \textcolor{preprocessor}{\#pragma\ omp\ parallel}}
\DoxyCodeLine{04181\ \{}
\DoxyCodeLine{04182\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04183\ \ \ \textcolor{comment}{//KS:\ First\ we\ calculate\ mean\ and\ spectral\ variance\ for\ the\ upper\ limit,\ this\ doesn't\ change\ and\ in\ literature\ is\ most\ often\ 50\%}}
\DoxyCodeLine{04184\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{04185\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ for}}
\DoxyCodeLine{04186\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{04187\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{04188\ \ \ \{}
\DoxyCodeLine{04189\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++i)}
\DoxyCodeLine{04190\ \ \ \ \ \{}
\DoxyCodeLine{04191\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}[i]\ >\ Threshold)}
\DoxyCodeLine{04192\ \ \ \ \ \ \ \{}
\DoxyCodeLine{04193\ \ \ \ \ \ \ \ \ MeanUp[j]\ +=\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i];}
\DoxyCodeLine{04194\ \ \ \ \ \ \ \ \ DenomCounterUp[j]++;}
\DoxyCodeLine{04195\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04196\ \ \ \ \ \}}
\DoxyCodeLine{04197\ \ \ \ \ MeanUp[j]\ =\ MeanUp[j]/DenomCounterUp[j];}
\DoxyCodeLine{04198\ \ \ \}}
\DoxyCodeLine{04199\ }
\DoxyCodeLine{04200\ \ \ \textcolor{comment}{//KS:\ now\ Spectral\ variance\ which\ in\ this\ case\ is\ sample\ variance}}
\DoxyCodeLine{04201\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{04202\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ for\ collapse(2)}}
\DoxyCodeLine{04203\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{04204\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{04205\ \ \ \{}
\DoxyCodeLine{04206\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++i)}
\DoxyCodeLine{04207\ \ \ \ \ \{}
\DoxyCodeLine{04208\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}[i]\ >\ Threshold)}
\DoxyCodeLine{04209\ \ \ \ \ \ \ \{}
\DoxyCodeLine{04210\ \ \ \ \ \ \ \ \ SpectralVarianceUp[j]\ +=\ (\mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i]\ -\/\ MeanUp[j])*(\mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i]\ -\/\ MeanUp[j]);}
\DoxyCodeLine{04211\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04212\ \ \ \ \ \}}
\DoxyCodeLine{04213\ \ \ \}}
\DoxyCodeLine{04214\ }
\DoxyCodeLine{04215\ \ \ \textcolor{comment}{//Loop\ over\ how\ many\ intervals\ we\ calculate}}
\DoxyCodeLine{04216\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{04217\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ for}}
\DoxyCodeLine{04218\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{04219\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 1;\ k\ <\ NChecks+1;\ ++k)}
\DoxyCodeLine{04220\ \ \ \{}
\DoxyCodeLine{04221\ \ \ \ \ \textcolor{comment}{//KS\ each\ thread\ has\ it's\ own}}
\DoxyCodeLine{04222\ \ \ \ \ std::vector<double>\ MeanDown(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0.0);}
\DoxyCodeLine{04223\ \ \ \ \ std::vector<double>\ SpectralVarianceDown(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0.0);}
\DoxyCodeLine{04224\ \ \ \ \ std::vector<int>\ DenomCounterDown(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0);}
\DoxyCodeLine{04225\ }
\DoxyCodeLine{04226\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ ThresholsCheck\ =\ Division*k*\mbox{\hyperlink{classMCMCProcessor_aae0016a4e1d105d5d65243438c622a97}{nSteps}};}
\DoxyCodeLine{04227\ \ \ \ \ \textcolor{comment}{//KS:\ First\ mean}}
\DoxyCodeLine{04228\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{04229\ \ \ \ \ \{}
\DoxyCodeLine{04230\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++i)}
\DoxyCodeLine{04231\ \ \ \ \ \ \ \{}
\DoxyCodeLine{04232\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}[i]\ <\ ThresholsCheck)}
\DoxyCodeLine{04233\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04234\ \ \ \ \ \ \ \ \ \ \ MeanDown[j]\ +=\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i];}
\DoxyCodeLine{04235\ \ \ \ \ \ \ \ \ \ \ DenomCounterDown[j]++;}
\DoxyCodeLine{04236\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04237\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04238\ \ \ \ \ \ \ MeanDown[j]\ =\ MeanDown[j]/DenomCounterDown[j];}
\DoxyCodeLine{04239\ \ \ \ \ \}}
\DoxyCodeLine{04240\ \ \ \ \ \textcolor{comment}{//Now\ spectral\ variance}}
\DoxyCodeLine{04241\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{04242\ \ \ \ \ \{}
\DoxyCodeLine{04243\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++i)}
\DoxyCodeLine{04244\ \ \ \ \ \ \ \{}
\DoxyCodeLine{04245\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}[i]\ <\ ThresholsCheck)}
\DoxyCodeLine{04246\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04247\ \ \ \ \ \ \ \ \ \ \ SpectralVarianceDown[j]\ +=\ (\mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i]\ -\/\ MeanDown[j])*(\mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i]\ -\/\ MeanDown[j]);}
\DoxyCodeLine{04248\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04249\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04250\ \ \ \ \ \}}
\DoxyCodeLine{04251\ \ \ \ \ \textcolor{comment}{//Lastly\ calc\ T\ score\ and\ fill\ histogram\ entry}}
\DoxyCodeLine{04252\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{04253\ \ \ \ \ \{}
\DoxyCodeLine{04254\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ T\_score\ =\ std::fabs((MeanDown[j]\ -\/\ MeanUp[j])/std::sqrt(SpectralVarianceDown[j]/DenomCounterDown[j]\ +\ SpectralVarianceUp[j]/DenomCounterUp[j]));}
\DoxyCodeLine{04255\ \ \ \ \ \ \ GewekePlots[j]-\/>SetBinContent(k,\ T\_score);}
\DoxyCodeLine{04256\ \ \ \ \ \}}
\DoxyCodeLine{04257\ \ \ \}\ \textcolor{comment}{//end\ loop\ over\ intervals}}
\DoxyCodeLine{04258\ \textcolor{preprocessor}{\#ifdef\ MULTITHREAD}}
\DoxyCodeLine{04259\ \}\ \textcolor{comment}{//End\ parallel\ region}}
\DoxyCodeLine{04260\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04261\ }
\DoxyCodeLine{04262\ \ \ \textcolor{comment}{//Finally\ save\ it\ to\ TFile}}
\DoxyCodeLine{04263\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{04264\ \ \ TDirectory\ *GewekeDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}Geweke"{}});}
\DoxyCodeLine{04265\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)}
\DoxyCodeLine{04266\ \ \ \{}
\DoxyCodeLine{04267\ \ \ \ \ GewekeDir-\/>cd();}
\DoxyCodeLine{04268\ \ \ \ \ GewekePlots[j]-\/>Write();}
\DoxyCodeLine{04269\ \ \ \}}
\DoxyCodeLine{04270\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ \{}
\DoxyCodeLine{04271\ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[i];}
\DoxyCodeLine{04272\ \ \ \}}
\DoxyCodeLine{04273\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}};}
\DoxyCodeLine{04274\ }
\DoxyCodeLine{04275\ \ \ GewekeDir-\/>Close();}
\DoxyCodeLine{04276\ \ \ \textcolor{keyword}{delete}\ GewekeDir;}
\DoxyCodeLine{04277\ }
\DoxyCodeLine{04278\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{04279\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a224995a0b47bd9cbd04e099cc3ca634c}\label{classMCMCProcessor_a224995a0b47bd9cbd04e099cc3ca634c}} 
\index{MCMCProcessor@{MCMCProcessor}!Initialise@{Initialise}}
\index{Initialise@{Initialise}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{Initialise()}{Initialise()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Initialise (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Scan chain, what parameters we have and load information from covariance matrices. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l00156}{156}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00157\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{00158\ \ \ \textcolor{comment}{//\ Scan\ the\ ROOT\ file\ for\ useful\ branches}}
\DoxyCodeLine{00159\ \ \ \mbox{\hyperlink{classMCMCProcessor_aeff2174617268c1e55333529459bffb6}{ScanInput}}();}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00161\ \ \ \textcolor{comment}{//\ Setup\ the\ output}}
\DoxyCodeLine{00162\ \ \ \mbox{\hyperlink{classMCMCProcessor_aa4761be1345f1be3defe162b278a9d8e}{SetupOutput}}();}
\DoxyCodeLine{00163\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_afc94f21ffd599b1e2dd7e62f24f6c4de}\label{classMCMCProcessor_afc94f21ffd599b1e2dd7e62f24f6c4de}} 
\index{MCMCProcessor@{MCMCProcessor}!MakeCovariance@{MakeCovariance}}
\index{MakeCovariance@{MakeCovariance}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{MakeCovariance()}{MakeCovariance()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Make\+Covariance (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Calculate covariance by making 2D projection of each combination of parameters. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l00991}{991}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00991\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00992\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{00993\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_aa5a7761e97cf2e24c7d877a5374b7333}{MakeOutputFile}}();}
\DoxyCodeLine{00994\ }
\DoxyCodeLine{00995\ \ \ \textcolor{keywordtype}{bool}\ HaveMadeDiagonal\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00996\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ post-\/fit\ covariances..."{}});}
\DoxyCodeLine{00997\ \ \ \textcolor{comment}{//\ Check\ that\ the\ diagonal\ entries\ have\ been\ filled}}
\DoxyCodeLine{00998\ \ \ \textcolor{comment}{//\ i.e.\ MakePostfit()\ has\ been\ called}}
\DoxyCodeLine{00999\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ \{}
\DoxyCodeLine{01000\ \ \ \ \ \textcolor{keywordflow}{if}\ ((*\mbox{\hyperlink{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}{Covariance}})(i,i)\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}})\ \{}
\DoxyCodeLine{01001\ \ \ \ \ \ \ HaveMadeDiagonal\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01002\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Have\ not\ run\ diagonal\ elements\ in\ covariance,\ will\ do\ so\ now\ by\ calling\ MakePostfit()"{}});}
\DoxyCodeLine{01003\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01004\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01005\ \ \ \ \ \ \ HaveMadeDiagonal\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01006\ \ \ \ \ \}}
\DoxyCodeLine{01007\ \ \ \}}
\DoxyCodeLine{01008\ }
\DoxyCodeLine{01009\ \ \ \textcolor{keywordflow}{if}\ (HaveMadeDiagonal\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{01010\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a8667510132aa01395520f028287f511b}{MakePostfit}}();}
\DoxyCodeLine{01011\ \ \ \}}
\DoxyCodeLine{01012\ \ \ gStyle-\/>SetPalette(55);}
\DoxyCodeLine{01013\ \ \ \textcolor{comment}{//\ Now\ we\ are\ sure\ we\ have\ the\ diagonal\ elements,\ let's\ make\ the\ off-\/diagonals}}
\DoxyCodeLine{01014\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{01015\ \ \ \{}
\DoxyCodeLine{01016\ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ \%\ (\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}/5)\ ==\ 0)}
\DoxyCodeLine{01017\ \ \ \ \ \ \ \mbox{\hyperlink{namespaceMaCh3Utils_a4c8bdeb1d34606aed192e9f1311a72f5}{MaCh3Utils::PrintProgressBar}}(i,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{01018\ }
\DoxyCodeLine{01019\ \ \ \ \ TString\ Title\_i\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{01020\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\_i,\ PriorError;}
\DoxyCodeLine{01021\ }
\DoxyCodeLine{01022\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(i,\ Prior\_i,\ PriorError,\ Title\_i);}
\DoxyCodeLine{01023\ \ \ \ \ }
\DoxyCodeLine{01024\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ min\_i\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMinimum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i]);}
\DoxyCodeLine{01025\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ max\_i\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMaximum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i]);}
\DoxyCodeLine{01026\ }
\DoxyCodeLine{01027\ \ \ \ \ \textcolor{comment}{//\ Loop\ over\ the\ other\ parameters\ to\ get\ the\ correlations}}
\DoxyCodeLine{01028\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ ++j)\ \{}
\DoxyCodeLine{01029\ }
\DoxyCodeLine{01030\ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ the\ diagonal\ elements\ which\ we've\ already\ done\ above}}
\DoxyCodeLine{01031\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ ==\ i)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01032\ }
\DoxyCodeLine{01033\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ this\ parameter\ isn't\ varied}}
\DoxyCodeLine{01034\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a95fa49737432818bc830a44898d0d850}{IamVaried}}[j]\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{01035\ \ \ \ \ \ \ \ \ (*Covariance)(i,j)\ =\ 0.0;}
\DoxyCodeLine{01036\ \ \ \ \ \ \ \ \ (*Covariance)(j,i)\ =\ (*\mbox{\hyperlink{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}{Covariance}})(i,j);}
\DoxyCodeLine{01037\ \ \ \ \ \ \ \ \ (*Correlation)(i,j)\ =\ 0.0;}
\DoxyCodeLine{01038\ \ \ \ \ \ \ \ \ (*Correlation)(j,i)\ =\ (*\mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}})(i,j);}
\DoxyCodeLine{01039\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01040\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01041\ }
\DoxyCodeLine{01042\ \ \ \ \ \ \ TString\ Title\_j\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{01043\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\_j,\ PriorError\_j;}
\DoxyCodeLine{01044\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(j,\ Prior\_j,\ PriorError\_j,\ Title\_j);}
\DoxyCodeLine{01045\ }
\DoxyCodeLine{01046\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{01047\ }
\DoxyCodeLine{01048\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ draw\ which\ we\ want\ to\ perform}}
\DoxyCodeLine{01049\ \ \ \ \ \ \ TString\ DrawMe\ =\ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[j]+\textcolor{stringliteral}{"{}:"{}}+\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i];}
\DoxyCodeLine{01050\ }
\DoxyCodeLine{01051\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ max\_j\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMaximum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[j]);}
\DoxyCodeLine{01052\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ min\_j\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMinimum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[j]);}
\DoxyCodeLine{01053\ }
\DoxyCodeLine{01054\ \ \ \ \ \ \ \textcolor{comment}{//\ TH2F\ to\ hold\ the\ Correlation\ }}
\DoxyCodeLine{01055\ \ \ \ \ \ \ std::unique\_ptr<TH2D>\ hpost\_2D\ =\ std::make\_unique<TH2D>(DrawMe,\ DrawMe,\ \mbox{\hyperlink{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}{nBins}},\ min\_i,\ max\_i,\ \mbox{\hyperlink{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}{nBins}},\ min\_j,\ max\_j);}
\DoxyCodeLine{01056\ \ \ \ \ \ \ hpost\_2D-\/>SetMinimum(0);}
\DoxyCodeLine{01057\ \ \ \ \ \ \ hpost\_2D-\/>GetXaxis()-\/>SetTitle(Title\_i);}
\DoxyCodeLine{01058\ \ \ \ \ \ \ hpost\_2D-\/>GetYaxis()-\/>SetTitle(Title\_j);}
\DoxyCodeLine{01059\ \ \ \ \ \ \ hpost\_2D-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Steps"{}});}
\DoxyCodeLine{01060\ }
\DoxyCodeLine{01061\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ draw\ command\ we\ want,\ i.e.\ draw\ param\ j\ vs\ param\ i}}
\DoxyCodeLine{01062\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>Project(DrawMe,\ DrawMe,\ \mbox{\hyperlink{classMCMCProcessor_a576f0eb874afaf7e31ff5c86b9e5b8f9}{StepCut}}.c\_str());}
\DoxyCodeLine{01063\ \ \ \ \ \ \ }
\DoxyCodeLine{01064\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a682c1c47626542f5820d633ba2bc010c}{ApplySmoothing}})\ hpost\_2D-\/>Smooth();}
\DoxyCodeLine{01065\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ Covariance\ for\ these\ two\ parameters}}
\DoxyCodeLine{01066\ \ \ \ \ \ \ (*Covariance)(i,j)\ =\ hpost\_2D-\/>GetCovariance();}
\DoxyCodeLine{01067\ \ \ \ \ \ \ (*Covariance)(j,i)\ =\ (*\mbox{\hyperlink{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}{Covariance}})(i,j);}
\DoxyCodeLine{01068\ }
\DoxyCodeLine{01069\ \ \ \ \ \ \ (*Correlation)(i,j)\ =\ hpost\_2D-\/>GetCorrelationFactor();}
\DoxyCodeLine{01070\ \ \ \ \ \ \ (*Correlation)(j,i)\ =\ (*\mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}})(i,j);}
\DoxyCodeLine{01071\ }
\DoxyCodeLine{01072\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})}
\DoxyCodeLine{01073\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01074\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Skip\ Flux\ Params}}
\DoxyCodeLine{01075\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}[i]\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}\ \&\&\ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}[j]\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}})}
\DoxyCodeLine{01076\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01077\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a2c06d64020e9246e720cc131a9f4986d}{IsXsec}}[j]\ \&\&\ \mbox{\hyperlink{classMCMCProcessor_a2c06d64020e9246e720cc131a9f4986d}{IsXsec}}[i]\ \&\&\ std::fabs((*\mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}})(i,j))\ >\ \mbox{\hyperlink{classMCMCProcessor_a25e4685b6299181021b02ac0e0b74681}{Post2DPlotThreshold}})}
\DoxyCodeLine{01078\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01079\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>cd();}
\DoxyCodeLine{01080\ \ \ \ \ \ \ \ \ \ \ \ \ hpost\_2D-\/>Draw(\textcolor{stringliteral}{"{}colz"{}});}
\DoxyCodeLine{01081\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetName(hpost\_2D-\/>GetName());}
\DoxyCodeLine{01082\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTitle(hpost\_2D-\/>GetTitle());}
\DoxyCodeLine{01083\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{01084\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01085\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01086\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01087\ \ \ \ \ \ \ \textcolor{comment}{//\ Write\ it\ to\ root\ file}}
\DoxyCodeLine{01088\ \ \ \ \ \ \ \textcolor{comment}{//OutputFile-\/>cd();}}
\DoxyCodeLine{01089\ \ \ \ \ \ \ \textcolor{comment}{//if(\ std::fabs((*Correlation)(i,j))\ >\ Post2DPlotThreshold\ )\ hpost\_2D-\/>Write();}}
\DoxyCodeLine{01090\ \ \ \ \ \}\ \textcolor{comment}{//\ End\ j\ loop}}
\DoxyCodeLine{01091\ \ \ \}\ \textcolor{comment}{//\ End\ i\ loop}}
\DoxyCodeLine{01092\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{01093\ \ \ \mbox{\hyperlink{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}{Covariance}}-\/>Write(\textcolor{stringliteral}{"{}Covariance"{}});}
\DoxyCodeLine{01094\ \ \ \mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}}-\/>Write(\textcolor{stringliteral}{"{}Correlation"{}});}
\DoxyCodeLine{01095\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_ab367cb5f56606338bb1fce780f2414e8}\label{classMCMCProcessor_ab367cb5f56606338bb1fce780f2414e8}} 
\index{MCMCProcessor@{MCMCProcessor}!MakeCovariance\_MP@{MakeCovariance\_MP}}
\index{MakeCovariance\_MP@{MakeCovariance\_MP}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{MakeCovariance\_MP()}{MakeCovariance\_MP()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Make\+Covariance\+\_\+\+MP (\begin{DoxyParamCaption}\item[{const bool}]{Mute = {\ttfamily false} }\end{DoxyParamCaption})}



Calculate covariance by making 2D projection of each combination of parameters using multithreading. 


\begin{DoxyParams}{Parameters}
{\em Mute} & Allow silencing many messages, especially important if we calculate matrix many times \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l01209}{1209}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01210\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{01211\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_aa5a7761e97cf2e24c7d877a5374b7333}{MakeOutputFile}}();}
\DoxyCodeLine{01212\ \ \ \ \ }
\DoxyCodeLine{01213\ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{classMCMCProcessor_aea84f0315695aa05ec41fcf965b1b031}{CacheMCMC}})\ \mbox{\hyperlink{classMCMCProcessor_ace48a54fb08e2a3943d4e2ed1f8c4a4b}{CacheSteps}}();}
\DoxyCodeLine{01214\ \ \ }
\DoxyCodeLine{01215\ \ \ \textcolor{keywordtype}{bool}\ HaveMadeDiagonal\ =\ \textcolor{keyword}{false};\ \ \ \ }
\DoxyCodeLine{01216\ \ \ \textcolor{comment}{//\ Check\ that\ the\ diagonal\ entries\ have\ been\ filled}}
\DoxyCodeLine{01217\ \ \ \textcolor{comment}{//\ i.e.\ MakePostfit()\ has\ been\ called}}
\DoxyCodeLine{01218\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ \{}
\DoxyCodeLine{01219\ \ \ \ \ \textcolor{keywordflow}{if}\ ((*\mbox{\hyperlink{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}{Covariance}})(i,i)\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}})\ \{}
\DoxyCodeLine{01220\ \ \ \ \ \ \ HaveMadeDiagonal\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01221\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Have\ not\ run\ diagonal\ elements\ in\ covariance,\ will\ do\ so\ now\ by\ calling\ MakePostfit()"{}});}
\DoxyCodeLine{01222\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01223\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01224\ \ \ \ \ \ \ HaveMadeDiagonal\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01225\ \ \ \ \ \}}
\DoxyCodeLine{01226\ \ \ \}}
\DoxyCodeLine{01227\ \ \ \ \ }
\DoxyCodeLine{01228\ \ \ \textcolor{keywordflow}{if}\ (HaveMadeDiagonal\ ==\ \textcolor{keyword}{false})\ \mbox{\hyperlink{classMCMCProcessor_a8667510132aa01395520f028287f511b}{MakePostfit}}();}
\DoxyCodeLine{01229\ \ \ \textcolor{keywordflow}{if}(!Mute)\ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Calculating\ covariance\ matrix"{}});}
\DoxyCodeLine{01230\ \ \ TStopwatch\ clock;}
\DoxyCodeLine{01231\ \ \ \textcolor{keywordflow}{if}(!Mute)\ clock.Start();}
\DoxyCodeLine{01232\ }
\DoxyCodeLine{01233\ \ \ gStyle-\/>SetPalette(55);}
\DoxyCodeLine{01234\ \ \ \textcolor{comment}{//\ Now\ we\ are\ sure\ we\ have\ the\ diagonal\ elements,\ let's\ make\ the\ off-\/diagonals}}
\DoxyCodeLine{01235\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{01236\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{01237\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{01238\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{01239\ \ \ \{\ \ \ \ }
\DoxyCodeLine{01240\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ ++j)}
\DoxyCodeLine{01241\ \ \ \ \ \{}
\DoxyCodeLine{01242\ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ the\ diagonal\ elements\ which\ we've\ already\ done\ above}}
\DoxyCodeLine{01243\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ ==\ i)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01244\ \ \ \ \ \ \ }
\DoxyCodeLine{01245\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ this\ parameter\ isn't\ varied}}
\DoxyCodeLine{01246\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a95fa49737432818bc830a44898d0d850}{IamVaried}}[j]\ ==\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{01247\ \ \ \ \ \ \ \ \ (*Covariance)(i,j)\ =\ 0.0;}
\DoxyCodeLine{01248\ \ \ \ \ \ \ \ \ (*Covariance)(j,i)\ =\ (*\mbox{\hyperlink{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}{Covariance}})(i,j);}
\DoxyCodeLine{01249\ \ \ \ \ \ \ \ \ (*Correlation)(i,j)\ =\ 0.0;}
\DoxyCodeLine{01250\ \ \ \ \ \ \ \ \ (*Correlation)(j,i)\ =\ (*\mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}})(i,j);}
\DoxyCodeLine{01251\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01252\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01253\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>SetMinimum(0);}
\DoxyCodeLine{01254\ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{01255\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++k)}
\DoxyCodeLine{01256\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01257\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Burn\ in\ cut}}
\DoxyCodeLine{01258\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}[k]\ <\ \mbox{\hyperlink{classMCMCProcessor_a22f82dadceccbe87dd8c5b7daa8432e8}{BurnInCut}})\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01259\ }
\DoxyCodeLine{01260\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Fill\ histogram\ with\ cached\ steps}}
\DoxyCodeLine{01261\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>Fill(\mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[i][k],\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][k]);}
\DoxyCodeLine{01262\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01263\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a682c1c47626542f5820d633ba2bc010c}{ApplySmoothing}})\ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>Smooth();}
\DoxyCodeLine{01264\ \ \ \ \ \ \ }
\DoxyCodeLine{01265\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ Covariance\ for\ these\ two\ parameters}}
\DoxyCodeLine{01266\ \ \ \ \ \ \ (*Covariance)(i,j)\ =\ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>\mbox{\hyperlink{classMCMCProcessor_ac9e4fdea5d2de92a1abad5b79b7daf88}{GetCovariance}}();}
\DoxyCodeLine{01267\ \ \ \ \ \ \ (*Covariance)(j,i)\ =\ (*\mbox{\hyperlink{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}{Covariance}})(i,j);}
\DoxyCodeLine{01268\ }
\DoxyCodeLine{01269\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Since\ we\ already\ have\ covariance\ consider\ calculating\ correlation\ using\ it,\ right\ now\ we\ effectively\ calculate\ covariance\ twice}}
\DoxyCodeLine{01270\ \ \ \ \ \ \ \textcolor{comment}{//https://root.cern.ch/doc/master/TH2\_8cxx\_source.html\#l01099}}
\DoxyCodeLine{01271\ \ \ \ \ \ \ (*Correlation)(i,j)\ =\ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>GetCorrelationFactor();}
\DoxyCodeLine{01272\ \ \ \ \ \ \ (*Correlation)(j,i)\ =\ (*\mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}})(i,j);}
\DoxyCodeLine{01273\ \ \ \ \ \}\textcolor{comment}{//\ End\ j\ loop}}
\DoxyCodeLine{01274\ \ \ \}\textcolor{comment}{//\ End\ i\ loop}}
\DoxyCodeLine{01275\ }
\DoxyCodeLine{01276\ \ \ \textcolor{keywordflow}{if}(!Mute)\ \{}
\DoxyCodeLine{01277\ \ \ \ \ clock.Stop();}
\DoxyCodeLine{01278\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ Covariance\ took\ \{:.2f\}s\ to\ finish\ for\ \{\}\ steps"{}},\ clock.RealTime(),\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{01279\ \ \ \}}
\DoxyCodeLine{01280\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{01281\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})}
\DoxyCodeLine{01282\ \ \ \{}
\DoxyCodeLine{01283\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>cd();}
\DoxyCodeLine{01284\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{01285\ \ \ \ \ \{\ \ \ \ }
\DoxyCodeLine{01286\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ ++j)}
\DoxyCodeLine{01287\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01288\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ the\ diagonal\ elements\ which\ we've\ already\ done\ above}}
\DoxyCodeLine{01289\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ ==\ i)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01290\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a95fa49737432818bc830a44898d0d850}{IamVaried}}[j]\ ==\ \textcolor{keyword}{false})\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01291\ }
\DoxyCodeLine{01292\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}[i]\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}\ \&\&\ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}[j]\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}})}
\DoxyCodeLine{01293\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01294\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Skip\ Flux\ Params}}
\DoxyCodeLine{01295\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a2c06d64020e9246e720cc131a9f4986d}{IsXsec}}[j]\ \&\&\ \mbox{\hyperlink{classMCMCProcessor_a2c06d64020e9246e720cc131a9f4986d}{IsXsec}}[i]\ \&\&\ std::fabs((*\mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}})(i,j))\ >\ \mbox{\hyperlink{classMCMCProcessor_a25e4685b6299181021b02ac0e0b74681}{Post2DPlotThreshold}})}
\DoxyCodeLine{01296\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01297\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>Draw(\textcolor{stringliteral}{"{}colz"{}});}
\DoxyCodeLine{01298\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetName(\mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>GetName());}
\DoxyCodeLine{01299\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTitle(\mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>GetTitle());}
\DoxyCodeLine{01300\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{01301\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01302\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01303\ \ \ \ \ \ \ \ \ \textcolor{comment}{//if(\ std::fabs((*Correlation)(i,j))\ >\ Post2DPlotThreshold)\ hpost2D[i][j]-\/>Write();}}
\DoxyCodeLine{01304\ \ \ \ \ \ \ \}\textcolor{comment}{//\ End\ j\ loop}}
\DoxyCodeLine{01305\ \ \ \ \ \}\textcolor{comment}{//\ End\ i\ loop}}
\DoxyCodeLine{01306\ \ \ \}\ \textcolor{comment}{//end\ if\ pdf}}
\DoxyCodeLine{01307\ \ \ \textcolor{keywordflow}{if}(!Mute)\ \{}
\DoxyCodeLine{01308\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}{Covariance}}-\/>Write(\textcolor{stringliteral}{"{}Covariance"{}});}
\DoxyCodeLine{01309\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}}-\/>Write(\textcolor{stringliteral}{"{}Correlation"{}});}
\DoxyCodeLine{01310\ \ \ \}}
\DoxyCodeLine{01311\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a17c0f09bfce82d1701a83645f748988a}\label{classMCMCProcessor_a17c0f09bfce82d1701a83645f748988a}} 
\index{MCMCProcessor@{MCMCProcessor}!MakeCredibleIntervals@{MakeCredibleIntervals}}
\index{MakeCredibleIntervals@{MakeCredibleIntervals}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{MakeCredibleIntervals()}{MakeCredibleIntervals()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Make\+Credible\+Intervals (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ double $>$ \&}]{Credible\+Intervals = {\ttfamily \{0.99,~0.90,~0.68~\}},  }\item[{const std\+::vector$<$ Color\+\_\+t $>$ \&}]{Credible\+Intervals\+Colours = {\ttfamily \{kCyan+4,~kCyan-\/2,~kCyan-\/10\}},  }\item[{const bool}]{Credible\+In\+Sigmas = {\ttfamily false} }\end{DoxyParamCaption})}



Make and Draw Credible intervals. 


\begin{DoxyParams}{Parameters}
{\em Credible\+Intervals} & Vector with values of credible intervals, must be in descending order \\
\hline
{\em Credible\+Intervals\+Colours} & Color\+\_\+t telling what colour to use for each Interval line \\
\hline
{\em Credible\+In\+Sigmas} & Bool telling whether intervals are in percentage or in sigmas, then special conversions is used \\
\hline
\end{DoxyParams}
Scale the histograms so it shows the posterior probability

Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l00695}{695}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00697\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00698\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{00699\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[0]\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_a8667510132aa01395520f028287f511b}{MakePostfit}}();}
\DoxyCodeLine{00700\ }
\DoxyCodeLine{00701\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ Credible\ Intervals\ "{}});}
\DoxyCodeLine{00702\ }
\DoxyCodeLine{00703\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ LeftMargin\ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetLeftMargin();}
\DoxyCodeLine{00704\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetLeftMargin(0.15);}
\DoxyCodeLine{00705\ }
\DoxyCodeLine{00706\ \ \ \textcolor{keywordflow}{if}(CredibleIntervals.size()\ !=\ CredibleIntervalsColours.size())}
\DoxyCodeLine{00707\ \ \ \{}
\DoxyCodeLine{00708\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Size\ of\ \ CredibleIntervals\ is\ not\ equal\ to\ size\ of\ CredibleIntervalsColours"{}});}
\DoxyCodeLine{00709\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00710\ \ \ \}}
\DoxyCodeLine{00711\ }
\DoxyCodeLine{00712\ \ \ \textcolor{keywordflow}{if}(CredibleIntervals.size()\ >\ 1)}
\DoxyCodeLine{00713\ \ \ \{}
\DoxyCodeLine{00714\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ CredibleIntervals.size();\ i++\ )}
\DoxyCodeLine{00715\ \ \ \ \ \{}
\DoxyCodeLine{00716\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(CredibleIntervals[i]\ >\ CredibleIntervals[i-\/1])}
\DoxyCodeLine{00717\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00718\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Interval\ \{\}\ is\ smaller\ than\ \{\}"{}},\ i,\ i-\/1);}
\DoxyCodeLine{00719\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}\{:.2f\}\ \{:.2f\}"{}},\ CredibleIntervals[i],\ CredibleIntervals[i-\/1]);}
\DoxyCodeLine{00720\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}They\ should\ be\ grouped\ in\ decreasing\ order"{}});}
\DoxyCodeLine{00721\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00722\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00723\ \ \ \ \ \}}
\DoxyCodeLine{00724\ \ \ \}}
\DoxyCodeLine{00725\ }
\DoxyCodeLine{00726\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nCredible\ =\ int(CredibleIntervals.size());}
\DoxyCodeLine{00727\ \ \ std::vector<TH1D*>\ hpost\_copy(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{00728\ \ \ std::vector<std::vector<TH1D*>>\ hpost\_cl(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{00729\ }
\DoxyCodeLine{00730\ \ \ \textcolor{comment}{//KS:\ Copy\ all\ histograms\ to\ be\ thread\ safe}}
\DoxyCodeLine{00731\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{00732\ \ \ \{}
\DoxyCodeLine{00733\ \ \ \ \ hpost\_copy[i]\ =\ \textcolor{keyword}{static\_cast<}TH1D*\textcolor{keyword}{>}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>Clone(Form(\textcolor{stringliteral}{"{}hpost\_copy\_\%i"{}},\ i)));}
\DoxyCodeLine{00734\ \ \ \ \ hpost\_cl[i].resize(nCredible);}
\DoxyCodeLine{00735\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nCredible;\ ++j)}
\DoxyCodeLine{00736\ \ \ \ \ \{}
\DoxyCodeLine{00737\ \ \ \ \ \ \ hpost\_cl[i][j]\ =\ \textcolor{keyword}{static\_cast<}TH1D*\textcolor{keyword}{>}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>Clone(Form(\textcolor{stringliteral}{"{}hpost\_copy\_\%i\_CL\_\%f"{}},\ i,\ CredibleIntervals[j])));}
\DoxyCodeLine{00738\ }
\DoxyCodeLine{00739\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Reset\ to\ get\ rid\ to\ TF1\ otherwise\ we\ run\ into\ segfault\ :(}}
\DoxyCodeLine{00740\ \ \ \ \ \ \ hpost\_cl[i][j]-\/>Reset(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00741\ \ \ \ \ \ \ hpost\_cl[i][j]-\/>Fill(0.0,\ 0.0);}
\DoxyCodeLine{00742\ \ \ \ \ \}}
\DoxyCodeLine{00743\ \ \ \}}
\DoxyCodeLine{00744\ }
\DoxyCodeLine{00745\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{00746\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{00747\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{00748\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{00749\ \ \ \{}
\DoxyCodeLine{00751\ \ \ \ \ hpost\_copy[i]-\/>Scale(1.\ /\ hpost\_copy[i]-\/>Integral());}
\DoxyCodeLine{00752\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nCredible;\ ++j)}
\DoxyCodeLine{00753\ \ \ \ \ \{}
\DoxyCodeLine{00754\ \ \ \ \ \ \ \textcolor{comment}{//\ Scale\ the\ histograms\ before\ gettindg\ credible\ intervals}}
\DoxyCodeLine{00755\ \ \ \ \ \ \ hpost\_cl[i][j]-\/>Scale(1.\ /\ hpost\_cl[i][j]-\/>Integral());}
\DoxyCodeLine{00756\ }
\DoxyCodeLine{00757\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ We\ have\ slightly\ different\ approach\ depending\ if\ you\ passed\ percentage\ or\ sigmas}}
\DoxyCodeLine{00758\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(CredibleInSigmas)}
\DoxyCodeLine{00759\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00760\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Convert\ sigmas\ into\ percentage}}
\DoxyCodeLine{00761\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ CredInter\ =\ \mbox{\hyperlink{StatisticalUtils_8h_a04394b98587b44b98b003bd1226606ed}{GetSigmaValue}}(\textcolor{keywordtype}{int}(std::round(CredibleIntervals[j])));}
\DoxyCodeLine{00762\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{StatisticalUtils_8h_aac24043cc7a5ef6a05fc1b10d3860875}{GetCredibleInterval}}(hpost\_copy[i],\ hpost\_cl[i][j],\ CredInter);}
\DoxyCodeLine{00763\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00764\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00765\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00766\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{StatisticalUtils_8h_aac24043cc7a5ef6a05fc1b10d3860875}{GetCredibleInterval}}(hpost\_copy[i],\ hpost\_cl[i][j],\ CredibleIntervals[j]);}
\DoxyCodeLine{00767\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00768\ }
\DoxyCodeLine{00769\ \ \ \ \ \ \ hpost\_cl[i][j]-\/>SetFillColor(CredibleIntervalsColours[j]);}
\DoxyCodeLine{00770\ \ \ \ \ \ \ hpost\_cl[i][j]-\/>SetLineWidth(1);}
\DoxyCodeLine{00771\ \ \ \ \ \}}
\DoxyCodeLine{00772\ \ \ \ \ hpost\_copy[i]-\/>GetYaxis()-\/>SetTitleOffset(1.8);}
\DoxyCodeLine{00773\ \ \ \ \ hpost\_copy[i]-\/>SetLineWidth(1);}
\DoxyCodeLine{00774\ \ \ \ \ hpost\_copy[i]-\/>SetMaximum(hpost\_copy[i]-\/>GetMaximum()*1.2);}
\DoxyCodeLine{00775\ \ \ \ \ hpost\_copy[i]-\/>SetLineWidth(2);}
\DoxyCodeLine{00776\ \ \ \ \ hpost\_copy[i]-\/>SetLineColor(kBlack);}
\DoxyCodeLine{00777\ \ \ \ \ hpost\_copy[i]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Posterior\ Probability"{}});}
\DoxyCodeLine{00778\ \ \ \}}
\DoxyCodeLine{00779\ }
\DoxyCodeLine{00780\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{00781\ \ \ TDirectory\ *CredibleDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}Credible"{}});}
\DoxyCodeLine{00782\ }
\DoxyCodeLine{00783\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{00784\ \ \ \{}
\DoxyCodeLine{00785\ \ \ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{classMCMCProcessor_a95fa49737432818bc830a44898d0d850}{IamVaried}}[i])\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00786\ }
\DoxyCodeLine{00787\ \ \ \ \ \textcolor{comment}{//\ Now\ make\ the\ TLine\ for\ the\ Asimov}}
\DoxyCodeLine{00788\ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00789\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{00790\ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{00791\ }
\DoxyCodeLine{00792\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(i,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{00793\ }
\DoxyCodeLine{00794\ \ \ \ \ \textcolor{keyword}{auto}\ Asimov\ =\ std::make\_unique<TLine>(Prior,\ hpost\_copy[i]-\/>GetMinimum(),\ Prior,\ hpost\_copy[i]-\/>GetMaximum());}
\DoxyCodeLine{00795\ \ \ \ \ Asimov-\/>SetLineColor(kRed-\/3);}
\DoxyCodeLine{00796\ \ \ \ \ Asimov-\/>SetLineWidth(2);}
\DoxyCodeLine{00797\ \ \ \ \ Asimov-\/>SetLineStyle(kDashed);}
\DoxyCodeLine{00798\ }
\DoxyCodeLine{00799\ \ \ \ \ \textcolor{keyword}{auto}\ legend\ =\ std::make\_unique<TLegend>(0.20,\ 0.7,\ 0.4,\ 0.92);}
\DoxyCodeLine{00800\ \ \ \ \ legend-\/>SetTextSize(0.03);}
\DoxyCodeLine{00801\ \ \ \ \ legend-\/>SetFillColor(0);}
\DoxyCodeLine{00802\ \ \ \ \ legend-\/>SetFillStyle(0);}
\DoxyCodeLine{00803\ \ \ \ \ legend-\/>SetLineColor(0);}
\DoxyCodeLine{00804\ \ \ \ \ legend-\/>SetLineStyle(0);}
\DoxyCodeLine{00805\ \ \ \ \ legend-\/>SetBorderSize(0);}
\DoxyCodeLine{00806\ \ \ \ \ hpost\_copy[i]-\/>Draw(\textcolor{stringliteral}{"{}HIST"{}});}
\DoxyCodeLine{00807\ }
\DoxyCodeLine{00808\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nCredible;\ ++j)}
\DoxyCodeLine{00809\ \ \ \ \ \ \ \ \ hpost\_cl[i][j]-\/>Draw(\textcolor{stringliteral}{"{}HIST\ SAME"{}});}
\DoxyCodeLine{00810\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ nCredible-\/1;\ j\ >=\ 0;\ -\/-\/j)}
\DoxyCodeLine{00811\ \ \ \ \ \{}
\DoxyCodeLine{00812\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(CredibleInSigmas)}
\DoxyCodeLine{00813\ \ \ \ \ \ \ \ \ legend-\/>AddEntry(hpost\_cl[i][j],\ Form(\textcolor{stringliteral}{"{}\%.0f\#sigma\ Credible\ Interval"{}},\ CredibleIntervals[j]),\ \textcolor{stringliteral}{"{}f"{}});}
\DoxyCodeLine{00814\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00815\ \ \ \ \ \ \ \ \ legend-\/>AddEntry(hpost\_cl[i][j],\ Form(\textcolor{stringliteral}{"{}\%.0f\%\%\ Credible\ Interval"{}},\ CredibleIntervals[j]*100),\ \textcolor{stringliteral}{"{}f"{}});}
\DoxyCodeLine{00816\ \ \ \ \ \}}
\DoxyCodeLine{00817\ \ \ \ \ legend-\/>AddEntry(Asimov.get(),\ Form(\textcolor{stringliteral}{"{}\#splitline\{Prior\}\{x\ =\ \%.2f\ ,\ \#sigma\ =\ \%.2f\}"{}},\ Prior,\ PriorError),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{00818\ \ \ \ \ legend-\/>Draw(\textcolor{stringliteral}{"{}SAME"{}});}
\DoxyCodeLine{00819\ \ \ \ \ Asimov-\/>Draw(\textcolor{stringliteral}{"{}SAME"{}});}
\DoxyCodeLine{00820\ }
\DoxyCodeLine{00821\ \ \ \ \ \textcolor{comment}{//\ Write\ to\ file}}
\DoxyCodeLine{00822\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetName(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetName());}
\DoxyCodeLine{00823\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTitle(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetTitle());}
\DoxyCodeLine{00824\ }
\DoxyCodeLine{00825\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{00826\ \ \ \ \ \textcolor{comment}{//\ cd\ into\ directory\ in\ root\ file}}
\DoxyCodeLine{00827\ \ \ \ \ CredibleDir-\/>cd();}
\DoxyCodeLine{00828\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Write();}
\DoxyCodeLine{00829\ \ \ \}}
\DoxyCodeLine{00830\ }
\DoxyCodeLine{00831\ \ \ \textcolor{comment}{//KS:\ Remove\ histograms}}
\DoxyCodeLine{00832\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ \{}
\DoxyCodeLine{00833\ \ \ \ \ \textcolor{keyword}{delete}\ hpost\_copy[i];}
\DoxyCodeLine{00834\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nCredible;\ ++j)\ \{}
\DoxyCodeLine{00835\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ hpost\_cl[i][j];}
\DoxyCodeLine{00836\ \ \ \ \ \}}
\DoxyCodeLine{00837\ \ \ \}}
\DoxyCodeLine{00838\ }
\DoxyCodeLine{00839\ \ \ CredibleDir-\/>Close();}
\DoxyCodeLine{00840\ \ \ \textcolor{keyword}{delete}\ CredibleDir;}
\DoxyCodeLine{00841\ }
\DoxyCodeLine{00842\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{00843\ }
\DoxyCodeLine{00844\ \ \ \textcolor{comment}{//Set\ back\ to\ normal}}
\DoxyCodeLine{00845\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetLeftMargin(LeftMargin);}
\DoxyCodeLine{00846\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a304adbe4407166ec42d76329c4bd17ff}\label{classMCMCProcessor_a304adbe4407166ec42d76329c4bd17ff}} 
\index{MCMCProcessor@{MCMCProcessor}!MakeCredibleRegions@{MakeCredibleRegions}}
\index{MakeCredibleRegions@{MakeCredibleRegions}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{MakeCredibleRegions()}{MakeCredibleRegions()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Make\+Credible\+Regions (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ double $>$ \&}]{Credible\+Regions = {\ttfamily \{0.99,~0.90,~0.68\}},  }\item[{const std\+::vector$<$ Style\+\_\+t $>$ \&}]{Credible\+Region\+Style = {\ttfamily \{kDashed,~kSolid,~kDotted\}},  }\item[{const std\+::vector$<$ Color\+\_\+t $>$ \&}]{Credible\+Region\+Color = {\ttfamily \{kGreen-\/3,~kGreen-\/10,~kGreen\}},  }\item[{const bool}]{Credible\+In\+Sigmas = {\ttfamily false} }\end{DoxyParamCaption})}



Make and Draw Credible Regions. 


\begin{DoxyParams}{Parameters}
{\em Credible\+Regions} & Vector with values of credible intervals, must be in descending order \\
\hline
{\em Credible\+Region\+Style} & Style\+\_\+t telling what line style to use for each Interval line \\
\hline
{\em Credible\+Region\+Color} & Color\+\_\+t telling what colour to use for each Interval line \\
\hline
{\em Credible\+In\+Sigmas} & Bool telling whether intervals are in percentage or in sigmas, then special conversions is used \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l01627}{1627}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01630\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01631\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{01632\ }
\DoxyCodeLine{01633\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_ab367cb5f56606338bb1fce780f2414e8}{MakeCovariance\_MP}}();}
\DoxyCodeLine{01634\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ Credible\ Regions"{}});}
\DoxyCodeLine{01635\ }
\DoxyCodeLine{01636\ \ \ \textcolor{keywordflow}{if}(\ (CredibleRegions.size()\ !=\ CredibleRegionStyle.size())\ ||\ (CredibleRegionStyle.size()\ !=\ CredibleRegionColor.size())\ )}
\DoxyCodeLine{01637\ \ \ \{}
\DoxyCodeLine{01638\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Size\ of\ \ CredibleRegions\ is\ not\ equat\ to\ size\ of\ CredibleRegionStyle"{}});}
\DoxyCodeLine{01639\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{01640\ \ \ \}}
\DoxyCodeLine{01641\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nCredible\ =\ int(CredibleRegions.size());}
\DoxyCodeLine{01642\ }
\DoxyCodeLine{01643\ }
\DoxyCodeLine{01644\ \ \ std::vector<std::vector<TH2D*>>\ hpost\_2D\_copy(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{01645\ \ \ std::vector<std::vector<std::vector<TH2D*>>>\ hpost\_2D\_cl(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{01646\ \ \ \textcolor{comment}{//KS:\ Copy\ all\ histograms\ to\ be\ thread\ safe}}
\DoxyCodeLine{01647\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{01648\ \ \ \{}
\DoxyCodeLine{01649\ \ \ \ \ hpost\_2D\_copy[i].resize(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{01650\ \ \ \ \ hpost\_2D\_cl[i].resize(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{01651\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ ++j)}
\DoxyCodeLine{01652\ \ \ \ \ \{}
\DoxyCodeLine{01653\ \ \ \ \ \ \ hpost\_2D\_copy[i][j]\ =\ \textcolor{keyword}{static\_cast<}TH2D*\textcolor{keyword}{>}(\mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>Clone(Form(\textcolor{stringliteral}{"{}hpost\_copy\_\%i\_\%i"{}},\ i,\ j)));}
\DoxyCodeLine{01654\ \ \ \ \ \ \ hpost\_2D\_cl[i][j].resize(nCredible);}
\DoxyCodeLine{01655\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ nCredible;\ ++k)}
\DoxyCodeLine{01656\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01657\ \ \ \ \ \ \ \ \ hpost\_2D\_cl[i][j][k]\ =\ \textcolor{keyword}{static\_cast<}TH2D*\textcolor{keyword}{>}(\mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>Clone(Form(\textcolor{stringliteral}{"{}hpost\_copy\_\%i\_\%i\_CL\_\%f"{}},\ i,\ j,\ CredibleRegions[k])));}
\DoxyCodeLine{01658\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01659\ \ \ \ \ \}}
\DoxyCodeLine{01660\ \ \ \}}
\DoxyCodeLine{01661\ }
\DoxyCodeLine{01662\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{01663\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{01664\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{01665\ \ \ \textcolor{comment}{//Calculate\ credible\ histogram}}
\DoxyCodeLine{01666\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{01667\ \ \ \{}
\DoxyCodeLine{01668\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ ++j)}
\DoxyCodeLine{01669\ \ \ \ \ \{}
\DoxyCodeLine{01670\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ nCredible;\ ++k)}
\DoxyCodeLine{01671\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01672\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(CredibleInSigmas)}
\DoxyCodeLine{01673\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01674\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Convert\ sigmas\ into\ percentage}}
\DoxyCodeLine{01675\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ CredReg\ =\ \mbox{\hyperlink{StatisticalUtils_8h_a04394b98587b44b98b003bd1226606ed}{GetSigmaValue}}(\textcolor{keywordtype}{int}(std::round(CredibleRegions[k])));}
\DoxyCodeLine{01676\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{StatisticalUtils_8h_add6570517afa2cca738b9aca56aa3883}{GetCredibleRegion}}(hpost\_2D\_cl[i][j][k],\ CredReg);}
\DoxyCodeLine{01677\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01678\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01679\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01680\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{StatisticalUtils_8h_add6570517afa2cca738b9aca56aa3883}{GetCredibleRegion}}(hpost\_2D\_cl[i][j][k],\ CredibleRegions[k]);}
\DoxyCodeLine{01681\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01682\ \ \ \ \ \ \ \ \ hpost\_2D\_cl[i][j][k]-\/>SetLineColor(CredibleRegionColor[k]);}
\DoxyCodeLine{01683\ \ \ \ \ \ \ \ \ hpost\_2D\_cl[i][j][k]-\/>SetLineWidth(2);}
\DoxyCodeLine{01684\ \ \ \ \ \ \ \ \ hpost\_2D\_cl[i][j][k]-\/>SetLineStyle(CredibleRegionStyle[k]);}
\DoxyCodeLine{01685\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01686\ \ \ \ \ \}}
\DoxyCodeLine{01687\ \ \ \}}
\DoxyCodeLine{01688\ }
\DoxyCodeLine{01689\ \ \ gStyle-\/>SetPalette(51);}
\DoxyCodeLine{01690\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{01691\ \ \ \{}
\DoxyCodeLine{01692\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ ++j)}
\DoxyCodeLine{01693\ \ \ \ \ \{}
\DoxyCodeLine{01694\ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ the\ diagonal\ elements\ which\ we've\ already\ done\ above}}
\DoxyCodeLine{01695\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ ==\ i)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01696\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a95fa49737432818bc830a44898d0d850}{IamVaried}}[j]\ ==\ \textcolor{keyword}{false})\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01697\ }
\DoxyCodeLine{01698\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ legend\ =\ std::make\_unique<TLegend>(0.20,\ 0.7,\ 0.4,\ 0.92);}
\DoxyCodeLine{01699\ \ \ \ \ \ \ legend-\/>SetTextColor(kRed);}
\DoxyCodeLine{01700\ \ \ \ \ \ \ legend-\/>SetTextSize(0.03);}
\DoxyCodeLine{01701\ \ \ \ \ \ \ legend-\/>SetFillColor(0);}
\DoxyCodeLine{01702\ \ \ \ \ \ \ legend-\/>SetFillStyle(0);}
\DoxyCodeLine{01703\ \ \ \ \ \ \ legend-\/>SetLineColor(0);}
\DoxyCodeLine{01704\ \ \ \ \ \ \ legend-\/>SetLineStyle(0);}
\DoxyCodeLine{01705\ \ \ \ \ \ \ legend-\/>SetBorderSize(0);}
\DoxyCodeLine{01706\ }
\DoxyCodeLine{01707\ \ \ \ \ \ \ \textcolor{comment}{//Get\ Best\ point}}
\DoxyCodeLine{01708\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ bestfitM\ =\ std::make\_unique<TGraph>(1);}
\DoxyCodeLine{01709\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ MaxBin\ =\ hpost\_2D\_copy[i][j]-\/>GetMaximumBin();}
\DoxyCodeLine{01710\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ Mbx,\ Mby,\ Mbz;}
\DoxyCodeLine{01711\ \ \ \ \ \ \ hpost\_2D\_copy[i][j]-\/>GetBinXYZ(MaxBin,\ Mbx,\ Mby,\ Mbz);}
\DoxyCodeLine{01712\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Mx\ =\ hpost\_2D\_copy[i][j]-\/>GetXaxis()-\/>GetBinCenter(Mbx);}
\DoxyCodeLine{01713\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ My\ =\ hpost\_2D\_copy[i][j]-\/>GetYaxis()-\/>GetBinCenter(Mby);}
\DoxyCodeLine{01714\ }
\DoxyCodeLine{01715\ \ \ \ \ \ \ bestfitM-\/>SetPoint(0,\ Mx,\ My);}
\DoxyCodeLine{01716\ \ \ \ \ \ \ bestfitM-\/>SetMarkerStyle(22);}
\DoxyCodeLine{01717\ \ \ \ \ \ \ bestfitM-\/>SetMarkerSize(1);}
\DoxyCodeLine{01718\ \ \ \ \ \ \ bestfitM-\/>SetMarkerColor(kMagenta);}
\DoxyCodeLine{01719\ \ \ \ \ \ \ legend-\/>AddEntry(bestfitM.get(),\textcolor{stringliteral}{"{}Best\ Fit"{}},\textcolor{stringliteral}{"{}p"{}});}
\DoxyCodeLine{01720\ }
\DoxyCodeLine{01721\ \ \ \ \ \ \ \textcolor{comment}{//Plot\ default\ 2D\ posterior}}
\DoxyCodeLine{01722\ \ \ \ \ \ \ hpost\_2D\_copy[i][j]-\/>Draw(\textcolor{stringliteral}{"{}COLZ"{}});}
\DoxyCodeLine{01723\ }
\DoxyCodeLine{01724\ \ \ \ \ \ \ \textcolor{comment}{//Now\ credible\ regions}}
\DoxyCodeLine{01725\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ nCredible;\ ++k)}
\DoxyCodeLine{01726\ \ \ \ \ \ \ \ \ hpost\_2D\_cl[i][j][k]-\/>Draw(\textcolor{stringliteral}{"{}CONT3\ SAME"{}});}
\DoxyCodeLine{01727\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ nCredible-\/1;\ k\ >=\ 0;\ -\/-\/k)}
\DoxyCodeLine{01728\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01729\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(CredibleInSigmas)}
\DoxyCodeLine{01730\ \ \ \ \ \ \ \ \ \ \ legend-\/>AddEntry(hpost\_2D\_cl[i][j][k],\ Form(\textcolor{stringliteral}{"{}\%.0f\#sigma\ Credible\ Interval"{}},\ CredibleRegions[k]),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{01731\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01732\ \ \ \ \ \ \ \ \ \ \ legend-\/>AddEntry(hpost\_2D\_cl[i][j][k],\ Form(\textcolor{stringliteral}{"{}\%.0f\%\%\ Credible\ Region"{}},\ CredibleRegions[k]*100),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{01733\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01734\ \ \ \ \ \ \ legend-\/>Draw(\textcolor{stringliteral}{"{}SAME"{}});}
\DoxyCodeLine{01735\ \ \ \ \ \ \ bestfitM-\/>Draw(\textcolor{stringliteral}{"{}SAME.P"{}});}
\DoxyCodeLine{01736\ }
\DoxyCodeLine{01737\ \ \ \ \ \ \ \textcolor{comment}{//\ Write\ to\ file}}
\DoxyCodeLine{01738\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetName(\mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>GetName());}
\DoxyCodeLine{01739\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTitle(\mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>GetTitle());}
\DoxyCodeLine{01740\ }
\DoxyCodeLine{01741\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Print\ only\ regions\ with\ correlation\ greater\ than\ specified\ value,\ by\ defualt\ 0.2.\ This\ is\ done\ to\ avoid\ dumping\ thousands\ of\ plots}}
\DoxyCodeLine{01742\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}}\ \&\&\ std::fabs((*\mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}})(i,j))\ >\ \mbox{\hyperlink{classMCMCProcessor_a25e4685b6299181021b02ac0e0b74681}{Post2DPlotThreshold}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{01743\ \ \ \ \ \ \ \textcolor{comment}{//\ Write\ it\ to\ root\ file}}
\DoxyCodeLine{01744\ \ \ \ \ \ \ \textcolor{comment}{//OutputFile-\/>cd();}}
\DoxyCodeLine{01745\ \ \ \ \ \ \ \textcolor{comment}{//if(\ std::fabs((*Correlation)(i,j))\ >\ Post2DPlotThreshold\ )\ Posterior-\/>Write();}}
\DoxyCodeLine{01746\ \ \ \ \ \}}
\DoxyCodeLine{01747\ \ \ \}}
\DoxyCodeLine{01748\ }
\DoxyCodeLine{01749\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{01750\ \ \ \textcolor{comment}{//KS:\ Remove\ histograms}}
\DoxyCodeLine{01751\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{01752\ \ \ \{}
\DoxyCodeLine{01753\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ ++j)}
\DoxyCodeLine{01754\ \ \ \ \ \{}
\DoxyCodeLine{01755\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ hpost\_2D\_copy[i][j];}
\DoxyCodeLine{01756\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ nCredible;\ ++k)}
\DoxyCodeLine{01757\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01758\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ hpost\_2D\_cl[i][j][k];}
\DoxyCodeLine{01759\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01760\ \ \ \ \ \}}
\DoxyCodeLine{01761\ \ \ \}}
\DoxyCodeLine{01762\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_aa5a7761e97cf2e24c7d877a5374b7333}\label{classMCMCProcessor_aa5a7761e97cf2e24c7d877a5374b7333}} 
\index{MCMCProcessor@{MCMCProcessor}!MakeOutputFile@{MakeOutputFile}}
\index{MakeOutputFile@{MakeOutputFile}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{MakeOutputFile()}{MakeOutputFile()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Make\+Output\+File (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



prepare output root file and canvas to which we will save EVERYTHING 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l00208}{208}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00209\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{00210\ \ \ \textcolor{comment}{//KS:\ ROOT\ hates\ me...\ but\ we\ can\ create\ several\ instances\ of\ MCMC\ Processor,\ each\ with\ own\ TCanvas\ ROOT\ is\ mad\ and\ will\ delete\ if\ there\ is\ more\ than\ one\ canvas\ with\ the\ same\ name,\ so\ we\ add\ random\ number\ to\ avoid\ issue}}
\DoxyCodeLine{00211\ \ \ \textcolor{keyword}{auto}\ rand\ =\ std::make\_unique<TRandom3>(0);}
\DoxyCodeLine{00212\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ uniform\ =\ int(rand-\/>Uniform(0,\ 10000));}
\DoxyCodeLine{00213\ \ \ \textcolor{comment}{//\ Open\ a\ TCanvas\ to\ write\ the\ posterior\ onto}}
\DoxyCodeLine{00214\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}\ =\ \textcolor{keyword}{new}\ TCanvas((\textcolor{stringliteral}{"{}Posterior"{}}\ +\ std::to\_string(uniform)).c\_str(),\ (\textcolor{stringliteral}{"{}Posterior"{}}\ +\ std::to\_string(uniform)).c\_str(),\ 0,\ 0,\ 1024,\ 1024);}
\DoxyCodeLine{00215\ \ \ \textcolor{comment}{//KS:\ No\ idea\ why\ but\ ROOT\ changed\ treatment\ of\ violin\ in\ R6.\ If\ you\ have\ non\ uniform\ binning\ this\ will\ results\ in\ very\ hard\ to\ see\ violin\ plots.}}
\DoxyCodeLine{00216\ \ \ TCandle::SetScaledViolin(\textcolor{keyword}{false});}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00218\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetGrid();}
\DoxyCodeLine{00219\ \ \ gStyle-\/>SetOptStat(0);}
\DoxyCodeLine{00220\ \ \ gStyle-\/>SetOptTitle(0);}
\DoxyCodeLine{00221\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTickx();}
\DoxyCodeLine{00222\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTicky();}
\DoxyCodeLine{00223\ }
\DoxyCodeLine{00224\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetBottomMargin(0.1);}
\DoxyCodeLine{00225\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTopMargin(0.05);}
\DoxyCodeLine{00226\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetRightMargin(0.03);}
\DoxyCodeLine{00227\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetLeftMargin(0.15);}
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00229\ \ \ \textcolor{comment}{//To\ avoid\ TCanvas::Print>\ messages}}
\DoxyCodeLine{00230\ \ \ gErrorIgnoreLevel\ =\ kWarning;}
\DoxyCodeLine{00231\ \ \ }
\DoxyCodeLine{00232\ \ \ \textcolor{comment}{//\ Output\ file\ to\ write\ to}}
\DoxyCodeLine{00233\ \ \ \mbox{\hyperlink{classMCMCProcessor_a3d17c1720b91d6d0361da0b5dabfbbff}{OutputName}}\ =\ \mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}}\ +\ \mbox{\hyperlink{classMCMCProcessor_aa34b50ce33fb2cb7d9e9ef2d9f2f67c1}{OutputSuffix}}\ +\textcolor{stringliteral}{"{}.root"{}};}
\DoxyCodeLine{00234\ }
\DoxyCodeLine{00235\ \ \ \textcolor{comment}{//\ Output\ file}}
\DoxyCodeLine{00236\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}\ =\ \textcolor{keyword}{new}\ TFile(\mbox{\hyperlink{classMCMCProcessor_a3d17c1720b91d6d0361da0b5dabfbbff}{OutputName}}.c\_str(),\ \textcolor{stringliteral}{"{}recreate"{}});}
\DoxyCodeLine{00237\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{00238\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a8667510132aa01395520f028287f511b}\label{classMCMCProcessor_a8667510132aa01395520f028287f511b}} 
\index{MCMCProcessor@{MCMCProcessor}!MakePostfit@{MakePostfit}}
\index{MakePostfit@{MakePostfit}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{MakePostfit()}{MakePostfit()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Make\+Postfit (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Make 1D projection for each parameter and prepare structure. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l00242}{242}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00243\ \textcolor{comment}{//\ ****************************}}
\DoxyCodeLine{00244\ }
\DoxyCodeLine{00245\ \ \ \textcolor{comment}{//\ Check\ if\ we've\ already\ made\ post-\/fit}}
\DoxyCodeLine{00246\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_aecc35d4ea7d2c7e020e50388ba0ffb64}{MadePostfit}}\ ==\ \textcolor{keyword}{true})\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00247\ \ \ \mbox{\hyperlink{classMCMCProcessor_aecc35d4ea7d2c7e020e50388ba0ffb64}{MadePostfit}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00249\ \ \ \textcolor{comment}{//\ Check\ if\ the\ output\ file\ is\ ready}}
\DoxyCodeLine{00250\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_aa5a7761e97cf2e24c7d877a5374b7333}{MakeOutputFile}}();}
\DoxyCodeLine{00251\ \ \ }
\DoxyCodeLine{00252\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}MCMCProcessor\ is\ making\ post-\/fit\ plots..."{}});}
\DoxyCodeLine{00253\ }
\DoxyCodeLine{00254\ \ \ \textcolor{comment}{//\ Directory\ for\ posteriors}}
\DoxyCodeLine{00255\ \ \ TDirectory\ *PostDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}Post"{}});}
\DoxyCodeLine{00256\ \ \ TDirectory\ *PostHistDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}Post\_1d\_hists"{}});}
\DoxyCodeLine{00257\ }
\DoxyCodeLine{00258\ \ \ \textcolor{comment}{//\ We\ fit\ with\ this\ Gaussian}}
\DoxyCodeLine{00259\ \ \ \mbox{\hyperlink{classMCMCProcessor_a92c1d9b0ebdf90951221cdaf2ac4cc2c}{Gauss}}\ =\ \textcolor{keyword}{new}\ TF1(\textcolor{stringliteral}{"{}Gauss"{}},\textcolor{stringliteral}{"{}[0]/sqrt(2.0*3.14159)/[2]*TMath::Exp(-\/0.5*pow(x-\/[1],2)/[2]/[2])"{}},-\/5,5);}
\DoxyCodeLine{00260\ \ \ \mbox{\hyperlink{classMCMCProcessor_a92c1d9b0ebdf90951221cdaf2ac4cc2c}{Gauss}}-\/>SetLineWidth(2);}
\DoxyCodeLine{00261\ \ \ \mbox{\hyperlink{classMCMCProcessor_a92c1d9b0ebdf90951221cdaf2ac4cc2c}{Gauss}}-\/>SetLineColor(kOrange-\/5);}
\DoxyCodeLine{00262\ \ \ }
\DoxyCodeLine{00263\ \ \ \textcolor{comment}{//\ nDraw\ is\ number\ of\ draws\ we\ want\ to\ do}}
\DoxyCodeLine{00264\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{00265\ \ \ \{}
\DoxyCodeLine{00266\ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ \%\ (\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}/5)\ ==\ 0)}
\DoxyCodeLine{00267\ \ \ \ \ \{}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \mbox{\hyperlink{namespaceMaCh3Utils_a4c8bdeb1d34606aed192e9f1311a72f5}{MaCh3Utils::PrintProgressBar}}(i,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{00269\ \ \ \ \ \}}
\DoxyCodeLine{00270\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{00271\ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00272\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{00273\ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{00274\ \ \ \ \ }
\DoxyCodeLine{00275\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(i,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00277\ \ \ \ \ \textcolor{comment}{//\ This\ holds\ the\ posterior\ density}}
\DoxyCodeLine{00278\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ maxi\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMaximum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i]);}
\DoxyCodeLine{00279\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ mini\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMinimum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i]);}
\DoxyCodeLine{00280\ \ \ \ \ \textcolor{comment}{//\ This\ holds\ the\ posterior\ density}}
\DoxyCodeLine{00281\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]\ =\ \textcolor{keyword}{new}\ TH1D(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i],\ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i],\ \mbox{\hyperlink{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}{nBins}},\ mini,\ maxi);}
\DoxyCodeLine{00282\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>SetMinimum(0);}
\DoxyCodeLine{00283\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Steps"{}});}
\DoxyCodeLine{00284\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetYaxis()-\/>SetNoExponent(\textcolor{keyword}{false});}
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00286\ \ \ \ \ \textcolor{comment}{//KS:\ Apply\ additional\ Cuts,\ like\ mass\ ordering}}
\DoxyCodeLine{00287\ \ \ \ \ std::string\ CutPosterior1D\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00288\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a85917e25c4f5b5b966c50cccd9ddd6a0}{Posterior1DCut}}\ !=\ \textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{00289\ \ \ \ \ \{}
\DoxyCodeLine{00290\ \ \ \ \ \ \ CutPosterior1D\ =\ \mbox{\hyperlink{classMCMCProcessor_a576f0eb874afaf7e31ff5c86b9e5b8f9}{StepCut}}\ +\textcolor{stringliteral}{"{}\ \&\&\ "{}}\ +\ \mbox{\hyperlink{classMCMCProcessor_a85917e25c4f5b5b966c50cccd9ddd6a0}{Posterior1DCut}};}
\DoxyCodeLine{00291\ \ \ \ \ \}}
\DoxyCodeLine{00292\ \ \ \ \ \textcolor{keywordflow}{else}\ CutPosterior1D\ =\ \mbox{\hyperlink{classMCMCProcessor_a576f0eb874afaf7e31ff5c86b9e5b8f9}{StepCut}};}
\DoxyCodeLine{00293\ }
\DoxyCodeLine{00294\ \ \ \ \ \textcolor{comment}{//\ Project\ BranchNames[i]\ onto\ hpost,\ applying\ stepcut}}
\DoxyCodeLine{00295\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>Project(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i],\ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i],\ CutPosterior1D.c\_str());}
\DoxyCodeLine{00296\ }
\DoxyCodeLine{00297\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a682c1c47626542f5820d633ba2bc010c}{ApplySmoothing}})\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>Smooth();}
\DoxyCodeLine{00298\ }
\DoxyCodeLine{00299\ \ \ \ \ (*Central\_Value)(i)\ =\ Prior;}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}},\ Err,\ Err\_p,\ Err\_m;}
\DoxyCodeLine{00302\ \ \ \ \ \mbox{\hyperlink{StatisticalUtils_8h_ab4dc9e4455015e55031e2cc8a076349d}{GetArithmetic}}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i],\ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}},\ Err);}
\DoxyCodeLine{00303\ \ \ \ \ (*Means)(i)\ =\ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}};}
\DoxyCodeLine{00304\ \ \ \ \ (*Errors)(i)\ =\ Err;}
\DoxyCodeLine{00305\ }
\DoxyCodeLine{00306\ \ \ \ \ \mbox{\hyperlink{StatisticalUtils_8h_a7237fc819d10a341c286a5597f584a96}{GetGaussian}}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i],\ \mbox{\hyperlink{classMCMCProcessor_a92c1d9b0ebdf90951221cdaf2ac4cc2c}{Gauss}},\ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}},\ Err);}
\DoxyCodeLine{00307\ \ \ \ \ (*Means\_Gauss)(i)\ =\ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}};}
\DoxyCodeLine{00308\ \ \ \ \ (*Errors\_Gauss)(i)\ =\ Err;}
\DoxyCodeLine{00309\ }
\DoxyCodeLine{00310\ \ \ \ \ \mbox{\hyperlink{StatisticalUtils_8h_aadbb121e8fc7db8e4e28d6b04d351460}{GetHPD}}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i],\ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}},\ Err,\ Err\_p,\ Err\_m);}
\DoxyCodeLine{00311\ \ \ \ \ (*Means\_HPD)(i)\ =\ \mbox{\hyperlink{RHat_8cpp_ab7d224b5fffa9367046f2976bb4972d1}{Mean}};}
\DoxyCodeLine{00312\ \ \ \ \ (*Errors\_HPD)(i)\ =\ Err;}
\DoxyCodeLine{00313\ \ \ \ \ (*Errors\_HPD\_Positive)(i)\ =\ Err\_p;}
\DoxyCodeLine{00314\ \ \ \ \ (*Errors\_HPD\_Negative)(i)\ =\ Err\_m;}
\DoxyCodeLine{00315\ }
\DoxyCodeLine{00316\ \ \ \ \ \textcolor{comment}{//\ Write\ the\ results\ from\ the\ projection\ into\ the\ TVectors\ and\ TMatrices}}
\DoxyCodeLine{00317\ \ \ \ \ (*Covariance)(i,i)\ =\ (*\mbox{\hyperlink{classMCMCProcessor_a5174aaa900edf16ddc6e841ea4adae83}{Errors}})(i)*(*\mbox{\hyperlink{classMCMCProcessor_a5174aaa900edf16ddc6e841ea4adae83}{Errors}})(i);}
\DoxyCodeLine{00318\ \ \ \ \ (*Correlation)(i,i)\ =\ 1.0;}
\DoxyCodeLine{00319\ }
\DoxyCodeLine{00320\ \ \ \ \ \textcolor{comment}{//KS:\ This\ need\ to\ be\ before\ SetMaximum(),\ this\ way\ plot\ is\ nicer\ as\ line\ end\ at\ the\ maximum}}
\DoxyCodeLine{00321\ \ \ \ \ \textcolor{keyword}{auto}\ hpd\ =\ std::make\_unique<TLine>((*\mbox{\hyperlink{classMCMCProcessor_a32657dc39a7fc0d04804f6195a3d8c3e}{Means\_HPD}})(i),\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetMinimum(),\ (*\mbox{\hyperlink{classMCMCProcessor_a32657dc39a7fc0d04804f6195a3d8c3e}{Means\_HPD}})(i),\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetMaximum());}
\DoxyCodeLine{00322\ \ \ \ \ hpd-\/>SetLineColor(kBlack);}
\DoxyCodeLine{00323\ \ \ \ \ hpd-\/>SetLineWidth(2);}
\DoxyCodeLine{00324\ \ \ \ \ hpd-\/>SetLineStyle(kSolid);}
\DoxyCodeLine{00325\ \ \ \ \ }
\DoxyCodeLine{00326\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>SetLineWidth(2);}
\DoxyCodeLine{00327\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>SetLineColor(kBlue-\/1);}
\DoxyCodeLine{00328\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>SetMaximum(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetMaximum()*\mbox{\hyperlink{classMCMCProcessor_a4abe633b264acd9b0459c7b8ccd8b9df}{DrawRange}});}
\DoxyCodeLine{00329\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>SetTitle(Title);}
\DoxyCodeLine{00330\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetXaxis()-\/>SetTitle(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetTitle());}
\DoxyCodeLine{00331\ \ \ \ \ }
\DoxyCodeLine{00332\ \ \ \ \ \textcolor{comment}{//\ Now\ make\ the\ TLine\ for\ the\ Asimov}}
\DoxyCodeLine{00333\ \ \ \ \ \textcolor{keyword}{auto}\ Asimov\ =\ std::make\_unique<TLine>(Prior,\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetMinimum(),\ Prior,\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetMaximum());}
\DoxyCodeLine{00334\ \ \ \ \ Asimov-\/>SetLineColor(kRed-\/3);}
\DoxyCodeLine{00335\ \ \ \ \ Asimov-\/>SetLineWidth(2);}
\DoxyCodeLine{00336\ \ \ \ \ Asimov-\/>SetLineStyle(kDashed);}
\DoxyCodeLine{00337\ }
\DoxyCodeLine{00338\ \ \ \ \ \textcolor{keyword}{auto}\ leg\ =\ std::make\_unique<TLegend>(0.12,\ 0.6,\ 0.6,\ 0.97);}
\DoxyCodeLine{00339\ \ \ \ \ leg-\/>SetTextSize(0.04);}
\DoxyCodeLine{00340\ \ \ \ \ leg-\/>AddEntry(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i],\ Form(\textcolor{stringliteral}{"{}\#splitline\{PDF\}\{\#mu\ =\ \%.2f,\ \#sigma\ =\ \%.2f\}"{}},\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetMean(),\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetRMS()),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{00341\ \ \ \ \ leg-\/>AddEntry(\mbox{\hyperlink{classMCMCProcessor_a92c1d9b0ebdf90951221cdaf2ac4cc2c}{Gauss}},\ Form(\textcolor{stringliteral}{"{}\#splitline\{Gauss\}\{\#mu\ =\ \%.2f,\ \#sigma\ =\ \%.2f\}"{}},\ \mbox{\hyperlink{classMCMCProcessor_a92c1d9b0ebdf90951221cdaf2ac4cc2c}{Gauss}}-\/>GetParameter(1),\ \mbox{\hyperlink{classMCMCProcessor_a92c1d9b0ebdf90951221cdaf2ac4cc2c}{Gauss}}-\/>GetParameter(2)),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{00342\ \ \ \ \ leg-\/>AddEntry(hpd.get(),\ Form(\textcolor{stringliteral}{"{}\#splitline\{HPD\}\{\#mu\ =\ \%.2f,\ \#sigma\ =\ \%.2f\ (+\%.2f-\/\%.2f)\}"{}},\ (*\mbox{\hyperlink{classMCMCProcessor_a32657dc39a7fc0d04804f6195a3d8c3e}{Means\_HPD}})(i),\ (*\mbox{\hyperlink{classMCMCProcessor_abb5c6ad85c89227bbb9bc5de2eb71272}{Errors\_HPD}})(i),\ (*\mbox{\hyperlink{classMCMCProcessor_af96664fa8cc51c49ad1385da07a343b8}{Errors\_HPD\_Positive}})(i),\ (*\mbox{\hyperlink{classMCMCProcessor_a7b85df39f22390dac24f4d66a89518e5}{Errors\_HPD\_Negative}})(i)),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{00343\ \ \ \ \ leg-\/>AddEntry(Asimov.get(),\ Form(\textcolor{stringliteral}{"{}\#splitline\{Prior\}\{x\ =\ \%.2f\ ,\ \#sigma\ =\ \%.2f\}"{}},\ Prior,\ PriorError),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{00344\ \ \ \ \ leg-\/>SetLineColor(0);}
\DoxyCodeLine{00345\ \ \ \ \ leg-\/>SetLineStyle(0);}
\DoxyCodeLine{00346\ \ \ \ \ leg-\/>SetFillColor(0);}
\DoxyCodeLine{00347\ \ \ \ \ leg-\/>SetFillStyle(0);}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00349\ \ \ \ \ \textcolor{comment}{//CW:\ Don't\ plot\ if\ this\ is\ a\ fixed\ histogram\ (i.e.\ the\ peak\ is\ the\ whole\ integral)}}
\DoxyCodeLine{00350\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>GetMaximum()\ ==\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>Integral()*\mbox{\hyperlink{classMCMCProcessor_a4abe633b264acd9b0459c7b8ccd8b9df}{DrawRange}})\ }
\DoxyCodeLine{00351\ \ \ \ \ \{}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Found\ fixed\ parameter,\ moving\ on"{}});}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a95fa49737432818bc830a44898d0d850}{IamVaried}}[i]\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \textcolor{comment}{//KS:Set\ mean\ and\ error\ to\ prior\ for\ fixed\ parameters,\ it\ looks\ much\ better\ when\ fixed\ parameter\ has\ mean\ on\ prior\ rather\ than\ on\ 0\ with\ 0\ error.}}
\DoxyCodeLine{00355\ \ \ \ \ \ \ (*Means\_HPD)(i)\ \ =\ Prior;}
\DoxyCodeLine{00356\ \ \ \ \ \ \ (*Errors\_HPD)(i)\ =\ PriorError;}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00358\ \ \ \ \ \}}
\DoxyCodeLine{00359\ }
\DoxyCodeLine{00360\ \ \ \ \ \textcolor{comment}{//\ Store\ that\ this\ parameter\ is\ indeed\ being\ varied}}
\DoxyCodeLine{00361\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a95fa49737432818bc830a44898d0d850}{IamVaried}}[i]\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ \ \ \ \ \textcolor{comment}{//\ Write\ to\ file}}
\DoxyCodeLine{00364\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetName(Title);}
\DoxyCodeLine{00365\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTitle(Title);}
\DoxyCodeLine{00366\ }
\DoxyCodeLine{00367\ \ \ \ \ \textcolor{comment}{//\ Draw\ onto\ the\ TCanvas}}
\DoxyCodeLine{00368\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>Draw();}
\DoxyCodeLine{00369\ \ \ \ \ hpd-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{00370\ \ \ \ \ Asimov-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{00371\ \ \ \ \ leg-\/>Draw(\textcolor{stringliteral}{"{}same"{}});\ \ }
\DoxyCodeLine{00372\ \ \ \ \ }
\DoxyCodeLine{00373\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00375\ \ \ \ \ \textcolor{comment}{//\ cd\ into\ params\ directory\ in\ root\ file}}
\DoxyCodeLine{00376\ \ \ \ \ PostDir-\/>cd();}
\DoxyCodeLine{00377\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Write();}
\DoxyCodeLine{00378\ \ \ \ \ }
\DoxyCodeLine{00379\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>SetName(Title);}
\DoxyCodeLine{00380\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>SetTitle(Title);}
\DoxyCodeLine{00381\ \ \ \ \ PostHistDir-\/>cd();}
\DoxyCodeLine{00382\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[i]-\/>Write();}
\DoxyCodeLine{00383\ \ \ \}\ \textcolor{comment}{//\ end\ the\ for\ loop\ over\ nDraw}}
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00385\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{00386\ \ \ TTree\ *SettingsBranch\ =\ \textcolor{keyword}{new}\ TTree(\textcolor{stringliteral}{"{}Settings"{}},\ \textcolor{stringliteral}{"{}Settings"{}});}
\DoxyCodeLine{00387\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{GetPostfitParamPlots_8cpp_a5307771642312031f0050189b493a621}{CrossSectionParameters}}\ =\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}];}
\DoxyCodeLine{00388\ \ \ SettingsBranch-\/>Branch(\textcolor{stringliteral}{"{}CrossSectionParameters"{}},\ \&\mbox{\hyperlink{GetPostfitParamPlots_8cpp_a5307771642312031f0050189b493a621}{CrossSectionParameters}});}
\DoxyCodeLine{00389\ \ \ \textcolor{keywordtype}{int}\ CrossSectionParametersStartingPos\ =\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}];}
\DoxyCodeLine{00390\ \ \ SettingsBranch-\/>Branch(\textcolor{stringliteral}{"{}CrossSectionParametersStartingPos"{}},\ \&CrossSectionParametersStartingPos);}
\DoxyCodeLine{00391\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{GetPostfitParamPlots_8cpp_adf4147e2ac31f2cb321121a90cb8c853}{FluxParameters}}\ =\ \mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}};}
\DoxyCodeLine{00392\ \ \ SettingsBranch-\/>Branch(\textcolor{stringliteral}{"{}FluxParameters"{}},\ \&\mbox{\hyperlink{GetPostfitParamPlots_8cpp_adf4147e2ac31f2cb321121a90cb8c853}{FluxParameters}});}
\DoxyCodeLine{00393\ \ \ }
\DoxyCodeLine{00394\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{GetPostfitParamPlots_8cpp_adb4ee3a874472b4ffccc8734da66250e}{NDParameters}}\ =\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}];}
\DoxyCodeLine{00395\ \ \ SettingsBranch-\/>Branch(\textcolor{stringliteral}{"{}NDParameters"{}},\ \&\mbox{\hyperlink{GetPostfitParamPlots_8cpp_adb4ee3a874472b4ffccc8734da66250e}{NDParameters}});}
\DoxyCodeLine{00396\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{GetPostfitParamPlots_8cpp_aa7bc6e5554391b57acf10c691b6374e0}{NDParametersStartingPos}}\ =\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}];}
\DoxyCodeLine{00397\ \ \ SettingsBranch-\/>Branch(\textcolor{stringliteral}{"{}NDParametersStartingPos"{}},\ \&\mbox{\hyperlink{GetPostfitParamPlots_8cpp_aa7bc6e5554391b57acf10c691b6374e0}{NDParametersStartingPos}});}
\DoxyCodeLine{00398\ }
\DoxyCodeLine{00399\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{GetPostfitParamPlots_8cpp_a15657a5f07a9fde98fc9210b7ae80f9e}{FDParameters}}\ =\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}];}
\DoxyCodeLine{00400\ \ \ SettingsBranch-\/>Branch(\textcolor{stringliteral}{"{}FDParameters"{}},\ \&\mbox{\hyperlink{GetPostfitParamPlots_8cpp_a15657a5f07a9fde98fc9210b7ae80f9e}{FDParameters}});}
\DoxyCodeLine{00401\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{GetPostfitParamPlots_8cpp_a6dfe886b2ff4881ee2434479a9028985}{FDParametersStartingPos}}\ =\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}];}
\DoxyCodeLine{00402\ \ \ SettingsBranch-\/>Branch(\textcolor{stringliteral}{"{}FDParametersStartingPos"{}},\ \&\mbox{\hyperlink{GetPostfitParamPlots_8cpp_a6dfe886b2ff4881ee2434479a9028985}{FDParametersStartingPos}});}
\DoxyCodeLine{00403\ \ \ }
\DoxyCodeLine{00404\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{GetPostfitParamPlots_8cpp_a5aedbc0849506477d31e20d345c967eb}{OscParameters}}\ =\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}];}
\DoxyCodeLine{00405\ \ \ SettingsBranch-\/>Branch(\textcolor{stringliteral}{"{}OscParameters"{}},\ \&\mbox{\hyperlink{GetPostfitParamPlots_8cpp_a5aedbc0849506477d31e20d345c967eb}{OscParameters}});}
\DoxyCodeLine{00406\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{GetPostfitParamPlots_8cpp_a3ec8e00c5c17bd6768473b08156f6c1c}{OscParametersStartingPos}}\ =\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}];}
\DoxyCodeLine{00407\ \ \ SettingsBranch-\/>Branch(\textcolor{stringliteral}{"{}OscParametersStartingPos"{}},\ \&\mbox{\hyperlink{GetPostfitParamPlots_8cpp_a3ec8e00c5c17bd6768473b08156f6c1c}{OscParametersStartingPos}});}
\DoxyCodeLine{00408\ \ \ }
\DoxyCodeLine{00409\ \ \ SettingsBranch-\/>Branch(\textcolor{stringliteral}{"{}NDSamplesBins"{}},\ \&\mbox{\hyperlink{classMCMCProcessor_ae76b02ce85737d30c778698ba127933b}{NDSamplesBins}});}
\DoxyCodeLine{00410\ \ \ SettingsBranch-\/>Branch(\textcolor{stringliteral}{"{}NDSamplesNames"{}},\ \&\mbox{\hyperlink{classMCMCProcessor_a27c8a25155baab660fc9658861c433ab}{NDSamplesNames}});}
\DoxyCodeLine{00411\ }
\DoxyCodeLine{00412\ \ \ SettingsBranch-\/>Fill();}
\DoxyCodeLine{00413\ \ \ SettingsBranch-\/>Write();}
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00415\ \ \ \textcolor{keyword}{delete}\ SettingsBranch;}
\DoxyCodeLine{00416\ }
\DoxyCodeLine{00417\ \ \ TDirectory\ *Names\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}Names"{}});}
\DoxyCodeLine{00418\ \ \ Names-\/>cd();}
\DoxyCodeLine{00419\ \ \ \textcolor{keywordflow}{for}\ (std::vector<TString>::iterator\ it\ =\ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}.begin();\ it\ !=\ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}.end();\ ++it)\ \{}
\DoxyCodeLine{00420\ \ \ \ \ TObjString((*it)).Write();}
\DoxyCodeLine{00421\ \ \ \}}
\DoxyCodeLine{00422\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{00423\ \ \ \mbox{\hyperlink{classMCMCProcessor_aad661c6d53f9f891e18ff8ccdbd08479}{Central\_Value}}-\/>Write(\textcolor{stringliteral}{"{}Central\_Value"{}});}
\DoxyCodeLine{00424\ \ \ \mbox{\hyperlink{classMCMCProcessor_acaf7f239136dfa3506d095b612323d0a}{Means}}-\/>Write(\textcolor{stringliteral}{"{}PDF\_Means"{}});}
\DoxyCodeLine{00425\ \ \ \mbox{\hyperlink{classMCMCProcessor_a5174aaa900edf16ddc6e841ea4adae83}{Errors}}-\/>Write(\textcolor{stringliteral}{"{}PDF\_Error"{}});}
\DoxyCodeLine{00426\ \ \ \mbox{\hyperlink{classMCMCProcessor_a600fc8c39af2750df91fb7a0ff85ac74}{Means\_Gauss}}-\/>Write(\textcolor{stringliteral}{"{}Gauss\_Means"{}});}
\DoxyCodeLine{00427\ \ \ \mbox{\hyperlink{classMCMCProcessor_aa78b7ed1bb9966f84f4eaf8cedf5e688}{Errors\_Gauss}}-\/>Write(\textcolor{stringliteral}{"{}Gauss\_Errors"{}});}
\DoxyCodeLine{00428\ \ \ \mbox{\hyperlink{classMCMCProcessor_a32657dc39a7fc0d04804f6195a3d8c3e}{Means\_HPD}}-\/>Write(\textcolor{stringliteral}{"{}Means\_HPD"{}});}
\DoxyCodeLine{00429\ \ \ \mbox{\hyperlink{classMCMCProcessor_abb5c6ad85c89227bbb9bc5de2eb71272}{Errors\_HPD}}-\/>Write(\textcolor{stringliteral}{"{}Errors\_HPD"{}});}
\DoxyCodeLine{00430\ \ \ \mbox{\hyperlink{classMCMCProcessor_af96664fa8cc51c49ad1385da07a343b8}{Errors\_HPD\_Positive}}-\/>Write(\textcolor{stringliteral}{"{}Errors\_HPD\_Positive"{}});}
\DoxyCodeLine{00431\ \ \ \mbox{\hyperlink{classMCMCProcessor_a7b85df39f22390dac24f4d66a89518e5}{Errors\_HPD\_Negative}}-\/>Write(\textcolor{stringliteral}{"{}Errors\_HPD\_Negative"{}});}
\DoxyCodeLine{00432\ }
\DoxyCodeLine{00433\ \ \ PostDir-\/>Close();}
\DoxyCodeLine{00434\ \ \ \textcolor{keyword}{delete}\ PostDir;}
\DoxyCodeLine{00435\ \ \ PostHistDir-\/>Close();}
\DoxyCodeLine{00436\ \ \ \textcolor{keyword}{delete}\ PostHistDir;}
\DoxyCodeLine{00437\ \}\ \textcolor{comment}{//\ Have\ now\ written\ the\ postfit\ projections}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a03267ff95cb0f4dab0882db852893768}\label{classMCMCProcessor_a03267ff95cb0f4dab0882db852893768}} 
\index{MCMCProcessor@{MCMCProcessor}!MakePrefit@{MakePrefit}}
\index{MakePrefit@{MakePrefit}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{MakePrefit()}{MakePrefit()}}
{\footnotesize\ttfamily TH1D $\ast$ MCMCProcessor\+::\+Make\+Prefit (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Prepare prefit histogram for parameter overlay plot. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l02326}{2326}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02326\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02327\ \textcolor{comment}{//\ *****************************}}
\DoxyCodeLine{02328\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_aa5a7761e97cf2e24c7d877a5374b7333}{MakeOutputFile}}();}
\DoxyCodeLine{02329\ }
\DoxyCodeLine{02330\ \ \ TH1D\ *PreFitPlot\ =\ \textcolor{keyword}{new}\ TH1D(\textcolor{stringliteral}{"{}Prefit"{}},\ \textcolor{stringliteral}{"{}Prefit"{}},\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{02331\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ PreFitPlot-\/>GetNbinsX()\ +\ 1;\ ++i)\ \{}
\DoxyCodeLine{02332\ \ \ \ \ PreFitPlot-\/>SetBinContent(i+1,\ 0);}
\DoxyCodeLine{02333\ \ \ \ \ PreFitPlot-\/>SetBinError(i+1,\ 0);}
\DoxyCodeLine{02334\ \ \ \}}
\DoxyCodeLine{02335\ }
\DoxyCodeLine{02336\ \ \ \textcolor{comment}{//KS:\ Slightly\ hacky\ way\ to\ get\ relative\ to\ prior\ or\ nominal\ as\ this\ is\ convention\ we\ use,}}
\DoxyCodeLine{02337\ \ \ \textcolor{comment}{//Only\ applies\ for\ xsec,\ for\ other\ systematic\ it\ make\ no\ difference}}
\DoxyCodeLine{02338\ \ \ \textcolor{keywordtype}{double}\ CentralValueTemp,\ Central,\ Error;}
\DoxyCodeLine{02339\ }
\DoxyCodeLine{02340\ \ \ \textcolor{comment}{//\ Set\ labels\ and\ data}}
\DoxyCodeLine{02341\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{02342\ \ \ \{}
\DoxyCodeLine{02343\ \ \ \ \ \textcolor{comment}{//Those\ keep\ which\ parameter\ type\ we\ run\ currently\ and\ relative\ number}}
\DoxyCodeLine{02344\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamEnum\ =\ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}[i];}
\DoxyCodeLine{02345\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamNo\ =\ i\ -\/\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20b}{ParameterEnum}}(ParamEnum)];}
\DoxyCodeLine{02346\ \ \ \ \ CentralValueTemp\ =\ \mbox{\hyperlink{classMCMCProcessor_a3a6614826ae320e462211e38e96d9d02}{ParamCentral}}[ParamEnum][ParamNo];}
\DoxyCodeLine{02347\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_afbac2a114c15ca7db4abe71dd549504c}{plotRelativeToPrior}})\ }
\DoxyCodeLine{02348\ \ \ \ \ \{}
\DoxyCodeLine{02349\ \ \ \ \ \ \ \textcolor{comment}{//\ Normalise\ the\ prior\ relative\ the\ nominal/prior,\ just\ the\ way\ we\ get\ our\ fit\ results\ in\ MaCh3}}
\DoxyCodeLine{02350\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ CentralValueTemp\ !=\ 0)}
\DoxyCodeLine{02351\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02352\ \ \ \ \ \ \ \ \ Central\ =\ \mbox{\hyperlink{classMCMCProcessor_a3a6614826ae320e462211e38e96d9d02}{ParamCentral}}[ParamEnum][ParamNo]\ /\ CentralValueTemp;}
\DoxyCodeLine{02353\ \ \ \ \ \ \ \ \ Error\ =\ \mbox{\hyperlink{classMCMCProcessor_a3a97e3cb4be3ceb9eb721eac51d82d60}{ParamErrors}}[ParamEnum][ParamNo]/CentralValueTemp;}
\DoxyCodeLine{02354\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ }
\DoxyCodeLine{02355\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02356\ \ \ \ \ \ \ \ \ Central\ =\ CentralValueTemp\ +\ 1.0;}
\DoxyCodeLine{02357\ \ \ \ \ \ \ \ \ Error\ =\ \mbox{\hyperlink{classMCMCProcessor_a3a97e3cb4be3ceb9eb721eac51d82d60}{ParamErrors}}[ParamEnum][ParamNo];}
\DoxyCodeLine{02358\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02359\ \ \ \ \ \}}
\DoxyCodeLine{02360\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02361\ \ \ \ \ \{}
\DoxyCodeLine{02362\ \ \ \ \ \ \ Central\ =\ CentralValueTemp;}
\DoxyCodeLine{02363\ \ \ \ \ \ \ Error\ =\ \mbox{\hyperlink{classMCMCProcessor_a3a97e3cb4be3ceb9eb721eac51d82d60}{ParamErrors}}[ParamEnum][ParamNo];}
\DoxyCodeLine{02364\ \ \ \ \ \}}
\DoxyCodeLine{02365\ \ \ \ \ \textcolor{comment}{//KS:\ If\ plotting\ error\ for\ param\ with\ flat\ prior\ is\ turned\ off\ and\ given\ param\ really\ has\ flat\ prior\ set\ error\ to\ 0}}
\DoxyCodeLine{02366\ \ \ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{classMCMCProcessor_ad24411a2556504c440ff0af045e8e7aa}{PlotFlatPrior}}\ \&\&\ \mbox{\hyperlink{classMCMCProcessor_a4be1eedb743e4ea410009a4fa45720f7}{ParamFlat}}[ParamEnum][ParamNo])}
\DoxyCodeLine{02367\ \ \ \ \ \{}
\DoxyCodeLine{02368\ \ \ \ \ \ \ Error\ =\ 0.;}
\DoxyCodeLine{02369\ \ \ \ \ \}}
\DoxyCodeLine{02370\ }
\DoxyCodeLine{02371\ \ \ \ \ PreFitPlot-\/>SetBinContent(i+1,\ Central);}
\DoxyCodeLine{02372\ \ \ \ \ PreFitPlot-\/>SetBinError(i+1,\ Error);}
\DoxyCodeLine{02373\ \ \ \ \ PreFitPlot-\/>GetXaxis()-\/>SetBinLabel(i+1,\ \mbox{\hyperlink{classMCMCProcessor_adecc55689f7d37b9412f8886fe3480dc}{ParamNames}}[ParamEnum][ParamNo]);}
\DoxyCodeLine{02374\ \ \ \}}
\DoxyCodeLine{02375\ \ \ PreFitPlot-\/>SetDirectory(0);}
\DoxyCodeLine{02376\ }
\DoxyCodeLine{02377\ \ \ PreFitPlot-\/>SetFillStyle(1001);}
\DoxyCodeLine{02378\ \ \ PreFitPlot-\/>SetFillColor(kRed-\/3);}
\DoxyCodeLine{02379\ \ \ PreFitPlot-\/>SetMarkerStyle(21);}
\DoxyCodeLine{02380\ \ \ PreFitPlot-\/>SetMarkerSize(2.4);}
\DoxyCodeLine{02381\ \ \ PreFitPlot-\/>SetMarkerColor(kWhite);}
\DoxyCodeLine{02382\ \ \ PreFitPlot-\/>SetLineColor(PreFitPlot-\/>GetFillColor());}
\DoxyCodeLine{02383\ \ \ PreFitPlot-\/>GetXaxis()-\/>LabelsOption(\textcolor{stringliteral}{"{}v"{}});}
\DoxyCodeLine{02384\ }
\DoxyCodeLine{02385\ \ \ \textcolor{keywordflow}{return}\ PreFitPlot;}
\DoxyCodeLine{02386\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_afac304b884238cc3624f5471b43f1a7e}\label{classMCMCProcessor_afac304b884238cc3624f5471b43f1a7e}} 
\index{MCMCProcessor@{MCMCProcessor}!MakeSubOptimality@{MakeSubOptimality}}
\index{MakeSubOptimality@{MakeSubOptimality}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{MakeSubOptimality()}{MakeSubOptimality()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Make\+Sub\+Optimality (\begin{DoxyParamCaption}\item[{const int}]{NIntervals = {\ttfamily 10} }\end{DoxyParamCaption})}



Make and Draw Sub\+Optimality \cite{roberts2009adaptive}. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l01317}{1317}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01318\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{01319\ }
\DoxyCodeLine{01320\ \ \ \textcolor{comment}{//Save\ burn\ in\ cut,\ at\ the\ end\ of\ the\ loop\ we\ will\ return\ to\ default\ values}}
\DoxyCodeLine{01321\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ DefaultUpperCut\ =\ \mbox{\hyperlink{classMCMCProcessor_a840c686f15f419c0156df01c4ed62931}{UpperCut}};}
\DoxyCodeLine{01322\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ DefaultBurnInCut\ =\ \mbox{\hyperlink{classMCMCProcessor_a22f82dadceccbe87dd8c5b7daa8432e8}{BurnInCut}};}
\DoxyCodeLine{01323\ \ \ \textcolor{keywordtype}{bool}\ defaultPrintToPDF\ =\ \mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}};}
\DoxyCodeLine{01324\ \ \ \mbox{\hyperlink{classMCMCProcessor_a22f82dadceccbe87dd8c5b7daa8432e8}{BurnInCut}}\ =\ 0;}
\DoxyCodeLine{01325\ \ \ \mbox{\hyperlink{classMCMCProcessor_a840c686f15f419c0156df01c4ed62931}{UpperCut}}\ =\ 0;}
\DoxyCodeLine{01326\ \ \ \mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01327\ }
\DoxyCodeLine{01328\ \ \ \textcolor{comment}{//Set\ via\ config\ in\ future}}
\DoxyCodeLine{01329\ \ \ \textcolor{keywordtype}{int}\ MaxStep\ =\ \mbox{\hyperlink{classMCMCProcessor_aae0016a4e1d105d5d65243438c622a97}{nSteps}};}
\DoxyCodeLine{01330\ \ \ \textcolor{keywordtype}{int}\ MinStep\ =\ 0;}
\DoxyCodeLine{01331\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ IntervalsSize\ =\ \mbox{\hyperlink{classMCMCProcessor_aae0016a4e1d105d5d65243438c622a97}{nSteps}}/NIntervals;}
\DoxyCodeLine{01332\ }
\DoxyCodeLine{01333\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ Suboptimality"{}});}
\DoxyCodeLine{01334\ \ \ TStopwatch\ clock;}
\DoxyCodeLine{01335\ \ \ clock.Start();}
\DoxyCodeLine{01336\ }
\DoxyCodeLine{01337\ \ \ std::unique\_ptr<TH1D>\ SubOptimality\ =\ std::make\_unique<TH1D>(\textcolor{stringliteral}{"{}Suboptimality"{}},\ \textcolor{stringliteral}{"{}Suboptimality"{}},\ NIntervals,\ MinStep,\ MaxStep);}
\DoxyCodeLine{01338\ \ \ SubOptimality-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Step"{}});}
\DoxyCodeLine{01339\ \ \ SubOptimality-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Suboptimality"{}});}
\DoxyCodeLine{01340\ \ \ SubOptimality-\/>SetLineWidth(2);}
\DoxyCodeLine{01341\ \ \ SubOptimality-\/>SetLineColor(kBlue);}
\DoxyCodeLine{01342\ }
\DoxyCodeLine{01343\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ NIntervals;\ ++i)}
\DoxyCodeLine{01344\ \ \ \{}
\DoxyCodeLine{01345\ \ \ \ \ \textcolor{comment}{//Reset\ our\ cov\ matrix}}
\DoxyCodeLine{01346\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a36441ec3d5b0e24e48040282ffcda3eb}{ResetHistograms}}();}
\DoxyCodeLine{01347\ }
\DoxyCodeLine{01348\ \ \ \ \ \textcolor{comment}{//Set\ threshold\ for\ calculating\ new\ matrix}}
\DoxyCodeLine{01349\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a840c686f15f419c0156df01c4ed62931}{UpperCut}}\ =\ i*IntervalsSize;}
\DoxyCodeLine{01350\ \ \ \ \ \textcolor{comment}{//Calculate\ cov\ matrix}}
\DoxyCodeLine{01351\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ab367cb5f56606338bb1fce780f2414e8}{MakeCovariance\_MP}}(\textcolor{keyword}{true});}
\DoxyCodeLine{01352\ }
\DoxyCodeLine{01353\ \ \ \ \ \textcolor{comment}{//Calculate\ eigen\ values}}
\DoxyCodeLine{01354\ \ \ \ \ TMatrixDSymEigen\ eigen(*\mbox{\hyperlink{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}{Covariance}});}
\DoxyCodeLine{01355\ \ \ \ \ TVectorD\ eigen\_values;}
\DoxyCodeLine{01356\ \ \ \ \ eigen\_values.ResizeTo(eigen.GetEigenValues());}
\DoxyCodeLine{01357\ \ \ \ \ eigen\_values\ =\ eigen.GetEigenValues();}
\DoxyCodeLine{01358\ }
\DoxyCodeLine{01359\ \ \ \ \ \textcolor{comment}{//KS:\ Converting\ from\ ROOT\ to\ vector\ as\ to\ make\ using\ other\ libraires\ (Eigen)\ easier\ in\ future}}
\DoxyCodeLine{01360\ \ \ \ \ std::vector<double>\ EigenValues(eigen\_values.GetNrows());}
\DoxyCodeLine{01361\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ EigenValues.size();\ j++)}
\DoxyCodeLine{01362\ \ \ \ \ \{}
\DoxyCodeLine{01363\ \ \ \ \ \ \ EigenValues[j]\ =\ eigen\_values(j);}
\DoxyCodeLine{01364\ \ \ \ \ \}}
\DoxyCodeLine{01365\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ SubOptimalityValue\ =\ \mbox{\hyperlink{StatisticalUtils_8h_a34d5232bfb12e29ec9d63acaa8744b58}{GetSubOptimality}}(EigenValues,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{01366\ \ \ \ \ SubOptimality-\/>SetBinContent(i+1,\ SubOptimalityValue);}
\DoxyCodeLine{01367\ \ \ \}}
\DoxyCodeLine{01368\ \ \ clock.Stop();}
\DoxyCodeLine{01369\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ Suboptimality\ took\ \{:.2f\}s\ to\ finish\ for\ \{\}\ steps"{}},\ clock.RealTime(),\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{01370\ }
\DoxyCodeLine{01371\ \ \ \mbox{\hyperlink{classMCMCProcessor_a840c686f15f419c0156df01c4ed62931}{UpperCut}}\ =\ DefaultUpperCut;}
\DoxyCodeLine{01372\ \ \ \mbox{\hyperlink{classMCMCProcessor_a22f82dadceccbe87dd8c5b7daa8432e8}{BurnInCut}}\ =\ DefaultBurnInCut;}
\DoxyCodeLine{01373\ \ \ \mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}}\ =\ defaultPrintToPDF;}
\DoxyCodeLine{01374\ }
\DoxyCodeLine{01375\ \ \ SubOptimality-\/>Draw(\textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{01376\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetName(SubOptimality-\/>GetName());}
\DoxyCodeLine{01377\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTitle(SubOptimality-\/>GetTitle());}
\DoxyCodeLine{01378\ }
\DoxyCodeLine{01379\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{01380\ \ \ \textcolor{comment}{//\ Write\ it\ to\ root\ file}}
\DoxyCodeLine{01381\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{01382\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Write();}
\DoxyCodeLine{01383\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a3ae80722efa0c94eec066ee91f3cf997}\label{classMCMCProcessor_a3ae80722efa0c94eec066ee91f3cf997}} 
\index{MCMCProcessor@{MCMCProcessor}!MakeTrianglePlot@{MakeTrianglePlot}}
\index{MakeTrianglePlot@{MakeTrianglePlot}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{MakeTrianglePlot()}{MakeTrianglePlot()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Make\+Triangle\+Plot (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ std\+::string $>$ \&}]{Par\+Names,  }\item[{const std\+::vector$<$ double $>$ \&}]{Credible\+Intervals = {\ttfamily \{0.99,~0.90,~0.68~\}},  }\item[{const std\+::vector$<$ Color\+\_\+t $>$ \&}]{Credible\+Intervals\+Colours = {\ttfamily \{kCyan+4,~kCyan-\/2,~kCyan-\/10\}},  }\item[{const std\+::vector$<$ double $>$ \&}]{Credible\+Regions = {\ttfamily \{0.99,~0.90,~0.68\}},  }\item[{const std\+::vector$<$ Style\+\_\+t $>$ \&}]{Credible\+Region\+Style = {\ttfamily \{kDashed,~kSolid,~kDotted\}},  }\item[{const std\+::vector$<$ Color\+\_\+t $>$ \&}]{Credible\+Region\+Color = {\ttfamily \{kGreen-\/3,~kGreen-\/10,~kGreen\}},  }\item[{const bool}]{Credible\+In\+Sigmas = {\ttfamily false} }\end{DoxyParamCaption})}



Make fancy triangle plot for selected parameters. 


\begin{DoxyParams}{Parameters}
{\em Credible\+Intervals} & Vector with values of credible intervals, must be in descending order \\
\hline
{\em Credible\+Intervals\+Colours} & Color\+\_\+t telling what colour to use for each Interval line \\
\hline
{\em Credible\+In\+Sigmas} & Bool telling whether intervals are in percentage or in sigmas, then special conversions is used \\
\hline
{\em Credible\+Regions} & Vector with values of credible intervals, must be in descending order \\
\hline
{\em Credible\+Region\+Style} & Style\+\_\+t telling what line style to use for each Interval line \\
\hline
{\em Credible\+Region\+Color} & Color\+\_\+t telling what colour to use for each Interval line \\
\hline
{\em Credible\+In\+Sigmas} & Bool telling whether intervals are in percentage or in sigmas, then special conversions is used \\
\hline
\end{DoxyParams}
Scale the histograms so it shows the posterior probability

Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l01766}{1766}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01775\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01776\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{01777\ }
\DoxyCodeLine{01778\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_ab367cb5f56606338bb1fce780f2414e8}{MakeCovariance\_MP}}();}
\DoxyCodeLine{01779\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ Triangle\ Plot"{}});}
\DoxyCodeLine{01780\ }
\DoxyCodeLine{01781\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nParamPlot\ =\ int(ParNames.size());}
\DoxyCodeLine{01782\ \ \ std::vector<int>\ ParamNumber;}
\DoxyCodeLine{01783\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nParamPlot;\ ++j)}
\DoxyCodeLine{01784\ \ \ \{}
\DoxyCodeLine{01785\ \ \ \ \ \textcolor{comment}{//KS:\ First\ we\ need\ to\ find\ parameter\ number\ based\ on\ name}}
\DoxyCodeLine{01786\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamNo\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{01787\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{01788\ \ \ \ \ \{}
\DoxyCodeLine{01789\ \ \ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{01790\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{01791\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{01792\ }
\DoxyCodeLine{01793\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(i,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{01794\ }
\DoxyCodeLine{01795\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(ParNames[j]\ ==\ Title)\ ParamNo\ =\ i;}
\DoxyCodeLine{01796\ \ \ \ \ \}}
\DoxyCodeLine{01797\ \ \ \ \ \textcolor{keywordflow}{if}(ParamNo\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}})}
\DoxyCodeLine{01798\ \ \ \ \ \{}
\DoxyCodeLine{01799\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Couldn't\ find\ param\ \{\}.\ Will\ not\ plot\ Triangle\ plot"{}},\ ParNames[j]);}
\DoxyCodeLine{01800\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01801\ \ \ \ \ \}}
\DoxyCodeLine{01802\ \ \ \ \ ParamNumber.push\_back(ParamNo);}
\DoxyCodeLine{01803\ \ \ \}}
\DoxyCodeLine{01804\ }
\DoxyCodeLine{01805\ \ \ \textcolor{comment}{//KS:\ Store\ it\ as\ we\ go\ back\ to\ them\ at\ the\ end}}
\DoxyCodeLine{01806\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ TopMargin\ \ \ \ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetTopMargin();}
\DoxyCodeLine{01807\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ BottomMargin\ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetBottomMargin();}
\DoxyCodeLine{01808\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ LeftMargin\ \ \ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetLeftMargin();}
\DoxyCodeLine{01809\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ RighMargin\ \ \ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetRightMargin();}
\DoxyCodeLine{01810\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTopMargin(0.001);}
\DoxyCodeLine{01811\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetBottomMargin(0.001);}
\DoxyCodeLine{01812\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetLeftMargin(0.001);}
\DoxyCodeLine{01813\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetRightMargin(0.001);}
\DoxyCodeLine{01814\ }
\DoxyCodeLine{01815\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>cd();}
\DoxyCodeLine{01816\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Clear();}
\DoxyCodeLine{01817\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Update();}
\DoxyCodeLine{01818\ }
\DoxyCodeLine{01819\ \ \ \textcolor{comment}{//KS:\ We\ sort\ to\ have\ parameters\ from\ highest\ to\ lowest,\ this\ is\ related\ to\ how\ we\ make\ 2D\ projections\ in\ MakeCovariance\_MP}}
\DoxyCodeLine{01820\ \ \ std::sort(ParamNumber.begin(),\ ParamNumber.end(),\ \ std::greater<int>());}
\DoxyCodeLine{01821\ }
\DoxyCodeLine{01822\ \ \ \textcolor{comment}{//KS:\ Calculate\ how\ many\ pads/plots\ we\ need}}
\DoxyCodeLine{01823\ \ \ \textcolor{keywordtype}{int}\ Npad\ =\ 0;}
\DoxyCodeLine{01824\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 1;\ j\ <\ nParamPlot+1;\ j++)\ Npad\ +=\ j;}
\DoxyCodeLine{01825\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>cd();}
\DoxyCodeLine{01826\ }
\DoxyCodeLine{01827\ \ \ \textcolor{keywordflow}{if}(CredibleIntervals.size()\ !=\ CredibleIntervalsColours.size())}
\DoxyCodeLine{01828\ \ \ \{}
\DoxyCodeLine{01829\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}size\ of\ \ CredibleIntervals\ is\ not\ equat\ to\ size\ of\ CredibleIntervalsColours"{}});}
\DoxyCodeLine{01830\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{01831\ \ \ \}}
\DoxyCodeLine{01832\ \ \ \textcolor{keywordflow}{if}(CredibleIntervals.size()\ >\ 1)}
\DoxyCodeLine{01833\ \ \ \{}
\DoxyCodeLine{01834\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ CredibleIntervals.size();\ i++\ )}
\DoxyCodeLine{01835\ \ \ \ \ \{}
\DoxyCodeLine{01836\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(CredibleIntervals[i]\ >\ CredibleIntervals[i-\/1])}
\DoxyCodeLine{01837\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01838\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Interval\ \{\}\ is\ smaller\ than\ \{\}"{}},\ i,\ i-\/1);}
\DoxyCodeLine{01839\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}\{:.2f\}\ \{:.2f\}"{}},\ CredibleIntervals[i],\ CredibleIntervals[i-\/1]);}
\DoxyCodeLine{01840\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}They\ should\ be\ grouped\ in\ decreasing\ order"{}});}
\DoxyCodeLine{01841\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{01842\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01843\ \ \ \ \ \}}
\DoxyCodeLine{01844\ \ \ \}}
\DoxyCodeLine{01845\ \ \ \textcolor{keywordflow}{if}(\ (CredibleRegions.size()\ !=\ CredibleRegionStyle.size())\ ||\ (CredibleRegionStyle.size()\ !=\ CredibleRegionColor.size())\ )}
\DoxyCodeLine{01846\ \ \ \{}
\DoxyCodeLine{01847\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}size\ of\ \ CredibleRegions\ is\ not\ equat\ to\ size\ of\ CredibleRegionStyle"{}});}
\DoxyCodeLine{01848\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{01849\ \ \ \}}
\DoxyCodeLine{01850\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ CredibleRegions.size();\ i++\ )}
\DoxyCodeLine{01851\ \ \ \{}
\DoxyCodeLine{01852\ \ \ \ \ \textcolor{keywordflow}{if}(CredibleRegions[i]\ >\ CredibleRegions[i-\/1])}
\DoxyCodeLine{01853\ \ \ \ \ \{}
\DoxyCodeLine{01854\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Interval\ \{\}\ is\ smaller\ than\ \{\}"{}},\ i,\ i-\/1);}
\DoxyCodeLine{01855\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}\{:.2f\}\ \{:.2f\}"{}},\ CredibleRegions[i],\ CredibleRegions[i-\/1]);}
\DoxyCodeLine{01856\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}They\ should\ be\ grouped\ in\ decreasing\ order"{}});}
\DoxyCodeLine{01857\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{01858\ \ \ \ \ \}}
\DoxyCodeLine{01859\ \ \ \}}
\DoxyCodeLine{01860\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nCredibleIntervals\ =\ int(CredibleIntervals.size());}
\DoxyCodeLine{01861\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nCredibleRegions\ =\ int(CredibleRegions.size());}
\DoxyCodeLine{01862\ }
\DoxyCodeLine{01863\ \ \ \textcolor{comment}{//KS:\ Initialise\ Tpad\ histograms\ etc\ we\ will\ need}}
\DoxyCodeLine{01864\ \ \ TPad**\ TrianglePad\ =\ \textcolor{keyword}{new}\ TPad*[Npad];}
\DoxyCodeLine{01865\ \ \ \textcolor{comment}{//KS:\ 1D\ copy\ of\ posterior,\ we\ need\ it\ as\ we\ modify\ them}}
\DoxyCodeLine{01866\ \ \ TH1D**\ hpost\_copy\ =\ \textcolor{keyword}{new}\ TH1D*[nParamPlot];}
\DoxyCodeLine{01867\ \ \ TH1D***\ hpost\_cl\ =\ \textcolor{keyword}{new}\ TH1D**[nParamPlot];}
\DoxyCodeLine{01868\ \ \ TText\ **TriangleText\ =\ \textcolor{keyword}{new}\ TText\ *[nParamPlot*2];}
\DoxyCodeLine{01869\ \ \ TH2D**\ hpost\_2D\_copy\ =\ \textcolor{keyword}{new}\ TH2D*[Npad-\/nParamPlot];}
\DoxyCodeLine{01870\ \ \ TH2D***\ hpost\_2D\_cl\ =\ \textcolor{keyword}{new}\ TH2D**[Npad-\/nParamPlot];}
\DoxyCodeLine{01871\ \ \ gStyle-\/>SetPalette(51);}
\DoxyCodeLine{01872\ }
\DoxyCodeLine{01873\ \ \ \textcolor{comment}{//KS:\ Super\ convoluted\ way\ of\ calculating\ ranges\ for\ our\ pads,\ trust\ me\ it\ works...}}
\DoxyCodeLine{01874\ \ \ std::vector<double>\ X\_Min(nParamPlot);}
\DoxyCodeLine{01875\ \ \ std::vector<double>\ X\_Max(nParamPlot);}
\DoxyCodeLine{01876\ }
\DoxyCodeLine{01877\ \ \ X\_Min[0]\ =\ 0.10;}
\DoxyCodeLine{01878\ \ \ \textcolor{keywordtype}{double}\ xScale\ =\ (0.95\ -\/\ (X\_Min[0]+0.05))/nParamPlot;}
\DoxyCodeLine{01879\ \ \ \textcolor{comment}{//KS:\ 0.05\ is\ because\ we\ need\ additional\ offset\ for\ labels}}
\DoxyCodeLine{01880\ \ \ X\_Max[0]\ =\ X\_Min[0]+xScale+0.05;}
\DoxyCodeLine{01881\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ nParamPlot;\ i++)}
\DoxyCodeLine{01882\ \ \ \{}
\DoxyCodeLine{01883\ \ \ \ \ X\_Min[i]\ =\ X\_Max[i-\/1];}
\DoxyCodeLine{01884\ \ \ \ \ X\_Max[i]\ =\ X\_Min[i]+xScale;}
\DoxyCodeLine{01885\ \ \ \}}
\DoxyCodeLine{01886\ \ \ std::vector<double>\ Y\_Min(nParamPlot);}
\DoxyCodeLine{01887\ \ \ std::vector<double>\ Y\_Max(nParamPlot);}
\DoxyCodeLine{01888\ \ \ Y\_Max[0]\ =\ 0.95;}
\DoxyCodeLine{01889\ \ \ \textcolor{comment}{//KS:\ 0.10\ is\ becasue\ we\ need\ additional\ offset\ for\ labels}}
\DoxyCodeLine{01890\ \ \ \textcolor{keywordtype}{double}\ yScale\ =\ std::fabs(0.10\ -\/\ (Y\_Max[0]))/nParamPlot;}
\DoxyCodeLine{01891\ \ \ Y\_Min[0]\ =\ Y\_Max[0]-\/yScale;}
\DoxyCodeLine{01892\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ nParamPlot;\ i++)}
\DoxyCodeLine{01893\ \ \ \{}
\DoxyCodeLine{01894\ \ \ \ \ Y\_Max[i]\ =\ Y\_Min[i-\/1];}
\DoxyCodeLine{01895\ \ \ \ \ Y\_Min[i]\ =\ Y\_Max[i]-\/yScale;}
\DoxyCodeLine{01896\ \ \ \}}
\DoxyCodeLine{01897\ }
\DoxyCodeLine{01898\ \ \ \textcolor{comment}{//KS:\ We\ store\ as\ numbering\ of\ isn't\ straightforward}}
\DoxyCodeLine{01899\ \ \ \textcolor{keywordtype}{int}\ counterPad\ =\ 0;}
\DoxyCodeLine{01900\ \ \ \textcolor{keywordtype}{int}\ counterText\ =\ 0;}
\DoxyCodeLine{01901\ \ \ \textcolor{keywordtype}{int}\ counterPost\ =\ 0;}
\DoxyCodeLine{01902\ \ \ \textcolor{keywordtype}{int}\ counter2DPost\ =\ 0;}
\DoxyCodeLine{01903\ \ \ \textcolor{comment}{//KS:\ We\ start\ from\ top\ of\ the\ plot,\ might\ be\ confusing\ but\ works\ very\ well}}
\DoxyCodeLine{01904\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ y\ =\ 0;\ y\ <\ nParamPlot;\ y++)}
\DoxyCodeLine{01905\ \ \ \{}
\DoxyCodeLine{01906\ \ \ \ \ \textcolor{comment}{//KS:\ start\ from\ left\ and\ go\ right,\ depending\ on\ y}}
\DoxyCodeLine{01907\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <=\ y;\ x++)}
\DoxyCodeLine{01908\ \ \ \ \ \{}
\DoxyCodeLine{01909\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Need\ to\ go\ to\ canvas\ every\ time\ to\ have\ our\ pads\ in\ the\ same\ canvas,\ not\ pads\ in\ the\ pads}}
\DoxyCodeLine{01910\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>cd();}
\DoxyCodeLine{01911\ \ \ \ \ \ \ TrianglePad[counterPad]\ =\ \textcolor{keyword}{new}\ TPad(Form(\textcolor{stringliteral}{"{}TPad\_\%i"{}},\ counterPad),\ Form(\textcolor{stringliteral}{"{}TPad\_\%i"{}},\ counterPad),}
\DoxyCodeLine{01912\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ X\_Min[x],\ Y\_Min[y],\ X\_Max[x],\ Y\_Max[y]);}
\DoxyCodeLine{01913\ }
\DoxyCodeLine{01914\ \ \ \ \ \ \ TrianglePad[counterPad]-\/>SetTopMargin(0);}
\DoxyCodeLine{01915\ \ \ \ \ \ \ TrianglePad[counterPad]-\/>SetRightMargin(0);}
\DoxyCodeLine{01916\ }
\DoxyCodeLine{01917\ \ \ \ \ \ \ TrianglePad[counterPad]-\/>SetGrid();}
\DoxyCodeLine{01918\ \ \ \ \ \ \ TrianglePad[counterPad]-\/>SetFrameBorderMode(0);}
\DoxyCodeLine{01919\ \ \ \ \ \ \ TrianglePad[counterPad]-\/>SetBorderMode(0);}
\DoxyCodeLine{01920\ \ \ \ \ \ \ TrianglePad[counterPad]-\/>SetBorderSize(0);}
\DoxyCodeLine{01921\ }
\DoxyCodeLine{01922\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Corresponds\ to\ bottom\ part\ of\ the\ plot,\ need\ margins\ for\ labels}}
\DoxyCodeLine{01923\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(y\ ==\ (nParamPlot-\/1))\ TrianglePad[counterPad]-\/>SetBottomMargin(0.1);}
\DoxyCodeLine{01924\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ TrianglePad[counterPad]-\/>SetBottomMargin(0);}
\DoxyCodeLine{01925\ }
\DoxyCodeLine{01926\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Corresponds\ to\ left\ part,\ need\ margins\ for\ labels}}
\DoxyCodeLine{01927\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(x\ ==\ 0)\ TrianglePad[counterPad]-\/>SetLeftMargin(0.15);}
\DoxyCodeLine{01928\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ TrianglePad[counterPad]-\/>SetLeftMargin(0);}
\DoxyCodeLine{01929\ }
\DoxyCodeLine{01930\ \ \ \ \ \ \ TrianglePad[counterPad]-\/>Draw();}
\DoxyCodeLine{01931\ \ \ \ \ \ \ TrianglePad[counterPad]-\/>cd();}
\DoxyCodeLine{01932\ }
\DoxyCodeLine{01933\ \ \ \ \ \ \ \textcolor{comment}{//KS:if\ diagonal\ plot\ main\ posterior}}
\DoxyCodeLine{01934\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(x\ ==\ y)}
\DoxyCodeLine{01935\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01936\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]\ =\ \textcolor{keyword}{static\_cast<}TH1D*\textcolor{keyword}{>}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNumber[x]]-\/>Clone(Form(\textcolor{stringliteral}{"{}hpost\_copy\_\%i"{}},\ ParamNumber[x])));}
\DoxyCodeLine{01937\ \ \ \ \ \ \ \ \ hpost\_cl[counterPost]\ =\ \textcolor{keyword}{new}\ TH1D*[nCredibleIntervals];}
\DoxyCodeLine{01939\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]-\/>Scale(1.\ /\ hpost\_copy[counterPost]-\/>Integral());}
\DoxyCodeLine{01940\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nCredibleIntervals;\ ++j)}
\DoxyCodeLine{01941\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01942\ \ \ \ \ \ \ \ \ \ \ hpost\_cl[counterPost][j]\ =\ \textcolor{keyword}{static\_cast<}TH1D*\textcolor{keyword}{>}(\mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNumber[x]]-\/>Clone(Form(\textcolor{stringliteral}{"{}hpost\_copy\_\%i\_CL\_\%f"{}},\ ParamNumber[x],\ CredibleIntervals[j])));}
\DoxyCodeLine{01943\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Reset\ to\ get\ rid\ to\ TF1\ otherwise\ we\ run\ into\ segfault\ :(}}
\DoxyCodeLine{01944\ \ \ \ \ \ \ \ \ \ \ hpost\_cl[counterPost][j]-\/>Reset(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{01945\ \ \ \ \ \ \ \ \ \ \ hpost\_cl[counterPost][j]-\/>Fill(0.0,\ 0.0);}
\DoxyCodeLine{01946\ }
\DoxyCodeLine{01947\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Scale\ the\ histograms\ before\ gettindg\ credible\ intervals}}
\DoxyCodeLine{01948\ \ \ \ \ \ \ \ \ \ \ hpost\_cl[counterPost][j]-\/>Scale(1.\ /\ hpost\_cl[counterPost][j]-\/>Integral());}
\DoxyCodeLine{01949\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Slightly\ different\ approach\ depending\ if\ intervals\ are\ in\ percentage\ or\ sigmas}}
\DoxyCodeLine{01950\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(CredibleInSigmas)}
\DoxyCodeLine{01951\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01952\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Convert\ sigmas\ into\ percentage}}
\DoxyCodeLine{01953\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ CredReg\ =\ \mbox{\hyperlink{StatisticalUtils_8h_a04394b98587b44b98b003bd1226606ed}{GetSigmaValue}}(\textcolor{keywordtype}{int}(std::round(CredibleIntervals[j])));}
\DoxyCodeLine{01954\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{StatisticalUtils_8h_aac24043cc7a5ef6a05fc1b10d3860875}{GetCredibleInterval}}(hpost\_copy[counterPost],\ hpost\_cl[counterPost][j],\ CredReg);}
\DoxyCodeLine{01955\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01956\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01957\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01958\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{StatisticalUtils_8h_aac24043cc7a5ef6a05fc1b10d3860875}{GetCredibleInterval}}(hpost\_copy[counterPost],\ hpost\_cl[counterPost][j],\ CredibleIntervals[j]);}
\DoxyCodeLine{01959\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01960\ }
\DoxyCodeLine{01961\ \ \ \ \ \ \ \ \ \ \ hpost\_cl[counterPost][j]-\/>SetFillColor(CredibleIntervalsColours[j]);}
\DoxyCodeLine{01962\ \ \ \ \ \ \ \ \ \ \ hpost\_cl[counterPost][j]-\/>SetLineWidth(1);}
\DoxyCodeLine{01963\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01964\ }
\DoxyCodeLine{01965\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]-\/>SetMaximum(hpost\_copy[counterPost]-\/>GetMaximum()*1.2);}
\DoxyCodeLine{01966\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]-\/>SetLineWidth(2);}
\DoxyCodeLine{01967\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]-\/>SetLineColor(kBlack);}
\DoxyCodeLine{01968\ }
\DoxyCodeLine{01969\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Don't\ want\ any\ titles}}
\DoxyCodeLine{01970\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{01971\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{01972\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]-\/>SetTitle(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{01973\ }
\DoxyCodeLine{01974\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]-\/>GetXaxis()-\/>SetLabelSize(0.1);}
\DoxyCodeLine{01975\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]-\/>GetYaxis()-\/>SetLabelSize(0.1);}
\DoxyCodeLine{01976\ }
\DoxyCodeLine{01977\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]-\/>GetXaxis()-\/>SetNdivisions(4);}
\DoxyCodeLine{01978\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]-\/>GetYaxis()-\/>SetNdivisions(4);}
\DoxyCodeLine{01979\ }
\DoxyCodeLine{01980\ \ \ \ \ \ \ \ \ hpost\_copy[counterPost]-\/>Draw(\textcolor{stringliteral}{"{}HIST"{}});}
\DoxyCodeLine{01981\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nCredibleIntervals;\ ++j)}
\DoxyCodeLine{01982\ \ \ \ \ \ \ \ \ \ \ hpost\_cl[counterPost][j]-\/>Draw(\textcolor{stringliteral}{"{}HIST\ SAME"{}});}
\DoxyCodeLine{01983\ \ \ \ \ \ \ \ \ counterPost++;}
\DoxyCodeLine{01984\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01985\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Here\ we\ plot\ 2D\ credible\ regions}}
\DoxyCodeLine{01986\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01987\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01988\ \ \ \ \ \ \ \ \ hpost\_2D\_copy[counter2DPost]\ =\ \textcolor{keyword}{static\_cast<}TH2D*\textcolor{keyword}{>}(\mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[ParamNumber[x]][ParamNumber[y]]-\/>Clone(}
\DoxyCodeLine{01989\ \ \ \ \ \ \ \ \ \ \ Form(\textcolor{stringliteral}{"{}hpost\_copy\_\%i\_\%i"{}},\ ParamNumber[x],\ ParamNumber[y])));}
\DoxyCodeLine{01990\ \ \ \ \ \ \ \ \ hpost\_2D\_cl[counter2DPost]\ =\ \textcolor{keyword}{new}\ TH2D*[nCredibleRegions];}
\DoxyCodeLine{01991\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Now\ copy\ for\ every\ credible\ region}}
\DoxyCodeLine{01992\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ nCredibleRegions;\ ++k)}
\DoxyCodeLine{01993\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01994\ \ \ \ \ \ \ \ \ \ \ hpost\_2D\_cl[counter2DPost][k]\ =\ \textcolor{keyword}{static\_cast<}TH2D*\textcolor{keyword}{>}(\mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[ParamNumber[x]][ParamNumber[y]]-\/>Clone(}
\DoxyCodeLine{01995\ \ \ \ \ \ \ \ \ \ \ \ \ Form(\textcolor{stringliteral}{"{}hpost\_copy\_\%i\_\%i\_CL\_\%f"{}},\ ParamNumber[x],\ ParamNumber[y],\ CredibleRegions[k])));}
\DoxyCodeLine{01996\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(CredibleInSigmas)}
\DoxyCodeLine{01997\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01998\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Convert\ sigmas\ into\ percentage}}
\DoxyCodeLine{01999\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ CredReg\ =\ \mbox{\hyperlink{StatisticalUtils_8h_a04394b98587b44b98b003bd1226606ed}{GetSigmaValue}}(\textcolor{keywordtype}{int}(std::round(CredibleRegions[k])));}
\DoxyCodeLine{02000\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{StatisticalUtils_8h_add6570517afa2cca738b9aca56aa3883}{GetCredibleRegion}}(hpost\_2D\_cl[counter2DPost][k],\ CredReg);}
\DoxyCodeLine{02001\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02002\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02003\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02004\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{StatisticalUtils_8h_add6570517afa2cca738b9aca56aa3883}{GetCredibleRegion}}(hpost\_2D\_cl[counter2DPost][k],\ CredibleRegions[k]);}
\DoxyCodeLine{02005\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02006\ }
\DoxyCodeLine{02007\ \ \ \ \ \ \ \ \ \ \ hpost\_2D\_cl[counter2DPost][k]-\/>SetLineColor(CredibleRegionColor[k]);}
\DoxyCodeLine{02008\ \ \ \ \ \ \ \ \ \ \ hpost\_2D\_cl[counter2DPost][k]-\/>SetLineWidth(2);}
\DoxyCodeLine{02009\ \ \ \ \ \ \ \ \ \ \ hpost\_2D\_cl[counter2DPost][k]-\/>SetLineStyle(CredibleRegionStyle[k]);}
\DoxyCodeLine{02010\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02011\ }
\DoxyCodeLine{02012\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Don't\ want\ any\ titles}}
\DoxyCodeLine{02013\ \ \ \ \ \ \ \ \ hpost\_2D\_copy[counter2DPost]-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{02014\ \ \ \ \ \ \ \ \ hpost\_2D\_copy[counter2DPost]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{02015\ \ \ \ \ \ \ \ \ hpost\_2D\_copy[counter2DPost]-\/>SetTitle(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{02016\ }
\DoxyCodeLine{02017\ \ \ \ \ \ \ \ \ hpost\_2D\_copy[counter2DPost]-\/>GetXaxis()-\/>SetLabelSize(0.1);}
\DoxyCodeLine{02018\ \ \ \ \ \ \ \ \ hpost\_2D\_copy[counter2DPost]-\/>GetYaxis()-\/>SetLabelSize(0.1);}
\DoxyCodeLine{02019\ }
\DoxyCodeLine{02020\ \ \ \ \ \ \ \ \ hpost\_2D\_copy[counter2DPost]-\/>\ GetXaxis()-\/>SetNdivisions(4);}
\DoxyCodeLine{02021\ \ \ \ \ \ \ \ \ hpost\_2D\_copy[counter2DPost]-\/>\ GetYaxis()-\/>SetNdivisions(4);}
\DoxyCodeLine{02022\ \ \ \ \ \ \ \ \ hpost\_2D\_copy[counter2DPost]-\/>Draw(\textcolor{stringliteral}{"{}COL"{}});}
\DoxyCodeLine{02023\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Now\ credible\ regions}}
\DoxyCodeLine{02024\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ nCredibleRegions;\ ++k)}
\DoxyCodeLine{02025\ \ \ \ \ \ \ \ \ \ \ hpost\_2D\_cl[counter2DPost][k]-\/>Draw(\textcolor{stringliteral}{"{}CONT3\ SAME"{}});}
\DoxyCodeLine{02026\ \ \ \ \ \ \ \ \ counter2DPost++;}
\DoxyCodeLine{02027\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02028\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Corresponds\ to\ bottom\ part\ of\ the\ plot}}
\DoxyCodeLine{02029\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(y\ ==\ (nParamPlot-\/1))}
\DoxyCodeLine{02030\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02031\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>cd();}
\DoxyCodeLine{02032\ \ \ \ \ \ \ \ \ TriangleText[counterText]\ =\ \textcolor{keyword}{new}\ TText(X\_Min[x]+\ (X\_Max[x]-\/X\_Min[x])/4,\ 0.04,\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNumber[x]]-\/>GetTitle());}
\DoxyCodeLine{02033\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Unfortunately\ for\ many\ plots\ or\ long\ names\ this\ can\ go\ out\ of\ bounds\ :(}}
\DoxyCodeLine{02034\ \ \ \ \ \ \ \ \ TriangleText[counterText]-\/>SetTextSize(0.015);}
\DoxyCodeLine{02035\ \ \ \ \ \ \ \ \ TriangleText[counterText]-\/>SetNDC(\textcolor{keyword}{true});}
\DoxyCodeLine{02036\ \ \ \ \ \ \ \ \ TriangleText[counterText]-\/>Draw();}
\DoxyCodeLine{02037\ }
\DoxyCodeLine{02038\ \ \ \ \ \ \ \ \ counterText++;}
\DoxyCodeLine{02039\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02040\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Corresponds\ to\ left\ part}}
\DoxyCodeLine{02041\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(x\ ==\ 0)}
\DoxyCodeLine{02042\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02043\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>cd();}
\DoxyCodeLine{02044\ \ \ \ \ \ \ \ \ TriangleText[counterText]\ =\ \textcolor{keyword}{new}\ TText(0.04,\ Y\_Min[y]\ +\ (Y\_Max[y]-\/Y\_Min[y])/4,\ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}[ParamNumber[y]]-\/>GetTitle());}
\DoxyCodeLine{02045\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Rotate\ as\ this\ is\ y\ axis}}
\DoxyCodeLine{02046\ \ \ \ \ \ \ \ \ TriangleText[counterText]-\/>SetTextAngle(90);}
\DoxyCodeLine{02047\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Unfortunately\ for\ many\ plots\ or\ long\ names\ this\ can\ go\ out\ of\ bounds\ :(}}
\DoxyCodeLine{02048\ \ \ \ \ \ \ \ \ TriangleText[counterText]-\/>SetTextSize(0.015);}
\DoxyCodeLine{02049\ \ \ \ \ \ \ \ \ TriangleText[counterText]-\/>SetNDC(\textcolor{keyword}{true});}
\DoxyCodeLine{02050\ \ \ \ \ \ \ \ \ TriangleText[counterText]-\/>Draw();}
\DoxyCodeLine{02051\ \ \ \ \ \ \ \ \ counterText++;}
\DoxyCodeLine{02052\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02053\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Update();}
\DoxyCodeLine{02054\ \ \ \ \ \ \ counterPad++;}
\DoxyCodeLine{02055\ \ \ \ \ \}}
\DoxyCodeLine{02056\ \ \ \}}
\DoxyCodeLine{02057\ }
\DoxyCodeLine{02058\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>cd();}
\DoxyCodeLine{02059\ \ \ \textcolor{keyword}{auto}\ legend\ =\ std::make\_unique<TLegend>(0.60,\ 0.7,\ 0.9,\ 0.9);}
\DoxyCodeLine{02060\ \ \ legend-\/>SetTextSize(0.03);}
\DoxyCodeLine{02061\ \ \ legend-\/>SetFillColor(0);}
\DoxyCodeLine{02062\ \ \ legend-\/>SetFillStyle(0);}
\DoxyCodeLine{02063\ \ \ legend-\/>SetLineColor(0);}
\DoxyCodeLine{02064\ \ \ legend-\/>SetLineStyle(0);}
\DoxyCodeLine{02065\ \ \ legend-\/>SetBorderSize(0);}
\DoxyCodeLine{02066\ \ \ \textcolor{comment}{//KS:\ Legend\ is\ shared\ so\ just\ take\ first\ histograms}}
\DoxyCodeLine{02067\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ nCredibleIntervals-\/1;\ j\ >=\ 0;\ -\/-\/j)}
\DoxyCodeLine{02068\ \ \ \{}
\DoxyCodeLine{02069\ \ \ \ \ \textcolor{keywordflow}{if}(CredibleInSigmas)}
\DoxyCodeLine{02070\ \ \ \ \ \ \ legend-\/>AddEntry(hpost\_cl[0][j],\ Form(\textcolor{stringliteral}{"{}\%.0f\#sigma\ Credible\ Interval"{}},\ CredibleIntervals[j]),\ \textcolor{stringliteral}{"{}f"{}});}
\DoxyCodeLine{02071\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02072\ \ \ \ \ \ \ legend-\/>AddEntry(hpost\_cl[0][j],\ Form(\textcolor{stringliteral}{"{}\%.0f\%\%\ Credible\ Interval"{}},\ CredibleRegions[j]*100),\ \textcolor{stringliteral}{"{}f"{}});}
\DoxyCodeLine{02073\ \ \ \}}
\DoxyCodeLine{02074\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ nCredibleRegions-\/1;\ k\ >=\ 0;\ -\/-\/k)}
\DoxyCodeLine{02075\ \ \ \{}
\DoxyCodeLine{02076\ \ \ \ \ \textcolor{keywordflow}{if}(CredibleInSigmas)}
\DoxyCodeLine{02077\ \ \ \ \ \ \ legend-\/>AddEntry(hpost\_2D\_cl[0][k],\ Form(\textcolor{stringliteral}{"{}\%.0f\#sigma\ Credible\ Region"{}},\ CredibleRegions[k]),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{02078\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02079\ \ \ \ \ \ \ legend-\/>AddEntry(hpost\_2D\_cl[0][k],\ Form(\textcolor{stringliteral}{"{}\%.0f\%\%\ Credible\ Region"{}},\ CredibleRegions[k]*100),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{02080\ \ \ \}}
\DoxyCodeLine{02081\ \ \ legend-\/>Draw(\textcolor{stringliteral}{"{}SAME"{}});}
\DoxyCodeLine{02082\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Update();}
\DoxyCodeLine{02083\ }
\DoxyCodeLine{02084\ \ \ \textcolor{comment}{//\ Write\ to\ file}}
\DoxyCodeLine{02085\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetName(\textcolor{stringliteral}{"{}TrianglePlot"{}});}
\DoxyCodeLine{02086\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTitle(\textcolor{stringliteral}{"{}TrianglePlot"{}});}
\DoxyCodeLine{02087\ }
\DoxyCodeLine{02088\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{02089\ \ \ \textcolor{comment}{//\ Write\ it\ to\ root\ file}}
\DoxyCodeLine{02090\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{02091\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Write();}
\DoxyCodeLine{02092\ }
\DoxyCodeLine{02093\ \ \ \textcolor{comment}{//KS:\ Remove\ allocated\ structures}}
\DoxyCodeLine{02094\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ Npad;\ i++)\ \textcolor{keyword}{delete}\ TrianglePad[i];}
\DoxyCodeLine{02095\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ nParamPlot*2;\ i++)\ \textcolor{keyword}{delete}\ TriangleText[i];}
\DoxyCodeLine{02096\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ nParamPlot;\ i++)}
\DoxyCodeLine{02097\ \ \ \{}
\DoxyCodeLine{02098\ \ \ \ \ \textcolor{keyword}{delete}\ hpost\_copy[i];}
\DoxyCodeLine{02099\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nCredibleIntervals;\ ++j)}
\DoxyCodeLine{02100\ \ \ \ \ \{}
\DoxyCodeLine{02101\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ hpost\_cl[i][j];}
\DoxyCodeLine{02102\ \ \ \ \ \}}
\DoxyCodeLine{02103\ \ \ \ \ \textcolor{keyword}{delete}[]\ hpost\_cl[i];}
\DoxyCodeLine{02104\ \ \ \}}
\DoxyCodeLine{02105\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ Npad\ -\/\ nParamPlot;\ i++)}
\DoxyCodeLine{02106\ \ \ \{}
\DoxyCodeLine{02107\ \ \ \ \ \textcolor{keyword}{delete}\ hpost\_2D\_copy[i];}
\DoxyCodeLine{02108\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nCredibleRegions;\ ++j)}
\DoxyCodeLine{02109\ \ \ \ \ \{}
\DoxyCodeLine{02110\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ hpost\_2D\_cl[i][j];}
\DoxyCodeLine{02111\ \ \ \ \ \}}
\DoxyCodeLine{02112\ \ \ \ \ \textcolor{keyword}{delete}[]\ hpost\_2D\_cl[i];}
\DoxyCodeLine{02113\ \ \ \}}
\DoxyCodeLine{02114\ \ \ \textcolor{keyword}{delete}[]\ hpost\_copy;}
\DoxyCodeLine{02115\ \ \ \textcolor{keyword}{delete}[]\ hpost\_cl;}
\DoxyCodeLine{02116\ \ \ \textcolor{keyword}{delete}[]\ hpost\_2D\_copy;}
\DoxyCodeLine{02117\ \ \ \textcolor{keyword}{delete}[]\ hpost\_2D\_cl;}
\DoxyCodeLine{02118\ \ \ \textcolor{keyword}{delete}[]\ TrianglePad;}
\DoxyCodeLine{02119\ \ \ \textcolor{keyword}{delete}[]\ TriangleText;}
\DoxyCodeLine{02120\ }
\DoxyCodeLine{02121\ \ \ \textcolor{comment}{//KS:\ Restore\ margin}}
\DoxyCodeLine{02122\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTopMargin(TopMargin);}
\DoxyCodeLine{02123\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetLeftMargin(BottomMargin);}
\DoxyCodeLine{02124\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetLeftMargin(LeftMargin);}
\DoxyCodeLine{02125\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetRightMargin(RighMargin);}
\DoxyCodeLine{02126\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a04976c69f0ef0b3f39edcf5f25f90981}\label{classMCMCProcessor_a04976c69f0ef0b3f39edcf5f25f90981}} 
\index{MCMCProcessor@{MCMCProcessor}!MakeViolin@{MakeViolin}}
\index{MakeViolin@{MakeViolin}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{MakeViolin()}{MakeViolin()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Make\+Violin (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Make and Draw Violin. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l00850}{850}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00850\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00851\ \textcolor{comment}{//\ *********************}}
\DoxyCodeLine{00852\ \ \ \textcolor{comment}{//KS:\ Make\ sure\ we\ have\ steps}}
\DoxyCodeLine{00853\ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{classMCMCProcessor_aea84f0315695aa05ec41fcf965b1b031}{CacheMCMC}})\ \mbox{\hyperlink{classMCMCProcessor_ace48a54fb08e2a3943d4e2ed1f8c4a4b}{CacheSteps}}();}
\DoxyCodeLine{00854\ }
\DoxyCodeLine{00855\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Producing\ Violin\ Plot"{}});}
\DoxyCodeLine{00856\ }
\DoxyCodeLine{00857\ \ \ \textcolor{comment}{//KS:\ Find\ min\ and\ max\ to\ make\ histogram\ in\ range}}
\DoxyCodeLine{00858\ \ \ \textcolor{keywordtype}{double}\ maxi\_y\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMaximum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[0]);}
\DoxyCodeLine{00859\ \ \ \textcolor{keywordtype}{double}\ mini\_y\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMinimum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[0]);}
\DoxyCodeLine{00860\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{00861\ \ \ \{}
\DoxyCodeLine{00862\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMaximum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i])\ >\ maxi\_y)\ maxi\_y\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMaximum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i]);}
\DoxyCodeLine{00863\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMinimum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i])\ <\ mini\_y)\ mini\_y\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMinimum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i]);}
\DoxyCodeLine{00864\ \ \ \}}
\DoxyCodeLine{00865\ }
\DoxyCodeLine{00866\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ vBins\ =\ (maxi\_y-\/mini\_y)*25;}
\DoxyCodeLine{00867\ }
\DoxyCodeLine{00868\ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}\ =\ \textcolor{keyword}{new}\ TH2D(\textcolor{stringliteral}{"{}hviolin"{}},\ \textcolor{stringliteral}{"{}hviolin"{}},\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ vBins,\ mini\_y,\ maxi\_y);}
\DoxyCodeLine{00869\ }
\DoxyCodeLine{00870\ \ \ \textcolor{comment}{//KS:\ Prior\ has\ larger\ errors\ so\ we\ increase\ range\ and\ number\ of\ bins}}
\DoxyCodeLine{00871\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ PriorFactor\ =\ 4;}
\DoxyCodeLine{00872\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}\ =\ \textcolor{keyword}{new}\ TH2D(\textcolor{stringliteral}{"{}hviolin\_prior"{}},\ \textcolor{stringliteral}{"{}hviolin\_prior"{}},\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}},\ PriorFactor*vBins,\ PriorFactor*mini\_y,\ PriorFactor*maxi\_y);}
\DoxyCodeLine{00873\ }
\DoxyCodeLine{00874\ \ \ \textcolor{keyword}{auto}\ rand\ =\ std::make\_unique<TRandom3>(0);}
\DoxyCodeLine{00875\ \ \ std::vector<double>\ PriorVec(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{00876\ \ \ std::vector<double>\ PriorErrorVec(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{00877\ \ \ std::vector<bool>\ PriorFlatVec(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{00878\ }
\DoxyCodeLine{00879\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++x)}
\DoxyCodeLine{00880\ \ \ \{}
\DoxyCodeLine{00881\ \ \ \ \ TString\ Title;}
\DoxyCodeLine{00882\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior,\ PriorError;}
\DoxyCodeLine{00883\ }
\DoxyCodeLine{00884\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(x,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{00885\ \ \ \ \ \textcolor{comment}{//Set\ fancy\ labels}}
\DoxyCodeLine{00886\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>GetXaxis()-\/>SetBinLabel(x+1,\ Title);}
\DoxyCodeLine{00887\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>GetXaxis()-\/>SetBinLabel(x+1,\ Title);}
\DoxyCodeLine{00888\ \ \ \ \ PriorVec[x]\ =\ Prior;}
\DoxyCodeLine{00889\ \ \ \ \ PriorErrorVec[x]\ =\ PriorError;}
\DoxyCodeLine{00890\ }
\DoxyCodeLine{00891\ \ \ \ \ \mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20b}{ParameterEnum}}\ ParType\ =\ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}[x];}
\DoxyCodeLine{00892\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamTemp\ =\ x\ -\/\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[ParType];}
\DoxyCodeLine{00893\ \ \ \ \ PriorFlatVec[x]\ =\ \mbox{\hyperlink{classMCMCProcessor_a4be1eedb743e4ea410009a4fa45720f7}{ParamFlat}}[ParType][ParamTemp];}
\DoxyCodeLine{00894\ \ \ \}}
\DoxyCodeLine{00895\ }
\DoxyCodeLine{00896\ \ \ TStopwatch\ clock;}
\DoxyCodeLine{00897\ \ \ clock.Start();}
\DoxyCodeLine{00898\ }
\DoxyCodeLine{00899\ \ \ \textcolor{comment}{//\ nDraw\ is\ number\ of\ draws\ we\ want\ to\ do}}
\DoxyCodeLine{00900\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{00901\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{00902\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{00903\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++x)}
\DoxyCodeLine{00904\ \ \ \{}
\DoxyCodeLine{00905\ \ \ \ \ \textcolor{comment}{//KS:\ Consider\ another\ treatment\ for\ fixed\ params}}
\DoxyCodeLine{00906\ \ \ \ \ \textcolor{comment}{//if\ (IamVaried[x]\ ==\ false)\ continue;}}
\DoxyCodeLine{00907\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++k)}
\DoxyCodeLine{00908\ \ \ \ \ \{}
\DoxyCodeLine{00909\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Burn\ in\ cut}}
\DoxyCodeLine{00910\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}[k]\ <\ \mbox{\hyperlink{classMCMCProcessor_a22f82dadceccbe87dd8c5b7daa8432e8}{BurnInCut}})\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00911\ }
\DoxyCodeLine{00912\ \ \ \ \ \ \ \textcolor{comment}{//Only\ used\ for\ Suboptimatlity}}
\DoxyCodeLine{00913\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}[k]\ >\ \mbox{\hyperlink{classMCMCProcessor_a840c686f15f419c0156df01c4ed62931}{UpperCut}})\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00914\ }
\DoxyCodeLine{00915\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ We\ know\ exactly\ which\ x\ bin\ we\ will\ end\ up,\ find\ y\ bin.\ This\ allow\ to\ avoid\ coslty\ Fill()\ and\ enable\ multithreading\ becasue\ I\ am\ master\ of\ faster}}
\DoxyCodeLine{00916\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ y\ =\ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>GetYaxis()-\/>FindBin(\mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[x][k]);}
\DoxyCodeLine{00917\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>SetBinContent(x+1,\ y,\ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>GetBinContent(x+1,\ y)+1);}
\DoxyCodeLine{00918\ \ \ \ \ \}}
\DoxyCodeLine{00919\ }
\DoxyCodeLine{00920\ \ \ \ \ \textcolor{comment}{//KS:\ If\ we\ set\ option\ to\ not\ plot\ flat\ prior\ and\ param\ has\ flat\ prior\ then\ we\ skip\ this\ step}}
\DoxyCodeLine{00921\ \ \ \ \ \textcolor{keywordflow}{if}(!(!\mbox{\hyperlink{classMCMCProcessor_ad24411a2556504c440ff0af045e8e7aa}{PlotFlatPrior}}\ \&\&\ PriorFlatVec[x]))}
\DoxyCodeLine{00922\ \ \ \ \ \{}
\DoxyCodeLine{00923\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++k)}
\DoxyCodeLine{00924\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00925\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Entry\ =\ rand-\/>Gaus(PriorVec[x],\ PriorErrorVec[x]);}
\DoxyCodeLine{00926\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ y\ =\ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>GetYaxis()-\/>FindBin(Entry);}
\DoxyCodeLine{00927\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>SetBinContent(x+1,\ y,\ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>GetBinContent(x+1,\ y)+1);}
\DoxyCodeLine{00928\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00929\ \ \ \ \ \}}
\DoxyCodeLine{00930\ \ \ \}\ \textcolor{comment}{//\ end\ the\ for\ loop\ over\ nDraw}}
\DoxyCodeLine{00931\ \ \ clock.Stop();}
\DoxyCodeLine{00932\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ Violin\ plot\ took\ \{:.2f\}s\ to\ finish\ for\ \{\}\ steps"{}},\ clock.RealTime(),\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{00933\ }
\DoxyCodeLine{00934\ \ \ \textcolor{comment}{//KS:\ Tells\ how\ many\ parameters\ in\ one\ canvas\ we\ want}}
\DoxyCodeLine{00935\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ IntervalsSize\ =\ 10;}
\DoxyCodeLine{00936\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ NIntervals\ =\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}/IntervalsSize;}
\DoxyCodeLine{00937\ }
\DoxyCodeLine{00938\ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Parameter\ Value"{}});}
\DoxyCodeLine{00939\ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>GetXaxis()-\/>SetTitle();}
\DoxyCodeLine{00940\ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>GetXaxis()-\/>LabelsOption(\textcolor{stringliteral}{"{}v"{}});}
\DoxyCodeLine{00941\ \ \ }
\DoxyCodeLine{00942\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Parameter\ Value"{}});}
\DoxyCodeLine{00943\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>GetXaxis()-\/>SetTitle();}
\DoxyCodeLine{00944\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>GetXaxis()-\/>LabelsOption(\textcolor{stringliteral}{"{}v"{}});}
\DoxyCodeLine{00945\ }
\DoxyCodeLine{00946\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>SetLineColor(kRed);}
\DoxyCodeLine{00947\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>SetMarkerColor(kRed);}
\DoxyCodeLine{00948\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>SetFillColorAlpha(kRed,\ 0.35);}
\DoxyCodeLine{00949\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>SetMarkerStyle(20);}
\DoxyCodeLine{00950\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>SetMarkerSize(0.5);}
\DoxyCodeLine{00951\ }
\DoxyCodeLine{00952\ \ \ \textcolor{comment}{//\ These\ control\ violin\ width,\ if\ you\ use\ larger\ then\ 1\ they\ will\ most\ likely\ overlay,\ so\ be\ cautious}}
\DoxyCodeLine{00953\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>SetBarWidth(1.0);}
\DoxyCodeLine{00954\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>SetBarOffset(0);}
\DoxyCodeLine{00955\ }
\DoxyCodeLine{00956\ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>SetLineColor(kBlue);}
\DoxyCodeLine{00957\ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>SetMarkerColor(kBlue);}
\DoxyCodeLine{00958\ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>SetFillColorAlpha(kBlue,\ 0.35);}
\DoxyCodeLine{00959\ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>SetMarkerStyle(20);}
\DoxyCodeLine{00960\ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>SetMarkerSize(1.0);}
\DoxyCodeLine{00961\ \ \ }
\DoxyCodeLine{00962\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ BottomMargin\ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetBottomMargin();}
\DoxyCodeLine{00963\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetBottomMargin(0.2);}
\DoxyCodeLine{00964\ \ \ \ \ }
\DoxyCodeLine{00965\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{00966\ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>Write(\textcolor{stringliteral}{"{}param\_violin"{}});}
\DoxyCodeLine{00967\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>Write(\textcolor{stringliteral}{"{}param\_violin\_prior"{}});}
\DoxyCodeLine{00968\ \ \ \textcolor{comment}{//KS:\ This\ is\ mostly\ for\ example\ plots,\ we\ have\ full\ file\ in\ the\ ROOT\ file\ so\ can\ do\ much\ better\ plot\ later}}
\DoxyCodeLine{00969\ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>GetYaxis()-\/>SetRangeUser(-\/1,\ +2);}
\DoxyCodeLine{00970\ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>GetYaxis()-\/>SetRangeUser(-\/1,\ +2);}
\DoxyCodeLine{00971\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ NIntervals+1;\ ++i)}
\DoxyCodeLine{00972\ \ \ \{}
\DoxyCodeLine{00973\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>GetXaxis()-\/>SetRangeUser(i*IntervalsSize,\ i*IntervalsSize+IntervalsSize);}
\DoxyCodeLine{00974\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>GetXaxis()-\/>SetRangeUser(i*IntervalsSize,\ i*IntervalsSize+IntervalsSize);}
\DoxyCodeLine{00975\ \ \ \ \ \textcolor{keywordflow}{if}(i\ ==\ NIntervals+1)}
\DoxyCodeLine{00976\ \ \ \ \ \{}
\DoxyCodeLine{00977\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>GetXaxis()-\/>SetRangeUser(i*IntervalsSize,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});\ }
\DoxyCodeLine{00978\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>GetXaxis()-\/>SetRangeUser(i*IntervalsSize,\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{00979\ \ \ \ \ \}}
\DoxyCodeLine{00980\ \ \ \ \ \textcolor{comment}{//KS:\ ROOT6\ has\ some\ additional\ options,\ consider\ updating\ it.\ more\ https://root.cern/doc/master/classTHistPainter.html\#HP140b}}
\DoxyCodeLine{00981\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}{hviolin\_prior}}-\/>Draw(\textcolor{stringliteral}{"{}violinX(03100300)"{}});}
\DoxyCodeLine{00982\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}{hviolin}}-\/>Draw(\textcolor{stringliteral}{"{}violinX(03100300)\ SAME"{}});}
\DoxyCodeLine{00983\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{00984\ \ \ \}}
\DoxyCodeLine{00985\ \ \ \textcolor{comment}{//KS:\ Return\ Margin\ to\ default\ one}}
\DoxyCodeLine{00986\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetBottomMargin(BottomMargin);}
\DoxyCodeLine{00987\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_ac9a5fc93b5ac3f6ef7850d21f47fd5dd}\label{classMCMCProcessor_ac9a5fc93b5ac3f6ef7850d21f47fd5dd}} 
\index{MCMCProcessor@{MCMCProcessor}!ParameterEvolution@{ParameterEvolution}}
\index{ParameterEvolution@{ParameterEvolution}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{ParameterEvolution()}{ParameterEvolution()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Parameter\+Evolution (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ std\+::string $>$ \&}]{Names,  }\item[{const std\+::vector$<$ int $>$ \&}]{NIntervals }\end{DoxyParamCaption})}



Make .gif of parameter evolution. 


\begin{DoxyParams}{Parameters}
{\em Par\+Name} & Parameter names for which we do .gif \\
\hline
{\em NIntervals} & Number of intervals for a gif \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l03143}{3143}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{03144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03145\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{03146\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Parameter\ Evolution\ gif"{}});}
\DoxyCodeLine{03147\ }
\DoxyCodeLine{03148\ \ \ \textcolor{comment}{//KS:\ First\ we\ need\ to\ find\ parameter\ number\ based\ on\ name}}
\DoxyCodeLine{03149\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ Names.size();\ ++k)}
\DoxyCodeLine{03150\ \ \ \{}
\DoxyCodeLine{03151\ \ \ \ \ \textcolor{comment}{//KS:\ First\ we\ need\ to\ find\ parameter\ number\ based\ on\ name}}
\DoxyCodeLine{03152\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamNo\ =\ \mbox{\hyperlink{classMCMCProcessor_a5ab91183fbbf23fff759fefc9954a1a5}{GetParamIndexFromName}}(Names[k]);}
\DoxyCodeLine{03153\ \ \ \ \ \textcolor{keywordflow}{if}(ParamNo\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}})}
\DoxyCodeLine{03154\ \ \ \ \ \{}
\DoxyCodeLine{03155\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Couldn't\ find\ param\ \{\}.\ Can't\ reweight\ Prior"{}},\ Names[k]);}
\DoxyCodeLine{03156\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{03157\ \ \ \ \ \}}
\DoxyCodeLine{03158\ }
\DoxyCodeLine{03159\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ IntervalsSize\ =\ \mbox{\hyperlink{classMCMCProcessor_aae0016a4e1d105d5d65243438c622a97}{nSteps}}/NIntervals[k];}
\DoxyCodeLine{03160\ \ \ \ \ \textcolor{comment}{//\ ROOT\ won't\ overwrite\ gifs\ so\ we\ need\ to\ delete\ the\ file\ if\ it's\ there\ already}}
\DoxyCodeLine{03161\ \ \ \ \ system(fmt::format(\textcolor{stringliteral}{"{}rm\ \{\}.gif"{}},Names[k]).c\_str());}
\DoxyCodeLine{03162\ }
\DoxyCodeLine{03163\ \ \ \ \ \textcolor{comment}{//\ This\ holds\ the\ posterior\ density}}
\DoxyCodeLine{03164\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ maxi\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMaximum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[ParamNo]);}
\DoxyCodeLine{03165\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ mini\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMinimum(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[ParamNo]);}
\DoxyCodeLine{03166\ }
\DoxyCodeLine{03167\ \ \ \ \ \textcolor{keywordtype}{int}\ Counter\ =\ 0;}
\DoxyCodeLine{03168\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ NIntervals[k]-\/1;\ i\ >=\ 0;\ -\/-\/i)}
\DoxyCodeLine{03169\ \ \ \ \ \{}
\DoxyCodeLine{03170\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ holds\ the\ posterior\ density}}
\DoxyCodeLine{03171\ \ \ \ \ \ \ TH1D*\ EvePlot\ =\ \textcolor{keyword}{new}\ TH1D(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[ParamNo],\ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[ParamNo],\ \mbox{\hyperlink{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}{nBins}},\ mini,\ maxi);}
\DoxyCodeLine{03172\ \ \ \ \ \ \ EvePlot-\/>SetMinimum(0);}
\DoxyCodeLine{03173\ \ \ \ \ \ \ EvePlot-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}PDF"{}});}
\DoxyCodeLine{03174\ \ \ \ \ \ \ EvePlot-\/>GetYaxis()-\/>SetNoExponent(\textcolor{keyword}{false});}
\DoxyCodeLine{03175\ }
\DoxyCodeLine{03176\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Apply\ additional\ Cuts,\ like\ mass\ ordering}}
\DoxyCodeLine{03177\ \ \ \ \ \ \ std::string\ CutPosterior1D\ =\ \textcolor{stringliteral}{"{}step\ >\ "{}}\ +\ std::to\_string(i*IntervalsSize+IntervalsSize);}
\DoxyCodeLine{03178\ }
\DoxyCodeLine{03179\ \ \ \ \ \ \ std::string\ TextTitle\ =\ \textcolor{stringliteral}{"{}Steps\ =\ 0\ -\/\ "{}}+std::to\_string(Counter*IntervalsSize+IntervalsSize);}
\DoxyCodeLine{03180\ \ \ \ \ \ \ \textcolor{comment}{//\ Project\ BranchNames[ParamNo]\ onto\ hpost,\ applying\ stepcut}}
\DoxyCodeLine{03181\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>Project(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[ParamNo],\ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[ParamNo],\ CutPosterior1D.c\_str());}
\DoxyCodeLine{03182\ }
\DoxyCodeLine{03183\ \ \ \ \ \ \ EvePlot-\/>SetLineWidth(2);}
\DoxyCodeLine{03184\ \ \ \ \ \ \ EvePlot-\/>SetLineColor(kBlue-\/1);}
\DoxyCodeLine{03185\ \ \ \ \ \ \ EvePlot-\/>SetTitle(Names[k].c\_str());}
\DoxyCodeLine{03186\ \ \ \ \ \ \ EvePlot-\/>GetXaxis()-\/>SetTitle(EvePlot-\/>GetTitle());}
\DoxyCodeLine{03187\ \ \ \ \ \ \ EvePlot-\/>GetYaxis()-\/>SetLabelOffset(1000);}
\DoxyCodeLine{03188\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a682c1c47626542f5820d633ba2bc010c}{ApplySmoothing}})\ EvePlot-\/>Smooth();}
\DoxyCodeLine{03189\ }
\DoxyCodeLine{03190\ \ \ \ \ \ \ EvePlot-\/>Scale(1.\ /\ EvePlot-\/>Integral());}
\DoxyCodeLine{03191\ }
\DoxyCodeLine{03192\ \ \ \ \ \ \ EvePlot-\/>Draw(\textcolor{stringliteral}{"{}HIST"{}});}
\DoxyCodeLine{03193\ }
\DoxyCodeLine{03194\ \ \ \ \ \ \ TText\ *text\ =\ \textcolor{keyword}{new}\ TText(0.3,\ 0.8,\ TextTitle.c\_str());}
\DoxyCodeLine{03195\ \ \ \ \ \ \ text-\/>SetTextFont\ (43);}
\DoxyCodeLine{03196\ \ \ \ \ \ \ text-\/>SetTextSize\ (40);}
\DoxyCodeLine{03197\ \ \ \ \ \ \ text-\/>SetNDC(\textcolor{keyword}{true});}
\DoxyCodeLine{03198\ \ \ \ \ \ \ text-\/>Draw(\textcolor{stringliteral}{"{}SAME"{}});}
\DoxyCodeLine{03199\ }
\DoxyCodeLine{03200\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(i\ ==\ 0)\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(((Names[k]\ +\ \textcolor{stringliteral}{"{}.gif++20"{}}).c\_str()));\ \textcolor{comment}{//\ produces\ infinite\ loop\ animated\ GIF}}
\DoxyCodeLine{03201\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(((Names[k]+\textcolor{stringliteral}{"{}.gif+20"{}}).c\_str()));\ \textcolor{comment}{//\ add\ picture\ to\ .gif}}
\DoxyCodeLine{03202\ }
\DoxyCodeLine{03203\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ EvePlot;}
\DoxyCodeLine{03204\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ text;}
\DoxyCodeLine{03205\ \ \ \ \ \ \ Counter++;}
\DoxyCodeLine{03206\ \ \ \ \ \}}
\DoxyCodeLine{03207\ \ \ \}}
\DoxyCodeLine{03208\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a929d6efec80bb4de05eea7011257439a}\label{classMCMCProcessor_a929d6efec80bb4de05eea7011257439a}} 
\index{MCMCProcessor@{MCMCProcessor}!ParamTraces@{ParamTraces}}
\index{ParamTraces@{ParamTraces}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{ParamTraces()}{ParamTraces()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Param\+Traces (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



CW\+: Draw trace plots of the parameters i.\+e. parameter vs step. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l03407}{3407}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{03407\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03408\ \textcolor{comment}{//\ *****************}}
\DoxyCodeLine{03409\ }
\DoxyCodeLine{03410\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_a930cadafa41b31b58066dea68628de9f}{PrepareDiagMCMC}}();}
\DoxyCodeLine{03411\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ trace\ plots..."{}});}
\DoxyCodeLine{03412\ \ \ \textcolor{comment}{//\ Make\ the\ TH1Ds}}
\DoxyCodeLine{03413\ \ \ TH1D**\ TraceParamPlots\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}];}
\DoxyCodeLine{03414\ \ \ TH1D**\ TraceSamplePlots\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classMCMCProcessor_a419d3669dbb54a55a635e35691134cc1}{nSamples}}];}
\DoxyCodeLine{03415\ \ \ TH1D**\ TraceSystsPlots\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classMCMCProcessor_adf518be96278f1d3901404cfbe767b67}{nSysts}}];}
\DoxyCodeLine{03416\ }
\DoxyCodeLine{03417\ \ \ \textcolor{comment}{//\ Set\ the\ titles\ and\ limits\ for\ TH2Ds}}
\DoxyCodeLine{03418\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{03419\ }
\DoxyCodeLine{03420\ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{03421\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{03422\ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{03423\ \ \ \ \ }
\DoxyCodeLine{03424\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(j,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{03425\ \ \ \ \ std::string\ HistName\ =\ Form(\textcolor{stringliteral}{"{}\%s\_\%s\_Trace"{}},\ Title.Data(),\ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[j].Data());}
\DoxyCodeLine{03426\ }
\DoxyCodeLine{03427\ \ \ \ \ TraceParamPlots[j]\ =\ \textcolor{keyword}{new}\ TH1D(HistName.c\_str(),\ HistName.c\_str(),\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{03428\ \ \ \ \ TraceParamPlots[j]-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Step"{}});}
\DoxyCodeLine{03429\ \ \ \ \ TraceParamPlots[j]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Parameter\ Variation"{}});}
\DoxyCodeLine{03430\ \ \ \}}
\DoxyCodeLine{03431\ }
\DoxyCodeLine{03432\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_a419d3669dbb54a55a635e35691134cc1}{nSamples}};\ ++j)\ \{}
\DoxyCodeLine{03433\ \ \ \ \ std::string\ HistName\ =\ \mbox{\hyperlink{classMCMCProcessor_a3660e404a6631cfa913a815481730a9b}{SampleName\_v}}[j].Data();}
\DoxyCodeLine{03434\ \ \ \ \ TraceSamplePlots[j]\ =\ \textcolor{keyword}{new}\ TH1D(HistName.c\_str(),\ HistName.c\_str(),\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{03435\ \ \ \ \ TraceSamplePlots[j]-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Step"{}});}
\DoxyCodeLine{03436\ \ \ \ \ TraceSamplePlots[j]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Sample\ -\/logL"{}});}
\DoxyCodeLine{03437\ \ \ \}}
\DoxyCodeLine{03438\ }
\DoxyCodeLine{03439\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_adf518be96278f1d3901404cfbe767b67}{nSysts}};\ ++j)\ \{}
\DoxyCodeLine{03440\ \ \ \ \ std::string\ HistName\ =\ \mbox{\hyperlink{classMCMCProcessor_acb1871575fdd3ae156aed4bf7c7a0a73}{SystName\_v}}[j].Data();}
\DoxyCodeLine{03441\ \ \ \ \ TraceSystsPlots[j]\ =\ \textcolor{keyword}{new}\ TH1D(HistName.c\_str(),\ HistName.c\_str(),\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}},\ 0,\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{03442\ \ \ \ \ TraceSystsPlots[j]-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Step"{}});}
\DoxyCodeLine{03443\ \ \ \ \ TraceSystsPlots[j]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Systematic\ -\/logL"{}});}
\DoxyCodeLine{03444\ \ \ \}}
\DoxyCodeLine{03445\ }
\DoxyCodeLine{03446\ \ \ \textcolor{comment}{//\ Have\ now\ made\ the\ empty\ TH1Ds,\ now\ for\ writing\ content\ to\ them!}}
\DoxyCodeLine{03447\ }
\DoxyCodeLine{03448\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ number\ of\ parameters\ to\ draw\ their\ traces}}
\DoxyCodeLine{03449\ \ \ \textcolor{comment}{//\ Each\ histogram}}
\DoxyCodeLine{03450\ \textcolor{preprocessor}{\#ifdef\ MULTITHREAD}}
\DoxyCodeLine{03451\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Using\ multi-\/threading..."{}});}
\DoxyCodeLine{03452\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{03453\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03454\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++i)\ \{}
\DoxyCodeLine{03455\ \ \ \ \ \textcolor{comment}{//\ Set\ bin\ content\ for\ the\ ith\ bin\ to\ the\ parameter\ values}}
\DoxyCodeLine{03456\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{03457\ \ \ \ \ \ \ TraceParamPlots[j]-\/>SetBinContent(i,\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i]);}
\DoxyCodeLine{03458\ \ \ \ \ \}}
\DoxyCodeLine{03459\ }
\DoxyCodeLine{03460\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_a419d3669dbb54a55a635e35691134cc1}{nSamples}};\ ++j)\ \{}
\DoxyCodeLine{03461\ \ \ \ \ \ \ TraceSamplePlots[j]-\/>SetBinContent(i,\ \mbox{\hyperlink{classMCMCProcessor_a28e89498420221149ec97c353c430bf8}{SampleValues}}[i][j]);}
\DoxyCodeLine{03462\ \ \ \ \ \}}
\DoxyCodeLine{03463\ }
\DoxyCodeLine{03464\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_adf518be96278f1d3901404cfbe767b67}{nSysts}};\ ++j)\ \{}
\DoxyCodeLine{03465\ \ \ \ \ \ \ TraceSystsPlots[j]-\/>SetBinContent(i,\ \mbox{\hyperlink{classMCMCProcessor_a4eb2748c81b0aef9bd7e14785559e301}{SystValues}}[i][j]);}
\DoxyCodeLine{03466\ \ \ \ \ \}}
\DoxyCodeLine{03467\ \ \ \}}
\DoxyCodeLine{03468\ }
\DoxyCodeLine{03469\ \ \ \textcolor{comment}{//\ Write\ the\ output\ and\ delete\ the\ TH2Ds}}
\DoxyCodeLine{03470\ \ \ TDirectory\ *TraceDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}Trace"{}});}
\DoxyCodeLine{03471\ \ \ TraceDir-\/>cd();}
\DoxyCodeLine{03472\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{03473\ \ \ \ \ \textcolor{comment}{//\ Fit\ a\ linear\ function\ to\ the\ traces}}
\DoxyCodeLine{03474\ \ \ \ \ TF1\ *Fitter\ =\ \textcolor{keyword}{new}\ TF1(\textcolor{stringliteral}{"{}Fitter"{}},\textcolor{stringliteral}{"{}[0]"{}},\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}/2,\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{03475\ \ \ \ \ Fitter-\/>SetLineColor(kRed);}
\DoxyCodeLine{03476\ \ \ \ \ TraceParamPlots[j]-\/>Fit(\textcolor{stringliteral}{"{}Fitter"{}},\textcolor{stringliteral}{"{}Rq"{}});}
\DoxyCodeLine{03477\ \ \ \ \ TraceParamPlots[j]-\/>Write();}
\DoxyCodeLine{03478\ \ \ \ \ \textcolor{keyword}{delete}\ Fitter;}
\DoxyCodeLine{03479\ \ \ \ \ \textcolor{keyword}{delete}\ TraceParamPlots[j];}
\DoxyCodeLine{03480\ \ \ \}}
\DoxyCodeLine{03481\ \ \ \textcolor{keyword}{delete}[]\ TraceParamPlots;}
\DoxyCodeLine{03482\ }
\DoxyCodeLine{03483\ \ \ TDirectory\ *LLDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}LogL"{}});}
\DoxyCodeLine{03484\ \ \ LLDir-\/>cd();}
\DoxyCodeLine{03485\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_a419d3669dbb54a55a635e35691134cc1}{nSamples}};\ ++j)\ \{}
\DoxyCodeLine{03486\ \ \ \ \ TraceSamplePlots[j]-\/>Write();}
\DoxyCodeLine{03487\ \ \ \ \ \textcolor{keyword}{delete}\ TraceSamplePlots[j];}
\DoxyCodeLine{03488\ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a28e89498420221149ec97c353c430bf8}{SampleValues}}[j];}
\DoxyCodeLine{03489\ \ \ \}}
\DoxyCodeLine{03490\ \ \ \textcolor{keyword}{delete}[]\ TraceSamplePlots;}
\DoxyCodeLine{03491\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a28e89498420221149ec97c353c430bf8}{SampleValues}};}
\DoxyCodeLine{03492\ }
\DoxyCodeLine{03493\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_adf518be96278f1d3901404cfbe767b67}{nSysts}};\ ++j)\ \{}
\DoxyCodeLine{03494\ \ \ \ \ TraceSystsPlots[j]-\/>Write();}
\DoxyCodeLine{03495\ \ \ \ \ \textcolor{keyword}{delete}\ TraceSystsPlots[j];}
\DoxyCodeLine{03496\ \ \ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classMCMCProcessor_a4eb2748c81b0aef9bd7e14785559e301}{SystValues}}[j];}
\DoxyCodeLine{03497\ \ \ \}}
\DoxyCodeLine{03498\ \ \ \textcolor{keyword}{delete}[]\ TraceSystsPlots;}
\DoxyCodeLine{03499\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classMCMCProcessor_a4eb2748c81b0aef9bd7e14785559e301}{SystValues}};}
\DoxyCodeLine{03500\ }
\DoxyCodeLine{03501\ \ \ TraceDir-\/>Close();}
\DoxyCodeLine{03502\ \ \ \textcolor{keyword}{delete}\ TraceDir;}
\DoxyCodeLine{03503\ }
\DoxyCodeLine{03504\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{03505\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_aef760d8c4bb70690a5c4114f4b2409b3}\label{classMCMCProcessor_aef760d8c4bb70690a5c4114f4b2409b3}} 
\index{MCMCProcessor@{MCMCProcessor}!PowerSpectrumAnalysis@{PowerSpectrumAnalysis}}
\index{PowerSpectrumAnalysis@{PowerSpectrumAnalysis}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{PowerSpectrumAnalysis()}{PowerSpectrumAnalysis()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Power\+Spectrum\+Analysis (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



RC\+: Perform spectral analysis of MCMC based on \cite{Dunkley:2004sv}. 

\begin{DoxyRefDesc}{Todo}
\item[\mbox{\hyperlink{todo__todo000011}{Todo}}]KS\+: Code is awfully slow... I know how to make it faster (GPU scream in a distant) but for now just make it for two params, bit hacky sry... \end{DoxyRefDesc}


Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l04020}{4020}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{04020\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{04021\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{04022\ \ \ TStopwatch\ clock;}
\DoxyCodeLine{04023\ \ \ clock.Start();}
\DoxyCodeLine{04024\ }
\DoxyCodeLine{04025\ \ \ \textcolor{comment}{//KS:\ Store\ it\ as\ we\ go\ back\ to\ them\ at\ the\ end}}
\DoxyCodeLine{04026\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ TopMargin\ \ =\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>GetTopMargin();}
\DoxyCodeLine{04027\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ OptTitle\ =\ gStyle-\/>GetOptTitle();}
\DoxyCodeLine{04028\ }
\DoxyCodeLine{04029\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTopMargin(0.1);}
\DoxyCodeLine{04030\ \ \ gStyle-\/>SetOptTitle(1);}
\DoxyCodeLine{04031\ }
\DoxyCodeLine{04032\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ Power\ Spectrum\ plots..."{}});}
\DoxyCodeLine{04033\ }
\DoxyCodeLine{04034\ \ \ \textcolor{comment}{//\ This\ is\ only\ to\ reduce\ number\ of\ computations...}}
\DoxyCodeLine{04035\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ N\_Coeffs\ =\ std::min(10000,\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{04036\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ start\ =\ -\/(N\_Coeffs/2-\/1);}
\DoxyCodeLine{04037\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ end\ =\ N\_Coeffs/2-\/1;}
\DoxyCodeLine{04038\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ v\_size\ =\ end\ -\/\ start;}
\DoxyCodeLine{04039\ }
\DoxyCodeLine{04040\ \ \ \textcolor{keywordtype}{int}\ nPrams\ =\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};}
\DoxyCodeLine{04042\ \ \ nPrams\ =\ 2;}
\DoxyCodeLine{04043\ }
\DoxyCodeLine{04044\ \ \ std::vector<std::vector<float>>\ k\_j(nPrams,\ std::vector<float>(v\_size,\ 0.0));}
\DoxyCodeLine{04045\ \ \ std::vector<std::vector<float>>\ P\_j(nPrams,\ std::vector<float>(v\_size,\ 0.0));}
\DoxyCodeLine{04046\ }
\DoxyCodeLine{04047\ \ \ \textcolor{keywordtype}{int}\ \_N\ =\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};}
\DoxyCodeLine{04048\ \ \ \textcolor{keywordflow}{if}\ (\_N\ \%\ 2\ !=\ 0)\ \_N\ -\/=\ 1;\ \textcolor{comment}{//\ N\ must\ be\ even}}
\DoxyCodeLine{04049\ }
\DoxyCodeLine{04050\ \ \ \textcolor{comment}{//This\ is\ being\ used\ a\ lot\ so\ calculate\ it\ once\ to\ increase\ performance}}
\DoxyCodeLine{04051\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ two\_pi\_over\_N\ =\ 2\ *\ TMath::Pi()\ /\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(\_N);}
\DoxyCodeLine{04052\ }
\DoxyCodeLine{04053\ \ \ \textcolor{comment}{//\ KS:\ This\ could\ be\ moved\ to\ GPU\ I\ guess}}
\DoxyCodeLine{04054\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{04055\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for\ collapse(2)}}
\DoxyCodeLine{04056\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{04057\ \ \ \textcolor{comment}{//\ RC:\ equation\ 11:\ for\ each\ value\ of\ j\ coef,\ from\ range\ -\/N/2\ -\/>\ N/2}}
\DoxyCodeLine{04058\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nPrams;\ ++j)}
\DoxyCodeLine{04059\ \ \ \{}
\DoxyCodeLine{04060\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ jj\ =\ start;\ jj\ <\ end;\ ++jj)}
\DoxyCodeLine{04061\ \ \ \ \ \{}
\DoxyCodeLine{04062\ \ \ \ \ \ \ std::complex<double>\ a\_j\ =\ 0.0;}
\DoxyCodeLine{04063\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ n\ =\ 0;\ n\ <\ \_N;\ ++n)}
\DoxyCodeLine{04064\ \ \ \ \ \ \ \{}
\DoxyCodeLine{04065\ \ \ \ \ \ \ \ \ \textcolor{comment}{//if(StepNumber[n]\ <\ BurnInCut)\ continue;}}
\DoxyCodeLine{04066\ \ \ \ \ \ \ \ \ std::complex<double>\ exp\_temp(0,\ two\_pi\_over\_N\ *\ jj\ *\ n);}
\DoxyCodeLine{04067\ \ \ \ \ \ \ \ \ a\_j\ +=\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][n]\ *\ std::exp(exp\_temp);}
\DoxyCodeLine{04068\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04069\ \ \ \ \ \ \ a\_j\ /=\ std::sqrt(\textcolor{keywordtype}{float}(\_N));}
\DoxyCodeLine{04070\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \_c\ =\ jj\ -\/\ start;}
\DoxyCodeLine{04071\ }
\DoxyCodeLine{04072\ \ \ \ \ \ \ k\_j[j][\_c]\ =\ two\_pi\_over\_N\ *\ jj;}
\DoxyCodeLine{04073\ \ \ \ \ \ \ \textcolor{comment}{//\ Equation\ 13}}
\DoxyCodeLine{04074\ \ \ \ \ \ \ P\_j[j][\_c]\ =\ std::norm(a\_j);}
\DoxyCodeLine{04075\ \ \ \ \ \}}
\DoxyCodeLine{04076\ \ \ \}}
\DoxyCodeLine{04077\ }
\DoxyCodeLine{04078\ \ \ TDirectory\ *PowerDir\ =\ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}PowerSpectrum"{}});}
\DoxyCodeLine{04079\ \ \ PowerDir-\/>cd();}
\DoxyCodeLine{04080\ }
\DoxyCodeLine{04081\ \ \ TGraph\ **plot\ =\ \textcolor{keyword}{new}\ TGraph*[nPrams];}
\DoxyCodeLine{04082\ \ \ TVectorD*\ PowerSpectrumStepSize\ =\ \textcolor{keyword}{new}\ TVectorD(nPrams);}
\DoxyCodeLine{04083\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ nPrams;\ ++j)}
\DoxyCodeLine{04084\ \ \ \{}
\DoxyCodeLine{04085\ \ \ \ \ plot[j]\ =\ \textcolor{keyword}{new}\ TGraph(v\_size,\ k\_j[j].data(),\ P\_j[j].data());}
\DoxyCodeLine{04086\ }
\DoxyCodeLine{04087\ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{04088\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{04089\ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{04090\ }
\DoxyCodeLine{04091\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(j,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{04092\ }
\DoxyCodeLine{04093\ \ \ \ \ std::string\ name\ =\ Form(\textcolor{stringliteral}{"{}Power\ Spectrum\ of\ \%s;k;P(k)"{}},\ Title.Data());}
\DoxyCodeLine{04094\ }
\DoxyCodeLine{04095\ \ \ \ \ plot[j]-\/>SetTitle(name.c\_str());}
\DoxyCodeLine{04096\ \ \ \ \ name\ =\ Form(\textcolor{stringliteral}{"{}\%s\_power\_spectrum"{}},\ Title.Data());}
\DoxyCodeLine{04097\ \ \ \ \ plot[j]-\/>SetName(name.c\_str());}
\DoxyCodeLine{04098\ \ \ \ \ plot[j]-\/>SetMarkerStyle(7);}
\DoxyCodeLine{04099\ }
\DoxyCodeLine{04100\ \ \ \ \ \textcolor{comment}{//\ Equation\ 18}}
\DoxyCodeLine{04101\ \ \ \ \ TF1\ *func\ =\ \textcolor{keyword}{new}\ TF1(\textcolor{stringliteral}{"{}power\_template"{}},\ \textcolor{stringliteral}{"{}[0]*(\ ([1]\ /\ x)\string^[2]\ /\ (([1]\ /\ x)\string^[2]\ +1)\ )"{}},\ 0.0,\ 1.0);}
\DoxyCodeLine{04102\ \ \ \ \ \textcolor{comment}{//\ P0\ gives\ the\ amplitude\ of\ the\ white\ noise\ spectrum\ in\ the\ k\ →\ 0\ limit}}
\DoxyCodeLine{04103\ \ \ \ \ func-\/>SetParameter(0,\ 10.0);}
\DoxyCodeLine{04104\ \ \ \ \ \textcolor{comment}{//\ k*\ indicates\ the\ position\ of\ the\ turnover\ to\ a\ different\ power\ law\ behaviour}}
\DoxyCodeLine{04105\ \ \ \ \ func-\/>SetParameter(1,\ 0.1);}
\DoxyCodeLine{04106\ \ \ \ \ \textcolor{comment}{//\ alpha\ free\ parameter}}
\DoxyCodeLine{04107\ \ \ \ \ func-\/>SetParameter(2,\ 2.0);}
\DoxyCodeLine{04108\ }
\DoxyCodeLine{04109\ \ \ \ \ \textcolor{comment}{//\ Set\ parameter\ limits\ for\ stability}}
\DoxyCodeLine{04110\ \ \ \ \ func-\/>SetParLimits(0,\ 0.0,\ 100.0);\ \textcolor{comment}{//\ Amplitude\ should\ be\ non-\/negative}}
\DoxyCodeLine{04111\ \ \ \ \ func-\/>SetParLimits(1,\ 0.001,\ 1.0);\ \textcolor{comment}{//\ k*\ should\ be\ within\ a\ reasonable\ range}}
\DoxyCodeLine{04112\ \ \ \ \ func-\/>SetParLimits(2,\ 0.0,\ 5.0);\ \ \ \textcolor{comment}{//\ alpha\ should\ be\ positive}}
\DoxyCodeLine{04113\ }
\DoxyCodeLine{04114\ \ \ \ \ plot[j]-\/>Fit(\textcolor{stringliteral}{"{}power\_template"{}},\textcolor{stringliteral}{"{}Rq"{}});}
\DoxyCodeLine{04115\ }
\DoxyCodeLine{04116\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetLogx();}
\DoxyCodeLine{04117\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetLogy();}
\DoxyCodeLine{04118\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetGrid();}
\DoxyCodeLine{04119\ \ \ \ \ plot[j]-\/>Write(plot[j]-\/>GetName());}
\DoxyCodeLine{04120\ \ \ \ \ plot[j]-\/>Draw(\textcolor{stringliteral}{"{}AL"{}});}
\DoxyCodeLine{04121\ \ \ \ \ func-\/>Draw(\textcolor{stringliteral}{"{}SAME"{}});}
\DoxyCodeLine{04122\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{04123\ }
\DoxyCodeLine{04124\ \ \ \ \ \textcolor{comment}{//KS:\ I\ have\ no\ clue\ what\ is\ the\ reason\ behind\ this.\ Found\ this\ in\ Rick\ Calland\ code...}}
\DoxyCodeLine{04125\ \ \ \ \ (*PowerSpectrumStepSize)(j)\ =\ std::sqrt(func-\/>GetParameter(0)/float(v\_size*0.5));}
\DoxyCodeLine{04126\ }
\DoxyCodeLine{04127\ \ \ \ \ \textcolor{keyword}{delete}\ func;}
\DoxyCodeLine{04128\ \ \ \ \ \textcolor{keyword}{delete}\ plot[j];}
\DoxyCodeLine{04129\ \ \ \}}
\DoxyCodeLine{04130\ \ \ \textcolor{keyword}{delete}\ []\ plot;}
\DoxyCodeLine{04131\ }
\DoxyCodeLine{04132\ \ \ PowerSpectrumStepSize-\/>Write(\textcolor{stringliteral}{"{}PowerSpectrumStepSize"{}});}
\DoxyCodeLine{04133\ \ \ \textcolor{keyword}{delete}\ PowerSpectrumStepSize;}
\DoxyCodeLine{04134\ \ \ PowerDir-\/>Close();}
\DoxyCodeLine{04135\ \ \ \textcolor{keyword}{delete}\ PowerDir;}
\DoxyCodeLine{04136\ }
\DoxyCodeLine{04137\ \ \ clock.Stop();}
\DoxyCodeLine{04138\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ Power\ Spectrum\ took\ \{:.2f\}s"{}},\ clock.RealTime());}
\DoxyCodeLine{04139\ }
\DoxyCodeLine{04140\ \ \ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>SetTopMargin(TopMargin);}
\DoxyCodeLine{04141\ \ \ gStyle-\/>SetOptTitle(OptTitle);}
\DoxyCodeLine{04142\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a930cadafa41b31b58066dea68628de9f}\label{classMCMCProcessor_a930cadafa41b31b58066dea68628de9f}} 
\index{MCMCProcessor@{MCMCProcessor}!PrepareDiagMCMC@{PrepareDiagMCMC}}
\index{PrepareDiagMCMC@{PrepareDiagMCMC}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{PrepareDiagMCMC()}{PrepareDiagMCMC()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Prepare\+Diag\+MCMC (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



CW\+: Prepare branches etc. for Diag\+MCMC. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l03239}{3239}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{03239\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03240\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{03241\ \ \ \mbox{\hyperlink{classMCMCProcessor_adf449e50cf358f737fe4a2b65d9668e9}{doDiagMCMC}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03242\ \ \ \ \ }
\DoxyCodeLine{03243\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}\ !=\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{03244\ \ \ \{}
\DoxyCodeLine{03245\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}It\ look\ like\ ParStep\ was\ already\ filled\ "{}});}
\DoxyCodeLine{03246\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Even\ though\ it\ is\ used\ for\ MakeCovariance\_MP\ and\ for\ DiagMCMC"{}});}
\DoxyCodeLine{03247\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}it\ has\ different\ structure\ in\ both\ for\ cache\ hits,\ sorry\ "{}});}
\DoxyCodeLine{03248\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{03249\ \ \ \}}
\DoxyCodeLine{03250\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}\ ==\ 0)}
\DoxyCodeLine{03251\ \ \ \{}
\DoxyCodeLine{03252\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}nBatches\ is\ equal\ to\ 0"{}});}
\DoxyCodeLine{03253\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}please\ use\ SetnBatches\ to\ set\ other\ value\ fore\ example\ 20"{}});}
\DoxyCodeLine{03254\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{03255\ \ \ \}}
\DoxyCodeLine{03256\ \ \ \ \ }
\DoxyCodeLine{03257\ \ \ \textcolor{comment}{//\ Initialise\ ParStep}}
\DoxyCodeLine{03258\ \ \ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}]();}
\DoxyCodeLine{03259\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{03260\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}]();}
\DoxyCodeLine{03261\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++i)\ \{}
\DoxyCodeLine{03262\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i]\ =\ -\/999.99;}
\DoxyCodeLine{03263\ \ \ \ \ \}}
\DoxyCodeLine{03264\ \ \ \}}
\DoxyCodeLine{03265\ }
\DoxyCodeLine{03266\ \ \ \mbox{\hyperlink{classMCMCProcessor_a28e89498420221149ec97c353c430bf8}{SampleValues}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}]();}
\DoxyCodeLine{03267\ \ \ \mbox{\hyperlink{classMCMCProcessor_a4eb2748c81b0aef9bd7e14785559e301}{SystValues}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}]();}
\DoxyCodeLine{03268\ \ \ \mbox{\hyperlink{classMCMCProcessor_a88cab29770fd6098a674a0ab3628a251}{AccProbValues}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}]();}
\DoxyCodeLine{03269\ \ \ \mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{int}[\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}]();}
\DoxyCodeLine{03270\ }
\DoxyCodeLine{03271\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++i)\ \{}
\DoxyCodeLine{03272\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28e89498420221149ec97c353c430bf8}{SampleValues}}[i]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classMCMCProcessor_a419d3669dbb54a55a635e35691134cc1}{nSamples}}]();}
\DoxyCodeLine{03273\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4eb2748c81b0aef9bd7e14785559e301}{SystValues}}[i]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classMCMCProcessor_adf518be96278f1d3901404cfbe767b67}{nSysts}}]();}
\DoxyCodeLine{03274\ }
\DoxyCodeLine{03275\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_a419d3669dbb54a55a635e35691134cc1}{nSamples}};\ ++j)\ \{}
\DoxyCodeLine{03276\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28e89498420221149ec97c353c430bf8}{SampleValues}}[i][j]\ =\ -\/999.99;}
\DoxyCodeLine{03277\ \ \ \ \ \}}
\DoxyCodeLine{03278\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_adf518be96278f1d3901404cfbe767b67}{nSysts}};\ ++j)\ \{}
\DoxyCodeLine{03279\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4eb2748c81b0aef9bd7e14785559e301}{SystValues}}[i][j]\ =\ -\/999.99;}
\DoxyCodeLine{03280\ \ \ \ \ \}}
\DoxyCodeLine{03281\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a88cab29770fd6098a674a0ab3628a251}{AccProbValues}}[i]\ =\ -\/999.99;}
\DoxyCodeLine{03282\ }
\DoxyCodeLine{03283\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}[i]\ =\ -\/999.99;}
\DoxyCodeLine{03284\ \ \ \}}
\DoxyCodeLine{03285\ }
\DoxyCodeLine{03286\ \ \ \textcolor{comment}{//\ Initialise\ the\ sums}}
\DoxyCodeLine{03287\ \ \ \mbox{\hyperlink{classMCMCProcessor_a7db98c7cf390b050f1acb927b4f55cab}{ParamSums}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}]();}
\DoxyCodeLine{03288\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ \{}
\DoxyCodeLine{03289\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a7db98c7cf390b050f1acb927b4f55cab}{ParamSums}}[i]\ =\ 0.0;}
\DoxyCodeLine{03290\ \ \ \}}
\DoxyCodeLine{03291\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Reading\ input\ tree..."{}});}
\DoxyCodeLine{03292\ \ \ TStopwatch\ clock;}
\DoxyCodeLine{03293\ \ \ clock.Start();}
\DoxyCodeLine{03294\ }
\DoxyCodeLine{03295\ \ \ \textcolor{comment}{//\ Set\ all\ the\ branches\ to\ off}}
\DoxyCodeLine{03296\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchStatus(\textcolor{stringliteral}{"{}*"{}},\ \textcolor{keyword}{false});}
\DoxyCodeLine{03297\ }
\DoxyCodeLine{03298\ \ \ \textcolor{comment}{//\ Turn\ on\ the\ branches\ which\ we\ want\ for\ parameters}}
\DoxyCodeLine{03299\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ \{}
\DoxyCodeLine{03300\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchStatus(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i].Data(),\ \textcolor{keyword}{true});}
\DoxyCodeLine{03301\ \ \ \}}
\DoxyCodeLine{03302\ \ \ }
\DoxyCodeLine{03303\ \ \ \textcolor{comment}{//\ Turn\ on\ the\ branches\ which\ we\ want\ for\ LogL\ sample}}
\DoxyCodeLine{03304\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a419d3669dbb54a55a635e35691134cc1}{nSamples}};\ ++i)\ \{}
\DoxyCodeLine{03305\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchStatus(\mbox{\hyperlink{classMCMCProcessor_a3660e404a6631cfa913a815481730a9b}{SampleName\_v}}[i].Data(),\ \textcolor{keyword}{true});}
\DoxyCodeLine{03306\ \ \ \}}
\DoxyCodeLine{03307\ }
\DoxyCodeLine{03308\ \ \ \textcolor{comment}{//\ Turn\ on\ the\ branches\ which\ we\ want\ for\ LogL\ systs}}
\DoxyCodeLine{03309\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_adf518be96278f1d3901404cfbe767b67}{nSysts}};\ ++i)\ \{}
\DoxyCodeLine{03310\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchStatus(\mbox{\hyperlink{classMCMCProcessor_acb1871575fdd3ae156aed4bf7c7a0a73}{SystName\_v}}[i].Data(),\ \textcolor{keyword}{true});}
\DoxyCodeLine{03311\ \ \ \}}
\DoxyCodeLine{03312\ }
\DoxyCodeLine{03313\ \ \ \textcolor{comment}{//\ Turn\ on\ the\ branches\ which\ we\ want\ for\ acc\ prob}}
\DoxyCodeLine{03314\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchStatus(\textcolor{stringliteral}{"{}accProb"{}},\ \textcolor{keyword}{true});}
\DoxyCodeLine{03315\ \ \ }
\DoxyCodeLine{03316\ \ \ \textcolor{comment}{//\ Only\ needed\ for\ Geweke\ right\ now}}
\DoxyCodeLine{03317\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchStatus(\textcolor{stringliteral}{"{}step"{}},\ \textcolor{keyword}{true});}
\DoxyCodeLine{03318\ }
\DoxyCodeLine{03319\ \ \ \textcolor{comment}{//\ 10\ entries\ output}}
\DoxyCodeLine{03320\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ countwidth\ =\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}/10;}
\DoxyCodeLine{03321\ }
\DoxyCodeLine{03322\ \ \ \textcolor{comment}{//\ Can\ also\ do\ the\ batched\ means\ here\ to\ minimize\ excessive\ loops}}
\DoxyCodeLine{03323\ \ \ \textcolor{comment}{//\ The\ length\ of\ each\ batch}}
\DoxyCodeLine{03324\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ BatchLength\ =\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}/\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}+1;}
\DoxyCodeLine{03325\ \ \ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}]();}
\DoxyCodeLine{03326\ \ \ \mbox{\hyperlink{classMCMCProcessor_a523a223a4754c133121796f4591c7be3}{AccProbBatchedAverages}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}]();}
\DoxyCodeLine{03327\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}};\ ++i)\ \{}
\DoxyCodeLine{03328\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}];}
\DoxyCodeLine{03329\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a523a223a4754c133121796f4591c7be3}{AccProbBatchedAverages}}[i]\ =\ 0;}
\DoxyCodeLine{03330\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{03331\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[i][j]\ =\ 0.0;}
\DoxyCodeLine{03332\ \ \ \ \ \}}
\DoxyCodeLine{03333\ \ \ \}}
\DoxyCodeLine{03334\ }
\DoxyCodeLine{03335\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ entries}}
\DoxyCodeLine{03336\ \ \ \textcolor{comment}{//KS:\ This\ is\ really\ a\ bottleneck\ right\ now,\ thus\ revisit\ with\ ROOT6\ https://pep-\/root6.github.io/docs/analysis/parallell/root.html}}
\DoxyCodeLine{03337\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++i)\ \{}
\DoxyCodeLine{03338\ }
\DoxyCodeLine{03339\ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ \%\ countwidth\ ==\ 0)}
\DoxyCodeLine{03340\ \ \ \ \ \ \ \mbox{\hyperlink{namespaceMaCh3Utils_a4c8bdeb1d34606aed192e9f1311a72f5}{MaCh3Utils::PrintProgressBar}}(i,\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{03341\ }
\DoxyCodeLine{03342\ \ \ \ \ \textcolor{comment}{//\ Set\ the\ branch\ addresses\ for\ params}}
\DoxyCodeLine{03343\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{03344\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchAddress(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[j].Data(),\ \&\mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i]);}
\DoxyCodeLine{03345\ \ \ \ \ \}}
\DoxyCodeLine{03346\ }
\DoxyCodeLine{03347\ \ \ \ \ \textcolor{comment}{//\ Set\ the\ branch\ addresses\ for\ samples}}
\DoxyCodeLine{03348\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_a419d3669dbb54a55a635e35691134cc1}{nSamples}};\ ++j)\ \{}
\DoxyCodeLine{03349\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchAddress(\mbox{\hyperlink{classMCMCProcessor_a3660e404a6631cfa913a815481730a9b}{SampleName\_v}}[j].Data(),\ \&\mbox{\hyperlink{classMCMCProcessor_a28e89498420221149ec97c353c430bf8}{SampleValues}}[i][j]);}
\DoxyCodeLine{03350\ \ \ \ \ \}}
\DoxyCodeLine{03351\ }
\DoxyCodeLine{03352\ \ \ \ \ \textcolor{comment}{//\ Set\ the\ branch\ addresses\ for\ systematics}}
\DoxyCodeLine{03353\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_adf518be96278f1d3901404cfbe767b67}{nSysts}};\ ++j)\ \{}
\DoxyCodeLine{03354\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchAddress(\mbox{\hyperlink{classMCMCProcessor_acb1871575fdd3ae156aed4bf7c7a0a73}{SystName\_v}}[j].Data(),\ \&\mbox{\hyperlink{classMCMCProcessor_a4eb2748c81b0aef9bd7e14785559e301}{SystValues}}[i][j]);}
\DoxyCodeLine{03355\ \ \ \ \ \}}
\DoxyCodeLine{03356\ \ \ \ \ \ \ }
\DoxyCodeLine{03357\ \ \ \ \ \textcolor{comment}{//\ Set\ the\ branch\ addresses\ for\ Acceptance\ Probability}}
\DoxyCodeLine{03358\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchAddress(\textcolor{stringliteral}{"{}accProb"{}},\ \&\mbox{\hyperlink{classMCMCProcessor_a88cab29770fd6098a674a0ab3628a251}{AccProbValues}}[i]);}
\DoxyCodeLine{03359\ }
\DoxyCodeLine{03360\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchAddress(\textcolor{stringliteral}{"{}step"{}},\ \&\mbox{\hyperlink{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}{StepNumber}}[i]);}
\DoxyCodeLine{03361\ }
\DoxyCodeLine{03362\ \ \ \ \ \textcolor{comment}{//\ Fill\ up\ the\ arrays}}
\DoxyCodeLine{03363\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetEntry(i);}
\DoxyCodeLine{03364\ }
\DoxyCodeLine{03365\ \ \ \ \ \textcolor{comment}{//\ Find\ which\ batch\ the\ event\ belongs\ in}}
\DoxyCodeLine{03366\ \ \ \ \ \textcolor{keywordtype}{int}\ BatchNumber\ =\ -\/1;}
\DoxyCodeLine{03367\ \ \ \ \ \textcolor{comment}{//\ I'm\ so\ lazy!\ But\ it's\ OK,\ the\ major\ overhead\ here\ is\ GetEntry:\ saved\ by\ ROOT!}}
\DoxyCodeLine{03368\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}};\ ++j)\ \{}
\DoxyCodeLine{03369\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ <\ (j+1)*BatchLength)\ \{}
\DoxyCodeLine{03370\ \ \ \ \ \ \ \ \ BatchNumber\ =\ j;}
\DoxyCodeLine{03371\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03372\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03373\ \ \ \ \ \}}
\DoxyCodeLine{03374\ }
\DoxyCodeLine{03375\ \ \ \ \ \textcolor{comment}{//\ Fill\ up\ the\ sum\ for\ each\ j\ param}}
\DoxyCodeLine{03376\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{03377\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a7db98c7cf390b050f1acb927b4f55cab}{ParamSums}}[j]\ +=\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i];}
\DoxyCodeLine{03378\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[BatchNumber][j]\ +=\ \mbox{\hyperlink{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}{ParStep}}[j][i];}
\DoxyCodeLine{03379\ \ \ \ \ \}}
\DoxyCodeLine{03380\ \ \ \ \ }
\DoxyCodeLine{03381\ \ \ \ \ \textcolor{comment}{//KS:\ Could\ easily\ add\ this\ to\ above\ loop\ but\ I\ accProb\ is\ different\ beast\ so\ better\ keep\ it\ like\ this}}
\DoxyCodeLine{03382\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a523a223a4754c133121796f4591c7be3}{AccProbBatchedAverages}}[BatchNumber]\ +=\ \mbox{\hyperlink{classMCMCProcessor_a88cab29770fd6098a674a0ab3628a251}{AccProbValues}}[i];}
\DoxyCodeLine{03383\ \ \ \}}
\DoxyCodeLine{03384\ }
\DoxyCodeLine{03385\ \ \ clock.Stop();}
\DoxyCodeLine{03386\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Took\ \{:.2f\}s\ to\ finish\ caching\ statistic\ for\ Diag\ MCMC\ with\ \{\}\ steps"{}},\ clock.RealTime(),\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{03387\ }
\DoxyCodeLine{03388\ \ \ \textcolor{comment}{//\ Make\ the\ sums\ into\ average}}
\DoxyCodeLine{03389\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{03390\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{03391\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{03392\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ \{}
\DoxyCodeLine{03393\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a7db98c7cf390b050f1acb927b4f55cab}{ParamSums}}[i]\ /=\ double(\mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}});}
\DoxyCodeLine{03394\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}};\ ++j)\ \{}
\DoxyCodeLine{03395\ \ \ \ \ \ \ \textcolor{comment}{//\ Divide\ by\ the\ total\ number\ of\ events\ in\ the\ batch}}
\DoxyCodeLine{03396\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}{BatchedAverages}}[j][i]\ /=\ BatchLength;}
\DoxyCodeLine{03397\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(i\ ==\ 0)\ \mbox{\hyperlink{classMCMCProcessor_a523a223a4754c133121796f4591c7be3}{AccProbBatchedAverages}}[j]\ /=\ BatchLength;\ \textcolor{comment}{//KS:\ we\ have\ only\ one\ accProb,\ keep\ it\ like\ this\ for\ now}}
\DoxyCodeLine{03398\ \ \ \ \ \}}
\DoxyCodeLine{03399\ \ \ \}}
\DoxyCodeLine{03400\ }
\DoxyCodeLine{03401\ \ \ \textcolor{comment}{//\ And\ make\ our\ sweet\ output\ file}}
\DoxyCodeLine{03402\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_aa5a7761e97cf2e24c7d877a5374b7333}{MakeOutputFile}}();}
\DoxyCodeLine{03403\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_ae5ea421c8dd77ceac2e748008633b573}\label{classMCMCProcessor_ae5ea421c8dd77ceac2e748008633b573}} 
\index{MCMCProcessor@{MCMCProcessor}!ReadFDFile@{ReadFDFile}}
\index{ReadFDFile@{ReadFDFile}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{ReadFDFile()}{ReadFDFile()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Read\+FDFile (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Read the FD cov file and get the input central values and errors. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l02591}{2591}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02591\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02592\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{02593\ \ \ \textcolor{comment}{//\ Do\ the\ same\ for\ the\ FD}}
\DoxyCodeLine{02594\ \ \ TFile\ *FDdetFile\ =\ \textcolor{keyword}{new}\ TFile(\mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}].back().c\_str(),\ \textcolor{stringliteral}{"{}open"{}});}
\DoxyCodeLine{02595\ \ \ \textcolor{keywordflow}{if}\ (FDdetFile-\/>IsZombie())\ \{}
\DoxyCodeLine{02596\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Couldn't\ find\ NDdetFile\ \{\}"{}},\ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}].back());}
\DoxyCodeLine{02597\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{02598\ \ \ \}}
\DoxyCodeLine{02599\ \ \ FDdetFile-\/>cd();}
\DoxyCodeLine{02600\ }
\DoxyCodeLine{02601\ \ \ TMatrixDSym\ *FDdetMatrix\ =\ FDdetFile-\/>Get<TMatrixDSym>(\textcolor{stringliteral}{"{}SKJointError\_Erec\_Total"{}});}
\DoxyCodeLine{02602\ }
\DoxyCodeLine{02603\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ FDdetMatrix-\/>GetNrows();\ ++i)}
\DoxyCodeLine{02604\ \ \ \{}
\DoxyCodeLine{02605\ \ \ \ \ \textcolor{comment}{//KS:\ FD\ parameters\ start\ at\ 1.\ in\ contrary\ to\ ND280}}
\DoxyCodeLine{02606\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4c4c6aa4827a2fe54ce37defbb3d0475}{ParamNom}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}].push\_back(1.);}
\DoxyCodeLine{02607\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a3a6614826ae320e462211e38e96d9d02}{ParamCentral}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}].push\_back(1.);}
\DoxyCodeLine{02608\ }
\DoxyCodeLine{02609\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a3a97e3cb4be3ceb9eb721eac51d82d60}{ParamErrors}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}].push\_back(\ std::sqrt((*FDdetMatrix)(i,i))\ );}
\DoxyCodeLine{02610\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_adecc55689f7d37b9412f8886fe3480dc}{ParamNames}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}].push\_back(\ Form(\textcolor{stringliteral}{"{}FD\ Det\ \%i"{}},\ i)\ );}
\DoxyCodeLine{02611\ }
\DoxyCodeLine{02612\ \ \ \ \ \textcolor{comment}{//KS:\ Currently\ we\ can\ only\ set\ it\ via\ config,\ change\ it\ in\ future}}
\DoxyCodeLine{02613\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4be1eedb743e4ea410009a4fa45720f7}{ParamFlat}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}].push\_back(\ \textcolor{keyword}{false}\ );}
\DoxyCodeLine{02614\ \ \ \}}
\DoxyCodeLine{02615\ \ \ \textcolor{comment}{//KS:\ The\ last\ parameter\ is\ p\ scale}}
\DoxyCodeLine{02616\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad25fe818c94163b0c4a8fcdfd387c148}{FancyPlotNames}})\ \mbox{\hyperlink{classMCMCProcessor_adecc55689f7d37b9412f8886fe3480dc}{ParamNames}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}].back()\ =\ \textcolor{stringliteral}{"{}Momentum\ Scale"{}};}
\DoxyCodeLine{02617\ }
\DoxyCodeLine{02618\ \ \ FDdetFile-\/>Close();}
\DoxyCodeLine{02619\ \ \ \textcolor{keyword}{delete}\ FDdetFile;}
\DoxyCodeLine{02620\ \ \ \textcolor{keyword}{delete}\ FDdetMatrix;}
\DoxyCodeLine{02621\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_afef48d4fccf7551dc1845f8f6c08864f}\label{classMCMCProcessor_afef48d4fccf7551dc1845f8f6c08864f}} 
\index{MCMCProcessor@{MCMCProcessor}!ReadInputCov@{ReadInputCov}}
\index{ReadInputCov@{ReadInputCov}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{ReadInputCov()}{ReadInputCov()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Read\+Input\+Cov (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



CW\+: Read the input Covariance matrix entries. Get stuff like parameter input errors, names, and so on. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l02391}{2391}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02391\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02392\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{02393\ \ \ \mbox{\hyperlink{classMCMCProcessor_aea15e730ff77556bb93bc4cff675744c}{FindInputFiles}}();}
\DoxyCodeLine{02394\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]\ >\ 0)\ \ \mbox{\hyperlink{classMCMCProcessor_a2b0b4afbf45adb93357abe96d108170b}{ReadXSecFile}}();}
\DoxyCodeLine{02395\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}]\ >\ 0)\ \mbox{\hyperlink{classMCMCProcessor_a66dd0f1f88dbeb2b6a1976d42f77e136}{ReadNDFile}}();}
\DoxyCodeLine{02396\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}]\ >\ 0)\ \mbox{\hyperlink{classMCMCProcessor_ae5ea421c8dd77ceac2e748008633b573}{ReadFDFile}}();}
\DoxyCodeLine{02397\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}]\ >\ 0)\ \ \ \mbox{\hyperlink{classMCMCProcessor_a3733b3b753c73f79e6846bc92c4da11b}{ReadOSCFile}}();}
\DoxyCodeLine{02398\ \ \ \textcolor{comment}{//KS:\ Remove\ parameters\ which\ were\ removed}}
\DoxyCodeLine{02399\ \ \ \mbox{\hyperlink{classMCMCProcessor_a9a29c1cb64589ac136f7f927cafa18aa}{RemoveParameters}}();}
\DoxyCodeLine{02400\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a66dd0f1f88dbeb2b6a1976d42f77e136}\label{classMCMCProcessor_a66dd0f1f88dbeb2b6a1976d42f77e136}} 
\index{MCMCProcessor@{MCMCProcessor}!ReadNDFile@{ReadNDFile}}
\index{ReadNDFile@{ReadNDFile}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{ReadNDFile()}{ReadNDFile()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Read\+NDFile (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Read the ND cov file and get the input central values and errors. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l02548}{2548}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02548\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02549\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{02550\ \ \ \textcolor{comment}{//\ Do\ the\ same\ for\ the\ ND280}}
\DoxyCodeLine{02551\ \ \ TFile\ *NDdetFile\ =\ \textcolor{keyword}{new}\ TFile(\mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}].back().c\_str(),\ \textcolor{stringliteral}{"{}open"{}});}
\DoxyCodeLine{02552\ \ \ \textcolor{keywordflow}{if}\ (NDdetFile-\/>IsZombie())\ \{}
\DoxyCodeLine{02553\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Couldn't\ find\ NDdetFile\ \{\}"{}},\ \mbox{\hyperlink{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}{CovPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}].back());}
\DoxyCodeLine{02554\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{02555\ \ \ \}}
\DoxyCodeLine{02556\ \ \ NDdetFile-\/>cd();}
\DoxyCodeLine{02557\ }
\DoxyCodeLine{02558\ \ \ TMatrixDSym\ *NDdetMatrix\ =\ NDdetFile-\/>Get<TMatrixDSym>(\textcolor{stringliteral}{"{}nddet\_cov"{}});}
\DoxyCodeLine{02559\ \ \ TVectorD\ *NDdetNominal\ =\ NDdetFile-\/>Get<TVectorD>(\textcolor{stringliteral}{"{}det\_weights"{}});}
\DoxyCodeLine{02560\ \ \ TDirectory\ *BinningDirectory\ =\ NDdetFile-\/>Get<TDirectory>(\textcolor{stringliteral}{"{}Binning"{}});}
\DoxyCodeLine{02561\ }
\DoxyCodeLine{02562\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ NDdetNominal-\/>GetNrows();\ ++i)}
\DoxyCodeLine{02563\ \ \ \{}
\DoxyCodeLine{02564\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4c4c6aa4827a2fe54ce37defbb3d0475}{ParamNom}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}].push\_back(\ (*NDdetNominal)(i)\ );}
\DoxyCodeLine{02565\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a3a6614826ae320e462211e38e96d9d02}{ParamCentral}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}].push\_back(\ (*NDdetNominal)(i)\ );}
\DoxyCodeLine{02566\ }
\DoxyCodeLine{02567\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a3a97e3cb4be3ceb9eb721eac51d82d60}{ParamErrors}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}].push\_back(\ std::sqrt((*NDdetMatrix)(i,i))\ );}
\DoxyCodeLine{02568\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_adecc55689f7d37b9412f8886fe3480dc}{ParamNames}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}].push\_back(\ Form(\textcolor{stringliteral}{"{}ND\ Det\ \%i"{}},\ i)\ );}
\DoxyCodeLine{02569\ \ \ \ \ \textcolor{comment}{//KS:\ Currently\ we\ can\ only\ set\ it\ via\ config,\ change\ it\ in\ future}}
\DoxyCodeLine{02570\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4be1eedb743e4ea410009a4fa45720f7}{ParamFlat}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}].push\_back(\ \textcolor{keyword}{false}\ );}
\DoxyCodeLine{02571\ \ \ \}}
\DoxyCodeLine{02572\ }
\DoxyCodeLine{02573\ \ \ TIter\ next(BinningDirectory-\/>GetListOfKeys());}
\DoxyCodeLine{02574\ \ \ TKey\ *key\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02575\ \ \ \textcolor{comment}{//\ Loop\ through\ all\ entries}}
\DoxyCodeLine{02576\ \ \ \textcolor{keywordflow}{while}\ ((key\ =\ \textcolor{keyword}{static\_cast<}TKey*\textcolor{keyword}{>}(next())))}
\DoxyCodeLine{02577\ \ \ \{}
\DoxyCodeLine{02578\ \ \ \ \ std::string\ name\ =\ std::string(key-\/>GetName());}
\DoxyCodeLine{02579\ \ \ \ \ TH2Poly*\ RefPoly\ =\ BinningDirectory-\/>Get<TH2Poly>((name).c\_str());}
\DoxyCodeLine{02580\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}}\ =\ RefPoly-\/>GetNumberOfBins();}
\DoxyCodeLine{02581\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ae76b02ce85737d30c778698ba127933b}{NDSamplesBins}}.push\_back(\mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}});}
\DoxyCodeLine{02582\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a27c8a25155baab660fc9658861c433ab}{NDSamplesNames}}.push\_back(RefPoly-\/>GetTitle());}
\DoxyCodeLine{02583\ \ \ \}}
\DoxyCodeLine{02584\ }
\DoxyCodeLine{02585\ \ \ NDdetFile-\/>Close();}
\DoxyCodeLine{02586\ \ \ \textcolor{keyword}{delete}\ NDdetFile;}
\DoxyCodeLine{02587\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a3733b3b753c73f79e6846bc92c4da11b}\label{classMCMCProcessor_a3733b3b753c73f79e6846bc92c4da11b}} 
\index{MCMCProcessor@{MCMCProcessor}!ReadOSCFile@{ReadOSCFile}}
\index{ReadOSCFile@{ReadOSCFile}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{ReadOSCFile()}{ReadOSCFile()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Read\+OSCFile (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Read the Osc cov file and get the input central values and errors. 

\begin{DoxyRefDesc}{Todo}
\item[\mbox{\hyperlink{todo__todo000010}{Todo}}]we should actually calculate central value and prior error but leave it for now... \end{DoxyRefDesc}


Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l02625}{2625}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02625\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02626\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{02627\ }
\DoxyCodeLine{02628\ \ \ YAML::Node\ OscFile\ =\ \mbox{\hyperlink{classMCMCProcessor_a4c1330a025c0b91e382bdc29c960424a}{CovConfig}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}];;}
\DoxyCodeLine{02629\ }
\DoxyCodeLine{02630\ \ \ \textcolor{keyword}{auto}\ systematics\ =\ OscFile[\textcolor{stringliteral}{"{}Systematics"{}}];}
\DoxyCodeLine{02631\ \ \ \textcolor{keywordtype}{int}\ i\ =\ 0;}
\DoxyCodeLine{02632\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ it\ =\ systematics.begin();\ it\ !=\ systematics.end();\ ++it,\ ++i)}
\DoxyCodeLine{02633\ \ \ \{}
\DoxyCodeLine{02634\ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}\ \&param\ =\ *it;}
\DoxyCodeLine{02635\ }
\DoxyCodeLine{02636\ \ \ \ \ \textcolor{comment}{//\ Push\ back\ the\ name}}
\DoxyCodeLine{02637\ \ \ \ \ std::string\ TempString\ =\ (param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}Names"{}}][\textcolor{stringliteral}{"{}FancyName"{}}].as<std::string>());}
\DoxyCodeLine{02638\ }
\DoxyCodeLine{02639\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_adecc55689f7d37b9412f8886fe3480dc}{ParamNames}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}].push\_back(TempString);}
\DoxyCodeLine{02640\ }
\DoxyCodeLine{02641\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a3a6614826ae320e462211e38e96d9d02}{ParamCentral}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}].push\_back(\ param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}ParameterValues"{}}][\textcolor{stringliteral}{"{}PreFitValue"{}}].as<double>()\ );}
\DoxyCodeLine{02642\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4c4c6aa4827a2fe54ce37defbb3d0475}{ParamNom}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}].push\_back(\ param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}ParameterValues"{}}][\textcolor{stringliteral}{"{}Generated"{}}].as<double>()\ );}
\DoxyCodeLine{02643\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a3a97e3cb4be3ceb9eb721eac51d82d60}{ParamErrors}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}].push\_back(\ param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}Error"{}}].as<double>()\ );}
\DoxyCodeLine{02644\ }
\DoxyCodeLine{02645\ \ \ \ \ \textcolor{keywordtype}{bool}\ flat\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02646\ \ \ \ \ \textcolor{keywordflow}{if}\ (param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}FlatPrior"{}}])\ \{\ flat\ =\ param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}FlatPrior"{}}].as<\textcolor{keywordtype}{bool}>();\ \}}
\DoxyCodeLine{02647\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4be1eedb743e4ea410009a4fa45720f7}{ParamFlat}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}].push\_back(\ flat\ );}
\DoxyCodeLine{02648\ \ \ \}}
\DoxyCodeLine{02649\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_af1392c6cff68e9f0a27e2c9a4e52cf4c}{PlotJarlskog}})}
\DoxyCodeLine{02650\ \ \ \{}
\DoxyCodeLine{02651\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetAlias(\textcolor{stringliteral}{"{}J\_cp"{}},\ \textcolor{stringliteral}{"{}TMath::Sqrt(sin2th\_13)*TMath::Sqrt(1.-\/sin2th\_13)*TMath::Sqrt(1.-\/sin2th\_13)*TMath::Sqrt(sin2th\_12)*TMath::Sqrt(1.-\/sin2th\_12)*TMath::Sqrt(sin2th\_23)*TMath::Sqrt(1.-\/sin2th\_23)*TMath::Sin(delta\_cp)"{}});}
\DoxyCodeLine{02652\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}.push\_back(\textcolor{stringliteral}{"{}J\_cp"{}});}
\DoxyCodeLine{02653\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}.push\_back(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}});}
\DoxyCodeLine{02654\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}]++;}
\DoxyCodeLine{02655\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}++;}
\DoxyCodeLine{02656\ }
\DoxyCodeLine{02658\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4c4c6aa4827a2fe54ce37defbb3d0475}{ParamNom}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}].push\_back(\ 0.\ );}
\DoxyCodeLine{02659\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a3a6614826ae320e462211e38e96d9d02}{ParamCentral}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}].push\_back(\ 0.\ );}
\DoxyCodeLine{02660\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a3a97e3cb4be3ceb9eb721eac51d82d60}{ParamErrors}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}].push\_back(\ 1.\ );}
\DoxyCodeLine{02661\ \ \ \ \ \textcolor{comment}{//\ Push\ back\ the\ name}}
\DoxyCodeLine{02662\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_adecc55689f7d37b9412f8886fe3480dc}{ParamNames}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}].push\_back(\textcolor{stringliteral}{"{}J\_cp"{}});}
\DoxyCodeLine{02663\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4be1eedb743e4ea410009a4fa45720f7}{ParamFlat}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}].push\_back(\ \textcolor{keyword}{false}\ );}
\DoxyCodeLine{02664\ \ \ \}}
\DoxyCodeLine{02665\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a2b0b4afbf45adb93357abe96d108170b}\label{classMCMCProcessor_a2b0b4afbf45adb93357abe96d108170b}} 
\index{MCMCProcessor@{MCMCProcessor}!ReadXSecFile@{ReadXSecFile}}
\index{ReadXSecFile@{ReadXSecFile}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{ReadXSecFile()}{ReadXSecFile()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Read\+XSec\+File (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Read the xsec file and get the input central values and errors. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l02501}{2501}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02501\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02502\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{02503\ \ \ YAML::Node\ XSecFile\ =\ \mbox{\hyperlink{classMCMCProcessor_a4c1330a025c0b91e382bdc29c960424a}{CovConfig}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}];}
\DoxyCodeLine{02504\ }
\DoxyCodeLine{02505\ \ \ \textcolor{keyword}{auto}\ systematics\ =\ XSecFile[\textcolor{stringliteral}{"{}Systematics"{}}];}
\DoxyCodeLine{02506\ \ \ \textcolor{keywordtype}{int}\ i\ =\ 0;}
\DoxyCodeLine{02507\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ it\ =\ systematics.begin();\ it\ !=\ systematics.end();\ ++it,\ ++i)}
\DoxyCodeLine{02508\ \ \ \{}
\DoxyCodeLine{02509\ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}\ \&param\ =\ *it;}
\DoxyCodeLine{02510\ }
\DoxyCodeLine{02511\ \ \ \ \ \textcolor{comment}{//\ Push\ back\ the\ name}}
\DoxyCodeLine{02512\ \ \ \ \ std::string\ TempString\ =\ (param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}Names"{}}][\textcolor{stringliteral}{"{}FancyName"{}}].as<std::string>());}
\DoxyCodeLine{02513\ }
\DoxyCodeLine{02514\ \ \ \ \ \textcolor{comment}{//KS:Reject\ particular\ parameter\ names,\ noticed\ that\ sometimes\ string\ comparison\ doesn't\ work\ becasue\ of\ some\ weird\ casting\ of\ TObjString\ into\ std::string.\ This\ is\ rare\ and\ sooner\ or\ later\ we\ move\ away\ from\ TObjString\ so\ this\ is\ fine}}
\DoxyCodeLine{02515\ \ \ \ \ \textcolor{keywordtype}{bool}\ rejected\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02516\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ik\ =\ 0;\ ik\ <\ \mbox{\hyperlink{classMCMCProcessor_a7425f7802e50bcb5ff4b38e20157c423}{ExcludedNames}}.size();\ ++ik)}
\DoxyCodeLine{02517\ \ \ \ \ \{}
\DoxyCodeLine{02518\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (TempString.rfind(\mbox{\hyperlink{classMCMCProcessor_a7425f7802e50bcb5ff4b38e20157c423}{ExcludedNames}}.at(ik),\ 0)\ ==\ 0)}
\DoxyCodeLine{02519\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02520\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ Tracker\ =\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]\ +\ i;}
\DoxyCodeLine{02521\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[Tracker]\ =\ \textcolor{stringliteral}{"{}delete"{}};}
\DoxyCodeLine{02522\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]-\/-\/;}
\DoxyCodeLine{02523\ \ \ \ \ \ \ \ \ rejected\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02524\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02525\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02526\ \ \ \ \ \}}
\DoxyCodeLine{02527\ \ \ \ \ \textcolor{keywordflow}{if}(rejected)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02528\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_adecc55689f7d37b9412f8886fe3480dc}{ParamNames}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}].push\_back(TempString);}
\DoxyCodeLine{02529\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_adecc55689f7d37b9412f8886fe3480dc}{ParamNames}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}][i].BeginsWith(\textcolor{stringliteral}{"{}b\_"{}}))}
\DoxyCodeLine{02530\ \ \ \ \ \{}
\DoxyCodeLine{02531\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a2c06d64020e9246e720cc131a9f4986d}{IsXsec}}.push\_back(\textcolor{keyword}{false});}
\DoxyCodeLine{02532\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}}++;}
\DoxyCodeLine{02533\ \ \ \ \ \}\ }
\DoxyCodeLine{02534\ \ \ \ \ \textcolor{keywordflow}{else}\ \mbox{\hyperlink{classMCMCProcessor_a2c06d64020e9246e720cc131a9f4986d}{IsXsec}}.push\_back(\textcolor{keyword}{true});\ \ }
\DoxyCodeLine{02535\ \ \ \ \ }
\DoxyCodeLine{02536\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a3a6614826ae320e462211e38e96d9d02}{ParamCentral}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}].push\_back(\ param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}ParameterValues"{}}][\textcolor{stringliteral}{"{}PreFitValue"{}}].as<double>()\ );}
\DoxyCodeLine{02537\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4c4c6aa4827a2fe54ce37defbb3d0475}{ParamNom}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}].push\_back(\ param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}ParameterValues"{}}][\textcolor{stringliteral}{"{}Generated"{}}].as<double>()\ );}
\DoxyCodeLine{02538\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a3a97e3cb4be3ceb9eb721eac51d82d60}{ParamErrors}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}].push\_back(\ param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}Error"{}}].as<double>()\ );}
\DoxyCodeLine{02539\ }
\DoxyCodeLine{02540\ \ \ \ \ \textcolor{keywordtype}{bool}\ flat\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02541\ \ \ \ \ \textcolor{keywordflow}{if}\ (param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}FlatPrior"{}}])\ \{\ flat\ =\ param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}FlatPrior"{}}].as<\textcolor{keywordtype}{bool}>();\ \}}
\DoxyCodeLine{02542\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4be1eedb743e4ea410009a4fa45720f7}{ParamFlat}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}].push\_back(\ flat\ );}
\DoxyCodeLine{02543\ \ \ \}}
\DoxyCodeLine{02544\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a9a29c1cb64589ac136f7f927cafa18aa}\label{classMCMCProcessor_a9a29c1cb64589ac136f7f927cafa18aa}} 
\index{MCMCProcessor@{MCMCProcessor}!RemoveParameters@{RemoveParameters}}
\index{RemoveParameters@{RemoveParameters}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{RemoveParameters()}{RemoveParameters()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Remove\+Parameters (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Remove parameter specified in config. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l02669}{2669}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02669\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02670\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{02671\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ i++)}
\DoxyCodeLine{02672\ \ \ \{}
\DoxyCodeLine{02673\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[i]\ ==\ \textcolor{stringliteral}{"{}delete"{}})}
\DoxyCodeLine{02674\ \ \ \ \ \{}
\DoxyCodeLine{02675\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}.erase(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}.begin()\ +\ i);}
\DoxyCodeLine{02676\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}.erase(\mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}.begin()\ +\ i);}
\DoxyCodeLine{02677\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}-\/-\/;}
\DoxyCodeLine{02678\ \ \ \ \ \ \ i\ =\ 0;}
\DoxyCodeLine{02679\ \ \ \ \ \}}
\DoxyCodeLine{02680\ \ \ \}}
\DoxyCodeLine{02681\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a36441ec3d5b0e24e48040282ffcda3eb}\label{classMCMCProcessor_a36441ec3d5b0e24e48040282ffcda3eb}} 
\index{MCMCProcessor@{MCMCProcessor}!ResetHistograms@{ResetHistograms}}
\index{ResetHistograms@{ResetHistograms}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{ResetHistograms()}{ResetHistograms()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Reset\+Histograms (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Reset 2D posteriors, in case we would like to calculate in again with different Burn\+In\+Cut. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l02739}{2739}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02739\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02740\ \textcolor{comment}{//\ **************************************************}}
\DoxyCodeLine{02741\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{02742\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{02743\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{02744\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)\ }
\DoxyCodeLine{02745\ \ \ \{}
\DoxyCodeLine{02746\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ ++j)}
\DoxyCodeLine{02747\ \ \ \ \ \{}
\DoxyCodeLine{02748\ \ \ \ \ \ \ \textcolor{comment}{//\ TH2D\ to\ hold\ the\ Correlation\ }}
\DoxyCodeLine{02749\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>Reset(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{02750\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}{hpost2D}}[i][j]-\/>Fill(0.0,\ 0.0,\ 0.0);}
\DoxyCodeLine{02751\ \ \ \ \ \}}
\DoxyCodeLine{02752\ \ \ \}}
\DoxyCodeLine{02753\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_ad3b1cfab21c7063bc29d1cf5dcca888c}\label{classMCMCProcessor_ad3b1cfab21c7063bc29d1cf5dcca888c}} 
\index{MCMCProcessor@{MCMCProcessor}!ReweightPrior@{ReweightPrior}}
\index{ReweightPrior@{ReweightPrior}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{ReweightPrior()}{ReweightPrior()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Reweight\+Prior (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ std\+::string $>$ \&}]{Names,  }\item[{const std\+::vector$<$ double $>$ \&}]{New\+Central,  }\item[{const std\+::vector$<$ double $>$ \&}]{New\+Error }\end{DoxyParamCaption})}



Reweight Prior by giving new central value and new error. 


\begin{DoxyParams}{Parameters}
{\em Par\+Name} & Parameter names for which we do reweighting \\
\hline
{\em New\+Central} & New central value for which we reweight \\
\hline
{\em New\+Error} & New error used for calculating weight \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l03039}{3039}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{03041\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03042\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{03043\ }
\DoxyCodeLine{03044\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Reweighting\ Prior"{}});}
\DoxyCodeLine{03045\ }
\DoxyCodeLine{03046\ \ \ \textcolor{keywordflow}{if}(\ (Names.size()\ !=\ NewCentral.size())\ ||\ (NewCentral.size()\ !=\ NewError.size()))}
\DoxyCodeLine{03047\ \ \ \{}
\DoxyCodeLine{03048\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Size\ of\ passed\ vectors\ doesn't\ match\ in\ ReweightPrior"{}});}
\DoxyCodeLine{03049\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{03050\ \ \ \}}
\DoxyCodeLine{03051\ \ \ std::vector<int>\ Param;}
\DoxyCodeLine{03052\ \ \ std::vector<double>\ OldCentral;}
\DoxyCodeLine{03053\ \ \ std::vector<double>\ OldError;}
\DoxyCodeLine{03054\ \ \ std::vector<bool>\ FlatPrior;}
\DoxyCodeLine{03055\ }
\DoxyCodeLine{03056\ \ \ \textcolor{comment}{//KS:\ First\ we\ need\ to\ find\ parameter\ number\ based\ on\ name}}
\DoxyCodeLine{03057\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ Names.size();\ ++k)}
\DoxyCodeLine{03058\ \ \ \{}
\DoxyCodeLine{03059\ \ \ \ \ \textcolor{comment}{//KS:\ First\ we\ need\ to\ find\ parameter\ number\ based\ on\ name}}
\DoxyCodeLine{03060\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamNo\ =\ \mbox{\hyperlink{classMCMCProcessor_a5ab91183fbbf23fff759fefc9954a1a5}{GetParamIndexFromName}}(Names[k]);}
\DoxyCodeLine{03061\ \ \ \ \ \textcolor{keywordflow}{if}(ParamNo\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}})}
\DoxyCodeLine{03062\ \ \ \ \ \{}
\DoxyCodeLine{03063\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Couldn't\ find\ param\ \{\}.\ Can't\ reweight\ Prior"{}},\ Names[k]);}
\DoxyCodeLine{03064\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{03065\ \ \ \ \ \}}
\DoxyCodeLine{03066\ }
\DoxyCodeLine{03067\ \ \ \ \ TString\ Title\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{03068\ \ \ \ \ \textcolor{keywordtype}{double}\ Prior\ =\ 1.0;}
\DoxyCodeLine{03069\ \ \ \ \ \textcolor{keywordtype}{double}\ PriorError\ =\ 1.0;}
\DoxyCodeLine{03070\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a28dfe42f1bf6fd3a145287be1e63fb0b}{GetNthParameter}}(ParamNo,\ Prior,\ PriorError,\ Title);}
\DoxyCodeLine{03071\ }
\DoxyCodeLine{03072\ \ \ \ \ Param.push\_back(ParamNo);}
\DoxyCodeLine{03073\ \ \ \ \ OldCentral.push\_back(Prior);}
\DoxyCodeLine{03074\ \ \ \ \ OldError.push\_back(PriorError);}
\DoxyCodeLine{03075\ }
\DoxyCodeLine{03076\ \ \ \ \ \mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20b}{ParameterEnum}}\ ParType\ =\ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}[ParamNo];}
\DoxyCodeLine{03077\ \ \ \ \ \textcolor{keywordtype}{int}\ ParamTemp\ =\ ParamNo\ -\/\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[ParType];}
\DoxyCodeLine{03078\ }
\DoxyCodeLine{03079\ \ \ \ \ FlatPrior.push\_back(\mbox{\hyperlink{classMCMCProcessor_a4be1eedb743e4ea410009a4fa45720f7}{ParamFlat}}[ParType][ParamTemp]);}
\DoxyCodeLine{03080\ \ \ \}}
\DoxyCodeLine{03081\ \ \ std::vector<double>\ ParameterPos(Names.size());}
\DoxyCodeLine{03082\ }
\DoxyCodeLine{03083\ \ \ std::string\ InputFile\ =\ \mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}}+\textcolor{stringliteral}{"{}.root"{}};}
\DoxyCodeLine{03084\ \ \ std::string\ OutputFilename\ =\ \mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}}\ +\ \textcolor{stringliteral}{"{}\_reweighted.root"{}};}
\DoxyCodeLine{03085\ }
\DoxyCodeLine{03086\ \ \ \textcolor{comment}{//KS:\ Simply\ create\ copy\ of\ file\ and\ add\ there\ new\ branch}}
\DoxyCodeLine{03087\ \ \ \textcolor{keywordtype}{int}\ ret\ =\ system((\textcolor{stringliteral}{"{}cp\ "{}}\ +\ InputFile\ +\ \textcolor{stringliteral}{"{}\ "{}}\ +\ OutputFilename).c\_str());}
\DoxyCodeLine{03088\ \ \ \textcolor{keywordflow}{if}\ (ret\ !=\ 0)}
\DoxyCodeLine{03089\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Error:\ system\ call\ to\ copy\ file\ failed\ with\ code\ \{\}"{}},\ ret);}
\DoxyCodeLine{03090\ }
\DoxyCodeLine{03091\ \ \ TFile\ *OutputChain\ =\ \textcolor{keyword}{new}\ TFile(OutputFilename.c\_str(),\ \textcolor{stringliteral}{"{}UPDATE"{}});}
\DoxyCodeLine{03092\ \ \ OutputChain-\/>cd();}
\DoxyCodeLine{03093\ \ \ TTree\ *post\ =\ OutputChain-\/>Get<TTree>(\textcolor{stringliteral}{"{}posteriors"{}});}
\DoxyCodeLine{03094\ }
\DoxyCodeLine{03095\ \ \ \textcolor{keywordtype}{double}\ Weight\ =\ 1.;}
\DoxyCodeLine{03096\ }
\DoxyCodeLine{03097\ \ \ post-\/>SetBranchStatus(\textcolor{stringliteral}{"{}*"{}},\textcolor{keyword}{false});}
\DoxyCodeLine{03098\ \ \ \textcolor{comment}{//\ Set\ the\ branch\ addresses\ for\ params}}
\DoxyCodeLine{03099\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ Names.size();\ ++j)\ \{}
\DoxyCodeLine{03100\ \ \ \ \ post-\/>SetBranchStatus(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[Param[j]].Data(),\ \textcolor{keyword}{true});}
\DoxyCodeLine{03101\ \ \ \ \ post-\/>SetBranchAddress(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}[Param[j]].Data(),\ \&ParameterPos[j]);}
\DoxyCodeLine{03102\ \ \ \}}
\DoxyCodeLine{03103\ \ \ TBranch\ *bpt\ =\ post-\/>Branch(\textcolor{stringliteral}{"{}Weight"{}},\ \&Weight,\ \textcolor{stringliteral}{"{}Weight/D"{}});}
\DoxyCodeLine{03104\ \ \ post-\/>SetBranchStatus(\textcolor{stringliteral}{"{}Weight"{}},\ \textcolor{keyword}{true});}
\DoxyCodeLine{03105\ }
\DoxyCodeLine{03106\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}};\ ++i)}
\DoxyCodeLine{03107\ \ \ \{}
\DoxyCodeLine{03108\ \ \ \ \ post-\/>GetEntry(i);}
\DoxyCodeLine{03109\ \ \ \ \ Weight\ =\ 1.;}
\DoxyCodeLine{03110\ }
\DoxyCodeLine{03111\ \ \ \ \ \textcolor{comment}{//KS:\ Calculate\ reweight\ weight.\ Weights\ are\ multiplicative\ so\ we\ can\ do\ several\ reweights\ at\ once.\ FIXME\ Big\ limitation\ is\ that\ code\ only\ works\ for\ uncorrelated\ parameters\ :(}}
\DoxyCodeLine{03112\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ Names.size();\ ++j)}
\DoxyCodeLine{03113\ \ \ \ \ \{}
\DoxyCodeLine{03114\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ new\_chi\ =\ (ParameterPos[j]\ -\/\ NewCentral[j])/NewError[j];}
\DoxyCodeLine{03115\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ new\_prior\ =\ std::exp(-\/0.5\ *\ new\_chi\ *\ new\_chi);}
\DoxyCodeLine{03116\ }
\DoxyCodeLine{03117\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ old\_chi\ =\ -\/1;}
\DoxyCodeLine{03118\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ old\_prior\ =\ -\/1;}
\DoxyCodeLine{03119\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(FlatPrior[j])}
\DoxyCodeLine{03120\ \ \ \ \ \ \ \{}
\DoxyCodeLine{03121\ \ \ \ \ \ \ \ \ old\_prior\ =\ 1.0;}
\DoxyCodeLine{03122\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03123\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{03124\ \ \ \ \ \ \ \{}
\DoxyCodeLine{03125\ \ \ \ \ \ \ \ \ old\_chi\ =\ (ParameterPos[j]\ -\/\ OldCentral[j])/OldError[j];}
\DoxyCodeLine{03126\ \ \ \ \ \ \ \ \ old\_prior\ =\ std::exp(-\/0.5\ *\ old\_chi\ *\ old\_chi);}
\DoxyCodeLine{03127\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03128\ \ \ \ \ \ \ Weight\ *=\ new\_prior/old\_prior;}
\DoxyCodeLine{03129\ \ \ \ \ \}}
\DoxyCodeLine{03130\ \ \ \ \ bpt-\/>Fill();}
\DoxyCodeLine{03131\ \ \ \}}
\DoxyCodeLine{03132\ \ \ post-\/>SetBranchStatus(\textcolor{stringliteral}{"{}*"{}},\textcolor{keyword}{true});}
\DoxyCodeLine{03133\ \ \ OutputChain-\/>cd();}
\DoxyCodeLine{03134\ \ \ post-\/>Write(\textcolor{stringliteral}{"{}posteriors"{}},\ TObject::kOverwrite);}
\DoxyCodeLine{03135\ \ \ OutputChain-\/>Close();}
\DoxyCodeLine{03136\ \ \ \textcolor{keyword}{delete}\ OutputChain;}
\DoxyCodeLine{03137\ }
\DoxyCodeLine{03138\ \ \ \mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}-\/>cd();}
\DoxyCodeLine{03139\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_aeff2174617268c1e55333529459bffb6}\label{classMCMCProcessor_aeff2174617268c1e55333529459bffb6}} 
\index{MCMCProcessor@{MCMCProcessor}!ScanInput@{ScanInput}}
\index{ScanInput@{ScanInput}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{ScanInput()}{ScanInput()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Scan\+Input (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Scan Input etc. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l02130}{2130}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02131\ \textcolor{comment}{//\ **************************}}
\DoxyCodeLine{02132\ \ \ \textcolor{comment}{//\ KS:\ This\ can\ reduce\ time\ necessary\ for\ caching\ even\ by\ half}}
\DoxyCodeLine{02133\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{02134\ \ \ \textcolor{comment}{//ROOT::EnableImplicitMT();}}
\DoxyCodeLine{02135\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{02136\ }
\DoxyCodeLine{02137\ \ \ \textcolor{comment}{//\ Open\ the\ Chain}}
\DoxyCodeLine{02138\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}\ =\ \textcolor{keyword}{new}\ TChain(\textcolor{stringliteral}{"{}posteriors"{}},\textcolor{stringliteral}{"{}posteriors"{}});}
\DoxyCodeLine{02139\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>Add(\mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}}.c\_str());}
\DoxyCodeLine{02140\ }
\DoxyCodeLine{02141\ \ \ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}\ =\ int(\mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetEntries());}
\DoxyCodeLine{02142\ \ \ }
\DoxyCodeLine{02143\ \ \ \textcolor{comment}{//Only\ is\ suboptimality\ we\ might\ want\ to\ change\ it,\ therefore\ set\ it\ high\ enough\ so\ it\ doesn't\ affect\ other\ functionality}}
\DoxyCodeLine{02144\ \ \ \mbox{\hyperlink{classMCMCProcessor_a840c686f15f419c0156df01c4ed62931}{UpperCut}}\ =\ \mbox{\hyperlink{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}{nEntries}}+1;}
\DoxyCodeLine{02145\ }
\DoxyCodeLine{02146\ \ \ \textcolor{comment}{//\ Get\ the\ list\ of\ branches}}
\DoxyCodeLine{02147\ }
\DoxyCodeLine{02148\ \ \ TObjArray*\ brlis\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetListOfBranches();}
\DoxyCodeLine{02149\ }
\DoxyCodeLine{02150\ \ \ \textcolor{comment}{//\ Get\ the\ number\ of\ branches}}
\DoxyCodeLine{02151\ \ \ \mbox{\hyperlink{classMCMCProcessor_af6ba5d9aec5350fafebbf81309e813cb}{nBranches}}\ =\ brlis-\/>GetEntries();}
\DoxyCodeLine{02152\ }
\DoxyCodeLine{02153\ \ \ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}.reserve(\mbox{\hyperlink{classMCMCProcessor_af6ba5d9aec5350fafebbf81309e813cb}{nBranches}});}
\DoxyCodeLine{02154\ \ \ \mbox{\hyperlink{classMCMCProcessor_a95fa49737432818bc830a44898d0d850}{IamVaried}}.reserve(\mbox{\hyperlink{classMCMCProcessor_af6ba5d9aec5350fafebbf81309e813cb}{nBranches}});}
\DoxyCodeLine{02155\ \ \ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}.reserve(\mbox{\hyperlink{classMCMCProcessor_af6ba5d9aec5350fafebbf81309e813cb}{nBranches}});}
\DoxyCodeLine{02156\ }
\DoxyCodeLine{02157\ \ \ \textcolor{comment}{//\ Set\ all\ the\ branches\ to\ off}}
\DoxyCodeLine{02158\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchStatus(\textcolor{stringliteral}{"{}*"{}},\ \textcolor{keyword}{false});}
\DoxyCodeLine{02159\ }
\DoxyCodeLine{02160\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ number\ of\ branches}}
\DoxyCodeLine{02161\ \ \ \textcolor{comment}{//\ Find\ the\ name\ and\ how\ many\ of\ each\ systematic\ we\ have}}
\DoxyCodeLine{02162\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_af6ba5d9aec5350fafebbf81309e813cb}{nBranches}};\ i++)}
\DoxyCodeLine{02163\ \ \ \{}
\DoxyCodeLine{02164\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ TBranch\ and\ its\ name}}
\DoxyCodeLine{02165\ \ \ \ \ TBranch*\ br\ =\ \textcolor{keyword}{static\_cast<}TBranch*\textcolor{keyword}{>}(brlis-\/>At(i));}
\DoxyCodeLine{02166\ \ \ \ \ \textcolor{keywordflow}{if}(!br)\{}
\DoxyCodeLine{02167\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Invalid\ branch\ at\ position\ \{\}"{}},\ i);}
\DoxyCodeLine{02168\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_,\_\_LINE\_\_);}
\DoxyCodeLine{02169\ \ \ \ \ \}}
\DoxyCodeLine{02170\ \ \ \ \ TString\ bname\ =\ br-\/>GetName();}
\DoxyCodeLine{02171\ }
\DoxyCodeLine{02172\ \ \ \ \ \textcolor{comment}{//KS:\ Exclude\ parameter\ types}}
\DoxyCodeLine{02173\ \ \ \ \ \textcolor{keywordtype}{bool}\ rejected\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02174\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ik\ =\ 0;\ ik\ <\ \mbox{\hyperlink{classMCMCProcessor_aada4aadea10661586b46c1013a9d018f}{ExcludedTypes}}.size();\ ++ik\ )}
\DoxyCodeLine{02175\ \ \ \ \ \{}
\DoxyCodeLine{02176\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(bname.BeginsWith(\mbox{\hyperlink{classMCMCProcessor_aada4aadea10661586b46c1013a9d018f}{ExcludedTypes}}[ik]))}
\DoxyCodeLine{02177\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02178\ \ \ \ \ \ \ \ \ rejected\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02179\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02180\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02181\ \ \ \ \ \}}
\DoxyCodeLine{02182\ \ \ \ \ \textcolor{keywordflow}{if}(rejected)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02183\ }
\DoxyCodeLine{02184\ \ \ \ \ \textcolor{comment}{//\ Turn\ on\ the\ branches\ which\ we\ want\ for\ parameters}}
\DoxyCodeLine{02185\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>SetBranchStatus(bname.Data(),\ \textcolor{keyword}{true});}
\DoxyCodeLine{02186\ }
\DoxyCodeLine{02187\ \ \ \ \ \textcolor{comment}{//\ If\ we're\ on\ beam\ systematics}}
\DoxyCodeLine{02188\ \ \ \ \ \textcolor{keywordflow}{if}(bname.BeginsWith(\textcolor{stringliteral}{"{}xsec\_"{}}))\ }
\DoxyCodeLine{02189\ \ \ \ \ \{}
\DoxyCodeLine{02190\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}.push\_back(bname);}
\DoxyCodeLine{02191\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}.push\_back(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}});}
\DoxyCodeLine{02192\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]++;}
\DoxyCodeLine{02193\ \ \ \ \ \}}
\DoxyCodeLine{02194\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (bname.BeginsWith(\textcolor{stringliteral}{"{}ndd\_"{}}))}
\DoxyCodeLine{02195\ \ \ \ \ \{}
\DoxyCodeLine{02196\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}.push\_back(bname);}
\DoxyCodeLine{02197\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}.push\_back(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}});}
\DoxyCodeLine{02198\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}]++;}
\DoxyCodeLine{02199\ \ \ \ \ \}}
\DoxyCodeLine{02200\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (bname.BeginsWith(\textcolor{stringliteral}{"{}skd\_joint\_"{}}))}
\DoxyCodeLine{02201\ \ \ \ \ \{}
\DoxyCodeLine{02202\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}.push\_back(bname);}
\DoxyCodeLine{02203\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}.push\_back(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}});}
\DoxyCodeLine{02204\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}]++;}
\DoxyCodeLine{02205\ \ \ \ \ \}}
\DoxyCodeLine{02206\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (bname.BeginsWith(\textcolor{stringliteral}{"{}sin2th\_"{}})\ \ ||}
\DoxyCodeLine{02207\ \ \ \ \ \ \ \ \ \ \ \ \ \ bname.BeginsWith(\textcolor{stringliteral}{"{}delm2\_"{}})\ \ \ ||}
\DoxyCodeLine{02208\ \ \ \ \ \ \ \ \ \ \ \ \ \ bname.BeginsWith(\textcolor{stringliteral}{"{}delta\_"{}})\ \ \ ||}
\DoxyCodeLine{02209\ \ \ \ \ \ \ \ \ \ \ \ \ \ bname.BeginsWith(\textcolor{stringliteral}{"{}baseline"{}})\ ||}
\DoxyCodeLine{02210\ \ \ \ \ \ \ \ \ \ \ \ \ \ bname.BeginsWith(\textcolor{stringliteral}{"{}density"{}})\ \ \ )}
\DoxyCodeLine{02211\ \ \ \ \ \{}
\DoxyCodeLine{02212\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}.push\_back(bname);}
\DoxyCodeLine{02213\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}.push\_back(\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}});}
\DoxyCodeLine{02214\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}]++;}
\DoxyCodeLine{02215\ \ \ \ \ \}}
\DoxyCodeLine{02216\ }
\DoxyCodeLine{02217\ \ \ \ \ \textcolor{comment}{//KS:\ as\ a\ bonus\ get\ LogL\ systematic}}
\DoxyCodeLine{02218\ \ \ \ \ \textcolor{keywordflow}{if}\ (bname.BeginsWith(\textcolor{stringliteral}{"{}LogL\_sample\_"{}}))\ \{}
\DoxyCodeLine{02219\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a3660e404a6631cfa913a815481730a9b}{SampleName\_v}}.push\_back(bname);}
\DoxyCodeLine{02220\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_a419d3669dbb54a55a635e35691134cc1}{nSamples}}++;}
\DoxyCodeLine{02221\ \ \ \ \ \}}
\DoxyCodeLine{02222\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (bname.BeginsWith(\textcolor{stringliteral}{"{}LogL\_systematic\_"{}}))\ \{}
\DoxyCodeLine{02223\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_acb1871575fdd3ae156aed4bf7c7a0a73}{SystName\_v}}.push\_back(bname);}
\DoxyCodeLine{02224\ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_adf518be96278f1d3901404cfbe767b67}{nSysts}}++;}
\DoxyCodeLine{02225\ \ \ \ \ \}}
\DoxyCodeLine{02226\ \ \ \}}
\DoxyCodeLine{02227\ \ \ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}\ =\ int(\mbox{\hyperlink{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}{BranchNames}}.size());}
\DoxyCodeLine{02228\ \ \ \textcolor{comment}{//\ Read\ the\ input\ Covariances}}
\DoxyCodeLine{02229\ \ \ \mbox{\hyperlink{classMCMCProcessor_afef48d4fccf7551dc1845f8f6c08864f}{ReadInputCov}}();}
\DoxyCodeLine{02230\ \ \ }
\DoxyCodeLine{02231\ \ \ \textcolor{comment}{//\ Check\ order\ of\ parameter\ types}}
\DoxyCodeLine{02232\ \ \ \mbox{\hyperlink{classMCMCProcessor_a015cf0d6925d026e5bd9d82aa31083b6}{ScanParameterOrder}}();}
\DoxyCodeLine{02233\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}************************************************"{}});}
\DoxyCodeLine{02234\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Scanning\ output\ branches..."{}});}
\DoxyCodeLine{02235\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\#\ useful\ entries\ in\ tree:\ \(\backslash\)033[1;32m\ \{\}\ \(\backslash\)033[0m\ "{}},\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{02236\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\#\ XSec\ params:\ \ \(\backslash\)033[1;32m\ \{\}\ starting\ at\ \{\}\ \(\backslash\)033[0m\ "{}},\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]\ -\/\ \mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}},\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f}{kXSecPar}}]);}
\DoxyCodeLine{02237\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\#\ Flux\ params:\ \ \ \{\}"{}},\ \mbox{\hyperlink{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}{nFlux}});}
\DoxyCodeLine{02238\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\#\ ND\ params:\ \ \ \ \(\backslash\)033[1;32m\ \{\}\ starting\ at\ \{\}\ \(\backslash\)033[0m\ "{}},\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}],\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4}{kNDPar}}]);}
\DoxyCodeLine{02239\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\#\ FD\ params:\ \ \ \ \(\backslash\)033[1;32m\ \{\}\ starting\ at\ \{\}\ \(\backslash\)033[0m\ "{}},\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}],\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae}{kFDDetPar}}]);}
\DoxyCodeLine{02240\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\#\ Osc\ params:\ \ \ \(\backslash\)033[1;32m\ \{\}\ starting\ at\ \{\}\ \(\backslash\)033[0m\ "{}},\ \mbox{\hyperlink{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}{nParam}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}],\ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06}{kOSCPar}}]);}
\DoxyCodeLine{02241\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}************************************************"{}});}
\DoxyCodeLine{02242\ }
\DoxyCodeLine{02243\ \ \ \mbox{\hyperlink{classMCMCProcessor_aae0016a4e1d105d5d65243438c622a97}{nSteps}}\ =\ \mbox{\hyperlink{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}{Chain}}-\/>GetMaximum(\textcolor{stringliteral}{"{}step"{}});}
\DoxyCodeLine{02244\ \ \ \textcolor{comment}{//\ Set\ the\ step\ cut\ to\ be\ 20\%}}
\DoxyCodeLine{02245\ \ \ \textcolor{keywordtype}{int}\ cut\ =\ \mbox{\hyperlink{classMCMCProcessor_aae0016a4e1d105d5d65243438c622a97}{nSteps}}/5;}
\DoxyCodeLine{02246\ \ \ \mbox{\hyperlink{classMCMCProcessor_ad610d8e835031872b428e759ef4045f1}{SetStepCut}}(cut);}
\DoxyCodeLine{02247\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a015cf0d6925d026e5bd9d82aa31083b6}\label{classMCMCProcessor_a015cf0d6925d026e5bd9d82aa31083b6}} 
\index{MCMCProcessor@{MCMCProcessor}!ScanParameterOrder@{ScanParameterOrder}}
\index{ScanParameterOrder@{ScanParameterOrder}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{ScanParameterOrder()}{ScanParameterOrder()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Scan\+Parameter\+Order (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Scan order of params from a different groups. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l02308}{2308}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02309\ \textcolor{comment}{//\ *****************************}}
\DoxyCodeLine{02310\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a}{kNParameterEnum}};\ i++)}
\DoxyCodeLine{02311\ \ \ \{}
\DoxyCodeLine{02312\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}.size();\ j++)}
\DoxyCodeLine{02313\ \ \ \ \ \{}
\DoxyCodeLine{02314\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}{ParamType}}[j]\ ==\ \mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20b}{ParameterEnum}}(i))\ }
\DoxyCodeLine{02315\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02316\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ When\ we\ find\ that\ i-\/th\ parameter\ types\ start\ at\ j,\ save\ and\ move\ to\ the\ next\ parameter.}}
\DoxyCodeLine{02317\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor_aeab63979ff36256072c046a15d981875}{ParamTypeStartPos}}[i]\ =\ j;}
\DoxyCodeLine{02318\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02319\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02320\ \ \ \ \ \}}
\DoxyCodeLine{02321\ \ \ \}}
\DoxyCodeLine{02322\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a09a6fa6cefcb20c00bee22c1dc5718c5}\label{classMCMCProcessor_a09a6fa6cefcb20c00bee22c1dc5718c5}} 
\index{MCMCProcessor@{MCMCProcessor}!SetExcludedNames@{SetExcludedNames}}
\index{SetExcludedNames@{SetExcludedNames}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{SetExcludedNames()}{SetExcludedNames()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Set\+Excluded\+Names (\begin{DoxyParamCaption}\item[{std\+::vector$<$ std\+::string $>$}]{Name }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00236}{236}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00236\ \{\mbox{\hyperlink{classMCMCProcessor_a7425f7802e50bcb5ff4b38e20157c423}{ExcludedNames}}\ =\ Name;\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a4364a8ab084906c8925c9db9dc110485}\label{classMCMCProcessor_a4364a8ab084906c8925c9db9dc110485}} 
\index{MCMCProcessor@{MCMCProcessor}!SetExcludedTypes@{SetExcludedTypes}}
\index{SetExcludedTypes@{SetExcludedTypes}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{SetExcludedTypes()}{SetExcludedTypes()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Set\+Excluded\+Types (\begin{DoxyParamCaption}\item[{std\+::vector$<$ std\+::string $>$}]{Name }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Setter related what parameters we want to exclude from analysis, for example if cross-\/section parameters look like xsec\+\_\+, then passing \char`\"{}xsec\+\_\+\char`\"{} will. 


\begin{DoxyParams}{Parameters}
{\em Batches} & Vector with parameters type names we want to exclude \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00235}{235}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00235\ \{\mbox{\hyperlink{classMCMCProcessor_aada4aadea10661586b46c1013a9d018f}{ExcludedTypes}}\ =\ Name;\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a7f61cf0a51670f24f16dd7d77b7f5ae4}\label{classMCMCProcessor_a7f61cf0a51670f24f16dd7d77b7f5ae4}} 
\index{MCMCProcessor@{MCMCProcessor}!SetFancyNames@{SetFancyNames}}
\index{SetFancyNames@{SetFancyNames}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{SetFancyNames()}{SetFancyNames()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Set\+Fancy\+Names (\begin{DoxyParamCaption}\item[{const bool}]{Plot\+Or\+Not }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00226}{226}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00226\ \{\mbox{\hyperlink{classMCMCProcessor_ad25fe818c94163b0c4a8fcdfd387c148}{FancyPlotNames}}\ =\ PlotOrNot;\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a5b13f1879f84d13b7d139432a9b993c6}\label{classMCMCProcessor_a5b13f1879f84d13b7d139432a9b993c6}} 
\index{MCMCProcessor@{MCMCProcessor}!SetnBatches@{SetnBatches}}
\index{SetnBatches@{SetnBatches}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{SetnBatches()}{SetnBatches()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Setn\+Batches (\begin{DoxyParamCaption}\item[{const int}]{Batches }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Set value of Nbatches used for batched mean, this need to be done earlier as batches are made when reading tree. 


\begin{DoxyParams}{Parameters}
{\em Batches} & Number of batches, default is 20 \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00240}{240}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00240\ \{\mbox{\hyperlink{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}{nBatches}}\ =\ Batches;\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a173d37d528ff201e66db8f92c156e3bb}\label{classMCMCProcessor_a173d37d528ff201e66db8f92c156e3bb}} 
\index{MCMCProcessor@{MCMCProcessor}!SetnLags@{SetnLags}}
\index{SetnLags@{SetnLags}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{SetnLags()}{SetnLags()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Setn\+Lags (\begin{DoxyParamCaption}\item[{const int}]{n\+Lags }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00241}{241}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00241\ \{\mbox{\hyperlink{classMCMCProcessor_a6156bba72e1f076e66f0356e48506a36}{AutoCorrLag}}\ =\ nLags;\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a2f4bf14c95b830c457a73be5399403ad}\label{classMCMCProcessor_a2f4bf14c95b830c457a73be5399403ad}} 
\index{MCMCProcessor@{MCMCProcessor}!SetOutputSuffix@{SetOutputSuffix}}
\index{SetOutputSuffix@{SetOutputSuffix}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{SetOutputSuffix()}{SetOutputSuffix()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Set\+Output\+Suffix (\begin{DoxyParamCaption}\item[{const std\+::string}]{Suffix }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Sett output suffix, this way jobs using the same file will have different names. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00244}{244}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00244\ \{\mbox{\hyperlink{classMCMCProcessor_aa34b50ce33fb2cb7d9e9ef2d9f2f67c1}{OutputSuffix}}\ =\ Suffix;\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_aed120fafdfe97615f4c2a30aedde03dd}\label{classMCMCProcessor_aed120fafdfe97615f4c2a30aedde03dd}} 
\index{MCMCProcessor@{MCMCProcessor}!SetPlotBinValue@{SetPlotBinValue}}
\index{SetPlotBinValue@{SetPlotBinValue}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{SetPlotBinValue()}{SetPlotBinValue()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Set\+Plot\+Bin\+Value (\begin{DoxyParamCaption}\item[{const bool}]{Plot\+Or\+Not }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00225}{225}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00225\ \{\mbox{\hyperlink{classMCMCProcessor_aa7611f55ac3c0ea70607761d037fbd91}{plotBinValue}}\ =\ PlotOrNot;\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_adbe0ec06ce30447cb1c03a961364b929}\label{classMCMCProcessor_adbe0ec06ce30447cb1c03a961364b929}} 
\index{MCMCProcessor@{MCMCProcessor}!SetPlotErrorForFlatPrior@{SetPlotErrorForFlatPrior}}
\index{SetPlotErrorForFlatPrior@{SetPlotErrorForFlatPrior}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{SetPlotErrorForFlatPrior()}{SetPlotErrorForFlatPrior()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Set\+Plot\+Error\+For\+Flat\+Prior (\begin{DoxyParamCaption}\item[{const bool}]{Plot\+Or\+Not }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Set whether you want to plot error for parameters which have flat prior. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00224}{224}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00224\ \{\mbox{\hyperlink{classMCMCProcessor_ad24411a2556504c440ff0af045e8e7aa}{PlotFlatPrior}}\ =\ PlotOrNot;\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a6ea549289949ac19d2fc768d82c8f1c9}\label{classMCMCProcessor_a6ea549289949ac19d2fc768d82c8f1c9}} 
\index{MCMCProcessor@{MCMCProcessor}!SetPlotRelativeToPrior@{SetPlotRelativeToPrior}}
\index{SetPlotRelativeToPrior@{SetPlotRelativeToPrior}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{SetPlotRelativeToPrior()}{SetPlotRelativeToPrior()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Set\+Plot\+Relative\+To\+Prior (\begin{DoxyParamCaption}\item[{const bool}]{Plot\+Or\+Not }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



You can set relative to prior or relative to generated. It is advised to use relate to prior. 


\begin{DoxyParams}{Parameters}
{\em Plot\+Or\+Not} & bool controlling plot\+Relative\+To\+Prior argument \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00221}{221}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00221\ \{\mbox{\hyperlink{classMCMCProcessor_afbac2a114c15ca7db4abe71dd549504c}{plotRelativeToPrior}}\ =\ PlotOrNot;\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_ab605f4d7bf4e2b24b4c0b1c5853b479f}\label{classMCMCProcessor_ab605f4d7bf4e2b24b4c0b1c5853b479f}} 
\index{MCMCProcessor@{MCMCProcessor}!SetPost2DPlotThreshold@{SetPost2DPlotThreshold}}
\index{SetPost2DPlotThreshold@{SetPost2DPlotThreshold}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{SetPost2DPlotThreshold()}{SetPost2DPlotThreshold()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Set\+Post2\+DPlot\+Threshold (\begin{DoxyParamCaption}\item[{const double}]{Threshold }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Code will only plot 2D posteriors if Correlation are larger than defined threshold. 


\begin{DoxyParams}{Parameters}
{\em Threshold} & This threshold is compared with correlation value \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00231}{231}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00231\ \{\mbox{\hyperlink{classMCMCProcessor_a25e4685b6299181021b02ac0e0b74681}{Post2DPlotThreshold}}\ =\ Threshold;\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a641da7f5e018d48d480638fbad6406a4}\label{classMCMCProcessor_a641da7f5e018d48d480638fbad6406a4}} 
\index{MCMCProcessor@{MCMCProcessor}!SetPosterior1DCut@{SetPosterior1DCut}}
\index{SetPosterior1DCut@{SetPosterior1DCut}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{SetPosterior1DCut()}{SetPosterior1DCut()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Set\+Posterior1\+DCut (\begin{DoxyParamCaption}\item[{const std\+::string}]{Cut }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00245}{245}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00245\ \{\mbox{\hyperlink{classMCMCProcessor_a85917e25c4f5b5b966c50cccd9ddd6a0}{Posterior1DCut}}\ =\ Cut;\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a9db87211d9f066011daed18af7f4631e}\label{classMCMCProcessor_a9db87211d9f066011daed18af7f4631e}} 
\index{MCMCProcessor@{MCMCProcessor}!SetPrintToPDF@{SetPrintToPDF}}
\index{SetPrintToPDF@{SetPrintToPDF}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{SetPrintToPDF()}{SetPrintToPDF()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Set\+Print\+To\+PDF (\begin{DoxyParamCaption}\item[{const bool}]{Plot\+Or\+Not }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00222}{222}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00222\ \{\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}}\ =\ PlotOrNot;\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a4bec41cdc9af977a51b269e2a07fe961}\label{classMCMCProcessor_a4bec41cdc9af977a51b269e2a07fe961}} 
\index{MCMCProcessor@{MCMCProcessor}!SetSmoothing@{SetSmoothing}}
\index{SetSmoothing@{SetSmoothing}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{SetSmoothing()}{SetSmoothing()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Set\+Smoothing (\begin{DoxyParamCaption}\item[{const bool}]{Plot\+Or\+Not }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Set whether want to use smoothing for histograms using ROOT algorithm. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00228}{228}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00228\ \{\mbox{\hyperlink{classMCMCProcessor_a682c1c47626542f5820d633ba2bc010c}{ApplySmoothing}}\ =\ PlotOrNot;\ \};}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_a16f653dcb6358f2a8e393e3946a7e6d2}\label{classMCMCProcessor_a16f653dcb6358f2a8e393e3946a7e6d2}} 
\index{MCMCProcessor@{MCMCProcessor}!SetStepCut@{SetStepCut}}
\index{SetStepCut@{SetStepCut}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{SetStepCut()}{SetStepCut()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Set\+Step\+Cut (\begin{DoxyParamCaption}\item[{const int}]{Cuts }\end{DoxyParamCaption})}



Set the step cutting by int. 


\begin{DoxyParams}{Parameters}
{\em Cuts} & integer telling cut value \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l02693}{2693}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02693\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02694\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{02695\ \ \ std::stringstream\ TempStream;}
\DoxyCodeLine{02696\ \ \ TempStream\ <<\ \textcolor{stringliteral}{"{}step\ >\ "{}}\ <<\ Cuts;}
\DoxyCodeLine{02697\ \ \ \mbox{\hyperlink{classMCMCProcessor_a576f0eb874afaf7e31ff5c86b9e5b8f9}{StepCut}}\ =\ TempStream.str();}
\DoxyCodeLine{02698\ \ \ \mbox{\hyperlink{classMCMCProcessor_a22f82dadceccbe87dd8c5b7daa8432e8}{BurnInCut}}\ =\ Cuts;}
\DoxyCodeLine{02699\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_ad610d8e835031872b428e759ef4045f1}\label{classMCMCProcessor_ad610d8e835031872b428e759ef4045f1}} 
\index{MCMCProcessor@{MCMCProcessor}!SetStepCut@{SetStepCut}}
\index{SetStepCut@{SetStepCut}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{SetStepCut()}{SetStepCut()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Set\+Step\+Cut (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{Cuts }\end{DoxyParamCaption})}



Set the step cutting by string. 


\begin{DoxyParams}{Parameters}
{\em Cuts} & string telling cut value \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l02685}{2685}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02685\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02686\ \textcolor{comment}{//\ ***************}}
\DoxyCodeLine{02687\ \ \ \mbox{\hyperlink{classMCMCProcessor_a576f0eb874afaf7e31ff5c86b9e5b8f9}{StepCut}}\ =\ Cuts;}
\DoxyCodeLine{02688\ \ \ \mbox{\hyperlink{classMCMCProcessor_a22f82dadceccbe87dd8c5b7daa8432e8}{BurnInCut}}\ =\ std::stoi(\ Cuts\ );}
\DoxyCodeLine{02689\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classMCMCProcessor_aa4761be1345f1be3defe162b278a9d8e}\label{classMCMCProcessor_aa4761be1345f1be3defe162b278a9d8e}} 
\index{MCMCProcessor@{MCMCProcessor}!SetupOutput@{SetupOutput}}
\index{SetupOutput@{SetupOutput}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{SetupOutput()}{SetupOutput()}}
{\footnotesize\ttfamily void MCMCProcessor\+::\+Setup\+Output (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Prepare all objects used for output. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8cpp_source_l02251}{2251}} of file \mbox{\hyperlink{MCMCProcessor_8cpp_source}{MCMCProcessor.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02252\ \textcolor{comment}{//\ ****************************}}
\DoxyCodeLine{02253\ }
\DoxyCodeLine{02254\ \ \ \textcolor{comment}{//\ Make\ sure\ we\ can\ read\ files\ located\ anywhere\ and\ strip\ the\ .root\ ending}}
\DoxyCodeLine{02255\ \ \ \mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}}\ =\ \mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}}.substr(0,\ \mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}}.find(\textcolor{stringliteral}{"{}.root"{}}));}
\DoxyCodeLine{02256\ }
\DoxyCodeLine{02257\ \ \ \textcolor{comment}{//\ Check\ if\ the\ output\ file\ is\ ready}}
\DoxyCodeLine{02258\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}{OutputFile}}\ ==\ \textcolor{keyword}{nullptr})\ \mbox{\hyperlink{classMCMCProcessor_aa5a7761e97cf2e24c7d877a5374b7333}{MakeOutputFile}}();}
\DoxyCodeLine{02259\ \ \ }
\DoxyCodeLine{02260\ \ \ \mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}}\ =\ \mbox{\hyperlink{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}{MCMCFile}}\ +\ \mbox{\hyperlink{classMCMCProcessor_aa34b50ce33fb2cb7d9e9ef2d9f2f67c1}{OutputSuffix}}\ +\ \textcolor{stringliteral}{"{}.pdf["{}};}
\DoxyCodeLine{02261\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}{printToPDF}})\ \mbox{\hyperlink{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}{Posterior}}-\/>Print(\mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}});}
\DoxyCodeLine{02262\ }
\DoxyCodeLine{02263\ \ \ \textcolor{comment}{//\ Once\ the\ pdf\ file\ is\ open\ no\ longer\ need\ to\ bracket}}
\DoxyCodeLine{02264\ \ \ \mbox{\hyperlink{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}{CanvasName}}.ReplaceAll(\textcolor{stringliteral}{"{}["{}},\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{02265\ }
\DoxyCodeLine{02266\ \ \ \textcolor{comment}{//\ We\ fit\ with\ this\ Gaussian}}
\DoxyCodeLine{02267\ \ \ \mbox{\hyperlink{classMCMCProcessor_a92c1d9b0ebdf90951221cdaf2ac4cc2c}{Gauss}}\ =\ \textcolor{keyword}{new}\ TF1(\textcolor{stringliteral}{"{}gauss"{}},\textcolor{stringliteral}{"{}[0]/sqrt(2.0*3.14159)/[2]*TMath::Exp(-\/0.5*pow(x-\/[1],2)/[2]/[2])"{}},\ -\/5,\ 5);}
\DoxyCodeLine{02268\ }
\DoxyCodeLine{02269\ \ \ \textcolor{comment}{//\ Declare\ the\ TVectors}}
\DoxyCodeLine{02270\ \ \ \mbox{\hyperlink{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}{Covariance}}\ =\ \textcolor{keyword}{new}\ TMatrixDSym(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{02271\ \ \ \mbox{\hyperlink{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}{Correlation}}\ =\ \textcolor{keyword}{new}\ TMatrixDSym(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{02272\ \ \ \mbox{\hyperlink{classMCMCProcessor_aad661c6d53f9f891e18ff8ccdbd08479}{Central\_Value}}\ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{02273\ \ \ \mbox{\hyperlink{classMCMCProcessor_acaf7f239136dfa3506d095b612323d0a}{Means}}\ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{02274\ \ \ \mbox{\hyperlink{classMCMCProcessor_a5174aaa900edf16ddc6e841ea4adae83}{Errors}}\ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{02275\ \ \ \mbox{\hyperlink{classMCMCProcessor_a600fc8c39af2750df91fb7a0ff85ac74}{Means\_Gauss}}\ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{02276\ \ \ \mbox{\hyperlink{classMCMCProcessor_aa78b7ed1bb9966f84f4eaf8cedf5e688}{Errors\_Gauss}}\ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{02277\ \ \ \mbox{\hyperlink{classMCMCProcessor_a32657dc39a7fc0d04804f6195a3d8c3e}{Means\_HPD}}\ \ \ \ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{02278\ \ \ \mbox{\hyperlink{classMCMCProcessor_abb5c6ad85c89227bbb9bc5de2eb71272}{Errors\_HPD}}\ \ \ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{02279\ \ \ \mbox{\hyperlink{classMCMCProcessor_af96664fa8cc51c49ad1385da07a343b8}{Errors\_HPD\_Positive}}\ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{02280\ \ \ \mbox{\hyperlink{classMCMCProcessor_a7b85df39f22390dac24f4d66a89518e5}{Errors\_HPD\_Negative}}\ =\ \textcolor{keyword}{new}\ TVectorD(\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}});}
\DoxyCodeLine{02281\ }
\DoxyCodeLine{02282\ \ \ \textcolor{comment}{//\ Initialise\ to\ something\ silly}}
\DoxyCodeLine{02283\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{02284\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{02285\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{02286\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++i)}
\DoxyCodeLine{02287\ \ \ \{}
\DoxyCodeLine{02288\ \ \ \ \ (*Central\_Value)(i)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{02289\ \ \ \ \ (*Means)(i)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{02290\ \ \ \ \ (*Errors)(i)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{02291\ \ \ \ \ (*Means\_Gauss)(i)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{02292\ \ \ \ \ (*Errors\_Gauss)(i)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{02293\ \ \ \ \ (*Means\_HPD)(i)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{02294\ \ \ \ \ (*Errors\_HPD)(i)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{02295\ \ \ \ \ (*Errors\_HPD\_Positive)(i)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{02296\ \ \ \ \ (*Errors\_HPD\_Negative)(i)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{02297\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}};\ ++j)\ \{}
\DoxyCodeLine{02298\ \ \ \ \ \ \ (*Covariance)(i,\ j)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{02299\ \ \ \ \ \ \ (*Correlation)(i,\ j)\ =\ \mbox{\hyperlink{MCMCProcessor_8h_a82a6d79039474bc403b627437a7b97ec}{\_UNDEF\_}};}
\DoxyCodeLine{02300\ \ \ \ \ \}}
\DoxyCodeLine{02301\ \ \ \}}
\DoxyCodeLine{02302\ \ \ }
\DoxyCodeLine{02303\ \ \ \mbox{\hyperlink{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}{hpost}}\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}{nDraw}}]();}
\DoxyCodeLine{02304\ \}}

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classMCMCProcessor_a523a223a4754c133121796f4591c7be3}\label{classMCMCProcessor_a523a223a4754c133121796f4591c7be3}} 
\index{MCMCProcessor@{MCMCProcessor}!AccProbBatchedAverages@{AccProbBatchedAverages}}
\index{AccProbBatchedAverages@{AccProbBatchedAverages}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{AccProbBatchedAverages}{AccProbBatchedAverages}}
{\footnotesize\ttfamily double$\ast$ MCMCProcessor\+::\+Acc\+Prob\+Batched\+Averages\hspace{0.3cm}{\ttfamily [private]}}



Holds all acc\+Prob in batches. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00483}{483}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a88cab29770fd6098a674a0ab3628a251}\label{classMCMCProcessor_a88cab29770fd6098a674a0ab3628a251}} 
\index{MCMCProcessor@{MCMCProcessor}!AccProbValues@{AccProbValues}}
\index{AccProbValues@{AccProbValues}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{AccProbValues}{AccProbValues}}
{\footnotesize\ttfamily double$\ast$ MCMCProcessor\+::\+Acc\+Prob\+Values\hspace{0.3cm}{\ttfamily [private]}}



Holds all acc\+Prob. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00481}{481}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a682c1c47626542f5820d633ba2bc010c}\label{classMCMCProcessor_a682c1c47626542f5820d633ba2bc010c}} 
\index{MCMCProcessor@{MCMCProcessor}!ApplySmoothing@{ApplySmoothing}}
\index{ApplySmoothing@{ApplySmoothing}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{ApplySmoothing}{ApplySmoothing}}
{\footnotesize\ttfamily bool MCMCProcessor\+::\+Apply\+Smoothing\hspace{0.3cm}{\ttfamily [private]}}



Apply smoothing for 2D histos using root algorithm. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00399}{399}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a6156bba72e1f076e66f0356e48506a36}\label{classMCMCProcessor_a6156bba72e1f076e66f0356e48506a36}} 
\index{MCMCProcessor@{MCMCProcessor}!AutoCorrLag@{AutoCorrLag}}
\index{AutoCorrLag@{AutoCorrLag}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{AutoCorrLag}{AutoCorrLag}}
{\footnotesize\ttfamily int MCMCProcessor\+::\+Auto\+Corr\+Lag\hspace{0.3cm}{\ttfamily [private]}}



LagL used in Auto\+Correlation. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00468}{468}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}\label{classMCMCProcessor_ab3f590b501162fc2ee5b78ce75689771}} 
\index{MCMCProcessor@{MCMCProcessor}!BatchedAverages@{BatchedAverages}}
\index{BatchedAverages@{BatchedAverages}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{BatchedAverages}{BatchedAverages}}
{\footnotesize\ttfamily double$\ast$$\ast$ MCMCProcessor\+::\+Batched\+Averages\hspace{0.3cm}{\ttfamily [private]}}



Values of batched average for every param and batch. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00473}{473}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}\label{classMCMCProcessor_ad043b6b2c885f47ab9967831bc8d0f5a}} 
\index{MCMCProcessor@{MCMCProcessor}!BranchNames@{BranchNames}}
\index{BranchNames@{BranchNames}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{BranchNames}{BranchNames}}
{\footnotesize\ttfamily std\+::vector$<$TString$>$ MCMCProcessor\+::\+Branch\+Names\hspace{0.3cm}{\ttfamily [private]}}



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00344}{344}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a22f82dadceccbe87dd8c5b7daa8432e8}\label{classMCMCProcessor_a22f82dadceccbe87dd8c5b7daa8432e8}} 
\index{MCMCProcessor@{MCMCProcessor}!BurnInCut@{BurnInCut}}
\index{BurnInCut@{BurnInCut}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{BurnInCut}{BurnInCut}}
{\footnotesize\ttfamily int MCMCProcessor\+::\+Burn\+In\+Cut\hspace{0.3cm}{\ttfamily [private]}}



Value of burn in cut. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00329}{329}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_aea84f0315695aa05ec41fcf965b1b031}\label{classMCMCProcessor_aea84f0315695aa05ec41fcf965b1b031}} 
\index{MCMCProcessor@{MCMCProcessor}!CacheMCMC@{CacheMCMC}}
\index{CacheMCMC@{CacheMCMC}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{CacheMCMC}{CacheMCMC}}
{\footnotesize\ttfamily bool MCMCProcessor\+::\+Cache\+MCMC\hspace{0.3cm}{\ttfamily [private]}}



MCMC Chain has been cached. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00460}{460}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}\label{classMCMCProcessor_ab5aec3dc293919701d31e6ae705601dd}} 
\index{MCMCProcessor@{MCMCProcessor}!CanvasName@{CanvasName}}
\index{CanvasName@{CanvasName}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{CanvasName}{CanvasName}}
{\footnotesize\ttfamily TString MCMCProcessor\+::\+Canvas\+Name\hspace{0.3cm}{\ttfamily [private]}}



Name of canvas which help to save to the sample pdf. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00380}{380}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_aad661c6d53f9f891e18ff8ccdbd08479}\label{classMCMCProcessor_aad661c6d53f9f891e18ff8ccdbd08479}} 
\index{MCMCProcessor@{MCMCProcessor}!Central\_Value@{Central\_Value}}
\index{Central\_Value@{Central\_Value}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{Central\_Value}{Central\_Value}}
{\footnotesize\ttfamily TVectorD$\ast$ MCMCProcessor\+::\+Central\+\_\+\+Value\hspace{0.3cm}{\ttfamily [private]}}



Vector with central value for each parameter. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00417}{417}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}\label{classMCMCProcessor_a6be3bbebd4a79fe9814a3da09b3bb820}} 
\index{MCMCProcessor@{MCMCProcessor}!Chain@{Chain}}
\index{Chain@{Chain}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{Chain}{Chain}}
{\footnotesize\ttfamily TChain$\ast$ MCMCProcessor\+::\+Chain\hspace{0.3cm}{\ttfamily [private]}}



Main chain storing all steps etc. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00321}{321}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}\label{classMCMCProcessor_a03f28431158777cdd81d058b6632a92f}} 
\index{MCMCProcessor@{MCMCProcessor}!Correlation@{Correlation}}
\index{Correlation@{Correlation}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{Correlation}{Correlation}}
{\footnotesize\ttfamily TMatrix\+DSym$\ast$ MCMCProcessor\+::\+Correlation\hspace{0.3cm}{\ttfamily [private]}}



Posterior Correlation Matrix. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00438}{438}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}\label{classMCMCProcessor_af9a40632e2d7f1266d69a74d5b5f2244}} 
\index{MCMCProcessor@{MCMCProcessor}!Covariance@{Covariance}}
\index{Covariance@{Covariance}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{Covariance}{Covariance}}
{\footnotesize\ttfamily TMatrix\+DSym$\ast$ MCMCProcessor\+::\+Covariance\hspace{0.3cm}{\ttfamily [private]}}



Posterior Covariance Matrix. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00436}{436}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a4c1330a025c0b91e382bdc29c960424a}\label{classMCMCProcessor_a4c1330a025c0b91e382bdc29c960424a}} 
\index{MCMCProcessor@{MCMCProcessor}!CovConfig@{CovConfig}}
\index{CovConfig@{CovConfig}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{CovConfig}{CovConfig}}
{\footnotesize\ttfamily std\+::vector$<$YAML\+::\+Node$>$ MCMCProcessor\+::\+Cov\+Config\hspace{0.3cm}{\ttfamily [private]}}



Covariance matrix config. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00317}{317}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}\label{classMCMCProcessor_a7c6afb0ed75207fd02c28e408f0592d4}} 
\index{MCMCProcessor@{MCMCProcessor}!CovPos@{CovPos}}
\index{CovPos@{CovPos}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{CovPos}{CovPos}}
{\footnotesize\ttfamily std\+::vector$<$std\+::vector$<$std\+::string$>$ $>$ MCMCProcessor\+::\+Cov\+Pos\hspace{0.3cm}{\ttfamily [private]}}



Covariance matrix name position. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00315}{315}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_adf449e50cf358f737fe4a2b65d9668e9}\label{classMCMCProcessor_adf449e50cf358f737fe4a2b65d9668e9}} 
\index{MCMCProcessor@{MCMCProcessor}!doDiagMCMC@{doDiagMCMC}}
\index{doDiagMCMC@{doDiagMCMC}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{doDiagMCMC}{doDiagMCMC}}
{\footnotesize\ttfamily bool MCMCProcessor\+::do\+Diag\+MCMC\hspace{0.3cm}{\ttfamily [private]}}



Doing MCMC Diagnostic. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00462}{462}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a4abe633b264acd9b0459c7b8ccd8b9df}\label{classMCMCProcessor_a4abe633b264acd9b0459c7b8ccd8b9df}} 
\index{MCMCProcessor@{MCMCProcessor}!DrawRange@{DrawRange}}
\index{DrawRange@{DrawRange}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{DrawRange}{DrawRange}}
{\footnotesize\ttfamily double MCMCProcessor\+::\+Draw\+Range\hspace{0.3cm}{\ttfamily [private]}}



Drawrange for Set\+Maximum. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00457}{457}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a5174aaa900edf16ddc6e841ea4adae83}\label{classMCMCProcessor_a5174aaa900edf16ddc6e841ea4adae83}} 
\index{MCMCProcessor@{MCMCProcessor}!Errors@{Errors}}
\index{Errors@{Errors}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{Errors}{Errors}}
{\footnotesize\ttfamily TVectorD$\ast$ MCMCProcessor\+::\+Errors\hspace{0.3cm}{\ttfamily [private]}}



Vector with errors values using RMS. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00421}{421}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_aa78b7ed1bb9966f84f4eaf8cedf5e688}\label{classMCMCProcessor_aa78b7ed1bb9966f84f4eaf8cedf5e688}} 
\index{MCMCProcessor@{MCMCProcessor}!Errors\_Gauss@{Errors\_Gauss}}
\index{Errors\_Gauss@{Errors\_Gauss}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{Errors\_Gauss}{Errors\_Gauss}}
{\footnotesize\ttfamily TVectorD$\ast$ MCMCProcessor\+::\+Errors\+\_\+\+Gauss\hspace{0.3cm}{\ttfamily [private]}}



Vector with error values using Gaussian fit. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00425}{425}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_abb5c6ad85c89227bbb9bc5de2eb71272}\label{classMCMCProcessor_abb5c6ad85c89227bbb9bc5de2eb71272}} 
\index{MCMCProcessor@{MCMCProcessor}!Errors\_HPD@{Errors\_HPD}}
\index{Errors\_HPD@{Errors\_HPD}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{Errors\_HPD}{Errors\_HPD}}
{\footnotesize\ttfamily TVectorD$\ast$ MCMCProcessor\+::\+Errors\+\_\+\+HPD\hspace{0.3cm}{\ttfamily [private]}}



Vector with error values using Highest Posterior Density. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00429}{429}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a7b85df39f22390dac24f4d66a89518e5}\label{classMCMCProcessor_a7b85df39f22390dac24f4d66a89518e5}} 
\index{MCMCProcessor@{MCMCProcessor}!Errors\_HPD\_Negative@{Errors\_HPD\_Negative}}
\index{Errors\_HPD\_Negative@{Errors\_HPD\_Negative}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{Errors\_HPD\_Negative}{Errors\_HPD\_Negative}}
{\footnotesize\ttfamily TVectorD$\ast$ MCMCProcessor\+::\+Errors\+\_\+\+HPD\+\_\+\+Negative\hspace{0.3cm}{\ttfamily [private]}}



Vector with negative error (left hand side) values using Highest Posterior Density. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00433}{433}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_af96664fa8cc51c49ad1385da07a343b8}\label{classMCMCProcessor_af96664fa8cc51c49ad1385da07a343b8}} 
\index{MCMCProcessor@{MCMCProcessor}!Errors\_HPD\_Positive@{Errors\_HPD\_Positive}}
\index{Errors\_HPD\_Positive@{Errors\_HPD\_Positive}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{Errors\_HPD\_Positive}{Errors\_HPD\_Positive}}
{\footnotesize\ttfamily TVectorD$\ast$ MCMCProcessor\+::\+Errors\+\_\+\+HPD\+\_\+\+Positive\hspace{0.3cm}{\ttfamily [private]}}



Vector with positive error (right hand side) values using Highest Posterior Density. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00431}{431}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a7425f7802e50bcb5ff4b38e20157c423}\label{classMCMCProcessor_a7425f7802e50bcb5ff4b38e20157c423}} 
\index{MCMCProcessor@{MCMCProcessor}!ExcludedNames@{ExcludedNames}}
\index{ExcludedNames@{ExcludedNames}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{ExcludedNames}{ExcludedNames}}
{\footnotesize\ttfamily std\+::vector$<$std\+::string$>$ MCMCProcessor\+::\+Excluded\+Names\hspace{0.3cm}{\ttfamily [private]}}



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00346}{346}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_aada4aadea10661586b46c1013a9d018f}\label{classMCMCProcessor_aada4aadea10661586b46c1013a9d018f}} 
\index{MCMCProcessor@{MCMCProcessor}!ExcludedTypes@{ExcludedTypes}}
\index{ExcludedTypes@{ExcludedTypes}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{ExcludedTypes}{ExcludedTypes}}
{\footnotesize\ttfamily std\+::vector$<$std\+::string$>$ MCMCProcessor\+::\+Excluded\+Types\hspace{0.3cm}{\ttfamily [private]}}



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00345}{345}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_ad25fe818c94163b0c4a8fcdfd387c148}\label{classMCMCProcessor_ad25fe818c94163b0c4a8fcdfd387c148}} 
\index{MCMCProcessor@{MCMCProcessor}!FancyPlotNames@{FancyPlotNames}}
\index{FancyPlotNames@{FancyPlotNames}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{FancyPlotNames}{FancyPlotNames}}
{\footnotesize\ttfamily bool MCMCProcessor\+::\+Fancy\+Plot\+Names\hspace{0.3cm}{\ttfamily [private]}}



Whether we want fancy plot names or not. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00395}{395}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a92c1d9b0ebdf90951221cdaf2ac4cc2c}\label{classMCMCProcessor_a92c1d9b0ebdf90951221cdaf2ac4cc2c}} 
\index{MCMCProcessor@{MCMCProcessor}!Gauss@{Gauss}}
\index{Gauss@{Gauss}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{Gauss}{Gauss}}
{\footnotesize\ttfamily TF1$\ast$ MCMCProcessor\+::\+Gauss\hspace{0.3cm}{\ttfamily [private]}}



Gaussian fitter. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00407}{407}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}\label{classMCMCProcessor_aa3c928a09df7d6fc431c0b879d5c40e4}} 
\index{MCMCProcessor@{MCMCProcessor}!hpost@{hpost}}
\index{hpost@{hpost}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{hpost}{hpost}}
{\footnotesize\ttfamily TH1D$\ast$$\ast$ MCMCProcessor\+::hpost\hspace{0.3cm}{\ttfamily [private]}}



Holds 1D Posterior Distributions. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00441}{441}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}\label{classMCMCProcessor_a0ddcfa4ba1e4dcdea366d88decc64391}} 
\index{MCMCProcessor@{MCMCProcessor}!hpost2D@{hpost2D}}
\index{hpost2D@{hpost2D}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{hpost2D}{hpost2D}}
{\footnotesize\ttfamily TH2D$\ast$$\ast$$\ast$ MCMCProcessor\+::hpost2D\hspace{0.3cm}{\ttfamily [private]}}



Holds 2D Posterior Distributions. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00443}{443}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}\label{classMCMCProcessor_a556988f03b24e3af33e9a29b23d2b1e2}} 
\index{MCMCProcessor@{MCMCProcessor}!hviolin@{hviolin}}
\index{hviolin@{hviolin}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{hviolin}{hviolin}}
{\footnotesize\ttfamily TH2D$\ast$ MCMCProcessor\+::hviolin\hspace{0.3cm}{\ttfamily [private]}}



Holds violin plot for all dials. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00445}{445}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}\label{classMCMCProcessor_a25d79f451d5d584c3e7ef0e1423e5e8e}} 
\index{MCMCProcessor@{MCMCProcessor}!hviolin\_prior@{hviolin\_prior}}
\index{hviolin\_prior@{hviolin\_prior}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{hviolin\_prior}{hviolin\_prior}}
{\footnotesize\ttfamily TH2D$\ast$ MCMCProcessor\+::hviolin\+\_\+prior\hspace{0.3cm}{\ttfamily [private]}}



Holds prior violin plot for all dials,. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00447}{447}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a95fa49737432818bc830a44898d0d850}\label{classMCMCProcessor_a95fa49737432818bc830a44898d0d850}} 
\index{MCMCProcessor@{MCMCProcessor}!IamVaried@{IamVaried}}
\index{IamVaried@{IamVaried}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{IamVaried}{IamVaried}}
{\footnotesize\ttfamily std\+::vector$<$bool$>$ MCMCProcessor\+::\+Iam\+Varied\hspace{0.3cm}{\ttfamily [private]}}



Is the ith parameter varied. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00349}{349}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a2c06d64020e9246e720cc131a9f4986d}\label{classMCMCProcessor_a2c06d64020e9246e720cc131a9f4986d}} 
\index{MCMCProcessor@{MCMCProcessor}!IsXsec@{IsXsec}}
\index{IsXsec@{IsXsec}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{IsXsec}{IsXsec}}
{\footnotesize\ttfamily std\+::vector$<$bool$>$ MCMCProcessor\+::\+Is\+Xsec\hspace{0.3cm}{\ttfamily [private]}}

In Xsec\+Matrix we have both xsec and flux parameters, this is just for some plotting options \begin{DoxyWarning}{Warning}
will become deprecated 
\end{DoxyWarning}


Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00367}{367}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_aecc35d4ea7d2c7e020e50388ba0ffb64}\label{classMCMCProcessor_aecc35d4ea7d2c7e020e50388ba0ffb64}} 
\index{MCMCProcessor@{MCMCProcessor}!MadePostfit@{MadePostfit}}
\index{MadePostfit@{MadePostfit}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{MadePostfit}{MadePostfit}}
{\footnotesize\ttfamily bool MCMCProcessor\+::\+Made\+Postfit\hspace{0.3cm}{\ttfamily [private]}}



Sanity check if Postfit is already done to not make several times. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00391}{391}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}\label{classMCMCProcessor_a6d212d77a818304a8674a7b9b18d43b8}} 
\index{MCMCProcessor@{MCMCProcessor}!MCMCFile@{MCMCFile}}
\index{MCMCFile@{MCMCFile}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{MCMCFile}{MCMCFile}}
{\footnotesize\ttfamily std\+::string MCMCProcessor\+::\+MCMCFile\hspace{0.3cm}{\ttfamily [private]}}



Name of MCMC file. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00311}{311}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_acaf7f239136dfa3506d095b612323d0a}\label{classMCMCProcessor_acaf7f239136dfa3506d095b612323d0a}} 
\index{MCMCProcessor@{MCMCProcessor}!Means@{Means}}
\index{Means@{Means}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{Means}{Means}}
{\footnotesize\ttfamily TVectorD$\ast$ MCMCProcessor\+::\+Means\hspace{0.3cm}{\ttfamily [private]}}



Vector with mean values using Arithmetic Mean. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00419}{419}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a600fc8c39af2750df91fb7a0ff85ac74}\label{classMCMCProcessor_a600fc8c39af2750df91fb7a0ff85ac74}} 
\index{MCMCProcessor@{MCMCProcessor}!Means\_Gauss@{Means\_Gauss}}
\index{Means\_Gauss@{Means\_Gauss}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{Means\_Gauss}{Means\_Gauss}}
{\footnotesize\ttfamily TVectorD$\ast$ MCMCProcessor\+::\+Means\+\_\+\+Gauss\hspace{0.3cm}{\ttfamily [private]}}



Vector with mean values using Gaussian fit. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00423}{423}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a32657dc39a7fc0d04804f6195a3d8c3e}\label{classMCMCProcessor_a32657dc39a7fc0d04804f6195a3d8c3e}} 
\index{MCMCProcessor@{MCMCProcessor}!Means\_HPD@{Means\_HPD}}
\index{Means\_HPD@{Means\_HPD}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{Means\_HPD}{Means\_HPD}}
{\footnotesize\ttfamily TVectorD$\ast$ MCMCProcessor\+::\+Means\+\_\+\+HPD\hspace{0.3cm}{\ttfamily [private]}}



Vector with mean values using Highest Posterior Density. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00427}{427}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}\label{classMCMCProcessor_a02c5a3f849cf217705816c650c678d19}} 
\index{MCMCProcessor@{MCMCProcessor}!nBatches@{nBatches}}
\index{nBatches@{nBatches}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{nBatches}{nBatches}}
{\footnotesize\ttfamily int MCMCProcessor\+::n\+Batches\hspace{0.3cm}{\ttfamily [private]}}



Number of batches for Batched Mean. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00466}{466}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}\label{classMCMCProcessor_a6b74f8195bcbca0979f9e9fe43468bae}} 
\index{MCMCProcessor@{MCMCProcessor}!nBins@{nBins}}
\index{nBins@{nBins}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{nBins}{nBins}}
{\footnotesize\ttfamily int MCMCProcessor\+::n\+Bins\hspace{0.3cm}{\ttfamily [private]}}



Number of bins. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00455}{455}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_af6ba5d9aec5350fafebbf81309e813cb}\label{classMCMCProcessor_af6ba5d9aec5350fafebbf81309e813cb}} 
\index{MCMCProcessor@{MCMCProcessor}!nBranches@{nBranches}}
\index{nBranches@{nBranches}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{nBranches}{nBranches}}
{\footnotesize\ttfamily int MCMCProcessor\+::n\+Branches\hspace{0.3cm}{\ttfamily [private]}}



Number of branches in a TTree. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00331}{331}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}\label{classMCMCProcessor_aa30545fedb0af2ad9619d6accf42a10d}} 
\index{MCMCProcessor@{MCMCProcessor}!nDraw@{nDraw}}
\index{nDraw@{nDraw}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{nDraw}{nDraw}}
{\footnotesize\ttfamily int MCMCProcessor\+::n\+Draw\hspace{0.3cm}{\ttfamily [private]}}



Number of all parameters used in the analysis. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00341}{341}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_ae76b02ce85737d30c778698ba127933b}\label{classMCMCProcessor_ae76b02ce85737d30c778698ba127933b}} 
\index{MCMCProcessor@{MCMCProcessor}!NDSamplesBins@{NDSamplesBins}}
\index{NDSamplesBins@{NDSamplesBins}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{NDSamplesBins}{NDSamplesBins}}
{\footnotesize\ttfamily std\+::vector$<$ int $>$ MCMCProcessor\+::\+NDSamples\+Bins\hspace{0.3cm}{\ttfamily [private]}}



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00403}{403}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a27c8a25155baab660fc9658861c433ab}\label{classMCMCProcessor_a27c8a25155baab660fc9658861c433ab}} 
\index{MCMCProcessor@{MCMCProcessor}!NDSamplesNames@{NDSamplesNames}}
\index{NDSamplesNames@{NDSamplesNames}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{NDSamplesNames}{NDSamplesNames}}
{\footnotesize\ttfamily std\+::vector$<$ std\+::string $>$ MCMCProcessor\+::\+NDSamples\+Names\hspace{0.3cm}{\ttfamily [private]}}



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00404}{404}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}\label{classMCMCProcessor_af3a19b885e9c34e1674aea8cfbe14e1c}} 
\index{MCMCProcessor@{MCMCProcessor}!nEntries@{nEntries}}
\index{nEntries@{nEntries}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{nEntries}{nEntries}}
{\footnotesize\ttfamily int MCMCProcessor\+::n\+Entries\hspace{0.3cm}{\ttfamily [private]}}



KS\+: For merged chains number of entries will be different from n\+Steps. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00333}{333}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}\label{classMCMCProcessor_acfc681553c5fbba89e133dfda605db3c}} 
\index{MCMCProcessor@{MCMCProcessor}!nFlux@{nFlux}}
\index{nFlux@{nFlux}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{nFlux}{nFlux}}
{\footnotesize\ttfamily int MCMCProcessor\+::n\+Flux\hspace{0.3cm}{\ttfamily [private]}}

This keep number of Flux params in xsec matrix \begin{DoxyWarning}{Warning}
will become deprecated 
\end{DoxyWarning}


Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00370}{370}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}\label{classMCMCProcessor_a4200e7cbe1c8f811d3640ebfd648ca85}} 
\index{MCMCProcessor@{MCMCProcessor}!nParam@{nParam}}
\index{nParam@{nParam}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{nParam}{nParam}}
{\footnotesize\ttfamily std\+::vector$<$int$>$ MCMCProcessor\+::n\+Param\hspace{0.3cm}{\ttfamily [private]}}



Number of parameters per type. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00358}{358}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a419d3669dbb54a55a635e35691134cc1}\label{classMCMCProcessor_a419d3669dbb54a55a635e35691134cc1}} 
\index{MCMCProcessor@{MCMCProcessor}!nSamples@{nSamples}}
\index{nSamples@{nSamples}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{nSamples}{nSamples}}
{\footnotesize\ttfamily int MCMCProcessor\+::n\+Samples\hspace{0.3cm}{\ttfamily [private]}}



Number of sample PDF objects. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00337}{337}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_aae0016a4e1d105d5d65243438c622a97}\label{classMCMCProcessor_aae0016a4e1d105d5d65243438c622a97}} 
\index{MCMCProcessor@{MCMCProcessor}!nSteps@{nSteps}}
\index{nSteps@{nSteps}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{nSteps}{nSteps}}
{\footnotesize\ttfamily int MCMCProcessor\+::n\+Steps\hspace{0.3cm}{\ttfamily [private]}}



KS\+: For merged chains number of entries will be different from n\+Steps. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00335}{335}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_adf518be96278f1d3901404cfbe767b67}\label{classMCMCProcessor_adf518be96278f1d3901404cfbe767b67}} 
\index{MCMCProcessor@{MCMCProcessor}!nSysts@{nSysts}}
\index{nSysts@{nSysts}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{nSysts}{nSysts}}
{\footnotesize\ttfamily int MCMCProcessor\+::n\+Systs\hspace{0.3cm}{\ttfamily [private]}}



Number of covariance objects. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00339}{339}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}\label{classMCMCProcessor_a62035b99df4617ab334cd1abd6ed0346}} 
\index{MCMCProcessor@{MCMCProcessor}!OutputFile@{OutputFile}}
\index{OutputFile@{OutputFile}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{OutputFile}{OutputFile}}
{\footnotesize\ttfamily TFile$\ast$ MCMCProcessor\+::\+Output\+File\hspace{0.3cm}{\ttfamily [private]}}



The output file. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00410}{410}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a3d17c1720b91d6d0361da0b5dabfbbff}\label{classMCMCProcessor_a3d17c1720b91d6d0361da0b5dabfbbff}} 
\index{MCMCProcessor@{MCMCProcessor}!OutputName@{OutputName}}
\index{OutputName@{OutputName}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{OutputName}{OutputName}}
{\footnotesize\ttfamily std\+::string MCMCProcessor\+::\+Output\+Name\hspace{0.3cm}{\ttfamily [private]}}



Name of output files. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00378}{378}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_aa34b50ce33fb2cb7d9e9ef2d9f2f67c1}\label{classMCMCProcessor_aa34b50ce33fb2cb7d9e9ef2d9f2f67c1}} 
\index{MCMCProcessor@{MCMCProcessor}!OutputSuffix@{OutputSuffix}}
\index{OutputSuffix@{OutputSuffix}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{OutputSuffix}{OutputSuffix}}
{\footnotesize\ttfamily std\+::string MCMCProcessor\+::\+Output\+Suffix\hspace{0.3cm}{\ttfamily [private]}}



Output file suffix useful when running over same file with different settings. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00313}{313}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a3a6614826ae320e462211e38e96d9d02}\label{classMCMCProcessor_a3a6614826ae320e462211e38e96d9d02}} 
\index{MCMCProcessor@{MCMCProcessor}!ParamCentral@{ParamCentral}}
\index{ParamCentral@{ParamCentral}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{ParamCentral}{ParamCentral}}
{\footnotesize\ttfamily std\+::vector$<$std\+::vector$<$double$>$ $>$ MCMCProcessor\+::\+Param\+Central\hspace{0.3cm}{\ttfamily [private]}}



Parameters central values which we are going to analyse. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00353}{353}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a3a97e3cb4be3ceb9eb721eac51d82d60}\label{classMCMCProcessor_a3a97e3cb4be3ceb9eb721eac51d82d60}} 
\index{MCMCProcessor@{MCMCProcessor}!ParamErrors@{ParamErrors}}
\index{ParamErrors@{ParamErrors}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{ParamErrors}{ParamErrors}}
{\footnotesize\ttfamily std\+::vector$<$std\+::vector$<$double$>$ $>$ MCMCProcessor\+::\+Param\+Errors\hspace{0.3cm}{\ttfamily [private]}}



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00355}{355}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a4be1eedb743e4ea410009a4fa45720f7}\label{classMCMCProcessor_a4be1eedb743e4ea410009a4fa45720f7}} 
\index{MCMCProcessor@{MCMCProcessor}!ParamFlat@{ParamFlat}}
\index{ParamFlat@{ParamFlat}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{ParamFlat}{ParamFlat}}
{\footnotesize\ttfamily std\+::vector$<$std\+::vector$<$bool$>$ $>$ MCMCProcessor\+::\+Param\+Flat\hspace{0.3cm}{\ttfamily [private]}}



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00356}{356}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_adecc55689f7d37b9412f8886fe3480dc}\label{classMCMCProcessor_adecc55689f7d37b9412f8886fe3480dc}} 
\index{MCMCProcessor@{MCMCProcessor}!ParamNames@{ParamNames}}
\index{ParamNames@{ParamNames}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{ParamNames}{ParamNames}}
{\footnotesize\ttfamily std\+::vector$<$std\+::vector$<$TString$>$ $>$ MCMCProcessor\+::\+Param\+Names\hspace{0.3cm}{\ttfamily [private]}}



Name of parameters which we are going to analyse. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00351}{351}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a4c4c6aa4827a2fe54ce37defbb3d0475}\label{classMCMCProcessor_a4c4c6aa4827a2fe54ce37defbb3d0475}} 
\index{MCMCProcessor@{MCMCProcessor}!ParamNom@{ParamNom}}
\index{ParamNom@{ParamNom}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{ParamNom}{ParamNom}}
{\footnotesize\ttfamily std\+::vector$<$std\+::vector$<$double$>$ $>$ MCMCProcessor\+::\+Param\+Nom\hspace{0.3cm}{\ttfamily [private]}}



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00354}{354}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a7db98c7cf390b050f1acb927b4f55cab}\label{classMCMCProcessor_a7db98c7cf390b050f1acb927b4f55cab}} 
\index{MCMCProcessor@{MCMCProcessor}!ParamSums@{ParamSums}}
\index{ParamSums@{ParamSums}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{ParamSums}{ParamSums}}
{\footnotesize\ttfamily double$\ast$ MCMCProcessor\+::\+Param\+Sums\hspace{0.3cm}{\ttfamily [private]}}



Total parameter sum for each param. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00471}{471}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}\label{classMCMCProcessor_aaa903949bde8f1a69800c71fe1eb538e}} 
\index{MCMCProcessor@{MCMCProcessor}!ParamType@{ParamType}}
\index{ParamType@{ParamType}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{ParamType}{ParamType}}
{\footnotesize\ttfamily std\+::vector$<$\mbox{\hyperlink{MCMCProcessor_8h_acd2848273413543fe14936252942c20b}{Parameter\+Enum}}$>$ MCMCProcessor\+::\+Param\+Type\hspace{0.3cm}{\ttfamily [private]}}



Make an enum for which class this parameter belongs to so we don\textquotesingle{}t have to keep string comparing. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00360}{360}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_aeab63979ff36256072c046a15d981875}\label{classMCMCProcessor_aeab63979ff36256072c046a15d981875}} 
\index{MCMCProcessor@{MCMCProcessor}!ParamTypeStartPos@{ParamTypeStartPos}}
\index{ParamTypeStartPos@{ParamTypeStartPos}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{ParamTypeStartPos}{ParamTypeStartPos}}
{\footnotesize\ttfamily std\+::vector$<$int$>$ MCMCProcessor\+::\+Param\+Type\+Start\+Pos\hspace{0.3cm}{\ttfamily [private]}}

KS\+: in MCMC output there is order of parameters so for example first goes xsec then nd det etc. Idea is that this parameter will keep track of it so code is flexible 

Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00363}{363}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}\label{classMCMCProcessor_a087dca88a306acdc28afea7213e3623c}} 
\index{MCMCProcessor@{MCMCProcessor}!ParStep@{ParStep}}
\index{ParStep@{ParStep}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{ParStep}{ParStep}}
{\footnotesize\ttfamily double$\ast$$\ast$ MCMCProcessor\+::\+Par\+Step\hspace{0.3cm}{\ttfamily [private]}}



Array holding values for all parameters. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00450}{450}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_aa7611f55ac3c0ea70607761d037fbd91}\label{classMCMCProcessor_aa7611f55ac3c0ea70607761d037fbd91}} 
\index{MCMCProcessor@{MCMCProcessor}!plotBinValue@{plotBinValue}}
\index{plotBinValue@{plotBinValue}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{plotBinValue}{plotBinValue}}
{\footnotesize\ttfamily bool MCMCProcessor\+::plot\+Bin\+Value\hspace{0.3cm}{\ttfamily [private]}}



If true it will print value on each bin of covariance matrix. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00397}{397}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_ad24411a2556504c440ff0af045e8e7aa}\label{classMCMCProcessor_ad24411a2556504c440ff0af045e8e7aa}} 
\index{MCMCProcessor@{MCMCProcessor}!PlotFlatPrior@{PlotFlatPrior}}
\index{PlotFlatPrior@{PlotFlatPrior}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{PlotFlatPrior}{PlotFlatPrior}}
{\footnotesize\ttfamily bool MCMCProcessor\+::\+Plot\+Flat\+Prior\hspace{0.3cm}{\ttfamily [private]}}



Whether we plot flat prior or not, we usually provide error even for flat prior params. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00383}{383}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_af1392c6cff68e9f0a27e2c9a4e52cf4c}\label{classMCMCProcessor_af1392c6cff68e9f0a27e2c9a4e52cf4c}} 
\index{MCMCProcessor@{MCMCProcessor}!PlotJarlskog@{PlotJarlskog}}
\index{PlotJarlskog@{PlotJarlskog}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{PlotJarlskog}{PlotJarlskog}}
{\footnotesize\ttfamily bool MCMCProcessor\+::\+Plot\+Jarlskog\hspace{0.3cm}{\ttfamily [private]}}



Will plot Jarlskog Invariant using information in the chain. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00385}{385}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_afbac2a114c15ca7db4abe71dd549504c}\label{classMCMCProcessor_afbac2a114c15ca7db4abe71dd549504c}} 
\index{MCMCProcessor@{MCMCProcessor}!plotRelativeToPrior@{plotRelativeToPrior}}
\index{plotRelativeToPrior@{plotRelativeToPrior}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{plotRelativeToPrior}{plotRelativeToPrior}}
{\footnotesize\ttfamily bool MCMCProcessor\+::plot\+Relative\+To\+Prior\hspace{0.3cm}{\ttfamily [private]}}



Whether we plot relative to prior or nominal, in most cases is prior. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00389}{389}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a25e4685b6299181021b02ac0e0b74681}\label{classMCMCProcessor_a25e4685b6299181021b02ac0e0b74681}} 
\index{MCMCProcessor@{MCMCProcessor}!Post2DPlotThreshold@{Post2DPlotThreshold}}
\index{Post2DPlotThreshold@{Post2DPlotThreshold}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{Post2DPlotThreshold}{Post2DPlotThreshold}}
{\footnotesize\ttfamily double MCMCProcessor\+::\+Post2\+DPlot\+Threshold\hspace{0.3cm}{\ttfamily [private]}}



KS\+: Set Threshold when to plot 2D posterior as by default we get a LOT of plots. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00401}{401}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}\label{classMCMCProcessor_a82e6cfef1ba6fcfc8ac8f61acb5bf931}} 
\index{MCMCProcessor@{MCMCProcessor}!Posterior@{Posterior}}
\index{Posterior@{Posterior}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{Posterior}{Posterior}}
{\footnotesize\ttfamily TCanvas$\ast$ MCMCProcessor\+::\+Posterior\hspace{0.3cm}{\ttfamily [private]}}



Fancy canvas used for our beautiful plots. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00413}{413}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a85917e25c4f5b5b966c50cccd9ddd6a0}\label{classMCMCProcessor_a85917e25c4f5b5b966c50cccd9ddd6a0}} 
\index{MCMCProcessor@{MCMCProcessor}!Posterior1DCut@{Posterior1DCut}}
\index{Posterior1DCut@{Posterior1DCut}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{Posterior1DCut}{Posterior1DCut}}
{\footnotesize\ttfamily std\+::string MCMCProcessor\+::\+Posterior1\+DCut\hspace{0.3cm}{\ttfamily [private]}}



Cut used when making 1D Posterior distribution. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00325}{325}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}\label{classMCMCProcessor_ad73755714ae3d6dc951158d5513c6eee}} 
\index{MCMCProcessor@{MCMCProcessor}!printToPDF@{printToPDF}}
\index{printToPDF@{printToPDF}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{printToPDF}{printToPDF}}
{\footnotesize\ttfamily bool MCMCProcessor\+::print\+To\+PDF\hspace{0.3cm}{\ttfamily [private]}}



Will plot all plot to PDF not only to root file. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00393}{393}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a3660e404a6631cfa913a815481730a9b}\label{classMCMCProcessor_a3660e404a6631cfa913a815481730a9b}} 
\index{MCMCProcessor@{MCMCProcessor}!SampleName\_v@{SampleName\_v}}
\index{SampleName\_v@{SampleName\_v}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{SampleName\_v}{SampleName\_v}}
{\footnotesize\ttfamily std\+::vector$<$TString$>$ MCMCProcessor\+::\+Sample\+Name\+\_\+v\hspace{0.3cm}{\ttfamily [private]}}



Vector of each systematic. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00373}{373}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a28e89498420221149ec97c353c430bf8}\label{classMCMCProcessor_a28e89498420221149ec97c353c430bf8}} 
\index{MCMCProcessor@{MCMCProcessor}!SampleValues@{SampleValues}}
\index{SampleValues@{SampleValues}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{SampleValues}{SampleValues}}
{\footnotesize\ttfamily double$\ast$$\ast$ MCMCProcessor\+::\+Sample\+Values\hspace{0.3cm}{\ttfamily [private]}}



Holds the sample values. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00476}{476}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a576f0eb874afaf7e31ff5c86b9e5b8f9}\label{classMCMCProcessor_a576f0eb874afaf7e31ff5c86b9e5b8f9}} 
\index{MCMCProcessor@{MCMCProcessor}!StepCut@{StepCut}}
\index{StepCut@{StepCut}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{StepCut}{StepCut}}
{\footnotesize\ttfamily std\+::string MCMCProcessor\+::\+Step\+Cut\hspace{0.3cm}{\ttfamily [private]}}



Burn\+In Cuts. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00323}{323}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}\label{classMCMCProcessor_a07549f3b67ca5409218d80c679f6e69e}} 
\index{MCMCProcessor@{MCMCProcessor}!StepNumber@{StepNumber}}
\index{StepNumber@{StepNumber}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{StepNumber}{StepNumber}}
{\footnotesize\ttfamily int$\ast$ MCMCProcessor\+::\+Step\+Number\hspace{0.3cm}{\ttfamily [private]}}



Step number for step, important if chains were merged. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00452}{452}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_acb1871575fdd3ae156aed4bf7c7a0a73}\label{classMCMCProcessor_acb1871575fdd3ae156aed4bf7c7a0a73}} 
\index{MCMCProcessor@{MCMCProcessor}!SystName\_v@{SystName\_v}}
\index{SystName\_v@{SystName\_v}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{SystName\_v}{SystName\_v}}
{\footnotesize\ttfamily std\+::vector$<$TString$>$ MCMCProcessor\+::\+Syst\+Name\+\_\+v\hspace{0.3cm}{\ttfamily [private]}}



Vector of each sample PDF object. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00375}{375}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a4eb2748c81b0aef9bd7e14785559e301}\label{classMCMCProcessor_a4eb2748c81b0aef9bd7e14785559e301}} 
\index{MCMCProcessor@{MCMCProcessor}!SystValues@{SystValues}}
\index{SystValues@{SystValues}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{SystValues}{SystValues}}
{\footnotesize\ttfamily double$\ast$$\ast$ MCMCProcessor\+::\+Syst\+Values\hspace{0.3cm}{\ttfamily [private]}}



Holds the systs values. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00478}{478}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.

\mbox{\Hypertarget{classMCMCProcessor_a840c686f15f419c0156df01c4ed62931}\label{classMCMCProcessor_a840c686f15f419c0156df01c4ed62931}} 
\index{MCMCProcessor@{MCMCProcessor}!UpperCut@{UpperCut}}
\index{UpperCut@{UpperCut}!MCMCProcessor@{MCMCProcessor}}
\doxysubsubsection{\texorpdfstring{UpperCut}{UpperCut}}
{\footnotesize\ttfamily int MCMCProcessor\+::\+Upper\+Cut\hspace{0.3cm}{\ttfamily [private]}}



KS\+: Used only for Sub\+Optimality. 



Definition at line \mbox{\hyperlink{MCMCProcessor_8h_source_l00327}{327}} of file \mbox{\hyperlink{MCMCProcessor_8h_source}{MCMCProcessor.\+h}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/runner/work/\+Ma\+Ch3/\+Ma\+Ch3/mcmc/\mbox{\hyperlink{MCMCProcessor_8h}{MCMCProcessor.\+h}}\item 
/home/runner/work/\+Ma\+Ch3/\+Ma\+Ch3/mcmc/\mbox{\hyperlink{MCMCProcessor_8cpp}{MCMCProcessor.\+cpp}}\end{DoxyCompactItemize}
