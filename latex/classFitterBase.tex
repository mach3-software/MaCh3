\hypertarget{classFitterBase}{}\doxysection{Fitter\+Base Class Reference}
\label{classFitterBase}\index{FitterBase@{FitterBase}}


Base class for implementing fitting algorithms.  




{\ttfamily \#include $<$/home/runner/work/\+Ma\+Ch3/\+Ma\+Ch3/mcmc/\+Fitter\+Base.\+h$>$}



Inheritance diagram for Fitter\+Base\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=247pt]{classFitterBase__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for Fitter\+Base\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classFitterBase__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classFitterBase_a2d45811f9bcb9719f312048bbd36a423}{Fitter\+Base}} (\mbox{\hyperlink{classmanager}{manager}} $\ast$const \mbox{\hyperlink{classFitterBase_a4fceb68f242feeb04a0ddf42a5a37095}{fit\+Man}})
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
virtual \mbox{\hyperlink{classFitterBase_ae8677b449e49ca86bafee685e8dbe93f}{$\sim$\+Fitter\+Base}} ()
\begin{DoxyCompactList}\small\item\em Destructor for the \mbox{\hyperlink{classFitterBase}{Fitter\+Base}} class. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classFitterBase_abe93c6d49aa079d811a9021de59691b1}{add\+Sample\+PDF}} (\mbox{\hyperlink{classsamplePDFBase}{sample\+PDFBase}} $\ast$sample)
\begin{DoxyCompactList}\small\item\em This function adds a sample PDF object to the analysis framework. The sample PDF object will be utilized in fitting procedures or likelihood scans. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classFitterBase_a1d0068193922448a6fed0e0d3ff4305a}{add\+Syst\+Obj}} (\mbox{\hyperlink{classcovarianceBase}{covariance\+Base}} $\ast$cov)
\begin{DoxyCompactList}\small\item\em This function adds a Covariance object to the analysis framework. The Covariance object will be utilized in fitting procedures or likelihood scans. \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{classFitterBase_a1a9666dc09f91af804954e8968bc7b24}{run\+MCMC}} ()=0
\begin{DoxyCompactList}\small\item\em The specific fitting algorithm implemented in this function depends on the derived class. It could be Markov Chain Monte Carlo (MCMC), \mbox{\hyperlink{classMinuitFit}{Minuit\+Fit}}, or another algorithm. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classFitterBase_ab3db1d0bb7364e70cd432a3e1c0a600e}{Drag\+Race}} (const int NLaps=100)
\begin{DoxyCompactList}\small\item\em Calculates the required time for each sample or covariance object in a drag race simulation. Inspired by Dan\textquotesingle{}s feature. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classFitterBase_a018e8d09a62bca19840e1321b49df2c0}{Run\+LLHScan}} ()
\begin{DoxyCompactList}\small\item\em Perform a 1D likelihood scan. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classFitterBase_a63820450a9089d5281769288c007db55}{Get\+Step\+Scale\+Based\+On\+LLHScan}} ()
\begin{DoxyCompactList}\small\item\em LLH scan is good first estimate of step scale. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classFitterBase_ab8b32ca268c20dd643eaf92dae04cd0a}{Run2\+DLLHScan}} ()
\begin{DoxyCompactList}\small\item\em Perform a 2D likelihood scan. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classFitterBase_a71e43b96395568e54879d9bd1b57c0f8}{Run\+Sigma\+Var}} ()
\begin{DoxyCompactList}\small\item\em Perform a 2D and 1D sigma var for all samples. \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{classFitterBase_a655ccea31627627e2b36745c97e5c0f0}{Start\+From\+Previous\+Fit}} (const std\+::string \&Fit\+Name)
\begin{DoxyCompactList}\small\item\em Allow to start from previous fit/chain. \end{DoxyCompactList}\item 
virtual std\+::string \mbox{\hyperlink{classFitterBase_a3706f6d722073b447b3de8c3a6516601}{Get\+Name}} () const
\begin{DoxyCompactList}\small\item\em Get name of class. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classFitterBase_a1dccdac8611e70c759c47a65f2b1aea7}{Process\+MCMC}} ()
\begin{DoxyCompactList}\small\item\em Process MCMC output. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classFitterBase_a53715760edd8c7640432f31793fd28f9}{Prepare\+Output}} ()
\begin{DoxyCompactList}\small\item\em Prepare the output file. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classFitterBase_a418f581b688f035211107ddd83168c08}{Save\+Output}} ()
\begin{DoxyCompactList}\small\item\em Save output and close files. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classFitterBase_a48f38bfa8996fe00d51f35b05dd16b46}{Save\+Settings}} ()
\begin{DoxyCompactList}\small\item\em Save the settings that the MCMC was run with. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classmanager}{manager}} $\ast$ \mbox{\hyperlink{classFitterBase_a4fceb68f242feeb04a0ddf42a5a37095}{fit\+Man}}
\begin{DoxyCompactList}\small\item\em The manager. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaCh3Modes}{Ma\+Ch3\+Modes}} $\ast$ \mbox{\hyperlink{classFitterBase_a004cb6e6168032d9280ce3db912f1a43}{Modes}}
\begin{DoxyCompactList}\small\item\em Ma\+Ch3 Modes. \end{DoxyCompactList}\item 
unsigned int \mbox{\hyperlink{classFitterBase_a50df1bd75b20a953f81ab9c2bab6b42c}{step}}
\begin{DoxyCompactList}\small\item\em current state \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classFitterBase_abfb6f10720764d8bbbe43754fd5cd976}{log\+LCurr}}
\begin{DoxyCompactList}\small\item\em current likelihood \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classFitterBase_a187dd22c17f9e96e5a7e2fb2371abace}{log\+LProp}}
\begin{DoxyCompactList}\small\item\em proposed likelihood \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classFitterBase_a6319d2ea50984860475bbc6c708b0d90}{acc\+Prob}}
\begin{DoxyCompactList}\small\item\em current acceptance prob \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classFitterBase_a2774f3a0047c4347ee0db05406425f79}{acc\+Count}}
\begin{DoxyCompactList}\small\item\em counts accepted steps \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \mbox{\hyperlink{classFitterBase_a6f435e161c96eea778aba844115428d4}{sample\+\_\+llh}}
\begin{DoxyCompactList}\small\item\em store the llh breakdowns \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \mbox{\hyperlink{classFitterBase_ace2eeca9829f63200c3f956c600d09ff}{syst\+\_\+llh}}
\begin{DoxyCompactList}\small\item\em systematic llh breakdowns \end{DoxyCompactList}\item 
std\+::vector$<$ \mbox{\hyperlink{classsamplePDFBase}{sample\+PDFBase}} $\ast$ $>$ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}
\begin{DoxyCompactList}\small\item\em Sample holder. \end{DoxyCompactList}\item 
unsigned int \mbox{\hyperlink{classFitterBase_abe9814558b8ff1bccdde3b4c894467e6}{Total\+NSamples}}
\begin{DoxyCompactList}\small\item\em Total number of samples used. \end{DoxyCompactList}\item 
std\+::vector$<$ \mbox{\hyperlink{classcovarianceBase}{covariance\+Base}} $\ast$ $>$ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}
\begin{DoxyCompactList}\small\item\em Systematic holder. \end{DoxyCompactList}\item 
std\+::unique\+\_\+ptr$<$ TStopwatch $>$ \mbox{\hyperlink{classFitterBase_a858edb45544f690e90b60b9e041394a6}{clock}}
\begin{DoxyCompactList}\small\item\em tells global time how long fit took \end{DoxyCompactList}\item 
std\+::unique\+\_\+ptr$<$ TStopwatch $>$ \mbox{\hyperlink{classFitterBase_a9fe01b2b6f7f0d6a7b04675a099e1a4f}{step\+Clock}}
\begin{DoxyCompactList}\small\item\em tells how long single step/fit iteration took \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classFitterBase_a8354e9a7a9cc534277ff76ab37c9a763}{step\+Time}}
\begin{DoxyCompactList}\small\item\em Time of single step. \end{DoxyCompactList}\item 
std\+::unique\+\_\+ptr$<$ TRandom3 $>$ \mbox{\hyperlink{classFitterBase_a138f250d9204a30204e4ca5b973008b2}{random}}
\begin{DoxyCompactList}\small\item\em Random number. \end{DoxyCompactList}\item 
TFile $\ast$ \mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{output\+File}}
\begin{DoxyCompactList}\small\item\em Output. \end{DoxyCompactList}\item 
TDirectory $\ast$ \mbox{\hyperlink{classFitterBase_aacc46437245ba8a9817f2ed2e86a96e0}{Cov\+Folder}}
\begin{DoxyCompactList}\small\item\em Output cov folder. \end{DoxyCompactList}\item 
TTree $\ast$ \mbox{\hyperlink{classFitterBase_aed2032b9c4a4f2248abe548f54f8dcc8}{out\+Tree}}
\begin{DoxyCompactList}\small\item\em Output tree with posteriors. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classFitterBase_ad955982e63066918cba9c53381608d09}{auto\+\_\+save}}
\begin{DoxyCompactList}\small\item\em auto save every N steps \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classFitterBase_ada898e35bab22af470f2cd1e28af609b}{f\+Test\+Likelihood}}
\begin{DoxyCompactList}\small\item\em Necessary for some fitting algorithms like \mbox{\hyperlink{classPSO}{PSO}}. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classFitterBase_aedd882d8e4d0da0f89cf94e3a008affe}{save\+\_\+nominal}}
\begin{DoxyCompactList}\small\item\em save nominal matrix info or not \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classFitterBase_a490b8614c4089c6db10ff357e7aaab67}{Save\+Proposal}}
\begin{DoxyCompactList}\small\item\em Save proposal at each step. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classFitterBase_a699abe6a2c89706b54544212152d613a}{File\+Saved}}
\begin{DoxyCompactList}\small\item\em Checks if file saved not repeat some operations. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classFitterBase_a588678c71d816f48ba3c140543dbe916}{Settings\+Saved}}
\begin{DoxyCompactList}\small\item\em Checks if setting saved not repeat some operations. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classFitterBase_a3bfd8f69df891d03bae0587cd1a1e1b7}{Output\+Prepared}}
\begin{DoxyCompactList}\small\item\em Checks if output prepared not repeat some operations. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Base class for implementing fitting algorithms. 

\begin{DoxySeeAlso}{See also}
For more details, visit the \href{https://github.com/mach3-software/MaCh3/wiki/06.-Fitting-Algorithms}{\texttt{ Wiki}}. 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00023}{23}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classFitterBase_a2d45811f9bcb9719f312048bbd36a423}\label{classFitterBase_a2d45811f9bcb9719f312048bbd36a423}} 
\index{FitterBase@{FitterBase}!FitterBase@{FitterBase}}
\index{FitterBase@{FitterBase}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{FitterBase()}{FitterBase()}}
{\footnotesize\ttfamily Fitter\+Base\+::\+Fitter\+Base (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classmanager}{manager}} $\ast$const}]{fit\+Man }\end{DoxyParamCaption})}



Constructor. 


\begin{DoxyParams}{Parameters}
{\em fit\+Man} & A pointer to a manager object, which will handle all settings. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{FitterBase_8cpp_source_l00013}{13}} of file \mbox{\hyperlink{FitterBase_8cpp_source}{Fitter\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00013\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classFitterBase_a4fceb68f242feeb04a0ddf42a5a37095}{fitMan}}(\mbox{\hyperlink{GetPostfitParamPlots_8cpp_aa6f3c9a8cee8f72f6f8ce65b720a2d40}{man}})\ \{}
\DoxyCodeLine{00014\ \textcolor{comment}{//\ *************************}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \ \ \textcolor{comment}{//Get\ mach3\ modes\ from\ manager}}
\DoxyCodeLine{00017\ \ \ \mbox{\hyperlink{classFitterBase_a004cb6e6168032d9280ce3db912f1a43}{Modes}}\ =\ \mbox{\hyperlink{classFitterBase_a4fceb68f242feeb04a0ddf42a5a37095}{fitMan}}-\/>\mbox{\hyperlink{classmanager_a297a81517f0a46bda90f42b211e42cf5}{GetMaCh3Modes}}();}
\DoxyCodeLine{00018\ \ \ \mbox{\hyperlink{classFitterBase_a138f250d9204a30204e4ca5b973008b2}{random}}\ =\ std::make\_unique<TRandom3>(\mbox{\hyperlink{classFitterBase_a4fceb68f242feeb04a0ddf42a5a37095}{fitMan}}-\/>\mbox{\hyperlink{classmanager_ab3999cc856ede72b37f68bdb28bd5520}{raw}}()[\textcolor{stringliteral}{"{}General"{}}][\textcolor{stringliteral}{"{}Seed"{}}].as<\textcolor{keywordtype}{int}>());}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \ \ \textcolor{comment}{//\ Counter\ of\ the\ accepted\ \#\ of\ steps}}
\DoxyCodeLine{00021\ \ \ \mbox{\hyperlink{classFitterBase_a2774f3a0047c4347ee0db05406425f79}{accCount}}\ =\ 0;}
\DoxyCodeLine{00022\ \ \ \mbox{\hyperlink{classFitterBase_a50df1bd75b20a953f81ab9c2bab6b42c}{step}}\ =\ 0;}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \ \ \mbox{\hyperlink{classFitterBase_a858edb45544f690e90b60b9e041394a6}{clock}}\ =\ std::make\_unique<TStopwatch>();}
\DoxyCodeLine{00025\ \ \ \mbox{\hyperlink{classFitterBase_a9fe01b2b6f7f0d6a7b04675a099e1a4f}{stepClock}}\ =\ std::make\_unique<TStopwatch>();}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\ \ \#ifdef\ DEBUG}}
\DoxyCodeLine{00027\ \ \ \textcolor{comment}{//\ Fit\ summary\ and\ debug\ info}}
\DoxyCodeLine{00028\ \ \ debug\ =\ GetFromManager<bool>(\mbox{\hyperlink{classFitterBase_a4fceb68f242feeb04a0ddf42a5a37095}{fitMan}}-\/>\mbox{\hyperlink{classmanager_ab3999cc856ede72b37f68bdb28bd5520}{raw}}()[\textcolor{stringliteral}{"{}General"{}}][\textcolor{stringliteral}{"{}Debug"{}}],\ \textcolor{keyword}{false});}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \ \ \textcolor{keyword}{auto}\ outfile\ =\ \mbox{\hyperlink{classFitterBase_a4fceb68f242feeb04a0ddf42a5a37095}{fitMan}}-\/>\mbox{\hyperlink{classmanager_ab3999cc856ede72b37f68bdb28bd5520}{raw}}()[\textcolor{stringliteral}{"{}General"{}}][\textcolor{stringliteral}{"{}OutputFile"{}}].as<std::string>();}
\DoxyCodeLine{00032\ \ \ \textcolor{comment}{//\ Save\ output\ every\ auto\_save\ steps}}
\DoxyCodeLine{00033\ \ \ \textcolor{comment}{//you\ don't\ want\ this\ too\ often\ https://root.cern/root/html606/TTree\_8cxx\_source.html\#l01229}}
\DoxyCodeLine{00034\ \ \ \mbox{\hyperlink{classFitterBase_ad955982e63066918cba9c53381608d09}{auto\_save}}\ =\ \mbox{\hyperlink{classFitterBase_a4fceb68f242feeb04a0ddf42a5a37095}{fitMan}}-\/>\mbox{\hyperlink{classmanager_ab3999cc856ede72b37f68bdb28bd5520}{raw}}()[\textcolor{stringliteral}{"{}General"{}}][\textcolor{stringliteral}{"{}MCMC"{}}][\textcolor{stringliteral}{"{}AutoSave"{}}].as<\textcolor{keywordtype}{int}>();}
\DoxyCodeLine{00035\ \ \ \textcolor{comment}{//\ Do\ we\ want\ to\ save\ the\ nominal\ parameters\ to\ output}}
\DoxyCodeLine{00036\ \ \ \mbox{\hyperlink{classFitterBase_aedd882d8e4d0da0f89cf94e3a008affe}{save\_nominal}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \ \ \textcolor{comment}{//\ Do\ we\ want\ to\ save\ proposal?\ This\ will\ break\ plotting\ scripts\ and\ is\ heave\ for\ disk\ space\ and\ step\ time.\ Only\ use\ when\ debugging}}
\DoxyCodeLine{00039\ \ \ \mbox{\hyperlink{classFitterBase_a490b8614c4089c6db10ff357e7aaab67}{SaveProposal}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{00042\ \ \ \textcolor{comment}{//KS:\ TODO\ This\ should\ help\ with\ performance\ when\ saving\ entries\ to\ ROOT\ file.\ I\ didn't\ have\ time\ to\ validate\ hence\ commented\ out}}
\DoxyCodeLine{00043\ \ \ \textcolor{comment}{//Based\ on\ other\ tests\ it\ is\ really\ helpful}}
\DoxyCodeLine{00044\ \ \ \textcolor{comment}{//ROOT::EnableImplicitMT();}}
\DoxyCodeLine{00045\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{00046\ \ \ \textcolor{comment}{//\ Set\ the\ output\ file}}
\DoxyCodeLine{00047\ \ \ \mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}}\ =\ \textcolor{keyword}{new}\ TFile(outfile.c\_str(),\ \textcolor{stringliteral}{"{}RECREATE"{}});}
\DoxyCodeLine{00048\ \ \ \mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}}-\/>cd();}
\DoxyCodeLine{00049\ \ \ \textcolor{comment}{//\ Set\ output\ tree}}
\DoxyCodeLine{00050\ \ \ \mbox{\hyperlink{classFitterBase_aed2032b9c4a4f2248abe548f54f8dcc8}{outTree}}\ =\ \textcolor{keyword}{new}\ TTree(\textcolor{stringliteral}{"{}posteriors"{}},\ \textcolor{stringliteral}{"{}Posterior\_Distributions"{}});}
\DoxyCodeLine{00051\ \ \ \textcolor{comment}{//\ Auto-\/save\ every\ 200MB,\ the\ bigger\ the\ better\ https://root.cern/root/html606/TTree\_8cxx\_source.html\#l01229}}
\DoxyCodeLine{00052\ \ \ \mbox{\hyperlink{classFitterBase_aed2032b9c4a4f2248abe548f54f8dcc8}{outTree}}-\/>SetAutoSave(-\/200E6);}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \mbox{\hyperlink{classFitterBase_a699abe6a2c89706b54544212152d613a}{FileSaved}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00055\ \ \ \mbox{\hyperlink{classFitterBase_a588678c71d816f48ba3c140543dbe916}{SettingsSaved}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00056\ \ \ \mbox{\hyperlink{classFitterBase_a3bfd8f69df891d03bae0587cd1a1e1b7}{OutputPrepared}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ \ \ \textcolor{comment}{//Create\ TDirectory}}
\DoxyCodeLine{00059\ \ \ \mbox{\hyperlink{classFitterBase_aacc46437245ba8a9817f2ed2e86a96e0}{CovFolder}}\ =\ \mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}CovarianceFolder"{}});}
\DoxyCodeLine{00060\ \ \ \mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}}-\/>cd();}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \textcolor{preprocessor}{\ \ \#ifdef\ DEBUG}}
\DoxyCodeLine{00063\ \ \ \textcolor{comment}{//\ Prepare\ the\ output\ log\ file}}
\DoxyCodeLine{00064\ \ \ \textcolor{keywordflow}{if}\ (debug)\ debugFile.open((outfile+\textcolor{stringliteral}{"{}.log"{}}).c\_str());}
\DoxyCodeLine{00065\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \ \ \mbox{\hyperlink{classFitterBase_abe9814558b8ff1bccdde3b4c894467e6}{TotalNSamples}}\ =\ 0;}
\DoxyCodeLine{00068\ \ \ \mbox{\hyperlink{classFitterBase_ada898e35bab22af470f2cd1e28af609b}{fTestLikelihood}}\ =\ GetFromManager<bool>(\mbox{\hyperlink{classFitterBase_a4fceb68f242feeb04a0ddf42a5a37095}{fitMan}}-\/>\mbox{\hyperlink{classmanager_ab3999cc856ede72b37f68bdb28bd5520}{raw}}()[\textcolor{stringliteral}{"{}General"{}}][\textcolor{stringliteral}{"{}Fitter"{}}][\textcolor{stringliteral}{"{}FitTestLikelihood"{}}],\ \textcolor{keyword}{false});}
\DoxyCodeLine{00069\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classFitterBase_ae8677b449e49ca86bafee685e8dbe93f}\label{classFitterBase_ae8677b449e49ca86bafee685e8dbe93f}} 
\index{FitterBase@{FitterBase}!````~FitterBase@{$\sim$FitterBase}}
\index{````~FitterBase@{$\sim$FitterBase}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{$\sim$FitterBase()}{~FitterBase()}}
{\footnotesize\ttfamily Fitter\+Base\+::$\sim$\+Fitter\+Base (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Destructor for the \mbox{\hyperlink{classFitterBase}{Fitter\+Base}} class. 



Definition at line \mbox{\hyperlink{FitterBase_8cpp_source_l00073}{73}} of file \mbox{\hyperlink{FitterBase_8cpp_source}{Fitter\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00074\ \textcolor{comment}{//\ *************************}}
\DoxyCodeLine{00075\ \ \ \mbox{\hyperlink{classFitterBase_a418f581b688f035211107ddd83168c08}{SaveOutput}}();}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}}\ !=\ \textcolor{keyword}{nullptr})\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}};}
\DoxyCodeLine{00078\ \ \ \mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00079\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a4db4657acad5c79ac4bbb66a9d1c5905}{MACH3LOG\_DEBUG}}(\textcolor{stringliteral}{"{}Closing\ MaCh3\ Fitter\ Engine"{}});}
\DoxyCodeLine{00080\ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classFitterBase_abe93c6d49aa079d811a9021de59691b1}\label{classFitterBase_abe93c6d49aa079d811a9021de59691b1}} 
\index{FitterBase@{FitterBase}!addSamplePDF@{addSamplePDF}}
\index{addSamplePDF@{addSamplePDF}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{addSamplePDF()}{addSamplePDF()}}
{\footnotesize\ttfamily void Fitter\+Base\+::add\+Sample\+PDF (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classsamplePDFBase}{sample\+PDFBase}} $\ast$}]{sample }\end{DoxyParamCaption})}



This function adds a sample PDF object to the analysis framework. The sample PDF object will be utilized in fitting procedures or likelihood scans. 


\begin{DoxyParams}{Parameters}
{\em sample} & A pointer to a sample PDF object derived from \mbox{\hyperlink{classsamplePDFBase}{sample\+PDFBase}}. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{FitterBase_8cpp_source_l00240}{240}} of file \mbox{\hyperlink{FitterBase_8cpp_source}{Fitter\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00241\ \textcolor{comment}{//\ *************************}}
\DoxyCodeLine{00242\ \ \ \mbox{\hyperlink{classFitterBase_abe9814558b8ff1bccdde3b4c894467e6}{TotalNSamples}}\ +=\ sample-\/>\mbox{\hyperlink{classsamplePDFBase_a1d691bd9b033f80ebbce926b46972e97}{GetNsamples}}();}
\DoxyCodeLine{00243\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Adding\ \{\}\ object,\ with\ \{\}\ samples"{}},\ sample-\/>\mbox{\hyperlink{classsamplePDFBase_a1d89044c7ad25a5782673075842565de}{GetName}}(),\ sample-\/>\mbox{\hyperlink{classsamplePDFBase_a1d691bd9b033f80ebbce926b46972e97}{GetNsamples}}());}
\DoxyCodeLine{00244\ \ \ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.push\_back(sample);}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00246\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00247\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classFitterBase_a1d0068193922448a6fed0e0d3ff4305a}\label{classFitterBase_a1d0068193922448a6fed0e0d3ff4305a}} 
\index{FitterBase@{FitterBase}!addSystObj@{addSystObj}}
\index{addSystObj@{addSystObj}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{addSystObj()}{addSystObj()}}
{\footnotesize\ttfamily void Fitter\+Base\+::add\+Syst\+Obj (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classcovarianceBase}{covariance\+Base}} $\ast$}]{cov }\end{DoxyParamCaption})}



This function adds a Covariance object to the analysis framework. The Covariance object will be utilized in fitting procedures or likelihood scans. 


\begin{DoxyParams}{Parameters}
{\em cov} & A pointer to a Covariance object derived from \mbox{\hyperlink{classcovarianceBase}{covariance\+Base}}. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{FitterBase_8cpp_source_l00251}{251}} of file \mbox{\hyperlink{FitterBase_8cpp_source}{Fitter\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00252\ \textcolor{comment}{//\ *************************}}
\DoxyCodeLine{00253\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Adding\ systematic\ object\ \{\},\ with\ \{\}\ params"{}},\ cov-\/>\mbox{\hyperlink{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}{getName}}(),\ cov-\/>\mbox{\hyperlink{classcovarianceBase_a3daac6405cc791347b768a5afe8a13d2}{GetNumParams}}());}
\DoxyCodeLine{00254\ \ \ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}.push\_back(cov);}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ \ \ \mbox{\hyperlink{classFitterBase_aacc46437245ba8a9817f2ed2e86a96e0}{CovFolder}}-\/>cd();}
\DoxyCodeLine{00257\ \ \ std::vector<double>\ n\_vec(cov-\/>\mbox{\hyperlink{classcovarianceBase_a3daac6405cc791347b768a5afe8a13d2}{GetNumParams}}());}
\DoxyCodeLine{00258\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ cov-\/>\mbox{\hyperlink{classcovarianceBase_a3daac6405cc791347b768a5afe8a13d2}{GetNumParams}}();\ ++i)}
\DoxyCodeLine{00259\ \ \ \ \ n\_vec[i]\ =\ cov-\/>\mbox{\hyperlink{classcovarianceBase_a1cede85accaac2ea7056740893d90c49}{getParInit}}(i);}
\DoxyCodeLine{00260\ }
\DoxyCodeLine{00261\ \ \ TVectorT<double>\ t\_vec(cov-\/>\mbox{\hyperlink{classcovarianceBase_a3daac6405cc791347b768a5afe8a13d2}{GetNumParams}}(),\ n\_vec.data());}
\DoxyCodeLine{00262\ \ \ t\_vec.Write((cov-\/>\mbox{\hyperlink{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}{getName}}()\ +\ \textcolor{stringliteral}{"{}\_prior"{}}).c\_str());}
\DoxyCodeLine{00263\ }
\DoxyCodeLine{00264\ \ \ cov-\/>\mbox{\hyperlink{classcovarianceBase_a5968a05b1139d72344ea08b8cd6c76c6}{getCovMatrix}}()-\/>Write(cov-\/>\mbox{\hyperlink{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}{getName}}().c\_str());}
\DoxyCodeLine{00265\ }
\DoxyCodeLine{00266\ \ \ TH2D*\ CorrMatrix\ =\ cov-\/>\mbox{\hyperlink{classcovarianceBase_ac14fabdb87f5101cdbfcecb8e6b6b811}{GetCorrelationMatrix}}();}
\DoxyCodeLine{00267\ \ \ CorrMatrix-\/>Write((cov-\/>\mbox{\hyperlink{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}{getName}}()\ +\ std::string(\textcolor{stringliteral}{"{}\_Corr"{}})).c\_str());}
\DoxyCodeLine{00268\ \ \ \textcolor{keyword}{delete}\ CorrMatrix;}
\DoxyCodeLine{00269\ }
\DoxyCodeLine{00270\ \ \ \textcolor{comment}{//\ If\ we\ have\ yaml\ config\ file\ for\ covariance\ let's\ save\ it}}
\DoxyCodeLine{00271\ \ \ YAML::Node\ Config\ =\ cov-\/>\mbox{\hyperlink{classcovarianceBase_a61936f5c39ad7902624222fc49ad1362}{GetConfig}}();}
\DoxyCodeLine{00272\ \ \ \textcolor{keywordflow}{if}(!Config.IsNull())}
\DoxyCodeLine{00273\ \ \ \{}
\DoxyCodeLine{00274\ \ \ \ \ TMacro\ ConfigSave\ =\ \mbox{\hyperlink{YamlHelper_8h_a2d4f3247b6e13ef8c127ff66e699d3cb}{YAMLtoTMacro}}(Config,\ (std::string(\textcolor{stringliteral}{"{}Config\_"{}})\ +\ cov-\/>\mbox{\hyperlink{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}{getName}}()));}
\DoxyCodeLine{00275\ \ \ \ \ ConfigSave.Write();}
\DoxyCodeLine{00276\ \ \ \}}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00278\ \ \ \mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}}-\/>cd();}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00281\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classFitterBase_ab3db1d0bb7364e70cd432a3e1c0a600e}\label{classFitterBase_ab3db1d0bb7364e70cd432a3e1c0a600e}} 
\index{FitterBase@{FitterBase}!DragRace@{DragRace}}
\index{DragRace@{DragRace}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{DragRace()}{DragRace()}}
{\footnotesize\ttfamily void Fitter\+Base\+::\+Drag\+Race (\begin{DoxyParamCaption}\item[{const int}]{NLaps = {\ttfamily 100} }\end{DoxyParamCaption})}



Calculates the required time for each sample or covariance object in a drag race simulation. Inspired by Dan\textquotesingle{}s feature. 


\begin{DoxyParams}{Parameters}
{\em NLaps} & number of laps, every part of Fitter will be tested with given number of laps and you will get total and average time \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{FitterBase_8cpp_source_l00403}{403}} of file \mbox{\hyperlink{FitterBase_8cpp_source}{Fitter\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00404\ \textcolor{comment}{//\ *************************}}
\DoxyCodeLine{00405\ }
\DoxyCodeLine{00406\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Let\ the\ Race\ Begin!"{}});}
\DoxyCodeLine{00407\ \ \ \textcolor{comment}{//\ Reweight\ the\ MC}}
\DoxyCodeLine{00408\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivs\ =\ 0;\ ivs\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ivs++\ )}
\DoxyCodeLine{00409\ \ \ \{}
\DoxyCodeLine{00410\ \ \ \ \ TStopwatch\ clockRace;}
\DoxyCodeLine{00411\ \ \ \ \ clockRace.Start();}
\DoxyCodeLine{00412\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ Lap\ =\ 0;\ Lap\ <\ NLaps;\ Lap++)\ \{}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>reweight();}
\DoxyCodeLine{00414\ \ \ \ \ \}}
\DoxyCodeLine{00415\ \ \ \ \ clockRace.Stop();}
\DoxyCodeLine{00416\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}It\ took\ \{:.4f\}\ s\ to\ reweights\ \{\}\ times\ sample:\ \{\}"{}},\ clockRace.RealTime(),\ NLaps,\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>GetName());}
\DoxyCodeLine{00417\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}On\ average\ \{:.6f\}"{}},\ clockRace.RealTime()/NLaps);}
\DoxyCodeLine{00418\ \ \ \}}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00420\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivs\ =\ 0;\ ivs\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ivs++\ )}
\DoxyCodeLine{00421\ \ \ \{}
\DoxyCodeLine{00422\ \ \ \ \ TStopwatch\ clockRace;}
\DoxyCodeLine{00423\ \ \ \ \ clockRace.Start();}
\DoxyCodeLine{00424\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ Lap\ =\ 0;\ Lap\ <\ NLaps;\ Lap++)\ \{}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>GetLikelihood();}
\DoxyCodeLine{00426\ \ \ \ \ \}}
\DoxyCodeLine{00427\ \ \ \ \ clockRace.Stop();}
\DoxyCodeLine{00428\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}It\ took\ \{:.4f\}\ s\ to\ calculate\ \ GetLikelihood\ \{\}\ times\ sample:\ \ \{\}"{}},\ clockRace.RealTime(),\ NLaps,\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>GetName());}
\DoxyCodeLine{00429\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}On\ average\ \{:.6f\}"{}},\ clockRace.RealTime()/NLaps);}
\DoxyCodeLine{00430\ \ \ \}}
\DoxyCodeLine{00431\ \ \ \textcolor{comment}{//\ Get\ vector\ of\ proposed\ steps.\ If\ we\ want\ to\ run\ LLH\ scan\ or\ something\ else\ after\ we\ need\ to\ revert\ changes\ after\ proposing\ steps\ multiple\ times}}
\DoxyCodeLine{00432\ \ \ std::vector<std::vector<double>>\ StepsValuesBefore(\mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}.size());}
\DoxyCodeLine{00433\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ s\ =\ 0;\ s\ <\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}.size();\ ++s)\ \{}
\DoxyCodeLine{00434\ \ \ \ \ StepsValuesBefore[s]\ =\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}[s]-\/>getProposed();}
\DoxyCodeLine{00435\ \ \ \}}
\DoxyCodeLine{00436\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ s\ =\ 0;\ s\ <\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}.size();\ ++s)\ \{}
\DoxyCodeLine{00437\ \ \ \ \ TStopwatch\ clockRace;}
\DoxyCodeLine{00438\ \ \ \ \ clockRace.Start();}
\DoxyCodeLine{00439\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ Lap\ =\ 0;\ Lap\ <\ NLaps;\ Lap++)\ \{}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}[s]-\/>proposeStep();}
\DoxyCodeLine{00441\ \ \ \ \ \}}
\DoxyCodeLine{00442\ \ \ \ \ clockRace.Stop();}
\DoxyCodeLine{00443\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}It\ took\ \{:.4f\}\ s\ to\ propose\ step\ \{\}\ times\ cov:\ \ \{\}"{}},\ \ clockRace.RealTime(),\ NLaps,\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}[s]-\/>getName());}
\DoxyCodeLine{00444\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}On\ average\ \{:.6f\}"{}},\ clockRace.RealTime()/NLaps);}
\DoxyCodeLine{00445\ \ \ \}}
\DoxyCodeLine{00446\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ s\ =\ 0;\ s\ <\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}.size();\ ++s)\ \{}
\DoxyCodeLine{00447\ \ \ \ \ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}[s]-\/>setParameters(StepsValuesBefore[s]);}
\DoxyCodeLine{00448\ \ \ \}}
\DoxyCodeLine{00449\ }
\DoxyCodeLine{00450\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ s\ =\ 0;\ s\ <\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}.size();\ ++s)\ \{}
\DoxyCodeLine{00451\ \ \ \ \ TStopwatch\ clockRace;}
\DoxyCodeLine{00452\ \ \ \ \ clockRace.Start();}
\DoxyCodeLine{00453\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ Lap\ =\ 0;\ Lap\ <\ NLaps;\ Lap++)\ \{}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}[s]-\/>GetLikelihood();}
\DoxyCodeLine{00455\ \ \ \ \ \}}
\DoxyCodeLine{00456\ \ \ \ \ clockRace.Stop();}
\DoxyCodeLine{00457\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}It\ took\ \{:.4f\}\ s\ to\ calculate\ \ get\ likelihood\ \{\}\ times\ cov:\ \ \{\}"{}},\ \ clockRace.RealTime(),\ NLaps,\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}[s]-\/>getName());}
\DoxyCodeLine{00458\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}On\ average\ \{:.6f\}"{}},\ clockRace.RealTime()/NLaps);}
\DoxyCodeLine{00459\ \ \ \}}
\DoxyCodeLine{00460\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}End\ of\ race"{}});}
\DoxyCodeLine{00461\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classFitterBase_a3706f6d722073b447b3de8c3a6516601}\label{classFitterBase_a3706f6d722073b447b3de8c3a6516601}} 
\index{FitterBase@{FitterBase}!GetName@{GetName}}
\index{GetName@{GetName}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{GetName()}{GetName()}}
{\footnotesize\ttfamily virtual std\+::string Fitter\+Base\+::\+Get\+Name (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Get name of class. 



Reimplemented in \mbox{\hyperlink{classLikelihoodFit_aff5ac0361aa016cebb24d4687e0da4ac}{Likelihood\+Fit}}, \mbox{\hyperlink{classmcmc_a0446e3c1f2af2173ffd6f017fdf6f1ba}{mcmc}}, \mbox{\hyperlink{classMinuitFit_a21eb79a3aa06baf99b0e5bd86e9d5c7c}{Minuit\+Fit}}, and \mbox{\hyperlink{classPSO_a95d9cbbfdcdc4d453254a3b1477cbbab}{PSO}}.



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00066}{66}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00066\ \{\textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}FitterBase"{}};\};}

\end{DoxyCode}
\mbox{\Hypertarget{classFitterBase_a63820450a9089d5281769288c007db55}\label{classFitterBase_a63820450a9089d5281769288c007db55}} 
\index{FitterBase@{FitterBase}!GetStepScaleBasedOnLLHScan@{GetStepScaleBasedOnLLHScan}}
\index{GetStepScaleBasedOnLLHScan@{GetStepScaleBasedOnLLHScan}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{GetStepScaleBasedOnLLHScan()}{GetStepScaleBasedOnLLHScan()}}
{\footnotesize\ttfamily void Fitter\+Base\+::\+Get\+Step\+Scale\+Based\+On\+LLHScan (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



LLH scan is good first estimate of step scale. 



Definition at line \mbox{\hyperlink{FitterBase_8cpp_source_l00790}{790}} of file \mbox{\hyperlink{FitterBase_8cpp_source}{Fitter\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00790\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00791\ \textcolor{comment}{//\ *************************}}
\DoxyCodeLine{00792\ \ \ TDirectory\ *Sample\_LLH\ =\ \mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}}-\/>Get<TDirectory>(\textcolor{stringliteral}{"{}Sample\_LLH"{}});}
\DoxyCodeLine{00793\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Starting\ Get\ Step\ Scale\ Based\ On\ LLHScan"{}});}
\DoxyCodeLine{00794\ }
\DoxyCodeLine{00795\ \ \ \textcolor{keywordflow}{if}(Sample\_LLH-\/>IsZombie())}
\DoxyCodeLine{00796\ \ \ \{}
\DoxyCodeLine{00797\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Couldn't\ find\ Sample\_LLH,\ it\ looks\ like\ LLH\ scan\ wasn't\ run,\ will\ do\ this\ now"{}});}
\DoxyCodeLine{00798\ \ \ \ \ \mbox{\hyperlink{classFitterBase_a018e8d09a62bca19840e1321b49df2c0}{RunLLHScan}}();}
\DoxyCodeLine{00799\ \ \ \}}
\DoxyCodeLine{00800\ }
\DoxyCodeLine{00801\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classcovarianceBase}{covarianceBase}}\ *cov\ :\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}})}
\DoxyCodeLine{00802\ \ \ \{}
\DoxyCodeLine{00803\ \ \ \ \ \textcolor{keywordtype}{bool}\ isxsec\ =\ (cov-\/>getName()\ ==\ \textcolor{stringliteral}{"{}xsec\_cov"{}});}
\DoxyCodeLine{00804\ }
\DoxyCodeLine{00805\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ npars\ =\ cov-\/>GetNumParams();}
\DoxyCodeLine{00806\ \ \ \ \ std::vector<double>\ StepScale(npars);}
\DoxyCodeLine{00807\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ npars;\ ++i)}
\DoxyCodeLine{00808\ \ \ \ \ \{}
\DoxyCodeLine{00809\ \ \ \ \ \ \ std::string\ name\ =\ cov-\/>GetParName(i);}
\DoxyCodeLine{00810\ \ \ \ \ \ \ \textcolor{comment}{//\ For\ xsec\ we\ can\ get\ the\ actual\ name,\ hurray\ for\ being\ informative}}
\DoxyCodeLine{00811\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (isxsec)\ name\ =\ cov-\/>GetParFancyName(i);}
\DoxyCodeLine{00812\ }
\DoxyCodeLine{00813\ }
\DoxyCodeLine{00814\ \ \ \ \ \ \ StepScale[i]\ =\ cov-\/>GetIndivStepScale(i);}
\DoxyCodeLine{00815\ \ \ \ \ \ \ TH1D*\ LLHScan\ =\ Sample\_LLH-\/>Get<TH1D>((name+\textcolor{stringliteral}{"{}\_sam"{}}).c\_str());}
\DoxyCodeLine{00816\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(LLHScan\ ==\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00817\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00818\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Couldn't\ find\ LLH\ scan,\ for\ \{\},\ skipping"{}},\ name);}
\DoxyCodeLine{00819\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00820\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00821\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ LLH\_val\ =\ std::max(LLHScan-\/>GetBinContent(1),\ LLHScan-\/>GetBinContent(LLHScan-\/>GetNbinsX()));}
\DoxyCodeLine{00822\ \ \ \ \ \ \ \textcolor{comment}{//If\ there\ is\ no\ sensitivity\ leave\ it}}
\DoxyCodeLine{00823\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(LLH\_val\ <\ 0.001)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00824\ }
\DoxyCodeLine{00825\ \ \ \ \ \ \ \textcolor{comment}{//\ EM:\ assuming\ that\ the\ likelihood\ is\ gaussian,\ approximate\ sigma\ value\ is\ given\ by\ variation/sqrt(-\/2LLH)}}
\DoxyCodeLine{00826\ \ \ \ \ \ \ \textcolor{comment}{//\ can\ evaluate\ this\ at\ any\ point,\ simple\ to\ evaluate\ it\ in\ the\ first\ bin\ of\ the\ LLH\ scan}}
\DoxyCodeLine{00827\ \ \ \ \ \ \ \textcolor{comment}{//\ KS:\ We\ assume\ variation\ is\ 1\ sigma,\ each\ dial\ has\ different\ scale\ so\ it\ becomes\ faff...}}
\DoxyCodeLine{00828\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Var\ =\ 1.;}
\DoxyCodeLine{00829\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ approxSigma\ =\ TMath::Abs(Var)/std::sqrt(LLH\_val);}
\DoxyCodeLine{00830\ }
\DoxyCodeLine{00831\ \ \ \ \ \ \ \textcolor{comment}{//\ Based\ on\ Ewan\ comment\ I\ just\ took\ the\ 1sigma\ width\ from\ the\ LLH,\ assuming\ it\ was\ Gaussian,\ but\ then\ had\ to\ also\ scale\ by\ 2.38/sqrt(N\_params)}}
\DoxyCodeLine{00832\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ NewStepScale\ =\ approxSigma\ *\ 2.38/std::sqrt(npars);}
\DoxyCodeLine{00833\ \ \ \ \ \ \ StepScale[i]\ =\ NewStepScale;}
\DoxyCodeLine{00834\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a4db4657acad5c79ac4bbb66a9d1c5905}{MACH3LOG\_DEBUG}}(\textcolor{stringliteral}{"{}Sigma:\ \{\}"{}},\ approxSigma);}
\DoxyCodeLine{00835\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a4db4657acad5c79ac4bbb66a9d1c5905}{MACH3LOG\_DEBUG}}(\textcolor{stringliteral}{"{}optimal\ Step\ Size:\ \{\}"{}},\ NewStepScale);}
\DoxyCodeLine{00836\ \ \ \ \ \}}
\DoxyCodeLine{00837\ \ \ \ \ cov-\/>setIndivStepScale(StepScale);}
\DoxyCodeLine{00838\ \ \ \ \ cov-\/>SaveUpdatedMatrixConfig();}
\DoxyCodeLine{00839\ \ \ \}}
\DoxyCodeLine{00840\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classFitterBase_a53715760edd8c7640432f31793fd28f9}\label{classFitterBase_a53715760edd8c7640432f31793fd28f9}} 
\index{FitterBase@{FitterBase}!PrepareOutput@{PrepareOutput}}
\index{PrepareOutput@{PrepareOutput}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{PrepareOutput()}{PrepareOutput()}}
{\footnotesize\ttfamily void Fitter\+Base\+::\+Prepare\+Output (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Prepare the output file. 



Definition at line \mbox{\hyperlink{FitterBase_8cpp_source_l00149}{149}} of file \mbox{\hyperlink{FitterBase_8cpp_source}{Fitter\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00150\ \textcolor{comment}{//\ *******************}}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classFitterBase_a3bfd8f69df891d03bae0587cd1a1e1b7}{OutputPrepared}})\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00153\ \ \ \textcolor{comment}{//MS:\ Check\ if\ we\ are\ fitting\ the\ test\ likelihood,\ rather\ than\ T2K\ likelihood,\ and\ only\ setup\ T2K\ output\ if\ not}}
\DoxyCodeLine{00154\ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{classFitterBase_ada898e35bab22af470f2cd1e28af609b}{fTestLikelihood}})}
\DoxyCodeLine{00155\ \ \ \{}
\DoxyCodeLine{00156\ \ \ \ \ \textcolor{comment}{//\ Check\ that\ we\ have\ added\ samples}}
\DoxyCodeLine{00157\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size())\ \{}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a07ff6d6a15b24f94afc88a1b89779beb}{MACH3LOG\_CRITICAL}}(\textcolor{stringliteral}{"{}No\ samples\ Found!\ Is\ this\ really\ what\ you\ wanted?"{}});}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \textcolor{comment}{//throw\ MaCh3Exception(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}}
\DoxyCodeLine{00160\ \ \ \ \ \}}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \ \ \ \ \textcolor{comment}{//\ Prepare\ the\ output\ trees}}
\DoxyCodeLine{00163\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classcovarianceBase}{covarianceBase}}\ *cov\ :\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}})\ \{}
\DoxyCodeLine{00164\ \ \ \ \ \ \ cov-\/>SetBranches(*\mbox{\hyperlink{classFitterBase_aed2032b9c4a4f2248abe548f54f8dcc8}{outTree}},\ \mbox{\hyperlink{classFitterBase_a490b8614c4089c6db10ff357e7aaab67}{SaveProposal}});}
\DoxyCodeLine{00165\ \ \ \ \ \}}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \ \ \ \ \mbox{\hyperlink{classFitterBase_aed2032b9c4a4f2248abe548f54f8dcc8}{outTree}}-\/>Branch(\textcolor{stringliteral}{"{}LogL"{}},\ \&\mbox{\hyperlink{classFitterBase_abfb6f10720764d8bbbe43754fd5cd976}{logLCurr}},\ \textcolor{stringliteral}{"{}LogL/D"{}});}
\DoxyCodeLine{00168\ \ \ \ \ \mbox{\hyperlink{classFitterBase_aed2032b9c4a4f2248abe548f54f8dcc8}{outTree}}-\/>Branch(\textcolor{stringliteral}{"{}accProb"{}},\ \&\mbox{\hyperlink{classFitterBase_a6319d2ea50984860475bbc6c708b0d90}{accProb}},\ \textcolor{stringliteral}{"{}accProb/D"{}});}
\DoxyCodeLine{00169\ \ \ \ \ \mbox{\hyperlink{classFitterBase_aed2032b9c4a4f2248abe548f54f8dcc8}{outTree}}-\/>Branch(\textcolor{stringliteral}{"{}step"{}},\ \&\mbox{\hyperlink{classFitterBase_a50df1bd75b20a953f81ab9c2bab6b42c}{step}},\ \textcolor{stringliteral}{"{}step/I"{}});}
\DoxyCodeLine{00170\ \ \ \ \ \mbox{\hyperlink{classFitterBase_aed2032b9c4a4f2248abe548f54f8dcc8}{outTree}}-\/>Branch(\textcolor{stringliteral}{"{}stepTime"{}},\ \&\mbox{\hyperlink{classFitterBase_a8354e9a7a9cc534277ff76ab37c9a763}{stepTime}},\ \textcolor{stringliteral}{"{}stepTime/D"{}});}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \ \ \ \ \textcolor{comment}{//\ Store\ individual\ likelihood\ components}}
\DoxyCodeLine{00173\ \ \ \ \ \textcolor{comment}{//\ Using\ double\ means\ double\ as\ large\ output\ file!}}
\DoxyCodeLine{00174\ \ \ \ \ \mbox{\hyperlink{classFitterBase_a6f435e161c96eea778aba844115428d4}{sample\_llh}}.resize(\mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size());}
\DoxyCodeLine{00175\ \ \ \ \ \mbox{\hyperlink{classFitterBase_ace2eeca9829f63200c3f956c600d09ff}{syst\_llh}}.resize(\mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}.size());}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00177\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ++i)\ \{}
\DoxyCodeLine{00178\ \ \ \ \ \ \ std::stringstream\ oss,\ oss2;}
\DoxyCodeLine{00179\ \ \ \ \ \ \ oss\ <<\ \textcolor{stringliteral}{"{}LogL\_sample\_"{}}\ <<\ i;}
\DoxyCodeLine{00180\ \ \ \ \ \ \ oss2\ <<\ oss.str()\ <<\ \textcolor{stringliteral}{"{}/D"{}};}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \mbox{\hyperlink{classFitterBase_aed2032b9c4a4f2248abe548f54f8dcc8}{outTree}}-\/>Branch(oss.str().c\_str(),\ \&\mbox{\hyperlink{classFitterBase_a6f435e161c96eea778aba844115428d4}{sample\_llh}}[i],\ oss2.str().c\_str());}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ \ \ \ \ \ \ \textcolor{comment}{//\ For\ adding\ sample\ dependent\ branches\ to\ the\ posteriors\ tree}}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[i]-\/>setMCMCBranches(\mbox{\hyperlink{classFitterBase_aed2032b9c4a4f2248abe548f54f8dcc8}{outTree}});}
\DoxyCodeLine{00185\ \ \ \ \ \}}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}.size();\ ++i)\ \{}
\DoxyCodeLine{00188\ \ \ \ \ \ \ std::stringstream\ oss,\ oss2;}
\DoxyCodeLine{00189\ \ \ \ \ \ \ oss\ <<\ \textcolor{stringliteral}{"{}LogL\_systematic\_"{}}\ <<\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}[i]-\/>getName();}
\DoxyCodeLine{00190\ \ \ \ \ \ \ oss2\ <<\ oss.str()\ <<\ \textcolor{stringliteral}{"{}/D"{}};}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \mbox{\hyperlink{classFitterBase_aed2032b9c4a4f2248abe548f54f8dcc8}{outTree}}-\/>Branch(oss.str().c\_str(),\ \&\mbox{\hyperlink{classFitterBase_ace2eeca9829f63200c3f956c600d09ff}{syst\_llh}}[i],\ oss2.str().c\_str());}
\DoxyCodeLine{00192\ \ \ \ \ \}}
\DoxyCodeLine{00193\ \ \ \}}
\DoxyCodeLine{00194\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00195\ \ \ \{}
\DoxyCodeLine{00196\ \ \ \ \ \mbox{\hyperlink{classFitterBase_aed2032b9c4a4f2248abe548f54f8dcc8}{outTree}}-\/>Branch(\textcolor{stringliteral}{"{}LogL"{}},\ \&\mbox{\hyperlink{classFitterBase_abfb6f10720764d8bbbe43754fd5cd976}{logLCurr}},\ \textcolor{stringliteral}{"{}LogL/D"{}});}
\DoxyCodeLine{00197\ \ \ \ \ \mbox{\hyperlink{classFitterBase_aed2032b9c4a4f2248abe548f54f8dcc8}{outTree}}-\/>Branch(\textcolor{stringliteral}{"{}accProb"{}},\ \&\mbox{\hyperlink{classFitterBase_a6319d2ea50984860475bbc6c708b0d90}{accProb}},\ \textcolor{stringliteral}{"{}accProb/D"{}});}
\DoxyCodeLine{00198\ \ \ \ \ \mbox{\hyperlink{classFitterBase_aed2032b9c4a4f2248abe548f54f8dcc8}{outTree}}-\/>Branch(\textcolor{stringliteral}{"{}step"{}},\ \&\mbox{\hyperlink{classFitterBase_a50df1bd75b20a953f81ab9c2bab6b42c}{step}},\ \textcolor{stringliteral}{"{}step/I"{}});}
\DoxyCodeLine{00199\ \ \ \ \ \mbox{\hyperlink{classFitterBase_aed2032b9c4a4f2248abe548f54f8dcc8}{outTree}}-\/>Branch(\textcolor{stringliteral}{"{}stepTime"{}},\ \&\mbox{\hyperlink{classFitterBase_a8354e9a7a9cc534277ff76ab37c9a763}{stepTime}},\ \textcolor{stringliteral}{"{}stepTime/D"{}});}
\DoxyCodeLine{00200\ \ \ \}}
\DoxyCodeLine{00201\ }
\DoxyCodeLine{00202\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ Starting\ MCMC\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/"{}});}
\DoxyCodeLine{00203\ \textcolor{preprocessor}{\ \ \#ifdef\ DEBUG}}
\DoxyCodeLine{00204\ \ \ \textcolor{keywordflow}{if}\ (debug)\ \{}
\DoxyCodeLine{00205\ \ \ \ \ debugFile\ <<\ \textcolor{stringliteral}{"{}-\/-\/-\/-\/-\/\ Starting\ MCMC\ -\/-\/-\/-\/-\/"{}}\ <<\ std::endl;}
\DoxyCodeLine{00206\ \ \ \}}
\DoxyCodeLine{00207\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{00208\ \ \ \textcolor{comment}{//\ Time\ the\ progress}}
\DoxyCodeLine{00209\ \ \ \mbox{\hyperlink{classFitterBase_a858edb45544f690e90b60b9e041394a6}{clock}}-\/>Start();}
\DoxyCodeLine{00210\ }
\DoxyCodeLine{00211\ \ \ \mbox{\hyperlink{classFitterBase_a3bfd8f69df891d03bae0587cd1a1e1b7}{OutputPrepared}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00212\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classFitterBase_a1dccdac8611e70c759c47a65f2b1aea7}\label{classFitterBase_a1dccdac8611e70c759c47a65f2b1aea7}} 
\index{FitterBase@{FitterBase}!ProcessMCMC@{ProcessMCMC}}
\index{ProcessMCMC@{ProcessMCMC}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{ProcessMCMC()}{ProcessMCMC()}}
{\footnotesize\ttfamily void Fitter\+Base\+::\+Process\+MCMC (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Process MCMC output. 



Definition at line \mbox{\hyperlink{FitterBase_8cpp_source_l00355}{355}} of file \mbox{\hyperlink{FitterBase_8cpp_source}{Fitter\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00356\ \textcolor{comment}{//\ *******************}}
\DoxyCodeLine{00357\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classFitterBase_a4fceb68f242feeb04a0ddf42a5a37095}{fitMan}}\ ==\ \textcolor{keyword}{nullptr})\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00358\ }
\DoxyCodeLine{00359\ \ \ \textcolor{comment}{//\ Process\ the\ MCMC}}
\DoxyCodeLine{00360\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classFitterBase_a4fceb68f242feeb04a0ddf42a5a37095}{fitMan}}-\/>\mbox{\hyperlink{classmanager_ab3999cc856ede72b37f68bdb28bd5520}{raw}}()[\textcolor{stringliteral}{"{}General"{}}][\textcolor{stringliteral}{"{}ProcessMCMC"{}}].as<\textcolor{keywordtype}{bool}>())\ \{}
\DoxyCodeLine{00361\ }
\DoxyCodeLine{00362\ \ \ \ \ \textcolor{comment}{//\ Make\ the\ processor}}
\DoxyCodeLine{00363\ \ \ \ \ \mbox{\hyperlink{classMCMCProcessor}{MCMCProcessor}}\ Processor(std::string(\mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}}-\/>GetName()));}
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \ \ \ \ Processor.Initialise();}
\DoxyCodeLine{00366\ \ \ \ \ \textcolor{comment}{//\ Make\ the\ TVectorD\ pointers\ which\ hold\ the\ processed\ output}}
\DoxyCodeLine{00367\ \ \ \ \ TVectorD\ *Central\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00368\ \ \ \ \ TVectorD\ *Errors\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00369\ \ \ \ \ TVectorD\ *Central\_Gauss\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00370\ \ \ \ \ TVectorD\ *Errors\_Gauss\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00371\ \ \ \ \ TVectorD\ *Peaks\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00372\ }
\DoxyCodeLine{00373\ \ \ \ \ \textcolor{comment}{//\ Make\ the\ postfit}}
\DoxyCodeLine{00374\ \ \ \ \ Processor.GetPostfit(Central,\ Errors,\ Central\_Gauss,\ Errors\_Gauss,\ Peaks);}
\DoxyCodeLine{00375\ \ \ \ \ Processor.DrawPostfit();}
\DoxyCodeLine{00376\ }
\DoxyCodeLine{00377\ \ \ \ \ \textcolor{comment}{//\ Make\ the\ TMatrix\ pointers\ which\ hold\ the\ processed\ output}}
\DoxyCodeLine{00378\ \ \ \ \ TMatrixDSym\ *Covariance\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00379\ \ \ \ \ TMatrixDSym\ *Correlation\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00380\ }
\DoxyCodeLine{00381\ \ \ \ \ \textcolor{comment}{//\ Make\ the\ covariance\ matrix}}
\DoxyCodeLine{00382\ \ \ \ \ Processor.GetCovariance(Covariance,\ Correlation);}
\DoxyCodeLine{00383\ \ \ \ \ Processor.DrawCovariance();}
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00385\ \ \ \ \ std::vector<TString>\ \mbox{\hyperlink{GetPenaltyTerm_8cpp_a871d6466cea2597401bdb203293f4033}{BranchNames}}\ =\ Processor.GetBranchNames();}
\DoxyCodeLine{00386\ }
\DoxyCodeLine{00387\ \ \ \ \ \textcolor{comment}{//\ Re-\/open\ the\ TFile}}
\DoxyCodeLine{00388\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}}-\/>IsOpen())\ \{}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Opening\ output\ again\ to\ update\ with\ means.."{}});}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}}\ =\ \textcolor{keyword}{new}\ TFile(\mbox{\hyperlink{classFitterBase_a4fceb68f242feeb04a0ddf42a5a37095}{fitMan}}-\/>\mbox{\hyperlink{classmanager_ab3999cc856ede72b37f68bdb28bd5520}{raw}}()[\textcolor{stringliteral}{"{}General"{}}][\textcolor{stringliteral}{"{}Output"{}}][\textcolor{stringliteral}{"{}Filename"{}}].as<std::string>().c\_str(),\ \textcolor{stringliteral}{"{}UPDATE"{}});}
\DoxyCodeLine{00391\ \ \ \ \ \}}
\DoxyCodeLine{00392\ \ \ \ \ Central-\/>Write(\textcolor{stringliteral}{"{}PDF\_Means"{}});}
\DoxyCodeLine{00393\ \ \ \ \ Errors-\/>Write(\textcolor{stringliteral}{"{}PDF\_Errors"{}});}
\DoxyCodeLine{00394\ \ \ \ \ Central\_Gauss-\/>Write(\textcolor{stringliteral}{"{}Gauss\_Means"{}});}
\DoxyCodeLine{00395\ \ \ \ \ Errors\_Gauss-\/>Write(\textcolor{stringliteral}{"{}Errors\_Gauss"{}});}
\DoxyCodeLine{00396\ \ \ \ \ Covariance-\/>Write(\textcolor{stringliteral}{"{}Covariance"{}});}
\DoxyCodeLine{00397\ \ \ \ \ Correlation-\/>Write(\textcolor{stringliteral}{"{}Correlation"{}});}
\DoxyCodeLine{00398\ \ \ \}}
\DoxyCodeLine{00399\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classFitterBase_ab8b32ca268c20dd643eaf92dae04cd0a}\label{classFitterBase_ab8b32ca268c20dd643eaf92dae04cd0a}} 
\index{FitterBase@{FitterBase}!Run2DLLHScan@{Run2DLLHScan}}
\index{Run2DLLHScan@{Run2DLLHScan}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{Run2DLLHScan()}{Run2DLLHScan()}}
{\footnotesize\ttfamily void Fitter\+Base\+::\+Run2\+DLLHScan (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Perform a 2D likelihood scan. 

\begin{DoxyWarning}{Warning}
This operation may take a significant amount of time, especially for complex models. 
\end{DoxyWarning}


Definition at line \mbox{\hyperlink{FitterBase_8cpp_source_l00844}{844}} of file \mbox{\hyperlink{FitterBase_8cpp_source}{Fitter\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00844\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00845\ \textcolor{comment}{//\ *************************}}
\DoxyCodeLine{00846\ }
\DoxyCodeLine{00847\ \ \ \textcolor{comment}{//\ Save\ the\ settings\ into\ the\ output\ file}}
\DoxyCodeLine{00848\ \ \ \mbox{\hyperlink{classFitterBase_a48f38bfa8996fe00d51f35b05dd16b46}{SaveSettings}}();}
\DoxyCodeLine{00849\ }
\DoxyCodeLine{00850\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Starting\ 2D\ LLH\ Scan"{}});}
\DoxyCodeLine{00851\ }
\DoxyCodeLine{00852\ \ \ TDirectory\ *Sample\_2DLLH\ =\ \mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}Sample\_2DLLH"{}});}
\DoxyCodeLine{00853\ \ \ std::vector<std::string>\ SkipVector;}
\DoxyCodeLine{00854\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classFitterBase_a4fceb68f242feeb04a0ddf42a5a37095}{fitMan}}-\/>\mbox{\hyperlink{classmanager_ab3999cc856ede72b37f68bdb28bd5520}{raw}}()[\textcolor{stringliteral}{"{}General"{}}][\textcolor{stringliteral}{"{}LLHScanSkipVector"{}}])}
\DoxyCodeLine{00855\ \ \ \{}
\DoxyCodeLine{00856\ \ \ \ \ SkipVector\ =\ \mbox{\hyperlink{classFitterBase_a4fceb68f242feeb04a0ddf42a5a37095}{fitMan}}-\/>\mbox{\hyperlink{classmanager_ab3999cc856ede72b37f68bdb28bd5520}{raw}}()[\textcolor{stringliteral}{"{}General"{}}][\textcolor{stringliteral}{"{}LLHScanSkipVector"{}}].as<std::vector<std::string>>();}
\DoxyCodeLine{00857\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Found\ skip\ vector\ with\ \{\}\ entries"{}},\ SkipVector.size());}
\DoxyCodeLine{00858\ \ \ \}}
\DoxyCodeLine{00859\ }
\DoxyCodeLine{00860\ \ \ \textcolor{comment}{//\ Number\ of\ points\ we\ do\ for\ each\ LLH\ scan}}
\DoxyCodeLine{00861\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ n\_points\ =\ 20;}
\DoxyCodeLine{00862\ \ \ \textcolor{comment}{//\ We\ print\ 5\ reweights}}
\DoxyCodeLine{00863\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ countwidth\ =\ double(n\_points)/double(5);}
\DoxyCodeLine{00864\ }
\DoxyCodeLine{00865\ \ \ \textcolor{keywordtype}{bool}\ isxsec\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00866\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ covariance\ classes}}
\DoxyCodeLine{00867\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classcovarianceBase}{covarianceBase}}\ *cov\ :\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}})}
\DoxyCodeLine{00868\ \ \ \{}
\DoxyCodeLine{00869\ \ \ \ \ \textcolor{keywordflow}{if}\ (cov-\/>getName()\ ==\ \textcolor{stringliteral}{"{}xsec\_cov"{}})}
\DoxyCodeLine{00870\ \ \ \ \ \{}
\DoxyCodeLine{00871\ \ \ \ \ \ \ isxsec\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00872\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00873\ \ \ \ \ \ \ isxsec\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00874\ \ \ \ \ \}}
\DoxyCodeLine{00875\ \ \ \ \ \textcolor{comment}{//\ Scan\ over\ all\ the\ parameters}}
\DoxyCodeLine{00876\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ number\ of\ parameters}}
\DoxyCodeLine{00877\ \ \ \ \ \textcolor{keywordtype}{int}\ npars\ =\ cov-\/>GetNumParams();}
\DoxyCodeLine{00878\ \ \ \ \ \textcolor{keywordtype}{bool}\ IsPCA\ =\ cov-\/>IsPCA();}
\DoxyCodeLine{00879\ \ \ \ \ \textcolor{keywordflow}{if}\ (IsPCA)\ npars\ =\ cov-\/>getNpars();}
\DoxyCodeLine{00880\ }
\DoxyCodeLine{00881\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ npars;\ ++i)}
\DoxyCodeLine{00882\ \ \ \ \ \{}
\DoxyCodeLine{00883\ \ \ \ \ \ \ std::string\ name\_x\ =\ cov-\/>GetParName(i);}
\DoxyCodeLine{00884\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (IsPCA)\ name\_x\ +=\ \textcolor{stringliteral}{"{}\_PCA"{}};}
\DoxyCodeLine{00885\ \ \ \ \ \ \ \textcolor{comment}{//\ For\ xsec\ we\ can\ get\ the\ actual\ name,\ hurray\ for\ being\ informative}}
\DoxyCodeLine{00886\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (isxsec)\ name\_x\ =\ cov-\/>GetParFancyName(i);}
\DoxyCodeLine{00887\ }
\DoxyCodeLine{00888\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ parameter\ priors\ and\ bounds}}
\DoxyCodeLine{00889\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ prior\_x\ =\ cov-\/>getParInit(i);}
\DoxyCodeLine{00890\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (IsPCA)\ prior\_x\ =\ cov-\/>getParCurr\_PCA(i);}
\DoxyCodeLine{00891\ }
\DoxyCodeLine{00892\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ covariance\ matrix\ and\ do\ the\ +/-\/\ nSigma}}
\DoxyCodeLine{00893\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ nSigma\ =\ 1;}
\DoxyCodeLine{00894\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (IsPCA)\ nSigma\ =\ 0.5;}
\DoxyCodeLine{00895\ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ lower\ and\ upper\ bounds\ relative\ the\ prior}}
\DoxyCodeLine{00896\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ lower\_x\ =\ prior\_x\ -\/\ nSigma*cov-\/>getDiagonalError(i);}
\DoxyCodeLine{00897\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ upper\_x\ =\ prior\_x\ +\ nSigma*cov-\/>getDiagonalError(i);}
\DoxyCodeLine{00898\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ PCA,\ transform\ these\ parameter\ values\ to\ the\ PCA\ basis}}
\DoxyCodeLine{00899\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (IsPCA)\ \{}
\DoxyCodeLine{00900\ \ \ \ \ \ \ \ \ lower\_x\ =\ prior\_x\ -\/\ nSigma*std::sqrt((cov-\/>getEigenValues())(i));}
\DoxyCodeLine{00901\ \ \ \ \ \ \ \ \ upper\_x\ =\ prior\_x\ +\ nSigma*std::sqrt((cov-\/>getEigenValues())(i));}
\DoxyCodeLine{00902\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}eval\ \{\}\ =\ \{:.2f\}"{}},\ i,\ cov-\/>getEigenValues()(i));}
\DoxyCodeLine{00903\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}prior\ \{\}\ =\ \{:.2f\}"{}},\ i,\ prior\_x);}
\DoxyCodeLine{00904\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}lower\ \{\}\ =\ \{:.2f\}"{}},\ i,\ lower\_x);}
\DoxyCodeLine{00905\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}upper\ \{\}\ =\ \{:.2f\}"{}},\ i,\ upper\_x);}
\DoxyCodeLine{00906\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}nSigma\ =\ \{:.2f\}"{}},\ nSigma);}
\DoxyCodeLine{00907\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00908\ }
\DoxyCodeLine{00909\ \ \ \ \ \ \ \textcolor{comment}{//\ Cross-\/section\ and\ flux\ parameters\ have\ boundaries\ that\ we\ scan\ between,\ check\ that\ these\ are\ respected\ in\ setting\ lower\ and\ upper\ variables}}
\DoxyCodeLine{00910\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lower\_x\ <\ cov-\/>GetLowerBound(i))\ \{}
\DoxyCodeLine{00911\ \ \ \ \ \ \ \ \ lower\_x\ =\ cov-\/>GetLowerBound(i);}
\DoxyCodeLine{00912\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00913\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (upper\_x\ >\ cov-\/>GetUpperBound(i))\ \{}
\DoxyCodeLine{00914\ \ \ \ \ \ \ \ \ upper\_x\ =\ cov-\/>GetUpperBound(i);}
\DoxyCodeLine{00915\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00916\ }
\DoxyCodeLine{00917\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ skip\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00918\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ is\ =\ 0;\ is\ <\ SkipVector.size();\ is++)}
\DoxyCodeLine{00919\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00920\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(name\_x.substr(0,\ SkipVector[is].length())\ ==\ SkipVector[is])}
\DoxyCodeLine{00921\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00922\ \ \ \ \ \ \ \ \ \ \ skip\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00923\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00924\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00925\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00926\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(skip)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00927\ }
\DoxyCodeLine{00928\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ i;\ ++j)}
\DoxyCodeLine{00929\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00930\ \ \ \ \ \ \ \ \ std::string\ name\_y\ =\ cov-\/>GetParName(j);}
\DoxyCodeLine{00931\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (IsPCA)\ name\_y\ +=\ \textcolor{stringliteral}{"{}\_PCA"{}};}
\DoxyCodeLine{00932\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ xsec\ we\ can\ get\ the\ actual\ name,\ hurray\ for\ being\ informative}}
\DoxyCodeLine{00933\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (isxsec)\ name\_y\ =\ cov-\/>GetParFancyName(j);}
\DoxyCodeLine{00934\ }
\DoxyCodeLine{00935\ \ \ \ \ \ \ \ \ skip\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00936\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ is\ =\ 0;\ is\ <\ SkipVector.size();\ is++)}
\DoxyCodeLine{00937\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00938\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(name\_y.substr(0,\ SkipVector[is].length())\ ==\ SkipVector[is])}
\DoxyCodeLine{00939\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00940\ \ \ \ \ \ \ \ \ \ \ \ \ skip\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00941\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00942\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00943\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00944\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(skip)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00945\ }
\DoxyCodeLine{00946\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ parameter\ priors\ and\ bounds}}
\DoxyCodeLine{00947\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ prior\_y\ =\ cov-\/>getParInit(j);}
\DoxyCodeLine{00948\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (IsPCA)\ prior\_y\ =\ cov-\/>getParCurr\_PCA(j);}
\DoxyCodeLine{00949\ }
\DoxyCodeLine{00950\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ lower\ and\ upper\ bounds\ relative\ the\ prior}}
\DoxyCodeLine{00951\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ lower\_y\ =\ prior\_y\ -\/\ nSigma*cov-\/>getDiagonalError(j);}
\DoxyCodeLine{00952\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ upper\_y\ =\ prior\_y\ +\ nSigma*cov-\/>getDiagonalError(j);}
\DoxyCodeLine{00953\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ PCA,\ transform\ these\ parameter\ values\ to\ the\ PCA\ basis}}
\DoxyCodeLine{00954\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (IsPCA)\ \{}
\DoxyCodeLine{00955\ \ \ \ \ \ \ \ \ \ \ lower\_y\ =\ prior\_y\ -\/\ nSigma*std::sqrt((cov-\/>getEigenValues())(j));}
\DoxyCodeLine{00956\ \ \ \ \ \ \ \ \ \ \ upper\_y\ =\ prior\_y\ +\ nSigma*std::sqrt((cov-\/>getEigenValues())(j));}
\DoxyCodeLine{00957\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}eval\ \{\}\ =\ \{:.2f\}"{}},\ i,\ cov-\/>getEigenValues()(j));}
\DoxyCodeLine{00958\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}prior\ \{\}\ =\ \{:.2f\}"{}},\ i,\ prior\_y);}
\DoxyCodeLine{00959\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}lower\ \{\}\ =\ \{:.2f\}"{}},\ i,\ lower\_y);}
\DoxyCodeLine{00960\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}upper\ \{\}\ =\ \{:.2f\}"{}},\ i,\ upper\_y);}
\DoxyCodeLine{00961\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}nSigma\ =\ \{:.2f\}"{}},\ nSigma);}
\DoxyCodeLine{00962\ }
\DoxyCodeLine{00963\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00964\ }
\DoxyCodeLine{00965\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Cross-\/section\ and\ flux\ parameters\ have\ boundaries\ that\ we\ scan\ between,\ check\ that\ these\ are\ respected\ in\ setting\ lower\ and\ upper\ variables}}
\DoxyCodeLine{00966\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lower\_y\ <\ cov-\/>GetLowerBound(j))\ \{}
\DoxyCodeLine{00967\ \ \ \ \ \ \ \ \ \ \ lower\_y\ =\ cov-\/>GetLowerBound(j);}
\DoxyCodeLine{00968\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00969\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (upper\_y\ >\ cov-\/>GetUpperBound(j))\ \{}
\DoxyCodeLine{00970\ \ \ \ \ \ \ \ \ \ \ upper\_y\ =\ cov-\/>GetUpperBound(j);}
\DoxyCodeLine{00971\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00972\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Scanning\ X\ \{\}\ with\ \{\}\ steps,\ from\ \{\}\ -\/\ \{\},\ prior\ =\ \{\}"{}},\ name\_x,\ n\_points,\ lower\_x,\ upper\_x,\ prior\_x);}
\DoxyCodeLine{00973\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Scanning\ Y\ \{\}\ with\ \{\}\ steps,\ from\ \{\}\ -\/\ \{\},\ prior\ =\ \{\}"{}},\ name\_y,\ n\_points,\ lower\_y,\ upper\_y,\ prior\_y);}
\DoxyCodeLine{00974\ }
\DoxyCodeLine{00975\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ hScanSam\ =\ std::make\_unique<TH2D>((name\_x\ +\ \textcolor{stringliteral}{"{}\_"{}}\ +\ name\_y\ +\ \textcolor{stringliteral}{"{}\_sam"{}}).c\_str(),\ (name\_x\ +\ \textcolor{stringliteral}{"{}\_"{}}\ +\ name\_y\ +\ \textcolor{stringliteral}{"{}\_sam"{}}).c\_str(),}
\DoxyCodeLine{00976\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ n\_points,\ lower\_x,\ upper\_x,\ n\_points,\ lower\_y,\ upper\_y);}
\DoxyCodeLine{00977\ \ \ \ \ \ \ \ \ hScanSam-\/>GetXaxis()-\/>SetTitle(name\_x.c\_str());}
\DoxyCodeLine{00978\ \ \ \ \ \ \ \ \ hScanSam-\/>GetYaxis()-\/>SetTitle(name\_y.c\_str());}
\DoxyCodeLine{00979\ \ \ \ \ \ \ \ \ hScanSam-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}2LLH\_sam"{}});}
\DoxyCodeLine{00980\ }
\DoxyCodeLine{00981\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Scan\ over\ the\ parameter\ space}}
\DoxyCodeLine{00982\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ n\_points;\ x++)}
\DoxyCodeLine{00983\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00984\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x\ \%\ countwidth\ ==\ 0)}
\DoxyCodeLine{00985\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceMaCh3Utils_a4c8bdeb1d34606aed192e9f1311a72f5}{MaCh3Utils::PrintProgressBar}}(x,\ n\_points);}
\DoxyCodeLine{00986\ }
\DoxyCodeLine{00987\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ 0;\ y\ <\ n\_points;\ y++)}
\DoxyCodeLine{00988\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00989\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ PCA\ we\ have\ to\ do\ it\ differently}}
\DoxyCodeLine{00990\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (IsPCA)\ \{}
\DoxyCodeLine{00991\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cov-\/>setParProp\_PCA(i,\ hScanSam-\/>GetXaxis()-\/>GetBinCenter(x+1));}
\DoxyCodeLine{00992\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cov-\/>setParProp\_PCA(j,\ hScanSam-\/>GetYaxis()-\/>GetBinCenter(y+1));}
\DoxyCodeLine{00993\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00994\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ the\ parameter}}
\DoxyCodeLine{00995\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cov-\/>setParProp(i,\ hScanSam-\/>GetXaxis()-\/>GetBinCenter(x+1));}
\DoxyCodeLine{00996\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cov-\/>setParProp(j,\ hScanSam-\/>GetYaxis()-\/>GetBinCenter(y+1));}
\DoxyCodeLine{00997\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00998\ }
\DoxyCodeLine{00999\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Reweight\ the\ MC}}
\DoxyCodeLine{01000\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//double\ *fake\ =\ 0;}}
\DoxyCodeLine{01001\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivs\ =\ 0;\ ivs\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ivs++)\ \{}
\DoxyCodeLine{01002\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>reweight();}
\DoxyCodeLine{01003\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01004\ }
\DoxyCodeLine{01005\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ -\/log\ L\ likelihoods}}
\DoxyCodeLine{01006\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ samplellh\ =\ 0;}
\DoxyCodeLine{01007\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivs\ =\ 0;\ ivs\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ivs++)\ \{}
\DoxyCodeLine{01008\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ samplellh\ +=\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>GetLikelihood();}
\DoxyCodeLine{01009\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01010\ \ \ \ \ \ \ \ \ \ \ \ \ hScanSam-\/>SetBinContent(x+1,\ y+1,\ 2*samplellh);}
\DoxyCodeLine{01011\ \ \ \ \ \ \ \ \ \ \ \}\textcolor{comment}{//\ end\ loop\ over\ y\ points}}
\DoxyCodeLine{01012\ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ end\ loop\ over\ x\ points}}
\DoxyCodeLine{01013\ }
\DoxyCodeLine{01014\ \ \ \ \ \ \ \ \ Sample\_2DLLH-\/>cd();}
\DoxyCodeLine{01015\ \ \ \ \ \ \ \ \ hScanSam-\/>Write();}
\DoxyCodeLine{01016\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Reset\ the\ parameters\ to\ their\ prior\ central\ values}}
\DoxyCodeLine{01017\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (IsPCA)\ \{}
\DoxyCodeLine{01018\ \ \ \ \ \ \ \ \ \ \ cov-\/>setParProp\_PCA(i,\ prior\_x);}
\DoxyCodeLine{01019\ \ \ \ \ \ \ \ \ \ \ cov-\/>setParProp\_PCA(j,\ prior\_y);}
\DoxyCodeLine{01020\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01021\ \ \ \ \ \ \ \ \ \ \ cov-\/>setParProp(i,\ prior\_x);}
\DoxyCodeLine{01022\ \ \ \ \ \ \ \ \ \ \ cov-\/>setParProp(j,\ prior\_y);}
\DoxyCodeLine{01023\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01024\ \ \ \ \ \ \ \}\ \textcolor{comment}{//end\ loop\ over\ systematics\ y}}
\DoxyCodeLine{01025\ \ \ \ \ \}\textcolor{comment}{//end\ loop\ over\ systematics\ X}}
\DoxyCodeLine{01026\ \ \ \}\textcolor{comment}{//end\ loop\ covariance\ classes}}
\DoxyCodeLine{01027\ \ \ Sample\_2DLLH-\/>Write();}
\DoxyCodeLine{01028\ \ \ \textcolor{keyword}{delete}\ Sample\_2DLLH;}
\DoxyCodeLine{01029\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classFitterBase_a018e8d09a62bca19840e1321b49df2c0}\label{classFitterBase_a018e8d09a62bca19840e1321b49df2c0}} 
\index{FitterBase@{FitterBase}!RunLLHScan@{RunLLHScan}}
\index{RunLLHScan@{RunLLHScan}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{RunLLHScan()}{RunLLHScan()}}
{\footnotesize\ttfamily void Fitter\+Base\+::\+Run\+LLHScan (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Perform a 1D likelihood scan. 



Definition at line \mbox{\hyperlink{FitterBase_8cpp_source_l00465}{465}} of file \mbox{\hyperlink{FitterBase_8cpp_source}{Fitter\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00466\ \textcolor{comment}{//\ *************************}}
\DoxyCodeLine{00467\ }
\DoxyCodeLine{00468\ \ \ \textcolor{comment}{//\ Save\ the\ settings\ into\ the\ output\ file}}
\DoxyCodeLine{00469\ \ \ \mbox{\hyperlink{classFitterBase_a48f38bfa8996fe00d51f35b05dd16b46}{SaveSettings}}();}
\DoxyCodeLine{00470\ }
\DoxyCodeLine{00471\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Starting\ LLH\ Scan"{}});}
\DoxyCodeLine{00472\ }
\DoxyCodeLine{00473\ \ \ \textcolor{comment}{//KS:\ Turn\ it\ on\ if\ you\ want\ LLH\ scan\ for\ each\ ND\ sample\ separately,\ which\ increase\ time\ significantly\ but\ can\ be\ useful\ for\ validating\ new\ samples\ or\ dials.}}
\DoxyCodeLine{00474\ \ \ \textcolor{keywordtype}{bool}\ PlotAllNDsamplesLLH\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00475\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classFitterBase_a4fceb68f242feeb04a0ddf42a5a37095}{fitMan}}-\/>\mbox{\hyperlink{classmanager_ab3999cc856ede72b37f68bdb28bd5520}{raw}}()[\textcolor{stringliteral}{"{}General"{}}][\textcolor{stringliteral}{"{}LLHScanBySample"{}}])}
\DoxyCodeLine{00476\ \ \ \ \ PlotAllNDsamplesLLH\ =\ \mbox{\hyperlink{classFitterBase_a4fceb68f242feeb04a0ddf42a5a37095}{fitMan}}-\/>\mbox{\hyperlink{classmanager_ab3999cc856ede72b37f68bdb28bd5520}{raw}}()[\textcolor{stringliteral}{"{}General"{}}][\textcolor{stringliteral}{"{}LLHScanBySample"{}}].as<\textcolor{keywordtype}{bool}>();}
\DoxyCodeLine{00477\ }
\DoxyCodeLine{00478\ \ \ std::vector<std::string>\ SkipVector;}
\DoxyCodeLine{00479\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classFitterBase_a4fceb68f242feeb04a0ddf42a5a37095}{fitMan}}-\/>\mbox{\hyperlink{classmanager_ab3999cc856ede72b37f68bdb28bd5520}{raw}}()[\textcolor{stringliteral}{"{}General"{}}][\textcolor{stringliteral}{"{}LLHScanSkipVector"{}}])}
\DoxyCodeLine{00480\ \ \ \{}
\DoxyCodeLine{00481\ \ \ \ \ SkipVector\ =\ \mbox{\hyperlink{classFitterBase_a4fceb68f242feeb04a0ddf42a5a37095}{fitMan}}-\/>\mbox{\hyperlink{classmanager_ab3999cc856ede72b37f68bdb28bd5520}{raw}}()[\textcolor{stringliteral}{"{}General"{}}][\textcolor{stringliteral}{"{}LLHScanSkipVector"{}}].as<std::vector<std::string>>();}
\DoxyCodeLine{00482\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Found\ skip\ vector\ with\ \{\}\ entries"{}},\ SkipVector.size());}
\DoxyCodeLine{00483\ \ \ \}}
\DoxyCodeLine{00484\ }
\DoxyCodeLine{00485\ \ \ \textcolor{comment}{//\ Now\ finally\ get\ onto\ the\ LLH\ scan\ stuff}}
\DoxyCodeLine{00486\ \ \ \textcolor{comment}{//\ Very\ similar\ code\ to\ MCMC\ but\ never\ start\ MCMC;\ just\ scan\ over\ the\ parameter\ space}}
\DoxyCodeLine{00487\ \ \ std::vector<TDirectory\ *>\ Cov\_LLH(\mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}.size());}
\DoxyCodeLine{00488\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivc\ =\ 0;\ ivc\ <\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}.size();\ ivc++\ )}
\DoxyCodeLine{00489\ \ \ \{}
\DoxyCodeLine{00490\ \ \ \ \ std::string\ NameTemp\ =\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}[ivc]-\/>getName();}
\DoxyCodeLine{00491\ \ \ \ \ NameTemp\ =\ NameTemp.substr(0,\ NameTemp.find(\textcolor{stringliteral}{"{}\_cov"{}}))\ +\ \textcolor{stringliteral}{"{}\_LLH"{}};}
\DoxyCodeLine{00492\ \ \ \ \ Cov\_LLH[ivc]\ =\ \mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}}-\/>mkdir(NameTemp.c\_str());}
\DoxyCodeLine{00493\ \ \ \}}
\DoxyCodeLine{00494\ }
\DoxyCodeLine{00495\ \ \ std::vector<TDirectory\ *>\ SampleClass\_LLH(\mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size());}
\DoxyCodeLine{00496\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivs\ =\ 0;\ ivs\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ivs++\ )}
\DoxyCodeLine{00497\ \ \ \{}
\DoxyCodeLine{00498\ \ \ \ \ std::string\ NameTemp\ =\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>GetName();}
\DoxyCodeLine{00499\ \ \ \ \ SampleClass\_LLH[ivs]\ =\ \mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}}-\/>mkdir(NameTemp.c\_str());}
\DoxyCodeLine{00500\ \ \ \}}
\DoxyCodeLine{00501\ }
\DoxyCodeLine{00502\ \ \ TDirectory\ *Sample\_LLH\ =\ \mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}Sample\_LLH"{}});}
\DoxyCodeLine{00503\ \ \ TDirectory\ *Total\_LLH\ =\ \mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}Total\_LLH"{}});}
\DoxyCodeLine{00504\ }
\DoxyCodeLine{00505\ \ \ std::vector<TDirectory\ *>SampleSplit\_LLH;}
\DoxyCodeLine{00506\ \ \ \textcolor{keywordflow}{if}(PlotAllNDsamplesLLH)}
\DoxyCodeLine{00507\ \ \ \{}
\DoxyCodeLine{00508\ \ \ \ \ SampleSplit\_LLH.resize(\mbox{\hyperlink{classFitterBase_abe9814558b8ff1bccdde3b4c894467e6}{TotalNSamples}});}
\DoxyCodeLine{00509\ \ \ \ \ \textcolor{keywordtype}{int}\ SampleIterator\ =\ 0;}
\DoxyCodeLine{00510\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivs\ =\ 0;\ ivs\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ivs++\ )}
\DoxyCodeLine{00511\ \ \ \ \ \{}
\DoxyCodeLine{00512\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ is\ =\ 0;\ is\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>GetNsamples();\ is++\ )}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ SampleSplit\_LLH[SampleIterator]\ =\ \mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}}-\/>mkdir((\mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>GetSampleName(is)+\ \textcolor{stringliteral}{"{}\_LLH"{}}).c\_str());}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \ \ SampleIterator++;}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00517\ \ \ \ \ \}}
\DoxyCodeLine{00518\ \ \ \}}
\DoxyCodeLine{00519\ \ \ \textcolor{comment}{//\ Number\ of\ points\ we\ do\ for\ each\ LLH\ scan}}
\DoxyCodeLine{00520\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ n\_points\ =\ GetFromManager<int>(\mbox{\hyperlink{classFitterBase_a4fceb68f242feeb04a0ddf42a5a37095}{fitMan}}-\/>\mbox{\hyperlink{classmanager_ab3999cc856ede72b37f68bdb28bd5520}{raw}}()[\textcolor{stringliteral}{"{}General"{}}][\textcolor{stringliteral}{"{}LLHScanPoints"{}}],\ 100);}
\DoxyCodeLine{00521\ }
\DoxyCodeLine{00522\ \ \ \textcolor{comment}{//\ We\ print\ 5\ reweights}}
\DoxyCodeLine{00523\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ countwidth\ =\ int(\textcolor{keywordtype}{double}(n\_points)/\textcolor{keywordtype}{double}(5));}
\DoxyCodeLine{00524\ }
\DoxyCodeLine{00525\ \ \ \textcolor{keywordtype}{bool}\ isxsec\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00526\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ covariance\ classes}}
\DoxyCodeLine{00527\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classcovarianceBase}{covarianceBase}}\ *cov\ :\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}})}
\DoxyCodeLine{00528\ \ \ \{}
\DoxyCodeLine{00529\ \ \ \ \ \textcolor{keywordflow}{if}\ (cov-\/>getName()\ ==\ \textcolor{stringliteral}{"{}xsec\_cov"{}})}
\DoxyCodeLine{00530\ \ \ \ \ \{}
\DoxyCodeLine{00531\ \ \ \ \ \ \ isxsec\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00532\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00533\ \ \ \ \ \ \ isxsec\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00534\ \ \ \ \ \}}
\DoxyCodeLine{00535\ }
\DoxyCodeLine{00536\ \ \ \ \ \textcolor{comment}{//\ Scan\ over\ all\ the\ parameters}}
\DoxyCodeLine{00537\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ number\ of\ parameters}}
\DoxyCodeLine{00538\ \ \ \ \ \textcolor{keywordtype}{int}\ npars\ =\ cov-\/>GetNumParams();}
\DoxyCodeLine{00539\ \ \ \ \ \textcolor{keywordtype}{bool}\ IsPCA\ =\ cov-\/>IsPCA();}
\DoxyCodeLine{00540\ \ \ \ \ \textcolor{keywordflow}{if}\ (IsPCA)\ npars\ =\ cov-\/>getNpars();}
\DoxyCodeLine{00541\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ npars;\ ++i)}
\DoxyCodeLine{00542\ \ \ \ \ \{}
\DoxyCodeLine{00543\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ parameter\ name}}
\DoxyCodeLine{00544\ \ \ \ \ \ \ std::string\ name\ =\ cov-\/>GetParName(i);}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (IsPCA)\ name\ +=\ \textcolor{stringliteral}{"{}\_PCA"{}};}
\DoxyCodeLine{00546\ \ \ \ \ \ \ \textcolor{comment}{//\ For\ xsec\ we\ can\ get\ the\ actual\ name,\ hurray\ for\ being\ informative}}
\DoxyCodeLine{00547\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (isxsec)\ name\ =\ cov-\/>GetParFancyName(i);}
\DoxyCodeLine{00548\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ skip\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00549\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ is\ =\ 0;\ is\ <\ SkipVector.size();\ is++)}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(name.substr(0,\ SkipVector[is].length())\ ==\ SkipVector[is])}
\DoxyCodeLine{00552\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00553\ \ \ \ \ \ \ \ \ \ \ skip\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00554\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00556\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00557\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(skip)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00558\ }
\DoxyCodeLine{00559\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ parameter\ priors\ and\ bounds}}
\DoxyCodeLine{00560\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ prior\ =\ cov-\/>getParInit(i);}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (IsPCA)\ prior\ =\ cov-\/>getParCurr\_PCA(i);}
\DoxyCodeLine{00562\ }
\DoxyCodeLine{00563\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ covariance\ matrix\ and\ do\ the\ +/-\/\ nSigma}}
\DoxyCodeLine{00564\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ nSigma\ =\ 1;}
\DoxyCodeLine{00565\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (IsPCA)\ nSigma\ =\ 0.5;}
\DoxyCodeLine{00566\ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ lower\ and\ upper\ bounds\ relative\ the\ prior}}
\DoxyCodeLine{00567\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ lower\ =\ prior\ -\/\ nSigma*cov-\/>getDiagonalError(i);}
\DoxyCodeLine{00568\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ upper\ =\ prior\ +\ nSigma*cov-\/>getDiagonalError(i);}
\DoxyCodeLine{00569\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ PCA,\ transform\ these\ parameter\ values\ to\ the\ PCA\ basis}}
\DoxyCodeLine{00570\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (IsPCA)\ \{}
\DoxyCodeLine{00571\ \ \ \ \ \ \ \ \ lower\ =\ prior\ -\/\ nSigma*std::sqrt((cov-\/>getEigenValues())(i));}
\DoxyCodeLine{00572\ \ \ \ \ \ \ \ \ upper\ =\ prior\ +\ nSigma*std::sqrt((cov-\/>getEigenValues())(i));}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}eval\ \{\}\ =\ \{:.2f\}"{}},\ i,\ cov-\/>getEigenValues()(i));}
\DoxyCodeLine{00574\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}prior\ \{\}\ =\ \{:.2f\}"{}},\ i,\ prior);}
\DoxyCodeLine{00575\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}lower\ \{\}\ =\ \{:.2f\}"{}},\ i,\ lower);}
\DoxyCodeLine{00576\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}upper\ \{\}\ =\ \{:.2f\}"{}},\ i,\ upper);}
\DoxyCodeLine{00577\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}nSigma\ =\ \{:.2f\}"{}},\ nSigma);}
\DoxyCodeLine{00578\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00579\ }
\DoxyCodeLine{00580\ \ \ \ \ \ \ \textcolor{comment}{//\ Cross-\/section\ and\ flux\ parameters\ have\ boundaries\ that\ we\ scan\ between,\ check\ that\ these\ are\ respected\ in\ setting\ lower\ and\ upper\ variables}}
\DoxyCodeLine{00581\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lower\ <\ cov-\/>GetLowerBound(i))\ \{}
\DoxyCodeLine{00582\ \ \ \ \ \ \ \ \ lower\ =\ cov-\/>GetLowerBound(i);}
\DoxyCodeLine{00583\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00584\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (upper\ >\ cov-\/>GetUpperBound(i))\ \{}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \ \ upper\ =\ cov-\/>GetUpperBound(i);}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00587\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Scanning\ \{\}\ with\ \{\}\ steps,\ from\ \{:.2f\}\ -\/\ \{:.2f\},\ prior\ =\ \{:.2f\}"{}},\ name,\ n\_points,\ lower,\ upper,\ prior);}
\DoxyCodeLine{00588\ }
\DoxyCodeLine{00589\ \ \ \ \ \ \ \textcolor{comment}{//\ Make\ the\ TH1D}}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ hScan\ =\ std::make\_unique<TH1D>((name\ +\ \textcolor{stringliteral}{"{}\_full"{}}).c\_str(),\ (name\ +\ \textcolor{stringliteral}{"{}\_full"{}}).c\_str(),\ n\_points,\ lower,\ upper);}
\DoxyCodeLine{00591\ \ \ \ \ \ \ hScan-\/>SetTitle((std::string(\textcolor{stringliteral}{"{}2LLH\_full,\ "{}})\ +\ name\ +\ \textcolor{stringliteral}{"{};"{}}\ +\ name\ +\ \textcolor{stringliteral}{"{};\ -\/2(ln\ L\_\{sample\}\ +\ ln\ L\_\{xsec+flux\}\ +\ ln\ L\_\{det\})"{}}).c\_str());}
\DoxyCodeLine{00592\ }
\DoxyCodeLine{00593\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ hScanSam\ =\ std::make\_unique<TH1D>((name\ +\ \textcolor{stringliteral}{"{}\_sam"{}}).c\_str(),\ (name\ +\ \textcolor{stringliteral}{"{}\_sam"{}}).c\_str(),\ n\_points,\ lower,\ upper);}
\DoxyCodeLine{00594\ \ \ \ \ \ \ hScanSam-\/>SetTitle((std::string(\textcolor{stringliteral}{"{}2LLH\_sam,\ "{}})\ +\ name\ +\ \textcolor{stringliteral}{"{};"{}}\ +\ name\ +\ \textcolor{stringliteral}{"{};\ -\/2(ln\ L\_\{sample\})"{}}).c\_str());}
\DoxyCodeLine{00595\ }
\DoxyCodeLine{00596\ \ \ \ \ \ \ std::vector<TH1D*>\ hScanSample(\mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size());}
\DoxyCodeLine{00597\ \ \ \ \ \ \ std::vector<double>\ nSamLLH(\mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size());}
\DoxyCodeLine{00598\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivs\ =\ 0;\ ivs\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ivs++\ )}
\DoxyCodeLine{00599\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \ \ std::string\ NameTemp\ =\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>GetName();}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \ \ hScanSample[ivs]\ =\ \textcolor{keyword}{new}\ TH1D((name+\textcolor{stringliteral}{"{}\_"{}}+NameTemp).c\_str(),\ (name+\textcolor{stringliteral}{"{}\_"{}}\ +\ NameTemp).c\_str(),\ n\_points,\ lower,\ upper);}
\DoxyCodeLine{00602\ \ \ \ \ \ \ \ \ hScanSample[ivs]-\/>SetTitle((\textcolor{stringliteral}{"{}2LLH\_"{}}\ +\ NameTemp\ +\ \textcolor{stringliteral}{"{},\ "{}}\ +\ name\ +\ \textcolor{stringliteral}{"{};"{}}\ +\ name\ +\ \textcolor{stringliteral}{"{};\ -\/2(ln\ L\_\{"{}}\ +\ NameTemp\ +\textcolor{stringliteral}{"{}\})"{}}).c\_str());}
\DoxyCodeLine{00603\ \ \ \ \ \ \ \ \ nSamLLH[ivs]\ =\ 0.;}
\DoxyCodeLine{00604\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00605\ }
\DoxyCodeLine{00606\ \ \ \ \ \ \ std::vector<TH1D*>\ hScanCov(\mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}.size());}
\DoxyCodeLine{00607\ \ \ \ \ \ \ std::vector<double>\ nCovLLH(\mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}.size());}
\DoxyCodeLine{00608\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivc\ =\ 0;\ ivc\ <\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}.size();\ ivc++\ )}
\DoxyCodeLine{00609\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ std::string\ NameTemp\ =\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}[ivc]-\/>getName();}
\DoxyCodeLine{00611\ \ \ \ \ \ \ \ \ NameTemp\ =\ NameTemp.substr(0,\ NameTemp.find(\textcolor{stringliteral}{"{}\_cov"{}}));}
\DoxyCodeLine{00612\ }
\DoxyCodeLine{00613\ \ \ \ \ \ \ \ \ hScanCov[ivc]\ =\ \textcolor{keyword}{new}\ TH1D((name+\textcolor{stringliteral}{"{}\_"{}}+NameTemp).c\_str(),\ (name+\textcolor{stringliteral}{"{}\_"{}}\ +\ NameTemp).c\_str(),\ n\_points,\ lower,\ upper);}
\DoxyCodeLine{00614\ \ \ \ \ \ \ \ \ hScanCov[ivc]-\/>SetTitle((\textcolor{stringliteral}{"{}2LLH\_"{}}\ +\ NameTemp\ +\ \textcolor{stringliteral}{"{},\ "{}}\ +\ name\ +\ \textcolor{stringliteral}{"{};"{}}\ +\ name\ +\ \textcolor{stringliteral}{"{};\ -\/2(ln\ L\_\{"{}}\ +\ NameTemp\ +\textcolor{stringliteral}{"{}\})"{}}).c\_str());}
\DoxyCodeLine{00615\ \ \ \ \ \ \ \ \ nCovLLH[ivc]\ =\ 0.;}
\DoxyCodeLine{00616\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00617\ }
\DoxyCodeLine{00618\ \ \ \ \ \ \ std::vector<TH1D\ *>\ hScanSamSplit;}
\DoxyCodeLine{00619\ \ \ \ \ \ \ std::vector<double>\ sampleSplitllh;}
\DoxyCodeLine{00620\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(PlotAllNDsamplesLLH)}
\DoxyCodeLine{00621\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00622\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ SampleIterator\ =\ 0;}
\DoxyCodeLine{00623\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivs\ =\ 0;\ ivs\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ivs++\ )}
\DoxyCodeLine{00624\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00625\ \ \ \ \ \ \ \ \ \ \ hScanSamSplit.resize(\mbox{\hyperlink{classFitterBase_abe9814558b8ff1bccdde3b4c894467e6}{TotalNSamples}});}
\DoxyCodeLine{00626\ \ \ \ \ \ \ \ \ \ \ sampleSplitllh.resize(\mbox{\hyperlink{classFitterBase_abe9814558b8ff1bccdde3b4c894467e6}{TotalNSamples}});}
\DoxyCodeLine{00627\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ is\ =\ 0;\ is\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>GetNsamples();\ is++\ )}
\DoxyCodeLine{00628\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00629\ \ \ \ \ \ \ \ \ \ \ \ \ hScanSamSplit[SampleIterator]\ =\ \textcolor{keyword}{new}\ TH1D((name+\mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>GetSampleName(is)).c\_str(),\ (name+\mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>GetSampleName(is)).c\_str(),\ n\_points,\ lower,\ upper);}
\DoxyCodeLine{00630\ \ \ \ \ \ \ \ \ \ \ \ \ hScanSamSplit[SampleIterator]-\/>SetTitle((std::string(\textcolor{stringliteral}{"{}2LLH\_sam,\ "{}})\ +\ name\ +\ \textcolor{stringliteral}{"{};"{}}\ +\ name\ +\ \textcolor{stringliteral}{"{};\ -\/2(ln\ L\_\{sample\})"{}}).c\_str());}
\DoxyCodeLine{00631\ \ \ \ \ \ \ \ \ \ \ \ \ SampleIterator++;}
\DoxyCodeLine{00632\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00633\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00634\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00635\ }
\DoxyCodeLine{00636\ \ \ \ \ \ \ \textcolor{comment}{//\ Scan\ over\ the\ parameter\ space}}
\DoxyCodeLine{00637\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ n\_points;\ j++)}
\DoxyCodeLine{00638\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00639\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ \%\ countwidth\ ==\ 0)}
\DoxyCodeLine{00640\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceMaCh3Utils_a4c8bdeb1d34606aed192e9f1311a72f5}{MaCh3Utils::PrintProgressBar}}(j,\ n\_points);}
\DoxyCodeLine{00641\ }
\DoxyCodeLine{00642\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ PCA\ we\ have\ to\ do\ it\ differently}}
\DoxyCodeLine{00643\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (IsPCA)\ \{}
\DoxyCodeLine{00644\ \ \ \ \ \ \ \ \ \ \ cov-\/>setParProp\_PCA(i,\ hScan-\/>GetBinCenter(j+1));}
\DoxyCodeLine{00645\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00646\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ the\ parameter}}
\DoxyCodeLine{00647\ \ \ \ \ \ \ \ \ \ \ cov-\/>setParProp(i,\ hScan-\/>GetBinCenter(j+1));}
\DoxyCodeLine{00648\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00649\ }
\DoxyCodeLine{00650\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Reweight\ the\ MC}}
\DoxyCodeLine{00651\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivs\ =\ 0;\ ivs\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ivs++\ )}
\DoxyCodeLine{00652\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00653\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>reweight();}
\DoxyCodeLine{00654\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00655\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Total\ LLH}}
\DoxyCodeLine{00656\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ totalllh\ =\ 0;}
\DoxyCodeLine{00657\ }
\DoxyCodeLine{00658\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ -\/log\ L\ likelihoods}}
\DoxyCodeLine{00659\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ samplellh\ =\ 0;}
\DoxyCodeLine{00660\ }
\DoxyCodeLine{00661\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivs\ =\ 0;\ ivs\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ivs++\ )}
\DoxyCodeLine{00662\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00663\ \ \ \ \ \ \ \ \ \ \ nSamLLH[ivs]\ =\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>GetLikelihood();}
\DoxyCodeLine{00664\ \ \ \ \ \ \ \ \ \ \ samplellh\ +=\ nSamLLH[ivs];}
\DoxyCodeLine{00665\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00666\ }
\DoxyCodeLine{00667\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivc\ =\ 0;\ ivc\ <\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}.size();\ ivc++\ )}
\DoxyCodeLine{00668\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00669\ \ \ \ \ \ \ \ \ \ \ nCovLLH[ivc]\ =\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}[ivc]-\/>GetLikelihood();}
\DoxyCodeLine{00670\ \ \ \ \ \ \ \ \ \ \ totalllh\ +=\ nCovLLH[ivc];}
\DoxyCodeLine{00671\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00672\ }
\DoxyCodeLine{00673\ \ \ \ \ \ \ \ \ totalllh\ +=\ samplellh;}
\DoxyCodeLine{00674\ }
\DoxyCodeLine{00675\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(PlotAllNDsamplesLLH)}
\DoxyCodeLine{00676\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00677\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ SampleIterator\ =\ 0;}
\DoxyCodeLine{00678\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivs\ =\ 0;\ ivs\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ivs++\ )}
\DoxyCodeLine{00679\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00680\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ is\ =\ 0;\ is\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>GetNsamples();\ is++)}
\DoxyCodeLine{00681\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00682\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sampleSplitllh[SampleIterator]\ =\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>getSampleLikelihood(is);}
\DoxyCodeLine{00683\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SampleIterator++;}
\DoxyCodeLine{00684\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00685\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00686\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00687\ }
\DoxyCodeLine{00688\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivs\ =\ 0;\ ivs\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ivs++\ )}
\DoxyCodeLine{00689\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00690\ \ \ \ \ \ \ \ \ \ \ hScanSample[ivs]-\/>SetBinContent(j+1,\ 2*nSamLLH[ivs]);}
\DoxyCodeLine{00691\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00692\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivc\ =\ 0;\ ivc\ <\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}.size();\ ivc++\ )}
\DoxyCodeLine{00693\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00694\ \ \ \ \ \ \ \ \ \ \ hScanCov[ivc]-\/>SetBinContent(j+1,\ 2*nCovLLH[ivc]);}
\DoxyCodeLine{00695\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00696\ }
\DoxyCodeLine{00697\ \ \ \ \ \ \ \ \ hScanSam-\/>SetBinContent(j+1,\ 2*samplellh);}
\DoxyCodeLine{00698\ \ \ \ \ \ \ \ \ hScan-\/>SetBinContent(j+1,\ 2*totalllh);}
\DoxyCodeLine{00699\ }
\DoxyCodeLine{00700\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(PlotAllNDsamplesLLH)}
\DoxyCodeLine{00701\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00702\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ SampleIterator\ =\ 0;}
\DoxyCodeLine{00703\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivs\ =\ 0;\ ivs\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ivs++\ )}
\DoxyCodeLine{00704\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00705\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ is\ =\ 0;\ is\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>GetNsamples();\ is++)}
\DoxyCodeLine{00706\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00707\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hScanSamSplit[is]-\/>SetBinContent(j+1,\ 2*sampleSplitllh[is]);}
\DoxyCodeLine{00708\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SampleIterator++;}
\DoxyCodeLine{00709\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00710\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00711\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00712\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00713\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivc\ =\ 0;\ ivc\ <\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}.size();\ ivc++\ )}
\DoxyCodeLine{00714\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00715\ \ \ \ \ \ \ \ \ Cov\_LLH[ivc]-\/>cd();}
\DoxyCodeLine{00716\ \ \ \ \ \ \ \ \ hScanCov[ivc]-\/>Write();}
\DoxyCodeLine{00717\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ hScanCov[ivc];}
\DoxyCodeLine{00718\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00719\ }
\DoxyCodeLine{00720\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivs\ =\ 0;\ ivs\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ivs++\ )}
\DoxyCodeLine{00721\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00722\ \ \ \ \ \ \ \ \ SampleClass\_LLH[ivs]-\/>cd();}
\DoxyCodeLine{00723\ \ \ \ \ \ \ \ \ hScanSample[ivs]-\/>Write();}
\DoxyCodeLine{00724\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ hScanSample[ivs];}
\DoxyCodeLine{00725\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00726\ \ \ \ \ \ \ Sample\_LLH-\/>cd();}
\DoxyCodeLine{00727\ \ \ \ \ \ \ hScanSam-\/>Write();}
\DoxyCodeLine{00728\ \ \ \ \ \ \ Total\_LLH-\/>cd();}
\DoxyCodeLine{00729\ \ \ \ \ \ \ hScan-\/>Write();}
\DoxyCodeLine{00730\ }
\DoxyCodeLine{00731\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(PlotAllNDsamplesLLH)}
\DoxyCodeLine{00732\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00733\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ SampleIterator\ =\ 0;}
\DoxyCodeLine{00734\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivs\ =\ 0;\ ivs\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ivs++\ )}
\DoxyCodeLine{00735\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00736\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ is\ =\ 0;\ is\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>GetNsamples();\ is++)}
\DoxyCodeLine{00737\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00738\ \ \ \ \ \ \ \ \ \ \ \ \ SampleSplit\_LLH[SampleIterator]-\/>cd();}
\DoxyCodeLine{00739\ \ \ \ \ \ \ \ \ \ \ \ \ hScanSamSplit[SampleIterator]-\/>Write();}
\DoxyCodeLine{00740\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ hScanSamSplit[SampleIterator];}
\DoxyCodeLine{00741\ \ \ \ \ \ \ \ \ \ \ \ \ SampleIterator++;}
\DoxyCodeLine{00742\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00743\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00744\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00745\ }
\DoxyCodeLine{00746\ \ \ \ \ \ \ \textcolor{comment}{//\ Reset\ the\ parameters\ to\ their\ prior\ central\ values}}
\DoxyCodeLine{00747\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (IsPCA)\ \{}
\DoxyCodeLine{00748\ \ \ \ \ \ \ \ \ cov-\/>setParProp\_PCA(i,\ prior);}
\DoxyCodeLine{00749\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00750\ \ \ \ \ \ \ \ \ cov-\/>setParProp(i,\ prior);}
\DoxyCodeLine{00751\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00752\ \ \ \ \ \}\textcolor{comment}{//end\ loop\ over\ systematics}}
\DoxyCodeLine{00753\ \ \ \}\textcolor{comment}{//end\ loop\ covariance\ classes}}
\DoxyCodeLine{00754\ }
\DoxyCodeLine{00755\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivc\ =\ 0;\ ivc\ <\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}.size();\ ivc++\ )}
\DoxyCodeLine{00756\ \ \ \{}
\DoxyCodeLine{00757\ \ \ \ \ Cov\_LLH[ivc]-\/>Write();}
\DoxyCodeLine{00758\ \ \ \ \ \textcolor{keyword}{delete}\ Cov\_LLH[ivc];}
\DoxyCodeLine{00759\ \ \ \}}
\DoxyCodeLine{00760\ }
\DoxyCodeLine{00761\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivs\ =\ 0;\ ivs\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ivs++\ )}
\DoxyCodeLine{00762\ \ \ \{}
\DoxyCodeLine{00763\ \ \ \ \ SampleClass\_LLH[ivs]-\/>Write();}
\DoxyCodeLine{00764\ \ \ \ \ \textcolor{keyword}{delete}\ SampleClass\_LLH[ivs];}
\DoxyCodeLine{00765\ \ \ \}}
\DoxyCodeLine{00766\ }
\DoxyCodeLine{00767\ \ \ Sample\_LLH-\/>Write();}
\DoxyCodeLine{00768\ \ \ \textcolor{keyword}{delete}\ Sample\_LLH;}
\DoxyCodeLine{00769\ }
\DoxyCodeLine{00770\ \ \ Total\_LLH-\/>Write();}
\DoxyCodeLine{00771\ \ \ \textcolor{keyword}{delete}\ Total\_LLH;}
\DoxyCodeLine{00772\ }
\DoxyCodeLine{00773\ \ \ \textcolor{keywordflow}{if}(PlotAllNDsamplesLLH)}
\DoxyCodeLine{00774\ \ \ \{}
\DoxyCodeLine{00775\ \ \ \ \ \textcolor{keywordtype}{int}\ SampleIterator\ =\ 0;}
\DoxyCodeLine{00776\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivs\ =\ 0;\ ivs\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ivs++\ )}
\DoxyCodeLine{00777\ \ \ \ \ \{}
\DoxyCodeLine{00778\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ is\ =\ 0;\ is\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>GetNsamples();\ is++\ )}
\DoxyCodeLine{00779\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00780\ \ \ \ \ \ \ \ \ SampleSplit\_LLH[SampleIterator]-\/>Write();}
\DoxyCodeLine{00781\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ SampleSplit\_LLH[SampleIterator];}
\DoxyCodeLine{00782\ \ \ \ \ \ \ \ \ SampleIterator++;}
\DoxyCodeLine{00783\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00784\ \ \ \ \ \}}
\DoxyCodeLine{00785\ \ \ \}}
\DoxyCodeLine{00786\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classFitterBase_a1a9666dc09f91af804954e8968bc7b24}\label{classFitterBase_a1a9666dc09f91af804954e8968bc7b24}} 
\index{FitterBase@{FitterBase}!runMCMC@{runMCMC}}
\index{runMCMC@{runMCMC}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{runMCMC()}{runMCMC()}}
{\footnotesize\ttfamily virtual void Fitter\+Base\+::run\+MCMC (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [pure virtual]}}



The specific fitting algorithm implemented in this function depends on the derived class. It could be Markov Chain Monte Carlo (MCMC), \mbox{\hyperlink{classMinuitFit}{Minuit\+Fit}}, or another algorithm. 



Implemented in \mbox{\hyperlink{classmcmc_a8a9cc0e0aa65c8573fca703a42b2ee31}{mcmc}}, \mbox{\hyperlink{classMinuitFit_a8e746fb17d4bc75a9d308398a4a0229e}{Minuit\+Fit}}, \mbox{\hyperlink{classPSO_afcd534dbf737430c8ab1e921e8730b81}{PSO}}, and \mbox{\hyperlink{classLikelihoodFit_a97f28cf4797fd2f6e3fac267dcdafb27}{Likelihood\+Fit}}.

\mbox{\Hypertarget{classFitterBase_a71e43b96395568e54879d9bd1b57c0f8}\label{classFitterBase_a71e43b96395568e54879d9bd1b57c0f8}} 
\index{FitterBase@{FitterBase}!RunSigmaVar@{RunSigmaVar}}
\index{RunSigmaVar@{RunSigmaVar}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{RunSigmaVar()}{RunSigmaVar()}}
{\footnotesize\ttfamily void Fitter\+Base\+::\+Run\+Sigma\+Var (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Perform a 2D and 1D sigma var for all samples. 

\begin{DoxyWarning}{Warning}
Code uses TH2\+Poly 
\end{DoxyWarning}


Definition at line \mbox{\hyperlink{FitterBase_8cpp_source_l01032}{1032}} of file \mbox{\hyperlink{FitterBase_8cpp_source}{Fitter\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01032\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01033\ \textcolor{comment}{//\ *************************}}
\DoxyCodeLine{01034\ \ \ \textcolor{comment}{//\ Save\ the\ settings\ into\ the\ output\ file}}
\DoxyCodeLine{01035\ \ \ \mbox{\hyperlink{classFitterBase_a48f38bfa8996fe00d51f35b05dd16b46}{SaveSettings}}();}
\DoxyCodeLine{01036\ }
\DoxyCodeLine{01037\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Starting\ Sigma\ Variation"{}});}
\DoxyCodeLine{01038\ }
\DoxyCodeLine{01039\ \ \ \textcolor{comment}{//\ Number\ of\ variations\ we\ want}}
\DoxyCodeLine{01040\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ numVar\ =\ 5;}
\DoxyCodeLine{01041\ \ \ \textcolor{comment}{//-\/3\ -\/1\ 0\ +1\ +3\ sigma\ variation}}
\DoxyCodeLine{01042\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ sigmaArray[numVar]\ =\ \{-\/3,\ -\/1,\ 0,\ 1,\ 3\};}
\DoxyCodeLine{01043\ }
\DoxyCodeLine{01044\ \ \ \mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}}-\/>cd();}
\DoxyCodeLine{01045\ }
\DoxyCodeLine{01046\ \ \ \textcolor{comment}{//KS:\ this\ is\ only\ relevant\ if\ PlotByMode\ is\ turned\ on}}
\DoxyCodeLine{01047\ \ \ \textcolor{comment}{//Checking\ each\ mode\ is\ time\ consuming\ so\ we\ only\ consider\ one\ which\ are\ relevant\ for\ particular\ analysis}}
\DoxyCodeLine{01048\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ nRelevantModes\ =\ 2;}
\DoxyCodeLine{01049\ \ \ \mbox{\hyperlink{MaCh3Modes_8h_adf43f6c73c9598abc381855d31ef5682}{MaCh3Modes\_t}}\ RelevantModes[nRelevantModes]\ =\ \{\mbox{\hyperlink{classFitterBase_a004cb6e6168032d9280ce3db912f1a43}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_a21af1738d7b145f08d76aa0c163e0486}{GetMode}}(\textcolor{stringliteral}{"{}CCQE"{}}),\ \mbox{\hyperlink{classFitterBase_a004cb6e6168032d9280ce3db912f1a43}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_a21af1738d7b145f08d76aa0c163e0486}{GetMode}}(\textcolor{stringliteral}{"{}2p2h"{}})\};}
\DoxyCodeLine{01050\ \ \ \textcolor{keywordtype}{bool}\ DoByMode\ =\ GetFromManager<int>(\mbox{\hyperlink{classFitterBase_a4fceb68f242feeb04a0ddf42a5a37095}{fitMan}}-\/>\mbox{\hyperlink{classmanager_ab3999cc856ede72b37f68bdb28bd5520}{raw}}()[\textcolor{stringliteral}{"{}General"{}}][\textcolor{stringliteral}{"{}DoByMode"{}}],\ \textcolor{keyword}{false});}
\DoxyCodeLine{01051\ }
\DoxyCodeLine{01052\ \ \ \textcolor{comment}{//KS:\ If\ true\ it\ will\ make\ additional\ plots\ with\ LLH\ sample\ contribution\ in\ each\ bin,\ should\ make\ it\ via\ config\ file...}}
\DoxyCodeLine{01053\ \ \ \textcolor{keywordtype}{bool}\ PlotLLHperBin\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01054\ }
\DoxyCodeLine{01055\ \ \ std::vector<std::string>\ SkipVector;}
\DoxyCodeLine{01056\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classFitterBase_a4fceb68f242feeb04a0ddf42a5a37095}{fitMan}}-\/>\mbox{\hyperlink{classmanager_ab3999cc856ede72b37f68bdb28bd5520}{raw}}()[\textcolor{stringliteral}{"{}General"{}}][\textcolor{stringliteral}{"{}LLHScanSkipVector"{}}])}
\DoxyCodeLine{01057\ \ \ \{}
\DoxyCodeLine{01058\ \ \ \ \ SkipVector\ =\ \mbox{\hyperlink{classFitterBase_a4fceb68f242feeb04a0ddf42a5a37095}{fitMan}}-\/>\mbox{\hyperlink{classmanager_ab3999cc856ede72b37f68bdb28bd5520}{raw}}()[\textcolor{stringliteral}{"{}General"{}}][\textcolor{stringliteral}{"{}LLHScanSkipVector"{}}].as<std::vector<std::string>>();}
\DoxyCodeLine{01059\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Found\ skip\ vector\ with\ \{\}\ entries"{}},\ SkipVector.size());}
\DoxyCodeLine{01060\ \ \ \}}
\DoxyCodeLine{01061\ }
\DoxyCodeLine{01062\ \ \ \textcolor{keywordtype}{bool}\ isxsec\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01063\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classcovarianceBase}{covarianceBase}}\ *cov\ :\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}})}
\DoxyCodeLine{01064\ \ \ \{}
\DoxyCodeLine{01065\ \ \ \ \ TMatrixDSym\ *Cov\ =\ cov-\/>getCovMatrix();}
\DoxyCodeLine{01066\ }
\DoxyCodeLine{01067\ \ \ \ \ \textcolor{keywordflow}{if}(cov-\/>IsPCA())}
\DoxyCodeLine{01068\ \ \ \ \ \{}
\DoxyCodeLine{01069\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Using\ PCAed\ matrix\ not\ implemented\ within\ sigma\ var\ code,\ I\ am\ sorry\ :("{}});}
\DoxyCodeLine{01070\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{01071\ \ \ \ \ \}}
\DoxyCodeLine{01072\ }
\DoxyCodeLine{01073\ \ \ \ \ \textcolor{keywordflow}{if}\ (cov-\/>getName()\ ==\ \textcolor{stringliteral}{"{}xsec\_cov"{}})}
\DoxyCodeLine{01074\ \ \ \ \ \{}
\DoxyCodeLine{01075\ \ \ \ \ \ \ isxsec\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01076\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01077\ \ \ \ \ \ \ isxsec\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01078\ \ \ \ \ \}}
\DoxyCodeLine{01079\ }
\DoxyCodeLine{01080\ \ \ \ \ \textcolor{comment}{//\ Loop\ over\ xsec\ parameters}}
\DoxyCodeLine{01081\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ cov-\/>GetNumParams();\ ++i)}
\DoxyCodeLine{01082\ \ \ \ \ \{}
\DoxyCodeLine{01083\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ parameter\ name}}
\DoxyCodeLine{01084\ \ \ \ \ \ \ std::string\ name\ =\ cov-\/>GetParName(i);}
\DoxyCodeLine{01085\ \ \ \ \ \ \ \textcolor{comment}{//\ For\ xsec\ we\ can\ get\ the\ actual\ name,\ hurray\ for\ being\ informative}}
\DoxyCodeLine{01086\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (isxsec)\ name\ =\ cov-\/>GetParFancyName(i);}
\DoxyCodeLine{01087\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ skip\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01088\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ is\ =\ 0;\ is\ <\ SkipVector.size();\ is++)}
\DoxyCodeLine{01089\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01090\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(name.substr(0,\ SkipVector[is].length())\ ==\ SkipVector[is])}
\DoxyCodeLine{01091\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01092\ \ \ \ \ \ \ \ \ \ \ skip\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01093\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01094\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01095\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01096\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(skip)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01097\ }
\DoxyCodeLine{01098\ \ \ \ \ \ \ \mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}}-\/>cd();}
\DoxyCodeLine{01099\ \ \ \ \ \ \ TDirectory\ *\ dirArryDial\ =\ \mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}}-\/>mkdir(name.c\_str());}
\DoxyCodeLine{01100\ \ \ \ \ \ \ TDirectory\ **dirArrySample\ =\ \textcolor{keyword}{new}\ TDirectory*[\mbox{\hyperlink{classFitterBase_abe9814558b8ff1bccdde3b4c894467e6}{TotalNSamples}}];}
\DoxyCodeLine{01101\ }
\DoxyCodeLine{01102\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ SampleIterator\ =\ 0;}
\DoxyCodeLine{01103\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ each\ sample\ and\ how\ it's\ responded\ to\ our\ reweighted\ parameter}}
\DoxyCodeLine{01104\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivs\ =\ 0;\ ivs\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ivs++\ )}
\DoxyCodeLine{01105\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01106\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>GetNsamples();\ k++\ )}
\DoxyCodeLine{01107\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01108\ \ \ \ \ \ \ \ \ \ \ std::string\ title\ =\ std::string(\mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>getPDF(k)-\/>\mbox{\hyperlink{classFitterBase_a3706f6d722073b447b3de8c3a6516601}{GetName}}());}
\DoxyCodeLine{01109\ \ \ \ \ \ \ \ \ \ \ dirArryDial-\/>cd();}
\DoxyCodeLine{01110\ \ \ \ \ \ \ \ \ \ \ dirArrySample[SampleIterator]\ =\ dirArryDial-\/>mkdir(title.c\_str());}
\DoxyCodeLine{01111\ \ \ \ \ \ \ \ \ \ \ SampleIterator++;}
\DoxyCodeLine{01112\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01113\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01114\ }
\DoxyCodeLine{01115\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ initial\ value\ of\ ith\ parameter}}
\DoxyCodeLine{01116\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ init\ =\ cov-\/>getParInit(i);}
\DoxyCodeLine{01117\ }
\DoxyCodeLine{01118\ \ \ \ \ \ \ TH1D\ ***sigmaArray\_x\ =\ \textcolor{keyword}{new}\ TH1D**[numVar]();}
\DoxyCodeLine{01119\ \ \ \ \ \ \ TH1D\ ***sigmaArray\_y\ =\ \textcolor{keyword}{new}\ TH1D**[numVar]();}
\DoxyCodeLine{01120\ \ \ \ \ \ \ TH1D\ ***sigmaArray\_x\_norm\ =\ \textcolor{keyword}{new}\ TH1D**[numVar]();}
\DoxyCodeLine{01121\ \ \ \ \ \ \ TH1D\ ***sigmaArray\_y\_norm\ =\ \textcolor{keyword}{new}\ TH1D**[numVar]();}
\DoxyCodeLine{01122\ }
\DoxyCodeLine{01123\ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ up\ for\ single\ mode}}
\DoxyCodeLine{01124\ \ \ \ \ \ \ TH1D\ ****sigmaArray\_mode\_x\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01125\ \ \ \ \ \ \ TH1D\ ****sigmaArray\_mode\_y\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01126\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (DoByMode)}
\DoxyCodeLine{01127\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01128\ \ \ \ \ \ \ \ \ sigmaArray\_mode\_x\ =\ \textcolor{keyword}{new}\ TH1D***[numVar]();}
\DoxyCodeLine{01129\ \ \ \ \ \ \ \ \ sigmaArray\_mode\_y\ =\ \textcolor{keyword}{new}\ TH1D***[numVar]();}
\DoxyCodeLine{01130\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01131\ }
\DoxyCodeLine{01132\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\{:<20\}\{\}"{}},\ name,\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{01133\ }
\DoxyCodeLine{01134\ \ \ \ \ \ \ \textcolor{comment}{//\ Make\ asymmetric\ errors\ just\ in\ case}}
\DoxyCodeLine{01135\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ numVar;\ ++j)}
\DoxyCodeLine{01136\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01137\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ New\ value\ =\ prior\ +\ variation*1sigma\ uncertainty}}
\DoxyCodeLine{01138\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ paramVal\ =\ cov-\/>getParInit(i)+sigmaArray[j]*std::sqrt((*Cov)(i,i));}
\DoxyCodeLine{01139\ }
\DoxyCodeLine{01140\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Check\ the\ bounds\ on\ the\ parameter}}
\DoxyCodeLine{01141\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (paramVal\ >\ cov-\/>GetUpperBound(i))\ \{}
\DoxyCodeLine{01142\ \ \ \ \ \ \ \ \ \ \ paramVal\ =\ cov-\/>GetUpperBound(i);}
\DoxyCodeLine{01143\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (paramVal\ <\ cov-\/>GetLowerBound(i))\ \{}
\DoxyCodeLine{01144\ \ \ \ \ \ \ \ \ \ \ paramVal\ =\ cov-\/>GetLowerBound(i);}
\DoxyCodeLine{01145\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01146\ }
\DoxyCodeLine{01147\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ the\ parameter}}
\DoxyCodeLine{01148\ \ \ \ \ \ \ \ \ cov-\/>setParProp(i,\ paramVal);}
\DoxyCodeLine{01149\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ And\ reweight\ the\ sample}}
\DoxyCodeLine{01150\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivs\ =\ 0;\ ivs\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ivs++)\ \{}
\DoxyCodeLine{01151\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>reweight();}
\DoxyCodeLine{01152\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01153\ }
\DoxyCodeLine{01154\ \ \ \ \ \ \ \ \ sigmaArray\_x[j]\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classFitterBase_abe9814558b8ff1bccdde3b4c894467e6}{TotalNSamples}}]();}
\DoxyCodeLine{01155\ \ \ \ \ \ \ \ \ sigmaArray\_y[j]\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classFitterBase_abe9814558b8ff1bccdde3b4c894467e6}{TotalNSamples}}]();}
\DoxyCodeLine{01156\ \ \ \ \ \ \ \ \ sigmaArray\_x\_norm[j]\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classFitterBase_abe9814558b8ff1bccdde3b4c894467e6}{TotalNSamples}}]();}
\DoxyCodeLine{01157\ \ \ \ \ \ \ \ \ sigmaArray\_y\_norm[j]\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classFitterBase_abe9814558b8ff1bccdde3b4c894467e6}{TotalNSamples}}]();}
\DoxyCodeLine{01158\ }
\DoxyCodeLine{01159\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (DoByMode)}
\DoxyCodeLine{01160\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01161\ \ \ \ \ \ \ \ \ \ \ sigmaArray\_mode\_x[j]\ =\ \textcolor{keyword}{new}\ TH1D**[\mbox{\hyperlink{classFitterBase_abe9814558b8ff1bccdde3b4c894467e6}{TotalNSamples}}]();}
\DoxyCodeLine{01162\ \ \ \ \ \ \ \ \ \ \ sigmaArray\_mode\_y[j]\ =\ \textcolor{keyword}{new}\ TH1D**[\mbox{\hyperlink{classFitterBase_abe9814558b8ff1bccdde3b4c894467e6}{TotalNSamples}}]();}
\DoxyCodeLine{01163\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01164\ }
\DoxyCodeLine{01165\ \ \ \ \ \ \ \ \ SampleIterator\ =\ 0;}
\DoxyCodeLine{01166\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ each\ sample\ and\ how\ it's\ responded\ to\ our\ reweighted\ parameter}}
\DoxyCodeLine{01167\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivs\ =\ 0;\ ivs\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ivs++\ )}
\DoxyCodeLine{01168\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01169\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>GetNsamples();\ ++k)}
\DoxyCodeLine{01170\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01171\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Make\ a\ string\ of\ the\ double}}
\DoxyCodeLine{01172\ \ \ \ \ \ \ \ \ \ \ \ \ std::ostringstream\ ss;}
\DoxyCodeLine{01173\ \ \ \ \ \ \ \ \ \ \ \ \ ss\ <<\ paramVal;}
\DoxyCodeLine{01174\ \ \ \ \ \ \ \ \ \ \ \ \ std::string\ parVarTitle\ =\ name\ +\ \textcolor{stringliteral}{"{}\_"{}}\ +\ ss.str();}
\DoxyCodeLine{01175\ }
\DoxyCodeLine{01176\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ is\ a\ TH2D}}
\DoxyCodeLine{01177\ }
\DoxyCodeLine{01178\ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<TH2Poly>\ currSamp(\textcolor{keyword}{static\_cast<}TH2Poly*\textcolor{keyword}{>}(\mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>getPDF(k)-\/>Clone()));}
\DoxyCodeLine{01179\ \ \ \ \ \ \ \ \ \ \ \ \ currSamp-\/>SetDirectory(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{01180\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ a\ descriptiv-\/ish\ title}}
\DoxyCodeLine{01181\ \ \ \ \ \ \ \ \ \ \ \ \ std::string\ title\_long\ =\ std::string(currSamp-\/>GetName())+\textcolor{stringliteral}{"{}\_"{}}+parVarTitle;}
\DoxyCodeLine{01182\ }
\DoxyCodeLine{01183\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Enable\ the\ mode\ histograms\ AFTER\ addSelection\ is\ called}}
\DoxyCodeLine{01184\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Get\ the\ 1d\ binning\ we\ want.\ Let's\ just\ use\ SetupBinning\ to\ get\ this\ as\ it\ already\ exists}}
\DoxyCodeLine{01185\ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<double>\ xbins;}
\DoxyCodeLine{01186\ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<double>\ ybins;}
\DoxyCodeLine{01187\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>SetupBinning(\mbox{\hyperlink{namespaceM3_adb59b8ecdc4e1b2d5d4c826a13aa7463}{M3::int\_t}}(k),\ xbins,\ ybins);}
\DoxyCodeLine{01188\ }
\DoxyCodeLine{01189\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:here\ we\ loop\ over\ all\ reaction\ modes\ defined\ in\ "{}RelevantModes[nRelevantModes]"{}}}
\DoxyCodeLine{01190\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (DoByMode)}
\DoxyCodeLine{01191\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sigmaArray\_mode\_x[j][SampleIterator]\ =\ \textcolor{keyword}{new}\ TH1D*[nRelevantModes]();}
\DoxyCodeLine{01193\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sigmaArray\_mode\_y[j][SampleIterator]\ =\ \textcolor{keyword}{new}\ TH1D*[nRelevantModes]();}
\DoxyCodeLine{01194\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Now\ get\ the\ TH2D\ mode\ variations}}
\DoxyCodeLine{01195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::string\ mode\_title\_long;}
\DoxyCodeLine{01196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ ir\ =\ 0;\ ir\ <\ nRelevantModes;\ ir++)}
\DoxyCodeLine{01197\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01198\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<TH2Poly>\ currSampMode(\textcolor{keyword}{static\_cast<}TH2Poly*\textcolor{keyword}{>}(\mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>getPDFMode(k,\ RelevantModes[ir])-\/>Clone()));}
\DoxyCodeLine{01199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ currSampMode-\/>SetDirectory(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{01200\ }
\DoxyCodeLine{01201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mode\_title\_long\ =\ title\_long\ +\ \textcolor{stringliteral}{"{}\_"{}}\ +\ \mbox{\hyperlink{classFitterBase_a004cb6e6168032d9280ce3db912f1a43}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_abf4ac35511787907bc16ae26aa6c2a15}{GetMaCh3ModeName}}(RelevantModes[ir]);}
\DoxyCodeLine{01202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ currSampMode-\/>SetNameTitle(mode\_title\_long.c\_str(),\ mode\_title\_long.c\_str());}
\DoxyCodeLine{01203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dirArrySample[SampleIterator]-\/>cd();}
\DoxyCodeLine{01204\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ currSampMode-\/>Write();}
\DoxyCodeLine{01205\ }
\DoxyCodeLine{01206\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sigmaArray\_mode\_x[j][SampleIterator][ir]\ =\ \mbox{\hyperlink{Structs_8cpp_a1ab7c868447cffff71227e07655b47ad}{PolyProjectionX}}(currSampMode.get(),\ (mode\_title\_long+\textcolor{stringliteral}{"{}\_xProj"{}}).c\_str(),\ xbins);}
\DoxyCodeLine{01207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sigmaArray\_mode\_x[j][SampleIterator][ir]-\/>SetDirectory(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{01208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sigmaArray\_mode\_y[j][SampleIterator][ir]\ =\ \mbox{\hyperlink{Structs_8cpp_aa26af438a657c81f2fb3f1506c6e35f6}{PolyProjectionY}}(currSampMode.get(),\ (mode\_title\_long+\textcolor{stringliteral}{"{}\_yProj"{}}).c\_str(),\ ybins);}
\DoxyCodeLine{01209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sigmaArray\_mode\_y[j][SampleIterator][ir]-\/>SetDirectory(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{01210\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01211\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01212\ }
\DoxyCodeLine{01213\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ This\ will\ give\ different\ results\ depending\ if\ data\ or\ Asimov,\ both\ have\ their\ uses}}
\DoxyCodeLine{01214\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PlotLLHperBin)}
\DoxyCodeLine{01215\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01216\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<TH2Poly>\ currLLHSamp(\textcolor{keyword}{static\_cast<}TH2Poly*\textcolor{keyword}{>}(\mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>getPDF(k)-\/>Clone()));}
\DoxyCodeLine{01217\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ currLLHSamp-\/>SetDirectory(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{01218\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ currLLHSamp-\/>Reset(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{01219\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ currLLHSamp-\/>Fill(0.0,\ 0.0,\ 0.0);}
\DoxyCodeLine{01220\ }
\DoxyCodeLine{01221\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TH2Poly*\ MCpdf\ =\ \textcolor{keyword}{static\_cast<}TH2Poly*\textcolor{keyword}{>}(\mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>getPDF(k));}
\DoxyCodeLine{01222\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TH2Poly*\ Datapdf\ =\ \textcolor{keyword}{static\_cast<}TH2Poly*\textcolor{keyword}{>}(\mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>getData(k));}
\DoxyCodeLine{01223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TH2Poly*\ W2pdf\ =\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>getW2(k);}
\DoxyCodeLine{01224\ }
\DoxyCodeLine{01225\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ bin\ =\ 1;\ bin\ <\ currLLHSamp-\/>GetNumberOfBins()+1;\ bin++)}
\DoxyCodeLine{01226\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01227\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ mc\ =\ MCpdf-\/>GetBinContent(bin);}
\DoxyCodeLine{01228\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ dat\ =\ Datapdf-\/>GetBinContent(bin);}
\DoxyCodeLine{01229\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ w2\ =\ W2pdf-\/>GetBinContent(bin);}
\DoxyCodeLine{01230\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ currLLHSamp-\/>SetBinContent(bin,\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>getTestStatLLH(dat,\ mc,\ w2));}
\DoxyCodeLine{01231\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01232\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ currLLHSamp-\/>SetNameTitle((title\_long+\textcolor{stringliteral}{"{}\_LLH"{}}).c\_str()\ ,(title\_long+\textcolor{stringliteral}{"{}\_LLH"{}}).c\_str());}
\DoxyCodeLine{01233\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dirArrySample[SampleIterator]-\/>cd();}
\DoxyCodeLine{01234\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ currLLHSamp-\/>Write();}
\DoxyCodeLine{01235\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01236\ }
\DoxyCodeLine{01237\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Project\ down\ onto\ x\ axis}}
\DoxyCodeLine{01238\ \ \ \ \ \ \ \ \ \ \ \ \ sigmaArray\_x[j][SampleIterator]\ =\ \mbox{\hyperlink{Structs_8cpp_a1ab7c868447cffff71227e07655b47ad}{PolyProjectionX}}(currSamp.get(),\ (title\_long+\textcolor{stringliteral}{"{}\_xProj"{}}).c\_str(),\ xbins);}
\DoxyCodeLine{01239\ \ \ \ \ \ \ \ \ \ \ \ \ sigmaArray\_x[j][SampleIterator]-\/>SetDirectory(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{01240\ \ \ \ \ \ \ \ \ \ \ \ \ sigmaArray\_x[j][SampleIterator]-\/>GetXaxis()-\/>SetTitle(currSamp-\/>GetXaxis()-\/>GetTitle());}
\DoxyCodeLine{01241\ \ \ \ \ \ \ \ \ \ \ \ \ sigmaArray\_y[j][SampleIterator]\ =\ \mbox{\hyperlink{Structs_8cpp_aa26af438a657c81f2fb3f1506c6e35f6}{PolyProjectionY}}(currSamp.get(),\ (title\_long+\textcolor{stringliteral}{"{}\_yProj"{}}).c\_str(),\ ybins);}
\DoxyCodeLine{01242\ \ \ \ \ \ \ \ \ \ \ \ \ sigmaArray\_y[j][SampleIterator]-\/>SetDirectory(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{01243\ \ \ \ \ \ \ \ \ \ \ \ \ sigmaArray\_y[j][SampleIterator]-\/>GetXaxis()-\/>SetTitle(currSamp-\/>GetYaxis()-\/>GetTitle());}
\DoxyCodeLine{01244\ }
\DoxyCodeLine{01245\ \ \ \ \ \ \ \ \ \ \ \ \ sigmaArray\_x\_norm[j][SampleIterator]\ =\ \textcolor{keyword}{static\_cast<}TH1D*\textcolor{keyword}{>}(sigmaArray\_x[j][SampleIterator]-\/>Clone());}
\DoxyCodeLine{01246\ \ \ \ \ \ \ \ \ \ \ \ \ sigmaArray\_x\_norm[j][SampleIterator]-\/>SetDirectory(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{01247\ \ \ \ \ \ \ \ \ \ \ \ \ sigmaArray\_x\_norm[j][SampleIterator]-\/>Scale(1.,\ \textcolor{stringliteral}{"{}width"{}});}
\DoxyCodeLine{01248\ \ \ \ \ \ \ \ \ \ \ \ \ sigmaArray\_y\_norm[j][SampleIterator]\ =\ \textcolor{keyword}{static\_cast<}TH1D*\textcolor{keyword}{>}(sigmaArray\_y[j][SampleIterator]-\/>Clone());}
\DoxyCodeLine{01249\ \ \ \ \ \ \ \ \ \ \ \ \ sigmaArray\_y\_norm[j][SampleIterator]-\/>SetDirectory(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{01250\ \ \ \ \ \ \ \ \ \ \ \ \ sigmaArray\_y\_norm[j][SampleIterator]-\/>Scale(1.,\ \textcolor{stringliteral}{"{}width"{}});}
\DoxyCodeLine{01251\ }
\DoxyCodeLine{01252\ \ \ \ \ \ \ \ \ \ \ \ \ currSamp-\/>SetNameTitle(title\_long.c\_str(),\ title\_long.c\_str());}
\DoxyCodeLine{01253\ \ \ \ \ \ \ \ \ \ \ \ \ dirArrySample[k]-\/>cd();}
\DoxyCodeLine{01254\ \ \ \ \ \ \ \ \ \ \ \ \ currSamp-\/>Write();}
\DoxyCodeLine{01255\ }
\DoxyCodeLine{01256\ \ \ \ \ \ \ \ \ \ \ \ \ sigmaArray\_x[j][k]-\/>Write();}
\DoxyCodeLine{01257\ \ \ \ \ \ \ \ \ \ \ \ \ sigmaArray\_y[j][k]-\/>Write();}
\DoxyCodeLine{01258\ \ \ \ \ \ \ \ \ \ \ \ \ SampleIterator++;}
\DoxyCodeLine{01259\ \ \ \ \ \ \ \ \ \ \ \}\textcolor{comment}{//End\ loop\ over\ samples}}
\DoxyCodeLine{01260\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01261\ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ End\ looping\ over\ variation}}
\DoxyCodeLine{01262\ }
\DoxyCodeLine{01263\ \ \ \ \ \ \ \textcolor{comment}{//\ Restore\ the\ parameter\ to\ prior\ value}}
\DoxyCodeLine{01264\ \ \ \ \ \ \ cov-\/>setParProp(i,\ init);}
\DoxyCodeLine{01265\ }
\DoxyCodeLine{01266\ \ \ \ \ \ \ SampleIterator\ =\ 0;}
\DoxyCodeLine{01267\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ each\ sample\ and\ how\ it's\ responded\ to\ our\ reweighted\ parameter}}
\DoxyCodeLine{01268\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivs\ =\ 0;\ ivs\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ivs++\ )}
\DoxyCodeLine{01269\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01270\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>GetNsamples();\ ++k)}
\DoxyCodeLine{01271\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01272\ \ \ \ \ \ \ \ \ \ \ std::string\ title\ =\ std::string(\mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>getPDF(k)-\/>\mbox{\hyperlink{classFitterBase_a3706f6d722073b447b3de8c3a6516601}{GetName}}())\ +\ \textcolor{stringliteral}{"{}\_"{}}\ +\ name;}
\DoxyCodeLine{01273\ \ \ \ \ \ \ \ \ \ \ TGraphAsymmErrors\ *var\_x\ =\ \mbox{\hyperlink{Structs_8cpp_a3b61160c5ff362348884cb311e827221}{MakeAsymGraph}}(sigmaArray\_x[1][SampleIterator],\ sigmaArray\_x[2][SampleIterator],\ sigmaArray\_x[3][SampleIterator],\ (title+\textcolor{stringliteral}{"{}\_X"{}}).c\_str());}
\DoxyCodeLine{01274\ \ \ \ \ \ \ \ \ \ \ TGraphAsymmErrors\ *var\_y\ =\ \mbox{\hyperlink{Structs_8cpp_a3b61160c5ff362348884cb311e827221}{MakeAsymGraph}}(sigmaArray\_y[1][SampleIterator],\ sigmaArray\_y[2][SampleIterator],\ sigmaArray\_y[3][SampleIterator],\ (title+\textcolor{stringliteral}{"{}\_Y"{}}).c\_str());}
\DoxyCodeLine{01275\ }
\DoxyCodeLine{01276\ \ \ \ \ \ \ \ \ \ \ TGraphAsymmErrors\ *var\_x\_norm\ =\ \mbox{\hyperlink{Structs_8cpp_a3b61160c5ff362348884cb311e827221}{MakeAsymGraph}}(sigmaArray\_x\_norm[1][SampleIterator],\ sigmaArray\_x\_norm[2][SampleIterator],\ sigmaArray\_x\_norm[3][SampleIterator],\ (title+\textcolor{stringliteral}{"{}\_X\_norm"{}}).c\_str());}
\DoxyCodeLine{01277\ \ \ \ \ \ \ \ \ \ \ TGraphAsymmErrors\ *var\_y\_norm\ =\ \mbox{\hyperlink{Structs_8cpp_a3b61160c5ff362348884cb311e827221}{MakeAsymGraph}}(sigmaArray\_y\_norm[1][SampleIterator],\ sigmaArray\_y\_norm[2][SampleIterator],\ sigmaArray\_y\_norm[3][SampleIterator],\ (title+\textcolor{stringliteral}{"{}\_Y\_norm"{}}).c\_str());}
\DoxyCodeLine{01278\ }
\DoxyCodeLine{01279\ \ \ \ \ \ \ \ \ \ \ dirArrySample[SampleIterator]-\/>cd();}
\DoxyCodeLine{01280\ \ \ \ \ \ \ \ \ \ \ var\_x-\/>Write();}
\DoxyCodeLine{01281\ \ \ \ \ \ \ \ \ \ \ var\_y-\/>Write();}
\DoxyCodeLine{01282\ \ \ \ \ \ \ \ \ \ \ var\_x\_norm-\/>Write();}
\DoxyCodeLine{01283\ \ \ \ \ \ \ \ \ \ \ var\_y\_norm-\/>Write();}
\DoxyCodeLine{01284\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ var\_x;}
\DoxyCodeLine{01285\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ var\_y;}
\DoxyCodeLine{01286\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ var\_x\_norm;}
\DoxyCodeLine{01287\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ var\_y\_norm;}
\DoxyCodeLine{01288\ }
\DoxyCodeLine{01289\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ here\ we\ loop\ over\ all\ reaction\ modes\ defined\ in\ "{}RelevantModes[nRelevantModes]"{}}}
\DoxyCodeLine{01290\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (DoByMode)}
\DoxyCodeLine{01291\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01292\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ ir\ =\ 0;\ ir\ <\ nRelevantModes;ir++)}
\DoxyCodeLine{01293\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01294\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TGraphAsymmErrors*\ var\_mode\_x\ =\ \mbox{\hyperlink{Structs_8cpp_a3b61160c5ff362348884cb311e827221}{MakeAsymGraph}}(sigmaArray\_mode\_x[1][SampleIterator][ir],\ sigmaArray\_mode\_x[2][SampleIterator][ir],\ sigmaArray\_mode\_x[3][SampleIterator][ir],\ (title+\textcolor{stringliteral}{"{}\_"{}}+\mbox{\hyperlink{classFitterBase_a004cb6e6168032d9280ce3db912f1a43}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_abf4ac35511787907bc16ae26aa6c2a15}{GetMaCh3ModeName}}(RelevantModes[ir])+\textcolor{stringliteral}{"{}\_X"{}}).c\_str());}
\DoxyCodeLine{01295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TGraphAsymmErrors*\ var\_mode\_y\ =\ \mbox{\hyperlink{Structs_8cpp_a3b61160c5ff362348884cb311e827221}{MakeAsymGraph}}(sigmaArray\_mode\_y[1][SampleIterator][ir],\ sigmaArray\_mode\_y[2][SampleIterator][ir],\ sigmaArray\_mode\_y[3][SampleIterator][ir],\ (title+\textcolor{stringliteral}{"{}\_"{}}+\mbox{\hyperlink{classFitterBase_a004cb6e6168032d9280ce3db912f1a43}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_abf4ac35511787907bc16ae26aa6c2a15}{GetMaCh3ModeName}}(RelevantModes[ir])+\textcolor{stringliteral}{"{}\_Y"{}}).c\_str());}
\DoxyCodeLine{01296\ }
\DoxyCodeLine{01297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dirArrySample[SampleIterator]-\/>cd();}
\DoxyCodeLine{01298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ var\_mode\_x-\/>Write();}
\DoxyCodeLine{01299\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ var\_mode\_y-\/>Write();}
\DoxyCodeLine{01300\ }
\DoxyCodeLine{01301\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ var\_mode\_x;}
\DoxyCodeLine{01302\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ var\_mode\_y;}
\DoxyCodeLine{01303\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ end\ for\ nRelevantModes}}
\DoxyCodeLine{01304\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ end\ if\ mode}}
\DoxyCodeLine{01305\ }
\DoxyCodeLine{01306\ \ \ \ \ \ \ \ \ \ \ SampleIterator++;}
\DoxyCodeLine{01307\ \ \ \ \ \ \ \ \ \}\textcolor{comment}{//End\ loop\ over\ samples(k)}}
\DoxyCodeLine{01308\ \ \ \ \ \ \ \}\textcolor{comment}{//end\ looping\ over\ sample\ object}}
\DoxyCodeLine{01309\ \ \ \ \ \ \ SampleIterator\ =\ 0;}
\DoxyCodeLine{01310\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivs\ =\ 0;\ ivs\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ivs++\ )}
\DoxyCodeLine{01311\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01312\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>GetNsamples();\ ++k)}
\DoxyCodeLine{01313\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01314\ \ \ \ \ \ \ \ \ \ \ dirArrySample[SampleIterator]-\/>Close();}
\DoxyCodeLine{01315\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ dirArrySample[SampleIterator];}
\DoxyCodeLine{01316\ \ \ \ \ \ \ \ \ \ \ SampleIterator++;}
\DoxyCodeLine{01317\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01318\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01319\ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ dirArrySample;}
\DoxyCodeLine{01320\ }
\DoxyCodeLine{01321\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ numVar;\ ++j)}
\DoxyCodeLine{01322\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01323\ \ \ \ \ \ \ \ \ SampleIterator\ =\ 0;}
\DoxyCodeLine{01324\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivs\ =\ 0;\ ivs\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ivs++\ )}
\DoxyCodeLine{01325\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01326\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>GetNsamples();\ ++k)}
\DoxyCodeLine{01327\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01328\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ sigmaArray\_x[j][SampleIterator];}
\DoxyCodeLine{01329\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ sigmaArray\_y[j][SampleIterator];}
\DoxyCodeLine{01330\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ sigmaArray\_x\_norm[j][SampleIterator];}
\DoxyCodeLine{01331\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ sigmaArray\_y\_norm[j][SampleIterator];}
\DoxyCodeLine{01332\ \ \ \ \ \ \ \ \ \ \ \ \ SampleIterator++;}
\DoxyCodeLine{01333\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01334\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01335\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ sigmaArray\_x[j];}
\DoxyCodeLine{01336\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ sigmaArray\_y[j];}
\DoxyCodeLine{01337\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ sigmaArray\_x\_norm[j];}
\DoxyCodeLine{01338\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ sigmaArray\_y\_norm[j];}
\DoxyCodeLine{01339\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01340\ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ sigmaArray\_x;}
\DoxyCodeLine{01341\ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ sigmaArray\_y;}
\DoxyCodeLine{01342\ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ sigmaArray\_x\_norm;}
\DoxyCodeLine{01343\ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ sigmaArray\_y\_norm;}
\DoxyCodeLine{01344\ }
\DoxyCodeLine{01345\ \ \ \ \ \ \ dirArryDial-\/>Close();}
\DoxyCodeLine{01346\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ dirArryDial;}
\DoxyCodeLine{01347\ }
\DoxyCodeLine{01348\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (DoByMode)}
\DoxyCodeLine{01349\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01350\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ numVar;\ ++j)}
\DoxyCodeLine{01351\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01352\ \ \ \ \ \ \ \ \ \ \ SampleIterator\ =\ 0;}
\DoxyCodeLine{01353\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ivs\ =\ 0;\ ivs\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ivs++\ )}
\DoxyCodeLine{01354\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01355\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[ivs]-\/>GetNsamples();\ ++k)}
\DoxyCodeLine{01356\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01357\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ ir\ =\ 0;\ ir\ <\ nRelevantModes;ir++)}
\DoxyCodeLine{01358\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ sigmaArray\_mode\_x[j][SampleIterator][ir];}
\DoxyCodeLine{01360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ sigmaArray\_mode\_y[j][SampleIterator][ir];}
\DoxyCodeLine{01361\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\textcolor{comment}{//\ end\ for\ nRelevantModes}}
\DoxyCodeLine{01362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ sigmaArray\_mode\_x[j][SampleIterator];}
\DoxyCodeLine{01363\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ sigmaArray\_mode\_y[j][SampleIterator];}
\DoxyCodeLine{01364\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SampleIterator++;}
\DoxyCodeLine{01365\ \ \ \ \ \ \ \ \ \ \ \ \ \}\textcolor{comment}{//\ end\ for\ samples}}
\DoxyCodeLine{01366\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01367\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01368\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ sigmaArray\_mode\_x;}
\DoxyCodeLine{01369\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ sigmaArray\_mode\_y;}
\DoxyCodeLine{01370\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01371\ \ \ \ \ \}\ \textcolor{comment}{//\ end\ looping\ over\ xsec\ parameters\ (i)}}
\DoxyCodeLine{01372\ \ \ \}\ \textcolor{comment}{//\ end\ looping\ over\ covarianceBase\ objects}}
\DoxyCodeLine{01373\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classFitterBase_a418f581b688f035211107ddd83168c08}\label{classFitterBase_a418f581b688f035211107ddd83168c08}} 
\index{FitterBase@{FitterBase}!SaveOutput@{SaveOutput}}
\index{SaveOutput@{SaveOutput}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{SaveOutput()}{SaveOutput()}}
{\footnotesize\ttfamily void Fitter\+Base\+::\+Save\+Output (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Save output and close files. 



Definition at line \mbox{\hyperlink{FitterBase_8cpp_source_l00215}{215}} of file \mbox{\hyperlink{FitterBase_8cpp_source}{Fitter\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00216\ \textcolor{comment}{//\ *******************}}
\DoxyCodeLine{00217\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classFitterBase_a699abe6a2c89706b54544212152d613a}{FileSaved}})\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00218\ \ \ \textcolor{comment}{//Stop\ Clock}}
\DoxyCodeLine{00219\ \ \ \mbox{\hyperlink{classFitterBase_a858edb45544f690e90b60b9e041394a6}{clock}}-\/>Stop();}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \ \ \mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}}-\/>cd();}
\DoxyCodeLine{00222\ \ \ \mbox{\hyperlink{classFitterBase_aed2032b9c4a4f2248abe548f54f8dcc8}{outTree}}-\/>Write();}
\DoxyCodeLine{00223\ }
\DoxyCodeLine{00224\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\{\}\ steps\ took\ \{:.2f\}\ seconds\ to\ complete.\ (\{:.2f\}s\ /\ step)."{}},\ \mbox{\hyperlink{classFitterBase_a50df1bd75b20a953f81ab9c2bab6b42c}{step}},\ \mbox{\hyperlink{classFitterBase_a858edb45544f690e90b60b9e041394a6}{clock}}-\/>RealTime(),\ \mbox{\hyperlink{classFitterBase_a858edb45544f690e90b60b9e041394a6}{clock}}-\/>RealTime()\ /\ \mbox{\hyperlink{classFitterBase_a50df1bd75b20a953f81ab9c2bab6b42c}{step}});}
\DoxyCodeLine{00225\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\{\}\ steps\ were\ accepted."{}},\ \mbox{\hyperlink{classFitterBase_a2774f3a0047c4347ee0db05406425f79}{accCount}});}
\DoxyCodeLine{00226\ \textcolor{preprocessor}{\ \ \#ifdef\ DEBUG}}
\DoxyCodeLine{00227\ \ \ \textcolor{keywordflow}{if}\ (debug)}
\DoxyCodeLine{00228\ \ \ \{}
\DoxyCodeLine{00229\ \ \ \ \ debugFile\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}}\ <<\ \mbox{\hyperlink{classFitterBase_a50df1bd75b20a953f81ab9c2bab6b42c}{step}}\ <<\ \textcolor{stringliteral}{"{}\ steps\ took\ "{}}\ <<\ \mbox{\hyperlink{classFitterBase_a858edb45544f690e90b60b9e041394a6}{clock}}-\/>RealTime()\ <<\ \textcolor{stringliteral}{"{}\ seconds\ to\ complete.\ ("{}}\ <<\ \mbox{\hyperlink{classFitterBase_a858edb45544f690e90b60b9e041394a6}{clock}}-\/>RealTime()\ /\ \mbox{\hyperlink{classFitterBase_a50df1bd75b20a953f81ab9c2bab6b42c}{step}}\ <<\ \textcolor{stringliteral}{"{}s\ /\ step).\(\backslash\)n"{}}\ <<\ \mbox{\hyperlink{classFitterBase_a2774f3a0047c4347ee0db05406425f79}{accCount}}<<\ \textcolor{stringliteral}{"{}\ steps\ were\ accepted."{}}\ <<\ std::endl;}
\DoxyCodeLine{00230\ \ \ \ \ debugFile.close();}
\DoxyCodeLine{00231\ \ \ \}}
\DoxyCodeLine{00232\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00234\ \ \ \mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}}-\/>Close();}
\DoxyCodeLine{00235\ \ \ \mbox{\hyperlink{classFitterBase_a699abe6a2c89706b54544212152d613a}{FileSaved}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00236\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classFitterBase_a48f38bfa8996fe00d51f35b05dd16b46}\label{classFitterBase_a48f38bfa8996fe00d51f35b05dd16b46}} 
\index{FitterBase@{FitterBase}!SaveSettings@{SaveSettings}}
\index{SaveSettings@{SaveSettings}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{SaveSettings()}{SaveSettings()}}
{\footnotesize\ttfamily void Fitter\+Base\+::\+Save\+Settings (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Save the settings that the MCMC was run with. 



Definition at line \mbox{\hyperlink{FitterBase_8cpp_source_l00084}{84}} of file \mbox{\hyperlink{FitterBase_8cpp_source}{Fitter\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00085\ \textcolor{comment}{//\ *******************}}
\DoxyCodeLine{00086\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classFitterBase_a588678c71d816f48ba3c140543dbe916}{SettingsSaved}})\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}}-\/>cd();}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \ \ TDirectory*\ MaCh3Version\ =\ \mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}}-\/>mkdir(\textcolor{stringliteral}{"{}MaCh3Engine"{}});}
\DoxyCodeLine{00091\ \ \ MaCh3Version-\/>cd();}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \textcolor{keywordflow}{if}\ (std::getenv(\textcolor{stringliteral}{"{}MaCh3\_ROOT"{}})\ ==\ NULL)\ \{}
\DoxyCodeLine{00094\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Need\ MaCh3\_ROOT\ environment\ variable"{}});}
\DoxyCodeLine{00095\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Please\ remember\ about\ source\ bin/setup.MaCh3.sh"{}});}
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00097\ \ \ \}}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \ \ \textcolor{keywordflow}{if}\ (std::getenv(\textcolor{stringliteral}{"{}MACH3"{}})\ ==\ NULL)\ \{}
\DoxyCodeLine{00100\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Need\ MACH3\ environment\ variable"{}});}
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00102\ \ \ \}}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \ \ std::string\ header\_path\ =\ std::string(std::getenv(\textcolor{stringliteral}{"{}MACH3"{}}));}
\DoxyCodeLine{00105\ \ \ header\_path\ +=\ \textcolor{stringliteral}{"{}/version.h"{}};}
\DoxyCodeLine{00106\ \ \ FILE*\ file\ =\ fopen(header\_path.c\_str(),\ \textcolor{stringliteral}{"{}r"{}});}
\DoxyCodeLine{00107\ \ \ \textcolor{comment}{//KS:\ It\ is\ better\ to\ use\ experiment\ specific\ header\ file.\ If\ given\ experiment\ didn't\ provide\ it\ we\ gonna\ use\ one\ given\ by\ Core\ MaCh3.}}
\DoxyCodeLine{00108\ \ \ \textcolor{keywordflow}{if}\ (!file)}
\DoxyCodeLine{00109\ \ \ \{}
\DoxyCodeLine{00110\ \ \ \ \ header\_path\ =\ std::string(std::getenv(\textcolor{stringliteral}{"{}MaCh3\_ROOT"{}}));}
\DoxyCodeLine{00111\ \ \ \ \ header\_path\ +=\ \textcolor{stringliteral}{"{}/version.h"{}};}
\DoxyCodeLine{00112\ \ \ \}}
\DoxyCodeLine{00113\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00114\ \ \ \{}
\DoxyCodeLine{00115\ \ \ \ \ fclose(file);}
\DoxyCodeLine{00116\ \ \ \}}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \ \ \textcolor{comment}{//\ EM:\ embed\ the\ cmake\ generated\ version.h\ file}}
\DoxyCodeLine{00119\ \ \ TMacro\ versionHeader(\textcolor{stringliteral}{"{}version\_header"{}},\ \textcolor{stringliteral}{"{}version\_header"{}});}
\DoxyCodeLine{00120\ \ \ versionHeader.ReadFile(header\_path.c\_str());}
\DoxyCodeLine{00121\ \ \ versionHeader.Write();}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \ \ TNamed\ Engine(\mbox{\hyperlink{classFitterBase_a3706f6d722073b447b3de8c3a6516601}{GetName}}(),\ \mbox{\hyperlink{classFitterBase_a3706f6d722073b447b3de8c3a6516601}{GetName}}());}
\DoxyCodeLine{00124\ \ \ Engine.Write(\mbox{\hyperlink{classFitterBase_a3706f6d722073b447b3de8c3a6516601}{GetName}}().c\_str());}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \ \ MaCh3Version-\/>Write();}
\DoxyCodeLine{00127\ \ \ \textcolor{keyword}{delete}\ MaCh3Version;}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \ \ \mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}}-\/>cd();}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \mbox{\hyperlink{classFitterBase_a4fceb68f242feeb04a0ddf42a5a37095}{fitMan}}-\/>\mbox{\hyperlink{classmanager_a0990af01a220479a19ead5d0231aaf94}{SaveSettings}}(\mbox{\hyperlink{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}{outputFile}});}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}\(\backslash\)033[0;31mCurrent\ Total\ RAM\ usage\ is\ \{:.2f\}\ GB\(\backslash\)033[0m"{}},\ \mbox{\hyperlink{namespaceMaCh3Utils_aa406fc13341d99d4ca7a4f43bbb38019}{MaCh3Utils::getValue}}(\textcolor{stringliteral}{"{}VmRSS"{}})\ /\ 1048576.0);}
\DoxyCodeLine{00134\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}\(\backslash\)033[0;31mOut\ of\ Total\ available\ RAM\ \{:.2f\}\ GB\(\backslash\)033[0m"{}},\ \mbox{\hyperlink{namespaceMaCh3Utils_aa406fc13341d99d4ca7a4f43bbb38019}{MaCh3Utils::getValue}}(\textcolor{stringliteral}{"{}MemTotal"{}})\ /\ 1048576.0);}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00136\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\#\#\#\#\#Current\ Setup\#\#\#\#\#"{}});}
\DoxyCodeLine{00137\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Number\ of\ covariances:\ \{\}"{}},\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}.size());}
\DoxyCodeLine{00138\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}.size();\ ++i)}
\DoxyCodeLine{00139\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\{\}:\ Cov\ name:\ \{\},\ it\ has\ \{\}\ params"{}},\ i,\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}[i]-\/>getName(),\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}[i]-\/>GetNumParams());}
\DoxyCodeLine{00140\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Number\ of\ SamplePDFs:\ \{\}"{}},\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size());}
\DoxyCodeLine{00141\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}.size();\ ++i)}
\DoxyCodeLine{00142\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\{\}:\ SamplePDF\ name:\ \{\},\ it\ has\ \{\}\ samples"{}},i\ ,\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[i]-\/>\mbox{\hyperlink{classFitterBase_a3706f6d722073b447b3de8c3a6516601}{GetName}}(),\ \mbox{\hyperlink{classFitterBase_afac0dcceb1df194159c07945e8dc0069}{samples}}[i]-\/>GetNsamples());}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \ \ \mbox{\hyperlink{classFitterBase_a588678c71d816f48ba3c140543dbe916}{SettingsSaved}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00145\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classFitterBase_a655ccea31627627e2b36745c97e5c0f0}\label{classFitterBase_a655ccea31627627e2b36745c97e5c0f0}} 
\index{FitterBase@{FitterBase}!StartFromPreviousFit@{StartFromPreviousFit}}
\index{StartFromPreviousFit@{StartFromPreviousFit}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{StartFromPreviousFit()}{StartFromPreviousFit()}}
{\footnotesize\ttfamily void Fitter\+Base\+::\+Start\+From\+Previous\+Fit (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{Fit\+Name }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Allow to start from previous fit/chain. 


\begin{DoxyParams}{Parameters}
{\em Fit\+Name} & Name of previous chain \\
\hline
\end{DoxyParams}
\begin{DoxyRefDesc}{Todo}
\item[\mbox{\hyperlink{todo__todo000006}{Todo}}]implement some check that number of params matches etc \end{DoxyRefDesc}


Reimplemented in \mbox{\hyperlink{classmcmc_adf4c80255288c5396da3b95d609ce4b2}{mcmc}}.



Definition at line \mbox{\hyperlink{FitterBase_8cpp_source_l00285}{285}} of file \mbox{\hyperlink{FitterBase_8cpp_source}{Fitter\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00286\ \textcolor{comment}{//\ *******************}}
\DoxyCodeLine{00287\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Getting\ starting\ position\ from\ \{\}"{}},\ FitName);}
\DoxyCodeLine{00288\ }
\DoxyCodeLine{00289\ \ \ TFile\ *infile\ =\ \textcolor{keyword}{new}\ TFile(FitName.c\_str(),\ \textcolor{stringliteral}{"{}READ"{}});}
\DoxyCodeLine{00290\ \ \ TTree\ *posts\ =\ infile-\/>Get<TTree>(\textcolor{stringliteral}{"{}posteriors"{}});}
\DoxyCodeLine{00291\ \ \ \textcolor{keywordtype}{int}\ step\_val\ =\ 0;}
\DoxyCodeLine{00292\ \ \ \textcolor{keywordtype}{double}\ log\_val\ =\ \mbox{\hyperlink{covarianceBase_8h_a194098591fd0bc4afaf13b4fd8fee408}{\_LARGE\_LOGL\_}};}
\DoxyCodeLine{00293\ \ \ posts-\/>SetBranchAddress(\textcolor{stringliteral}{"{}step"{}},\&step\_val);}
\DoxyCodeLine{00294\ \ \ posts-\/>SetBranchAddress(\textcolor{stringliteral}{"{}LogL"{}},\&log\_val);}
\DoxyCodeLine{00295\ }
\DoxyCodeLine{00296\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ s\ =\ 0;\ s\ <\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}.size();\ ++s)}
\DoxyCodeLine{00297\ \ \ \{}
\DoxyCodeLine{00298\ \ \ \ \ TDirectory*\ CovarianceFolder\ =\ infile-\/>Get<TDirectory>(\textcolor{stringliteral}{"{}CovarianceFolder"{}});}
\DoxyCodeLine{00299\ }
\DoxyCodeLine{00300\ \ \ \ \ std::string\ ConfigName\ =\ \textcolor{stringliteral}{"{}Config\_"{}}\ +\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}[s]-\/>getName();}
\DoxyCodeLine{00301\ \ \ \ \ TMacro\ *ConfigCov\ =\ CovarianceFolder-\/>Get<TMacro>(ConfigName.c\_str());}
\DoxyCodeLine{00302\ \ \ \ \ \textcolor{comment}{//\ KS:\ Not\ every\ covariance\ uses\ yaml,\ if\ it\ uses\ yaml\ make\ sure\ they\ are\ identical}}
\DoxyCodeLine{00303\ \ \ \ \ \textcolor{keywordflow}{if}\ (ConfigCov\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \textcolor{comment}{//\ Config\ which\ was\ in\ MCMC\ from\ which\ we\ are\ starting}}
\DoxyCodeLine{00305\ \ \ \ \ \ \ YAML::Node\ CovSettings\ =\ \mbox{\hyperlink{YamlHelper_8h_a7e0ade2fd295a927676c243c97d0aa64}{TMacroToYAML}}(*ConfigCov);}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \textcolor{comment}{//\ Config\ from\ currently\ used\ cov\ object}}
\DoxyCodeLine{00307\ \ \ \ \ \ \ YAML::Node\ ConfigCurrent\ =\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}[s]-\/>GetConfig();}
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00309\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{YamlHelper_8h_ab06d2acbecc5692cab63bdf679ef0034}{compareYAMLNodes}}(CovSettings,\ ConfigCurrent))}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Yaml\ configs\ in\ previous\ chain\ and\ current\ one\ are\ different"{}},\ FitName);}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00314\ \ \ \ \ \}}
\DoxyCodeLine{00315\ \ \ \ \ \textcolor{keywordflow}{if}(ConfigCov\ ==\ \textcolor{keyword}{nullptr})\ \textcolor{keyword}{delete}\ ConfigCov;}
\DoxyCodeLine{00316\ }
\DoxyCodeLine{00317\ \ \ \ \ std::vector<double>\ branch\_vals(\mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}[s]-\/>GetNumParams());}
\DoxyCodeLine{00318\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}[s]-\/>GetNumParams();\ ++i)\ \{}
\DoxyCodeLine{00319\ \ \ \ \ \ \ branch\_vals[i]\ =\ \mbox{\hyperlink{Structs_8h_aa2920b946077e971486eaf1b49101f01}{\_BAD\_DOUBLE\_}};}
\DoxyCodeLine{00320\ \ \ \ \ \ \ posts-\/>SetBranchAddress(\mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}[s]-\/>GetParName(i).c\_str(),\ \&branch\_vals[i]);}
\DoxyCodeLine{00321\ \ \ \ \ \}}
\DoxyCodeLine{00322\ \ \ \ \ posts-\/>GetEntry(posts-\/>GetEntries()-\/1);}
\DoxyCodeLine{00323\ }
\DoxyCodeLine{00324\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}[s]-\/>GetNumParams();\ ++i)\ \{}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(branch\_vals[i]\ ==\ \mbox{\hyperlink{Structs_8h_aa2920b946077e971486eaf1b49101f01}{\_BAD\_DOUBLE\_}})}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Parameter\ \{\}\ is\ unvitalised\ with\ value\ \{\}"{}},\ i,\ branch\_vals[i]);}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Please\ check\ more\ precisely\ chain\ you\ passed\ \{\}"{}},\ FitName);}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00331\ \ \ \ \ \}}
\DoxyCodeLine{00332\ \ \ \ \ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}[s]-\/>setParameters(branch\_vals);}
\DoxyCodeLine{00333\ \ \ \ \ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}[s]-\/>acceptStep();}
\DoxyCodeLine{00334\ }
\DoxyCodeLine{00335\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Printing\ new\ starting\ values\ for:\ \{\}"{}},\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}[s]-\/>getName());}
\DoxyCodeLine{00336\ \ \ \ \ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}[s]-\/>printNominalCurrProp();}
\DoxyCodeLine{00337\ }
\DoxyCodeLine{00338\ \ \ \ \ CovarianceFolder-\/>Close();}
\DoxyCodeLine{00339\ \ \ \ \ \textcolor{keyword}{delete}\ CovarianceFolder;}
\DoxyCodeLine{00340\ \ \ \}}
\DoxyCodeLine{00341\ \ \ \mbox{\hyperlink{classFitterBase_abfb6f10720764d8bbbe43754fd5cd976}{logLCurr}}\ =\ log\_val;}
\DoxyCodeLine{00342\ }
\DoxyCodeLine{00343\ \ \ infile-\/>Close();}
\DoxyCodeLine{00344\ \ \ \textcolor{keyword}{delete}\ infile;}
\DoxyCodeLine{00345\ }
\DoxyCodeLine{00346\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ s\ =\ 0;\ s\ <\ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}.size();\ ++s)\ \{}
\DoxyCodeLine{00347\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}[s]-\/>getDoAdaption())\{\ \textcolor{comment}{//Use\ separate\ throw\ matrix\ for\ xsec}}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \mbox{\hyperlink{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}{systematics}}[s]-\/>setNumberOfSteps(step\_val);}
\DoxyCodeLine{00349\ \ \ \ \ \}}
\DoxyCodeLine{00350\ \ \ \}}
\DoxyCodeLine{00351\ \}}

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classFitterBase_a2774f3a0047c4347ee0db05406425f79}\label{classFitterBase_a2774f3a0047c4347ee0db05406425f79}} 
\index{FitterBase@{FitterBase}!accCount@{accCount}}
\index{accCount@{accCount}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{accCount}{accCount}}
{\footnotesize\ttfamily int Fitter\+Base\+::acc\+Count\hspace{0.3cm}{\ttfamily [protected]}}



counts accepted steps 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00095}{95}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.

\mbox{\Hypertarget{classFitterBase_a6319d2ea50984860475bbc6c708b0d90}\label{classFitterBase_a6319d2ea50984860475bbc6c708b0d90}} 
\index{FitterBase@{FitterBase}!accProb@{accProb}}
\index{accProb@{accProb}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{accProb}{accProb}}
{\footnotesize\ttfamily double Fitter\+Base\+::acc\+Prob\hspace{0.3cm}{\ttfamily [protected]}}



current acceptance prob 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00093}{93}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.

\mbox{\Hypertarget{classFitterBase_ad955982e63066918cba9c53381608d09}\label{classFitterBase_ad955982e63066918cba9c53381608d09}} 
\index{FitterBase@{FitterBase}!auto\_save@{auto\_save}}
\index{auto\_save@{auto\_save}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{auto\_save}{auto\_save}}
{\footnotesize\ttfamily int Fitter\+Base\+::auto\+\_\+save\hspace{0.3cm}{\ttfamily [protected]}}



auto save every N steps 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00127}{127}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.

\mbox{\Hypertarget{classFitterBase_a858edb45544f690e90b60b9e041394a6}\label{classFitterBase_a858edb45544f690e90b60b9e041394a6}} 
\index{FitterBase@{FitterBase}!clock@{clock}}
\index{clock@{clock}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{clock}{clock}}
{\footnotesize\ttfamily std\+::unique\+\_\+ptr$<$TStopwatch$>$ Fitter\+Base\+::clock\hspace{0.3cm}{\ttfamily [protected]}}



tells global time how long fit took 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00111}{111}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.

\mbox{\Hypertarget{classFitterBase_aacc46437245ba8a9817f2ed2e86a96e0}\label{classFitterBase_aacc46437245ba8a9817f2ed2e86a96e0}} 
\index{FitterBase@{FitterBase}!CovFolder@{CovFolder}}
\index{CovFolder@{CovFolder}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{CovFolder}{CovFolder}}
{\footnotesize\ttfamily TDirectory$\ast$ Fitter\+Base\+::\+Cov\+Folder\hspace{0.3cm}{\ttfamily [protected]}}



Output cov folder. 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00123}{123}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.

\mbox{\Hypertarget{classFitterBase_a699abe6a2c89706b54544212152d613a}\label{classFitterBase_a699abe6a2c89706b54544212152d613a}} 
\index{FitterBase@{FitterBase}!FileSaved@{FileSaved}}
\index{FileSaved@{FileSaved}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{FileSaved}{FileSaved}}
{\footnotesize\ttfamily bool Fitter\+Base\+::\+File\+Saved\hspace{0.3cm}{\ttfamily [protected]}}



Checks if file saved not repeat some operations. 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00137}{137}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.

\mbox{\Hypertarget{classFitterBase_a4fceb68f242feeb04a0ddf42a5a37095}\label{classFitterBase_a4fceb68f242feeb04a0ddf42a5a37095}} 
\index{FitterBase@{FitterBase}!fitMan@{fitMan}}
\index{fitMan@{fitMan}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{fitMan}{fitMan}}
{\footnotesize\ttfamily \mbox{\hyperlink{classmanager}{manager}}$\ast$ Fitter\+Base\+::fit\+Man\hspace{0.3cm}{\ttfamily [protected]}}



The manager. 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00081}{81}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.

\mbox{\Hypertarget{classFitterBase_ada898e35bab22af470f2cd1e28af609b}\label{classFitterBase_ada898e35bab22af470f2cd1e28af609b}} 
\index{FitterBase@{FitterBase}!fTestLikelihood@{fTestLikelihood}}
\index{fTestLikelihood@{fTestLikelihood}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{fTestLikelihood}{fTestLikelihood}}
{\footnotesize\ttfamily bool Fitter\+Base\+::f\+Test\+Likelihood\hspace{0.3cm}{\ttfamily [protected]}}



Necessary for some fitting algorithms like \mbox{\hyperlink{classPSO}{PSO}}. 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00130}{130}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.

\mbox{\Hypertarget{classFitterBase_abfb6f10720764d8bbbe43754fd5cd976}\label{classFitterBase_abfb6f10720764d8bbbe43754fd5cd976}} 
\index{FitterBase@{FitterBase}!logLCurr@{logLCurr}}
\index{logLCurr@{logLCurr}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{logLCurr}{logLCurr}}
{\footnotesize\ttfamily double Fitter\+Base\+::log\+LCurr\hspace{0.3cm}{\ttfamily [protected]}}



current likelihood 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00089}{89}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.

\mbox{\Hypertarget{classFitterBase_a187dd22c17f9e96e5a7e2fb2371abace}\label{classFitterBase_a187dd22c17f9e96e5a7e2fb2371abace}} 
\index{FitterBase@{FitterBase}!logLProp@{logLProp}}
\index{logLProp@{logLProp}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{logLProp}{logLProp}}
{\footnotesize\ttfamily double Fitter\+Base\+::log\+LProp\hspace{0.3cm}{\ttfamily [protected]}}



proposed likelihood 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00091}{91}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.

\mbox{\Hypertarget{classFitterBase_a004cb6e6168032d9280ce3db912f1a43}\label{classFitterBase_a004cb6e6168032d9280ce3db912f1a43}} 
\index{FitterBase@{FitterBase}!Modes@{Modes}}
\index{Modes@{Modes}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{Modes}{Modes}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaCh3Modes}{Ma\+Ch3\+Modes}}$\ast$ Fitter\+Base\+::\+Modes\hspace{0.3cm}{\ttfamily [protected]}}



Ma\+Ch3 Modes. 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00084}{84}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.

\mbox{\Hypertarget{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}\label{classFitterBase_a4260b312e3f35cf01fc73b02239f8990}} 
\index{FitterBase@{FitterBase}!outputFile@{outputFile}}
\index{outputFile@{outputFile}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{outputFile}{outputFile}}
{\footnotesize\ttfamily TFile$\ast$ Fitter\+Base\+::output\+File\hspace{0.3cm}{\ttfamily [protected]}}



Output. 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00121}{121}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.

\mbox{\Hypertarget{classFitterBase_a3bfd8f69df891d03bae0587cd1a1e1b7}\label{classFitterBase_a3bfd8f69df891d03bae0587cd1a1e1b7}} 
\index{FitterBase@{FitterBase}!OutputPrepared@{OutputPrepared}}
\index{OutputPrepared@{OutputPrepared}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{OutputPrepared}{OutputPrepared}}
{\footnotesize\ttfamily bool Fitter\+Base\+::\+Output\+Prepared\hspace{0.3cm}{\ttfamily [protected]}}



Checks if output prepared not repeat some operations. 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00141}{141}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.

\mbox{\Hypertarget{classFitterBase_aed2032b9c4a4f2248abe548f54f8dcc8}\label{classFitterBase_aed2032b9c4a4f2248abe548f54f8dcc8}} 
\index{FitterBase@{FitterBase}!outTree@{outTree}}
\index{outTree@{outTree}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{outTree}{outTree}}
{\footnotesize\ttfamily TTree$\ast$ Fitter\+Base\+::out\+Tree\hspace{0.3cm}{\ttfamily [protected]}}



Output tree with posteriors. 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00125}{125}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.

\mbox{\Hypertarget{classFitterBase_a138f250d9204a30204e4ca5b973008b2}\label{classFitterBase_a138f250d9204a30204e4ca5b973008b2}} 
\index{FitterBase@{FitterBase}!random@{random}}
\index{random@{random}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{random}{random}}
{\footnotesize\ttfamily std\+::unique\+\_\+ptr$<$TRandom3$>$ Fitter\+Base\+::random\hspace{0.3cm}{\ttfamily [protected]}}



Random number. 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00118}{118}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.

\mbox{\Hypertarget{classFitterBase_a6f435e161c96eea778aba844115428d4}\label{classFitterBase_a6f435e161c96eea778aba844115428d4}} 
\index{FitterBase@{FitterBase}!sample\_llh@{sample\_llh}}
\index{sample\_llh@{sample\_llh}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{sample\_llh}{sample\_llh}}
{\footnotesize\ttfamily std\+::vector$<$double$>$ Fitter\+Base\+::sample\+\_\+llh\hspace{0.3cm}{\ttfamily [protected]}}



store the llh breakdowns 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00098}{98}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.

\mbox{\Hypertarget{classFitterBase_afac0dcceb1df194159c07945e8dc0069}\label{classFitterBase_afac0dcceb1df194159c07945e8dc0069}} 
\index{FitterBase@{FitterBase}!samples@{samples}}
\index{samples@{samples}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{samples}{samples}}
{\footnotesize\ttfamily std\+::vector$<$\mbox{\hyperlink{classsamplePDFBase}{sample\+PDFBase}}$\ast$$>$ Fitter\+Base\+::samples\hspace{0.3cm}{\ttfamily [protected]}}



Sample holder. 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00103}{103}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.

\mbox{\Hypertarget{classFitterBase_aedd882d8e4d0da0f89cf94e3a008affe}\label{classFitterBase_aedd882d8e4d0da0f89cf94e3a008affe}} 
\index{FitterBase@{FitterBase}!save\_nominal@{save\_nominal}}
\index{save\_nominal@{save\_nominal}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{save\_nominal}{save\_nominal}}
{\footnotesize\ttfamily bool Fitter\+Base\+::save\+\_\+nominal\hspace{0.3cm}{\ttfamily [protected]}}



save nominal matrix info or not 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00132}{132}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.

\mbox{\Hypertarget{classFitterBase_a490b8614c4089c6db10ff357e7aaab67}\label{classFitterBase_a490b8614c4089c6db10ff357e7aaab67}} 
\index{FitterBase@{FitterBase}!SaveProposal@{SaveProposal}}
\index{SaveProposal@{SaveProposal}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{SaveProposal}{SaveProposal}}
{\footnotesize\ttfamily bool Fitter\+Base\+::\+Save\+Proposal\hspace{0.3cm}{\ttfamily [protected]}}



Save proposal at each step. 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00134}{134}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.

\mbox{\Hypertarget{classFitterBase_a588678c71d816f48ba3c140543dbe916}\label{classFitterBase_a588678c71d816f48ba3c140543dbe916}} 
\index{FitterBase@{FitterBase}!SettingsSaved@{SettingsSaved}}
\index{SettingsSaved@{SettingsSaved}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{SettingsSaved}{SettingsSaved}}
{\footnotesize\ttfamily bool Fitter\+Base\+::\+Settings\+Saved\hspace{0.3cm}{\ttfamily [protected]}}



Checks if setting saved not repeat some operations. 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00139}{139}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.

\mbox{\Hypertarget{classFitterBase_a50df1bd75b20a953f81ab9c2bab6b42c}\label{classFitterBase_a50df1bd75b20a953f81ab9c2bab6b42c}} 
\index{FitterBase@{FitterBase}!step@{step}}
\index{step@{step}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{step}{step}}
{\footnotesize\ttfamily unsigned int Fitter\+Base\+::step\hspace{0.3cm}{\ttfamily [protected]}}



current state 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00087}{87}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.

\mbox{\Hypertarget{classFitterBase_a9fe01b2b6f7f0d6a7b04675a099e1a4f}\label{classFitterBase_a9fe01b2b6f7f0d6a7b04675a099e1a4f}} 
\index{FitterBase@{FitterBase}!stepClock@{stepClock}}
\index{stepClock@{stepClock}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{stepClock}{stepClock}}
{\footnotesize\ttfamily std\+::unique\+\_\+ptr$<$TStopwatch$>$ Fitter\+Base\+::step\+Clock\hspace{0.3cm}{\ttfamily [protected]}}



tells how long single step/fit iteration took 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00113}{113}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.

\mbox{\Hypertarget{classFitterBase_a8354e9a7a9cc534277ff76ab37c9a763}\label{classFitterBase_a8354e9a7a9cc534277ff76ab37c9a763}} 
\index{FitterBase@{FitterBase}!stepTime@{stepTime}}
\index{stepTime@{stepTime}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{stepTime}{stepTime}}
{\footnotesize\ttfamily double Fitter\+Base\+::step\+Time\hspace{0.3cm}{\ttfamily [protected]}}



Time of single step. 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00115}{115}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.

\mbox{\Hypertarget{classFitterBase_ace2eeca9829f63200c3f956c600d09ff}\label{classFitterBase_ace2eeca9829f63200c3f956c600d09ff}} 
\index{FitterBase@{FitterBase}!syst\_llh@{syst\_llh}}
\index{syst\_llh@{syst\_llh}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{syst\_llh}{syst\_llh}}
{\footnotesize\ttfamily std\+::vector$<$double$>$ Fitter\+Base\+::syst\+\_\+llh\hspace{0.3cm}{\ttfamily [protected]}}



systematic llh breakdowns 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00100}{100}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.

\mbox{\Hypertarget{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}\label{classFitterBase_a3a15d2348b7bf0a639aaab52b9294bbf}} 
\index{FitterBase@{FitterBase}!systematics@{systematics}}
\index{systematics@{systematics}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{systematics}{systematics}}
{\footnotesize\ttfamily std\+::vector$<$\mbox{\hyperlink{classcovarianceBase}{covariance\+Base}}$\ast$$>$ Fitter\+Base\+::systematics\hspace{0.3cm}{\ttfamily [protected]}}



Systematic holder. 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00108}{108}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.

\mbox{\Hypertarget{classFitterBase_abe9814558b8ff1bccdde3b4c894467e6}\label{classFitterBase_abe9814558b8ff1bccdde3b4c894467e6}} 
\index{FitterBase@{FitterBase}!TotalNSamples@{TotalNSamples}}
\index{TotalNSamples@{TotalNSamples}!FitterBase@{FitterBase}}
\doxysubsubsection{\texorpdfstring{TotalNSamples}{TotalNSamples}}
{\footnotesize\ttfamily unsigned int Fitter\+Base\+::\+Total\+NSamples\hspace{0.3cm}{\ttfamily [protected]}}



Total number of samples used. 



Definition at line \mbox{\hyperlink{FitterBase_8h_source_l00105}{105}} of file \mbox{\hyperlink{FitterBase_8h_source}{Fitter\+Base.\+h}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/runner/work/\+Ma\+Ch3/\+Ma\+Ch3/mcmc/\mbox{\hyperlink{FitterBase_8h}{Fitter\+Base.\+h}}\item 
/home/runner/work/\+Ma\+Ch3/\+Ma\+Ch3/mcmc/\mbox{\hyperlink{FitterBase_8cpp}{Fitter\+Base.\+cpp}}\end{DoxyCompactItemize}
