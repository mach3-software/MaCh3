\hypertarget{classcovarianceBase}{}\doxysection{covariance\+Base Class Reference}
\label{classcovarianceBase}\index{covarianceBase@{covarianceBase}}


Base class responsible for handling of systematic error parameters. Capable of using PCA or using adaptive throw matrix.  




{\ttfamily \#include $<$/home/runner/work/\+Ma\+Ch3/\+Ma\+Ch3/covariance/covariance\+Base.\+h$>$}



Inheritance diagram for covariance\+Base\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=279pt]{classcovarianceBase__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for covariance\+Base\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classcovarianceBase__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classcovarianceBase_a332cbcc2c262ff3775b56c40724e623e}{covariance\+Base}} (const std\+::vector$<$ std\+::string $>$ \&YAMLFile, std\+::string name, double threshold=-\/1, int \mbox{\hyperlink{classcovarianceBase_abba75182305d556818c76974a054a17d}{First\+PCAdpar}}=-\/999, int \mbox{\hyperlink{classcovarianceBase_a5ebdc744b733656972a15f1657915a3f}{Last\+PCAdpar}}=-\/999)
\begin{DoxyCompactList}\small\item\em ETA -\/ constructor for a YAML file. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classcovarianceBase_a8ff9c473f7e2ed9289459073a9d3dbe1}{covariance\+Base}} (std\+::string name, std\+::string file)
\begin{DoxyCompactList}\small\item\em \char`\"{}\+Usual\char`\"{} constructors from root file \end{DoxyCompactList}\item 
virtual \mbox{\hyperlink{classcovarianceBase_a1e7a87a1d7e054475b4b921407e0a2d1}{$\sim$covariance\+Base}} ()
\begin{DoxyCompactList}\small\item\em Destructor. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a5f28f7294d25cca6334f7033a63596b9}{set\+Cov\+Matrix}} (TMatrix\+DSym $\ast$cov)
\begin{DoxyCompactList}\small\item\em Set covariance matrix. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a9f980a259c5952f9ca907832f99ad2a7}{set\+Name}} (std\+::string name)
\begin{DoxyCompactList}\small\item\em Set matrix name. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a086ff04fa55c074a2baa6cc63e4f279a}{set\+Par\+Name}} (int i, std\+::string name)
\begin{DoxyCompactList}\small\item\em change parameter name \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a978483dabf04239f1c475516b5cdab7f}{set\+Single\+Parameter}} (const int par\+No, const double par\+Val)
\item 
void \mbox{\hyperlink{classcovarianceBase_aae3b226cbd6a4c03f291620ebd018bc9}{set\+Par}} (const int i, const double val)
\begin{DoxyCompactList}\small\item\em Set all the covariance matrix parameters to a user-\/defined value. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a6701f97eb624cef70998773333f96757}{set\+Par\+Curr\+Prop}} (const int i, const double val)
\begin{DoxyCompactList}\small\item\em Set current parameter value. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a9f78e4f0ae493e78accc8374cdf38b6f}{set\+Par\+Prop}} (const int i, const double val)
\begin{DoxyCompactList}\small\item\em Set proposed parameter value. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_aa4d9eaf56199245332f0b0be2c353944}{set\+Parameters}} (const std\+::vector$<$ double $>$ \&pars=\{\})
\begin{DoxyCompactList}\small\item\em Set parameter values using vector, it has to have same size as covariance class. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a1e9b4a09866909595a26fb2e1ea94cac}{set\+Flat\+Prior}} (const int i, const bool eL)
\begin{DoxyCompactList}\small\item\em Set if parameter should have flat prior or not. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_aae80acab113ac496a9bc56e28f6ae0c9}{Set\+Branches}} (TTree \&tree, bool Save\+Proposal=false)
\begin{DoxyCompactList}\small\item\em set branches for output file \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a806cf53a69a35da2426169561f450b85}{set\+Step\+Scale}} (const double scale)
\begin{DoxyCompactList}\small\item\em Set global step scale for covariance object. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a21b912b31c888a2bdae9145a0c10a614}{set\+Indiv\+Step\+Scale}} (const int Parameter\+Index, const double Step\+Scale)
\begin{DoxyCompactList}\small\item\em DB Function to set f\+Indiv\+Step\+Scale from a vector (Can be used from execs and inside covariance constructors) \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a57fcbce7dbdc47e3b6ff9344c215ed9a}{set\+Indiv\+Step\+Scale}} (const std\+::vector$<$ double $>$ \&stepscale)
\begin{DoxyCompactList}\small\item\em DB Function to set f\+Indiv\+Step\+Scale from a vector (Can be used from execs and inside covariance constructors) \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a340fbee1b5d97897431f2b0222f85337}{set\+Print\+Length}} (const unsigned int Pri\+Len)
\begin{DoxyCompactList}\small\item\em KS\+: In case someone really want to change this. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_ab36f40d40f4747718c98d368c04f41b7}{Save\+Updated\+Matrix\+Config}} ()
\begin{DoxyCompactList}\small\item\em KS\+: After step scale, prefit etc. value were modified save this modified config. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_af4d127ff4761379dd11843523835c4dc}{throw\+Par\+Prop}} (const double mag=1.)
\begin{DoxyCompactList}\small\item\em Throw the proposed parameter by mag sigma. Should really just have the user specify this throw by having argument double. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a4e92a9db846d956473efbe5712c71d31}{throw\+Par\+Curr}} (const double mag=1.)
\begin{DoxyCompactList}\small\item\em Helper function to throw the current parameter by mag sigma. Can study bias in MCMC with this; put different starting parameters. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_aa5d82895bcbae7773b6813c02cf2f485}{throw\+Parameters}} ()
\begin{DoxyCompactList}\small\item\em Throw the parameters according to the covariance matrix. This shouldn\textquotesingle{}t be used in MCMC code ase it can break Detailed Balance;. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a867bff214af25bba68f921eaea8b5cdd}{Random\+Configuration}} ()
\begin{DoxyCompactList}\small\item\em Randomly throw the parameters in their 1 sigma range. \end{DoxyCompactList}\item 
virtual int \mbox{\hyperlink{classcovarianceBase_ac3c3e322dc06ce6a44a887ae13e522ae}{Check\+Bounds}} ()
\begin{DoxyCompactList}\small\item\em Check if parameters were proposed outside physical boundary. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classcovarianceBase_a0056f747843633b2f8408f599f13f89f}{Calc\+Likelihood}} ()
\begin{DoxyCompactList}\small\item\em Calc penalty term based on inverted covariance matrix. \end{DoxyCompactList}\item 
virtual double \mbox{\hyperlink{classcovarianceBase_a9ee2fbfe0f1ac86c8c129095638e0f76}{Get\+Likelihood}} ()
\begin{DoxyCompactList}\small\item\em Return Calc\+Likelihood if some params were thrown out of boundary return {\itshape LARGE\+\_\+\+LOGL} \end{DoxyCompactList}\item 
TMatrix\+DSym $\ast$ \mbox{\hyperlink{classcovarianceBase_a5968a05b1139d72344ea08b8cd6c76c6}{get\+Cov\+Matrix}} ()
\begin{DoxyCompactList}\small\item\em Return covariance matrix. \end{DoxyCompactList}\item 
TMatrix\+DSym $\ast$ \mbox{\hyperlink{classcovarianceBase_a12221dba3e93480881d1195482ef6d87}{get\+Inv\+Cov\+Matrix}} ()
\begin{DoxyCompactList}\small\item\em Return inverted covariance matrix. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classcovarianceBase_a0278e73361d955ab1e39984552acb3b7}{get\+Flat\+Prior}} (const int i)
\begin{DoxyCompactList}\small\item\em Get if param has flat prior or not. \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}{get\+Name}} ()
\begin{DoxyCompactList}\small\item\em Get name of covariance. \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{classcovarianceBase_a033c5b6a8669537acaa6c5fc252899e6}{Get\+Par\+Name}} (const int i)
\begin{DoxyCompactList}\small\item\em Get name of covariance. \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{classcovarianceBase_a6a46b5fed3e7feb6e9e151e90927bdbc}{Get\+Par\+Fancy\+Name}} (const int i)
\begin{DoxyCompactList}\small\item\em Get fancy name of the Parameter. \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{classcovarianceBase_aa52b2765d3e7ae504af20861bedafa4e}{get\+Input\+File}} () const
\begin{DoxyCompactList}\small\item\em Get name of input file. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classcovarianceBase_a01e3ab6a6758fc58b8c695556a39d879}{get\+Diagonal\+Error}} (const int i)
\begin{DoxyCompactList}\small\item\em Get diagonal error for ith parameter. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classcovarianceBase_a82539ec974ced3c3f912be4731bb191d}{Get\+Error}} (const int i)
\begin{DoxyCompactList}\small\item\em Get the error for the ith parameter. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a0993a1ea6c5b06ba834e9e70af87ee9e}{reset\+Indiv\+Step\+Scale}} ()
\begin{DoxyCompactList}\small\item\em Adaptive Step Tuning Stuff. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a715900cc67fcc598090399ee931938e9}{initialise\+Adaption}} (const YAML\+::\+Node \&adapt\+\_\+manager)
\begin{DoxyCompactList}\small\item\em Initialise adaptive MCMC. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_ae4c26e3f2a727a39e9db7ed88e72ac38}{save\+Adaptive\+To\+File}} (const TString \&out\+File\+Name, const TString \&systematic\+Name)
\begin{DoxyCompactList}\small\item\em Save adaptive throw matrix to file. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classcovarianceBase_a11075f684f5d2d7eff9c222867e33bb7}{get\+Do\+Adaption}} ()
\begin{DoxyCompactList}\small\item\em Do we adapt or not. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_af30ca7861452e1446e55700f4b49b608}{set\+Throw\+Matrix}} (TMatrix\+DSym $\ast$cov)
\begin{DoxyCompactList}\small\item\em Use new throw matrix, used in adaptive MCMC. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a7e2d3623bbbf3edee558e04737fe2add}{update\+Throw\+Matrix}} (TMatrix\+DSym $\ast$cov)
\item 
void \mbox{\hyperlink{classcovarianceBase_a1e5aec8c073799ac9d40e65c0996b2c1}{set\+Number\+Of\+Steps}} (const int nsteps)
\begin{DoxyCompactList}\small\item\em Set number of MCMC step, when running adaptive MCMC it is updated with given frequency. We need number of steps to determine frequency. \end{DoxyCompactList}\item 
TMatrix\+DSym $\ast$ \mbox{\hyperlink{classcovarianceBase_aa306bea2b30013ca55f2a95b8d16ec42}{get\+Throw\+Matrix}} ()
\begin{DoxyCompactList}\small\item\em Get matrix used for step proposal. \end{DoxyCompactList}\item 
TMatrixD $\ast$ \mbox{\hyperlink{classcovarianceBase_a563a904298d0bd5ec5518708396e0e22}{get\+Throw\+Matrix\+\_\+\+Chol\+Decomp}} ()
\begin{DoxyCompactList}\small\item\em Get the Cholesky decomposition of the throw matrix. \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \mbox{\hyperlink{classcovarianceBase_ab89b754afc93b63f41070710af4c0f2d}{get\+Parameter\+Means}} ()
\begin{DoxyCompactList}\small\item\em Get the parameter means used in the adaptive handler. \end{DoxyCompactList}\item 
TH2D $\ast$ \mbox{\hyperlink{classcovarianceBase_ac14fabdb87f5101cdbfcecb8e6b6b811}{Get\+Correlation\+Matrix}} ()
\begin{DoxyCompactList}\small\item\em KS\+: Convert covariance matrix to correlation matrix and return TH2D which can be used for fancy plotting. \end{DoxyCompactList}\item 
const double $\ast$ \mbox{\hyperlink{classcovarianceBase_aa970d7a68497a3765723bf34629f79f7}{ret\+Pointer}} (const int i\+Param)
\begin{DoxyCompactList}\small\item\em DB Pointer return to param position. \end{DoxyCompactList}\item 
const std\+::vector$<$ double $>$ \& \mbox{\hyperlink{classcovarianceBase_a43c569248e176e14330cd002bfc2bff6}{get\+Par\+Prop\+Vec}} ()
\begin{DoxyCompactList}\small\item\em Get a reference to the proposed parameter values Can be useful if you want to track these without having to copy values using \mbox{\hyperlink{classcovarianceBase_a63db139faf1e42d7a1c3c3c661c0b7d9}{get\+Proposed()}} \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classcovarianceBase_a3daac6405cc791347b768a5afe8a13d2}{Get\+Num\+Params}} ()
\begin{DoxyCompactList}\small\item\em Get total number of parameters. \end{DoxyCompactList}\item 
virtual std\+::vector$<$ double $>$ \mbox{\hyperlink{classcovarianceBase_ae0a231f87266048a3cd2e0032eaf0f30}{get\+Nominal\+Array}} ()
\begin{DoxyCompactList}\small\item\em Get the nominal array for parameters. \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \mbox{\hyperlink{classcovarianceBase_ab34500d7b559db68c46a2838667c3e03}{get\+Pre\+Fit\+Values}} ()
\begin{DoxyCompactList}\small\item\em Get the pre-\/fit values of the parameters. \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \mbox{\hyperlink{classcovarianceBase_a7316a31398c07816a5529d7a9494a1c5}{get\+Generated\+Values}} ()
\begin{DoxyCompactList}\small\item\em Get the generated values of the parameters. \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \mbox{\hyperlink{classcovarianceBase_a63db139faf1e42d7a1c3c3c661c0b7d9}{get\+Proposed}} () const
\begin{DoxyCompactList}\small\item\em Get vector of all proposed parameter values. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classcovarianceBase_a37c87fa18db7e4ac087d120bca955617}{get\+Par\+Prop}} (const int i)
\begin{DoxyCompactList}\small\item\em Get proposed parameter value. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classcovarianceBase_a040e445c6d4f8d4eea8fc13418cea7ff}{get\+Par\+Curr}} (const int i)
\begin{DoxyCompactList}\small\item\em Get current parameter value. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classcovarianceBase_a1cede85accaac2ea7056740893d90c49}{get\+Par\+Init}} (const int i)
\begin{DoxyCompactList}\small\item\em Get prior parameter value. \end{DoxyCompactList}\item 
virtual double \mbox{\hyperlink{classcovarianceBase_a5bf31f7d7a5e24c49d4157d411080dbf}{get\+Nominal}} (const int i)
\begin{DoxyCompactList}\small\item\em Return generated value, although is virtual so class inheriting might actual get nominal not generated. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classcovarianceBase_a3d8d40e4f44cd0c89a1a2d4b4711f332}{Get\+Generated}} (const int i)
\begin{DoxyCompactList}\small\item\em Return generated value for a given parameter. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classcovarianceBase_a0c6510aa48248382ba2da0330015b8c6}{Get\+Upper\+Bound}} (const int i)
\begin{DoxyCompactList}\small\item\em Get upper parameter bound in which it is physically valid. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classcovarianceBase_a634e89392da441ff88cad3a3ba619ccc}{Get\+Lower\+Bound}} (const int i)
\begin{DoxyCompactList}\small\item\em Get lower parameter bound in which it is physically valid. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classcovarianceBase_ad5b8a91b33381652bae35f1903e16136}{Get\+Indiv\+Step\+Scale}} (const int Parameter\+Index)
\begin{DoxyCompactList}\small\item\em Get individual step scale for selected parameter. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classcovarianceBase_a3e29910a1706f60db5f615b3b6f05994}{get\+Par\+Prop\+\_\+\+PCA}} (const int i)
\begin{DoxyCompactList}\small\item\em Get current parameter value using PCA. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classcovarianceBase_af4c0edbf1bd150484bc4696480ef9a77}{get\+Par\+Curr\+\_\+\+PCA}} (const int i)
\begin{DoxyCompactList}\small\item\em Get current parameter value using PCA. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classcovarianceBase_ab7cb212b7fda7f402629855b58a69cec}{is\+Parameter\+Fixed\+PCA}} (const int i)
\begin{DoxyCompactList}\small\item\em Is parameter fixed in PCA base or not. \end{DoxyCompactList}\item 
const TMatrixD \mbox{\hyperlink{classcovarianceBase_acdcf459e3ef443e93c66d83cde87e238}{get\+Transfer\+Matrix}} ()
\begin{DoxyCompactList}\small\item\em Get transfer matrix allowing to go from PCA base to normal base. \end{DoxyCompactList}\item 
const TMatrixD \mbox{\hyperlink{classcovarianceBase_ad1b0e5f25843ee77ec1c6094856cda27}{get\+Eigen\+Vectors}} ()
\begin{DoxyCompactList}\small\item\em Get eigen vectors of covariance matrix, only works with PCA. \end{DoxyCompactList}\item 
const TVectorD \mbox{\hyperlink{classcovarianceBase_add3d24e738cde5a2f5ab1b2b377a2afb}{get\+Eigen\+Values}} ()
\begin{DoxyCompactList}\small\item\em Get eigen values for all parameters, if you want for decomposed only parameters use get\+Eigen\+Values\+Master. \end{DoxyCompactList}\item 
const std\+::vector$<$ double $>$ \mbox{\hyperlink{classcovarianceBase_a104f2d2f1b7f60693bba489ac4e753cc}{get\+Eigen\+Values\+Master}} ()
\begin{DoxyCompactList}\small\item\em Get eigen value of only decomposed parameters, if you want for all parameters use get\+Eigen\+Values. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a7c9b2ae1b4144448385b47a576e4d07d}{set\+Par\+Prop\+\_\+\+PCA}} (const int i, const double value)
\begin{DoxyCompactList}\small\item\em Set proposed value for parameter in PCA base. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a593457c3ae0a2d1892846b484833274f}{set\+Par\+Curr\+\_\+\+PCA}} (const int i, const double value)
\begin{DoxyCompactList}\small\item\em Set current value for parameter in PCA base. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a5888af0b4b6e1d7826fca0f6777bf3ae}{set\+Parameters\+\_\+\+PCA}} (const std\+::vector$<$ double $>$ \&pars)
\begin{DoxyCompactList}\small\item\em Set values for PCA parameters in PCA base. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classcovarianceBase_a261941a4c06e5d875174d8769a4d02f1}{get\+Npars}} ()
\begin{DoxyCompactList}\small\item\em Get number of params which will be different depending if using Eigen decomposition or not. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_aebd37baf2d6551863d810bea83c73020}{print\+Nominal}} ()
\begin{DoxyCompactList}\small\item\em Print nominal value for every parameter. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a732268706d083b6ae4495e34e703bbda}{print\+Nominal\+Curr\+Prop}} ()
\begin{DoxyCompactList}\small\item\em Print nominal, current and proposed value for each parameter. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_ac1ff984cbc1b7858af9dd237cc1648d3}{print\+Pars}} ()
\item 
void \mbox{\hyperlink{classcovarianceBase_ad3c0dddbedcf57f06a14ec52800a087b}{print\+Indiv\+Step\+Scale}} ()
\begin{DoxyCompactList}\small\item\em Print step scale for each parameter. \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{classcovarianceBase_a95c7ca23995af579cfa7f199833fe24a}{propose\+Step}} ()
\begin{DoxyCompactList}\small\item\em Generate a new proposed state. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_aa2344b1482362eed11d817acdb6befe4}{accept\+Step}} ()
\begin{DoxyCompactList}\small\item\em Accepted this step. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_adb2d1a39cd2bd160257bc9e34e32df4c}{toggle\+Fix\+All\+Parameters}} ()
\begin{DoxyCompactList}\small\item\em fix parameters at prior values \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_aafbbdc05b87df882dc341e20fe870603}{toggle\+Fix\+Parameter}} (const int i)
\begin{DoxyCompactList}\small\item\em fix parameter at prior values \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a41cc8dd2185af7cee380f3c6d463e5a4}{toggle\+Fix\+Parameter}} (const std\+::string \&name)
\begin{DoxyCompactList}\small\item\em Fix parameter at prior values. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classcovarianceBase_a2424eaebd9daa92b0294b352310770a3}{is\+Parameter\+Fixed}} (const int i)
\begin{DoxyCompactList}\small\item\em Is parameter fixed or not. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classcovarianceBase_a1a0ed90bcbc2f932c7a32d26090edbbb}{is\+Parameter\+Fixed}} (const std\+::string \&name)
\begin{DoxyCompactList}\small\item\em Is parameter fixed or not. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a8ac3a458097817eca534c23554a7635b}{Construct\+PCA}} ()
\begin{DoxyCompactList}\small\item\em CW\+: Calculate eigen values, prepare transition matrices and remove param based on defined threshold. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classcovarianceBase_a30f3f34243be0f6bc901e525497e7f56}{Is\+PCA}} ()
\begin{DoxyCompactList}\small\item\em is PCA, can use to query e.\+g. LLH scans \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a64aaa71f81750ba27977c0405c51cd88}{Matrix\+Vector\+Multi}} (double $\ast$\mbox{\hyperlink{Structs_8h_ab6a7e23420f0bcfb04f42f45f8283101}{\+\_\+restrict\+\_\+}} Vec\+Multi, double $\ast$$\ast$\mbox{\hyperlink{Structs_8h_ab6a7e23420f0bcfb04f42f45f8283101}{\+\_\+restrict\+\_\+}} matrix, const double $\ast$\mbox{\hyperlink{Structs_8h_ab6a7e23420f0bcfb04f42f45f8283101}{\+\_\+restrict\+\_\+}} vector, const int n)
\begin{DoxyCompactList}\small\item\em KS\+: Custom function to perform multiplication of matrix and vector with multithreading. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classcovarianceBase_a767242ffde1e52dff143889e5534b4e3}{Matrix\+Vector\+Multi\+Single}} (double $\ast$$\ast$\mbox{\hyperlink{Structs_8h_ab6a7e23420f0bcfb04f42f45f8283101}{\+\_\+restrict\+\_\+}} matrix, const double $\ast$\mbox{\hyperlink{Structs_8h_ab6a7e23420f0bcfb04f42f45f8283101}{\+\_\+restrict\+\_\+}} vector, const int Length, const int i)
\begin{DoxyCompactList}\small\item\em KS\+: Custom function to perform multiplication of matrix and single element which is thread safe. \end{DoxyCompactList}\item 
YAML\+::\+Node \mbox{\hyperlink{classcovarianceBase_a61936f5c39ad7902624222fc49ad1362}{Get\+Config}} () const
\begin{DoxyCompactList}\small\item\em Getter to return a copy of the YAML node. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classcovarianceBase_a2960c489f6aafdb5a2291e1a48b14e9a}{init}} (std\+::string name, std\+::string file)
\begin{DoxyCompactList}\small\item\em Initialisation of the class using matrix from root file. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_acec1e1c7fd83d21e1ad55a03acfeb8c4}{init}} (const std\+::vector$<$ std\+::string $>$ \&YAMLFile)
\begin{DoxyCompactList}\small\item\em Initialisation of the class using config. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_ab5141e2014519c1483788f4995686164}{init}} (TMatrix\+DSym $\ast$cov\+Mat)
\begin{DoxyCompactList}\small\item\em Initialisation of the class using only TMatrix. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a75b5553823335bb82026ff46369fb67e}{Reserve\+Memory}} (const int \mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}})
\begin{DoxyCompactList}\small\item\em Initialise vectors with parameters information. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a3432b7a9acc1243b8bdb17ec0b40d195}{randomize}} ()
\begin{DoxyCompactList}\small\item\em \char`\"{}\+Randomize\char`\"{} the parameters in the covariance class for the proposed step. Used the proposal kernel and the current parameter value to set proposed step \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_aba2b2dae2546299c9a4dab618d65e7c0}{Correlate\+Steps}} ()
\begin{DoxyCompactList}\small\item\em Use Cholesky throw matrix for better step proposal. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_ae2850c8e2f2d4acfe322b0ebe65b07cf}{Make\+Pos\+Def}} (TMatrix\+DSym $\ast$cov=nullptr)
\begin{DoxyCompactList}\small\item\em Make matrix positive definite by adding small values to diagonal, necessary for inverting matrix. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a8a709e1c6c58618cf65400eef1741cc7}{make\+Closest\+Pos\+Def}} (TMatrix\+DSym $\ast$cov)
\begin{DoxyCompactList}\small\item\em HW\+: Finds closest possible positive definite matrix in Frobenius Norm $\vert$$\vert$.$\vert$$\vert$\+\_\+frob Where $\vert$$\vert$\+X$\vert$$\vert$\+\_\+frob=sqrt\mbox{[}sum\+\_\+ij(x\+\_\+ij$^\wedge$2)\mbox{]} (basically just turns an n,n matrix into vector in n$^\wedge$2 space then does Euclidean norm) \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a651f5ecd8973918d5683606a607fa88c}{Transfer\+To\+PCA}} ()
\begin{DoxyCompactList}\small\item\em Transfer param values from normal base to PCA base. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a65ac4956a782b01768f445732522a450}{Transfer\+To\+Param}} ()
\begin{DoxyCompactList}\small\item\em Transfer param values from PCA base to normal base. \end{DoxyCompactList}\item 
const double $\ast$ \mbox{\hyperlink{classcovarianceBase_a3e2c11c7c0a3557068369b30e7aac17f}{Return\+Unity}} ()
\begin{DoxyCompactList}\small\item\em Handy function to return 1 for any systs. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a5ab3d89b7fe6103ae6f750c984bcefc8}{set\+Throw\+Matrix\+From\+File}} (const std\+::string \&matrix\+\_\+file\+\_\+name, const std\+::string \&matrix\+\_\+name, const std\+::string \&means\+\_\+name)
\begin{DoxyCompactList}\small\item\em sets throw matrix from a file \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcovarianceBase_a50ce8ebb96ebd64190dc37e4bf950a9b}{update\+Adaptive\+Covariance}} ()
\begin{DoxyCompactList}\small\item\em Method to update adaptive MCMC. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
const std\+::string \mbox{\hyperlink{classcovarianceBase_a5451d4189a9fb7591c8ce728852ba82e}{input\+File}}
\begin{DoxyCompactList}\small\item\em The input root file we read in. \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{classcovarianceBase_a26618d3f5633b33ce20e38ce8261b3ee}{matrix\+Name}}
\begin{DoxyCompactList}\small\item\em Name of cov matrix. \end{DoxyCompactList}\item 
TMatrix\+DSym $\ast$ \mbox{\hyperlink{classcovarianceBase_a6c3fe8db34c06299fd1633951ac00937}{cov\+Matrix}}
\begin{DoxyCompactList}\small\item\em The covariance matrix. \end{DoxyCompactList}\item 
TMatrix\+DSym $\ast$ \mbox{\hyperlink{classcovarianceBase_a35c7dc7817eaf4058e9775b6bc792ebc}{inv\+Cov\+Matrix}}
\begin{DoxyCompactList}\small\item\em The inverse covariance matrix. \end{DoxyCompactList}\item 
double $\ast$$\ast$ \mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{Invert\+Cov\+Matrix}}
\begin{DoxyCompactList}\small\item\em KS\+: Same as above but much faster as TMatrix\+DSym cache miss. \end{DoxyCompactList}\item 
TRandom3 $\ast$$\ast$ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\+\_\+number}}
\begin{DoxyCompactList}\small\item\em KS\+: Set Random numbers for each thread so each thread has different seed. \end{DoxyCompactList}\item 
double $\ast$ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{rand\+Params}}
\begin{DoxyCompactList}\small\item\em Random number taken from gaussian around prior error used for corr\+\_\+throw. \end{DoxyCompactList}\item 
double $\ast$ \mbox{\hyperlink{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}{corr\+\_\+throw}}
\begin{DoxyCompactList}\small\item\em Result of multiplication of Cholesky matrix and rand\+Params. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classcovarianceBase_a0088413d6a15d12cd34ec06166302f5c}{\+\_\+f\+Global\+Step\+Scale}}
\begin{DoxyCompactList}\small\item\em Global step scale applied ot all params in this class. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classcovarianceBase_a8d821ce805f2426fe95549170866821f}{Print\+Length}}
\begin{DoxyCompactList}\small\item\em KS\+: This is used when printing parameters, sometimes we have super long parameters name, we want to flexibly adjust couts. \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::string $>$ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\+\_\+f\+Names}}
\begin{DoxyCompactList}\small\item\em ETA \+\_\+f\+Names is set automatically in the covariance class to be something like xsec\+\_\+i, this is currently to make things compatible with the Diagnostic tools. \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::string $>$ \mbox{\hyperlink{classcovarianceBase_a973671386a2f8ea924f25f8f5404654c}{\+\_\+f\+Fancy\+Names}}
\begin{DoxyCompactList}\small\item\em Fancy name for example rather than xsec\+\_\+0 it is MAQE, useful for human reading. \end{DoxyCompactList}\item 
YAML\+::\+Node \mbox{\hyperlink{classcovarianceBase_a933ff3dc0af99629ba3582a5d9d89d23}{\+\_\+f\+YAMLDoc}}
\begin{DoxyCompactList}\small\item\em Stores config describing systematics. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\+\_\+f\+Num\+Par}}
\begin{DoxyCompactList}\small\item\em Number of systematic parameters. \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\+\_\+f\+Pre\+Fit\+Value}}
\begin{DoxyCompactList}\small\item\em Parameter value dictated by the prior model. Based on it penalty term is calculated. \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\+\_\+f\+Curr\+Val}}
\begin{DoxyCompactList}\small\item\em Current value of the parameter. \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\+\_\+f\+Prop\+Val}}
\begin{DoxyCompactList}\small\item\em Proposed value of the parameter. \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \mbox{\hyperlink{classcovarianceBase_a9b753f52711600a9f8d648531d95b044}{\+\_\+f\+Generated}}
\begin{DoxyCompactList}\small\item\em Generated value of the parameter. \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\+\_\+f\+Error}}
\begin{DoxyCompactList}\small\item\em Prior error on the parameter. \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \mbox{\hyperlink{classcovarianceBase_a8f1d94838f188cc85c4f82557c0b0b66}{\+\_\+f\+Low\+Bound}}
\begin{DoxyCompactList}\small\item\em Lowest physical bound, parameter will not be able to go beyond it. \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \mbox{\hyperlink{classcovarianceBase_a31e636cb6de871bd0c2c8e7e299df9e7}{\+\_\+f\+Up\+Bound}}
\begin{DoxyCompactList}\small\item\em Upper physical bound, parameter will not be able to go beyond it. \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \mbox{\hyperlink{classcovarianceBase_a3cda39026e336a49cef482efd4062561}{\+\_\+f\+Indiv\+Step\+Scale}}
\begin{DoxyCompactList}\small\item\em Individual step scale used by MCMC algorithm. \end{DoxyCompactList}\item 
std\+::vector$<$ bool $>$ \mbox{\hyperlink{classcovarianceBase_ad9c47deb7009bff81210f666e80012eb}{\+\_\+f\+Flat\+Prior}}
\begin{DoxyCompactList}\small\item\em Whether to apply flat prior or not. \end{DoxyCompactList}\item 
const double \mbox{\hyperlink{classcovarianceBase_a7682c3de33ae5b23b23e070dc0a3f778}{Unity}} = 1.\+0
\begin{DoxyCompactList}\small\item\em Unity for null systs to point back to. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}}
\begin{DoxyCompactList}\small\item\em perform PCA or not \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classcovarianceBase_add54ab1ba46b723fa23d7c95dfad671a}{eigen\+\_\+threshold}}
\begin{DoxyCompactList}\small\item\em CW\+: Threshold based on which we remove parameters in eigen base. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\+\_\+f\+Num\+Par\+PCA}}
\begin{DoxyCompactList}\small\item\em Number of parameters in PCA base. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classcovarianceBase_abba75182305d556818c76974a054a17d}{First\+PCAdpar}}
\begin{DoxyCompactList}\small\item\em Index of the first param that is being decomposed. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classcovarianceBase_a5ebdc744b733656972a15f1657915a3f}{Last\+PCAdpar}}
\begin{DoxyCompactList}\small\item\em Index of the last param that is being decomposed. \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \mbox{\hyperlink{classcovarianceBase_ae6aada94037640a68e3f37898f276019}{\+\_\+f\+Pre\+Fit\+Value\+\_\+\+PCA}}
\begin{DoxyCompactList}\small\item\em Prefit value for PCA params. \end{DoxyCompactList}\item 
TVectorD \mbox{\hyperlink{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}{f\+Par\+Prop\+\_\+\+PCA}}
\begin{DoxyCompactList}\small\item\em CW\+: Current parameter value in PCA base. \end{DoxyCompactList}\item 
TVectorD \mbox{\hyperlink{classcovarianceBase_aa96f87ab90dc26fc1b5e157149b9dfd3}{f\+Par\+Curr\+\_\+\+PCA}}
\begin{DoxyCompactList}\small\item\em CW\+: Proposed parameter value in PCA base. \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \mbox{\hyperlink{classcovarianceBase_a7b83a17de68cc7838b93de242d91d9a0}{f\+Par\+Sigma\+\_\+\+PCA}}
\begin{DoxyCompactList}\small\item\em Tells if parameter is fixed in PCA base or not. \end{DoxyCompactList}\item 
std\+::vector$<$ int $>$ \mbox{\hyperlink{classcovarianceBase_ae9f3cb2a310874b86965903714ef2bd8}{is\+Decomposed\+\_\+\+PCA}}
\begin{DoxyCompactList}\small\item\em If param is decomposed this will return -\/1, if not this will return enumerator to param in normal base. This way we can map stuff like step scale etc between normal base and undecomposed param in eigen base. \end{DoxyCompactList}\item 
TMatrix\+DSym $\ast$ \mbox{\hyperlink{classcovarianceBase_a6cb3d0b4096fbb55b040f70cd5b6e32b}{throw\+Matrix}}
\begin{DoxyCompactList}\small\item\em Matrix which we use for step proposal before Cholesky decomposition (not actually used for step proposal) \end{DoxyCompactList}\item 
TMatrixD $\ast$ \mbox{\hyperlink{classcovarianceBase_ab95f5e066c2dfb1d20d120bc6c85dda2}{throw\+Matrix\+\_\+\+Chol\+Decomp}}
\begin{DoxyCompactList}\small\item\em Matrix which we use for step proposal after Cholesky decomposition. \end{DoxyCompactList}\item 
double $\ast$$\ast$ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throw\+Matrix\+Chol\+Decomp}}
\begin{DoxyCompactList}\small\item\em Throw matrix that is being used in the fit, much faster as TMatrix\+DSym cache miss. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classcovarianceBase_a838731abd6716940043b484b2b266f86}{use\+\_\+adaptive}}
\begin{DoxyCompactList}\small\item\em Are we using AMCMC? \end{DoxyCompactList}\item 
\mbox{\hyperlink{classPCAHandler}{PCAHandler}} \mbox{\hyperlink{classcovarianceBase_ad0022a3e9dd3b2661c9b02a02488759c}{PCAObj}}
\begin{DoxyCompactList}\small\item\em Struct containing information about PCA. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler}{adaptive\+\_\+mcmc\+::\+Adaptive\+MCMCHandler}} \mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{Adaptive\+Handler}}
\begin{DoxyCompactList}\small\item\em Struct containing information about adaption. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Base class responsible for handling of systematic error parameters. Capable of using PCA or using adaptive throw matrix. 

\begin{DoxySeeAlso}{See also}
For more details, visit the \href{https://github.com/mach3-software/MaCh3/wiki/02.-Implementation-of-Systematic}{\texttt{ Wiki}}. 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00017}{17}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classcovarianceBase_a332cbcc2c262ff3775b56c40724e623e}\label{classcovarianceBase_a332cbcc2c262ff3775b56c40724e623e}} 
\index{covarianceBase@{covarianceBase}!covarianceBase@{covarianceBase}}
\index{covarianceBase@{covarianceBase}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{covarianceBase()}{covarianceBase()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily covariance\+Base\+::covariance\+Base (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ std\+::string $>$ \&}]{YAMLFile,  }\item[{std\+::string}]{name,  }\item[{double}]{threshold = {\ttfamily -\/1},  }\item[{int}]{First\+PCAdpar = {\ttfamily -\/999},  }\item[{int}]{Last\+PCAdpar = {\ttfamily -\/999} }\end{DoxyParamCaption})}



ETA -\/ constructor for a YAML file. 


\begin{DoxyParams}{Parameters}
{\em YAMLFile} & A vector of strings representing the YAML files used for initialisation of matrix \\
\hline
{\em name} & Matrix name \\
\hline
{\em threshold} & PCA threshold from 0 to 1. Default is -\/1 and means no PCA \\
\hline
{\em First\+PCAdpar} & First PCA parameter that will be decomposed. \\
\hline
{\em Last\+PCAdpar} & First PCA parameter that will be decomposed. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00012}{12}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00012\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classcovarianceBase_a5451d4189a9fb7591c8ce728852ba82e}{inputFile}}(YAMLFile[0].c\_str()),\ \mbox{\hyperlink{classcovarianceBase_a26618d3f5633b33ce20e38ce8261b3ee}{matrixName}}(name),\ \mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}}(\textcolor{keyword}{true}),\ \mbox{\hyperlink{classcovarianceBase_add54ab1ba46b723fa23d7c95dfad671a}{eigen\_threshold}}(threshold),\ \mbox{\hyperlink{classcovarianceBase_abba75182305d556818c76974a054a17d}{FirstPCAdpar}}(FirstPCA),\ \mbox{\hyperlink{classcovarianceBase_a5ebdc744b733656972a15f1657915a3f}{LastPCAdpar}}(LastPCA)\ \{}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Constructing\ instance\ of\ covarianceBase\ using\ "{}});}
\DoxyCodeLine{00016\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ YAMLFile.size();\ i++)}
\DoxyCodeLine{00017\ \ \ \{}
\DoxyCodeLine{00018\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\{\}"{}},\ YAMLFile[i]);}
\DoxyCodeLine{00019\ \ \ \}}
\DoxyCodeLine{00020\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}as\ an\ input"{}});}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \ \ \textcolor{keywordflow}{if}\ (threshold\ <\ 0\ ||\ threshold\ >=\ 1)\ \{}
\DoxyCodeLine{00023\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Principal\ component\ analysis\ but\ given\ the\ threshold\ for\ the\ principal\ components\ to\ be\ less\ than\ 0,\ or\ greater\ than\ (or\ equal\ to)\ 1.\ This\ will\ not\ work"{}});}
\DoxyCodeLine{00024\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Please\ specify\ a\ number\ between\ 0\ and\ 1"{}});}
\DoxyCodeLine{00025\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}You\ specified:\ "{}});}
\DoxyCodeLine{00026\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Am\ instead\ calling\ the\ usual\ non-\/PCA\ constructor..."{}});}
\DoxyCodeLine{00027\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00028\ \ \ \}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \ \ \mbox{\hyperlink{classcovarianceBase_a2960c489f6aafdb5a2291e1a48b14e9a}{init}}(YAMLFile);}
\DoxyCodeLine{00031\ \ \ \textcolor{comment}{//\ Call\ the\ innocent\ helper\ function}}
\DoxyCodeLine{00032\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \mbox{\hyperlink{classcovarianceBase_a8ac3a458097817eca534c23554a7635b}{ConstructPCA}}();}
\DoxyCodeLine{00033\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a8ff9c473f7e2ed9289459073a9d3dbe1}\label{classcovarianceBase_a8ff9c473f7e2ed9289459073a9d3dbe1}} 
\index{covarianceBase@{covarianceBase}!covarianceBase@{covarianceBase}}
\index{covarianceBase@{covarianceBase}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{covarianceBase()}{covarianceBase()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily covariance\+Base\+::covariance\+Base (\begin{DoxyParamCaption}\item[{std\+::string}]{name,  }\item[{std\+::string}]{file }\end{DoxyParamCaption})}



\char`\"{}\+Usual\char`\"{} constructors from root file 


\begin{DoxyParams}{Parameters}
{\em name} & Matrix name \\
\hline
{\em file} & Path to matrix root file \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00004}{4}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00004\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classcovarianceBase_a5451d4189a9fb7591c8ce728852ba82e}{inputFile}}(file),\ \mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}}(\textcolor{keyword}{false})\ \{}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00006\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Constructing\ instance\ of\ covarianceBase"{}});}
\DoxyCodeLine{00007\ \ \ \mbox{\hyperlink{classcovarianceBase_a2960c489f6aafdb5a2291e1a48b14e9a}{init}}(name,\ file);}
\DoxyCodeLine{00008\ \ \ \mbox{\hyperlink{classcovarianceBase_abba75182305d556818c76974a054a17d}{FirstPCAdpar}}\ =\ -\/999;}
\DoxyCodeLine{00009\ \ \ \mbox{\hyperlink{classcovarianceBase_a5ebdc744b733656972a15f1657915a3f}{LastPCAdpar}}\ =\ -\/999;}
\DoxyCodeLine{00010\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a1e7a87a1d7e054475b4b921407e0a2d1}\label{classcovarianceBase_a1e7a87a1d7e054475b4b921407e0a2d1}} 
\index{covarianceBase@{covarianceBase}!````~covarianceBase@{$\sim$covarianceBase}}
\index{````~covarianceBase@{$\sim$covarianceBase}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{$\sim$covarianceBase()}{~covarianceBase()}}
{\footnotesize\ttfamily covariance\+Base\+::$\sim$covariance\+Base (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Destructor. 



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00037}{37}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00038\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00039\ \ \ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}.clear();}
\DoxyCodeLine{00040\ \ \ \mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}.clear();}
\DoxyCodeLine{00041\ \ \ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}.clear();}
\DoxyCodeLine{00042\ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}.clear();}
\DoxyCodeLine{00043\ \ \ \mbox{\hyperlink{classcovarianceBase_a8f1d94838f188cc85c4f82557c0b0b66}{\_fLowBound}}.clear();}
\DoxyCodeLine{00044\ \ \ \mbox{\hyperlink{classcovarianceBase_a31e636cb6de871bd0c2c8e7e299df9e7}{\_fUpBound}}.clear();}
\DoxyCodeLine{00045\ \ \ \mbox{\hyperlink{classcovarianceBase_a3cda39026e336a49cef482efd4062561}{\_fIndivStepScale}}.clear();}
\DoxyCodeLine{00046\ \ \ \mbox{\hyperlink{classcovarianceBase_ad9c47deb7009bff81210f666e80012eb}{\_fFlatPrior}}.clear();}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}};}
\DoxyCodeLine{00049\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}{corr\_throw}};}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a6c3fe8db34c06299fd1633951ac00937}{covMatrix}}\ !=\ \textcolor{keyword}{nullptr})\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classcovarianceBase_a6c3fe8db34c06299fd1633951ac00937}{covMatrix}};}
\DoxyCodeLine{00052\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a35c7dc7817eaf4058e9775b6bc792ebc}{invCovMatrix}}\ !=\ \textcolor{keyword}{nullptr})\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classcovarianceBase_a35c7dc7817eaf4058e9775b6bc792ebc}{invCovMatrix}};}
\DoxyCodeLine{00053\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ab95f5e066c2dfb1d20d120bc6c85dda2}{throwMatrix\_CholDecomp}}\ !=\ \textcolor{keyword}{nullptr})\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classcovarianceBase_ab95f5e066c2dfb1d20d120bc6c85dda2}{throwMatrix\_CholDecomp}};}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)}
\DoxyCodeLine{00056\ \ \ \{}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}}[i];}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}}[i];}
\DoxyCodeLine{00059\ \ \ \}}
\DoxyCodeLine{00060\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}};}
\DoxyCodeLine{00061\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}};}
\DoxyCodeLine{00062\ \ \ }
\DoxyCodeLine{00063\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nThreads\ =\ \mbox{\hyperlink{namespaceMaCh3Utils_a5aff908b9241c673e8d05403996e2229}{MaCh3Utils::GetNThreads}}();}
\DoxyCodeLine{00064\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ iThread\ =\ 0;iThread\ <\ nThreads;\ iThread++)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}[iThread];}
\DoxyCodeLine{00065\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}};}
\DoxyCodeLine{00066\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a6cb3d0b4096fbb55b040f70cd5b6e32b}{throwMatrix}}\ !=\ \textcolor{keyword}{nullptr})\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classcovarianceBase_a6cb3d0b4096fbb55b040f70cd5b6e32b}{throwMatrix}};}
\DoxyCodeLine{00067\ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classcovarianceBase_aa2344b1482362eed11d817acdb6befe4}\label{classcovarianceBase_aa2344b1482362eed11d817acdb6befe4}} 
\index{covarianceBase@{covarianceBase}!acceptStep@{acceptStep}}
\index{acceptStep@{acceptStep}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{acceptStep()}{acceptStep()}}
{\footnotesize\ttfamily void covariance\+Base\+::accept\+Step (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Accepted this step. 



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00687}{687}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00687\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00688\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00689\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{}
\DoxyCodeLine{00690\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{00691\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{00692\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{00693\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{00694\ \ \ \ \ \ \ \textcolor{comment}{//\ Update\ state\ so\ that\ current\ state\ is\ proposed\ state}}
\DoxyCodeLine{00695\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i];}
\DoxyCodeLine{00696\ \ \ \ \ \}}
\DoxyCodeLine{00697\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00698\ \ \ \textcolor{comment}{//\ Update\ the\ book-\/keeping\ for\ the\ output}}
\DoxyCodeLine{00699\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{00700\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{00701\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{00702\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}};\ ++i)\ \{}
\DoxyCodeLine{00703\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_aa96f87ab90dc26fc1b5e157149b9dfd3}{fParCurr\_PCA}}(i)\ =\ \mbox{\hyperlink{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}{fParProp\_PCA}}(i);}
\DoxyCodeLine{00704\ \ \ \ \ \}}
\DoxyCodeLine{00705\ \ \ \ \ \textcolor{comment}{//\ Then\ update\ the\ parameter\ basis}}
\DoxyCodeLine{00706\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a65ac4956a782b01768f445732522a450}{TransferToParam}}();}
\DoxyCodeLine{00707\ \ \ \}}
\DoxyCodeLine{00708\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a0056f747843633b2f8408f599f13f89f}\label{classcovarianceBase_a0056f747843633b2f8408f599f13f89f}} 
\index{covarianceBase@{covarianceBase}!CalcLikelihood@{CalcLikelihood}}
\index{CalcLikelihood@{CalcLikelihood}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{CalcLikelihood()}{CalcLikelihood()}}
{\footnotesize\ttfamily double covariance\+Base\+::\+Calc\+Likelihood (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Calc penalty term based on inverted covariance matrix. 



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00800}{800}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00800\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00801\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00802\ \ \ \textcolor{keywordtype}{double}\ logL\ =\ 0.0;}
\DoxyCodeLine{00803\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{00804\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for\ reduction(+:logL)}}
\DoxyCodeLine{00805\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{00806\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\{}
\DoxyCodeLine{00807\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{00808\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ simd}}
\DoxyCodeLine{00809\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{00810\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ ++j)\ \{}
\DoxyCodeLine{00811\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_ad9c47deb7009bff81210f666e80012eb}{\_fFlatPrior}}[i]\ \&\&\ !\mbox{\hyperlink{classcovarianceBase_ad9c47deb7009bff81210f666e80012eb}{\_fFlatPrior}}[j])\ \{}
\DoxyCodeLine{00812\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Since\ matrix\ is\ symmetric\ we\ can\ calculate\ non\ diagonal\ elements\ only\ once\ and\ multiply\ by\ 2,\ can\ bring\ up\ to\ factor\ speed\ decrease.}}
\DoxyCodeLine{00813\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ \textcolor{keywordtype}{int}\ scale\ =\ (i\ !=\ j)\ ?\ 2\ :\ 1;}
\DoxyCodeLine{00814\ \ \ \ \ \ \ \ \ logL\ +=\ scale\ *\ 0.5*(\mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ -\/\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i])*(\mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[j]\ -\/\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[j])*\mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}}[i][j];}
\DoxyCodeLine{00815\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00816\ \ \ \ \ \}}
\DoxyCodeLine{00817\ \ \ \}}
\DoxyCodeLine{00818\ \ \ \textcolor{keywordflow}{return}\ logL;}
\DoxyCodeLine{00819\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_ac3c3e322dc06ce6a44a887ae13e522ae}\label{classcovarianceBase_ac3c3e322dc06ce6a44a887ae13e522ae}} 
\index{covarianceBase@{covarianceBase}!CheckBounds@{CheckBounds}}
\index{CheckBounds@{CheckBounds}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{CheckBounds()}{CheckBounds()}}
{\footnotesize\ttfamily int covariance\+Base\+::\+Check\+Bounds (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Check if parameters were proposed outside physical boundary. 



Reimplemented in \mbox{\hyperlink{classcovarianceOsc_ad181d61769506529f8f00c10c2a86944}{covariance\+Osc}}.



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00822}{822}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00822\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00823\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00824\ \ \ \textcolor{keywordtype}{int}\ NOutside\ =\ 0;}
\DoxyCodeLine{00825\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{00826\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for\ reduction(+:NOutside)}}
\DoxyCodeLine{00827\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{00828\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\{}
\DoxyCodeLine{00829\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ >\ \mbox{\hyperlink{classcovarianceBase_a31e636cb6de871bd0c2c8e7e299df9e7}{\_fUpBound}}[i]\ ||\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ <\ \mbox{\hyperlink{classcovarianceBase_a8f1d94838f188cc85c4f82557c0b0b66}{\_fLowBound}}[i])\{}
\DoxyCodeLine{00830\ \ \ \ \ \ \ NOutside++;}
\DoxyCodeLine{00831\ \ \ \ \ \}}
\DoxyCodeLine{00832\ \ \ \}}
\DoxyCodeLine{00833\ \ \ \textcolor{keywordflow}{return}\ NOutside;}
\DoxyCodeLine{00834\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a8ac3a458097817eca534c23554a7635b}\label{classcovarianceBase_a8ac3a458097817eca534c23554a7635b}} 
\index{covarianceBase@{covarianceBase}!ConstructPCA@{ConstructPCA}}
\index{ConstructPCA@{ConstructPCA}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{ConstructPCA()}{ConstructPCA()}}
{\footnotesize\ttfamily void covariance\+Base\+::\+Construct\+PCA (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



CW\+: Calculate eigen values, prepare transition matrices and remove param based on defined threshold. 

\begin{DoxySeeAlso}{See also}
For more details, visit the \href{https://github.com/mach3-software/MaCh3/wiki/03.-Eigen-Decomposition-\%E2\%80\%90-PCA}{\texttt{ Wiki}}. 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00070}{70}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00071\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \textcolor{comment}{//Check\ whether\ first\ and\ last\ pcadpar\ are\ set\ and\ if\ not\ just\ PCA\ everything}}
\DoxyCodeLine{00074\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classcovarianceBase_abba75182305d556818c76974a054a17d}{FirstPCAdpar}}\ ==\ -\/999\ ||\ \mbox{\hyperlink{classcovarianceBase_a5ebdc744b733656972a15f1657915a3f}{LastPCAdpar}}\ ==\ -\/999)\{}
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classcovarianceBase_abba75182305d556818c76974a054a17d}{FirstPCAdpar}}\ ==\ -\/999\ \&\&\ \mbox{\hyperlink{classcovarianceBase_a5ebdc744b733656972a15f1657915a3f}{LastPCAdpar}}\ ==\ -\/999)\{}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_abba75182305d556818c76974a054a17d}{FirstPCAdpar}}\ =\ 0;}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a5ebdc744b733656972a15f1657915a3f}{LastPCAdpar}}\ =\ \mbox{\hyperlink{classcovarianceBase_a6c3fe8db34c06299fd1633951ac00937}{covMatrix}}-\/>GetNrows()-\/1;}
\DoxyCodeLine{00078\ \ \ \ \ \}}
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}You\ must\ either\ leave\ FirstPCAdpar\ and\ LastPCAdpar\ at\ -\/999\ or\ set\ them\ both\ to\ something"{}});}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00082\ \ \ \ \ \}}
\DoxyCodeLine{00083\ \ \ \}}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \mbox{\hyperlink{classcovarianceBase_ad0022a3e9dd3b2661c9b02a02488759c}{PCAObj}}.\mbox{\hyperlink{classPCAHandler_a361fd5f81ae3bcd915cd598b69e264ba}{ConstructPCA}}(\mbox{\hyperlink{classcovarianceBase_a6c3fe8db34c06299fd1633951ac00937}{covMatrix}},\ \mbox{\hyperlink{classcovarianceBase_abba75182305d556818c76974a054a17d}{FirstPCAdpar}},\ \mbox{\hyperlink{classcovarianceBase_a5ebdc744b733656972a15f1657915a3f}{LastPCAdpar}},\ \mbox{\hyperlink{classcovarianceBase_add54ab1ba46b723fa23d7c95dfad671a}{eigen\_threshold}},\ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}});}
\DoxyCodeLine{00086\ \ \ \textcolor{comment}{//\ Make\ a\ note\ that\ we\ have\ now\ done\ PCA}}
\DoxyCodeLine{00087\ \ \ \mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \ \ \textcolor{comment}{//\ Make\ the\ PCA\ parameter\ arrays}}
\DoxyCodeLine{00090\ \ \ \mbox{\hyperlink{classcovarianceBase_aa96f87ab90dc26fc1b5e157149b9dfd3}{fParCurr\_PCA}}.ResizeTo(\mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}});}
\DoxyCodeLine{00091\ \ \ \mbox{\hyperlink{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}{fParProp\_PCA}}.ResizeTo(\mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}});}
\DoxyCodeLine{00092\ \ \ \mbox{\hyperlink{classcovarianceBase_ae6aada94037640a68e3f37898f276019}{\_fPreFitValue\_PCA}}.resize(\mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}});}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ \textcolor{comment}{//KS:\ make\ easy\ map\ so\ we\ could\ easily\ find\ un-\/decomposed\ parameters}}
\DoxyCodeLine{00095\ \ \ \mbox{\hyperlink{classcovarianceBase_ae9f3cb2a310874b86965903714ef2bd8}{isDecomposed\_PCA}}.resize(\mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}});}
\DoxyCodeLine{00096\ \ \ \mbox{\hyperlink{classcovarianceBase_a7b83a17de68cc7838b93de242d91d9a0}{fParSigma\_PCA}}.resize(\mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}});}
\DoxyCodeLine{00097\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}};\ ++i)}
\DoxyCodeLine{00098\ \ \ \{}
\DoxyCodeLine{00099\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a7b83a17de68cc7838b93de242d91d9a0}{fParSigma\_PCA}}[i]\ =\ 1;}
\DoxyCodeLine{00100\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ae9f3cb2a310874b86965903714ef2bd8}{isDecomposed\_PCA}}[i]\ =\ -\/1;}
\DoxyCodeLine{00101\ \ \ \}}
\DoxyCodeLine{00102\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_abba75182305d556818c76974a054a17d}{FirstPCAdpar}};\ ++i)\ \mbox{\hyperlink{classcovarianceBase_ae9f3cb2a310874b86965903714ef2bd8}{isDecomposed\_PCA}}[i]\ =\ i;}
\DoxyCodeLine{00103\ \ \ }
\DoxyCodeLine{00104\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ \mbox{\hyperlink{classcovarianceBase_abba75182305d556818c76974a054a17d}{FirstPCAdpar}}+\mbox{\hyperlink{classcovarianceBase_ad0022a3e9dd3b2661c9b02a02488759c}{PCAObj}}.\mbox{\hyperlink{classPCAHandler_aa39db9118399bebcdb784fe9c9fea458}{nKeptPCApars}}+1;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}};\ ++i)\ \mbox{\hyperlink{classcovarianceBase_ae9f3cb2a310874b86965903714ef2bd8}{isDecomposed\_PCA}}[i]\ =\ i+(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}-\/\mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}});}
\DoxyCodeLine{00105\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_aba2b2dae2546299c9a4dab618d65e7c0}\label{classcovarianceBase_aba2b2dae2546299c9a4dab618d65e7c0}} 
\index{covarianceBase@{covarianceBase}!CorrelateSteps@{CorrelateSteps}}
\index{CorrelateSteps@{CorrelateSteps}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{CorrelateSteps()}{CorrelateSteps()}}
{\footnotesize\ttfamily void covariance\+Base\+::\+Correlate\+Steps (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Use Cholesky throw matrix for better step proposal. 



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00639}{639}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00639\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00640\ \textcolor{comment}{//\ ************************************************}}
\DoxyCodeLine{00641\ \ \ \textcolor{comment}{//KS:\ Using\ custom\ function\ compared\ to\ ROOT\ one\ with\ 8\ threads\ we\ have\ almost\ factor\ 2\ performance\ increase,\ by\ replacing\ TMatrix\ with\ just\ double\ we\ increase\ it\ even\ more}}
\DoxyCodeLine{00642\ \ \ \mbox{\hyperlink{classcovarianceBase_a64aaa71f81750ba27977c0405c51cd88}{MatrixVectorMulti}}(\mbox{\hyperlink{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}{corr\_throw}},\ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}},\ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}},\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{00643\ }
\DoxyCodeLine{00644\ \ \ \textcolor{comment}{//\ If\ not\ doing\ PCA}}
\DoxyCodeLine{00645\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{}
\DoxyCodeLine{00646\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{00647\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{00648\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{00649\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{00650\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}[i]\ >\ 0.)\ \{}
\DoxyCodeLine{00651\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i]\ +\ \mbox{\hyperlink{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}{corr\_throw}}[i]*\mbox{\hyperlink{classcovarianceBase_a0088413d6a15d12cd34ec06166302f5c}{\_fGlobalStepScale}}*\mbox{\hyperlink{classcovarianceBase_a3cda39026e336a49cef482efd4062561}{\_fIndivStepScale}}[i];}
\DoxyCodeLine{00652\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00653\ \ \ \ \ \}}
\DoxyCodeLine{00654\ \ \ \ \ \textcolor{comment}{//\ If\ doing\ PCA\ throw\ uncorrelated\ in\ PCA\ basis\ (orthogonal\ basis\ by\ definition)}}
\DoxyCodeLine{00655\ \ \ \}\ \textcolor{keywordflow}{else}\ \{\ }
\DoxyCodeLine{00656\ \ \ \ \ \textcolor{comment}{//\ Throw\ around\ the\ current\ step}}
\DoxyCodeLine{00657\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{00658\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{00659\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{00660\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}};\ ++i)}
\DoxyCodeLine{00661\ \ \ \ \ \{}
\DoxyCodeLine{00662\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a7b83a17de68cc7838b93de242d91d9a0}{fParSigma\_PCA}}[i]\ >\ 0.)\ }
\DoxyCodeLine{00663\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00664\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ IndStepScale\ =\ 1.;}
\DoxyCodeLine{00665\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ If\ undecomposed\ parameter\ apply\ individual\ step\ scale\ and\ Cholesky\ for\ better\ acceptance\ rate}}
\DoxyCodeLine{00666\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classcovarianceBase_ae9f3cb2a310874b86965903714ef2bd8}{isDecomposed\_PCA}}[i]\ >=\ 0)}
\DoxyCodeLine{00667\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00668\ \ \ \ \ \ \ \ \ \ \ IndStepScale\ *=\ \mbox{\hyperlink{classcovarianceBase_a3cda39026e336a49cef482efd4062561}{\_fIndivStepScale}}[\mbox{\hyperlink{classcovarianceBase_ae9f3cb2a310874b86965903714ef2bd8}{isDecomposed\_PCA}}[i]];}
\DoxyCodeLine{00669\ \ \ \ \ \ \ \ \ \ \ IndStepScale\ *=\ \mbox{\hyperlink{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}{corr\_throw}}[\mbox{\hyperlink{classcovarianceBase_ae9f3cb2a310874b86965903714ef2bd8}{isDecomposed\_PCA}}[i]];}
\DoxyCodeLine{00670\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00671\ \ \ \ \ \ \ \ \ \textcolor{comment}{//If\ decomposed\ apply\ only\ random\ number}}
\DoxyCodeLine{00672\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00673\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00674\ \ \ \ \ \ \ \ \ \ IndStepScale\ *=\ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}}[i];}
\DoxyCodeLine{00675\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ All\ PCA-\/ed\ parameters\ have\ the\ same\ step\ scale}}
\DoxyCodeLine{00676\ \ \ \ \ \ \ \ \ \ IndStepScale\ *=\ \mbox{\hyperlink{classcovarianceBase_a3cda39026e336a49cef482efd4062561}{\_fIndivStepScale}}[\mbox{\hyperlink{classcovarianceBase_abba75182305d556818c76974a054a17d}{FirstPCAdpar}}];}
\DoxyCodeLine{00677\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00678\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}{fParProp\_PCA}}(i)\ =\ \mbox{\hyperlink{classcovarianceBase_aa96f87ab90dc26fc1b5e157149b9dfd3}{fParCurr\_PCA}}(i)+\mbox{\hyperlink{classcovarianceBase_a0088413d6a15d12cd34ec06166302f5c}{\_fGlobalStepScale}}*IndStepScale*\mbox{\hyperlink{classcovarianceBase_ad0022a3e9dd3b2661c9b02a02488759c}{PCAObj}}.\mbox{\hyperlink{classPCAHandler_a2924386fef0cf65215c51b4f81cdb0d1}{eigen\_values\_master}}[i];}
\DoxyCodeLine{00679\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00680\ \ \ \ \ \}}
\DoxyCodeLine{00681\ \ \ \ \ \textcolor{comment}{//\ Then\ update\ the\ parameter\ basis}}
\DoxyCodeLine{00682\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a65ac4956a782b01768f445732522a450}{TransferToParam}}();}
\DoxyCodeLine{00683\ \ \ \}}
\DoxyCodeLine{00684\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a61936f5c39ad7902624222fc49ad1362}\label{classcovarianceBase_a61936f5c39ad7902624222fc49ad1362}} 
\index{covarianceBase@{covarianceBase}!GetConfig@{GetConfig}}
\index{GetConfig@{GetConfig}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{GetConfig()}{GetConfig()}}
{\footnotesize\ttfamily YAML\+::\+Node covariance\+Base\+::\+Get\+Config (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Getter to return a copy of the YAML node. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00344}{344}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00344\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_a933ff3dc0af99629ba3582a5d9d89d23}{\_fYAMLDoc}};\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_ac14fabdb87f5101cdbfcecb8e6b6b811}\label{classcovarianceBase_ac14fabdb87f5101cdbfcecb8e6b6b811}} 
\index{covarianceBase@{covarianceBase}!GetCorrelationMatrix@{GetCorrelationMatrix}}
\index{GetCorrelationMatrix@{GetCorrelationMatrix}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{GetCorrelationMatrix()}{GetCorrelationMatrix()}}
{\footnotesize\ttfamily TH2D $\ast$ covariance\+Base\+::\+Get\+Correlation\+Matrix (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



KS\+: Convert covariance matrix to correlation matrix and return TH2D which can be used for fancy plotting. 

This function converts the covariance matrix to a correlation matrix and returns a TH2D object, which can be used for advanced plotting purposes. \begin{DoxyReturn}{Returns}
A pointer to a TH2D object representing the correlation matrix 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l01321}{1321}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01321\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01322\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{01323\ \ \ TH2D*\ hMatrix\ =\ \textcolor{keyword}{new}\ TH2D(\mbox{\hyperlink{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}{getName}}().c\_str(),\ \mbox{\hyperlink{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}{getName}}().c\_str(),\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}},\ 0.0,\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}},\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}},\ 0.0,\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{01324\ }
\DoxyCodeLine{01325\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)}
\DoxyCodeLine{01326\ \ \ \{}
\DoxyCodeLine{01327\ \ \ \ \ hMatrix-\/>SetBinContent(i+1,\ i+1,\ 1.);}
\DoxyCodeLine{01328\ \ \ \ \ hMatrix-\/>GetXaxis()-\/>SetBinLabel(i+1,\ \mbox{\hyperlink{classcovarianceBase_a6a46b5fed3e7feb6e9e151e90927bdbc}{GetParFancyName}}(i).c\_str());}
\DoxyCodeLine{01329\ \ \ \ \ hMatrix-\/>GetYaxis()-\/>SetBinLabel(i+1,\ \mbox{\hyperlink{classcovarianceBase_a6a46b5fed3e7feb6e9e151e90927bdbc}{GetParFancyName}}(i).c\_str());}
\DoxyCodeLine{01330\ \ \ \}}
\DoxyCodeLine{01331\ }
\DoxyCodeLine{01332\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{01333\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{01334\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{01335\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)}
\DoxyCodeLine{01336\ \ \ \{}
\DoxyCodeLine{01337\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ j++)}
\DoxyCodeLine{01338\ \ \ \ \ \{}
\DoxyCodeLine{01339\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Corr\ =\ (*covMatrix)(i,j)\ /\ (\ \mbox{\hyperlink{classcovarianceBase_a01e3ab6a6758fc58b8c695556a39d879}{getDiagonalError}}(i)\ *\ \mbox{\hyperlink{classcovarianceBase_a01e3ab6a6758fc58b8c695556a39d879}{getDiagonalError}}(j));}
\DoxyCodeLine{01340\ \ \ \ \ \ \ hMatrix-\/>SetBinContent(i+1,\ j+1,\ Corr);}
\DoxyCodeLine{01341\ \ \ \ \ \ \ hMatrix-\/>SetBinContent(j+1,\ i+1,\ Corr);}
\DoxyCodeLine{01342\ \ \ \ \ \}}
\DoxyCodeLine{01343\ \ \ \}}
\DoxyCodeLine{01344\ \ \ \textcolor{keywordflow}{return}\ hMatrix;}
\DoxyCodeLine{01345\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a5968a05b1139d72344ea08b8cd6c76c6}\label{classcovarianceBase_a5968a05b1139d72344ea08b8cd6c76c6}} 
\index{covarianceBase@{covarianceBase}!getCovMatrix@{getCovMatrix}}
\index{getCovMatrix@{getCovMatrix}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getCovMatrix()}{getCovMatrix()}}
{\footnotesize\ttfamily TMatrix\+DSym $\ast$ covariance\+Base\+::get\+Cov\+Matrix (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Return covariance matrix. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00106}{106}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00106\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_a6c3fe8db34c06299fd1633951ac00937}{covMatrix}};\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a01e3ab6a6758fc58b8c695556a39d879}\label{classcovarianceBase_a01e3ab6a6758fc58b8c695556a39d879}} 
\index{covarianceBase@{covarianceBase}!getDiagonalError@{getDiagonalError}}
\index{getDiagonalError@{getDiagonalError}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getDiagonalError()}{getDiagonalError()}}
{\footnotesize\ttfamily double covariance\+Base\+::get\+Diagonal\+Error (\begin{DoxyParamCaption}\item[{const int}]{i }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get diagonal error for ith parameter. 


\begin{DoxyParams}{Parameters}
{\em i} & Parameter index \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00126}{126}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00126\ \{\ \textcolor{keywordflow}{return}\ std::sqrt((*\mbox{\hyperlink{classcovarianceBase_a6c3fe8db34c06299fd1633951ac00937}{covMatrix}})(i,i));\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a11075f684f5d2d7eff9c222867e33bb7}\label{classcovarianceBase_a11075f684f5d2d7eff9c222867e33bb7}} 
\index{covarianceBase@{covarianceBase}!getDoAdaption@{getDoAdaption}}
\index{getDoAdaption@{getDoAdaption}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getDoAdaption()}{getDoAdaption()}}
{\footnotesize\ttfamily bool covariance\+Base\+::get\+Do\+Adaption (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Do we adapt or not. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00142}{142}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00142\ \{\textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_a838731abd6716940043b484b2b266f86}{use\_adaptive}};\}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_add3d24e738cde5a2f5ab1b2b377a2afb}\label{classcovarianceBase_add3d24e738cde5a2f5ab1b2b377a2afb}} 
\index{covarianceBase@{covarianceBase}!getEigenValues@{getEigenValues}}
\index{getEigenValues@{getEigenValues}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getEigenValues()}{getEigenValues()}}
{\footnotesize\ttfamily const TVectorD covariance\+Base\+::get\+Eigen\+Values (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get eigen values for all parameters, if you want for decomposed only parameters use get\+Eigen\+Values\+Master. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00245}{245}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00246\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{\ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Am\ not\ running\ in\ PCA\ mode"{}});\ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );\ \}}
\DoxyCodeLine{00247\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_ad0022a3e9dd3b2661c9b02a02488759c}{PCAObj}}.\mbox{\hyperlink{classPCAHandler_a8d95ecb29e091e9b09c5011691516c28}{eigen\_values}};}
\DoxyCodeLine{00248\ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a104f2d2f1b7f60693bba489ac4e753cc}\label{classcovarianceBase_a104f2d2f1b7f60693bba489ac4e753cc}} 
\index{covarianceBase@{covarianceBase}!getEigenValuesMaster@{getEigenValuesMaster}}
\index{getEigenValuesMaster@{getEigenValuesMaster}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getEigenValuesMaster()}{getEigenValuesMaster()}}
{\footnotesize\ttfamily const std\+::vector$<$ double $>$ covariance\+Base\+::get\+Eigen\+Values\+Master (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get eigen value of only decomposed parameters, if you want for all parameters use get\+Eigen\+Values. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00250}{250}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00251\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{\ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Am\ not\ running\ in\ PCA\ mode"{}});\ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );\ \}}
\DoxyCodeLine{00252\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_ad0022a3e9dd3b2661c9b02a02488759c}{PCAObj}}.\mbox{\hyperlink{classPCAHandler_a2924386fef0cf65215c51b4f81cdb0d1}{eigen\_values\_master}};}
\DoxyCodeLine{00253\ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_ad1b0e5f25843ee77ec1c6094856cda27}\label{classcovarianceBase_ad1b0e5f25843ee77ec1c6094856cda27}} 
\index{covarianceBase@{covarianceBase}!getEigenVectors@{getEigenVectors}}
\index{getEigenVectors@{getEigenVectors}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getEigenVectors()}{getEigenVectors()}}
{\footnotesize\ttfamily const TMatrixD covariance\+Base\+::get\+Eigen\+Vectors (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get eigen vectors of covariance matrix, only works with PCA. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00240}{240}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00241\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{\ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Am\ not\ running\ in\ PCA\ mode"{}});\ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );\ \}}
\DoxyCodeLine{00242\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_ad0022a3e9dd3b2661c9b02a02488759c}{PCAObj}}.\mbox{\hyperlink{classPCAHandler_a3ba9d34343ce0d0eeb4c020fa70486e2}{eigen\_vectors}};}
\DoxyCodeLine{00243\ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a82539ec974ced3c3f912be4731bb191d}\label{classcovarianceBase_a82539ec974ced3c3f912be4731bb191d}} 
\index{covarianceBase@{covarianceBase}!GetError@{GetError}}
\index{GetError@{GetError}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{GetError()}{GetError()}}
{\footnotesize\ttfamily double covariance\+Base\+::\+Get\+Error (\begin{DoxyParamCaption}\item[{const int}]{i }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get the error for the ith parameter. 


\begin{DoxyParams}{Parameters}
{\em i} & Parameter index \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00129}{129}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00129\ \{\textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}[i];\}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a0278e73361d955ab1e39984552acb3b7}\label{classcovarianceBase_a0278e73361d955ab1e39984552acb3b7}} 
\index{covarianceBase@{covarianceBase}!getFlatPrior@{getFlatPrior}}
\index{getFlatPrior@{getFlatPrior}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getFlatPrior()}{getFlatPrior()}}
{\footnotesize\ttfamily bool covariance\+Base\+::get\+Flat\+Prior (\begin{DoxyParamCaption}\item[{const int}]{i }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get if param has flat prior or not. 


\begin{DoxyParams}{Parameters}
{\em i} & Parameter index \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00111}{111}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00111\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_ad9c47deb7009bff81210f666e80012eb}{\_fFlatPrior}}[i];\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a3d8d40e4f44cd0c89a1a2d4b4711f332}\label{classcovarianceBase_a3d8d40e4f44cd0c89a1a2d4b4711f332}} 
\index{covarianceBase@{covarianceBase}!GetGenerated@{GetGenerated}}
\index{GetGenerated@{GetGenerated}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{GetGenerated()}{GetGenerated()}}
{\footnotesize\ttfamily double covariance\+Base\+::\+Get\+Generated (\begin{DoxyParamCaption}\item[{const int}]{i }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Return generated value for a given parameter. 


\begin{DoxyParams}{Parameters}
{\em i} & Parameter index \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00204}{204}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00204\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_a9b753f52711600a9f8d648531d95b044}{\_fGenerated}}[i];\}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a7316a31398c07816a5529d7a9494a1c5}\label{classcovarianceBase_a7316a31398c07816a5529d7a9494a1c5}} 
\index{covarianceBase@{covarianceBase}!getGeneratedValues@{getGeneratedValues}}
\index{getGeneratedValues@{getGeneratedValues}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getGeneratedValues()}{getGeneratedValues()}}
{\footnotesize\ttfamily std\+::vector$<$ double $>$ covariance\+Base\+::get\+Generated\+Values (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get the generated values of the parameters. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00187}{187}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00187\ \{\textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_a9b753f52711600a9f8d648531d95b044}{\_fGenerated}};\}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_ad5b8a91b33381652bae35f1903e16136}\label{classcovarianceBase_ad5b8a91b33381652bae35f1903e16136}} 
\index{covarianceBase@{covarianceBase}!GetIndivStepScale@{GetIndivStepScale}}
\index{GetIndivStepScale@{GetIndivStepScale}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{GetIndivStepScale()}{GetIndivStepScale()}}
{\footnotesize\ttfamily double covariance\+Base\+::\+Get\+Indiv\+Step\+Scale (\begin{DoxyParamCaption}\item[{const int}]{Parameter\+Index }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get individual step scale for selected parameter. 


\begin{DoxyParams}{Parameters}
{\em Parameter\+Index} & Parameter index \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00213}{213}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00213\ \{\textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_a3cda39026e336a49cef482efd4062561}{\_fIndivStepScale}}.at(ParameterIndex);\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_aa52b2765d3e7ae504af20861bedafa4e}\label{classcovarianceBase_aa52b2765d3e7ae504af20861bedafa4e}} 
\index{covarianceBase@{covarianceBase}!getInputFile@{getInputFile}}
\index{getInputFile@{getInputFile}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getInputFile()}{getInputFile()}}
{\footnotesize\ttfamily std\+::string covariance\+Base\+::get\+Input\+File (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Get name of input file. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00122}{122}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00122\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_a5451d4189a9fb7591c8ce728852ba82e}{inputFile}};\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a12221dba3e93480881d1195482ef6d87}\label{classcovarianceBase_a12221dba3e93480881d1195482ef6d87}} 
\index{covarianceBase@{covarianceBase}!getInvCovMatrix@{getInvCovMatrix}}
\index{getInvCovMatrix@{getInvCovMatrix}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getInvCovMatrix()}{getInvCovMatrix()}}
{\footnotesize\ttfamily TMatrix\+DSym $\ast$ covariance\+Base\+::get\+Inv\+Cov\+Matrix (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Return inverted covariance matrix. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00108}{108}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00108\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_a35c7dc7817eaf4058e9775b6bc792ebc}{invCovMatrix}};\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a9ee2fbfe0f1ac86c8c129095638e0f76}\label{classcovarianceBase_a9ee2fbfe0f1ac86c8c129095638e0f76}} 
\index{covarianceBase@{covarianceBase}!GetLikelihood@{GetLikelihood}}
\index{GetLikelihood@{GetLikelihood}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{GetLikelihood()}{GetLikelihood()}}
{\footnotesize\ttfamily double covariance\+Base\+::\+Get\+Likelihood (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Return Calc\+Likelihood if some params were thrown out of boundary return {\itshape LARGE\+\_\+\+LOGL} 



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00837}{837}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00837\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00838\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00839\ \ \ \textcolor{comment}{//\ Checkbounds\ and\ calclikelihood\ are\ virtual}}
\DoxyCodeLine{00840\ \ \ \textcolor{comment}{//\ Default\ behaviour\ is\ to\ reject\ negative\ values\ +\ do\ std\ llh\ calculation}}
\DoxyCodeLine{00841\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ NOutside\ =\ \mbox{\hyperlink{classcovarianceBase_ac3c3e322dc06ce6a44a887ae13e522ae}{CheckBounds}}();}
\DoxyCodeLine{00842\ \ \ }
\DoxyCodeLine{00843\ \ \ \textcolor{keywordflow}{if}(NOutside\ >\ 0)}
\DoxyCodeLine{00844\ \ \ \ \ \textcolor{keywordflow}{return}\ NOutside*\mbox{\hyperlink{covarianceBase_8h_a194098591fd0bc4afaf13b4fd8fee408}{\_LARGE\_LOGL\_}};}
\DoxyCodeLine{00845\ }
\DoxyCodeLine{00846\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_a0056f747843633b2f8408f599f13f89f}{CalcLikelihood}}();}
\DoxyCodeLine{00847\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a634e89392da441ff88cad3a3ba619ccc}\label{classcovarianceBase_a634e89392da441ff88cad3a3ba619ccc}} 
\index{covarianceBase@{covarianceBase}!GetLowerBound@{GetLowerBound}}
\index{GetLowerBound@{GetLowerBound}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{GetLowerBound()}{GetLowerBound()}}
{\footnotesize\ttfamily double covariance\+Base\+::\+Get\+Lower\+Bound (\begin{DoxyParamCaption}\item[{const int}]{i }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get lower parameter bound in which it is physically valid. 


\begin{DoxyParams}{Parameters}
{\em i} & Parameter index \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00210}{210}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00210\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_a8f1d94838f188cc85c4f82557c0b0b66}{\_fLowBound}}[i];\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}\label{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}} 
\index{covarianceBase@{covarianceBase}!getName@{getName}}
\index{getName@{getName}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getName()}{getName()}}
{\footnotesize\ttfamily std\+::string covariance\+Base\+::get\+Name (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get name of covariance. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00114}{114}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00114\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_a26618d3f5633b33ce20e38ce8261b3ee}{matrixName}};\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a5bf31f7d7a5e24c49d4157d411080dbf}\label{classcovarianceBase_a5bf31f7d7a5e24c49d4157d411080dbf}} 
\index{covarianceBase@{covarianceBase}!getNominal@{getNominal}}
\index{getNominal@{getNominal}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getNominal()}{getNominal()}}
{\footnotesize\ttfamily virtual double covariance\+Base\+::get\+Nominal (\begin{DoxyParamCaption}\item[{const int}]{i }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Return generated value, although is virtual so class inheriting might actual get nominal not generated. 


\begin{DoxyParams}{Parameters}
{\em i} & Parameter index \\
\hline
\end{DoxyParams}


Reimplemented in \mbox{\hyperlink{classcovarianceXsec_aea8d453c3b4bfe236faff0bf48623118}{covariance\+Xsec}}.



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00201}{201}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00201\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_a1cede85accaac2ea7056740893d90c49}{getParInit}}(i);\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_ae0a231f87266048a3cd2e0032eaf0f30}\label{classcovarianceBase_ae0a231f87266048a3cd2e0032eaf0f30}} 
\index{covarianceBase@{covarianceBase}!getNominalArray@{getNominalArray}}
\index{getNominalArray@{getNominalArray}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getNominalArray()}{getNominalArray()}}
{\footnotesize\ttfamily std\+::vector$<$ double $>$ covariance\+Base\+::get\+Nominal\+Array (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Get the nominal array for parameters. 



Reimplemented in \mbox{\hyperlink{classcovarianceXsec_a98cf4b870e62badc83bcda99ae3574ae}{covariance\+Xsec}}.



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l01309}{1309}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01309\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01310\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{01311\ \ \ std::vector<double>\ \mbox{\hyperlink{GetPenaltyTerm_8cpp_a35f9d8ea46badc9ea84d62feaa0e73df}{nominal}}(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{01312\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)}
\DoxyCodeLine{01313\ \ \ \{}
\DoxyCodeLine{01314\ \ \ \ \ \mbox{\hyperlink{GetPenaltyTerm_8cpp_a35f9d8ea46badc9ea84d62feaa0e73df}{nominal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i];}
\DoxyCodeLine{01315\ \ \ \}}
\DoxyCodeLine{01316\ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{GetPenaltyTerm_8cpp_a35f9d8ea46badc9ea84d62feaa0e73df}{nominal}};}
\DoxyCodeLine{01317\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a261941a4c06e5d875174d8769a4d02f1}\label{classcovarianceBase_a261941a4c06e5d875174d8769a4d02f1}} 
\index{covarianceBase@{covarianceBase}!getNpars@{getNpars}}
\index{getNpars@{getNpars}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getNpars()}{getNpars()}}
{\footnotesize\ttfamily int covariance\+Base\+::get\+Npars (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get number of params which will be different depending if using Eigen decomposition or not. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00290}{290}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00291\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}};}
\DoxyCodeLine{00292\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};}
\DoxyCodeLine{00293\ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a3daac6405cc791347b768a5afe8a13d2}\label{classcovarianceBase_a3daac6405cc791347b768a5afe8a13d2}} 
\index{covarianceBase@{covarianceBase}!GetNumParams@{GetNumParams}}
\index{GetNumParams@{GetNumParams}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{GetNumParams()}{GetNumParams()}}
{\footnotesize\ttfamily int covariance\+Base\+::\+Get\+Num\+Params (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get total number of parameters. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00181}{181}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00181\ \{\textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_ab89b754afc93b63f41070710af4c0f2d}\label{classcovarianceBase_ab89b754afc93b63f41070710af4c0f2d}} 
\index{covarianceBase@{covarianceBase}!getParameterMeans@{getParameterMeans}}
\index{getParameterMeans@{getParameterMeans}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getParameterMeans()}{getParameterMeans()}}
{\footnotesize\ttfamily std\+::vector$<$ double $>$ covariance\+Base\+::get\+Parameter\+Means (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get the parameter means used in the adaptive handler. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00157}{157}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00157\ \{\textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_a066984e9598e073d04edec51511cdf0a}{par\_means}};\}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a040e445c6d4f8d4eea8fc13418cea7ff}\label{classcovarianceBase_a040e445c6d4f8d4eea8fc13418cea7ff}} 
\index{covarianceBase@{covarianceBase}!getParCurr@{getParCurr}}
\index{getParCurr@{getParCurr}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getParCurr()}{getParCurr()}}
{\footnotesize\ttfamily double covariance\+Base\+::get\+Par\+Curr (\begin{DoxyParamCaption}\item[{const int}]{i }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get current parameter value. 


\begin{DoxyParams}{Parameters}
{\em i} & Parameter index \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00195}{195}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00195\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i];\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_af4c0edbf1bd150484bc4696480ef9a77}\label{classcovarianceBase_af4c0edbf1bd150484bc4696480ef9a77}} 
\index{covarianceBase@{covarianceBase}!getParCurr\_PCA@{getParCurr\_PCA}}
\index{getParCurr\_PCA@{getParCurr\_PCA}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getParCurr\_PCA()}{getParCurr\_PCA()}}
{\footnotesize\ttfamily double covariance\+Base\+::get\+Par\+Curr\+\_\+\+PCA (\begin{DoxyParamCaption}\item[{const int}]{i }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get current parameter value using PCA. 


\begin{DoxyParams}{Parameters}
{\em i} & Parameter index \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00223}{223}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00224\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{\ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Am\ not\ running\ in\ PCA\ mode"{}});\ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );\ \}}
\DoxyCodeLine{00225\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_aa96f87ab90dc26fc1b5e157149b9dfd3}{fParCurr\_PCA}}(i);}
\DoxyCodeLine{00226\ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a6a46b5fed3e7feb6e9e151e90927bdbc}\label{classcovarianceBase_a6a46b5fed3e7feb6e9e151e90927bdbc}} 
\index{covarianceBase@{covarianceBase}!GetParFancyName@{GetParFancyName}}
\index{GetParFancyName@{GetParFancyName}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{GetParFancyName()}{GetParFancyName()}}
{\footnotesize\ttfamily std\+::string covariance\+Base\+::\+Get\+Par\+Fancy\+Name (\begin{DoxyParamCaption}\item[{const int}]{i }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get fancy name of the Parameter. 


\begin{DoxyParams}{Parameters}
{\em i} & Parameter index \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00120}{120}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00120\ \{\textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_a973671386a2f8ea924f25f8f5404654c}{\_fFancyNames}}[i];\}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a1cede85accaac2ea7056740893d90c49}\label{classcovarianceBase_a1cede85accaac2ea7056740893d90c49}} 
\index{covarianceBase@{covarianceBase}!getParInit@{getParInit}}
\index{getParInit@{getParInit}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getParInit()}{getParInit()}}
{\footnotesize\ttfamily double covariance\+Base\+::get\+Par\+Init (\begin{DoxyParamCaption}\item[{const int}]{i }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get prior parameter value. 


\begin{DoxyParams}{Parameters}
{\em i} & Parameter index \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00198}{198}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00198\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i];\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a033c5b6a8669537acaa6c5fc252899e6}\label{classcovarianceBase_a033c5b6a8669537acaa6c5fc252899e6}} 
\index{covarianceBase@{covarianceBase}!GetParName@{GetParName}}
\index{GetParName@{GetParName}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{GetParName()}{GetParName()}}
{\footnotesize\ttfamily std\+::string covariance\+Base\+::\+Get\+Par\+Name (\begin{DoxyParamCaption}\item[{const int}]{i }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get name of covariance. 


\begin{DoxyParams}{Parameters}
{\em i} & Parameter index \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00117}{117}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00117\ \{\textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}[i];\}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a37c87fa18db7e4ac087d120bca955617}\label{classcovarianceBase_a37c87fa18db7e4ac087d120bca955617}} 
\index{covarianceBase@{covarianceBase}!getParProp@{getParProp}}
\index{getParProp@{getParProp}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getParProp()}{getParProp()}}
{\footnotesize\ttfamily double covariance\+Base\+::get\+Par\+Prop (\begin{DoxyParamCaption}\item[{const int}]{i }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get proposed parameter value. 


\begin{DoxyParams}{Parameters}
{\em i} & Parameter index \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00192}{192}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00192\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i];\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a3e29910a1706f60db5f615b3b6f05994}\label{classcovarianceBase_a3e29910a1706f60db5f615b3b6f05994}} 
\index{covarianceBase@{covarianceBase}!getParProp\_PCA@{getParProp\_PCA}}
\index{getParProp\_PCA@{getParProp\_PCA}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getParProp\_PCA()}{getParProp\_PCA()}}
{\footnotesize\ttfamily double covariance\+Base\+::get\+Par\+Prop\+\_\+\+PCA (\begin{DoxyParamCaption}\item[{const int}]{i }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get current parameter value using PCA. 


\begin{DoxyParams}{Parameters}
{\em i} & Parameter index \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00216}{216}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00217\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{\ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Am\ not\ running\ in\ PCA\ mode"{}});\ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );\ \}}
\DoxyCodeLine{00218\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}{fParProp\_PCA}}(i);}
\DoxyCodeLine{00219\ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a43c569248e176e14330cd002bfc2bff6}\label{classcovarianceBase_a43c569248e176e14330cd002bfc2bff6}} 
\index{covarianceBase@{covarianceBase}!getParPropVec@{getParPropVec}}
\index{getParPropVec@{getParPropVec}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getParPropVec()}{getParPropVec()}}
{\footnotesize\ttfamily const std\+::vector$<$ double $>$ \& covariance\+Base\+::get\+Par\+Prop\+Vec (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get a reference to the proposed parameter values Can be useful if you want to track these without having to copy values using \mbox{\hyperlink{classcovarianceBase_a63db139faf1e42d7a1c3c3c661c0b7d9}{get\+Proposed()}} 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00177}{177}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00177\ \{\textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}};\}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_ab34500d7b559db68c46a2838667c3e03}\label{classcovarianceBase_ab34500d7b559db68c46a2838667c3e03}} 
\index{covarianceBase@{covarianceBase}!getPreFitValues@{getPreFitValues}}
\index{getPreFitValues@{getPreFitValues}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getPreFitValues()}{getPreFitValues()}}
{\footnotesize\ttfamily std\+::vector$<$ double $>$ covariance\+Base\+::get\+Pre\+Fit\+Values (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get the pre-\/fit values of the parameters. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00185}{185}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00185\ \{\textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}};\}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a63db139faf1e42d7a1c3c3c661c0b7d9}\label{classcovarianceBase_a63db139faf1e42d7a1c3c3c661c0b7d9}} 
\index{covarianceBase@{covarianceBase}!getProposed@{getProposed}}
\index{getProposed@{getProposed}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getProposed()}{getProposed()}}
{\footnotesize\ttfamily std\+::vector$<$ double $>$ covariance\+Base\+::get\+Proposed (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}



Get vector of all proposed parameter values. 



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00460}{460}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00461\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00462\ \ \ std::vector<double>\ props(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{00463\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ props[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i];}
\DoxyCodeLine{00464\ \ \ \textcolor{keywordflow}{return}\ props;}
\DoxyCodeLine{00465\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_aa306bea2b30013ca55f2a95b8d16ec42}\label{classcovarianceBase_aa306bea2b30013ca55f2a95b8d16ec42}} 
\index{covarianceBase@{covarianceBase}!getThrowMatrix@{getThrowMatrix}}
\index{getThrowMatrix@{getThrowMatrix}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getThrowMatrix()}{getThrowMatrix()}}
{\footnotesize\ttfamily TMatrix\+DSym $\ast$ covariance\+Base\+::get\+Throw\+Matrix (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get matrix used for step proposal. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00153}{153}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00153\ \{\textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_a6cb3d0b4096fbb55b040f70cd5b6e32b}{throwMatrix}};\}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a563a904298d0bd5ec5518708396e0e22}\label{classcovarianceBase_a563a904298d0bd5ec5518708396e0e22}} 
\index{covarianceBase@{covarianceBase}!getThrowMatrix\_CholDecomp@{getThrowMatrix\_CholDecomp}}
\index{getThrowMatrix\_CholDecomp@{getThrowMatrix\_CholDecomp}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getThrowMatrix\_CholDecomp()}{getThrowMatrix\_CholDecomp()}}
{\footnotesize\ttfamily TMatrixD $\ast$ covariance\+Base\+::get\+Throw\+Matrix\+\_\+\+Chol\+Decomp (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get the Cholesky decomposition of the throw matrix. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00155}{155}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00155\ \{\textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_ab95f5e066c2dfb1d20d120bc6c85dda2}{throwMatrix\_CholDecomp}};\}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_acdcf459e3ef443e93c66d83cde87e238}\label{classcovarianceBase_acdcf459e3ef443e93c66d83cde87e238}} 
\index{covarianceBase@{covarianceBase}!getTransferMatrix@{getTransferMatrix}}
\index{getTransferMatrix@{getTransferMatrix}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{getTransferMatrix()}{getTransferMatrix()}}
{\footnotesize\ttfamily const TMatrixD covariance\+Base\+::get\+Transfer\+Matrix (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get transfer matrix allowing to go from PCA base to normal base. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00235}{235}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00236\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{\ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Am\ not\ running\ in\ PCA\ mode"{}});\ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );\ \}}
\DoxyCodeLine{00237\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_ad0022a3e9dd3b2661c9b02a02488759c}{PCAObj}}.\mbox{\hyperlink{classPCAHandler_a1d9302633ed96ec57fbe26d25cbcee61}{TransferMat}};}
\DoxyCodeLine{00238\ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a0c6510aa48248382ba2da0330015b8c6}\label{classcovarianceBase_a0c6510aa48248382ba2da0330015b8c6}} 
\index{covarianceBase@{covarianceBase}!GetUpperBound@{GetUpperBound}}
\index{GetUpperBound@{GetUpperBound}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{GetUpperBound()}{GetUpperBound()}}
{\footnotesize\ttfamily double covariance\+Base\+::\+Get\+Upper\+Bound (\begin{DoxyParamCaption}\item[{const int}]{i }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get upper parameter bound in which it is physically valid. 


\begin{DoxyParams}{Parameters}
{\em i} & Parameter index \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00207}{207}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00207\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_a31e636cb6de871bd0c2c8e7e299df9e7}{\_fUpBound}}[i];\}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_acec1e1c7fd83d21e1ad55a03acfeb8c4}\label{classcovarianceBase_acec1e1c7fd83d21e1ad55a03acfeb8c4}} 
\index{covarianceBase@{covarianceBase}!init@{init}}
\index{init@{init}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{init()}{init()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily void covariance\+Base\+::init (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ std\+::string $>$ \&}]{YAMLFile }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Initialisation of the class using config. 


\begin{DoxyParams}{Parameters}
{\em YAMLFile} & A vector of strings representing the YAML files used for initialisation of matrix \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00180}{180}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00181\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00182\ \ \ \mbox{\hyperlink{classcovarianceBase_a933ff3dc0af99629ba3582a5d9d89d23}{\_fYAMLDoc}}[\textcolor{stringliteral}{"{}Systematics"{}}]\ =\ YAML::Node(YAML::NodeType::Sequence);}
\DoxyCodeLine{00183\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ YAMLFile.size();\ i++)}
\DoxyCodeLine{00184\ \ \ \{}
\DoxyCodeLine{00185\ \ \ \ \ YAML::Node\ YAMLDocTemp\ =\ YAML::LoadFile(YAMLFile[i]);}
\DoxyCodeLine{00186\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ item\ :\ YAMLDocTemp[\textcolor{stringliteral}{"{}Systematics"{}}])\ \{}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a933ff3dc0af99629ba3582a5d9d89d23}{\_fYAMLDoc}}[\textcolor{stringliteral}{"{}Systematics"{}}].push\_back(item);}
\DoxyCodeLine{00188\ \ \ \ \ \}}
\DoxyCodeLine{00189\ \ \ \}}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nThreads\ =\ \mbox{\hyperlink{namespaceMaCh3Utils_a5aff908b9241c673e8d05403996e2229}{MaCh3Utils::GetNThreads}}();}
\DoxyCodeLine{00192\ \ \ \textcolor{comment}{//KS:\ set\ Random\ numbers\ for\ each\ thread\ so\ each\ thread\ has\ different\ seed}}
\DoxyCodeLine{00193\ \ \ \textcolor{comment}{//or\ for\ one\ thread\ if\ without\ MULTITHREAD}}
\DoxyCodeLine{00194\ \ \ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}\ =\ \textcolor{keyword}{new}\ TRandom3*[nThreads]();}
\DoxyCodeLine{00195\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ iThread\ =\ 0;\ iThread\ <\ nThreads;\ iThread++)\ \{}
\DoxyCodeLine{00196\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}[iThread]\ =\ \textcolor{keyword}{new}\ TRandom3(0);}
\DoxyCodeLine{00197\ \ \ \}}
\DoxyCodeLine{00198\ \ \ \mbox{\hyperlink{classcovarianceBase_a8d821ce805f2426fe95549170866821f}{PrintLength}}\ =\ 35;}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00200\ \ \ \textcolor{comment}{//\ Set\ the\ covariance\ matrix}}
\DoxyCodeLine{00201\ \ \ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}\ =\ int(\mbox{\hyperlink{classcovarianceBase_a933ff3dc0af99629ba3582a5d9d89d23}{\_fYAMLDoc}}[\textcolor{stringliteral}{"{}Systematics"{}}].\mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}}());}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ \ \ \mbox{\hyperlink{classcovarianceBase_a838731abd6716940043b484b2b266f86}{use\_adaptive}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00205\ \ \ \mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}]();}
\DoxyCodeLine{00206\ \ \ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}]();}
\DoxyCodeLine{00207\ \ \ \textcolor{comment}{//\ Set\ the\ defaults\ to\ true}}
\DoxyCodeLine{00208\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)}
\DoxyCodeLine{00209\ \ \ \{}
\DoxyCodeLine{00210\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}}[i]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}]();}
\DoxyCodeLine{00211\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}}[i]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}]();}
\DoxyCodeLine{00212\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ j++)}
\DoxyCodeLine{00213\ \ \ \ \ \{}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}}[i][j]\ =\ 0.;}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}}[i][j]\ =\ 0.;}
\DoxyCodeLine{00216\ \ \ \ \ \}}
\DoxyCodeLine{00217\ \ \ \}}
\DoxyCodeLine{00218\ }
\DoxyCodeLine{00219\ \ \ \mbox{\hyperlink{classcovarianceBase_a75b5553823335bb82026ff46369fb67e}{ReserveMemory}}(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \ \ TMatrixDSym*\ \_fCovMatrix\ =\ \textcolor{keyword}{new}\ TMatrixDSym(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{00222\ \ \ \textcolor{comment}{//\_fDetString\ =\ std::vector<std::string>(\_fNumPar);}}
\DoxyCodeLine{00223\ }
\DoxyCodeLine{00224\ \ \ \textcolor{keywordtype}{int}\ i\ =\ 0;}
\DoxyCodeLine{00225\ \ \ std::vector<std::map<std::string,double>>\ Correlations(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{00226\ \ \ std::map<std::string,\ int>\ CorrNamesMap;}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00228\ \ \ \textcolor{comment}{//ETA\ -\/\ read\ in\ the\ systematics.\ Would\ be\ good\ to\ add\ in\ some\ checks\ to\ make\ sure}}
\DoxyCodeLine{00229\ \ \ \textcolor{comment}{//that\ there\ are\ the\ correct\ number\ of\ entries\ i.e.\ are\ the\ \_fNumPar\ for\ Names,}}
\DoxyCodeLine{00230\ \ \ \textcolor{comment}{//PreFitValues\ etc\ etc.}}
\DoxyCodeLine{00231\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \textcolor{keyword}{const}\ \&param\ :\ \mbox{\hyperlink{classcovarianceBase_a933ff3dc0af99629ba3582a5d9d89d23}{\_fYAMLDoc}}[\textcolor{stringliteral}{"{}Systematics"{}}])}
\DoxyCodeLine{00232\ \ \ \{}
\DoxyCodeLine{00233\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a973671386a2f8ea924f25f8f5404654c}{\_fFancyNames}}[i]\ =\ (param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}Names"{}}][\textcolor{stringliteral}{"{}FancyName"{}}].as<std::string>());}
\DoxyCodeLine{00234\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i]\ =\ (param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}ParameterValues"{}}][\textcolor{stringliteral}{"{}PreFitValue"{}}].as<\textcolor{keywordtype}{double}>());}
\DoxyCodeLine{00235\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a9b753f52711600a9f8d648531d95b044}{\_fGenerated}}[i]\ =\ (param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}ParameterValues"{}}][\textcolor{stringliteral}{"{}Generated"{}}].as<\textcolor{keywordtype}{double}>());}
\DoxyCodeLine{00236\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a3cda39026e336a49cef482efd4062561}{\_fIndivStepScale}}[i]\ =\ (param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}StepScale"{}}][\textcolor{stringliteral}{"{}MCMC"{}}].as<\textcolor{keywordtype}{double}>());}
\DoxyCodeLine{00237\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}[i]\ =\ (param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}Error"{}}].as<\textcolor{keywordtype}{double}>());}
\DoxyCodeLine{00238\ }
\DoxyCodeLine{00239\ \ \ \ \ \textcolor{comment}{//ETA\ -\/\ a\ bit\ of\ a\ fudge\ but\ works}}
\DoxyCodeLine{00240\ \ \ \ \ std::vector<double>\ TempBoundsVec\ =\ param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}ParameterBounds"{}}].as<std::vector<double>>();}
\DoxyCodeLine{00241\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a8f1d94838f188cc85c4f82557c0b0b66}{\_fLowBound}}[i]\ =\ TempBoundsVec[0];}
\DoxyCodeLine{00242\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a31e636cb6de871bd0c2c8e7e299df9e7}{\_fUpBound}}[i]\ =\ TempBoundsVec[1];}
\DoxyCodeLine{00243\ }
\DoxyCodeLine{00244\ \ \ \ \ \textcolor{comment}{//ETA\ -\/\ now\ for\ parameters\ which\ are\ optional\ and\ have\ default\ values}}
\DoxyCodeLine{00245\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ad9c47deb7009bff81210f666e80012eb}{\_fFlatPrior}}[i]\ =\ GetFromManager<bool>(param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}FlatPrior"{}}],\ \textcolor{keyword}{false});}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \ \ \ \ \textcolor{comment}{//Fill\ the\ map\ to\ get\ the\ correlations\ later\ as\ well}}
\DoxyCodeLine{00248\ \ \ \ \ CorrNamesMap[param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}Names"{}}][\textcolor{stringliteral}{"{}FancyName"{}}].as<std::string>()]=i;}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00250\ \ \ \ \ \textcolor{comment}{//Also\ loop\ through\ the\ correlations}}
\DoxyCodeLine{00251\ \ \ \ \ \textcolor{keywordflow}{if}(param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}Correlations"{}}])\ \{}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ Corr\_i\ =\ 0;\ Corr\_i\ <\ param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}Correlations"{}}].size();\ ++Corr\_i)\{}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (YAML::const\_iterator\ it=param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}Correlations"{}}][Corr\_i].begin();it!=param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}Correlations"{}}][Corr\_i].end();++it)\ \{}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ Correlations[i][it-\/>first.as<std::string>()]\ =\ it-\/>second.as<\textcolor{keywordtype}{double}>();}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00257\ \ \ \ \ \}}
\DoxyCodeLine{00258\ \ \ \ \ i++;}
\DoxyCodeLine{00259\ \ \ \}}
\DoxyCodeLine{00260\ }
\DoxyCodeLine{00261\ \ \ \textcolor{comment}{//ETA}}
\DoxyCodeLine{00262\ \ \ \textcolor{comment}{//Now\ that\ we've\ been\ through\ all\ systematic\ let's\ fill\ the\ covmatrix}}
\DoxyCodeLine{00263\ \ \ \textcolor{comment}{//This\ makes\ the\ root\ TCov\ from\ YAML}}
\DoxyCodeLine{00264\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};j++)\ \{}
\DoxyCodeLine{00265\ \ \ \ \ (*\_fCovMatrix)(j,\ j)=\mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}[j]*\mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}[j];}
\DoxyCodeLine{00266\ \ \ \ \ \textcolor{comment}{//Get\ the\ map\ of\ parameter\ name\ to\ correlation\ from\ the\ Correlations\ object}}
\DoxyCodeLine{00267\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ pair\ :\ Correlations[j])\ \{}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ key\ =\ pair.first;}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keyword}{const}\&\ val\ =\ pair.second;}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ index\ =\ -\/1;}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \textcolor{comment}{//If\ you\ found\ the\ parameter\ name\ then\ get\ the\ index}}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (CorrNamesMap.find(key)\ !=\ CorrNamesMap.end())\ \{}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ index\ =\ CorrNamesMap[key];}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Parameter\ \{\}\ not\ in\ list!\ Check\ your\ spelling?"{}},\ key);}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ Corr1\ =\ val;}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ Corr2\ =\ 0;}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(Correlations[index].find(\mbox{\hyperlink{classcovarianceBase_a973671386a2f8ea924f25f8f5404654c}{\_fFancyNames}}[j])\ !=\ Correlations[index].end())\ \{}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ Corr2\ =\ Correlations[index][\mbox{\hyperlink{classcovarianceBase_a973671386a2f8ea924f25f8f5404654c}{\_fFancyNames}}[j]];}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Do\ they\ agree\ to\ better\ than\ float\ precision?}}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(std::abs(Corr2\ -\/\ Corr1)\ >\ FLT\_EPSILON)\ \{}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Correlations\ are\ not\ equal\ between\ \{\}\ and\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a973671386a2f8ea924f25f8f5404654c}{\_fFancyNames}}[j],\ key);}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Got\ :\ \{\}\ and\ \{\}"{}},\ Corr2,\ Corr1);}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Correlation\ does\ not\ appear\ reciprocally\ between\ \{\}\ and\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a973671386a2f8ea924f25f8f5404654c}{\_fFancyNames}}[j],\ key);}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00293\ \ \ \ \ \ \ (*\_fCovMatrix)(j,\ index)=\ (*\_fCovMatrix)(index,\ j)\ =\ Corr1*\mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}[j]*\mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}[index];}
\DoxyCodeLine{00294\ \ \ \ \ \}}
\DoxyCodeLine{00295\ \ \ \}}
\DoxyCodeLine{00296\ }
\DoxyCodeLine{00297\ \ \ \textcolor{comment}{//Now\ make\ positive\ definite}}
\DoxyCodeLine{00298\ \ \ \mbox{\hyperlink{classcovarianceBase_ae2850c8e2f2d4acfe322b0ebe65b07cf}{MakePosDef}}(\_fCovMatrix);}
\DoxyCodeLine{00299\ \ \ \mbox{\hyperlink{classcovarianceBase_a5f28f7294d25cca6334f7033a63596b9}{setCovMatrix}}(\_fCovMatrix);}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}\ <=\ 0)\ \{}
\DoxyCodeLine{00302\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Covariance\ object\ has\ \{\}\ systematics!"{}},\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{00303\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00304\ \ \ \}}
\DoxyCodeLine{00305\ \ \ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}}\ =\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00307\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Created\ covariance\ matrix\ from\ files:\ "{}});}
\DoxyCodeLine{00308\ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ \&file\ :\ YAMLFile)\{}
\DoxyCodeLine{00309\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\{\}\ "{}},\ file);}
\DoxyCodeLine{00310\ \ \ \}}
\DoxyCodeLine{00311\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/"{}});}
\DoxyCodeLine{00312\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Found\ \{\}\ systematics\ parameters\ in\ total"{}},\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{00313\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/"{}});}
\DoxyCodeLine{00314\ }
\DoxyCodeLine{00315\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00316\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a2960c489f6aafdb5a2291e1a48b14e9a}\label{classcovarianceBase_a2960c489f6aafdb5a2291e1a48b14e9a}} 
\index{covarianceBase@{covarianceBase}!init@{init}}
\index{init@{init}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{init()}{init()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily void covariance\+Base\+::init (\begin{DoxyParamCaption}\item[{std\+::string}]{name,  }\item[{std\+::string}]{file }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Initialisation of the class using matrix from root file. 



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00108}{108}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00109\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \ \ \textcolor{comment}{//\ Set\ the\ covariance\ matrix\ from\ input\ ROOT\ file\ (e.g.\ flux,\ ND280,\ NIWG)}}
\DoxyCodeLine{00112\ \ \ TFile\ *infile\ =\ \textcolor{keyword}{new}\ TFile(file.c\_str(),\ \textcolor{stringliteral}{"{}READ"{}});}
\DoxyCodeLine{00113\ \ \ \textcolor{keywordflow}{if}\ (infile-\/>IsZombie())\ \{}
\DoxyCodeLine{00114\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Could\ not\ open\ input\ covariance\ ROOT\ file\ \{\}\ !!!"{}},\ file);}
\DoxyCodeLine{00115\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Was\ about\ to\ retrieve\ matrix\ with\ name\ \{\}"{}},\ name);}
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00117\ \ \ \}}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ TMatrixDSym\ *CovMat\ =\ infile-\/>Get<TMatrixDSym>(name.c\_str());}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ \textcolor{keywordflow}{if}\ (CovMat\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00123\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Could\ not\ find\ covariance\ matrix\ name\ \{\}\ in\ file\ \{\}"{}},\ name,\ file);}
\DoxyCodeLine{00124\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Are\ you\ really\ sure\ \{\}\ exists\ in\ the\ file?"{}},\ name);}
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00126\ \ \ \}\ }
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00128\ \ \ \mbox{\hyperlink{classcovarianceBase_a8d821ce805f2426fe95549170866821f}{PrintLength}}\ =\ 35;}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nThreads\ =\ \mbox{\hyperlink{namespaceMaCh3Utils_a5aff908b9241c673e8d05403996e2229}{MaCh3Utils::GetNThreads}}();}
\DoxyCodeLine{00131\ \ \ \textcolor{comment}{//KS:\ set\ Random\ numbers\ for\ each\ thread\ so\ each\ thread\ has\ different\ seed}}
\DoxyCodeLine{00132\ \ \ \textcolor{comment}{//or\ for\ one\ thread\ if\ without\ MULTITHREAD}}
\DoxyCodeLine{00133\ \ \ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}\ =\ \textcolor{keyword}{new}\ TRandom3*[nThreads]();}
\DoxyCodeLine{00134\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ iThread\ =\ 0;\ iThread\ <\ nThreads;\ iThread++)\ \{}
\DoxyCodeLine{00135\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}[iThread]\ =\ \textcolor{keyword}{new}\ TRandom3(0);}
\DoxyCodeLine{00136\ \ \ \}}
\DoxyCodeLine{00137\ \ \ \textcolor{comment}{//\ Not\ using\ adaptive\ by\ default}}
\DoxyCodeLine{00138\ \ \ \mbox{\hyperlink{classcovarianceBase_a838731abd6716940043b484b2b266f86}{use\_adaptive}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00139\ \ \ \textcolor{comment}{//\ Set\ the\ covariance\ matrix}}
\DoxyCodeLine{00140\ \ \ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}\ =\ CovMat-\/>GetNrows();}
\DoxyCodeLine{00141\ \ \ \ \ }
\DoxyCodeLine{00142\ \ \ \mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}]();}
\DoxyCodeLine{00143\ \ \ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}]();}
\DoxyCodeLine{00144\ \ \ \textcolor{comment}{//\ Set\ the\ defaults\ to\ true}}
\DoxyCodeLine{00145\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)}
\DoxyCodeLine{00146\ \ \ \{}
\DoxyCodeLine{00147\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}}[i]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}]();}
\DoxyCodeLine{00148\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}}[i]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}]();}
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ j++)}
\DoxyCodeLine{00150\ \ \ \ \ \{}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}}[i][j]\ =\ 0.;}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}}[i][j]\ =\ 0.;}
\DoxyCodeLine{00153\ \ \ \ \ \}}
\DoxyCodeLine{00154\ \ \ \}}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \ \ \mbox{\hyperlink{classcovarianceBase_a9f980a259c5952f9ca907832f99ad2a7}{setName}}(name);}
\DoxyCodeLine{00157\ \ \ \mbox{\hyperlink{classcovarianceBase_ae2850c8e2f2d4acfe322b0ebe65b07cf}{MakePosDef}}(CovMat);}
\DoxyCodeLine{00158\ \ \ \mbox{\hyperlink{classcovarianceBase_a5f28f7294d25cca6334f7033a63596b9}{setCovMatrix}}(CovMat);}
\DoxyCodeLine{00159\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}\ <=\ 0)\ \{}
\DoxyCodeLine{00160\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a07ff6d6a15b24f94afc88a1b89779beb}{MACH3LOG\_CRITICAL}}(\textcolor{stringliteral}{"{}Covariance\ matrix\ \{\}\ has\ \{\}\ entries!"{}},\ \mbox{\hyperlink{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}{getName}}(),\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{00161\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00162\ \ \ \}}
\DoxyCodeLine{00163\ \ \ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}}\ =\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \ \ \mbox{\hyperlink{classcovarianceBase_a75b5553823335bb82026ff46369fb67e}{ReserveMemory}}(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \ \ infile-\/>Close();}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Created\ covariance\ matrix\ named:\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}{getName}}());}
\DoxyCodeLine{00170\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}from\ file:\ \{\}"{}},\ file);}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \ \ \textcolor{keyword}{delete}\ infile;}
\DoxyCodeLine{00173\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_ab5141e2014519c1483788f4995686164}\label{classcovarianceBase_ab5141e2014519c1483788f4995686164}} 
\index{covarianceBase@{covarianceBase}!init@{init}}
\index{init@{init}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{init()}{init()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily void covariance\+Base\+::init (\begin{DoxyParamCaption}\item[{TMatrix\+DSym $\ast$}]{cov\+Mat }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Initialisation of the class using only TMatrix. 



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00319}{319}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00320\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00321\ \ \ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}\ =\ covMat-\/>GetNrows();}
\DoxyCodeLine{00322\ \ \ \mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}]();}
\DoxyCodeLine{00323\ \ \ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}*[\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}]();}
\DoxyCodeLine{00324\ \ \ \textcolor{comment}{//\ Set\ the\ defaults\ to\ true}}
\DoxyCodeLine{00325\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)}
\DoxyCodeLine{00326\ \ \ \{}
\DoxyCodeLine{00327\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}}[i]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}]();}
\DoxyCodeLine{00328\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}}[i]\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}]();}
\DoxyCodeLine{00329\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ j++)}
\DoxyCodeLine{00330\ \ \ \ \ \{}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}}[i][j]\ =\ 0.;}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}}[i][j]\ =\ 0.;}
\DoxyCodeLine{00333\ \ \ \ \ \}}
\DoxyCodeLine{00334\ \ \ \}}
\DoxyCodeLine{00335\ }
\DoxyCodeLine{00336\ \ \ \mbox{\hyperlink{classcovarianceBase_a838731abd6716940043b484b2b266f86}{use\_adaptive}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00337\ \ \ \mbox{\hyperlink{classcovarianceBase_a5f28f7294d25cca6334f7033a63596b9}{setCovMatrix}}(covMat);}
\DoxyCodeLine{00338\ }
\DoxyCodeLine{00339\ \ \ \mbox{\hyperlink{classcovarianceBase_a75b5553823335bb82026ff46369fb67e}{ReserveMemory}}(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{00340\ }
\DoxyCodeLine{00341\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Created\ covariance\ matrix\ named:\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}{getName}}());}
\DoxyCodeLine{00342\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a715900cc67fcc598090399ee931938e9}\label{classcovarianceBase_a715900cc67fcc598090399ee931938e9}} 
\index{covarianceBase@{covarianceBase}!initialiseAdaption@{initialiseAdaption}}
\index{initialiseAdaption@{initialiseAdaption}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{initialiseAdaption()}{initialiseAdaption()}}
{\footnotesize\ttfamily void covariance\+Base\+::initialise\+Adaption (\begin{DoxyParamCaption}\item[{const YAML\+::\+Node \&}]{adapt\+\_\+manager }\end{DoxyParamCaption})}



Initialise adaptive MCMC. 


\begin{DoxyParams}{Parameters}
{\em adapt\+\_\+manager} & Node having from which we load all adaptation options \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l01202}{1202}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01203\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{01204\ \ \ \textcolor{comment}{//\ need\ to\ cast\ matrixName\ to\ string}}
\DoxyCodeLine{01205\ \ \ std::string\ matrix\_name\_str(\mbox{\hyperlink{classcovarianceBase_a26618d3f5633b33ce20e38ce8261b3ee}{matrixName}});}
\DoxyCodeLine{01206\ }
\DoxyCodeLine{01207\ \ \ \textcolor{comment}{//\ Now\ we\ read\ the\ general\ settings\ [these\ SHOULD\ be\ common\ across\ all\ matrices!]}}
\DoxyCodeLine{01208\ \ \ \textcolor{keywordtype}{bool}\ success\ =\ \mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_a192304475bc377ef975ef40d2bd2b254}{InitFromConfig}}(adapt\_manager,\ matrix\_name\_str,\ \mbox{\hyperlink{classcovarianceBase_a261941a4c06e5d875174d8769a4d02f1}{getNpars}}());}
\DoxyCodeLine{01209\ \ \ \textcolor{keywordflow}{if}(!success)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01210\ \ \ \mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_a5997a813faf68d891c62cbaf65984aca}{Print}}();}
\DoxyCodeLine{01211\ }
\DoxyCodeLine{01212\ \ \ \textcolor{comment}{//\ Next\ let"{}s\ check\ for\ external\ matrices}}
\DoxyCodeLine{01213\ \ \ \textcolor{comment}{//\ We"{}re\ going\ to\ grab\ this\ info\ from\ the\ YAML\ manager}}
\DoxyCodeLine{01214\ \ \ \textcolor{keywordflow}{if}(!GetFromManager<bool>(adapt\_manager[\textcolor{stringliteral}{"{}AdaptionOptions"{}}][\textcolor{stringliteral}{"{}Covariance"{}}][matrix\_name\_str][\textcolor{stringliteral}{"{}UseExternalMatrix"{}}],\ \textcolor{keyword}{false}))\ \{}
\DoxyCodeLine{01215\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Not\ using\ external\ matrix\ for\ \{\},\ initialising\ adaption\ from\ scratch"{}},\ matrix\_name\_str);}
\DoxyCodeLine{01216\ \ \ \ \ \textcolor{comment}{//\ If\ we\ don't\ have\ a\ covariance\ matrix\ to\ start\ from\ for\ adaptive\ tune\ we\ need\ to\ make\ one!}}
\DoxyCodeLine{01217\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a838731abd6716940043b484b2b266f86}{use\_adaptive}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01218\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_ad7df80045651df99c2d1c375fea4ac74}{CreateNewAdaptiveCovariance}}(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{01219\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01220\ \ \ \}}
\DoxyCodeLine{01221\ }
\DoxyCodeLine{01222\ \ \ \textcolor{comment}{//\ Finally,\ we\ accept\ that\ we\ want\ to\ read\ the\ matrix\ from\ a\ file!}}
\DoxyCodeLine{01223\ \ \ std::string\ external\_file\_name\ =\ GetFromManager<std::string>(adapt\_manager[\textcolor{stringliteral}{"{}AdaptionOptions"{}}][\textcolor{stringliteral}{"{}Covariance"{}}][matrix\_name\_str][\textcolor{stringliteral}{"{}ExternalMatrixFileName"{}}],\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{01224\ \ \ std::string\ external\_matrix\_name\ =\ GetFromManager<std::string>(adapt\_manager[\textcolor{stringliteral}{"{}AdaptionOptions"{}}][\textcolor{stringliteral}{"{}Covariance"{}}][matrix\_name\_str][\textcolor{stringliteral}{"{}ExternalMatrixName"{}}],\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{01225\ \ \ std::string\ external\_mean\_name\ =\ GetFromManager<std::string>(adapt\_manager[\textcolor{stringliteral}{"{}AdaptionOptions"{}}][\textcolor{stringliteral}{"{}Covariance"{}}][matrix\_name\_str][\textcolor{stringliteral}{"{}ExternalMeansName"{}}],\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{01226\ }
\DoxyCodeLine{01227\ \ \ \mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_aebd1df26766a9f106fe6ce4255ceb0d9}{SetThrowMatrixFromFile}}(external\_file\_name,\ external\_matrix\_name,\ external\_mean\_name,\ \mbox{\hyperlink{classcovarianceBase_a838731abd6716940043b484b2b266f86}{use\_adaptive}},\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{01228\ \ \ \mbox{\hyperlink{classcovarianceBase_af30ca7861452e1446e55700f4b49b608}{setThrowMatrix}}(\mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_afd61e64f18f5c25dbbd6bb2bd619a268}{adaptive\_covariance}});}
\DoxyCodeLine{01229\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Successfully\ Set\ External\ Throw\ Matrix\ Stored\ in\ \{\}"{}},\ external\_file\_name);}
\DoxyCodeLine{01230\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a2424eaebd9daa92b0294b352310770a3}\label{classcovarianceBase_a2424eaebd9daa92b0294b352310770a3}} 
\index{covarianceBase@{covarianceBase}!isParameterFixed@{isParameterFixed}}
\index{isParameterFixed@{isParameterFixed}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{isParameterFixed()}{isParameterFixed()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily bool covariance\+Base\+::is\+Parameter\+Fixed (\begin{DoxyParamCaption}\item[{const int}]{i }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Is parameter fixed or not. 


\begin{DoxyParams}{Parameters}
{\em i} & Parameter index \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00319}{319}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00320\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}[i]\ <\ 0)\ \{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};\ \}}
\DoxyCodeLine{00321\ \ \ \ \ \textcolor{keywordflow}{else}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};\ \}}
\DoxyCodeLine{00322\ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a1a0ed90bcbc2f932c7a32d26090edbbb}\label{classcovarianceBase_a1a0ed90bcbc2f932c7a32d26090edbbb}} 
\index{covarianceBase@{covarianceBase}!isParameterFixed@{isParameterFixed}}
\index{isParameterFixed@{isParameterFixed}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{isParameterFixed()}{isParameterFixed()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily bool covariance\+Base\+::is\+Parameter\+Fixed (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{name }\end{DoxyParamCaption})}



Is parameter fixed or not. 


\begin{DoxyParams}{Parameters}
{\em name} & Name of parameter you want to check if is fixed \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00992}{992}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00992\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00993\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00994\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{00995\ \ \ \ \ \textcolor{keywordflow}{if}(name\ ==\ \mbox{\hyperlink{classcovarianceBase_a973671386a2f8ea924f25f8f5404654c}{\_fFancyNames}}[i])\ \{}
\DoxyCodeLine{00996\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_a2424eaebd9daa92b0294b352310770a3}{isParameterFixed}}(i);}
\DoxyCodeLine{00997\ \ \ \ \ \}}
\DoxyCodeLine{00998\ \ \ \}}
\DoxyCodeLine{00999\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}I\ couldn't\ find\ parameter\ with\ name\ \{\},\ therefore\ will\ not\ fix\ it"{}},\ name);}
\DoxyCodeLine{01000\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01001\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_ab7cb212b7fda7f402629855b58a69cec}\label{classcovarianceBase_ab7cb212b7fda7f402629855b58a69cec}} 
\index{covarianceBase@{covarianceBase}!isParameterFixedPCA@{isParameterFixedPCA}}
\index{isParameterFixedPCA@{isParameterFixedPCA}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{isParameterFixedPCA()}{isParameterFixedPCA()}}
{\footnotesize\ttfamily bool covariance\+Base\+::is\+Parameter\+Fixed\+PCA (\begin{DoxyParamCaption}\item[{const int}]{i }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Is parameter fixed in PCA base or not. 


\begin{DoxyParams}{Parameters}
{\em i} & Parameter index \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00230}{230}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00231\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a7b83a17de68cc7838b93de242d91d9a0}{fParSigma\_PCA}}[i]\ <\ 0)\ \{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};\ \ \}}
\DoxyCodeLine{00232\ \ \ \ \ \textcolor{keywordflow}{else}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};\ \}}
\DoxyCodeLine{00233\ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a30f3f34243be0f6bc901e525497e7f56}\label{classcovarianceBase_a30f3f34243be0f6bc901e525497e7f56}} 
\index{covarianceBase@{covarianceBase}!IsPCA@{IsPCA}}
\index{IsPCA@{IsPCA}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{IsPCA()}{IsPCA()}}
{\footnotesize\ttfamily bool covariance\+Base\+::\+Is\+PCA (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



is PCA, can use to query e.\+g. LLH scans 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00332}{332}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00332\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}};\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a8a709e1c6c58618cf65400eef1741cc7}\label{classcovarianceBase_a8a709e1c6c58618cf65400eef1741cc7}} 
\index{covarianceBase@{covarianceBase}!makeClosestPosDef@{makeClosestPosDef}}
\index{makeClosestPosDef@{makeClosestPosDef}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{makeClosestPosDef()}{makeClosestPosDef()}}
{\footnotesize\ttfamily void covariance\+Base\+::make\+Closest\+Pos\+Def (\begin{DoxyParamCaption}\item[{TMatrix\+DSym $\ast$}]{cov }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



HW\+: Finds closest possible positive definite matrix in Frobenius Norm $\vert$$\vert$.$\vert$$\vert$\+\_\+frob Where $\vert$$\vert$\+X$\vert$$\vert$\+\_\+frob=sqrt\mbox{[}sum\+\_\+ij(x\+\_\+ij$^\wedge$2)\mbox{]} (basically just turns an n,n matrix into vector in n$^\wedge$2 space then does Euclidean norm) 



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l01261}{1261}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01262\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{01263\ }
\DoxyCodeLine{01264\ \ \ \textcolor{comment}{//\ Want\ to\ get\ cov'\ =\ (cov\_sym+cov\_polar)/2}}
\DoxyCodeLine{01265\ \ \ \textcolor{comment}{//\ cov\_sym=(cov+cov\string^T)/2}}
\DoxyCodeLine{01266\ \ \ \textcolor{comment}{//\ cov\_polar-\/>\ SVD\ cov\ to\ cov=USV\string^T\ then\ cov\_polar=VSV\string^T}}
\DoxyCodeLine{01267\ }
\DoxyCodeLine{01268\ \ \ \textcolor{comment}{//Get\ frob\ norm\ of\ cov}}
\DoxyCodeLine{01269\ \ \ \textcolor{comment}{//\ \ Double\_t\ cov\_norm=cov-\/>E2Norm();}}
\DoxyCodeLine{01270\ \ \ }
\DoxyCodeLine{01271\ \ \ TMatrixDSym*\ cov\_trans\ =\ cov;}
\DoxyCodeLine{01272\ \ \ cov\_trans-\/>T();}
\DoxyCodeLine{01273\ \ \ TMatrixDSym\ cov\_sym\ =\ 0.5*(*cov+*cov\_trans);\ \textcolor{comment}{//If\ cov\ is\ symmetric\ does\ nothing,\ otherwise\ just\ ensures\ symmetry}}
\DoxyCodeLine{01274\ }
\DoxyCodeLine{01275\ \ \ \textcolor{comment}{//Do\ SVD\ to\ get\ polar\ form}}
\DoxyCodeLine{01276\ \ \ TDecompSVD\ cov\_sym\_svd=TDecompSVD(cov\_sym);}
\DoxyCodeLine{01277\ \ \ \textcolor{keywordflow}{if}(!cov\_sym\_svd.Decompose())\{}
\DoxyCodeLine{01278\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Cannot\ do\ SVD\ on\ input\ matrix!"{}});}
\DoxyCodeLine{01279\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{01280\ \ \ \}}
\DoxyCodeLine{01281\ \ \ }
\DoxyCodeLine{01282\ }
\DoxyCodeLine{01283\ \ \ TMatrixD\ cov\_sym\_v\ =\ cov\_sym\_svd.GetV();}
\DoxyCodeLine{01284\ \ \ TMatrixD\ cov\_sym\_vt\ =\ cov\_sym\_v;}
\DoxyCodeLine{01285\ \ \ cov\_sym\_vt.T();}
\DoxyCodeLine{01286\ \ \ \textcolor{comment}{//SVD\ returns\ as\ vector\ (grrr)\ so\ need\ to\ get\ into\ matrix\ form\ for\ multiplying!}}
\DoxyCodeLine{01287\ \ \ TVectorD\ cov\_sym\_sigvect\ =\ cov\_sym\_svd.GetSig();}
\DoxyCodeLine{01288\ }
\DoxyCodeLine{01289\ \ \ \textcolor{keyword}{const}\ Int\_t\ nCols\ =\ cov\_sym\_v.GetNcols();\ \textcolor{comment}{//square\ so\ only\ need\ rows\ hence\ lack\ of\ cols}}
\DoxyCodeLine{01290\ \ \ TMatrixDSym\ cov\_sym\_sig(nCols);}
\DoxyCodeLine{01291\ \ \ TMatrixDDiag\ cov\_sym\_sig\_diag(cov\_sym\_sig);}
\DoxyCodeLine{01292\ \ \ cov\_sym\_sig\_diag=cov\_sym\_sigvect;}
\DoxyCodeLine{01293\ }
\DoxyCodeLine{01294\ \ \ \textcolor{comment}{//Can\ finally\ get\ H=VSV}}
\DoxyCodeLine{01295\ \ \ TMatrixDSym\ cov\_sym\_polar\ =\ cov\_sym\_sig.SimilarityT(cov\_sym\_vt);\textcolor{comment}{//V*S*V\string^T\ (this\ took\ forver\ to\ find!)}}
\DoxyCodeLine{01296\ \ \ }
\DoxyCodeLine{01297\ \ \ \textcolor{comment}{//Now\ we\ can\ construct\ closest\ approximater\ Ahat=0.5*(B+H)}}
\DoxyCodeLine{01298\ \ \ TMatrixDSym\ cov\_closest\_approx\ \ =\ 0.5*(cov\_sym+cov\_sym\_polar);\textcolor{comment}{//Not\ fully\ sure\ why\ this\ is\ even\ needed\ since\ symmetric\ B\ -\/>\ U=V}}
\DoxyCodeLine{01299\ \ \ \textcolor{comment}{//Get\ norm\ of\ transformed}}
\DoxyCodeLine{01300\ \ \ \textcolor{comment}{//\ \ Double\_t\ approx\_norm=cov\_closest\_approx.E2Norm();}}
\DoxyCodeLine{01301\ \ \ \textcolor{comment}{//MACH3LOG\_INFO("{}Initial\ Norm:\ \{:.6f\}\ |\ Norm\ after\ transformation:\ \{:.6f\}\ |\ Ratio:\ \{:.6f\}"{},\ cov\_norm,\ approx\_norm,\ cov\_norm\ /\ approx\_norm);}}
\DoxyCodeLine{01302\ \ \ }
\DoxyCodeLine{01303\ \ \ *cov\ =\ cov\_closest\_approx;}
\DoxyCodeLine{01304\ \ \ \textcolor{comment}{//Now\ can\ just\ add\ a\ makeposdef!}}
\DoxyCodeLine{01305\ \ \ \mbox{\hyperlink{classcovarianceBase_ae2850c8e2f2d4acfe322b0ebe65b07cf}{MakePosDef}}(cov);}
\DoxyCodeLine{01306\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_ae2850c8e2f2d4acfe322b0ebe65b07cf}\label{classcovarianceBase_ae2850c8e2f2d4acfe322b0ebe65b07cf}} 
\index{covarianceBase@{covarianceBase}!MakePosDef@{MakePosDef}}
\index{MakePosDef@{MakePosDef}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{MakePosDef()}{MakePosDef()}}
{\footnotesize\ttfamily void covariance\+Base\+::\+Make\+Pos\+Def (\begin{DoxyParamCaption}\item[{TMatrix\+DSym $\ast$}]{cov = {\ttfamily nullptr} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Make matrix positive definite by adding small values to diagonal, necessary for inverting matrix. 


\begin{DoxyParams}{Parameters}
{\em cov} & Matrix which we evaluate Positive Definitiveness \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l01090}{1090}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01091\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{01092\ \ \ \textcolor{comment}{//DB\ Save\ original\ warning\ state\ and\ then\ increase\ it\ in\ this\ function\ to\ suppress\ 'matrix\ not\ positive\ definite'\ messages}}
\DoxyCodeLine{01093\ \ \ \textcolor{comment}{//Means\ we\ no\ longer\ need\ to\ overload}}
\DoxyCodeLine{01094\ \ \ \textcolor{keywordflow}{if}(cov\ ==\ \textcolor{keyword}{nullptr})\{}
\DoxyCodeLine{01095\ \ \ \ \ cov\ =\ \&*\mbox{\hyperlink{classcovarianceBase_a6c3fe8db34c06299fd1633951ac00937}{covMatrix}};}
\DoxyCodeLine{01096\ \ \ \}}
\DoxyCodeLine{01097\ }
\DoxyCodeLine{01098\ \ \ \textcolor{keywordtype}{int}\ originalErrorWarning\ =\ gErrorIgnoreLevel;}
\DoxyCodeLine{01099\ \ \ gErrorIgnoreLevel\ =\ kFatal;}
\DoxyCodeLine{01100\ \ \ }
\DoxyCodeLine{01101\ \ \ \textcolor{comment}{//DB\ Loop\ 1000\ times\ adding\ 1e-\/9\ which\ tops\ out\ at\ 1e-\/6\ shift\ on\ the\ diagonal\ before\ throwing\ error}}
\DoxyCodeLine{01102\ \ \ \textcolor{keywordtype}{int}\ MaxAttempts\ =\ 1e5;}
\DoxyCodeLine{01103\ \ \ \textcolor{keywordtype}{int}\ iAttempt\ =\ 0;}
\DoxyCodeLine{01104\ \ \ \textcolor{keywordtype}{bool}\ CanDecomp\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01105\ \ \ TDecompChol\ chdcmp;}
\DoxyCodeLine{01106\ \ \ }
\DoxyCodeLine{01107\ \ \ \textcolor{keywordflow}{for}\ (iAttempt\ =\ 0;\ iAttempt\ <\ MaxAttempts;\ iAttempt++)\ \{}
\DoxyCodeLine{01108\ \ \ \ \ chdcmp\ =\ TDecompChol(*cov);}
\DoxyCodeLine{01109\ \ \ \ \ \textcolor{keywordflow}{if}\ (chdcmp.Decompose())\ \{}
\DoxyCodeLine{01110\ \ \ \ \ \ \ CanDecomp\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01111\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01112\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01113\ \textcolor{preprocessor}{\ \ \ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{01114\ \textcolor{preprocessor}{\ \ \ \ \ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{01115\ \textcolor{preprocessor}{\ \ \ \ \ \ \#endif}}
\DoxyCodeLine{01116\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ iVar\ =\ 0\ ;\ iVar\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ iVar++)\ \{}
\DoxyCodeLine{01117\ \ \ \ \ \ \ \ \ (*cov)(iVar,iVar)\ +=\ pow(10,-\/9);}
\DoxyCodeLine{01118\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01119\ \ \ \ \ \}}
\DoxyCodeLine{01120\ \ \ \}}
\DoxyCodeLine{01121\ }
\DoxyCodeLine{01122\ \ \ \textcolor{keywordflow}{if}\ (!CanDecomp)\ \{}
\DoxyCodeLine{01123\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Tried\ \{\}\ times\ to\ shift\ diagonal\ but\ still\ can\ not\ decompose\ the\ matrix"{}},\ MaxAttempts);}
\DoxyCodeLine{01124\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}This\ indicates\ that\ something\ is\ wrong\ with\ the\ input\ matrix"{}});}
\DoxyCodeLine{01125\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{01126\ \ \ \}}
\DoxyCodeLine{01127\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_ab2837af4566e2d62db7b76f9527fb6d7}{total\_steps}}\ <\ 2)\ \{}
\DoxyCodeLine{01128\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Had\ to\ shift\ diagonal\ \{\}\ time(s)\ to\ allow\ the\ covariance\ matrix\ to\ be\ decomposed"{}},\ iAttempt);}
\DoxyCodeLine{01129\ \ \ \}}
\DoxyCodeLine{01130\ \ \ \textcolor{comment}{//DB\ Resetting\ warning\ level}}
\DoxyCodeLine{01131\ \ \ gErrorIgnoreLevel\ =\ originalErrorWarning;}
\DoxyCodeLine{01132\ }
\DoxyCodeLine{01133\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01134\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a64aaa71f81750ba27977c0405c51cd88}\label{classcovarianceBase_a64aaa71f81750ba27977c0405c51cd88}} 
\index{covarianceBase@{covarianceBase}!MatrixVectorMulti@{MatrixVectorMulti}}
\index{MatrixVectorMulti@{MatrixVectorMulti}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{MatrixVectorMulti()}{MatrixVectorMulti()}}
{\footnotesize\ttfamily void covariance\+Base\+::\+Matrix\+Vector\+Multi (\begin{DoxyParamCaption}\item[{double $\ast$\mbox{\hyperlink{Structs_8h_ab6a7e23420f0bcfb04f42f45f8283101}{\+\_\+restrict\+\_\+}}}]{Vec\+Multi,  }\item[{double $\ast$$\ast$\mbox{\hyperlink{Structs_8h_ab6a7e23420f0bcfb04f42f45f8283101}{\+\_\+restrict\+\_\+}}}]{matrix,  }\item[{const double $\ast$\mbox{\hyperlink{Structs_8h_ab6a7e23420f0bcfb04f42f45f8283101}{\+\_\+restrict\+\_\+}}}]{vector,  }\item[{const int}]{n }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



KS\+: Custom function to perform multiplication of matrix and vector with multithreading. 


\begin{DoxyParams}{Parameters}
{\em Vec\+Multi} & Output Vector, Vec\+Multi = matrix x vector \\
\hline
{\em matrix} & This matrix is used for multiplication Vec\+Multi = matrix x vector \\
\hline
{\em Vec\+Multi} & This vector is used for multiplication Vec\+Multi = matrix x vector \\
\hline
{\em n} & this is size of matrix and vector, we assume matrix is symmetric \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l01024}{1024}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01024\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01025\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{01026\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{01027\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{01028\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{01029\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n;\ ++i)}
\DoxyCodeLine{01030\ \ \ \{}
\DoxyCodeLine{01031\ \ \ \ \ \textcolor{keywordtype}{double}\ result\ =\ 0.0;}
\DoxyCodeLine{01032\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{01033\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ simd}}
\DoxyCodeLine{01034\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{01035\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ n;\ ++j)}
\DoxyCodeLine{01036\ \ \ \ \ \{}
\DoxyCodeLine{01037\ \ \ \ \ \ \ result\ +=\ matrix[i][j]*vector[j];}
\DoxyCodeLine{01038\ \ \ \ \ \}}
\DoxyCodeLine{01039\ \ \ \ \ VecMulti[i]\ =\ result;}
\DoxyCodeLine{01040\ \ \ \}}
\DoxyCodeLine{01041\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a767242ffde1e52dff143889e5534b4e3}\label{classcovarianceBase_a767242ffde1e52dff143889e5534b4e3}} 
\index{covarianceBase@{covarianceBase}!MatrixVectorMultiSingle@{MatrixVectorMultiSingle}}
\index{MatrixVectorMultiSingle@{MatrixVectorMultiSingle}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{MatrixVectorMultiSingle()}{MatrixVectorMultiSingle()}}
{\footnotesize\ttfamily double covariance\+Base\+::\+Matrix\+Vector\+Multi\+Single (\begin{DoxyParamCaption}\item[{double $\ast$$\ast$\mbox{\hyperlink{Structs_8h_ab6a7e23420f0bcfb04f42f45f8283101}{\+\_\+restrict\+\_\+}}}]{matrix,  }\item[{const double $\ast$\mbox{\hyperlink{Structs_8h_ab6a7e23420f0bcfb04f42f45f8283101}{\+\_\+restrict\+\_\+}}}]{vector,  }\item[{const int}]{Length,  }\item[{const int}]{i }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



KS\+: Custom function to perform multiplication of matrix and single element which is thread safe. 



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l01044}{1044}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01044\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01045\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{01046\ }
\DoxyCodeLine{01047\ \ \ \textcolor{keywordtype}{double}\ Element\ =\ 0.0;}
\DoxyCodeLine{01048\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{01049\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ simd}}
\DoxyCodeLine{01050\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{01051\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ Length;\ ++j)\ \{}
\DoxyCodeLine{01052\ \ \ \ \ Element\ +=\ matrix[i][j]*vector[j];}
\DoxyCodeLine{01053\ \ \ \}}
\DoxyCodeLine{01054\ \ \ \textcolor{keywordflow}{return}\ Element;}
\DoxyCodeLine{01055\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_ad3c0dddbedcf57f06a14ec52800a087b}\label{classcovarianceBase_ad3c0dddbedcf57f06a14ec52800a087b}} 
\index{covarianceBase@{covarianceBase}!printIndivStepScale@{printIndivStepScale}}
\index{printIndivStepScale@{printIndivStepScale}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{printIndivStepScale()}{printIndivStepScale()}}
{\footnotesize\ttfamily void covariance\+Base\+::print\+Indiv\+Step\+Scale (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Print step scale for each parameter. 



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l01078}{1078}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01079\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{01080\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}============================================================"{}});}
\DoxyCodeLine{01081\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\{:<\{\}\}\ |\ \{:<11\}"{}},\ \textcolor{stringliteral}{"{}Parameter:"{}},\ \mbox{\hyperlink{classcovarianceBase_a8d821ce805f2426fe95549170866821f}{PrintLength}},\ \textcolor{stringliteral}{"{}Step\ scale:"{}});}
\DoxyCodeLine{01082\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ iParam\ =\ 0;\ iParam\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ iParam++)\ \{}
\DoxyCodeLine{01083\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\{:<\{\}\}\ |\ \{:<11\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}[iParam].c\_str(),\ \mbox{\hyperlink{classcovarianceBase_a8d821ce805f2426fe95549170866821f}{PrintLength}},\ \mbox{\hyperlink{classcovarianceBase_a3cda39026e336a49cef482efd4062561}{\_fIndivStepScale}}[iParam]);}
\DoxyCodeLine{01084\ \ \ \}}
\DoxyCodeLine{01085\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}============================================================"{}});}
\DoxyCodeLine{01086\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_aebd37baf2d6551863d810bea83c73020}\label{classcovarianceBase_aebd37baf2d6551863d810bea83c73020}} 
\index{covarianceBase@{covarianceBase}!printNominal@{printNominal}}
\index{printNominal@{printNominal}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{printNominal()}{printNominal()}}
{\footnotesize\ttfamily void covariance\+Base\+::print\+Nominal (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Print nominal value for every parameter. 



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00769}{769}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00769\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00770\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00771\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Prior\ values\ for\ \{\}\ covarianceBase:"{}},\ \mbox{\hyperlink{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}{getName}}());}
\DoxyCodeLine{00772\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)\ \{}
\DoxyCodeLine{00773\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\ \ \ \ \{\}\ \ \ \{\}\ "{}},\ \mbox{\hyperlink{classcovarianceBase_a6a46b5fed3e7feb6e9e151e90927bdbc}{GetParFancyName}}(i),\ \mbox{\hyperlink{classcovarianceBase_a1cede85accaac2ea7056740893d90c49}{getParInit}}(i));}
\DoxyCodeLine{00774\ \ \ \}}
\DoxyCodeLine{00775\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a732268706d083b6ae4495e34e703bbda}\label{classcovarianceBase_a732268706d083b6ae4495e34e703bbda}} 
\index{covarianceBase@{covarianceBase}!printNominalCurrProp@{printNominalCurrProp}}
\index{printNominalCurrProp@{printNominalCurrProp}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{printNominalCurrProp()}{printNominalCurrProp()}}
{\footnotesize\ttfamily void covariance\+Base\+::print\+Nominal\+Curr\+Prop (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Print nominal, current and proposed value for each parameter. 



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00779}{779}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00779\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00780\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00781\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Printing\ parameters\ for\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}{getName}}());}
\DoxyCodeLine{00782\ \ \ \textcolor{comment}{//\ Dump\ out\ the\ PCA\ parameters\ too}}
\DoxyCodeLine{00783\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{}
\DoxyCodeLine{00784\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}PCA:"{}});}
\DoxyCodeLine{00785\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}};\ ++i)\ \{}
\DoxyCodeLine{00786\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}PCA\ \{:<2\}\ Current:\ \{:<10.2f\}\ Proposed:\ \{:<10.2f\}"{}},\ i,\ \mbox{\hyperlink{classcovarianceBase_aa96f87ab90dc26fc1b5e157149b9dfd3}{fParCurr\_PCA}}(i),\ \mbox{\hyperlink{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}{fParProp\_PCA}}(i));}
\DoxyCodeLine{00787\ \ \ \ \ \}}
\DoxyCodeLine{00788\ \ \ \}}
\DoxyCodeLine{00789\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\{:<30\}\ \{:<10\}\ \{:<10\}\ \{:<10\}"{}},\ \textcolor{stringliteral}{"{}Name"{}},\ \textcolor{stringliteral}{"{}Prior"{}},\ \textcolor{stringliteral}{"{}Current"{}},\ \textcolor{stringliteral}{"{}Proposed"{}});}
\DoxyCodeLine{00790\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{00791\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\{:<30\}\ \{:<10.2f\}\ \{:<10.2f\}\ \{:<10.2f\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a6a46b5fed3e7feb6e9e151e90927bdbc}{GetParFancyName}}(i),\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i],\ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i],\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]);}
\DoxyCodeLine{00792\ \ \ \}}
\DoxyCodeLine{00793\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_ac1ff984cbc1b7858af9dd237cc1648d3}\label{classcovarianceBase_ac1ff984cbc1b7858af9dd237cc1648d3}} 
\index{covarianceBase@{covarianceBase}!printPars@{printPars}}
\index{printPars@{printPars}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{printPars()}{printPars()}}
{\footnotesize\ttfamily void covariance\+Base\+::print\+Pars (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00850}{850}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00850\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00851\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00852\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Number\ of\ pars:\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{00853\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Current\ \{\}\ parameters:"{}},\ \mbox{\hyperlink{classcovarianceBase_a26618d3f5633b33ce20e38ce8261b3ee}{matrixName}});}
\DoxyCodeLine{00854\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)\ \{}
\DoxyCodeLine{00855\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\{:s\}\ current:\ \(\backslash\)t\{:.5f\}\ \ \ \(\backslash\)tproposed:\ \(\backslash\)t\{:.5f\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}[i],\ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i],\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]);}
\DoxyCodeLine{00856\ \ \ \}}
\DoxyCodeLine{00857\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00858\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a95c7ca23995af579cfa7f199833fe24a}\label{classcovarianceBase_a95c7ca23995af579cfa7f199833fe24a}} 
\index{covarianceBase@{covarianceBase}!proposeStep@{proposeStep}}
\index{proposeStep@{proposeStep}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{proposeStep()}{proposeStep()}}
{\footnotesize\ttfamily void covariance\+Base\+::propose\+Step (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Generate a new proposed state. 



Reimplemented in \mbox{\hyperlink{classcovarianceOsc_abb8df24417b380af9b96763b8abc6b2e}{covariance\+Osc}}.



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00583}{583}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00583\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00584\ \textcolor{comment}{//\ ************************************************}}
\DoxyCodeLine{00585\ \ \ \textcolor{comment}{//\ Make\ the\ random\ numbers\ for\ the\ step\ proposal}}
\DoxyCodeLine{00586\ \ \ \mbox{\hyperlink{classcovarianceBase_a3432b7a9acc1243b8bdb17ec0b40d195}{randomize}}();}
\DoxyCodeLine{00587\ \ \ \mbox{\hyperlink{classcovarianceBase_aba2b2dae2546299c9a4dab618d65e7c0}{CorrelateSteps}}();}
\DoxyCodeLine{00588\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classcovarianceBase_a838731abd6716940043b484b2b266f86}{use\_adaptive}})\ \mbox{\hyperlink{classcovarianceBase_a50ce8ebb96ebd64190dc37e4bf950a9b}{updateAdaptiveCovariance}}();}
\DoxyCodeLine{00589\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a867bff214af25bba68f921eaea8b5cdd}\label{classcovarianceBase_a867bff214af25bba68f921eaea8b5cdd}} 
\index{covarianceBase@{covarianceBase}!RandomConfiguration@{RandomConfiguration}}
\index{RandomConfiguration@{RandomConfiguration}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{RandomConfiguration()}{RandomConfiguration()}}
{\footnotesize\ttfamily void covariance\+Base\+::\+Random\+Configuration (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Randomly throw the parameters in their 1 sigma range. 



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00527}{527}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00527\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00528\ \textcolor{comment}{//\ *************************************}}
\DoxyCodeLine{00529\ \ \ \textcolor{comment}{//\ Have\ the\ 1\ sigma\ for\ each\ parameter\ in\ each\ covariance\ class,\ sweet!}}
\DoxyCodeLine{00530\ \ \ \textcolor{comment}{//\ Don't\ want\ to\ change\ the\ nominal\ array\ because\ that's\ what\ determines\ our\ likelihood}}
\DoxyCodeLine{00531\ \ \ \textcolor{comment}{//\ Want\ to\ change\ the\ fParProp,\ fParCurr,\ fParInit}}
\DoxyCodeLine{00532\ \ \ \textcolor{comment}{//\ fParInit\ and\ the\ others\ will\ already\ be\ set}}
\DoxyCodeLine{00533\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{00534\ \ \ \ \ \textcolor{comment}{//\ Check\ if\ parameter\ is\ fixed\ first:\ if\ so\ don't\ randomly\ throw}}
\DoxyCodeLine{00535\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a2424eaebd9daa92b0294b352310770a3}{isParameterFixed}}(i))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00536\ \ \ \ \ \textcolor{comment}{//\ Check\ that\ the\ sigma\ range\ is\ larger\ than\ the\ parameter\ range}}
\DoxyCodeLine{00537\ \ \ \ \ \textcolor{comment}{//\ If\ not,\ throw\ in\ the\ valid\ parameter\ range\ instead}}
\DoxyCodeLine{00538\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ paramrange\ =\ \mbox{\hyperlink{classcovarianceBase_a31e636cb6de871bd0c2c8e7e299df9e7}{\_fUpBound}}[i]\ -\/\ \mbox{\hyperlink{classcovarianceBase_a8f1d94838f188cc85c4f82557c0b0b66}{\_fLowBound}}[i];}
\DoxyCodeLine{00539\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ sigma\ =\ sqrt((*\mbox{\hyperlink{classcovarianceBase_a6c3fe8db34c06299fd1633951ac00937}{covMatrix}})(i,i));}
\DoxyCodeLine{00540\ \ \ \ \ \textcolor{keywordtype}{double}\ throwrange\ =\ sigma;}
\DoxyCodeLine{00541\ \ \ \ \ \textcolor{keywordflow}{if}\ (paramrange\ <\ sigma)\ throwrange\ =\ paramrange;}
\DoxyCodeLine{00542\ }
\DoxyCodeLine{00543\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i]\ +\ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}[0]-\/>Gaus(0,\ 1)*throwrange;}
\DoxyCodeLine{00544\ \ \ \ \ \textcolor{comment}{//\ Try\ again\ if\ we\ the\ initial\ parameter\ proposal\ falls\ outside\ of\ the\ range\ of\ the\ parameter}}
\DoxyCodeLine{00545\ \ \ \ \ \textcolor{comment}{//\ Really\ only\ relevant\ for\ the\ xsec\ parameters;\ the\ flux\ and\ ND280\ have\ -\/999\ and\ 999\ set\ to\ the\ limits!}}
\DoxyCodeLine{00546\ \ \ \ \ \textcolor{keywordtype}{int}\ \textcolor{keywordflow}{throws}\ =\ 0;}
\DoxyCodeLine{00547\ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ >\ \mbox{\hyperlink{classcovarianceBase_a31e636cb6de871bd0c2c8e7e299df9e7}{\_fUpBound}}[i]\ ||\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ <\ \mbox{\hyperlink{classcovarianceBase_a8f1d94838f188cc85c4f82557c0b0b66}{\_fLowBound}}[i])\ \{}
\DoxyCodeLine{00548\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordflow}{throws}\ >\ 1000)\ \{}
\DoxyCodeLine{00549\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Tried\ \{\}\ times\ to\ throw\ parameter\ \{\}\ but\ failed"{}},\ \textcolor{keywordflow}{throws},\ i);}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Matrix:\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a26618d3f5633b33ce20e38ce8261b3ee}{matrixName}});}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Param:\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}[i]);}
\DoxyCodeLine{00552\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00553\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00554\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i]\ +\ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}[0]-\/>Gaus(0,\ 1)*throwrange;}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \textcolor{keywordflow}{throws}++;}
\DoxyCodeLine{00556\ \ \ \ \ \}}
\DoxyCodeLine{00557\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Setting\ current\ step\ in\ \{\}\ param\ \{\}\ =\ \{\}\ from\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a26618d3f5633b33ce20e38ce8261b3ee}{matrixName}},\ i,\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i],\ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i]);}
\DoxyCodeLine{00558\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i];}
\DoxyCodeLine{00559\ \ \ \}}
\DoxyCodeLine{00560\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \mbox{\hyperlink{classcovarianceBase_a651f5ecd8973918d5683606a607fa88c}{TransferToPCA}}();}
\DoxyCodeLine{00561\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a3432b7a9acc1243b8bdb17ec0b40d195}\label{classcovarianceBase_a3432b7a9acc1243b8bdb17ec0b40d195}} 
\index{covarianceBase@{covarianceBase}!randomize@{randomize}}
\index{randomize@{randomize}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{randomize()}{randomize()}}
{\footnotesize\ttfamily void covariance\+Base\+::randomize (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



\char`\"{}\+Randomize\char`\"{} the parameters in the covariance class for the proposed step. Used the proposal kernel and the current parameter value to set proposed step 



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00595}{595}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00596\ \textcolor{comment}{//\ ************************************************}}
\DoxyCodeLine{00597\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{}
\DoxyCodeLine{00598\ \textcolor{comment}{//KS:\ By\ multithreading\ here\ we\ gain\ at\ least\ factor\ 2\ with\ 8\ threads\ with\ ND\ only\ fit\ \ \ \ \ \ }}
\DoxyCodeLine{00599\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{00600\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{00601\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{00602\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{00603\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ parameter\ isn't\ fixed}}
\DoxyCodeLine{00604\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}[i]\ >\ 0.0)\ \{}
\DoxyCodeLine{00605\ \textcolor{preprocessor}{\#ifdef\ MULTITHREAD}}
\DoxyCodeLine{00606\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}[omp\_get\_thread\_num()]-\/>Gaus(0,\ 1);}
\DoxyCodeLine{00607\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00608\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}[0]-\/>Gaus(0,\ 1);}
\DoxyCodeLine{00609\ \textcolor{preprocessor}{\#endif\ }}
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ parameter\ IS\ fixed}}
\DoxyCodeLine{00611\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00612\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}}[i]\ =\ 0.0;}
\DoxyCodeLine{00613\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00614\ \ \ \ \ \}\ \textcolor{comment}{//\ end\ for}}
\DoxyCodeLine{00615\ \ \ \textcolor{comment}{//\ If\ we're\ in\ the\ PCA\ basis\ we\ instead\ throw\ parameters\ there\ (only\ \_fNumParPCA\ parameter)}}
\DoxyCodeLine{00616\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00617\ \ \ \ \ \textcolor{comment}{//\ Scale\ the\ random\ parameters\ by\ the\ sqrt\ of\ eigen\ values\ for\ the\ throw}}
\DoxyCodeLine{00618\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{00619\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{00620\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{00621\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)}
\DoxyCodeLine{00622\ \ \ \ \ \{}
\DoxyCodeLine{00623\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a7b83a17de68cc7838b93de242d91d9a0}{fParSigma\_PCA}}[i]\ >\ 0.\ \&\&\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}})}
\DoxyCodeLine{00624\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00625\ \textcolor{preprocessor}{\#ifdef\ MULTITHREAD\ \ \ \ \ \ \ \ }}
\DoxyCodeLine{00626\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}[omp\_get\_thread\_num()]-\/>Gaus(0,1);}
\DoxyCodeLine{00627\ \textcolor{preprocessor}{\#else\ \ \ \ \ \ \ \ }}
\DoxyCodeLine{00628\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}[0]-\/>Gaus(0,1);}
\DoxyCodeLine{00629\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00630\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{\ \textcolor{comment}{//\ If\ parameter\ IS\ fixed\ or\ out\ od\ bounds}}
\DoxyCodeLine{00631\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}}[i]\ =\ 0.0;}
\DoxyCodeLine{00632\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00633\ \ \ \ \ \}}
\DoxyCodeLine{00634\ \ \ \}}
\DoxyCodeLine{00635\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a75b5553823335bb82026ff46369fb67e}\label{classcovarianceBase_a75b5553823335bb82026ff46369fb67e}} 
\index{covarianceBase@{covarianceBase}!ReserveMemory@{ReserveMemory}}
\index{ReserveMemory@{ReserveMemory}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{ReserveMemory()}{ReserveMemory()}}
{\footnotesize\ttfamily void covariance\+Base\+::\+Reserve\+Memory (\begin{DoxyParamCaption}\item[{const int}]{size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Initialise vectors with parameters information. 


\begin{DoxyParams}{Parameters}
{\em size} & integer telling size to which we will resize all vectors/allocate memory \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00368}{368}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00369\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00370\ \ \ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}\ =\ std::vector<std::string>(SizeVec);}
\DoxyCodeLine{00371\ \ \ \mbox{\hyperlink{classcovarianceBase_a973671386a2f8ea924f25f8f5404654c}{\_fFancyNames}}\ =\ std::vector<std::string>(SizeVec);}
\DoxyCodeLine{00372\ \ \ \mbox{\hyperlink{classcovarianceBase_a9b753f52711600a9f8d648531d95b044}{\_fGenerated}}\ =\ std::vector<double>(SizeVec);}
\DoxyCodeLine{00373\ \ \ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}\ =\ std::vector<double>(SizeVec);}
\DoxyCodeLine{00374\ \ \ \mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}\ =\ std::vector<double>(SizeVec);}
\DoxyCodeLine{00375\ \ \ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}\ =\ std::vector<double>(SizeVec);}
\DoxyCodeLine{00376\ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}\ =\ std::vector<double>(SizeVec);}
\DoxyCodeLine{00377\ \ \ \mbox{\hyperlink{classcovarianceBase_a8f1d94838f188cc85c4f82557c0b0b66}{\_fLowBound}}\ =\ std::vector<double>(SizeVec);}
\DoxyCodeLine{00378\ \ \ \mbox{\hyperlink{classcovarianceBase_a31e636cb6de871bd0c2c8e7e299df9e7}{\_fUpBound}}\ =\ std::vector<double>(SizeVec);}
\DoxyCodeLine{00379\ \ \ \mbox{\hyperlink{classcovarianceBase_ad9c47deb7009bff81210f666e80012eb}{\_fFlatPrior}}\ =\ std::vector<bool>(SizeVec);}
\DoxyCodeLine{00380\ \ \ \mbox{\hyperlink{classcovarianceBase_a3cda39026e336a49cef482efd4062561}{\_fIndivStepScale}}\ =\ std::vector<double>(SizeVec);}
\DoxyCodeLine{00381\ }
\DoxyCodeLine{00382\ \ \ \mbox{\hyperlink{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}{corr\_throw}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[SizeVec]();}
\DoxyCodeLine{00383\ \ \ \textcolor{comment}{//\ set\ random\ parameter\ vector\ (for\ correlated\ steps)}}
\DoxyCodeLine{00384\ \ \ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[SizeVec];}
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00386\ \ \ \textcolor{comment}{//\ Set\ the\ defaults\ to\ true}}
\DoxyCodeLine{00387\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ SizeVec;\ i++)\ \{}
\DoxyCodeLine{00388\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a9b753f52711600a9f8d648531d95b044}{\_fGenerated}}.at(i)\ =\ 1.;}
\DoxyCodeLine{00389\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}.at(i)\ =\ 1.;}
\DoxyCodeLine{00390\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}.at(i)\ =\ 0.;}
\DoxyCodeLine{00391\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}.at(i)\ =\ 0.;}
\DoxyCodeLine{00392\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}.at(i)\ =\ 0.;}
\DoxyCodeLine{00393\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a8f1d94838f188cc85c4f82557c0b0b66}{\_fLowBound}}.at(i)\ =\ -\/999.99;}
\DoxyCodeLine{00394\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a31e636cb6de871bd0c2c8e7e299df9e7}{\_fUpBound}}.at(i)\ =\ 999.99;}
\DoxyCodeLine{00395\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ad9c47deb7009bff81210f666e80012eb}{\_fFlatPrior}}.at(i)\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00396\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a3cda39026e336a49cef482efd4062561}{\_fIndivStepScale}}.at(i)\ =\ 1.;}
\DoxyCodeLine{00397\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}{corr\_throw}}[i]\ =\ 0.0;}
\DoxyCodeLine{00398\ \ \ \}}
\DoxyCodeLine{00399\ }
\DoxyCodeLine{00400\ \ \ \mbox{\hyperlink{classcovarianceBase_a0088413d6a15d12cd34ec06166302f5c}{\_fGlobalStepScale}}\ =\ 1.0;}
\DoxyCodeLine{00401\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a0993a1ea6c5b06ba834e9e70af87ee9e}\label{classcovarianceBase_a0993a1ea6c5b06ba834e9e70af87ee9e}} 
\index{covarianceBase@{covarianceBase}!resetIndivStepScale@{resetIndivStepScale}}
\index{resetIndivStepScale@{resetIndivStepScale}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{resetIndivStepScale()}{resetIndivStepScale()}}
{\footnotesize\ttfamily void covariance\+Base\+::reset\+Indiv\+Step\+Scale (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Adaptive Step Tuning Stuff. 



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l01137}{1137}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01138\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{01139\ \ \ std::vector<double>\ stepScales(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{01140\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)\ \{}
\DoxyCodeLine{01141\ \ \ \ \ stepScales[i]\ =\ 1.;}
\DoxyCodeLine{01142\ \ \ \}}
\DoxyCodeLine{01143\ \ \ \mbox{\hyperlink{classcovarianceBase_a0088413d6a15d12cd34ec06166302f5c}{\_fGlobalStepScale}}\ =\ 1.0;}
\DoxyCodeLine{01144\ \ \ \mbox{\hyperlink{classcovarianceBase_a21b912b31c888a2bdae9145a0c10a614}{setIndivStepScale}}(stepScales);}
\DoxyCodeLine{01145\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_aa970d7a68497a3765723bf34629f79f7}\label{classcovarianceBase_aa970d7a68497a3765723bf34629f79f7}} 
\index{covarianceBase@{covarianceBase}!retPointer@{retPointer}}
\index{retPointer@{retPointer}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{retPointer()}{retPointer()}}
{\footnotesize\ttfamily const double $\ast$ covariance\+Base\+::ret\+Pointer (\begin{DoxyParamCaption}\item[{const int}]{i\+Param }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



DB Pointer return to param position. 


\begin{DoxyParams}{Parameters}
{\em i\+Param} & The index of the parameter in the vector. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A pointer to the parameter value at the specified index.
\end{DoxyReturn}
\begin{DoxyWarning}{Warning}
ETA -\/ This might be a bit squiffy? If the vector gots moved from say a push\+\_\+back then the pointer is no longer valid... maybe need a better way to deal with this? It was fine before when the return was to an element of a new array. There must be a clever C++ way to be careful 
\end{DoxyWarning}


Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00173}{173}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00173\ \{\textcolor{keywordflow}{return}\ \&(\mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}.data()[iParam]);\}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a3e2c11c7c0a3557068369b30e7aac17f}\label{classcovarianceBase_a3e2c11c7c0a3557068369b30e7aac17f}} 
\index{covarianceBase@{covarianceBase}!ReturnUnity@{ReturnUnity}}
\index{ReturnUnity@{ReturnUnity}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{ReturnUnity()}{ReturnUnity()}}
{\footnotesize\ttfamily const double $\ast$ covariance\+Base\+::\+Return\+Unity (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}



Handy function to return 1 for any systs. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00374}{374}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00374\ \{\textcolor{keywordflow}{return}\ \&\mbox{\hyperlink{classcovarianceBase_a7682c3de33ae5b23b23e070dc0a3f778}{Unity}};\}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_ae4c26e3f2a727a39e9db7ed88e72ac38}\label{classcovarianceBase_ae4c26e3f2a727a39e9db7ed88e72ac38}} 
\index{covarianceBase@{covarianceBase}!saveAdaptiveToFile@{saveAdaptiveToFile}}
\index{saveAdaptiveToFile@{saveAdaptiveToFile}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{saveAdaptiveToFile()}{saveAdaptiveToFile()}}
{\footnotesize\ttfamily void covariance\+Base\+::save\+Adaptive\+To\+File (\begin{DoxyParamCaption}\item[{const TString \&}]{out\+File\+Name,  }\item[{const TString \&}]{systematic\+Name }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Save adaptive throw matrix to file. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00138}{138}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00139\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_a752d312d5fdd755af88b58880a9845ec}{SaveAdaptiveToFile}}(outFileName,\ systematicName);\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_ab36f40d40f4747718c98d368c04f41b7}\label{classcovarianceBase_ab36f40d40f4747718c98d368c04f41b7}} 
\index{covarianceBase@{covarianceBase}!SaveUpdatedMatrixConfig@{SaveUpdatedMatrixConfig}}
\index{SaveUpdatedMatrixConfig@{SaveUpdatedMatrixConfig}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{SaveUpdatedMatrixConfig()}{SaveUpdatedMatrixConfig()}}
{\footnotesize\ttfamily void covariance\+Base\+::\+Save\+Updated\+Matrix\+Config (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



KS\+: After step scale, prefit etc. value were modified save this modified config. 



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l01349}{1349}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01349\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01350\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{01351\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_a933ff3dc0af99629ba3582a5d9d89d23}{\_fYAMLDoc}})}
\DoxyCodeLine{01352\ \ \ \{}
\DoxyCodeLine{01353\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a07ff6d6a15b24f94afc88a1b89779beb}{MACH3LOG\_CRITICAL}}(\textcolor{stringliteral}{"{}Yaml\ node\ hasn't\ been\ initialised\ for\ matrix\ \{\},\ something\ is\ not\ right"{}},\ \mbox{\hyperlink{classcovarianceBase_a26618d3f5633b33ce20e38ce8261b3ee}{matrixName}});}
\DoxyCodeLine{01354\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a07ff6d6a15b24f94afc88a1b89779beb}{MACH3LOG\_CRITICAL}}(\textcolor{stringliteral}{"{}I\ am\ not\ throwing\ error\ but\ should\ be\ investigated"{}});}
\DoxyCodeLine{01355\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01356\ \ \ \}}
\DoxyCodeLine{01357\ }
\DoxyCodeLine{01358\ \ \ YAML::Node\ copyNode\ =\ \mbox{\hyperlink{classcovarianceBase_a933ff3dc0af99629ba3582a5d9d89d23}{\_fYAMLDoc}};}
\DoxyCodeLine{01359\ \ \ \textcolor{keywordtype}{int}\ i\ =\ 0;}
\DoxyCodeLine{01360\ }
\DoxyCodeLine{01361\ \ \ \textcolor{keywordflow}{for}\ (YAML::Node\ param\ :\ copyNode[\textcolor{stringliteral}{"{}Systematics"{}}])}
\DoxyCodeLine{01362\ \ \ \{}
\DoxyCodeLine{01363\ \ \ \ \ \textcolor{comment}{//KS:\ Feel\ free\ to\ update\ it,\ if\ you\ need\ updated\ prefit\ value\ etc}}
\DoxyCodeLine{01364\ \ \ \ \ param[\textcolor{stringliteral}{"{}Systematic"{}}][\textcolor{stringliteral}{"{}StepScale"{}}][\textcolor{stringliteral}{"{}MCMC"{}}]\ =\ std::round(\mbox{\hyperlink{classcovarianceBase_a3cda39026e336a49cef482efd4062561}{\_fIndivStepScale}}[i]\ *\ 100.0)\ /\ 100.0;\ \textcolor{comment}{//\ Round\ to\ 2\ decimal\ places}}
\DoxyCodeLine{01365\ \ \ \ \ i++;}
\DoxyCodeLine{01366\ \ \ \}}
\DoxyCodeLine{01367\ \ \ \textcolor{comment}{//\ Save\ the\ modified\ node\ to\ a\ file}}
\DoxyCodeLine{01368\ \ \ std::ofstream\ fout(\textcolor{stringliteral}{"{}Modified\_Matrix.yaml"{}});}
\DoxyCodeLine{01369\ \ \ fout\ <<\ copyNode;}
\DoxyCodeLine{01370\ \ \ fout.close();}
\DoxyCodeLine{01371\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_aae80acab113ac496a9bc56e28f6ae0c9}\label{classcovarianceBase_aae80acab113ac496a9bc56e28f6ae0c9}} 
\index{covarianceBase@{covarianceBase}!SetBranches@{SetBranches}}
\index{SetBranches@{SetBranches}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{SetBranches()}{SetBranches()}}
{\footnotesize\ttfamily void covariance\+Base\+::\+Set\+Branches (\begin{DoxyParamCaption}\item[{TTree \&}]{tree,  }\item[{bool}]{Save\+Proposal = {\ttfamily false} }\end{DoxyParamCaption})}



set branches for output file 


\begin{DoxyParams}{Parameters}
{\em tree} & Tree to which we will save branches \\
\hline
{\em Save\+Proposal} & Normally we only save parameter after is accepted, for debugging purpose it is helpful to see also proposed values. That\textquotesingle{}s what this variable controls \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00896}{896}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00896\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00897\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00898\ \ \ \textcolor{comment}{//\ loop\ over\ parameters\ and\ set\ a\ branch}}
\DoxyCodeLine{00899\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{00900\ \ \ \ \ tree.Branch(\mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}[i].c\_str(),\ \&\mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i],\ Form(\textcolor{stringliteral}{"{}\%s/D"{}},\ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}[i].c\_str()));}
\DoxyCodeLine{00901\ \ \ \}}
\DoxyCodeLine{00902\ \ \ \textcolor{comment}{//\ When\ running\ PCA,\ also\ save\ PCA\ parameters}}
\DoxyCodeLine{00903\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{}
\DoxyCodeLine{00904\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}};\ ++i)\ \{}
\DoxyCodeLine{00905\ }
\DoxyCodeLine{00906\ \ \ \ \ \ \ tree.Branch(Form(\textcolor{stringliteral}{"{}\%s\_PCA"{}},\ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}[i].c\_str()),\ \&\mbox{\hyperlink{classcovarianceBase_aa96f87ab90dc26fc1b5e157149b9dfd3}{fParCurr\_PCA}}.GetMatrixArray()[i],\ Form(\textcolor{stringliteral}{"{}\%s\_PCA/D"{}},\ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}[i].c\_str()));}
\DoxyCodeLine{00907\ \ \ \ \ \}}
\DoxyCodeLine{00908\ \ \ \}}
\DoxyCodeLine{00909\ }
\DoxyCodeLine{00910\ \ \ \textcolor{keywordflow}{if}(SaveProposal)}
\DoxyCodeLine{00911\ \ \ \{}
\DoxyCodeLine{00912\ \ \ \ \ \textcolor{comment}{//\ loop\ over\ parameters\ and\ set\ a\ branch}}
\DoxyCodeLine{00913\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{00914\ \ \ \ \ \ \ tree.Branch(Form(\textcolor{stringliteral}{"{}\%s\_Prop"{}},\ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}[i].c\_str()),\ \&\mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i],\ Form(\textcolor{stringliteral}{"{}\%s\_Prop/D"{}},\ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}[i].c\_str()));}
\DoxyCodeLine{00915\ \ \ \ \ \}}
\DoxyCodeLine{00916\ \ \ \ \ \textcolor{comment}{//\ When\ running\ PCA,\ also\ save\ PCA\ parameters}}
\DoxyCodeLine{00917\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{}
\DoxyCodeLine{00918\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}};\ ++i)\ \{}
\DoxyCodeLine{00919\ }
\DoxyCodeLine{00920\ \ \ \ \ \ \ \ \ tree.Branch(Form(\textcolor{stringliteral}{"{}\%s\_PCA\_Prop"{}},\ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}[i].c\_str()),\ \&\mbox{\hyperlink{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}{fParProp\_PCA}}.GetMatrixArray()[i],\ Form(\textcolor{stringliteral}{"{}\%s\_PCA\_Prop/D"{}},\ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}[i].c\_str()));}
\DoxyCodeLine{00921\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00922\ \ \ \ \ \}}
\DoxyCodeLine{00923\ \ \ \}}
\DoxyCodeLine{00924\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a5f28f7294d25cca6334f7033a63596b9}\label{classcovarianceBase_a5f28f7294d25cca6334f7033a63596b9}} 
\index{covarianceBase@{covarianceBase}!setCovMatrix@{setCovMatrix}}
\index{setCovMatrix@{setCovMatrix}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{setCovMatrix()}{setCovMatrix()}}
{\footnotesize\ttfamily void covariance\+Base\+::set\+Cov\+Matrix (\begin{DoxyParamCaption}\item[{TMatrix\+DSym $\ast$}]{cov }\end{DoxyParamCaption})}



Set covariance matrix. 


\begin{DoxyParams}{Parameters}
{\em cov} & Covariance matrix which we set and will be used later for evaluation of penalty term \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00346}{346}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00347\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00348\ \ \ \textcolor{keywordflow}{if}\ (cov\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00349\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Could\ not\ find\ covariance\ matrix\ you\ provided\ to\ setCovMatrix"{}});}
\DoxyCodeLine{00350\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00351\ \ \ \}}
\DoxyCodeLine{00352\ \ \ \mbox{\hyperlink{classcovarianceBase_a6c3fe8db34c06299fd1633951ac00937}{covMatrix}}\ =\ cov;}
\DoxyCodeLine{00353\ }
\DoxyCodeLine{00354\ \ \ \mbox{\hyperlink{classcovarianceBase_a35c7dc7817eaf4058e9775b6bc792ebc}{invCovMatrix}}\ =\ \textcolor{keyword}{static\_cast<}TMatrixDSym\ *\textcolor{keyword}{>}(cov-\/>Clone());}
\DoxyCodeLine{00355\ \ \ \mbox{\hyperlink{classcovarianceBase_a35c7dc7817eaf4058e9775b6bc792ebc}{invCovMatrix}}-\/>Invert();}
\DoxyCodeLine{00356\ \ \ \textcolor{comment}{//KS:\ ROOT\ has\ bad\ memory\ management,\ using\ standard\ double\ means\ we\ can\ decrease\ most\ operation\ by\ factor\ 2\ simply\ due\ to\ cache\ hits}}
\DoxyCodeLine{00357\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)}
\DoxyCodeLine{00358\ \ \ \{}
\DoxyCodeLine{00359\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++j)}
\DoxyCodeLine{00360\ \ \ \ \ \{}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}{InvertCovMatrix}}[i][j]\ =\ (*invCovMatrix)(i,j);}
\DoxyCodeLine{00362\ \ \ \ \ \}}
\DoxyCodeLine{00363\ \ \ \}}
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \ \ \mbox{\hyperlink{classcovarianceBase_af30ca7861452e1446e55700f4b49b608}{setThrowMatrix}}(cov);}
\DoxyCodeLine{00366\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a1e9b4a09866909595a26fb2e1ea94cac}\label{classcovarianceBase_a1e9b4a09866909595a26fb2e1ea94cac}} 
\index{covarianceBase@{covarianceBase}!setFlatPrior@{setFlatPrior}}
\index{setFlatPrior@{setFlatPrior}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{setFlatPrior()}{setFlatPrior()}}
{\footnotesize\ttfamily void covariance\+Base\+::set\+Flat\+Prior (\begin{DoxyParamCaption}\item[{const int}]{i,  }\item[{const bool}]{eL }\end{DoxyParamCaption})}



Set if parameter should have flat prior or not. 


\begin{DoxyParams}{Parameters}
{\em i} & Parameter index \\
\hline
{\em eL} & bool telling if it will be flat or not \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l01004}{1004}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01004\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01005\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{01006\ \ \ \textcolor{keywordflow}{if}\ (i\ >\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}})\ \{}
\DoxyCodeLine{01007\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Can't\ setEvalLikelihood\ for\ Cov=\{\}/Param=\{\}\ because\ size\ of\ Covariance\ =\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}{getName}}(),\ i,\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{01008\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Fix\ this\ in\ your\ config\ file\ please!"{}});}
\DoxyCodeLine{01009\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{01010\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01011\ \ \ \ \ \textcolor{keywordflow}{if}(eL)\{}
\DoxyCodeLine{01012\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Setting\ \{\}\ (parameter\ \{\})\ to\ flat\ prior"{}},\ \mbox{\hyperlink{classcovarianceBase_a033c5b6a8669537acaa6c5fc252899e6}{GetParName}}(i),\ i);}
\DoxyCodeLine{01013\ \ \ \ \ \}}
\DoxyCodeLine{01014\ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{01015\ \ \ \ \ \ \ \textcolor{comment}{//\ HW\ ::\ This\ is\ useful}}
\DoxyCodeLine{01016\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Setting\ \{\}\ (parameter\ \{\})\ to\ non-\/flat\ prior"{}},\ \mbox{\hyperlink{classcovarianceBase_a033c5b6a8669537acaa6c5fc252899e6}{GetParName}}(i),\ i);}
\DoxyCodeLine{01017\ \ \ \ \ \}}
\DoxyCodeLine{01018\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ad9c47deb7009bff81210f666e80012eb}{\_fFlatPrior}}[i]\ =\ eL;}
\DoxyCodeLine{01019\ \ \ \}}
\DoxyCodeLine{01020\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a21b912b31c888a2bdae9145a0c10a614}\label{classcovarianceBase_a21b912b31c888a2bdae9145a0c10a614}} 
\index{covarianceBase@{covarianceBase}!setIndivStepScale@{setIndivStepScale}}
\index{setIndivStepScale@{setIndivStepScale}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{setIndivStepScale()}{setIndivStepScale()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void covariance\+Base\+::set\+Indiv\+Step\+Scale (\begin{DoxyParamCaption}\item[{const int}]{Parameter\+Index,  }\item[{const double}]{Step\+Scale }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



DB Function to set f\+Indiv\+Step\+Scale from a vector (Can be used from execs and inside covariance constructors) 


\begin{DoxyParams}{Parameters}
{\em Parameter\+Index} & Parameter Index \\
\hline
{\em Step\+Scale} & Value of individual step scale \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00078}{78}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00078\ \{\ \mbox{\hyperlink{classcovarianceBase_a3cda39026e336a49cef482efd4062561}{\_fIndivStepScale}}.at(ParameterIndex)\ =\ StepScale;\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a57fcbce7dbdc47e3b6ff9344c215ed9a}\label{classcovarianceBase_a57fcbce7dbdc47e3b6ff9344c215ed9a}} 
\index{covarianceBase@{covarianceBase}!setIndivStepScale@{setIndivStepScale}}
\index{setIndivStepScale@{setIndivStepScale}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{setIndivStepScale()}{setIndivStepScale()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void covariance\+Base\+::set\+Indiv\+Step\+Scale (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ double $>$ \&}]{stepscale }\end{DoxyParamCaption})}



DB Function to set f\+Indiv\+Step\+Scale from a vector (Can be used from execs and inside covariance constructors) 


\begin{DoxyParams}{Parameters}
{\em stepscale} & Vector of individual step scale, should have same \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l01058}{1058}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01059\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{01060\ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordtype}{int}(stepscale.size())\ !=\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}})}
\DoxyCodeLine{01061\ \ \ \{}
\DoxyCodeLine{01062\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Stepscale\ vector\ not\ equal\ to\ number\ of\ parameters.\ Quitting.."{}});}
\DoxyCodeLine{01063\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Size\ of\ argument\ vector:\ \{\}"{}},\ stepscale.size());}
\DoxyCodeLine{01064\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Expected\ size:\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{01065\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01066\ \ \ \}}
\DoxyCodeLine{01067\ }
\DoxyCodeLine{01068\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ iParam\ =\ 0\ ;\ iParam\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ iParam++)\ \{}
\DoxyCodeLine{01069\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a3cda39026e336a49cef482efd4062561}{\_fIndivStepScale}}[iParam]\ =\ stepscale[iParam];}
\DoxyCodeLine{01070\ \ \ \}}
\DoxyCodeLine{01071\ }
\DoxyCodeLine{01072\ \ \ \mbox{\hyperlink{classcovarianceBase_ad3c0dddbedcf57f06a14ec52800a087b}{printIndivStepScale}}();}
\DoxyCodeLine{01073\ }
\DoxyCodeLine{01074\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01075\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a9f980a259c5952f9ca907832f99ad2a7}\label{classcovarianceBase_a9f980a259c5952f9ca907832f99ad2a7}} 
\index{covarianceBase@{covarianceBase}!setName@{setName}}
\index{setName@{setName}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{setName()}{setName()}}
{\footnotesize\ttfamily void covariance\+Base\+::set\+Name (\begin{DoxyParamCaption}\item[{std\+::string}]{name }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Set matrix name. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00040}{40}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00040\ \{\ \mbox{\hyperlink{classcovarianceBase_a26618d3f5633b33ce20e38ce8261b3ee}{matrixName}}\ =\ name;\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a1e5aec8c073799ac9d40e65c0996b2c1}\label{classcovarianceBase_a1e5aec8c073799ac9d40e65c0996b2c1}} 
\index{covarianceBase@{covarianceBase}!setNumberOfSteps@{setNumberOfSteps}}
\index{setNumberOfSteps@{setNumberOfSteps}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{setNumberOfSteps()}{setNumberOfSteps()}}
{\footnotesize\ttfamily void covariance\+Base\+::set\+Number\+Of\+Steps (\begin{DoxyParamCaption}\item[{const int}]{nsteps }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Set number of MCMC step, when running adaptive MCMC it is updated with given frequency. We need number of steps to determine frequency. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00147}{147}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00148\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_ab2837af4566e2d62db7b76f9527fb6d7}{total\_steps}}\ =\ nsteps;}
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_a39a099e5712cf605190a53a4355c700c}{AdaptionUpdate}}())\ \mbox{\hyperlink{classcovarianceBase_a0993a1ea6c5b06ba834e9e70af87ee9e}{resetIndivStepScale}}();}
\DoxyCodeLine{00150\ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_aae3b226cbd6a4c03f291620ebd018bc9}\label{classcovarianceBase_aae3b226cbd6a4c03f291620ebd018bc9}} 
\index{covarianceBase@{covarianceBase}!setPar@{setPar}}
\index{setPar@{setPar}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{setPar()}{setPar()}}
{\footnotesize\ttfamily void covariance\+Base\+::set\+Par (\begin{DoxyParamCaption}\item[{const int}]{i,  }\item[{const double}]{val }\end{DoxyParamCaption})}



Set all the covariance matrix parameters to a user-\/defined value. 


\begin{DoxyParams}{Parameters}
{\em i} & Parameter index \\
\hline
{\em val} & new value which will be set \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00406}{406}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00407\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00408\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Over-\/riding\ \{\}:\ "{}},\ \mbox{\hyperlink{classcovarianceBase_a033c5b6a8669537acaa6c5fc252899e6}{GetParName}}(i));}
\DoxyCodeLine{00409\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\_fPropVal\ (\{\}),\ \_fCurrVal\ (\{\}),\ \_fPreFitValue\ (\{\})\ to\ (\{\})"{}},\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i],\ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i],\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i],\ val);}
\DoxyCodeLine{00410\ }
\DoxyCodeLine{00411\ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ =\ val;}
\DoxyCodeLine{00412\ \ \ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i]\ =\ val;}
\DoxyCodeLine{00413\ \ \ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i]\ =\ val;}
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00415\ \ \ \textcolor{comment}{//\ Transfer\ the\ parameter\ values\ to\ the\ PCA\ basis}}
\DoxyCodeLine{00416\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \mbox{\hyperlink{classcovarianceBase_a651f5ecd8973918d5683606a607fa88c}{TransferToPCA}}();}
\DoxyCodeLine{00417\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_aa4d9eaf56199245332f0b0be2c353944}\label{classcovarianceBase_aa4d9eaf56199245332f0b0be2c353944}} 
\index{covarianceBase@{covarianceBase}!setParameters@{setParameters}}
\index{setParameters@{setParameters}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{setParameters()}{setParameters()}}
{\footnotesize\ttfamily void covariance\+Base\+::set\+Parameters (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ double $>$ \&}]{pars = {\ttfamily \{\}} }\end{DoxyParamCaption})}



Set parameter values using vector, it has to have same size as covariance class. 


\begin{DoxyParams}{Parameters}
{\em pars} & Vector holding new values for every parameter \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00862}{862}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00862\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00863\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00864\ \ \ \textcolor{comment}{//\ If\ empty,\ set\ the\ proposed\ to\ nominal}}
\DoxyCodeLine{00865\ \ \ \textcolor{keywordflow}{if}\ (pars.empty())\ \{}
\DoxyCodeLine{00866\ \ \ \ \ \textcolor{comment}{//\ For\ xsec\ this\ means\ setting\ to\ the\ prior\ (because\ nominal\ is\ the\ prior)}}
\DoxyCodeLine{00867\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)\ \{}
\DoxyCodeLine{00868\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i];}
\DoxyCodeLine{00869\ \ \ \ \ \}}
\DoxyCodeLine{00870\ \ \ \ \ \textcolor{comment}{//\ If\ not\ empty,\ set\ the\ parameters\ to\ the\ specified}}
\DoxyCodeLine{00871\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00872\ \ \ \ \ \textcolor{keywordflow}{if}\ (pars.size()\ !=\ \textcolor{keywordtype}{size\_t}(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}}))\ \{}
\DoxyCodeLine{00873\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Warning:\ parameter\ arrays\ of\ incompatible\ size!\ Not\ changing\ parameters!\ \{\}\ has\ size\ \{\}\ but\ was\ expecting\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a26618d3f5633b33ce20e38ce8261b3ee}{matrixName}},\ pars.size(),\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{00874\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00875\ \ \ \ \ \}}
\DoxyCodeLine{00876\ \ \ \ \ \textcolor{keywordtype}{int}\ parsSize\ =\ int(pars.size());}
\DoxyCodeLine{00877\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ parsSize;\ i++)\ \{}
\DoxyCodeLine{00878\ \ \ \ \ \ \ \textcolor{comment}{//Make\ sure\ that\ you\ are\ actually\ passing\ a\ number\ to\ set\ the\ parameter\ to}}
\DoxyCodeLine{00879\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(std::isnan(pars[i]))\ \{}
\DoxyCodeLine{00880\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Error:\ trying\ to\ set\ parameter\ value\ to\ a\ nan\ for\ parameter\ \{\}\ in\ matrix\ \{\}.\ This\ will\ not\ go\ well!"{}},\ \mbox{\hyperlink{classcovarianceBase_a033c5b6a8669537acaa6c5fc252899e6}{GetParName}}(i),\ \mbox{\hyperlink{classcovarianceBase_a26618d3f5633b33ce20e38ce8261b3ee}{matrixName}});}
\DoxyCodeLine{00881\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00882\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00883\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ =\ pars[i];}
\DoxyCodeLine{00884\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00885\ \ \ \ \ \}}
\DoxyCodeLine{00886\ \ \ \}}
\DoxyCodeLine{00887\ \ \ \textcolor{comment}{//\ And\ if\ pca\ make\ the\ transfer}}
\DoxyCodeLine{00888\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{}
\DoxyCodeLine{00889\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a651f5ecd8973918d5683606a607fa88c}{TransferToPCA}}();}
\DoxyCodeLine{00890\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a65ac4956a782b01768f445732522a450}{TransferToParam}}();}
\DoxyCodeLine{00891\ \ \ \}}
\DoxyCodeLine{00892\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00893\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a5888af0b4b6e1d7826fca0f6777bf3ae}\label{classcovarianceBase_a5888af0b4b6e1d7826fca0f6777bf3ae}} 
\index{covarianceBase@{covarianceBase}!setParameters\_PCA@{setParameters\_PCA}}
\index{setParameters\_PCA@{setParameters\_PCA}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{setParameters\_PCA()}{setParameters\_PCA()}}
{\footnotesize\ttfamily void covariance\+Base\+::set\+Parameters\+\_\+\+PCA (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ double $>$ \&}]{pars }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Set values for PCA parameters in PCA base. 


\begin{DoxyParams}{Parameters}
{\em pars} & vector with new values of PCA params \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00275}{275}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00276\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{\ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Am\ not\ running\ in\ PCA\ mode"{}});\ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );\ \}}
\DoxyCodeLine{00277\ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordtype}{int}(pars.size())\ !=\ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}})\ \{}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Warning:\ parameter\ arrays\ of\ incompatible\ size!\ Not\ changing\ parameters!\ \{\}\ has\ size\ \{\}\ but\ was\ expecting\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a26618d3f5633b33ce20e38ce8261b3ee}{matrixName}},\ pars.size(),\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00280\ \ \ \ \ \}}
\DoxyCodeLine{00281\ \ \ \ \ \textcolor{keywordtype}{int}\ parsSize\ =\ int(pars.size());}
\DoxyCodeLine{00282\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ parsSize;\ i++)\ \{}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}{fParProp\_PCA}}(i)\ =\ pars[i];}
\DoxyCodeLine{00284\ \ \ \ \ \}}
\DoxyCodeLine{00285\ \ \ \ \ \textcolor{comment}{//KS:\ Transfer\ to\ normal\ base}}
\DoxyCodeLine{00286\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a65ac4956a782b01768f445732522a450}{TransferToParam}}();}
\DoxyCodeLine{00287\ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a593457c3ae0a2d1892846b484833274f}\label{classcovarianceBase_a593457c3ae0a2d1892846b484833274f}} 
\index{covarianceBase@{covarianceBase}!setParCurr\_PCA@{setParCurr\_PCA}}
\index{setParCurr\_PCA@{setParCurr\_PCA}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{setParCurr\_PCA()}{setParCurr\_PCA()}}
{\footnotesize\ttfamily void covariance\+Base\+::set\+Par\+Curr\+\_\+\+PCA (\begin{DoxyParamCaption}\item[{const int}]{i,  }\item[{const double}]{value }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Set current value for parameter in PCA base. 


\begin{DoxyParams}{Parameters}
{\em i} & Parameter index \\
\hline
{\em value} & new value \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00266}{266}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00267\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{\ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Am\ not\ running\ in\ PCA\ mode"{}});\ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );\ \}}
\DoxyCodeLine{00268\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_aa96f87ab90dc26fc1b5e157149b9dfd3}{fParCurr\_PCA}}(i)\ =\ value;}
\DoxyCodeLine{00269\ \ \ \ \ \textcolor{comment}{//\ And\ then\ transfer\ back\ to\ the\ parameter\ basis}}
\DoxyCodeLine{00270\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a65ac4956a782b01768f445732522a450}{TransferToParam}}();}
\DoxyCodeLine{00271\ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a6701f97eb624cef70998773333f96757}\label{classcovarianceBase_a6701f97eb624cef70998773333f96757}} 
\index{covarianceBase@{covarianceBase}!setParCurrProp@{setParCurrProp}}
\index{setParCurrProp@{setParCurrProp}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{setParCurrProp()}{setParCurrProp()}}
{\footnotesize\ttfamily void covariance\+Base\+::set\+Par\+Curr\+Prop (\begin{DoxyParamCaption}\item[{const int}]{i,  }\item[{const double}]{val }\end{DoxyParamCaption})}



Set current parameter value. 


\begin{DoxyParams}{Parameters}
{\em i} & Parameter index \\
\hline
{\em val} & new value which will be set \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00573}{573}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00574\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00575\ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[parNo]\ =\ parVal;}
\DoxyCodeLine{00576\ \ \ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[parNo]\ =\ parVal;}
\DoxyCodeLine{00577\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a4db4657acad5c79ac4bbb66a9d1c5905}{MACH3LOG\_DEBUG}}(\textcolor{stringliteral}{"{}Setting\ \{\}\ (parameter\ \{\})\ to\ \{\})"{}},\ \mbox{\hyperlink{classcovarianceBase_a033c5b6a8669537acaa6c5fc252899e6}{GetParName}}(parNo),\ \ parNo,\ parVal);}
\DoxyCodeLine{00578\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \mbox{\hyperlink{classcovarianceBase_a651f5ecd8973918d5683606a607fa88c}{TransferToPCA}}();}
\DoxyCodeLine{00579\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a086ff04fa55c074a2baa6cc63e4f279a}\label{classcovarianceBase_a086ff04fa55c074a2baa6cc63e4f279a}} 
\index{covarianceBase@{covarianceBase}!setParName@{setParName}}
\index{setParName@{setParName}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{setParName()}{setParName()}}
{\footnotesize\ttfamily void covariance\+Base\+::set\+Par\+Name (\begin{DoxyParamCaption}\item[{int}]{i,  }\item[{std\+::string}]{name }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



change parameter name 


\begin{DoxyParams}{Parameters}
{\em i} & Parameter index \\
\hline
{\em name} & new name which will be set \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00044}{44}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00044\ \{\ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}.at(i)\ =\ name;\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a9f78e4f0ae493e78accc8374cdf38b6f}\label{classcovarianceBase_a9f78e4f0ae493e78accc8374cdf38b6f}} 
\index{covarianceBase@{covarianceBase}!setParProp@{setParProp}}
\index{setParProp@{setParProp}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{setParProp()}{setParProp()}}
{\footnotesize\ttfamily void covariance\+Base\+::set\+Par\+Prop (\begin{DoxyParamCaption}\item[{const int}]{i,  }\item[{const double}]{val }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Set proposed parameter value. 


\begin{DoxyParams}{Parameters}
{\em val} & new value which will be set \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00056}{56}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00057\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ =\ val;}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \mbox{\hyperlink{classcovarianceBase_a651f5ecd8973918d5683606a607fa88c}{TransferToPCA}}();}
\DoxyCodeLine{00059\ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a7c9b2ae1b4144448385b47a576e4d07d}\label{classcovarianceBase_a7c9b2ae1b4144448385b47a576e4d07d}} 
\index{covarianceBase@{covarianceBase}!setParProp\_PCA@{setParProp\_PCA}}
\index{setParProp\_PCA@{setParProp\_PCA}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{setParProp\_PCA()}{setParProp\_PCA()}}
{\footnotesize\ttfamily void covariance\+Base\+::set\+Par\+Prop\+\_\+\+PCA (\begin{DoxyParamCaption}\item[{const int}]{i,  }\item[{const double}]{value }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Set proposed value for parameter in PCA base. 


\begin{DoxyParams}{Parameters}
{\em i} & Parameter index \\
\hline
{\em value} & new value \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00257}{257}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00258\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{\ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Am\ not\ running\ in\ PCA\ mode"{}});\ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );\ \}}
\DoxyCodeLine{00259\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}{fParProp\_PCA}}(i)\ =\ value;}
\DoxyCodeLine{00260\ \ \ \ \ \textcolor{comment}{//\ And\ then\ transfer\ back\ to\ the\ parameter\ basis}}
\DoxyCodeLine{00261\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a65ac4956a782b01768f445732522a450}{TransferToParam}}();}
\DoxyCodeLine{00262\ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a340fbee1b5d97897431f2b0222f85337}\label{classcovarianceBase_a340fbee1b5d97897431f2b0222f85337}} 
\index{covarianceBase@{covarianceBase}!setPrintLength@{setPrintLength}}
\index{setPrintLength@{setPrintLength}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{setPrintLength()}{setPrintLength()}}
{\footnotesize\ttfamily void covariance\+Base\+::set\+Print\+Length (\begin{DoxyParamCaption}\item[{const unsigned int}]{Pri\+Len }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



KS\+: In case someone really want to change this. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00083}{83}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00083\ \{\ \mbox{\hyperlink{classcovarianceBase_a8d821ce805f2426fe95549170866821f}{PrintLength}}\ =\ PriLen;\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a978483dabf04239f1c475516b5cdab7f}\label{classcovarianceBase_a978483dabf04239f1c475516b5cdab7f}} 
\index{covarianceBase@{covarianceBase}!setSingleParameter@{setSingleParameter}}
\index{setSingleParameter@{setSingleParameter}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{setSingleParameter()}{setSingleParameter()}}
{\footnotesize\ttfamily void covariance\+Base\+::set\+Single\+Parameter (\begin{DoxyParamCaption}\item[{const int}]{par\+No,  }\item[{const double}]{par\+Val }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00565}{565}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00565\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00566\ \textcolor{comment}{//\ *************************************}}
\DoxyCodeLine{00567\ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[parNo]\ =\ parVal;}
\DoxyCodeLine{00568\ \ \ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[parNo]\ =\ parVal;}
\DoxyCodeLine{00569\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a4db4657acad5c79ac4bbb66a9d1c5905}{MACH3LOG\_DEBUG}}(\textcolor{stringliteral}{"{}Setting\ \{\}\ (parameter\ \{\})\ to\ \{\})"{}},\ \mbox{\hyperlink{classcovarianceBase_a033c5b6a8669537acaa6c5fc252899e6}{GetParName}}(parNo),\ \ parNo,\ parVal);}
\DoxyCodeLine{00570\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \mbox{\hyperlink{classcovarianceBase_a651f5ecd8973918d5683606a607fa88c}{TransferToPCA}}();}
\DoxyCodeLine{00571\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a806cf53a69a35da2426169561f450b85}\label{classcovarianceBase_a806cf53a69a35da2426169561f450b85}} 
\index{covarianceBase@{covarianceBase}!setStepScale@{setStepScale}}
\index{setStepScale@{setStepScale}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{setStepScale()}{setStepScale()}}
{\footnotesize\ttfamily void covariance\+Base\+::set\+Step\+Scale (\begin{DoxyParamCaption}\item[{const double}]{scale }\end{DoxyParamCaption})}



Set global step scale for covariance object. 


\begin{DoxyParams}{Parameters}
{\em scale} & Value of global step scale \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00927}{927}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00927\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00928\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00929\ \ \ \textcolor{keywordflow}{if}(scale\ ==\ 0)}
\DoxyCodeLine{00930\ \ \ \{}
\DoxyCodeLine{00931\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}You\ are\ trying\ so\ set\ StepScale\ to\ 0\ this\ will\ not\ work"{}});}
\DoxyCodeLine{00932\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00933\ \ \ \}}
\DoxyCodeLine{00934\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\{\}\ setStepScale()\ =\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_ae57d994c79de782285455c9c6524a1c4}{getName}}(),\ scale);}
\DoxyCodeLine{00935\ \ \ \mbox{\hyperlink{classcovarianceBase_a0088413d6a15d12cd34ec06166302f5c}{\_fGlobalStepScale}}\ =\ scale;}
\DoxyCodeLine{00936\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_af30ca7861452e1446e55700f4b49b608}\label{classcovarianceBase_af30ca7861452e1446e55700f4b49b608}} 
\index{covarianceBase@{covarianceBase}!setThrowMatrix@{setThrowMatrix}}
\index{setThrowMatrix@{setThrowMatrix}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{setThrowMatrix()}{setThrowMatrix()}}
{\footnotesize\ttfamily void covariance\+Base\+::set\+Throw\+Matrix (\begin{DoxyParamCaption}\item[{TMatrix\+DSym $\ast$}]{cov }\end{DoxyParamCaption})}



Use new throw matrix, used in adaptive MCMC. 



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l01149}{1149}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01150\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{01151\ \ \ \ \textcolor{keywordflow}{if}\ (cov\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01152\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Could\ not\ find\ covariance\ matrix\ you\ provided\ to\ setThrowMatrix"{}});}
\DoxyCodeLine{01153\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{01154\ \ \ \}}
\DoxyCodeLine{01155\ }
\DoxyCodeLine{01156\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a6c3fe8db34c06299fd1633951ac00937}{covMatrix}}-\/>GetNrows()\ !=\ cov-\/>GetNrows())\ \{}
\DoxyCodeLine{01157\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Matrix\ given\ for\ throw\ Matrix\ is\ not\ the\ same\ size\ as\ the\ covariance\ matrix\ stored\ in\ object!"{}});}
\DoxyCodeLine{01158\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Stored\ covariance\ matrix\ size:\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a6c3fe8db34c06299fd1633951ac00937}{covMatrix}}-\/>GetNrows());}
\DoxyCodeLine{01159\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Given\ matrix\ size:\ \{\}"{}},\ cov-\/>GetNrows());}
\DoxyCodeLine{01160\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{01161\ \ \ \}}
\DoxyCodeLine{01162\ }
\DoxyCodeLine{01163\ \ \ \mbox{\hyperlink{classcovarianceBase_a6cb3d0b4096fbb55b040f70cd5b6e32b}{throwMatrix}}\ =\ \textcolor{keyword}{static\_cast<}TMatrixDSym*\textcolor{keyword}{>}(cov-\/>Clone());}
\DoxyCodeLine{01164\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classcovarianceBase_a838731abd6716940043b484b2b266f86}{use\_adaptive}}\ \&\&\ \mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_a39a099e5712cf605190a53a4355c700c}{AdaptionUpdate}}())\ \mbox{\hyperlink{classcovarianceBase_a8a709e1c6c58618cf65400eef1741cc7}{makeClosestPosDef}}(\mbox{\hyperlink{classcovarianceBase_a6cb3d0b4096fbb55b040f70cd5b6e32b}{throwMatrix}});}
\DoxyCodeLine{01165\ \ \ \textcolor{keywordflow}{else}\ \mbox{\hyperlink{classcovarianceBase_ae2850c8e2f2d4acfe322b0ebe65b07cf}{MakePosDef}}(\mbox{\hyperlink{classcovarianceBase_a6cb3d0b4096fbb55b040f70cd5b6e32b}{throwMatrix}});}
\DoxyCodeLine{01166\ \ \ }
\DoxyCodeLine{01167\ \ \ TDecompChol\ TDecompChol\_throwMatrix(*\mbox{\hyperlink{classcovarianceBase_a6cb3d0b4096fbb55b040f70cd5b6e32b}{throwMatrix}});}
\DoxyCodeLine{01168\ \ \ }
\DoxyCodeLine{01169\ \ \ \textcolor{keywordflow}{if}(!TDecompChol\_throwMatrix.Decompose())\ \{}
\DoxyCodeLine{01170\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Cholesky\ decomposition\ failed\ for\ \{\}\ trying\ to\ make\ positive\ definite"{}},\ \mbox{\hyperlink{classcovarianceBase_a26618d3f5633b33ce20e38ce8261b3ee}{matrixName}});}
\DoxyCodeLine{01171\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{01172\ \ \ \}}
\DoxyCodeLine{01173\ }
\DoxyCodeLine{01174\ \ \ \mbox{\hyperlink{classcovarianceBase_ab95f5e066c2dfb1d20d120bc6c85dda2}{throwMatrix\_CholDecomp}}\ =\ \textcolor{keyword}{new}\ TMatrixD(TDecompChol\_throwMatrix.GetU());}
\DoxyCodeLine{01175\ \ \ \mbox{\hyperlink{classcovarianceBase_ab95f5e066c2dfb1d20d120bc6c85dda2}{throwMatrix\_CholDecomp}}-\/>T();}
\DoxyCodeLine{01176\ }
\DoxyCodeLine{01177\ \ \ \textcolor{comment}{//KS:\ ROOT\ has\ bad\ memory\ management,\ using\ standard\ double\ means\ we\ can\ decrease\ most\ operation\ by\ factor\ 2\ simply\ due\ to\ cache\ hits}}
\DoxyCodeLine{01178\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{01179\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for\ collapse(2)}}
\DoxyCodeLine{01180\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{01181\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)}
\DoxyCodeLine{01182\ \ \ \{}
\DoxyCodeLine{01183\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++j)}
\DoxyCodeLine{01184\ \ \ \ \ \{}
\DoxyCodeLine{01185\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}}[i][j]\ =\ (*throwMatrix\_CholDecomp)(i,j);}
\DoxyCodeLine{01186\ \ \ \ \ \}}
\DoxyCodeLine{01187\ \ \ \}}
\DoxyCodeLine{01188\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a5ab3d89b7fe6103ae6f750c984bcefc8}\label{classcovarianceBase_a5ab3d89b7fe6103ae6f750c984bcefc8}} 
\index{covarianceBase@{covarianceBase}!setThrowMatrixFromFile@{setThrowMatrixFromFile}}
\index{setThrowMatrixFromFile@{setThrowMatrixFromFile}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{setThrowMatrixFromFile()}{setThrowMatrixFromFile()}}
{\footnotesize\ttfamily void covariance\+Base\+::set\+Throw\+Matrix\+From\+File (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{matrix\+\_\+file\+\_\+name,  }\item[{const std\+::string \&}]{matrix\+\_\+name,  }\item[{const std\+::string \&}]{means\+\_\+name }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



sets throw matrix from a file 


\begin{DoxyParams}{Parameters}
{\em matrix\+\_\+file\+\_\+name} & name of file matrix lives in \\
\hline
{\em matrix\+\_\+name} & name of matrix in file \\
\hline
{\em means\+\_\+name} & name of means vec in file \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classcovarianceBase_aa5d82895bcbae7773b6813c02cf2f485}\label{classcovarianceBase_aa5d82895bcbae7773b6813c02cf2f485}} 
\index{covarianceBase@{covarianceBase}!throwParameters@{throwParameters}}
\index{throwParameters@{throwParameters}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{throwParameters()}{throwParameters()}}
{\footnotesize\ttfamily void covariance\+Base\+::throw\+Parameters (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Throw the parameters according to the covariance matrix. This shouldn\textquotesingle{}t be used in MCMC code ase it can break Detailed Balance;. 



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00470}{470}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00471\ \textcolor{comment}{//\ *************************************}}
\DoxyCodeLine{00472\ \ \ \textcolor{comment}{//\ First\ draw\ new\ randParams}}
\DoxyCodeLine{00473\ \ \ \mbox{\hyperlink{classcovarianceBase_a3432b7a9acc1243b8bdb17ec0b40d195}{randomize}}();}
\DoxyCodeLine{00474\ }
\DoxyCodeLine{00475\ \ \ \textcolor{comment}{//\ KS:\ We\ use\ PCA\ very\ rarely\ on\ top\ PCA\ functionality\ isn't\ implemented\ for\ this\ function.}}
\DoxyCodeLine{00476\ \ \ \textcolor{comment}{//\ Use\ \_\_builtin\_expect\ to\ give\ compiler\ a\ hint\ which\ option\ is\ more\ likely,\ which\ should\ help}}
\DoxyCodeLine{00477\ \ \ \textcolor{comment}{//\ with\ better\ optimisation.\ This\ isn't\ critical\ but\ more\ to\ have\ example}}
\DoxyCodeLine{00478\ \ \ \textcolor{keywordflow}{if}\ (\_\_builtin\_expect(!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}},\ 1))\ \{}
\DoxyCodeLine{00479\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a64aaa71f81750ba27977c0405c51cd88}{MatrixVectorMulti}}(\mbox{\hyperlink{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}{corr\_throw}},\ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}},\ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}},\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{00480\ }
\DoxyCodeLine{00481\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{00482\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{00483\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{00484\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \textcolor{comment}{//\ Check\ if\ parameter\ is\ fixed\ first:\ if\ so\ don't\ randomly\ throw}}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a2424eaebd9daa92b0294b352310770a3}{isParameterFixed}}(i))\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00487\ }
\DoxyCodeLine{00488\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i]\ +\ \mbox{\hyperlink{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}{corr\_throw}}[i];}
\DoxyCodeLine{00489\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \textcolor{keywordflow}{throws}\ =\ 0;}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \textcolor{comment}{//\ Try\ again\ if\ we\ the\ initial\ parameter\ proposal\ falls\ outside\ of\ the\ range\ of\ the\ parameter}}
\DoxyCodeLine{00491\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ >\ \mbox{\hyperlink{classcovarianceBase_a31e636cb6de871bd0c2c8e7e299df9e7}{\_fUpBound}}[i]\ ||\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ <\ \mbox{\hyperlink{classcovarianceBase_a8f1d94838f188cc85c4f82557c0b0b66}{\_fLowBound}}[i])\ \{}
\DoxyCodeLine{00492\ \textcolor{preprocessor}{\#ifdef\ MULTITHREAD}}
\DoxyCodeLine{00493\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}[omp\_get\_thread\_num()]-\/>Gaus(0,\ 1);}
\DoxyCodeLine{00494\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}{random\_number}}[0]-\/>Gaus(0,1);}
\DoxyCodeLine{00496\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00497\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ corr\_throw\_single\ =\ \mbox{\hyperlink{classcovarianceBase_a767242ffde1e52dff143889e5534b4e3}{MatrixVectorMultiSingle}}(\mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}},\ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}},\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}},\ i);}
\DoxyCodeLine{00498\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i]\ +\ corr\_throw\_single;}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordflow}{throws}\ >\ 10000)\ }
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Since\ we\ are\ multithreading\ there\ is\ danger\ that\ those\ messages}}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//will\ be\ all\ over\ the\ place,\ small\ price\ to\ pay\ for\ faster\ code}}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Tried\ \{\}\ times\ to\ throw\ parameter\ \{\}\ but\ failed"{}},\ \textcolor{keywordflow}{throws},\ i);}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Matrix:\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a26618d3f5633b33ce20e38ce8261b3ee}{matrixName}});}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Param:\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}{\_fNames}}[i]);}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}Setting\ \_fPropVal:\ \ \{\}\ to\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i],\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i]);}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}I\ live\ at\ \{\}:\{\}"{}},\ \_\_FILE\_\_,\ \_\_LINE\_\_);}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}{\_fPreFitValue}}[i];}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//throw\ MaCh3Exception(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00511\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throws}++;}
\DoxyCodeLine{00512\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i];}
\DoxyCodeLine{00514\ \ \ \ \ \}}
\DoxyCodeLine{00515\ \ \ \}}
\DoxyCodeLine{00516\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00517\ \ \ \{}
\DoxyCodeLine{00518\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a07ff6d6a15b24f94afc88a1b89779beb}{MACH3LOG\_CRITICAL}}(\textcolor{stringliteral}{"{}Hold\ on,\ you\ are\ trying\ to\ run\ Prior\ Predictive\ Code\ with\ PCA,\ which\ is\ wrong"{}});}
\DoxyCodeLine{00519\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a07ff6d6a15b24f94afc88a1b89779beb}{MACH3LOG\_CRITICAL}}(\textcolor{stringliteral}{"{}Sorry\ I\ have\ to\ kill\ you,\ I\ mean\ your\ job"{}});}
\DoxyCodeLine{00520\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00521\ \ \ \}}
\DoxyCodeLine{00522\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a4e92a9db846d956473efbe5712c71d31}\label{classcovarianceBase_a4e92a9db846d956473efbe5712c71d31}} 
\index{covarianceBase@{covarianceBase}!throwParCurr@{throwParCurr}}
\index{throwParCurr@{throwParCurr}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{throwParCurr()}{throwParCurr()}}
{\footnotesize\ttfamily void covariance\+Base\+::throw\+Par\+Curr (\begin{DoxyParamCaption}\item[{const double}]{mag = {\ttfamily 1.} }\end{DoxyParamCaption})}



Helper function to throw the current parameter by mag sigma. Can study bias in MCMC with this; put different starting parameters. 



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00740}{740}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00740\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00741\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00742\ \ \ \mbox{\hyperlink{classcovarianceBase_a3432b7a9acc1243b8bdb17ec0b40d195}{randomize}}();}
\DoxyCodeLine{00743\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{}
\DoxyCodeLine{00744\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ correlated\ throw\ vector}}
\DoxyCodeLine{00745\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a64aaa71f81750ba27977c0405c51cd88}{MatrixVectorMulti}}(\mbox{\hyperlink{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}{corr\_throw}},\ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}},\ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}},\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{00746\ \ \ \ \ \textcolor{comment}{//\ The\ number\ of\ sigmas\ to\ throw}}
\DoxyCodeLine{00747\ \ \ \ \ \textcolor{comment}{//\ Should\ probably\ have\ this\ as\ a\ default\ parameter\ input\ to\ the\ function\ instead}}
\DoxyCodeLine{00748\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)\ \{}
\DoxyCodeLine{00749\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}[i]\ >\ 0.)\{}
\DoxyCodeLine{00750\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}{corr\_throw}}[i]*mag;}
\DoxyCodeLine{00751\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00752\ \ \ \ \ \}}
\DoxyCodeLine{00753\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00754\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)\ \{}
\DoxyCodeLine{00755\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}{fParProp\_PCA}}(i)\ =\ mag*\mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}}[i];}
\DoxyCodeLine{00756\ \ \ \ \ \}}
\DoxyCodeLine{00757\ \ \ \ \ \textcolor{comment}{//\ And\ update\ the\ fParCurr\ in\ the\ basis}}
\DoxyCodeLine{00758\ \ \ \ \ \textcolor{comment}{//\ Then\ update\ the\ fParProp\ in\ the\ parameter\ basis\ using\ the\ transfer\ matrix,\ so\ likelihood\ is\ evaluated\ correctly}}
\DoxyCodeLine{00759\ \ \ \ \ TVectorD\ current\ =\ \mbox{\hyperlink{classcovarianceBase_ad0022a3e9dd3b2661c9b02a02488759c}{PCAObj}}.\mbox{\hyperlink{classPCAHandler_a1d9302633ed96ec57fbe26d25cbcee61}{TransferMat}}*\mbox{\hyperlink{classcovarianceBase_aa96f87ab90dc26fc1b5e157149b9dfd3}{fParCurr\_PCA}};}
\DoxyCodeLine{00760\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{00761\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a7b83a17de68cc7838b93de242d91d9a0}{fParSigma\_PCA}}[i]\ >\ 0.)\ \{}
\DoxyCodeLine{00762\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i]\ =\ current(i);}
\DoxyCodeLine{00763\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00764\ \ \ \ \ \}}
\DoxyCodeLine{00765\ \ \ \}}
\DoxyCodeLine{00766\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_af4d127ff4761379dd11843523835c4dc}\label{classcovarianceBase_af4d127ff4761379dd11843523835c4dc}} 
\index{covarianceBase@{covarianceBase}!throwParProp@{throwParProp}}
\index{throwParProp@{throwParProp}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{throwParProp()}{throwParProp()}}
{\footnotesize\ttfamily void covariance\+Base\+::throw\+Par\+Prop (\begin{DoxyParamCaption}\item[{const double}]{mag = {\ttfamily 1.} }\end{DoxyParamCaption})}



Throw the proposed parameter by mag sigma. Should really just have the user specify this throw by having argument double. 



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00712}{712}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00712\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00713\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00714\ \ \ \mbox{\hyperlink{classcovarianceBase_a3432b7a9acc1243b8bdb17ec0b40d195}{randomize}}();}
\DoxyCodeLine{00715\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{}
\DoxyCodeLine{00716\ \ \ \ \ \textcolor{comment}{//\ Make\ the\ correlated\ throw}}
\DoxyCodeLine{00717\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a64aaa71f81750ba27977c0405c51cd88}{MatrixVectorMulti}}(\mbox{\hyperlink{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}{corr\_throw}},\ \mbox{\hyperlink{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}{throwMatrixCholDecomp}},\ \mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}},\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{00718\ \ \ \ \ \textcolor{comment}{//\ Number\ of\ sigmas\ we\ throw}}
\DoxyCodeLine{00719\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)\ \{}
\DoxyCodeLine{00720\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}[i]\ >\ 0.)}
\DoxyCodeLine{00721\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ =\ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i]\ +\ \mbox{\hyperlink{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}{corr\_throw}}[i]*mag;}
\DoxyCodeLine{00722\ \ \ \ \ \}}
\DoxyCodeLine{00723\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00724\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)\ \{}
\DoxyCodeLine{00725\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}{fParProp\_PCA}}(i)\ =\ \mbox{\hyperlink{classcovarianceBase_aa96f87ab90dc26fc1b5e157149b9dfd3}{fParCurr\_PCA}}(i)+mag*\mbox{\hyperlink{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}{randParams}}[i];}
\DoxyCodeLine{00726\ \ \ \ \ \}}
\DoxyCodeLine{00727\ \ \ \ \ \textcolor{comment}{//\ And\ update\ the\ fParCurr\ in\ the\ basis}}
\DoxyCodeLine{00728\ \ \ \ \ \textcolor{comment}{//\ Then\ update\ the\ fParProp\ in\ the\ parameter\ basis\ using\ the\ transfer\ matrix,\ so\ likelihood\ is\ evaluated\ correctly}}
\DoxyCodeLine{00729\ \ \ \ \ TVectorD\ proposed\ =\ \mbox{\hyperlink{classcovarianceBase_ad0022a3e9dd3b2661c9b02a02488759c}{PCAObj}}.\mbox{\hyperlink{classPCAHandler_a1d9302633ed96ec57fbe26d25cbcee61}{TransferMat}}*\mbox{\hyperlink{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}{fParProp\_PCA}};}
\DoxyCodeLine{00730\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{00731\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classcovarianceBase_a7b83a17de68cc7838b93de242d91d9a0}{fParSigma\_PCA}}[i]\ >\ 0.)\ \{}
\DoxyCodeLine{00732\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ =\ proposed(i);}
\DoxyCodeLine{00733\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00734\ \ \ \ \ \}}
\DoxyCodeLine{00735\ \ \ \}}
\DoxyCodeLine{00736\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_adb2d1a39cd2bd160257bc9e34e32df4c}\label{classcovarianceBase_adb2d1a39cd2bd160257bc9e34e32df4c}} 
\index{covarianceBase@{covarianceBase}!toggleFixAllParameters@{toggleFixAllParameters}}
\index{toggleFixAllParameters@{toggleFixAllParameters}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{toggleFixAllParameters()}{toggleFixAllParameters()}}
{\footnotesize\ttfamily void covariance\+Base\+::toggle\+Fix\+All\+Parameters (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



fix parameters at prior values 



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00939}{939}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00939\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00940\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00941\ \ \ \textcolor{comment}{//\ fix\ or\ unfix\ all\ parameters\ by\ multiplying\ by\ -\/1}}
\DoxyCodeLine{00942\ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})}
\DoxyCodeLine{00943\ \ \ \{}
\DoxyCodeLine{00944\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ i++)\ \mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}[i]\ *=\ -\/1.0;}
\DoxyCodeLine{00945\ \ \ \}\ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{00946\ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}};\ i++)\ \mbox{\hyperlink{classcovarianceBase_a7b83a17de68cc7838b93de242d91d9a0}{fParSigma\_PCA}}[i]\ *=\ -\/1.0;}
\DoxyCodeLine{00947\ \ \ \}}
\DoxyCodeLine{00948\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00949\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_aafbbdc05b87df882dc341e20fe870603}\label{classcovarianceBase_aafbbdc05b87df882dc341e20fe870603}} 
\index{covarianceBase@{covarianceBase}!toggleFixParameter@{toggleFixParameter}}
\index{toggleFixParameter@{toggleFixParameter}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{toggleFixParameter()}{toggleFixParameter()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void covariance\+Base\+::toggle\+Fix\+Parameter (\begin{DoxyParamCaption}\item[{const int}]{i }\end{DoxyParamCaption})}



fix parameter at prior values 


\begin{DoxyParams}{Parameters}
{\em i} & Parameter index \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00952}{952}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00952\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00953\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00954\ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{}
\DoxyCodeLine{00955\ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ >\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}})\ \{}
\DoxyCodeLine{00956\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Can't\ toggleFixParameter\ for\ parameter\ \{\}\ because\ size\ of\ covariance\ =\{\}"{}},\ i,\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{00957\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Fix\ this\ in\ your\ config\ file\ please!"{}});}
\DoxyCodeLine{00958\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00959\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00960\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}{\_fError}}[i]\ *=\ -\/1.0;}
\DoxyCodeLine{00961\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Setting\ \{\}(parameter\ \{\})\ to\ fixed\ at\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a6a46b5fed3e7feb6e9e151e90927bdbc}{GetParFancyName}}(i),\ i,\ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i]);}
\DoxyCodeLine{00962\ \ \ \ \ \}}
\DoxyCodeLine{00963\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00964\ \ \ \ \ \textcolor{keywordtype}{int}\ isDecom\ =\ -\/1;}
\DoxyCodeLine{00965\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ im\ =\ 0;\ im\ <\ \mbox{\hyperlink{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}{\_fNumParPCA}};\ ++im)\ \{}
\DoxyCodeLine{00966\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classcovarianceBase_ae9f3cb2a310874b86965903714ef2bd8}{isDecomposed\_PCA}}[im]\ ==\ i)\ \{isDecom\ =\ im;\}}
\DoxyCodeLine{00967\ \ \ \ \ \}}
\DoxyCodeLine{00968\ \ \ \ \ \textcolor{keywordflow}{if}(isDecom\ <\ 0)\ \{}
\DoxyCodeLine{00969\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Parameter\ \{\}\ is\ PCA\ decomposed\ can't\ fix\ this"{}},\ \mbox{\hyperlink{classcovarianceBase_a033c5b6a8669537acaa6c5fc252899e6}{GetParName}}(i));}
\DoxyCodeLine{00970\ \ \ \ \ \ \ \textcolor{comment}{//throw\ MaCh3Exception(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}}
\DoxyCodeLine{00971\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00972\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a7b83a17de68cc7838b93de242d91d9a0}{fParSigma\_PCA}}[isDecom]\ *=\ -\/1.0;}
\DoxyCodeLine{00973\ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Setting\ un-\/decomposed\ \{\}(parameter\ \{\}/\{\}\ in\ PCA\ base)\ to\ fixed\ at\ \{\}"{}},\ \mbox{\hyperlink{classcovarianceBase_a033c5b6a8669537acaa6c5fc252899e6}{GetParName}}(i),\ i,\ isDecom,\ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i]);}
\DoxyCodeLine{00974\ \ \ \ \ \}}
\DoxyCodeLine{00975\ \ \ \}}
\DoxyCodeLine{00976\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00977\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a41cc8dd2185af7cee380f3c6d463e5a4}\label{classcovarianceBase_a41cc8dd2185af7cee380f3c6d463e5a4}} 
\index{covarianceBase@{covarianceBase}!toggleFixParameter@{toggleFixParameter}}
\index{toggleFixParameter@{toggleFixParameter}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{toggleFixParameter()}{toggleFixParameter()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void covariance\+Base\+::toggle\+Fix\+Parameter (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{name }\end{DoxyParamCaption})}



Fix parameter at prior values. 


\begin{DoxyParams}{Parameters}
{\em name} & Name of parameter you want to fix \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00980}{980}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00980\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00981\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00982\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{00983\ \ \ \ \ \textcolor{keywordflow}{if}(name\ ==\ \mbox{\hyperlink{classcovarianceBase_a973671386a2f8ea924f25f8f5404654c}{\_fFancyNames}}[i])\ \{}
\DoxyCodeLine{00984\ \ \ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_aafbbdc05b87df882dc341e20fe870603}{toggleFixParameter}}(i);}
\DoxyCodeLine{00985\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00986\ \ \ \ \ \}}
\DoxyCodeLine{00987\ \ \ \}}
\DoxyCodeLine{00988\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_ad5b2eb6377721e3ac95def22c2386bb1}{MACH3LOG\_WARN}}(\textcolor{stringliteral}{"{}I\ couldn't\ find\ parameter\ with\ name\ \{\},\ therefore\ will\ not\ fix\ it"{}},\ name);}
\DoxyCodeLine{00989\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a65ac4956a782b01768f445732522a450}\label{classcovarianceBase_a65ac4956a782b01768f445732522a450}} 
\index{covarianceBase@{covarianceBase}!TransferToParam@{TransferToParam}}
\index{TransferToParam@{TransferToParam}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{TransferToParam()}{TransferToParam()}}
{\footnotesize\ttfamily void covariance\+Base\+::\+Transfer\+To\+Param (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Transfer param values from PCA base to normal base. 



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00441}{441}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00442\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00443\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{}
\DoxyCodeLine{00444\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Can\ not\ transfer\ to\ PCA\ if\ PCA\ isn't\ enabled"{}});}
\DoxyCodeLine{00445\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00446\ \ \ \}}
\DoxyCodeLine{00447\ }
\DoxyCodeLine{00448\ \ \ \textcolor{comment}{//\ Make\ the\ temporary\ vectors}}
\DoxyCodeLine{00449\ \ \ TVectorD\ fParProp\_vec\ =\ \mbox{\hyperlink{classcovarianceBase_ad0022a3e9dd3b2661c9b02a02488759c}{PCAObj}}.\mbox{\hyperlink{classPCAHandler_a1d9302633ed96ec57fbe26d25cbcee61}{TransferMat}}*\mbox{\hyperlink{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}{fParProp\_PCA}};}
\DoxyCodeLine{00450\ \ \ TVectorD\ fParCurr\_vec\ =\ \mbox{\hyperlink{classcovarianceBase_ad0022a3e9dd3b2661c9b02a02488759c}{PCAObj}}.\mbox{\hyperlink{classPCAHandler_a1d9302633ed96ec57fbe26d25cbcee61}{TransferMat}}*\mbox{\hyperlink{classcovarianceBase_aa96f87ab90dc26fc1b5e157149b9dfd3}{fParCurr\_PCA}};}
\DoxyCodeLine{00451\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{00452\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{00453\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{00454\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{00455\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i]\ =\ fParProp\_vec(i);}
\DoxyCodeLine{00456\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i]\ =\ fParCurr\_vec(i);}
\DoxyCodeLine{00457\ \ \ \}}
\DoxyCodeLine{00458\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a651f5ecd8973918d5683606a607fa88c}\label{classcovarianceBase_a651f5ecd8973918d5683606a607fa88c}} 
\index{covarianceBase@{covarianceBase}!TransferToPCA@{TransferToPCA}}
\index{TransferToPCA@{TransferToPCA}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{TransferToPCA()}{TransferToPCA()}}
{\footnotesize\ttfamily void covariance\+Base\+::\+Transfer\+To\+PCA (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Transfer param values from normal base to PCA base. 



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l00421}{421}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00422\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{00423\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}{pca}})\ \{}
\DoxyCodeLine{00424\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Can\ not\ transfer\ to\ PCA\ if\ PCA\ isn't\ enabled"{}});}
\DoxyCodeLine{00425\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00426\ \ \ \}}
\DoxyCodeLine{00427\ \ \ \textcolor{comment}{//\ Make\ the\ temporary\ vectors}}
\DoxyCodeLine{00428\ \ \ TVectorD\ fParCurr\_vec(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{00429\ \ \ TVectorD\ fParProp\_vec(\mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{00430\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}};\ ++i)\ \{}
\DoxyCodeLine{00431\ \ \ \ \ fParCurr\_vec(i)\ =\ \mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}}[i];}
\DoxyCodeLine{00432\ \ \ \ \ fParProp\_vec(i)\ =\ \mbox{\hyperlink{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}{\_fPropVal}}[i];}
\DoxyCodeLine{00433\ \ \ \}}
\DoxyCodeLine{00434\ }
\DoxyCodeLine{00435\ \ \ \mbox{\hyperlink{classcovarianceBase_aa96f87ab90dc26fc1b5e157149b9dfd3}{fParCurr\_PCA}}\ =\ \mbox{\hyperlink{classcovarianceBase_ad0022a3e9dd3b2661c9b02a02488759c}{PCAObj}}.\mbox{\hyperlink{classPCAHandler_a6f6443a487bb544e6a6e458d86f35f27}{TransferMatT}}*fParCurr\_vec;}
\DoxyCodeLine{00436\ \ \ \mbox{\hyperlink{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}{fParProp\_PCA}}\ =\ \mbox{\hyperlink{classcovarianceBase_ad0022a3e9dd3b2661c9b02a02488759c}{PCAObj}}.\mbox{\hyperlink{classPCAHandler_a6f6443a487bb544e6a6e458d86f35f27}{TransferMatT}}*fParProp\_vec;}
\DoxyCodeLine{00437\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a50ce8ebb96ebd64190dc37e4bf950a9b}\label{classcovarianceBase_a50ce8ebb96ebd64190dc37e4bf950a9b}} 
\index{covarianceBase@{covarianceBase}!updateAdaptiveCovariance@{updateAdaptiveCovariance}}
\index{updateAdaptiveCovariance@{updateAdaptiveCovariance}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{updateAdaptiveCovariance()}{updateAdaptiveCovariance()}}
{\footnotesize\ttfamily void covariance\+Base\+::update\+Adaptive\+Covariance (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Method to update adaptive MCMC. 

\begin{DoxySeeAlso}{See also}
\href{https://projecteuclid.org/journals/bernoulli/volume-7/issue-2/An-adaptive-Metropolis-algorithm/bj/1080222083.full}{\texttt{ https\+://projecteuclid.\+org/journals/bernoulli/volume-\/7/issue-\/2/\+An-\/adaptive-\/\+Metropolis-\/algorithm/bj/1080222083.\+full}} 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l01234}{1234}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01234\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01235\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{01236\ \ \ \textcolor{comment}{//\ Updates\ adaptive\ matrix}}
\DoxyCodeLine{01237\ \ \ \textcolor{comment}{//\ First\ we\ update\ the\ total\ means}}
\DoxyCodeLine{01238\ }
\DoxyCodeLine{01239\ \ \ \textcolor{comment}{//\ Skip\ this\ if\ we're\ at\ a\ large\ number\ of\ steps}}
\DoxyCodeLine{01240\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_af797ab969eb8c1802afa12df8c2106d8}{SkipAdaption}}())\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01241\ }
\DoxyCodeLine{01242\ \ \ \textcolor{comment}{//\ Call\ main\ adaption\ function}}
\DoxyCodeLine{01243\ \ \ \mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_a828e12f4ecb82252341af5f5e54f7ad3}{UpdateAdaptiveCovariance}}(\mbox{\hyperlink{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}{\_fCurrVal}},\ \mbox{\hyperlink{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}{\_fNumPar}});}
\DoxyCodeLine{01244\ }
\DoxyCodeLine{01245\ \ \ \textcolor{comment}{//This\ is\ likely\ going\ to\ be\ the\ slow\ bit!}}
\DoxyCodeLine{01246\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_a77726d0255edf32a817339fcbac30bee}{IndivStepScaleAdapt}}())\ \{}
\DoxyCodeLine{01247\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a0993a1ea6c5b06ba834e9e70af87ee9e}{resetIndivStepScale}}();}
\DoxyCodeLine{01248\ \ \ \}}
\DoxyCodeLine{01249\ }
\DoxyCodeLine{01250\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_a217c72a492c9d3e1b3a7b14626d19ab2}{UpdateMatrixAdapt}}())\ \{}
\DoxyCodeLine{01251\ \ \ \ \ TMatrixDSym*\ update\_matrix\ =\ \textcolor{keyword}{static\_cast<}TMatrixDSym*\textcolor{keyword}{>}(\mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_afd61e64f18f5c25dbbd6bb2bd619a268}{adaptive\_covariance}}-\/>Clone());}
\DoxyCodeLine{01252\ \ \ \ \ \mbox{\hyperlink{classcovarianceBase_a7e2d3623bbbf3edee558e04737fe2add}{updateThrowMatrix}}(update\_matrix);\ \textcolor{comment}{//Now\ we\ update\ and\ continue!}}
\DoxyCodeLine{01253\ \ \ \}}
\DoxyCodeLine{01254\ \ \ \mbox{\hyperlink{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}{AdaptiveHandler}}.\mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler_ab2837af4566e2d62db7b76f9527fb6d7}{total\_steps}}++;}
\DoxyCodeLine{01255\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classcovarianceBase_a7e2d3623bbbf3edee558e04737fe2add}\label{classcovarianceBase_a7e2d3623bbbf3edee558e04737fe2add}} 
\index{covarianceBase@{covarianceBase}!updateThrowMatrix@{updateThrowMatrix}}
\index{updateThrowMatrix@{updateThrowMatrix}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{updateThrowMatrix()}{updateThrowMatrix()}}
{\footnotesize\ttfamily void covariance\+Base\+::update\+Throw\+Matrix (\begin{DoxyParamCaption}\item[{TMatrix\+DSym $\ast$}]{cov }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{covarianceBase_8cpp_source_l01191}{1191}} of file \mbox{\hyperlink{covarianceBase_8cpp_source}{covariance\+Base.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01191\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01192\ \textcolor{comment}{//\ ********************************************}}
\DoxyCodeLine{01193\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classcovarianceBase_a6cb3d0b4096fbb55b040f70cd5b6e32b}{throwMatrix}};}
\DoxyCodeLine{01194\ \ \ \mbox{\hyperlink{classcovarianceBase_a6cb3d0b4096fbb55b040f70cd5b6e32b}{throwMatrix}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01195\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classcovarianceBase_ab95f5e066c2dfb1d20d120bc6c85dda2}{throwMatrix\_CholDecomp}};}
\DoxyCodeLine{01196\ \ \ \mbox{\hyperlink{classcovarianceBase_ab95f5e066c2dfb1d20d120bc6c85dda2}{throwMatrix\_CholDecomp}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01197\ \ \ \mbox{\hyperlink{classcovarianceBase_af30ca7861452e1446e55700f4b49b608}{setThrowMatrix}}(cov);}
\DoxyCodeLine{01198\ \}}

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}\label{classcovarianceBase_ae70f51df3976975b2dc78fd3bfc28b65}} 
\index{covarianceBase@{covarianceBase}!\_fCurrVal@{\_fCurrVal}}
\index{\_fCurrVal@{\_fCurrVal}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{\_fCurrVal}{\_fCurrVal}}
{\footnotesize\ttfamily std\+::vector$<$double$>$ covariance\+Base\+::\+\_\+f\+Curr\+Val\hspace{0.3cm}{\ttfamily [protected]}}



Current value of the parameter. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00422}{422}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}\label{classcovarianceBase_a34f877fc160b4a93a3aab1b3a8977858}} 
\index{covarianceBase@{covarianceBase}!\_fError@{\_fError}}
\index{\_fError@{\_fError}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{\_fError}{\_fError}}
{\footnotesize\ttfamily std\+::vector$<$double$>$ covariance\+Base\+::\+\_\+f\+Error\hspace{0.3cm}{\ttfamily [protected]}}



Prior error on the parameter. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00428}{428}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a973671386a2f8ea924f25f8f5404654c}\label{classcovarianceBase_a973671386a2f8ea924f25f8f5404654c}} 
\index{covarianceBase@{covarianceBase}!\_fFancyNames@{\_fFancyNames}}
\index{\_fFancyNames@{\_fFancyNames}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{\_fFancyNames}{\_fFancyNames}}
{\footnotesize\ttfamily std\+::vector$<$std\+::string$>$ covariance\+Base\+::\+\_\+f\+Fancy\+Names\hspace{0.3cm}{\ttfamily [protected]}}



Fancy name for example rather than xsec\+\_\+0 it is MAQE, useful for human reading. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00414}{414}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_ad9c47deb7009bff81210f666e80012eb}\label{classcovarianceBase_ad9c47deb7009bff81210f666e80012eb}} 
\index{covarianceBase@{covarianceBase}!\_fFlatPrior@{\_fFlatPrior}}
\index{\_fFlatPrior@{\_fFlatPrior}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{\_fFlatPrior}{\_fFlatPrior}}
{\footnotesize\ttfamily std\+::vector$<$bool$>$ covariance\+Base\+::\+\_\+f\+Flat\+Prior\hspace{0.3cm}{\ttfamily [protected]}}



Whether to apply flat prior or not. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00436}{436}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a9b753f52711600a9f8d648531d95b044}\label{classcovarianceBase_a9b753f52711600a9f8d648531d95b044}} 
\index{covarianceBase@{covarianceBase}!\_fGenerated@{\_fGenerated}}
\index{\_fGenerated@{\_fGenerated}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{\_fGenerated}{\_fGenerated}}
{\footnotesize\ttfamily std\+::vector$<$double$>$ covariance\+Base\+::\+\_\+f\+Generated\hspace{0.3cm}{\ttfamily [protected]}}



Generated value of the parameter. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00426}{426}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a0088413d6a15d12cd34ec06166302f5c}\label{classcovarianceBase_a0088413d6a15d12cd34ec06166302f5c}} 
\index{covarianceBase@{covarianceBase}!\_fGlobalStepScale@{\_fGlobalStepScale}}
\index{\_fGlobalStepScale@{\_fGlobalStepScale}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{\_fGlobalStepScale}{\_fGlobalStepScale}}
{\footnotesize\ttfamily double covariance\+Base\+::\+\_\+f\+Global\+Step\+Scale\hspace{0.3cm}{\ttfamily [protected]}}



Global step scale applied ot all params in this class. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00406}{406}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a3cda39026e336a49cef482efd4062561}\label{classcovarianceBase_a3cda39026e336a49cef482efd4062561}} 
\index{covarianceBase@{covarianceBase}!\_fIndivStepScale@{\_fIndivStepScale}}
\index{\_fIndivStepScale@{\_fIndivStepScale}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{\_fIndivStepScale}{\_fIndivStepScale}}
{\footnotesize\ttfamily std\+::vector$<$double$>$ covariance\+Base\+::\+\_\+f\+Indiv\+Step\+Scale\hspace{0.3cm}{\ttfamily [protected]}}



Individual step scale used by MCMC algorithm. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00434}{434}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a8f1d94838f188cc85c4f82557c0b0b66}\label{classcovarianceBase_a8f1d94838f188cc85c4f82557c0b0b66}} 
\index{covarianceBase@{covarianceBase}!\_fLowBound@{\_fLowBound}}
\index{\_fLowBound@{\_fLowBound}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{\_fLowBound}{\_fLowBound}}
{\footnotesize\ttfamily std\+::vector$<$double$>$ covariance\+Base\+::\+\_\+f\+Low\+Bound\hspace{0.3cm}{\ttfamily [protected]}}



Lowest physical bound, parameter will not be able to go beyond it. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00430}{430}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}\label{classcovarianceBase_a3e502d80fd2c30a7da4fe75a3e05b0da}} 
\index{covarianceBase@{covarianceBase}!\_fNames@{\_fNames}}
\index{\_fNames@{\_fNames}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{\_fNames}{\_fNames}}
{\footnotesize\ttfamily std\+::vector$<$std\+::string$>$ covariance\+Base\+::\+\_\+f\+Names\hspace{0.3cm}{\ttfamily [protected]}}



ETA \+\_\+f\+Names is set automatically in the covariance class to be something like xsec\+\_\+i, this is currently to make things compatible with the Diagnostic tools. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00412}{412}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}\label{classcovarianceBase_ac5d922f1a4163b38ebc7a3ef21eec376}} 
\index{covarianceBase@{covarianceBase}!\_fNumPar@{\_fNumPar}}
\index{\_fNumPar@{\_fNumPar}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{\_fNumPar}{\_fNumPar}}
{\footnotesize\ttfamily int covariance\+Base\+::\+\_\+f\+Num\+Par\hspace{0.3cm}{\ttfamily [protected]}}



Number of systematic parameters. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00418}{418}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}\label{classcovarianceBase_ac57285a48d41ef764b4c659959a36c2d}} 
\index{covarianceBase@{covarianceBase}!\_fNumParPCA@{\_fNumParPCA}}
\index{\_fNumParPCA@{\_fNumParPCA}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{\_fNumParPCA}{\_fNumParPCA}}
{\footnotesize\ttfamily int covariance\+Base\+::\+\_\+f\+Num\+Par\+PCA\hspace{0.3cm}{\ttfamily [protected]}}



Number of parameters in PCA base. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00446}{446}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}\label{classcovarianceBase_a7578a2cc2e8e9100fad88310a824cb1c}} 
\index{covarianceBase@{covarianceBase}!\_fPreFitValue@{\_fPreFitValue}}
\index{\_fPreFitValue@{\_fPreFitValue}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{\_fPreFitValue}{\_fPreFitValue}}
{\footnotesize\ttfamily std\+::vector$<$double$>$ covariance\+Base\+::\+\_\+f\+Pre\+Fit\+Value\hspace{0.3cm}{\ttfamily [protected]}}



Parameter value dictated by the prior model. Based on it penalty term is calculated. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00420}{420}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_ae6aada94037640a68e3f37898f276019}\label{classcovarianceBase_ae6aada94037640a68e3f37898f276019}} 
\index{covarianceBase@{covarianceBase}!\_fPreFitValue\_PCA@{\_fPreFitValue\_PCA}}
\index{\_fPreFitValue\_PCA@{\_fPreFitValue\_PCA}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{\_fPreFitValue\_PCA}{\_fPreFitValue\_PCA}}
{\footnotesize\ttfamily std\+::vector$<$double$>$ covariance\+Base\+::\+\_\+f\+Pre\+Fit\+Value\+\_\+\+PCA\hspace{0.3cm}{\ttfamily [protected]}}



Prefit value for PCA params. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00453}{453}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}\label{classcovarianceBase_a12f0eb31a5ef48b014baa11d4ab919e9}} 
\index{covarianceBase@{covarianceBase}!\_fPropVal@{\_fPropVal}}
\index{\_fPropVal@{\_fPropVal}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{\_fPropVal}{\_fPropVal}}
{\footnotesize\ttfamily std\+::vector$<$double$>$ covariance\+Base\+::\+\_\+f\+Prop\+Val\hspace{0.3cm}{\ttfamily [protected]}}



Proposed value of the parameter. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00424}{424}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a31e636cb6de871bd0c2c8e7e299df9e7}\label{classcovarianceBase_a31e636cb6de871bd0c2c8e7e299df9e7}} 
\index{covarianceBase@{covarianceBase}!\_fUpBound@{\_fUpBound}}
\index{\_fUpBound@{\_fUpBound}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{\_fUpBound}{\_fUpBound}}
{\footnotesize\ttfamily std\+::vector$<$double$>$ covariance\+Base\+::\+\_\+f\+Up\+Bound\hspace{0.3cm}{\ttfamily [protected]}}



Upper physical bound, parameter will not be able to go beyond it. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00432}{432}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a933ff3dc0af99629ba3582a5d9d89d23}\label{classcovarianceBase_a933ff3dc0af99629ba3582a5d9d89d23}} 
\index{covarianceBase@{covarianceBase}!\_fYAMLDoc@{\_fYAMLDoc}}
\index{\_fYAMLDoc@{\_fYAMLDoc}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{\_fYAMLDoc}{\_fYAMLDoc}}
{\footnotesize\ttfamily YAML\+::\+Node covariance\+Base\+::\+\_\+f\+YAMLDoc\hspace{0.3cm}{\ttfamily [protected]}}



Stores config describing systematics. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00416}{416}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}\label{classcovarianceBase_ab3833dc51a81afc9dca7c3dcbb107af7}} 
\index{covarianceBase@{covarianceBase}!AdaptiveHandler@{AdaptiveHandler}}
\index{AdaptiveHandler@{AdaptiveHandler}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{AdaptiveHandler}{AdaptiveHandler}}
{\footnotesize\ttfamily \mbox{\hyperlink{classadaptive__mcmc_1_1AdaptiveMCMCHandler}{adaptive\+\_\+mcmc\+::\+Adaptive\+MCMCHandler}} covariance\+Base\+::\+Adaptive\+Handler\hspace{0.3cm}{\ttfamily [protected]}}



Struct containing information about adaption. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00476}{476}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}\label{classcovarianceBase_a7b70de3f098aae1d537d80bac5969d88}} 
\index{covarianceBase@{covarianceBase}!corr\_throw@{corr\_throw}}
\index{corr\_throw@{corr\_throw}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{corr\_throw}{corr\_throw}}
{\footnotesize\ttfamily double$\ast$ covariance\+Base\+::corr\+\_\+throw\hspace{0.3cm}{\ttfamily [protected]}}



Result of multiplication of Cholesky matrix and rand\+Params. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00404}{404}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a6c3fe8db34c06299fd1633951ac00937}\label{classcovarianceBase_a6c3fe8db34c06299fd1633951ac00937}} 
\index{covarianceBase@{covarianceBase}!covMatrix@{covMatrix}}
\index{covMatrix@{covMatrix}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{covMatrix}{covMatrix}}
{\footnotesize\ttfamily TMatrix\+DSym$\ast$ covariance\+Base\+::cov\+Matrix\hspace{0.3cm}{\ttfamily [protected]}}



The covariance matrix. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00392}{392}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_add54ab1ba46b723fa23d7c95dfad671a}\label{classcovarianceBase_add54ab1ba46b723fa23d7c95dfad671a}} 
\index{covarianceBase@{covarianceBase}!eigen\_threshold@{eigen\_threshold}}
\index{eigen\_threshold@{eigen\_threshold}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{eigen\_threshold}{eigen\_threshold}}
{\footnotesize\ttfamily double covariance\+Base\+::eigen\+\_\+threshold\hspace{0.3cm}{\ttfamily [protected]}}



CW\+: Threshold based on which we remove parameters in eigen base. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00444}{444}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_abba75182305d556818c76974a054a17d}\label{classcovarianceBase_abba75182305d556818c76974a054a17d}} 
\index{covarianceBase@{covarianceBase}!FirstPCAdpar@{FirstPCAdpar}}
\index{FirstPCAdpar@{FirstPCAdpar}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{FirstPCAdpar}{FirstPCAdpar}}
{\footnotesize\ttfamily int covariance\+Base\+::\+First\+PCAdpar\hspace{0.3cm}{\ttfamily [protected]}}



Index of the first param that is being decomposed. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00448}{448}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_aa96f87ab90dc26fc1b5e157149b9dfd3}\label{classcovarianceBase_aa96f87ab90dc26fc1b5e157149b9dfd3}} 
\index{covarianceBase@{covarianceBase}!fParCurr\_PCA@{fParCurr\_PCA}}
\index{fParCurr\_PCA@{fParCurr\_PCA}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{fParCurr\_PCA}{fParCurr\_PCA}}
{\footnotesize\ttfamily TVectorD covariance\+Base\+::f\+Par\+Curr\+\_\+\+PCA\hspace{0.3cm}{\ttfamily [protected]}}



CW\+: Proposed parameter value in PCA base. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00457}{457}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}\label{classcovarianceBase_a2e101b6b7028c82a02e617c90212e4cc}} 
\index{covarianceBase@{covarianceBase}!fParProp\_PCA@{fParProp\_PCA}}
\index{fParProp\_PCA@{fParProp\_PCA}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{fParProp\_PCA}{fParProp\_PCA}}
{\footnotesize\ttfamily TVectorD covariance\+Base\+::f\+Par\+Prop\+\_\+\+PCA\hspace{0.3cm}{\ttfamily [protected]}}



CW\+: Current parameter value in PCA base. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00455}{455}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a7b83a17de68cc7838b93de242d91d9a0}\label{classcovarianceBase_a7b83a17de68cc7838b93de242d91d9a0}} 
\index{covarianceBase@{covarianceBase}!fParSigma\_PCA@{fParSigma\_PCA}}
\index{fParSigma\_PCA@{fParSigma\_PCA}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{fParSigma\_PCA}{fParSigma\_PCA}}
{\footnotesize\ttfamily std\+::vector$<$double$>$ covariance\+Base\+::f\+Par\+Sigma\+\_\+\+PCA\hspace{0.3cm}{\ttfamily [protected]}}



Tells if parameter is fixed in PCA base or not. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00459}{459}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a5451d4189a9fb7591c8ce728852ba82e}\label{classcovarianceBase_a5451d4189a9fb7591c8ce728852ba82e}} 
\index{covarianceBase@{covarianceBase}!inputFile@{inputFile}}
\index{inputFile@{inputFile}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{inputFile}{inputFile}}
{\footnotesize\ttfamily const std\+::string covariance\+Base\+::input\+File\hspace{0.3cm}{\ttfamily [protected]}}



The input root file we read in. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00387}{387}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a35c7dc7817eaf4058e9775b6bc792ebc}\label{classcovarianceBase_a35c7dc7817eaf4058e9775b6bc792ebc}} 
\index{covarianceBase@{covarianceBase}!invCovMatrix@{invCovMatrix}}
\index{invCovMatrix@{invCovMatrix}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{invCovMatrix}{invCovMatrix}}
{\footnotesize\ttfamily TMatrix\+DSym$\ast$ covariance\+Base\+::inv\+Cov\+Matrix\hspace{0.3cm}{\ttfamily [protected]}}



The inverse covariance matrix. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00394}{394}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}\label{classcovarianceBase_a49a8341eb8e997fb090749117320edf9}} 
\index{covarianceBase@{covarianceBase}!InvertCovMatrix@{InvertCovMatrix}}
\index{InvertCovMatrix@{InvertCovMatrix}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{InvertCovMatrix}{InvertCovMatrix}}
{\footnotesize\ttfamily double$\ast$$\ast$ covariance\+Base\+::\+Invert\+Cov\+Matrix\hspace{0.3cm}{\ttfamily [protected]}}



KS\+: Same as above but much faster as TMatrix\+DSym cache miss. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00396}{396}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_ae9f3cb2a310874b86965903714ef2bd8}\label{classcovarianceBase_ae9f3cb2a310874b86965903714ef2bd8}} 
\index{covarianceBase@{covarianceBase}!isDecomposed\_PCA@{isDecomposed\_PCA}}
\index{isDecomposed\_PCA@{isDecomposed\_PCA}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{isDecomposed\_PCA}{isDecomposed\_PCA}}
{\footnotesize\ttfamily std\+::vector$<$int$>$ covariance\+Base\+::is\+Decomposed\+\_\+\+PCA\hspace{0.3cm}{\ttfamily [protected]}}



If param is decomposed this will return -\/1, if not this will return enumerator to param in normal base. This way we can map stuff like step scale etc between normal base and undecomposed param in eigen base. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00461}{461}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a5ebdc744b733656972a15f1657915a3f}\label{classcovarianceBase_a5ebdc744b733656972a15f1657915a3f}} 
\index{covarianceBase@{covarianceBase}!LastPCAdpar@{LastPCAdpar}}
\index{LastPCAdpar@{LastPCAdpar}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{LastPCAdpar}{LastPCAdpar}}
{\footnotesize\ttfamily int covariance\+Base\+::\+Last\+PCAdpar\hspace{0.3cm}{\ttfamily [protected]}}



Index of the last param that is being decomposed. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00450}{450}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a26618d3f5633b33ce20e38ce8261b3ee}\label{classcovarianceBase_a26618d3f5633b33ce20e38ce8261b3ee}} 
\index{covarianceBase@{covarianceBase}!matrixName@{matrixName}}
\index{matrixName@{matrixName}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{matrixName}{matrixName}}
{\footnotesize\ttfamily std\+::string covariance\+Base\+::matrix\+Name\hspace{0.3cm}{\ttfamily [protected]}}



Name of cov matrix. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00390}{390}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}\label{classcovarianceBase_ab4b7f96d3e977a0b3307ceecbd0baeb4}} 
\index{covarianceBase@{covarianceBase}!pca@{pca}}
\index{pca@{pca}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{pca}{pca}}
{\footnotesize\ttfamily bool covariance\+Base\+::pca\hspace{0.3cm}{\ttfamily [protected]}}



perform PCA or not 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00442}{442}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_ad0022a3e9dd3b2661c9b02a02488759c}\label{classcovarianceBase_ad0022a3e9dd3b2661c9b02a02488759c}} 
\index{covarianceBase@{covarianceBase}!PCAObj@{PCAObj}}
\index{PCAObj@{PCAObj}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{PCAObj}{PCAObj}}
{\footnotesize\ttfamily \mbox{\hyperlink{classPCAHandler}{PCAHandler}} covariance\+Base\+::\+PCAObj\hspace{0.3cm}{\ttfamily [protected]}}



Struct containing information about PCA. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00474}{474}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a8d821ce805f2426fe95549170866821f}\label{classcovarianceBase_a8d821ce805f2426fe95549170866821f}} 
\index{covarianceBase@{covarianceBase}!PrintLength@{PrintLength}}
\index{PrintLength@{PrintLength}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{PrintLength}{PrintLength}}
{\footnotesize\ttfamily int covariance\+Base\+::\+Print\+Length\hspace{0.3cm}{\ttfamily [protected]}}



KS\+: This is used when printing parameters, sometimes we have super long parameters name, we want to flexibly adjust couts. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00409}{409}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}\label{classcovarianceBase_a60dcca091a79ccddd3ad5b414ccd809b}} 
\index{covarianceBase@{covarianceBase}!random\_number@{random\_number}}
\index{random\_number@{random\_number}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{random\_number}{random\_number}}
{\footnotesize\ttfamily TRandom3$\ast$$\ast$ covariance\+Base\+::random\+\_\+number\hspace{0.3cm}{\ttfamily [protected]}}



KS\+: Set Random numbers for each thread so each thread has different seed. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00399}{399}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}\label{classcovarianceBase_a705e648220c06083cd1acc5fba4f2ef7}} 
\index{covarianceBase@{covarianceBase}!randParams@{randParams}}
\index{randParams@{randParams}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{randParams}{randParams}}
{\footnotesize\ttfamily double$\ast$ covariance\+Base\+::rand\+Params\hspace{0.3cm}{\ttfamily [protected]}}



Random number taken from gaussian around prior error used for corr\+\_\+throw. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00402}{402}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a6cb3d0b4096fbb55b040f70cd5b6e32b}\label{classcovarianceBase_a6cb3d0b4096fbb55b040f70cd5b6e32b}} 
\index{covarianceBase@{covarianceBase}!throwMatrix@{throwMatrix}}
\index{throwMatrix@{throwMatrix}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{throwMatrix}{throwMatrix}}
{\footnotesize\ttfamily TMatrix\+DSym$\ast$ covariance\+Base\+::throw\+Matrix\hspace{0.3cm}{\ttfamily [protected]}}



Matrix which we use for step proposal before Cholesky decomposition (not actually used for step proposal) 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00464}{464}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_ab95f5e066c2dfb1d20d120bc6c85dda2}\label{classcovarianceBase_ab95f5e066c2dfb1d20d120bc6c85dda2}} 
\index{covarianceBase@{covarianceBase}!throwMatrix\_CholDecomp@{throwMatrix\_CholDecomp}}
\index{throwMatrix\_CholDecomp@{throwMatrix\_CholDecomp}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{throwMatrix\_CholDecomp}{throwMatrix\_CholDecomp}}
{\footnotesize\ttfamily TMatrixD$\ast$ covariance\+Base\+::throw\+Matrix\+\_\+\+Chol\+Decomp\hspace{0.3cm}{\ttfamily [protected]}}



Matrix which we use for step proposal after Cholesky decomposition. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00466}{466}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}\label{classcovarianceBase_aca17e48a5fa8e353317d58c205fb89df}} 
\index{covarianceBase@{covarianceBase}!throwMatrixCholDecomp@{throwMatrixCholDecomp}}
\index{throwMatrixCholDecomp@{throwMatrixCholDecomp}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{throwMatrixCholDecomp}{throwMatrixCholDecomp}}
{\footnotesize\ttfamily double$\ast$$\ast$ covariance\+Base\+::throw\+Matrix\+Chol\+Decomp\hspace{0.3cm}{\ttfamily [protected]}}



Throw matrix that is being used in the fit, much faster as TMatrix\+DSym cache miss. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00468}{468}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a7682c3de33ae5b23b23e070dc0a3f778}\label{classcovarianceBase_a7682c3de33ae5b23b23e070dc0a3f778}} 
\index{covarianceBase@{covarianceBase}!Unity@{Unity}}
\index{Unity@{Unity}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{Unity}{Unity}}
{\footnotesize\ttfamily const double covariance\+Base\+::\+Unity = 1.\+0\hspace{0.3cm}{\ttfamily [protected]}}



Unity for null systs to point back to. 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00439}{439}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.

\mbox{\Hypertarget{classcovarianceBase_a838731abd6716940043b484b2b266f86}\label{classcovarianceBase_a838731abd6716940043b484b2b266f86}} 
\index{covarianceBase@{covarianceBase}!use\_adaptive@{use\_adaptive}}
\index{use\_adaptive@{use\_adaptive}!covarianceBase@{covarianceBase}}
\doxysubsubsection{\texorpdfstring{use\_adaptive}{use\_adaptive}}
{\footnotesize\ttfamily bool covariance\+Base\+::use\+\_\+adaptive\hspace{0.3cm}{\ttfamily [protected]}}



Are we using AMCMC? 



Definition at line \mbox{\hyperlink{covarianceBase_8h_source_l00471}{471}} of file \mbox{\hyperlink{covarianceBase_8h_source}{covariance\+Base.\+h}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/runner/work/\+Ma\+Ch3/\+Ma\+Ch3/covariance/\mbox{\hyperlink{covarianceBase_8h}{covariance\+Base.\+h}}\item 
/home/runner/work/\+Ma\+Ch3/\+Ma\+Ch3/covariance/\mbox{\hyperlink{covarianceBase_8cpp}{covariance\+Base.\+cpp}}\end{DoxyCompactItemize}
