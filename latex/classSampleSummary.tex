\hypertarget{classSampleSummary}{}\doxysection{Sample\+Summary Class Reference}
\label{classSampleSummary}\index{SampleSummary@{SampleSummary}}


Class to calculate pvalue produce posterior predictive and many fancy Bayesian stuff \cite{gelman1996posterior}.  




{\ttfamily \#include $<$/home/runner/work/\+Ma\+Ch3/\+Ma\+Ch3/mcmc/\+Sample\+Summary.\+h$>$}



Collaboration diagram for Sample\+Summary\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classSampleSummary__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classSampleSummary_afa739654e03cce78c48eb99bcd58c99a}{Sample\+Summary}} (const int n\+\_\+\+Samples, const std\+::string \&Filename, \mbox{\hyperlink{classsamplePDFBase}{sample\+PDFBase}} $\ast$const sample, const int n\+Steps)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classSampleSummary_a0ff4ad11cdada6c57e9e525decdfc6a6}{$\sim$\+Sample\+Summary}} ()
\begin{DoxyCompactList}\small\item\em Destructor. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_a681bee322172bef35a64e86c23c415b6}{Add\+Data}} (std\+::vector$<$ TH2\+Poly $\ast$ $>$ \&\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{Data\+Hist}})
\begin{DoxyCompactList}\small\item\em KS\+: Add data histograms. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_a8c870b718bccf37fc7f91b5201345f8e}{Add\+Nominal}} (std\+::vector$<$ TH2\+Poly $\ast$ $>$ \&\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{Nominal\+Hist}}, std\+::vector$<$ TH2\+Poly $\ast$ $>$ \&W2\+Nom)
\begin{DoxyCompactList}\small\item\em KS\+: Add prior histograms. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_a10d0df830c319f3d8b76d2c3b85b4215}{Add\+Throw}} (std\+::vector$<$ TH2\+Poly $\ast$ $>$ \&MCHist, std\+::vector$<$ TH2\+Poly $\ast$ $>$ \&W2\+Hist, const double LLHPenalty=0.\+0, const double Weight=1.\+0, const int Draw\+Number=0)
\begin{DoxyCompactList}\small\item\em KS\+: Add histograms with throws. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_a00d7dbefac4ec95c256dfd2aa7e4e1a3}{Add\+Throw\+By\+Mode}} (std\+::vector$<$ std\+::vector$<$ TH2\+Poly $\ast$ $>$ $>$ \&Sample\+Vector\+\_\+\+By\+Mode)
\begin{DoxyCompactList}\small\item\em KS\+: Add histograms for each mode. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_aacf987756d2024868bf28b9c2c4a5a99}{Write}} ()
\begin{DoxyCompactList}\small\item\em KS\+: Write results into root file. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_aec9b5e17c269714496bf717bd7d6ae81}{Set\+Likelihood}} (const \mbox{\hyperlink{Structs_8h_a960da89e33ac45a56f7bbfac3068dc67}{Test\+Statistic}} Test\+Stat)
\begin{DoxyCompactList}\small\item\em KS\+: Set likelihood type. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_ab659605093e8fb68607a0fd5691e0535}{Set\+NModel\+Params}} (const int n\+Pars)
\begin{DoxyCompactList}\small\item\em Set number of model params used for BIC. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classSampleSummary_a44baf8959ced974c9a0b8ae640c336bd}{Make\+Predictive}} ()
\begin{DoxyCompactList}\small\item\em Finalise the distributions from the thrown samples. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_a7b87a7ce0c38e968fb841f228aea7212}{Prepare\+Output}} ()
\begin{DoxyCompactList}\small\item\em KS\+: Prepare output tree and necessary variables. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_a197d9d30abc14a76d65bd876b28cca32}{Calc\+LLH}} (TH2\+Poly $\ast$const \&Data, TH2\+Poly $\ast$const \&MC, TH2\+Poly $\ast$const \&W2)
\begin{DoxyCompactList}\small\item\em Helper functions to calculate likelihoods using TH2\+Poly, will modify MC hist tittle to include LLH. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_a5cd35f899a9f6dce138e6d99561aebdf}{Calc\+LLH}} (TH1D $\ast$const \&Data, TH1D $\ast$const \&MC, TH1D $\ast$const \&W2)
\begin{DoxyCompactList}\small\item\em Helper functions to calculate likelihoods using TH1D, will modify MC hist tittle to include LLH. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classSampleSummary_ad027b0716b707691e6a9565ee497b66f}{Get\+LLH}} (TH2\+Poly $\ast$const \&Data, TH2\+Poly $\ast$const \&MC, TH2\+Poly $\ast$const \&W2)
\begin{DoxyCompactList}\small\item\em Helper functions to calculate likelihoods using TH2\+Poly. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classSampleSummary_a89b4a0897346caf484c356155792fce3}{Get\+LLH}} (TH1D $\ast$const \&Data, TH1D $\ast$const \&MC, TH1D $\ast$const \&W2)
\begin{DoxyCompactList}\small\item\em Helper functions to calculate likelihoods using TH1D. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_ac49aa59702b5e24cb0718c2642d6d793}{Plot\+Beta\+Parameters}} ()
\begin{DoxyCompactList}\small\item\em KS\+: In Barlow Beeston we have Beta Parameters which scale generated MC. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_afa199f8841fcbf007c293187ea60d795}{Study\+Kinematic\+Correlations}} ()
\begin{DoxyCompactList}\small\item\em KS\+: Study how correlated are sample or kinematic bins. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_ab28f4325f8104ab783fa3094a2fbbc44}{Make\+Cut\+LLH}} ()
\begin{DoxyCompactList}\small\item\em Make the cut LLH histogram. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_abf964a8fd459fff903faaea17a98f8b1}{Make\+Cut\+LLH1D}} (TH1D $\ast$Histogram, double llh\+\_\+ref=-\/999)
\item 
void \mbox{\hyperlink{classSampleSummary_a24fff19d07a5b11c9c4149a45d0265cd}{Make\+Cut\+LLH2D}} (TH2D $\ast$Histogram)
\begin{DoxyCompactList}\small\item\em Make the 2D cut distribution and give the 2D p-\/value. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_a0e21a2b9fd429261e378f4e505ba2f75}{Make\+Cut\+Event\+Rate}} (TH1D $\ast$Histogram, const double Data\+Rate)
\begin{DoxyCompactList}\small\item\em Make the 1D Event Rate Hist. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_a316974fb99c5a775e1c7099be3bccc7b}{Make\+Chi2\+Hists}} ()
\begin{DoxyCompactList}\small\item\em Make the fluctuated histograms (2D and 1D) for the chi2s Essentially taking the MCMC draws and calculating their LLH to the Posterior predictive distribution And additionally taking the data histogram and calculating the LLH to the predictive distribution Additionally we calculate the chi2 of the draws (fluctuated) of the MC with the prior/posterior predictive and plot it vs the chi2 from the draws of MCMC and the data. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classSampleSummary_a8c5a4ed4db695ce5c5820d857c76b4ff}{Check\+Samples}} (const int Length)
\begin{DoxyCompactList}\small\item\em Check the length of samples agrees. \end{DoxyCompactList}\item 
{\footnotesize template$<$class Hist\+Type $>$ }\\Hist\+Type $\ast$ \mbox{\hyperlink{classSampleSummary_a6cd67dc7cbc004f9b1581ac3a68e1924}{Ratio\+Hists}} (Hist\+Type $\ast$Num\+Hist, Hist\+Type $\ast$Denom\+Hist)
\begin{DoxyCompactList}\small\item\em Helper to make ratio histograms. \end{DoxyCompactList}\item 
TH2\+Poly $\ast$ \mbox{\hyperlink{classSampleSummary_a6d7ad3d2ee9868e80548b8a73299bd5b}{Ratio\+Polys}} (TH2\+Poly $\ast$Num\+Poly, TH2\+Poly $\ast$Denom\+Poly)
\begin{DoxyCompactList}\small\item\em Helper to make ratio of TH2\+Polys. \end{DoxyCompactList}\item 
TH1D $\ast$ \mbox{\hyperlink{classSampleSummary_af9277cfce437396a23e3fb22c55196f9}{Project\+Hist}} (TH2D $\ast$Histogram, const bool ProjectX)
\begin{DoxyCompactList}\small\item\em Helper to project TH2D onto axis. \end{DoxyCompactList}\item 
TH1D $\ast$ \mbox{\hyperlink{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}{Project\+Poly}} (TH2\+Poly $\ast$Histogram, const bool ProjectX, const int selection, const bool Make\+Error\+Hist=false)
\begin{DoxyCompactList}\small\item\em Helper to project TH2\+Poly onto axis. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_ada2f0b7b9b7bb687e67023e84151610e}{Make\+Fluctuated\+Histogram}} (TH1D $\ast$Fluct\+Hist, TH1D $\ast$Poly\+Hist)
\begin{DoxyCompactList}\small\item\em Make Poisson fluctuation of TH1D hist. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_a8ac933c68cff9451eaf1cde713f2eedc}{Make\+Fluctuated\+Histogram\+Standard}} (TH1D $\ast$Fluct\+Hist, TH1D $\ast$Poly\+Hist)
\begin{DoxyCompactList}\small\item\em Make Poisson fluctuation of TH1D hist using default fast method. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_af7cda55ff5d54f442f39181f8478bd7f}{Make\+Fluctuated\+Histogram\+Alternative}} (TH1D $\ast$Fluct\+Hist, TH1D $\ast$Poly\+Hist)
\begin{DoxyCompactList}\small\item\em Make Poisson fluctuation of TH1D hist using slow method which is only for cross-\/check. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_af05fa75a97eeb8890d7bc2d2204761f5}{Make\+Fluctuated\+Histogram}} (TH2\+Poly $\ast$Fluct\+Hist, TH2\+Poly $\ast$Poly\+Hist)
\begin{DoxyCompactList}\small\item\em Make Poisson fluctuation of TH2\+Poly hist. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_ad8fdfe9143603490ebf0f9927c9e5ea6}{Make\+Fluctuated\+Histogram\+Standard}} (TH2\+Poly $\ast$Fluct\+Hist, TH2\+Poly $\ast$Poly\+Hist)
\begin{DoxyCompactList}\small\item\em Make Poisson fluctuation of TH2\+Poly hist using default fast method. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_a1efcadb382307fc99ce01170401ffbaf}{Make\+Fluctuated\+Histogram\+Alternative}} (TH2\+Poly $\ast$Fluct\+Hist, TH2\+Poly $\ast$Poly\+Hist)
\begin{DoxyCompactList}\small\item\em Make Poisson fluctuation of TH2\+Poly hist using slow method which is only for cross-\/check. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_a90fbcfacacf629b0b5f0de3fdab3fdfd}{Fast\+Violin\+Fill}} (TH2D $\ast$violin, TH1D $\ast$hist\+\_\+1d)
\begin{DoxyCompactList}\small\item\em KS\+: Fill Violin histogram with entry from a toy. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classSampleSummary_a938ba96c39db535ede194bfe9f15d626}{Get\+Random\+Poly2}} (const TH2\+Poly $\ast$Poly\+Hist)
\begin{DoxyCompactList}\small\item\em Return 2 random numbers along axis x and y distributed according to the cell-\/contents. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classSampleSummary_a1ed7c379dc433cb1dc3b71eb7aec9713}{Get\+Mode\+Error}} (TH1D $\ast$hpost)
\begin{DoxyCompactList}\small\item\em Get the mode error from a TH1D. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_a3560f062913ea70912e7b9a1cb93e2a5}{Study\+BIC}} ()
\begin{DoxyCompactList}\small\item\em Study Bayesian Information Criterion (BIC) \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_a8e73fe07b8b8dfb1e2ee9245df4e7a4b}{Study\+DIC}} ()
\begin{DoxyCompactList}\small\item\em KS\+: Get the Deviance Information Criterion (DIC) \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classSampleSummary_acab977d5e63eaca5862c352fea8a01c2}{Normalise\+TH2\+Poly}} (TH2\+Poly $\ast$Histogram)
\begin{DoxyCompactList}\small\item\em Helper to Normalise histograms. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
TRandom3 $\ast$ \mbox{\hyperlink{classSampleSummary_a8322552ef396f34af5ee4bd47a44e39e}{rnd}}
\begin{DoxyCompactList}\small\item\em Random number generator. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classSampleSummary_a4ade2ccb94981d4483f0b4e6e367b1a0}{first\+\_\+pass}}
\begin{DoxyCompactList}\small\item\em KS\+: Hacky flag to let us know if this is first toy. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classSampleSummary_ae502645ddf5c53a7a3f2c52566956bf3}{Standard\+Fluctuation}}
\begin{DoxyCompactList}\small\item\em KS\+: We have two methods for Poissonian fluctuation. \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::vector$<$ TH2\+Poly $\ast$ $>$ $>$ \mbox{\hyperlink{classSampleSummary_a13177305e8fd4b97812b2ca563740bf2}{MCVector}}
\begin{DoxyCompactList}\small\item\em Vector of vectors which holds the loaded MC histograms. \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::vector$<$ TH2\+Poly $\ast$ $>$ $>$ \mbox{\hyperlink{classSampleSummary_a263b7541545b8b0ba735e0a3ac2d31e7}{W2\+MCVector}}
\begin{DoxyCompactList}\small\item\em Vector of vectors which holds the loaded W2 histograms. \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::vector$<$ std\+::vector$<$ TH2\+Poly $\ast$ $>$ $>$ $>$ \mbox{\hyperlink{classSampleSummary_ab3eeac18b62f7ee3a5c943c3cd0e9b76}{MCVector\+By\+Mode}}
\begin{DoxyCompactList}\small\item\em Vector of vectors which holds the loaded MC histograms for each mode. \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \mbox{\hyperlink{classSampleSummary_a068e2a5ad0c02aaa57a27d2b12e37810}{LLHPenalty\+Vector}}
\begin{DoxyCompactList}\small\item\em Vector to hold the penalty term. \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \mbox{\hyperlink{classSampleSummary_ad40a0514f4be18ef026ea41bd5965fa3}{Weight\+Vector}}
\begin{DoxyCompactList}\small\item\em Vector holding weight. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{n\+Samples}}
\begin{DoxyCompactList}\small\item\em Number of samples. \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::string $>$ \mbox{\hyperlink{classSampleSummary_a9ba7df41774c45a14c0a97e4accc9cc0}{Sample\+Names}}
\begin{DoxyCompactList}\small\item\em name for each sample \end{DoxyCompactList}\item 
TH1D $\ast$$\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{Posterior\+Hist}}
\begin{DoxyCompactList}\small\item\em The posterior predictive for the whole selection\+: this gets built after adding in the toys. Now an array of Th1ds, 1 for each poly bin, for each sample. \end{DoxyCompactList}\item 
TH1D $\ast$$\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_a0fd31469ea40b54ea864f5eb7360adee}{w2\+Hist}}
\begin{DoxyCompactList}\small\item\em The posterior predictive for the whole selection\+: this gets built after adding in the toys. Now an array of Th1ds, 1 for each poly bin, for each sample for W2. \end{DoxyCompactList}\item 
TH2D $\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_a7176dc4fd5368e01f00d5fcc909ee605}{Violin\+Hists\+\_\+\+ProjectX}}
\begin{DoxyCompactList}\small\item\em Posterior predictive but for X projection but as a violin plot. \end{DoxyCompactList}\item 
TH2D $\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_af4447b09538a0138de4e11c81169f821}{Violin\+Hists\+\_\+\+ProjectY}}
\begin{DoxyCompactList}\small\item\em Posterior predictive but for Y projection but as a violin plot. \end{DoxyCompactList}\item 
TH2\+Poly $\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{Data\+Hist}}
\begin{DoxyCompactList}\small\item\em The data histogram for the selection. \end{DoxyCompactList}\item 
TH1D $\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_aed3d754bfa3b870ba2676748d1420b5f}{Data\+Hist\+\_\+\+ProjectX}}
\begin{DoxyCompactList}\small\item\em The data histogram for the selection X projection. \end{DoxyCompactList}\item 
TH1D $\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_abb300b204c11a5542efa5d28510d0860}{Data\+Hist\+\_\+\+ProjectY}}
\begin{DoxyCompactList}\small\item\em The data histogram for the selection Y projection. \end{DoxyCompactList}\item 
TH2\+Poly $\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{Nominal\+Hist}}
\begin{DoxyCompactList}\small\item\em The nominal histogram for the selection. \end{DoxyCompactList}\item 
TH2\+Poly $\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_a8219b4f8763481e16c6b4493f97378cb}{W2\+Nom\+Hist}}
\begin{DoxyCompactList}\small\item\em Pointer to the w2 histograms (for nominal values). \end{DoxyCompactList}\item 
TH2\+Poly $\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2\+Mean\+Hist}}
\begin{DoxyCompactList}\small\item\em Pointer to the w2 histograms (for mean values). \end{DoxyCompactList}\item 
TH2\+Poly $\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_accde7a80fb4c8b986d1a152f88e8f515}{W2\+Mode\+Hist}}
\begin{DoxyCompactList}\small\item\em Pointer to the w2 histograms (for mode values). \end{DoxyCompactList}\item 
TH1D $\ast$ \mbox{\hyperlink{classSampleSummary_a086c2804cf7c1af54784d856c4351de8}{ln\+LHist}}
\begin{DoxyCompactList}\small\item\em The histogram containing the lnL for each throw. \end{DoxyCompactList}\item 
TH1D $\ast$ \mbox{\hyperlink{classSampleSummary_a77da9dc0abfc381a526e3ceac9453f80}{ln\+LHist\+\_\+drawfluc}}
\begin{DoxyCompactList}\small\item\em The ln\+Lhist for the draw vs MC fluctuated. \end{DoxyCompactList}\item 
TH1D $\ast$ \mbox{\hyperlink{classSampleSummary_a6c8b2e34255d1c109b5172ddcf5e9fcd}{ln\+LHist\+\_\+drawflucdraw}}
\begin{DoxyCompactList}\small\item\em The ln\+Lhist for the draw vs draw fluctuated. \end{DoxyCompactList}\item 
TH1D $\ast$ \mbox{\hyperlink{classSampleSummary_af4240300eba39917dee195fd2b37c5d9}{ln\+LHist\+\_\+drawdata}}
\begin{DoxyCompactList}\small\item\em The ln\+Lhist for the draw vs data. \end{DoxyCompactList}\item 
TH2D $\ast$ \mbox{\hyperlink{classSampleSummary_a653e0d84096e0acdb3e392c2a68077e9}{ln\+LDraw\+Hist}}
\begin{DoxyCompactList}\small\item\em The 2D ln\+Lhist, showing (draw vs data) and (draw vs fluct), anything above y=x axis is the p-\/value. \end{DoxyCompactList}\item 
TH2D $\ast$ \mbox{\hyperlink{classSampleSummary_a6f7c55987330d006555b44010e54d8b0}{ln\+LFluc\+Hist}}
\begin{DoxyCompactList}\small\item\em The 2D ln\+LHist, showing (draw vs data) and (draw vs draw fluct), anything above y=x axis is the p-\/value. \end{DoxyCompactList}\item 
TH2D $\ast$ \mbox{\hyperlink{classSampleSummary_a7cee72732c2a3e242e5ed723e4b206c9}{ln\+LDraw\+Hist\+Rate}}
\begin{DoxyCompactList}\small\item\em The 2D ln\+Lhist, showing (draw vs data) and (draw vs fluct), using rate, anything above y=x axis is the p-\/value. \end{DoxyCompactList}\item 
TH2D $\ast$ \mbox{\hyperlink{classSampleSummary_a40f5c789dbf8ad9c8a4af401343af474}{ln\+LFluc\+Hist\+\_\+\+ProjectX}}
\begin{DoxyCompactList}\small\item\em The 2D ln\+LHist but for ProjectionX histogram (pmu), showing (draw vs data) and (draw vs draw fluct), anything above y=x axis is the p-\/value. \end{DoxyCompactList}\item 
TH1D $\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_a08c14eaf908f0fd1bc8bd95b0886c99e}{ln\+LHist\+\_\+\+Sample\+\_\+\+Draw\+Data}}
\begin{DoxyCompactList}\small\item\em The histogram containing the lnL (draw vs data) for each throw for each sample. \end{DoxyCompactList}\item 
TH1D $\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_a0e32c2a76de59e4142036b1c5a234819}{ln\+LHist\+\_\+\+Sample\+\_\+\+Drawfluc\+Draw}}
\begin{DoxyCompactList}\small\item\em The histogram containing the lnL (draw vs draw fluct) for each throw for each sample. \end{DoxyCompactList}\item 
TH1D $\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_a59de41ffd933765d2e22ffd8aa198ac1}{ln\+LHist\+\_\+\+Sample\+\_\+\+Predfluc\+Draw}}
\begin{DoxyCompactList}\small\item\em The histogram containing the lnL (draw vs pred fluct) for each throw for each sample. \end{DoxyCompactList}\item 
TH2\+Poly $\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_a0ae323dddee7bec9c425f309b60959f1}{ln\+LHist\+\_\+\+Mean}}
\begin{DoxyCompactList}\small\item\em The LLH distribution in pmu cosmu for using the mean in each bin. \end{DoxyCompactList}\item 
TH2\+Poly $\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_aa9d2908a7dfefa91deb35a562b673eb1}{ln\+LHist\+\_\+\+Mode}}
\begin{DoxyCompactList}\small\item\em The LLH distribution in pmu cosmu for using the mode in each bin. \end{DoxyCompactList}\item 
TH1D $\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_a9e6d97ff3cffed6a40689a547ec7e5d7}{ln\+LHist\+\_\+\+Mean\+\_\+\+ProjectX}}
\begin{DoxyCompactList}\small\item\em The LLH distribution in pmu using the mean in each bin. \end{DoxyCompactList}\item 
TH2\+Poly $\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{Mean\+Hist}}
\begin{DoxyCompactList}\small\item\em The posterior predictive distribution in pmu cosmu using the mean. \end{DoxyCompactList}\item 
TH2\+Poly $\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_a805cc2be1298a385160deaa03269313a}{Mean\+Hist\+Corrected}}
\begin{DoxyCompactList}\small\item\em The posterior predictive distribution in pmu cosmu using the mean after applying Barlow-\/\+Beeston Correction. \end{DoxyCompactList}\item 
TH2\+Poly $\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_a59475a0c9460277914402850372727ea}{Mode\+Hist}}
\begin{DoxyCompactList}\small\item\em The posterior predictive distribution in pmu cosmu using the mode. \end{DoxyCompactList}\item 
TH1D $\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_a6ae29545d50456334c6035d165599787}{ln\+LHist\+\_\+\+Mean1D}}
\begin{DoxyCompactList}\small\item\em Holds the bin-\/by-\/bin LLH for the mean posterior predictive vs the data. \end{DoxyCompactList}\item 
TH1D $\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_a8ad8aa62be1f0f895faf342bfc0f7d13}{ln\+LHist\+\_\+\+Mode1D}}
\begin{DoxyCompactList}\small\item\em Holds the bin-\/by-\/bin LLH for the mode posterior predictive vs the data. \end{DoxyCompactList}\item 
TH1D $\ast$ \mbox{\hyperlink{classSampleSummary_a07ea4bf6cf23214263ec63cd69de49c1}{Random\+Hist}}
\begin{DoxyCompactList}\small\item\em Holds the history of which entries have been drawn in the MCMC file. \end{DoxyCompactList}\item 
TH1D $\ast$$\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{Beta\+Hist}}
\begin{DoxyCompactList}\small\item\em Distribution of beta parameters in Barlow Beeston formalisms. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{Do\+Beta\+Param}}
\begin{DoxyCompactList}\small\item\em Are we making Beta Histograms. \end{DoxyCompactList}\item 
unsigned int \mbox{\hyperlink{classSampleSummary_af4767862e5c1f4e3319d16b861213555}{n\+Chain\+Steps}}
\begin{DoxyCompactList}\small\item\em Number of throws by user. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classSampleSummary_adb737e335e68edeb14a6ce2ca112dc8c}{is\+Prior\+Predictive}}
\begin{DoxyCompactList}\small\item\em bool whether we have Prior or Posterior Predictive \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classSampleSummary_aebd01b201cf04608b251cd3e272878b7}{do\+Shape\+Only}}
\begin{DoxyCompactList}\small\item\em bool whether to normalise each toy to have shape based p-\/value and pos pred distribution \end{DoxyCompactList}\item 
unsigned int \mbox{\hyperlink{classSampleSummary_aa5c4055d4bb4dc720a4118032cdb4910}{n\+Throws}}
\begin{DoxyCompactList}\small\item\em Number of throws. \end{DoxyCompactList}\item 
int $\ast$ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{max\+Bins}}
\begin{DoxyCompactList}\small\item\em Max Number of Bins per each sample. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classSampleSummary_aacac73b24f1e8b05d35fabe2322578e8}{llh\+\_\+total}}
\begin{DoxyCompactList}\small\item\em Total LLH for the posterior predictive distribution. \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{classSampleSummary_a4463f635de4e83c7ada683768454da82}{Output\+Name}}
\begin{DoxyCompactList}\small\item\em Output filename. \end{DoxyCompactList}\item 
TFile $\ast$ \mbox{\hyperlink{classSampleSummary_aa7b948f290517a052f04f61dfa6af68f}{Outputfile}}
\begin{DoxyCompactList}\small\item\em Output filename. \end{DoxyCompactList}\item 
TDirectory $\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_a916c6d1f50b54f1f4509622359b2a1b7}{Dir}}
\begin{DoxyCompactList}\small\item\em Directory for each sample. \end{DoxyCompactList}\item 
TTree $\ast$ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{Output\+Tree}}
\begin{DoxyCompactList}\small\item\em TTree which we save useful information to. \end{DoxyCompactList}\item 
double $\ast$ \mbox{\hyperlink{classSampleSummary_a8e20b53f7845651f6dc8f4b5faa9400c}{llh\+\_\+data\+\_\+draw}}
\begin{DoxyCompactList}\small\item\em Data vs Draw. \end{DoxyCompactList}\item 
double $\ast$ \mbox{\hyperlink{classSampleSummary_afbea2da38c0bd2e78ec9fa87ebdf992a}{llh\+\_\+drawfluc\+\_\+draw}}
\begin{DoxyCompactList}\small\item\em Fluctuated Draw vs Draw. \end{DoxyCompactList}\item 
double $\ast$ \mbox{\hyperlink{classSampleSummary_a6dc4f1e22995a7bfa538df57903e7650}{llh\+\_\+predfluc\+\_\+draw}}
\begin{DoxyCompactList}\small\item\em Fluctuated Predictive vs Draw. \end{DoxyCompactList}\item 
double $\ast$ \mbox{\hyperlink{classSampleSummary_ad766eb771115b2800b3a8e20f95ac612}{llh\+\_\+rate\+\_\+data\+\_\+draw}}
\begin{DoxyCompactList}\small\item\em Data vs Draw using rate only. \end{DoxyCompactList}\item 
double $\ast$ \mbox{\hyperlink{classSampleSummary_a09609fb1b319d270011d01983fa88d79}{llh\+\_\+rate\+\_\+predfluc\+\_\+draw}}
\begin{DoxyCompactList}\small\item\em Fluctuated Predictive vs Draw using rate only. \end{DoxyCompactList}\item 
double $\ast$ \mbox{\hyperlink{classSampleSummary_a5c46fc1f6e0ab29dcadcde3152b0d275}{llh\+\_\+data\+\_\+drawfluc}}
\begin{DoxyCompactList}\small\item\em Data vs Fluctuated Draw. \end{DoxyCompactList}\item 
double $\ast$ \mbox{\hyperlink{classSampleSummary_a07d4cc27e2299f3beefe0b3e78da493a}{llh\+\_\+data\+\_\+predfluc}}
\begin{DoxyCompactList}\small\item\em Data vs Fluctuated Predictive. \end{DoxyCompactList}\item 
double $\ast$ \mbox{\hyperlink{classSampleSummary_a1a154b17f6f4ab15eec03f3dcfc91e5f}{llh\+\_\+draw\+\_\+pred}}
\begin{DoxyCompactList}\small\item\em Draw vs Predictive. \end{DoxyCompactList}\item 
double $\ast$ \mbox{\hyperlink{classSampleSummary_adb0f7be738ba901c4a6c1253dc8b2b03}{llh\+\_\+drawfluc\+\_\+pred}}
\begin{DoxyCompactList}\small\item\em Fluctuated Draw vs Predictive. \end{DoxyCompactList}\item 
double $\ast$ \mbox{\hyperlink{classSampleSummary_a5160d49065adca11bec43baaab283b70}{llh\+\_\+predfluc\+\_\+pred}}
\begin{DoxyCompactList}\small\item\em Fluctuated Predictive vs Predictive. \end{DoxyCompactList}\item 
double $\ast$ \mbox{\hyperlink{classSampleSummary_a5fb4519a15437b229f37fb171e578ab0}{llh\+\_\+drawfluc\+\_\+predfluc}}
\begin{DoxyCompactList}\small\item\em Fluctuated Draw vs Fluctuated Predictive. \end{DoxyCompactList}\item 
double $\ast$ \mbox{\hyperlink{classSampleSummary_a85f8c5e630bc333137a403401097785d}{llh\+\_\+datafluc\+\_\+draw}}
\begin{DoxyCompactList}\small\item\em Fluctuated Data vs Draw. \end{DoxyCompactList}\item 
double $\ast$ \mbox{\hyperlink{classSampleSummary_a77250cd6138be6d5220f2ac6c7ebd2ea}{llh\+\_\+data\+\_\+draw\+\_\+\+ProjectX}}
\begin{DoxyCompactList}\small\item\em Projection X (most likely muon momentum) of LLH. \end{DoxyCompactList}\item 
double $\ast$ \mbox{\hyperlink{classSampleSummary_a6a171e9c3a2f71785b777d1d64a78dfa}{llh\+\_\+drawfluc\+\_\+draw\+\_\+\+ProjectX}}
\item 
double \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\+\_\+penalty}}
\begin{DoxyCompactList}\small\item\em LLH penalty for each throw. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classSampleSummary_a2cb3d8dcbab49b62be3bc2a4a7e4d5f3}{total\+\_\+llh\+\_\+data\+\_\+draw}}
\begin{DoxyCompactList}\small\item\em Data vs Draw. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classSampleSummary_a7e418146cce2c4201c3aa7e1eaad4a38}{total\+\_\+llh\+\_\+drawfluc\+\_\+draw}}
\begin{DoxyCompactList}\small\item\em Fluctuated Draw vs Draw. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classSampleSummary_a804a117990fd1441c9e3a9d8e8d32e98}{total\+\_\+llh\+\_\+predfluc\+\_\+draw}}
\begin{DoxyCompactList}\small\item\em Fluctuated Predictive vs Draw. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classSampleSummary_aaf055562efe3e5f2592942f5151ece22}{total\+\_\+llh\+\_\+rate\+\_\+data\+\_\+draw}}
\begin{DoxyCompactList}\small\item\em Rate Data vs Draw. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classSampleSummary_a2ebe701d114669fdfcf61e1680bb144d}{total\+\_\+llh\+\_\+rate\+\_\+predfluc\+\_\+draw}}
\begin{DoxyCompactList}\small\item\em Fluctuated Predictive vs Draw using Rate. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classSampleSummary_aeee48af77dc4e0beee5eab13c30f3d38}{total\+\_\+llh\+\_\+data\+\_\+predfluc}}
\begin{DoxyCompactList}\small\item\em Data vs Fluctuated Predictive. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classSampleSummary_a670c890357fd77997279c83c197f989c}{total\+\_\+llh\+\_\+data\+\_\+drawfluc}}
\begin{DoxyCompactList}\small\item\em Data vs Fluctuated Draw. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classSampleSummary_a58efe34df7c43fb40d211036e30a1b5d}{total\+\_\+llh\+\_\+draw\+\_\+pred}}
\begin{DoxyCompactList}\small\item\em Draw vs Predictive. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classSampleSummary_a9c8b444ac7f80a5af63d5b9f4a150b79}{total\+\_\+llh\+\_\+drawfluc\+\_\+pred}}
\begin{DoxyCompactList}\small\item\em Fluctuated Draw vs Predictive. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classSampleSummary_af92a42a666e1bfcb2dc761ffa2253b7e}{total\+\_\+llh\+\_\+drawfluc\+\_\+predfluc}}
\begin{DoxyCompactList}\small\item\em Fluctuated Draw vs Fluctuated Predictive. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classSampleSummary_af9e5d89095e6c6a81aedb5ea2402e3fb}{total\+\_\+llh\+\_\+datafluc\+\_\+draw}}
\begin{DoxyCompactList}\small\item\em Fluctuated Data vs Draw. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classSampleSummary_a1f6c2e7ed8f9024cf928da5b56054e07}{total\+\_\+llh\+\_\+predfluc\+\_\+pred}}
\begin{DoxyCompactList}\small\item\em Fluctuated Predictive vs Predictive. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classSampleSummary_a5a973692db89f52c19c9195ffe95c9a1}{total\+\_\+llh\+\_\+data\+\_\+draw\+\_\+\+ProjectX}}
\begin{DoxyCompactList}\small\item\em Data vs Draw for projection X (most likely muon momentum) \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classSampleSummary_a22df11667306c7892f9ed3f8935a5c9e}{total\+\_\+llh\+\_\+drawfluc\+\_\+draw\+\_\+\+ProjectX}}
\begin{DoxyCompactList}\small\item\em Fluctuated Draw vs Draw for projection X (most likely muon momentum) \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classSampleSummary_a795ac96bf6958c8a2f38c9de23c3c081}{Do\+By\+Mode\+Plots}}
\begin{DoxyCompactList}\small\item\em By mode variables. \end{DoxyCompactList}\item 
TH2\+Poly $\ast$$\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_a20237446a72eda2dc833bfc72c7e42e1}{Mean\+Hist\+\_\+\+By\+Mode}}
\begin{DoxyCompactList}\small\item\em The posterior predictive distribution in pmu cosmu using the mean. \end{DoxyCompactList}\item 
TH1D $\ast$$\ast$$\ast$$\ast$ \mbox{\hyperlink{classSampleSummary_aa6cfe4fb92b67f08b0d94f0fe1d8a3a2}{Posterior\+Hist\+\_\+\+By\+Mode}}
\begin{DoxyCompactList}\small\item\em Histogram which corresponds to each bin in the sample\textquotesingle{}s th2poly. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classsamplePDFBase}{sample\+PDFBase}} $\ast$ \mbox{\hyperlink{classSampleSummary_abd938805245ca6cfeb8c49363f5ff11c}{Sample\+PDF}}
\begin{DoxyCompactList}\small\item\em Pointer to sample\+PDF object, mostly used to get sample names, binning etc. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classMaCh3Modes}{Ma\+Ch3\+Modes}} $\ast$ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}
\begin{DoxyCompactList}\small\item\em Ma\+Ch3 Modes. \end{DoxyCompactList}\item 
\mbox{\hyperlink{Structs_8h_a960da89e33ac45a56f7bbfac3068dc67}{Test\+Statistic}} \mbox{\hyperlink{classSampleSummary_aafb18632bb987ae9a302d95781d5fdba}{likelihood}}
\begin{DoxyCompactList}\small\item\em Type of likelihood for example Poisson, Barlow-\/\+Beeston or Ice Cube. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classSampleSummary_a49215601479aaa99f9f64d8f7c900385}{n\+Model\+Params}}
\begin{DoxyCompactList}\small\item\em Number of parameters. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classSampleSummary_a807e348a85fb460c5ca4a1ce56d08aab}{Debug}}
\begin{DoxyCompactList}\small\item\em Tells Debug level to save additional histograms. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Class to calculate pvalue produce posterior predictive and many fancy Bayesian stuff \cite{gelman1996posterior}. 

For more information, visit the \href{https://github.com/mach3-software/MaCh3/wiki/10.-Posterior-Predictive,-p\%E2\%80\%90value-etc.}{\texttt{ Wiki}}. 

Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00011}{11}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classSampleSummary_afa739654e03cce78c48eb99bcd58c99a}\label{classSampleSummary_afa739654e03cce78c48eb99bcd58c99a}} 
\index{SampleSummary@{SampleSummary}!SampleSummary@{SampleSummary}}
\index{SampleSummary@{SampleSummary}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{SampleSummary()}{SampleSummary()}}
{\footnotesize\ttfamily Sample\+Summary\+::\+Sample\+Summary (\begin{DoxyParamCaption}\item[{const int}]{n\+\_\+\+Samples,  }\item[{const std\+::string \&}]{Filename,  }\item[{\mbox{\hyperlink{classsamplePDFBase}{sample\+PDFBase}} $\ast$const}]{sample,  }\item[{const int}]{n\+Steps }\end{DoxyParamCaption})}



Constructor. 


\begin{DoxyParams}{Parameters}
{\em n\+\_\+\+Samples} & total number of samples \\
\hline
{\em Filename} & name of output file \\
\hline
{\em sample} & pointer to sample PDF object \\
\hline
{\em n\+Chain\+Steps} & number of steps in a chain, 0 indicate prior predictive was used \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l00009}{9}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00009\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00010\ \textcolor{comment}{//\ *******************}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a4db4657acad5c79ac4bbb66a9d1c5905}{MACH3LOG\_DEBUG}}(\textcolor{stringliteral}{"{}Making\ sample\ summary\ class..."{}});}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{00014\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a4db4657acad5c79ac4bbb66a9d1c5905}{MACH3LOG\_DEBUG}}(\textcolor{stringliteral}{"{}With\ OpenMP\ and\ \{\}\ threads"{}},\ omp\_get\_max\_threads());}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{00016\ \ \ }
\DoxyCodeLine{00017\ \ \ \mbox{\hyperlink{classSampleSummary_ae502645ddf5c53a7a3f2c52566956bf3}{StandardFluctuation}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00018\ \ \ }
\DoxyCodeLine{00019\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_ae502645ddf5c53a7a3f2c52566956bf3}{StandardFluctuation}})\ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Using\ standard\ method\ of\ statistical\ fluctuation"{}});}
\DoxyCodeLine{00020\ \ \ \textcolor{keywordflow}{else}\ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Using\ alternative\ method\ of\ statistical\ fluctuation,\ which\ is\ much\ slower"{}});}
\DoxyCodeLine{00021\ \ \ }
\DoxyCodeLine{00022\ \ \ \textcolor{comment}{//KS:\ If\ true\ it\ will\ print\ posterior\ predictive\ for\ every\ beta\ parameter\ it\ is\ quite\ useful\ but\ make\ root\ big\ number\ of\ plots}}
\DoxyCodeLine{00023\ \ \ \mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00024\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}})\ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}I\ will\ calculate\ \#beta\ parameters\ from\ Barlow-\/Beeston\ formalism"{}});}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \ \ \textcolor{comment}{//If\ true\ code\ will\ normalise\ each\ histogram,\ this\ way\ you\ can\ calculate\ shape\ only\ error.\ etc.\ pvalue\ will\ be\ completely\ wrong\ unfortunately}}
\DoxyCodeLine{00027\ \ \ \mbox{\hyperlink{classSampleSummary_aebd01b201cf04608b251cd3e272878b7}{doShapeOnly}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \ \ \mbox{\hyperlink{classSampleSummary_af4767862e5c1f4e3319d16b861213555}{nChainSteps}}\ =\ nSteps;}
\DoxyCodeLine{00030\ \ \ \textcolor{comment}{//KS:\ nChainSteps\ ==\ 0\ means\ we\ run\ PriorPredcitive}}
\DoxyCodeLine{00031\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_af4767862e5c1f4e3319d16b861213555}{nChainSteps}}\ ==\ 0)\ \mbox{\hyperlink{classSampleSummary_adb737e335e68edeb14a6ce2ca112dc8c}{isPriorPredictive}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00032\ \ \ \textcolor{keywordflow}{else}\ \mbox{\hyperlink{classSampleSummary_adb737e335e68edeb14a6ce2ca112dc8c}{isPriorPredictive}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00033\ \ \ }
\DoxyCodeLine{00034\ \ \ \mbox{\hyperlink{classSampleSummary_a4463f635de4e83c7ada683768454da82}{OutputName}}\ =\ Filename;}
\DoxyCodeLine{00035\ \ \ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}\ =\ n\_Samples;}
\DoxyCodeLine{00036\ \ \ \mbox{\hyperlink{classSampleSummary_abd938805245ca6cfeb8c49363f5ff11c}{SamplePDF}}\ =\ sample;}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \ \ \textcolor{comment}{//Get\ mach3\ modes\ from\ manager}}
\DoxyCodeLine{00039\ \ \ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}\ =\ \mbox{\hyperlink{classSampleSummary_abd938805245ca6cfeb8c49363f5ff11c}{SamplePDF}}-\/>\mbox{\hyperlink{classsamplePDFBase_ad7ab324d8b7ac73f92ef6a8d74b9dc72}{GetMaCh3Modes}}();}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \ \ \mbox{\hyperlink{classSampleSummary_aa5c4055d4bb4dc720a4118032cdb4910}{nThrows}}\ =\ 0;}
\DoxyCodeLine{00042\ \ \ \mbox{\hyperlink{classSampleSummary_a4ade2ccb94981d4483f0b4e6e367b1a0}{first\_pass}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00043\ \ \ \mbox{\hyperlink{classSampleSummary_aa7b948f290517a052f04f61dfa6af68f}{Outputfile}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00044\ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00045\ \ \ \mbox{\hyperlink{classSampleSummary_a916c6d1f50b54f1f4509622359b2a1b7}{Dir}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \ \ \mbox{\hyperlink{classSampleSummary_a8322552ef396f34af5ee4bd47a44e39e}{rnd}}\ =\ \textcolor{keyword}{new}\ TRandom3();}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \ \ \mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}\ =\ \textcolor{keyword}{new}\ TH2Poly*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00050\ \ \ \mbox{\hyperlink{classSampleSummary_aed3d754bfa3b870ba2676748d1420b5f}{DataHist\_ProjectX}}\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00051\ \ \ \mbox{\hyperlink{classSampleSummary_abb300b204c11a5542efa5d28510d0860}{DataHist\_ProjectY}}\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00052\ \ \ \mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}\ =\ \textcolor{keyword}{new}\ TH2Poly*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00053\ \ \ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}\ =\ \textcolor{keyword}{new}\ TH1D**[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00054\ \ \ \mbox{\hyperlink{classSampleSummary_a8219b4f8763481e16c6b4493f97378cb}{W2NomHist}}\ =\ \textcolor{keyword}{new}\ TH2Poly*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00055\ \ \ \mbox{\hyperlink{classSampleSummary_a0fd31469ea40b54ea864f5eb7360adee}{w2Hist}}\ =\ \textcolor{keyword}{new}\ TH1D**[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ \mbox{\hyperlink{classSampleSummary_a7176dc4fd5368e01f00d5fcc909ee605}{ViolinHists\_ProjectX}}\ =\ \textcolor{keyword}{new}\ TH2D*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00058\ \ \ \mbox{\hyperlink{classSampleSummary_af4447b09538a0138de4e11c81169f821}{ViolinHists\_ProjectY}}\ =\ \textcolor{keyword}{new}\ TH2D*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00059\ \ \ \ \ }
\DoxyCodeLine{00060\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}})\ \mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}}\ =\ \textcolor{keyword}{new}\ TH1D**[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00061\ \ \ \textcolor{keywordflow}{else}\ \mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \ \ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{int}[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00064\ \ \ }
\DoxyCodeLine{00065\ \ \ \mbox{\hyperlink{classSampleSummary_a0ae323dddee7bec9c425f309b60959f1}{lnLHist\_Mean}}\ =\ \textcolor{keyword}{new}\ TH2Poly*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00066\ \ \ \mbox{\hyperlink{classSampleSummary_aa9d2908a7dfefa91deb35a562b673eb1}{lnLHist\_Mode}}\ =\ \textcolor{keyword}{new}\ TH2Poly*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00067\ \ \ \mbox{\hyperlink{classSampleSummary_a9e6d97ff3cffed6a40689a547ec7e5d7}{lnLHist\_Mean\_ProjectX}}\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00068\ \ \ \mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}\ =\ \textcolor{keyword}{new}\ TH2Poly*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00069\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}})\ \mbox{\hyperlink{classSampleSummary_a805cc2be1298a385160deaa03269313a}{MeanHistCorrected}}\ =\ \textcolor{keyword}{new}\ TH2Poly*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00070\ \ \ \textcolor{keywordflow}{else}\ \mbox{\hyperlink{classSampleSummary_a805cc2be1298a385160deaa03269313a}{MeanHistCorrected}}\ =\ NULL;}
\DoxyCodeLine{00071\ \ \ \mbox{\hyperlink{classSampleSummary_a59475a0c9460277914402850372727ea}{ModeHist}}\ =\ \textcolor{keyword}{new}\ TH2Poly*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00072\ \ \ \mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2MeanHist}}\ =\ \textcolor{keyword}{new}\ TH2Poly*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00073\ \ \ \mbox{\hyperlink{classSampleSummary_accde7a80fb4c8b986d1a152f88e8f515}{W2ModeHist}}\ =\ \textcolor{keyword}{new}\ TH2Poly*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00074\ \ \ \mbox{\hyperlink{classSampleSummary_a6ae29545d50456334c6035d165599787}{lnLHist\_Mean1D}}\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00075\ \ \ \mbox{\hyperlink{classSampleSummary_a8ad8aa62be1f0f895faf342bfc0f7d13}{lnLHist\_Mode1D}}\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00076\ \ \ \mbox{\hyperlink{classSampleSummary_a08c14eaf908f0fd1bc8bd95b0886c99e}{lnLHist\_Sample\_DrawData}}\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00077\ \ \ \mbox{\hyperlink{classSampleSummary_a0e32c2a76de59e4142036b1c5a234819}{lnLHist\_Sample\_DrawflucDraw}}\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00078\ \ \ \mbox{\hyperlink{classSampleSummary_a59de41ffd933765d2e22ffd8aa198ac1}{lnLHist\_Sample\_PredflucDraw}}\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00079\ \ \ \ \ }
\DoxyCodeLine{00080\ \ \ \textcolor{comment}{//KS:\ When\ a\ histogram\ is\ created\ with\ an\ axis\ lower\ limit\ greater\ or\ equal\ to\ its\ upper\ limit\ ROOT\ will\ automatically\ adjust\ histogram\ range}}
\DoxyCodeLine{00081\ \ \ \textcolor{comment}{//\ https://root.cern.ch/doc/master/classTH1.html\#auto-\/bin}}
\DoxyCodeLine{00082\ \ \ \mbox{\hyperlink{classSampleSummary_a086c2804cf7c1af54784d856c4351de8}{lnLHist}}\ =\ \textcolor{keyword}{new}\ TH1D(\textcolor{stringliteral}{"{}lnLHist\_predpredfluc"{}},\ \textcolor{stringliteral}{"{}lnLHist\_predpredfluc"{}},\ 100,\ 1,\ -\/1);}
\DoxyCodeLine{00083\ \ \ \mbox{\hyperlink{classSampleSummary_a086c2804cf7c1af54784d856c4351de8}{lnLHist}}-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}-\/2LLH\ (Pred\ Fluc,\ Pred)"{}});}
\DoxyCodeLine{00084\ \ \ \mbox{\hyperlink{classSampleSummary_a086c2804cf7c1af54784d856c4351de8}{lnLHist}}-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Counts"{}});}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \ \ \mbox{\hyperlink{classSampleSummary_af4240300eba39917dee195fd2b37c5d9}{lnLHist\_drawdata}}\ =\ \textcolor{keyword}{new}\ TH1D(\textcolor{stringliteral}{"{}lnLHist\_drawdata"{}},\ \textcolor{stringliteral}{"{}lnLHist\_drawdata"{}},\ 100,\ 1,\ -\/1);}
\DoxyCodeLine{00087\ \ \ \mbox{\hyperlink{classSampleSummary_af4240300eba39917dee195fd2b37c5d9}{lnLHist\_drawdata}}-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}-\/2LLH\ (Data,\ Draw)"{}});}
\DoxyCodeLine{00088\ \ \ \mbox{\hyperlink{classSampleSummary_af4240300eba39917dee195fd2b37c5d9}{lnLHist\_drawdata}}-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Counts"{}});}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \ \ \mbox{\hyperlink{classSampleSummary_a77da9dc0abfc381a526e3ceac9453f80}{lnLHist\_drawfluc}}\ =\ \textcolor{keyword}{new}\ TH1D(\textcolor{stringliteral}{"{}lnLHist\_drawpredfluc"{}},\ \textcolor{stringliteral}{"{}lnLHist\_drawpredfluc"{}},\ 100,\ 1,\ -\/1);}
\DoxyCodeLine{00091\ \ \ \mbox{\hyperlink{classSampleSummary_a77da9dc0abfc381a526e3ceac9453f80}{lnLHist\_drawfluc}}-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}-\/2LLH\ (Pred\ Fluc,\ Draw)"{}});}
\DoxyCodeLine{00092\ \ \ \mbox{\hyperlink{classSampleSummary_a77da9dc0abfc381a526e3ceac9453f80}{lnLHist\_drawfluc}}-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Counts"{}});}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ \mbox{\hyperlink{classSampleSummary_a6c8b2e34255d1c109b5172ddcf5e9fcd}{lnLHist\_drawflucdraw}}\ =\ \textcolor{keyword}{new}\ TH1D(\textcolor{stringliteral}{"{}lnLHist\_drawflucdraw"{}},\ \textcolor{stringliteral}{"{}lnLHist\_drawflucdraw"{}},\ 100,\ 1,\ -\/1);}
\DoxyCodeLine{00095\ \ \ \mbox{\hyperlink{classSampleSummary_a6c8b2e34255d1c109b5172ddcf5e9fcd}{lnLHist\_drawflucdraw}}-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}-\/2LLH\ (Draw\ Fluc,\ Draw)"{}});}
\DoxyCodeLine{00096\ \ \ \mbox{\hyperlink{classSampleSummary_a6c8b2e34255d1c109b5172ddcf5e9fcd}{lnLHist\_drawflucdraw}}-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Counts"{}});}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \ \ \mbox{\hyperlink{classSampleSummary_a653e0d84096e0acdb3e392c2a68077e9}{lnLDrawHist}}\ =\ \textcolor{keyword}{new}\ TH2D(\textcolor{stringliteral}{"{}lnLDrawHist"{}},\ \textcolor{stringliteral}{"{}lnLDrawHist"{}},\ 50,\ 1,\ -\/1,\ 50,\ 1,\ -\/1);}
\DoxyCodeLine{00099\ \ \ \mbox{\hyperlink{classSampleSummary_a653e0d84096e0acdb3e392c2a68077e9}{lnLDrawHist}}-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}-\/2LLH\_\{Pred\ Fluc,\ Draw\}"{}});}
\DoxyCodeLine{00100\ \ \ \mbox{\hyperlink{classSampleSummary_a653e0d84096e0acdb3e392c2a68077e9}{lnLDrawHist}}-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}-\/2LLH\_\{Data,\ Draw\}"{}});}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \ \ \mbox{\hyperlink{classSampleSummary_a6f7c55987330d006555b44010e54d8b0}{lnLFlucHist}}\ =\ \textcolor{keyword}{new}\ TH2D(\textcolor{stringliteral}{"{}lnLFlucHist"{}},\ \textcolor{stringliteral}{"{}lnLFlucHist"{}},\ 50,\ 1,\ -\/1,\ 50,\ 1,\ -\/1);}
\DoxyCodeLine{00103\ \ \ \mbox{\hyperlink{classSampleSummary_a6f7c55987330d006555b44010e54d8b0}{lnLFlucHist}}-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}-\/2LLH\_\{Draw\ Fluc,\ Draw\}"{}});}
\DoxyCodeLine{00104\ \ \ \mbox{\hyperlink{classSampleSummary_a6f7c55987330d006555b44010e54d8b0}{lnLFlucHist}}-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}-\/2LLH\_\{Data,\ Draw\}"{}});}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \ \ \mbox{\hyperlink{classSampleSummary_a7cee72732c2a3e242e5ed723e4b206c9}{lnLDrawHistRate}}\ =\ \textcolor{keyword}{new}\ TH2D(\textcolor{stringliteral}{"{}lnLDrawHistRate"{}},\ \textcolor{stringliteral}{"{}lnLDrawHistRate"{}},\ 50,\ 1,\ -\/1,\ 50,\ 1,\ -\/1);}
\DoxyCodeLine{00107\ \ \ \mbox{\hyperlink{classSampleSummary_a7cee72732c2a3e242e5ed723e4b206c9}{lnLDrawHistRate}}-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}-\/2LLH\_\{Pred\ Fluc,\ Draw\}"{}});}
\DoxyCodeLine{00108\ \ \ \mbox{\hyperlink{classSampleSummary_a7cee72732c2a3e242e5ed723e4b206c9}{lnLDrawHistRate}}-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}-\/2LLH\_\{Data,\ Draw\}"{}});}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \ \ \textcolor{comment}{//KS:\ This\ is\ silly\ as\ it\ assumes\ all\ samples\ uses\ same\ kinematics}}
\DoxyCodeLine{00111\ \ \ \mbox{\hyperlink{classSampleSummary_a40f5c789dbf8ad9c8a4af401343af474}{lnLFlucHist\_ProjectX}}\ =\ \textcolor{keyword}{new}\ TH2D(\textcolor{stringliteral}{"{}lnLFlucHist\_ProjectX"{}},\ \textcolor{stringliteral}{"{}lnLFlucHist\_ProjectX"{}},\ 50,\ 1,\ -\/1,\ 50,\ 1,\ -\/1);}
\DoxyCodeLine{00112\ \ \ \mbox{\hyperlink{classSampleSummary_a40f5c789dbf8ad9c8a4af401343af474}{lnLFlucHist\_ProjectX}}-\/>GetXaxis()-\/>SetTitle((\textcolor{stringliteral}{"{}-\/2LLH\_\{Draw\ Fluc,\ Draw\}\ for\ "{}}\ +\ \mbox{\hyperlink{classSampleSummary_abd938805245ca6cfeb8c49363f5ff11c}{SamplePDF}}-\/>\mbox{\hyperlink{classsamplePDFBase_a2c02e6a8107a0fd8b9deed6d98015ba3}{GetKinVarLabel}}(0,\ 0)).c\_str());}
\DoxyCodeLine{00113\ \ \ \mbox{\hyperlink{classSampleSummary_a40f5c789dbf8ad9c8a4af401343af474}{lnLFlucHist\_ProjectX}}-\/>GetYaxis()-\/>SetTitle((\textcolor{stringliteral}{"{}-\/2LLH\_\{Data,\ Draw\}\ for\ "{}}\ +\ \mbox{\hyperlink{classSampleSummary_abd938805245ca6cfeb8c49363f5ff11c}{SamplePDF}}-\/>\mbox{\hyperlink{classsamplePDFBase_a2c02e6a8107a0fd8b9deed6d98015ba3}{GetKinVarLabel}}(0,\ 0)).c\_str());}
\DoxyCodeLine{00114\ \ \ }
\DoxyCodeLine{00115\ \ \ \textcolor{comment}{//\ Holds\ the\ hist\ of\ random\ number\ draws,\ only\ works\ for\ posterior\ predictive}}
\DoxyCodeLine{00116\ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{classSampleSummary_adb737e335e68edeb14a6ce2ca112dc8c}{isPriorPredictive}})}
\DoxyCodeLine{00117\ \ \ \{}
\DoxyCodeLine{00118\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a07ea4bf6cf23214263ec63cd69de49c1}{RandomHist}}\ =\ \textcolor{keyword}{new}\ TH1D(\textcolor{stringliteral}{"{}RandomHist"{}},\ \textcolor{stringliteral}{"{}RandomHist"{}},\ 100,\ 0,\ \mbox{\hyperlink{classSampleSummary_af4767862e5c1f4e3319d16b861213555}{nChainSteps}});}
\DoxyCodeLine{00119\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a07ea4bf6cf23214263ec63cd69de49c1}{RandomHist}}-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Step"{}});}
\DoxyCodeLine{00120\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ binwidth\ =\ \mbox{\hyperlink{classSampleSummary_af4767862e5c1f4e3319d16b861213555}{nChainSteps}}/\mbox{\hyperlink{classSampleSummary_a07ea4bf6cf23214263ec63cd69de49c1}{RandomHist}}-\/>GetNbinsX();}
\DoxyCodeLine{00121\ \ \ \ \ std::stringstream\ ss;}
\DoxyCodeLine{00122\ \ \ \ \ ss\ <<\ \textcolor{stringliteral}{"{}Draws/"{}}\ <<\ binwidth;}
\DoxyCodeLine{00123\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a07ea4bf6cf23214263ec63cd69de49c1}{RandomHist}}-\/>GetYaxis()-\/>SetTitle(ss.str().c\_str());}
\DoxyCodeLine{00124\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a07ea4bf6cf23214263ec63cd69de49c1}{RandomHist}}-\/>SetLineWidth(2);}
\DoxyCodeLine{00125\ \ \ \}}
\DoxyCodeLine{00126\ \ \ \textcolor{keywordflow}{else}\ \mbox{\hyperlink{classSampleSummary_a07ea4bf6cf23214263ec63cd69de49c1}{RandomHist}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00128\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++i)}
\DoxyCodeLine{00129\ \ \ \{}
\DoxyCodeLine{00130\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[i]\ =\ NULL;}
\DoxyCodeLine{00131\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a0fd31469ea40b54ea864f5eb7360adee}{w2Hist}}[i]\ =\ NULL;}
\DoxyCodeLine{00132\ \ \ \ \ \ \ }
\DoxyCodeLine{00133\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}})\ \mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}}[i]\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00134\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i]\ =\ NULL;}
\DoxyCodeLine{00135\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_aed3d754bfa3b870ba2676748d1420b5f}{DataHist\_ProjectX}}[i]\ =\ NULL;}
\DoxyCodeLine{00136\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_abb300b204c11a5542efa5d28510d0860}{DataHist\_ProjectY}}[i]\ =\ NULL;}
\DoxyCodeLine{00137\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i]\ =\ NULL;}
\DoxyCodeLine{00138\ \ \ \ \ }
\DoxyCodeLine{00139\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a7176dc4fd5368e01f00d5fcc909ee605}{ViolinHists\_ProjectX}}[i]\ =\ NULL;}
\DoxyCodeLine{00140\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_af4447b09538a0138de4e11c81169f821}{ViolinHists\_ProjectY}}[i]\ =\ NULL;}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[i]\ =\ NULL;}
\DoxyCodeLine{00143\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}})\ \mbox{\hyperlink{classSampleSummary_a805cc2be1298a385160deaa03269313a}{MeanHistCorrected}}[i]\ =\ NULL;}
\DoxyCodeLine{00144\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2MeanHist}}[i]\ =\ NULL;}
\DoxyCodeLine{00145\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_accde7a80fb4c8b986d1a152f88e8f515}{W2ModeHist}}[i]\ =\ NULL;}
\DoxyCodeLine{00146\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a0ae323dddee7bec9c425f309b60959f1}{lnLHist\_Mean}}[i]\ =\ NULL;}
\DoxyCodeLine{00147\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_aa9d2908a7dfefa91deb35a562b673eb1}{lnLHist\_Mode}}[i]\ =\ NULL;}
\DoxyCodeLine{00148\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a9e6d97ff3cffed6a40689a547ec7e5d7}{lnLHist\_Mean\_ProjectX}}[i]\ =\ NULL;}
\DoxyCodeLine{00149\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a6ae29545d50456334c6035d165599787}{lnLHist\_Mean1D}}[i]\ =\ NULL;}
\DoxyCodeLine{00150\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a8ad8aa62be1f0f895faf342bfc0f7d13}{lnLHist\_Mode1D}}[i]\ =\ NULL;}
\DoxyCodeLine{00151\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a08c14eaf908f0fd1bc8bd95b0886c99e}{lnLHist\_Sample\_DrawData}}[i]\ =\ NULL;}
\DoxyCodeLine{00152\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a0e32c2a76de59e4142036b1c5a234819}{lnLHist\_Sample\_DrawflucDraw}}[i]\ =\ NULL;}
\DoxyCodeLine{00153\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a59de41ffd933765d2e22ffd8aa198ac1}{lnLHist\_Sample\_PredflucDraw}}[i]\ =\ NULL;}
\DoxyCodeLine{00154\ \ \ \}\textcolor{comment}{//end\ loop\ over\ samples}}
\DoxyCodeLine{00155\ \ \ }
\DoxyCodeLine{00156\ \ \ \mbox{\hyperlink{classSampleSummary_a8e20b53f7845651f6dc8f4b5faa9400c}{llh\_data\_draw}}\ =\ NULL;}
\DoxyCodeLine{00157\ \ \ \mbox{\hyperlink{classSampleSummary_afbea2da38c0bd2e78ec9fa87ebdf992a}{llh\_drawfluc\_draw}}\ =\ NULL;}
\DoxyCodeLine{00158\ \ \ \mbox{\hyperlink{classSampleSummary_a6dc4f1e22995a7bfa538df57903e7650}{llh\_predfluc\_draw}}\ =\ NULL;}
\DoxyCodeLine{00159\ \ \ \mbox{\hyperlink{classSampleSummary_ad766eb771115b2800b3a8e20f95ac612}{llh\_rate\_data\_draw}}\ =\ NULL;}
\DoxyCodeLine{00160\ \ \ \mbox{\hyperlink{classSampleSummary_a09609fb1b319d270011d01983fa88d79}{llh\_rate\_predfluc\_draw}}\ =\ NULL;}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \ \ \mbox{\hyperlink{classSampleSummary_a5c46fc1f6e0ab29dcadcde3152b0d275}{llh\_data\_drawfluc}}\ =\ NULL;}
\DoxyCodeLine{00163\ \ \ \mbox{\hyperlink{classSampleSummary_a07d4cc27e2299f3beefe0b3e78da493a}{llh\_data\_predfluc}}\ =\ NULL;}
\DoxyCodeLine{00164\ \ \ \mbox{\hyperlink{classSampleSummary_a1a154b17f6f4ab15eec03f3dcfc91e5f}{llh\_draw\_pred}}\ =\ NULL;}
\DoxyCodeLine{00165\ \ \ \mbox{\hyperlink{classSampleSummary_adb0f7be738ba901c4a6c1253dc8b2b03}{llh\_drawfluc\_pred}}\ =\ NULL;}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \ \ \mbox{\hyperlink{classSampleSummary_a5160d49065adca11bec43baaab283b70}{llh\_predfluc\_pred}}\ =\ NULL;}
\DoxyCodeLine{00168\ \ \ \mbox{\hyperlink{classSampleSummary_a5fb4519a15437b229f37fb171e578ab0}{llh\_drawfluc\_predfluc}}\ =\ NULL;}
\DoxyCodeLine{00169\ \ \ \mbox{\hyperlink{classSampleSummary_a85f8c5e630bc333137a403401097785d}{llh\_datafluc\_draw}}\ =\ NULL;}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00171\ \ \ \mbox{\hyperlink{classSampleSummary_a795ac96bf6958c8a2f38c9de23c3c081}{DoByModePlots}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00172\ \ \ \mbox{\hyperlink{classSampleSummary_a20237446a72eda2dc833bfc72c7e42e1}{MeanHist\_ByMode}}\ =\ NULL;}
\DoxyCodeLine{00173\ \ \ \mbox{\hyperlink{classSampleSummary_aa6cfe4fb92b67f08b0d94f0fe1d8a3a2}{PosteriorHist\_ByMode}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ \mbox{\hyperlink{classSampleSummary_a49215601479aaa99f9f64d8f7c900385}{nModelParams}}\ =\ 0;}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00177\ \ \ \mbox{\hyperlink{classSampleSummary_a807e348a85fb460c5ca4a1ce56d08aab}{Debug}}\ =\ 0;}
\DoxyCodeLine{00178\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_a0ff4ad11cdada6c57e9e525decdfc6a6}\label{classSampleSummary_a0ff4ad11cdada6c57e9e525decdfc6a6}} 
\index{SampleSummary@{SampleSummary}!````~SampleSummary@{$\sim$SampleSummary}}
\index{````~SampleSummary@{$\sim$SampleSummary}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{$\sim$SampleSummary()}{~SampleSummary()}}
{\footnotesize\ttfamily Sample\+Summary\+::$\sim$\+Sample\+Summary (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Destructor. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l00182}{182}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00183\ \textcolor{comment}{//\ *******************}}
\DoxyCodeLine{00184\ \ \ \mbox{\hyperlink{classSampleSummary_aa7b948f290517a052f04f61dfa6af68f}{Outputfile}}-\/>cd();}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00186\ \ \ \textcolor{comment}{//ROOT\ is\ weird\ and\ once\ you\ write\ TFile\ claim\ ownership\ of\ histograms.\ Best\ is\ to\ first\ delete\ histograms\ and\ then\ close\ file}}
\DoxyCodeLine{00187\ \ \ \mbox{\hyperlink{classSampleSummary_aa7b948f290517a052f04f61dfa6af68f}{Outputfile}}-\/>Close();}
\DoxyCodeLine{00188\ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_aa7b948f290517a052f04f61dfa6af68f}{Outputfile}};}
\DoxyCodeLine{00189\ }
\DoxyCodeLine{00190\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a8322552ef396f34af5ee4bd47a44e39e}{rnd}}\ !=\ \textcolor{keyword}{nullptr})\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_a8322552ef396f34af5ee4bd47a44e39e}{rnd}};}
\DoxyCodeLine{00191\ \ \ }
\DoxyCodeLine{00192\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a086c2804cf7c1af54784d856c4351de8}{lnLHist}}\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_a086c2804cf7c1af54784d856c4351de8}{lnLHist}};}
\DoxyCodeLine{00193\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_af4240300eba39917dee195fd2b37c5d9}{lnLHist\_drawdata}}\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_af4240300eba39917dee195fd2b37c5d9}{lnLHist\_drawdata}};}
\DoxyCodeLine{00194\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a77da9dc0abfc381a526e3ceac9453f80}{lnLHist\_drawfluc}}\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_a77da9dc0abfc381a526e3ceac9453f80}{lnLHist\_drawfluc}};}
\DoxyCodeLine{00195\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a6c8b2e34255d1c109b5172ddcf5e9fcd}{lnLHist\_drawflucdraw}}\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_a6c8b2e34255d1c109b5172ddcf5e9fcd}{lnLHist\_drawflucdraw}};}
\DoxyCodeLine{00196\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a653e0d84096e0acdb3e392c2a68077e9}{lnLDrawHist}}\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_a653e0d84096e0acdb3e392c2a68077e9}{lnLDrawHist}};}
\DoxyCodeLine{00197\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a6f7c55987330d006555b44010e54d8b0}{lnLFlucHist}}\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_a6f7c55987330d006555b44010e54d8b0}{lnLFlucHist}};}
\DoxyCodeLine{00198\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a7cee72732c2a3e242e5ed723e4b206c9}{lnLDrawHistRate}}\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_a7cee72732c2a3e242e5ed723e4b206c9}{lnLDrawHistRate}};}
\DoxyCodeLine{00199\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a07ea4bf6cf23214263ec63cd69de49c1}{RandomHist}}\ !=\ \textcolor{keyword}{nullptr})\ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_a07ea4bf6cf23214263ec63cd69de49c1}{RandomHist}};}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00201\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a40f5c789dbf8ad9c8a4af401343af474}{lnLFlucHist\_ProjectX}}\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_a40f5c789dbf8ad9c8a4af401343af474}{lnLFlucHist\_ProjectX}};}
\DoxyCodeLine{00202\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a795ac96bf6958c8a2f38c9de23c3c081}{DoByModePlots}})}
\DoxyCodeLine{00203\ \ \ \{}
\DoxyCodeLine{00204\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++i)}
\DoxyCodeLine{00205\ \ \ \ \ \{}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i]\ ==\ NULL)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1;\ j++)}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 1;\ k\ <=\ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[i];\ ++k)}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_aa6cfe4fb92b67f08b0d94f0fe1d8a3a2}{PosteriorHist\_ByMode}}[i][j][k]\ !=\ \textcolor{keyword}{nullptr})\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_aa6cfe4fb92b67f08b0d94f0fe1d8a3a2}{PosteriorHist\_ByMode}}[i][j][k];}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_aa6cfe4fb92b67f08b0d94f0fe1d8a3a2}{PosteriorHist\_ByMode}}[i][j];}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a20237446a72eda2dc833bfc72c7e42e1}{MeanHist\_ByMode}}[i][j]\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_a20237446a72eda2dc833bfc72c7e42e1}{MeanHist\_ByMode}}[i][j];}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_aa6cfe4fb92b67f08b0d94f0fe1d8a3a2}{PosteriorHist\_ByMode}}[i];}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a20237446a72eda2dc833bfc72c7e42e1}{MeanHist\_ByMode}}[i];}
\DoxyCodeLine{00218\ \ \ \ \ \}}
\DoxyCodeLine{00219\ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_aa6cfe4fb92b67f08b0d94f0fe1d8a3a2}{PosteriorHist\_ByMode}};}
\DoxyCodeLine{00220\ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a20237446a72eda2dc833bfc72c7e42e1}{MeanHist\_ByMode}};}
\DoxyCodeLine{00221\ \ \ \}}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++i)}
\DoxyCodeLine{00224\ \ \ \{}
\DoxyCodeLine{00225\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i]\ ==\ NULL)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00226\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i]\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i];}
\DoxyCodeLine{00227\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i]\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i];}
\DoxyCodeLine{00228\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[i]\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[i];}
\DoxyCodeLine{00229\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}}\ \&\&\ \mbox{\hyperlink{classSampleSummary_a805cc2be1298a385160deaa03269313a}{MeanHistCorrected}}[i]\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_a805cc2be1298a385160deaa03269313a}{MeanHistCorrected}}[i];}
\DoxyCodeLine{00230\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2MeanHist}}[i]\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2MeanHist}}[i];}
\DoxyCodeLine{00231\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_accde7a80fb4c8b986d1a152f88e8f515}{W2ModeHist}}[i]\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_accde7a80fb4c8b986d1a152f88e8f515}{W2ModeHist}}[i];}
\DoxyCodeLine{00232\ \ \ \ \ }
\DoxyCodeLine{00233\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a7176dc4fd5368e01f00d5fcc909ee605}{ViolinHists\_ProjectX}}[i]\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_a7176dc4fd5368e01f00d5fcc909ee605}{ViolinHists\_ProjectX}}[i];}
\DoxyCodeLine{00234\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_af4447b09538a0138de4e11c81169f821}{ViolinHists\_ProjectY}}[i]\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_af4447b09538a0138de4e11c81169f821}{ViolinHists\_ProjectY}}[i];}
\DoxyCodeLine{00235\ \ \ \ \ }
\DoxyCodeLine{00236\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a0ae323dddee7bec9c425f309b60959f1}{lnLHist\_Mean}}[i]\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_a0ae323dddee7bec9c425f309b60959f1}{lnLHist\_Mean}}[i];}
\DoxyCodeLine{00237\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_aa9d2908a7dfefa91deb35a562b673eb1}{lnLHist\_Mode}}[i]\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_aa9d2908a7dfefa91deb35a562b673eb1}{lnLHist\_Mode}}[i];}
\DoxyCodeLine{00238\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a9e6d97ff3cffed6a40689a547ec7e5d7}{lnLHist\_Mean\_ProjectX}}[i]\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_a9e6d97ff3cffed6a40689a547ec7e5d7}{lnLHist\_Mean\_ProjectX}}[i];}
\DoxyCodeLine{00239\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a6ae29545d50456334c6035d165599787}{lnLHist\_Mean1D}}[i]\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_a6ae29545d50456334c6035d165599787}{lnLHist\_Mean1D}}[i];}
\DoxyCodeLine{00240\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a8ad8aa62be1f0f895faf342bfc0f7d13}{lnLHist\_Mode1D}}[i]\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_a8ad8aa62be1f0f895faf342bfc0f7d13}{lnLHist\_Mode1D}}[i];}
\DoxyCodeLine{00241\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a08c14eaf908f0fd1bc8bd95b0886c99e}{lnLHist\_Sample\_DrawData}}[i]\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_a08c14eaf908f0fd1bc8bd95b0886c99e}{lnLHist\_Sample\_DrawData}}[i];}
\DoxyCodeLine{00242\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a0e32c2a76de59e4142036b1c5a234819}{lnLHist\_Sample\_DrawflucDraw}}[i]\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_a0e32c2a76de59e4142036b1c5a234819}{lnLHist\_Sample\_DrawflucDraw}}[i];}
\DoxyCodeLine{00243\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a59de41ffd933765d2e22ffd8aa198ac1}{lnLHist\_Sample\_PredflucDraw}}[i]\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_a59de41ffd933765d2e22ffd8aa198ac1}{lnLHist\_Sample\_PredflucDraw}}[i];}
\DoxyCodeLine{00244\ }
\DoxyCodeLine{00245\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 1;\ j\ <=\ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[i];\ ++j)}
\DoxyCodeLine{00246\ \ \ \ \ \{}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[i][j]\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[i][j];}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a0fd31469ea40b54ea864f5eb7360adee}{w2Hist}}[i][j]\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_a0fd31469ea40b54ea864f5eb7360adee}{w2Hist}}[i][j];}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}}\ \&\&\ \mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}}[i][j]\ !=\ NULL)\ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}}[i][j];}
\DoxyCodeLine{00250\ \ \ \ \ \}}
\DoxyCodeLine{00251\ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[i];}
\DoxyCodeLine{00252\ \ \ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a0fd31469ea40b54ea864f5eb7360adee}{w2Hist}}[i];}
\DoxyCodeLine{00253\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}})\ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}}[i];}
\DoxyCodeLine{00254\ \ \ \}}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}};}
\DoxyCodeLine{00257\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}};}
\DoxyCodeLine{00258\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}};}
\DoxyCodeLine{00259\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}})\ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a805cc2be1298a385160deaa03269313a}{MeanHistCorrected}};}
\DoxyCodeLine{00260\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2MeanHist}};}
\DoxyCodeLine{00261\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_accde7a80fb4c8b986d1a152f88e8f515}{W2ModeHist}};}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00263\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a7176dc4fd5368e01f00d5fcc909ee605}{ViolinHists\_ProjectX}};}
\DoxyCodeLine{00264\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_af4447b09538a0138de4e11c81169f821}{ViolinHists\_ProjectY}};}
\DoxyCodeLine{00265\ \ \ \ \ \ \ }
\DoxyCodeLine{00266\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a0ae323dddee7bec9c425f309b60959f1}{lnLHist\_Mean}};}
\DoxyCodeLine{00267\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_aa9d2908a7dfefa91deb35a562b673eb1}{lnLHist\_Mode}};}
\DoxyCodeLine{00268\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a9e6d97ff3cffed6a40689a547ec7e5d7}{lnLHist\_Mean\_ProjectX}};}
\DoxyCodeLine{00269\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a6ae29545d50456334c6035d165599787}{lnLHist\_Mean1D}};}
\DoxyCodeLine{00270\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a8ad8aa62be1f0f895faf342bfc0f7d13}{lnLHist\_Mode1D}};}
\DoxyCodeLine{00271\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a08c14eaf908f0fd1bc8bd95b0886c99e}{lnLHist\_Sample\_DrawData}};}
\DoxyCodeLine{00272\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a0e32c2a76de59e4142036b1c5a234819}{lnLHist\_Sample\_DrawflucDraw}};}
\DoxyCodeLine{00273\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a59de41ffd933765d2e22ffd8aa198ac1}{lnLHist\_Sample\_PredflucDraw}};}
\DoxyCodeLine{00274\ \ \ }
\DoxyCodeLine{00275\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}};}
\DoxyCodeLine{00276\ \ \ \ \ \ \ }
\DoxyCodeLine{00277\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}};}
\DoxyCodeLine{00278\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a0fd31469ea40b54ea864f5eb7360adee}{w2Hist}};}
\DoxyCodeLine{00279\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}})\ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}};}
\DoxyCodeLine{00280\ }
\DoxyCodeLine{00281\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a8e20b53f7845651f6dc8f4b5faa9400c}{llh\_data\_draw}};}
\DoxyCodeLine{00282\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a5c46fc1f6e0ab29dcadcde3152b0d275}{llh\_data\_drawfluc}};}
\DoxyCodeLine{00283\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a07d4cc27e2299f3beefe0b3e78da493a}{llh\_data\_predfluc}};}
\DoxyCodeLine{00284\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_ad766eb771115b2800b3a8e20f95ac612}{llh\_rate\_data\_draw}};}
\DoxyCodeLine{00285\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a09609fb1b319d270011d01983fa88d79}{llh\_rate\_predfluc\_draw}};}
\DoxyCodeLine{00286\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a1a154b17f6f4ab15eec03f3dcfc91e5f}{llh\_draw\_pred}};}
\DoxyCodeLine{00287\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_adb0f7be738ba901c4a6c1253dc8b2b03}{llh\_drawfluc\_pred}};}
\DoxyCodeLine{00288\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a5fb4519a15437b229f37fb171e578ab0}{llh\_drawfluc\_predfluc}};}
\DoxyCodeLine{00289\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_afbea2da38c0bd2e78ec9fa87ebdf992a}{llh\_drawfluc\_draw}};}
\DoxyCodeLine{00290\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a5160d49065adca11bec43baaab283b70}{llh\_predfluc\_pred}};}
\DoxyCodeLine{00291\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a6dc4f1e22995a7bfa538df57903e7650}{llh\_predfluc\_draw}};}
\DoxyCodeLine{00292\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a85f8c5e630bc333137a403401097785d}{llh\_datafluc\_draw}};}
\DoxyCodeLine{00293\ \ \ }
\DoxyCodeLine{00294\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a77250cd6138be6d5220f2ac6c7ebd2ea}{llh\_data\_draw\_ProjectX}};}
\DoxyCodeLine{00295\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_a6a171e9c3a2f71785b777d1d64a78dfa}{llh\_drawfluc\_draw\_ProjectX}};}
\DoxyCodeLine{00296\ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classSampleSummary_a681bee322172bef35a64e86c23c415b6}\label{classSampleSummary_a681bee322172bef35a64e86c23c415b6}} 
\index{SampleSummary@{SampleSummary}!AddData@{AddData}}
\index{AddData@{AddData}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{AddData()}{AddData()}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Add\+Data (\begin{DoxyParamCaption}\item[{std\+::vector$<$ TH2\+Poly $\ast$ $>$ \&}]{Data\+Hist }\end{DoxyParamCaption})}



KS\+: Add data histograms. 


\begin{DoxyParams}{Parameters}
{\em Data\+Hist} & Histogram with data even rates for each sample \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l00316}{316}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00317\ \textcolor{comment}{//\ *******************}}
\DoxyCodeLine{00318\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ Length\ =\ int(Data.size());}
\DoxyCodeLine{00319\ \ \ \textcolor{comment}{//\ Check\ length\ of\ samples\ are\ OK}}
\DoxyCodeLine{00320\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classSampleSummary_a8c5a4ed4db695ce5c5820d857c76b4ff}{CheckSamples}}(Length))\ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00321\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ Length;\ ++i)\ \{}
\DoxyCodeLine{00322\ \ \ \ \ \textcolor{keywordflow}{if}\ (Data[i]\ ==\ NULL)\ \{}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i]\ =\ NULL;}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_aed3d754bfa3b870ba2676748d1420b5f}{DataHist\_ProjectX}}[i]\ =\ NULL;}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_abb300b204c11a5542efa5d28510d0860}{DataHist\_ProjectY}}[i]\ =\ NULL;}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[i]\ =\ 0;}
\DoxyCodeLine{00327\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00328\ \ \ \ \ \ \ std::string\ classname\ =\ std::string(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i]-\/>Class\_Name());}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(classname\ ==\ \textcolor{stringliteral}{"{}TH2Poly"{}})}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i]\ =\ \textcolor{keyword}{static\_cast<}TH2Poly*\textcolor{keyword}{>}(Data[i]-\/>Clone());}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_aebd01b201cf04608b251cd3e272878b7}{doShapeOnly}})\ \mbox{\hyperlink{classSampleSummary_acab977d5e63eaca5862c352fea8a01c2}{NormaliseTH2Poly}}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i]);}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_aed3d754bfa3b870ba2676748d1420b5f}{DataHist\_ProjectX}}[i]\ =\ \mbox{\hyperlink{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}{ProjectPoly}}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i],\ \textcolor{keyword}{true},\ i);}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_abb300b204c11a5542efa5d28510d0860}{DataHist\_ProjectY}}[i]\ =\ \mbox{\hyperlink{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}{ProjectPoly}}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i],\ \textcolor{keyword}{false},\ i);}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[i]\ =\ \mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i]-\/>GetNumberOfBins();}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Somehow\ sample\ \{\}\ doesn't\ use\ TH2Poly"{}},\ \mbox{\hyperlink{classSampleSummary_abd938805245ca6cfeb8c49363f5ff11c}{SamplePDF}}-\/>\mbox{\hyperlink{classsamplePDFBase_a35ced08988cee48ac111024c70a2c7c2}{GetSampleName}}(i));}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Right\ now\ I\ only\ support\ TH2Poly\ but\ I\ am\ ambitious\ piece\ of\ code\ and\ surely\ will\ have\ more\ support\ in\ the\ future"{}});}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00341\ \ \ \ \ \}}
\DoxyCodeLine{00342\ \ \ \}}
\DoxyCodeLine{00343\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_a8c870b718bccf37fc7f91b5201345f8e}\label{classSampleSummary_a8c870b718bccf37fc7f91b5201345f8e}} 
\index{SampleSummary@{SampleSummary}!AddNominal@{AddNominal}}
\index{AddNominal@{AddNominal}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{AddNominal()}{AddNominal()}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Add\+Nominal (\begin{DoxyParamCaption}\item[{std\+::vector$<$ TH2\+Poly $\ast$ $>$ \&}]{Nominal\+Hist,  }\item[{std\+::vector$<$ TH2\+Poly $\ast$ $>$ \&}]{W2\+Nom }\end{DoxyParamCaption})}



KS\+: Add prior histograms. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l00347}{347}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00348\ \textcolor{comment}{//\ *******************}}
\DoxyCodeLine{00349\ }
\DoxyCodeLine{00350\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ Length\ =\ int(Nominal.size());}
\DoxyCodeLine{00351\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classSampleSummary_a8c5a4ed4db695ce5c5820d857c76b4ff}{CheckSamples}}(Length))\ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00352\ \ \ }
\DoxyCodeLine{00353\ \ \ \textcolor{comment}{//KS:\ ROOT\ is\ super\ annoying\ and\ you\ cannot\ use\ clone\ with\ openMP,\ hence\ we\ have\ another\ loop\ below}}
\DoxyCodeLine{00354\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ Length;\ ++i)\ }
\DoxyCodeLine{00355\ \ \ \{}
\DoxyCodeLine{00356\ \ \ \ \ \textcolor{keywordflow}{if}\ (Nominal[i]\ ==\ NULL)\ \{}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[i]\ =\ NULL;}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i]\ =\ NULL;}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a8219b4f8763481e16c6b4493f97378cb}{W2NomHist}}[i]\ =\ NULL;}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a0ae323dddee7bec9c425f309b60959f1}{lnLHist\_Mean}}[i]\ =\ NULL;}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_aa9d2908a7dfefa91deb35a562b673eb1}{lnLHist\_Mode}}[i]\ =\ NULL;}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a9e6d97ff3cffed6a40689a547ec7e5d7}{lnLHist\_Mean\_ProjectX}}[i]\ =\ NULL;}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[i]\ =\ NULL;}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}})\ \mbox{\hyperlink{classSampleSummary_a805cc2be1298a385160deaa03269313a}{MeanHistCorrected}}[i]\ =\ NULL;}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a59475a0c9460277914402850372727ea}{ModeHist}}[i]\ =\ NULL;}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2MeanHist}}[i]\ =\ NULL;}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_accde7a80fb4c8b986d1a152f88e8f515}{W2ModeHist}}[i]\ =\ NULL;}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a08c14eaf908f0fd1bc8bd95b0886c99e}{lnLHist\_Sample\_DrawData}}[i]\ =\ NULL;}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a0e32c2a76de59e4142036b1c5a234819}{lnLHist\_Sample\_DrawflucDraw}}[i]\ =\ NULL;}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a59de41ffd933765d2e22ffd8aa198ac1}{lnLHist\_Sample\_PredflucDraw}}[i]\ =\ NULL;}
\DoxyCodeLine{00371\ \ \ \ \ \textcolor{comment}{//\ If\ not\ NULL\ it\ indicates\ the\ selection\ was\ turned\ on,\ so\ initialise\ the\ privates}}
\DoxyCodeLine{00372\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i]\ =\ \textcolor{keyword}{static\_cast<}TH2Poly*\textcolor{keyword}{>}(Nominal[i]-\/>Clone());}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_aebd01b201cf04608b251cd3e272878b7}{doShapeOnly}})\ \mbox{\hyperlink{classSampleSummary_acab977d5e63eaca5862c352fea8a01c2}{NormaliseTH2Poly}}(\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i]);}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a8219b4f8763481e16c6b4493f97378cb}{W2NomHist}}[i]\ =\ \textcolor{keyword}{static\_cast<}TH2Poly*\textcolor{keyword}{>}(NomW2[i]-\/>Clone());}
\DoxyCodeLine{00376\ \ \ \ \ \ \ }
\DoxyCodeLine{00377\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a0ae323dddee7bec9c425f309b60959f1}{lnLHist\_Mean}}[i]\ =\ \textcolor{keyword}{static\_cast<}TH2Poly*\textcolor{keyword}{>}(\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i]-\/>Clone());}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a0ae323dddee7bec9c425f309b60959f1}{lnLHist\_Mean}}[i]-\/>SetDirectory(0);}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_aa9d2908a7dfefa91deb35a562b673eb1}{lnLHist\_Mode}}[i]\ =\ \textcolor{keyword}{static\_cast<}TH2Poly*\textcolor{keyword}{>}(\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i]-\/>Clone());}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_aa9d2908a7dfefa91deb35a562b673eb1}{lnLHist\_Mode}}[i]-\/>SetDirectory(0);}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a9e6d97ff3cffed6a40689a547ec7e5d7}{lnLHist\_Mean\_ProjectX}}[i]\ =\ \textcolor{keyword}{static\_cast<}TH1D*\textcolor{keyword}{>}(\mbox{\hyperlink{classSampleSummary_aed3d754bfa3b870ba2676748d1420b5f}{DataHist\_ProjectX}}[i]-\/>Clone());}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[i]\ =\ \textcolor{keyword}{static\_cast<}TH2Poly*\textcolor{keyword}{>}(\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i]-\/>Clone());}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}})\ \mbox{\hyperlink{classSampleSummary_a805cc2be1298a385160deaa03269313a}{MeanHistCorrected}}[i]\ =\ \textcolor{keyword}{static\_cast<}TH2Poly*\textcolor{keyword}{>}(\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i]-\/>Clone());}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a59475a0c9460277914402850372727ea}{ModeHist}}[i]\ =\ \textcolor{keyword}{static\_cast<}TH2Poly*\textcolor{keyword}{>}(\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i]-\/>Clone());}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2MeanHist}}[i]\ =\ \textcolor{keyword}{static\_cast<}TH2Poly*\textcolor{keyword}{>}(\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i]-\/>Clone());}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_accde7a80fb4c8b986d1a152f88e8f515}{W2ModeHist}}[i]\ =\ \textcolor{keyword}{static\_cast<}TH2Poly*\textcolor{keyword}{>}(\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i]-\/>Clone());}
\DoxyCodeLine{00387\ \ \ \ \ \}}
\DoxyCodeLine{00388\ \ \ \}}
\DoxyCodeLine{00389\ \ \ }
\DoxyCodeLine{00390\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ length\ of\ nominal\ and\ set\ the\ initial\ distributions\ up}}
\DoxyCodeLine{00391\ \ \ \textcolor{comment}{//KS:\ Don't\ multithread,\ mostly\ due\ to\ fact\ that\ we\ initialise\ histograms}}
\DoxyCodeLine{00392\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ Length;\ ++i)\ \{}
\DoxyCodeLine{00393\ \ \ \textcolor{comment}{//\ If\ NULL\ it\ indicates\ the\ selection\ was\ turned\ off,\ so\ initialise\ all\ the\ hists\ to\ NULL}}
\DoxyCodeLine{00394\ \ \ \ \ \textcolor{keywordflow}{if}\ (Nominal[i]\ !=\ NULL)\ }
\DoxyCodeLine{00395\ \ \ \ \ \{}
\DoxyCodeLine{00396\ \ \ \ \ \ \ std::string\ name\ =\ std::string(\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i]-\/>GetName());}
\DoxyCodeLine{00397\ \ \ \ \ \ \ name\ =\ name.substr(0,\ name.find(\textcolor{stringliteral}{"{}\_nom"{}}));}
\DoxyCodeLine{00398\ }
\DoxyCodeLine{00399\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[i]\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[i]+1];}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a0fd31469ea40b54ea864f5eb7360adee}{w2Hist}}[i]\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[i]+1];}
\DoxyCodeLine{00401\ }
\DoxyCodeLine{00402\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}})\ \mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}}[i]\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[i]+1];}
\DoxyCodeLine{00403\ }
\DoxyCodeLine{00404\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[i];\ ++j)}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[i][j]\ =\ NULL;}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a0fd31469ea40b54ea864f5eb7360adee}{w2Hist}}[i][j]\ =\ NULL;}
\DoxyCodeLine{00408\ }
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}})\ \mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}}[i][j]\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a0ae323dddee7bec9c425f309b60959f1}{lnLHist\_Mean}}[i]-\/>SetNameTitle((name+\textcolor{stringliteral}{"{}\_MeanlnL"{}}).c\_str(),\ (name+\textcolor{stringliteral}{"{}\_MeanlnL"{}}).c\_str());}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a0ae323dddee7bec9c425f309b60959f1}{lnLHist\_Mean}}[i]-\/>Reset(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a0ae323dddee7bec9c425f309b60959f1}{lnLHist\_Mean}}[i]-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}-\/2lnL\_\{sample\}\ \#times\ sign(MC-\/data)"{}});}
\DoxyCodeLine{00414\ \ \ \ \ \ \ }
\DoxyCodeLine{00415\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_aa9d2908a7dfefa91deb35a562b673eb1}{lnLHist\_Mode}}[i]-\/>SetNameTitle((name+\textcolor{stringliteral}{"{}\_ModelnL"{}}).c\_str(),\ (name+\textcolor{stringliteral}{"{}\_ModelnL"{}}).c\_str());}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_aa9d2908a7dfefa91deb35a562b673eb1}{lnLHist\_Mode}}[i]-\/>Reset(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_aa9d2908a7dfefa91deb35a562b673eb1}{lnLHist\_Mode}}[i]-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}-\/2lnL\_\{sample\}\ \#times\ sign(MC-\/data)"{}});}
\DoxyCodeLine{00418\ }
\DoxyCodeLine{00419\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a9e6d97ff3cffed6a40689a547ec7e5d7}{lnLHist\_Mean\_ProjectX}}[i]-\/>SetNameTitle((name+\textcolor{stringliteral}{"{}\_MeanlnL\_ProjectX"{}}).c\_str(),\ (name+\textcolor{stringliteral}{"{}\_MeanlnL\_ProjectX"{}}).c\_str());\ }
\DoxyCodeLine{00420\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a9e6d97ff3cffed6a40689a547ec7e5d7}{lnLHist\_Mean\_ProjectX}}[i]-\/>Reset(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a9e6d97ff3cffed6a40689a547ec7e5d7}{lnLHist\_Mean\_ProjectX}}[i]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}-\/2lnL\_\{sample\}\ \#times\ sign(MC-\/data)"{}});}
\DoxyCodeLine{00422\ }
\DoxyCodeLine{00423\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[i]-\/>SetNameTitle((name+\textcolor{stringliteral}{"{}\_mean"{}}).c\_str(),\ (name+\textcolor{stringliteral}{"{}\_mean"{}}).c\_str());}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[i]-\/>Reset(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[i]-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Mean"{}});}
\DoxyCodeLine{00426\ \ \ \ \ \ \ }
\DoxyCodeLine{00427\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}})}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a805cc2be1298a385160deaa03269313a}{MeanHistCorrected}}[i]-\/>SetNameTitle((name+\textcolor{stringliteral}{"{}\_mean\_corrected"{}}).c\_str(),\ (name+\textcolor{stringliteral}{"{}\_mean\_corrected"{}}).c\_str());}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a805cc2be1298a385160deaa03269313a}{MeanHistCorrected}}[i]-\/>Reset(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a805cc2be1298a385160deaa03269313a}{MeanHistCorrected}}[i]-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Mean"{}});}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00433\ \ \ \ \ \ \ std::vector<double>\ xbins;}
\DoxyCodeLine{00434\ \ \ \ \ \ \ std::vector<double>\ ybins;}
\DoxyCodeLine{00435\ }
\DoxyCodeLine{00436\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_abd938805245ca6cfeb8c49363f5ff11c}{SamplePDF}}-\/>\mbox{\hyperlink{classsamplePDFBase_aa3ac45cabba791d5ea5baabcc277384b}{SetupBinning}}(\mbox{\hyperlink{namespaceM3_adb59b8ecdc4e1b2d5d4c826a13aa7463}{M3::int\_t}}(i),\ xbins,\ ybins);}
\DoxyCodeLine{00437\ \ \ \ \ \ \ }
\DoxyCodeLine{00438\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Y\ axis\ is\ number\ of\ events\ to\ get\ estimate\ of\ maximal\ number\ we\ use\ integral}}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ MaxBinning\ =\ \mbox{\hyperlink{classSampleSummary_aebd01b201cf04608b251cd3e272878b7}{doShapeOnly}}\ ?\ 1\ :\ int(\mbox{\hyperlink{Structs_8cpp_ab18c6b2408d7b9021bad06d47a06ee8d}{NoOverflowIntegral}}(\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i])/4);}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a7176dc4fd5368e01f00d5fcc909ee605}{ViolinHists\_ProjectX}}[i]\ =\ \textcolor{keyword}{new}\ TH2D((name+\textcolor{stringliteral}{"{}\_Violin\_ProjectX"{}}).c\_str(),\ (name+\textcolor{stringliteral}{"{}\_Violin\_ProjectX"{}}).c\_str(),\ \textcolor{keywordtype}{int}(xbins.size()-\/1),\ \&xbins[0]\ ,\ 400,\ 0,\ MaxBinning);}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a7176dc4fd5368e01f00d5fcc909ee605}{ViolinHists\_ProjectX}}[i]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Events"{}});}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a7176dc4fd5368e01f00d5fcc909ee605}{ViolinHists\_ProjectX}}[i]-\/>GetXaxis()-\/>SetTitle(std::string(\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i]-\/>GetXaxis()-\/>GetTitle()).c\_str()\ );}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a7176dc4fd5368e01f00d5fcc909ee605}{ViolinHists\_ProjectX}}[i]-\/>SetDirectory(0);}
\DoxyCodeLine{00444\ }
\DoxyCodeLine{00445\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_af4447b09538a0138de4e11c81169f821}{ViolinHists\_ProjectY}}[i]\ =\ \textcolor{keyword}{new}\ TH2D((name+\textcolor{stringliteral}{"{}\_Violin\_ProjectY"{}}).c\_str(),\ (name+\textcolor{stringliteral}{"{}\_Violin\_ProjectY"{}}).c\_str(),\ \textcolor{keywordtype}{int}(ybins.size()-\/1),\ \&ybins[0]\ ,\ 400,\ 0,\ MaxBinning);}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_af4447b09538a0138de4e11c81169f821}{ViolinHists\_ProjectY}}[i]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Events"{}});}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_af4447b09538a0138de4e11c81169f821}{ViolinHists\_ProjectY}}[i]-\/>GetXaxis()-\/>SetTitle(std::string(\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i]-\/>GetYaxis()-\/>GetTitle()).c\_str());}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_af4447b09538a0138de4e11c81169f821}{ViolinHists\_ProjectY}}[i]-\/>SetDirectory(0);}
\DoxyCodeLine{00449\ }
\DoxyCodeLine{00450\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a59475a0c9460277914402850372727ea}{ModeHist}}[i]-\/>SetNameTitle((name+\textcolor{stringliteral}{"{}\_mode"{}}).c\_str(),\ (name+\textcolor{stringliteral}{"{}\_mode"{}}).c\_str());}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a59475a0c9460277914402850372727ea}{ModeHist}}[i]-\/>Reset(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a59475a0c9460277914402850372727ea}{ModeHist}}[i]-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Mode"{}});}
\DoxyCodeLine{00453\ }
\DoxyCodeLine{00454\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2MeanHist}}[i]-\/>SetNameTitle((name+\textcolor{stringliteral}{"{}\_w2mean"{}}).c\_str(),\ (name+\textcolor{stringliteral}{"{}\_w2mean"{}}).c\_str());}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2MeanHist}}[i]-\/>Reset(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2MeanHist}}[i]-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}W2Mean"{}});}
\DoxyCodeLine{00457\ }
\DoxyCodeLine{00458\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_accde7a80fb4c8b986d1a152f88e8f515}{W2ModeHist}}[i]-\/>SetNameTitle((name+\textcolor{stringliteral}{"{}\_w2mode"{}}).c\_str(),\ (name+\textcolor{stringliteral}{"{}\_w2mode"{}}).c\_str());}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_accde7a80fb4c8b986d1a152f88e8f515}{W2ModeHist}}[i]-\/>Reset(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_accde7a80fb4c8b986d1a152f88e8f515}{W2ModeHist}}[i]-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}W2Mode"{}});}
\DoxyCodeLine{00461\ }
\DoxyCodeLine{00462\ \ \ \ \ \ \ \textcolor{comment}{//\ Declare\ the\ lnL\ histograms}}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a6ae29545d50456334c6035d165599787}{lnLHist\_Mean1D}}[i]\ =\ \textcolor{keyword}{new}\ TH1D((name+\textcolor{stringliteral}{"{}\_MeanlnL1D"{}}).c\_str(),(name+\textcolor{stringliteral}{"{}\_MeanlnL1D"{}}).c\_str(),\ 50,\ 1,\ -\/1);}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a6ae29545d50456334c6035d165599787}{lnLHist\_Mean1D}}[i]-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}-\/2LLH\ (Data,\ Pred)"{}});}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a6ae29545d50456334c6035d165599787}{lnLHist\_Mean1D}}[i]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Counts"{}});}
\DoxyCodeLine{00466\ }
\DoxyCodeLine{00467\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a8ad8aa62be1f0f895faf342bfc0f7d13}{lnLHist\_Mode1D}}[i]\ =\ \textcolor{keyword}{new}\ TH1D((name+\textcolor{stringliteral}{"{}\_ModelnL1D"{}}).c\_str(),(name+\textcolor{stringliteral}{"{}\_ModelnL1D"{}}).c\_str(),\ 50,\ 1,\ -\/1);}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a8ad8aa62be1f0f895faf342bfc0f7d13}{lnLHist\_Mode1D}}[i]-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}-\/2LLH\ (Data,\ Pred)"{}});}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a8ad8aa62be1f0f895faf342bfc0f7d13}{lnLHist\_Mode1D}}[i]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Counts"{}});}
\DoxyCodeLine{00470\ }
\DoxyCodeLine{00471\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a08c14eaf908f0fd1bc8bd95b0886c99e}{lnLHist\_Sample\_DrawData}}[i]\ =\ \textcolor{keyword}{new}\ TH1D((name+\textcolor{stringliteral}{"{}\_lnLdrawdata"{}}).c\_str(),(name+\textcolor{stringliteral}{"{}\_lnL"{}}).c\_str(),\ 100,\ 1,\ -\/1);}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a08c14eaf908f0fd1bc8bd95b0886c99e}{lnLHist\_Sample\_DrawData}}[i]-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}-\/2LLH\ (Data,\ Draw)"{}});}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a08c14eaf908f0fd1bc8bd95b0886c99e}{lnLHist\_Sample\_DrawData}}[i]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Counts"{}});}
\DoxyCodeLine{00474\ \ \ \ \ \ \ }
\DoxyCodeLine{00475\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a0e32c2a76de59e4142036b1c5a234819}{lnLHist\_Sample\_DrawflucDraw}}[i]\ =\ \textcolor{keyword}{new}\ TH1D((name+\textcolor{stringliteral}{"{}\_lnLdrawfluc"{}}).c\_str(),(name+\textcolor{stringliteral}{"{}\_lnL"{}}).c\_str(),\ 100,\ 1,\ -\/1);}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a0e32c2a76de59e4142036b1c5a234819}{lnLHist\_Sample\_DrawflucDraw}}[i]-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}-\/2LLH\ (Draw\ Fluc,\ Draw)"{}});}
\DoxyCodeLine{00477\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a0e32c2a76de59e4142036b1c5a234819}{lnLHist\_Sample\_DrawflucDraw}}[i]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Counts"{}});}
\DoxyCodeLine{00478\ \ \ \ \ \ \ }
\DoxyCodeLine{00479\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a59de41ffd933765d2e22ffd8aa198ac1}{lnLHist\_Sample\_PredflucDraw}}[i]\ =\ \textcolor{keyword}{new}\ TH1D((name+\textcolor{stringliteral}{"{}\_lnLpredfluc"{}}).c\_str(),(name+\textcolor{stringliteral}{"{}\_lnL"{}}).c\_str(),\ 100,\ 1,\ -\/1);}
\DoxyCodeLine{00480\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a59de41ffd933765d2e22ffd8aa198ac1}{lnLHist\_Sample\_PredflucDraw}}[i]-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}-\/2LLH\ (Pred\ Fluc,\ Draw)"{}});}
\DoxyCodeLine{00481\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a59de41ffd933765d2e22ffd8aa198ac1}{lnLHist\_Sample\_PredflucDraw}}[i]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Counts"{}});}
\DoxyCodeLine{00482\ \ \ \ \ \}}
\DoxyCodeLine{00483\ \ \ \}}
\DoxyCodeLine{00484\ \ \ \textcolor{comment}{//KS:\ Separate\ loop\ for\ thread\ safe\ reasons}}
\DoxyCodeLine{00485\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ Length;\ ++i)}
\DoxyCodeLine{00486\ \ \ \{}
\DoxyCodeLine{00487\ \ \ \ \ \textcolor{comment}{//KS:\ We\ copy\ histograms\ so\ delete\ original}}
\DoxyCodeLine{00488\ \ \ \ \ \textcolor{keyword}{delete}\ Nominal[i];}
\DoxyCodeLine{00489\ \ \ \ \ \textcolor{keyword}{delete}\ NomW2[i];}
\DoxyCodeLine{00490\ \ \ \}}
\DoxyCodeLine{00491\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_a10d0df830c319f3d8b76d2c3b85b4215}\label{classSampleSummary_a10d0df830c319f3d8b76d2c3b85b4215}} 
\index{SampleSummary@{SampleSummary}!AddThrow@{AddThrow}}
\index{AddThrow@{AddThrow}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{AddThrow()}{AddThrow()}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Add\+Throw (\begin{DoxyParamCaption}\item[{std\+::vector$<$ TH2\+Poly $\ast$ $>$ \&}]{MCHist,  }\item[{std\+::vector$<$ TH2\+Poly $\ast$ $>$ \&}]{W2\+Hist,  }\item[{const double}]{LLHPenalty = {\ttfamily 0.0},  }\item[{const double}]{Weight = {\ttfamily 1.0},  }\item[{const int}]{Draw\+Number = {\ttfamily 0} }\end{DoxyParamCaption})}



KS\+: Add histograms with throws. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l00496}{496}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00497\ \textcolor{comment}{//\ *******************}}
\DoxyCodeLine{00498\ }
\DoxyCodeLine{00499\ \ \ \mbox{\hyperlink{classSampleSummary_aa5c4055d4bb4dc720a4118032cdb4910}{nThrows}}++;}
\DoxyCodeLine{00500\ \ \ \textcolor{comment}{//KS:\ Only\ make\ sense\ for\ PosteriorPredictive}}
\DoxyCodeLine{00501\ \ \ \textcolor{keywordflow}{if}(\ !\mbox{\hyperlink{classSampleSummary_adb737e335e68edeb14a6ce2ca112dc8c}{isPriorPredictive}}\ )\mbox{\hyperlink{classSampleSummary_a07ea4bf6cf23214263ec63cd69de49c1}{RandomHist}}-\/>Fill(DrawNumber);}
\DoxyCodeLine{00502\ }
\DoxyCodeLine{00503\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}}\ =\ int(SampleVector.size());}
\DoxyCodeLine{00504\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classSampleSummary_a8c5a4ed4db695ce5c5820d857c76b4ff}{CheckSamples}}(\mbox{\hyperlink{GetPenaltyTerm_8cpp_a439227feff9d7f55384e8780cfc2eb82}{size}}))\ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00505\ }
\DoxyCodeLine{00506\ \ \ \textcolor{comment}{//\ Push\ back\ the\ throw}}
\DoxyCodeLine{00507\ \ \ \mbox{\hyperlink{classSampleSummary_a13177305e8fd4b97812b2ca563740bf2}{MCVector}}.push\_back(SampleVector);}
\DoxyCodeLine{00508\ \ \ \mbox{\hyperlink{classSampleSummary_a068e2a5ad0c02aaa57a27d2b12e37810}{LLHPenaltyVector}}.push\_back(LLHPenalty);}
\DoxyCodeLine{00509\ \ \ \mbox{\hyperlink{classSampleSummary_ad40a0514f4be18ef026ea41bd5965fa3}{WeightVector}}.push\_back(Weight);}
\DoxyCodeLine{00510\ \ \ \mbox{\hyperlink{classSampleSummary_a263b7541545b8b0ba735e0a3ac2d31e7}{W2MCVector}}.push\_back(W2Vec);}
\DoxyCodeLine{00511\ }
\DoxyCodeLine{00512\ \ \ \textcolor{comment}{//\ Initialise\ the\ posterior\ hist}}
\DoxyCodeLine{00513\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classSampleSummary_a4ade2ccb94981d4483f0b4e6e367b1a0}{first\_pass}})}
\DoxyCodeLine{00514\ \ \ \{}
\DoxyCodeLine{00515\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ SampleNum\ =\ 0;\ \ SampleNum\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++SampleNum)}
\DoxyCodeLine{00516\ \ \ \ \ \{}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nXBins\ =\ 500;}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \textcolor{comment}{//Initialise\ TH1D\ which\ corresponds\ to\ each\ bin\ in\ the\ sample's\ th2poly}}
\DoxyCodeLine{00519\ \ \ \ \ \ \ std::string\ name\ =\ std::string(SampleVector[SampleNum]-\/>GetName());}
\DoxyCodeLine{00520\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <=\ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[SampleNum];\ ++i)}
\DoxyCodeLine{00521\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00522\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Get\ PolyBin}}
\DoxyCodeLine{00523\ \ \ \ \ \ \ \ \ TH2PolyBin*\ bin\ =\ \textcolor{keyword}{static\_cast<}TH2PolyBin*\textcolor{keyword}{>}(SampleVector[SampleNum]-\/>GetBins()-\/>At(i-\/1));}
\DoxyCodeLine{00524\ }
\DoxyCodeLine{00525\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Just\ make\ a\ little\ fancy\ name}}
\DoxyCodeLine{00526\ \ \ \ \ \ \ \ \ std::stringstream\ ss2;}
\DoxyCodeLine{00527\ \ \ \ \ \ \ \ \ ss2\ <<\ name\ <<\ \textcolor{stringliteral}{"{}\_"{}};}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \ \ ss2\ <<\ \textcolor{stringliteral}{"{}p\_\{\#mu\}\ ("{}}\ <<\ bin-\/>GetXMin()\ <<\ \textcolor{stringliteral}{"{}-\/"{}}\ <<\ bin-\/>GetXMax()\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \ \ ss2\ <<\ \textcolor{stringliteral}{"{}\ cos\#theta\_\{\#mu\}\ ("{}}\ <<\ bin-\/>GetYMin()\ <<\ \textcolor{stringliteral}{"{}-\/"{}}\ <<\ bin-\/>GetYMax()\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{00530\ }
\DoxyCodeLine{00531\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[SampleNum][i]\ =\ \textcolor{keyword}{new}\ TH1D(ss2.str().c\_str(),\ ss2.str().c\_str(),nXBins,\ 1,\ -\/1);}
\DoxyCodeLine{00532\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[SampleNum][i]-\/>SetDirectory(0);}
\DoxyCodeLine{00533\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a0fd31469ea40b54ea864f5eb7360adee}{w2Hist}}[SampleNum][i]\ =\ \textcolor{keyword}{new}\ TH1D((\textcolor{stringliteral}{"{}w2\_"{}}+ss2.str()).c\_str(),\ (\textcolor{stringliteral}{"{}w2\_"{}}+ss2.str()).c\_str(),nXBins,\ 1,\ -\/1);}
\DoxyCodeLine{00534\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a0fd31469ea40b54ea864f5eb7360adee}{w2Hist}}[SampleNum][i]-\/>SetDirectory(0);}
\DoxyCodeLine{00535\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}})}
\DoxyCodeLine{00536\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00537\ \ \ \ \ \ \ \ \ \ \ std::string\ betaName\ =\ \textcolor{stringliteral}{"{}\#beta\_param\_"{}};}
\DoxyCodeLine{00538\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}}[SampleNum][i]\ =\ \textcolor{keyword}{new}\ TH1D((betaName+ss2.str()).c\_str(),\ (betaName+ss2.str()).c\_str(),\ 70,\ 1,\ -\/1);}
\DoxyCodeLine{00539\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}}[SampleNum][i]-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}\#beta\ parameter\ value"{}});}
\DoxyCodeLine{00540\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}}[SampleNum][i]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Counts"{}});}
\DoxyCodeLine{00541\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00542\ \ \ \ \ \ \ \}\ \textcolor{comment}{//end\ loop\ over\ bins}}
\DoxyCodeLine{00543\ \ \ \ \ \}\textcolor{comment}{//end\ loop\ over\ samples}}
\DoxyCodeLine{00544\ \ \ \}}
\DoxyCodeLine{00545\ \ \ \mbox{\hyperlink{classSampleSummary_a4ade2ccb94981d4483f0b4e6e367b1a0}{first\_pass}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00546\ }
\DoxyCodeLine{00547\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ samples}}
\DoxyCodeLine{00548\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{00549\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{00550\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{00551\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ SampleNum\ =\ 0;\ \ SampleNum\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++SampleNum)}
\DoxyCodeLine{00552\ \ \ \{}
\DoxyCodeLine{00553\ \ \ \ \ \textcolor{keywordflow}{if}\ (SampleVector[SampleNum]\ ==\ NULL)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00554\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_aebd01b201cf04608b251cd3e272878b7}{doShapeOnly}})\ \mbox{\hyperlink{classSampleSummary_acab977d5e63eaca5862c352fea8a01c2}{NormaliseTH2Poly}}(SampleVector[SampleNum]);}
\DoxyCodeLine{00555\ \ \ \ \ \textcolor{comment}{//\ Loop\ over\ the\ distribution\ and\ fill\ the\ prior/posterior\ predictive}}
\DoxyCodeLine{00556\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <=\ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[SampleNum];\ ++i)\ \{}
\DoxyCodeLine{00557\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Content\ =\ SampleVector[SampleNum]-\/>GetBinContent(i);}
\DoxyCodeLine{00558\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[SampleNum][i]-\/>Fill(Content,\ Weight);}
\DoxyCodeLine{00559\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ w2\ =\ W2Vec[SampleNum]-\/>GetBinContent(i);}
\DoxyCodeLine{00560\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a0fd31469ea40b54ea864f5eb7360adee}{w2Hist}}[SampleNum][i]-\/>Fill(w2,\ Weight);}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}})}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00563\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ data\ =\ \mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[SampleNum]-\/>GetBinContent(i);}
\DoxyCodeLine{00564\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ BetaParam\ =\ \mbox{\hyperlink{StatisticalUtils_8h_afecd84c56d6546271c4547192aae31af}{GetBetaParameter}}(data,\ Content,\ w2,\ \mbox{\hyperlink{classSampleSummary_aafb18632bb987ae9a302d95781d5fdba}{likelihood}});}
\DoxyCodeLine{00565\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}}[SampleNum][i]-\/>Fill(BetaParam,\ Weight);}
\DoxyCodeLine{00566\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00567\ \ \ \ \ \}\ \textcolor{comment}{//\ end\ bin\ loop}}
\DoxyCodeLine{00568\ \ \ \}\ \textcolor{comment}{//\ end\ samples\ loop}}
\DoxyCodeLine{00569\ \}\ \textcolor{comment}{//\ end\ AddThrow}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_a00d7dbefac4ec95c256dfd2aa7e4e1a3}\label{classSampleSummary_a00d7dbefac4ec95c256dfd2aa7e4e1a3}} 
\index{SampleSummary@{SampleSummary}!AddThrowByMode@{AddThrowByMode}}
\index{AddThrowByMode@{AddThrowByMode}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{AddThrowByMode()}{AddThrowByMode()}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Add\+Throw\+By\+Mode (\begin{DoxyParamCaption}\item[{std\+::vector$<$ std\+::vector$<$ TH2\+Poly $\ast$ $>$ $>$ \&}]{Sample\+Vector\+\_\+\+By\+Mode }\end{DoxyParamCaption})}



KS\+: Add histograms for each mode. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l00574}{574}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00574\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00575\ \textcolor{comment}{//\ *******************}}
\DoxyCodeLine{00576\ }
\DoxyCodeLine{00577\ \ \ \mbox{\hyperlink{classSampleSummary_ab3eeac18b62f7ee3a5c943c3cd0e9b76}{MCVectorByMode}}.push\_back(SampleVector\_ByMode);}
\DoxyCodeLine{00578\ }
\DoxyCodeLine{00579\ \ \ \textcolor{comment}{//KS:\ This\ means\ this\ is\ first\ time}}
\DoxyCodeLine{00580\ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{classSampleSummary_a795ac96bf6958c8a2f38c9de23c3c081}{DoByModePlots}})}
\DoxyCodeLine{00581\ \ \ \{}
\DoxyCodeLine{00582\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Turning\ reaction\ breadkwon\ mode,\ brum\ brum"{}});}
\DoxyCodeLine{00583\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_aa6cfe4fb92b67f08b0d94f0fe1d8a3a2}{PosteriorHist\_ByMode}}\ =\ \textcolor{keyword}{new}\ TH1D***[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00584\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a20237446a72eda2dc833bfc72c7e42e1}{MeanHist\_ByMode}}\ =\ \textcolor{keyword}{new}\ TH2Poly**[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00585\ }
\DoxyCodeLine{00586\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ SampleNum\ =\ 0;\ \ SampleNum\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ SampleNum++)}
\DoxyCodeLine{00587\ \ \ \ \ \{}
\DoxyCodeLine{00588\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[SampleNum]\ ==\ NULL)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00589\ }
\DoxyCodeLine{00590\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_aa6cfe4fb92b67f08b0d94f0fe1d8a3a2}{PosteriorHist\_ByMode}}[SampleNum]\ =\ \textcolor{keyword}{new}\ TH1D**[\mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1];}
\DoxyCodeLine{00591\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a20237446a72eda2dc833bfc72c7e42e1}{MeanHist\_ByMode}}[SampleNum]\ =\ \textcolor{keyword}{new}\ TH2Poly*[\mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1];}
\DoxyCodeLine{00592\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1;\ j++)}
\DoxyCodeLine{00593\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00594\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_aa6cfe4fb92b67f08b0d94f0fe1d8a3a2}{PosteriorHist\_ByMode}}[SampleNum][j]\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[SampleNum]+1];}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nXBins\ =\ 500;}
\DoxyCodeLine{00596\ }
\DoxyCodeLine{00597\ \ \ \ \ \ \ \ \ std::string\ name\ =\ std::string(\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[SampleNum]-\/>GetName());}
\DoxyCodeLine{00598\ \ \ \ \ \ \ \ \ name\ =\ name.substr(0,\ name.find(\textcolor{stringliteral}{"{}\_nom"{}}));}
\DoxyCodeLine{00599\ \ \ \ \ \ \ \ \ name\ =\ name\ +\ \textcolor{stringliteral}{"{}\_"{}}+\mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_abf4ac35511787907bc16ae26aa6c2a15}{GetMaCh3ModeName}}(j);}
\DoxyCodeLine{00600\ }
\DoxyCodeLine{00601\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <=\ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[SampleNum];\ i++)}
\DoxyCodeLine{00602\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00603\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Get\ PolyBin}}
\DoxyCodeLine{00604\ \ \ \ \ \ \ \ \ \ \ TH2PolyBin*\ bin\ =\ \textcolor{keyword}{static\_cast<}TH2PolyBin*\textcolor{keyword}{>}(\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[SampleNum]-\/>GetBins()-\/>At(i-\/1));}
\DoxyCodeLine{00605\ }
\DoxyCodeLine{00606\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Just\ make\ a\ little\ fancy\ name}}
\DoxyCodeLine{00607\ \ \ \ \ \ \ \ \ \ \ std::stringstream\ ss2;}
\DoxyCodeLine{00608\ \ \ \ \ \ \ \ \ \ \ ss2\ <<\ name\ <<\ \textcolor{stringliteral}{"{}\_"{}};}
\DoxyCodeLine{00609\ \ \ \ \ \ \ \ \ \ \ ss2\ <<\ \textcolor{stringliteral}{"{}p\_\{\#mu\}\ ("{}}\ <<\ bin-\/>GetXMin()\ <<\ \textcolor{stringliteral}{"{}-\/"{}}\ <<\ bin-\/>GetXMax()\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ \ \ ss2\ <<\ \textcolor{stringliteral}{"{}\ cos\#theta\_\{\#mu\}\ ("{}}\ <<\ bin-\/>GetYMin()\ <<\ \textcolor{stringliteral}{"{}-\/"{}}\ <<\ bin-\/>GetYMax()\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{00611\ }
\DoxyCodeLine{00612\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Initialise\ TH1D\ which\ corresponds\ to\ each\ bin\ in\ the\ sample's\ th2poly}}
\DoxyCodeLine{00613\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_aa6cfe4fb92b67f08b0d94f0fe1d8a3a2}{PosteriorHist\_ByMode}}[SampleNum][j][i]\ =\ \textcolor{keyword}{new}\ TH1D((name+ss2.str()).c\_str(),(name+ss2.str()).c\_str(),nXBins,\ 1,\ -\/1);}
\DoxyCodeLine{00614\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00615\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a20237446a72eda2dc833bfc72c7e42e1}{MeanHist\_ByMode}}[SampleNum][j]\ =\ \textcolor{keyword}{static\_cast<}TH2Poly*\textcolor{keyword}{>}(\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[SampleNum]-\/>Clone());}
\DoxyCodeLine{00616\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a20237446a72eda2dc833bfc72c7e42e1}{MeanHist\_ByMode}}[SampleNum][j]-\/>SetNameTitle((name+\textcolor{stringliteral}{"{}\_mean"{}}).c\_str(),\ (name+\textcolor{stringliteral}{"{}\_mean"{}}).c\_str());}
\DoxyCodeLine{00617\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a20237446a72eda2dc833bfc72c7e42e1}{MeanHist\_ByMode}}[SampleNum][j]-\/>Reset(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00618\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a20237446a72eda2dc833bfc72c7e42e1}{MeanHist\_ByMode}}[SampleNum][j]-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Mean"{}});}
\DoxyCodeLine{00619\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00620\ \ \ \ \ \}}
\DoxyCodeLine{00621\ \ \ \}}
\DoxyCodeLine{00622\ \ \ \mbox{\hyperlink{classSampleSummary_a795ac96bf6958c8a2f38c9de23c3c081}{DoByModePlots}}\ =\ \textcolor{keyword}{true};\ \ \ \ }
\DoxyCodeLine{00623\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ sameples}}
\DoxyCodeLine{00624\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{00625\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{00626\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{00627\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ SampleNum\ =\ 0;\ \ SampleNum\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ SampleNum++)}
\DoxyCodeLine{00628\ \ \ \{}
\DoxyCodeLine{00629\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[SampleNum]\ ==\ NULL)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00630\ \ \ \ \ }
\DoxyCodeLine{00631\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1;\ j++)}
\DoxyCodeLine{00632\ \ \ \ \ \{}
\DoxyCodeLine{00633\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_aebd01b201cf04608b251cd3e272878b7}{doShapeOnly}})\ \mbox{\hyperlink{classSampleSummary_acab977d5e63eaca5862c352fea8a01c2}{NormaliseTH2Poly}}(SampleVector\_ByMode[SampleNum][j]);}
\DoxyCodeLine{00634\ \ \ \ \ \ \ \textcolor{comment}{//\ Loop\ over\ the\ distribution\ and\ fill\ the\ prior/posterior\ predictive}}
\DoxyCodeLine{00635\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <=\ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[SampleNum];\ ++i)}
\DoxyCodeLine{00636\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00637\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Content\ =\ SampleVector\_ByMode[SampleNum][j]-\/>GetBinContent(i);}
\DoxyCodeLine{00638\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ Entries\ =\ int(\mbox{\hyperlink{classSampleSummary_aa6cfe4fb92b67f08b0d94f0fe1d8a3a2}{PosteriorHist\_ByMode}}[SampleNum][j][i]-\/>GetEntries());}
\DoxyCodeLine{00639\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_aa6cfe4fb92b67f08b0d94f0fe1d8a3a2}{PosteriorHist\_ByMode}}[SampleNum][j][i]-\/>Fill(Content,\ \mbox{\hyperlink{classSampleSummary_ad40a0514f4be18ef026ea41bd5965fa3}{WeightVector}}[Entries]);}
\DoxyCodeLine{00640\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00641\ \ \ \ \ \}}
\DoxyCodeLine{00642\ \ \ \}}
\DoxyCodeLine{00643\ \}\ \textcolor{comment}{//\ end\ AddThrowByMode}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_a5cd35f899a9f6dce138e6d99561aebdf}\label{classSampleSummary_a5cd35f899a9f6dce138e6d99561aebdf}} 
\index{SampleSummary@{SampleSummary}!CalcLLH@{CalcLLH}}
\index{CalcLLH@{CalcLLH}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{CalcLLH()}{CalcLLH()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Calc\+LLH (\begin{DoxyParamCaption}\item[{TH1D $\ast$const \&}]{Data,  }\item[{TH1D $\ast$const \&}]{MC,  }\item[{TH1D $\ast$const \&}]{W2 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Helper functions to calculate likelihoods using TH1D, will modify MC hist tittle to include LLH. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l01773}{1773}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01773\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01774\ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{01775\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ llh\ =\ \mbox{\hyperlink{classSampleSummary_ad027b0716b707691e6a9565ee497b66f}{GetLLH}}(DatHist,\ MCHist,\ W2Hist);}
\DoxyCodeLine{01776\ \ \ std::stringstream\ ss;}
\DoxyCodeLine{01777\ \ \ ss\ <<\ \textcolor{stringliteral}{"{}\_2LLH="{}}\ <<\ llh;}
\DoxyCodeLine{01778\ \ \ MCHist-\/>SetTitle((std::string(MCHist-\/>GetTitle())+ss.str()).c\_str());}
\DoxyCodeLine{01779\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\{:<55\}\ \{:<10.2f\}\ \{:<10.2f\}\ \{:<10.2f\}"{}},\ MCHist-\/>GetName(),\ DatHist-\/>Integral(),\ MCHist-\/>Integral(),\ llh);}
\DoxyCodeLine{01780\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_a197d9d30abc14a76d65bd876b28cca32}\label{classSampleSummary_a197d9d30abc14a76d65bd876b28cca32}} 
\index{SampleSummary@{SampleSummary}!CalcLLH@{CalcLLH}}
\index{CalcLLH@{CalcLLH}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{CalcLLH()}{CalcLLH()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Calc\+LLH (\begin{DoxyParamCaption}\item[{TH2\+Poly $\ast$const \&}]{Data,  }\item[{TH2\+Poly $\ast$const \&}]{MC,  }\item[{TH2\+Poly $\ast$const \&}]{W2 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Helper functions to calculate likelihoods using TH2\+Poly, will modify MC hist tittle to include LLH. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l01784}{1784}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01784\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01785\ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{01786\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ llh\ =\ \mbox{\hyperlink{classSampleSummary_ad027b0716b707691e6a9565ee497b66f}{GetLLH}}(DatHist,\ MCHist,\ W2Hist);}
\DoxyCodeLine{01787\ \ \ std::stringstream\ ss;}
\DoxyCodeLine{01788\ \ \ ss\ <<\ \textcolor{stringliteral}{"{}\_2LLH="{}}\ <<\ llh;}
\DoxyCodeLine{01789\ \ \ MCHist-\/>SetTitle((std::string(MCHist-\/>GetTitle())+ss.str()).c\_str());}
\DoxyCodeLine{01790\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}\{:<55\}\ \{:<10.2f\}\ \{:<10.2f\}\ \{:<10.2f\}"{}},\ MCHist-\/>GetName(),\ \mbox{\hyperlink{Structs_8cpp_ab18c6b2408d7b9021bad06d47a06ee8d}{NoOverflowIntegral}}(DatHist),\ \mbox{\hyperlink{Structs_8cpp_ab18c6b2408d7b9021bad06d47a06ee8d}{NoOverflowIntegral}}(MCHist),\ llh);}
\DoxyCodeLine{01791\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_a8c5a4ed4db695ce5c5820d857c76b4ff}\label{classSampleSummary_a8c5a4ed4db695ce5c5820d857c76b4ff}} 
\index{SampleSummary@{SampleSummary}!CheckSamples@{CheckSamples}}
\index{CheckSamples@{CheckSamples}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{CheckSamples()}{CheckSamples()}}
{\footnotesize\ttfamily bool Sample\+Summary\+::\+Check\+Samples (\begin{DoxyParamCaption}\item[{const int}]{Length }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Check the length of samples agrees. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l00300}{300}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00301\ \textcolor{comment}{//\ *******************}}
\DoxyCodeLine{00302\ \ \ \textcolor{keywordtype}{bool}\ ok\ =\ (\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}\ ==\ Length);}
\DoxyCodeLine{00303\ \ \ \textcolor{keywordflow}{if}\ (!ok)\ \{}
\DoxyCodeLine{00304\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Size\ of\ SampleVector\ input\ !=\ number\ of\ defined\ samples"{}});}
\DoxyCodeLine{00305\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Size\ of\ SampleVector:\ \ \{\}"{}},\ Length);}
\DoxyCodeLine{00306\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Size\ of\ defined\ samples:\ \ \{\}"{}},\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}});}
\DoxyCodeLine{00307\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a61052119a625282d0ec6d4a97adf3ee2}{MACH3LOG\_ERROR}}(\textcolor{stringliteral}{"{}Something\ has\ gone\ wrong\ with\ making\ the\ Samples"{}});}
\DoxyCodeLine{00308\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classMaCh3Exception}{MaCh3Exception}}(\_\_FILE\_\_\ ,\ \_\_LINE\_\_\ );}
\DoxyCodeLine{00309\ \ \ \}}
\DoxyCodeLine{00310\ \ \ \textcolor{keywordflow}{return}\ ok;}
\DoxyCodeLine{00311\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_a90fbcfacacf629b0b5f0de3fdab3fdfd}\label{classSampleSummary_a90fbcfacacf629b0b5f0de3fdab3fdfd}} 
\index{SampleSummary@{SampleSummary}!FastViolinFill@{FastViolinFill}}
\index{FastViolinFill@{FastViolinFill}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{FastViolinFill()}{FastViolinFill()}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Fast\+Violin\+Fill (\begin{DoxyParamCaption}\item[{TH2D $\ast$}]{violin,  }\item[{TH1D $\ast$}]{hist\+\_\+1d }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



KS\+: Fill Violin histogram with entry from a toy. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l02673}{2673}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02673\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02674\ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{02675\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ violin-\/>GetXaxis()-\/>GetNbins();\ ++x)\ }
\DoxyCodeLine{02676\ \ \ \{}
\DoxyCodeLine{02677\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ y\ =\ violin-\/>GetYaxis()-\/>FindBin(hist\_1d-\/>GetBinContent(x+1));}
\DoxyCodeLine{02678\ \ \ \ \ violin-\/>SetBinContent(x+1,\ y,\ \ violin-\/>GetBinContent(x+1,\ y)+1);}
\DoxyCodeLine{02679\ \ \ \}}
\DoxyCodeLine{02680\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02681\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_a89b4a0897346caf484c356155792fce3}\label{classSampleSummary_a89b4a0897346caf484c356155792fce3}} 
\index{SampleSummary@{SampleSummary}!GetLLH@{GetLLH}}
\index{GetLLH@{GetLLH}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{GetLLH()}{GetLLH()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily double Sample\+Summary\+::\+Get\+LLH (\begin{DoxyParamCaption}\item[{TH1D $\ast$const \&}]{Data,  }\item[{TH1D $\ast$const \&}]{MC,  }\item[{TH1D $\ast$const \&}]{W2 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Helper functions to calculate likelihoods using TH1D. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l01809}{1809}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01809\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01810\ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{01811\ \ \ \textcolor{keywordtype}{double}\ llh\ =\ 0.0;}
\DoxyCodeLine{01812\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <=\ DatHist-\/>GetXaxis()-\/>GetNbins();\ ++i)}
\DoxyCodeLine{01813\ \ \ \{}
\DoxyCodeLine{01814\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ data\ =\ DatHist-\/>GetBinContent(i);}
\DoxyCodeLine{01815\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ mc\ =\ MCHist-\/>GetBinContent(i);}
\DoxyCodeLine{01816\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ w2\ =\ W2Hist-\/>GetBinContent(i);}
\DoxyCodeLine{01817\ \ \ \ \ llh\ +=\ \mbox{\hyperlink{classSampleSummary_abd938805245ca6cfeb8c49363f5ff11c}{SamplePDF}}-\/>\mbox{\hyperlink{classsamplePDFBase_a772ebf22fbffd9336b2d8c2f46988453}{getTestStatLLH}}(data,\ mc,\ w2);}
\DoxyCodeLine{01818\ \ \ \}}
\DoxyCodeLine{01819\ \ \ \textcolor{comment}{//KS:\ do\ times\ 2\ because\ banff\ reports\ chi2}}
\DoxyCodeLine{01820\ \ \ \textcolor{keywordflow}{return}\ 2*llh;}
\DoxyCodeLine{01821\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_ad027b0716b707691e6a9565ee497b66f}\label{classSampleSummary_ad027b0716b707691e6a9565ee497b66f}} 
\index{SampleSummary@{SampleSummary}!GetLLH@{GetLLH}}
\index{GetLLH@{GetLLH}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{GetLLH()}{GetLLH()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily double Sample\+Summary\+::\+Get\+LLH (\begin{DoxyParamCaption}\item[{TH2\+Poly $\ast$const \&}]{Data,  }\item[{TH2\+Poly $\ast$const \&}]{MC,  }\item[{TH2\+Poly $\ast$const \&}]{W2 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Helper functions to calculate likelihoods using TH2\+Poly. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l01794}{1794}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01794\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01795\ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{01796\ \ \ \textcolor{keywordtype}{double}\ llh\ =\ 0.0;}
\DoxyCodeLine{01797\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ DatHist-\/>GetNumberOfBins()+1;\ ++i)}
\DoxyCodeLine{01798\ \ \ \{}
\DoxyCodeLine{01799\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ data\ =\ DatHist-\/>GetBinContent(i);}
\DoxyCodeLine{01800\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ mc\ =\ MCHist-\/>GetBinContent(i);}
\DoxyCodeLine{01801\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ w2\ =\ W2Hist-\/>GetBinContent(i);}
\DoxyCodeLine{01802\ \ \ \ \ llh\ +=\ \mbox{\hyperlink{classSampleSummary_abd938805245ca6cfeb8c49363f5ff11c}{SamplePDF}}-\/>\mbox{\hyperlink{classsamplePDFBase_a772ebf22fbffd9336b2d8c2f46988453}{getTestStatLLH}}(data,\ mc,\ w2);}
\DoxyCodeLine{01803\ \ \ \}}
\DoxyCodeLine{01804\ \ \ \textcolor{comment}{//KS:\ do\ times\ 2\ because\ banff\ reports\ chi2}}
\DoxyCodeLine{01805\ \ \ \textcolor{keywordflow}{return}\ 2*llh;}
\DoxyCodeLine{01806\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_a1ed7c379dc433cb1dc3b71eb7aec9713}\label{classSampleSummary_a1ed7c379dc433cb1dc3b71eb7aec9713}} 
\index{SampleSummary@{SampleSummary}!GetModeError@{GetModeError}}
\index{GetModeError@{GetModeError}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{GetModeError()}{GetModeError()}}
{\footnotesize\ttfamily double Sample\+Summary\+::\+Get\+Mode\+Error (\begin{DoxyParamCaption}\item[{TH1D $\ast$}]{hpost }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Get the mode error from a TH1D. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l02558}{2558}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02558\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02559\ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{02560\ \ \ \textcolor{comment}{//\ Get\ the\ bin\ which\ has\ the\ largest\ posterior\ density}}
\DoxyCodeLine{02561\ \ \ \textcolor{keywordtype}{int}\ MaxBin\ =\ hpost-\/>GetMaximumBin();}
\DoxyCodeLine{02562\ }
\DoxyCodeLine{02563\ \ \ \textcolor{comment}{//\ The\ total\ integral\ of\ the\ posterior}}
\DoxyCodeLine{02564\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Integral\ =\ hpost-\/>Integral();}
\DoxyCodeLine{02565\ }
\DoxyCodeLine{02566\ \ \ \textcolor{keywordtype}{int}\ LowBin\ =\ MaxBin;}
\DoxyCodeLine{02567\ \ \ \textcolor{keywordtype}{int}\ HighBin\ =\ MaxBin;}
\DoxyCodeLine{02568\ \ \ \textcolor{keywordtype}{double}\ sum\ =\ hpost-\/>GetBinContent(MaxBin);;}
\DoxyCodeLine{02569\ \ \ \textcolor{keywordtype}{double}\ LowCon\ =\ 0.0;}
\DoxyCodeLine{02570\ \ \ \textcolor{keywordtype}{double}\ HighCon\ =\ 0.0;}
\DoxyCodeLine{02571\ \ \ \textcolor{keywordflow}{while}\ (sum/Integral\ <\ 0.6827\ \&\&\ (LowBin\ >\ 0\ ||\ HighBin\ <\ hpost-\/>GetNbinsX()+1)\ )}
\DoxyCodeLine{02572\ \ \ \{}
\DoxyCodeLine{02573\ \ \ \ \ LowCon\ =\ 0.0;}
\DoxyCodeLine{02574\ \ \ \ \ HighCon\ =\ 0.0;}
\DoxyCodeLine{02575\ \ \ \ \ \textcolor{comment}{//KS::\ Move\ further\ only\ if\ you\ haven't\ reached\ histogram\ end}}
\DoxyCodeLine{02576\ \ \ \ \ \textcolor{keywordflow}{if}(LowBin\ >\ 1)}
\DoxyCodeLine{02577\ \ \ \ \ \{}
\DoxyCodeLine{02578\ \ \ \ \ \ \ LowBin-\/-\/;}
\DoxyCodeLine{02579\ \ \ \ \ \ \ LowCon\ =\ hpost-\/>GetBinContent(LowBin);}
\DoxyCodeLine{02580\ \ \ \ \ \}}
\DoxyCodeLine{02581\ \ \ \ \ \textcolor{keywordflow}{if}(HighBin\ <\ hpost-\/>GetNbinsX())}
\DoxyCodeLine{02582\ \ \ \ \ \{}
\DoxyCodeLine{02583\ \ \ \ \ \ \ HighBin++;}
\DoxyCodeLine{02584\ \ \ \ \ \ \ HighCon\ =\ hpost-\/>GetBinContent(HighBin);}
\DoxyCodeLine{02585\ \ \ \ \ \}}
\DoxyCodeLine{02586\ }
\DoxyCodeLine{02587\ \ \ \ \ \textcolor{comment}{//\ If\ we're\ on\ the\ last\ slice\ and\ the\ lower\ contour\ is\ larger\ than\ the\ upper}}
\DoxyCodeLine{02588\ \ \ \ \ \textcolor{keywordflow}{if}\ ((sum+LowCon+HighCon)/Integral\ >\ 0.6827\ \&\&\ LowCon\ >\ HighCon)\ \{}
\DoxyCodeLine{02589\ \ \ \ \ \ \ sum\ +=\ LowCon;}
\DoxyCodeLine{02590\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02591\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ we're\ on\ the\ last\ slice\ and\ the\ upper\ contour\ is\ larger\ than\ the\ lower}}
\DoxyCodeLine{02592\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((sum+LowCon+HighCon)/Integral\ >\ 0.6827\ \&\&\ HighCon\ >=\ LowCon)\ \{}
\DoxyCodeLine{02593\ \ \ \ \ \ \ sum\ +=\ HighCon;}
\DoxyCodeLine{02594\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02595\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02596\ \ \ \ \ \ \ sum\ +=\ LowCon\ +\ HighCon;}
\DoxyCodeLine{02597\ \ \ \ \ \}}
\DoxyCodeLine{02598\ \ \ \}}
\DoxyCodeLine{02599\ }
\DoxyCodeLine{02600\ \ \ \textcolor{keywordtype}{double}\ Mode\_Error\ =\ 0.0;}
\DoxyCodeLine{02601\ \ \ \textcolor{keywordflow}{if}\ (LowCon\ >\ HighCon)\ \{}
\DoxyCodeLine{02602\ \ \ \ \ Mode\_Error\ =\ std::fabs(hpost-\/>GetBinCenter(LowBin)-\/hpost-\/>GetBinCenter(MaxBin));}
\DoxyCodeLine{02603\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02604\ \ \ \ \ Mode\_Error\ =\ std::fabs(hpost-\/>GetBinCenter(HighBin)-\/hpost-\/>GetBinCenter(MaxBin));}
\DoxyCodeLine{02605\ \ \ \}}
\DoxyCodeLine{02606\ }
\DoxyCodeLine{02607\ \ \ \textcolor{keywordflow}{return}\ Mode\_Error;}
\DoxyCodeLine{02608\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_a938ba96c39db535ede194bfe9f15d626}\label{classSampleSummary_a938ba96c39db535ede194bfe9f15d626}} 
\index{SampleSummary@{SampleSummary}!GetRandomPoly2@{GetRandomPoly2}}
\index{GetRandomPoly2@{GetRandomPoly2}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{GetRandomPoly2()}{GetRandomPoly2()}}
{\footnotesize\ttfamily int Sample\+Summary\+::\+Get\+Random\+Poly2 (\begin{DoxyParamCaption}\item[{const TH2\+Poly $\ast$}]{Poly\+Hist }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Return 2 random numbers along axis x and y distributed according to the cell-\/contents. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l02529}{2529}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02529\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02530\ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{02531\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nbins\ =\ PolyHist-\/>GetNumberOfBins();}
\DoxyCodeLine{02532\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ r1\ =\ \mbox{\hyperlink{classSampleSummary_a8322552ef396f34af5ee4bd47a44e39e}{rnd}}-\/>Rndm();}
\DoxyCodeLine{02533\ \ \ }
\DoxyCodeLine{02534\ \ \ \textcolor{keywordtype}{double}*\ fIntegral\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[nbins+2];}
\DoxyCodeLine{02535\ \ \ fIntegral[0]\ =\ 0.0;}
\DoxyCodeLine{02536\ }
\DoxyCodeLine{02537\ \ \ \textcolor{comment}{//KS:\ This\ is\ custom\ version\ of\ ComputeIntegral,\ once\ again\ ROOT\ was\ lazy\ :(}}
\DoxyCodeLine{02538\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ nbins+1;\ ++i)\ }
\DoxyCodeLine{02539\ \ \ \{}
\DoxyCodeLine{02540\ \ \ \ \ fIntegral[i]\ =\ 0.0;}
\DoxyCodeLine{02541\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ content\ =\ PolyHist-\/>GetBinContent(i);}
\DoxyCodeLine{02542\ \ \ \ \ fIntegral[i]\ +=\ fIntegral[i\ -\/\ 1]\ +\ content;}
\DoxyCodeLine{02543\ \ \ \}}
\DoxyCodeLine{02544\ \ \ \textcolor{keywordflow}{for}\ (Int\_t\ bin\ =\ 1;\ bin\ <\ nbins+1;\ ++bin)\ \ fIntegral[bin]\ /=\ fIntegral[nbins];}
\DoxyCodeLine{02545\ \ \ fIntegral[nbins+1]\ =\ PolyHist-\/>GetEntries();}
\DoxyCodeLine{02546\ \ \ }
\DoxyCodeLine{02547\ \ \ \textcolor{comment}{//KS:\ We\ just\ return\ one\ rather\ then\ X\ and\ Y,\ this\ way\ we\ can\ use\ SetBinContent\ rather\ than\ Fill,\ which\ is\ faster\ }}
\DoxyCodeLine{02548\ \ \ \textcolor{keywordtype}{int}\ iBin\ =\ int(TMath::BinarySearch(nbins,\ fIntegral,\ r1));}
\DoxyCodeLine{02549\ \ \ \textcolor{comment}{//KS:\ Have\ to\ increment\ because\ TH2Poly\ has\ stupid\ offset\ arghh}}
\DoxyCodeLine{02550\ \ \ iBin\ +=\ 1;}
\DoxyCodeLine{02551\ \ \ }
\DoxyCodeLine{02552\ \ \ \textcolor{keyword}{delete}[]\ fIntegral;}
\DoxyCodeLine{02553\ \ \ \textcolor{keywordflow}{return}\ iBin;}
\DoxyCodeLine{02554\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_a316974fb99c5a775e1c7099be3bccc7b}\label{classSampleSummary_a316974fb99c5a775e1c7099be3bccc7b}} 
\index{SampleSummary@{SampleSummary}!MakeChi2Hists@{MakeChi2Hists}}
\index{MakeChi2Hists@{MakeChi2Hists}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{MakeChi2Hists()}{MakeChi2Hists()}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Make\+Chi2\+Hists (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Make the fluctuated histograms (2D and 1D) for the chi2s Essentially taking the MCMC draws and calculating their LLH to the Posterior predictive distribution And additionally taking the data histogram and calculating the LLH to the predictive distribution Additionally we calculate the chi2 of the draws (fluctuated) of the MC with the prior/posterior predictive and plot it vs the chi2 from the draws of MCMC and the data. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l01234}{1234}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01234\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01235\ \textcolor{comment}{//\ *******************}}
\DoxyCodeLine{01236\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Making\ the\ chi2\ histograms..."{}});}
\DoxyCodeLine{01237\ \ \ \textcolor{comment}{//\ Have\ this\ to\ signify\ if\ we're\ doing\ the\ first\ pass}}
\DoxyCodeLine{01238\ \ \ \mbox{\hyperlink{classSampleSummary_a4ade2ccb94981d4483f0b4e6e367b1a0}{first\_pass}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01239\ }
\DoxyCodeLine{01240\ \ \ \textcolor{keywordtype}{double}\ AveragePenalty\ =\ 0;}
\DoxyCodeLine{01241\ }
\DoxyCodeLine{01242\ \ \ \textcolor{comment}{//\ Vectors\ to\ hold\ exact\ LLH}}
\DoxyCodeLine{01243\ \ \ std::vector<double>\ LLH\_PredFluc\_V(\mbox{\hyperlink{classSampleSummary_aa5c4055d4bb4dc720a4118032cdb4910}{nThrows}});}
\DoxyCodeLine{01244\ \ \ std::vector<double>\ LLH\_DataDraw\_V(\mbox{\hyperlink{classSampleSummary_aa5c4055d4bb4dc720a4118032cdb4910}{nThrows}});}
\DoxyCodeLine{01245\ \ \ std::vector<double>\ LLH\_DrawFlucDraw\_V(\mbox{\hyperlink{classSampleSummary_aa5c4055d4bb4dc720a4118032cdb4910}{nThrows}});}
\DoxyCodeLine{01246\ \ \ \ \ }
\DoxyCodeLine{01247\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ draws}}
\DoxyCodeLine{01248\ \ \ \textcolor{comment}{//\ Should\ look\ into\ multi-\/threading\ this.\ Would\ require\ temporary\ THxx\ structures\ from\ arrays}}
\DoxyCodeLine{01249\ \ \ \textcolor{comment}{//KS:\ Update\ above\ would\ be\ ideal\ but\ currently\ we\ loop\ over\ samples\ (see\ loop\ below)\ which\ isn't\ as\ efficient\ as\ loop\ over\ throws\ but\ much\ much\ easier\ to\ implement}}
\DoxyCodeLine{01250\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_aa5c4055d4bb4dc720a4118032cdb4910}{nThrows}};\ ++i)}
\DoxyCodeLine{01251\ \ \ \{}
\DoxyCodeLine{01252\ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ \%\ (\mbox{\hyperlink{classSampleSummary_aa5c4055d4bb4dc720a4118032cdb4910}{nThrows}}/10)\ ==\ 0)\ \{}
\DoxyCodeLine{01253\ \ \ \ \ \ \ \mbox{\hyperlink{namespaceMaCh3Utils_a4c8bdeb1d34606aed192e9f1311a72f5}{MaCh3Utils::PrintProgressBar}}(i,\ \mbox{\hyperlink{classSampleSummary_aa5c4055d4bb4dc720a4118032cdb4910}{nThrows}});}
\DoxyCodeLine{01254\ \ \ \ \ \}}
\DoxyCodeLine{01255\ }
\DoxyCodeLine{01256\ \ \ \ \ \textcolor{comment}{//\ Set\ the\ total\ LLH\ to\ zero\ to\ initialise}}
\DoxyCodeLine{01257\ \ \ \ \ \textcolor{keywordtype}{double}\ total\_llh\_data\_draw\_temp\ =\ 0.0;}
\DoxyCodeLine{01258\ \ \ \ \ \textcolor{keywordtype}{double}\ total\_llh\_drawfluc\_draw\_temp\ =\ 0.0;}
\DoxyCodeLine{01259\ \ \ \ \ \textcolor{keywordtype}{double}\ total\_llh\_predfluc\_draw\_temp\ =\ 0.0;}
\DoxyCodeLine{01260\ }
\DoxyCodeLine{01261\ \ \ \ \ \textcolor{keywordtype}{double}\ total\_llh\_rate\_data\_draw\_temp\ =\ 0.0;}
\DoxyCodeLine{01262\ \ \ \ \ \textcolor{keywordtype}{double}\ total\_llh\_rate\_predfluc\_draw\_temp\ =\ 0.0;}
\DoxyCodeLine{01263\ }
\DoxyCodeLine{01264\ \ \ \ \ \textcolor{keywordtype}{double}\ total\_llh\_data\_drawfluc\_temp\ =\ 0.0;}
\DoxyCodeLine{01265\ \ \ \ \ \textcolor{keywordtype}{double}\ total\_llh\_data\_predfluc\_temp\ =\ 0.0;}
\DoxyCodeLine{01266\ \ \ \ \ \textcolor{keywordtype}{double}\ total\_llh\_draw\_pred\_temp\ =\ 0.0;}
\DoxyCodeLine{01267\ \ \ \ \ \textcolor{keywordtype}{double}\ total\_llh\_drawfluc\_pred\_temp\ =\ 0.0;}
\DoxyCodeLine{01268\ \ \ \ \ \textcolor{keywordtype}{double}\ total\_llh\_drawfluc\_predfluc\_temp\ =\ 0.0;}
\DoxyCodeLine{01269\ \ \ \ \ \textcolor{keywordtype}{double}\ total\_llh\_predfluc\_pred\_temp\ =\ 0.0;}
\DoxyCodeLine{01270\ \ \ \ \ \textcolor{keywordtype}{double}\ total\_llh\_datafluc\_draw\_temp\ =\ 0.0;}
\DoxyCodeLine{01271\ }
\DoxyCodeLine{01272\ \ \ \ \ \textcolor{keywordtype}{double}\ total\_llh\_data\_draw\_ProjectX\_temp\ =\ 0.0;}
\DoxyCodeLine{01273\ \ \ \ \ \textcolor{keywordtype}{double}\ total\_llh\_drawfluc\_draw\_ProjectX\_temp\ =\ 0.0;}
\DoxyCodeLine{01274\ }
\DoxyCodeLine{01275\ \ \ \ \ \textcolor{comment}{//\ Save\ the\ double\ that\ gets\ written\ to\ file}}
\DoxyCodeLine{01276\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}}\ =\ \mbox{\hyperlink{classSampleSummary_a068e2a5ad0c02aaa57a27d2b12e37810}{LLHPenaltyVector}}[i];}
\DoxyCodeLine{01277\ \ \ \ \ AveragePenalty\ +=\ \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}};}
\DoxyCodeLine{01278\ }
\DoxyCodeLine{01279\ \ \ \ \ \textcolor{comment}{//\ Make\ the\ Poisson\ fluctuated\ hist}}
\DoxyCodeLine{01280\ \ \ \ \ TH2Poly\ **FluctHist\ =\ \textcolor{keyword}{new}\ TH2Poly*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{01281\ \ \ \ \ \textcolor{comment}{//\ Also\ Poisson\ fluctuate\ the\ drawn\ MCMC\ hist}}
\DoxyCodeLine{01282\ \ \ \ \ TH2Poly\ **FluctDrawHist\ =\ \textcolor{keyword}{new}\ TH2Poly*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{01283\ \ \ \ \ \textcolor{comment}{//\ Finally\ Poisson\ fluctuate\ the\ data\ histogram}}
\DoxyCodeLine{01284\ \ \ \ \ TH2Poly\ **DataFlucHist\ =\ \textcolor{keyword}{new}\ TH2Poly*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{01285\ }
\DoxyCodeLine{01286\ \ \ \ \ \textcolor{comment}{//\ Finally\ Poisson\ fluctuate\ the\ data\ histogram}}
\DoxyCodeLine{01287\ \ \ \ \ TH1D\ **FluctDrawHistProjectX\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{01288\ \ \ \ \ TH1D\ **DrawHistProjectX\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{01289\ \ \ \ \ TH1D\ **DrawHistProjectY\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{01290\ \ \ \ \ TH1D\ **DrawW2HistProjectX\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{01291\ }
\DoxyCodeLine{01292\ \ \ \ \ \textcolor{comment}{//KS:\ We\ have\ to\ clone\ histograms\ here\ to\ avoid\ cloning\ in\ MP\ loop,\ we\ have\ to\ make\ sure\ binning\ matches,\ content\ doesn't\ have\ to}}
\DoxyCodeLine{01293\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ SampleNum\ =\ 0;\ \ SampleNum\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++SampleNum)}
\DoxyCodeLine{01294\ \ \ \ \ \{}
\DoxyCodeLine{01295\ \ \ \ \ \ \ FluctHist[SampleNum]\ =\ \textcolor{keyword}{static\_cast<}TH2Poly*\textcolor{keyword}{>}(\mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[SampleNum]-\/>Clone());}
\DoxyCodeLine{01296\ \ \ \ \ \ \ FluctDrawHist[SampleNum]\ =\ \textcolor{keyword}{static\_cast<}TH2Poly*\textcolor{keyword}{>}(\mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[SampleNum]-\/>Clone());}
\DoxyCodeLine{01297\ \ \ \ \ \ \ DataFlucHist[SampleNum]\ =\ \textcolor{keyword}{static\_cast<}TH2Poly*\textcolor{keyword}{>}(\mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[SampleNum]-\/>Clone());}
\DoxyCodeLine{01298\ }
\DoxyCodeLine{01299\ \ \ \ \ \ \ FluctDrawHistProjectX[SampleNum]\ =\ \textcolor{keyword}{static\_cast<}TH1D*\textcolor{keyword}{>}(\mbox{\hyperlink{classSampleSummary_aed3d754bfa3b870ba2676748d1420b5f}{DataHist\_ProjectX}}[SampleNum]-\/>Clone());}
\DoxyCodeLine{01300\ }
\DoxyCodeLine{01301\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ ith\ draw\ for\ the\ jth\ sample}}
\DoxyCodeLine{01302\ \ \ \ \ \ \ TH2Poly\ *DrawHist\ =\ \mbox{\hyperlink{classSampleSummary_a13177305e8fd4b97812b2ca563740bf2}{MCVector}}[i][SampleNum];}
\DoxyCodeLine{01303\ \ \ \ \ \ \ TH2Poly\ *DrawW2Hist\ =\ \mbox{\hyperlink{classSampleSummary_a263b7541545b8b0ba735e0a3ac2d31e7}{W2MCVector}}[i][SampleNum];}
\DoxyCodeLine{01304\ }
\DoxyCodeLine{01305\ \ \ \ \ \ \ \textcolor{comment}{//ProjectPoly\ calls\ new\ TH1D\ under\ the\ hood,\ never\ define\ new\ ROOT\ object\ under\ MP...}}
\DoxyCodeLine{01306\ \ \ \ \ \ \ DrawHistProjectX[SampleNum]\ =\ \mbox{\hyperlink{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}{ProjectPoly}}(DrawHist,\ \textcolor{keyword}{true},\ SampleNum);}
\DoxyCodeLine{01307\ \ \ \ \ \ \ DrawW2HistProjectX[SampleNum]\ =\ \mbox{\hyperlink{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}{ProjectPoly}}(DrawW2Hist,\ \textcolor{keyword}{true},\ SampleNum);}
\DoxyCodeLine{01308\ \ \ \ \ \ \ DrawHistProjectY[SampleNum]\ =\ \mbox{\hyperlink{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}{ProjectPoly}}(DrawHist,\ \textcolor{keyword}{false},\ SampleNum);}
\DoxyCodeLine{01309\ \ \ \ \ \}}
\DoxyCodeLine{01310\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD\ }}
\DoxyCodeLine{01311\ \ \ \ \ \textcolor{comment}{//KS:\ might\ be\ most\ obscure\ OMP\ reduction\ I\ have\ ever\ made...}}
\DoxyCodeLine{01312\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ parallel\ for\ reduction(+:total\_llh\_data\_draw\_temp,\ total\_llh\_drawfluc\_draw\_temp,\ total\_llh\_predfluc\_draw\_temp,\ total\_llh\_rate\_data\_draw\_temp,\ total\_llh\_rate\_predfluc\_draw\_temp,\ total\_llh\_data\_drawfluc\_temp,\ total\_llh\_data\_predfluc\_temp,\ total\_llh\_draw\_pred\_temp,\ total\_llh\_drawfluc\_pred\_temp,\ total\_llh\_drawfluc\_predfluc\_temp,\ total\_llh\_predfluc\_pred\_temp,\ total\_llh\_datafluc\_draw\_temp,\ total\_llh\_data\_draw\_ProjectX\_temp,\ total\_llh\_drawfluc\_draw\_ProjectX\_temp)}}
\DoxyCodeLine{01313\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{01314\ \ \ \ \ \textcolor{comment}{//\ Loop\ over\ the\ samples}}
\DoxyCodeLine{01315\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ SampleNum\ =\ 0;\ \ SampleNum\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++SampleNum)}
\DoxyCodeLine{01316\ \ \ \ \ \{}
\DoxyCodeLine{01317\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ ith\ draw\ for\ the\ jth\ sample}}
\DoxyCodeLine{01318\ \ \ \ \ \ \ TH2Poly\ *DrawHist\ =\ \mbox{\hyperlink{classSampleSummary_a13177305e8fd4b97812b2ca563740bf2}{MCVector}}[i][SampleNum];}
\DoxyCodeLine{01319\ \ \ \ \ \ \ TH2Poly\ *DrawW2Hist\ =\ \mbox{\hyperlink{classSampleSummary_a263b7541545b8b0ba735e0a3ac2d31e7}{W2MCVector}}[i][SampleNum];}
\DoxyCodeLine{01320\ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ empty\ samples}}
\DoxyCodeLine{01321\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (DrawHist\ ==\ NULL)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01322\ }
\DoxyCodeLine{01323\ \ \ \ \ \ \ \textcolor{comment}{//\ Add\ LLH\ penalties\ from\ the\ systematics\ to\ the\ LLH\ that\ use\ the\ drawn\ histogram}}
\DoxyCodeLine{01324\ \ \ \ \ \ \ \textcolor{comment}{//\ Data\ vs\ Draw}}
\DoxyCodeLine{01325\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a8e20b53f7845651f6dc8f4b5faa9400c}{llh\_data\_draw}}[SampleNum]\ =\ \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}};}
\DoxyCodeLine{01326\ \ \ \ \ \ \ \textcolor{comment}{//\ Fluctuated\ Draw\ vs\ Draw}}
\DoxyCodeLine{01327\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_afbea2da38c0bd2e78ec9fa87ebdf992a}{llh\_drawfluc\_draw}}[SampleNum]\ =\ \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}};}
\DoxyCodeLine{01328\ \ \ \ \ \ \ \textcolor{comment}{//\ Fluctuated\ Predicitve\ vs\ Draw}}
\DoxyCodeLine{01329\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a6dc4f1e22995a7bfa538df57903e7650}{llh\_predfluc\_draw}}[SampleNum]\ =\ \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}};}
\DoxyCodeLine{01330\ \ \ \ \ \ \ }
\DoxyCodeLine{01331\ \ \ \ \ \ \ \textcolor{comment}{//\ Data\ vs\ Draw\ using\ rate}}
\DoxyCodeLine{01332\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_ad766eb771115b2800b3a8e20f95ac612}{llh\_rate\_data\_draw}}[SampleNum]\ =\ \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}};}
\DoxyCodeLine{01333\ \ \ \ \ \ \ \textcolor{comment}{//\ Fluctuated\ Predicitve\ vs\ Draw\ using\ rate}}
\DoxyCodeLine{01334\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a09609fb1b319d270011d01983fa88d79}{llh\_rate\_predfluc\_draw}}[SampleNum]\ =\ \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}};}
\DoxyCodeLine{01335\ }
\DoxyCodeLine{01336\ \ \ \ \ \ \ \ \textcolor{comment}{//\ Data\ vs\ Fluctuated\ Draw}}
\DoxyCodeLine{01337\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a5c46fc1f6e0ab29dcadcde3152b0d275}{llh\_data\_drawfluc}}[SampleNum]\ =\ \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}};}
\DoxyCodeLine{01338\ \ \ \ \ \ \ \textcolor{comment}{//\ Draw\ vs\ Predictive}}
\DoxyCodeLine{01339\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a1a154b17f6f4ab15eec03f3dcfc91e5f}{llh\_draw\_pred}}[SampleNum]\ =\ \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}};}
\DoxyCodeLine{01340\ \ \ \ \ \ \ \textcolor{comment}{//\ Fluctuated\ Draw\ vs\ Predictive}}
\DoxyCodeLine{01341\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_adb0f7be738ba901c4a6c1253dc8b2b03}{llh\_drawfluc\_pred}}[SampleNum]\ =\ \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}};}
\DoxyCodeLine{01342\ \ \ \ \ \ \ \textcolor{comment}{//\ Fluctuated\ Draw\ vs\ Fluctuated\ Predictive}}
\DoxyCodeLine{01343\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a5fb4519a15437b229f37fb171e578ab0}{llh\_drawfluc\_predfluc}}[SampleNum]\ =\ \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}};}
\DoxyCodeLine{01344\ \ \ \ \ \ \ \textcolor{comment}{//\ Fluctuated\ Data\ vs\ Draw}}
\DoxyCodeLine{01345\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a85f8c5e630bc333137a403401097785d}{llh\_datafluc\_draw}}[SampleNum]\ =\ \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}};}
\DoxyCodeLine{01346\ \ \ \ \ \ \ }
\DoxyCodeLine{01347\ \ \ \ \ \ \ \textcolor{comment}{//Some\ LLH\ for\ 1D\ projections}}
\DoxyCodeLine{01348\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a77250cd6138be6d5220f2ac6c7ebd2ea}{llh\_data\_draw\_ProjectX}}[SampleNum]\ =\ \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}};}
\DoxyCodeLine{01349\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a6a171e9c3a2f71785b777d1d64a78dfa}{llh\_drawfluc\_draw\_ProjectX}}[SampleNum]\ =\ \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}};}
\DoxyCodeLine{01350\ \ \ \ \ \ \ }
\DoxyCodeLine{01351\ \ \ \ \ \ \ \textcolor{comment}{//Other\ get\ 0\ penalty\ term}}
\DoxyCodeLine{01352\ \ \ \ \ \ \ \textcolor{comment}{//\ Fluctuated\ Predictive\ vs\ Predictive}}
\DoxyCodeLine{01353\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a5160d49065adca11bec43baaab283b70}{llh\_predfluc\_pred}}[SampleNum]\ =\ 0.0;}
\DoxyCodeLine{01354\ \ \ \ \ \ \ \textcolor{comment}{//\ Data\ vs\ Fluctuated\ Predictive}}
\DoxyCodeLine{01355\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a07d4cc27e2299f3beefe0b3e78da493a}{llh\_data\_predfluc}}[SampleNum]\ =\ 0.0;}
\DoxyCodeLine{01356\ }
\DoxyCodeLine{01357\ \ \ \ \ \ \ \textcolor{comment}{//\ Make\ the\ Poisson\ fluctuated\ hist}}
\DoxyCodeLine{01358\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_ada2f0b7b9b7bb687e67023e84151610e}{MakeFluctuatedHistogram}}(FluctHist[SampleNum],\ \mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[SampleNum]);}
\DoxyCodeLine{01359\ \ \ \ \ \ \ \textcolor{comment}{//\ Also\ Poisson\ fluctuate\ the\ drawn\ MCMC\ hist}}
\DoxyCodeLine{01360\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_ada2f0b7b9b7bb687e67023e84151610e}{MakeFluctuatedHistogram}}(FluctDrawHist[SampleNum],\ DrawHist);}
\DoxyCodeLine{01361\ \ \ \ \ \ \ \textcolor{comment}{//\ Finally\ Poisson\ fluctuate\ the\ data\ histogram}}
\DoxyCodeLine{01362\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_ada2f0b7b9b7bb687e67023e84151610e}{MakeFluctuatedHistogram}}(DataFlucHist[SampleNum],\ \mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[SampleNum]);}
\DoxyCodeLine{01363\ }
\DoxyCodeLine{01364\ \ \ \ \ \ \ \textcolor{comment}{//\ Likelihood\ between\ the\ drawn\ histogram\ and\ the\ data}}
\DoxyCodeLine{01365\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ DataDrawLLH\ =\ \mbox{\hyperlink{classSampleSummary_ad027b0716b707691e6a9565ee497b66f}{GetLLH}}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[SampleNum],\ DrawHist,\ DrawW2Hist);}
\DoxyCodeLine{01366\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a8e20b53f7845651f6dc8f4b5faa9400c}{llh\_data\_draw}}[SampleNum]\ +=\ DataDrawLLH;}
\DoxyCodeLine{01367\ \ \ \ \ \ \ total\_llh\_data\_draw\_temp\ +=\ DataDrawLLH;}
\DoxyCodeLine{01368\ \ \ \ \ \ \ }
\DoxyCodeLine{01369\ \ \ \ \ \ \ \textcolor{comment}{//\ Likelihood\ between\ drawn\ histogram\ and\ fluctuated\ drawn\ histogram}}
\DoxyCodeLine{01370\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ DrawFlucDrawLLH\ =\ \mbox{\hyperlink{classSampleSummary_ad027b0716b707691e6a9565ee497b66f}{GetLLH}}(FluctDrawHist[SampleNum],\ DrawHist,\ DrawW2Hist);}
\DoxyCodeLine{01371\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_afbea2da38c0bd2e78ec9fa87ebdf992a}{llh\_drawfluc\_draw}}[SampleNum]\ +=\ DrawFlucDrawLLH;}
\DoxyCodeLine{01372\ \ \ \ \ \ \ total\_llh\_drawfluc\_draw\_temp\ +=\ DrawFlucDrawLLH;}
\DoxyCodeLine{01373\ \ \ \ \ \ \ }
\DoxyCodeLine{01374\ \ \ \ \ \ \ \textcolor{comment}{//\ Likelihood\ between\ drawn\ histogram\ and\ fluctuated\ posterior\ predictive\ distribution}}
\DoxyCodeLine{01375\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ PredFlucDrawLLH\ =\ \mbox{\hyperlink{classSampleSummary_ad027b0716b707691e6a9565ee497b66f}{GetLLH}}(FluctHist[SampleNum],\ DrawHist,\ DrawW2Hist);}
\DoxyCodeLine{01376\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a6dc4f1e22995a7bfa538df57903e7650}{llh\_predfluc\_draw}}[SampleNum]\ +=\ PredFlucDrawLLH;}
\DoxyCodeLine{01377\ \ \ \ \ \ \ total\_llh\_predfluc\_draw\_temp\ +=\ PredFlucDrawLLH;}
\DoxyCodeLine{01378\ }
\DoxyCodeLine{01379\ \textcolor{comment}{//Rate\ Based\ p-\/value}}
\DoxyCodeLine{01380\ \ \ \ \ \ \ \textcolor{comment}{//\ Likelihood\ between\ the\ drawn\ histogram\ and\ the\ data}}
\DoxyCodeLine{01381\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ RateDataDrawLLH\ =\ \mbox{\hyperlink{classSampleSummary_abd938805245ca6cfeb8c49363f5ff11c}{SamplePDF}}-\/>\mbox{\hyperlink{classsamplePDFBase_a772ebf22fbffd9336b2d8c2f46988453}{getTestStatLLH}}(\mbox{\hyperlink{Structs_8cpp_ab18c6b2408d7b9021bad06d47a06ee8d}{NoOverflowIntegral}}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[SampleNum]),\ \mbox{\hyperlink{Structs_8cpp_ab18c6b2408d7b9021bad06d47a06ee8d}{NoOverflowIntegral}}(DrawHist),\ \mbox{\hyperlink{Structs_8cpp_ab18c6b2408d7b9021bad06d47a06ee8d}{NoOverflowIntegral}}(DrawW2Hist));}
\DoxyCodeLine{01382\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_ad766eb771115b2800b3a8e20f95ac612}{llh\_rate\_data\_draw}}[SampleNum]\ +=\ RateDataDrawLLH;}
\DoxyCodeLine{01383\ \ \ \ \ \ \ total\_llh\_rate\_data\_draw\_temp\ +=\ RateDataDrawLLH;}
\DoxyCodeLine{01384\ }
\DoxyCodeLine{01385\ \ \ \ \ \ \ \textcolor{comment}{//\ Likelihood\ between\ drawn\ histogram\ and\ fluctuated\ posterior\ predictive\ distribution\ using\ rate}}
\DoxyCodeLine{01386\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ RatePredFlucDrawLLH\ =\ \mbox{\hyperlink{classSampleSummary_abd938805245ca6cfeb8c49363f5ff11c}{SamplePDF}}-\/>\mbox{\hyperlink{classsamplePDFBase_a772ebf22fbffd9336b2d8c2f46988453}{getTestStatLLH}}(\mbox{\hyperlink{Structs_8cpp_ab18c6b2408d7b9021bad06d47a06ee8d}{NoOverflowIntegral}}(FluctHist[SampleNum]),\ \mbox{\hyperlink{Structs_8cpp_ab18c6b2408d7b9021bad06d47a06ee8d}{NoOverflowIntegral}}(DrawHist),\ \mbox{\hyperlink{Structs_8cpp_ab18c6b2408d7b9021bad06d47a06ee8d}{NoOverflowIntegral}}(DrawW2Hist));}
\DoxyCodeLine{01387\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a09609fb1b319d270011d01983fa88d79}{llh\_rate\_predfluc\_draw}}[SampleNum]\ +=\ RatePredFlucDrawLLH;}
\DoxyCodeLine{01388\ \ \ \ \ \ \ total\_llh\_rate\_predfluc\_draw\_temp\ +=\ RatePredFlucDrawLLH;}
\DoxyCodeLine{01389\ }
\DoxyCodeLine{01390\ \textcolor{comment}{//\ \ \ \ All\ LLH\ below\ are\ for\ validation\ reason\ but\ not\ used\ for\ final\ P-\/Value}}
\DoxyCodeLine{01391\ \ \ \ \ \ \ \textcolor{comment}{//\ Likelihood\ between\ the\ fluctuated\ drawn\ histogram\ and\ the\ data}}
\DoxyCodeLine{01392\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ DataDrawFlucLLH\ =\ \mbox{\hyperlink{classSampleSummary_ad027b0716b707691e6a9565ee497b66f}{GetLLH}}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[SampleNum],\ FluctDrawHist[SampleNum],\ DrawW2Hist);}
\DoxyCodeLine{01393\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a5c46fc1f6e0ab29dcadcde3152b0d275}{llh\_data\_drawfluc}}[SampleNum]\ +=\ DataDrawFlucLLH;}
\DoxyCodeLine{01394\ \ \ \ \ \ \ total\_llh\_data\_drawfluc\_temp\ +=\ DataDrawFlucLLH;}
\DoxyCodeLine{01395\ }
\DoxyCodeLine{01396\ \ \ \ \ \ \ \textcolor{comment}{//\ Likelihood\ between\ the\ drawn\ histogram\ and\ the\ data}}
\DoxyCodeLine{01397\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ DataPredFlucLLH\ =\ \mbox{\hyperlink{classSampleSummary_ad027b0716b707691e6a9565ee497b66f}{GetLLH}}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[SampleNum],\ FluctHist[SampleNum],\ \mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2MeanHist}}[SampleNum]);}
\DoxyCodeLine{01398\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a07d4cc27e2299f3beefe0b3e78da493a}{llh\_data\_predfluc}}[SampleNum]\ +=\ DataPredFlucLLH;}
\DoxyCodeLine{01399\ \ \ \ \ \ \ total\_llh\_data\_predfluc\_temp\ +=\ DataPredFlucLLH;}
\DoxyCodeLine{01400\ }
\DoxyCodeLine{01401\ \ \ \ \ \ \ \textcolor{comment}{//\ Likelihood\ between\ the\ drawn\ hist\ and\ the\ Posterior\ Predictive}}
\DoxyCodeLine{01402\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ DrawPredLLH\ =\ \mbox{\hyperlink{classSampleSummary_ad027b0716b707691e6a9565ee497b66f}{GetLLH}}(DrawHist,\ \mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[SampleNum],\ \mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2MeanHist}}[SampleNum]);}
\DoxyCodeLine{01403\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a1a154b17f6f4ab15eec03f3dcfc91e5f}{llh\_draw\_pred}}[SampleNum]\ +=\ DrawPredLLH;}
\DoxyCodeLine{01404\ \ \ \ \ \ \ total\_llh\_draw\_pred\_temp\ +=\ DrawPredLLH;}
\DoxyCodeLine{01405\ }
\DoxyCodeLine{01406\ \ \ \ \ \ \ \textcolor{comment}{//\ Likelihood\ between\ fluctuated\ drawn\ and\ predictive}}
\DoxyCodeLine{01407\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ DrawFlucPredLLH\ =\ \mbox{\hyperlink{classSampleSummary_ad027b0716b707691e6a9565ee497b66f}{GetLLH}}(FluctDrawHist[SampleNum],\ \mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[SampleNum],\ \mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2MeanHist}}[SampleNum]);}
\DoxyCodeLine{01408\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_adb0f7be738ba901c4a6c1253dc8b2b03}{llh\_drawfluc\_pred}}[SampleNum]\ \ +=\ DrawFlucPredLLH;}
\DoxyCodeLine{01409\ \ \ \ \ \ \ total\_llh\_drawfluc\_pred\_temp\ \ +=\ DrawFlucPredLLH;}
\DoxyCodeLine{01410\ }
\DoxyCodeLine{01411\ \ \ \ \ \ \ \textcolor{comment}{//\ Likelihood\ between\ drawn\ histogram\ and\ fluctuated\ drawn\ histogram}}
\DoxyCodeLine{01412\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ DrawFlucPredFlucLLH\ =\ \mbox{\hyperlink{classSampleSummary_ad027b0716b707691e6a9565ee497b66f}{GetLLH}}(FluctDrawHist[SampleNum],\ FluctHist[SampleNum],\ \mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2MeanHist}}[SampleNum]);}
\DoxyCodeLine{01413\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a5fb4519a15437b229f37fb171e578ab0}{llh\_drawfluc\_predfluc}}[SampleNum]\ +=\ DrawFlucPredFlucLLH;}
\DoxyCodeLine{01414\ \ \ \ \ \ \ total\_llh\_drawfluc\_predfluc\_temp\ +=\ DrawFlucPredFlucLLH;}
\DoxyCodeLine{01415\ }
\DoxyCodeLine{01416\ \ \ \ \ \ \ \textcolor{comment}{//\ Likelihood\ between\ the\ fluctuated\ drawn\ histogram\ and\ the\ posterior\ predictive}}
\DoxyCodeLine{01417\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ PredFlucPredLLH\ =\ \mbox{\hyperlink{classSampleSummary_ad027b0716b707691e6a9565ee497b66f}{GetLLH}}(FluctHist[SampleNum],\ \mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[SampleNum],\ \mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2MeanHist}}[SampleNum]);}
\DoxyCodeLine{01418\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a5160d49065adca11bec43baaab283b70}{llh\_predfluc\_pred}}[SampleNum]\ +=\ PredFlucPredLLH;}
\DoxyCodeLine{01419\ \ \ \ \ \ \ total\_llh\_predfluc\_pred\_temp\ +=\ PredFlucPredLLH;}
\DoxyCodeLine{01420\ }
\DoxyCodeLine{01421\ \ \ \ \ \ \ \textcolor{comment}{//\ Likelihood\ between\ fluctuated\ data\ histogram\ and\ drawn\ histogram\ }}
\DoxyCodeLine{01422\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ DataFlucDrawLLH\ =\ \mbox{\hyperlink{classSampleSummary_ad027b0716b707691e6a9565ee497b66f}{GetLLH}}(DataFlucHist[SampleNum],\ DrawHist,\ DrawW2Hist);}
\DoxyCodeLine{01423\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a85f8c5e630bc333137a403401097785d}{llh\_datafluc\_draw}}[SampleNum]\ +=\ DataFlucDrawLLH;}
\DoxyCodeLine{01424\ \ \ \ \ \ \ total\_llh\_datafluc\_draw\_temp\ +=\ DataFlucDrawLLH;}
\DoxyCodeLine{01425\ }
\DoxyCodeLine{01426\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a08c14eaf908f0fd1bc8bd95b0886c99e}{lnLHist\_Sample\_DrawData}}[SampleNum]-\/>Fill(DataDrawLLH);}
\DoxyCodeLine{01427\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a0e32c2a76de59e4142036b1c5a234819}{lnLHist\_Sample\_DrawflucDraw}}[SampleNum]-\/>Fill(DrawFlucDrawLLH);}
\DoxyCodeLine{01428\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a59de41ffd933765d2e22ffd8aa198ac1}{lnLHist\_Sample\_PredflucDraw}}[SampleNum]-\/>Fill(PredFlucDrawLLH);}
\DoxyCodeLine{01429\ \ \ \ \ \ \ }
\DoxyCodeLine{01430\ \textcolor{comment}{//\ \ \ \ At\ the\ end\ we\ leave\ LLH\ for\ 1D\ projections}}
\DoxyCodeLine{01431\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_ada2f0b7b9b7bb687e67023e84151610e}{MakeFluctuatedHistogram}}(FluctDrawHistProjectX[SampleNum],\ DrawHistProjectX[SampleNum]);}
\DoxyCodeLine{01432\ \ \ \ \ \ \ }
\DoxyCodeLine{01433\ \ \ \ \ \ \ \textcolor{comment}{//\ Likelihood\ between\ the\ drawn\ histogram\ and\ the\ data\ for\ muon\ momentum}}
\DoxyCodeLine{01434\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ DataDrawLLH\_ProjectX\ =\ \mbox{\hyperlink{classSampleSummary_ad027b0716b707691e6a9565ee497b66f}{GetLLH}}(\mbox{\hyperlink{classSampleSummary_aed3d754bfa3b870ba2676748d1420b5f}{DataHist\_ProjectX}}[SampleNum],\ DrawHistProjectX[SampleNum],\ DrawW2HistProjectX[SampleNum]);}
\DoxyCodeLine{01435\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a77250cd6138be6d5220f2ac6c7ebd2ea}{llh\_data\_draw\_ProjectX}}[SampleNum]\ +=\ DataDrawLLH\_ProjectX;}
\DoxyCodeLine{01436\ \ \ \ \ \ \ total\_llh\_data\_draw\_ProjectX\_temp\ +=\ DataDrawLLH\_ProjectX;}
\DoxyCodeLine{01437\ \ \ \ \ \ \ }
\DoxyCodeLine{01438\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ DrawFlucDrawLLH\_ProjectX\ =\ \mbox{\hyperlink{classSampleSummary_ad027b0716b707691e6a9565ee497b66f}{GetLLH}}(FluctDrawHistProjectX[SampleNum],\ DrawHistProjectX[SampleNum],\ DrawW2HistProjectX[SampleNum]);}
\DoxyCodeLine{01439\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a6a171e9c3a2f71785b777d1d64a78dfa}{llh\_drawfluc\_draw\_ProjectX}}[SampleNum]\ +=\ DrawFlucDrawLLH\_ProjectX;}
\DoxyCodeLine{01440\ \ \ \ \ \ \ total\_llh\_drawfluc\_draw\_ProjectX\_temp\ +=\ DrawFlucDrawLLH\_ProjectX;}
\DoxyCodeLine{01441\ \ \ \ \ \ \ }
\DoxyCodeLine{01442\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ This\ might\ seem\ complicated\ but\ we\ make\ X\ and\ Y\ projection\ for\ each\ sample.\ Then\ we\ add\ this\ to\ the\ Violin\ plot\ making\ nice\ Gaussian\ in\ each\ kineatmical\ bin\ of\ x\ and\ y\ axis}}
\DoxyCodeLine{01443\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a90fbcfacacf629b0b5f0de3fdab3fdfd}{FastViolinFill}}(\mbox{\hyperlink{classSampleSummary_a7176dc4fd5368e01f00d5fcc909ee605}{ViolinHists\_ProjectX}}[SampleNum],\ DrawHistProjectX[SampleNum]);}
\DoxyCodeLine{01444\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a90fbcfacacf629b0b5f0de3fdab3fdfd}{FastViolinFill}}(\mbox{\hyperlink{classSampleSummary_af4447b09538a0138de4e11c81169f821}{ViolinHists\_ProjectY}}[SampleNum],\ DrawHistProjectY[SampleNum]);}
\DoxyCodeLine{01445\ \ \ \ \ \}\ \textcolor{comment}{//\ End\ loop\ over\ samples\ (still\ looping\ throws)}}
\DoxyCodeLine{01446\ }
\DoxyCodeLine{01447\ \ \ \ \ \textcolor{comment}{//\ Delete\ the\ temporary\ histograms}}
\DoxyCodeLine{01448\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ SampleNum\ =\ 0;\ \ SampleNum\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++SampleNum)}
\DoxyCodeLine{01449\ \ \ \ \ \{}
\DoxyCodeLine{01450\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ FluctHist[SampleNum];}
\DoxyCodeLine{01451\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ FluctDrawHist[SampleNum];}
\DoxyCodeLine{01452\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ DataFlucHist[SampleNum];}
\DoxyCodeLine{01453\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ FluctDrawHistProjectX[SampleNum];}
\DoxyCodeLine{01454\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ DrawHistProjectX[SampleNum];}
\DoxyCodeLine{01455\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ DrawHistProjectY[SampleNum];}
\DoxyCodeLine{01456\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ DrawW2HistProjectX[SampleNum];}
\DoxyCodeLine{01457\ \ \ \ \ \}}
\DoxyCodeLine{01458\ \ \ \ \ \textcolor{keyword}{delete}[]\ FluctHist;}
\DoxyCodeLine{01459\ \ \ \ \ \textcolor{keyword}{delete}[]\ FluctDrawHist;}
\DoxyCodeLine{01460\ \ \ \ \ \textcolor{keyword}{delete}[]\ DataFlucHist;}
\DoxyCodeLine{01461\ \ \ \ \ \textcolor{keyword}{delete}[]\ FluctDrawHistProjectX;}
\DoxyCodeLine{01462\ \ \ \ \ \textcolor{keyword}{delete}[]\ DrawHistProjectX;}
\DoxyCodeLine{01463\ \ \ \ \ \textcolor{keyword}{delete}[]\ DrawHistProjectY;}
\DoxyCodeLine{01464\ \ \ \ \ \textcolor{keyword}{delete}[]\ DrawW2HistProjectX;}
\DoxyCodeLine{01465\ }
\DoxyCodeLine{01466\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a2cb3d8dcbab49b62be3bc2a4a7e4d5f3}{total\_llh\_data\_draw}}\ =\ total\_llh\_data\_draw\_temp;}
\DoxyCodeLine{01467\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a7e418146cce2c4201c3aa7e1eaad4a38}{total\_llh\_drawfluc\_draw}}\ =\ total\_llh\_drawfluc\_draw\_temp;}
\DoxyCodeLine{01468\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a804a117990fd1441c9e3a9d8e8d32e98}{total\_llh\_predfluc\_draw}}\ =\ total\_llh\_predfluc\_draw\_temp;}
\DoxyCodeLine{01469\ }
\DoxyCodeLine{01470\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_aaf055562efe3e5f2592942f5151ece22}{total\_llh\_rate\_data\_draw}}\ =\ total\_llh\_rate\_data\_draw\_temp;}
\DoxyCodeLine{01471\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a2ebe701d114669fdfcf61e1680bb144d}{total\_llh\_rate\_predfluc\_draw}}\ =\ total\_llh\_rate\_predfluc\_draw\_temp;}
\DoxyCodeLine{01472\ }
\DoxyCodeLine{01473\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a670c890357fd77997279c83c197f989c}{total\_llh\_data\_drawfluc}}\ =\ total\_llh\_data\_drawfluc\_temp;}
\DoxyCodeLine{01474\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_aeee48af77dc4e0beee5eab13c30f3d38}{total\_llh\_data\_predfluc}}\ =\ total\_llh\_data\_predfluc\_temp;}
\DoxyCodeLine{01475\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a58efe34df7c43fb40d211036e30a1b5d}{total\_llh\_draw\_pred}}\ =\ total\_llh\_draw\_pred\_temp;}
\DoxyCodeLine{01476\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a9c8b444ac7f80a5af63d5b9f4a150b79}{total\_llh\_drawfluc\_pred}}\ =\ total\_llh\_drawfluc\_pred\_temp;}
\DoxyCodeLine{01477\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_af92a42a666e1bfcb2dc761ffa2253b7e}{total\_llh\_drawfluc\_predfluc}}\ =\ total\_llh\_drawfluc\_predfluc\_temp;}
\DoxyCodeLine{01478\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a1f6c2e7ed8f9024cf928da5b56054e07}{total\_llh\_predfluc\_pred}}\ =\ total\_llh\_predfluc\_pred\_temp;}
\DoxyCodeLine{01479\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_af9e5d89095e6c6a81aedb5ea2402e3fb}{total\_llh\_datafluc\_draw}}\ =\ total\_llh\_datafluc\_draw\_temp;}
\DoxyCodeLine{01480\ }
\DoxyCodeLine{01481\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a5a973692db89f52c19c9195ffe95c9a1}{total\_llh\_data\_draw\_ProjectX}}\ =\ total\_llh\_data\_draw\_ProjectX\_temp;}
\DoxyCodeLine{01482\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a22df11667306c7892f9ed3f8935a5c9e}{total\_llh\_drawfluc\_draw\_ProjectX}}\ =\ total\_llh\_drawfluc\_draw\_ProjectX\_temp;}
\DoxyCodeLine{01483\ }
\DoxyCodeLine{01484\ \ \ \ \ \textcolor{comment}{//\ Add\ LLH\ penalties\ from\ the\ systematics\ to\ the\ LLH\ that\ use\ the\ drawn\ histogram}}
\DoxyCodeLine{01485\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a2cb3d8dcbab49b62be3bc2a4a7e4d5f3}{total\_llh\_data\_draw}}\ \ \ \ \ +=\ \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}};}
\DoxyCodeLine{01486\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a7e418146cce2c4201c3aa7e1eaad4a38}{total\_llh\_drawfluc\_draw}}\ +=\ \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}};}
\DoxyCodeLine{01487\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a804a117990fd1441c9e3a9d8e8d32e98}{total\_llh\_predfluc\_draw}}\ +=\ \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}};}
\DoxyCodeLine{01488\ \ \ \ \ \textcolor{comment}{//Rate\ based}}
\DoxyCodeLine{01489\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_aaf055562efe3e5f2592942f5151ece22}{total\_llh\_rate\_data\_draw}}\ +=\ \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}};}
\DoxyCodeLine{01490\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a2ebe701d114669fdfcf61e1680bb144d}{total\_llh\_rate\_predfluc\_draw}}\ +=\ \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}};}
\DoxyCodeLine{01491\ }
\DoxyCodeLine{01492\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a670c890357fd77997279c83c197f989c}{total\_llh\_data\_drawfluc}}\ +=\ \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}};}
\DoxyCodeLine{01493\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a58efe34df7c43fb40d211036e30a1b5d}{total\_llh\_draw\_pred}}\ \ \ \ \ +=\ \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}};}
\DoxyCodeLine{01494\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a9c8b444ac7f80a5af63d5b9f4a150b79}{total\_llh\_drawfluc\_pred}}\ +=\ \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}};}
\DoxyCodeLine{01495\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_af92a42a666e1bfcb2dc761ffa2253b7e}{total\_llh\_drawfluc\_predfluc}}\ +=\ \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}};}
\DoxyCodeLine{01496\ }
\DoxyCodeLine{01497\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a5a973692db89f52c19c9195ffe95c9a1}{total\_llh\_data\_draw\_ProjectX}}\ +=\ \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}};}
\DoxyCodeLine{01498\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a22df11667306c7892f9ed3f8935a5c9e}{total\_llh\_drawfluc\_draw\_ProjectX}}\ +=\ \mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}};}
\DoxyCodeLine{01499\ }
\DoxyCodeLine{01500\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a086c2804cf7c1af54784d856c4351de8}{lnLHist}}-\/>Fill(\mbox{\hyperlink{classSampleSummary_a1f6c2e7ed8f9024cf928da5b56054e07}{total\_llh\_predfluc\_pred}});}
\DoxyCodeLine{01501\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_af4240300eba39917dee195fd2b37c5d9}{lnLHist\_drawdata}}-\/>Fill(\mbox{\hyperlink{classSampleSummary_a2cb3d8dcbab49b62be3bc2a4a7e4d5f3}{total\_llh\_data\_draw}});}
\DoxyCodeLine{01502\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a77da9dc0abfc381a526e3ceac9453f80}{lnLHist\_drawfluc}}-\/>Fill(\mbox{\hyperlink{classSampleSummary_a804a117990fd1441c9e3a9d8e8d32e98}{total\_llh\_predfluc\_draw}});}
\DoxyCodeLine{01503\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a6c8b2e34255d1c109b5172ddcf5e9fcd}{lnLHist\_drawflucdraw}}-\/>Fill(\mbox{\hyperlink{classSampleSummary_a7e418146cce2c4201c3aa7e1eaad4a38}{total\_llh\_drawfluc\_draw}});}
\DoxyCodeLine{01504\ }
\DoxyCodeLine{01505\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a653e0d84096e0acdb3e392c2a68077e9}{lnLDrawHist}}-\/>Fill(\mbox{\hyperlink{classSampleSummary_a804a117990fd1441c9e3a9d8e8d32e98}{total\_llh\_predfluc\_draw}},\ \mbox{\hyperlink{classSampleSummary_a2cb3d8dcbab49b62be3bc2a4a7e4d5f3}{total\_llh\_data\_draw}});}
\DoxyCodeLine{01506\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a6f7c55987330d006555b44010e54d8b0}{lnLFlucHist}}-\/>Fill(\mbox{\hyperlink{classSampleSummary_a7e418146cce2c4201c3aa7e1eaad4a38}{total\_llh\_drawfluc\_draw}},\ \mbox{\hyperlink{classSampleSummary_a2cb3d8dcbab49b62be3bc2a4a7e4d5f3}{total\_llh\_data\_draw}});}
\DoxyCodeLine{01507\ }
\DoxyCodeLine{01508\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a7cee72732c2a3e242e5ed723e4b206c9}{lnLDrawHistRate}}-\/>Fill(\mbox{\hyperlink{classSampleSummary_a2ebe701d114669fdfcf61e1680bb144d}{total\_llh\_rate\_predfluc\_draw}},\ \mbox{\hyperlink{classSampleSummary_aaf055562efe3e5f2592942f5151ece22}{total\_llh\_rate\_data\_draw}});}
\DoxyCodeLine{01509\ }
\DoxyCodeLine{01510\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a40f5c789dbf8ad9c8a4af401343af474}{lnLFlucHist\_ProjectX}}-\/>Fill(\mbox{\hyperlink{classSampleSummary_a22df11667306c7892f9ed3f8935a5c9e}{total\_llh\_drawfluc\_draw\_ProjectX}},\ \mbox{\hyperlink{classSampleSummary_a5a973692db89f52c19c9195ffe95c9a1}{total\_llh\_data\_draw\_ProjectX}});}
\DoxyCodeLine{01511\ \ \ \ \ }
\DoxyCodeLine{01512\ \ \ \ \ \textcolor{comment}{//\ Also\ save\ to\ arrays\ to\ make\ sure\ we\ have\ the\ utmost\ super\ accuracy}}
\DoxyCodeLine{01513\ \ \ \ \ LLH\_PredFluc\_V[i]\ =\ \mbox{\hyperlink{classSampleSummary_a804a117990fd1441c9e3a9d8e8d32e98}{total\_llh\_predfluc\_draw}};}
\DoxyCodeLine{01514\ \ \ \ \ LLH\_DataDraw\_V[i]\ =\ \mbox{\hyperlink{classSampleSummary_a2cb3d8dcbab49b62be3bc2a4a7e4d5f3}{total\_llh\_data\_draw}};}
\DoxyCodeLine{01515\ \ \ \ \ LLH\_DrawFlucDraw\_V[i]\ =\ \mbox{\hyperlink{classSampleSummary_a7e418146cce2c4201c3aa7e1eaad4a38}{total\_llh\_drawfluc\_draw}};}
\DoxyCodeLine{01516\ }
\DoxyCodeLine{01517\ \ \ \ \ \textcolor{comment}{//\ Write\ to\ the\ output\ tree}}
\DoxyCodeLine{01518\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Fill();}
\DoxyCodeLine{01519\ \ \ \}\ \textcolor{comment}{//\ End\ loop\ over\ throws}}
\DoxyCodeLine{01520\ }
\DoxyCodeLine{01521\ \ \ AveragePenalty\ =\ AveragePenalty/double(\mbox{\hyperlink{classSampleSummary_aa5c4055d4bb4dc720a4118032cdb4910}{nThrows}});}
\DoxyCodeLine{01522\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Average\ LLH\ penalty\ over\ toys\ is\ \{:.2f\}"{}},\ AveragePenalty);}
\DoxyCodeLine{01523\ \ \ \textcolor{comment}{//\ Calculate\ exact\ p-\/value\ instead\ of\ binned}}
\DoxyCodeLine{01524\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ Accept\_PredFluc\ =\ 0;}
\DoxyCodeLine{01525\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ Accept\_DrawFluc\ =\ 0;}
\DoxyCodeLine{01526\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_aa5c4055d4bb4dc720a4118032cdb4910}{nThrows}};\ ++i)}
\DoxyCodeLine{01527\ \ \ \{}
\DoxyCodeLine{01528\ \ \ \ \ \textcolor{keywordflow}{if}\ (LLH\_DataDraw\_V[i]\ >\ LLH\_DrawFlucDraw\_V[i])\ Accept\_DrawFluc++;}
\DoxyCodeLine{01529\ \ \ \ \ \textcolor{keywordflow}{if}\ (LLH\_DataDraw\_V[i]\ >\ LLH\_PredFluc\_V[i])\ Accept\_PredFluc++;}
\DoxyCodeLine{01530\ \ \ \}}
\DoxyCodeLine{01531\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ pvalue\_DrawFluc\ =\ double(Accept\_DrawFluc)/double(\mbox{\hyperlink{classSampleSummary_aa5c4055d4bb4dc720a4118032cdb4910}{nThrows}});}
\DoxyCodeLine{01532\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ pvalue\_PredFluc\ =\ double(Accept\_PredFluc)/double(\mbox{\hyperlink{classSampleSummary_aa5c4055d4bb4dc720a4118032cdb4910}{nThrows}});}
\DoxyCodeLine{01533\ }
\DoxyCodeLine{01534\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Calculated\ exact\ p-\/value\ using\ Fluctuation\ of\ Draw:\ \{:.2f\}"{}},\ pvalue\_DrawFluc);}
\DoxyCodeLine{01535\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Calculated\ exact\ p-\/value\ using\ Fluctuation\ of\ Prediction:\ \{:.2f\}"{}},\ pvalue\_PredFluc);}
\DoxyCodeLine{01536\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_a0e21a2b9fd429261e378f4e505ba2f75}\label{classSampleSummary_a0e21a2b9fd429261e378f4e505ba2f75}} 
\index{SampleSummary@{SampleSummary}!MakeCutEventRate@{MakeCutEventRate}}
\index{MakeCutEventRate@{MakeCutEventRate}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{MakeCutEventRate()}{MakeCutEventRate()}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Make\+Cut\+Event\+Rate (\begin{DoxyParamCaption}\item[{TH1D $\ast$}]{Histogram,  }\item[{const double}]{Data\+Rate }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Make the 1D Event Rate Hist. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l01678}{1678}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01678\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01679\ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{01680\ \ \ \textcolor{comment}{//\ For\ the\ event\ rate\ histogram\ add\ a\ TLine\ to\ the\ data\ rate}}
\DoxyCodeLine{01681\ \ \ TLine\ *TempLine\ =\ \textcolor{keyword}{new}\ TLine(DataRate,\ Histogram-\/>GetMinimum(),\ DataRate,\ Histogram-\/>GetMaximum());}
\DoxyCodeLine{01682\ \ \ TempLine-\/>SetLineColor(kRed);}
\DoxyCodeLine{01683\ \ \ TempLine-\/>SetLineWidth(2);}
\DoxyCodeLine{01684\ \ \ \textcolor{comment}{//\ Also\ fit\ a\ Gaussian\ because\ why\ not?}}
\DoxyCodeLine{01685\ \ \ TF1\ *Fitter\ =\ \textcolor{keyword}{new}\ TF1(\textcolor{stringliteral}{"{}Fit"{}},\ \textcolor{stringliteral}{"{}gaus"{}},\ Histogram-\/>GetBinLowEdge(1),\ Histogram-\/>GetBinLowEdge(Histogram-\/>GetNbinsX()+1));}
\DoxyCodeLine{01686\ \ \ Histogram-\/>Fit(Fitter,\ \textcolor{stringliteral}{"{}RQ"{}});}
\DoxyCodeLine{01687\ \ \ Fitter-\/>SetLineColor(kRed-\/5);}
\DoxyCodeLine{01688\ \ \ \textcolor{comment}{//\ Calculate\ a\ p-\/value}}
\DoxyCodeLine{01689\ \ \ \textcolor{keywordtype}{double}\ Above\ =\ 0.0;}
\DoxyCodeLine{01690\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ z\ =\ 0;\ z\ <\ Histogram-\/>GetNbinsX();\ ++z)\ \{}
\DoxyCodeLine{01691\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ xvalue\ =\ Histogram-\/>GetBinCenter(z+1);}
\DoxyCodeLine{01692\ \ \ \ \ \textcolor{keywordflow}{if}\ (xvalue\ >=\ DataRate)\ \{}
\DoxyCodeLine{01693\ \ \ \ \ \ \ Above\ +=\ Histogram-\/>GetBinContent(z+1);}
\DoxyCodeLine{01694\ \ \ \ \ \}}
\DoxyCodeLine{01695\ \ \ \}}
\DoxyCodeLine{01696\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ pvalue\ =\ Above/Histogram-\/>Integral();}
\DoxyCodeLine{01697\ \ \ TLegend\ *Legend\ =\ \textcolor{keyword}{new}\ TLegend(0.4,\ 0.75,\ 0.98,\ 0.90);}
\DoxyCodeLine{01698\ \ \ Legend-\/>SetFillColor(0);}
\DoxyCodeLine{01699\ \ \ Legend-\/>SetFillStyle(0);}
\DoxyCodeLine{01700\ \ \ Legend-\/>SetLineWidth(0);}
\DoxyCodeLine{01701\ \ \ Legend-\/>SetLineColor(0);}
\DoxyCodeLine{01702\ \ \ Legend-\/>AddEntry(TempLine,\ Form(\textcolor{stringliteral}{"{}Data,\ \%.0f,\ p-\/value=\%.2f"{}},\ DataRate,\ pvalue),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{01703\ \ \ Legend-\/>AddEntry(Histogram,\ Form(\textcolor{stringliteral}{"{}MC,\ \#mu=\%.1f\#pm\%.1f"{}},\ Histogram-\/>GetMean(),\ Histogram-\/>GetRMS()),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{01704\ \ \ Legend-\/>AddEntry(Fitter,\ Form(\textcolor{stringliteral}{"{}Gauss,\ \#mu=\%.1f\#pm\%.1f"{}},\ Fitter-\/>GetParameter(1),\ Fitter-\/>GetParameter(2)),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{01705\ \ \ std::string\ TempTitle\ =\ std::string(Histogram-\/>GetName());}
\DoxyCodeLine{01706\ \ \ TempTitle\ +=\ \textcolor{stringliteral}{"{}\_canv"{}};}
\DoxyCodeLine{01707\ \ \ TCanvas\ *TempCanvas\ =\ \textcolor{keyword}{new}\ TCanvas(TempTitle.c\_str(),\ TempTitle.c\_str(),\ 1024,\ 1024);}
\DoxyCodeLine{01708\ \ \ TempCanvas-\/>SetGridx();}
\DoxyCodeLine{01709\ \ \ TempCanvas-\/>SetGridy();}
\DoxyCodeLine{01710\ \ \ TempCanvas-\/>SetRightMargin(0.03);}
\DoxyCodeLine{01711\ \ \ TempCanvas-\/>SetBottomMargin(0.08);}
\DoxyCodeLine{01712\ \ \ TempCanvas-\/>SetLeftMargin(0.10);}
\DoxyCodeLine{01713\ \ \ TempCanvas-\/>SetTopMargin(0.06);}
\DoxyCodeLine{01714\ \ \ TempCanvas-\/>cd();}
\DoxyCodeLine{01715\ \ \ Histogram-\/>Draw();}
\DoxyCodeLine{01716\ \ \ TempLine-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{01717\ \ \ Fitter-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{01718\ \ \ Legend-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{01719\ \ \ TempCanvas-\/>Write();}
\DoxyCodeLine{01720\ \ \ Histogram-\/>Write();}
\DoxyCodeLine{01721\ }
\DoxyCodeLine{01722\ \ \ \textcolor{keyword}{delete}\ TempLine;}
\DoxyCodeLine{01723\ \ \ \textcolor{keyword}{delete}\ TempCanvas;}
\DoxyCodeLine{01724\ \ \ \textcolor{keyword}{delete}\ Fitter;}
\DoxyCodeLine{01725\ \ \ \textcolor{keyword}{delete}\ Legend;}
\DoxyCodeLine{01726\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_ab28f4325f8104ab783fa3094a2fbbc44}\label{classSampleSummary_ab28f4325f8104ab783fa3094a2fbbc44}} 
\index{SampleSummary@{SampleSummary}!MakeCutLLH@{MakeCutLLH}}
\index{MakeCutLLH@{MakeCutLLH}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{MakeCutLLH()}{MakeCutLLH()}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Make\+Cut\+LLH (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Make the cut LLH histogram. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l01540}{1540}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01540\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01541\ \textcolor{comment}{//\ *******************}}
\DoxyCodeLine{01542\ \ \ \mbox{\hyperlink{classSampleSummary_aa7b948f290517a052f04f61dfa6af68f}{Outputfile}}-\/>cd();}
\DoxyCodeLine{01543\ \ \ \mbox{\hyperlink{classSampleSummary_abf964a8fd459fff903faaea17a98f8b1}{MakeCutLLH1D}}(\mbox{\hyperlink{classSampleSummary_a086c2804cf7c1af54784d856c4351de8}{lnLHist}});}
\DoxyCodeLine{01544\ \ \ \mbox{\hyperlink{classSampleSummary_abf964a8fd459fff903faaea17a98f8b1}{MakeCutLLH1D}}(\mbox{\hyperlink{classSampleSummary_a77da9dc0abfc381a526e3ceac9453f80}{lnLHist\_drawfluc}});}
\DoxyCodeLine{01545\ \ \ \mbox{\hyperlink{classSampleSummary_abf964a8fd459fff903faaea17a98f8b1}{MakeCutLLH1D}}(\mbox{\hyperlink{classSampleSummary_af4240300eba39917dee195fd2b37c5d9}{lnLHist\_drawdata}});}
\DoxyCodeLine{01546\ \ \ \mbox{\hyperlink{classSampleSummary_abf964a8fd459fff903faaea17a98f8b1}{MakeCutLLH1D}}(\mbox{\hyperlink{classSampleSummary_a6c8b2e34255d1c109b5172ddcf5e9fcd}{lnLHist\_drawflucdraw}});}
\DoxyCodeLine{01547\ \ \ }
\DoxyCodeLine{01548\ \ \ \mbox{\hyperlink{classSampleSummary_a24fff19d07a5b11c9c4149a45d0265cd}{MakeCutLLH2D}}(\mbox{\hyperlink{classSampleSummary_a653e0d84096e0acdb3e392c2a68077e9}{lnLDrawHist}});}
\DoxyCodeLine{01549\ \ \ \mbox{\hyperlink{classSampleSummary_a24fff19d07a5b11c9c4149a45d0265cd}{MakeCutLLH2D}}(\mbox{\hyperlink{classSampleSummary_a6f7c55987330d006555b44010e54d8b0}{lnLFlucHist}});}
\DoxyCodeLine{01550\ \ \ \mbox{\hyperlink{classSampleSummary_a24fff19d07a5b11c9c4149a45d0265cd}{MakeCutLLH2D}}(\mbox{\hyperlink{classSampleSummary_a7cee72732c2a3e242e5ed723e4b206c9}{lnLDrawHistRate}});}
\DoxyCodeLine{01551\ \ \ \mbox{\hyperlink{classSampleSummary_a24fff19d07a5b11c9c4149a45d0265cd}{MakeCutLLH2D}}(\mbox{\hyperlink{classSampleSummary_a40f5c789dbf8ad9c8a4af401343af474}{lnLFlucHist\_ProjectX}});}
\DoxyCodeLine{01552\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_abf964a8fd459fff903faaea17a98f8b1}\label{classSampleSummary_abf964a8fd459fff903faaea17a98f8b1}} 
\index{SampleSummary@{SampleSummary}!MakeCutLLH1D@{MakeCutLLH1D}}
\index{MakeCutLLH1D@{MakeCutLLH1D}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{MakeCutLLH1D()}{MakeCutLLH1D()}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Make\+Cut\+LLH1D (\begin{DoxyParamCaption}\item[{TH1D $\ast$}]{Histogram,  }\item[{double}]{llh\+\_\+ref = {\ttfamily -\/999} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l01556}{1556}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01556\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01557\ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{01558\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ TotalIntegral\ =\ Histogram-\/>Integral();}
\DoxyCodeLine{01559\ \ \ \textcolor{keywordtype}{double}\ Above\ =\ 0.0;}
\DoxyCodeLine{01560\ \ \ \textcolor{comment}{//\ Get\ the\ LLH\ reference\ from\ total\ llh\ or\ some\ reference\ histogram}}
\DoxyCodeLine{01561\ \ \ \textcolor{keywordtype}{double}\ llh\_reference\ =\ 0.0;}
\DoxyCodeLine{01562\ \ \ \textcolor{keywordflow}{if}\ (llh\_ref\ >=\ 0)\ \{}
\DoxyCodeLine{01563\ \ \ \ \ llh\_reference\ =\ llh\_ref;}
\DoxyCodeLine{01564\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01565\ \ \ \ \ llh\_reference\ =\ \mbox{\hyperlink{classSampleSummary_aacac73b24f1e8b05d35fabe2322578e8}{llh\_total}};}
\DoxyCodeLine{01566\ \ \ \}}
\DoxyCodeLine{01567\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ Histogram-\/>GetXaxis()-\/>GetNbins();\ ++i)\ \{}
\DoxyCodeLine{01568\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ xvalue\ =\ Histogram-\/>GetBinCenter(i+1);}
\DoxyCodeLine{01569\ \ \ \ \ \textcolor{keywordflow}{if}\ (xvalue\ >=\ llh\_reference)\ \{}
\DoxyCodeLine{01570\ \ \ \ \ \ \ Above\ +=\ Histogram-\/>GetBinContent(i+1);}
\DoxyCodeLine{01571\ \ \ \ \ \}}
\DoxyCodeLine{01572\ \ \ \}}
\DoxyCodeLine{01573\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ pvalue\ =\ Above/TotalIntegral;}
\DoxyCodeLine{01574\ \ \ std::stringstream\ ss;}
\DoxyCodeLine{01575\ \ \ ss\ <<\ int(Above)\ <<\ \textcolor{stringliteral}{"{}/"{}}\ <<\ int(TotalIntegral)\ <<\ \textcolor{stringliteral}{"{}="{}}\ <<\ pvalue;}
\DoxyCodeLine{01576\ \ \ Histogram-\/>SetTitle((std::string(Histogram-\/>GetTitle())+\textcolor{stringliteral}{"{}\_"{}}+ss.str()).c\_str());}
\DoxyCodeLine{01577\ }
\DoxyCodeLine{01578\ \ \ \textcolor{comment}{//\ Write\ a\ TCanvas\ and\ make\ a\ line\ and\ a\ filled\ histogram}}
\DoxyCodeLine{01579\ \ \ TLine\ *TempLine\ =\ \textcolor{keyword}{new}\ TLine(llh\_reference\ ,\ Histogram-\/>GetMinimum(),\ llh\_reference,\ Histogram-\/>GetMaximum());}
\DoxyCodeLine{01580\ \ \ TempLine-\/>SetLineColor(kBlack);}
\DoxyCodeLine{01581\ \ \ TempLine-\/>SetLineWidth(2);}
\DoxyCodeLine{01582\ }
\DoxyCodeLine{01583\ \ \ \textcolor{comment}{//\ Make\ the\ fill\ histogram}}
\DoxyCodeLine{01584\ \ \ TH1D\ *TempHistogram\ =\ \textcolor{keyword}{static\_cast<}TH1D*\textcolor{keyword}{>}(Histogram-\/>Clone());}
\DoxyCodeLine{01585\ \ \ TempHistogram-\/>SetFillStyle(1001);}
\DoxyCodeLine{01586\ \ \ TempHistogram-\/>SetFillColor(kRed);}
\DoxyCodeLine{01587\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ TempHistogram-\/>GetNbinsX();\ ++i)\ }
\DoxyCodeLine{01588\ \ \ \{}
\DoxyCodeLine{01589\ \ \ \ \ \textcolor{keywordflow}{if}\ (TempHistogram-\/>GetBinCenter(i+1)\ <\ llh\_reference)\ }
\DoxyCodeLine{01590\ \ \ \ \ \{}
\DoxyCodeLine{01591\ \ \ \ \ \ \ TempHistogram-\/>SetBinContent(i+1,\ 0.0);}
\DoxyCodeLine{01592\ \ \ \ \ \}}
\DoxyCodeLine{01593\ \ \ \}}
\DoxyCodeLine{01594\ }
\DoxyCodeLine{01595\ \ \ TLegend\ *Legend\ =\ \textcolor{keyword}{new}\ TLegend(0.6,\ 0.6,\ 0.9,\ 0.9);}
\DoxyCodeLine{01596\ \ \ Legend-\/>SetFillColor(0);}
\DoxyCodeLine{01597\ \ \ Legend-\/>SetFillStyle(0);}
\DoxyCodeLine{01598\ \ \ Legend-\/>SetLineWidth(0);}
\DoxyCodeLine{01599\ \ \ Legend-\/>SetLineColor(0);}
\DoxyCodeLine{01600\ \ \ Legend-\/>AddEntry(TempLine,\ Form(\textcolor{stringliteral}{"{}Reference\ LLH,\ \%.0f,\ p-\/value=\%.2f"{}},\ llh\_reference,\ pvalue),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{01601\ \ \ Legend-\/>AddEntry(Histogram,\ Form(\textcolor{stringliteral}{"{}LLH,\ \#mu=\%.1f\#pm\%.1f"{}},\ Histogram-\/>GetMean(),\ Histogram-\/>GetRMS()),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{01602\ \ \ std::string\ Title\ =\ Histogram-\/>GetName();}
\DoxyCodeLine{01603\ \ \ Title\ +=\ \textcolor{stringliteral}{"{}\_canv"{}};}
\DoxyCodeLine{01604\ \ \ TCanvas\ *TempCanvas\ =\ \textcolor{keyword}{new}\ TCanvas(Title.c\_str(),\ Title.c\_str(),\ 1024,\ 1024);}
\DoxyCodeLine{01605\ \ \ TempCanvas-\/>SetGridx();}
\DoxyCodeLine{01606\ \ \ TempCanvas-\/>SetGridy();}
\DoxyCodeLine{01607\ \ \ Histogram-\/>Draw();}
\DoxyCodeLine{01608\ \ \ TempHistogram-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{01609\ \ \ TempLine-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{01610\ \ \ Legend-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{01611\ }
\DoxyCodeLine{01612\ \ \ TempCanvas-\/>Write();}
\DoxyCodeLine{01613\ }
\DoxyCodeLine{01614\ \ \ \textcolor{keyword}{delete}\ TempLine;}
\DoxyCodeLine{01615\ \ \ \textcolor{keyword}{delete}\ TempHistogram;}
\DoxyCodeLine{01616\ \ \ \textcolor{keyword}{delete}\ TempCanvas;}
\DoxyCodeLine{01617\ \ \ \textcolor{keyword}{delete}\ Legend;}
\DoxyCodeLine{01618\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_a24fff19d07a5b11c9c4149a45d0265cd}\label{classSampleSummary_a24fff19d07a5b11c9c4149a45d0265cd}} 
\index{SampleSummary@{SampleSummary}!MakeCutLLH2D@{MakeCutLLH2D}}
\index{MakeCutLLH2D@{MakeCutLLH2D}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{MakeCutLLH2D()}{MakeCutLLH2D()}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Make\+Cut\+LLH2D (\begin{DoxyParamCaption}\item[{TH2D $\ast$}]{Histogram }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Make the 2D cut distribution and give the 2D p-\/value. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l01622}{1622}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01622\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01623\ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{01624\ }
\DoxyCodeLine{01625\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ TotalIntegral\ =\ Histogram-\/>Integral();}
\DoxyCodeLine{01626\ \ \ \textcolor{comment}{//\ Count\ how\ many\ fills\ are\ above\ y=x\ axis}}
\DoxyCodeLine{01627\ \ \ \textcolor{comment}{//\ This\ is\ the\ 2D\ p-\/value}}
\DoxyCodeLine{01628\ \ \ \textcolor{keywordtype}{double}\ Above\ =\ 0.0;}
\DoxyCodeLine{01629\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ Histogram-\/>GetXaxis()-\/>GetNbins();\ ++i)\ \{}
\DoxyCodeLine{01630\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ xvalue\ =\ Histogram-\/>GetXaxis()-\/>GetBinCenter(i+1);}
\DoxyCodeLine{01631\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ Histogram-\/>GetYaxis()-\/>GetNbins();\ ++j)\ \{}
\DoxyCodeLine{01632\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ yvalue\ =\ Histogram-\/>GetYaxis()-\/>GetBinCenter(j+1);}
\DoxyCodeLine{01633\ \ \ \ \ \ \ \textcolor{comment}{//\ We're\ only\ interested\ in\ being\ \_ABOVE\_\ the\ y=x\ axis}}
\DoxyCodeLine{01634\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (xvalue\ >=\ yvalue)\ \{}
\DoxyCodeLine{01635\ \ \ \ \ \ \ \ \ Above\ +=\ Histogram-\/>GetBinContent(i+1,\ j+1);}
\DoxyCodeLine{01636\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01637\ \ \ \ \ \}}
\DoxyCodeLine{01638\ \ \ \}}
\DoxyCodeLine{01639\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ pvalue\ =\ Above/TotalIntegral;}
\DoxyCodeLine{01640\ \ \ std::stringstream\ ss;}
\DoxyCodeLine{01641\ \ \ ss\ <<\ int(Above)\ <<\ \textcolor{stringliteral}{"{}/"{}}\ <<\ int(TotalIntegral)\ <<\ \textcolor{stringliteral}{"{}="{}}\ <<\ pvalue;}
\DoxyCodeLine{01642\ \ \ Histogram-\/>SetTitle((std::string(Histogram-\/>GetTitle())+\textcolor{stringliteral}{"{}\_"{}}+ss.str()).c\_str());}
\DoxyCodeLine{01643\ }
\DoxyCodeLine{01644\ \ \ \textcolor{comment}{//\ Now\ add\ the\ TLine\ going\ diagonally}}
\DoxyCodeLine{01645\ \ \ \textcolor{keywordtype}{double}\ minimum\ =\ Histogram-\/>GetXaxis()-\/>GetBinLowEdge(1);}
\DoxyCodeLine{01646\ \ \ \textcolor{keywordflow}{if}\ (Histogram-\/>GetYaxis()-\/>GetBinLowEdge(1)\ >\ minimum)\ \{}
\DoxyCodeLine{01647\ \ \ \ \ minimum\ =\ Histogram-\/>GetYaxis()-\/>GetBinLowEdge(1);}
\DoxyCodeLine{01648\ \ \ \}}
\DoxyCodeLine{01649\ \ \ \textcolor{keywordtype}{double}\ maximum\ =\ Histogram-\/>GetXaxis()-\/>GetBinLowEdge(Histogram-\/>GetXaxis()-\/>GetNbins());}
\DoxyCodeLine{01650\ \ \ \textcolor{keywordflow}{if}\ (Histogram-\/>GetYaxis()-\/>GetBinLowEdge(Histogram-\/>GetYaxis()-\/>GetNbins())\ <\ maximum)\ \{}
\DoxyCodeLine{01651\ \ \ \ \ maximum\ =\ Histogram-\/>GetYaxis()-\/>GetBinLowEdge(Histogram-\/>GetYaxis()-\/>GetNbins());}
\DoxyCodeLine{01652\ \ \ \ \ \textcolor{comment}{//KS:\ Extend\ by\ bin\ width\ to\ perfectly\ fit\ canvas}}
\DoxyCodeLine{01653\ \ \ \ \ maximum\ +=\ Histogram-\/>GetYaxis()-\/>GetBinWidth(Histogram-\/>GetYaxis()-\/>GetNbins());}
\DoxyCodeLine{01654\ \ \ \}}
\DoxyCodeLine{01655\ \ \ \textcolor{keywordflow}{else}\ maximum\ +=\ Histogram-\/>GetXaxis()-\/>GetBinWidth(Histogram-\/>GetXaxis()-\/>GetNbins());}
\DoxyCodeLine{01656\ \ \ TLine\ *TempLine\ =\ \textcolor{keyword}{new}\ TLine(minimum,\ minimum,\ maximum,\ maximum);}
\DoxyCodeLine{01657\ \ \ TempLine-\/>SetLineColor(kRed);}
\DoxyCodeLine{01658\ \ \ TempLine-\/>SetLineWidth(2);}
\DoxyCodeLine{01659\ }
\DoxyCodeLine{01660\ \ \ std::string\ Title\ =\ Histogram-\/>GetName();}
\DoxyCodeLine{01661\ \ \ Title\ +=\ \textcolor{stringliteral}{"{}\_canv"{}};}
\DoxyCodeLine{01662\ \ \ TCanvas\ *TempCanvas\ =\ \textcolor{keyword}{new}\ TCanvas(Title.c\_str(),\ Title.c\_str(),\ 1024,\ 1024);}
\DoxyCodeLine{01663\ \ \ TempCanvas-\/>SetGridx();}
\DoxyCodeLine{01664\ \ \ TempCanvas-\/>SetGridy();}
\DoxyCodeLine{01665\ \ \ TempCanvas-\/>cd();}
\DoxyCodeLine{01666\ \ \ gStyle-\/>SetPalette(81);}
\DoxyCodeLine{01667\ \ \ Histogram-\/>SetMinimum(-\/0.01);}
\DoxyCodeLine{01668\ \ \ Histogram-\/>Draw(\textcolor{stringliteral}{"{}colz"{}});}
\DoxyCodeLine{01669\ \ \ TempLine-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{01670\ }
\DoxyCodeLine{01671\ \ \ TempCanvas-\/>Write();}
\DoxyCodeLine{01672\ \ \ \textcolor{keyword}{delete}\ TempLine;}
\DoxyCodeLine{01673\ \ \ \textcolor{keyword}{delete}\ TempCanvas;}
\DoxyCodeLine{01674\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_ada2f0b7b9b7bb687e67023e84151610e}\label{classSampleSummary_ada2f0b7b9b7bb687e67023e84151610e}} 
\index{SampleSummary@{SampleSummary}!MakeFluctuatedHistogram@{MakeFluctuatedHistogram}}
\index{MakeFluctuatedHistogram@{MakeFluctuatedHistogram}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{MakeFluctuatedHistogram()}{MakeFluctuatedHistogram()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Make\+Fluctuated\+Histogram (\begin{DoxyParamCaption}\item[{TH1D $\ast$}]{Fluct\+Hist,  }\item[{TH1D $\ast$}]{Poly\+Hist }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Make Poisson fluctuation of TH1D hist. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l02436}{2436}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02436\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02437\ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{02438\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_ae502645ddf5c53a7a3f2c52566956bf3}{StandardFluctuation}})\ \mbox{\hyperlink{classSampleSummary_a8ac933c68cff9451eaf1cde713f2eedc}{MakeFluctuatedHistogramStandard}}(FluctHist,\ PolyHist);}
\DoxyCodeLine{02439\ \ \ \textcolor{keywordflow}{else}\ \mbox{\hyperlink{classSampleSummary_af7cda55ff5d54f442f39181f8478bd7f}{MakeFluctuatedHistogramAlternative}}(FluctHist,\ PolyHist);}
\DoxyCodeLine{02440\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_af05fa75a97eeb8890d7bc2d2204761f5}\label{classSampleSummary_af05fa75a97eeb8890d7bc2d2204761f5}} 
\index{SampleSummary@{SampleSummary}!MakeFluctuatedHistogram@{MakeFluctuatedHistogram}}
\index{MakeFluctuatedHistogram@{MakeFluctuatedHistogram}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{MakeFluctuatedHistogram()}{MakeFluctuatedHistogram()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Make\+Fluctuated\+Histogram (\begin{DoxyParamCaption}\item[{TH2\+Poly $\ast$}]{Fluct\+Hist,  }\item[{TH2\+Poly $\ast$}]{Poly\+Hist }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Make Poisson fluctuation of TH2\+Poly hist. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l02444}{2444}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02444\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02445\ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{02446\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_ae502645ddf5c53a7a3f2c52566956bf3}{StandardFluctuation}})\ \mbox{\hyperlink{classSampleSummary_a8ac933c68cff9451eaf1cde713f2eedc}{MakeFluctuatedHistogramStandard}}(FluctHist,\ PolyHist);}
\DoxyCodeLine{02447\ \ \ \textcolor{keywordflow}{else}\ \mbox{\hyperlink{classSampleSummary_af7cda55ff5d54f442f39181f8478bd7f}{MakeFluctuatedHistogramAlternative}}(FluctHist,\ PolyHist);}
\DoxyCodeLine{02448\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_af7cda55ff5d54f442f39181f8478bd7f}\label{classSampleSummary_af7cda55ff5d54f442f39181f8478bd7f}} 
\index{SampleSummary@{SampleSummary}!MakeFluctuatedHistogramAlternative@{MakeFluctuatedHistogramAlternative}}
\index{MakeFluctuatedHistogramAlternative@{MakeFluctuatedHistogramAlternative}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{MakeFluctuatedHistogramAlternative()}{MakeFluctuatedHistogramAlternative()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Make\+Fluctuated\+Histogram\+Alternative (\begin{DoxyParamCaption}\item[{TH1D $\ast$}]{Fluct\+Hist,  }\item[{TH1D $\ast$}]{Poly\+Hist }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Make Poisson fluctuation of TH1D hist using slow method which is only for cross-\/check. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l02490}{2490}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02490\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02491\ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{02492\ \ \ \textcolor{comment}{//\ Make\ the\ Poisson\ fluctuated\ hist}}
\DoxyCodeLine{02493\ \ \ FluctHist-\/>Reset(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{02494\ \ \ FluctHist-\/>Fill(0.0,\ 0.0);}
\DoxyCodeLine{02495\ }
\DoxyCodeLine{02496\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ evrate\ =\ PolyHist-\/>Integral();}
\DoxyCodeLine{02497\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ num\ =\ \mbox{\hyperlink{classSampleSummary_a8322552ef396f34af5ee4bd47a44e39e}{rnd}}-\/>PoissonD(evrate);}
\DoxyCodeLine{02498\ \ \ \textcolor{keywordtype}{int}\ count\ =\ 0;}
\DoxyCodeLine{02499\ \ \ \textcolor{keywordflow}{while}(count\ <\ num)}
\DoxyCodeLine{02500\ \ \ \{}
\DoxyCodeLine{02501\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ candidate\ =\ PolyHist-\/>GetRandom();}
\DoxyCodeLine{02502\ \ \ \ \ FluctHist-\/>Fill(candidate);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{02503\ \ \ \ \ count++;}
\DoxyCodeLine{02504\ \ \ \}}
\DoxyCodeLine{02505\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_a1efcadb382307fc99ce01170401ffbaf}\label{classSampleSummary_a1efcadb382307fc99ce01170401ffbaf}} 
\index{SampleSummary@{SampleSummary}!MakeFluctuatedHistogramAlternative@{MakeFluctuatedHistogramAlternative}}
\index{MakeFluctuatedHistogramAlternative@{MakeFluctuatedHistogramAlternative}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{MakeFluctuatedHistogramAlternative()}{MakeFluctuatedHistogramAlternative()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Make\+Fluctuated\+Histogram\+Alternative (\begin{DoxyParamCaption}\item[{TH2\+Poly $\ast$}]{Fluct\+Hist,  }\item[{TH2\+Poly $\ast$}]{Poly\+Hist }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Make Poisson fluctuation of TH2\+Poly hist using slow method which is only for cross-\/check. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l02509}{2509}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02509\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02510\ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{02511\ \ \ \textcolor{comment}{//\ Make\ the\ Poisson\ fluctuated\ hist}}
\DoxyCodeLine{02512\ \ \ FluctHist-\/>Reset(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{02513\ \ \ FluctHist-\/>Fill(0.0,\ 0.0,\ 0.0);}
\DoxyCodeLine{02514\ }
\DoxyCodeLine{02515\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ evrate\ =\ \mbox{\hyperlink{Structs_8cpp_ab18c6b2408d7b9021bad06d47a06ee8d}{NoOverflowIntegral}}(PolyHist);}
\DoxyCodeLine{02516\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ num\ =\ \mbox{\hyperlink{classSampleSummary_a8322552ef396f34af5ee4bd47a44e39e}{rnd}}-\/>PoissonD(evrate);}
\DoxyCodeLine{02517\ \ \ \textcolor{keywordtype}{int}\ count\ =\ 0;}
\DoxyCodeLine{02518\ \ \ \textcolor{keywordflow}{while}(count\ <\ num)}
\DoxyCodeLine{02519\ \ \ \{}
\DoxyCodeLine{02520\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ iBin\ =\ \mbox{\hyperlink{classSampleSummary_a938ba96c39db535ede194bfe9f15d626}{GetRandomPoly2}}(PolyHist);}
\DoxyCodeLine{02521\ \ \ \ \ FluctHist-\/>SetBinContent(iBin,\ FluctHist-\/>GetBinContent(iBin)\ +\ 1);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{02522\ \ \ \ \ count++;}
\DoxyCodeLine{02523\ \ \ \}}
\DoxyCodeLine{02524\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_a8ac933c68cff9451eaf1cde713f2eedc}\label{classSampleSummary_a8ac933c68cff9451eaf1cde713f2eedc}} 
\index{SampleSummary@{SampleSummary}!MakeFluctuatedHistogramStandard@{MakeFluctuatedHistogramStandard}}
\index{MakeFluctuatedHistogramStandard@{MakeFluctuatedHistogramStandard}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{MakeFluctuatedHistogramStandard()}{MakeFluctuatedHistogramStandard()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Make\+Fluctuated\+Histogram\+Standard (\begin{DoxyParamCaption}\item[{TH1D $\ast$}]{Fluct\+Hist,  }\item[{TH1D $\ast$}]{Poly\+Hist }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Make Poisson fluctuation of TH1D hist using default fast method. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l02452}{2452}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02452\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02453\ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{02454\ \ \ \textcolor{comment}{//\ Make\ the\ Poisson\ fluctuated\ hist}}
\DoxyCodeLine{02455\ \ \ FluctHist-\/>Reset(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{02456\ \ \ FluctHist-\/>Fill(0.0,\ 0.0);}
\DoxyCodeLine{02457\ }
\DoxyCodeLine{02458\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <=\ PolyHist-\/>GetXaxis()-\/>GetNbins();\ ++i)\ \ }
\DoxyCodeLine{02459\ \ \ \{}
\DoxyCodeLine{02460\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ posterior\ predictive\ bin\ content}}
\DoxyCodeLine{02461\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ MeanContent\ =\ PolyHist-\/>GetBinContent(i);}
\DoxyCodeLine{02462\ \ \ \ \ \textcolor{comment}{//\ Get\ a\ Poisson\ fluctuation\ of\ the\ content}}
\DoxyCodeLine{02463\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Random\ =\ \mbox{\hyperlink{classSampleSummary_a8322552ef396f34af5ee4bd47a44e39e}{rnd}}-\/>PoissonD(MeanContent);}
\DoxyCodeLine{02464\ \ \ \ \ \textcolor{comment}{//\ Set\ the\ fluctuated\ histogram\ content\ to\ the\ Poisson\ variation\ of\ the\ posterior\ predictive\ histogram}}
\DoxyCodeLine{02465\ \ \ \ \ FluctHist-\/>SetBinContent(i,Random);}
\DoxyCodeLine{02466\ \ \ \}}
\DoxyCodeLine{02467\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_ad8fdfe9143603490ebf0f9927c9e5ea6}\label{classSampleSummary_ad8fdfe9143603490ebf0f9927c9e5ea6}} 
\index{SampleSummary@{SampleSummary}!MakeFluctuatedHistogramStandard@{MakeFluctuatedHistogramStandard}}
\index{MakeFluctuatedHistogramStandard@{MakeFluctuatedHistogramStandard}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{MakeFluctuatedHistogramStandard()}{MakeFluctuatedHistogramStandard()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Make\+Fluctuated\+Histogram\+Standard (\begin{DoxyParamCaption}\item[{TH2\+Poly $\ast$}]{Fluct\+Hist,  }\item[{TH2\+Poly $\ast$}]{Poly\+Hist }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Make Poisson fluctuation of TH2\+Poly hist using default fast method. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l02471}{2471}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02471\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02472\ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{02473\ \ \ \textcolor{comment}{//\ Make\ the\ Poisson\ fluctuated\ hist}}
\DoxyCodeLine{02474\ \ \ FluctHist-\/>Reset(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{02475\ \ \ FluctHist-\/>Fill(0.0,\ 0.0,\ 0.0);}
\DoxyCodeLine{02476\ }
\DoxyCodeLine{02477\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ FluctHist-\/>GetNumberOfBins()+1;\ ++i)\ }
\DoxyCodeLine{02478\ \ \ \{}
\DoxyCodeLine{02479\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ posterior\ predictive\ bin\ content}}
\DoxyCodeLine{02480\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ MeanContent\ =\ PolyHist-\/>GetBinContent(i);}
\DoxyCodeLine{02481\ \ \ \ \ \textcolor{comment}{//\ Get\ a\ Poisson\ fluctuation\ of\ the\ content}}
\DoxyCodeLine{02482\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Random\ =\ \mbox{\hyperlink{classSampleSummary_a8322552ef396f34af5ee4bd47a44e39e}{rnd}}-\/>PoissonD(MeanContent);}
\DoxyCodeLine{02483\ \ \ \ \ \textcolor{comment}{//\ Set\ the\ fluctuated\ histogram\ content\ to\ the\ Poisson\ variation\ of\ the\ posterior\ predictive\ histogram}}
\DoxyCodeLine{02484\ \ \ \ \ FluctHist-\/>SetBinContent(i,Random);}
\DoxyCodeLine{02485\ \ \ \}}
\DoxyCodeLine{02486\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_a44baf8959ced974c9a0b8ae640c336bd}\label{classSampleSummary_a44baf8959ced974c9a0b8ae640c336bd}} 
\index{SampleSummary@{SampleSummary}!MakePredictive@{MakePredictive}}
\index{MakePredictive@{MakePredictive}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{MakePredictive()}{MakePredictive()}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Make\+Predictive (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Finalise the distributions from the thrown samples. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l01077}{1077}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01078\ \textcolor{comment}{//\ *******************}}
\DoxyCodeLine{01079\ }
\DoxyCodeLine{01080\ \ \ \textcolor{comment}{//\ First\ make\ the\ projection\ on\ the\ z\ axis\ of\ the\ TH3D*\ for\ every\ pmu\ cosmu\ bin}}
\DoxyCodeLine{01081\ \ \ \textcolor{keywordtype}{double}\ llh\_total\_temp\ =\ 0.0;}
\DoxyCodeLine{01082\ }
\DoxyCodeLine{01083\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ samples}}
\DoxyCodeLine{01084\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{01085\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for\ reduction(+:llh\_total\_temp)}}
\DoxyCodeLine{01086\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{01087\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ SampleNum\ =\ 0;\ \ SampleNum\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++SampleNum)}
\DoxyCodeLine{01088\ \ \ \{}
\DoxyCodeLine{01089\ \ \ \ \ \textcolor{comment}{//\ Skip\ disabled\ samples}}
\DoxyCodeLine{01090\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[SampleNum]\ ==\ NULL\ ||\ \mbox{\hyperlink{Structs_8cpp_ab18c6b2408d7b9021bad06d47a06ee8d}{NoOverflowIntegral}}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[SampleNum])\ ==\ 0)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01091\ }
\DoxyCodeLine{01092\ \ \ \ \ \textcolor{comment}{//\ Count\ the\ -\/2LLH\ for\ each\ histogram}}
\DoxyCodeLine{01093\ \ \ \ \ \textcolor{keywordtype}{double}\ negLogL\_Mean\ =\ 0.0;}
\DoxyCodeLine{01094\ \ \ \ \ \textcolor{keywordtype}{double}\ negLogL\_Mode\ =\ 0.0;}
\DoxyCodeLine{01095\ }
\DoxyCodeLine{01096\ \ \ \ \ \textcolor{comment}{//\ Loop\ over\ each\ pmu\ cosmu\ bin}}
\DoxyCodeLine{01097\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 1;\ j\ <\ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[SampleNum]+1;\ ++j)}
\DoxyCodeLine{01098\ \ \ \ \ \{}
\DoxyCodeLine{01099\ \ \ \ \ \ \ TH1D\ *Projection\ =\ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[SampleNum][j];}
\DoxyCodeLine{01100\ \ \ \ \ \ \ TH1D\ *W2Projection\ =\ \mbox{\hyperlink{classSampleSummary_a0fd31469ea40b54ea864f5eb7360adee}{w2Hist}}[SampleNum][j];}
\DoxyCodeLine{01101\ }
\DoxyCodeLine{01102\ \ \ \ \ \ \ \textcolor{comment}{//\ Data\ content\ for\ the\ j,kth\ bin}}
\DoxyCodeLine{01103\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ nData\ =\ \mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[SampleNum]-\/>GetBinContent(j);}
\DoxyCodeLine{01104\ \ \ \ \ \ \ }
\DoxyCodeLine{01105\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ mean\ for\ this\ projection\ for\ all\ the\ samples}}
\DoxyCodeLine{01106\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ is\ the\ mean\ prediction\ for\ this\ given\ j,k\ bin}}
\DoxyCodeLine{01107\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ nMean\ =\ Projection-\/>GetMean();}
\DoxyCodeLine{01108\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ nMeanError\ =\ Projection-\/>GetRMS();}
\DoxyCodeLine{01109\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ nMode\ =\ Projection-\/>GetBinCenter(Projection-\/>GetMaximumBin());}
\DoxyCodeLine{01110\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ nModeError\ =\ \mbox{\hyperlink{classSampleSummary_a1ed7c379dc433cb1dc3b71eb7aec9713}{GetModeError}}(Projection);}
\DoxyCodeLine{01111\ \ \ \ \ \ \ }
\DoxyCodeLine{01112\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ nW2Mean\ =\ W2Projection-\/>GetMean();}
\DoxyCodeLine{01113\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ nW2Mode\ =\ W2Projection-\/>GetBinCenter(W2Projection-\/>GetMaximumBin());}
\DoxyCodeLine{01114\ \ \ \ \ \ \ }
\DoxyCodeLine{01115\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ TempLLH\_Mean\ =\ 0.0;}
\DoxyCodeLine{01116\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ TempLLH\_Mode\ =\ 0.0;}
\DoxyCodeLine{01117\ \ \ \ \ \ \ }
\DoxyCodeLine{01118\ \ \ \ \ \ \ \textcolor{comment}{//KS:Get\ LLH\ contribution\ getTestStatLLH\ can\ calculate\ Barlow\ Beeston/IceCube\ or\ Poisson}}
\DoxyCodeLine{01119\ \ \ \ \ \ \ TempLLH\_Mean\ =\ \mbox{\hyperlink{classSampleSummary_abd938805245ca6cfeb8c49363f5ff11c}{SamplePDF}}-\/>\mbox{\hyperlink{classsamplePDFBase_a772ebf22fbffd9336b2d8c2f46988453}{getTestStatLLH}}(nData,\ nMean,\ nW2Mean);}
\DoxyCodeLine{01120\ \ \ \ \ \ \ TempLLH\_Mode\ =\ \mbox{\hyperlink{classSampleSummary_abd938805245ca6cfeb8c49363f5ff11c}{SamplePDF}}-\/>\mbox{\hyperlink{classsamplePDFBase_a772ebf22fbffd9336b2d8c2f46988453}{getTestStatLLH}}(nData,\ nMode,\ nW2Mode);}
\DoxyCodeLine{01121\ }
\DoxyCodeLine{01122\ \ \ \ \ \ \ \textcolor{comment}{//\ Increment\ -\/2LLH}}
\DoxyCodeLine{01123\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ do\ times\ 2\ because\ banff\ reports\ chi2}}
\DoxyCodeLine{01124\ \ \ \ \ \ \ negLogL\_Mean\ +=\ 2*TempLLH\_Mean;}
\DoxyCodeLine{01125\ \ \ \ \ \ \ negLogL\_Mode\ +=\ 2*TempLLH\_Mode;}
\DoxyCodeLine{01126\ \ \ \ \ \ \ }
\DoxyCodeLine{01127\ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ the\ content\ and\ error\ to\ the\ mean\ in\ the\ bin}}
\DoxyCodeLine{01128\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[SampleNum]-\/>SetBinContent(j,\ \mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[SampleNum]-\/>GetBinContent(j)+nMean);}
\DoxyCodeLine{01129\ \ \ \ \ \ \ \textcolor{comment}{//\ KS:\ This\ -\/1\ is\ only\ needed\ for\ root\ older\ than\ 6.18\ for\ more\ see\ https://t2k-\/experiment.slack.com/archives/CU9CBG6NS/p1714551365661589}}
\DoxyCodeLine{01130\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[SampleNum]-\/>SetBinError(j,\ nMeanError);}
\DoxyCodeLine{01131\ }
\DoxyCodeLine{01132\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}})}
\DoxyCodeLine{01133\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01134\ \ \ \ \ \ \ \ \ TH1D\ *BetaTemp\ =\ \mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}}[SampleNum][j];}
\DoxyCodeLine{01135\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ nBetaMean\ =\ BetaTemp-\/>GetMean();}
\DoxyCodeLine{01136\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ nBetaMeanError\ =\ BetaTemp-\/>GetRMS();}
\DoxyCodeLine{01137\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Here\ we\ modify\ predictions\ by\ beta\ parameter\ from\ Barlow-\/Beeston}}
\DoxyCodeLine{01138\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a805cc2be1298a385160deaa03269313a}{MeanHistCorrected}}[SampleNum]-\/>SetBinContent(j,\ \mbox{\hyperlink{classSampleSummary_a805cc2be1298a385160deaa03269313a}{MeanHistCorrected}}[SampleNum]-\/>GetBinContent(j)+nMean*nBetaMean);}
\DoxyCodeLine{01139\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ Use\ error\ propagation\ to\ calcuate\ error}}
\DoxyCodeLine{01140\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ ErrorTemp\ =\ std::sqrt(\ (nBetaMean*nMeanError)\ *\ (nBetaMean*nMeanError)\ +\ (nMean*nBetaMeanError)\ *\ (nMean*nBetaMeanError));}
\DoxyCodeLine{01141\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ KS:\ This\ -\/1\ is\ only\ needed\ for\ root\ older\ than\ 6.18\ for\ more\ see\ https://t2k-\/experiment.slack.com/archives/CU9CBG6NS/p1714551365661589}}
\DoxyCodeLine{01142\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a805cc2be1298a385160deaa03269313a}{MeanHistCorrected}}[SampleNum]-\/>SetBinError(j,\ ErrorTemp);}
\DoxyCodeLine{01143\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01144\ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ the\ content\ to\ the\ mode\ in\ the\ bin}}
\DoxyCodeLine{01145\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a59475a0c9460277914402850372727ea}{ModeHist}}[SampleNum]-\/>SetBinContent(j,\ \mbox{\hyperlink{classSampleSummary_a59475a0c9460277914402850372727ea}{ModeHist}}[SampleNum]-\/>GetBinContent(j)+nMode);}
\DoxyCodeLine{01146\ \ \ \ \ \ \ \textcolor{comment}{//\ KS:\ This\ -\/1\ is\ only\ needed\ for\ root\ older\ than\ 6.18\ for\ more\ see\ https://t2k-\/experiment.slack.com/archives/CU9CBG6NS/p1714551365661589}}
\DoxyCodeLine{01147\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a59475a0c9460277914402850372727ea}{ModeHist}}[SampleNum]-\/>SetBinError(j,\ nModeError);}
\DoxyCodeLine{01148\ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ the\ content\ to\ the\ mean\ in\ the\ bin}}
\DoxyCodeLine{01149\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2MeanHist}}[SampleNum]-\/>SetBinContent(j,\ \mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2MeanHist}}[SampleNum]-\/>GetBinContent(j)+nW2Mean);}
\DoxyCodeLine{01150\ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ the\ content\ to\ the\ mode\ in\ the\ bin}}
\DoxyCodeLine{01151\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_accde7a80fb4c8b986d1a152f88e8f515}{W2ModeHist}}[SampleNum]-\/>SetBinContent(j,\ \mbox{\hyperlink{classSampleSummary_accde7a80fb4c8b986d1a152f88e8f515}{W2ModeHist}}[SampleNum]-\/>GetBinContent(j)+nW2Mode);}
\DoxyCodeLine{01152\ \ \ \ \ \ \ }
\DoxyCodeLine{01153\ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ the\ mean\ and\ average\ LLH\ for\ this\ given\ bin}}
\DoxyCodeLine{01154\ \ \ \ \ \ \ \textcolor{comment}{//\ Can\ use\ these\ hists\ to\ see\ where\ the\ largest\ -\/2LLH\ hists\ come\ from}}
\DoxyCodeLine{01155\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a0ae323dddee7bec9c425f309b60959f1}{lnLHist\_Mean}}[SampleNum]-\/>SetBinContent(j,\ 2.0*TempLLH\_Mean);}
\DoxyCodeLine{01156\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_aa9d2908a7dfefa91deb35a562b673eb1}{lnLHist\_Mode}}[SampleNum]-\/>SetBinContent(j,\ 2.0*TempLLH\_Mode);}
\DoxyCodeLine{01157\ \ \ \ \ \ \ }
\DoxyCodeLine{01158\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a6ae29545d50456334c6035d165599787}{lnLHist\_Mean1D}}[SampleNum]-\/>Fill(2.0*TempLLH\_Mean);}
\DoxyCodeLine{01159\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a8ad8aa62be1f0f895faf342bfc0f7d13}{lnLHist\_Mode1D}}[SampleNum]-\/>Fill(2.0*TempLLH\_Mode);}
\DoxyCodeLine{01160\ \ \ \ \ \}\ \textcolor{comment}{//\ End\ loop\ over\ bins}}
\DoxyCodeLine{01161\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a795ac96bf6958c8a2f38c9de23c3c081}{DoByModePlots}})}
\DoxyCodeLine{01162\ \ \ \ \ \{}
\DoxyCodeLine{01163\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1;\ j++)}
\DoxyCodeLine{01164\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01165\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Loop\ over\ each\ pmu\ cosmu\ bin}}
\DoxyCodeLine{01166\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[SampleNum]+1;\ ++i)}
\DoxyCodeLine{01167\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01168\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Make\ the\ posterior/prior\ predictive\ projection\ on\ z}}
\DoxyCodeLine{01169\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ z\ axis\ of\ Predictive\ is\ the\ bin\ content}}
\DoxyCodeLine{01170\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Essentially\ zooming\ in\ on\ one\ bin\ and\ looking\ at\ the\ mean\ and\ mode\ of\ that\ bin}}
\DoxyCodeLine{01171\ \ \ \ \ \ \ \ \ \ \ TH1D\ *Projection\ =\ \mbox{\hyperlink{classSampleSummary_aa6cfe4fb92b67f08b0d94f0fe1d8a3a2}{PosteriorHist\_ByMode}}[SampleNum][j][i];}
\DoxyCodeLine{01172\ }
\DoxyCodeLine{01173\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ mean\ for\ this\ projection\ for\ all\ the\ samples}}
\DoxyCodeLine{01174\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ nMean\ =\ Projection-\/>GetMean();}
\DoxyCodeLine{01175\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ nMeanError\ =\ Projection-\/>GetRMS();}
\DoxyCodeLine{01176\ }
\DoxyCodeLine{01177\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ the\ content\ and\ error\ to\ the\ mean\ in\ the\ bin}}
\DoxyCodeLine{01178\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a20237446a72eda2dc833bfc72c7e42e1}{MeanHist\_ByMode}}[SampleNum][j]-\/>SetBinContent(i,\ \mbox{\hyperlink{classSampleSummary_a20237446a72eda2dc833bfc72c7e42e1}{MeanHist\_ByMode}}[SampleNum][j]-\/>GetBinContent(i)+nMean);}
\DoxyCodeLine{01179\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ KS:\ This\ -\/1\ is\ only\ needed\ for\ root\ older\ than\ 6.18\ for\ more\ see\ https://t2k-\/experiment.slack.com/archives/CU9CBG6NS/p1714551365661589}}
\DoxyCodeLine{01180\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a20237446a72eda2dc833bfc72c7e42e1}{MeanHist\_ByMode}}[SampleNum][j]-\/>SetBinError(i,\ nMeanError);}
\DoxyCodeLine{01181\ \ \ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ End\ loop\ over\ bins}}
\DoxyCodeLine{01182\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01183\ \ \ \ \ \}}
\DoxyCodeLine{01184\ \ \ \ \ llh\_total\_temp\ +=\ negLogL\_Mean;}
\DoxyCodeLine{01185\ \ \ \}\ \textcolor{comment}{//\ End\ loop\ over\ samples}}
\DoxyCodeLine{01186\ }
\DoxyCodeLine{01187\ \ \ \textcolor{comment}{//\ This\ is\ not\ multithreaded\ as\ due\ to\ ProjectPoly\ it\ is\ not\ safe}}
\DoxyCodeLine{01188\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ SampleNum\ =\ 0;\ \ SampleNum\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++SampleNum)}
\DoxyCodeLine{01189\ \ \ \{}
\DoxyCodeLine{01190\ \ \ \ \ \textcolor{comment}{//\ Skip\ disabled\ samples}}
\DoxyCodeLine{01191\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[SampleNum]\ ==\ NULL\ ||\ \mbox{\hyperlink{Structs_8cpp_ab18c6b2408d7b9021bad06d47a06ee8d}{NoOverflowIntegral}}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[SampleNum])\ ==\ 0)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01192\ }
\DoxyCodeLine{01193\ \ \ \ \ \textcolor{comment}{//KS::\ Might\ consider\ caching\ it\ as\ we\ use\ it\ once\ agian\ much\ later}}
\DoxyCodeLine{01194\ \ \ \ \ TH1D\ *MeanProjectX\ =\ \mbox{\hyperlink{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}{ProjectPoly}}(\mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[SampleNum],\ \textcolor{keyword}{true},\ SampleNum,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01195\ \ \ \ \ TH1D\ *W2MeanProjectX\ =\ \mbox{\hyperlink{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}{ProjectPoly}}(\mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2MeanHist}}[SampleNum],\ \textcolor{keyword}{true},\ SampleNum);}
\DoxyCodeLine{01196\ \ \ \ \ \textcolor{comment}{//\ Loop\ over\ each\ pmu\ bin\ for\ 1D\ projection}}
\DoxyCodeLine{01197\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 1;\ j\ <=\ \mbox{\hyperlink{classSampleSummary_a9e6d97ff3cffed6a40689a547ec7e5d7}{lnLHist\_Mean\_ProjectX}}[SampleNum]-\/>GetXaxis()-\/>GetNbins();\ ++j)}
\DoxyCodeLine{01198\ \ \ \ \ \{}
\DoxyCodeLine{01199\ \ \ \ \ \ \ \textcolor{comment}{//\ Data\ content\ for\ the\ j,kth\ bin}}
\DoxyCodeLine{01200\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ nData\ =\ \mbox{\hyperlink{classSampleSummary_aed3d754bfa3b870ba2676748d1420b5f}{DataHist\_ProjectX}}[SampleNum]-\/>GetBinContent(j);}
\DoxyCodeLine{01201\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ nMean\ =\ MeanProjectX-\/>GetBinContent(j);}
\DoxyCodeLine{01202\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ nW2Mean\ =\ W2MeanProjectX-\/>GetBinContent(j);}
\DoxyCodeLine{01203\ }
\DoxyCodeLine{01204\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ TempLLH\_Mean\ =\ 0.0;}
\DoxyCodeLine{01205\ \ \ \ \ \ \ TempLLH\_Mean\ =\ \mbox{\hyperlink{classSampleSummary_abd938805245ca6cfeb8c49363f5ff11c}{SamplePDF}}-\/>\mbox{\hyperlink{classsamplePDFBase_a772ebf22fbffd9336b2d8c2f46988453}{getTestStatLLH}}(nData,\ nMean,\ nW2Mean);}
\DoxyCodeLine{01206\ }
\DoxyCodeLine{01207\ \ \ \ \ \ \ \textcolor{comment}{//KS:\ do\ times\ 2\ because\ banff\ reports\ chi2}}
\DoxyCodeLine{01208\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a9e6d97ff3cffed6a40689a547ec7e5d7}{lnLHist\_Mean\_ProjectX}}[SampleNum]-\/>SetBinContent(j,\ 2.0*TempLLH\_Mean);}
\DoxyCodeLine{01209\ \ \ \ \ \}\textcolor{comment}{//\ End\ loop\ over\ \ bins}}
\DoxyCodeLine{01210\ }
\DoxyCodeLine{01211\ \ \ \ \ \textcolor{keyword}{delete}\ MeanProjectX;}
\DoxyCodeLine{01212\ \ \ \ \ \textcolor{keyword}{delete}\ W2MeanProjectX;}
\DoxyCodeLine{01213\ \ \ \}\ \textcolor{comment}{//\ End\ loop\ over\ samples}}
\DoxyCodeLine{01214\ }
\DoxyCodeLine{01215\ \ \ \mbox{\hyperlink{classSampleSummary_aacac73b24f1e8b05d35fabe2322578e8}{llh\_total}}\ =\ llh\_total\_temp;}
\DoxyCodeLine{01216\ \ \ \textcolor{comment}{//\ Now\ we\ have\ our\ posterior\ predictive\ histogram\ and\ it's\ LLH}}
\DoxyCodeLine{01217\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Prior/Posterior\ predictive\ LLH\ mean\ (sample\ only)\ =\ \{\}"{}},\ \mbox{\hyperlink{classSampleSummary_aacac73b24f1e8b05d35fabe2322578e8}{llh\_total}});}
\DoxyCodeLine{01218\ \ \ std::stringstream\ ss;}
\DoxyCodeLine{01219\ \ \ ss\ <<\ \mbox{\hyperlink{classSampleSummary_aacac73b24f1e8b05d35fabe2322578e8}{llh\_total}};}
\DoxyCodeLine{01220\ \ \ \mbox{\hyperlink{classSampleSummary_a086c2804cf7c1af54784d856c4351de8}{lnLHist}}-\/>SetTitle((std::string(\mbox{\hyperlink{classSampleSummary_a086c2804cf7c1af54784d856c4351de8}{lnLHist}}-\/>GetTitle())+\textcolor{stringliteral}{"{}\_"{}}+ss.str()).c\_str());}
\DoxyCodeLine{01221\ }
\DoxyCodeLine{01222\ \ \ \textcolor{comment}{//\ Now\ make\ the\ fluctuated\ hists\ of\ the\ MeanHist\ and\ ModeHist}}
\DoxyCodeLine{01223\ \ \ \mbox{\hyperlink{classSampleSummary_a316974fb99c5a775e1c7099be3bccc7b}{MakeChi2Hists}}();}
\DoxyCodeLine{01224\ }
\DoxyCodeLine{01225\ \ \ \textcolor{comment}{//\ Get\ the\ 1D\ LLH\ dists}}
\DoxyCodeLine{01226\ \ \ \mbox{\hyperlink{classSampleSummary_ab28f4325f8104ab783fa3094a2fbbc44}{MakeCutLLH}}();}
\DoxyCodeLine{01227\ \}\ \textcolor{comment}{//\ End\ MakePredictive()\ function}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_acab977d5e63eaca5862c352fea8a01c2}\label{classSampleSummary_acab977d5e63eaca5862c352fea8a01c2}} 
\index{SampleSummary@{SampleSummary}!NormaliseTH2Poly@{NormaliseTH2Poly}}
\index{NormaliseTH2Poly@{NormaliseTH2Poly}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{NormaliseTH2Poly()}{NormaliseTH2Poly()}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Normalise\+TH2\+Poly (\begin{DoxyParamCaption}\item[{TH2\+Poly $\ast$}]{Histogram }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Helper to Normalise histograms. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l01761}{1761}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01761\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01762\ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{01763\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Integral\ =\ \mbox{\hyperlink{Structs_8cpp_ab18c6b2408d7b9021bad06d47a06ee8d}{NoOverflowIntegral}}(Histogram);}
\DoxyCodeLine{01764\ }
\DoxyCodeLine{01765\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 1;\ j\ <\ Histogram-\/>GetNumberOfBins()+1;\ j++)}
\DoxyCodeLine{01766\ \ \ \{}
\DoxyCodeLine{01767\ \ \ \ \ Histogram-\/>SetBinContent(j,\ Histogram-\/>GetBinContent(j)/Integral);}
\DoxyCodeLine{01768\ \ \ \}}
\DoxyCodeLine{01769\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_ac49aa59702b5e24cb0718c2642d6d793}\label{classSampleSummary_ac49aa59702b5e24cb0718c2642d6d793}} 
\index{SampleSummary@{SampleSummary}!PlotBetaParameters@{PlotBetaParameters}}
\index{PlotBetaParameters@{PlotBetaParameters}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{PlotBetaParameters()}{PlotBetaParameters()}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Plot\+Beta\+Parameters (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



KS\+: In Barlow Beeston we have Beta Parameters which scale generated MC. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l01824}{1824}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01824\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01825\ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{01826\ }
\DoxyCodeLine{01827\ \ \ \textcolor{comment}{//\ Make\ a\ new\ directory}}
\DoxyCodeLine{01828\ \ \ TDirectory\ *BetaDir\ =\ \mbox{\hyperlink{classSampleSummary_aa7b948f290517a052f04f61dfa6af68f}{Outputfile}}-\/>mkdir(\textcolor{stringliteral}{"{}BetaParameters"{}});}
\DoxyCodeLine{01829\ \ \ BetaDir-\/>cd();}
\DoxyCodeLine{01830\ }
\DoxyCodeLine{01831\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Writing\ Beta\ parameters"{}});}
\DoxyCodeLine{01832\ \ \ TDirectory\ **DirBeta\ =\ \textcolor{keyword}{new}\ TDirectory*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{01833\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++i)}
\DoxyCodeLine{01834\ \ \ \{}
\DoxyCodeLine{01835\ \ \ \ \ \textcolor{comment}{//\ Make\ a\ new\ directory}}
\DoxyCodeLine{01836\ \ \ \ \ DirBeta[i]\ =\ BetaDir-\/>mkdir((\mbox{\hyperlink{classSampleSummary_a9ba7df41774c45a14c0a97e4accc9cc0}{SampleNames}}[i]).c\_str());}
\DoxyCodeLine{01837\ \ \ \ \ DirBeta[i]-\/>cd();}
\DoxyCodeLine{01838\ }
\DoxyCodeLine{01839\ \ \ \ \ \textcolor{comment}{//\ Loop\ over\ each\ pmu\ cosmu\ bin}}
\DoxyCodeLine{01840\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 1;\ j\ <\ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[i]+1;\ ++j)}
\DoxyCodeLine{01841\ \ \ \ \ \{}
\DoxyCodeLine{01842\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ data\ =\ \mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i]-\/>GetBinContent(j);}
\DoxyCodeLine{01843\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ mc\ =\ \mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i]-\/>GetBinContent(j);}
\DoxyCodeLine{01844\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ w2\ =\ \mbox{\hyperlink{classSampleSummary_a8219b4f8763481e16c6b4493f97378cb}{W2NomHist}}[i]-\/>GetBinContent(j);}
\DoxyCodeLine{01845\ }
\DoxyCodeLine{01846\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ BetaPrior\ =\ \mbox{\hyperlink{StatisticalUtils_8h_afecd84c56d6546271c4547192aae31af}{GetBetaParameter}}(data,\ mc,\ w2,\ \mbox{\hyperlink{classSampleSummary_aafb18632bb987ae9a302d95781d5fdba}{likelihood}});}
\DoxyCodeLine{01847\ }
\DoxyCodeLine{01848\ \ \ \ \ \ \ TLine\ *TempLine\ =\ \textcolor{keyword}{new}\ TLine(BetaPrior,\ \mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}}[i][j]-\/>GetMinimum(),\ BetaPrior,\ \mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}}[i][j]-\/>GetMaximum());}
\DoxyCodeLine{01849\ \ \ \ \ \ \ TempLine-\/>SetLineColor(kRed);}
\DoxyCodeLine{01850\ \ \ \ \ \ \ TempLine-\/>SetLineWidth(2);}
\DoxyCodeLine{01851\ }
\DoxyCodeLine{01852\ \ \ \ \ \ \ \textcolor{comment}{//\ Also\ fit\ a\ Gaussian\ because\ why\ not?}}
\DoxyCodeLine{01853\ \ \ \ \ \ \ TF1\ *Fitter\ =\ \textcolor{keyword}{new}\ TF1(\textcolor{stringliteral}{"{}Fit"{}},\ \textcolor{stringliteral}{"{}gaus"{}},\ \mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}}[i][j]-\/>GetBinLowEdge(1),\ \mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}}[i][j]-\/>GetBinLowEdge(\mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}}[i][j]-\/>GetNbinsX()+1));}
\DoxyCodeLine{01854\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}}[i][j]-\/>Fit(Fitter,\ \textcolor{stringliteral}{"{}RQ"{}});}
\DoxyCodeLine{01855\ \ \ \ \ \ \ Fitter-\/>SetLineColor(kRed-\/5);}
\DoxyCodeLine{01856\ }
\DoxyCodeLine{01857\ \ \ \ \ \ \ TLegend\ *Legend\ =\ \textcolor{keyword}{new}\ TLegend(0.4,\ 0.75,\ 0.98,\ 0.90);}
\DoxyCodeLine{01858\ \ \ \ \ \ \ Legend-\/>SetFillColor(0);}
\DoxyCodeLine{01859\ \ \ \ \ \ \ Legend-\/>SetFillStyle(0);}
\DoxyCodeLine{01860\ \ \ \ \ \ \ Legend-\/>SetLineWidth(0);}
\DoxyCodeLine{01861\ \ \ \ \ \ \ Legend-\/>SetLineColor(0);}
\DoxyCodeLine{01862\ \ \ \ \ \ \ Legend-\/>AddEntry(TempLine,\ Form(\textcolor{stringliteral}{"{}Prior\ \#mu=\%.4f,\ N\_\{data\}=\%.0f"{}},\ BetaPrior,\ data),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{01863\ \ \ \ \ \ \ Legend-\/>AddEntry(\mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}}[i][j],\ Form(\textcolor{stringliteral}{"{}Post,\ \#mu=\%.4f\#pm\%.4f"{}},\ \mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}}[i][j]-\/>GetMean(),\ \mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}}[i][j]-\/>GetRMS()),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{01864\ \ \ \ \ \ \ Legend-\/>AddEntry(Fitter,\ Form(\textcolor{stringliteral}{"{}Gauss,\ \#mu=\%.4f\#pm\%.4f"{}},\ Fitter-\/>GetParameter(1),\ Fitter-\/>GetParameter(2)),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{01865\ \ \ \ \ \ \ std::string\ TempTitle\ =\ std::string(\mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}}[i][j]-\/>GetName());}
\DoxyCodeLine{01866\ }
\DoxyCodeLine{01867\ \ \ \ \ \ \ TempTitle\ +=\ \textcolor{stringliteral}{"{}\_canv"{}};}
\DoxyCodeLine{01868\ \ \ \ \ \ \ TCanvas\ *TempCanvas\ =\ \textcolor{keyword}{new}\ TCanvas(TempTitle.c\_str(),\ TempTitle.c\_str(),\ 1024,\ 1024);}
\DoxyCodeLine{01869\ \ \ \ \ \ \ TempCanvas-\/>SetGridx();}
\DoxyCodeLine{01870\ \ \ \ \ \ \ TempCanvas-\/>SetGridy();}
\DoxyCodeLine{01871\ \ \ \ \ \ \ TempCanvas-\/>SetRightMargin(0.03);}
\DoxyCodeLine{01872\ \ \ \ \ \ \ TempCanvas-\/>SetBottomMargin(0.08);}
\DoxyCodeLine{01873\ \ \ \ \ \ \ TempCanvas-\/>SetLeftMargin(0.10);}
\DoxyCodeLine{01874\ \ \ \ \ \ \ TempCanvas-\/>SetTopMargin(0.06);}
\DoxyCodeLine{01875\ \ \ \ \ \ \ TempCanvas-\/>cd();}
\DoxyCodeLine{01876\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}}[i][j]-\/>Draw();}
\DoxyCodeLine{01877\ \ \ \ \ \ \ TempLine-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{01878\ \ \ \ \ \ \ Fitter-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{01879\ \ \ \ \ \ \ Legend-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{01880\ \ \ \ \ \ \ TempCanvas-\/>Write();}
\DoxyCodeLine{01881\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a1041f478d0610e2a363a3993991599e5}{BetaHist}}[i][j]-\/>Write();}
\DoxyCodeLine{01882\ }
\DoxyCodeLine{01883\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ TempLine;}
\DoxyCodeLine{01884\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ TempCanvas;}
\DoxyCodeLine{01885\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ Fitter;}
\DoxyCodeLine{01886\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ Legend;}
\DoxyCodeLine{01887\ \ \ \ \ \}}
\DoxyCodeLine{01888\ \ \ \ \ DirBeta[i]-\/>Write();}
\DoxyCodeLine{01889\ \ \ \ \ \textcolor{keyword}{delete}\ DirBeta[i];}
\DoxyCodeLine{01890\ \ \ \}}
\DoxyCodeLine{01891\ \ \ \textcolor{keyword}{delete}[]\ DirBeta;}
\DoxyCodeLine{01892\ \ \ BetaDir-\/>Write();}
\DoxyCodeLine{01893\ \ \ \textcolor{keyword}{delete}\ BetaDir;}
\DoxyCodeLine{01894\ }
\DoxyCodeLine{01895\ \ \ \mbox{\hyperlink{classSampleSummary_aa7b948f290517a052f04f61dfa6af68f}{Outputfile}}-\/>cd();}
\DoxyCodeLine{01896\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_a7b87a7ce0c38e968fb841f228aea7212}\label{classSampleSummary_a7b87a7ce0c38e968fb841f228aea7212}} 
\index{SampleSummary@{SampleSummary}!PrepareOutput@{PrepareOutput}}
\index{PrepareOutput@{PrepareOutput}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{PrepareOutput()}{PrepareOutput()}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Prepare\+Output (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



KS\+: Prepare output tree and necessary variables. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l00646}{646}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00646\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00647\ \textcolor{comment}{//\ **********************}}
\DoxyCodeLine{00648\ }
\DoxyCodeLine{00649\ \ \ \textcolor{comment}{//\ Make\ the\ output\ file\ (MakePosterioPredictive\ call\ writes\ to\ this)}}
\DoxyCodeLine{00650\ \ \ std::string\ TempString\ =\ \mbox{\hyperlink{classSampleSummary_a4463f635de4e83c7ada683768454da82}{OutputName}};}
\DoxyCodeLine{00651\ \ \ TempString.replace(TempString.find(\textcolor{stringliteral}{"{}.root"{}}),\ 5,\ std::string(\textcolor{stringliteral}{"{}\_procsW2.root"{}}));}
\DoxyCodeLine{00652\ \ \ \mbox{\hyperlink{classSampleSummary_aa7b948f290517a052f04f61dfa6af68f}{Outputfile}}\ =\ \textcolor{keyword}{new}\ TFile(TempString.c\_str(),\ \textcolor{stringliteral}{"{}RECREATE"{}});}
\DoxyCodeLine{00653\ }
\DoxyCodeLine{00654\ \ \ \textcolor{comment}{//\ The\ array\ of\ doubles\ we\ write\ to\ the\ TTree}}
\DoxyCodeLine{00655\ \ \ \textcolor{comment}{//\ Data\ vs\ Draw}}
\DoxyCodeLine{00656\ \ \ \mbox{\hyperlink{classSampleSummary_a8e20b53f7845651f6dc8f4b5faa9400c}{llh\_data\_draw}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00657\ \ \ \textcolor{comment}{//\ Fluctuated\ Draw\ vs\ Draw}}
\DoxyCodeLine{00658\ \ \ \mbox{\hyperlink{classSampleSummary_afbea2da38c0bd2e78ec9fa87ebdf992a}{llh\_drawfluc\_draw}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00659\ \ \ \textcolor{comment}{//\ Fluctuated\ Predicitve\ vs\ Draw}}
\DoxyCodeLine{00660\ \ \ \mbox{\hyperlink{classSampleSummary_a6dc4f1e22995a7bfa538df57903e7650}{llh\_predfluc\_draw}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00661\ }
\DoxyCodeLine{00662\ \ \ \textcolor{comment}{//\ Data\ vs\ Draw\ using\ Rate}}
\DoxyCodeLine{00663\ \ \ \mbox{\hyperlink{classSampleSummary_ad766eb771115b2800b3a8e20f95ac612}{llh\_rate\_data\_draw}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00664\ \ \ \textcolor{comment}{//\ Data\ vs\ Fluctuated\ Predictive\ using\ Rate}}
\DoxyCodeLine{00665\ \ \ \mbox{\hyperlink{classSampleSummary_a09609fb1b319d270011d01983fa88d79}{llh\_rate\_predfluc\_draw}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00666\ }
\DoxyCodeLine{00667\ \ \ \textcolor{comment}{//\ Data\ vs\ Fluctuated\ Draw}}
\DoxyCodeLine{00668\ \ \ \mbox{\hyperlink{classSampleSummary_a5c46fc1f6e0ab29dcadcde3152b0d275}{llh\_data\_drawfluc}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00669\ \ \ \textcolor{comment}{//\ Data\ vs\ Fluctuated\ Predictive}}
\DoxyCodeLine{00670\ \ \ \mbox{\hyperlink{classSampleSummary_a07d4cc27e2299f3beefe0b3e78da493a}{llh\_data\_predfluc}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00671\ \ \ \textcolor{comment}{//\ Draw\ vs\ Predictive}}
\DoxyCodeLine{00672\ \ \ \mbox{\hyperlink{classSampleSummary_a1a154b17f6f4ab15eec03f3dcfc91e5f}{llh\_draw\_pred}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00673\ \ \ \textcolor{comment}{//\ Fluctuated\ Draw\ vs\ Predictive}}
\DoxyCodeLine{00674\ \ \ \mbox{\hyperlink{classSampleSummary_adb0f7be738ba901c4a6c1253dc8b2b03}{llh\_drawfluc\_pred}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00675\ \ \ \textcolor{comment}{//\ Fluctuated\ Draw\ vs\ Fluctuated\ Predictive}}
\DoxyCodeLine{00676\ \ \ \mbox{\hyperlink{classSampleSummary_a5fb4519a15437b229f37fb171e578ab0}{llh\_drawfluc\_predfluc}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00677\ }
\DoxyCodeLine{00678\ \ \ \textcolor{comment}{//\ Fluctuated\ Predictive\ vs\ Predictive}}
\DoxyCodeLine{00679\ \ \ \mbox{\hyperlink{classSampleSummary_a5160d49065adca11bec43baaab283b70}{llh\_predfluc\_pred}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00680\ \ \ \textcolor{comment}{//\ Fluctuated\ Data\ vs\ Draw}}
\DoxyCodeLine{00681\ \ \ \mbox{\hyperlink{classSampleSummary_a85f8c5e630bc333137a403401097785d}{llh\_datafluc\_draw}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00682\ \ \ }
\DoxyCodeLine{00683\ \ \ \textcolor{comment}{//\ Data\ vs\ Draw\ for\ 1D\ projection}}
\DoxyCodeLine{00684\ \ \ \mbox{\hyperlink{classSampleSummary_a77250cd6138be6d5220f2ac6c7ebd2ea}{llh\_data\_draw\_ProjectX}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00685\ \ \ \mbox{\hyperlink{classSampleSummary_a6a171e9c3a2f71785b777d1d64a78dfa}{llh\_drawfluc\_draw\_ProjectX}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00686\ \ \ \ \ }
\DoxyCodeLine{00687\ \ \ \textcolor{comment}{//\ The\ output\ tree\ we're\ going\ to\ write\ to}}
\DoxyCodeLine{00688\ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}\ =\ \textcolor{keyword}{new}\ TTree(\textcolor{stringliteral}{"{}LLH\_draws"{}},\ \textcolor{stringliteral}{"{}LLH\_draws"{}});}
\DoxyCodeLine{00689\ \ \ \mbox{\hyperlink{classSampleSummary_a9ba7df41774c45a14c0a97e4accc9cc0}{SampleNames}}.resize(\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}});}
\DoxyCodeLine{00690\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ samples\ and\ set\ the\ addresses\ of\ the\ variables\ to\ write\ to\ file}}
\DoxyCodeLine{00691\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++i)}
\DoxyCodeLine{00692\ \ \ \{}
\DoxyCodeLine{00693\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ name}}
\DoxyCodeLine{00694\ \ \ \ \ std::string\ SampleName\ =\ \mbox{\hyperlink{classSampleSummary_abd938805245ca6cfeb8c49363f5ff11c}{SamplePDF}}-\/>\mbox{\hyperlink{classsamplePDFBase_a35ced08988cee48ac111024c70a2c7c2}{GetSampleName}}(i);}
\DoxyCodeLine{00695\ \ \ \ \ \textcolor{comment}{//\ Strip\ out\ spaces}}
\DoxyCodeLine{00696\ \ \ \ \ \textcolor{keywordflow}{while}\ (SampleName.find(\textcolor{stringliteral}{"{}\ "{}})\ !=\ std::string::npos)\ \{}
\DoxyCodeLine{00697\ \ \ \ \ \ \ SampleName.replace(SampleName.find(\textcolor{stringliteral}{"{}\ "{}}),\ 1,\ std::string(\textcolor{stringliteral}{"{}\_"{}}));}
\DoxyCodeLine{00698\ \ \ \ \ \}}
\DoxyCodeLine{00699\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a9ba7df41774c45a14c0a97e4accc9cc0}{SampleNames}}[i]\ =\ SampleName;}
\DoxyCodeLine{00700\ \ \ \ \ \textcolor{comment}{//CW:\ Also\ strip\ out\ -\/\ signs\ because\ it\ messes\ up\ TBranches}}
\DoxyCodeLine{00701\ \ \ \ \ \textcolor{keywordflow}{while}\ (SampleName.find(\textcolor{stringliteral}{"{}-\/"{}})\ !=\ std::string::npos)\ \{}
\DoxyCodeLine{00702\ \ \ \ \ \ \ SampleName.replace(SampleName.find(\textcolor{stringliteral}{"{}-\/"{}}),\ 1,\ std::string(\textcolor{stringliteral}{"{}\_"{}}));}
\DoxyCodeLine{00703\ \ \ \ \ \}}
\DoxyCodeLine{00704\ \textcolor{comment}{//\ \ All\ LLH\ below\ are\ used\ for\ actual\ p-\/value\ calculations}}
\DoxyCodeLine{00705\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch((SampleName+\textcolor{stringliteral}{"{}\_data\_draw"{}}).c\_str(),\ \ \ \ \ \&\mbox{\hyperlink{classSampleSummary_a8e20b53f7845651f6dc8f4b5faa9400c}{llh\_data\_draw}}[i]);}
\DoxyCodeLine{00706\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch((SampleName+\textcolor{stringliteral}{"{}\_drawfluc\_draw"{}}).c\_str(),\ \&\mbox{\hyperlink{classSampleSummary_afbea2da38c0bd2e78ec9fa87ebdf992a}{llh\_drawfluc\_draw}}[i]);}
\DoxyCodeLine{00707\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch((SampleName+\textcolor{stringliteral}{"{}\_predfluc\_draw"{}}).c\_str(),\ \&\mbox{\hyperlink{classSampleSummary_a6dc4f1e22995a7bfa538df57903e7650}{llh\_predfluc\_draw}}[i]);}
\DoxyCodeLine{00708\ }
\DoxyCodeLine{00709\ \textcolor{comment}{//\ \ All\ LLH\ below\ are\ used\ for\ actual\ p-\/value\ calculations\ however\ using\ rate\ only}}
\DoxyCodeLine{00710\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch((SampleName+\textcolor{stringliteral}{"{}\_rate\_data\_draw"{}}).c\_str(),\ \&\mbox{\hyperlink{classSampleSummary_ad766eb771115b2800b3a8e20f95ac612}{llh\_rate\_data\_draw}}[i]);}
\DoxyCodeLine{00711\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch((SampleName+\textcolor{stringliteral}{"{}\_rate\_predfluc\_draw"{}}).c\_str(),\ \&\mbox{\hyperlink{classSampleSummary_a09609fb1b319d270011d01983fa88d79}{llh\_rate\_predfluc\_draw}}[i]);}
\DoxyCodeLine{00712\ }
\DoxyCodeLine{00713\ \textcolor{comment}{//\ \ All\ LLH\ below\ are\ for\ validation\ reason\ but\ not\ used\ for\ final\ P-\/Value}}
\DoxyCodeLine{00714\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch((SampleName+\textcolor{stringliteral}{"{}\_data\_drawfluc"{}}).c\_str(),\ \&\mbox{\hyperlink{classSampleSummary_a5c46fc1f6e0ab29dcadcde3152b0d275}{llh\_data\_drawfluc}}[i]);}
\DoxyCodeLine{00715\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch((SampleName+\textcolor{stringliteral}{"{}\_data\_predfluc"{}}).c\_str(),\ \&\mbox{\hyperlink{classSampleSummary_a07d4cc27e2299f3beefe0b3e78da493a}{llh\_data\_predfluc}}[i]);}
\DoxyCodeLine{00716\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch((SampleName+\textcolor{stringliteral}{"{}\_draw\_pred"{}}).c\_str(),\ \ \ \ \ \&\mbox{\hyperlink{classSampleSummary_a1a154b17f6f4ab15eec03f3dcfc91e5f}{llh\_draw\_pred}}[i]);}
\DoxyCodeLine{00717\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch((SampleName+\textcolor{stringliteral}{"{}\_drawfluc\_pred"{}}).c\_str(),\ \&\mbox{\hyperlink{classSampleSummary_adb0f7be738ba901c4a6c1253dc8b2b03}{llh\_drawfluc\_pred}}[i]);}
\DoxyCodeLine{00718\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch((SampleName+\textcolor{stringliteral}{"{}\_drawfluc\_predfluc"{}}).c\_str(),\ \&\mbox{\hyperlink{classSampleSummary_a5fb4519a15437b229f37fb171e578ab0}{llh\_drawfluc\_predfluc}}[i]);}
\DoxyCodeLine{00719\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch((SampleName+\textcolor{stringliteral}{"{}\_predfluc\_pred"{}}).c\_str(),\ \&\mbox{\hyperlink{classSampleSummary_a5160d49065adca11bec43baaab283b70}{llh\_predfluc\_pred}}[i]);}
\DoxyCodeLine{00720\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch((SampleName+\textcolor{stringliteral}{"{}\_datafluc\_draw"{}}).c\_str(),\ \&\mbox{\hyperlink{classSampleSummary_a85f8c5e630bc333137a403401097785d}{llh\_datafluc\_draw}}[i]);}
\DoxyCodeLine{00721\ \ }
\DoxyCodeLine{00722\ \textcolor{comment}{//\ \ All\ LLH\ below\ are\ used\ for\ calcauting\ P-\/Value\ but\ using\ 1D\ projections}}
\DoxyCodeLine{00723\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch((SampleName+\textcolor{stringliteral}{"{}\_data\_draw\_ProjectX"{}}).c\_str(),\ \&\mbox{\hyperlink{classSampleSummary_a77250cd6138be6d5220f2ac6c7ebd2ea}{llh\_data\_draw\_ProjectX}}[i]);}
\DoxyCodeLine{00724\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch((SampleName+\textcolor{stringliteral}{"{}\_drawfluc\_draw\_ProjectX"{}}).c\_str(),\ \&\mbox{\hyperlink{classSampleSummary_a6a171e9c3a2f71785b777d1d64a78dfa}{llh\_drawfluc\_draw\_ProjectX}}[i]);}
\DoxyCodeLine{00725\ \ \ \}}
\DoxyCodeLine{00726\ \textcolor{comment}{//All\ LLH\ below\ are\ used\ for\ actual\ p-\/value\ calculations}}
\DoxyCodeLine{00727\ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch(\textcolor{stringliteral}{"{}LLH\_Penalty"{}},\ \ \ \ \ \ \ \ \ \&\mbox{\hyperlink{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}{llh\_penalty}});}
\DoxyCodeLine{00728\ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch(\textcolor{stringliteral}{"{}Total\_LLH\_Data\_Draw"{}},\ \&\mbox{\hyperlink{classSampleSummary_a2cb3d8dcbab49b62be3bc2a4a7e4d5f3}{total\_llh\_data\_draw}});}
\DoxyCodeLine{00729\ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch(\textcolor{stringliteral}{"{}Total\_LLH\_DrawFluc\_Draw"{}},\ \&\mbox{\hyperlink{classSampleSummary_a7e418146cce2c4201c3aa7e1eaad4a38}{total\_llh\_drawfluc\_draw}});}
\DoxyCodeLine{00730\ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch(\textcolor{stringliteral}{"{}Total\_LLH\_PredFluc\_Draw"{}},\ \&\mbox{\hyperlink{classSampleSummary_a804a117990fd1441c9e3a9d8e8d32e98}{total\_llh\_predfluc\_draw}});}
\DoxyCodeLine{00731\ \ \ }
\DoxyCodeLine{00732\ \textcolor{comment}{//\ \ All\ LLH\ below\ are\ used\ for\ actual\ p-\/value\ calculations\ however\ using\ rate\ only}}
\DoxyCodeLine{00733\ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch(\textcolor{stringliteral}{"{}Total\_LLH\_Rate\_PredFluc\_Draw"{}},\ \&\mbox{\hyperlink{classSampleSummary_a2ebe701d114669fdfcf61e1680bb144d}{total\_llh\_rate\_predfluc\_draw}});}
\DoxyCodeLine{00734\ }
\DoxyCodeLine{00735\ \textcolor{comment}{//All\ LLH\ below\ are\ for\ validation\ reason\ but\ not\ used\ for\ final\ P-\/Value}}
\DoxyCodeLine{00736\ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch(\textcolor{stringliteral}{"{}Total\_LLH\_Data\_DrawFluc"{}},\ \&\mbox{\hyperlink{classSampleSummary_a670c890357fd77997279c83c197f989c}{total\_llh\_data\_drawfluc}});}
\DoxyCodeLine{00737\ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch(\textcolor{stringliteral}{"{}Total\_LLH\_Data\_PredFluc"{}},\ \&\mbox{\hyperlink{classSampleSummary_aeee48af77dc4e0beee5eab13c30f3d38}{total\_llh\_data\_predfluc}});}
\DoxyCodeLine{00738\ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch(\textcolor{stringliteral}{"{}Total\_LLH\_Draw\_Pred"{}},\ \ \ \ \ \&\mbox{\hyperlink{classSampleSummary_a58efe34df7c43fb40d211036e30a1b5d}{total\_llh\_draw\_pred}});}
\DoxyCodeLine{00739\ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch(\textcolor{stringliteral}{"{}Total\_LLH\_DrawFluc\_Pred"{}},\ \&\mbox{\hyperlink{classSampleSummary_a9c8b444ac7f80a5af63d5b9f4a150b79}{total\_llh\_drawfluc\_pred}});}
\DoxyCodeLine{00740\ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch(\textcolor{stringliteral}{"{}Total\_LLH\_DrawFluc\_PredFluc"{}},\ \&\mbox{\hyperlink{classSampleSummary_af92a42a666e1bfcb2dc761ffa2253b7e}{total\_llh\_drawfluc\_predfluc}});}
\DoxyCodeLine{00741\ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch(\textcolor{stringliteral}{"{}Total\_LLH\_PredFluc\_Pred"{}},\ \&\mbox{\hyperlink{classSampleSummary_a1f6c2e7ed8f9024cf928da5b56054e07}{total\_llh\_predfluc\_pred}});}
\DoxyCodeLine{00742\ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch(\textcolor{stringliteral}{"{}Total\_LLH\_DataFluc\_Draw"{}},\ \&\mbox{\hyperlink{classSampleSummary_af9e5d89095e6c6a81aedb5ea2402e3fb}{total\_llh\_datafluc\_draw}});}
\DoxyCodeLine{00743\ \ \ }
\DoxyCodeLine{00744\ \textcolor{comment}{//All\ LLH\ below\ are\ used\ for\ calcauting\ P-\/Value\ but\ 1D\ projections}}
\DoxyCodeLine{00745\ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch(\textcolor{stringliteral}{"{}total\_llh\_data\_draw\_ProjectX"{}},\ \&\mbox{\hyperlink{classSampleSummary_a5a973692db89f52c19c9195ffe95c9a1}{total\_llh\_data\_draw\_ProjectX}});}
\DoxyCodeLine{00746\ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Branch(\textcolor{stringliteral}{"{}total\_llh\_drawfluc\_draw\_ProjectX"{}},\ \&\mbox{\hyperlink{classSampleSummary_a22df11667306c7892f9ed3f8935a5c9e}{total\_llh\_drawfluc\_draw\_ProjectX}});}
\DoxyCodeLine{00747\ }
\DoxyCodeLine{00748\ \ \ \mbox{\hyperlink{classSampleSummary_aa7b948f290517a052f04f61dfa6af68f}{Outputfile}}-\/>cd();}
\DoxyCodeLine{00749\ \ \ \mbox{\hyperlink{classSampleSummary_a916c6d1f50b54f1f4509622359b2a1b7}{Dir}}\ =\ \textcolor{keyword}{new}\ TDirectory*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{00750\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++i)}
\DoxyCodeLine{00751\ \ \ \{}
\DoxyCodeLine{00752\ \ \ \ \ \textcolor{comment}{//\ Make\ a\ new\ directory}}
\DoxyCodeLine{00753\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a916c6d1f50b54f1f4509622359b2a1b7}{Dir}}[i]\ =\ \mbox{\hyperlink{classSampleSummary_aa7b948f290517a052f04f61dfa6af68f}{Outputfile}}-\/>mkdir((\mbox{\hyperlink{classSampleSummary_a9ba7df41774c45a14c0a97e4accc9cc0}{SampleNames}}[i]).c\_str());}
\DoxyCodeLine{00754\ \ \ \}}
\DoxyCodeLine{00755\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_af9277cfce437396a23e3fb22c55196f9}\label{classSampleSummary_af9277cfce437396a23e3fb22c55196f9}} 
\index{SampleSummary@{SampleSummary}!ProjectHist@{ProjectHist}}
\index{ProjectHist@{ProjectHist}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{ProjectHist()}{ProjectHist()}}
{\footnotesize\ttfamily TH1D $\ast$ Sample\+Summary\+::\+Project\+Hist (\begin{DoxyParamCaption}\item[{TH2D $\ast$}]{Histogram,  }\item[{const bool}]{ProjectX }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Helper to project TH2D onto axis. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l02396}{2396}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02396\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02397\ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{02398\ }
\DoxyCodeLine{02399\ \ \ TH1D*\ Projection\ =\ NULL;}
\DoxyCodeLine{02400\ \ \ std::string\ name;}
\DoxyCodeLine{02401\ \ \ \textcolor{keywordflow}{if}\ (ProjectX)\ \{}
\DoxyCodeLine{02402\ \ \ \ \ name\ =\ std::string(Histogram-\/>GetName())\ +\ \textcolor{stringliteral}{"{}\_x"{}};}
\DoxyCodeLine{02403\ \ \ \ \ Projection\ =\ Histogram-\/>ProjectionX(name.c\_str(),\ 1,\ Histogram-\/>GetYaxis()-\/>GetNbins(),\ \textcolor{stringliteral}{"{}e"{}});}
\DoxyCodeLine{02404\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02405\ \ \ \ \ name\ =\ std::string(Histogram-\/>GetName())\ +\ \textcolor{stringliteral}{"{}\_y"{}};}
\DoxyCodeLine{02406\ \ \ \ \ Projection\ =\ Histogram-\/>ProjectionY(name.c\_str(),\ 1,\ Histogram-\/>GetXaxis()-\/>GetNbins(),\ \textcolor{stringliteral}{"{}e"{}});}
\DoxyCodeLine{02407\ \ \ \}}
\DoxyCodeLine{02408\ }
\DoxyCodeLine{02409\ \ \ \textcolor{keywordflow}{return}\ Projection;}
\DoxyCodeLine{02410\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}\label{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}} 
\index{SampleSummary@{SampleSummary}!ProjectPoly@{ProjectPoly}}
\index{ProjectPoly@{ProjectPoly}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{ProjectPoly()}{ProjectPoly()}}
{\footnotesize\ttfamily TH1D $\ast$ Sample\+Summary\+::\+Project\+Poly (\begin{DoxyParamCaption}\item[{TH2\+Poly $\ast$}]{Histogram,  }\item[{const bool}]{ProjectX,  }\item[{const int}]{selection,  }\item[{const bool}]{Make\+Error\+Hist = {\ttfamily false} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Helper to project TH2\+Poly onto axis. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l02414}{2414}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02414\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02415\ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{02416\ \ \ std::vector<double>\ xbins;}
\DoxyCodeLine{02417\ \ \ std::vector<double>\ ybins;}
\DoxyCodeLine{02418\ }
\DoxyCodeLine{02419\ \ \ \mbox{\hyperlink{classSampleSummary_abd938805245ca6cfeb8c49363f5ff11c}{SamplePDF}}-\/>\mbox{\hyperlink{classsamplePDFBase_aa3ac45cabba791d5ea5baabcc277384b}{SetupBinning}}(\mbox{\hyperlink{namespaceM3_adb59b8ecdc4e1b2d5d4c826a13aa7463}{M3::int\_t}}(selection),\ xbins,\ ybins);}
\DoxyCodeLine{02420\ \ \ TH1D*\ Projection\ =\ NULL;}
\DoxyCodeLine{02421\ \ \ std::string\ name;}
\DoxyCodeLine{02422\ \ \ \textcolor{keywordflow}{if}\ (ProjectX)\ \{}
\DoxyCodeLine{02423\ \ \ \ \ name\ =\ std::string(Histogram-\/>GetName())\ +\ \textcolor{stringliteral}{"{}\_x"{}};}
\DoxyCodeLine{02424\ \ \ \ \ Projection\ =\ \mbox{\hyperlink{Structs_8cpp_a1ab7c868447cffff71227e07655b47ad}{PolyProjectionX}}(Histogram,\ name.c\_str(),\ xbins,\ MakeErrorHist);}
\DoxyCodeLine{02425\ \ \ \}\ }
\DoxyCodeLine{02426\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02427\ \ \ \ \ name\ =\ std::string(Histogram-\/>GetName())\ +\ \textcolor{stringliteral}{"{}\_y"{}};}
\DoxyCodeLine{02428\ \ \ \ \ Projection\ =\ \mbox{\hyperlink{Structs_8cpp_aa26af438a657c81f2fb3f1506c6e35f6}{PolyProjectionY}}(Histogram,\ name.c\_str(),\ ybins,\ MakeErrorHist);}
\DoxyCodeLine{02429\ \ \ \}}
\DoxyCodeLine{02430\ }
\DoxyCodeLine{02431\ \ \ \textcolor{keywordflow}{return}\ Projection;}
\DoxyCodeLine{02432\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_a6cd67dc7cbc004f9b1581ac3a68e1924}\label{classSampleSummary_a6cd67dc7cbc004f9b1581ac3a68e1924}} 
\index{SampleSummary@{SampleSummary}!RatioHists@{RatioHists}}
\index{RatioHists@{RatioHists}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{RatioHists()}{RatioHists()}}
{\footnotesize\ttfamily template$<$class Hist\+Type $>$ \\
Hist\+Type $\ast$ Sample\+Summary\+::\+Ratio\+Hists (\begin{DoxyParamCaption}\item[{Hist\+Type $\ast$}]{Num\+Hist,  }\item[{Hist\+Type $\ast$}]{Denom\+Hist }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Helper to make ratio histograms. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l01731}{1731}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01731\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01732\ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{01733\ }
\DoxyCodeLine{01734\ \ \ HistType\ *NumCopy\ =\ \textcolor{keyword}{static\_cast<}HistType*\textcolor{keyword}{>}(NumHist-\/>Clone());}
\DoxyCodeLine{01735\ \ \ std::string\ title\ =\ std::string(DenomHist-\/>GetName())\ +\ \textcolor{stringliteral}{"{}\_ratio"{}};}
\DoxyCodeLine{01736\ \ \ NumCopy-\/>SetNameTitle(title.c\_str(),\ title.c\_str());}
\DoxyCodeLine{01737\ \ \ NumCopy-\/>Divide(DenomHist);}
\DoxyCodeLine{01738\ }
\DoxyCodeLine{01739\ \ \ \textcolor{keywordflow}{return}\ NumCopy;}
\DoxyCodeLine{01740\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_a6d7ad3d2ee9868e80548b8a73299bd5b}\label{classSampleSummary_a6d7ad3d2ee9868e80548b8a73299bd5b}} 
\index{SampleSummary@{SampleSummary}!RatioPolys@{RatioPolys}}
\index{RatioPolys@{RatioPolys}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{RatioPolys()}{RatioPolys()}}
{\footnotesize\ttfamily TH2\+Poly $\ast$ Sample\+Summary\+::\+Ratio\+Polys (\begin{DoxyParamCaption}\item[{TH2\+Poly $\ast$}]{Num\+Poly,  }\item[{TH2\+Poly $\ast$}]{Denom\+Poly }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Helper to make ratio of TH2\+Polys. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l01744}{1744}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01744\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01745\ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{01746\ }
\DoxyCodeLine{01747\ \ \ TH2Poly\ *NumCopy\ =\ \textcolor{keyword}{static\_cast<}TH2Poly*\textcolor{keyword}{>}(NumHist-\/>Clone());}
\DoxyCodeLine{01748\ \ \ std::string\ title\ =\ std::string(DenomHist-\/>GetName())\ +\ \textcolor{stringliteral}{"{}\_ratio"{}};}
\DoxyCodeLine{01749\ \ \ NumCopy-\/>SetNameTitle(title.c\_str(),\ title.c\_str());}
\DoxyCodeLine{01750\ }
\DoxyCodeLine{01751\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ NumCopy-\/>GetNumberOfBins()+1;\ ++i)}
\DoxyCodeLine{01752\ \ \ \{}
\DoxyCodeLine{01753\ \ \ \ \ NumCopy-\/>SetBinContent(i,NumHist-\/>GetBinContent(i)/DenomHist-\/>GetBinContent(i));}
\DoxyCodeLine{01754\ \ \ \}}
\DoxyCodeLine{01755\ }
\DoxyCodeLine{01756\ \ \ \textcolor{keywordflow}{return}\ NumCopy;}
\DoxyCodeLine{01757\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_aec9b5e17c269714496bf717bd7d6ae81}\label{classSampleSummary_aec9b5e17c269714496bf717bd7d6ae81}} 
\index{SampleSummary@{SampleSummary}!SetLikelihood@{SetLikelihood}}
\index{SetLikelihood@{SetLikelihood}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{SetLikelihood()}{SetLikelihood()}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Set\+Likelihood (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{Structs_8h_a960da89e33ac45a56f7bbfac3068dc67}{Test\+Statistic}}}]{Test\+Stat }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



KS\+: Set likelihood type. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00037}{37}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00037\ \{\ \mbox{\hyperlink{classSampleSummary_aafb18632bb987ae9a302d95781d5fdba}{likelihood}}\ =\ TestStat;\};}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_ab659605093e8fb68607a0fd5691e0535}\label{classSampleSummary_ab659605093e8fb68607a0fd5691e0535}} 
\index{SampleSummary@{SampleSummary}!SetNModelParams@{SetNModelParams}}
\index{SetNModelParams@{SetNModelParams}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{SetNModelParams()}{SetNModelParams()}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Set\+NModel\+Params (\begin{DoxyParamCaption}\item[{const int}]{n\+Pars }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Set number of model params used for BIC. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00039}{39}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00039\ \{\ \mbox{\hyperlink{classSampleSummary_a49215601479aaa99f9f64d8f7c900385}{nModelParams}}\ =\ nPars;\};}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_a3560f062913ea70912e7b9a1cb93e2a5}\label{classSampleSummary_a3560f062913ea70912e7b9a1cb93e2a5}} 
\index{SampleSummary@{SampleSummary}!StudyBIC@{StudyBIC}}
\index{StudyBIC@{StudyBIC}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{StudyBIC()}{StudyBIC()}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Study\+BIC (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Study Bayesian Information Criterion (BIC) 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l02611}{2611}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02611\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02612\ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{02613\ \ \ \textcolor{comment}{//make\ fancy\ event\ rate\ histogram}}
\DoxyCodeLine{02614\ \ \ \textcolor{keywordtype}{double}\ DataRate\ =\ 0.0;}
\DoxyCodeLine{02615\ \ \ \textcolor{keywordtype}{double}\ BinsRate\ =\ 0.0;}
\DoxyCodeLine{02616\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{02617\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for\ reduction(+:DataRate,\ BinsRate)}}
\DoxyCodeLine{02618\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{02619\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++i)}
\DoxyCodeLine{02620\ \ \ \{}
\DoxyCodeLine{02621\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i]\ ==\ NULL)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02622\ \ \ \ \ DataRate\ +=\ \mbox{\hyperlink{Structs_8cpp_ab18c6b2408d7b9021bad06d47a06ee8d}{NoOverflowIntegral}}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i]);}
\DoxyCodeLine{02623\ \ \ \ \ BinsRate\ +=\ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[i];}
\DoxyCodeLine{02624\ \ \ \}}
\DoxyCodeLine{02625\ }
\DoxyCodeLine{02626\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ EventRateBIC\ =\ \mbox{\hyperlink{StatisticalUtils_8h_a3dbcf2e503dd81c1c26f063a7e6b3362}{GetBIC}}(\mbox{\hyperlink{classSampleSummary_aacac73b24f1e8b05d35fabe2322578e8}{llh\_total}},\ DataRate,\ \mbox{\hyperlink{classSampleSummary_a49215601479aaa99f9f64d8f7c900385}{nModelParams}});}
\DoxyCodeLine{02627\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ BinBasedBIC\ =\ \mbox{\hyperlink{StatisticalUtils_8h_a3dbcf2e503dd81c1c26f063a7e6b3362}{GetBIC}}(\mbox{\hyperlink{classSampleSummary_aacac73b24f1e8b05d35fabe2322578e8}{llh\_total}},\ BinsRate,\ \mbox{\hyperlink{classSampleSummary_a49215601479aaa99f9f64d8f7c900385}{nModelParams}});}
\DoxyCodeLine{02628\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}******************************"{}});}
\DoxyCodeLine{02629\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Calculated\ Bayesian\ Information\ Criterion\ using\ global\ number\ of\ events:\ \{:.2f\}"{}},\ EventRateBIC);}
\DoxyCodeLine{02630\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Calculated\ Bayesian\ Information\ Criterion\ using\ global\ number\ of\ bins:\ \{:.2f\}"{}},\ BinBasedBIC);}
\DoxyCodeLine{02631\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Additional\ info:\ nModelParams\ \{\}\ DataRate:\ \{:.2f\}\ BinsRate:\ \{:.2f\}"{}},\ \mbox{\hyperlink{classSampleSummary_a49215601479aaa99f9f64d8f7c900385}{nModelParams}},\ DataRate,\ BinsRate);}
\DoxyCodeLine{02632\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}******************************"{}});}
\DoxyCodeLine{02633\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_a8e73fe07b8b8dfb1e2ee9245df4e7a4b}\label{classSampleSummary_a8e73fe07b8b8dfb1e2ee9245df4e7a4b}} 
\index{SampleSummary@{SampleSummary}!StudyDIC@{StudyDIC}}
\index{StudyDIC@{StudyDIC}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{StudyDIC()}{StudyDIC()}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Study\+DIC (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



KS\+: Get the Deviance Information Criterion (DIC) 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l02637}{2637}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{02637\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02638\ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{02639\ }
\DoxyCodeLine{02640\ \ \ \textcolor{comment}{//The\ posterior\ mean\ of\ the\ deviance}}
\DoxyCodeLine{02641\ \ \ \textcolor{keywordtype}{double}\ Dbar\ =\ 0.;}
\DoxyCodeLine{02642\ }
\DoxyCodeLine{02643\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{02644\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for\ reduction(+:Dbar)}}
\DoxyCodeLine{02645\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{02646\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_aa5c4055d4bb4dc720a4118032cdb4910}{nThrows}};\ ++i)}
\DoxyCodeLine{02647\ \ \ \{}
\DoxyCodeLine{02648\ \ \ \ \ \textcolor{keywordtype}{double}\ LLH\_temp\ =\ 0.;}
\DoxyCodeLine{02649\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ SampleNum\ =\ 0;\ \ SampleNum\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++SampleNum)}
\DoxyCodeLine{02650\ \ \ \ \ \{}
\DoxyCodeLine{02651\ \ \ \ \ \ \ LLH\_temp\ +=\ \mbox{\hyperlink{classSampleSummary_ad027b0716b707691e6a9565ee497b66f}{GetLLH}}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[SampleNum],\ \mbox{\hyperlink{classSampleSummary_a13177305e8fd4b97812b2ca563740bf2}{MCVector}}[i][SampleNum],\ \mbox{\hyperlink{classSampleSummary_a263b7541545b8b0ba735e0a3ac2d31e7}{W2MCVector}}[i][SampleNum]);}
\DoxyCodeLine{02652\ \ \ \ \ \}}
\DoxyCodeLine{02653\ \ \ \ \ Dbar\ +=\ LLH\_temp;}
\DoxyCodeLine{02654\ \ \ \}}
\DoxyCodeLine{02655\ \ \ Dbar\ =\ Dbar\ /\ \mbox{\hyperlink{classSampleSummary_aa5c4055d4bb4dc720a4118032cdb4910}{nThrows}};}
\DoxyCodeLine{02656\ }
\DoxyCodeLine{02657\ \ \ \textcolor{comment}{//\ A\ point\ estimate\ of\ the\ deviance}}
\DoxyCodeLine{02658\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Dhat\ =\ \mbox{\hyperlink{classSampleSummary_aacac73b24f1e8b05d35fabe2322578e8}{llh\_total}};}
\DoxyCodeLine{02659\ }
\DoxyCodeLine{02660\ \ \ \textcolor{comment}{//Effective\ number\ of\ parameters}}
\DoxyCodeLine{02661\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ p\_D\ =\ std::fabs(Dbar\ -\/\ Dhat);}
\DoxyCodeLine{02662\ }
\DoxyCodeLine{02663\ \ \ \textcolor{comment}{//Actual\ test\ stat}}
\DoxyCodeLine{02664\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ DIC\_stat\ =\ Dhat\ +\ 2\ *\ p\_D;}
\DoxyCodeLine{02665\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Effective\ number\ of\ parameters\ following\ DIC\ formalism\ is\ equal\ to:\ \{:.2f\}"{}},\ p\_D);}
\DoxyCodeLine{02666\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}DIC\ test\ statistic\ =\ \{:.2f\}"{}},\ DIC\_stat);}
\DoxyCodeLine{02667\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}******************************"{}});}
\DoxyCodeLine{02668\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02669\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_afa199f8841fcbf007c293187ea60d795}\label{classSampleSummary_afa199f8841fcbf007c293187ea60d795}} 
\index{SampleSummary@{SampleSummary}!StudyKinematicCorrelations@{StudyKinematicCorrelations}}
\index{StudyKinematicCorrelations@{StudyKinematicCorrelations}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{StudyKinematicCorrelations()}{StudyKinematicCorrelations()}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Study\+Kinematic\+Correlations (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



KS\+: Study how correlated are sample or kinematic bins. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l01900}{1900}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01900\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01901\ \textcolor{comment}{//\ ****************}}
\DoxyCodeLine{01902\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Calculating\ Correlations"{}});}
\DoxyCodeLine{01903\ \ \ TStopwatch\ timer;}
\DoxyCodeLine{01904\ \ \ timer.Start();}
\DoxyCodeLine{01905\ }
\DoxyCodeLine{01906\ \ \ \ \ \textcolor{comment}{//\ Data\ vs\ Draw\ for\ 1D\ projection}}
\DoxyCodeLine{01907\ \ \ \textcolor{keywordtype}{double}*\ NEvents\_Sample\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{01908\ \ \ \textcolor{keywordtype}{double}\ event\_rate\ =\ 0.;}
\DoxyCodeLine{01909\ }
\DoxyCodeLine{01910\ \ \ \textcolor{comment}{//\ The\ output\ tree\ we're\ going\ to\ write\ to}}
\DoxyCodeLine{01911\ \ \ TTree*\ Event\_Rate\_Tree\ =\ \textcolor{keyword}{new}\ TTree(\textcolor{stringliteral}{"{}Event\_Rate\_draws"{}},\ \textcolor{stringliteral}{"{}Event\_Rate\_draws"{}});}
\DoxyCodeLine{01912\ \ \ Event\_Rate\_Tree-\/>Branch(\textcolor{stringliteral}{"{}Event\_Rate"{}},\ \&event\_rate);}
\DoxyCodeLine{01913\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ samples\ and\ set\ the\ addresses\ of\ the\ variables\ to\ write\ to\ file}}
\DoxyCodeLine{01914\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++i)}
\DoxyCodeLine{01915\ \ \ \{}
\DoxyCodeLine{01916\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ name}}
\DoxyCodeLine{01917\ \ \ \ \ std::string\ SampleName\ =\ \mbox{\hyperlink{classSampleSummary_a9ba7df41774c45a14c0a97e4accc9cc0}{SampleNames}}[i];}
\DoxyCodeLine{01918\ \ \ \ \ \textcolor{comment}{//CW:\ Also\ strip\ out\ -\/\ signs\ because\ it\ messes\ up\ TBranches}}
\DoxyCodeLine{01919\ \ \ \ \ \textcolor{keywordflow}{while}\ (SampleName.find(\textcolor{stringliteral}{"{}-\/"{}})\ !=\ std::string::npos)\ \{}
\DoxyCodeLine{01920\ \ \ \ \ \ \ SampleName.replace(SampleName.find(\textcolor{stringliteral}{"{}-\/"{}}),\ 1,\ std::string(\textcolor{stringliteral}{"{}\_"{}}));}
\DoxyCodeLine{01921\ \ \ \ \ \}}
\DoxyCodeLine{01922\ \ \ \ \ Event\_Rate\_Tree-\/>Branch((SampleName+\textcolor{stringliteral}{"{}\_Event\_Rate"{}}).c\_str(),\ \&NEvents\_Sample[i]);}
\DoxyCodeLine{01923\ \ \ \}}
\DoxyCodeLine{01924\ }
\DoxyCodeLine{01925\ \ \ \textcolor{comment}{//\ Holds\ the\ total\ event\ rate}}
\DoxyCodeLine{01926\ \ \ TH1D\ *EventHist\ =\ \textcolor{keyword}{new}\ TH1D(\textcolor{stringliteral}{"{}EventHist"{}},\ \textcolor{stringliteral}{"{}Total\ Event\ Rate"{}},\ 100,\ 1,\ -\/1);}
\DoxyCodeLine{01927\ \ \ EventHist-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Total\ event\ rate"{}});}
\DoxyCodeLine{01928\ \ \ EventHist-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Counts"{}});}
\DoxyCodeLine{01929\ \ \ EventHist-\/>SetLineWidth(2);}
\DoxyCodeLine{01930\ }
\DoxyCodeLine{01931\ \ \ \textcolor{comment}{//\ Holds\ the\ event\ rate\ for\ the\ distribution}}
\DoxyCodeLine{01932\ \ \ TH1D\ **SumHist\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}];}
\DoxyCodeLine{01933\ }
\DoxyCodeLine{01934\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++i)}
\DoxyCodeLine{01935\ \ \ \{}
\DoxyCodeLine{01936\ \ \ \ \ std::string\ name\ =\ std::string(\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i]-\/>GetName());}
\DoxyCodeLine{01937\ \ \ \ \ name\ =\ name.substr(0,\ name.find(\textcolor{stringliteral}{"{}\_nom"{}}));}
\DoxyCodeLine{01938\ }
\DoxyCodeLine{01939\ \ \ \ \ SumHist[i]\ =\ \textcolor{keyword}{new}\ TH1D((name+\textcolor{stringliteral}{"{}\_sum"{}}).c\_str(),(name+\textcolor{stringliteral}{"{}\_sum"{}}).c\_str(),\ 100,\ 1,\ -\/1);}
\DoxyCodeLine{01940\ \ \ \ \ SumHist[i]-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}N\_\{events\}"{}});}
\DoxyCodeLine{01941\ \ \ \ \ SumHist[i]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Counts"{}});}
\DoxyCodeLine{01942\ \ \ \ \ \textcolor{keywordtype}{double}\ Integral\ =\ \mbox{\hyperlink{Structs_8cpp_ab18c6b2408d7b9021bad06d47a06ee8d}{NoOverflowIntegral}}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i]);}
\DoxyCodeLine{01943\ \ \ \ \ std::stringstream\ ss;}
\DoxyCodeLine{01944\ \ \ \ \ ss\ <<\ Integral;}
\DoxyCodeLine{01945\ \ \ \ \ SumHist[i]-\/>SetTitle((std::string(SumHist[i]-\/>GetTitle())+\textcolor{stringliteral}{"{}\_"{}}+ss.str()).c\_str());}
\DoxyCodeLine{01946\ \ \ \}}
\DoxyCodeLine{01947\ }
\DoxyCodeLine{01948\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ it\ =\ 0;\ it\ <\ \mbox{\hyperlink{classSampleSummary_aa5c4055d4bb4dc720a4118032cdb4910}{nThrows}};\ ++it)}
\DoxyCodeLine{01949\ \ \ \{}
\DoxyCodeLine{01950\ \ \ \ \ \textcolor{keywordtype}{double}\ event\_rate\_temp\ =\ 0.;}
\DoxyCodeLine{01951\ \ \ \ \ \textcolor{comment}{//\ Loop\ over\ the\ samples}}
\DoxyCodeLine{01952\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{01953\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ parallel\ for\ reduction(+:event\_rate\_temp)}}
\DoxyCodeLine{01954\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{01955\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ SampleNum\ =\ 0;\ \ SampleNum\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++SampleNum)}
\DoxyCodeLine{01956\ \ \ \ \ \{}
\DoxyCodeLine{01957\ \ \ \ \ \ \ NEvents\_Sample[SampleNum]\ =\ \mbox{\hyperlink{Structs_8cpp_ab18c6b2408d7b9021bad06d47a06ee8d}{NoOverflowIntegral}}(\mbox{\hyperlink{classSampleSummary_a13177305e8fd4b97812b2ca563740bf2}{MCVector}}[it][SampleNum]);}
\DoxyCodeLine{01958\ \ \ \ \ \ \ \textcolor{comment}{//\ Fill\ the\ sum\ histogram\ with\ the\ integral\ of\ the\ sampled\ distribution}}
\DoxyCodeLine{01959\ \ \ \ \ \ \ SumHist[SampleNum]-\/>Fill(NEvents\_Sample[SampleNum],\ \mbox{\hyperlink{classSampleSummary_ad40a0514f4be18ef026ea41bd5965fa3}{WeightVector}}[it]);}
\DoxyCodeLine{01960\ }
\DoxyCodeLine{01961\ \ \ \ \ \ \ event\_rate\_temp\ +=\ NEvents\_Sample[SampleNum];}
\DoxyCodeLine{01962\ \ \ \ \ \}\ \textcolor{comment}{//\ end\ samples\ loop}}
\DoxyCodeLine{01963\ \ \ \ \ event\_rate\ =\ event\_rate\_temp;}
\DoxyCodeLine{01964\ \ \ \ \ EventHist-\/>Fill(event\_rate);}
\DoxyCodeLine{01965\ \ \ \ \ Event\_Rate\_Tree-\/>Fill();}
\DoxyCodeLine{01966\ \ \ \}\ \textcolor{comment}{//end\ loops\ over\ throws}}
\DoxyCodeLine{01967\ \ \ Event\_Rate\_Tree-\/>Write();}
\DoxyCodeLine{01968\ \ \ \textcolor{keyword}{delete}\ Event\_Rate\_Tree;}
\DoxyCodeLine{01969\ }
\DoxyCodeLine{01970\ \ \ \textcolor{keywordtype}{double}\ DataRate\ =\ 0.0;}
\DoxyCodeLine{01971\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{01972\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for\ reduction(+:DataRate)}}
\DoxyCodeLine{01973\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{01974\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++i)}
\DoxyCodeLine{01975\ \ \ \{}
\DoxyCodeLine{01976\ \ \ \ \ DataRate\ +=\ \mbox{\hyperlink{Structs_8cpp_ab18c6b2408d7b9021bad06d47a06ee8d}{NoOverflowIntegral}}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i]);}
\DoxyCodeLine{01977\ \ \ \}}
\DoxyCodeLine{01978\ \ \ \mbox{\hyperlink{classSampleSummary_a0e21a2b9fd429261e378f4e505ba2f75}{MakeCutEventRate}}(EventHist,\ DataRate);}
\DoxyCodeLine{01979\ \ \ \textcolor{keyword}{delete}\ EventHist;}
\DoxyCodeLine{01980\ }
\DoxyCodeLine{01981\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ SampleNum\ =\ 0;\ SampleNum\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++SampleNum)}
\DoxyCodeLine{01982\ \ \ \{}
\DoxyCodeLine{01983\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a916c6d1f50b54f1f4509622359b2a1b7}{Dir}}[SampleNum]-\/>cd();}
\DoxyCodeLine{01984\ \ \ \ \ \textcolor{comment}{//Make\ fancy\ event\ rate\ histogram}}
\DoxyCodeLine{01985\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a0e21a2b9fd429261e378f4e505ba2f75}{MakeCutEventRate}}(SumHist[SampleNum],\ \mbox{\hyperlink{Structs_8cpp_ab18c6b2408d7b9021bad06d47a06ee8d}{NoOverflowIntegral}}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[SampleNum]));}
\DoxyCodeLine{01986\ \ \ \}}
\DoxyCodeLine{01987\ }
\DoxyCodeLine{01988\ \ \ \textcolor{comment}{//\ Make\ a\ new\ direcotry}}
\DoxyCodeLine{01989\ \ \ TDirectory\ *CorrDir\ =\ \mbox{\hyperlink{classSampleSummary_aa7b948f290517a052f04f61dfa6af68f}{Outputfile}}-\/>mkdir(\textcolor{stringliteral}{"{}Correlations"{}});}
\DoxyCodeLine{01990\ \ \ CorrDir-\/>cd();}
\DoxyCodeLine{01991\ }
\DoxyCodeLine{01992\ \ \ TMatrixDSym*\ SampleCorrelation\ =\ \textcolor{keyword}{new}\ TMatrixDSym(\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}});}
\DoxyCodeLine{01993\ }
\DoxyCodeLine{01994\ \ \ TH2D***\ SamCorr\ =\ \textcolor{keyword}{new}\ TH2D**[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}]();}
\DoxyCodeLine{01995\ }
\DoxyCodeLine{01996\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++i)}
\DoxyCodeLine{01997\ \ \ \{}
\DoxyCodeLine{01998\ \ \ \ \ SamCorr[i]\ =\ \textcolor{keyword}{new}\ TH2D*[\mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}}]();}
\DoxyCodeLine{01999\ }
\DoxyCodeLine{02000\ \ \ \ \ (*SampleCorrelation)(i,i)\ =\ 1.0;}
\DoxyCodeLine{02001\ }
\DoxyCodeLine{02002\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Min\_i\ =\ SumHist[i]-\/>GetXaxis()-\/>GetBinLowEdge(1);}
\DoxyCodeLine{02003\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Max\_i\ =\ SumHist[i]-\/>GetXaxis()-\/>GetBinUpEdge(SumHist[i]-\/>GetNbinsX()+1);}
\DoxyCodeLine{02004\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++j)}
\DoxyCodeLine{02005\ \ \ \ \ \{}
\DoxyCodeLine{02006\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Min\_j\ =\ SumHist[j]-\/>GetXaxis()-\/>GetBinLowEdge(1);}
\DoxyCodeLine{02007\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Max\_j\ =\ SumHist[j]-\/>GetXaxis()-\/>GetBinUpEdge(SumHist[j]-\/>GetNbinsX()+1);}
\DoxyCodeLine{02008\ }
\DoxyCodeLine{02009\ \ \ \ \ \ \ \textcolor{comment}{//\ TH2D\ to\ hold\ the\ Correlation}}
\DoxyCodeLine{02010\ \ \ \ \ \ \ SamCorr[i][j]\ =\ \textcolor{keyword}{new}\ TH2D(Form(\textcolor{stringliteral}{"{}SamCorr\_\%i\_\%i"{}},i,j),\ Form(\textcolor{stringliteral}{"{}SamCorr\_\%i\_\%i"{}},i,j),\ 70,\ Min\_i,\ Max\_i,\ 70,\ Min\_j,\ Max\_j);}
\DoxyCodeLine{02011\ \ \ \ \ \ \ SamCorr[i][j]-\/>SetDirectory(0);}
\DoxyCodeLine{02012\ \ \ \ \ \ \ SamCorr[i][j]-\/>SetMinimum(0);}
\DoxyCodeLine{02013\ \ \ \ \ \ \ SamCorr[i][j]-\/>GetXaxis()-\/>SetTitle(\mbox{\hyperlink{classSampleSummary_a9ba7df41774c45a14c0a97e4accc9cc0}{SampleNames}}[i].c\_str());}
\DoxyCodeLine{02014\ \ \ \ \ \ \ SamCorr[i][j]-\/>GetYaxis()-\/>SetTitle(\mbox{\hyperlink{classSampleSummary_a9ba7df41774c45a14c0a97e4accc9cc0}{SampleNames}}[j].c\_str());}
\DoxyCodeLine{02015\ \ \ \ \ \ \ SamCorr[i][j]-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Events"{}});}
\DoxyCodeLine{02016\ \ \ \ \ \}}
\DoxyCodeLine{02017\ \ \ \}}
\DoxyCodeLine{02018\ }
\DoxyCodeLine{02019\ \ \ \textcolor{comment}{//\ Now\ we\ are\ sure\ we\ have\ the\ diagonal\ elements,\ let's\ make\ the\ off-\/diagonals}}
\DoxyCodeLine{02020\ \textcolor{preprocessor}{\ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{02021\ \textcolor{preprocessor}{\ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{02022\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{02023\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++i)}
\DoxyCodeLine{02024\ \ \ \{}
\DoxyCodeLine{02025\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ ++j)}
\DoxyCodeLine{02026\ \ \ \ \ \{}
\DoxyCodeLine{02027\ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ the\ diagonal\ elements\ which\ we've\ already\ done\ above}}
\DoxyCodeLine{02028\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ ==\ i)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02029\ }
\DoxyCodeLine{02030\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ it\ =\ 0;\ it\ <\ \mbox{\hyperlink{classSampleSummary_aa5c4055d4bb4dc720a4118032cdb4910}{nThrows}};\ ++it)}
\DoxyCodeLine{02031\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02032\ \ \ \ \ \ \ \ \ SamCorr[i][j]-\/>Fill(\mbox{\hyperlink{Structs_8cpp_ab18c6b2408d7b9021bad06d47a06ee8d}{NoOverflowIntegral}}(\mbox{\hyperlink{classSampleSummary_a13177305e8fd4b97812b2ca563740bf2}{MCVector}}[it][i]),\ \mbox{\hyperlink{Structs_8cpp_ab18c6b2408d7b9021bad06d47a06ee8d}{NoOverflowIntegral}}(\mbox{\hyperlink{classSampleSummary_a13177305e8fd4b97812b2ca563740bf2}{MCVector}}[it][j]));}
\DoxyCodeLine{02033\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02034\ \ \ \ \ \ \ SamCorr[i][j]-\/>Smooth();}
\DoxyCodeLine{02035\ }
\DoxyCodeLine{02036\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ Covariance\ for\ these\ two\ parameters}}
\DoxyCodeLine{02037\ \ \ \ \ \ \ (*SampleCorrelation)(i,j)\ =\ SamCorr[i][j]-\/>GetCorrelationFactor();}
\DoxyCodeLine{02038\ \ \ \ \ \ \ (*SampleCorrelation)(j,i)\ =\ (*SampleCorrelation)(i,j);}
\DoxyCodeLine{02039\ }
\DoxyCodeLine{02040\ \ \ \ \ \}\textcolor{comment}{//\ End\ j\ loop}}
\DoxyCodeLine{02041\ \ \ \}\textcolor{comment}{//\ End\ i\ loop}}
\DoxyCodeLine{02042\ }
\DoxyCodeLine{02043\ \ \ TH2D*\ hSamCorr\ =\ \textcolor{keyword}{new}\ TH2D(\textcolor{stringliteral}{"{}Sample\ Correlation"{}},\ \textcolor{stringliteral}{"{}Sample\ Correlation"{}},\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}},\ 0,\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}},\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}},\ 0,\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}});}
\DoxyCodeLine{02044\ \ \ hSamCorr-\/>SetDirectory(0);}
\DoxyCodeLine{02045\ \ \ hSamCorr-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Correlation"{}});}
\DoxyCodeLine{02046\ \ \ hSamCorr-\/>SetMinimum(-\/1);}
\DoxyCodeLine{02047\ \ \ hSamCorr-\/>SetMaximum(1);}
\DoxyCodeLine{02048\ \ \ hSamCorr-\/>GetXaxis()-\/>SetLabelSize(0.015);}
\DoxyCodeLine{02049\ \ \ hSamCorr-\/>GetYaxis()-\/>SetLabelSize(0.015);}
\DoxyCodeLine{02050\ }
\DoxyCodeLine{02051\ \ \ \textcolor{comment}{//\ Loop\ over\ the\ Covariance\ matrix\ entries}}
\DoxyCodeLine{02052\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++i)}
\DoxyCodeLine{02053\ \ \ \{}
\DoxyCodeLine{02054\ \ \ \ \ hSamCorr-\/>GetXaxis()-\/>SetBinLabel(i+1,\ \mbox{\hyperlink{classSampleSummary_a9ba7df41774c45a14c0a97e4accc9cc0}{SampleNames}}[i].c\_str());}
\DoxyCodeLine{02055\ }
\DoxyCodeLine{02056\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++j)}
\DoxyCodeLine{02057\ \ \ \ \ \{}
\DoxyCodeLine{02058\ \ \ \ \ \ \ hSamCorr-\/>GetYaxis()-\/>SetBinLabel(j+1,\ \mbox{\hyperlink{classSampleSummary_a9ba7df41774c45a14c0a97e4accc9cc0}{SampleNames}}[j].c\_str());}
\DoxyCodeLine{02059\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ value\ of\ the\ Covariance}}
\DoxyCodeLine{02060\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ corr\ =\ (*SampleCorrelation)(i,j);}
\DoxyCodeLine{02061\ \ \ \ \ \ \ hSamCorr-\/>SetBinContent(i+1,\ j+1,\ corr);}
\DoxyCodeLine{02062\ \ \ \ \ \}}
\DoxyCodeLine{02063\ \ \ \}}
\DoxyCodeLine{02064\ }
\DoxyCodeLine{02065\ \ \ hSamCorr-\/>Draw(\textcolor{stringliteral}{"{}colz"{}});}
\DoxyCodeLine{02066\ \ \ hSamCorr-\/>Write(\textcolor{stringliteral}{"{}Sample\_Corr"{}});}
\DoxyCodeLine{02067\ \ \ \textcolor{keyword}{delete}\ hSamCorr;}
\DoxyCodeLine{02068\ }
\DoxyCodeLine{02069\ \ \ SampleCorrelation-\/>Write(\textcolor{stringliteral}{"{}Sample\_Correlation"{}});}
\DoxyCodeLine{02070\ \ \ \textcolor{keyword}{delete}\ SampleCorrelation;}
\DoxyCodeLine{02071\ }
\DoxyCodeLine{02072\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++i)}
\DoxyCodeLine{02073\ \ \ \{}
\DoxyCodeLine{02074\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ ++j)}
\DoxyCodeLine{02075\ \ \ \ \ \{}
\DoxyCodeLine{02076\ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ the\ diagonal\ elements\ which\ we've\ already\ done\ above}}
\DoxyCodeLine{02077\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ ==\ i)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02078\ \ \ \ \ \ \ SamCorr[i][j]-\/>Write();}
\DoxyCodeLine{02079\ \ \ \ \ \}\textcolor{comment}{//\ End\ j\ loop}}
\DoxyCodeLine{02080\ \ \ \}\textcolor{comment}{//\ End\ i\ loop}}
\DoxyCodeLine{02081\ }
\DoxyCodeLine{02082\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++i)}
\DoxyCodeLine{02083\ \ \ \{}
\DoxyCodeLine{02084\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++j)}
\DoxyCodeLine{02085\ \ \ \ \ \{}
\DoxyCodeLine{02086\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ SamCorr[i][j];}
\DoxyCodeLine{02087\ \ \ \ \ \}}
\DoxyCodeLine{02088\ \ \ \ \ \textcolor{keyword}{delete}[]\ SamCorr[i];}
\DoxyCodeLine{02089\ \ \ \}}
\DoxyCodeLine{02090\ \ \ \textcolor{keyword}{delete}[]\ SamCorr;}
\DoxyCodeLine{02091\ }
\DoxyCodeLine{02092\ \ \ \textcolor{comment}{//KS:\ This\ can\ take\ ages\ so\ better\ turn\ it\ off\ by\ default}}
\DoxyCodeLine{02093\ \ \ \textcolor{keywordtype}{bool}\ DoPerKinemBin\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02094\ \ \ \textcolor{keywordflow}{if}(DoPerKinemBin)}
\DoxyCodeLine{02095\ \ \ \{}
\DoxyCodeLine{02096\ \ \ \ \ \textcolor{comment}{//KS:\ Now\ the\ same\ but\ for\ kinematic\ bin\ of\ each\ sample}}
\DoxyCodeLine{02097\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ SampleNum\ =\ 0;\ SampleNum\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++SampleNum)}
\DoxyCodeLine{02098\ \ \ \ \ \{}
\DoxyCodeLine{02099\ \ \ \ \ \ \ TMatrixDSym*\ KinCorrelation\ =\ \textcolor{keyword}{new}\ TMatrixDSym(\mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[SampleNum]);}
\DoxyCodeLine{02100\ }
\DoxyCodeLine{02101\ \ \ \ \ \ \ TH2D***\ KinCorr\ =\ \textcolor{keyword}{new}\ TH2D**[\mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[SampleNum]]();}
\DoxyCodeLine{02102\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[SampleNum];\ ++i)}
\DoxyCodeLine{02103\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02104\ \ \ \ \ \ \ \ \ KinCorr[i]\ =\ \textcolor{keyword}{new}\ TH2D*[\mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[SampleNum]]();}
\DoxyCodeLine{02105\ \ \ \ \ \ \ \ \ (*KinCorrelation)(i,i)\ =\ 1.0;}
\DoxyCodeLine{02106\ }
\DoxyCodeLine{02107\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Min\_i\ =\ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[SampleNum][i+1]-\/>GetXaxis()-\/>GetBinLowEdge(1);}
\DoxyCodeLine{02108\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Max\_i\ =\ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[SampleNum][i+1]-\/>GetXaxis()-\/>GetBinUpEdge(\mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[SampleNum][i+1]-\/>GetNbinsX()+1);}
\DoxyCodeLine{02109\ }
\DoxyCodeLine{02110\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Get\ PolyBin}}
\DoxyCodeLine{02111\ \ \ \ \ \ \ \ \ TH2PolyBin*\ bin\ =\ \textcolor{keyword}{static\_cast<}TH2PolyBin*\textcolor{keyword}{>}(\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[SampleNum]-\/>GetBins()-\/>At(i));}
\DoxyCodeLine{02112\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Just\ make\ a\ little\ fancy\ name}}
\DoxyCodeLine{02113\ \ \ \ \ \ \ \ \ std::stringstream\ ss2;}
\DoxyCodeLine{02114\ \ \ \ \ \ \ \ \ ss2\ <<\ \textcolor{stringliteral}{"{}p\_\{\#mu\}\ ("{}}\ <<\ bin-\/>GetXMin()\ <<\ \textcolor{stringliteral}{"{}-\/"{}}\ <<\ bin-\/>GetXMax()\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{02115\ \ \ \ \ \ \ \ \ ss2\ <<\ \textcolor{stringliteral}{"{}\ cos\#theta\_\{\#mu\}\ ("{}}\ <<\ bin-\/>GetYMin()\ <<\ \textcolor{stringliteral}{"{}-\/"{}}\ <<\ bin-\/>GetYMax()\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{02116\ }
\DoxyCodeLine{02117\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[SampleNum];\ ++j)}
\DoxyCodeLine{02118\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02119\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Min\_j\ =\ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[SampleNum][j+1]-\/>GetXaxis()-\/>GetBinLowEdge(1);}
\DoxyCodeLine{02120\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Max\_j\ =\ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[SampleNum][j+1]-\/>GetXaxis()-\/>GetBinUpEdge(\mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[SampleNum][j+1]-\/>GetNbinsX()+1);}
\DoxyCodeLine{02121\ }
\DoxyCodeLine{02122\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TH2D\ to\ hold\ the\ Correlation}}
\DoxyCodeLine{02123\ \ \ \ \ \ \ \ \ \ \ KinCorr[i][j]\ =\ \textcolor{keyword}{new}\ TH2D(Form(\textcolor{stringliteral}{"{}Kin\_\%i\_\%i\_\%i"{}},SampleNum,i,j),\ Form(\textcolor{stringliteral}{"{}Kin\_\%i\_\%i\_\%i"{}},SampleNum,i,j),\ 70,\ Min\_i,\ Max\_i,\ 70,\ Min\_j,\ Max\_j);}
\DoxyCodeLine{02124\ \ \ \ \ \ \ \ \ \ \ KinCorr[i][j]-\/>SetDirectory(0);}
\DoxyCodeLine{02125\ \ \ \ \ \ \ \ \ \ \ KinCorr[i][j]-\/>SetMinimum(0);}
\DoxyCodeLine{02126\ }
\DoxyCodeLine{02127\ \ \ \ \ \ \ \ \ \ \ KinCorr[i][j]-\/>GetXaxis()-\/>SetTitle(ss2.str().c\_str());}
\DoxyCodeLine{02128\ }
\DoxyCodeLine{02129\ \ \ \ \ \ \ \ \ \ \ bin\ =\ \textcolor{keyword}{static\_cast<}TH2PolyBin*\textcolor{keyword}{>}(\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[SampleNum]-\/>GetBins()-\/>At(j));}
\DoxyCodeLine{02130\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Just\ make\ a\ little\ fancy\ name}}
\DoxyCodeLine{02131\ \ \ \ \ \ \ \ \ \ \ std::stringstream\ ss3;}
\DoxyCodeLine{02132\ \ \ \ \ \ \ \ \ \ \ ss3\ <<\ \textcolor{stringliteral}{"{}p\_\{\#mu\}\ ("{}}\ <<\ bin-\/>GetXMin()\ <<\ \textcolor{stringliteral}{"{}-\/"{}}\ <<\ bin-\/>GetXMax()\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{02133\ \ \ \ \ \ \ \ \ \ \ ss3\ <<\ \textcolor{stringliteral}{"{}\ cos\#theta\_\{\#mu\}\ ("{}}\ <<\ bin-\/>GetYMin()\ <<\ \textcolor{stringliteral}{"{}-\/"{}}\ <<\ bin-\/>GetYMax()\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{02134\ \ \ \ \ \ \ \ \ \ \ KinCorr[i][j]-\/>GetYaxis()-\/>SetTitle(ss3.str().c\_str());}
\DoxyCodeLine{02135\ }
\DoxyCodeLine{02136\ \ \ \ \ \ \ \ \ \ \ KinCorr[i][j]-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Events"{}});}
\DoxyCodeLine{02137\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02138\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02139\ \ \ \ \ \ \ \textcolor{comment}{//\ Now\ we\ are\ sure\ we\ have\ the\ diagonal\ elements,\ let's\ make\ the\ off-\/diagonals}}
\DoxyCodeLine{02140\ \textcolor{preprocessor}{\ \ \ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{02141\ \textcolor{preprocessor}{\ \ \ \ \ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{02142\ \textcolor{preprocessor}{\ \ \ \ \ \ \#endif}}
\DoxyCodeLine{02143\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[SampleNum];\ ++i)}
\DoxyCodeLine{02144\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02145\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ ++j)}
\DoxyCodeLine{02146\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02147\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ the\ diagonal\ elements\ which\ we've\ already\ done\ above}}
\DoxyCodeLine{02148\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ ==\ i)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02149\ }
\DoxyCodeLine{02150\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ it\ =\ 0;\ it\ <\ \mbox{\hyperlink{classSampleSummary_aa5c4055d4bb4dc720a4118032cdb4910}{nThrows}};\ ++it)}
\DoxyCodeLine{02151\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02152\ \ \ \ \ \ \ \ \ \ \ \ \ KinCorr[i][j]-\/>Fill(\mbox{\hyperlink{classSampleSummary_a13177305e8fd4b97812b2ca563740bf2}{MCVector}}[it][SampleNum]-\/>GetBinContent(i+1),\ \mbox{\hyperlink{classSampleSummary_a13177305e8fd4b97812b2ca563740bf2}{MCVector}}[it][SampleNum]-\/>GetBinContent(j+1));}
\DoxyCodeLine{02153\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02154\ \ \ \ \ \ \ \ \ \ \ KinCorr[i][j]-\/>Smooth();}
\DoxyCodeLine{02155\ }
\DoxyCodeLine{02156\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ Covariance\ for\ these\ two\ parameters}}
\DoxyCodeLine{02157\ \ \ \ \ \ \ \ \ \ \ (*KinCorrelation)(i,j)\ =\ KinCorr[i][j]-\/>GetCorrelationFactor();}
\DoxyCodeLine{02158\ \ \ \ \ \ \ \ \ \ \ (*KinCorrelation)(j,i)\ =\ (*KinCorrelation)(i,j);}
\DoxyCodeLine{02159\ }
\DoxyCodeLine{02160\ \ \ \ \ \ \ \ \ \}\textcolor{comment}{//\ End\ j\ loop}}
\DoxyCodeLine{02161\ \ \ \ \ \ \ \}\textcolor{comment}{//\ End\ i\ loop}}
\DoxyCodeLine{02162\ }
\DoxyCodeLine{02163\ }
\DoxyCodeLine{02164\ \ \ \ \ \ \ TH2D*\ hKinCorr\ =\ \textcolor{keyword}{new}\ TH2D(\mbox{\hyperlink{classSampleSummary_a9ba7df41774c45a14c0a97e4accc9cc0}{SampleNames}}[SampleNum].c\_str(),\ \mbox{\hyperlink{classSampleSummary_a9ba7df41774c45a14c0a97e4accc9cc0}{SampleNames}}[SampleNum].c\_str(),\ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[SampleNum],\ 0,\ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[SampleNum],\ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[SampleNum],\ 0,\ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[SampleNum]);}
\DoxyCodeLine{02165\ \ \ \ \ \ \ hKinCorr-\/>SetDirectory(0);}
\DoxyCodeLine{02166\ \ \ \ \ \ \ hKinCorr-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Correlation"{}});}
\DoxyCodeLine{02167\ \ \ \ \ \ \ hKinCorr-\/>SetMinimum(-\/1);}
\DoxyCodeLine{02168\ \ \ \ \ \ \ hKinCorr-\/>SetMaximum(1);}
\DoxyCodeLine{02169\ \ \ \ \ \ \ hKinCorr-\/>GetXaxis()-\/>SetLabelSize(0.015);}
\DoxyCodeLine{02170\ \ \ \ \ \ \ hKinCorr-\/>GetYaxis()-\/>SetLabelSize(0.015);}
\DoxyCodeLine{02171\ }
\DoxyCodeLine{02172\ \ \ \ \ \ \ \textcolor{comment}{//\ Loop\ over\ the\ Covariance\ matrix\ entries}}
\DoxyCodeLine{02173\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[SampleNum];\ ++i)}
\DoxyCodeLine{02174\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02175\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Get\ PolyBin}}
\DoxyCodeLine{02176\ \ \ \ \ \ \ \ \ TH2PolyBin*\ bin\ =\ \textcolor{keyword}{static\_cast<}TH2PolyBin*\textcolor{keyword}{>}(\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[SampleNum]-\/>GetBins()-\/>At(i));}
\DoxyCodeLine{02177\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Just\ make\ a\ little\ fancy\ name}}
\DoxyCodeLine{02178\ \ \ \ \ \ \ \ \ std::stringstream\ ss2;}
\DoxyCodeLine{02179\ \ \ \ \ \ \ \ \ ss2\ <<\ \textcolor{stringliteral}{"{}p\_\{\#mu\}\ ("{}}\ <<\ bin-\/>GetXMin()\ <<\ \textcolor{stringliteral}{"{}-\/"{}}\ <<\ bin-\/>GetXMax()\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{02180\ \ \ \ \ \ \ \ \ ss2\ <<\ \textcolor{stringliteral}{"{}\ cos\#theta\_\{\#mu\}\ ("{}}\ <<\ bin-\/>GetYMin()\ <<\ \textcolor{stringliteral}{"{}-\/"{}}\ <<\ bin-\/>GetYMax()\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{02181\ \ \ \ \ \ \ \ \ hKinCorr-\/>GetXaxis()-\/>SetBinLabel(i+1,\ ss2.str().c\_str());}
\DoxyCodeLine{02182\ }
\DoxyCodeLine{02183\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[SampleNum];\ ++j)}
\DoxyCodeLine{02184\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02185\ \ \ \ \ \ \ \ \ \ \ bin\ =\ \textcolor{keyword}{static\_cast<}TH2PolyBin*\textcolor{keyword}{>}(\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[SampleNum]-\/>GetBins()-\/>At(j));}
\DoxyCodeLine{02186\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Just\ make\ a\ little\ fancy\ name}}
\DoxyCodeLine{02187\ \ \ \ \ \ \ \ \ \ \ std::stringstream\ ss3;}
\DoxyCodeLine{02188\ \ \ \ \ \ \ \ \ \ \ ss3\ <<\ \textcolor{stringliteral}{"{}p\_\{\#mu\}\ ("{}}\ <<\ bin-\/>GetXMin()\ <<\ \textcolor{stringliteral}{"{}-\/"{}}\ <<\ bin-\/>GetXMax()\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{02189\ \ \ \ \ \ \ \ \ \ \ ss3\ <<\ \textcolor{stringliteral}{"{}\ cos\#theta\_\{\#mu\}\ ("{}}\ <<\ bin-\/>GetYMin()\ <<\ \textcolor{stringliteral}{"{}-\/"{}}\ <<\ bin-\/>GetYMax()\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{02190\ \ \ \ \ \ \ \ \ \ \ KinCorr[i][j]-\/>GetYaxis()-\/>SetTitle(ss3.str().c\_str());}
\DoxyCodeLine{02191\ }
\DoxyCodeLine{02192\ \ \ \ \ \ \ \ \ \ \ hKinCorr-\/>GetYaxis()-\/>SetBinLabel(j+1,\ ss3.str().c\_str());}
\DoxyCodeLine{02193\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ value\ of\ the\ Covariance}}
\DoxyCodeLine{02194\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ corr\ =\ (*KinCorrelation)(i,j);}
\DoxyCodeLine{02195\ \ \ \ \ \ \ \ \ \ \ hKinCorr-\/>SetBinContent(i+1,\ j+1,\ corr);}
\DoxyCodeLine{02196\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02197\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02198\ }
\DoxyCodeLine{02199\ \ \ \ \ \ \ hKinCorr-\/>Draw(\textcolor{stringliteral}{"{}colz"{}});}
\DoxyCodeLine{02200\ \ \ \ \ \ \ hKinCorr-\/>Write((\mbox{\hyperlink{classSampleSummary_a9ba7df41774c45a14c0a97e4accc9cc0}{SampleNames}}[SampleNum]\ +\ \textcolor{stringliteral}{"{}\_Corr"{}}).c\_str());}
\DoxyCodeLine{02201\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ hKinCorr;}
\DoxyCodeLine{02202\ }
\DoxyCodeLine{02203\ \ \ \ \ \ \ KinCorrelation-\/>Write((\mbox{\hyperlink{classSampleSummary_a9ba7df41774c45a14c0a97e4accc9cc0}{SampleNames}}[SampleNum]\ +\ \textcolor{stringliteral}{"{}\_Correlation"{}}).c\_str());}
\DoxyCodeLine{02204\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ KinCorrelation;}
\DoxyCodeLine{02205\ }
\DoxyCodeLine{02206\ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{02207\ \textcolor{comment}{\ \ \ \ \ \ for\ (int\ i\ =\ 0;\ i\ <\ maxBins[SampleNum];\ ++i)}}
\DoxyCodeLine{02208\ \textcolor{comment}{\ \ \ \ \ \ \{}}
\DoxyCodeLine{02209\ \textcolor{comment}{\ \ \ \ \ \ \ \ for\ (int\ j\ =\ 0;\ j\ <=\ i;\ ++j)}}
\DoxyCodeLine{02210\ \textcolor{comment}{\ \ \ \ \ \ \ \ \{}}
\DoxyCodeLine{02211\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ //\ Skip\ the\ diagonal\ elements\ which\ we've\ already\ done\ above}}
\DoxyCodeLine{02212\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ if\ (j\ ==\ i)\ continue;}}
\DoxyCodeLine{02213\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ KinCorr[i][j]-\/>Write();}}
\DoxyCodeLine{02214\ \textcolor{comment}{\ \ \ \ \ \ \ \ \}//\ End\ j\ loop}}
\DoxyCodeLine{02215\ \textcolor{comment}{\ \ \ \ \ \ \}//\ End\ i\ loop}}
\DoxyCodeLine{02216\ \textcolor{comment}{\ \ \ \ \ \ */}}
\DoxyCodeLine{02217\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[SampleNum];\ ++i)}
\DoxyCodeLine{02218\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02219\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[SampleNum];\ ++j)}
\DoxyCodeLine{02220\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02221\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ KinCorr[i][j];}
\DoxyCodeLine{02222\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02223\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ KinCorr[i];}
\DoxyCodeLine{02224\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02225\ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ KinCorr;}
\DoxyCodeLine{02226\ \ \ \ \ \}\textcolor{comment}{//end\ loop\ over\ samples}}
\DoxyCodeLine{02227\ \ \ \}\textcolor{comment}{//end\ if\ DoPerKinemBin}}
\DoxyCodeLine{02228\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02229\ \ \ \{}
\DoxyCodeLine{02230\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Not\ calculating\ correlations\ per\ each\ kinematic\ bin"{}});}
\DoxyCodeLine{02231\ \ \ \}}
\DoxyCodeLine{02232\ }
\DoxyCodeLine{02233\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a795ac96bf6958c8a2f38c9de23c3c081}{DoByModePlots}})}
\DoxyCodeLine{02234\ \ \ \{}
\DoxyCodeLine{02235\ \ \ \ \ \textcolor{comment}{//\ Holds\ the\ total\ event\ rate\ by\ mode}}
\DoxyCodeLine{02236\ \ \ \ \ TH1D\ **\ EventHist\_ByMode\ =\ \textcolor{keyword}{new}\ TH1D*[\mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1];}
\DoxyCodeLine{02237\ }
\DoxyCodeLine{02238\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1;\ j++)}
\DoxyCodeLine{02239\ \ \ \ \ \{}
\DoxyCodeLine{02240\ \ \ \ \ \ \ std::string\ ModeName\ =\ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_abf4ac35511787907bc16ae26aa6c2a15}{GetMaCh3ModeName}}(j);}
\DoxyCodeLine{02241\ \ \ \ \ \ \ EventHist\_ByMode[j]\ =\ \textcolor{keyword}{new}\ TH1D(Form(\textcolor{stringliteral}{"{}EventHist\_\%s"{}},\ ModeName.c\_str()),\ Form(\textcolor{stringliteral}{"{}Total\ Event\ Rate\ \%s"{}},\ ModeName.c\_str()),\ 100,\ 1,\ -\/1);}
\DoxyCodeLine{02242\ \ \ \ \ \ \ EventHist\_ByMode[j]-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Total\ event\ rate"{}});}
\DoxyCodeLine{02243\ \ \ \ \ \ \ EventHist\_ByMode[j]-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Counts"{}});}
\DoxyCodeLine{02244\ \ \ \ \ \ \ EventHist\_ByMode[j]-\/>SetLineWidth(2);}
\DoxyCodeLine{02245\ \ \ \ \ \}}
\DoxyCodeLine{02246\ }
\DoxyCodeLine{02247\ \ \ \ \ \textcolor{comment}{//KS:\ Here\ we\ calculate\ total\ event\ rates\ for\ each\ mode,\ maybe\ not\ most\ efficient\ but\ can\ be\ improved\ in\ the\ future}}
\DoxyCodeLine{02248\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ it\ =\ 0;\ it\ <\ \mbox{\hyperlink{classSampleSummary_aa5c4055d4bb4dc720a4118032cdb4910}{nThrows}};\ ++it)}
\DoxyCodeLine{02249\ \ \ \ \ \{}
\DoxyCodeLine{02250\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1;\ j++)}
\DoxyCodeLine{02251\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02252\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ event\_rate\_temp\ =\ 0.;}
\DoxyCodeLine{02253\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{02254\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \#pragma\ omp\ parallel\ for\ reduction(+:event\_rate\_temp)}}
\DoxyCodeLine{02255\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \#endif}}
\DoxyCodeLine{02256\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ SampleNum\ =\ 0;\ \ SampleNum\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ SampleNum++)}
\DoxyCodeLine{02257\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02258\ \ \ \ \ \ \ \ \ \ \ event\_rate\_temp\ +=\ \mbox{\hyperlink{Structs_8cpp_ab18c6b2408d7b9021bad06d47a06ee8d}{NoOverflowIntegral}}(\mbox{\hyperlink{classSampleSummary_ab3eeac18b62f7ee3a5c943c3cd0e9b76}{MCVectorByMode}}[it][SampleNum][j]);}
\DoxyCodeLine{02259\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02260\ \ \ \ \ \ \ \ \ EventHist\_ByMode[j]-\/>Fill(event\_rate\_temp);}
\DoxyCodeLine{02261\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02262\ \ \ \ \ \}}
\DoxyCodeLine{02263\ }
\DoxyCodeLine{02264\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1;\ ++i)}
\DoxyCodeLine{02265\ \ \ \ \ \{}
\DoxyCodeLine{02266\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a0e21a2b9fd429261e378f4e505ba2f75}{MakeCutEventRate}}(EventHist\_ByMode[i],\ DataRate);}
\DoxyCodeLine{02267\ \ \ \ \ \}}
\DoxyCodeLine{02268\ }
\DoxyCodeLine{02269\ \ \ \ \ TMatrixDSym*\ ModeCorrelation\ =\ \textcolor{keyword}{new}\ TMatrixDSym(\mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1);}
\DoxyCodeLine{02270\ }
\DoxyCodeLine{02271\ \ \ \ \ TH2D***\ ModeCorr\ =\ \textcolor{keyword}{new}\ TH2D**[\mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1]();}
\DoxyCodeLine{02272\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1;\ ++i)}
\DoxyCodeLine{02273\ \ \ \ \ \{}
\DoxyCodeLine{02274\ \ \ \ \ \ \ ModeCorr[i]\ =\ \textcolor{keyword}{new}\ TH2D*[\mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1]();}
\DoxyCodeLine{02275\ }
\DoxyCodeLine{02276\ \ \ \ \ \ \ (*ModeCorrelation)(i,i)\ =\ 1.0;}
\DoxyCodeLine{02277\ }
\DoxyCodeLine{02278\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Min\_i\ =\ EventHist\_ByMode[i]-\/>GetXaxis()-\/>GetBinLowEdge(1);}
\DoxyCodeLine{02279\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Max\_i\ =\ EventHist\_ByMode[i]-\/>GetXaxis()-\/>GetBinUpEdge(EventHist\_ByMode[i]-\/>GetNbinsX()+1);}
\DoxyCodeLine{02280\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1;\ ++j)}
\DoxyCodeLine{02281\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02282\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Min\_j\ =\ EventHist\_ByMode[j]-\/>GetXaxis()-\/>GetBinLowEdge(1);}
\DoxyCodeLine{02283\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Max\_j\ =\ EventHist\_ByMode[j]-\/>GetXaxis()-\/>GetBinUpEdge(EventHist\_ByMode[j]-\/>GetNbinsX()+1);}
\DoxyCodeLine{02284\ }
\DoxyCodeLine{02285\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TH2D\ to\ hold\ the\ Correlation}}
\DoxyCodeLine{02286\ \ \ \ \ \ \ \ \ ModeCorr[i][j]\ =\ \textcolor{keyword}{new}\ TH2D(Form(\textcolor{stringliteral}{"{}ModeCorr\_\%i\_\%i"{}},i,j),\ Form(\textcolor{stringliteral}{"{}ModeCorr\_\%i\_\%i"{}},i,j),\ 70,\ Min\_i,\ Max\_i,\ 70,\ Min\_j,\ Max\_j);}
\DoxyCodeLine{02287\ \ \ \ \ \ \ \ \ ModeCorr[i][j]-\/>SetDirectory(0);}
\DoxyCodeLine{02288\ \ \ \ \ \ \ \ \ ModeCorr[i][j]-\/>SetMinimum(0);}
\DoxyCodeLine{02289\ \ \ \ \ \ \ \ \ ModeCorr[i][j]-\/>GetXaxis()-\/>SetTitle(\mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_abf4ac35511787907bc16ae26aa6c2a15}{GetMaCh3ModeName}}(i).c\_str());}
\DoxyCodeLine{02290\ \ \ \ \ \ \ \ \ ModeCorr[i][j]-\/>GetYaxis()-\/>SetTitle(\mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_abf4ac35511787907bc16ae26aa6c2a15}{GetMaCh3ModeName}}(j).c\_str());}
\DoxyCodeLine{02291\ \ \ \ \ \ \ \ \ ModeCorr[i][j]-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Events"{}});}
\DoxyCodeLine{02292\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02293\ \ \ \ \ \}}
\DoxyCodeLine{02294\ }
\DoxyCodeLine{02295\ \ \ \ \ \textcolor{comment}{//\ Now\ we\ are\ sure\ we\ have\ the\ diagonal\ elements,\ let's\ make\ the\ off-\/diagonals}}
\DoxyCodeLine{02296\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ MULTITHREAD}}
\DoxyCodeLine{02297\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ parallel\ for}}
\DoxyCodeLine{02298\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{02299\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1;\ ++i)}
\DoxyCodeLine{02300\ \ \ \ \ \{}
\DoxyCodeLine{02301\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ ++j)}
\DoxyCodeLine{02302\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02303\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ the\ diagonal\ elements\ which\ we've\ already\ done\ above}}
\DoxyCodeLine{02304\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ ==\ i)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02305\ }
\DoxyCodeLine{02306\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ it\ =\ 0;\ it\ <\ \mbox{\hyperlink{classSampleSummary_aa5c4055d4bb4dc720a4118032cdb4910}{nThrows}};\ ++it)}
\DoxyCodeLine{02307\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02308\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ Integral\_X\ =\ 0.;}
\DoxyCodeLine{02309\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ Integral\_Y\ =\ 0.;}
\DoxyCodeLine{02310\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ SampleNum\ =\ 0;\ SampleNum\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++SampleNum)}
\DoxyCodeLine{02311\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02312\ \ \ \ \ \ \ \ \ \ \ \ \ Integral\_X\ +=\ \mbox{\hyperlink{Structs_8cpp_ab18c6b2408d7b9021bad06d47a06ee8d}{NoOverflowIntegral}}(\mbox{\hyperlink{classSampleSummary_ab3eeac18b62f7ee3a5c943c3cd0e9b76}{MCVectorByMode}}[it][SampleNum][i]);}
\DoxyCodeLine{02313\ \ \ \ \ \ \ \ \ \ \ \ \ Integral\_Y\ +=\ \mbox{\hyperlink{Structs_8cpp_ab18c6b2408d7b9021bad06d47a06ee8d}{NoOverflowIntegral}}(\mbox{\hyperlink{classSampleSummary_ab3eeac18b62f7ee3a5c943c3cd0e9b76}{MCVectorByMode}}[it][SampleNum][j]);}
\DoxyCodeLine{02314\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02315\ \ \ \ \ \ \ \ \ \ \ ModeCorr[i][j]-\/>Fill(Integral\_X,\ Integral\_Y);}
\DoxyCodeLine{02316\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02317\ \ \ \ \ \ \ \ \ ModeCorr[i][j]-\/>Smooth();}
\DoxyCodeLine{02318\ }
\DoxyCodeLine{02319\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ Covariance\ for\ these\ two\ parameters}}
\DoxyCodeLine{02320\ \ \ \ \ \ \ \ \ (*ModeCorrelation)(i,j)\ =\ ModeCorr[i][j]-\/>GetCorrelationFactor();}
\DoxyCodeLine{02321\ \ \ \ \ \ \ \ \ (*ModeCorrelation)(j,i)\ =\ (*ModeCorrelation)(i,j);}
\DoxyCodeLine{02322\ }
\DoxyCodeLine{02323\ \ \ \ \ \ \ \}\textcolor{comment}{//\ End\ j\ loop}}
\DoxyCodeLine{02324\ \ \ \ \ \}\textcolor{comment}{//\ End\ i\ loop}}
\DoxyCodeLine{02325\ }
\DoxyCodeLine{02326\ \ \ \ \ TH2D*\ hModeCorr\ =\ \textcolor{keyword}{new}\ TH2D(\textcolor{stringliteral}{"{}Mode\ Correlation"{}},\ \textcolor{stringliteral}{"{}Mode\ Correlation"{}},\ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1,\ 0,\ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1,\ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1,\ 0,\ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1);}
\DoxyCodeLine{02327\ \ \ \ \ hModeCorr-\/>SetDirectory(0);}
\DoxyCodeLine{02328\ \ \ \ \ hModeCorr-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Correlation"{}});}
\DoxyCodeLine{02329\ \ \ \ \ hModeCorr-\/>SetMinimum(-\/1);}
\DoxyCodeLine{02330\ \ \ \ \ hModeCorr-\/>SetMaximum(1);}
\DoxyCodeLine{02331\ \ \ \ \ hModeCorr-\/>GetXaxis()-\/>SetLabelSize(0.015);}
\DoxyCodeLine{02332\ \ \ \ \ hModeCorr-\/>GetYaxis()-\/>SetLabelSize(0.015);}
\DoxyCodeLine{02333\ }
\DoxyCodeLine{02334\ \ \ \ \ \textcolor{comment}{//\ Loop\ over\ the\ Covariance\ matrix\ entries}}
\DoxyCodeLine{02335\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1;\ ++i)}
\DoxyCodeLine{02336\ \ \ \ \ \{}
\DoxyCodeLine{02337\ \ \ \ \ \ \ hModeCorr-\/>GetXaxis()-\/>SetBinLabel(i+1,\ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_abf4ac35511787907bc16ae26aa6c2a15}{GetMaCh3ModeName}}(i).c\_str());}
\DoxyCodeLine{02338\ }
\DoxyCodeLine{02339\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1;\ ++j)}
\DoxyCodeLine{02340\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02341\ \ \ \ \ \ \ \ \ hModeCorr-\/>GetYaxis()-\/>SetBinLabel(j+1,\ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_abf4ac35511787907bc16ae26aa6c2a15}{GetMaCh3ModeName}}(j).c\_str());}
\DoxyCodeLine{02342\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ value\ of\ the\ Covariance}}
\DoxyCodeLine{02343\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ corr\ =\ (*ModeCorrelation)(i,j);}
\DoxyCodeLine{02344\ \ \ \ \ \ \ \ \ hModeCorr-\/>SetBinContent(i+1,\ j+1,\ corr);}
\DoxyCodeLine{02345\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02346\ \ \ \ \ \}}
\DoxyCodeLine{02347\ \ \ \ \ hModeCorr-\/>Draw(\textcolor{stringliteral}{"{}colz"{}});}
\DoxyCodeLine{02348\ \ \ \ \ hModeCorr-\/>Write(\textcolor{stringliteral}{"{}Mode\_Corr"{}});}
\DoxyCodeLine{02349\ \ \ \ \ \textcolor{keyword}{delete}\ hModeCorr;}
\DoxyCodeLine{02350\ }
\DoxyCodeLine{02351\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1;\ ++i)}
\DoxyCodeLine{02352\ \ \ \ \ \{}
\DoxyCodeLine{02353\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <=\ i;\ ++j)}
\DoxyCodeLine{02354\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02355\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ the\ diagonal\ elements\ which\ we've\ already\ done\ above}}
\DoxyCodeLine{02356\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j\ ==\ i)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{02357\ \ \ \ \ \ \ \ \ ModeCorr[i][j]-\/>Write();}
\DoxyCodeLine{02358\ \ \ \ \ \ \ \}\textcolor{comment}{//\ End\ j\ loop}}
\DoxyCodeLine{02359\ \ \ \ \ \}\textcolor{comment}{//\ End\ i\ loop}}
\DoxyCodeLine{02360\ }
\DoxyCodeLine{02361\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1;\ ++i)}
\DoxyCodeLine{02362\ \ \ \ \ \{}
\DoxyCodeLine{02363\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1;\ ++j)}
\DoxyCodeLine{02364\ \ \ \ \ \ \ \{}
\DoxyCodeLine{02365\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ ModeCorr[i][j];}
\DoxyCodeLine{02366\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02367\ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ ModeCorr[i];}
\DoxyCodeLine{02368\ \ \ \ \ \}}
\DoxyCodeLine{02369\ \ \ \ \ \textcolor{keyword}{delete}[]\ ModeCorr;}
\DoxyCodeLine{02370\ \ \ \ \ ModeCorrelation-\/>Write(\textcolor{stringliteral}{"{}Mode\_Correlation"{}});}
\DoxyCodeLine{02371\ \ \ \ \ \textcolor{keyword}{delete}\ ModeCorrelation;}
\DoxyCodeLine{02372\ }
\DoxyCodeLine{02373\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1;\ j++)}
\DoxyCodeLine{02374\ \ \ \ \ \{}
\DoxyCodeLine{02375\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ EventHist\_ByMode[j];}
\DoxyCodeLine{02376\ \ \ \ \ \}}
\DoxyCodeLine{02377\ \ \ \ \ \textcolor{keyword}{delete}[]\ EventHist\_ByMode;}
\DoxyCodeLine{02378\ \ \ \}}
\DoxyCodeLine{02379\ }
\DoxyCodeLine{02380\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++i)}
\DoxyCodeLine{02381\ \ \ \{}
\DoxyCodeLine{02382\ \ \ \ \ \textcolor{keyword}{delete}\ SumHist[i];}
\DoxyCodeLine{02383\ \ \ \}}
\DoxyCodeLine{02384\ \ \ \textcolor{keyword}{delete}[]\ SumHist;}
\DoxyCodeLine{02385\ }
\DoxyCodeLine{02386\ \ \ CorrDir-\/>Close();}
\DoxyCodeLine{02387\ \ \ \textcolor{keyword}{delete}\ CorrDir;}
\DoxyCodeLine{02388\ }
\DoxyCodeLine{02389\ \ \ timer.Stop();}
\DoxyCodeLine{02390\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Calculating\ correlations\ took\ \ \{:.2f\}s"{}},\ timer.RealTime());}
\DoxyCodeLine{02391\ \ \ \mbox{\hyperlink{classSampleSummary_aa7b948f290517a052f04f61dfa6af68f}{Outputfile}}-\/>cd();}
\DoxyCodeLine{02392\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{classSampleSummary_aacf987756d2024868bf28b9c2c4a5a99}\label{classSampleSummary_aacf987756d2024868bf28b9c2c4a5a99}} 
\index{SampleSummary@{SampleSummary}!Write@{Write}}
\index{Write@{Write}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{Write()}{Write()}}
{\footnotesize\ttfamily void Sample\+Summary\+::\+Write (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



KS\+: Write results into root file. 



Definition at line \mbox{\hyperlink{SampleSummary_8cpp_source_l00759}{759}} of file \mbox{\hyperlink{SampleSummary_8cpp_source}{Sample\+Summary.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00759\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00760\ \textcolor{comment}{//\ *******************}}
\DoxyCodeLine{00761\ }
\DoxyCodeLine{00762\ \ \ \textcolor{comment}{//\ Prepare\ the\ output\ tree}}
\DoxyCodeLine{00763\ \ \ \mbox{\hyperlink{classSampleSummary_a7b87a7ce0c38e968fb841f228aea7212}{PrepareOutput}}();}
\DoxyCodeLine{00764\ }
\DoxyCodeLine{00765\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Summarising\ \{\}\ throws..."{}},\ \mbox{\hyperlink{classSampleSummary_aa5c4055d4bb4dc720a4118032cdb4910}{nThrows}});}
\DoxyCodeLine{00766\ \ \ \textcolor{comment}{//\ After\ all\ the\ throws\ are\ added\ finalise\ the\ sample}}
\DoxyCodeLine{00767\ \ \ TStopwatch\ timer;}
\DoxyCodeLine{00768\ \ \ timer.Start();}
\DoxyCodeLine{00769\ \ \ \mbox{\hyperlink{classSampleSummary_a44baf8959ced974c9a0b8ae640c336bd}{MakePredictive}}();}
\DoxyCodeLine{00770\ \ \ timer.Stop();}
\DoxyCodeLine{00771\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Made\ Prior/Posterior\ Predictive,\ it\ took\ \{\}s,\ now\ writing..."{}},\ timer.RealTime());}
\DoxyCodeLine{00772\ }
\DoxyCodeLine{00773\ \ \ \textcolor{comment}{//\ Study\ Bayesian\ Information\ Criterion}}
\DoxyCodeLine{00774\ \ \ \mbox{\hyperlink{classSampleSummary_a3560f062913ea70912e7b9a1cb93e2a5}{StudyBIC}}();}
\DoxyCodeLine{00775\ }
\DoxyCodeLine{00776\ \ \ \textcolor{comment}{//\ Study\ Deviance\ Information\ Criterion}}
\DoxyCodeLine{00777\ \ \ \mbox{\hyperlink{classSampleSummary_a8e73fe07b8b8dfb1e2ee9245df4e7a4b}{StudyDIC}}();}
\DoxyCodeLine{00778\ }
\DoxyCodeLine{00779\ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Write();}
\DoxyCodeLine{00780\ }
\DoxyCodeLine{00781\ \ \ \textcolor{comment}{//\ Make\ the\ various\ distributions}}
\DoxyCodeLine{00782\ \ \ \mbox{\hyperlink{classSampleSummary_a086c2804cf7c1af54784d856c4351de8}{lnLHist}}-\/>Write();}
\DoxyCodeLine{00783\ \ \ \mbox{\hyperlink{classSampleSummary_a77da9dc0abfc381a526e3ceac9453f80}{lnLHist\_drawfluc}}-\/>Write();}
\DoxyCodeLine{00784\ \ \ \mbox{\hyperlink{classSampleSummary_a6c8b2e34255d1c109b5172ddcf5e9fcd}{lnLHist\_drawflucdraw}}-\/>Write();}
\DoxyCodeLine{00785\ \ \ \mbox{\hyperlink{classSampleSummary_af4240300eba39917dee195fd2b37c5d9}{lnLHist\_drawdata}}-\/>Write();}
\DoxyCodeLine{00786\ \ \ \mbox{\hyperlink{classSampleSummary_a653e0d84096e0acdb3e392c2a68077e9}{lnLDrawHist}}-\/>Write();}
\DoxyCodeLine{00787\ \ \ \mbox{\hyperlink{classSampleSummary_a6f7c55987330d006555b44010e54d8b0}{lnLFlucHist}}-\/>Write();}
\DoxyCodeLine{00788\ \ \ \mbox{\hyperlink{classSampleSummary_a7cee72732c2a3e242e5ed723e4b206c9}{lnLDrawHistRate}}-\/>Write();}
\DoxyCodeLine{00789\ \ \ \textcolor{comment}{//KS:\ Only\ available\ for\ Posterior\ Predictive}}
\DoxyCodeLine{00790\ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{classSampleSummary_adb737e335e68edeb14a6ce2ca112dc8c}{isPriorPredictive}})\ \mbox{\hyperlink{classSampleSummary_a07ea4bf6cf23214263ec63cd69de49c1}{RandomHist}}-\/>Write();}
\DoxyCodeLine{00791\ }
\DoxyCodeLine{00792\ \ \ \mbox{\hyperlink{classSampleSummary_a40f5c789dbf8ad9c8a4af401343af474}{lnLFlucHist\_ProjectX}}-\/>Write();}
\DoxyCodeLine{00793\ \ \ }
\DoxyCodeLine{00794\ \ \ \textcolor{comment}{//\ Loop\ over\ each\ sample\ and\ write\ to\ file}}
\DoxyCodeLine{00795\ \ \ \textcolor{comment}{//KS:\ Multithreading\ is\ tempting\ here\ but\ we\ also\ write\ to\ ROOT\ file,\ separating\ all\ LLH\ and\ poly\ projections\ from\ write\ could\ work\ well}}
\DoxyCodeLine{00796\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}{nSamples}};\ ++i)}
\DoxyCodeLine{00797\ \ \ \{}
\DoxyCodeLine{00798\ \ \ \ \ \ \textcolor{comment}{//\ Skip\ the\ null\ histograms}}
\DoxyCodeLine{00799\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i]\ ==\ NULL\ ||\ \mbox{\hyperlink{Structs_8cpp_ab18c6b2408d7b9021bad06d47a06ee8d}{NoOverflowIntegral}}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i])\ ==\ 0)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00800\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a916c6d1f50b54f1f4509622359b2a1b7}{Dir}}[i]-\/>cd();}
\DoxyCodeLine{00801\ }
\DoxyCodeLine{00802\ \ \ \ \ \textcolor{comment}{//\ Make\ the\ data/MC\ ratio\ histogram}}
\DoxyCodeLine{00803\ \ \ \ \ TH2Poly\ *RatioHistMean\ =\ \mbox{\hyperlink{classSampleSummary_a6d7ad3d2ee9868e80548b8a73299bd5b}{RatioPolys}}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i],\ \mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[i]);}
\DoxyCodeLine{00804\ \ \ \ \ RatioHistMean-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Data/Mean"{}});}
\DoxyCodeLine{00805\ \ \ \ \ TH2Poly\ *RatioHistMode\ =\ \mbox{\hyperlink{classSampleSummary_a6d7ad3d2ee9868e80548b8a73299bd5b}{RatioPolys}}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i],\ \mbox{\hyperlink{classSampleSummary_a59475a0c9460277914402850372727ea}{ModeHist}}[i]);}
\DoxyCodeLine{00806\ \ \ \ \ RatioHistMode-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Data/Mode"{}});}
\DoxyCodeLine{00807\ \ \ \ \ TH2Poly\ *RatioHistNom\ =\ \mbox{\hyperlink{classSampleSummary_a6d7ad3d2ee9868e80548b8a73299bd5b}{RatioPolys}}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i],\ \mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i]);}
\DoxyCodeLine{00808\ \ \ \ \ RatioHistNom-\/>GetZaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}Data/Nom"{}});}
\DoxyCodeLine{00809\ }
\DoxyCodeLine{00810\ \ \ \ \ \textcolor{comment}{//\ And\ the\ normalised\ data\ histogram}}
\DoxyCodeLine{00811\ \ \ \ \ TH2Poly\ *DataNormHist\ =\ \mbox{\hyperlink{Structs_8cpp_ae28c217f8e8591248bfa54e95fdd7741}{NormalisePoly}}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i]);}
\DoxyCodeLine{00812\ \ \ \ \ \textcolor{comment}{//\ Last\ true\ refers\ to\ if\ project\ along\ x\ or\ y}}
\DoxyCodeLine{00813\ \ \ \ \ TH2Poly\ *MeanNormHist\ =\ \mbox{\hyperlink{Structs_8cpp_ae28c217f8e8591248bfa54e95fdd7741}{NormalisePoly}}(\mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[i]);}
\DoxyCodeLine{00814\ \ \ \ \ TH2Poly\ *ModeNormHist\ =\ \mbox{\hyperlink{Structs_8cpp_ae28c217f8e8591248bfa54e95fdd7741}{NormalisePoly}}(\mbox{\hyperlink{classSampleSummary_a59475a0c9460277914402850372727ea}{ModeHist}}[i]);}
\DoxyCodeLine{00815\ \ \ \ \ TH1D\ *MeanProjectX\ =\ \mbox{\hyperlink{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}{ProjectPoly}}(\mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[i],\ \textcolor{keyword}{true},\ i,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00816\ \ \ \ \ TH1D\ *MeanProjectY\ =\ \mbox{\hyperlink{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}{ProjectPoly}}(\mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[i],\ \textcolor{keyword}{false},\ i,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00817\ \ \ \ \ TH1D\ *ModeProjectX\ =\ \mbox{\hyperlink{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}{ProjectPoly}}(\mbox{\hyperlink{classSampleSummary_a59475a0c9460277914402850372727ea}{ModeHist}}[i],\ \textcolor{keyword}{true},\ i,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00818\ \ \ \ \ TH1D\ *ModeProjectY\ =\ \mbox{\hyperlink{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}{ProjectPoly}}(\mbox{\hyperlink{classSampleSummary_a59475a0c9460277914402850372727ea}{ModeHist}}[i],\ \textcolor{keyword}{false},\ i,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00819\ }
\DoxyCodeLine{00820\ \ \ \ \ TH1D\ *MeanHistCorrectedProjectX\ =\ NULL;}
\DoxyCodeLine{00821\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}})\ MeanHistCorrectedProjectX\ =\ \mbox{\hyperlink{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}{ProjectPoly}}(\mbox{\hyperlink{classSampleSummary_a805cc2be1298a385160deaa03269313a}{MeanHistCorrected}}[i],\ \textcolor{keyword}{true},\ i,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00822\ \ \ \ \ TH1D\ *MeanHistCorrectedProjectY\ =\ NULL;}
\DoxyCodeLine{00823\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}})\ MeanHistCorrectedProjectY\ =\ \mbox{\hyperlink{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}{ProjectPoly}}(\mbox{\hyperlink{classSampleSummary_a805cc2be1298a385160deaa03269313a}{MeanHistCorrected}}[i],\ \textcolor{keyword}{false},\ i,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00824\ }
\DoxyCodeLine{00825\ \ \ \ \ TH1D\ *W2MeanProjectX\ =\ \mbox{\hyperlink{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}{ProjectPoly}}(\mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2MeanHist}}[i],\ \textcolor{keyword}{true},\ i);}
\DoxyCodeLine{00826\ \ \ \ \ TH1D\ *W2MeanProjectY\ =\ \mbox{\hyperlink{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}{ProjectPoly}}(\mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2MeanHist}}[i],\ \textcolor{keyword}{false},\ i);}
\DoxyCodeLine{00827\ \ \ \ \ TH1D\ *W2ModeProjectX\ =\ \mbox{\hyperlink{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}{ProjectPoly}}(\mbox{\hyperlink{classSampleSummary_accde7a80fb4c8b986d1a152f88e8f515}{W2ModeHist}}[i],\ \textcolor{keyword}{true},\ i);}
\DoxyCodeLine{00828\ \ \ \ \ TH1D\ *W2ModeProjectY\ =\ \mbox{\hyperlink{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}{ProjectPoly}}(\mbox{\hyperlink{classSampleSummary_accde7a80fb4c8b986d1a152f88e8f515}{W2ModeHist}}[i],\ \textcolor{keyword}{false},\ i);}
\DoxyCodeLine{00829\ }
\DoxyCodeLine{00830\ \ \ \ \ TH2Poly\ *NomNormHist\ =\ \mbox{\hyperlink{Structs_8cpp_ae28c217f8e8591248bfa54e95fdd7741}{NormalisePoly}}(\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i]);}
\DoxyCodeLine{00831\ \ \ \ \ TH1D\ *NomProjectX\ =\ \mbox{\hyperlink{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}{ProjectPoly}}(\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i],\ \textcolor{keyword}{true},\ i);}
\DoxyCodeLine{00832\ \ \ \ \ TH1D\ *NomProjectY\ =\ \mbox{\hyperlink{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}{ProjectPoly}}(\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i],\ \textcolor{keyword}{false},\ i);}
\DoxyCodeLine{00833\ }
\DoxyCodeLine{00834\ \ \ \ \ TH1D\ *W2NomProjectX\ =\ \mbox{\hyperlink{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}{ProjectPoly}}(\mbox{\hyperlink{classSampleSummary_a8219b4f8763481e16c6b4493f97378cb}{W2NomHist}}[i],\ \textcolor{keyword}{true},\ i);}
\DoxyCodeLine{00835\ \ \ \ \ TH1D\ *W2NomProjectY\ =\ \mbox{\hyperlink{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}{ProjectPoly}}(\mbox{\hyperlink{classSampleSummary_a8219b4f8763481e16c6b4493f97378cb}{W2NomHist}}[i],\ \textcolor{keyword}{false},\ i);}
\DoxyCodeLine{00836\ }
\DoxyCodeLine{00837\ \ \ \ \ \textcolor{comment}{//\ Same\ for\ the\ TH2Ds}}
\DoxyCodeLine{00838\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a197d9d30abc14a76d65bd876b28cca32}{CalcLLH}}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i],\ \mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i],\ \mbox{\hyperlink{classSampleSummary_a8219b4f8763481e16c6b4493f97378cb}{W2NomHist}}[i]);}
\DoxyCodeLine{00839\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a197d9d30abc14a76d65bd876b28cca32}{CalcLLH}}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i],\ \mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[i],\ \mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2MeanHist}}[i]);}
\DoxyCodeLine{00840\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a197d9d30abc14a76d65bd876b28cca32}{CalcLLH}}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i],\ \mbox{\hyperlink{classSampleSummary_a59475a0c9460277914402850372727ea}{ModeHist}}[i],\ \mbox{\hyperlink{classSampleSummary_accde7a80fb4c8b986d1a152f88e8f515}{W2ModeHist}}[i]);}
\DoxyCodeLine{00841\ }
\DoxyCodeLine{00842\ \ \ \ \ \textcolor{comment}{//\ Calculate\ the\ log\ likelihood\ for\ the\ 1D\ dists}}
\DoxyCodeLine{00843\ \ \ \ \ \textcolor{comment}{//\ Sets\ the\ title\ of\ the\ second\ TH1D\ to\ the\ -\/2LLH}}
\DoxyCodeLine{00844\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a197d9d30abc14a76d65bd876b28cca32}{CalcLLH}}(\mbox{\hyperlink{classSampleSummary_aed3d754bfa3b870ba2676748d1420b5f}{DataHist\_ProjectX}}[i],\ NomProjectX,\ W2NomProjectX);}
\DoxyCodeLine{00845\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a197d9d30abc14a76d65bd876b28cca32}{CalcLLH}}(\mbox{\hyperlink{classSampleSummary_aed3d754bfa3b870ba2676748d1420b5f}{DataHist\_ProjectX}}[i],\ MeanProjectX,\ W2MeanProjectX);}
\DoxyCodeLine{00846\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a197d9d30abc14a76d65bd876b28cca32}{CalcLLH}}(\mbox{\hyperlink{classSampleSummary_aed3d754bfa3b870ba2676748d1420b5f}{DataHist\_ProjectX}}[i],\ ModeProjectX,\ W2ModeProjectX);}
\DoxyCodeLine{00847\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a197d9d30abc14a76d65bd876b28cca32}{CalcLLH}}(\mbox{\hyperlink{classSampleSummary_abb300b204c11a5542efa5d28510d0860}{DataHist\_ProjectY}}[i],\ NomProjectY,\ W2NomProjectY);}
\DoxyCodeLine{00848\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a197d9d30abc14a76d65bd876b28cca32}{CalcLLH}}(\mbox{\hyperlink{classSampleSummary_abb300b204c11a5542efa5d28510d0860}{DataHist\_ProjectY}}[i],\ MeanProjectY,\ W2MeanProjectY);}
\DoxyCodeLine{00849\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a197d9d30abc14a76d65bd876b28cca32}{CalcLLH}}(\mbox{\hyperlink{classSampleSummary_abb300b204c11a5542efa5d28510d0860}{DataHist\_ProjectY}}[i],\ ModeProjectY,\ W2ModeProjectY);}
\DoxyCodeLine{00850\ }
\DoxyCodeLine{00851\ \ \ \ \ std::string\ SampleName\ =\ \mbox{\hyperlink{classSampleSummary_a9ba7df41774c45a14c0a97e4accc9cc0}{SampleNames}}[i];}
\DoxyCodeLine{00852\ \ \ \ \ \textcolor{comment}{//\ Also\ strip\ out\ -\/\ signs\ because\ it\ messes\ up\ TBranches}}
\DoxyCodeLine{00853\ \ \ \ \ \textcolor{keywordflow}{while}\ (SampleName.find(\textcolor{stringliteral}{"{}-\/"{}})\ !=\ std::string::npos)\ \{}
\DoxyCodeLine{00854\ \ \ \ \ \ \ SampleName.replace(SampleName.find(\textcolor{stringliteral}{"{}-\/"{}}),\ 1,\ std::string(\textcolor{stringliteral}{"{}\_"{}}));}
\DoxyCodeLine{00855\ \ \ \ \ \}\ }
\DoxyCodeLine{00856\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Draw((SampleName+\textcolor{stringliteral}{"{}\_data\_draw:"{}}+SampleName+\textcolor{stringliteral}{"{}\_drawfluc\_draw>>htemp"{}}).c\_str());}
\DoxyCodeLine{00857\ \ \ \ \ TH2D\ *TempHistogram\ =\ \textcolor{keyword}{static\_cast<}TH2D*\textcolor{keyword}{>}(gDirectory-\/>Get(\textcolor{stringliteral}{"{}htemp"{}})-\/>Clone());}
\DoxyCodeLine{00858\ \ \ \ \ TempHistogram-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}-\/2LLH(Draw\ Fluc,\ Draw)"{}});}
\DoxyCodeLine{00859\ \ \ \ \ TempHistogram-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}-\/2LLH(Data,\ Draw)"{}});}
\DoxyCodeLine{00860\ \ \ \ \ TempHistogram-\/>SetNameTitle((\mbox{\hyperlink{classSampleSummary_a9ba7df41774c45a14c0a97e4accc9cc0}{SampleNames}}[i]+\textcolor{stringliteral}{"{}\_drawfluc\_draw"{}}).c\_str(),\ (\mbox{\hyperlink{classSampleSummary_a9ba7df41774c45a14c0a97e4accc9cc0}{SampleNames}}[i]+\textcolor{stringliteral}{"{}\_drawfluc\_draw"{}}).c\_str());}
\DoxyCodeLine{00861\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a24fff19d07a5b11c9c4149a45d0265cd}{MakeCutLLH2D}}(TempHistogram);}
\DoxyCodeLine{00862\ \ \ \ \ TempHistogram-\/>Write();}
\DoxyCodeLine{00863\ \ \ \ \ \textcolor{keyword}{delete}\ TempHistogram;}
\DoxyCodeLine{00864\ }
\DoxyCodeLine{00865\ \ \ \ \ \textcolor{comment}{//\ Also\ write\ the\ 2D\ histograms\ for\ the\ p-\/value}}
\DoxyCodeLine{00866\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Draw((SampleName+\textcolor{stringliteral}{"{}\_data\_draw:"{}}+SampleName+\textcolor{stringliteral}{"{}\_predfluc\_draw>>htemp2"{}}).c\_str());}
\DoxyCodeLine{00867\ \ \ \ \ TH2D\ *TempHistogram2\ =\ \textcolor{keyword}{static\_cast<}TH2D*\textcolor{keyword}{>}(gDirectory-\/>Get(\textcolor{stringliteral}{"{}htemp2"{}})-\/>Clone());}
\DoxyCodeLine{00868\ \ \ \ \ TempHistogram2-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}-\/2LLH(Pred\ Fluc,\ Draw)"{}});}
\DoxyCodeLine{00869\ \ \ \ \ TempHistogram2-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}-\/2LLH(Data,\ Draw)"{}});}
\DoxyCodeLine{00870\ \ \ \ \ TempHistogram2-\/>SetNameTitle((\mbox{\hyperlink{classSampleSummary_a9ba7df41774c45a14c0a97e4accc9cc0}{SampleNames}}[i]+\textcolor{stringliteral}{"{}\_predfluc\_draw"{}}).c\_str(),\ (\mbox{\hyperlink{classSampleSummary_a9ba7df41774c45a14c0a97e4accc9cc0}{SampleNames}}[i]+\textcolor{stringliteral}{"{}\_predfluc\_draw"{}}).c\_str());}
\DoxyCodeLine{00871\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a24fff19d07a5b11c9c4149a45d0265cd}{MakeCutLLH2D}}(TempHistogram2);}
\DoxyCodeLine{00872\ \ \ \ \ TempHistogram2-\/>Write();}
\DoxyCodeLine{00873\ \ \ \ \ \textcolor{keyword}{delete}\ TempHistogram2;}
\DoxyCodeLine{00874\ \ \ \ }
\DoxyCodeLine{00875\ \ \ \ \ \textcolor{comment}{//\ finally\ p-\/value\ for\ 1D\ projection}}
\DoxyCodeLine{00876\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Draw((SampleName+\textcolor{stringliteral}{"{}\_rate\_data\_draw:"{}}+SampleName+\textcolor{stringliteral}{"{}\_rate\_predfluc\_draw>>htemp3"{}}).c\_str());}
\DoxyCodeLine{00877\ \ \ \ \ TH2D\ *TempHistogram3\ =\ \textcolor{keyword}{static\_cast<}TH2D*\textcolor{keyword}{>}(gDirectory-\/>Get(\textcolor{stringliteral}{"{}htemp3"{}})-\/>Clone());}
\DoxyCodeLine{00878\ \ \ \ \ TempHistogram3-\/>GetXaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}-\/2LLH(Pred\ Fluc,\ Draw)"{}});}
\DoxyCodeLine{00879\ \ \ \ \ TempHistogram3-\/>GetYaxis()-\/>SetTitle(\textcolor{stringliteral}{"{}-\/2LLH(Data,\ Draw)"{}});}
\DoxyCodeLine{00880\ \ \ \ \ TempHistogram3-\/>SetNameTitle((\mbox{\hyperlink{classSampleSummary_a9ba7df41774c45a14c0a97e4accc9cc0}{SampleNames}}[i]+\textcolor{stringliteral}{"{}\_rate\_predfluc\_draw"{}}).c\_str(),\ (\mbox{\hyperlink{classSampleSummary_a9ba7df41774c45a14c0a97e4accc9cc0}{SampleNames}}[i]+\textcolor{stringliteral}{"{}\_rate\_predfluc\_draw"{}}).c\_str());}
\DoxyCodeLine{00881\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a24fff19d07a5b11c9c4149a45d0265cd}{MakeCutLLH2D}}(TempHistogram3);}
\DoxyCodeLine{00882\ \ \ \ \ TempHistogram3-\/>Write();}
\DoxyCodeLine{00883\ \ \ \ \ \textcolor{keyword}{delete}\ TempHistogram3;}
\DoxyCodeLine{00884\ }
\DoxyCodeLine{00885\ \ \ \ \ \textcolor{comment}{//\ finally\ p-\/value\ for\ 1D\ projection}}
\DoxyCodeLine{00886\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}{OutputTree}}-\/>Draw((SampleName+\textcolor{stringliteral}{"{}\_data\_draw\_ProjectX:"{}}+SampleName+\textcolor{stringliteral}{"{}\_drawfluc\_draw\_ProjectX>>htemp4"{}}).c\_str());}
\DoxyCodeLine{00887\ \ \ \ \ TH2D\ *TempHistogram4\ =\ \textcolor{keyword}{static\_cast<}TH2D*\textcolor{keyword}{>}(gDirectory-\/>Get(\textcolor{stringliteral}{"{}htemp4"{}})-\/>Clone());}
\DoxyCodeLine{00888\ \ \ \ \ TempHistogram4-\/>GetXaxis()-\/>SetTitle((\textcolor{stringliteral}{"{}-\/2LLH\_\{Draw\ Fluc,\ Draw\}\ for\ "{}}\ +\ \mbox{\hyperlink{classSampleSummary_abd938805245ca6cfeb8c49363f5ff11c}{SamplePDF}}-\/>\mbox{\hyperlink{classsamplePDFBase_a2c02e6a8107a0fd8b9deed6d98015ba3}{GetKinVarLabel}}(i,\ 0)).c\_str());}
\DoxyCodeLine{00889\ \ \ \ \ TempHistogram4-\/>GetYaxis()-\/>SetTitle((\textcolor{stringliteral}{"{}-\/2LLH\_\{Data,\ Draw\}\ for\ "{}}\ +\ \mbox{\hyperlink{classSampleSummary_abd938805245ca6cfeb8c49363f5ff11c}{SamplePDF}}-\/>\mbox{\hyperlink{classsamplePDFBase_a2c02e6a8107a0fd8b9deed6d98015ba3}{GetKinVarLabel}}(i,\ 0)).c\_str());}
\DoxyCodeLine{00890\ \ \ \ \ TempHistogram4-\/>SetNameTitle((\mbox{\hyperlink{classSampleSummary_a9ba7df41774c45a14c0a97e4accc9cc0}{SampleNames}}[i]+\textcolor{stringliteral}{"{}\_drawfluc\_draw\_ProjectX"{}}).c\_str(),\ (\mbox{\hyperlink{classSampleSummary_a9ba7df41774c45a14c0a97e4accc9cc0}{SampleNames}}[i]+\textcolor{stringliteral}{"{}\_drawfluc\_draw\_ProjectX"{}}).c\_str());}
\DoxyCodeLine{00891\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a24fff19d07a5b11c9c4149a45d0265cd}{MakeCutLLH2D}}(TempHistogram4);}
\DoxyCodeLine{00892\ \ \ \ \ TempHistogram4-\/>Write();}
\DoxyCodeLine{00893\ \ \ \ \ \textcolor{keyword}{delete}\ TempHistogram4;}
\DoxyCodeLine{00894\ \ \ \ \ }
\DoxyCodeLine{00895\ \ \ \ \ \textcolor{comment}{//\ Write\ the\ Histograms\ to\ each\ folder}}
\DoxyCodeLine{00896\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i]-\/>Write();}
\DoxyCodeLine{00897\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i]-\/>Write();}
\DoxyCodeLine{00898\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[i]-\/>Write();}
\DoxyCodeLine{00899\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a59475a0c9460277914402850372727ea}{ModeHist}}[i]-\/>Write();}
\DoxyCodeLine{00900\ \ \ \ \ RatioHistMean-\/>Write();}
\DoxyCodeLine{00901\ \ \ \ \ RatioHistMode-\/>Write();}
\DoxyCodeLine{00902\ \ \ \ \ RatioHistNom-\/>Write();}
\DoxyCodeLine{00903\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}})\ \mbox{\hyperlink{classSampleSummary_a805cc2be1298a385160deaa03269313a}{MeanHistCorrected}}[i]-\/>Write();}
\DoxyCodeLine{00904\ }
\DoxyCodeLine{00905\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a8219b4f8763481e16c6b4493f97378cb}{W2NomHist}}[i]-\/>Write();}
\DoxyCodeLine{00906\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2MeanHist}}[i]-\/>Write();}
\DoxyCodeLine{00907\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_accde7a80fb4c8b986d1a152f88e8f515}{W2ModeHist}}[i]-\/>Write();}
\DoxyCodeLine{00908\ }
\DoxyCodeLine{00909\ \ \ \ \ DataNormHist-\/>Write();}
\DoxyCodeLine{00910\ \ \ \ \ NomNormHist-\/>Write();}
\DoxyCodeLine{00911\ \ \ \ \ MeanNormHist-\/>Write();}
\DoxyCodeLine{00912\ \ \ \ \ ModeNormHist-\/>Write();}
\DoxyCodeLine{00913\ }
\DoxyCodeLine{00914\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_aed3d754bfa3b870ba2676748d1420b5f}{DataHist\_ProjectX}}[i]-\/>Write();}
\DoxyCodeLine{00915\ \ \ \ \ NomProjectX-\/>Write();}
\DoxyCodeLine{00916\ \ \ \ \ MeanProjectX-\/>Write();}
\DoxyCodeLine{00917\ \ \ \ \ ModeProjectX-\/>Write();}
\DoxyCodeLine{00918\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}})\ MeanHistCorrectedProjectX-\/>Write();}
\DoxyCodeLine{00919\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a7176dc4fd5368e01f00d5fcc909ee605}{ViolinHists\_ProjectX}}[i]-\/>Write();}
\DoxyCodeLine{00920\ \ \ \ \ }
\DoxyCodeLine{00921\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_abb300b204c11a5542efa5d28510d0860}{DataHist\_ProjectY}}[i]-\/>Write();}
\DoxyCodeLine{00922\ \ \ \ \ NomProjectY-\/>Write();}
\DoxyCodeLine{00923\ \ \ \ \ MeanProjectY-\/>Write();}
\DoxyCodeLine{00924\ \ \ \ \ ModeProjectY-\/>Write();}
\DoxyCodeLine{00925\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}})\ MeanHistCorrectedProjectY-\/>Write();}
\DoxyCodeLine{00926\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_af4447b09538a0138de4e11c81169f821}{ViolinHists\_ProjectY}}[i]-\/>Write();}
\DoxyCodeLine{00927\ }
\DoxyCodeLine{00928\ \ \ \ \ W2NomProjectX-\/>Write();}
\DoxyCodeLine{00929\ \ \ \ \ W2MeanProjectX-\/>Write();}
\DoxyCodeLine{00930\ \ \ \ \ W2ModeProjectX-\/>Write();}
\DoxyCodeLine{00931\ }
\DoxyCodeLine{00932\ \ \ \ \ W2NomProjectY-\/>Write();}
\DoxyCodeLine{00933\ \ \ \ \ W2MeanProjectY-\/>Write();}
\DoxyCodeLine{00934\ \ \ \ \ W2ModeProjectY-\/>Write();}
\DoxyCodeLine{00935\ \ \ \ \ }
\DoxyCodeLine{00936\ \ \ \ \ \textcolor{comment}{//KS:\ This\ will\ dump\ lots\ of\ hists,\ use\ it\ only\ for\ debugging}}
\DoxyCodeLine{00937\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a807e348a85fb460c5ca4a1ce56d08aab}{Debug}}\ >\ 0)}
\DoxyCodeLine{00938\ \ \ \ \ \{}
\DoxyCodeLine{00939\ \ \ \ \ \ \ TDirectory*\ DebugDir\ =\ \mbox{\hyperlink{classSampleSummary_a916c6d1f50b54f1f4509622359b2a1b7}{Dir}}[i]-\/>mkdir(\textcolor{stringliteral}{"{}Debug"{}});}
\DoxyCodeLine{00940\ \ \ \ \ \ \ DebugDir-\/>cd();}
\DoxyCodeLine{00941\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ b\ =\ 1;\ b\ <=\ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[i];\ ++b)}
\DoxyCodeLine{00942\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00943\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[i][b]-\/>Write();}
\DoxyCodeLine{00944\ \ \ \ \ \ \ \ \ std::string\ Title\ =\ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[i][b]-\/>GetName();}
\DoxyCodeLine{00945\ }
\DoxyCodeLine{00946\ \ \ \ \ \ \ \ \ TLine\ *TempLine\ =\ \textcolor{keyword}{new}\ TLine(\mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i]-\/>GetBinContent(b),\ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[i][b]-\/>GetMinimum(),\ \mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i]-\/>GetBinContent(b),\ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[i][b]-\/>GetMaximum());}
\DoxyCodeLine{00947\ \ \ \ \ \ \ \ \ TempLine-\/>SetLineColor(kRed);}
\DoxyCodeLine{00948\ \ \ \ \ \ \ \ \ TempLine-\/>SetLineWidth(2);}
\DoxyCodeLine{00949\ }
\DoxyCodeLine{00950\ \ \ \ \ \ \ \ \ TLine\ *TempLineData\ =\ \textcolor{keyword}{new}\ TLine(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i]-\/>GetBinContent(b),\ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[i][b]-\/>GetMinimum(),\ \mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i]-\/>GetBinContent(b),\ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[i][b]-\/>GetMaximum());}
\DoxyCodeLine{00951\ \ \ \ \ \ \ \ \ TempLineData-\/>SetLineColor(kGreen);}
\DoxyCodeLine{00952\ \ \ \ \ \ \ \ \ TempLineData-\/>SetLineWidth(2);}
\DoxyCodeLine{00953\ }
\DoxyCodeLine{00954\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Also\ fit\ a\ Gaussian\ because\ why\ not?}}
\DoxyCodeLine{00955\ \ \ \ \ \ \ \ \ TF1\ *Fitter\ =\ \textcolor{keyword}{new}\ TF1(\textcolor{stringliteral}{"{}Fit"{}},\ \textcolor{stringliteral}{"{}gaus"{}},\ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[i][b]-\/>GetBinLowEdge(1),\ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[i][b]-\/>GetBinLowEdge(\mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[i][b]-\/>GetNbinsX()+1));}
\DoxyCodeLine{00956\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[i][b]-\/>Fit(Fitter,\ \textcolor{stringliteral}{"{}RQ"{}});}
\DoxyCodeLine{00957\ \ \ \ \ \ \ \ \ Fitter-\/>SetLineColor(kRed-\/5);}
\DoxyCodeLine{00958\ }
\DoxyCodeLine{00959\ \ \ \ \ \ \ \ \ TLegend\ *Legend\ =\ \textcolor{keyword}{new}\ TLegend(0.4,\ 0.75,\ 0.98,\ 0.90);}
\DoxyCodeLine{00960\ \ \ \ \ \ \ \ \ Legend-\/>SetFillColor(0);}
\DoxyCodeLine{00961\ \ \ \ \ \ \ \ \ Legend-\/>SetFillStyle(0);}
\DoxyCodeLine{00962\ \ \ \ \ \ \ \ \ Legend-\/>SetLineWidth(0);}
\DoxyCodeLine{00963\ \ \ \ \ \ \ \ \ Legend-\/>SetLineColor(0);}
\DoxyCodeLine{00964\ \ \ \ \ \ \ \ \ Legend-\/>AddEntry(TempLineData,\ Form(\textcolor{stringliteral}{"{}Data\ \#mu=\%.2f"{}},\ \mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i]-\/>GetBinContent(b)),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{00965\ \ \ \ \ \ \ \ \ Legend-\/>AddEntry(TempLine,\ Form(\textcolor{stringliteral}{"{}Prior\ \#mu=\%.2f"{}},\ \mbox{\hyperlink{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}{NominalHist}}[i]-\/>GetBinContent(b)),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{00966\ \ \ \ \ \ \ \ \ Legend-\/>AddEntry(\mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[i][b],\ Form(\textcolor{stringliteral}{"{}Post,\ \#mu=\%.2f\#pm\%.2f"{}},\ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[i][b]-\/>GetMean(),\ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[i][b]-\/>GetRMS()),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{00967\ \ \ \ \ \ \ \ \ Legend-\/>AddEntry(Fitter,\ Form(\textcolor{stringliteral}{"{}Gauss,\ \#mu=\%.2f\#pm\%.2f"{}},\ Fitter-\/>GetParameter(1),\ Fitter-\/>GetParameter(2)),\ \textcolor{stringliteral}{"{}l"{}});}
\DoxyCodeLine{00968\ \ \ \ \ \ \ \ \ std::string\ TempTitle\ =\ std::string(\mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[i][b]-\/>GetName());}
\DoxyCodeLine{00969\ }
\DoxyCodeLine{00970\ \ \ \ \ \ \ \ \ TempTitle\ +=\ \textcolor{stringliteral}{"{}\_canv"{}};}
\DoxyCodeLine{00971\ \ \ \ \ \ \ \ \ TCanvas\ *TempCanvas\ =\ \textcolor{keyword}{new}\ TCanvas(TempTitle.c\_str(),\ TempTitle.c\_str(),\ 1024,\ 1024);}
\DoxyCodeLine{00972\ \ \ \ \ \ \ \ \ TempCanvas-\/>SetGridx();}
\DoxyCodeLine{00973\ \ \ \ \ \ \ \ \ TempCanvas-\/>SetGridy();}
\DoxyCodeLine{00974\ \ \ \ \ \ \ \ \ TempCanvas-\/>SetRightMargin(0.03);}
\DoxyCodeLine{00975\ \ \ \ \ \ \ \ \ TempCanvas-\/>SetBottomMargin(0.08);}
\DoxyCodeLine{00976\ \ \ \ \ \ \ \ \ TempCanvas-\/>SetLeftMargin(0.10);}
\DoxyCodeLine{00977\ \ \ \ \ \ \ \ \ TempCanvas-\/>SetTopMargin(0.06);}
\DoxyCodeLine{00978\ \ \ \ \ \ \ \ \ TempCanvas-\/>cd();}
\DoxyCodeLine{00979\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}{PosteriorHist}}[i][b]-\/>Draw();}
\DoxyCodeLine{00980\ \ \ \ \ \ \ \ \ TempLine-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{00981\ \ \ \ \ \ \ \ \ TempLineData-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{00982\ \ \ \ \ \ \ \ \ Fitter-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{00983\ \ \ \ \ \ \ \ \ Legend-\/>Draw(\textcolor{stringliteral}{"{}same"{}});}
\DoxyCodeLine{00984\ \ \ \ \ \ \ \ \ TempCanvas-\/>Write();}
\DoxyCodeLine{00985\ }
\DoxyCodeLine{00986\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ TempLine;}
\DoxyCodeLine{00987\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ TempLineData;}
\DoxyCodeLine{00988\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ TempCanvas;}
\DoxyCodeLine{00989\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ Fitter;}
\DoxyCodeLine{00990\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ Legend;}
\DoxyCodeLine{00991\ \ \ \ \ \ \ \ \ \textcolor{comment}{//This\ isn't\ useful\ check\ only\ in\ desperation}}
\DoxyCodeLine{00992\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a807e348a85fb460c5ca4a1ce56d08aab}{Debug}}\ >\ 1)\ \mbox{\hyperlink{classSampleSummary_a0fd31469ea40b54ea864f5eb7360adee}{w2Hist}}[i][b]-\/>Write();}
\DoxyCodeLine{00993\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00994\ \ \ \ \ \ \ DebugDir-\/>Close();}
\DoxyCodeLine{00995\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ DebugDir;}
\DoxyCodeLine{00996\ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a916c6d1f50b54f1f4509622359b2a1b7}{Dir}}[i]-\/>cd();}
\DoxyCodeLine{00997\ \ \ \ \ \}}
\DoxyCodeLine{00998\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a0ae323dddee7bec9c425f309b60959f1}{lnLHist\_Mean}}[i]-\/>Write();}
\DoxyCodeLine{00999\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_aa9d2908a7dfefa91deb35a562b673eb1}{lnLHist\_Mode}}[i]-\/>Write();}
\DoxyCodeLine{01000\ }
\DoxyCodeLine{01001\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a9e6d97ff3cffed6a40689a547ec7e5d7}{lnLHist\_Mean\_ProjectX}}[i]-\/>Write();}
\DoxyCodeLine{01002\ }
\DoxyCodeLine{01003\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a6ae29545d50456334c6035d165599787}{lnLHist\_Mean1D}}[i]-\/>Write();}
\DoxyCodeLine{01004\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a8ad8aa62be1f0f895faf342bfc0f7d13}{lnLHist\_Mode1D}}[i]-\/>Write();}
\DoxyCodeLine{01005\ }
\DoxyCodeLine{01006\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_abf964a8fd459fff903faaea17a98f8b1}{MakeCutLLH1D}}(\mbox{\hyperlink{classSampleSummary_a08c14eaf908f0fd1bc8bd95b0886c99e}{lnLHist\_Sample\_DrawData}}[i],\ \mbox{\hyperlink{classSampleSummary_ad027b0716b707691e6a9565ee497b66f}{GetLLH}}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i],\ \mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[i],\ \mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2MeanHist}}[i]));}
\DoxyCodeLine{01007\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a08c14eaf908f0fd1bc8bd95b0886c99e}{lnLHist\_Sample\_DrawData}}[i]-\/>Write();}
\DoxyCodeLine{01008\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_abf964a8fd459fff903faaea17a98f8b1}{MakeCutLLH1D}}(\mbox{\hyperlink{classSampleSummary_a0e32c2a76de59e4142036b1c5a234819}{lnLHist\_Sample\_DrawflucDraw}}[i],\ \mbox{\hyperlink{classSampleSummary_ad027b0716b707691e6a9565ee497b66f}{GetLLH}}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i],\ \mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[i],\ \mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2MeanHist}}[i]));}
\DoxyCodeLine{01009\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a0e32c2a76de59e4142036b1c5a234819}{lnLHist\_Sample\_DrawflucDraw}}[i]-\/>Write();}
\DoxyCodeLine{01010\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_abf964a8fd459fff903faaea17a98f8b1}{MakeCutLLH1D}}(\mbox{\hyperlink{classSampleSummary_a59de41ffd933765d2e22ffd8aa198ac1}{lnLHist\_Sample\_PredflucDraw}}[i],\ \mbox{\hyperlink{classSampleSummary_ad027b0716b707691e6a9565ee497b66f}{GetLLH}}(\mbox{\hyperlink{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}{DataHist}}[i],\ \mbox{\hyperlink{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}{MeanHist}}[i],\ \mbox{\hyperlink{classSampleSummary_a520002b543541541096b79d15ca01911}{W2MeanHist}}[i]));}
\DoxyCodeLine{01011\ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a59de41ffd933765d2e22ffd8aa198ac1}{lnLHist\_Sample\_PredflucDraw}}[i]-\/>Write();}
\DoxyCodeLine{01012\ \ \ \ \ }
\DoxyCodeLine{01013\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a795ac96bf6958c8a2f38c9de23c3c081}{DoByModePlots}})}
\DoxyCodeLine{01014\ \ \ \ \ \{}
\DoxyCodeLine{01015\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ \mbox{\hyperlink{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}{Modes}}-\/>\mbox{\hyperlink{classMaCh3Modes_aaa508822590464a0ce36d2fed94e4d03}{GetNModes}}()+1;\ ++j)}
\DoxyCodeLine{01016\ \ \ \ \ \ \ \{}
\DoxyCodeLine{01017\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_a20237446a72eda2dc833bfc72c7e42e1}{MeanHist\_ByMode}}[i][j]-\/>Write();}
\DoxyCodeLine{01018\ \ \ \ \ \ \ \ \ TH1D\ *MeanProjectX\_ByMode\ =\ \mbox{\hyperlink{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}{ProjectPoly}}(\mbox{\hyperlink{classSampleSummary_a20237446a72eda2dc833bfc72c7e42e1}{MeanHist\_ByMode}}[i][j],\ \textcolor{keyword}{true},\ i,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01019\ \ \ \ \ \ \ \ \ TH1D\ *MeanProjectY\_ByMode\ =\ \mbox{\hyperlink{classSampleSummary_a685a8ef3180d4f6474328b5c806d8b74}{ProjectPoly}}(\mbox{\hyperlink{classSampleSummary_a20237446a72eda2dc833bfc72c7e42e1}{MeanHist\_ByMode}}[i][j],\ \textcolor{keyword}{false},\ i,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01020\ \ \ \ \ \ \ \ \ MeanProjectX\_ByMode-\/>Write();}
\DoxyCodeLine{01021\ \ \ \ \ \ \ \ \ MeanProjectY\_ByMode-\/>Write();}
\DoxyCodeLine{01022\ \ \ \ \ \ \ \ \ \textcolor{comment}{//KS:\ This\ will\ dump\ lots\ of\ hists,\ use\ it\ only\ for\ debugging}}
\DoxyCodeLine{01023\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_a807e348a85fb460c5ca4a1ce56d08aab}{Debug}}\ >\ 0)}
\DoxyCodeLine{01024\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01025\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ b\ =\ 1;\ b\ <=\ \mbox{\hyperlink{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}{maxBins}}[i];\ ++b)}
\DoxyCodeLine{01026\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01027\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classSampleSummary_aa6cfe4fb92b67f08b0d94f0fe1d8a3a2}{PosteriorHist\_ByMode}}[i][j][b]-\/>Write();}
\DoxyCodeLine{01028\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01029\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01030\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ MeanProjectX\_ByMode;}
\DoxyCodeLine{01031\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ MeanProjectY\_ByMode;}
\DoxyCodeLine{01032\ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ End\ loop\ over\ bins}}
\DoxyCodeLine{01033\ \ \ \ \ \}}
\DoxyCodeLine{01034\ \ \ \ \ }
\DoxyCodeLine{01035\ \ \ \ \ \textcolor{comment}{//\ Delete\ temporary\ objects}}
\DoxyCodeLine{01036\ \ \ \ \ \textcolor{keyword}{delete}\ RatioHistMean;}
\DoxyCodeLine{01037\ \ \ \ \ \textcolor{keyword}{delete}\ RatioHistMode;}
\DoxyCodeLine{01038\ \ \ \ \ \textcolor{keyword}{delete}\ RatioHistNom;}
\DoxyCodeLine{01039\ }
\DoxyCodeLine{01040\ \ \ \ \ \textcolor{keyword}{delete}\ DataNormHist;}
\DoxyCodeLine{01041\ \ \ \ \ \textcolor{keyword}{delete}\ MeanNormHist;}
\DoxyCodeLine{01042\ \ \ \ \ \textcolor{keyword}{delete}\ ModeNormHist;}
\DoxyCodeLine{01043\ \ \ \ \ \textcolor{keyword}{delete}\ NomNormHist;}
\DoxyCodeLine{01044\ }
\DoxyCodeLine{01045\ \ \ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_aed3d754bfa3b870ba2676748d1420b5f}{DataHist\_ProjectX}}[i];}
\DoxyCodeLine{01046\ \ \ \ \ \textcolor{keyword}{delete}\ MeanProjectX;}
\DoxyCodeLine{01047\ \ \ \ \ \textcolor{keyword}{delete}\ ModeProjectX;}
\DoxyCodeLine{01048\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}})\ \textcolor{keyword}{delete}\ MeanHistCorrectedProjectX;}
\DoxyCodeLine{01049\ \ \ \ \ \textcolor{keyword}{delete}\ NomProjectX;}
\DoxyCodeLine{01050\ }
\DoxyCodeLine{01051\ \ \ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classSampleSummary_abb300b204c11a5542efa5d28510d0860}{DataHist\_ProjectY}}[i];}
\DoxyCodeLine{01052\ \ \ \ \ \textcolor{keyword}{delete}\ MeanProjectY;}
\DoxyCodeLine{01053\ \ \ \ \ \textcolor{keyword}{delete}\ ModeProjectY;}
\DoxyCodeLine{01054\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}})\ \textcolor{keyword}{delete}\ MeanHistCorrectedProjectY;}
\DoxyCodeLine{01055\ \ \ \ \ \textcolor{keyword}{delete}\ NomProjectY;}
\DoxyCodeLine{01056\ }
\DoxyCodeLine{01057\ \ \ \ \ \textcolor{keyword}{delete}\ W2NomProjectX;}
\DoxyCodeLine{01058\ \ \ \ \ \textcolor{keyword}{delete}\ W2MeanProjectX;}
\DoxyCodeLine{01059\ \ \ \ \ \textcolor{keyword}{delete}\ W2ModeProjectX;}
\DoxyCodeLine{01060\ \ \ }
\DoxyCodeLine{01061\ \ \ \ \ \textcolor{keyword}{delete}\ W2NomProjectY;}
\DoxyCodeLine{01062\ \ \ \ \ \textcolor{keyword}{delete}\ W2MeanProjectY;}
\DoxyCodeLine{01063\ \ \ \ \ \textcolor{keyword}{delete}\ W2ModeProjectY;}
\DoxyCodeLine{01064\ \ \ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{01065\ \ \ \}\ \textcolor{comment}{//end\ loop\ over\ samples}}
\DoxyCodeLine{01066\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_aed3d754bfa3b870ba2676748d1420b5f}{DataHist\_ProjectX}};}
\DoxyCodeLine{01067\ \ \ \textcolor{keyword}{delete}[]\ \mbox{\hyperlink{classSampleSummary_abb300b204c11a5542efa5d28510d0860}{DataHist\_ProjectY}};}
\DoxyCodeLine{01068\ }
\DoxyCodeLine{01069\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}{DoBetaParam}})\ \mbox{\hyperlink{classSampleSummary_ac49aa59702b5e24cb0718c2642d6d793}{PlotBetaParameters}}();}
\DoxyCodeLine{01070\ }
\DoxyCodeLine{01071\ \ \ \mbox{\hyperlink{classSampleSummary_afa199f8841fcbf007c293187ea60d795}{StudyKinematicCorrelations}}();}
\DoxyCodeLine{01072\ \ \ \mbox{\hyperlink{MaCh3Logger_8h_a95fa4dffc648e4c5536c9292c2bdcac3}{MACH3LOG\_INFO}}(\textcolor{stringliteral}{"{}Wrote\ to\ \{\}"{}},\ \mbox{\hyperlink{classSampleSummary_aa7b948f290517a052f04f61dfa6af68f}{Outputfile}}-\/>GetName());}
\DoxyCodeLine{01073\ \}}

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classSampleSummary_a1041f478d0610e2a363a3993991599e5}\label{classSampleSummary_a1041f478d0610e2a363a3993991599e5}} 
\index{SampleSummary@{SampleSummary}!BetaHist@{BetaHist}}
\index{BetaHist@{BetaHist}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{BetaHist}{BetaHist}}
{\footnotesize\ttfamily TH1D$\ast$$\ast$$\ast$ Sample\+Summary\+::\+Beta\+Hist\hspace{0.3cm}{\ttfamily [private]}}



Distribution of beta parameters in Barlow Beeston formalisms. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00222}{222}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}\label{classSampleSummary_a584178216a524d9b9c114d1ff9f3e604}} 
\index{SampleSummary@{SampleSummary}!DataHist@{DataHist}}
\index{DataHist@{DataHist}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{DataHist}{DataHist}}
{\footnotesize\ttfamily TH2\+Poly$\ast$$\ast$ Sample\+Summary\+::\+Data\+Hist\hspace{0.3cm}{\ttfamily [private]}}



The data histogram for the selection. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00159}{159}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_aed3d754bfa3b870ba2676748d1420b5f}\label{classSampleSummary_aed3d754bfa3b870ba2676748d1420b5f}} 
\index{SampleSummary@{SampleSummary}!DataHist\_ProjectX@{DataHist\_ProjectX}}
\index{DataHist\_ProjectX@{DataHist\_ProjectX}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{DataHist\_ProjectX}{DataHist\_ProjectX}}
{\footnotesize\ttfamily TH1D$\ast$$\ast$ Sample\+Summary\+::\+Data\+Hist\+\_\+\+ProjectX\hspace{0.3cm}{\ttfamily [private]}}



The data histogram for the selection X projection. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00161}{161}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_abb300b204c11a5542efa5d28510d0860}\label{classSampleSummary_abb300b204c11a5542efa5d28510d0860}} 
\index{SampleSummary@{SampleSummary}!DataHist\_ProjectY@{DataHist\_ProjectY}}
\index{DataHist\_ProjectY@{DataHist\_ProjectY}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{DataHist\_ProjectY}{DataHist\_ProjectY}}
{\footnotesize\ttfamily TH1D$\ast$$\ast$ Sample\+Summary\+::\+Data\+Hist\+\_\+\+ProjectY\hspace{0.3cm}{\ttfamily [private]}}



The data histogram for the selection Y projection. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00163}{163}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a807e348a85fb460c5ca4a1ce56d08aab}\label{classSampleSummary_a807e348a85fb460c5ca4a1ce56d08aab}} 
\index{SampleSummary@{SampleSummary}!Debug@{Debug}}
\index{Debug@{Debug}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{Debug}{Debug}}
{\footnotesize\ttfamily int Sample\+Summary\+::\+Debug\hspace{0.3cm}{\ttfamily [private]}}



Tells Debug level to save additional histograms. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00340}{340}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a916c6d1f50b54f1f4509622359b2a1b7}\label{classSampleSummary_a916c6d1f50b54f1f4509622359b2a1b7}} 
\index{SampleSummary@{SampleSummary}!Dir@{Dir}}
\index{Dir@{Dir}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{Dir}{Dir}}
{\footnotesize\ttfamily TDirectory$\ast$$\ast$ Sample\+Summary\+::\+Dir\hspace{0.3cm}{\ttfamily [private]}}



Directory for each sample. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00249}{249}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}\label{classSampleSummary_adf610d698a50c4930d95be320e99a8e8}} 
\index{SampleSummary@{SampleSummary}!DoBetaParam@{DoBetaParam}}
\index{DoBetaParam@{DoBetaParam}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{DoBetaParam}{DoBetaParam}}
{\footnotesize\ttfamily bool Sample\+Summary\+::\+Do\+Beta\+Param\hspace{0.3cm}{\ttfamily [private]}}



Are we making Beta Histograms. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00224}{224}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a795ac96bf6958c8a2f38c9de23c3c081}\label{classSampleSummary_a795ac96bf6958c8a2f38c9de23c3c081}} 
\index{SampleSummary@{SampleSummary}!DoByModePlots@{DoByModePlots}}
\index{DoByModePlots@{DoByModePlots}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{DoByModePlots}{DoByModePlots}}
{\footnotesize\ttfamily bool Sample\+Summary\+::\+Do\+By\+Mode\+Plots\hspace{0.3cm}{\ttfamily [private]}}



By mode variables. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00321}{321}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_aebd01b201cf04608b251cd3e272878b7}\label{classSampleSummary_aebd01b201cf04608b251cd3e272878b7}} 
\index{SampleSummary@{SampleSummary}!doShapeOnly@{doShapeOnly}}
\index{doShapeOnly@{doShapeOnly}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{doShapeOnly}{doShapeOnly}}
{\footnotesize\ttfamily bool Sample\+Summary\+::do\+Shape\+Only\hspace{0.3cm}{\ttfamily [private]}}



bool whether to normalise each toy to have shape based p-\/value and pos pred distribution 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00233}{233}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a4ade2ccb94981d4483f0b4e6e367b1a0}\label{classSampleSummary_a4ade2ccb94981d4483f0b4e6e367b1a0}} 
\index{SampleSummary@{SampleSummary}!first\_pass@{first\_pass}}
\index{first\_pass@{first\_pass}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{first\_pass}{first\_pass}}
{\footnotesize\ttfamily bool Sample\+Summary\+::first\+\_\+pass\hspace{0.3cm}{\ttfamily [private]}}



KS\+: Hacky flag to let us know if this is first toy. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00125}{125}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_adb737e335e68edeb14a6ce2ca112dc8c}\label{classSampleSummary_adb737e335e68edeb14a6ce2ca112dc8c}} 
\index{SampleSummary@{SampleSummary}!isPriorPredictive@{isPriorPredictive}}
\index{isPriorPredictive@{isPriorPredictive}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{isPriorPredictive}{isPriorPredictive}}
{\footnotesize\ttfamily bool Sample\+Summary\+::is\+Prior\+Predictive\hspace{0.3cm}{\ttfamily [private]}}



bool whether we have Prior or Posterior Predictive 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00230}{230}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_aafb18632bb987ae9a302d95781d5fdba}\label{classSampleSummary_aafb18632bb987ae9a302d95781d5fdba}} 
\index{SampleSummary@{SampleSummary}!likelihood@{likelihood}}
\index{likelihood@{likelihood}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{likelihood}{likelihood}}
{\footnotesize\ttfamily \mbox{\hyperlink{Structs_8h_a960da89e33ac45a56f7bbfac3068dc67}{Test\+Statistic}} Sample\+Summary\+::likelihood\hspace{0.3cm}{\ttfamily [private]}}



Type of likelihood for example Poisson, Barlow-\/\+Beeston or Ice Cube. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00334}{334}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a8e20b53f7845651f6dc8f4b5faa9400c}\label{classSampleSummary_a8e20b53f7845651f6dc8f4b5faa9400c}} 
\index{SampleSummary@{SampleSummary}!llh\_data\_draw@{llh\_data\_draw}}
\index{llh\_data\_draw@{llh\_data\_draw}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{llh\_data\_draw}{llh\_data\_draw}}
{\footnotesize\ttfamily double$\ast$ Sample\+Summary\+::llh\+\_\+data\+\_\+draw\hspace{0.3cm}{\ttfamily [private]}}



Data vs Draw. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00254}{254}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a77250cd6138be6d5220f2ac6c7ebd2ea}\label{classSampleSummary_a77250cd6138be6d5220f2ac6c7ebd2ea}} 
\index{SampleSummary@{SampleSummary}!llh\_data\_draw\_ProjectX@{llh\_data\_draw\_ProjectX}}
\index{llh\_data\_draw\_ProjectX@{llh\_data\_draw\_ProjectX}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{llh\_data\_draw\_ProjectX}{llh\_data\_draw\_ProjectX}}
{\footnotesize\ttfamily double$\ast$ Sample\+Summary\+::llh\+\_\+data\+\_\+draw\+\_\+\+ProjectX\hspace{0.3cm}{\ttfamily [private]}}



Projection X (most likely muon momentum) of LLH. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00282}{282}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a5c46fc1f6e0ab29dcadcde3152b0d275}\label{classSampleSummary_a5c46fc1f6e0ab29dcadcde3152b0d275}} 
\index{SampleSummary@{SampleSummary}!llh\_data\_drawfluc@{llh\_data\_drawfluc}}
\index{llh\_data\_drawfluc@{llh\_data\_drawfluc}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{llh\_data\_drawfluc}{llh\_data\_drawfluc}}
{\footnotesize\ttfamily double$\ast$ Sample\+Summary\+::llh\+\_\+data\+\_\+drawfluc\hspace{0.3cm}{\ttfamily [private]}}



Data vs Fluctuated Draw. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00266}{266}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a07d4cc27e2299f3beefe0b3e78da493a}\label{classSampleSummary_a07d4cc27e2299f3beefe0b3e78da493a}} 
\index{SampleSummary@{SampleSummary}!llh\_data\_predfluc@{llh\_data\_predfluc}}
\index{llh\_data\_predfluc@{llh\_data\_predfluc}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{llh\_data\_predfluc}{llh\_data\_predfluc}}
{\footnotesize\ttfamily double$\ast$ Sample\+Summary\+::llh\+\_\+data\+\_\+predfluc\hspace{0.3cm}{\ttfamily [private]}}



Data vs Fluctuated Predictive. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00268}{268}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a85f8c5e630bc333137a403401097785d}\label{classSampleSummary_a85f8c5e630bc333137a403401097785d}} 
\index{SampleSummary@{SampleSummary}!llh\_datafluc\_draw@{llh\_datafluc\_draw}}
\index{llh\_datafluc\_draw@{llh\_datafluc\_draw}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{llh\_datafluc\_draw}{llh\_datafluc\_draw}}
{\footnotesize\ttfamily double$\ast$ Sample\+Summary\+::llh\+\_\+datafluc\+\_\+draw\hspace{0.3cm}{\ttfamily [private]}}



Fluctuated Data vs Draw. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00279}{279}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a1a154b17f6f4ab15eec03f3dcfc91e5f}\label{classSampleSummary_a1a154b17f6f4ab15eec03f3dcfc91e5f}} 
\index{SampleSummary@{SampleSummary}!llh\_draw\_pred@{llh\_draw\_pred}}
\index{llh\_draw\_pred@{llh\_draw\_pred}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{llh\_draw\_pred}{llh\_draw\_pred}}
{\footnotesize\ttfamily double$\ast$ Sample\+Summary\+::llh\+\_\+draw\+\_\+pred\hspace{0.3cm}{\ttfamily [private]}}



Draw vs Predictive. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00270}{270}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_afbea2da38c0bd2e78ec9fa87ebdf992a}\label{classSampleSummary_afbea2da38c0bd2e78ec9fa87ebdf992a}} 
\index{SampleSummary@{SampleSummary}!llh\_drawfluc\_draw@{llh\_drawfluc\_draw}}
\index{llh\_drawfluc\_draw@{llh\_drawfluc\_draw}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{llh\_drawfluc\_draw}{llh\_drawfluc\_draw}}
{\footnotesize\ttfamily double$\ast$ Sample\+Summary\+::llh\+\_\+drawfluc\+\_\+draw\hspace{0.3cm}{\ttfamily [private]}}



Fluctuated Draw vs Draw. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00256}{256}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a6a171e9c3a2f71785b777d1d64a78dfa}\label{classSampleSummary_a6a171e9c3a2f71785b777d1d64a78dfa}} 
\index{SampleSummary@{SampleSummary}!llh\_drawfluc\_draw\_ProjectX@{llh\_drawfluc\_draw\_ProjectX}}
\index{llh\_drawfluc\_draw\_ProjectX@{llh\_drawfluc\_draw\_ProjectX}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{llh\_drawfluc\_draw\_ProjectX}{llh\_drawfluc\_draw\_ProjectX}}
{\footnotesize\ttfamily double$\ast$ Sample\+Summary\+::llh\+\_\+drawfluc\+\_\+draw\+\_\+\+ProjectX\hspace{0.3cm}{\ttfamily [private]}}



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00283}{283}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_adb0f7be738ba901c4a6c1253dc8b2b03}\label{classSampleSummary_adb0f7be738ba901c4a6c1253dc8b2b03}} 
\index{SampleSummary@{SampleSummary}!llh\_drawfluc\_pred@{llh\_drawfluc\_pred}}
\index{llh\_drawfluc\_pred@{llh\_drawfluc\_pred}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{llh\_drawfluc\_pred}{llh\_drawfluc\_pred}}
{\footnotesize\ttfamily double$\ast$ Sample\+Summary\+::llh\+\_\+drawfluc\+\_\+pred\hspace{0.3cm}{\ttfamily [private]}}



Fluctuated Draw vs Predictive. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00272}{272}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a5fb4519a15437b229f37fb171e578ab0}\label{classSampleSummary_a5fb4519a15437b229f37fb171e578ab0}} 
\index{SampleSummary@{SampleSummary}!llh\_drawfluc\_predfluc@{llh\_drawfluc\_predfluc}}
\index{llh\_drawfluc\_predfluc@{llh\_drawfluc\_predfluc}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{llh\_drawfluc\_predfluc}{llh\_drawfluc\_predfluc}}
{\footnotesize\ttfamily double$\ast$ Sample\+Summary\+::llh\+\_\+drawfluc\+\_\+predfluc\hspace{0.3cm}{\ttfamily [private]}}



Fluctuated Draw vs Fluctuated Predictive. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00277}{277}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}\label{classSampleSummary_aef70c5ef9c8432dc42ff7f6c73c7e8d5}} 
\index{SampleSummary@{SampleSummary}!llh\_penalty@{llh\_penalty}}
\index{llh\_penalty@{llh\_penalty}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{llh\_penalty}{llh\_penalty}}
{\footnotesize\ttfamily double Sample\+Summary\+::llh\+\_\+penalty\hspace{0.3cm}{\ttfamily [private]}}



LLH penalty for each throw. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00286}{286}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a6dc4f1e22995a7bfa538df57903e7650}\label{classSampleSummary_a6dc4f1e22995a7bfa538df57903e7650}} 
\index{SampleSummary@{SampleSummary}!llh\_predfluc\_draw@{llh\_predfluc\_draw}}
\index{llh\_predfluc\_draw@{llh\_predfluc\_draw}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{llh\_predfluc\_draw}{llh\_predfluc\_draw}}
{\footnotesize\ttfamily double$\ast$ Sample\+Summary\+::llh\+\_\+predfluc\+\_\+draw\hspace{0.3cm}{\ttfamily [private]}}



Fluctuated Predictive vs Draw. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00258}{258}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a5160d49065adca11bec43baaab283b70}\label{classSampleSummary_a5160d49065adca11bec43baaab283b70}} 
\index{SampleSummary@{SampleSummary}!llh\_predfluc\_pred@{llh\_predfluc\_pred}}
\index{llh\_predfluc\_pred@{llh\_predfluc\_pred}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{llh\_predfluc\_pred}{llh\_predfluc\_pred}}
{\footnotesize\ttfamily double$\ast$ Sample\+Summary\+::llh\+\_\+predfluc\+\_\+pred\hspace{0.3cm}{\ttfamily [private]}}



Fluctuated Predictive vs Predictive. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00275}{275}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_ad766eb771115b2800b3a8e20f95ac612}\label{classSampleSummary_ad766eb771115b2800b3a8e20f95ac612}} 
\index{SampleSummary@{SampleSummary}!llh\_rate\_data\_draw@{llh\_rate\_data\_draw}}
\index{llh\_rate\_data\_draw@{llh\_rate\_data\_draw}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{llh\_rate\_data\_draw}{llh\_rate\_data\_draw}}
{\footnotesize\ttfamily double$\ast$ Sample\+Summary\+::llh\+\_\+rate\+\_\+data\+\_\+draw\hspace{0.3cm}{\ttfamily [private]}}



Data vs Draw using rate only. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00261}{261}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a09609fb1b319d270011d01983fa88d79}\label{classSampleSummary_a09609fb1b319d270011d01983fa88d79}} 
\index{SampleSummary@{SampleSummary}!llh\_rate\_predfluc\_draw@{llh\_rate\_predfluc\_draw}}
\index{llh\_rate\_predfluc\_draw@{llh\_rate\_predfluc\_draw}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{llh\_rate\_predfluc\_draw}{llh\_rate\_predfluc\_draw}}
{\footnotesize\ttfamily double$\ast$ Sample\+Summary\+::llh\+\_\+rate\+\_\+predfluc\+\_\+draw\hspace{0.3cm}{\ttfamily [private]}}



Fluctuated Predictive vs Draw using rate only. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00263}{263}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_aacac73b24f1e8b05d35fabe2322578e8}\label{classSampleSummary_aacac73b24f1e8b05d35fabe2322578e8}} 
\index{SampleSummary@{SampleSummary}!llh\_total@{llh\_total}}
\index{llh\_total@{llh\_total}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{llh\_total}{llh\_total}}
{\footnotesize\ttfamily double Sample\+Summary\+::llh\+\_\+total\hspace{0.3cm}{\ttfamily [private]}}



Total LLH for the posterior predictive distribution. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00242}{242}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a068e2a5ad0c02aaa57a27d2b12e37810}\label{classSampleSummary_a068e2a5ad0c02aaa57a27d2b12e37810}} 
\index{SampleSummary@{SampleSummary}!LLHPenaltyVector@{LLHPenaltyVector}}
\index{LLHPenaltyVector@{LLHPenaltyVector}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{LLHPenaltyVector}{LLHPenaltyVector}}
{\footnotesize\ttfamily std\+::vector$<$double$>$ Sample\+Summary\+::\+LLHPenalty\+Vector\hspace{0.3cm}{\ttfamily [private]}}



Vector to hold the penalty term. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00138}{138}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a653e0d84096e0acdb3e392c2a68077e9}\label{classSampleSummary_a653e0d84096e0acdb3e392c2a68077e9}} 
\index{SampleSummary@{SampleSummary}!lnLDrawHist@{lnLDrawHist}}
\index{lnLDrawHist@{lnLDrawHist}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{lnLDrawHist}{lnLDrawHist}}
{\footnotesize\ttfamily TH2D$\ast$ Sample\+Summary\+::ln\+LDraw\+Hist\hspace{0.3cm}{\ttfamily [private]}}



The 2D ln\+Lhist, showing (draw vs data) and (draw vs fluct), anything above y=x axis is the p-\/value. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00182}{182}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a7cee72732c2a3e242e5ed723e4b206c9}\label{classSampleSummary_a7cee72732c2a3e242e5ed723e4b206c9}} 
\index{SampleSummary@{SampleSummary}!lnLDrawHistRate@{lnLDrawHistRate}}
\index{lnLDrawHistRate@{lnLDrawHistRate}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{lnLDrawHistRate}{lnLDrawHistRate}}
{\footnotesize\ttfamily TH2D$\ast$ Sample\+Summary\+::ln\+LDraw\+Hist\+Rate\hspace{0.3cm}{\ttfamily [private]}}



The 2D ln\+Lhist, showing (draw vs data) and (draw vs fluct), using rate, anything above y=x axis is the p-\/value. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00187}{187}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a6f7c55987330d006555b44010e54d8b0}\label{classSampleSummary_a6f7c55987330d006555b44010e54d8b0}} 
\index{SampleSummary@{SampleSummary}!lnLFlucHist@{lnLFlucHist}}
\index{lnLFlucHist@{lnLFlucHist}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{lnLFlucHist}{lnLFlucHist}}
{\footnotesize\ttfamily TH2D$\ast$ Sample\+Summary\+::ln\+LFluc\+Hist\hspace{0.3cm}{\ttfamily [private]}}



The 2D ln\+LHist, showing (draw vs data) and (draw vs draw fluct), anything above y=x axis is the p-\/value. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00184}{184}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a40f5c789dbf8ad9c8a4af401343af474}\label{classSampleSummary_a40f5c789dbf8ad9c8a4af401343af474}} 
\index{SampleSummary@{SampleSummary}!lnLFlucHist\_ProjectX@{lnLFlucHist\_ProjectX}}
\index{lnLFlucHist\_ProjectX@{lnLFlucHist\_ProjectX}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{lnLFlucHist\_ProjectX}{lnLFlucHist\_ProjectX}}
{\footnotesize\ttfamily TH2D$\ast$ Sample\+Summary\+::ln\+LFluc\+Hist\+\_\+\+ProjectX\hspace{0.3cm}{\ttfamily [private]}}



The 2D ln\+LHist but for ProjectionX histogram (pmu), showing (draw vs data) and (draw vs draw fluct), anything above y=x axis is the p-\/value. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00189}{189}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a086c2804cf7c1af54784d856c4351de8}\label{classSampleSummary_a086c2804cf7c1af54784d856c4351de8}} 
\index{SampleSummary@{SampleSummary}!lnLHist@{lnLHist}}
\index{lnLHist@{lnLHist}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{lnLHist}{lnLHist}}
{\footnotesize\ttfamily TH1D$\ast$ Sample\+Summary\+::ln\+LHist\hspace{0.3cm}{\ttfamily [private]}}



The histogram containing the lnL for each throw. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00174}{174}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_af4240300eba39917dee195fd2b37c5d9}\label{classSampleSummary_af4240300eba39917dee195fd2b37c5d9}} 
\index{SampleSummary@{SampleSummary}!lnLHist\_drawdata@{lnLHist\_drawdata}}
\index{lnLHist\_drawdata@{lnLHist\_drawdata}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{lnLHist\_drawdata}{lnLHist\_drawdata}}
{\footnotesize\ttfamily TH1D$\ast$ Sample\+Summary\+::ln\+LHist\+\_\+drawdata\hspace{0.3cm}{\ttfamily [private]}}



The ln\+Lhist for the draw vs data. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00180}{180}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a77da9dc0abfc381a526e3ceac9453f80}\label{classSampleSummary_a77da9dc0abfc381a526e3ceac9453f80}} 
\index{SampleSummary@{SampleSummary}!lnLHist\_drawfluc@{lnLHist\_drawfluc}}
\index{lnLHist\_drawfluc@{lnLHist\_drawfluc}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{lnLHist\_drawfluc}{lnLHist\_drawfluc}}
{\footnotesize\ttfamily TH1D$\ast$ Sample\+Summary\+::ln\+LHist\+\_\+drawfluc\hspace{0.3cm}{\ttfamily [private]}}



The ln\+Lhist for the draw vs MC fluctuated. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00176}{176}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a6c8b2e34255d1c109b5172ddcf5e9fcd}\label{classSampleSummary_a6c8b2e34255d1c109b5172ddcf5e9fcd}} 
\index{SampleSummary@{SampleSummary}!lnLHist\_drawflucdraw@{lnLHist\_drawflucdraw}}
\index{lnLHist\_drawflucdraw@{lnLHist\_drawflucdraw}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{lnLHist\_drawflucdraw}{lnLHist\_drawflucdraw}}
{\footnotesize\ttfamily TH1D$\ast$ Sample\+Summary\+::ln\+LHist\+\_\+drawflucdraw\hspace{0.3cm}{\ttfamily [private]}}



The ln\+Lhist for the draw vs draw fluctuated. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00178}{178}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a0ae323dddee7bec9c425f309b60959f1}\label{classSampleSummary_a0ae323dddee7bec9c425f309b60959f1}} 
\index{SampleSummary@{SampleSummary}!lnLHist\_Mean@{lnLHist\_Mean}}
\index{lnLHist\_Mean@{lnLHist\_Mean}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{lnLHist\_Mean}{lnLHist\_Mean}}
{\footnotesize\ttfamily TH2\+Poly$\ast$$\ast$ Sample\+Summary\+::ln\+LHist\+\_\+\+Mean\hspace{0.3cm}{\ttfamily [private]}}



The LLH distribution in pmu cosmu for using the mean in each bin. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00199}{199}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a6ae29545d50456334c6035d165599787}\label{classSampleSummary_a6ae29545d50456334c6035d165599787}} 
\index{SampleSummary@{SampleSummary}!lnLHist\_Mean1D@{lnLHist\_Mean1D}}
\index{lnLHist\_Mean1D@{lnLHist\_Mean1D}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{lnLHist\_Mean1D}{lnLHist\_Mean1D}}
{\footnotesize\ttfamily TH1D$\ast$$\ast$ Sample\+Summary\+::ln\+LHist\+\_\+\+Mean1D\hspace{0.3cm}{\ttfamily [private]}}



Holds the bin-\/by-\/bin LLH for the mean posterior predictive vs the data. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00214}{214}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a9e6d97ff3cffed6a40689a547ec7e5d7}\label{classSampleSummary_a9e6d97ff3cffed6a40689a547ec7e5d7}} 
\index{SampleSummary@{SampleSummary}!lnLHist\_Mean\_ProjectX@{lnLHist\_Mean\_ProjectX}}
\index{lnLHist\_Mean\_ProjectX@{lnLHist\_Mean\_ProjectX}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{lnLHist\_Mean\_ProjectX}{lnLHist\_Mean\_ProjectX}}
{\footnotesize\ttfamily TH1D$\ast$$\ast$ Sample\+Summary\+::ln\+LHist\+\_\+\+Mean\+\_\+\+ProjectX\hspace{0.3cm}{\ttfamily [private]}}



The LLH distribution in pmu using the mean in each bin. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00204}{204}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_aa9d2908a7dfefa91deb35a562b673eb1}\label{classSampleSummary_aa9d2908a7dfefa91deb35a562b673eb1}} 
\index{SampleSummary@{SampleSummary}!lnLHist\_Mode@{lnLHist\_Mode}}
\index{lnLHist\_Mode@{lnLHist\_Mode}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{lnLHist\_Mode}{lnLHist\_Mode}}
{\footnotesize\ttfamily TH2\+Poly$\ast$$\ast$ Sample\+Summary\+::ln\+LHist\+\_\+\+Mode\hspace{0.3cm}{\ttfamily [private]}}



The LLH distribution in pmu cosmu for using the mode in each bin. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00201}{201}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a8ad8aa62be1f0f895faf342bfc0f7d13}\label{classSampleSummary_a8ad8aa62be1f0f895faf342bfc0f7d13}} 
\index{SampleSummary@{SampleSummary}!lnLHist\_Mode1D@{lnLHist\_Mode1D}}
\index{lnLHist\_Mode1D@{lnLHist\_Mode1D}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{lnLHist\_Mode1D}{lnLHist\_Mode1D}}
{\footnotesize\ttfamily TH1D$\ast$$\ast$ Sample\+Summary\+::ln\+LHist\+\_\+\+Mode1D\hspace{0.3cm}{\ttfamily [private]}}



Holds the bin-\/by-\/bin LLH for the mode posterior predictive vs the data. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00216}{216}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a08c14eaf908f0fd1bc8bd95b0886c99e}\label{classSampleSummary_a08c14eaf908f0fd1bc8bd95b0886c99e}} 
\index{SampleSummary@{SampleSummary}!lnLHist\_Sample\_DrawData@{lnLHist\_Sample\_DrawData}}
\index{lnLHist\_Sample\_DrawData@{lnLHist\_Sample\_DrawData}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{lnLHist\_Sample\_DrawData}{lnLHist\_Sample\_DrawData}}
{\footnotesize\ttfamily TH1D$\ast$$\ast$ Sample\+Summary\+::ln\+LHist\+\_\+\+Sample\+\_\+\+Draw\+Data\hspace{0.3cm}{\ttfamily [private]}}



The histogram containing the lnL (draw vs data) for each throw for each sample. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00192}{192}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a0e32c2a76de59e4142036b1c5a234819}\label{classSampleSummary_a0e32c2a76de59e4142036b1c5a234819}} 
\index{SampleSummary@{SampleSummary}!lnLHist\_Sample\_DrawflucDraw@{lnLHist\_Sample\_DrawflucDraw}}
\index{lnLHist\_Sample\_DrawflucDraw@{lnLHist\_Sample\_DrawflucDraw}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{lnLHist\_Sample\_DrawflucDraw}{lnLHist\_Sample\_DrawflucDraw}}
{\footnotesize\ttfamily TH1D$\ast$$\ast$ Sample\+Summary\+::ln\+LHist\+\_\+\+Sample\+\_\+\+Drawfluc\+Draw\hspace{0.3cm}{\ttfamily [private]}}



The histogram containing the lnL (draw vs draw fluct) for each throw for each sample. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00194}{194}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a59de41ffd933765d2e22ffd8aa198ac1}\label{classSampleSummary_a59de41ffd933765d2e22ffd8aa198ac1}} 
\index{SampleSummary@{SampleSummary}!lnLHist\_Sample\_PredflucDraw@{lnLHist\_Sample\_PredflucDraw}}
\index{lnLHist\_Sample\_PredflucDraw@{lnLHist\_Sample\_PredflucDraw}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{lnLHist\_Sample\_PredflucDraw}{lnLHist\_Sample\_PredflucDraw}}
{\footnotesize\ttfamily TH1D$\ast$$\ast$ Sample\+Summary\+::ln\+LHist\+\_\+\+Sample\+\_\+\+Predfluc\+Draw\hspace{0.3cm}{\ttfamily [private]}}



The histogram containing the lnL (draw vs pred fluct) for each throw for each sample. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00196}{196}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}\label{classSampleSummary_a780a82a74bb9d1c3b798a995dfef7ec2}} 
\index{SampleSummary@{SampleSummary}!maxBins@{maxBins}}
\index{maxBins@{maxBins}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{maxBins}{maxBins}}
{\footnotesize\ttfamily int$\ast$ Sample\+Summary\+::max\+Bins\hspace{0.3cm}{\ttfamily [private]}}



Max Number of Bins per each sample. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00239}{239}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a13177305e8fd4b97812b2ca563740bf2}\label{classSampleSummary_a13177305e8fd4b97812b2ca563740bf2}} 
\index{SampleSummary@{SampleSummary}!MCVector@{MCVector}}
\index{MCVector@{MCVector}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{MCVector}{MCVector}}
{\footnotesize\ttfamily std\+::vector$<$std\+::vector$<$TH2\+Poly$\ast$$>$ $>$ Sample\+Summary\+::\+MCVector\hspace{0.3cm}{\ttfamily [private]}}



Vector of vectors which holds the loaded MC histograms. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00131}{131}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_ab3eeac18b62f7ee3a5c943c3cd0e9b76}\label{classSampleSummary_ab3eeac18b62f7ee3a5c943c3cd0e9b76}} 
\index{SampleSummary@{SampleSummary}!MCVectorByMode@{MCVectorByMode}}
\index{MCVectorByMode@{MCVectorByMode}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{MCVectorByMode}{MCVectorByMode}}
{\footnotesize\ttfamily std\+::vector$<$std\+::vector$<$std\+::vector$<$TH2\+Poly$\ast$$>$ $>$ $>$ Sample\+Summary\+::\+MCVector\+By\+Mode\hspace{0.3cm}{\ttfamily [private]}}



Vector of vectors which holds the loaded MC histograms for each mode. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00135}{135}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}\label{classSampleSummary_a7ba3f318fff83a31e1474f7bbd186a91}} 
\index{SampleSummary@{SampleSummary}!MeanHist@{MeanHist}}
\index{MeanHist@{MeanHist}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{MeanHist}{MeanHist}}
{\footnotesize\ttfamily TH2\+Poly$\ast$$\ast$ Sample\+Summary\+::\+Mean\+Hist\hspace{0.3cm}{\ttfamily [private]}}



The posterior predictive distribution in pmu cosmu using the mean. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00207}{207}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a20237446a72eda2dc833bfc72c7e42e1}\label{classSampleSummary_a20237446a72eda2dc833bfc72c7e42e1}} 
\index{SampleSummary@{SampleSummary}!MeanHist\_ByMode@{MeanHist\_ByMode}}
\index{MeanHist\_ByMode@{MeanHist\_ByMode}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{MeanHist\_ByMode}{MeanHist\_ByMode}}
{\footnotesize\ttfamily TH2\+Poly$\ast$$\ast$$\ast$ Sample\+Summary\+::\+Mean\+Hist\+\_\+\+By\+Mode\hspace{0.3cm}{\ttfamily [private]}}



The posterior predictive distribution in pmu cosmu using the mean. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00323}{323}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a805cc2be1298a385160deaa03269313a}\label{classSampleSummary_a805cc2be1298a385160deaa03269313a}} 
\index{SampleSummary@{SampleSummary}!MeanHistCorrected@{MeanHistCorrected}}
\index{MeanHistCorrected@{MeanHistCorrected}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{MeanHistCorrected}{MeanHistCorrected}}
{\footnotesize\ttfamily TH2\+Poly$\ast$$\ast$ Sample\+Summary\+::\+Mean\+Hist\+Corrected\hspace{0.3cm}{\ttfamily [private]}}



The posterior predictive distribution in pmu cosmu using the mean after applying Barlow-\/\+Beeston Correction. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00209}{209}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a59475a0c9460277914402850372727ea}\label{classSampleSummary_a59475a0c9460277914402850372727ea}} 
\index{SampleSummary@{SampleSummary}!ModeHist@{ModeHist}}
\index{ModeHist@{ModeHist}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{ModeHist}{ModeHist}}
{\footnotesize\ttfamily TH2\+Poly$\ast$$\ast$ Sample\+Summary\+::\+Mode\+Hist\hspace{0.3cm}{\ttfamily [private]}}



The posterior predictive distribution in pmu cosmu using the mode. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00211}{211}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}\label{classSampleSummary_a6593fed9709673a6910f96adc88fc8f2}} 
\index{SampleSummary@{SampleSummary}!Modes@{Modes}}
\index{Modes@{Modes}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{Modes}{Modes}}
{\footnotesize\ttfamily \mbox{\hyperlink{classMaCh3Modes}{Ma\+Ch3\+Modes}}$\ast$ Sample\+Summary\+::\+Modes\hspace{0.3cm}{\ttfamily [private]}}



Ma\+Ch3 Modes. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00331}{331}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_af4767862e5c1f4e3319d16b861213555}\label{classSampleSummary_af4767862e5c1f4e3319d16b861213555}} 
\index{SampleSummary@{SampleSummary}!nChainSteps@{nChainSteps}}
\index{nChainSteps@{nChainSteps}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{nChainSteps}{nChainSteps}}
{\footnotesize\ttfamily unsigned int Sample\+Summary\+::n\+Chain\+Steps\hspace{0.3cm}{\ttfamily [private]}}



Number of throws by user. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00227}{227}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a49215601479aaa99f9f64d8f7c900385}\label{classSampleSummary_a49215601479aaa99f9f64d8f7c900385}} 
\index{SampleSummary@{SampleSummary}!nModelParams@{nModelParams}}
\index{nModelParams@{nModelParams}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{nModelParams}{nModelParams}}
{\footnotesize\ttfamily int Sample\+Summary\+::n\+Model\+Params\hspace{0.3cm}{\ttfamily [private]}}



Number of parameters. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00337}{337}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}\label{classSampleSummary_af997228f24e00ac2ba766883cfb83ee0}} 
\index{SampleSummary@{SampleSummary}!NominalHist@{NominalHist}}
\index{NominalHist@{NominalHist}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{NominalHist}{NominalHist}}
{\footnotesize\ttfamily TH2\+Poly$\ast$$\ast$ Sample\+Summary\+::\+Nominal\+Hist\hspace{0.3cm}{\ttfamily [private]}}



The nominal histogram for the selection. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00165}{165}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}\label{classSampleSummary_ab16d22bf65d2a9c15072901161fc160a}} 
\index{SampleSummary@{SampleSummary}!nSamples@{nSamples}}
\index{nSamples@{nSamples}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{nSamples}{nSamples}}
{\footnotesize\ttfamily int Sample\+Summary\+::n\+Samples\hspace{0.3cm}{\ttfamily [private]}}



Number of samples. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00143}{143}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_aa5c4055d4bb4dc720a4118032cdb4910}\label{classSampleSummary_aa5c4055d4bb4dc720a4118032cdb4910}} 
\index{SampleSummary@{SampleSummary}!nThrows@{nThrows}}
\index{nThrows@{nThrows}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{nThrows}{nThrows}}
{\footnotesize\ttfamily unsigned int Sample\+Summary\+::n\+Throws\hspace{0.3cm}{\ttfamily [private]}}



Number of throws. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00236}{236}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_aa7b948f290517a052f04f61dfa6af68f}\label{classSampleSummary_aa7b948f290517a052f04f61dfa6af68f}} 
\index{SampleSummary@{SampleSummary}!Outputfile@{Outputfile}}
\index{Outputfile@{Outputfile}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{Outputfile}{Outputfile}}
{\footnotesize\ttfamily TFile$\ast$ Sample\+Summary\+::\+Outputfile\hspace{0.3cm}{\ttfamily [private]}}



Output filename. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00247}{247}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a4463f635de4e83c7ada683768454da82}\label{classSampleSummary_a4463f635de4e83c7ada683768454da82}} 
\index{SampleSummary@{SampleSummary}!OutputName@{OutputName}}
\index{OutputName@{OutputName}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{OutputName}{OutputName}}
{\footnotesize\ttfamily std\+::string Sample\+Summary\+::\+Output\+Name\hspace{0.3cm}{\ttfamily [private]}}



Output filename. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00245}{245}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}\label{classSampleSummary_a78eb4766cc8b4758b909b6ce9113a56e}} 
\index{SampleSummary@{SampleSummary}!OutputTree@{OutputTree}}
\index{OutputTree@{OutputTree}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{OutputTree}{OutputTree}}
{\footnotesize\ttfamily TTree$\ast$ Sample\+Summary\+::\+Output\+Tree\hspace{0.3cm}{\ttfamily [private]}}



TTree which we save useful information to. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00252}{252}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}\label{classSampleSummary_a57653c676681b825720c2c1eaae4df3f}} 
\index{SampleSummary@{SampleSummary}!PosteriorHist@{PosteriorHist}}
\index{PosteriorHist@{PosteriorHist}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{PosteriorHist}{PosteriorHist}}
{\footnotesize\ttfamily TH1D$\ast$$\ast$$\ast$ Sample\+Summary\+::\+Posterior\+Hist\hspace{0.3cm}{\ttfamily [private]}}



The posterior predictive for the whole selection\+: this gets built after adding in the toys. Now an array of Th1ds, 1 for each poly bin, for each sample. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00149}{149}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_aa6cfe4fb92b67f08b0d94f0fe1d8a3a2}\label{classSampleSummary_aa6cfe4fb92b67f08b0d94f0fe1d8a3a2}} 
\index{SampleSummary@{SampleSummary}!PosteriorHist\_ByMode@{PosteriorHist\_ByMode}}
\index{PosteriorHist\_ByMode@{PosteriorHist\_ByMode}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{PosteriorHist\_ByMode}{PosteriorHist\_ByMode}}
{\footnotesize\ttfamily TH1D$\ast$$\ast$$\ast$$\ast$ Sample\+Summary\+::\+Posterior\+Hist\+\_\+\+By\+Mode\hspace{0.3cm}{\ttfamily [private]}}



Histogram which corresponds to each bin in the sample\textquotesingle{}s th2poly. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00325}{325}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a07ea4bf6cf23214263ec63cd69de49c1}\label{classSampleSummary_a07ea4bf6cf23214263ec63cd69de49c1}} 
\index{SampleSummary@{SampleSummary}!RandomHist@{RandomHist}}
\index{RandomHist@{RandomHist}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{RandomHist}{RandomHist}}
{\footnotesize\ttfamily TH1D$\ast$ Sample\+Summary\+::\+Random\+Hist\hspace{0.3cm}{\ttfamily [private]}}



Holds the history of which entries have been drawn in the MCMC file. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00219}{219}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a8322552ef396f34af5ee4bd47a44e39e}\label{classSampleSummary_a8322552ef396f34af5ee4bd47a44e39e}} 
\index{SampleSummary@{SampleSummary}!rnd@{rnd}}
\index{rnd@{rnd}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{rnd}{rnd}}
{\footnotesize\ttfamily TRandom3$\ast$ Sample\+Summary\+::rnd\hspace{0.3cm}{\ttfamily [private]}}



Random number generator. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00123}{123}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a9ba7df41774c45a14c0a97e4accc9cc0}\label{classSampleSummary_a9ba7df41774c45a14c0a97e4accc9cc0}} 
\index{SampleSummary@{SampleSummary}!SampleNames@{SampleNames}}
\index{SampleNames@{SampleNames}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{SampleNames}{SampleNames}}
{\footnotesize\ttfamily std\+::vector$<$std\+::string$>$ Sample\+Summary\+::\+Sample\+Names\hspace{0.3cm}{\ttfamily [private]}}



name for each sample 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00146}{146}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_abd938805245ca6cfeb8c49363f5ff11c}\label{classSampleSummary_abd938805245ca6cfeb8c49363f5ff11c}} 
\index{SampleSummary@{SampleSummary}!SamplePDF@{SamplePDF}}
\index{SamplePDF@{SamplePDF}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{SamplePDF}{SamplePDF}}
{\footnotesize\ttfamily \mbox{\hyperlink{classsamplePDFBase}{sample\+PDFBase}}$\ast$ Sample\+Summary\+::\+Sample\+PDF\hspace{0.3cm}{\ttfamily [private]}}



Pointer to sample\+PDF object, mostly used to get sample names, binning etc. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00328}{328}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_ae502645ddf5c53a7a3f2c52566956bf3}\label{classSampleSummary_ae502645ddf5c53a7a3f2c52566956bf3}} 
\index{SampleSummary@{SampleSummary}!StandardFluctuation@{StandardFluctuation}}
\index{StandardFluctuation@{StandardFluctuation}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{StandardFluctuation}{StandardFluctuation}}
{\footnotesize\ttfamily bool Sample\+Summary\+::\+Standard\+Fluctuation\hspace{0.3cm}{\ttfamily [private]}}



KS\+: We have two methods for Poissonian fluctuation. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00128}{128}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a2cb3d8dcbab49b62be3bc2a4a7e4d5f3}\label{classSampleSummary_a2cb3d8dcbab49b62be3bc2a4a7e4d5f3}} 
\index{SampleSummary@{SampleSummary}!total\_llh\_data\_draw@{total\_llh\_data\_draw}}
\index{total\_llh\_data\_draw@{total\_llh\_data\_draw}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{total\_llh\_data\_draw}{total\_llh\_data\_draw}}
{\footnotesize\ttfamily double Sample\+Summary\+::total\+\_\+llh\+\_\+data\+\_\+draw\hspace{0.3cm}{\ttfamily [private]}}



Data vs Draw. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00289}{289}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a5a973692db89f52c19c9195ffe95c9a1}\label{classSampleSummary_a5a973692db89f52c19c9195ffe95c9a1}} 
\index{SampleSummary@{SampleSummary}!total\_llh\_data\_draw\_ProjectX@{total\_llh\_data\_draw\_ProjectX}}
\index{total\_llh\_data\_draw\_ProjectX@{total\_llh\_data\_draw\_ProjectX}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{total\_llh\_data\_draw\_ProjectX}{total\_llh\_data\_draw\_ProjectX}}
{\footnotesize\ttfamily double Sample\+Summary\+::total\+\_\+llh\+\_\+data\+\_\+draw\+\_\+\+ProjectX\hspace{0.3cm}{\ttfamily [private]}}



Data vs Draw for projection X (most likely muon momentum) 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00316}{316}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a670c890357fd77997279c83c197f989c}\label{classSampleSummary_a670c890357fd77997279c83c197f989c}} 
\index{SampleSummary@{SampleSummary}!total\_llh\_data\_drawfluc@{total\_llh\_data\_drawfluc}}
\index{total\_llh\_data\_drawfluc@{total\_llh\_data\_drawfluc}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{total\_llh\_data\_drawfluc}{total\_llh\_data\_drawfluc}}
{\footnotesize\ttfamily double Sample\+Summary\+::total\+\_\+llh\+\_\+data\+\_\+drawfluc\hspace{0.3cm}{\ttfamily [private]}}



Data vs Fluctuated Draw. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00303}{303}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_aeee48af77dc4e0beee5eab13c30f3d38}\label{classSampleSummary_aeee48af77dc4e0beee5eab13c30f3d38}} 
\index{SampleSummary@{SampleSummary}!total\_llh\_data\_predfluc@{total\_llh\_data\_predfluc}}
\index{total\_llh\_data\_predfluc@{total\_llh\_data\_predfluc}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{total\_llh\_data\_predfluc}{total\_llh\_data\_predfluc}}
{\footnotesize\ttfamily double Sample\+Summary\+::total\+\_\+llh\+\_\+data\+\_\+predfluc\hspace{0.3cm}{\ttfamily [private]}}



Data vs Fluctuated Predictive. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00301}{301}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_af9e5d89095e6c6a81aedb5ea2402e3fb}\label{classSampleSummary_af9e5d89095e6c6a81aedb5ea2402e3fb}} 
\index{SampleSummary@{SampleSummary}!total\_llh\_datafluc\_draw@{total\_llh\_datafluc\_draw}}
\index{total\_llh\_datafluc\_draw@{total\_llh\_datafluc\_draw}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{total\_llh\_datafluc\_draw}{total\_llh\_datafluc\_draw}}
{\footnotesize\ttfamily double Sample\+Summary\+::total\+\_\+llh\+\_\+datafluc\+\_\+draw\hspace{0.3cm}{\ttfamily [private]}}



Fluctuated Data vs Draw. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00311}{311}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a58efe34df7c43fb40d211036e30a1b5d}\label{classSampleSummary_a58efe34df7c43fb40d211036e30a1b5d}} 
\index{SampleSummary@{SampleSummary}!total\_llh\_draw\_pred@{total\_llh\_draw\_pred}}
\index{total\_llh\_draw\_pred@{total\_llh\_draw\_pred}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{total\_llh\_draw\_pred}{total\_llh\_draw\_pred}}
{\footnotesize\ttfamily double Sample\+Summary\+::total\+\_\+llh\+\_\+draw\+\_\+pred\hspace{0.3cm}{\ttfamily [private]}}



Draw vs Predictive. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00305}{305}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a7e418146cce2c4201c3aa7e1eaad4a38}\label{classSampleSummary_a7e418146cce2c4201c3aa7e1eaad4a38}} 
\index{SampleSummary@{SampleSummary}!total\_llh\_drawfluc\_draw@{total\_llh\_drawfluc\_draw}}
\index{total\_llh\_drawfluc\_draw@{total\_llh\_drawfluc\_draw}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{total\_llh\_drawfluc\_draw}{total\_llh\_drawfluc\_draw}}
{\footnotesize\ttfamily double Sample\+Summary\+::total\+\_\+llh\+\_\+drawfluc\+\_\+draw\hspace{0.3cm}{\ttfamily [private]}}



Fluctuated Draw vs Draw. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00291}{291}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a22df11667306c7892f9ed3f8935a5c9e}\label{classSampleSummary_a22df11667306c7892f9ed3f8935a5c9e}} 
\index{SampleSummary@{SampleSummary}!total\_llh\_drawfluc\_draw\_ProjectX@{total\_llh\_drawfluc\_draw\_ProjectX}}
\index{total\_llh\_drawfluc\_draw\_ProjectX@{total\_llh\_drawfluc\_draw\_ProjectX}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{total\_llh\_drawfluc\_draw\_ProjectX}{total\_llh\_drawfluc\_draw\_ProjectX}}
{\footnotesize\ttfamily double Sample\+Summary\+::total\+\_\+llh\+\_\+drawfluc\+\_\+draw\+\_\+\+ProjectX\hspace{0.3cm}{\ttfamily [private]}}



Fluctuated Draw vs Draw for projection X (most likely muon momentum) 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00318}{318}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a9c8b444ac7f80a5af63d5b9f4a150b79}\label{classSampleSummary_a9c8b444ac7f80a5af63d5b9f4a150b79}} 
\index{SampleSummary@{SampleSummary}!total\_llh\_drawfluc\_pred@{total\_llh\_drawfluc\_pred}}
\index{total\_llh\_drawfluc\_pred@{total\_llh\_drawfluc\_pred}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{total\_llh\_drawfluc\_pred}{total\_llh\_drawfluc\_pred}}
{\footnotesize\ttfamily double Sample\+Summary\+::total\+\_\+llh\+\_\+drawfluc\+\_\+pred\hspace{0.3cm}{\ttfamily [private]}}



Fluctuated Draw vs Predictive. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00307}{307}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_af92a42a666e1bfcb2dc761ffa2253b7e}\label{classSampleSummary_af92a42a666e1bfcb2dc761ffa2253b7e}} 
\index{SampleSummary@{SampleSummary}!total\_llh\_drawfluc\_predfluc@{total\_llh\_drawfluc\_predfluc}}
\index{total\_llh\_drawfluc\_predfluc@{total\_llh\_drawfluc\_predfluc}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{total\_llh\_drawfluc\_predfluc}{total\_llh\_drawfluc\_predfluc}}
{\footnotesize\ttfamily double Sample\+Summary\+::total\+\_\+llh\+\_\+drawfluc\+\_\+predfluc\hspace{0.3cm}{\ttfamily [private]}}



Fluctuated Draw vs Fluctuated Predictive. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00309}{309}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a804a117990fd1441c9e3a9d8e8d32e98}\label{classSampleSummary_a804a117990fd1441c9e3a9d8e8d32e98}} 
\index{SampleSummary@{SampleSummary}!total\_llh\_predfluc\_draw@{total\_llh\_predfluc\_draw}}
\index{total\_llh\_predfluc\_draw@{total\_llh\_predfluc\_draw}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{total\_llh\_predfluc\_draw}{total\_llh\_predfluc\_draw}}
{\footnotesize\ttfamily double Sample\+Summary\+::total\+\_\+llh\+\_\+predfluc\+\_\+draw\hspace{0.3cm}{\ttfamily [private]}}



Fluctuated Predictive vs Draw. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00293}{293}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a1f6c2e7ed8f9024cf928da5b56054e07}\label{classSampleSummary_a1f6c2e7ed8f9024cf928da5b56054e07}} 
\index{SampleSummary@{SampleSummary}!total\_llh\_predfluc\_pred@{total\_llh\_predfluc\_pred}}
\index{total\_llh\_predfluc\_pred@{total\_llh\_predfluc\_pred}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{total\_llh\_predfluc\_pred}{total\_llh\_predfluc\_pred}}
{\footnotesize\ttfamily double Sample\+Summary\+::total\+\_\+llh\+\_\+predfluc\+\_\+pred\hspace{0.3cm}{\ttfamily [private]}}



Fluctuated Predictive vs Predictive. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00313}{313}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_aaf055562efe3e5f2592942f5151ece22}\label{classSampleSummary_aaf055562efe3e5f2592942f5151ece22}} 
\index{SampleSummary@{SampleSummary}!total\_llh\_rate\_data\_draw@{total\_llh\_rate\_data\_draw}}
\index{total\_llh\_rate\_data\_draw@{total\_llh\_rate\_data\_draw}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{total\_llh\_rate\_data\_draw}{total\_llh\_rate\_data\_draw}}
{\footnotesize\ttfamily double Sample\+Summary\+::total\+\_\+llh\+\_\+rate\+\_\+data\+\_\+draw\hspace{0.3cm}{\ttfamily [private]}}



Rate Data vs Draw. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00296}{296}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a2ebe701d114669fdfcf61e1680bb144d}\label{classSampleSummary_a2ebe701d114669fdfcf61e1680bb144d}} 
\index{SampleSummary@{SampleSummary}!total\_llh\_rate\_predfluc\_draw@{total\_llh\_rate\_predfluc\_draw}}
\index{total\_llh\_rate\_predfluc\_draw@{total\_llh\_rate\_predfluc\_draw}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{total\_llh\_rate\_predfluc\_draw}{total\_llh\_rate\_predfluc\_draw}}
{\footnotesize\ttfamily double Sample\+Summary\+::total\+\_\+llh\+\_\+rate\+\_\+predfluc\+\_\+draw\hspace{0.3cm}{\ttfamily [private]}}



Fluctuated Predictive vs Draw using Rate. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00298}{298}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a7176dc4fd5368e01f00d5fcc909ee605}\label{classSampleSummary_a7176dc4fd5368e01f00d5fcc909ee605}} 
\index{SampleSummary@{SampleSummary}!ViolinHists\_ProjectX@{ViolinHists\_ProjectX}}
\index{ViolinHists\_ProjectX@{ViolinHists\_ProjectX}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{ViolinHists\_ProjectX}{ViolinHists\_ProjectX}}
{\footnotesize\ttfamily TH2D$\ast$$\ast$ Sample\+Summary\+::\+Violin\+Hists\+\_\+\+ProjectX\hspace{0.3cm}{\ttfamily [private]}}



Posterior predictive but for X projection but as a violin plot. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00154}{154}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_af4447b09538a0138de4e11c81169f821}\label{classSampleSummary_af4447b09538a0138de4e11c81169f821}} 
\index{SampleSummary@{SampleSummary}!ViolinHists\_ProjectY@{ViolinHists\_ProjectY}}
\index{ViolinHists\_ProjectY@{ViolinHists\_ProjectY}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{ViolinHists\_ProjectY}{ViolinHists\_ProjectY}}
{\footnotesize\ttfamily TH2D$\ast$$\ast$ Sample\+Summary\+::\+Violin\+Hists\+\_\+\+ProjectY\hspace{0.3cm}{\ttfamily [private]}}



Posterior predictive but for Y projection but as a violin plot. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00156}{156}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a0fd31469ea40b54ea864f5eb7360adee}\label{classSampleSummary_a0fd31469ea40b54ea864f5eb7360adee}} 
\index{SampleSummary@{SampleSummary}!w2Hist@{w2Hist}}
\index{w2Hist@{w2Hist}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{w2Hist}{w2Hist}}
{\footnotesize\ttfamily TH1D$\ast$$\ast$$\ast$ Sample\+Summary\+::w2\+Hist\hspace{0.3cm}{\ttfamily [private]}}



The posterior predictive for the whole selection\+: this gets built after adding in the toys. Now an array of Th1ds, 1 for each poly bin, for each sample for W2. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00151}{151}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a263b7541545b8b0ba735e0a3ac2d31e7}\label{classSampleSummary_a263b7541545b8b0ba735e0a3ac2d31e7}} 
\index{SampleSummary@{SampleSummary}!W2MCVector@{W2MCVector}}
\index{W2MCVector@{W2MCVector}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{W2MCVector}{W2MCVector}}
{\footnotesize\ttfamily std\+::vector$<$std\+::vector$<$TH2\+Poly$\ast$$>$ $>$ Sample\+Summary\+::\+W2\+MCVector\hspace{0.3cm}{\ttfamily [private]}}



Vector of vectors which holds the loaded W2 histograms. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00133}{133}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a520002b543541541096b79d15ca01911}\label{classSampleSummary_a520002b543541541096b79d15ca01911}} 
\index{SampleSummary@{SampleSummary}!W2MeanHist@{W2MeanHist}}
\index{W2MeanHist@{W2MeanHist}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{W2MeanHist}{W2MeanHist}}
{\footnotesize\ttfamily TH2\+Poly$\ast$$\ast$ Sample\+Summary\+::\+W2\+Mean\+Hist\hspace{0.3cm}{\ttfamily [private]}}



Pointer to the w2 histograms (for mean values). 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00169}{169}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_accde7a80fb4c8b986d1a152f88e8f515}\label{classSampleSummary_accde7a80fb4c8b986d1a152f88e8f515}} 
\index{SampleSummary@{SampleSummary}!W2ModeHist@{W2ModeHist}}
\index{W2ModeHist@{W2ModeHist}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{W2ModeHist}{W2ModeHist}}
{\footnotesize\ttfamily TH2\+Poly$\ast$$\ast$ Sample\+Summary\+::\+W2\+Mode\+Hist\hspace{0.3cm}{\ttfamily [private]}}



Pointer to the w2 histograms (for mode values). 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00171}{171}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_a8219b4f8763481e16c6b4493f97378cb}\label{classSampleSummary_a8219b4f8763481e16c6b4493f97378cb}} 
\index{SampleSummary@{SampleSummary}!W2NomHist@{W2NomHist}}
\index{W2NomHist@{W2NomHist}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{W2NomHist}{W2NomHist}}
{\footnotesize\ttfamily TH2\+Poly$\ast$$\ast$ Sample\+Summary\+::\+W2\+Nom\+Hist\hspace{0.3cm}{\ttfamily [private]}}



Pointer to the w2 histograms (for nominal values). 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00167}{167}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.

\mbox{\Hypertarget{classSampleSummary_ad40a0514f4be18ef026ea41bd5965fa3}\label{classSampleSummary_ad40a0514f4be18ef026ea41bd5965fa3}} 
\index{SampleSummary@{SampleSummary}!WeightVector@{WeightVector}}
\index{WeightVector@{WeightVector}!SampleSummary@{SampleSummary}}
\doxysubsubsection{\texorpdfstring{WeightVector}{WeightVector}}
{\footnotesize\ttfamily std\+::vector$<$double$>$ Sample\+Summary\+::\+Weight\+Vector\hspace{0.3cm}{\ttfamily [private]}}



Vector holding weight. 



Definition at line \mbox{\hyperlink{SampleSummary_8h_source_l00140}{140}} of file \mbox{\hyperlink{SampleSummary_8h_source}{Sample\+Summary.\+h}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/runner/work/\+Ma\+Ch3/\+Ma\+Ch3/mcmc/\mbox{\hyperlink{SampleSummary_8h}{Sample\+Summary.\+h}}\item 
/home/runner/work/\+Ma\+Ch3/\+Ma\+Ch3/mcmc/\mbox{\hyperlink{SampleSummary_8cpp}{Sample\+Summary.\+cpp}}\end{DoxyCompactItemize}
