<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MaCh3: Sample Handler Getters</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="MaCh3.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mach3logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MaCh3
   &#160;<span id="projectnumber">2.4.0</span>
   </div>
   <div id="projectbrief">Reference Guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Sample Handler Getters</div>  </div>
</div><!--header-->
<div class="contents">

<p>Group of functions to get various parameters, names, and values.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gac4b73a8841ff9bab2fb08b578ad4137f"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gac4b73a8841ff9bab2fb08b578ad4137f">SampleHandlerBase::GetNsamples</a> ()</td></tr>
<tr class="separator:gac4b73a8841ff9bab2fb08b578ad4137f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad3df6900450be4bbb05453e3b166e09e"><td class="memItemLeft" align="right" valign="top">virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gad3df6900450be4bbb05453e3b166e09e">SampleHandlerBase::GetSampleTitle</a> (const int Sample) const =0</td></tr>
<tr class="separator:gad3df6900450be4bbb05453e3b166e09e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadc0365a430cbe628f5ec63ef49bf6f5e"><td class="memItemLeft" align="right" valign="top">virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gadc0365a430cbe628f5ec63ef49bf6f5e">SampleHandlerBase::GetName</a> () const =0</td></tr>
<tr class="separator:gadc0365a430cbe628f5ec63ef49bf6f5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga60ce18ee8d7adbc78b9be1269f081aa3"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga60ce18ee8d7adbc78b9be1269f081aa3">SampleHandlerBase::GetSampleLikelihood</a> (const int isample) const =0</td></tr>
<tr class="separator:ga60ce18ee8d7adbc78b9be1269f081aa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4e232eb59bc09c3f8ff4cbed69fcd688"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMaCh3Modes.html">MaCh3Modes</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga4e232eb59bc09c3f8ff4cbed69fcd688">SampleHandlerBase::GetMaCh3Modes</a> () const</td></tr>
<tr class="memdesc:ga4e232eb59bc09c3f8ff4cbed69fcd688"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to MaCh3 modes.  <a href="group__SampleHandlerGetters.html#ga4e232eb59bc09c3f8ff4cbed69fcd688">More...</a><br /></td></tr>
<tr class="separator:ga4e232eb59bc09c3f8ff4cbed69fcd688"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac4cd44c594061bfc45da228220dcd950"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gac4cd44c594061bfc45da228220dcd950">SampleHandlerBase::GetLikelihood</a> () const =0</td></tr>
<tr class="separator:gac4cd44c594061bfc45da228220dcd950"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6ceca02f83e878ef1aec6e54e7b2f331"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga6ceca02f83e878ef1aec6e54e7b2f331">SampleHandlerBase::GetNEvents</a> () const</td></tr>
<tr class="separator:ga6ceca02f83e878ef1aec6e54e7b2f331"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9d9a63f16c4acc2ab7bdd39df77712d4"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga9d9a63f16c4acc2ab7bdd39df77712d4">SampleHandlerBase::GetNOscChannels</a> (const int iSample) const =0</td></tr>
<tr class="separator:ga9d9a63f16c4acc2ab7bdd39df77712d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1e55d089cbc7f13fbe43308e654e723d"><td class="memItemLeft" align="right" valign="top">virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga1e55d089cbc7f13fbe43308e654e723d">SampleHandlerBase::GetKinVarName</a> (const int iSample, const int Dimension) const =0</td></tr>
<tr class="memdesc:ga1e55d089cbc7f13fbe43308e654e723d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return Kinematic Variable name for specified sample and dimension for example "Reconstructed_Neutrino_Energy".  <a href="group__SampleHandlerGetters.html#ga1e55d089cbc7f13fbe43308e654e723d">More...</a><br /></td></tr>
<tr class="separator:ga1e55d089cbc7f13fbe43308e654e723d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae30e9cf2ee9dfa805f9a87432558e600"><td class="memItemLeft" align="right" valign="top">virtual TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gae30e9cf2ee9dfa805f9a87432558e600">SampleHandlerBase::GetDataHist</a> (const int Sample)=0</td></tr>
<tr class="memdesc:gae30e9cf2ee9dfa805f9a87432558e600"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get Data histogram.  <a href="group__SampleHandlerGetters.html#gae30e9cf2ee9dfa805f9a87432558e600">More...</a><br /></td></tr>
<tr class="separator:gae30e9cf2ee9dfa805f9a87432558e600"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7a6f0525d4e4f941fc1af4709042add3"><td class="memItemLeft" align="right" valign="top">virtual TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga7a6f0525d4e4f941fc1af4709042add3">SampleHandlerBase::GetMCHist</a> (const int Sample)=0</td></tr>
<tr class="memdesc:ga7a6f0525d4e4f941fc1af4709042add3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get MC histogram.  <a href="group__SampleHandlerGetters.html#ga7a6f0525d4e4f941fc1af4709042add3">More...</a><br /></td></tr>
<tr class="separator:ga7a6f0525d4e4f941fc1af4709042add3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5ea53e5e6adb5b4e6281a3d1ce910c3a"><td class="memItemLeft" align="right" valign="top">virtual TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga5ea53e5e6adb5b4e6281a3d1ce910c3a">SampleHandlerBase::GetW2Hist</a> (const int Sample)=0</td></tr>
<tr class="memdesc:ga5ea53e5e6adb5b4e6281a3d1ce910c3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get W2 histogram.  <a href="group__SampleHandlerGetters.html#ga5ea53e5e6adb5b4e6281a3d1ce910c3a">More...</a><br /></td></tr>
<tr class="separator:ga5ea53e5e6adb5b4e6281a3d1ce910c3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae5849766fbbc7aa71672da8b0f189fe5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gae5849766fbbc7aa71672da8b0f189fe5">SampleHandlerBase::GetPoissonLLH</a> (const double data, const double mc) const</td></tr>
<tr class="memdesc:gae5849766fbbc7aa71672da8b0f189fe5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate test statistic for a single bin using Poisson.  <a href="group__SampleHandlerGetters.html#gae5849766fbbc7aa71672da8b0f189fe5">More...</a><br /></td></tr>
<tr class="separator:gae5849766fbbc7aa71672da8b0f189fe5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga527307a4186e2eb61475ea975108aa65"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga527307a4186e2eb61475ea975108aa65">SampleHandlerBase::GetTestStatLLH</a> (const double data, const double mc, const double w2) const</td></tr>
<tr class="memdesc:ga527307a4186e2eb61475ea975108aa65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate test statistic for a single bin. Calculation depends on setting of <code>fTestStatistic</code>. Data and mc -&gt; 0 cut-offs are defined in <a class="el" href="namespaceM3.html" title="Main namespace for MaCh3 software.">M3</a>::<em>LOW_MC_BOUND</em>.  <a href="group__SampleHandlerGetters.html#ga527307a4186e2eb61475ea975108aa65">More...</a><br /></td></tr>
<tr class="separator:ga527307a4186e2eb61475ea975108aa65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1c81b6b7a7e70b04c6c6ca1c81c70fc5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga1c81b6b7a7e70b04c6c6ca1c81c70fc5">SampleHandlerBase::SetTestStatistic</a> (<a class="el" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67">TestStatistic</a> testStat)</td></tr>
<tr class="memdesc:ga1c81b6b7a7e70b04c6c6ca1c81c70fc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the test statistic to be used when calculating the binned likelihoods.  <a href="group__SampleHandlerGetters.html#ga1c81b6b7a7e70b04c6c6ca1c81c70fc5">More...</a><br /></td></tr>
<tr class="separator:ga1c81b6b7a7e70b04c6c6ca1c81c70fc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga23987526c4fed2f7426632c6935864e1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga23987526c4fed2f7426632c6935864e1">SampleHandlerFD::GetNDim</a> (const int Sample) const</td></tr>
<tr class="memdesc:ga23987526c4fed2f7426632c6935864e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">DB Function to differentiate 1D or 2D binning.  <a href="group__SampleHandlerGetters.html#ga23987526c4fed2f7426632c6935864e1">More...</a><br /></td></tr>
<tr class="separator:ga23987526c4fed2f7426632c6935864e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6101b46360ae54fe37dd1243f3f7f51e"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga6101b46360ae54fe37dd1243f3f7f51e">SampleHandlerFD::GetName</a> () const override</td></tr>
<tr class="separator:ga6101b46360ae54fe37dd1243f3f7f51e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadfad2507ad845ad36fff3c82231a143c"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gadfad2507ad845ad36fff3c82231a143c">SampleHandlerFD::GetSampleTitle</a> (const int Sample) const override</td></tr>
<tr class="separator:gadfad2507ad845ad36fff3c82231a143c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7f3923d1e2b39df2e1bf2348312925a6"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga7f3923d1e2b39df2e1bf2348312925a6">SampleHandlerFD::GetKinVarName</a> (const int iSample, const int Dimension) const override</td></tr>
<tr class="memdesc:ga7f3923d1e2b39df2e1bf2348312925a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return Kinematic Variable name for specified sample and dimension for example "Reconstructed_Neutrino_Energy".  <a href="group__SampleHandlerGetters.html#ga7f3923d1e2b39df2e1bf2348312925a6">More...</a><br /></td></tr>
<tr class="separator:ga7f3923d1e2b39df2e1bf2348312925a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9aebf7da41ad6ddb87e3081a7f4763ec"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga9aebf7da41ad6ddb87e3081a7f4763ec">SampleHandlerFD::GetXBinVarName</a> (const int Sample) const</td></tr>
<tr class="separator:ga9aebf7da41ad6ddb87e3081a7f4763ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga69d66592696bee9e73f61649c681a573"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga69d66592696bee9e73f61649c681a573">SampleHandlerFD::GetYBinVarName</a> (const int Sample) const</td></tr>
<tr class="separator:ga69d66592696bee9e73f61649c681a573"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaac2deb8881a00c85951a3e8a6653393"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gaaac2deb8881a00c85951a3e8a6653393">SampleHandlerFD::GetSampleLikelihood</a> (const int isample) const override</td></tr>
<tr class="memdesc:gaaac2deb8881a00c85951a3e8a6653393"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get likelihood for single sample.  <a href="group__SampleHandlerGetters.html#gaaac2deb8881a00c85951a3e8a6653393">More...</a><br /></td></tr>
<tr class="separator:gaaac2deb8881a00c85951a3e8a6653393"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad83a84cec68b96cb50eaaf1a40f96edf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gad83a84cec68b96cb50eaaf1a40f96edf">SampleHandlerFD::GetSampleIndex</a> (const std::string &amp;SampleTitle) const</td></tr>
<tr class="memdesc:gad83a84cec68b96cb50eaaf1a40f96edf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get index of sample based on name.  <a href="group__SampleHandlerGetters.html#gad83a84cec68b96cb50eaaf1a40f96edf">More...</a><br /></td></tr>
<tr class="separator:gad83a84cec68b96cb50eaaf1a40f96edf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac2fa527d43bfe7b5dccf767b2445fbb0"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gac2fa527d43bfe7b5dccf767b2445fbb0">SampleHandlerFD::GetDataHist</a> (const int Sample) override</td></tr>
<tr class="memdesc:gac2fa527d43bfe7b5dccf767b2445fbb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get Data histogram.  <a href="group__SampleHandlerGetters.html#gac2fa527d43bfe7b5dccf767b2445fbb0">More...</a><br /></td></tr>
<tr class="separator:gac2fa527d43bfe7b5dccf767b2445fbb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaef4a66f22b067c8125af5fe799f5a804"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gaef4a66f22b067c8125af5fe799f5a804">SampleHandlerFD::GetMCHist</a> (const int Sample) override</td></tr>
<tr class="memdesc:gaef4a66f22b067c8125af5fe799f5a804"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get MC histogram.  <a href="group__SampleHandlerGetters.html#gaef4a66f22b067c8125af5fe799f5a804">More...</a><br /></td></tr>
<tr class="separator:gaef4a66f22b067c8125af5fe799f5a804"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9a47c08f11d5019f5f237cddd279ef9c"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga9a47c08f11d5019f5f237cddd279ef9c">SampleHandlerFD::GetW2Hist</a> (const int Sample) override</td></tr>
<tr class="memdesc:ga9a47c08f11d5019f5f237cddd279ef9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get W2 histogram.  <a href="group__SampleHandlerGetters.html#ga9a47c08f11d5019f5f237cddd279ef9c">More...</a><br /></td></tr>
<tr class="separator:ga9a47c08f11d5019f5f237cddd279ef9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaac276e3f10be081ce8e7f94df131490d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gaac276e3f10be081ce8e7f94df131490d">SampleHandlerFD::GetNOscChannels</a> (const int iSample) const override</td></tr>
<tr class="separator:gaac276e3f10be081ce8e7f94df131490d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga19cffdf18f1fb12f68b262907671801d"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga19cffdf18f1fb12f68b262907671801d">SampleHandlerFD::GetFlavourName</a> (const int iSample, const int iChannel)</td></tr>
<tr class="separator:ga19cffdf18f1fb12f68b262907671801d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga95adaa63edf9453f12eed965a3bf46cf"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga95adaa63edf9453f12eed965a3bf46cf">SampleHandlerFD::Get1DVarHist</a> (const int iSample, const std::string &amp;ProjectionVar, const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;EventSelectionVec=std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt;(), int WeightStyle=0, TAxis *Axis=nullptr, const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;SubEventSelectionVec=std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt;())</td></tr>
<tr class="separator:ga95adaa63edf9453f12eed965a3bf46cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1a2660d3a532d059eea9865672cb9544"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga1a2660d3a532d059eea9865672cb9544">SampleHandlerFD::Fill1DSubEventHist</a> (const int iSample, TH1D *_h1DVar, const std::string &amp;ProjectionVar, const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;SubEventSelectionVec=std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt;(), int WeightStyle=0)</td></tr>
<tr class="separator:ga1a2660d3a532d059eea9865672cb9544"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf193072f552cac18955b2197bd106ed1"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gaf193072f552cac18955b2197bd106ed1">SampleHandlerFD::Get1DVarHistByModeAndChannel</a> (const int iSample, const std::string &amp;ProjectionVar_Str, int kModeToFill=-1, int kChannelToFill=-1, int WeightStyle=0, TAxis *Axis=nullptr)</td></tr>
<tr class="separator:gaf193072f552cac18955b2197bd106ed1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga463c2e2cdba7afd948295a1a9833cd9b"><td class="memItemLeft" align="right" valign="top">TH2 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga463c2e2cdba7afd948295a1a9833cd9b">SampleHandlerFD::Get2DVarHistByModeAndChannel</a> (const int iSample, const std::string &amp;ProjectionVar_StrX, const std::string &amp;ProjectionVar_StrY, int kModeToFill=-1, int kChannelToFill=-1, int WeightStyle=0, TAxis *AxisX=nullptr, TAxis *AxisY=nullptr)</td></tr>
<tr class="separator:ga463c2e2cdba7afd948295a1a9833cd9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac453c29b475060135d911e4c23d0cb48"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gac453c29b475060135d911e4c23d0cb48">SampleHandlerFD::GetModeHist1D</a> (const int iSample, int s, int m, int style=0)</td></tr>
<tr class="separator:gac453c29b475060135d911e4c23d0cb48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga386667b346c7937285076aadf1f7c0a9"><td class="memItemLeft" align="right" valign="top">TH2 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga386667b346c7937285076aadf1f7c0a9">SampleHandlerFD::GetModeHist2D</a> (const int iSample, int s, int m, int style=0)</td></tr>
<tr class="separator:ga386667b346c7937285076aadf1f7c0a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa5a0b0ed2e81af8e60a7fbda65971441"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH1 * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gaa5a0b0ed2e81af8e60a7fbda65971441">SampleHandlerFD::ReturnHistsBySelection1D</a> (const int iSample, std::string KinematicProjection, int Selection1, int Selection2=-1, int WeightStyle=0, TAxis *Axis=0)</td></tr>
<tr class="separator:gaa5a0b0ed2e81af8e60a7fbda65971441"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf9d1ac8ae54628f20b02d0a6c2458822"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH2 * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gaf9d1ac8ae54628f20b02d0a6c2458822">SampleHandlerFD::ReturnHistsBySelection2D</a> (const int iSample, std::string KinematicProjectionX, std::string KinematicProjectionY, int Selection1, int Selection2=-1, int WeightStyle=0, TAxis *XAxis=0, TAxis *YAxis=0)</td></tr>
<tr class="separator:gaf9d1ac8ae54628f20b02d0a6c2458822"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga75481a54d71de4d814b558bf00c4fe3f"><td class="memItemLeft" align="right" valign="top">THStack *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga75481a54d71de4d814b558bf00c4fe3f">SampleHandlerFD::ReturnStackedHistBySelection1D</a> (const int iSample, const std::string &amp;KinematicProjection, int Selection1, int Selection2=-1, int WeightStyle=0, TAxis *Axis=0)</td></tr>
<tr class="separator:ga75481a54d71de4d814b558bf00c4fe3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8be73835c2d9f0e50d738c4f204a0286"><td class="memItemLeft" align="right" valign="top">TLegend *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga8be73835c2d9f0e50d738c4f204a0286">SampleHandlerFD::ReturnStackHistLegend</a> ()</td></tr>
<tr class="separator:ga8be73835c2d9f0e50d738c4f204a0286"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae2769d593f34e8356b545af076818f89"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gae2769d593f34e8356b545af076818f89">SampleHandlerFD::ReturnKinematicParameterFromString</a> (const std::string &amp;KinematicStr) const</td></tr>
<tr class="memdesc:gae2769d593f34e8356b545af076818f89"><td class="mdescLeft">&#160;</td><td class="mdescRight">ETA function to generically convert a string from xsec cov to a kinematic type.  <a href="group__SampleHandlerGetters.html#gae2769d593f34e8356b545af076818f89">More...</a><br /></td></tr>
<tr class="separator:gae2769d593f34e8356b545af076818f89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3e88e3720a6a8d3384a6b8d317795c74"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga3e88e3720a6a8d3384a6b8d317795c74">SampleHandlerFD::ReturnStringFromKinematicParameter</a> (const int KinematicVariable) const</td></tr>
<tr class="memdesc:ga3e88e3720a6a8d3384a6b8d317795c74"><td class="mdescLeft">&#160;</td><td class="mdescRight">ETA function to generically convert a kinematic type from xsec cov to a string.  <a href="group__SampleHandlerGetters.html#ga3e88e3720a6a8d3384a6b8d317795c74">More...</a><br /></td></tr>
<tr class="separator:ga3e88e3720a6a8d3384a6b8d317795c74"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Group of functions to get various parameters, names, and values. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga1a2660d3a532d059eea9865672cb9544"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1a2660d3a532d059eea9865672cb9544">&#9670;&nbsp;</a></span>Fill1DSubEventHist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::Fill1DSubEventHist </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1D *&#160;</td>
          <td class="paramname"><em>_h1DVar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>SubEventSelectionVec</em> = <code>std::vector&lt;&#160;<a class="el" href="structKinematicCut.html">KinematicCut</a>&#160;&gt;()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01401">1401</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                                                                                                                                                                                     {</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;  <span class="keywordtype">int</span> ProjectionVar_Int = <a class="code" href="classSampleHandlerFD.html#ad81e082a5a4c86e51fc748bffd1dfa9e">ReturnKinematicVectorFromString</a>(ProjectionVar_Str);</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160; </div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;  <span class="comment">//JM Loop over all events</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iEvent = 0; iEvent &lt; <a class="code" href="group__SampleHandlerGetters.html#ga6ceca02f83e878ef1aec6e54e7b2f331">GetNEvents</a>(); iEvent++) {</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> EventSample = <a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].NominalSample;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="keywordflow">if</span>(EventSample != iSample) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#af67a9a10193e12526e3284d48f425185">IsEventSelected</a>(EventSample, iEvent)) {</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      <span class="keywordtype">double</span> Weight = <a class="code" href="classSampleHandlerFD.html#a6831d91d5bcf1fb5723167736e0082ef">GetEventWeight</a>(iEvent);</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      <span class="keywordflow">if</span> (WeightStyle == 1) {</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;        Weight = 1.;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      }</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;      std::vector&lt;double&gt; Vec = <a class="code" href="classSampleHandlerFD.html#ae98d72c6c30697e32fcb464923456fc0">ReturnKinematicVector</a>(ProjectionVar_Int,iEvent);</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      <span class="keywordtype">size_t</span> nsubevents = Vec.size();</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;      <span class="comment">//JM Loop over all subevents in event</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iSubEvent = 0; iSubEvent &lt; nsubevents; iSubEvent++) {</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#aacc4d573b8e4569269b51ac325bc0092">IsSubEventSelected</a>(SubEventSelectionVec, iEvent, iSubEvent, nsubevents)) {</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;          <span class="keywordtype">double</span> Var = Vec[iSubEvent];</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;          _h1DVar-&gt;Fill(Var,Weight);</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        }</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;      }</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    }</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;  }</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a6831d91d5bcf1fb5723167736e0082ef"><div class="ttname"><a href="classSampleHandlerFD.html#a6831d91d5bcf1fb5723167736e0082ef">SampleHandlerFD::GetEventWeight</a></div><div class="ttdeci">M3::float_t GetEventWeight(const int iEntry)</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01157">SampleHandlerFD.cpp:1157</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_aacc4d573b8e4569269b51ac325bc0092"><div class="ttname"><a href="classSampleHandlerFD.html#aacc4d573b8e4569269b51ac325bc0092">SampleHandlerFD::IsSubEventSelected</a></div><div class="ttdeci">bool IsSubEventSelected(const std::vector&lt; KinematicCut &gt; &amp;SubEventCuts, const int iEvent, unsigned const int iSubEvent, size_t nsubevents)</div><div class="ttdoc">JM Function which determines if a subevent is selected.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00304">SampleHandlerFD.cpp:304</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ad81e082a5a4c86e51fc748bffd1dfa9e"><div class="ttname"><a href="classSampleHandlerFD.html#ad81e082a5a4c86e51fc748bffd1dfa9e">SampleHandlerFD::ReturnKinematicVectorFromString</a></div><div class="ttdeci">int ReturnKinematicVectorFromString(const std::string &amp;KinematicStr) const</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01569">SampleHandlerFD.cpp:1569</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ae422410559d7f3af0e0a80cc15fbfbff"><div class="ttname"><a href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">SampleHandlerFD::MCSamples</a></div><div class="ttdeci">std::vector&lt; EventInfo &gt; MCSamples</div><div class="ttdoc">Stores information about every MC event.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00347">SampleHandlerFD.h:347</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ae98d72c6c30697e32fcb464923456fc0"><div class="ttname"><a href="classSampleHandlerFD.html#ae98d72c6c30697e32fcb464923456fc0">SampleHandlerFD::ReturnKinematicVector</a></div><div class="ttdeci">virtual std::vector&lt; double &gt; ReturnKinematicVector(std::string KinematicParameter, int iEvent)</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00295">SampleHandlerFD.h:295</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_af67a9a10193e12526e3284d48f425185"><div class="ttname"><a href="classSampleHandlerFD.html#af67a9a10193e12526e3284d48f425185">SampleHandlerFD::IsEventSelected</a></div><div class="ttdeci">bool IsEventSelected(const int iSample, const int iEvent) _noexcept_</div><div class="ttdoc">DB Function which determines if an event is selected, where Selection double looks like {{ND280Kinema...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00288">SampleHandlerFD.cpp:288</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_ga6ceca02f83e878ef1aec6e54e7b2f331"><div class="ttname"><a href="group__SampleHandlerGetters.html#ga6ceca02f83e878ef1aec6e54e7b2f331">SampleHandlerBase::GetNEvents</a></div><div class="ttdeci">unsigned int GetNEvents() const</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00059">SampleHandlerBase.h:59</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga95adaa63edf9453f12eed965a3bf46cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga95adaa63edf9453f12eed965a3bf46cf">&#9670;&nbsp;</a></span>Get1DVarHist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TH1 * SampleHandlerFD::Get1DVarHist </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>EventSelectionVec</em> = <code>std::vector&lt;<a class="el" href="structKinematicCut.html">KinematicCut</a>&gt;()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>Axis</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>SubEventSelectionVec</em> = <code>std::vector&lt;<a class="el" href="structKinematicCut.html">KinematicCut</a>&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01346">1346</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                                                                                         {</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;  <span class="comment">//DB Need to overwrite the Selection member variable so that IsEventSelected function operates correctly.</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  <span class="comment">//   Consequently, store the selection cuts already saved in the sample, overwrite the Selection variable, then reset</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  std::vector&lt; std::vector&lt; KinematicCut &gt; &gt; tmp_Selection = <a class="code" href="classSampleHandlerFD.html#a07b3357278429dfe809d7d9d27682bf9">Selection</a>;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  std::vector&lt; std::vector&lt; KinematicCut &gt; &gt; SelectionVecToApply;</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160; </div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;  <span class="comment">//DB Add all the predefined selections to the selection vector which will be applied</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;  SelectionVecToApply = tmp_Selection;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160; </div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  <span class="comment">//DB Add all requested cuts from the argument to the selection vector which will be applied</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iSelec=0;iSelec&lt;EventSelectionVec.size();iSelec++) {</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    SelectionVecToApply[iSample].emplace_back(EventSelectionVec[iSelec]);</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  }</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160; </div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;  <span class="comment">//DB Set the member variable to be the cuts to apply</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a07b3357278429dfe809d7d9d27682bf9">Selection</a> = SelectionVecToApply;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160; </div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  <span class="comment">//DB Define the histogram which will be returned</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  TH1D* _h1DVar = <span class="keyword">nullptr</span>;;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  <span class="keywordflow">if</span> (Axis) {</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    _h1DVar = <span class="keyword">new</span> TH1D(<span class="stringliteral">&quot;&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,Axis-&gt;GetNbins(),Axis-&gt;GetXbins()-&gt;GetArray());</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    std::vector&lt;double&gt; xBinEdges = <a class="code" href="classSampleHandlerFD.html#a2cee961e07a80484fe568898f41e4965">ReturnKinematicParameterBinning</a>(iSample, ProjectionVar_Str);</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    _h1DVar = <span class="keyword">new</span> TH1D(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="keywordtype">int</span>(xBinEdges.size())-1, xBinEdges.data());</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  }</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  _h1DVar-&gt;GetXaxis()-&gt;SetTitle(ProjectionVar_Str.c_str());</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160; </div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#ad14d9728400a7b87f095aca00761b829">IsSubEventVarString</a>(ProjectionVar_Str)) {</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <a class="code" href="group__SampleHandlerGetters.html#ga1a2660d3a532d059eea9865672cb9544">Fill1DSubEventHist</a>(iSample, _h1DVar, ProjectionVar_Str, SubEventSelectionVec, WeightStyle);</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    <span class="comment">//DB Grab the associated enum with the argument string</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <span class="keywordtype">int</span> ProjectionVar_Int = <a class="code" href="group__SampleHandlerGetters.html#gae2769d593f34e8356b545af076818f89">ReturnKinematicParameterFromString</a>(ProjectionVar_Str);</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160; </div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="comment">//DB Loop over all events</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iEvent = 0; iEvent &lt; <a class="code" href="group__SampleHandlerGetters.html#ga6ceca02f83e878ef1aec6e54e7b2f331">GetNEvents</a>(); iEvent++) {</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> EventSample = <a class="code" href="classSampleHandlerFD.html#ae422410559d7f3af0e0a80cc15fbfbff">MCSamples</a>[iEvent].NominalSample;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;      <span class="keywordflow">if</span>(EventSample != iSample) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#af67a9a10193e12526e3284d48f425185">IsEventSelected</a>(EventSample, iEvent)) {</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;        <span class="keywordtype">double</span> Weight = <a class="code" href="classSampleHandlerFD.html#a6831d91d5bcf1fb5723167736e0082ef">GetEventWeight</a>(iEvent);</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;        <span class="keywordflow">if</span> (WeightStyle == 1) {</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;          Weight = 1.;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        }</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;        <span class="keywordtype">double</span> Var = <a class="code" href="classSampleHandlerFD.html#ad0f549802b5625871e11d86905989697">ReturnKinematicParameter</a>(ProjectionVar_Int, iEvent);</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        _h1DVar-&gt;Fill(Var, Weight);</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      }</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    }</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;  }</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;  <span class="comment">//DB Reset the saved selection</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a07b3357278429dfe809d7d9d27682bf9">Selection</a> = tmp_Selection;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160; </div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;  <span class="keywordflow">return</span> _h1DVar;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a07b3357278429dfe809d7d9d27682bf9"><div class="ttname"><a href="classSampleHandlerFD.html#a07b3357278429dfe809d7d9d27682bf9">SampleHandlerFD::Selection</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; KinematicCut &gt; &gt; Selection</div><div class="ttdoc">a way to store selection cuts which you may push back in the get1DVar functions most of the time this...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00373">SampleHandlerFD.h:373</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a2cee961e07a80484fe568898f41e4965"><div class="ttname"><a href="classSampleHandlerFD.html#a2cee961e07a80484fe568898f41e4965">SampleHandlerFD::ReturnKinematicParameterBinning</a></div><div class="ttdeci">std::vector&lt; double &gt; ReturnKinematicParameterBinning(const int Sample, const std::string &amp;KinematicParameter) const override</div><div class="ttdoc">Return the binning used to draw a kinematic parameter.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01595">SampleHandlerFD.cpp:1595</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ad0f549802b5625871e11d86905989697"><div class="ttname"><a href="classSampleHandlerFD.html#ad0f549802b5625871e11d86905989697">SampleHandlerFD::ReturnKinematicParameter</a></div><div class="ttdeci">virtual double ReturnKinematicParameter(std::string KinematicParamter, int iEvent)=0</div><div class="ttdoc">Return the value of an associated kinematic parameter for an event.</div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ad14d9728400a7b87f095aca00761b829"><div class="ttname"><a href="classSampleHandlerFD.html#ad14d9728400a7b87f095aca00761b829">SampleHandlerFD::IsSubEventVarString</a></div><div class="ttdeci">bool IsSubEventVarString(const std::string &amp;VarStr)</div><div class="ttdoc">JM Check if a kinematic parameter string corresponds to a subevent-level variable.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01632">SampleHandlerFD.cpp:1632</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_ga1a2660d3a532d059eea9865672cb9544"><div class="ttname"><a href="group__SampleHandlerGetters.html#ga1a2660d3a532d059eea9865672cb9544">SampleHandlerFD::Fill1DSubEventHist</a></div><div class="ttdeci">void Fill1DSubEventHist(const int iSample, TH1D *_h1DVar, const std::string &amp;ProjectionVar, const std::vector&lt; KinematicCut &gt; &amp;SubEventSelectionVec=std::vector&lt; KinematicCut &gt;(), int WeightStyle=0)</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01401">SampleHandlerFD.cpp:1401</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_gae2769d593f34e8356b545af076818f89"><div class="ttname"><a href="group__SampleHandlerGetters.html#gae2769d593f34e8356b545af076818f89">SampleHandlerFD::ReturnKinematicParameterFromString</a></div><div class="ttdeci">int ReturnKinematicParameterFromString(const std::string &amp;KinematicStr) const</div><div class="ttdoc">ETA function to generically convert a string from xsec cov to a kinematic type.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01542">SampleHandlerFD.cpp:1542</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gaf193072f552cac18955b2197bd106ed1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf193072f552cac18955b2197bd106ed1">&#9670;&nbsp;</a></span>Get1DVarHistByModeAndChannel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TH1 * SampleHandlerFD::Get1DVarHistByModeAndChannel </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVar_Str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kModeToFill</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kChannelToFill</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>Axis</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01698">1698</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;                                                                       {</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  <span class="keyword">auto</span> SelectionVec = <a class="code" href="classSampleHandlerFD.html#a8d9a0e8af47eee94ae9b535d9c7122d4">BuildModeChannelSelection</a>(iSample, kModeToFill, kChannelToFill);</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__SampleHandlerGetters.html#ga95adaa63edf9453f12eed965a3bf46cf">Get1DVarHist</a>(iSample, ProjectionVar_Str, SelectionVec, WeightStyle, Axis);</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a8d9a0e8af47eee94ae9b535d9c7122d4"><div class="ttname"><a href="classSampleHandlerFD.html#a8d9a0e8af47eee94ae9b535d9c7122d4">SampleHandlerFD::BuildModeChannelSelection</a></div><div class="ttdeci">std::vector&lt; KinematicCut &gt; BuildModeChannelSelection(const int iSample, const int kModeToFill, const int kChannelToFill) const</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01647">SampleHandlerFD.cpp:1647</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_ga95adaa63edf9453f12eed965a3bf46cf"><div class="ttname"><a href="group__SampleHandlerGetters.html#ga95adaa63edf9453f12eed965a3bf46cf">SampleHandlerFD::Get1DVarHist</a></div><div class="ttdeci">TH1 * Get1DVarHist(const int iSample, const std::string &amp;ProjectionVar, const std::vector&lt; KinematicCut &gt; &amp;EventSelectionVec=std::vector&lt; KinematicCut &gt;(), int WeightStyle=0, TAxis *Axis=nullptr, const std::vector&lt; KinematicCut &gt; &amp;SubEventSelectionVec=std::vector&lt; KinematicCut &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01346">SampleHandlerFD.cpp:1346</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga463c2e2cdba7afd948295a1a9833cd9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga463c2e2cdba7afd948295a1a9833cd9b">&#9670;&nbsp;</a></span>Get2DVarHistByModeAndChannel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TH2 * SampleHandlerFD::Get2DVarHistByModeAndChannel </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVar_StrX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVar_StrY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kModeToFill</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kChannelToFill</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>AxisX</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>AxisY</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01706">1706</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                                                                                      {</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;  <span class="keyword">auto</span> SelectionVec = <a class="code" href="classSampleHandlerFD.html#a8d9a0e8af47eee94ae9b535d9c7122d4">BuildModeChannelSelection</a>(iSample, kModeToFill, kChannelToFill);</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#ac5234e3fdfc43fa499744502b28c54be">Get2DVarHist</a>(iSample, ProjectionVar_StrX, ProjectionVar_StrY, SelectionVec, WeightStyle, AxisX,AxisY);</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_ac5234e3fdfc43fa499744502b28c54be"><div class="ttname"><a href="classSampleHandlerFD.html#ac5234e3fdfc43fa499744502b28c54be">SampleHandlerFD::Get2DVarHist</a></div><div class="ttdeci">TH2 * Get2DVarHist(const int iSample, const std::string &amp;ProjectionVarX, const std::string &amp;ProjectionVarY, const std::vector&lt; KinematicCut &gt; &amp;EventSelectionVec=std::vector&lt; KinematicCut &gt;(), int WeightStyle=0, TAxis *AxisX=nullptr, TAxis *AxisY=nullptr, const std::vector&lt; KinematicCut &gt; &amp;SubEventSelectionVec=std::vector&lt; KinematicCut &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01427">SampleHandlerFD.cpp:1427</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gac2fa527d43bfe7b5dccf767b2445fbb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac2fa527d43bfe7b5dccf767b2445fbb0">&#9670;&nbsp;</a></span>GetDataHist() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH1 * SampleHandlerFD::GetDataHist </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get Data histogram. </p>

<p>Implements <a class="el" href="group__SampleHandlerGetters.html#gae30e9cf2ee9dfa805f9a87432558e600">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00927">927</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                                                  {</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].DataHist == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Can&#39;t access {} for {}Dimensions&quot;</span>, __func__, <a class="code" href="group__SampleHandlerGetters.html#ga23987526c4fed2f7426632c6935864e1">GetNDim</a>(Sample));</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  }</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].DataHist;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a61052119a625282d0ec6d4a97adf3ee2"><div class="ttname"><a href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a></div><div class="ttdeci">#define MACH3LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00037">MaCh3Logger.h:37</a></div></div>
<div class="ttc" id="aclassMaCh3Exception_html"><div class="ttname"><a href="classMaCh3Exception.html">MaCh3Exception</a></div><div class="ttdoc">Custom exception class used throughout MaCh3.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Exception_8h_source.html#l00023">MaCh3Exception.h:23</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a115728f4ba502c93ffd447fb5457aac6"><div class="ttname"><a href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleHandlerFD::SampleDetails</a></div><div class="ttdeci">std::vector&lt; SampleInfo &gt; SampleDetails</div><div class="ttdoc">Stores info about currently initialised sample.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00349">SampleHandlerFD.h:349</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_ga23987526c4fed2f7426632c6935864e1"><div class="ttname"><a href="group__SampleHandlerGetters.html#ga23987526c4fed2f7426632c6935864e1">SampleHandlerFD::GetNDim</a></div><div class="ttdeci">int GetNDim(const int Sample) const</div><div class="ttdoc">DB Function to differentiate 1D or 2D binning.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00032">SampleHandlerFD.h:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gae30e9cf2ee9dfa805f9a87432558e600"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae30e9cf2ee9dfa805f9a87432558e600">&#9670;&nbsp;</a></span>GetDataHist() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual TH1* SampleHandlerBase::GetDataHist </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get Data histogram. </p>

<p>Implemented in <a class="el" href="group__SampleHandlerGetters.html#gac2fa527d43bfe7b5dccf767b2445fbb0">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#abf412be6b795ad8d4b76e0d0d8a737ce">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="ga19cffdf18f1fb12f68b262907671801d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga19cffdf18f1fb12f68b262907671801d">&#9670;&nbsp;</a></span>GetFlavourName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::GetFlavourName </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iChannel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00106">106</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                                                                  {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">if</span> (iChannel &lt; 0 || iChannel &gt; <a class="code" href="group__SampleHandlerGetters.html#gaac276e3f10be081ce8e7f94df131490d">GetNOscChannels</a>(iSample)) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Invalid Channel Requested: {}&quot;</span>, iChannel);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__);      </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[iSample].OscChannels[iChannel].flavourName;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  }</div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_gaac276e3f10be081ce8e7f94df131490d"><div class="ttname"><a href="group__SampleHandlerGetters.html#gaac276e3f10be081ce8e7f94df131490d">SampleHandlerFD::GetNOscChannels</a></div><div class="ttdeci">int GetNOscChannels(const int iSample) const override</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00103">SampleHandlerFD.h:103</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga1e55d089cbc7f13fbe43308e654e723d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1e55d089cbc7f13fbe43308e654e723d">&#9670;&nbsp;</a></span>GetKinVarName() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::string SampleHandlerBase::GetKinVarName </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Dimension</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return Kinematic Variable name for specified sample and dimension for example "Reconstructed_Neutrino_Energy". </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iSample</td><td>Sample index </td></tr>
    <tr><td class="paramname">Dimension</td><td>Dimension index </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="group__SampleHandlerGetters.html#ga7f3923d1e2b39df2e1bf2348312925a6">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#a8dab325f56215c56ecf058707459dfb9">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="ga7f3923d1e2b39df2e1bf2348312925a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7f3923d1e2b39df2e1bf2348312925a6">&#9670;&nbsp;</a></span>GetKinVarName() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::GetKinVarName </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Dimension</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return Kinematic Variable name for specified sample and dimension for example "Reconstructed_Neutrino_Energy". </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iSample</td><td>Sample index </td></tr>
    <tr><td class="paramname">Dimension</td><td>Dimension index </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="group__SampleHandlerGetters.html#ga1e55d089cbc7f13fbe43308e654e723d">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01996">1996</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;                                                                                     {</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;<span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;  <span class="keywordflow">if</span>(Dimension &gt; <a class="code" href="group__SampleHandlerGetters.html#ga23987526c4fed2f7426632c6935864e1">GetNDim</a>(iSample)) {</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Asking for dimension {}, while sample: {} only has {}&quot;</span>, Dimension, <a class="code" href="group__SampleHandlerGetters.html#gadfad2507ad845ad36fff3c82231a143c">GetSampleTitle</a>(iSample), <a class="code" href="group__SampleHandlerGetters.html#ga23987526c4fed2f7426632c6935864e1">GetNDim</a>(iSample));</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;  }</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[iSample].VarStr[Dimension];</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;}</div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_gadfad2507ad845ad36fff3c82231a143c"><div class="ttname"><a href="group__SampleHandlerGetters.html#gadfad2507ad845ad36fff3c82231a143c">SampleHandlerFD::GetSampleTitle</a></div><div class="ttdeci">std::string GetSampleTitle(const int Sample) const override</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00036">SampleHandlerFD.h:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gac4cd44c594061bfc45da228220dcd950"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac4cd44c594061bfc45da228220dcd950">&#9670;&nbsp;</a></span>GetLikelihood()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double SampleHandlerBase::GetLikelihood </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classSampleHandlerFD.html#a25b63e394dab02d0b2d278ff55642fd9">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#a6bcfa5975956a489634a8540d3f231c1">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="ga4e232eb59bc09c3f8ff4cbed69fcd688"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4e232eb59bc09c3f8ff4cbed69fcd688">&#9670;&nbsp;</a></span>GetMaCh3Modes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMaCh3Modes.html">MaCh3Modes</a>* SampleHandlerBase::GetMaCh3Modes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return pointer to MaCh3 modes. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8h_source.html#l00048">48</a> of file <a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>.get(); }</div>
<div class="ttc" id="aclassSampleHandlerBase_html_a2f86c6158b755b9d2d400415ccac45f2"><div class="ttname"><a href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">SampleHandlerBase::Modes</a></div><div class="ttdeci">std::unique_ptr&lt; MaCh3Modes &gt; Modes</div><div class="ttdoc">Holds information about used Generator and MaCh3 modes.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00217">SampleHandlerBase.h:217</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gaef4a66f22b067c8125af5fe799f5a804"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaef4a66f22b067c8125af5fe799f5a804">&#9670;&nbsp;</a></span>GetMCHist() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH1 * SampleHandlerFD::GetMCHist </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get MC histogram. </p>

<p>Implements <a class="el" href="group__SampleHandlerGetters.html#ga7a6f0525d4e4f941fc1af4709042add3">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00909">909</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                                                {</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a5eab24c8508cdd247c23b9bd9b3017b0">FillHist</a>(Sample, <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].MCHist, <a class="code" href="classSampleHandlerFD.html#a85415d4ac54a5aefe78e5ab4d7bdb769">SampleHandlerFD_array</a>);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].MCHist == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Can&#39;t access {} for {}Dimensions&quot;</span>, __func__, <a class="code" href="group__SampleHandlerGetters.html#ga23987526c4fed2f7426632c6935864e1">GetNDim</a>(Sample));</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  }</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].MCHist;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a5eab24c8508cdd247c23b9bd9b3017b0"><div class="ttname"><a href="classSampleHandlerFD.html#a5eab24c8508cdd247c23b9bd9b3017b0">SampleHandlerFD::FillHist</a></div><div class="ttdeci">void FillHist(const int Sample, TH1 *Hist, double *Array)</div><div class="ttdoc">Fill a histogram with the event-level information used in the fit.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00249">SampleHandlerFD.cpp:249</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a85415d4ac54a5aefe78e5ab4d7bdb769"><div class="ttname"><a href="classSampleHandlerFD.html#a85415d4ac54a5aefe78e5ab4d7bdb769">SampleHandlerFD::SampleHandlerFD_array</a></div><div class="ttdeci">double * SampleHandlerFD_array</div><div class="ttdoc">DB Array to be filled after reweighting.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00338">SampleHandlerFD.h:338</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga7a6f0525d4e4f941fc1af4709042add3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7a6f0525d4e4f941fc1af4709042add3">&#9670;&nbsp;</a></span>GetMCHist() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual TH1* SampleHandlerBase::GetMCHist </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get MC histogram. </p>

<p>Implemented in <a class="el" href="group__SampleHandlerGetters.html#gaef4a66f22b067c8125af5fe799f5a804">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#a20e359c2f53e3266215392cf129a50f9">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="gac453c29b475060135d911e4c23d0cb48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac453c29b475060135d911e4c23d0cb48">&#9670;&nbsp;</a></span>GetModeHist1D()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH1* SampleHandlerFD::GetModeHist1D </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>style</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00135">135</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                                                                     {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__SampleHandlerGetters.html#gaf193072f552cac18955b2197bd106ed1">Get1DVarHistByModeAndChannel</a>(iSample, <a class="code" href="group__SampleHandlerGetters.html#ga9aebf7da41ad6ddb87e3081a7f4763ec">GetXBinVarName</a>(iSample), m, s, style);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  }</div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_ga9aebf7da41ad6ddb87e3081a7f4763ec"><div class="ttname"><a href="group__SampleHandlerGetters.html#ga9aebf7da41ad6ddb87e3081a7f4763ec">SampleHandlerFD::GetXBinVarName</a></div><div class="ttdeci">std::string GetXBinVarName(const int Sample) const</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00045">SampleHandlerFD.h:45</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_gaf193072f552cac18955b2197bd106ed1"><div class="ttname"><a href="group__SampleHandlerGetters.html#gaf193072f552cac18955b2197bd106ed1">SampleHandlerFD::Get1DVarHistByModeAndChannel</a></div><div class="ttdeci">TH1 * Get1DVarHistByModeAndChannel(const int iSample, const std::string &amp;ProjectionVar_Str, int kModeToFill=-1, int kChannelToFill=-1, int WeightStyle=0, TAxis *Axis=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01698">SampleHandlerFD.cpp:1698</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga386667b346c7937285076aadf1f7c0a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga386667b346c7937285076aadf1f7c0a9">&#9670;&nbsp;</a></span>GetModeHist2D()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH2* SampleHandlerFD::GetModeHist2D </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>style</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00139">139</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                                                                     {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__SampleHandlerGetters.html#ga463c2e2cdba7afd948295a1a9833cd9b">Get2DVarHistByModeAndChannel</a>(iSample, <a class="code" href="group__SampleHandlerGetters.html#ga9aebf7da41ad6ddb87e3081a7f4763ec">GetXBinVarName</a>(iSample),<a class="code" href="group__SampleHandlerGetters.html#ga69d66592696bee9e73f61649c681a573">GetYBinVarName</a>(iSample), m, s, style);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  }</div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_ga463c2e2cdba7afd948295a1a9833cd9b"><div class="ttname"><a href="group__SampleHandlerGetters.html#ga463c2e2cdba7afd948295a1a9833cd9b">SampleHandlerFD::Get2DVarHistByModeAndChannel</a></div><div class="ttdeci">TH2 * Get2DVarHistByModeAndChannel(const int iSample, const std::string &amp;ProjectionVar_StrX, const std::string &amp;ProjectionVar_StrY, int kModeToFill=-1, int kChannelToFill=-1, int WeightStyle=0, TAxis *AxisX=nullptr, TAxis *AxisY=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01706">SampleHandlerFD.cpp:1706</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_ga69d66592696bee9e73f61649c681a573"><div class="ttname"><a href="group__SampleHandlerGetters.html#ga69d66592696bee9e73f61649c681a573">SampleHandlerFD::GetYBinVarName</a></div><div class="ttdeci">std::string GetYBinVarName(const int Sample) const</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00047">SampleHandlerFD.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gadc0365a430cbe628f5ec63ef49bf6f5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadc0365a430cbe628f5ec63ef49bf6f5e">&#9670;&nbsp;</a></span>GetName() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::string SampleHandlerBase::GetName </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="group__SampleHandlerGetters.html#ga6101b46360ae54fe37dd1243f3f7f51e">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#a239f38bf2aca5262213196c0ff26e6cd">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="ga6101b46360ae54fe37dd1243f3f7f51e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6101b46360ae54fe37dd1243f3f7f51e">&#9670;&nbsp;</a></span>GetName() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::GetName </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="group__SampleHandlerGetters.html#gadc0365a430cbe628f5ec63ef49bf6f5e">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01144">1144</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                                         {</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  <span class="comment">//ETA - extra safety to make sure SampleHandlerName is actually set</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  <span class="comment">// probably unnecessary due to the requirement for it to be in the yaml config</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#a9a7fccdf8392ee06495902fab60e9858">SampleHandlerName</a>.length() == 0) {</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;No sample name provided&quot;</span>);</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Please provide a SampleHandlerName in your configuration file: {}&quot;</span>, <a class="code" href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleManager</a>-&gt;GetFileName());</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  }</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a9a7fccdf8392ee06495902fab60e9858">SampleHandlerName</a>;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a46fa97953e811328fe125560ed5c809e"><div class="ttname"><a href="classSampleHandlerFD.html#a46fa97953e811328fe125560ed5c809e">SampleHandlerFD::SampleManager</a></div><div class="ttdeci">std::unique_ptr&lt; Manager &gt; SampleManager</div><div class="ttdoc">The manager object used to read the sample yaml file.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00387">SampleHandlerFD.h:387</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a9a7fccdf8392ee06495902fab60e9858"><div class="ttname"><a href="classSampleHandlerFD.html#a9a7fccdf8392ee06495902fab60e9858">SampleHandlerFD::SampleHandlerName</a></div><div class="ttdeci">std::string SampleHandlerName</div><div class="ttdoc">A unique ID for each sample based on which we can define what systematic should be applied.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00360">SampleHandlerFD.h:360</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga23987526c4fed2f7426632c6935864e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga23987526c4fed2f7426632c6935864e1">&#9670;&nbsp;</a></span>GetNDim()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SampleHandlerFD::GetNDim </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>DB Function to differentiate 1D or 2D binning. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00032">32</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].nDimensions; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga6ceca02f83e878ef1aec6e54e7b2f331"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6ceca02f83e878ef1aec6e54e7b2f331">&#9670;&nbsp;</a></span>GetNEvents()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int SampleHandlerBase::GetNEvents </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8h_source.html#l00059">59</a> of file <a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="classSampleHandlerBase.html#ab497b52d94868283a8a7cedbd1a4d777">nEvents</a>;}</div>
<div class="ttc" id="aclassSampleHandlerBase_html_ab497b52d94868283a8a7cedbd1a4d777"><div class="ttname"><a href="classSampleHandlerBase.html#ab497b52d94868283a8a7cedbd1a4d777">SampleHandlerBase::nEvents</a></div><div class="ttdeci">unsigned int nEvents</div><div class="ttdoc">Number of MC events are there.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00214">SampleHandlerBase.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga9d9a63f16c4acc2ab7bdd39df77712d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9d9a63f16c4acc2ab7bdd39df77712d4">&#9670;&nbsp;</a></span>GetNOscChannels() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual int SampleHandlerBase::GetNOscChannels </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="group__SampleHandlerGetters.html#gaac276e3f10be081ce8e7f94df131490d">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#ab4005935fa8cb04fb06e7d2d9b490b8a">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="gaac276e3f10be081ce8e7f94df131490d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaac276e3f10be081ce8e7f94df131490d">&#9670;&nbsp;</a></span>GetNOscChannels() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SampleHandlerFD::GetNOscChannels </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="group__SampleHandlerGetters.html#ga9d9a63f16c4acc2ab7bdd39df77712d4">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00103">103</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;{<span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[iSample].OscChannels.size());};</div>
</div><!-- fragment -->
</div>
</div>
<a id="gac4b73a8841ff9bab2fb08b578ad4137f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac4b73a8841ff9bab2fb08b578ad4137f">&#9670;&nbsp;</a></span>GetNsamples()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a> SampleHandlerBase::GetNsamples </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8h_source.html#l00035">35</a> of file <a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerBase.html#aa7a13af22c2314c718fb6438d493d3d1">nSamples</a>; };</div>
<div class="ttc" id="aclassSampleHandlerBase_html_aa7a13af22c2314c718fb6438d493d3d1"><div class="ttname"><a href="classSampleHandlerBase.html#aa7a13af22c2314c718fb6438d493d3d1">SampleHandlerBase::nSamples</a></div><div class="ttdeci">M3::int_t nSamples</div><div class="ttdoc">Contains how many samples we've got.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00211">SampleHandlerBase.h:211</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gae5849766fbbc7aa71672da8b0f189fe5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae5849766fbbc7aa71672da8b0f189fe5">&#9670;&nbsp;</a></span>GetPoissonLLH()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double SampleHandlerBase::GetPoissonLLH </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>mc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate test statistic for a single bin using Poisson. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>is data </td></tr>
    <tr><td class="paramname">mc</td><td>is mc </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8cpp_source.html#l00017">17</a> of file <a class="el" href="SampleHandlerBase_8cpp_source.html">SampleHandlerBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;                                                                                {</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="comment">// Return MC if there are no data, returns 0 for data == 0 &amp;&amp; mc == 0  </span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="keywordflow">if</span> ( data == 0 ) <span class="keywordflow">return</span> mc;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="comment">// If there are some data, but the prediction falls below the MC bound =&gt; return Poisson LogL for the low MC bound</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keywordflow">if</span> ( mc &lt; <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) {</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keywordflow">if</span> ( data &gt; <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) <span class="keywordflow">return</span> ( <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> - data + data * std::log( data/<a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) );</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( data &gt;= mc ) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  }</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="comment">// Otherwise, just return usual Poisson LogL using Stirling&#39;s approximation</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="comment">// http://hyperphysics.phy-astr.gsu.edu/hbase/math/stirling.html</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordflow">return</span> ( mc - data + data * std::log( data / mc ) );</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;}</div>
<div class="ttc" id="anamespaceM3_html_ad6bd1a7e1e5b714f2985b91f8bdc4104"><div class="ttname"><a href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a></div><div class="ttdeci">constexpr static const double _LOW_MC_BOUND_</div><div class="ttdoc">MC prediction lower bound in bin to identify problematic binning definitions and handle LogL calculat...</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00083">Core.h:83</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gad83a84cec68b96cb50eaaf1a40f96edf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad83a84cec68b96cb50eaaf1a40f96edf">&#9670;&nbsp;</a></span>GetSampleIndex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SampleHandlerFD::GetSampleIndex </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>SampleTitle</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get index of sample based on name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">SampleTitle</td><td>The title of the sample to search for. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00879">879</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                                                                      {</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a> iSample = 0; iSample &lt; <a class="code" href="classSampleHandlerBase.html#aa7a13af22c2314c718fb6438d493d3d1">nSamples</a>; ++iSample) {</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="keywordflow">if</span> (SampleTitle == <a class="code" href="group__SampleHandlerGetters.html#gadfad2507ad845ad36fff3c82231a143c">GetSampleTitle</a>(iSample)) {</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      <span class="keywordflow">return</span> iSample;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    }</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  }</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Sample name not found: {}&quot;</span>, SampleTitle);</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;}</div>
<div class="ttc" id="anamespaceM3_html_adb59b8ecdc4e1b2d5d4c826a13aa7463"><div class="ttname"><a href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a></div><div class="ttdeci">int int_t</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00038">Core.h:38</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga60ce18ee8d7adbc78b9be1269f081aa3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga60ce18ee8d7adbc78b9be1269f081aa3">&#9670;&nbsp;</a></span>GetSampleLikelihood() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double SampleHandlerBase::GetSampleLikelihood </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>isample</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="group__SampleHandlerGetters.html#gaaac2deb8881a00c85951a3e8a6653393">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#a70fdee6b3ba405ef04a0f83ab63a8c3f">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="gaaac2deb8881a00c85951a3e8a6653393"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaac2deb8881a00c85951a3e8a6653393">&#9670;&nbsp;</a></span>GetSampleLikelihood() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SampleHandlerFD::GetSampleLikelihood </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>isample</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get likelihood for single sample. </p>

<p>Implements <a class="el" href="group__SampleHandlerGetters.html#ga60ce18ee8d7adbc78b9be1269f081aa3">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01220">1220</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                                                                   {</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> Start = <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetSampleStartBin(isample);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> End = <a class="code" href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">Binning</a>-&gt;GetSampleEndBin(isample);</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160; </div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  <span class="keywordtype">double</span> negLogL = 0.;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="preprocessor">  #pragma omp parallel for reduction(+:negLogL)</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idx = Start; idx &lt; End; ++idx)</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  {</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> DataVal = <a class="code" href="classSampleHandlerFD.html#a2b16ed4f91f2f37ff707ca048d8d6927">SampleHandlerFD_data</a>[idx];</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> MCPred = <a class="code" href="classSampleHandlerFD.html#a85415d4ac54a5aefe78e5ab4d7bdb769">SampleHandlerFD_array</a>[idx];</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> w2 = <a class="code" href="classSampleHandlerFD.html#af5c6a3701c6ac76a96886ff13300a53b">SampleHandlerFD_array_w2</a>[idx];</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160; </div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <span class="comment">//KS: Calculate likelihood using Barlow-Beeston Poisson or even IceCube</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    negLogL += <a class="code" href="group__SampleHandlerGetters.html#ga527307a4186e2eb61475ea975108aa65">GetTestStatLLH</a>(DataVal, MCPred, w2);</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  }</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  <span class="keywordflow">return</span> negLogL;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a231b4b5b9b5e5f0d1cb9a3ba96c85ec5"><div class="ttname"><a href="classSampleHandlerFD.html#a231b4b5b9b5e5f0d1cb9a3ba96c85ec5">SampleHandlerFD::Binning</a></div><div class="ttdeci">std::unique_ptr&lt; BinningHandler &gt; Binning</div><div class="ttdoc">KS: This stores binning information, in future could be come vector to store binning for every used s...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00336">SampleHandlerFD.h:336</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a2b16ed4f91f2f37ff707ca048d8d6927"><div class="ttname"><a href="classSampleHandlerFD.html#a2b16ed4f91f2f37ff707ca048d8d6927">SampleHandlerFD::SampleHandlerFD_data</a></div><div class="ttdeci">double * SampleHandlerFD_data</div><div class="ttdoc">DB Array to be filled in AddData.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00342">SampleHandlerFD.h:342</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_af5c6a3701c6ac76a96886ff13300a53b"><div class="ttname"><a href="classSampleHandlerFD.html#af5c6a3701c6ac76a96886ff13300a53b">SampleHandlerFD::SampleHandlerFD_array_w2</a></div><div class="ttdeci">double * SampleHandlerFD_array_w2</div><div class="ttdoc">KS Array used for MC stat.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00340">SampleHandlerFD.h:340</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_ga527307a4186e2eb61475ea975108aa65"><div class="ttname"><a href="group__SampleHandlerGetters.html#ga527307a4186e2eb61475ea975108aa65">SampleHandlerBase::GetTestStatLLH</a></div><div class="ttdeci">double GetTestStatLLH(const double data, const double mc, const double w2) const</div><div class="ttdoc">Calculate test statistic for a single bin. Calculation depends on setting of fTestStatistic....</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8cpp_source.html#l00035">SampleHandlerBase.cpp:35</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gad3df6900450be4bbb05453e3b166e09e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad3df6900450be4bbb05453e3b166e09e">&#9670;&nbsp;</a></span>GetSampleTitle() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::string SampleHandlerBase::GetSampleTitle </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="group__SampleHandlerGetters.html#gadfad2507ad845ad36fff3c82231a143c">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#ab5e1742f6636b3c05d078250b8611366">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="gadfad2507ad845ad36fff3c82231a143c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadfad2507ad845ad36fff3c82231a143c">&#9670;&nbsp;</a></span>GetSampleTitle() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::GetSampleTitle </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="group__SampleHandlerGetters.html#gad3df6900450be4bbb05453e3b166e09e">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00036">36</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].SampleTitle;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga527307a4186e2eb61475ea975108aa65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga527307a4186e2eb61475ea975108aa65">&#9670;&nbsp;</a></span>GetTestStatLLH()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double SampleHandlerBase::GetTestStatLLH </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>mc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>w2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate test statistic for a single bin. Calculation depends on setting of <code>fTestStatistic</code>. Data and mc -&gt; 0 cut-offs are defined in <a class="el" href="namespaceM3.html" title="Main namespace for MaCh3 software.">M3</a>::<em>LOW_MC_BOUND</em>. </p>
<h3><a class="anchor" id="autotoc_md29"></a>
Poisson</h3>
<p>Standard Poisson log-likelihood (Stirling approximation) <a class="el" href="citelist.html#CITEREF_BakerCousins1984">[2]</a> </p><p class="formulaDsp">
\[ - \log \mathcal{L}_\mathrm{Poisson} = \sum_i N_i^\mathrm{MC} - N_i^\mathrm{data} + N_i^\mathrm{data} \ln \frac{N_i^\mathrm{data}}{N_i^\mathrm{MC}}, \]
</p>
<h3><a class="anchor" id="autotoc_md30"></a>
Pearson</h3>
<p>Standard Pearson likelihood <a class="el" href="citelist.html#CITEREF_Pearson1900">[25]</a> (assumes Gaussian approximation of bin counts): </p><p class="formulaDsp">
\[ - \log \mathcal{L}_\mathrm{Pearson} = \sum_i \frac{(N_i^\mathrm{data} - N_i^\mathrm{MC})^2}{2 \, N_i^\mathrm{MC}} \]
</p>
<h3><a class="anchor" id="autotoc_md31"></a>
Barlow-Beeston</h3>
<p>Based on <a class="el" href="citelist.html#CITEREF_Barlow:1993dm">[3]</a> and following Conway approximation (<a class="el" href="citelist.html#CITEREF_Conway:2011in">[5]</a>) The generation of MC is a stochastic process, so even identical settings can lead to different outputs (assuming that the seeds of the random number generator are different). This introduces uncertainty in MC distributions, especially in bins with low statistics.</p>
<p class="formulaDsp">
\[ - \log \mathcal{L}_\mathrm{BB} = - \log \mathcal{L}_\mathrm{Poisson} - \log \mathcal{L}_\mathrm{MC_{stat}} = \sum_i \Biggl[ N_i^\mathrm{MC}(\vec{\theta}) - N_i^\mathrm{data} + N_i^\mathrm{data} \ln \frac{N_i^\mathrm{data}}{N_i^\mathrm{MC}(\vec{\theta})} + \frac{(\beta_i - 1)^2}{2 \sigma_{\beta_i}^2} \Biggr], \]
</p>
<p>where \(\beta_i\) is a scaling parameter between ideal ("true") and generated MC in a bin ( \(N^\mathrm{true}_{\mathrm{MC},i} = \beta_i N_i^\mathrm{MC}\)), and \(\sigma^2_{\beta_i} = \frac{\sum_i w_i^2}{N_i^\mathrm{MC}}\), with \(\sum_i w_i^2\) being the sum of the squares of weights in bin \(i\). Assuming \(\beta_i\) follows a Gaussian, its mean can be found by solving the quadratic equation derived by Conway:</p>
<p class="formulaDsp">
\[ \beta_i^2 + (N_i^\mathrm{MC} \sigma_{\beta_i}^2 - 1)\beta_i - N_i^\mathrm{data} \sigma_{\beta_i}^2 = 0 \]
</p>
<h3><a class="anchor" id="autotoc_md32"></a>
Dembinski-Abdelmotteleb</h3>
<p>Alternative treatment of MC statistical uncertainty following Hans Dembinski and Ahmed Abdelmotteleb <a class="el" href="citelist.html#CITEREF_Dembinski:2022ios">[6]</a></p>
<p>This approach extends the Barlow-Beeston method. For each bin: </p><p class="formulaDsp">
\[ - \log \mathcal{L}_\mathrm{DA} = (N_i^{\mathrm{MC},\prime} - N_i^\mathrm{data} + N_i^\mathrm{data} \ln \frac{N_i^\mathrm{data}}{N_i^{\mathrm{MC},\prime}}) + k \beta - k + k \ln \frac{k}{k \beta} \]
</p>
<p> where </p><p class="formulaDsp">
\[ k = \frac{(N_i^\mathrm{MC})^2}{\sum_i w_i^2} \]
</p>
<p> and </p><p class="formulaDsp">
\[ \beta = \frac{N_i^\mathrm{data} + k}{N_i^\mathrm{MC} + k}, \quad N_i^{\mathrm{MC},\prime} = N_i^\mathrm{MC} \cdot \beta \]
</p>
<h3><a class="anchor" id="autotoc_md33"></a>
IceCube</h3>
<p>Alternative likelihood definition described by the IceCube collaboration <a class="el" href="citelist.html#CITEREF_Arguelles:2019izp">[1]</a> </p><p class="formulaDsp">
\[ - \log \mathcal{L} = - \sum_i \Biggl( a_i \log(b_i) + \log[\Gamma(N_i^{\mathrm{data}}+a_i)] - (N_i^{\mathrm{data}}+a_i)\log(b_i+1) - \log[\Gamma(a_i)] \Biggr), \]
</p>
<p> where the auxiliary variables are </p><p class="formulaDsp">
\[ a_i = N^{\mathrm{gen}}_{\mathrm{MC},i} \, b_i + 1, \quad b_i = \frac{N^{\mathrm{gen}}_{\mathrm{MC},i}}{\sum_i w_i^2}. \]
</p>
<h3><a class="anchor" id="autotoc_md34"></a>
Treatment of low data/mc</h3>
<p>Implemented fTestStatistic are <code>kPoisson</code> (with Stirling's approx.), <code>kBarlowBeeston</code> (arXiv:1103.0354), <code>kDembinskiAbdelmotteleb</code> (arXiv:2206.12346), <code>kIceCube</code> (arxiv:1901.04645), and <code>kPearson</code>. Test statistics require mc &gt; 0, therefore low mc and data values are treated with cut-offs based on <a class="el" href="namespaceM3.html" title="Main namespace for MaCh3 software.">M3</a>::<em>LOW_MC_BOUND</em> = .00001 by default. For <code>kPoisson</code>, <code>kBarlowBeeston</code>, <code>kDembinskiAbdelmotteleb</code>, <code>kPearson:</code> data &gt; <em>LOW_MC_BOUND</em> &amp; mc &lt;= <em>LOW_MC_BOUND</em>: returns GetTestStatLLH(data, <em>LOW_MC_BOUND</em>, w2), with Poisson(data,<em>LOW_MC_BOUND</em>) limit for mc-&gt;0, w2-&gt;0. mc &lt; data &lt;= <em>LOW_MC_BOUND</em>: returns 0 (as if any data &lt;= <em>LOW_MC_BOUND</em> were effectively consistent with 0 data count), with a limit of 0 for mc-&gt;0. data = 0: returns mc (or mc/2. for <code>kPearson</code>), with a limit of 0 for mc-&gt;0. For <code>kIceCube:</code> mc &lt; data returns the lower of IceCube(data,mc,w2) and Poisson(data,mc) penalties, with a Poisson(data,<em>LOW_MC_BOUND</em>) limit for mc-&gt;0, w2-&gt;0. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>is data </td></tr>
    <tr><td class="paramname">mc</td><td>is mc </td></tr>
    <tr><td class="paramname">w2</td><td>is \(\sum_{i} w_{i}^2\) (sum of weights squared), which is \(\sigma^2_{\text{MC stats}}\) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8cpp_source.html#l00035">35</a> of file <a class="el" href="SampleHandlerBase_8cpp_source.html">SampleHandlerBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                                                                                                  {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">// *************************</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="classSampleHandlerBase.html#a87670dbcda5d09b09675e8f407fe3a30">fTestStatistic</a>)</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">//CW: Not full Barlow-Beeston or what is referred to as &quot;light&quot;: we&#39;re not introducing any more parameters</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">// Assume the MC has a Gaussian distribution around generated</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// As in https://arxiv.org/abs/1103.0354 eq 10, 11</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">//CW: Calculate the Barlow-Beeston likelihood contribution from MC statistics</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// Assumes the beta scaling parameters are Gaussian distributed</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">// Follows arXiv:1103.0354 section 5 and equation 8, 9, 10, 11 on page 4/5</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">// Essentially solves equation 11</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">case</span> (<a class="code" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a3c9b50397bd37ce679bbdda14f6108c4">kBarlowBeeston</a>):</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <span class="comment">// The MC used in the likelihood calculation is allowed to be changed by Barlow Beeston beta parameters</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keywordtype">double</span> newmc = mc;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <span class="comment">// If MC falls below the low MC bound, use low MC bound for newmc</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="keywordflow">if</span> ( mc &lt; <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">if</span> ( data &gt; <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) newmc = <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( data &gt;= mc ) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="comment">// Barlow-Beeston uses fractional uncertainty on MC, so sqrt(sum[w^2])/mc</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> fractional = std::sqrt( w2 ) / newmc;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="comment">// fractional^2 to avoid doing same operation several times</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> fractional2 = fractional * fractional;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="comment">// b in quadratic equation</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> temp = newmc * fractional2 - 1;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="comment">// b^2 - 4ac in quadratic equation</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> temp2 = temp * temp + 4 * data * fractional2;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordflow">if</span> ( temp2 &lt; 0 ) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Negative square root in Barlow Beeston coefficient calculation!&quot;</span>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <span class="comment">// Solve for the positive beta</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> beta = ( -1 * temp + sqrt( temp2 ) ) / 2.;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <span class="comment">// If there is no data, test-stat shall return only MC*beta</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keywordtype">double</span> stat = mc * beta;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="comment">// With data, test-stat shall return LogL for newMC*beta which includes the low MC bound</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="keywordflow">if</span> ( data &gt; 0 ) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        newmc *= beta;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        stat = newmc - data + data * std::log( data / newmc );</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="comment">// Now, MC stat penalty</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="comment">// The penalty from MC statistics using Conways approach (https://cds.cern.ch/record/1333496?)</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordtype">double</span> penalty = 0;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="keywordflow">if</span> ( fractional &gt; 0 )  penalty = ( beta - 1 ) * ( beta - 1 ) / ( 2 * fractional2 );</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="comment">// Returns test-stat plus the MC stat penalty </span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keywordflow">return</span> stat+penalty;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">//KS: Alternative calculation of Barlow-Beeston following Hans Dembinski and Ahmed Abdelmottele arXiv:2206.12346v2</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">case</span> (<a class="code" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a7d4e059541c7ec9737f5c884cd6cd0f0">kDembinskiAbdelmotteleb</a>):</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="comment">//KS: code follows authors implementation from:</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="comment">//https://github.com/scikit-hep/iminuit/blob/059d06b00cae097ebf340b218b4eb57357111df8/src/iminuit/cost.py#L274-L300</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="comment">// If there is no MC stat error for any reason, return Poisson LogL</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keywordflow">if</span> ( w2 == 0 ) <span class="keywordflow">return</span> <a class="code" href="group__SampleHandlerGetters.html#gae5849766fbbc7aa71672da8b0f189fe5">GetPoissonLLH</a>(data,mc);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="comment">// The MC can be changed</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <span class="keywordtype">double</span> newmc = mc;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="comment">// If MC falls below the low MC bound, use low MC bound for newmc</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="keywordflow">if</span> ( mc &lt; <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">if</span> ( data &gt; <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) newmc = <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( data &gt;= mc ) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <span class="comment">//the so-called effective count</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> k = newmc * newmc / w2;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="comment">//Calculate beta which is scaling factor between true and generated MC</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> beta = ( data + k ) / ( newmc + k );</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      newmc *= beta;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="comment">// And penalise the movement in beta relative the mc uncertainty</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> penalty = k * beta - k + k * std::log( k / ( k * beta ) );</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="comment">// If there are no data, this shall return newmc</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordtype">double</span> stat = newmc;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="comment">// All likelihood calculations may use the bare Poisson likelihood, so calculate here</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="comment">// Only if there are some data</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">if</span> ( data &gt; 0 ) stat = newmc - data + data * std::log( data / newmc );</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="comment">// Return the statistical contribution and penalty</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keywordflow">return</span> stat+penalty;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">//CW: Also try the IceCube likelihood</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">// It does not modify the MC content</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// https://arxiv.org/abs/1901.04645</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// Argelles, C.A., Schneider, A. &amp; Yuan, T. J. High Energ. Phys. (2019) 2019: 30. https://doi.org/10.1007/JHEP06(2019)030</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">// We essentially construct eq 3.16 and take the logarithm</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// in eq 3.16, mu is MC, sigma2 is w2, k is data</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">case</span> (<a class="code" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a5a1aedce85942661f297f503d606c472">kIceCube</a>):</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="comment">// IceCube low MC bound is implemented to return Poisson(data, _LOW_MC_BOUND_)</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="comment">// up until the IceCube(data, mc) test-statistic is less than Poisson(data, _LOW_MC_BOUND_)</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <span class="comment">// The 0 MC limit is set to Poisson(data, 0.) as there is no way to get a non-diverging and reasonable guess on w2</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="comment">// If there is 0 MC uncertainty (technically also when MC is 0) =&gt; Return Poisson(data, mc)</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="keywordflow">if</span> ( w2 == 0 ) <span class="keywordflow">return</span> <a class="code" href="group__SampleHandlerGetters.html#gae5849766fbbc7aa71672da8b0f189fe5">GetPoissonLLH</a>(data,mc);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="comment">// Auxiliary variables</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">double</span> b = mc / w2;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">double</span> a = mc * b + 1;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="comment">// Use C99&#39;s implementation of log of gamma function to not be C++11 dependent</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> stat = double( -1 * ( a * logl( b ) + lgammal( data + a ) - lgammal( data + 1 ) - ( ( data + a ) * log1pl( b ) ) - lgammal( a ) ) );</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="comment">// Check whether the stat is more than Poisson-like bound for low mc (mc &lt; data)</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="comment">// TN: I believe this might get some extra optimization</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keywordflow">if</span> ( mc &lt;= data ) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">if</span> ( data &lt;= <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> poisson = <a class="code" href="group__SampleHandlerGetters.html#gae5849766fbbc7aa71672da8b0f189fe5">GetPoissonLLH</a>(data, <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a>);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">if</span> ( stat &gt; poisson ) <span class="keywordflow">return</span> poisson;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="comment">// Otherwise, return IceCube test-stat</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="keywordflow">return</span> stat;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">//KS: Pearson works on assumption that event distribution in each bin is described by a Gaussian which in our case is not fulfilled for all bins, hence use it at your own risk</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">case</span> (<a class="code" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a1ac0c03f07bf2bb9ad083e449d69ffd7">kPearson</a>):</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="comment">//KS: 2 is because this function returns -LLH not -2LLH</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="comment">// With no data return the MC/2.</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keywordflow">if</span> ( data == 0 ) <span class="keywordflow">return</span> mc/2.;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <span class="comment">// If MC is lower than the low MC bound, return the test-stat at the bound</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="keywordflow">if</span> ( mc &lt; <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">if</span> ( data &gt; <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) <span class="keywordflow">return</span> ( data - <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) * ( data - <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) / ( 2. * <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ); </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( data &gt;= mc ) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="comment">// Return the Pearson metric</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="keywordflow">return</span> ( data - mc ) * ( data - mc ) / ( 2 * mc );</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">case</span> (<a class="code" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a82f43d91f1eda213c4b5c486672a32a5">kPoisson</a>):</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="comment">//Just call GetPoissonLLH which doesn&#39;t take in weights</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="comment">//and is a Poisson likelihood comparison.</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="group__SampleHandlerGetters.html#gae5849766fbbc7aa71672da8b0f189fe5">GetPoissonLLH</a>(data, mc);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a1459dbcc0f1b68b266cf0ddc37c34aee">TestStatistic::kNTestStatistics</a>:</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;kNTestStatistics is not a valid TestStatistic!&quot;</span>);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Couldn&#39;t find TestStatistic {} exiting!&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerBase.html#a87670dbcda5d09b09675e8f407fe3a30">fTestStatistic</a>));</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  } <span class="comment">// end switch</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;}</div>
<div class="ttc" id="aSampleStructs_8h_html_a960da89e33ac45a56f7bbfac3068dc67a1459dbcc0f1b68b266cf0ddc37c34aee"><div class="ttname"><a href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a1459dbcc0f1b68b266cf0ddc37c34aee">kNTestStatistics</a></div><div class="ttdeci">@ kNTestStatistics</div><div class="ttdoc">Number of test statistics.</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00111">SampleStructs.h:110</a></div></div>
<div class="ttc" id="aSampleStructs_8h_html_a960da89e33ac45a56f7bbfac3068dc67a1ac0c03f07bf2bb9ad083e449d69ffd7"><div class="ttname"><a href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a1ac0c03f07bf2bb9ad083e449d69ffd7">kPearson</a></div><div class="ttdeci">@ kPearson</div><div class="ttdoc">Standard Pearson likelihood .</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00108">SampleStructs.h:108</a></div></div>
<div class="ttc" id="aSampleStructs_8h_html_a960da89e33ac45a56f7bbfac3068dc67a3c9b50397bd37ce679bbdda14f6108c4"><div class="ttname"><a href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a3c9b50397bd37ce679bbdda14f6108c4">kBarlowBeeston</a></div><div class="ttdeci">@ kBarlowBeeston</div><div class="ttdoc">Barlow-Beeston () following Conway approximation ()</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00106">SampleStructs.h:106</a></div></div>
<div class="ttc" id="aSampleStructs_8h_html_a960da89e33ac45a56f7bbfac3068dc67a5a1aedce85942661f297f503d606c472"><div class="ttname"><a href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a5a1aedce85942661f297f503d606c472">kIceCube</a></div><div class="ttdeci">@ kIceCube</div><div class="ttdoc">Based on .</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00107">SampleStructs.h:107</a></div></div>
<div class="ttc" id="aSampleStructs_8h_html_a960da89e33ac45a56f7bbfac3068dc67a7d4e059541c7ec9737f5c884cd6cd0f0"><div class="ttname"><a href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a7d4e059541c7ec9737f5c884cd6cd0f0">kDembinskiAbdelmotteleb</a></div><div class="ttdeci">@ kDembinskiAbdelmotteleb</div><div class="ttdoc">Based on .</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00109">SampleStructs.h:109</a></div></div>
<div class="ttc" id="aSampleStructs_8h_html_a960da89e33ac45a56f7bbfac3068dc67a82f43d91f1eda213c4b5c486672a32a5"><div class="ttname"><a href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a82f43d91f1eda213c4b5c486672a32a5">kPoisson</a></div><div class="ttdeci">@ kPoisson</div><div class="ttdoc">Standard Poisson likelihood .</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00105">SampleStructs.h:105</a></div></div>
<div class="ttc" id="aclassSampleHandlerBase_html_a87670dbcda5d09b09675e8f407fe3a30"><div class="ttname"><a href="classSampleHandlerBase.html#a87670dbcda5d09b09675e8f407fe3a30">SampleHandlerBase::fTestStatistic</a></div><div class="ttdeci">TestStatistic fTestStatistic</div><div class="ttdoc">Test statistic tells what kind of likelihood sample is using.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00203">SampleHandlerBase.h:203</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_gae5849766fbbc7aa71672da8b0f189fe5"><div class="ttname"><a href="group__SampleHandlerGetters.html#gae5849766fbbc7aa71672da8b0f189fe5">SampleHandlerBase::GetPoissonLLH</a></div><div class="ttdeci">double GetPoissonLLH(const double data, const double mc) const</div><div class="ttdoc">Calculate test statistic for a single bin using Poisson.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8cpp_source.html#l00017">SampleHandlerBase.cpp:17</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga9a47c08f11d5019f5f237cddd279ef9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9a47c08f11d5019f5f237cddd279ef9c">&#9670;&nbsp;</a></span>GetW2Hist() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH1 * SampleHandlerFD::GetW2Hist </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get W2 histogram. </p>

<p>Implements <a class="el" href="group__SampleHandlerGetters.html#ga5ea53e5e6adb5b4e6281a3d1ce910c3a">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00891">891</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                                                {</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a5eab24c8508cdd247c23b9bd9b3017b0">FillHist</a>(Sample, <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].W2Hist, <a class="code" href="classSampleHandlerFD.html#af5c6a3701c6ac76a96886ff13300a53b">SampleHandlerFD_array_w2</a>);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].W2Hist == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Can&#39;t access {} for {}Dimensions&quot;</span>, __func__, <a class="code" href="group__SampleHandlerGetters.html#ga23987526c4fed2f7426632c6935864e1">GetNDim</a>(Sample));</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  }</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a115728f4ba502c93ffd447fb5457aac6">SampleDetails</a>[Sample].W2Hist;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga5ea53e5e6adb5b4e6281a3d1ce910c3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5ea53e5e6adb5b4e6281a3d1ce910c3a">&#9670;&nbsp;</a></span>GetW2Hist() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual TH1* SampleHandlerBase::GetW2Hist </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get W2 histogram. </p>

<p>Implemented in <a class="el" href="group__SampleHandlerGetters.html#ga9a47c08f11d5019f5f237cddd279ef9c">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#ab542ee8c1dc30a252529576a784ff9dd">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="ga9aebf7da41ad6ddb87e3081a7f4763ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9aebf7da41ad6ddb87e3081a7f4763ec">&#9670;&nbsp;</a></span>GetXBinVarName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::GetXBinVarName </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00045">45</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="group__SampleHandlerGetters.html#ga7f3923d1e2b39df2e1bf2348312925a6">GetKinVarName</a>(Sample, 0);}</div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_ga7f3923d1e2b39df2e1bf2348312925a6"><div class="ttname"><a href="group__SampleHandlerGetters.html#ga7f3923d1e2b39df2e1bf2348312925a6">SampleHandlerFD::GetKinVarName</a></div><div class="ttdeci">std::string GetKinVarName(const int iSample, const int Dimension) const override</div><div class="ttdoc">Return Kinematic Variable name for specified sample and dimension for example &quot;Reconstructed_Neutrino...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01996">SampleHandlerFD.cpp:1996</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga69d66592696bee9e73f61649c681a573"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga69d66592696bee9e73f61649c681a573">&#9670;&nbsp;</a></span>GetYBinVarName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::GetYBinVarName </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00047">47</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="group__SampleHandlerGetters.html#ga7f3923d1e2b39df2e1bf2348312925a6">GetKinVarName</a>(Sample, 1);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="gaa5a0b0ed2e81af8e60a7fbda65971441"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa5a0b0ed2e81af8e60a7fbda65971441">&#9670;&nbsp;</a></span>ReturnHistsBySelection1D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; TH1 * &gt; SampleHandlerFD::ReturnHistsBySelection1D </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>KinematicProjection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Selection1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Selection2</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>Axis</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01855">1855</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;                                                                                                                                                                         {</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;  std::vector&lt;TH1*&gt; hHistList;</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;  std::string legendEntry;</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160; </div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">THStackLeg</a> != <span class="keyword">nullptr</span>) {<span class="keyword">delete</span> <a class="code" href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">THStackLeg</a>;}</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;  <a class="code" href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">THStackLeg</a> = <span class="keyword">new</span> TLegend(0.1,0.1,0.9,0.9);</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160; </div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;  <span class="keywordtype">int</span> iMax = -1;</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;  <span class="keywordflow">if</span> (Selection1 == FDPlotType::kModePlot) {</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    iMax = <a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetNModes();</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;  }</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;  <span class="keywordflow">if</span> (Selection1 == FDPlotType::kOscChannelPlot) {</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    iMax = <a class="code" href="group__SampleHandlerGetters.html#gaac276e3f10be081ce8e7f94df131490d">GetNOscChannels</a>(iSample);</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;  }</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;  <span class="keywordflow">if</span> (iMax == -1) {</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;You&#39;ve passed me a Selection1 which was not implemented in ReturnHistsBySelection1D. Selection1 and Selection2 are counters for different indexable quantities&quot;</span>);</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;  }</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160; </div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;iMax;i++) {</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    <span class="keywordflow">if</span> (Selection1 == FDPlotType::kModePlot) {</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;      hHistList.push_back(<a class="code" href="group__SampleHandlerGetters.html#gaf193072f552cac18955b2197bd106ed1">Get1DVarHistByModeAndChannel</a>(iSample, KinematicProjection,i,Selection2,WeightStyle,XAxis));</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;      <a class="code" href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">THStackLeg</a>-&gt;AddEntry(hHistList[i],(<a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetMaCh3ModeName(i)+Form(<span class="stringliteral">&quot; : (%4.2f)&quot;</span>,hHistList[i]-&gt;Integral())).c_str(),<span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160; </div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;      hHistList[i]-&gt;SetFillColor(<span class="keyword">static_cast&lt;</span>Color_t<span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetMaCh3ModePlotColor(i)));</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;      hHistList[i]-&gt;SetLineColor(<span class="keyword">static_cast&lt;</span>Color_t<span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetMaCh3ModePlotColor(i)));</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    }</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    <span class="keywordflow">if</span> (Selection1 == FDPlotType::kOscChannelPlot) {</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;      hHistList.push_back(<a class="code" href="group__SampleHandlerGetters.html#gaf193072f552cac18955b2197bd106ed1">Get1DVarHistByModeAndChannel</a>(iSample, KinematicProjection,Selection2,i,WeightStyle,XAxis));</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;      <a class="code" href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">THStackLeg</a>-&gt;AddEntry(hHistList[i],(<a class="code" href="group__SampleHandlerGetters.html#ga19cffdf18f1fb12f68b262907671801d">GetFlavourName</a>(iSample, i)+Form(<span class="stringliteral">&quot; | %4.2f&quot;</span>,hHistList[i]-&gt;Integral())).c_str(),<span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    }</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;  }</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160; </div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;  <span class="keywordflow">return</span> hHistList;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_af60df24f4eb7954a3297c9841c60624b"><div class="ttname"><a href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">SampleHandlerFD::THStackLeg</a></div><div class="ttdeci">TLegend * THStackLeg</div><div class="ttdoc">DB Miscellaneous Variables.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00394">SampleHandlerFD.h:394</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_ga19cffdf18f1fb12f68b262907671801d"><div class="ttname"><a href="group__SampleHandlerGetters.html#ga19cffdf18f1fb12f68b262907671801d">SampleHandlerFD::GetFlavourName</a></div><div class="ttdeci">std::string GetFlavourName(const int iSample, const int iChannel)</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00106">SampleHandlerFD.h:106</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gaf9d1ac8ae54628f20b02d0a6c2458822"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf9d1ac8ae54628f20b02d0a6c2458822">&#9670;&nbsp;</a></span>ReturnHistsBySelection2D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; TH2 * &gt; SampleHandlerFD::ReturnHistsBySelection2D </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>KinematicProjectionX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>KinematicProjectionY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Selection1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Selection2</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>XAxis</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>YAxis</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01891">1891</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;                                                                                        {</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;  std::vector&lt;TH2*&gt; hHistList;</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160; </div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;  <span class="keywordtype">int</span> iMax = -1;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;  <span class="keywordflow">if</span> (Selection1 == FDPlotType::kModePlot) {</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    iMax = <a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetNModes();</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;  }</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;  <span class="keywordflow">if</span> (Selection1 == FDPlotType::kOscChannelPlot) {</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    iMax = <a class="code" href="group__SampleHandlerGetters.html#gaac276e3f10be081ce8e7f94df131490d">GetNOscChannels</a>(iSample);</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;  }</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;  <span class="keywordflow">if</span> (iMax == -1) {</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;You&#39;ve passed me a Selection1 which was not implemented in ReturnHistsBySelection1D. Selection1 and Selection2 are counters for different indexable quantities&quot;</span>);</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;  }</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160; </div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;iMax;i++) {</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    <span class="keywordflow">if</span> (Selection1 == FDPlotType::kModePlot) {</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;      hHistList.push_back(<a class="code" href="group__SampleHandlerGetters.html#ga463c2e2cdba7afd948295a1a9833cd9b">Get2DVarHistByModeAndChannel</a>(iSample, KinematicProjectionX,KinematicProjectionY,i,Selection2,WeightStyle,XAxis,YAxis));</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    }</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <span class="keywordflow">if</span> (Selection1 == FDPlotType::kOscChannelPlot) {</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;      hHistList.push_back(<a class="code" href="group__SampleHandlerGetters.html#ga463c2e2cdba7afd948295a1a9833cd9b">Get2DVarHistByModeAndChannel</a>(iSample, KinematicProjectionX,KinematicProjectionY,Selection2,i,WeightStyle,XAxis,YAxis));</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    }</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;  }</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160; </div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;  <span class="keywordflow">return</span> hHistList;</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="gae2769d593f34e8356b545af076818f89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae2769d593f34e8356b545af076818f89">&#9670;&nbsp;</a></span>ReturnKinematicParameterFromString()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SampleHandlerFD::ReturnKinematicParameterFromString </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>KinematicStr</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ETA function to generically convert a string from xsec cov to a kinematic type. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01542">1542</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                                                                                                    {</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;  <span class="keyword">auto</span> it = <a class="code" href="classSampleHandlerFD.html#aae37732e76f0b17b6f124bd5543177e4">KinematicParameters</a>-&gt;find(KinematicParameterStr);</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  <span class="keywordflow">if</span> (it != <a class="code" href="classSampleHandlerFD.html#aae37732e76f0b17b6f124bd5543177e4">KinematicParameters</a>-&gt;end()) <span class="keywordflow">return</span> it-&gt;second;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160; </div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Did not recognise Kinematic Parameter type: {}&quot;</span>, KinematicParameterStr);</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160; </div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a>;</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_aae37732e76f0b17b6f124bd5543177e4"><div class="ttname"><a href="classSampleHandlerFD.html#aae37732e76f0b17b6f124bd5543177e4">SampleHandlerFD::KinematicParameters</a></div><div class="ttdeci">const std::unordered_map&lt; std::string, int &gt; * KinematicParameters</div><div class="ttdoc">Mapping between string and kinematic enum.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00377">SampleHandlerFD.h:377</a></div></div>
<div class="ttc" id="anamespaceM3_html_ac289df32a5b3b05c61a87cbac5702b25"><div class="ttname"><a href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a></div><div class="ttdeci">constexpr static const int _BAD_INT_</div><div class="ttdoc">Default value used for int initialisation.</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00055">Core.h:55</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga75481a54d71de4d814b558bf00c4fe3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga75481a54d71de4d814b558bf00c4fe3f">&#9670;&nbsp;</a></span>ReturnStackedHistBySelection1D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">THStack * SampleHandlerFD::ReturnStackedHistBySelection1D </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>KinematicProjection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Selection1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Selection2</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>Axis</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01922">1922</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;                                                                                                                                                                               {</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;  std::vector&lt;TH1*&gt; HistList = <a class="code" href="group__SampleHandlerGetters.html#gaa5a0b0ed2e81af8e60a7fbda65971441">ReturnHistsBySelection1D</a>(iSample, KinematicProjection, Selection1, Selection2, WeightStyle, XAxis);</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;  THStack* StackHist = <span class="keyword">new</span> THStack((<a class="code" href="group__SampleHandlerGetters.html#gadfad2507ad845ad36fff3c82231a143c">GetSampleTitle</a>(iSample)+<span class="stringliteral">&quot;_&quot;</span>+KinematicProjection+<span class="stringliteral">&quot;_Stack&quot;</span>).c_str(),<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;HistList.size();i++) {</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    StackHist-&gt;Add(HistList[i]);</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;  }</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;  <span class="keywordflow">return</span> StackHist;</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;}</div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_gaa5a0b0ed2e81af8e60a7fbda65971441"><div class="ttname"><a href="group__SampleHandlerGetters.html#gaa5a0b0ed2e81af8e60a7fbda65971441">SampleHandlerFD::ReturnHistsBySelection1D</a></div><div class="ttdeci">std::vector&lt; TH1 * &gt; ReturnHistsBySelection1D(const int iSample, std::string KinematicProjection, int Selection1, int Selection2=-1, int WeightStyle=0, TAxis *Axis=0)</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01855">SampleHandlerFD.cpp:1855</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga8be73835c2d9f0e50d738c4f204a0286"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8be73835c2d9f0e50d738c4f204a0286">&#9670;&nbsp;</a></span>ReturnStackHistLegend()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TLegend* SampleHandlerFD::ReturnStackHistLegend </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00150">150</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">THStackLeg</a>;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga3e88e3720a6a8d3384a6b8d317795c74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3e88e3720a6a8d3384a6b8d317795c74">&#9670;&nbsp;</a></span>ReturnStringFromKinematicParameter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::ReturnStringFromKinematicParameter </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>KinematicVariable</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ETA function to generically convert a kinematic type from xsec cov to a string. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01554">1554</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                                                                                                {</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  <span class="keyword">auto</span> it = <a class="code" href="classSampleHandlerFD.html#ad7ac675cc4ce81bec42e0700f1ff2620">ReversedKinematicParameters</a>-&gt;find(KinematicParameter);</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  <span class="keywordflow">if</span> (it != <a class="code" href="classSampleHandlerFD.html#ad7ac675cc4ce81bec42e0700f1ff2620">ReversedKinematicParameters</a>-&gt;end()) {</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    <span class="keywordflow">return</span> it-&gt;second;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  }</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160; </div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Did not recognise Kinematic Parameter type: {}&quot;</span>, KinematicParameter);</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;  <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160; </div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_ad7ac675cc4ce81bec42e0700f1ff2620"><div class="ttname"><a href="classSampleHandlerFD.html#ad7ac675cc4ce81bec42e0700f1ff2620">SampleHandlerFD::ReversedKinematicParameters</a></div><div class="ttdeci">const std::unordered_map&lt; int, std::string &gt; * ReversedKinematicParameters</div><div class="ttdoc">Mapping between kinematic enum and string.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00379">SampleHandlerFD.h:379</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga1c81b6b7a7e70b04c6c6ca1c81c70fc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1c81b6b7a7e70b04c6c6ca1c81c70fc5">&#9670;&nbsp;</a></span>SetTestStatistic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerBase::SetTestStatistic </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67">TestStatistic</a>&#160;</td>
          <td class="paramname"><em>testStat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the test statistic to be used when calculating the binned likelihoods. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">testStat</td><td>The test statistic to use. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8h_source.html#l00183">183</a> of file <a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;{ <a class="code" href="classSampleHandlerBase.html#a87670dbcda5d09b09675e8f407fe3a30">fTestStatistic</a> = testStat; }</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- Footer for MaCh3 Doxygen documentation -->
<footer class="mach3-footer" style="text-align: center;">
    <div style="margin-bottom: 15px;">
        <span style="font-weight: bold;">The MaCh3 Collaboration</span>
    </div>
    <!-- Dropdown to jump between doc versions -->
    <div style="margin-bottom: 10px;">
        <span>Select Software Version: </span>
        <select id="versionSelector" onchange="window.location.href=this.value" style="padding: 5px; border-radius: 4px; border: 1px solid #ccc;">
            <option value="">-- Select --</option>
            <option value="https://mach3-software.github.io/MaCh3/">develop</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.3.0/index.html">v2.3.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.2.0/index.html">v2.2.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.1.0/index.html">v2.1.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.0.0/index.html">v2.0.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.5.0/index.html">v1.5.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.4.0/index.html">v1.4.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.3.0/index.html">v1.3.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.2.0/index.html">v1.2.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.1.0/index.html">v1.1.0</option>
        </select>
    </div>
    <!-- Footer info about doxygen -->
    <div style="font-size: 0.9em; color: #666; margin-top: 10px;">
        Documentation generated with
        <a href="https://www.doxygen.nl/" target="_blank" style="color: #666;">Doxygen</a>
        <span id="doxygenVersion"></span>
    </div>
    <!-- Now grab doxygen version from metadata -->
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        const meta = document.querySelector('meta[name="generator"]');
        if (meta) {
            const version = meta.getAttribute("content").replace("Doxygen ", "");
            document.getElementById("doxygenVersion").textContent = " " + version;
        }
    });
    </script>
</footer>
