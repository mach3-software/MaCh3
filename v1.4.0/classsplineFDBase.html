<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MaCh3: splineFDBase Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="MaCh3.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mach3logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MaCh3
   &#160;<span id="projectnumber">1.4.0</span>
   </div>
   <div id="projectbrief">Reference Guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classsplineFDBase-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">splineFDBase Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>Bin-by-bin class calculating response for spline parameters.  
 <a href="classsplineFDBase.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="splineFDBase_8h_source.html">/hosthome/v1.4.0/splines/splineFDBase.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for splineFDBase:</div>
<div class="dyncontent">
<div class="center"><img src="classsplineFDBase__inherit__graph.png" border="0" usemap="#asplineFDBase_inherit__map" alt="Inheritance graph"/></div>
<map name="asplineFDBase_inherit__map" id="asplineFDBase_inherit__map">
<area shape="rect" title="Bin&#45;by&#45;bin class calculating response for spline parameters." alt="" coords="5,80,109,107"/>
<area shape="rect" href="classSplineBase.html" title="Base class for calculating weight from spline." alt="" coords="13,5,101,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for splineFDBase:</div>
<div class="dyncontent">
<div class="center"><img src="classsplineFDBase__coll__graph.png" border="0" usemap="#asplineFDBase_coll__map" alt="Collaboration graph"/></div>
<map name="asplineFDBase_coll__map" id="asplineFDBase_coll__map">
<area shape="rect" title="Bin&#45;by&#45;bin class calculating response for spline parameters." alt="" coords="2151,412,2255,439"/>
<area shape="rect" href="classSplineBase.html" title="Base class for calculating weight from spline." alt="" coords="1809,5,1897,32"/>
<area shape="rect" title=" " alt="" coords="1770,57,1937,98"/>
<area shape="rect" title=" " alt="" coords="1751,122,1956,193"/>
<area shape="rect" title=" " alt="" coords="1357,213,1513,254"/>
<area shape="rect" title=" " alt="" coords="1775,281,1932,322"/>
<area shape="rect" title=" " alt="" coords="1780,346,1927,387"/>
<area shape="rect" href="classTSpline3__red.html" title="CW: Reduced TSpline3 class." alt="" coords="1386,281,1485,308"/>
<area shape="rect" href="classTResponseFunction__red.html" title="KS: A reduced ResponseFunction Generic function used for evaluating weight." alt="" coords="947,181,1109,208"/>
<area shape="rect" title=" " alt="" coords="592,435,748,477"/>
<area shape="rect" href="classcovarianceBase.html" title="Base class responsible for handling of systematic error parameters. Capable of using PCA or using ada..." alt="" coords="971,772,1085,799"/>
<area shape="rect" href="classcovarianceXsec.html" title="Class responsible for handling of systematic error parameters with different types defined in the con..." alt="" coords="1796,831,1911,857"/>
<area shape="rect" title=" " alt="" coords="568,833,772,860"/>
<area shape="rect" href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html" title="Contains information about adaptive covariance matrix ." alt="" coords="541,567,799,593"/>
<area shape="rect" title=" " alt="" coords="218,532,339,559"/>
<area shape="rect" href="structXsecSplines1.html" title="KS: Struct holding info about Spline Systematics." alt="" coords="619,384,721,411"/>
<area shape="rect" href="structXsecNorms4.html" title="ETA &#45; Normalisations for cross&#45;section parameters Carrier for whether you want to apply a systematic ..." alt="" coords="979,1109,1077,1136"/>
<area shape="rect" title=" " alt="" coords="206,772,351,799"/>
<area shape="rect" title=" " alt="" coords="592,1006,748,1047"/>
<area shape="rect" title=" " alt="" coords="239,1149,319,1176"/>
<area shape="rect" title=" " alt="" coords="587,1149,753,1176"/>
<area shape="rect" title=" " alt="" coords="5,1142,132,1183"/>
<area shape="rect" title=" " alt="" coords="591,501,749,542"/>
<area shape="rect" title=" " alt="" coords="181,447,376,473"/>
<area shape="rect" title=" " alt="" coords="605,617,735,644"/>
<area shape="rect" title=" " alt="" coords="1133,384,1320,411"/>
<area shape="rect" title=" " alt="" coords="1362,823,1509,865"/>
<area shape="rect" title=" " alt="" coords="962,831,1094,857"/>
<area shape="rect" title=" " alt="" coords="1355,889,1516,916"/>
<area shape="rect" title=" " alt="" coords="1344,1109,1527,1136"/>
<area shape="rect" title=" " alt="" coords="1761,1173,1946,1214"/>
<area shape="rect" title=" " alt="" coords="1351,1267,1520,1293"/>
<area shape="rect" title=" " alt="" coords="1775,1302,1931,1343"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae46579e08ee311f797423b50003cd002"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#ae46579e08ee311f797423b50003cd002">splineFDBase</a> (<a class="el" href="classcovarianceXsec.html">covarianceXsec</a> *xsec_=nullptr)</td></tr>
<tr class="memdesc:ae46579e08ee311f797423b50003cd002"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classsplineFDBase.html#ae46579e08ee311f797423b50003cd002">More...</a><br /></td></tr>
<tr class="separator:ae46579e08ee311f797423b50003cd002"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16c33124874a336255a3cba480b835c2"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a16c33124874a336255a3cba480b835c2">~splineFDBase</a> ()</td></tr>
<tr class="memdesc:a16c33124874a336255a3cba480b835c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="classsplineFDBase.html#a16c33124874a336255a3cba480b835c2">More...</a><br /></td></tr>
<tr class="separator:a16c33124874a336255a3cba480b835c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6e248be25f753c85c4fbf2f3b72cf88"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#af6e248be25f753c85c4fbf2f3b72cf88">Evaluate</a> ()</td></tr>
<tr class="memdesc:af6e248be25f753c85c4fbf2f3b72cf88"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: This Eval should be used when using two separate x,{y,a,b,c,d} arrays to store the weights; probably the best one here! Same thing but pass parameter spline segments instead of variations.  <a href="classsplineFDBase.html#af6e248be25f753c85c4fbf2f3b72cf88">More...</a><br /></td></tr>
<tr class="separator:af6e248be25f753c85c4fbf2f3b72cf88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e33b916e60b424a9f3b3c7f889a9b52"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a8e33b916e60b424a9f3b3c7f889a9b52">AddSample</a> (const std::string &amp;SampleName, const std::string &amp;DetID, const std::vector&lt; std::string &gt; &amp;OscChanFileNames, const std::vector&lt; std::string &gt; &amp;SplineVarNames)</td></tr>
<tr class="memdesc:a8e33b916e60b424a9f3b3c7f889a9b52"><td class="mdescLeft">&#160;</td><td class="mdescRight">add oscillation channel to spline monolith  <a href="classsplineFDBase.html#a8e33b916e60b424a9f3b3c7f889a9b52">More...</a><br /></td></tr>
<tr class="separator:a8e33b916e60b424a9f3b3c7f889a9b52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d1872fe4be72c735bd55fa00e1674b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a6d1872fe4be72c735bd55fa00e1674b8">TransferToMonolith</a> ()</td></tr>
<tr class="separator:a6d1872fe4be72c735bd55fa00e1674b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e765571776f8affeca355a184fef11a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a6e765571776f8affeca355a184fef11a">cleanUpMemory</a> ()</td></tr>
<tr class="memdesc:a6e765571776f8affeca355a184fef11a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove setup variables not needed for spline evaluations.  <a href="classsplineFDBase.html#a6e765571776f8affeca355a184fef11a">More...</a><br /></td></tr>
<tr class="separator:a6e765571776f8affeca355a184fef11a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addabdf30ee85c6975422c0ccf3f1844f"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#addabdf30ee85c6975422c0ccf3f1844f">FillSampleArray</a> (std::string SampleName, std::vector&lt; std::string &gt; OscChanFileNames)=0</td></tr>
<tr class="separator:addabdf30ee85c6975422c0ccf3f1844f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cccada6b5ee280213997ab95721abf0"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; std::vector&lt; int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a1cccada6b5ee280213997ab95721abf0">StripDuplicatedModes</a> (std::vector&lt; std::vector&lt; int &gt; &gt; InputVector)=0</td></tr>
<tr class="memdesc:a1cccada6b5ee280213997ab95721abf0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if there are any repeated modes. This is used to reduce the number of modes in case many interaction modes get averaged into one spline.  <a href="classsplineFDBase.html#a1cccada6b5ee280213997ab95721abf0">More...</a><br /></td></tr>
<tr class="separator:a1cccada6b5ee280213997ab95721abf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a174446c62e92573d2c15c207b22f1c36"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; std::vector&lt; int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a174446c62e92573d2c15c207b22f1c36">GetEventSplines</a> (std::string SampleName, int iOscChan, int EventMode, double Var1Val, double Var2Val, double Var3Val)=0</td></tr>
<tr class="memdesc:a174446c62e92573d2c15c207b22f1c36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the splines which affect a given event.  <a href="classsplineFDBase.html#a174446c62e92573d2c15c207b22f1c36">More...</a><br /></td></tr>
<tr class="separator:a174446c62e92573d2c15c207b22f1c36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00c0e93b4c4799ffacaa58578e5dcf6b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TAxis * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a00c0e93b4c4799ffacaa58578e5dcf6b">FindSplineBinning</a> (std::string FileName, std::string SampleName)</td></tr>
<tr class="separator:a00c0e93b4c4799ffacaa58578e5dcf6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bfc616fab953333e6e938de52ce3bed"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a0bfc616fab953333e6e938de52ce3bed">CountNumberOfLoadedSplines</a> (bool NonFlat=false, int Verbosity=0)</td></tr>
<tr class="separator:a0bfc616fab953333e6e938de52ce3bed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa37a0f892b96f6b0e3b6b7aa847e94cb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#aa37a0f892b96f6b0e3b6b7aa847e94cb">getNDim</a> (int BinningOpt)</td></tr>
<tr class="separator:aa37a0f892b96f6b0e3b6b7aa847e94cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85302df644fb84ff00201624c454636f"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a85302df644fb84ff00201624c454636f">getDimLabel</a> (int BinningOpt, unsigned int Axis)</td></tr>
<tr class="separator:a85302df644fb84ff00201624c454636f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5de6441e53ffe4e7e126a222ac8d712a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a5de6441e53ffe4e7e126a222ac8d712a">getSampleIndex</a> (const std::string &amp;SampleName)</td></tr>
<tr class="separator:a5de6441e53ffe4e7e126a222ac8d712a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b026cd74035f56db3790f1eea49de92"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a2b026cd74035f56db3790f1eea49de92">isValidSplineIndex</a> (const std::string &amp;SampleName, int iSyst, int iOscChan, int iMode, int iVar1, int iVar2, int iVar3)</td></tr>
<tr class="separator:a2b026cd74035f56db3790f1eea49de92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9bcc5253804c4a5ad8e2990490ecfab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#ac9bcc5253804c4a5ad8e2990490ecfab">BuildSampleIndexingArray</a> (const std::string &amp;SampleName)</td></tr>
<tr class="separator:ac9bcc5253804c4a5ad8e2990490ecfab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2eb495f4d63c9e4ee10b97c47e982b28"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a2eb495f4d63c9e4ee10b97c47e982b28">PrepForReweight</a> ()</td></tr>
<tr class="separator:a2eb495f4d63c9e4ee10b97c47e982b28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b7b34479c3240a9827d6a0b5b7da4b4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a8b7b34479c3240a9827d6a0b5b7da4b4">getSplineCoeff_SepMany</a> (int splineindex, <a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> *&amp;xArray, <a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> *&amp;manyArray)</td></tr>
<tr class="separator:a8b7b34479c3240a9827d6a0b5b7da4b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f5b16b65dc7da748f20bdc803b7e593"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a7f5b16b65dc7da748f20bdc803b7e593">PrintBinning</a> (TAxis *Axis)</td></tr>
<tr class="separator:a7f5b16b65dc7da748f20bdc803b7e593"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af45c2bd4fbeb4dedabdedd991a25fb1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#af45c2bd4fbeb4dedabdedd991a25fb1e">PrintSampleDetails</a> (const std::string &amp;SampleName)</td></tr>
<tr class="separator:af45c2bd4fbeb4dedabdedd991a25fb1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2930155dc346dc5106bc481586ca4948"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a2930155dc346dc5106bc481586ca4948">PrintArrayDetails</a> (const std::string &amp;SampleName)</td></tr>
<tr class="separator:a2930155dc346dc5106bc481586ca4948"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8825fb6bdcde012c90005dd9b91967e4"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a8825fb6bdcde012c90005dd9b91967e4">retPointer</a> (const int sample, const int oscchan, const int syst, const int mode, const int var1bin, const int var2bin, const int var3bin) const</td></tr>
<tr class="separator:a8825fb6bdcde012c90005dd9b91967e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classSplineBase"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classSplineBase')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classSplineBase.html">SplineBase</a></td></tr>
<tr class="memitem:aa6965d1522cc68ecf81ac3bfd2dcd6f1 inherit pub_methods_classSplineBase"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplineBase.html#aa6965d1522cc68ecf81ac3bfd2dcd6f1">SplineBase</a> ()</td></tr>
<tr class="memdesc:aa6965d1522cc68ecf81ac3bfd2dcd6f1 inherit pub_methods_classSplineBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classSplineBase.html#aa6965d1522cc68ecf81ac3bfd2dcd6f1">More...</a><br /></td></tr>
<tr class="separator:aa6965d1522cc68ecf81ac3bfd2dcd6f1 inherit pub_methods_classSplineBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0de19b2322edb4197380506d594456bd inherit pub_methods_classSplineBase"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplineBase.html#a0de19b2322edb4197380506d594456bd">~SplineBase</a> ()</td></tr>
<tr class="memdesc:a0de19b2322edb4197380506d594456bd inherit pub_methods_classSplineBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="classSplineBase.html#a0de19b2322edb4197380506d594456bd">More...</a><br /></td></tr>
<tr class="separator:a0de19b2322edb4197380506d594456bd inherit pub_methods_classSplineBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e1534f622ae1976b21df1ebf984eec5 inherit pub_methods_classSplineBase"><td class="memItemLeft" align="right" valign="top">virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplineBase.html#a2e1534f622ae1976b21df1ebf984eec5">GetName</a> () const</td></tr>
<tr class="memdesc:a2e1534f622ae1976b21df1ebf984eec5 inherit pub_methods_classSplineBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get class name.  <a href="classSplineBase.html#a2e1534f622ae1976b21df1ebf984eec5">More...</a><br /></td></tr>
<tr class="separator:a2e1534f622ae1976b21df1ebf984eec5 inherit pub_methods_classSplineBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ab4a852337aab961abbcaa0c9f70c88ba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#ab4a852337aab961abbcaa0c9f70c88ba">FindSplineSegment</a> () override</td></tr>
<tr class="memdesc:ab4a852337aab961abbcaa0c9f70c88ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW:Code used in step by step reweighting, Find Spline Segment for each param.  <a href="classsplineFDBase.html#ab4a852337aab961abbcaa0c9f70c88ba">More...</a><br /></td></tr>
<tr class="separator:ab4a852337aab961abbcaa0c9f70c88ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9eceab58c0aa06b58eb4e3708c00ee0e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a9eceab58c0aa06b58eb4e3708c00ee0e">CalcSplineWeights</a> () override</td></tr>
<tr class="memdesc:a9eceab58c0aa06b58eb4e3708c00ee0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">CPU based code which eval weight for each spline.  <a href="classsplineFDBase.html#a9eceab58c0aa06b58eb4e3708c00ee0e">More...</a><br /></td></tr>
<tr class="separator:a9eceab58c0aa06b58eb4e3708c00ee0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a237a8b8c3c165c82ebe15d2ca740c7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a1a237a8b8c3c165c82ebe15d2ca740c7">ModifyWeights</a> () override</td></tr>
<tr class="memdesc:a1a237a8b8c3c165c82ebe15d2ca740c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calc total event weight, not used by Bin-by-bin splines.  <a href="classsplineFDBase.html#a1a237a8b8c3c165c82ebe15d2ca740c7">More...</a><br /></td></tr>
<tr class="separator:a1a237a8b8c3c165c82ebe15d2ca740c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classSplineBase"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classSplineBase')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classSplineBase.html">SplineBase</a></td></tr>
<tr class="memitem:ac8a5f86ac6f156a7e11ef188b06f425f inherit pro_methods_classSplineBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSplineBase.html#ac8a5f86ac6f156a7e11ef188b06f425f">getTF1Coeff</a> (<a class="el" href="classTF1__red.html">TF1_red</a> *&amp;spl, int &amp;nPoints, float *&amp;coeffs)</td></tr>
<tr class="memdesc:ac8a5f86ac6f156a7e11ef188b06f425f inherit pro_methods_classSplineBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Gets the polynomial coefficients for TF1.  <a href="classSplineBase.html#ac8a5f86ac6f156a7e11ef188b06f425f">More...</a><br /></td></tr>
<tr class="separator:ac8a5f86ac6f156a7e11ef188b06f425f inherit pro_methods_classSplineBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a891de87b873e079f6bbdb1355a9ff153"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcovarianceXsec.html">covarianceXsec</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a891de87b873e079f6bbdb1355a9ff153">xsec</a></td></tr>
<tr class="memdesc:a891de87b873e079f6bbdb1355a9ff153"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to covariance xsec.  <a href="classsplineFDBase.html#a891de87b873e079f6bbdb1355a9ff153">More...</a><br /></td></tr>
<tr class="separator:a891de87b873e079f6bbdb1355a9ff153"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78508c5d0d4ef09457beb723dc796208"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a78508c5d0d4ef09457beb723dc796208">SampleNames</a></td></tr>
<tr class="separator:a78508c5d0d4ef09457beb723dc796208"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c28400605049bdee229885c46463dcd"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a6c28400605049bdee229885c46463dcd">Dimensions</a></td></tr>
<tr class="separator:a6c28400605049bdee229885c46463dcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00e1aeea8e9389c41f93469a26c83adc"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; std::string &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a00e1aeea8e9389c41f93469a26c83adc">DimensionLabels</a></td></tr>
<tr class="separator:a00e1aeea8e9389c41f93469a26c83adc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a481d275de711edfddbb82d3924b6e63a"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a481d275de711edfddbb82d3924b6e63a">DetIDs</a></td></tr>
<tr class="separator:a481d275de711edfddbb82d3924b6e63a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad64c7c63db8ea676f86eb2279f04d40"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#aad64c7c63db8ea676f86eb2279f04d40">nSplineParams</a></td></tr>
<tr class="separator:aad64c7c63db8ea676f86eb2279f04d40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa10670a64bbdef3ffd69f4b8f102fff3"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#aa10670a64bbdef3ffd69f4b8f102fff3">nOscChans</a></td></tr>
<tr class="separator:aa10670a64bbdef3ffd69f4b8f102fff3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af71b65713518f42e59c543dbad5dab70"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; std::vector&lt; TAxis * &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#af71b65713518f42e59c543dbad5dab70">SplineBinning</a></td></tr>
<tr class="separator:af71b65713518f42e59c543dbad5dab70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5619363447e607cd835c46d601b10675"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; std::string &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a5619363447e607cd835c46d601b10675">SplineFileParPrefixNames</a></td></tr>
<tr class="separator:a5619363447e607cd835c46d601b10675"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b7aeec6d03dad01975582226b39632b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; std::vector&lt; int &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a6b7aeec6d03dad01975582226b39632b">SplineModeVecs</a></td></tr>
<tr class="separator:a6b7aeec6d03dad01975582226b39632b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af036372a158b4e463683a8d02a20ec3d"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#af036372a158b4e463683a8d02a20ec3d">GlobalSystIndex</a></td></tr>
<tr class="memdesc:af036372a158b4e463683a8d02a20ec3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This holds the global spline index and is used to grab the current parameter value to evaluate splines at. Each internal vector will be of size of the number of spline systematics which affect that sample.  <a href="classsplineFDBase.html#af036372a158b4e463683a8d02a20ec3d">More...</a><br /></td></tr>
<tr class="separator:af036372a158b4e463683a8d02a20ec3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabc74a6dd8b13fc6925e975bf5f92cff"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; <a class="el" href="Structs_8h.html#a6720d732608767153550aebebcf8fbf4">SplineInterpolation</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#aabc74a6dd8b13fc6925e975bf5f92cff">SplineInterpolationTypes</a></td></tr>
<tr class="memdesc:aabc74a6dd8b13fc6925e975bf5f92cff"><td class="mdescLeft">&#160;</td><td class="mdescRight">spline interpolation types for each sample. These vectors are from a call to GetSplineInterpolationFromDetID()  <a href="classsplineFDBase.html#aabc74a6dd8b13fc6925e975bf5f92cff">More...</a><br /></td></tr>
<tr class="separator:aabc74a6dd8b13fc6925e975bf5f92cff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d42cbfc22f21906264af285fd57b1af"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a0d42cbfc22f21906264af285fd57b1af">nUniqueSysts</a></td></tr>
<tr class="separator:a0d42cbfc22f21906264af285fd57b1af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacf850f4ec22e4f7338f243999ecc7dd"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#aacf850f4ec22e4f7338f243999ecc7dd">UniqueSystNames</a></td></tr>
<tr class="separator:aacf850f4ec22e4f7338f243999ecc7dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b821b95c2db6063a9baa244b28aeaa6"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a3b821b95c2db6063a9baa244b28aeaa6">UniqueSystIndices</a></td></tr>
<tr class="separator:a3b821b95c2db6063a9baa244b28aeaa6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a176d42bb137d3c8c3771eb1a4a8440c8"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a176d42bb137d3c8c3771eb1a4a8440c8">UniqueSystNKnots</a></td></tr>
<tr class="separator:a176d42bb137d3c8c3771eb1a4a8440c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa36e6889d054ad0f86f33a53dd3fe036"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#aa36e6889d054ad0f86f33a53dd3fe036">UniqueSystCurrSegment</a></td></tr>
<tr class="separator:aa36e6889d054ad0f86f33a53dd3fe036"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5112a1bbd658d3a90c6a785c12aebf34"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; <a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a5112a1bbd658d3a90c6a785c12aebf34">UniqueSystXPts</a></td></tr>
<tr class="separator:a5112a1bbd658d3a90c6a785c12aebf34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3a4e79bfe675a4070597557e6226e12"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; std::vector&lt; std::vector&lt; std::vector&lt; std::vector&lt; std::vector&lt; int &gt; &gt; &gt; &gt; &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a></td></tr>
<tr class="memdesc:ab3a4e79bfe675a4070597557e6226e12"><td class="mdescLeft">&#160;</td><td class="mdescRight">Variables related to determined which modes have splines and which piggy-back of other modes.  <a href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">More...</a><br /></td></tr>
<tr class="separator:ab3a4e79bfe675a4070597557e6226e12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af63885ddb6731f77808d029372e6b187"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#af63885ddb6731f77808d029372e6b187">coeffindexvec</a></td></tr>
<tr class="separator:af63885ddb6731f77808d029372e6b187"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a564f5748f16d97ebf1e1c300a1cc5c"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a7a564f5748f16d97ebf1e1c300a1cc5c">uniquecoeffindices</a></td></tr>
<tr class="separator:a7a564f5748f16d97ebf1e1c300a1cc5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84ec9ea208503053b9735b1cb1bc417d"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classTSpline3__red.html">TSpline3_red</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a84ec9ea208503053b9735b1cb1bc417d">splinevec_Monolith</a></td></tr>
<tr class="separator:a84ec9ea208503053b9735b1cb1bc417d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1fefa7f796f2a28a69f5336f5777bce"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#ad1fefa7f796f2a28a69f5336f5777bce">MonolithSize</a></td></tr>
<tr class="separator:ad1fefa7f796f2a28a69f5336f5777bce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addec38a8493974ccc3ee16931d5b794a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#addec38a8493974ccc3ee16931d5b794a">MonolithIndex</a></td></tr>
<tr class="separator:addec38a8493974ccc3ee16931d5b794a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcff04fee3e6790a099a0df9dbee74c2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#abcff04fee3e6790a099a0df9dbee74c2">CoeffIndex</a></td></tr>
<tr class="separator:abcff04fee3e6790a099a0df9dbee74c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a324c4b50910454092ba45d945ef57bda"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a324c4b50910454092ba45d945ef57bda">xVarArray</a></td></tr>
<tr class="memdesc:a324c4b50910454092ba45d945ef57bda"><td class="mdescLeft">&#160;</td><td class="mdescRight">Probably need to clear these arrays up at some point.  <a href="classsplineFDBase.html#a324c4b50910454092ba45d945ef57bda">More...</a><br /></td></tr>
<tr class="separator:a324c4b50910454092ba45d945ef57bda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8a204355df78af3f79bf8f2815258d3"><td class="memItemLeft" align="right" valign="top">bool *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#aa8a204355df78af3f79bf8f2815258d3">isflatarray</a></td></tr>
<tr class="memdesc:aa8a204355df78af3f79bf8f2815258d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Need to keep track of which splines are flat and which aren't.  <a href="classsplineFDBase.html#aa8a204355df78af3f79bf8f2815258d3">More...</a><br /></td></tr>
<tr class="separator:aa8a204355df78af3f79bf8f2815258d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00f046c4c64c0aa11334b32b0701a9f1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a00f046c4c64c0aa11334b32b0701a9f1">xcoeff_arr</a></td></tr>
<tr class="memdesc:a00f046c4c64c0aa11334b32b0701a9f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">x coefficients for each spline  <a href="classsplineFDBase.html#a00f046c4c64c0aa11334b32b0701a9f1">More...</a><br /></td></tr>
<tr class="separator:a00f046c4c64c0aa11334b32b0701a9f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab883a1f2cdae707c36fa27b86ed7f279"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#ab883a1f2cdae707c36fa27b86ed7f279">manycoeff_arr</a></td></tr>
<tr class="memdesc:ab883a1f2cdae707c36fa27b86ed7f279"><td class="mdescLeft">&#160;</td><td class="mdescRight">ybcd coefficients for each spline  <a href="classsplineFDBase.html#ab883a1f2cdae707c36fa27b86ed7f279">More...</a><br /></td></tr>
<tr class="separator:ab883a1f2cdae707c36fa27b86ed7f279"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a107c337ce7053208795747a3223f04e1"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#a107c337ce7053208795747a3223f04e1">weightvec_Monolith</a></td></tr>
<tr class="separator:a107c337ce7053208795747a3223f04e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae237cc1c6d97e35bf4f7f64e369a5781"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsplineFDBase.html#ae237cc1c6d97e35bf4f7f64e369a5781">uniquesplinevec_Monolith</a></td></tr>
<tr class="separator:ae237cc1c6d97e35bf4f7f64e369a5781"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Bin-by-bin class calculating response for spline parameters. </p>
<dl class="section see"><dt>See also</dt><dd>For more details, visit the <a href="https://github.com/mach3-software/MaCh3/wiki/05.-Splines">Wiki</a>. </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Dan Barrow </dd>
<dd>
Ed Atkin </dd>
<dd>
Henry Wallace </dd></dl>

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00017">17</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ae46579e08ee311f797423b50003cd002"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae46579e08ee311f797423b50003cd002">&#9670;&nbsp;</a></span>splineFDBase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">splineFDBase::splineFDBase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcovarianceXsec.html">covarianceXsec</a> *&#160;</td>
          <td class="paramname"><em>xsec_</em> = <code>nullptr</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd>ETA - do all of these functions and members actually need to be public? </dd></dl>

<p class="definition">Definition at line <a class="el" href="splineFDBase_8cpp_source.html#l00008">8</a> of file <a class="el" href="splineFDBase_8cpp_source.html">splineFDBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;              : <a class="code" href="classSplineBase.html#aa6965d1522cc68ecf81ac3bfd2dcd6f1">SplineBase</a>() {</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//****************************************</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  <span class="keywordflow">if</span> (!xsec_) {</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Trying to create splineFDBase with uninitialised covariance object&quot;</span>);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  }</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <a class="code" href="classsplineFDBase.html#a891de87b873e079f6bbdb1355a9ff153">xsec</a> = xsec_;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <span class="comment">// Keep these in class scope, important for using 1 monolith/sample!</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  <a class="code" href="classsplineFDBase.html#addec38a8493974ccc3ee16931d5b794a">MonolithIndex</a> = 0; <span class="comment">//Keeps track of the monolith index we&#39;re on when filling arrays (declared here so we can have multiple FillSampleArray calls)</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <a class="code" href="classsplineFDBase.html#abcff04fee3e6790a099a0df9dbee74c2">CoeffIndex</a> = 0; <span class="comment">//Keeps track of our indexing the coefficient arrays [x, ybcd]</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a61052119a625282d0ec6d4a97adf3ee2"><div class="ttname"><a href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a></div><div class="ttdeci">#define MACH3LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00025">MaCh3Logger.h:25</a></div></div>
<div class="ttc" id="aclassMaCh3Exception_html"><div class="ttname"><a href="classMaCh3Exception.html">MaCh3Exception</a></div><div class="ttdoc">Custom exception class for MaCh3 errors.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Exception_8h_source.html#l00013">MaCh3Exception.h:13</a></div></div>
<div class="ttc" id="aclassSplineBase_html_aa6965d1522cc68ecf81ac3bfd2dcd6f1"><div class="ttname"><a href="classSplineBase.html#aa6965d1522cc68ecf81ac3bfd2dcd6f1">SplineBase::SplineBase</a></div><div class="ttdeci">SplineBase()</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="SplineBase_8cpp_source.html#l00007">SplineBase.cpp:7</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_a891de87b873e079f6bbdb1355a9ff153"><div class="ttname"><a href="classsplineFDBase.html#a891de87b873e079f6bbdb1355a9ff153">splineFDBase::xsec</a></div><div class="ttdeci">covarianceXsec * xsec</div><div class="ttdoc">Pointer to covariance xsec.</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00078">splineFDBase.h:76</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_abcff04fee3e6790a099a0df9dbee74c2"><div class="ttname"><a href="classsplineFDBase.html#abcff04fee3e6790a099a0df9dbee74c2">splineFDBase::CoeffIndex</a></div><div class="ttdeci">int CoeffIndex</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00118">splineFDBase.h:118</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_addec38a8493974ccc3ee16931d5b794a"><div class="ttname"><a href="classsplineFDBase.html#addec38a8493974ccc3ee16931d5b794a">splineFDBase::MonolithIndex</a></div><div class="ttdeci">int MonolithIndex</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00117">splineFDBase.h:117</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a16c33124874a336255a3cba480b835c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16c33124874a336255a3cba480b835c2">&#9670;&nbsp;</a></span>~splineFDBase()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">splineFDBase::~splineFDBase </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000003">Todo:</a></b></dt><dd>it need some love </dd></dl>

<p class="definition">Definition at line <a class="el" href="splineFDBase_8cpp_source.html#l00022">22</a> of file <a class="el" href="splineFDBase_8cpp_source.html">splineFDBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;                           {</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//****************************************</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classsplineFDBase.html#ab883a1f2cdae707c36fa27b86ed7f279">manycoeff_arr</a> != <span class="keyword">nullptr</span>) <span class="keyword">delete</span>[] <a class="code" href="classsplineFDBase.html#ab883a1f2cdae707c36fa27b86ed7f279">manycoeff_arr</a>;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classsplineFDBase.html#a00f046c4c64c0aa11334b32b0701a9f1">xcoeff_arr</a> != <span class="keyword">nullptr</span>) <span class="keyword">delete</span>[] <a class="code" href="classsplineFDBase.html#a00f046c4c64c0aa11334b32b0701a9f1">xcoeff_arr</a>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;}</div>
<div class="ttc" id="aclasssplineFDBase_html_a00f046c4c64c0aa11334b32b0701a9f1"><div class="ttname"><a href="classsplineFDBase.html#a00f046c4c64c0aa11334b32b0701a9f1">splineFDBase::xcoeff_arr</a></div><div class="ttdeci">M3::float_t * xcoeff_arr</div><div class="ttdoc">x coefficients for each spline</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00125">splineFDBase.h:125</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_ab883a1f2cdae707c36fa27b86ed7f279"><div class="ttname"><a href="classsplineFDBase.html#ab883a1f2cdae707c36fa27b86ed7f279">splineFDBase::manycoeff_arr</a></div><div class="ttdeci">M3::float_t * manycoeff_arr</div><div class="ttdoc">ybcd coefficients for each spline</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00127">splineFDBase.h:127</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a8e33b916e60b424a9f3b3c7f889a9b52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e33b916e60b424a9f3b3c7f889a9b52">&#9670;&nbsp;</a></span>AddSample()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool splineFDBase::AddSample </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>SampleName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>DetID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>OscChanFileNames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>SplineVarNames</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>add oscillation channel to spline monolith </p>

<p class="definition">Definition at line <a class="el" href="splineFDBase_8cpp_source.html#l00065">65</a> of file <a class="el" href="splineFDBase_8cpp_source.html">splineFDBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;{</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <a class="code" href="classsplineFDBase.html#a78508c5d0d4ef09457beb723dc796208">SampleNames</a>.push_back(SampleName);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <a class="code" href="classsplineFDBase.html#a6c28400605049bdee229885c46463dcd">Dimensions</a>.push_back(<span class="keywordtype">int</span>(SplineVarNames.size()));</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="classsplineFDBase.html#a00e1aeea8e9389c41f93469a26c83adc">DimensionLabels</a>.push_back(SplineVarNames);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <a class="code" href="classsplineFDBase.html#a481d275de711edfddbb82d3924b6e63a">DetIDs</a>.push_back(DetID);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordtype">int</span> nSplineParam = <a class="code" href="classsplineFDBase.html#a891de87b873e079f6bbdb1355a9ff153">xsec</a>-&gt;<a class="code" href="classcovarianceXsec.html#ab4f92efb89282448bc65d69238147566">GetNumParamsFromDetID</a>(DetID, <a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa29d6ccf6cf507f6e66c72b1d3c2aed00">SystType::kSpline</a>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="classsplineFDBase.html#aad64c7c63db8ea676f86eb2279f04d40">nSplineParams</a>.push_back(nSplineParam);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">//This holds the global index of the spline i.e. 0 -&gt; _fNumPar</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  std::vector&lt;int&gt; GlobalSystIndex_Sample = <a class="code" href="classsplineFDBase.html#a891de87b873e079f6bbdb1355a9ff153">xsec</a>-&gt;<a class="code" href="classcovarianceXsec.html#ac580752fdcf84f1f6298c29e15b7fbb5">GetGlobalSystIndexFromDetID</a>(DetID, <a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa29d6ccf6cf507f6e66c72b1d3c2aed00">SystType::kSpline</a>);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="comment">//Keep track of this for all the samples</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <a class="code" href="classsplineFDBase.html#af036372a158b4e463683a8d02a20ec3d">GlobalSystIndex</a>.push_back(GlobalSystIndex_Sample);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  std::vector&lt;SplineInterpolation&gt; SplineInterpolation_Sample = <a class="code" href="classsplineFDBase.html#a891de87b873e079f6bbdb1355a9ff153">xsec</a>-&gt;<a class="code" href="classcovarianceXsec.html#a31ec21d902da40866b905e6ef55aef1e">GetSplineInterpolationFromDetID</a>(DetID);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="comment">// Keep track of this for all samples</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <a class="code" href="classsplineFDBase.html#aabc74a6dd8b13fc6925e975bf5f92cff">SplineInterpolationTypes</a>.push_back(SplineInterpolation_Sample);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  std::vector&lt;std::string&gt; SplineFileParPrefixNames_Sample = <a class="code" href="classsplineFDBase.html#a891de87b873e079f6bbdb1355a9ff153">xsec</a>-&gt;<a class="code" href="classcovarianceXsec.html#ae9e3666595988885e95c288f6ffd4ff6">GetSplineParsNamesFromDetID</a>(DetID);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="classsplineFDBase.html#a5619363447e607cd835c46d601b10675">SplineFileParPrefixNames</a>.push_back(SplineFileParPrefixNames_Sample);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Create SplineModeVecs_Sample&quot;</span>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  std::vector&lt;std::vector&lt;int&gt;&gt; SplineModeVecs_Sample = <a class="code" href="classsplineFDBase.html#a1cccada6b5ee280213997ab95721abf0">StripDuplicatedModes</a>(<a class="code" href="classsplineFDBase.html#a891de87b873e079f6bbdb1355a9ff153">xsec</a>-&gt;<a class="code" href="classcovarianceXsec.html#a4559ca9cbbc02e63d230ee868997d252">GetSplineModeVecFromDetID</a>(DetID));</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;SplineModeVecs_Sample is of size {}&quot;</span>, SplineModeVecs_Sample.size());</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <a class="code" href="classsplineFDBase.html#a6b7aeec6d03dad01975582226b39632b">SplineModeVecs</a>.push_back(SplineModeVecs_Sample);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;SplineModeVecs is of size {}&quot;</span>, <a class="code" href="classsplineFDBase.html#a6b7aeec6d03dad01975582226b39632b">SplineModeVecs</a>.size());</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordtype">int</span> nOscChan = int(OscChanFileNames.size());</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <a class="code" href="classsplineFDBase.html#aa10670a64bbdef3ffd69f4b8f102fff3">nOscChans</a>.push_back(nOscChan);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="classsplineFDBase.html#af45c2bd4fbeb4dedabdedd991a25fb1e">PrintSampleDetails</a>(SampleName);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  std::vector&lt;std::vector&lt;TAxis *&gt;&gt; SampleBinning(nOscChan);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iOscChan = 0; iOscChan &lt; nOscChan; iOscChan++)</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    SampleBinning[iOscChan] = <a class="code" href="classsplineFDBase.html#a00c0e93b4c4799ffacaa58578e5dcf6b">FindSplineBinning</a>(OscChanFileNames[iOscChan], SampleName);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;#----------------------------------------------------------------------------------------------------------------------------------#&quot;</span>);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <a class="code" href="classsplineFDBase.html#af71b65713518f42e59c543dbad5dab70">SplineBinning</a>.push_back(SampleBinning);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <a class="code" href="classsplineFDBase.html#ac9bcc5253804c4a5ad8e2990490ecfab">BuildSampleIndexingArray</a>(SampleName);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <a class="code" href="classsplineFDBase.html#a2930155dc346dc5106bc481586ca4948">PrintArrayDetails</a>(SampleName);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;#----------------------------------------------------------------------------------------------------------------------------------#&quot;</span>);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <a class="code" href="classsplineFDBase.html#addabdf30ee85c6975422c0ccf3f1844f">FillSampleArray</a>(SampleName, OscChanFileNames);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;#----------------------------------------------------------------------------------------------------------------------------------#&quot;</span>);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a95fa4dffc648e4c5536c9292c2bdcac3"><div class="ttname"><a href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a></div><div class="ttdeci">#define MACH3LOG_INFO</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00023">MaCh3Logger.h:23</a></div></div>
<div class="ttc" id="aStructs_8h_html_affc27d8b7b82d3713f45af17873fde2fa29d6ccf6cf507f6e66c72b1d3c2aed00"><div class="ttname"><a href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa29d6ccf6cf507f6e66c72b1d3c2aed00">kSpline</a></div><div class="ttdeci">@ kSpline</div><div class="ttdoc">For splined parameters (1D)</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00227">Structs.h:227</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a31ec21d902da40866b905e6ef55aef1e"><div class="ttname"><a href="classcovarianceXsec.html#a31ec21d902da40866b905e6ef55aef1e">covarianceXsec::GetSplineInterpolationFromDetID</a></div><div class="ttdeci">const std::vector&lt; SplineInterpolation &gt; GetSplineInterpolationFromDetID(const std::string &amp;DetID)</div><div class="ttdoc">Get the interpolation types for splines affecting a particular DetID.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00121">covarianceXsec.cpp:121</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a4559ca9cbbc02e63d230ee868997d252"><div class="ttname"><a href="classcovarianceXsec.html#a4559ca9cbbc02e63d230ee868997d252">covarianceXsec::GetSplineModeVecFromDetID</a></div><div class="ttdeci">const std::vector&lt; std::vector&lt; int &gt; &gt; GetSplineModeVecFromDetID(const std::string &amp;DetID)</div><div class="ttdoc">DB Grab the Spline Modes for the relevant DetID.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00137">covarianceXsec.cpp:137</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_ab4f92efb89282448bc65d69238147566"><div class="ttname"><a href="classcovarianceXsec.html#ab4f92efb89282448bc65d69238147566">covarianceXsec::GetNumParamsFromDetID</a></div><div class="ttdeci">int GetNumParamsFromDetID(const std::string &amp;DetID, const SystType Type)</div><div class="ttdoc">DB Grab the number of parameters for the relevant DetID.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00282">covarianceXsec.cpp:282</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_ac580752fdcf84f1f6298c29e15b7fbb5"><div class="ttname"><a href="classcovarianceXsec.html#ac580752fdcf84f1f6298c29e15b7fbb5">covarianceXsec::GetGlobalSystIndexFromDetID</a></div><div class="ttdeci">const std::vector&lt; int &gt; GetGlobalSystIndexFromDetID(const std::string &amp;DetID, const SystType Type)</div><div class="ttdoc">DB Get spline parameters depending on given DetID.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00213">covarianceXsec.cpp:213</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_ae9e3666595988885e95c288f6ffd4ff6"><div class="ttname"><a href="classcovarianceXsec.html#ae9e3666595988885e95c288f6ffd4ff6">covarianceXsec::GetSplineParsNamesFromDetID</a></div><div class="ttdeci">const std::vector&lt; std::string &gt; GetSplineParsNamesFromDetID(const std::string &amp;DetID)</div><div class="ttdoc">DB Get spline parameters depending on given DetID.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00106">covarianceXsec.cpp:106</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_a00c0e93b4c4799ffacaa58578e5dcf6b"><div class="ttname"><a href="classsplineFDBase.html#a00c0e93b4c4799ffacaa58578e5dcf6b">splineFDBase::FindSplineBinning</a></div><div class="ttdeci">std::vector&lt; TAxis * &gt; FindSplineBinning(std::string FileName, std::string SampleName)</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8cpp_source.html#l00373">splineFDBase.cpp:373</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_a00e1aeea8e9389c41f93469a26c83adc"><div class="ttname"><a href="classsplineFDBase.html#a00e1aeea8e9389c41f93469a26c83adc">splineFDBase::DimensionLabels</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::string &gt; &gt; DimensionLabels</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00083">splineFDBase.h:83</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_a1cccada6b5ee280213997ab95721abf0"><div class="ttname"><a href="classsplineFDBase.html#a1cccada6b5ee280213997ab95721abf0">splineFDBase::StripDuplicatedModes</a></div><div class="ttdeci">virtual std::vector&lt; std::vector&lt; int &gt; &gt; StripDuplicatedModes(std::vector&lt; std::vector&lt; int &gt; &gt; InputVector)=0</div><div class="ttdoc">Check if there are any repeated modes. This is used to reduce the number of modes in case many intera...</div></div>
<div class="ttc" id="aclasssplineFDBase_html_a2930155dc346dc5106bc481586ca4948"><div class="ttname"><a href="classsplineFDBase.html#a2930155dc346dc5106bc481586ca4948">splineFDBase::PrintArrayDetails</a></div><div class="ttdeci">void PrintArrayDetails(const std::string &amp;SampleName)</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8cpp_source.html#l00793">splineFDBase.cpp:793</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_a481d275de711edfddbb82d3924b6e63a"><div class="ttname"><a href="classsplineFDBase.html#a481d275de711edfddbb82d3924b6e63a">splineFDBase::DetIDs</a></div><div class="ttdeci">std::vector&lt; std::string &gt; DetIDs</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00084">splineFDBase.h:84</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_a5619363447e607cd835c46d601b10675"><div class="ttname"><a href="classsplineFDBase.html#a5619363447e607cd835c46d601b10675">splineFDBase::SplineFileParPrefixNames</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::string &gt; &gt; SplineFileParPrefixNames</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00089">splineFDBase.h:89</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_a6b7aeec6d03dad01975582226b39632b"><div class="ttname"><a href="classsplineFDBase.html#a6b7aeec6d03dad01975582226b39632b">splineFDBase::SplineModeVecs</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; int &gt; &gt; &gt; SplineModeVecs</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00093">splineFDBase.h:93</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_a6c28400605049bdee229885c46463dcd"><div class="ttname"><a href="classsplineFDBase.html#a6c28400605049bdee229885c46463dcd">splineFDBase::Dimensions</a></div><div class="ttdeci">std::vector&lt; int &gt; Dimensions</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00082">splineFDBase.h:82</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_a78508c5d0d4ef09457beb723dc796208"><div class="ttname"><a href="classsplineFDBase.html#a78508c5d0d4ef09457beb723dc796208">splineFDBase::SampleNames</a></div><div class="ttdeci">std::vector&lt; std::string &gt; SampleNames</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00081">splineFDBase.h:81</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_aa10670a64bbdef3ffd69f4b8f102fff3"><div class="ttname"><a href="classsplineFDBase.html#aa10670a64bbdef3ffd69f4b8f102fff3">splineFDBase::nOscChans</a></div><div class="ttdeci">std::vector&lt; int &gt; nOscChans</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00086">splineFDBase.h:86</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_aabc74a6dd8b13fc6925e975bf5f92cff"><div class="ttname"><a href="classsplineFDBase.html#aabc74a6dd8b13fc6925e975bf5f92cff">splineFDBase::SplineInterpolationTypes</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; SplineInterpolation &gt; &gt; SplineInterpolationTypes</div><div class="ttdoc">spline interpolation types for each sample. These vectors are from a call to GetSplineInterpolationFr...</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00100">splineFDBase.h:100</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_aad64c7c63db8ea676f86eb2279f04d40"><div class="ttname"><a href="classsplineFDBase.html#aad64c7c63db8ea676f86eb2279f04d40">splineFDBase::nSplineParams</a></div><div class="ttdeci">std::vector&lt; int &gt; nSplineParams</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00085">splineFDBase.h:85</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_ac9bcc5253804c4a5ad8e2990490ecfab"><div class="ttname"><a href="classsplineFDBase.html#ac9bcc5253804c4a5ad8e2990490ecfab">splineFDBase::BuildSampleIndexingArray</a></div><div class="ttdeci">void BuildSampleIndexingArray(const std::string &amp;SampleName)</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8cpp_source.html#l00330">splineFDBase.cpp:330</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_addabdf30ee85c6975422c0ccf3f1844f"><div class="ttname"><a href="classsplineFDBase.html#addabdf30ee85c6975422c0ccf3f1844f">splineFDBase::FillSampleArray</a></div><div class="ttdeci">virtual void FillSampleArray(std::string SampleName, std::vector&lt; std::string &gt; OscChanFileNames)=0</div></div>
<div class="ttc" id="aclasssplineFDBase_html_af036372a158b4e463683a8d02a20ec3d"><div class="ttname"><a href="classsplineFDBase.html#af036372a158b4e463683a8d02a20ec3d">splineFDBase::GlobalSystIndex</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int &gt; &gt; GlobalSystIndex</div><div class="ttdoc">This holds the global spline index and is used to grab the current parameter value to evaluate spline...</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00097">splineFDBase.h:97</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_af45c2bd4fbeb4dedabdedd991a25fb1e"><div class="ttname"><a href="classsplineFDBase.html#af45c2bd4fbeb4dedabdedd991a25fb1e">splineFDBase::PrintSampleDetails</a></div><div class="ttdeci">void PrintSampleDetails(const std::string &amp;SampleName)</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8cpp_source.html#l00780">splineFDBase.cpp:780</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_af71b65713518f42e59c543dbad5dab70"><div class="ttname"><a href="classsplineFDBase.html#af71b65713518f42e59c543dbad5dab70">splineFDBase::SplineBinning</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; TAxis * &gt; &gt; &gt; SplineBinning</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00088">splineFDBase.h:88</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac9bcc5253804c4a5ad8e2990490ecfab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9bcc5253804c4a5ad8e2990490ecfab">&#9670;&nbsp;</a></span>BuildSampleIndexingArray()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void splineFDBase::BuildSampleIndexingArray </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>SampleName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8cpp_source.html#l00330">330</a> of file <a class="el" href="splineFDBase_8cpp_source.html">splineFDBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;{  </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordtype">int</span> iSample = <a class="code" href="classsplineFDBase.html#a5de6441e53ffe4e7e126a222ac8d712a">getSampleIndex</a>(SampleName);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="keywordtype">int</span> nSplineSysts = <a class="code" href="classsplineFDBase.html#aad64c7c63db8ea676f86eb2279f04d40">nSplineParams</a>[iSample];</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keywordtype">int</span> nOscChannels = <a class="code" href="classsplineFDBase.html#aa10670a64bbdef3ffd69f4b8f102fff3">nOscChans</a>[iSample];</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  std::vector&lt;std::vector&lt;std::vector&lt;std::vector&lt;std::vector&lt;std::vector&lt;int&gt;&gt;&gt;&gt;&gt;&gt; indexvec_OscChan;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iOscChan = 0; iOscChan &lt; nOscChannels; iOscChan++)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  { <span class="comment">// Loop over oscillation channels</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    std::vector&lt;std::vector&lt;std::vector&lt;std::vector&lt;std::vector&lt;int &gt;&gt;&gt;&gt;&gt; indexvec_Syst;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iSyst = 0; iSyst &lt; nSplineSysts; iSyst++)</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    { <span class="comment">// Loop over systematics</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      std::vector&lt;std::vector&lt;std::vector&lt;std::vector&lt;int &gt;&gt;&gt;&gt; indexvec_Mode;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="keywordtype">int</span> nModesInSyst = int(<a class="code" href="classsplineFDBase.html#a6b7aeec6d03dad01975582226b39632b">SplineModeVecs</a>[iSample][iSyst].<a class="code" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>());</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iMode = 0; iMode &lt; nModesInSyst; iMode++)</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      { <span class="comment">// Loop over modes</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        std::vector&lt;std::vector&lt;std::vector&lt;int &gt;&gt;&gt; indexvec_Var1;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iVar1 = 0; iVar1 &lt; (<a class="code" href="classsplineFDBase.html#af71b65713518f42e59c543dbad5dab70">SplineBinning</a>[iSample][iOscChan][0])-&gt;GetNbins(); iVar1++)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        { <span class="comment">// Loop over first dimension</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;          std::vector&lt;std::vector&lt;int &gt;&gt; indexvec_Var2;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iVar2 = 0; iVar2 &lt; (<a class="code" href="classsplineFDBase.html#af71b65713518f42e59c543dbad5dab70">SplineBinning</a>[iSample][iOscChan][1])-&gt;GetNbins(); iVar2++)</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;          { <span class="comment">// Loop over second dimension</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            std::vector&lt;int&gt; indexvec_Var3;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iVar3 = 0; iVar3 &lt; (<a class="code" href="classsplineFDBase.html#af71b65713518f42e59c543dbad5dab70">SplineBinning</a>[iSample][iOscChan][2])-&gt;GetNbins(); iVar3++)</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            { <span class="comment">// Loop over third dimension</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;              indexvec_Var3.push_back(0); <span class="comment">//Don&#39;t start counting yet!</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            } <span class="comment">// end iVar3 loop</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            indexvec_Var2.push_back(indexvec_Var3);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;          } <span class="comment">// end iVar2 loop</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;          indexvec_Var1.push_back(indexvec_Var2);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        } <span class="comment">// end iVar1 loop</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        indexvec_Mode.push_back(indexvec_Var1);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      } <span class="comment">// end of iMode loop</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      indexvec_Syst.push_back(indexvec_Mode);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    } <span class="comment">// end of iOscChan loop</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    indexvec_OscChan.push_back(indexvec_Syst);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  } <span class="comment">// end of iSyst loop</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>.push_back(indexvec_OscChan);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;}</div>
<div class="ttc" id="aGetPenaltyTerm_8cpp_html_a439227feff9d7f55384e8780cfc2eb82"><div class="ttname"><a href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a></div><div class="ttdeci">int size</div><div class="ttdef"><b>Definition:</b> <a href="GetPenaltyTerm_8cpp_source.html#l00037">GetPenaltyTerm.cpp:37</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_a5de6441e53ffe4e7e126a222ac8d712a"><div class="ttname"><a href="classsplineFDBase.html#a5de6441e53ffe4e7e126a222ac8d712a">splineFDBase::getSampleIndex</a></div><div class="ttdeci">int getSampleIndex(const std::string &amp;SampleName)</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8cpp_source.html#l00762">splineFDBase.cpp:762</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_ab3a4e79bfe675a4070597557e6226e12"><div class="ttname"><a href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">splineFDBase::indexvec</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; std::vector&lt; std::vector&lt; std::vector&lt; std::vector&lt; int &gt; &gt; &gt; &gt; &gt; &gt; &gt; indexvec</div><div class="ttdoc">Variables related to determined which modes have splines and which piggy-back of other modes.</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00110">splineFDBase.h:110</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9eceab58c0aa06b58eb4e3708c00ee0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9eceab58c0aa06b58eb4e3708c00ee0e">&#9670;&nbsp;</a></span>CalcSplineWeights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void splineFDBase::CalcSplineWeights </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CPU based code which eval weight for each spline. </p>

<p>Implements <a class="el" href="classSplineBase.html#a1ceacf5fee1fc8438501582bef93a9b5">SplineBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="splineFDBase_8cpp_source.html#l00291">291</a> of file <a class="el" href="splineFDBase_8cpp_source.html">splineFDBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;{</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="preprocessor">  #pragma omp parallel for simd</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iCoeff = 0; iCoeff &lt; <a class="code" href="classsplineFDBase.html#a7a564f5748f16d97ebf1e1c300a1cc5c">uniquecoeffindices</a>.size(); ++iCoeff)</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> iSpline = <a class="code" href="classsplineFDBase.html#a7a564f5748f16d97ebf1e1c300a1cc5c">uniquecoeffindices</a>[iCoeff];</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> uniqueIndex = short(<a class="code" href="classsplineFDBase.html#ae237cc1c6d97e35bf4f7f64e369a5781">uniquesplinevec_Monolith</a>[iSpline]);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> currentsegment = short(<a class="code" href="classsplineFDBase.html#aa36e6889d054ad0f86f33a53dd3fe036">UniqueSystCurrSegment</a>[uniqueIndex]);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> segCoeff = <a class="code" href="classsplineFDBase.html#af63885ddb6731f77808d029372e6b187">coeffindexvec</a>[iSpline]+currentsegment;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> coeffOffset = segCoeff * 4;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">// These are what we can extract from the TSpline3</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> x = <a class="code" href="classsplineFDBase.html#a00f046c4c64c0aa11334b32b0701a9f1">xcoeff_arr</a>[segCoeff];</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> y = <a class="code" href="classsplineFDBase.html#ab883a1f2cdae707c36fa27b86ed7f279">manycoeff_arr</a>[coeffOffset+<a class="code" href="SplineCommon_8h.html#aac6312c7a4c683e6d016d9fccdc7d7c0a9e87d802f64d8929291c58eeb0eb16e6">kCoeffY</a>];</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> b = <a class="code" href="classsplineFDBase.html#ab883a1f2cdae707c36fa27b86ed7f279">manycoeff_arr</a>[coeffOffset+<a class="code" href="SplineCommon_8h.html#aac6312c7a4c683e6d016d9fccdc7d7c0a546352c58e328d9b57692a033eee8a42">kCoeffB</a>];</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> c = <a class="code" href="classsplineFDBase.html#ab883a1f2cdae707c36fa27b86ed7f279">manycoeff_arr</a>[coeffOffset+<a class="code" href="SplineCommon_8h.html#aac6312c7a4c683e6d016d9fccdc7d7c0af73b429597449e82d2920f69d03cef36">kCoeffC</a>];</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> d = <a class="code" href="classsplineFDBase.html#ab883a1f2cdae707c36fa27b86ed7f279">manycoeff_arr</a>[coeffOffset+<a class="code" href="SplineCommon_8h.html#aac6312c7a4c683e6d016d9fccdc7d7c0a82b4ea363cc5a4b0429efcc46582769d">kCoeffD</a>];</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">// Get the variation for this reconfigure for the ith parameter</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> xvar = <a class="code" href="classsplineFDBase.html#a324c4b50910454092ba45d945ef57bda">xVarArray</a>[uniqueIndex];</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">// The Delta(x)</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> dx = xvar - x;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="comment">//Speedy 1% time boost https://en.cppreference.com/w/c/numeric/math/fma (see ND code!)</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> weight = <a class="code" href="namespaceM3.html#ad501f876b26ca2cef7bb5f434deaffb8">M3::fmaf_t</a>(dx, <a class="code" href="namespaceM3.html#ad501f876b26ca2cef7bb5f434deaffb8">M3::fmaf_t</a>(dx, <a class="code" href="namespaceM3.html#ad501f876b26ca2cef7bb5f434deaffb8">M3::fmaf_t</a>(dx, d, c), b), y);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">//This is the speedy version of writing dx^3+b*dx^2+c*dx+d</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">//ETA - do we need this? We check later for negative weights and I wonder if this is even</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">//possible with the fmaf line above?</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">if</span>(weight &lt; 0){weight = 0.;}  <span class="comment">//Stops is getting negative weights</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <a class="code" href="classsplineFDBase.html#a107c337ce7053208795747a3223f04e1">weightvec_Monolith</a>[iSpline] = weight;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;}</div>
<div class="ttc" id="aSplineCommon_8h_html_aac6312c7a4c683e6d016d9fccdc7d7c0a546352c58e328d9b57692a033eee8a42"><div class="ttname"><a href="SplineCommon_8h.html#aac6312c7a4c683e6d016d9fccdc7d7c0a546352c58e328d9b57692a033eee8a42">kCoeffB</a></div><div class="ttdeci">@ kCoeffB</div><div class="ttdoc">Coefficient B.</div><div class="ttdef"><b>Definition:</b> <a href="SplineCommon_8h_source.html#l00025">SplineCommon.h:25</a></div></div>
<div class="ttc" id="aSplineCommon_8h_html_aac6312c7a4c683e6d016d9fccdc7d7c0a82b4ea363cc5a4b0429efcc46582769d"><div class="ttname"><a href="SplineCommon_8h.html#aac6312c7a4c683e6d016d9fccdc7d7c0a82b4ea363cc5a4b0429efcc46582769d">kCoeffD</a></div><div class="ttdeci">@ kCoeffD</div><div class="ttdoc">Coefficient D.</div><div class="ttdef"><b>Definition:</b> <a href="SplineCommon_8h_source.html#l00028">SplineCommon.h:27</a></div></div>
<div class="ttc" id="aSplineCommon_8h_html_aac6312c7a4c683e6d016d9fccdc7d7c0a9e87d802f64d8929291c58eeb0eb16e6"><div class="ttname"><a href="SplineCommon_8h.html#aac6312c7a4c683e6d016d9fccdc7d7c0a9e87d802f64d8929291c58eeb0eb16e6">kCoeffY</a></div><div class="ttdeci">@ kCoeffY</div><div class="ttdoc">Coefficient Y.</div><div class="ttdef"><b>Definition:</b> <a href="SplineCommon_8h_source.html#l00024">SplineCommon.h:24</a></div></div>
<div class="ttc" id="aSplineCommon_8h_html_aac6312c7a4c683e6d016d9fccdc7d7c0af73b429597449e82d2920f69d03cef36"><div class="ttname"><a href="SplineCommon_8h.html#aac6312c7a4c683e6d016d9fccdc7d7c0af73b429597449e82d2920f69d03cef36">kCoeffC</a></div><div class="ttdeci">@ kCoeffC</div><div class="ttdoc">Coefficient C.</div><div class="ttdef"><b>Definition:</b> <a href="SplineCommon_8h_source.html#l00026">SplineCommon.h:26</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_a107c337ce7053208795747a3223f04e1"><div class="ttname"><a href="classsplineFDBase.html#a107c337ce7053208795747a3223f04e1">splineFDBase::weightvec_Monolith</a></div><div class="ttdeci">std::vector&lt; M3::float_t &gt; weightvec_Monolith</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00129">splineFDBase.h:129</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_a324c4b50910454092ba45d945ef57bda"><div class="ttname"><a href="classsplineFDBase.html#a324c4b50910454092ba45d945ef57bda">splineFDBase::xVarArray</a></div><div class="ttdeci">M3::float_t * xVarArray</div><div class="ttdoc">Probably need to clear these arrays up at some point.</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00121">splineFDBase.h:121</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_a7a564f5748f16d97ebf1e1c300a1cc5c"><div class="ttname"><a href="classsplineFDBase.html#a7a564f5748f16d97ebf1e1c300a1cc5c">splineFDBase::uniquecoeffindices</a></div><div class="ttdeci">std::vector&lt; int &gt; uniquecoeffindices</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00112">splineFDBase.h:112</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_aa36e6889d054ad0f86f33a53dd3fe036"><div class="ttname"><a href="classsplineFDBase.html#aa36e6889d054ad0f86f33a53dd3fe036">splineFDBase::UniqueSystCurrSegment</a></div><div class="ttdeci">std::vector&lt; int &gt; UniqueSystCurrSegment</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00106">splineFDBase.h:106</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_ae237cc1c6d97e35bf4f7f64e369a5781"><div class="ttname"><a href="classsplineFDBase.html#ae237cc1c6d97e35bf4f7f64e369a5781">splineFDBase::uniquesplinevec_Monolith</a></div><div class="ttdeci">std::vector&lt; int &gt; uniquesplinevec_Monolith</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00130">splineFDBase.h:130</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_af63885ddb6731f77808d029372e6b187"><div class="ttname"><a href="classsplineFDBase.html#af63885ddb6731f77808d029372e6b187">splineFDBase::coeffindexvec</a></div><div class="ttdeci">std::vector&lt; int &gt; coeffindexvec</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00111">splineFDBase.h:111</a></div></div>
<div class="ttc" id="anamespaceM3_html_a1f95274549f25fc19fe7db343c8a7a68"><div class="ttname"><a href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a></div><div class="ttdeci">double float_t</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00026">Core.h:26</a></div></div>
<div class="ttc" id="anamespaceM3_html_ad501f876b26ca2cef7bb5f434deaffb8"><div class="ttname"><a href="namespaceM3.html#ad501f876b26ca2cef7bb5f434deaffb8">M3::fmaf_t</a></div><div class="ttdeci">constexpr T fmaf_t(T x, T y, T z)</div><div class="ttdoc">Function template for fused multiply-add.</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00033">Core.h:33</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6e765571776f8affeca355a184fef11a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e765571776f8affeca355a184fef11a">&#9670;&nbsp;</a></span>cleanUpMemory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void splineFDBase::cleanUpMemory </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove setup variables not needed for spline evaluations. </p>

<p class="definition">Definition at line <a class="el" href="splineFDBase_8cpp_source.html#l00029">29</a> of file <a class="el" href="splineFDBase_8cpp_source.html">splineFDBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;                                 {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">//****************************************</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="comment">//Call once everything&#39;s been allocated in samplePDFSKBase, cleans up junk from memory!</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="comment">//Not a huge saving but it&#39;s better than leaving everything up to the compiler</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Cleaning up spline memory&quot;</span>);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <a class="code" href="Structs_8h.html#a85aef80dc0fb38ccb4ff2f7b6a49a5ab">CleanVector</a>(<a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <a class="code" href="Structs_8h.html#a85aef80dc0fb38ccb4ff2f7b6a49a5ab">CleanVector</a>(<a class="code" href="classsplineFDBase.html#a5619363447e607cd835c46d601b10675">SplineFileParPrefixNames</a>);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <a class="code" href="Structs_8h.html#a85aef80dc0fb38ccb4ff2f7b6a49a5ab">CleanVector</a>(<a class="code" href="classsplineFDBase.html#af036372a158b4e463683a8d02a20ec3d">GlobalSystIndex</a>);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <a class="code" href="Structs_8h.html#a85aef80dc0fb38ccb4ff2f7b6a49a5ab">CleanVector</a>(<a class="code" href="classsplineFDBase.html#a6b7aeec6d03dad01975582226b39632b">SplineModeVecs</a>);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <a class="code" href="Structs_8h.html#a85aef80dc0fb38ccb4ff2f7b6a49a5ab">CleanVector</a>(<a class="code" href="classsplineFDBase.html#aacf850f4ec22e4f7338f243999ecc7dd">UniqueSystNames</a>);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="Structs_8h.html#a85aef80dc0fb38ccb4ff2f7b6a49a5ab">CleanVector</a>(<a class="code" href="classsplineFDBase.html#aabc74a6dd8b13fc6925e975bf5f92cff">SplineInterpolationTypes</a>);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; Binning2D : <a class="code" href="classsplineFDBase.html#af71b65713518f42e59c543dbad5dab70">SplineBinning</a>) {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; Binning1D : Binning2D) {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="keywordflow">for</span> (TAxis* axis : Binning1D) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keyword">delete</span> axis;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      }</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      Binning1D.clear();</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      Binning1D.shrink_to_fit();</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    }</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    Binning2D.clear();</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    Binning2D.shrink_to_fit();</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <a class="code" href="classsplineFDBase.html#af71b65713518f42e59c543dbad5dab70">SplineBinning</a>.clear();</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <a class="code" href="classsplineFDBase.html#af71b65713518f42e59c543dbad5dab70">SplineBinning</a>.shrink_to_fit();</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="comment">//Really make sure all the memory is cleared</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">for</span>(<span class="keyword">auto</span> Spline : <a class="code" href="classsplineFDBase.html#a84ec9ea208503053b9735b1cb1bc417d">splinevec_Monolith</a>){</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">if</span>(Spline){<span class="keyword">delete</span> Spline;}</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <a class="code" href="classsplineFDBase.html#a84ec9ea208503053b9735b1cb1bc417d">splinevec_Monolith</a>.clear();</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <a class="code" href="classsplineFDBase.html#a84ec9ea208503053b9735b1cb1bc417d">splinevec_Monolith</a>.shrink_to_fit();</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classsplineFDBase.html#aa8a204355df78af3f79bf8f2815258d3">isflatarray</a> != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code" href="classsplineFDBase.html#aa8a204355df78af3f79bf8f2815258d3">isflatarray</a>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;}</div>
<div class="ttc" id="aStructs_8h_html_a85aef80dc0fb38ccb4ff2f7b6a49a5ab"><div class="ttname"><a href="Structs_8h.html#a85aef80dc0fb38ccb4ff2f7b6a49a5ab">CleanVector</a></div><div class="ttdeci">void CleanVector(std::vector&lt; T &gt; &amp;vec)</div><div class="ttdoc">Generic cleanup function.</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00044">Structs.h:44</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_a84ec9ea208503053b9735b1cb1bc417d"><div class="ttname"><a href="classsplineFDBase.html#a84ec9ea208503053b9735b1cb1bc417d">splineFDBase::splinevec_Monolith</a></div><div class="ttdeci">std::vector&lt; TSpline3_red * &gt; splinevec_Monolith</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00114">splineFDBase.h:114</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_aa8a204355df78af3f79bf8f2815258d3"><div class="ttname"><a href="classsplineFDBase.html#aa8a204355df78af3f79bf8f2815258d3">splineFDBase::isflatarray</a></div><div class="ttdeci">bool * isflatarray</div><div class="ttdoc">Need to keep track of which splines are flat and which aren't.</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00123">splineFDBase.h:123</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_aacf850f4ec22e4f7338f243999ecc7dd"><div class="ttname"><a href="classsplineFDBase.html#aacf850f4ec22e4f7338f243999ecc7dd">splineFDBase::UniqueSystNames</a></div><div class="ttdeci">std::vector&lt; std::string &gt; UniqueSystNames</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00103">splineFDBase.h:103</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0bfc616fab953333e6e938de52ce3bed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bfc616fab953333e6e938de52ce3bed">&#9670;&nbsp;</a></span>CountNumberOfLoadedSplines()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int splineFDBase::CountNumberOfLoadedSplines </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>NonFlat</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Verbosity</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8cpp_source.html#l00488">488</a> of file <a class="el" href="splineFDBase_8cpp_source.html">splineFDBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;{</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="keywordtype">int</span> SampleCounter_NonFlat = 0;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordtype">int</span> SampleCounter_All = 0;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keywordtype">int</span> FullCounter_NonFlat = 0;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="keywordtype">int</span> FullCounter_All = 0;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iSample = 0; iSample &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>.size(); iSample++)</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  { <span class="comment">// Loop over systematics</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    SampleCounter_NonFlat = 0;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    SampleCounter_All = 0;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    std::string SampleName = <a class="code" href="classsplineFDBase.html#a78508c5d0d4ef09457beb723dc796208">SampleNames</a>[iSample];</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iOscChan = 0; iOscChan &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample].size(); iOscChan++)</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    { <span class="comment">// Loop over oscillation channels</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iSyst = 0; iSyst &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan].size(); iSyst++)</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      { <span class="comment">// Loop over systematics</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iMode = 0; iMode &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst].size(); iMode++)</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        { <span class="comment">// Loop over modes</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iVar1 = 0; iVar1 &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst][iMode].size(); iVar1++)</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;          { <span class="comment">// Loop over first dimension</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iVar2 = 0; iVar2 &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst][iMode][iVar1].size(); iVar2++)</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            { <span class="comment">// Loop over second dimension</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iVar3 = 0; iVar3 &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst][iMode][iVar1][iVar2].size(); iVar3++)</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;              { <span class="comment">// Loop over third dimension</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classsplineFDBase.html#a2b026cd74035f56db3790f1eea49de92">isValidSplineIndex</a>(SampleName, iOscChan, iSyst, iMode, iVar1, iVar2, iVar3))</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                  <span class="keywordtype">int</span> splineindex = <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst][iMode][iVar1][iVar2][iVar3];</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="classsplineFDBase.html#a84ec9ea208503053b9735b1cb1bc417d">splinevec_Monolith</a>[splineindex])</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                  {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                    SampleCounter_NonFlat += 1;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                  }</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                  SampleCounter_All += 1;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;              }</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            }</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;          }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        }</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    }</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a>(<span class="stringliteral">&quot;{:&lt;10} has {:&lt;10} splines, of which {:&lt;10} are not flat&quot;</span>, <a class="code" href="classsplineFDBase.html#a78508c5d0d4ef09457beb723dc796208">SampleNames</a>[iSample], SampleCounter_All, SampleCounter_NonFlat);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    FullCounter_NonFlat += SampleCounter_NonFlat;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    FullCounter_All += SampleCounter_All;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  }</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keywordflow">if</span> (Verbosity &gt; 0)</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  {</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Total number of splines loaded: {}&quot;</span>, FullCounter_All);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Total number of non-flat splines loaded: {}&quot;</span>, FullCounter_NonFlat);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="keywordflow">if</span> (NonFlat)</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordflow">return</span> FullCounter_NonFlat;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  }</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordflow">return</span> FullCounter_All;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a4db4657acad5c79ac4bbb66a9d1c5905"><div class="ttname"><a href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a></div><div class="ttdeci">#define MACH3LOG_DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00022">MaCh3Logger.h:22</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_a2b026cd74035f56db3790f1eea49de92"><div class="ttname"><a href="classsplineFDBase.html#a2b026cd74035f56db3790f1eea49de92">splineFDBase::isValidSplineIndex</a></div><div class="ttdeci">bool isValidSplineIndex(const std::string &amp;SampleName, int iSyst, int iOscChan, int iMode, int iVar1, int iVar2, int iVar3)</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8cpp_source.html#l00819">splineFDBase.cpp:819</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af6e248be25f753c85c4fbf2f3b72cf88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6e248be25f753c85c4fbf2f3b72cf88">&#9670;&nbsp;</a></span>Evaluate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void splineFDBase::Evaluate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CW: This Eval should be used when using two separate x,{y,a,b,c,d} arrays to store the weights; probably the best one here! Same thing but pass parameter spline segments instead of variations. </p>

<p>Implements <a class="el" href="classSplineBase.html#a86e629f3eef59b2f3800136c86fe90c3">SplineBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="splineFDBase_8cpp_source.html#l00220">220</a> of file <a class="el" href="splineFDBase_8cpp_source.html">splineFDBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                            {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">// *****************************************</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="comment">// There&#39;s a parameter mapping that goes from spline parameter to a global parameter index</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="comment">// Find the spline segments</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <a class="code" href="classsplineFDBase.html#ab4a852337aab961abbcaa0c9f70c88ba">FindSplineSegment</a>();</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="comment">//KS: Huge MP loop over all valid splines</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <a class="code" href="classsplineFDBase.html#a9eceab58c0aa06b58eb4e3708c00ee0e">CalcSplineWeights</a>();</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">//KS: Huge MP loop over all events calculating total weight</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <a class="code" href="classsplineFDBase.html#a1a237a8b8c3c165c82ebe15d2ca740c7">ModifyWeights</a>();</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;}</div>
<div class="ttc" id="aclasssplineFDBase_html_a1a237a8b8c3c165c82ebe15d2ca740c7"><div class="ttname"><a href="classsplineFDBase.html#a1a237a8b8c3c165c82ebe15d2ca740c7">splineFDBase::ModifyWeights</a></div><div class="ttdeci">void ModifyWeights() override</div><div class="ttdoc">Calc total event weight, not used by Bin-by-bin splines.</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00076">splineFDBase.h:76</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_a9eceab58c0aa06b58eb4e3708c00ee0e"><div class="ttname"><a href="classsplineFDBase.html#a9eceab58c0aa06b58eb4e3708c00ee0e">splineFDBase::CalcSplineWeights</a></div><div class="ttdeci">void CalcSplineWeights() override</div><div class="ttdoc">CPU based code which eval weight for each spline.</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8cpp_source.html#l00291">splineFDBase.cpp:291</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_ab4a852337aab961abbcaa0c9f70c88ba"><div class="ttname"><a href="classsplineFDBase.html#ab4a852337aab961abbcaa0c9f70c88ba">splineFDBase::FindSplineSegment</a></div><div class="ttdeci">void FindSplineSegment() override</div><div class="ttdoc">CW:Code used in step by step reweighting, Find Spline Segment for each param.</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8cpp_source.html#l00237">splineFDBase.cpp:237</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="addabdf30ee85c6975422c0ccf3f1844f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addabdf30ee85c6975422c0ccf3f1844f">&#9670;&nbsp;</a></span>FillSampleArray()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void splineFDBase::FillSampleArray </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>SampleName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>OscChanFileNames</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a00c0e93b4c4799ffacaa58578e5dcf6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00c0e93b4c4799ffacaa58578e5dcf6b">&#9670;&nbsp;</a></span>FindSplineBinning()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; TAxis * &gt; splineFDBase::FindSplineBinning </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>FileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>SampleName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8cpp_source.html#l00373">373</a> of file <a class="el" href="splineFDBase_8cpp_source.html">splineFDBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;{</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  std::vector&lt;TAxis *&gt; ReturnVec;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keywordtype">int</span> iSample=<a class="code" href="classsplineFDBase.html#a5de6441e53ffe4e7e126a222ac8d712a">getSampleIndex</a>(SampleName);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="comment">//Try declaring these outside of TFile so they aren&#39;t owned by File</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordtype">int</span> nDummyBins = 1;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keywordtype">double</span> DummyEdges[2];</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  DummyEdges[0] = -1e15;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  DummyEdges[1] = 1e15;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  TAxis* DummyAxis = <span class="keyword">new</span> TAxis(nDummyBins, DummyEdges);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  TH2F* Hist2D = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  TH3F* Hist3D = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keyword">auto</span> File = std::unique_ptr&lt;TFile&gt;(TFile::Open(FileName.c_str(), <span class="stringliteral">&quot;READ&quot;</span>));</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="keywordflow">if</span> (!File || File-&gt;IsZombie())</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;File {} not found&quot;</span>, FileName);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;This is caused by something here! {} : {}&quot;</span>, __FILE__, __LINE__);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Finding binning for:&quot;</span>);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{}&quot;</span>, FileName);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="keywordtype">bool</span> isHist2D = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="keywordtype">bool</span> isHist3D = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  std::string TemplateName = <span class="stringliteral">&quot;dev_tmp_0_0&quot;</span>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  TObject *Obj = File-&gt;Get(TemplateName.c_str());</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="comment">//If you can&#39;t find dev_tmp_0_0 then this will cause a problem</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordflow">if</span> (!Obj)</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    TemplateName = <span class="stringliteral">&quot;dev_tmp.0.0&quot;</span>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    Obj = File-&gt;Get(TemplateName.c_str());</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">if</span> (!Obj)</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Error: could not find dev_tmp_0_0 in spline file. Spline binning cannot be set!&quot;</span>);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;FileName: {}&quot;</span>, FileName);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    }</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="comment">//Now check if dev_tmp_0_0 is a TH2 i.e. specifying the dimensions of the splines is 2D</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordflow">if</span> (Obj-&gt;IsA() == TH2F::Class())</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    isHist2D = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="comment">//For T2K annoyingly all objects are TH3Fs</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keywordflow">if</span> (Obj-&gt;IsA() == TH3F::Class())</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    isHist3D = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  }</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="keywordflow">if</span> (!isHist2D &amp;&amp; !isHist3D)</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Object doesn&#39;t inherit from either TH2D and TH3D - Odd A&quot;</span>);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="keywordflow">if</span> (isHist2D)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classsplineFDBase.html#a6c28400605049bdee229885c46463dcd">Dimensions</a>[iSample] != 2)</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Trying to load a 2D spline template when nDim={}&quot;</span>, <a class="code" href="classsplineFDBase.html#a6c28400605049bdee229885c46463dcd">Dimensions</a>[iSample]);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="comment">//Hist2D = std::unique_ptr&lt;TH2F&gt;(File-&gt;Get&lt;TH2F&gt;(&quot;dev_tmp_0_0&quot;));</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    Hist2D = File-&gt;Get&lt;TH2F&gt;(TemplateName.c_str());</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="keywordflow">if</span> (isHist3D)</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    Hist3D = File-&gt;Get&lt;TH3F&gt;((TemplateName.c_str()));</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classsplineFDBase.html#a6c28400605049bdee229885c46463dcd">Dimensions</a>[iSample] != 3 &amp;&amp; Hist3D-&gt;GetZaxis()-&gt;GetNbins() != 1)</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Trying to load a 3D spline template when nDim={}&quot;</span>, <a class="code" href="classsplineFDBase.html#a6c28400605049bdee229885c46463dcd">Dimensions</a>[iSample]);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    Hist3D = File-&gt;Get&lt;TH3F&gt;(TemplateName.c_str());</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classsplineFDBase.html#a6c28400605049bdee229885c46463dcd">Dimensions</a>[iSample] == 2) {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">if</span>(isHist2D){</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      ReturnVec.push_back(<span class="keyword">static_cast&lt;</span>TAxis*<span class="keyword">&gt;</span>(Hist2D-&gt;GetXaxis()-&gt;Clone()));</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      ReturnVec.push_back(<span class="keyword">static_cast&lt;</span>TAxis*<span class="keyword">&gt;</span>(Hist2D-&gt;GetYaxis()-&gt;Clone()));</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      ReturnVec.push_back(<span class="keyword">static_cast&lt;</span>TAxis*<span class="keyword">&gt;</span>(DummyAxis-&gt;Clone()));</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isHist3D) {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      ReturnVec.push_back(<span class="keyword">static_cast&lt;</span>TAxis*<span class="keyword">&gt;</span>(Hist3D-&gt;GetXaxis()-&gt;Clone()));</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      ReturnVec.push_back(<span class="keyword">static_cast&lt;</span>TAxis*<span class="keyword">&gt;</span>(Hist3D-&gt;GetYaxis()-&gt;Clone()));</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      ReturnVec.push_back(<span class="keyword">static_cast&lt;</span>TAxis*<span class="keyword">&gt;</span>(DummyAxis-&gt;Clone()));</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    }</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classsplineFDBase.html#a6c28400605049bdee229885c46463dcd">Dimensions</a>[iSample] == 3) {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    ReturnVec.push_back(<span class="keyword">static_cast&lt;</span>TAxis*<span class="keyword">&gt;</span>(Hist3D-&gt;GetXaxis()-&gt;Clone()));</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    ReturnVec.push_back(<span class="keyword">static_cast&lt;</span>TAxis*<span class="keyword">&gt;</span>(Hist3D-&gt;GetYaxis()-&gt;Clone()));</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    ReturnVec.push_back(<span class="keyword">static_cast&lt;</span>TAxis*<span class="keyword">&gt;</span>(Hist3D-&gt;GetZaxis()-&gt;Clone()));</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Number of dimensions not valid! Given: {}&quot;</span>, <a class="code" href="classsplineFDBase.html#a6c28400605049bdee229885c46463dcd">Dimensions</a>[iSample]);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iAxis = 0; iAxis &lt; ReturnVec.size(); ++iAxis) {</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <a class="code" href="classsplineFDBase.html#a7f5b16b65dc7da748f20bdc803b7e593">PrintBinning</a>(ReturnVec[iAxis]);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Left PrintBinning now tidying up&quot;</span>);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="keyword">delete</span> DummyAxis;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="keywordflow">return</span> ReturnVec;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;}</div>
<div class="ttc" id="aclasssplineFDBase_html_a7f5b16b65dc7da748f20bdc803b7e593"><div class="ttname"><a href="classsplineFDBase.html#a7f5b16b65dc7da748f20bdc803b7e593">splineFDBase::PrintBinning</a></div><div class="ttdeci">void PrintBinning(TAxis *Axis)</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8cpp_source.html#l00884">splineFDBase.cpp:884</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab4a852337aab961abbcaa0c9f70c88ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4a852337aab961abbcaa0c9f70c88ba">&#9670;&nbsp;</a></span>FindSplineSegment()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void splineFDBase::FindSplineSegment </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CW:Code used in step by step reweighting, Find Spline Segment for each param. </p>

<p>Implements <a class="el" href="classSplineBase.html#ae18e490295762416c8627d2db11ee98d">SplineBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="splineFDBase_8cpp_source.html#l00237">237</a> of file <a class="el" href="splineFDBase_8cpp_source.html">splineFDBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                                     {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">//****************************************</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="comment">//HW okay let&#39;s try this, we delete+refill a new array which we&#39;ll fill with x-s for our segment</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iSyst = 0; iSyst &lt; <a class="code" href="classsplineFDBase.html#a0d42cbfc22f21906264af285fd57b1af">nUniqueSysts</a>; ++iSyst) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nPoints = <a class="code" href="classsplineFDBase.html#a176d42bb137d3c8c3771eb1a4a8440c8">UniqueSystNKnots</a>[iSyst];</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">// KS: By reference to not copy memory like a fool</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keyword">const</span> std::vector&lt;M3::float_t&gt;&amp; xArray = <a class="code" href="classsplineFDBase.html#a5112a1bbd658d3a90c6a785c12aebf34">UniqueSystXPts</a>[iSyst];</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">// Get the variation for this reconfigure for the ith parameter</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> GlobalIndex = <a class="code" href="classsplineFDBase.html#a3b821b95c2db6063a9baa244b28aeaa6">UniqueSystIndices</a>[iSyst];</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> xvar = <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>(<a class="code" href="classsplineFDBase.html#a891de87b873e079f6bbdb1355a9ff153">xsec</a>-&gt;<a class="code" href="classcovarianceBase.html#af298d9a2d624b02c4953e735d870fcf5">getParProp</a>(GlobalIndex));</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="classsplineFDBase.html#a324c4b50910454092ba45d945ef57bda">xVarArray</a>[iSyst] = xvar;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a> segment = 0;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a> kHigh = <a class="code" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a>(nPoints - 1);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">//KS: We expect new segment is very close to previous</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a> PreviousSegment = <a class="code" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a>(<a class="code" href="classsplineFDBase.html#aa36e6889d054ad0f86f33a53dd3fe036">UniqueSystCurrSegment</a>[iSyst]);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">//KS: It is quite probable the new segment is same as in previous step so try to avoid binary search</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">if</span>( xArray[PreviousSegment+1] &gt; xvar &amp;&amp; xvar &gt;= xArray[PreviousSegment] ) {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      segment = PreviousSegment;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (xvar &lt;= xArray[0]) {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">// If the variation is below the lowest saved spline point</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      segment = 0;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <span class="comment">// If the variation is above the highest saved spline point</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (xvar &gt;= xArray[nPoints-1]) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="comment">//CW: Yes, the -2 is indeed correct, see TSpline.cxx:814 and //see: https://savannah.cern.ch/bugs/?71651</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      segment = kHigh;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <span class="comment">//KS: It is quite probable the new segment is same as in previous step so try to avoid binary search</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="comment">// The top point we&#39;ve got</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <a class="code" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a> kHalf = 0;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="comment">// While there is still a difference in the points (we haven&#39;t yet found the segment)</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="comment">// This is a binary search, incrementing segment and decrementing kHalf until we&#39;ve found the segment</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <span class="keywordflow">while</span> (kHigh - segment &gt; 1) {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="comment">// Increment the half-step</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        kHalf = <a class="code" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a>((segment + kHigh)/2);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="comment">// If our variation is above the kHalf, set the segment to kHalf</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keywordflow">if</span> (xvar &gt; xArray[kHalf]) {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;          segment = kHalf;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;          <span class="comment">// Else move kHigh down</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;          kHigh = kHalf;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      } <span class="comment">// End the while: we&#39;ve now done our binary search</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    } <span class="comment">// End the else: we&#39;ve now found our point</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">if</span> (segment &gt;= nPoints-1 &amp;&amp; nPoints &gt; 1){segment = <a class="code" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a>(nPoints-2);}</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="classsplineFDBase.html#aa36e6889d054ad0f86f33a53dd3fe036">UniqueSystCurrSegment</a>[iSyst] = segment; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  } <span class="comment">//end loop over params</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;}</div>
<div class="ttc" id="aclasscovarianceBase_html_af298d9a2d624b02c4953e735d870fcf5"><div class="ttname"><a href="classcovarianceBase.html#af298d9a2d624b02c4953e735d870fcf5">covarianceBase::getParProp</a></div><div class="ttdeci">double getParProp(const int i) const</div><div class="ttdoc">Get proposed parameter value.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00230">covarianceBase.h:230</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_a0d42cbfc22f21906264af285fd57b1af"><div class="ttname"><a href="classsplineFDBase.html#a0d42cbfc22f21906264af285fd57b1af">splineFDBase::nUniqueSysts</a></div><div class="ttdeci">int nUniqueSysts</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00102">splineFDBase.h:102</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_a176d42bb137d3c8c3771eb1a4a8440c8"><div class="ttname"><a href="classsplineFDBase.html#a176d42bb137d3c8c3771eb1a4a8440c8">splineFDBase::UniqueSystNKnots</a></div><div class="ttdeci">std::vector&lt; int &gt; UniqueSystNKnots</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00105">splineFDBase.h:105</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_a3b821b95c2db6063a9baa244b28aeaa6"><div class="ttname"><a href="classsplineFDBase.html#a3b821b95c2db6063a9baa244b28aeaa6">splineFDBase::UniqueSystIndices</a></div><div class="ttdeci">std::vector&lt; int &gt; UniqueSystIndices</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00104">splineFDBase.h:104</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_a5112a1bbd658d3a90c6a785c12aebf34"><div class="ttname"><a href="classsplineFDBase.html#a5112a1bbd658d3a90c6a785c12aebf34">splineFDBase::UniqueSystXPts</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; M3::float_t &gt; &gt; UniqueSystXPts</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00107">splineFDBase.h:107</a></div></div>
<div class="ttc" id="anamespaceM3_html_adb59b8ecdc4e1b2d5d4c826a13aa7463"><div class="ttname"><a href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a></div><div class="ttdeci">int int_t</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00027">Core.h:27</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a85302df644fb84ff00201624c454636f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85302df644fb84ff00201624c454636f">&#9670;&nbsp;</a></span>getDimLabel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string splineFDBase::getDimLabel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>BinningOpt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>Axis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8cpp_source.html#l00750">750</a> of file <a class="el" href="splineFDBase_8cpp_source.html">splineFDBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;{</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <span class="keywordflow">if</span>(Axis &gt; <a class="code" href="classsplineFDBase.html#a00e1aeea8e9389c41f93469a26c83adc">DimensionLabels</a>[iSample].<a class="code" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>()){</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;The spline Axis you are trying to get the label of is larger than the number of dimensions&quot;</span>);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;You are trying to get axis {} but have only got {}&quot;</span>, Axis, <a class="code" href="classsplineFDBase.html#a6c28400605049bdee229885c46463dcd">Dimensions</a>[iSample]);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  }</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classsplineFDBase.html#a00e1aeea8e9389c41f93469a26c83adc">DimensionLabels</a>.at(iSample).at(Axis);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a174446c62e92573d2c15c207b22f1c36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a174446c62e92573d2c15c207b22f1c36">&#9670;&nbsp;</a></span>GetEventSplines()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::vector&lt; std::vector&lt;int&gt; &gt; splineFDBase::GetEventSplines </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>SampleName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iOscChan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>EventMode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Var1Val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Var2Val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Var3Val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the splines which affect a given event. </p>

</div>
</div>
<a id="aa37a0f892b96f6b0e3b6b7aa847e94cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa37a0f892b96f6b0e3b6b7aa847e94cb">&#9670;&nbsp;</a></span>getNDim()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int splineFDBase::getNDim </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>BinningOpt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5de6441e53ffe4e7e126a222ac8d712a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5de6441e53ffe4e7e126a222ac8d712a">&#9670;&nbsp;</a></span>getSampleIndex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int splineFDBase::getSampleIndex </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>SampleName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8cpp_source.html#l00762">762</a> of file <a class="el" href="splineFDBase_8cpp_source.html">splineFDBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                                                           {</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="keywordtype">int</span> SampleIndex = -1;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iSample = 0; iSample &lt; <a class="code" href="classsplineFDBase.html#a78508c5d0d4ef09457beb723dc796208">SampleNames</a>.size(); iSample++)</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  {</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keywordflow">if</span> (SampleName == <a class="code" href="classsplineFDBase.html#a78508c5d0d4ef09457beb723dc796208">SampleNames</a>[iSample])</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      SampleIndex = iSample;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    }</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  }</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  <span class="keywordflow">if</span> (SampleIndex == -1)</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  {</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Sample name not found : {}&quot;</span>, SampleName);     </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  }</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="keywordflow">return</span> SampleIndex;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8b7b34479c3240a9827d6a0b5b7da4b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b7b34479c3240a9827d6a0b5b7da4b4">&#9670;&nbsp;</a></span>getSplineCoeff_SepMany()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void splineFDBase::getSplineCoeff_SepMany </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>splineindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> *&amp;&#160;</td>
          <td class="paramname"><em>xArray</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> *&amp;&#160;</td>
          <td class="paramname"><em>manyArray</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8cpp_source.html#l00708">708</a> of file <a class="el" href="splineFDBase_8cpp_source.html">splineFDBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                                                                                                   {</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">//****************************************</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="comment">// Initialise all arrays to 1.0</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="keywordtype">int</span> nPoints;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <span class="comment">//No point evaluating a flat spline</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  nPoints = <a class="code" href="classsplineFDBase.html#a84ec9ea208503053b9735b1cb1bc417d">splinevec_Monolith</a>[splineindex]-&gt;GetNp();</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nPoints; i++) {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    xArray[i] = 1.0;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 4; j++) {</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      manyArray[i*4+j] = 1.0;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    }</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  }</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nPoints; i++) {</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="comment">// Spline coefficients to be</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="comment">// M3::float_t type is defined by the LOW_MEMORY_STRUCTS compiler flag</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="comment">// so M3::float_t can be double or float depending on this</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> x = <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>(-999.99);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> y = <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>(-999.99);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> b = <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>(-999.99);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> c = <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>(-999.99);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> d = <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>(-999.99);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <a class="code" href="classsplineFDBase.html#a84ec9ea208503053b9735b1cb1bc417d">splinevec_Monolith</a>[splineindex]-&gt;GetCoeff(i, x, y, b, c, d);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="comment">// Store the coefficients for each knot contiguously in memory</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="comment">// 4 because manyArray stores y,b,c,d</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    xArray[i] = x;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    manyArray[i*4] = y; </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    manyArray[i*4+1] = b;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    manyArray[i*4+2] = c;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    manyArray[i*4+3] = d;    </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  }</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="comment">//We now clean up the splines!</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <span class="keyword">delete</span> <a class="code" href="classsplineFDBase.html#a84ec9ea208503053b9735b1cb1bc417d">splinevec_Monolith</a>[splineindex];</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <a class="code" href="classsplineFDBase.html#a84ec9ea208503053b9735b1cb1bc417d">splinevec_Monolith</a>[splineindex] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2b026cd74035f56db3790f1eea49de92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b026cd74035f56db3790f1eea49de92">&#9670;&nbsp;</a></span>isValidSplineIndex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool splineFDBase::isValidSplineIndex </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>SampleName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iSyst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iOscChan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iMode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iVar1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iVar2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iVar3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8cpp_source.html#l00819">819</a> of file <a class="el" href="splineFDBase_8cpp_source.html">splineFDBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;{</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  <span class="keywordtype">int</span> iSample=<a class="code" href="classsplineFDBase.html#a5de6441e53ffe4e7e126a222ac8d712a">getSampleIndex</a>(SampleName);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <span class="keywordtype">bool</span> isValid = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <span class="keywordflow">if</span> (iSample &lt; 0 || iSample &gt;= <span class="keywordtype">int</span>(<a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>.size()))</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  {</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Sample index is invalid! 0 &lt;= Index &lt; {} &quot;</span>, <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>.size());</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    isValid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  }</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160; </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <span class="keywordflow">if</span> (iOscChan &lt; 0 || iOscChan &gt;= <span class="keywordtype">int</span>(<a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample].<a class="code" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>()))</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  {</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;OscChan index is invalid! 0 &lt;= Index &lt; {} &quot;</span>, <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample].<a class="code" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>());</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    isValid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  }</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="keywordflow">if</span> (iSyst &lt; 0 || iSyst &gt;= <span class="keywordtype">int</span>(<a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan].<a class="code" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>()))</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  {</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Syst index is invalid! 0 &lt;= Index &lt; {} &quot;</span>, <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan].<a class="code" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>());</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    isValid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  }</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160; </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="keywordflow">if</span> (iMode &lt; 0 || iMode &gt;= <span class="keywordtype">int</span>(<a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst].<a class="code" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>()))</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  {</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Mode index is invalid! 0 &lt;= Index &lt; {} &quot;</span>, <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst].<a class="code" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>());</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    isValid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  }</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160; </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <span class="keywordflow">if</span> (iVar1 &lt; 0 || iVar1 &gt;= <span class="keywordtype">int</span>(<a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst][iMode].<a class="code" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>()))</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Var1 index is invalid! 0 &lt;= Index &lt; {} &quot;</span>, <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst][iMode].<a class="code" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>());      </div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    isValid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  }</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160; </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="keywordflow">if</span> (iVar2 &lt; 0 || iVar2 &gt;= <span class="keywordtype">int</span>(<a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst][iMode][iVar1].<a class="code" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>()))</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  {</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Var2 index is invalid! 0 &lt;= Index &lt; {} &quot;</span>, <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst][iMode][iVar1].<a class="code" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>());</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    isValid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  }</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160; </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <span class="keywordflow">if</span> (iVar3 &lt; 0 || iVar3 &gt;= <span class="keywordtype">int</span>(<a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst][iMode][iVar1][iVar2].<a class="code" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>()))</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  {</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Var3 index is invalid! 0 &lt;= Index &lt; {} &quot;</span>, <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst][iMode][iVar1][iVar2].<a class="code" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>());</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    isValid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  }</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <span class="keywordflow">if</span> (!isValid)</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  { </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Given iSample: {}&quot;</span>, iSample);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Given iOscChan: {}&quot;</span>, iOscChan);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Given iSyst: {}&quot;</span>, iSyst);</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Given iMode: {}&quot;</span>, iMode);</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Given iVar1: {}&quot;</span>, iVar1);</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Given iVar2: {}&quot;</span>, iVar2);</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Given iVar3: {}&quot;</span>, iVar3);   </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Come visit me at : {} : {}&quot;</span>, __FILE__, __LINE__);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  }</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160; </div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1a237a8b8c3c165c82ebe15d2ca740c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a237a8b8c3c165c82ebe15d2ca740c7">&#9670;&nbsp;</a></span>ModifyWeights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void splineFDBase::ModifyWeights </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calc total event weight, not used by Bin-by-bin splines. </p>

<p>Implements <a class="el" href="classSplineBase.html#a49665d2712b61b038085d25ace96a568">SplineBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00076">76</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;{<span class="keywordflow">return</span>;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2eb495f4d63c9e4ee10b97c47e982b28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2eb495f4d63c9e4ee10b97c47e982b28">&#9670;&nbsp;</a></span>PrepForReweight()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void splineFDBase::PrepForReweight </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8cpp_source.html#l00551">551</a> of file <a class="el" href="splineFDBase_8cpp_source.html">splineFDBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                                   {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">//****************************************</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  std::vector&lt;TSpline3_red*&gt; UniqueSystSplines;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="comment">// DB Find all the Unique systs across each sample and oscillation channel</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="comment">//    This assumes that each occurence of the same systematic spline has the same knot spacing</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="comment">//    Which is a reasonable assumption for the current implementation of spline evaluations</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iSample = 0; iSample &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>.size(); iSample++)</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  { <span class="comment">// Loop over systematics</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iSyst = 0; iSyst &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][0].size(); iSyst++)</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    { <span class="comment">// Loop over systematics</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      std::string SystName = <a class="code" href="classsplineFDBase.html#a5619363447e607cd835c46d601b10675">SplineFileParPrefixNames</a>[iSample][iSyst];</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      <span class="keywordtype">bool</span> FoundSyst = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      <span class="comment">//ETA - this always seems to be empty to begin with??</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <span class="comment">//so this loop never gets used?</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iFoundSyst = 0; iFoundSyst &lt; <a class="code" href="classsplineFDBase.html#aacf850f4ec22e4f7338f243999ecc7dd">UniqueSystNames</a>.size(); iFoundSyst++)</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      {</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="keywordflow">if</span> (SystName == <a class="code" href="classsplineFDBase.html#aacf850f4ec22e4f7338f243999ecc7dd">UniqueSystNames</a>[iFoundSyst])</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;          FoundSyst = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        }</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      }</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <span class="keywordflow">if</span> (!FoundSyst)</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      {</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="keywordtype">bool</span> FoundNonFlatSpline = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="comment">//This is all basically to check that you have some resposne from a spline</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <span class="comment">//systematic somewhere</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iOscChan = 0; iOscChan &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample].size(); iOscChan++)</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        { <span class="comment">// Loop over oscillation channels</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iMode = 0; iMode &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst].size(); iMode++)</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;          { <span class="comment">// Loop over modes</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iVar1 = 0; iVar1 &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst][iMode].size(); iVar1++)</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            { <span class="comment">// Loop over first dimension</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iVar2 = 0; iVar2 &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst][iMode][iVar1].size(); iVar2++)</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;              { <span class="comment">// Loop over second dimension</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iVar3 = 0; iVar3 &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst][iMode][iVar1][iVar2].size(); iVar3++)</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                { <span class="comment">// Loop over third dimension</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                  <span class="keywordtype">int</span> splineindex=<a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst][iMode][iVar1][iVar2][iVar3];</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="classsplineFDBase.html#a84ec9ea208503053b9735b1cb1bc417d">splinevec_Monolith</a>[splineindex])</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                  {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                    UniqueSystSplines.push_back(<a class="code" href="classsplineFDBase.html#a84ec9ea208503053b9735b1cb1bc417d">splinevec_Monolith</a>[splineindex]);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                    <a class="code" href="classsplineFDBase.html#a3b821b95c2db6063a9baa244b28aeaa6">UniqueSystIndices</a>.push_back(<a class="code" href="classsplineFDBase.html#af036372a158b4e463683a8d02a20ec3d">GlobalSystIndex</a>[iSample][iSyst]);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                    FoundNonFlatSpline = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                  }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                  <span class="keywordflow">if</span> (FoundNonFlatSpline)</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                  {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                  }</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                }<span class="comment">//3D loop end</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                <span class="keywordflow">if</span> (FoundNonFlatSpline)</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                  <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;              }<span class="comment">//2D loop end</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;              <span class="keywordflow">if</span> (FoundNonFlatSpline)</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;              {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;              }</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            }<span class="comment">//1D loop end</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            <span class="keywordflow">if</span> (FoundNonFlatSpline)</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;          }<span class="comment">//mode loop end</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;          <span class="keywordflow">if</span> (FoundNonFlatSpline)</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;          {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;          }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        }<span class="comment">//osc loop end</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="comment">//ETA - only push back unique name if a non-flat response has been found</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="keywordflow">if</span>(FoundNonFlatSpline){</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;          <a class="code" href="classsplineFDBase.html#aacf850f4ec22e4f7338f243999ecc7dd">UniqueSystNames</a>.push_back(SystName);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        <span class="keywordflow">if</span> (!FoundNonFlatSpline)</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;          <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{} syst has no response in sample {}&quot;</span>, SystName, iSample);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;          <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Whilst this isn&#39;t neccessarily a problem, it seems odd&quot;</span>);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        }</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      }</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    }<span class="comment">//Syst loop end</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  }</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <a class="code" href="classsplineFDBase.html#a0d42cbfc22f21906264af285fd57b1af">nUniqueSysts</a> = int(UniqueSystSplines.size());</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  <span class="comment">// DB Find the number of splines knots which assumes each instance of the syst has the same number of knots</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <a class="code" href="classsplineFDBase.html#a176d42bb137d3c8c3771eb1a4a8440c8">UniqueSystNKnots</a>.resize(<a class="code" href="classsplineFDBase.html#a0d42cbfc22f21906264af285fd57b1af">nUniqueSysts</a>);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <a class="code" href="classsplineFDBase.html#aa36e6889d054ad0f86f33a53dd3fe036">UniqueSystCurrSegment</a>.resize(<a class="code" href="classsplineFDBase.html#a0d42cbfc22f21906264af285fd57b1af">nUniqueSysts</a>);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <a class="code" href="classsplineFDBase.html#a5112a1bbd658d3a90c6a785c12aebf34">UniqueSystXPts</a>.resize(<a class="code" href="classsplineFDBase.html#a0d42cbfc22f21906264af285fd57b1af">nUniqueSysts</a>);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <a class="code" href="classsplineFDBase.html#a324c4b50910454092ba45d945ef57bda">xVarArray</a>=<span class="keyword">new</span> <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>[<a class="code" href="classsplineFDBase.html#a0d42cbfc22f21906264af285fd57b1af">nUniqueSysts</a>];</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iSpline = 0; iSpline &lt; <a class="code" href="classsplineFDBase.html#a0d42cbfc22f21906264af285fd57b1af">nUniqueSysts</a>; iSpline++)</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  {</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <a class="code" href="classsplineFDBase.html#a176d42bb137d3c8c3771eb1a4a8440c8">UniqueSystNKnots</a>[iSpline] = UniqueSystSplines[iSpline]-&gt;GetNp();</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <a class="code" href="classsplineFDBase.html#a5112a1bbd658d3a90c6a785c12aebf34">UniqueSystXPts</a>[iSpline].resize(<a class="code" href="classsplineFDBase.html#a176d42bb137d3c8c3771eb1a4a8440c8">UniqueSystNKnots</a>[iSpline]);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iKnot = 0; iKnot &lt; <a class="code" href="classsplineFDBase.html#a176d42bb137d3c8c3771eb1a4a8440c8">UniqueSystNKnots</a>[iSpline]; iKnot++)</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    {</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> xPoint;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> yPoint;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      UniqueSystSplines[iSpline]-&gt;GetKnot(iKnot, xPoint, yPoint);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      <a class="code" href="classsplineFDBase.html#a5112a1bbd658d3a90c6a785c12aebf34">UniqueSystXPts</a>[iSpline][iKnot] = xPoint;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    }</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="comment">//ETA - let this just be set as the first segment by default</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <a class="code" href="classsplineFDBase.html#aa36e6889d054ad0f86f33a53dd3fe036">UniqueSystCurrSegment</a>[iSpline] = 0;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <a class="code" href="classsplineFDBase.html#a324c4b50910454092ba45d945ef57bda">xVarArray</a>[iSpline]=0;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  }</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;nUniqueSysts: {}&quot;</span>, <a class="code" href="classsplineFDBase.html#a0d42cbfc22f21906264af285fd57b1af">nUniqueSysts</a>);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{:&lt;15} | {:&lt;20} | {:&lt;6}&quot;</span>, <span class="stringliteral">&quot;Spline Index&quot;</span>, <span class="stringliteral">&quot;Syst Name&quot;</span>, <span class="stringliteral">&quot;nKnots&quot;</span>);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iUniqueSyst = 0; iUniqueSyst &lt; <a class="code" href="classsplineFDBase.html#a0d42cbfc22f21906264af285fd57b1af">nUniqueSysts</a>; iUniqueSyst++)</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  {</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{:&lt;15} | {:&lt;20} | {:&lt;6}&quot;</span>, iUniqueSyst, <a class="code" href="classsplineFDBase.html#aacf850f4ec22e4f7338f243999ecc7dd">UniqueSystNames</a>[iUniqueSyst], <a class="code" href="classsplineFDBase.html#a176d42bb137d3c8c3771eb1a4a8440c8">UniqueSystNKnots</a>[iUniqueSyst]);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <span class="comment">//ETA</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="comment">//Isn&#39;t this just doing what CountNumberOfLoadedSplines() does?</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="keywordtype">int</span> nCombinations_FlatSplines = 0;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="keywordtype">int</span> nCombinations_All = 0;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="comment">// DB Now actually loop over splines to determine which are all null i.e. flat</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iSample = 0; iSample &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>.size(); iSample++)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  { <span class="comment">// Loop over systematics</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iOscChan = 0; iOscChan &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample].size(); iOscChan++)</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    { <span class="comment">// Loop over oscillation channels</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iSyst = 0; iSyst &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan].size(); iSyst++)</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      { <span class="comment">// Loop over systematics</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iMode = 0; iMode &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst].size(); iMode++)</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        { <span class="comment">// Loop over modes</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;          <span class="comment">//bool isFlat = false;</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iVar1 = 0; iVar1 &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst][iMode].size(); iVar1++)</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;          { <span class="comment">// Loop over first dimension</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iVar2 = 0; iVar2 &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst][iMode][iVar1].size(); iVar2++)</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            { <span class="comment">// Loop over second dimension</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iVar3 = 0; iVar3 &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst][iMode][iVar1][iVar2].size(); iVar3++)</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;              { <span class="comment">// Loop over third dimension</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                <span class="keywordtype">int</span> splineindex=<a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst][iMode][iVar1][iVar2][iVar3];</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classsplineFDBase.html#a84ec9ea208503053b9735b1cb1bc417d">splinevec_Monolith</a>[splineindex])</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                  nCombinations_All += 1;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                } <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                  nCombinations_FlatSplines += 1;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                  nCombinations_All += 1;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                }</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;              }</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            }</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;          }</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        }</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    }</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <span class="comment">// We need to grab the maximum number of knots</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Number of combinations of Sample, OscChan, Syst and Mode which have entirely flat response: {} / {}&quot;</span>, nCombinations_FlatSplines, nCombinations_All);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2930155dc346dc5106bc481586ca4948"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2930155dc346dc5106bc481586ca4948">&#9670;&nbsp;</a></span>PrintArrayDetails()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void splineFDBase::PrintArrayDetails </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>SampleName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8cpp_source.html#l00793">793</a> of file <a class="el" href="splineFDBase_8cpp_source.html">splineFDBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;{</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <span class="keywordtype">int</span> iSample = <a class="code" href="classsplineFDBase.html#a5de6441e53ffe4e7e126a222ac8d712a">getSampleIndex</a>(SampleName);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="keywordtype">int</span> nOscChannels = int(<a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample].<a class="code" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>());</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Sample {} has {} oscillation channels&quot;</span>, SampleName, nOscChannels); </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  </div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iOscChan = 0; iOscChan &lt; nOscChannels; iOscChan++)</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  {</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="keywordtype">int</span> nSysts = int(<a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan].<a class="code" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>());</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Oscillation channel {} has {} systematics&quot;</span>, iOscChan, nSysts);     </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  }</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;#----------------------------------------------------------------------------------------------------------------------------------#&quot;</span>);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Printing no. of modes affected by each systematic for each oscillation channel&quot;</span>);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iOscChan = 0; iOscChan &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample].size(); iOscChan++) {</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    std::string modes = fmt::format(<span class="stringliteral">&quot;OscChan: {}\t&quot;</span>, iOscChan);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iSyst = 0; iSyst &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan].size(); iSyst++) {</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      modes += fmt::format(<span class="stringliteral">&quot;{} &quot;</span>, <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst].<a class="code" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>());</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    }</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{}&quot;</span>, modes);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  }</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;#----------------------------------------------------------------------------------------------------------------------------------#&quot;</span>);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7f5b16b65dc7da748f20bdc803b7e593"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f5b16b65dc7da748f20bdc803b7e593">&#9670;&nbsp;</a></span>PrintBinning()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void splineFDBase::PrintBinning </td>
          <td>(</td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>Axis</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8cpp_source.html#l00884">884</a> of file <a class="el" href="splineFDBase_8cpp_source.html">splineFDBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;{</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> NBins = Axis-&gt;GetNbins();</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  std::string text = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iBin = 0; iBin &lt;= NBins; iBin++) {</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    text += fmt::format(<span class="stringliteral">&quot;{} &quot;</span>, Axis-&gt;GetXbins()-&gt;GetAt(iBin));</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  }</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{}&quot;</span>, text);</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af45c2bd4fbeb4dedabdedd991a25fb1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af45c2bd4fbeb4dedabdedd991a25fb1e">&#9670;&nbsp;</a></span>PrintSampleDetails()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void splineFDBase::PrintSampleDetails </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>SampleName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8cpp_source.html#l00780">780</a> of file <a class="el" href="splineFDBase_8cpp_source.html">splineFDBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;{</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="keywordtype">int</span> iSample = <a class="code" href="classsplineFDBase.html#a5de6441e53ffe4e7e126a222ac8d712a">getSampleIndex</a>(SampleName);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160; </div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Details about sample: {:&lt;20}&quot;</span>, <a class="code" href="classsplineFDBase.html#a78508c5d0d4ef09457beb723dc796208">SampleNames</a>[iSample]);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;\t Dimension: {:&lt;35}&quot;</span>, <a class="code" href="classsplineFDBase.html#a6c28400605049bdee229885c46463dcd">Dimensions</a>[iSample]);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;\t DetID: {:&lt;35}&quot;</span>, <a class="code" href="classsplineFDBase.html#a481d275de711edfddbb82d3924b6e63a">DetIDs</a>[iSample]);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;\t nSplineParam: {:&lt;35}&quot;</span>, <a class="code" href="classsplineFDBase.html#aad64c7c63db8ea676f86eb2279f04d40">nSplineParams</a>[iSample]);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;\t nOscChan: {:&lt;35}&quot;</span>, <a class="code" href="classsplineFDBase.html#aa10670a64bbdef3ffd69f4b8f102fff3">nOscChans</a>[iSample]);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8825fb6bdcde012c90005dd9b91967e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8825fb6bdcde012c90005dd9b91967e4">&#9670;&nbsp;</a></span>retPointer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>* splineFDBase::retPointer </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>sample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>oscchan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>syst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>var1bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>var2bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>var3bin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00064">64</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                                                                                                  {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordtype">int</span> index = <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[sample][oscchan][syst][mode][var1bin][var2bin][var3bin];</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <span class="keywordflow">return</span> &amp;<a class="code" href="classsplineFDBase.html#a107c337ce7053208795747a3223f04e1">weightvec_Monolith</a>[index];</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1cccada6b5ee280213997ab95721abf0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cccada6b5ee280213997ab95721abf0">&#9670;&nbsp;</a></span>StripDuplicatedModes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::vector&lt; std::vector&lt;int&gt; &gt; splineFDBase::StripDuplicatedModes </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int &gt; &gt;&#160;</td>
          <td class="paramname"><em>InputVector</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if there are any repeated modes. This is used to reduce the number of modes in case many interaction modes get averaged into one spline. </p>

</div>
</div>
<a id="a6d1872fe4be72c735bd55fa00e1674b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d1872fe4be72c735bd55fa00e1674b8">&#9670;&nbsp;</a></span>TransferToMonolith()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void splineFDBase::TransferToMonolith </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8cpp_source.html#l00123">123</a> of file <a class="el" href="splineFDBase_8cpp_source.html">splineFDBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;{</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <a class="code" href="classsplineFDBase.html#a2eb495f4d63c9e4ee10b97c47e982b28">PrepForReweight</a>(); </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <a class="code" href="classsplineFDBase.html#ad1fefa7f796f2a28a69f5336f5777bce">MonolithSize</a> = <a class="code" href="classsplineFDBase.html#a0bfc616fab953333e6e938de52ce3bed">CountNumberOfLoadedSplines</a>(<span class="keyword">false</span>, 1);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classsplineFDBase.html#ad1fefa7f796f2a28a69f5336f5777bce">MonolithSize</a>!=<a class="code" href="classsplineFDBase.html#addec38a8493974ccc3ee16931d5b794a">MonolithIndex</a>){</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Something&#39;s gone wrong when we tried to get the size of your monolith&quot;</span>);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;MonolithSize is {}&quot;</span>, <a class="code" href="classsplineFDBase.html#ad1fefa7f796f2a28a69f5336f5777bce">MonolithSize</a>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;MonolithIndex is {}&quot;</span>, <a class="code" href="classsplineFDBase.html#addec38a8493974ccc3ee16931d5b794a">MonolithIndex</a>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Now transferring splines to a monolith if size {}&quot;</span>, <a class="code" href="classsplineFDBase.html#ad1fefa7f796f2a28a69f5336f5777bce">MonolithSize</a>);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <a class="code" href="classsplineFDBase.html#ae237cc1c6d97e35bf4f7f64e369a5781">uniquesplinevec_Monolith</a>.resize(<a class="code" href="classsplineFDBase.html#ad1fefa7f796f2a28a69f5336f5777bce">MonolithSize</a>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="classsplineFDBase.html#a107c337ce7053208795747a3223f04e1">weightvec_Monolith</a>.resize(<a class="code" href="classsplineFDBase.html#ad1fefa7f796f2a28a69f5336f5777bce">MonolithSize</a>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <a class="code" href="classsplineFDBase.html#aa8a204355df78af3f79bf8f2815258d3">isflatarray</a> = <span class="keyword">new</span> <span class="keywordtype">bool</span>[<a class="code" href="classsplineFDBase.html#ad1fefa7f796f2a28a69f5336f5777bce">MonolithSize</a>];</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <a class="code" href="classsplineFDBase.html#a00f046c4c64c0aa11334b32b0701a9f1">xcoeff_arr</a> = <span class="keyword">new</span> <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>[<a class="code" href="classsplineFDBase.html#abcff04fee3e6790a099a0df9dbee74c2">CoeffIndex</a>];</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <a class="code" href="classsplineFDBase.html#ab883a1f2cdae707c36fa27b86ed7f279">manycoeff_arr</a> = <span class="keyword">new</span> <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>[<a class="code" href="classsplineFDBase.html#abcff04fee3e6790a099a0df9dbee74c2">CoeffIndex</a>*4];</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iSample = 0; iSample &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>.size(); iSample++)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  { <span class="comment">// Loop over sample</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iOscChan = 0; iOscChan &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample].size(); iOscChan++)</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    { <span class="comment">// Loop over oscillation channels</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iSyst = 0; iSyst &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan].size(); iSyst++)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      { <span class="comment">// Loop over systematics</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iMode = 0; iMode &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst].size(); iMode++)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        { <span class="comment">// Loop over modes</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iVar1 = 0; iVar1 &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst][iMode].size(); iVar1++)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          { <span class="comment">// Loop over first dimension</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iVar2 = 0; iVar2 &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst][iMode][iVar1].size(); iVar2++)</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            { <span class="comment">// Loop over second dimension</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iVar3 = 0; iVar3 &lt; <a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst][iMode][iVar1][iVar2].size(); iVar3++)</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;              {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                <span class="keywordtype">int</span> splineindex=<a class="code" href="classsplineFDBase.html#ab3a4e79bfe675a4070597557e6226e12">indexvec</a>[iSample][iOscChan][iSyst][iMode][iVar1][iVar2][iVar3];</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                <a class="code" href="classsplineFDBase.html#a107c337ce7053208795747a3223f04e1">weightvec_Monolith</a>[splineindex] = 1.0;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                <span class="keywordtype">bool</span> foundUniqueSpline = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iUniqueSyst = 0; iUniqueSyst &lt; <a class="code" href="classsplineFDBase.html#a0d42cbfc22f21906264af285fd57b1af">nUniqueSysts</a>; iUniqueSyst++)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="classsplineFDBase.html#a5619363447e607cd835c46d601b10675">SplineFileParPrefixNames</a>[iSample][iSyst] == <a class="code" href="classsplineFDBase.html#aacf850f4ec22e4f7338f243999ecc7dd">UniqueSystNames</a>[iUniqueSyst])</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                  {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                    <a class="code" href="classsplineFDBase.html#ae237cc1c6d97e35bf4f7f64e369a5781">uniquesplinevec_Monolith</a>[splineindex] = iUniqueSyst;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                    foundUniqueSpline = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                  }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                }<span class="comment">//unique syst loop end</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                <span class="keywordflow">if</span> (!foundUniqueSpline)</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                  <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Unique spline index not found&quot;</span>);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                  <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;For Spline {}&quot;</span>, <a class="code" href="classsplineFDBase.html#a5619363447e607cd835c46d601b10675">SplineFileParPrefixNames</a>[iSample][iSyst]);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                  <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Couldn&#39;t match {} with any of the following {} systs:&quot;</span>, <a class="code" href="classsplineFDBase.html#a5619363447e607cd835c46d601b10675">SplineFileParPrefixNames</a>[iSample][iSyst], <a class="code" href="classsplineFDBase.html#a0d42cbfc22f21906264af285fd57b1af">nUniqueSysts</a>);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iUniqueSyst = 0; iUniqueSyst &lt; <a class="code" href="classsplineFDBase.html#a0d42cbfc22f21906264af285fd57b1af">nUniqueSysts</a>; iUniqueSyst++)</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                  {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;{},&quot;</span>, <a class="code" href="classsplineFDBase.html#aacf850f4ec22e4f7338f243999ecc7dd">UniqueSystNames</a>.at(iUniqueSyst));</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                  }<span class="comment">//unique syst loop end</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                  <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                <span class="keywordtype">int</span> splineKnots;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classsplineFDBase.html#a84ec9ea208503053b9735b1cb1bc417d">splinevec_Monolith</a>[splineindex]){</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                  <a class="code" href="classsplineFDBase.html#aa8a204355df78af3f79bf8f2815258d3">isflatarray</a>[splineindex]=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                  splineKnots=<a class="code" href="classsplineFDBase.html#a84ec9ea208503053b9735b1cb1bc417d">splinevec_Monolith</a>[splineindex]-&gt;GetNp();</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                  <span class="comment">//Now to fill up our coefficient arrayss</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                  <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>* tmpXCoeffArr = <span class="keyword">new</span> <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>[splineKnots];</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                  <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>* tmpManyCoeffArr = <span class="keyword">new</span> <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>[splineKnots*4];</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                  <span class="keywordtype">int</span> iCoeff=<a class="code" href="classsplineFDBase.html#af63885ddb6731f77808d029372e6b187">coeffindexvec</a>[splineindex];</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                  <a class="code" href="classsplineFDBase.html#a8b7b34479c3240a9827d6a0b5b7da4b4">getSplineCoeff_SepMany</a>(splineindex, tmpXCoeffArr, tmpManyCoeffArr);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; splineKnots; i++){</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                    <a class="code" href="classsplineFDBase.html#a00f046c4c64c0aa11334b32b0701a9f1">xcoeff_arr</a>[iCoeff+i]=tmpXCoeffArr[i];</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;4; j++){</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                      <a class="code" href="classsplineFDBase.html#ab883a1f2cdae707c36fa27b86ed7f279">manycoeff_arr</a>[(iCoeff+i)*4+j]=tmpManyCoeffArr[i*4+j];</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                    }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                  }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                  <span class="keyword">delete</span>[] tmpXCoeffArr;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                  <span class="keyword">delete</span>[] tmpManyCoeffArr;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                    <a class="code" href="classsplineFDBase.html#aa8a204355df78af3f79bf8f2815258d3">isflatarray</a>[splineindex]=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;              }<span class="comment">//3d loop end</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            }<span class="comment">//2d loop end</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;          }<span class="comment">//1d loop end</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        }<span class="comment">//mode loop end</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      }<span class="comment">//syst2 loop end</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    }<span class="comment">//osc loop end</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  }<span class="comment">//syst1 loop end</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;}</div>
<div class="ttc" id="aclasssplineFDBase_html_a0bfc616fab953333e6e938de52ce3bed"><div class="ttname"><a href="classsplineFDBase.html#a0bfc616fab953333e6e938de52ce3bed">splineFDBase::CountNumberOfLoadedSplines</a></div><div class="ttdeci">int CountNumberOfLoadedSplines(bool NonFlat=false, int Verbosity=0)</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8cpp_source.html#l00488">splineFDBase.cpp:488</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_a2eb495f4d63c9e4ee10b97c47e982b28"><div class="ttname"><a href="classsplineFDBase.html#a2eb495f4d63c9e4ee10b97c47e982b28">splineFDBase::PrepForReweight</a></div><div class="ttdeci">void PrepForReweight()</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8cpp_source.html#l00551">splineFDBase.cpp:551</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_a8b7b34479c3240a9827d6a0b5b7da4b4"><div class="ttname"><a href="classsplineFDBase.html#a8b7b34479c3240a9827d6a0b5b7da4b4">splineFDBase::getSplineCoeff_SepMany</a></div><div class="ttdeci">void getSplineCoeff_SepMany(int splineindex, M3::float_t *&amp;xArray, M3::float_t *&amp;manyArray)</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8cpp_source.html#l00708">splineFDBase.cpp:708</a></div></div>
<div class="ttc" id="aclasssplineFDBase_html_ad1fefa7f796f2a28a69f5336f5777bce"><div class="ttname"><a href="classsplineFDBase.html#ad1fefa7f796f2a28a69f5336f5777bce">splineFDBase::MonolithSize</a></div><div class="ttdeci">int MonolithSize</div><div class="ttdef"><b>Definition:</b> <a href="splineFDBase_8h_source.html#l00116">splineFDBase.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="abcff04fee3e6790a099a0df9dbee74c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcff04fee3e6790a099a0df9dbee74c2">&#9670;&nbsp;</a></span>CoeffIndex</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int splineFDBase::CoeffIndex</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00118">118</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="af63885ddb6731f77808d029372e6b187"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af63885ddb6731f77808d029372e6b187">&#9670;&nbsp;</a></span>coeffindexvec</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int &gt; splineFDBase::coeffindexvec</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00111">111</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="a481d275de711edfddbb82d3924b6e63a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a481d275de711edfddbb82d3924b6e63a">&#9670;&nbsp;</a></span>DetIDs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; splineFDBase::DetIDs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00084">84</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="a00e1aeea8e9389c41f93469a26c83adc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00e1aeea8e9389c41f93469a26c83adc">&#9670;&nbsp;</a></span>DimensionLabels</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;std::string&gt; &gt; splineFDBase::DimensionLabels</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00083">83</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="a6c28400605049bdee229885c46463dcd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c28400605049bdee229885c46463dcd">&#9670;&nbsp;</a></span>Dimensions</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; splineFDBase::Dimensions</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00082">82</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="af036372a158b4e463683a8d02a20ec3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af036372a158b4e463683a8d02a20ec3d">&#9670;&nbsp;</a></span>GlobalSystIndex</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt;int&gt; &gt; splineFDBase::GlobalSystIndex</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This holds the global spline index and is used to grab the current parameter value to evaluate splines at. Each internal vector will be of size of the number of spline systematics which affect that sample. </p>

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00097">97</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="ab3a4e79bfe675a4070597557e6226e12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3a4e79bfe675a4070597557e6226e12">&#9670;&nbsp;</a></span>indexvec</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt; std::vector&lt; std::vector&lt; std::vector&lt; std::vector&lt; std::vector&lt; int &gt; &gt; &gt; &gt; &gt; &gt; &gt; splineFDBase::indexvec</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Variables related to determined which modes have splines and which piggy-back of other modes. </p>

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00110">110</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="aa8a204355df78af3f79bf8f2815258d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8a204355df78af3f79bf8f2815258d3">&#9670;&nbsp;</a></span>isflatarray</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool* splineFDBase::isflatarray</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Need to keep track of which splines are flat and which aren't. </p>

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00123">123</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="ab883a1f2cdae707c36fa27b86ed7f279"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab883a1f2cdae707c36fa27b86ed7f279">&#9670;&nbsp;</a></span>manycoeff_arr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>* splineFDBase::manycoeff_arr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>ybcd coefficients for each spline </p>

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00127">127</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="addec38a8493974ccc3ee16931d5b794a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addec38a8493974ccc3ee16931d5b794a">&#9670;&nbsp;</a></span>MonolithIndex</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int splineFDBase::MonolithIndex</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00117">117</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="ad1fefa7f796f2a28a69f5336f5777bce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1fefa7f796f2a28a69f5336f5777bce">&#9670;&nbsp;</a></span>MonolithSize</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int splineFDBase::MonolithSize</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00116">116</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="aa10670a64bbdef3ffd69f4b8f102fff3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa10670a64bbdef3ffd69f4b8f102fff3">&#9670;&nbsp;</a></span>nOscChans</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; splineFDBase::nOscChans</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00086">86</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="aad64c7c63db8ea676f86eb2279f04d40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad64c7c63db8ea676f86eb2279f04d40">&#9670;&nbsp;</a></span>nSplineParams</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; splineFDBase::nSplineParams</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00085">85</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="a0d42cbfc22f21906264af285fd57b1af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d42cbfc22f21906264af285fd57b1af">&#9670;&nbsp;</a></span>nUniqueSysts</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int splineFDBase::nUniqueSysts</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00102">102</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="a78508c5d0d4ef09457beb723dc796208"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78508c5d0d4ef09457beb723dc796208">&#9670;&nbsp;</a></span>SampleNames</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; splineFDBase::SampleNames</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00081">81</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="af71b65713518f42e59c543dbad5dab70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af71b65713518f42e59c543dbad5dab70">&#9670;&nbsp;</a></span>SplineBinning</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt; std::vector&lt;TAxis*&gt; &gt; &gt; splineFDBase::SplineBinning</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00088">88</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="a5619363447e607cd835c46d601b10675"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5619363447e607cd835c46d601b10675">&#9670;&nbsp;</a></span>SplineFileParPrefixNames</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt;std::string&gt; &gt; splineFDBase::SplineFileParPrefixNames</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00089">89</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="aabc74a6dd8b13fc6925e975bf5f92cff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabc74a6dd8b13fc6925e975bf5f92cff">&#9670;&nbsp;</a></span>SplineInterpolationTypes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt;<a class="el" href="Structs_8h.html#a6720d732608767153550aebebcf8fbf4">SplineInterpolation</a>&gt; &gt; splineFDBase::SplineInterpolationTypes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>spline interpolation types for each sample. These vectors are from a call to GetSplineInterpolationFromDetID() </p>

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00100">100</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="a6b7aeec6d03dad01975582226b39632b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b7aeec6d03dad01975582226b39632b">&#9670;&nbsp;</a></span>SplineModeVecs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt; std::vector&lt;int&gt; &gt; &gt; splineFDBase::SplineModeVecs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A vector of vectors of the spline modes that a systematic applies to This gets compared against the event mode to figure out if a syst should apply to an event or not </p>

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00093">93</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="a84ec9ea208503053b9735b1cb1bc417d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84ec9ea208503053b9735b1cb1bc417d">&#9670;&nbsp;</a></span>splinevec_Monolith</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classTSpline3__red.html">TSpline3_red</a>* &gt; splineFDBase::splinevec_Monolith</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00114">114</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="a7a564f5748f16d97ebf1e1c300a1cc5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a564f5748f16d97ebf1e1c300a1cc5c">&#9670;&nbsp;</a></span>uniquecoeffindices</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; splineFDBase::uniquecoeffindices</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00112">112</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="ae237cc1c6d97e35bf4f7f64e369a5781"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae237cc1c6d97e35bf4f7f64e369a5781">&#9670;&nbsp;</a></span>uniquesplinevec_Monolith</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; splineFDBase::uniquesplinevec_Monolith</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00130">130</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="aa36e6889d054ad0f86f33a53dd3fe036"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa36e6889d054ad0f86f33a53dd3fe036">&#9670;&nbsp;</a></span>UniqueSystCurrSegment</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; splineFDBase::UniqueSystCurrSegment</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00106">106</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="a3b821b95c2db6063a9baa244b28aeaa6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b821b95c2db6063a9baa244b28aeaa6">&#9670;&nbsp;</a></span>UniqueSystIndices</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; splineFDBase::UniqueSystIndices</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00104">104</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="aacf850f4ec22e4f7338f243999ecc7dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacf850f4ec22e4f7338f243999ecc7dd">&#9670;&nbsp;</a></span>UniqueSystNames</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; splineFDBase::UniqueSystNames</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00103">103</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="a176d42bb137d3c8c3771eb1a4a8440c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a176d42bb137d3c8c3771eb1a4a8440c8">&#9670;&nbsp;</a></span>UniqueSystNKnots</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; splineFDBase::UniqueSystNKnots</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00105">105</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="a5112a1bbd658d3a90c6a785c12aebf34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5112a1bbd658d3a90c6a785c12aebf34">&#9670;&nbsp;</a></span>UniqueSystXPts</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt;<a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>&gt; &gt; splineFDBase::UniqueSystXPts</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00107">107</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="a107c337ce7053208795747a3223f04e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a107c337ce7053208795747a3223f04e1">&#9670;&nbsp;</a></span>weightvec_Monolith</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>&gt; splineFDBase::weightvec_Monolith</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00129">129</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="a00f046c4c64c0aa11334b32b0701a9f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00f046c4c64c0aa11334b32b0701a9f1">&#9670;&nbsp;</a></span>xcoeff_arr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>* splineFDBase::xcoeff_arr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>x coefficients for each spline </p>

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00125">125</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="a891de87b873e079f6bbdb1355a9ff153"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a891de87b873e079f6bbdb1355a9ff153">&#9670;&nbsp;</a></span>xsec</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcovarianceXsec.html">covarianceXsec</a>* splineFDBase::xsec</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to covariance xsec. </p>

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00078">78</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<a id="a324c4b50910454092ba45d945ef57bda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a324c4b50910454092ba45d945ef57bda">&#9670;&nbsp;</a></span>xVarArray</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>* splineFDBase::xVarArray</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Probably need to clear these arrays up at some point. </p>

<p class="definition">Definition at line <a class="el" href="splineFDBase_8h_source.html#l00121">121</a> of file <a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/hosthome/v1.4.0/splines/<a class="el" href="splineFDBase_8h_source.html">splineFDBase.h</a></li>
<li>/hosthome/v1.4.0/splines/<a class="el" href="splineFDBase_8cpp_source.html">splineFDBase.cpp</a></li>
</ul>
</div><!-- contents -->
<footer class="mach3-footer" style="text-align: center;">
    <div style="margin-bottom: 15px;">
        <span style="font-weight: bold;">The MaCh3 Collaboration</span>
    </div>
    <div style="margin-bottom: 10px;">
        <span>Select Software Version: </span>
        <select id="versionSelector" onchange="window.location.href=this.value" style="padding: 5px; border-radius: 4px; border: 1px solid #ccc;">
            <option value="">-- Select --</option>
            <option value="https://mach3-software.github.io/MaCh3/">develop</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.2.0/index.html">v2.2.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.1.0/index.html">v2.1.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.0.0/index.html">v2.0.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.5.0/index.html">v1.5.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.4.0/index.html">v1.4.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.3.0/index.html">v1.3.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.2.0/index.html">v1.2.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.1.0/index.html">v1.1.0</option>
        </select>
    </div>
    <div style="font-size: 0.9em; color: #666; margin-top: 10px;">
        Documentation generated with <a href="https://www.doxygen.nl/" target="_blank" style="color: #666;">Doxygen</a>
    </div>
</footer>
