<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MaCh3: covarianceBase Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="MaCh3.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="mach3logo_small.png"/></td>
  <td id="projectalign">
   <div id="projectname">MaCh3<span id="projectnumber">&#160;1.4.4</span>
   </div>
   <div id="projectbrief">Reference Guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classcovarianceBase-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">covarianceBase Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Base class responsible for handling of systematic error parameters. Capable of using PCA or using adaptive throw matrix.  
 <a href="classcovarianceBase.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="covarianceBase_8h_source.html">covariance/covarianceBase.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for covarianceBase:</div>
<div class="dyncontent">
<div class="center"><img src="classcovarianceBase__inherit__graph.png" border="0" usemap="#acovarianceBase_inherit__map" alt="Inheritance graph"/></div>
<map name="acovarianceBase_inherit__map" id="acovarianceBase_inherit__map">
<area shape="rect" title="Base class responsible for handling of systematic error parameters. Capable of using PCA or using ada..." alt="" coords="169,5,294,31"/>
<area shape="rect" href="classPyCovarianceBase.html" title=" " alt="" coords="5,79,148,104"/>
<area shape="rect" href="classcovarianceOsc.html" title="Class responsible for handling of neutrino oscillation parameters." alt="" coords="173,79,290,104"/>
<area shape="rect" href="classcovarianceXsec.html" title="Class responsible for handling of systematic error parameters with different types defined in the con..." alt="" coords="313,79,437,104"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for covarianceBase:</div>
<div class="dyncontent">
<div class="center"><img src="classcovarianceBase__coll__graph.png" border="0" usemap="#acovarianceBase_coll__map" alt="Collaboration graph"/></div>
<map name="acovarianceBase_coll__map" id="acovarianceBase_coll__map">
<area shape="rect" title="Base class responsible for handling of systematic error parameters. Capable of using PCA or using ada..." alt="" coords="1253,345,1379,370"/>
<area shape="rect" title=" " alt="" coords="458,54,545,79"/>
<area shape="rect" title=" " alt="" coords="887,21,1073,46"/>
<area shape="rect" title=" " alt="" coords="19,47,157,87"/>
<area shape="rect" title=" " alt="" coords="668,271,843,311"/>
<area shape="rect" title=" " alt="" coords="5,333,171,358"/>
<area shape="rect" href="classPCAHandler.html" title="Class responsible for handling Principal Component Analysis (PCA) of covariance matrix." alt="" coords="452,493,551,518"/>
<area shape="rect" href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html" title="Contains information about adaptive covariance matrix ." alt="" coords="359,567,644,593"/>
<area shape="rect" title=" " alt="" coords="891,337,1069,377"/>
<area shape="rect" title=" " alt="" coords="392,345,611,370"/>
<area shape="rect" title=" " alt="" coords="905,402,1055,427"/>
<area shape="rect" title=" " alt="" coords="893,452,1067,492"/>
<area shape="rect" title=" " alt="" coords="867,517,1093,542"/>
<area shape="rect" title=" " alt="" coords="19,530,157,555"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a332cbcc2c262ff3775b56c40724e623e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a332cbcc2c262ff3775b56c40724e623e">covarianceBase</a> (const std::vector&lt; std::string &gt; &amp;YAMLFile, std::string name, double threshold=-1, int <a class="el" href="classcovarianceBase.html#abba75182305d556818c76974a054a17d">FirstPCAdpar</a>=-999, int <a class="el" href="classcovarianceBase.html#a5ebdc744b733656972a15f1657915a3f">LastPCAdpar</a>=-999)</td></tr>
<tr class="memdesc:a332cbcc2c262ff3775b56c40724e623e"><td class="mdescLeft">&#160;</td><td class="mdescRight">ETA - constructor for a YAML file.  <br /></td></tr>
<tr class="separator:a332cbcc2c262ff3775b56c40724e623e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12f3d613f4acccf595599bd6bd6cbeb5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a12f3d613f4acccf595599bd6bd6cbeb5">covarianceBase</a> (std::string name, std::string file, double threshold=-1, int <a class="el" href="classcovarianceBase.html#abba75182305d556818c76974a054a17d">FirstPCAdpar</a>=-999, int <a class="el" href="classcovarianceBase.html#a5ebdc744b733656972a15f1657915a3f">LastPCAdpar</a>=-999)</td></tr>
<tr class="memdesc:a12f3d613f4acccf595599bd6bd6cbeb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">"Usual" constructors from root file  <br /></td></tr>
<tr class="separator:a12f3d613f4acccf595599bd6bd6cbeb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e7a87a1d7e054475b4b921407e0a2d1"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a1e7a87a1d7e054475b4b921407e0a2d1">~covarianceBase</a> ()</td></tr>
<tr class="memdesc:a1e7a87a1d7e054475b4b921407e0a2d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <br /></td></tr>
<tr class="separator:a1e7a87a1d7e054475b4b921407e0a2d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5f28f7294d25cca6334f7033a63596b9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Setters.html#ga5f28f7294d25cca6334f7033a63596b9">setCovMatrix</a> (TMatrixDSym *cov)</td></tr>
<tr class="memdesc:ga5f28f7294d25cca6334f7033a63596b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set covariance matrix.  <br /></td></tr>
<tr class="separator:ga5f28f7294d25cca6334f7033a63596b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f980a259c5952f9ca907832f99ad2a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a9f980a259c5952f9ca907832f99ad2a7">setName</a> (std::string name)</td></tr>
<tr class="memdesc:a9f980a259c5952f9ca907832f99ad2a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set matrix name.  <br /></td></tr>
<tr class="separator:a9f980a259c5952f9ca907832f99ad2a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga086ff04fa55c074a2baa6cc63e4f279a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Setters.html#ga086ff04fa55c074a2baa6cc63e4f279a">setParName</a> (int i, std::string name)</td></tr>
<tr class="memdesc:ga086ff04fa55c074a2baa6cc63e4f279a"><td class="mdescLeft">&#160;</td><td class="mdescRight">change parameter name  <br /></td></tr>
<tr class="separator:ga086ff04fa55c074a2baa6cc63e4f279a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga978483dabf04239f1c475516b5cdab7f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Setters.html#ga978483dabf04239f1c475516b5cdab7f">setSingleParameter</a> (const int parNo, const double parVal)</td></tr>
<tr class="separator:ga978483dabf04239f1c475516b5cdab7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaae3b226cbd6a4c03f291620ebd018bc9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Setters.html#gaae3b226cbd6a4c03f291620ebd018bc9">setPar</a> (const int i, const double val)</td></tr>
<tr class="memdesc:gaae3b226cbd6a4c03f291620ebd018bc9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set all the covariance matrix parameters to a user-defined value.  <br /></td></tr>
<tr class="separator:gaae3b226cbd6a4c03f291620ebd018bc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6701f97eb624cef70998773333f96757"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Setters.html#ga6701f97eb624cef70998773333f96757">setParCurrProp</a> (const int i, const double val)</td></tr>
<tr class="memdesc:ga6701f97eb624cef70998773333f96757"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set current parameter value.  <br /></td></tr>
<tr class="separator:ga6701f97eb624cef70998773333f96757"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9f78e4f0ae493e78accc8374cdf38b6f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Setters.html#ga9f78e4f0ae493e78accc8374cdf38b6f">setParProp</a> (const int i, const double val)</td></tr>
<tr class="memdesc:ga9f78e4f0ae493e78accc8374cdf38b6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set proposed parameter value.  <br /></td></tr>
<tr class="separator:ga9f78e4f0ae493e78accc8374cdf38b6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa4d9eaf56199245332f0b0be2c353944"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Setters.html#gaa4d9eaf56199245332f0b0be2c353944">setParameters</a> (const std::vector&lt; double &gt; &amp;pars={})</td></tr>
<tr class="memdesc:gaa4d9eaf56199245332f0b0be2c353944"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set parameter values using vector, it has to have same size as covariance class.  <br /></td></tr>
<tr class="separator:gaa4d9eaf56199245332f0b0be2c353944"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1e9b4a09866909595a26fb2e1ea94cac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Setters.html#ga1e9b4a09866909595a26fb2e1ea94cac">setFlatPrior</a> (const int i, const bool eL)</td></tr>
<tr class="memdesc:ga1e9b4a09866909595a26fb2e1ea94cac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set if parameter should have flat prior or not.  <br /></td></tr>
<tr class="separator:ga1e9b4a09866909595a26fb2e1ea94cac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae1e0a162d1644691d6113e74c37b9940"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Setters.html#gae1e0a162d1644691d6113e74c37b9940">SetRandomThrow</a> (const int i, const double rand)</td></tr>
<tr class="memdesc:gae1e0a162d1644691d6113e74c37b9940"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set random value useful for debugging/CI.  <br /></td></tr>
<tr class="separator:gae1e0a162d1644691d6113e74c37b9940"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac32b276beb1fa595404bf1b9a62ef9c2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#ac32b276beb1fa595404bf1b9a62ef9c2">GetRandomThrow</a> (const int i)</td></tr>
<tr class="memdesc:ac32b276beb1fa595404bf1b9a62ef9c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get random value useful for debugging/CI.  <br /></td></tr>
<tr class="separator:ac32b276beb1fa595404bf1b9a62ef9c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaae80acab113ac496a9bc56e28f6ae0c9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Setters.html#gaae80acab113ac496a9bc56e28f6ae0c9">SetBranches</a> (TTree &amp;tree, bool SaveProposal=false)</td></tr>
<tr class="memdesc:gaae80acab113ac496a9bc56e28f6ae0c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">set branches for output file  <br /></td></tr>
<tr class="separator:gaae80acab113ac496a9bc56e28f6ae0c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga806cf53a69a35da2426169561f450b85"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Setters.html#ga806cf53a69a35da2426169561f450b85">setStepScale</a> (const double scale)</td></tr>
<tr class="memdesc:ga806cf53a69a35da2426169561f450b85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set global step scale for covariance object.  <br /></td></tr>
<tr class="separator:ga806cf53a69a35da2426169561f450b85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga21b912b31c888a2bdae9145a0c10a614"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Setters.html#ga21b912b31c888a2bdae9145a0c10a614">setIndivStepScale</a> (const int ParameterIndex, const double StepScale)</td></tr>
<tr class="memdesc:ga21b912b31c888a2bdae9145a0c10a614"><td class="mdescLeft">&#160;</td><td class="mdescRight">DB Function to set fIndivStepScale from a vector (Can be used from execs and inside covariance constructors)  <br /></td></tr>
<tr class="separator:ga21b912b31c888a2bdae9145a0c10a614"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga57fcbce7dbdc47e3b6ff9344c215ed9a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Setters.html#ga57fcbce7dbdc47e3b6ff9344c215ed9a">setIndivStepScale</a> (const std::vector&lt; double &gt; &amp;stepscale)</td></tr>
<tr class="memdesc:ga57fcbce7dbdc47e3b6ff9344c215ed9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">DB Function to set fIndivStepScale from a vector (Can be used from execs and inside covariance constructors)  <br /></td></tr>
<tr class="separator:ga57fcbce7dbdc47e3b6ff9344c215ed9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga340fbee1b5d97897431f2b0222f85337"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Setters.html#ga340fbee1b5d97897431f2b0222f85337">setPrintLength</a> (const unsigned int PriLen)</td></tr>
<tr class="memdesc:ga340fbee1b5d97897431f2b0222f85337"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: In case someone really want to change this.  <br /></td></tr>
<tr class="separator:ga340fbee1b5d97897431f2b0222f85337"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab36f40d40f4747718c98d368c04f41b7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#ab36f40d40f4747718c98d368c04f41b7">SaveUpdatedMatrixConfig</a> ()</td></tr>
<tr class="memdesc:ab36f40d40f4747718c98d368c04f41b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: After step scale, prefit etc. value were modified save this modified config.  <br /></td></tr>
<tr class="separator:ab36f40d40f4747718c98d368c04f41b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4d127ff4761379dd11843523835c4dc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#af4d127ff4761379dd11843523835c4dc">throwParProp</a> (const double mag=1.)</td></tr>
<tr class="memdesc:af4d127ff4761379dd11843523835c4dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Throw the proposed parameter by mag sigma. Should really just have the user specify this throw by having argument double.  <br /></td></tr>
<tr class="separator:af4d127ff4761379dd11843523835c4dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e92a9db846d956473efbe5712c71d31"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a4e92a9db846d956473efbe5712c71d31">throwParCurr</a> (const double mag=1.)</td></tr>
<tr class="memdesc:a4e92a9db846d956473efbe5712c71d31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to throw the current parameter by mag sigma. Can study bias in MCMC with this; put different starting parameters.  <br /></td></tr>
<tr class="separator:a4e92a9db846d956473efbe5712c71d31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5d82895bcbae7773b6813c02cf2f485"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#aa5d82895bcbae7773b6813c02cf2f485">throwParameters</a> ()</td></tr>
<tr class="memdesc:aa5d82895bcbae7773b6813c02cf2f485"><td class="mdescLeft">&#160;</td><td class="mdescRight">Throw the parameters according to the covariance matrix. This shouldn't be used in MCMC code ase it can break Detailed Balance;.  <br /></td></tr>
<tr class="separator:aa5d82895bcbae7773b6813c02cf2f485"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a867bff214af25bba68f921eaea8b5cdd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a867bff214af25bba68f921eaea8b5cdd">RandomConfiguration</a> ()</td></tr>
<tr class="memdesc:a867bff214af25bba68f921eaea8b5cdd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Randomly throw the parameters in their 1 sigma range.  <br /></td></tr>
<tr class="separator:a867bff214af25bba68f921eaea8b5cdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0e457ad3d7acfdc2b29b14a8553eee2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#ab0e457ad3d7acfdc2b29b14a8553eee2">CheckBounds</a> () const <a class="el" href="Core_8h.html#a2abc3d82639661d84964bed9e2df0e68">_noexcept_</a></td></tr>
<tr class="memdesc:ab0e457ad3d7acfdc2b29b14a8553eee2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if parameters were proposed outside physical boundary.  <br /></td></tr>
<tr class="separator:ab0e457ad3d7acfdc2b29b14a8553eee2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5aadbf9d0a50062ae401136dc6e60ffb"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a5aadbf9d0a50062ae401136dc6e60ffb">CalcLikelihood</a> () const <a class="el" href="Core_8h.html#a2abc3d82639661d84964bed9e2df0e68">_noexcept_</a></td></tr>
<tr class="memdesc:a5aadbf9d0a50062ae401136dc6e60ffb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calc penalty term based on inverted covariance matrix.  <br /></td></tr>
<tr class="separator:a5aadbf9d0a50062ae401136dc6e60ffb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ee2fbfe0f1ac86c8c129095638e0f76"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a9ee2fbfe0f1ac86c8c129095638e0f76">GetLikelihood</a> ()</td></tr>
<tr class="memdesc:a9ee2fbfe0f1ac86c8c129095638e0f76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return CalcLikelihood if some params were thrown out of boundary return <em>LARGE_LOGL</em>  <br /></td></tr>
<tr class="separator:a9ee2fbfe0f1ac86c8c129095638e0f76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5968a05b1139d72344ea08b8cd6c76c6"><td class="memItemLeft" align="right" valign="top">TMatrixDSym *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a5968a05b1139d72344ea08b8cd6c76c6">getCovMatrix</a> ()</td></tr>
<tr class="memdesc:a5968a05b1139d72344ea08b8cd6c76c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return covariance matrix.  <br /></td></tr>
<tr class="separator:a5968a05b1139d72344ea08b8cd6c76c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12221dba3e93480881d1195482ef6d87"><td class="memItemLeft" align="right" valign="top">TMatrixDSym *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a12221dba3e93480881d1195482ef6d87">getInvCovMatrix</a> ()</td></tr>
<tr class="memdesc:a12221dba3e93480881d1195482ef6d87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return inverted covariance matrix.  <br /></td></tr>
<tr class="separator:a12221dba3e93480881d1195482ef6d87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d3e0859942a48136bc446b0b6d5012a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a5d3e0859942a48136bc446b0b6d5012a">GetInvCovMatrix</a> (const int i, const int j)</td></tr>
<tr class="memdesc:a5d3e0859942a48136bc446b0b6d5012a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return inverted covariance matrix.  <br /></td></tr>
<tr class="separator:a5d3e0859942a48136bc446b0b6d5012a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6e490033dbd3db0965eaa443811f355"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#aa6e490033dbd3db0965eaa443811f355">GetCorrThrows</a> (const int i)</td></tr>
<tr class="memdesc:aa6e490033dbd3db0965eaa443811f355"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return correlated throws.  <br /></td></tr>
<tr class="separator:aa6e490033dbd3db0965eaa443811f355"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0278e73361d955ab1e39984552acb3b7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a0278e73361d955ab1e39984552acb3b7">getFlatPrior</a> (const int i)</td></tr>
<tr class="memdesc:a0278e73361d955ab1e39984552acb3b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get if param has flat prior or not.  <br /></td></tr>
<tr class="separator:a0278e73361d955ab1e39984552acb3b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafae8445e4cdef85c27c4863adb9e7fe4"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Setters.html#gafae8445e4cdef85c27c4863adb9e7fe4">getName</a> () const</td></tr>
<tr class="memdesc:gafae8445e4cdef85c27c4863adb9e7fe4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get name of covariance.  <br /></td></tr>
<tr class="separator:gafae8445e4cdef85c27c4863adb9e7fe4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab4ac97e0e881db5ca0f28cdeba39e228"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Setters.html#gab4ac97e0e881db5ca0f28cdeba39e228">GetParName</a> (const int i) const</td></tr>
<tr class="memdesc:gab4ac97e0e881db5ca0f28cdeba39e228"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get name of covariance.  <br /></td></tr>
<tr class="separator:gab4ac97e0e881db5ca0f28cdeba39e228"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga295f5fe63911d4c704b73e0b0c8c7971"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Setters.html#ga295f5fe63911d4c704b73e0b0c8c7971">GetParFancyName</a> (const int i) const</td></tr>
<tr class="memdesc:ga295f5fe63911d4c704b73e0b0c8c7971"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get fancy name of the Parameter.  <br /></td></tr>
<tr class="separator:ga295f5fe63911d4c704b73e0b0c8c7971"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa52b2765d3e7ae504af20861bedafa4e"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Setters.html#gaa52b2765d3e7ae504af20861bedafa4e">getInputFile</a> () const</td></tr>
<tr class="memdesc:gaa52b2765d3e7ae504af20861bedafa4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get name of input file.  <br /></td></tr>
<tr class="separator:gaa52b2765d3e7ae504af20861bedafa4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga279d5470e3f83ec53a6c2dfce77de537"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Setters.html#ga279d5470e3f83ec53a6c2dfce77de537">getDiagonalError</a> (const int i) const</td></tr>
<tr class="memdesc:ga279d5470e3f83ec53a6c2dfce77de537"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get diagonal error for ith parameter.  <br /></td></tr>
<tr class="separator:ga279d5470e3f83ec53a6c2dfce77de537"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8302ee285a54445832506fcd0a1bf274"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Setters.html#ga8302ee285a54445832506fcd0a1bf274">GetError</a> (const int i) const</td></tr>
<tr class="memdesc:ga8302ee285a54445832506fcd0a1bf274"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the error for the ith parameter.  <br /></td></tr>
<tr class="separator:ga8302ee285a54445832506fcd0a1bf274"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0993a1ea6c5b06ba834e9e70af87ee9e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a0993a1ea6c5b06ba834e9e70af87ee9e">resetIndivStepScale</a> ()</td></tr>
<tr class="memdesc:a0993a1ea6c5b06ba834e9e70af87ee9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adaptive Step Tuning Stuff.  <br /></td></tr>
<tr class="separator:a0993a1ea6c5b06ba834e9e70af87ee9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a715900cc67fcc598090399ee931938e9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a715900cc67fcc598090399ee931938e9">initialiseAdaption</a> (const YAML::Node &amp;adapt_manager)</td></tr>
<tr class="memdesc:a715900cc67fcc598090399ee931938e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise adaptive MCMC.  <br /></td></tr>
<tr class="separator:a715900cc67fcc598090399ee931938e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4c26e3f2a727a39e9db7ed88e72ac38"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#ae4c26e3f2a727a39e9db7ed88e72ac38">saveAdaptiveToFile</a> (const TString &amp;outFileName, const TString &amp;systematicName)</td></tr>
<tr class="memdesc:ae4c26e3f2a727a39e9db7ed88e72ac38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save adaptive throw matrix to file.  <br /></td></tr>
<tr class="separator:ae4c26e3f2a727a39e9db7ed88e72ac38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11075f684f5d2d7eff9c222867e33bb7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a11075f684f5d2d7eff9c222867e33bb7">getDoAdaption</a> ()</td></tr>
<tr class="memdesc:a11075f684f5d2d7eff9c222867e33bb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do we adapt or not.  <br /></td></tr>
<tr class="separator:a11075f684f5d2d7eff9c222867e33bb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af30ca7861452e1446e55700f4b49b608"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#af30ca7861452e1446e55700f4b49b608">setThrowMatrix</a> (TMatrixDSym *cov)</td></tr>
<tr class="memdesc:af30ca7861452e1446e55700f4b49b608"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use new throw matrix, used in adaptive MCMC.  <br /></td></tr>
<tr class="separator:af30ca7861452e1446e55700f4b49b608"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e2d3623bbbf3edee558e04737fe2add"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a7e2d3623bbbf3edee558e04737fe2add">updateThrowMatrix</a> (TMatrixDSym *cov)</td></tr>
<tr class="separator:a7e2d3623bbbf3edee558e04737fe2add"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e5aec8c073799ac9d40e65c0996b2c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a1e5aec8c073799ac9d40e65c0996b2c1">setNumberOfSteps</a> (const int nsteps)</td></tr>
<tr class="memdesc:a1e5aec8c073799ac9d40e65c0996b2c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set number of MCMC step, when running adaptive MCMC it is updated with given frequency. We need number of steps to determine frequency.  <br /></td></tr>
<tr class="separator:a1e5aec8c073799ac9d40e65c0996b2c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa306bea2b30013ca55f2a95b8d16ec42"><td class="memItemLeft" align="right" valign="top">TMatrixDSym *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#aa306bea2b30013ca55f2a95b8d16ec42">getThrowMatrix</a> ()</td></tr>
<tr class="memdesc:aa306bea2b30013ca55f2a95b8d16ec42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get matrix used for step proposal.  <br /></td></tr>
<tr class="separator:aa306bea2b30013ca55f2a95b8d16ec42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15273ab6a1a9b189cca2ac62339a1b66"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a15273ab6a1a9b189cca2ac62339a1b66">GetThrowMatrix</a> (int i, int j)</td></tr>
<tr class="memdesc:a15273ab6a1a9b189cca2ac62339a1b66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get matrix used for step proposal.  <br /></td></tr>
<tr class="separator:a15273ab6a1a9b189cca2ac62339a1b66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a563a904298d0bd5ec5518708396e0e22"><td class="memItemLeft" align="right" valign="top">TMatrixD *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a563a904298d0bd5ec5518708396e0e22">getThrowMatrix_CholDecomp</a> ()</td></tr>
<tr class="memdesc:a563a904298d0bd5ec5518708396e0e22"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the Cholesky decomposition of the throw matrix.  <br /></td></tr>
<tr class="separator:a563a904298d0bd5ec5518708396e0e22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab89b754afc93b63f41070710af4c0f2d"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#ab89b754afc93b63f41070710af4c0f2d">getParameterMeans</a> ()</td></tr>
<tr class="memdesc:ab89b754afc93b63f41070710af4c0f2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the parameter means used in the adaptive handler.  <br /></td></tr>
<tr class="separator:ab89b754afc93b63f41070710af4c0f2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac14fabdb87f5101cdbfcecb8e6b6b811"><td class="memItemLeft" align="right" valign="top">TH2D *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#ac14fabdb87f5101cdbfcecb8e6b6b811">GetCorrelationMatrix</a> ()</td></tr>
<tr class="memdesc:ac14fabdb87f5101cdbfcecb8e6b6b811"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Convert covariance matrix to correlation matrix and return TH2D which can be used for fancy plotting.  <br /></td></tr>
<tr class="separator:ac14fabdb87f5101cdbfcecb8e6b6b811"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa970d7a68497a3765723bf34629f79f7"><td class="memItemLeft" align="right" valign="top">const double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#aa970d7a68497a3765723bf34629f79f7">retPointer</a> (const int iParam)</td></tr>
<tr class="memdesc:aa970d7a68497a3765723bf34629f79f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">DB Pointer return to param position.  <br /></td></tr>
<tr class="separator:aa970d7a68497a3765723bf34629f79f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43c569248e176e14330cd002bfc2bff6"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; double &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a43c569248e176e14330cd002bfc2bff6">getParPropVec</a> ()</td></tr>
<tr class="memdesc:a43c569248e176e14330cd002bfc2bff6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a reference to the proposed parameter values Can be useful if you want to track these without having to copy values using <a class="el" href="classcovarianceBase.html#a63db139faf1e42d7a1c3c3c661c0b7d9" title="Get vector of all proposed parameter values.">getProposed()</a>  <br /></td></tr>
<tr class="separator:a43c569248e176e14330cd002bfc2bff6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87f80dff42b1f82433aaa7f69966343a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a87f80dff42b1f82433aaa7f69966343a">GetNumParams</a> () const</td></tr>
<tr class="memdesc:a87f80dff42b1f82433aaa7f69966343a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get total number of parameters.  <br /></td></tr>
<tr class="separator:a87f80dff42b1f82433aaa7f69966343a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0a231f87266048a3cd2e0032eaf0f30"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#ae0a231f87266048a3cd2e0032eaf0f30">getNominalArray</a> ()</td></tr>
<tr class="memdesc:ae0a231f87266048a3cd2e0032eaf0f30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the prior array for parameters.  <br /></td></tr>
<tr class="separator:ae0a231f87266048a3cd2e0032eaf0f30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3961d4bdb1479609dbc1b01401fb765f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a3961d4bdb1479609dbc1b01401fb765f">getPreFitValues</a> () const</td></tr>
<tr class="memdesc:a3961d4bdb1479609dbc1b01401fb765f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the pre-fit values of the parameters.  <br /></td></tr>
<tr class="separator:a3961d4bdb1479609dbc1b01401fb765f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad047151c0216a32b3967a8a5bceb4eb0"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#ad047151c0216a32b3967a8a5bceb4eb0">getGeneratedValues</a> () const</td></tr>
<tr class="memdesc:ad047151c0216a32b3967a8a5bceb4eb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the generated values of the parameters.  <br /></td></tr>
<tr class="separator:ad047151c0216a32b3967a8a5bceb4eb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63db139faf1e42d7a1c3c3c661c0b7d9"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a63db139faf1e42d7a1c3c3c661c0b7d9">getProposed</a> () const</td></tr>
<tr class="memdesc:a63db139faf1e42d7a1c3c3c661c0b7d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get vector of all proposed parameter values.  <br /></td></tr>
<tr class="separator:a63db139faf1e42d7a1c3c3c661c0b7d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af298d9a2d624b02c4953e735d870fcf5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#af298d9a2d624b02c4953e735d870fcf5">getParProp</a> (const int i) const</td></tr>
<tr class="memdesc:af298d9a2d624b02c4953e735d870fcf5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get proposed parameter value.  <br /></td></tr>
<tr class="separator:af298d9a2d624b02c4953e735d870fcf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a532619abf240021223f48fa73869106b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a532619abf240021223f48fa73869106b">getParCurr</a> (const int i) const</td></tr>
<tr class="memdesc:a532619abf240021223f48fa73869106b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get current parameter value.  <br /></td></tr>
<tr class="separator:a532619abf240021223f48fa73869106b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add825b13bf6604725577cb229f8372d8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#add825b13bf6604725577cb229f8372d8">getParInit</a> (const int i) const</td></tr>
<tr class="memdesc:add825b13bf6604725577cb229f8372d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get prior parameter value.  <br /></td></tr>
<tr class="separator:add825b13bf6604725577cb229f8372d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bf31f7d7a5e24c49d4157d411080dbf"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a5bf31f7d7a5e24c49d4157d411080dbf">getNominal</a> (const int i)</td></tr>
<tr class="memdesc:a5bf31f7d7a5e24c49d4157d411080dbf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return generated value, although is virtual so class inheriting might actual get prior not generated.  <br /></td></tr>
<tr class="separator:a5bf31f7d7a5e24c49d4157d411080dbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80262f5ee8ecb5b6195f188787b47f13"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a80262f5ee8ecb5b6195f188787b47f13">GetGenerated</a> (const int i) const</td></tr>
<tr class="memdesc:a80262f5ee8ecb5b6195f188787b47f13"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return generated value for a given parameter.  <br /></td></tr>
<tr class="separator:a80262f5ee8ecb5b6195f188787b47f13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a350821c0cf735a32934c6b27b87c5e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a9a350821c0cf735a32934c6b27b87c5e">GetUpperBound</a> (const int i) const</td></tr>
<tr class="memdesc:a9a350821c0cf735a32934c6b27b87c5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get upper parameter bound in which it is physically valid.  <br /></td></tr>
<tr class="separator:a9a350821c0cf735a32934c6b27b87c5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fa216c45b8e66e15091cffcefcc85ce"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a2fa216c45b8e66e15091cffcefcc85ce">GetLowerBound</a> (const int i) const</td></tr>
<tr class="memdesc:a2fa216c45b8e66e15091cffcefcc85ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get lower parameter bound in which it is physically valid.  <br /></td></tr>
<tr class="separator:a2fa216c45b8e66e15091cffcefcc85ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60159e8c0428a9b83187a28ce56f1c9e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a60159e8c0428a9b83187a28ce56f1c9e">GetIndivStepScale</a> (const int ParameterIndex) const</td></tr>
<tr class="memdesc:a60159e8c0428a9b83187a28ce56f1c9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get individual step scale for selected parameter.  <br /></td></tr>
<tr class="separator:a60159e8c0428a9b83187a28ce56f1c9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1811a06eb22c5d76e3642085706fbaa0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a1811a06eb22c5d76e3642085706fbaa0">GetGlobalStepScale</a> () const</td></tr>
<tr class="memdesc:a1811a06eb22c5d76e3642085706fbaa0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get global step scale for covariance object.  <br /></td></tr>
<tr class="separator:a1811a06eb22c5d76e3642085706fbaa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e29910a1706f60db5f615b3b6f05994"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a3e29910a1706f60db5f615b3b6f05994">getParProp_PCA</a> (const int i)</td></tr>
<tr class="memdesc:a3e29910a1706f60db5f615b3b6f05994"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get current parameter value using PCA.  <br /></td></tr>
<tr class="separator:a3e29910a1706f60db5f615b3b6f05994"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4c0edbf1bd150484bc4696480ef9a77"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#af4c0edbf1bd150484bc4696480ef9a77">getParCurr_PCA</a> (const int i)</td></tr>
<tr class="memdesc:af4c0edbf1bd150484bc4696480ef9a77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get current parameter value using PCA.  <br /></td></tr>
<tr class="separator:af4c0edbf1bd150484bc4696480ef9a77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7cb212b7fda7f402629855b58a69cec"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#ab7cb212b7fda7f402629855b58a69cec">isParameterFixedPCA</a> (const int i)</td></tr>
<tr class="memdesc:ab7cb212b7fda7f402629855b58a69cec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is parameter fixed in PCA base or not.  <br /></td></tr>
<tr class="separator:ab7cb212b7fda7f402629855b58a69cec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdcf459e3ef443e93c66d83cde87e238"><td class="memItemLeft" align="right" valign="top">const TMatrixD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#acdcf459e3ef443e93c66d83cde87e238">getTransferMatrix</a> ()</td></tr>
<tr class="memdesc:acdcf459e3ef443e93c66d83cde87e238"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get transfer matrix allowing to go from PCA base to normal base.  <br /></td></tr>
<tr class="separator:acdcf459e3ef443e93c66d83cde87e238"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1b0e5f25843ee77ec1c6094856cda27"><td class="memItemLeft" align="right" valign="top">const TMatrixD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#ad1b0e5f25843ee77ec1c6094856cda27">getEigenVectors</a> ()</td></tr>
<tr class="memdesc:ad1b0e5f25843ee77ec1c6094856cda27"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get eigen vectors of covariance matrix, only works with PCA.  <br /></td></tr>
<tr class="separator:ad1b0e5f25843ee77ec1c6094856cda27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add3d24e738cde5a2f5ab1b2b377a2afb"><td class="memItemLeft" align="right" valign="top">const TVectorD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#add3d24e738cde5a2f5ab1b2b377a2afb">getEigenValues</a> ()</td></tr>
<tr class="memdesc:add3d24e738cde5a2f5ab1b2b377a2afb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get eigen values for all parameters, if you want for decomposed only parameters use getEigenValuesMaster.  <br /></td></tr>
<tr class="separator:add3d24e738cde5a2f5ab1b2b377a2afb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a104f2d2f1b7f60693bba489ac4e753cc"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a104f2d2f1b7f60693bba489ac4e753cc">getEigenValuesMaster</a> ()</td></tr>
<tr class="memdesc:a104f2d2f1b7f60693bba489ac4e753cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get eigen value of only decomposed parameters, if you want for all parameters use getEigenValues.  <br /></td></tr>
<tr class="separator:a104f2d2f1b7f60693bba489ac4e753cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c9b2ae1b4144448385b47a576e4d07d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a7c9b2ae1b4144448385b47a576e4d07d">setParProp_PCA</a> (const int i, const double value)</td></tr>
<tr class="memdesc:a7c9b2ae1b4144448385b47a576e4d07d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set proposed value for parameter in PCA base.  <br /></td></tr>
<tr class="separator:a7c9b2ae1b4144448385b47a576e4d07d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a593457c3ae0a2d1892846b484833274f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a593457c3ae0a2d1892846b484833274f">setParCurr_PCA</a> (const int i, const double value)</td></tr>
<tr class="memdesc:a593457c3ae0a2d1892846b484833274f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set current value for parameter in PCA base.  <br /></td></tr>
<tr class="separator:a593457c3ae0a2d1892846b484833274f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5888af0b4b6e1d7826fca0f6777bf3ae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a5888af0b4b6e1d7826fca0f6777bf3ae">setParameters_PCA</a> (const std::vector&lt; double &gt; &amp;pars)</td></tr>
<tr class="memdesc:a5888af0b4b6e1d7826fca0f6777bf3ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set values for PCA parameters in PCA base.  <br /></td></tr>
<tr class="separator:a5888af0b4b6e1d7826fca0f6777bf3ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a261941a4c06e5d875174d8769a4d02f1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a261941a4c06e5d875174d8769a4d02f1">getNpars</a> ()</td></tr>
<tr class="memdesc:a261941a4c06e5d875174d8769a4d02f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get number of params which will be different depending if using Eigen decomposition or not.  <br /></td></tr>
<tr class="separator:a261941a4c06e5d875174d8769a4d02f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a925903433ed900714d2930b5db338214"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a925903433ed900714d2930b5db338214">printNominal</a> () const</td></tr>
<tr class="memdesc:a925903433ed900714d2930b5db338214"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print prior value for every parameter.  <br /></td></tr>
<tr class="separator:a925903433ed900714d2930b5db338214"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae992ca06f3313a7e5f9584ac1798e59f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#ae992ca06f3313a7e5f9584ac1798e59f">printNominalCurrProp</a> () const</td></tr>
<tr class="memdesc:ae992ca06f3313a7e5f9584ac1798e59f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print prior, current and proposed value for each parameter.  <br /></td></tr>
<tr class="separator:ae992ca06f3313a7e5f9584ac1798e59f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18ed4e7527f25c3c80eff28139267abd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a18ed4e7527f25c3c80eff28139267abd">printPars</a> () const</td></tr>
<tr class="separator:a18ed4e7527f25c3c80eff28139267abd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6666769aa222368338d943826122bb4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#ac6666769aa222368338d943826122bb4">printIndivStepScale</a> () const</td></tr>
<tr class="memdesc:ac6666769aa222368338d943826122bb4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print step scale for each parameter.  <br /></td></tr>
<tr class="separator:ac6666769aa222368338d943826122bb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95c7ca23995af579cfa7f199833fe24a"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a95c7ca23995af579cfa7f199833fe24a">proposeStep</a> ()</td></tr>
<tr class="memdesc:a95c7ca23995af579cfa7f199833fe24a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a new proposed state.  <br /></td></tr>
<tr class="separator:a95c7ca23995af579cfa7f199833fe24a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d58b8e8ac3b2a8f1c6867e8b6cd7ff8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a8d58b8e8ac3b2a8f1c6867e8b6cd7ff8">randomize</a> () <a class="el" href="Core_8h.html#a2abc3d82639661d84964bed9e2df0e68">_noexcept_</a></td></tr>
<tr class="memdesc:a8d58b8e8ac3b2a8f1c6867e8b6cd7ff8"><td class="mdescLeft">&#160;</td><td class="mdescRight">"Randomize" the parameters in the covariance class for the proposed step. Used the proposal kernel and the current parameter value to set proposed step  <br /></td></tr>
<tr class="separator:a8d58b8e8ac3b2a8f1c6867e8b6cd7ff8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a044a1c9e5642d9f2f7e713999898a2f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a044a1c9e5642d9f2f7e713999898a2f8">CorrelateSteps</a> () <a class="el" href="Core_8h.html#a2abc3d82639661d84964bed9e2df0e68">_noexcept_</a></td></tr>
<tr class="memdesc:a044a1c9e5642d9f2f7e713999898a2f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use Cholesky throw matrix for better step proposal.  <br /></td></tr>
<tr class="separator:a044a1c9e5642d9f2f7e713999898a2f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54712c01de98adcaaa0ecb5a650a3457"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a54712c01de98adcaaa0ecb5a650a3457">acceptStep</a> () <a class="el" href="Core_8h.html#a2abc3d82639661d84964bed9e2df0e68">_noexcept_</a></td></tr>
<tr class="memdesc:a54712c01de98adcaaa0ecb5a650a3457"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accepted this step.  <br /></td></tr>
<tr class="separator:a54712c01de98adcaaa0ecb5a650a3457"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb2d1a39cd2bd160257bc9e34e32df4c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#adb2d1a39cd2bd160257bc9e34e32df4c">toggleFixAllParameters</a> ()</td></tr>
<tr class="memdesc:adb2d1a39cd2bd160257bc9e34e32df4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">fix parameters at prior values  <br /></td></tr>
<tr class="separator:adb2d1a39cd2bd160257bc9e34e32df4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafbbdc05b87df882dc341e20fe870603"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#aafbbdc05b87df882dc341e20fe870603">toggleFixParameter</a> (const int i)</td></tr>
<tr class="memdesc:aafbbdc05b87df882dc341e20fe870603"><td class="mdescLeft">&#160;</td><td class="mdescRight">fix parameter at prior values  <br /></td></tr>
<tr class="separator:aafbbdc05b87df882dc341e20fe870603"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41cc8dd2185af7cee380f3c6d463e5a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a41cc8dd2185af7cee380f3c6d463e5a4">toggleFixParameter</a> (const std::string &amp;name)</td></tr>
<tr class="memdesc:a41cc8dd2185af7cee380f3c6d463e5a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fix parameter at prior values.  <br /></td></tr>
<tr class="separator:a41cc8dd2185af7cee380f3c6d463e5a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76cad7ebfd2ca8c4f1a8b69e0153436e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a76cad7ebfd2ca8c4f1a8b69e0153436e">isParameterFixed</a> (const int i) const</td></tr>
<tr class="memdesc:a76cad7ebfd2ca8c4f1a8b69e0153436e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is parameter fixed or not.  <br /></td></tr>
<tr class="separator:a76cad7ebfd2ca8c4f1a8b69e0153436e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedb669ab47a5c4e610dfd12b2ffcc2ab"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#aedb669ab47a5c4e610dfd12b2ffcc2ab">isParameterFixed</a> (const std::string &amp;name) const</td></tr>
<tr class="memdesc:aedb669ab47a5c4e610dfd12b2ffcc2ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is parameter fixed or not.  <br /></td></tr>
<tr class="separator:aedb669ab47a5c4e610dfd12b2ffcc2ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ac3a458097817eca534c23554a7635b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a8ac3a458097817eca534c23554a7635b">ConstructPCA</a> ()</td></tr>
<tr class="memdesc:a8ac3a458097817eca534c23554a7635b"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Calculate eigen values, prepare transition matrices and remove param based on defined threshold.  <br /></td></tr>
<tr class="separator:a8ac3a458097817eca534c23554a7635b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30f3f34243be0f6bc901e525497e7f56"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a30f3f34243be0f6bc901e525497e7f56">IsPCA</a> ()</td></tr>
<tr class="memdesc:a30f3f34243be0f6bc901e525497e7f56"><td class="mdescLeft">&#160;</td><td class="mdescRight">is PCA, can use to query e.g. LLH scans  <br /></td></tr>
<tr class="separator:a30f3f34243be0f6bc901e525497e7f56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43367db263b2607232077410f27b1146"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a43367db263b2607232077410f27b1146">MatrixVectorMulti</a> (double *<a class="el" href="Core_8h.html#ab6a7e23420f0bcfb04f42f45f8283101">_restrict_</a> VecMulti, double **<a class="el" href="Core_8h.html#ab6a7e23420f0bcfb04f42f45f8283101">_restrict_</a> matrix, const double *<a class="el" href="Core_8h.html#ab6a7e23420f0bcfb04f42f45f8283101">_restrict_</a> vector, const int n) const</td></tr>
<tr class="memdesc:a43367db263b2607232077410f27b1146"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Custom function to perform multiplication of matrix and vector with multithreading.  <br /></td></tr>
<tr class="separator:a43367db263b2607232077410f27b1146"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29d3a7af51740c17ae5002b579923446"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a29d3a7af51740c17ae5002b579923446">MatrixVectorMultiSingle</a> (double **<a class="el" href="Core_8h.html#ab6a7e23420f0bcfb04f42f45f8283101">_restrict_</a> matrix, const double *<a class="el" href="Core_8h.html#ab6a7e23420f0bcfb04f42f45f8283101">_restrict_</a> vector, const int Length, const int i) const</td></tr>
<tr class="memdesc:a29d3a7af51740c17ae5002b579923446"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Custom function to perform multiplication of matrix and single element which is thread safe.  <br /></td></tr>
<tr class="separator:a29d3a7af51740c17ae5002b579923446"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61936f5c39ad7902624222fc49ad1362"><td class="memItemLeft" align="right" valign="top">YAML::Node&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a61936f5c39ad7902624222fc49ad1362">GetConfig</a> () const</td></tr>
<tr class="memdesc:a61936f5c39ad7902624222fc49ad1362"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter to return a copy of the YAML node.  <br /></td></tr>
<tr class="separator:a61936f5c39ad7902624222fc49ad1362"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a2960c489f6aafdb5a2291e1a48b14e9a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a2960c489f6aafdb5a2291e1a48b14e9a">init</a> (std::string name, std::string file)</td></tr>
<tr class="memdesc:a2960c489f6aafdb5a2291e1a48b14e9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialisation of the class using matrix from root file.  <br /></td></tr>
<tr class="separator:a2960c489f6aafdb5a2291e1a48b14e9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acec1e1c7fd83d21e1ad55a03acfeb8c4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#acec1e1c7fd83d21e1ad55a03acfeb8c4">init</a> (const std::vector&lt; std::string &gt; &amp;YAMLFile)</td></tr>
<tr class="memdesc:acec1e1c7fd83d21e1ad55a03acfeb8c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialisation of the class using config.  <br /></td></tr>
<tr class="separator:acec1e1c7fd83d21e1ad55a03acfeb8c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75b5553823335bb82026ff46369fb67e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a75b5553823335bb82026ff46369fb67e">ReserveMemory</a> (const int <a class="el" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>)</td></tr>
<tr class="memdesc:a75b5553823335bb82026ff46369fb67e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise vectors with parameters information.  <br /></td></tr>
<tr class="separator:a75b5553823335bb82026ff46369fb67e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2850c8e2f2d4acfe322b0ebe65b07cf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#ae2850c8e2f2d4acfe322b0ebe65b07cf">MakePosDef</a> (TMatrixDSym *cov=nullptr)</td></tr>
<tr class="memdesc:ae2850c8e2f2d4acfe322b0ebe65b07cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make matrix positive definite by adding small values to diagonal, necessary for inverting matrix.  <br /></td></tr>
<tr class="separator:ae2850c8e2f2d4acfe322b0ebe65b07cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a709e1c6c58618cf65400eef1741cc7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a8a709e1c6c58618cf65400eef1741cc7">makeClosestPosDef</a> (TMatrixDSym *cov)</td></tr>
<tr class="memdesc:a8a709e1c6c58618cf65400eef1741cc7"><td class="mdescLeft">&#160;</td><td class="mdescRight">HW: Finds closest possible positive definite matrix in Frobenius Norm ||.||_frob Where ||X||_frob=sqrt[sum_ij(x_ij^2)] (basically just turns an n,n matrix into vector in n^2 space then does Euclidean norm)  <br /></td></tr>
<tr class="separator:a8a709e1c6c58618cf65400eef1741cc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ab3d89b7fe6103ae6f750c984bcefc8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a5ab3d89b7fe6103ae6f750c984bcefc8">setThrowMatrixFromFile</a> (const std::string &amp;matrix_file_name, const std::string &amp;matrix_name, const std::string &amp;means_name)</td></tr>
<tr class="memdesc:a5ab3d89b7fe6103ae6f750c984bcefc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">sets throw matrix from a file  <br /></td></tr>
<tr class="separator:a5ab3d89b7fe6103ae6f750c984bcefc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50ce8ebb96ebd64190dc37e4bf950a9b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a50ce8ebb96ebd64190dc37e4bf950a9b">updateAdaptiveCovariance</a> ()</td></tr>
<tr class="memdesc:a50ce8ebb96ebd64190dc37e4bf950a9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method to update adaptive MCMC <a class="el" href="citelist.html#CITEREF_haario2001adaptive">[10]</a>.  <br /></td></tr>
<tr class="separator:a50ce8ebb96ebd64190dc37e4bf950a9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c83deb921c0ee4107645752ff84e91b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a6c83deb921c0ee4107645752ff84e91b">AppliesToDetID</a> (const int SystIndex, const std::string &amp;DetID) const</td></tr>
<tr class="memdesc:a6c83deb921c0ee4107645752ff84e91b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if parameter is affecting given det ID.  <br /></td></tr>
<tr class="separator:a6c83deb921c0ee4107645752ff84e91b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a5451d4189a9fb7591c8ce728852ba82e"><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a5451d4189a9fb7591c8ce728852ba82e">inputFile</a></td></tr>
<tr class="memdesc:a5451d4189a9fb7591c8ce728852ba82e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The input root file we read in.  <br /></td></tr>
<tr class="separator:a5451d4189a9fb7591c8ce728852ba82e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26618d3f5633b33ce20e38ce8261b3ee"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a26618d3f5633b33ce20e38ce8261b3ee">matrixName</a></td></tr>
<tr class="memdesc:a26618d3f5633b33ce20e38ce8261b3ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name of cov matrix.  <br /></td></tr>
<tr class="separator:a26618d3f5633b33ce20e38ce8261b3ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c3fe8db34c06299fd1633951ac00937"><td class="memItemLeft" align="right" valign="top">TMatrixDSym *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a6c3fe8db34c06299fd1633951ac00937">covMatrix</a></td></tr>
<tr class="memdesc:a6c3fe8db34c06299fd1633951ac00937"><td class="mdescLeft">&#160;</td><td class="mdescRight">The covariance matrix.  <br /></td></tr>
<tr class="separator:a6c3fe8db34c06299fd1633951ac00937"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35c7dc7817eaf4058e9775b6bc792ebc"><td class="memItemLeft" align="right" valign="top">TMatrixDSym *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a35c7dc7817eaf4058e9775b6bc792ebc">invCovMatrix</a></td></tr>
<tr class="memdesc:a35c7dc7817eaf4058e9775b6bc792ebc"><td class="mdescLeft">&#160;</td><td class="mdescRight">The inverse covariance matrix.  <br /></td></tr>
<tr class="separator:a35c7dc7817eaf4058e9775b6bc792ebc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5973f7f446d6058af9bcd006a6cf562d"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a5973f7f446d6058af9bcd006a6cf562d">InvertCovMatrix</a></td></tr>
<tr class="memdesc:a5973f7f446d6058af9bcd006a6cf562d"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Same as above but much faster as TMatrixDSym cache miss.  <br /></td></tr>
<tr class="separator:a5973f7f446d6058af9bcd006a6cf562d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0704c430bdc8e87fd6f03f01b2ab00df"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::unique_ptr&lt; TRandom3 &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a0704c430bdc8e87fd6f03f01b2ab00df">random_number</a></td></tr>
<tr class="memdesc:a0704c430bdc8e87fd6f03f01b2ab00df"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Set Random numbers for each thread so each thread has different seed.  <br /></td></tr>
<tr class="separator:a0704c430bdc8e87fd6f03f01b2ab00df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a705e648220c06083cd1acc5fba4f2ef7"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a705e648220c06083cd1acc5fba4f2ef7">randParams</a></td></tr>
<tr class="memdesc:a705e648220c06083cd1acc5fba4f2ef7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Random number taken from gaussian around prior error used for corr_throw.  <br /></td></tr>
<tr class="separator:a705e648220c06083cd1acc5fba4f2ef7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b70de3f098aae1d537d80bac5969d88"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a7b70de3f098aae1d537d80bac5969d88">corr_throw</a></td></tr>
<tr class="memdesc:a7b70de3f098aae1d537d80bac5969d88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Result of multiplication of Cholesky matrix and randParams.  <br /></td></tr>
<tr class="separator:a7b70de3f098aae1d537d80bac5969d88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0088413d6a15d12cd34ec06166302f5c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a0088413d6a15d12cd34ec06166302f5c">_fGlobalStepScale</a></td></tr>
<tr class="memdesc:a0088413d6a15d12cd34ec06166302f5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global step scale applied to all params in this class.  <br /></td></tr>
<tr class="separator:a0088413d6a15d12cd34ec06166302f5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d821ce805f2426fe95549170866821f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a8d821ce805f2426fe95549170866821f">PrintLength</a></td></tr>
<tr class="memdesc:a8d821ce805f2426fe95549170866821f"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: This is used when printing parameters, sometimes we have super long parameters name, we want to flexibly adjust couts.  <br /></td></tr>
<tr class="separator:a8d821ce805f2426fe95549170866821f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e502d80fd2c30a7da4fe75a3e05b0da"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a3e502d80fd2c30a7da4fe75a3e05b0da">_fNames</a></td></tr>
<tr class="memdesc:a3e502d80fd2c30a7da4fe75a3e05b0da"><td class="mdescLeft">&#160;</td><td class="mdescRight">ETA _fNames is set automatically in the covariance class to be something like xsec_i, this is currently to make things compatible with the Diagnostic tools.  <br /></td></tr>
<tr class="separator:a3e502d80fd2c30a7da4fe75a3e05b0da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a973671386a2f8ea924f25f8f5404654c"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a973671386a2f8ea924f25f8f5404654c">_fFancyNames</a></td></tr>
<tr class="memdesc:a973671386a2f8ea924f25f8f5404654c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fancy name for example rather than xsec_0 it is MAQE, useful for human reading.  <br /></td></tr>
<tr class="separator:a973671386a2f8ea924f25f8f5404654c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a933ff3dc0af99629ba3582a5d9d89d23"><td class="memItemLeft" align="right" valign="top">YAML::Node&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a933ff3dc0af99629ba3582a5d9d89d23">_fYAMLDoc</a></td></tr>
<tr class="memdesc:a933ff3dc0af99629ba3582a5d9d89d23"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores config describing systematics.  <br /></td></tr>
<tr class="separator:a933ff3dc0af99629ba3582a5d9d89d23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5d922f1a4163b38ebc7a3ef21eec376"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a></td></tr>
<tr class="memdesc:ac5d922f1a4163b38ebc7a3ef21eec376"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of systematic parameters.  <br /></td></tr>
<tr class="separator:ac5d922f1a4163b38ebc7a3ef21eec376"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7578a2cc2e8e9100fad88310a824cb1c"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a7578a2cc2e8e9100fad88310a824cb1c">_fPreFitValue</a></td></tr>
<tr class="memdesc:a7578a2cc2e8e9100fad88310a824cb1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parameter value dictated by the prior model. Based on it penalty term is calculated.  <br /></td></tr>
<tr class="separator:a7578a2cc2e8e9100fad88310a824cb1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae70f51df3976975b2dc78fd3bfc28b65"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#ae70f51df3976975b2dc78fd3bfc28b65">_fCurrVal</a></td></tr>
<tr class="memdesc:ae70f51df3976975b2dc78fd3bfc28b65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current value of the parameter.  <br /></td></tr>
<tr class="separator:ae70f51df3976975b2dc78fd3bfc28b65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12f0eb31a5ef48b014baa11d4ab919e9"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a></td></tr>
<tr class="memdesc:a12f0eb31a5ef48b014baa11d4ab919e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Proposed value of the parameter.  <br /></td></tr>
<tr class="separator:a12f0eb31a5ef48b014baa11d4ab919e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b753f52711600a9f8d648531d95b044"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a9b753f52711600a9f8d648531d95b044">_fGenerated</a></td></tr>
<tr class="memdesc:a9b753f52711600a9f8d648531d95b044"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generated value of the parameter.  <br /></td></tr>
<tr class="separator:a9b753f52711600a9f8d648531d95b044"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34f877fc160b4a93a3aab1b3a8977858"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a34f877fc160b4a93a3aab1b3a8977858">_fError</a></td></tr>
<tr class="memdesc:a34f877fc160b4a93a3aab1b3a8977858"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prior error on the parameter.  <br /></td></tr>
<tr class="separator:a34f877fc160b4a93a3aab1b3a8977858"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f1d94838f188cc85c4f82557c0b0b66"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a8f1d94838f188cc85c4f82557c0b0b66">_fLowBound</a></td></tr>
<tr class="memdesc:a8f1d94838f188cc85c4f82557c0b0b66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lowest physical bound, parameter will not be able to go beyond it.  <br /></td></tr>
<tr class="separator:a8f1d94838f188cc85c4f82557c0b0b66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31e636cb6de871bd0c2c8e7e299df9e7"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a31e636cb6de871bd0c2c8e7e299df9e7">_fUpBound</a></td></tr>
<tr class="memdesc:a31e636cb6de871bd0c2c8e7e299df9e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Upper physical bound, parameter will not be able to go beyond it.  <br /></td></tr>
<tr class="separator:a31e636cb6de871bd0c2c8e7e299df9e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cda39026e336a49cef482efd4062561"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a3cda39026e336a49cef482efd4062561">_fIndivStepScale</a></td></tr>
<tr class="memdesc:a3cda39026e336a49cef482efd4062561"><td class="mdescLeft">&#160;</td><td class="mdescRight">Individual step scale used by MCMC algorithm.  <br /></td></tr>
<tr class="separator:a3cda39026e336a49cef482efd4062561"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9c47deb7009bff81210f666e80012eb"><td class="memItemLeft" align="right" valign="top">std::vector&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#ad9c47deb7009bff81210f666e80012eb">_fFlatPrior</a></td></tr>
<tr class="memdesc:ad9c47deb7009bff81210f666e80012eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether to apply flat prior or not.  <br /></td></tr>
<tr class="separator:ad9c47deb7009bff81210f666e80012eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a267523bb0f78c27208000b2856f741da"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; std::string &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a267523bb0f78c27208000b2856f741da">_fDetID</a></td></tr>
<tr class="memdesc:a267523bb0f78c27208000b2856f741da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tells to which samples object param should be applied.  <br /></td></tr>
<tr class="separator:a267523bb0f78c27208000b2856f741da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4b7f96d3e977a0b3307ceecbd0baeb4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a></td></tr>
<tr class="memdesc:ab4b7f96d3e977a0b3307ceecbd0baeb4"><td class="mdescLeft">&#160;</td><td class="mdescRight">perform PCA or not  <br /></td></tr>
<tr class="separator:ab4b7f96d3e977a0b3307ceecbd0baeb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add54ab1ba46b723fa23d7c95dfad671a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#add54ab1ba46b723fa23d7c95dfad671a">eigen_threshold</a></td></tr>
<tr class="memdesc:add54ab1ba46b723fa23d7c95dfad671a"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Threshold based on which we remove parameters in eigen base.  <br /></td></tr>
<tr class="separator:add54ab1ba46b723fa23d7c95dfad671a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac57285a48d41ef764b4c659959a36c2d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#ac57285a48d41ef764b4c659959a36c2d">_fNumParPCA</a></td></tr>
<tr class="memdesc:ac57285a48d41ef764b4c659959a36c2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of parameters in PCA base.  <br /></td></tr>
<tr class="separator:ac57285a48d41ef764b4c659959a36c2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abba75182305d556818c76974a054a17d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#abba75182305d556818c76974a054a17d">FirstPCAdpar</a></td></tr>
<tr class="memdesc:abba75182305d556818c76974a054a17d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index of the first param that is being decomposed.  <br /></td></tr>
<tr class="separator:abba75182305d556818c76974a054a17d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ebdc744b733656972a15f1657915a3f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a5ebdc744b733656972a15f1657915a3f">LastPCAdpar</a></td></tr>
<tr class="memdesc:a5ebdc744b733656972a15f1657915a3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index of the last param that is being decomposed.  <br /></td></tr>
<tr class="separator:a5ebdc744b733656972a15f1657915a3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cb3d0b4096fbb55b040f70cd5b6e32b"><td class="memItemLeft" align="right" valign="top">TMatrixDSym *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a6cb3d0b4096fbb55b040f70cd5b6e32b">throwMatrix</a></td></tr>
<tr class="memdesc:a6cb3d0b4096fbb55b040f70cd5b6e32b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Matrix which we use for step proposal before Cholesky decomposition (not actually used for step proposal)  <br /></td></tr>
<tr class="separator:a6cb3d0b4096fbb55b040f70cd5b6e32b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab95f5e066c2dfb1d20d120bc6c85dda2"><td class="memItemLeft" align="right" valign="top">TMatrixD *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#ab95f5e066c2dfb1d20d120bc6c85dda2">throwMatrix_CholDecomp</a></td></tr>
<tr class="memdesc:ab95f5e066c2dfb1d20d120bc6c85dda2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Matrix which we use for step proposal after Cholesky decomposition.  <br /></td></tr>
<tr class="separator:ab95f5e066c2dfb1d20d120bc6c85dda2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca17e48a5fa8e353317d58c205fb89df"><td class="memItemLeft" align="right" valign="top">double **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#aca17e48a5fa8e353317d58c205fb89df">throwMatrixCholDecomp</a></td></tr>
<tr class="memdesc:aca17e48a5fa8e353317d58c205fb89df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Throw matrix that is being used in the fit, much faster as TMatrixDSym cache miss.  <br /></td></tr>
<tr class="separator:aca17e48a5fa8e353317d58c205fb89df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a838731abd6716940043b484b2b266f86"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#a838731abd6716940043b484b2b266f86">use_adaptive</a></td></tr>
<tr class="memdesc:a838731abd6716940043b484b2b266f86"><td class="mdescLeft">&#160;</td><td class="mdescRight">Are we using AMCMC?  <br /></td></tr>
<tr class="separator:a838731abd6716940043b484b2b266f86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb8262289fb5a37e849def35c04d6165"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classPCAHandler.html">PCAHandler</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a></td></tr>
<tr class="memdesc:acb8262289fb5a37e849def35c04d6165"><td class="mdescLeft">&#160;</td><td class="mdescRight">Struct containing information about PCA.  <br /></td></tr>
<tr class="separator:acb8262289fb5a37e849def35c04d6165"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3833dc51a81afc9dca7c3dcbb107af7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html">adaptive_mcmc::AdaptiveMCMCHandler</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcovarianceBase.html#ab3833dc51a81afc9dca7c3dcbb107af7">AdaptiveHandler</a></td></tr>
<tr class="memdesc:ab3833dc51a81afc9dca7c3dcbb107af7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Struct containing information about adaption.  <br /></td></tr>
<tr class="separator:ab3833dc51a81afc9dca7c3dcbb107af7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Base class responsible for handling of systematic error parameters. Capable of using PCA or using adaptive throw matrix. </p>
<dl class="section see"><dt>See also</dt><dd>For more details, visit the <a href="https://github.com/mach3-software/MaCh3/wiki/02.-Implementation-of-Systematic">Wiki</a>. </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Dan Barrow </dd>
<dd>
Ed Atkin </dd>
<dd>
Kamil Skwarczynski </dd></dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00014">14</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a332cbcc2c262ff3775b56c40724e623e" name="a332cbcc2c262ff3775b56c40724e623e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a332cbcc2c262ff3775b56c40724e623e">&#9670;&#160;</a></span>covarianceBase() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">covarianceBase::covarianceBase </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>YAMLFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>threshold</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>FirstPCAdpar</em> = <code>-999</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>LastPCAdpar</em> = <code>-999</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ETA - constructor for a YAML file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">YAMLFile</td><td>A vector of strings representing the YAML files used for initialisation of matrix </td></tr>
    <tr><td class="paramname">name</td><td>Matrix name </td></tr>
    <tr><td class="paramname">threshold</td><td>PCA threshold from 0 to 1. Default is -1 and means no PCA </td></tr>
    <tr><td class="paramname">FirstPCAdpar</td><td>First PCA parameter that will be decomposed. </td></tr>
    <tr><td class="paramname">LastPCAdpar</td><td>First PCA parameter that will be decomposed. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00023">23</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   23</span>                                                                                                                                : <a class="code hl_variable" href="classcovarianceBase.html#a5451d4189a9fb7591c8ce728852ba82e">inputFile</a>(YAMLFile[0].c_str()), <a class="code hl_variable" href="classcovarianceBase.html#a26618d3f5633b33ce20e38ce8261b3ee">matrixName</a>(name), <a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>(<span class="keyword">true</span>), <a class="code hl_variable" href="classcovarianceBase.html#add54ab1ba46b723fa23d7c95dfad671a">eigen_threshold</a>(threshold), <a class="code hl_variable" href="classcovarianceBase.html#abba75182305d556818c76974a054a17d">FirstPCAdpar</a>(FirstPCA), <a class="code hl_variable" href="classcovarianceBase.html#a5ebdc744b733656972a15f1657915a3f">LastPCAdpar</a>(LastPCA) {</div>
<div class="line"><span class="lineno">   24</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">   25</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Constructing instance of covarianceBase using &quot;</span>);</div>
<div class="line"><span class="lineno">   26</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; YAMLFile.size(); i++)</div>
<div class="line"><span class="lineno">   27</span>  {</div>
<div class="line"><span class="lineno">   28</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{}&quot;</span>, YAMLFile[i]);</div>
<div class="line"><span class="lineno">   29</span>  }</div>
<div class="line"><span class="lineno">   30</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;as an input&quot;</span>);</div>
<div class="line"><span class="lineno">   31</span> </div>
<div class="line"><span class="lineno">   32</span>  <span class="keywordflow">if</span> (threshold &lt; 0 || threshold &gt;= 1) {</div>
<div class="line"><span class="lineno">   33</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Principal component analysis but given the threshold for the principal components to be less than 0, or greater than (or equal to) 1. This will not work&quot;</span>);</div>
<div class="line"><span class="lineno">   34</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Please specify a number between 0 and 1&quot;</span>);</div>
<div class="line"><span class="lineno">   35</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;You specified: &quot;</span>);</div>
<div class="line"><span class="lineno">   36</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Am instead calling the usual non-PCA constructor...&quot;</span>);</div>
<div class="line"><span class="lineno">   37</span>    <a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   38</span>  }</div>
<div class="line"><span class="lineno">   39</span> </div>
<div class="line"><span class="lineno">   40</span>  <a class="code hl_function" href="classcovarianceBase.html#a2960c489f6aafdb5a2291e1a48b14e9a">init</a>(YAMLFile);</div>
<div class="line"><span class="lineno">   41</span>  <span class="comment">// Call the innocent helper function</span></div>
<div class="line"><span class="lineno">   42</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>) <a class="code hl_function" href="classcovarianceBase.html#a8ac3a458097817eca534c23554a7635b">ConstructPCA</a>();</div>
<div class="line"><span class="lineno">   43</span>}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a95fa4dffc648e4c5536c9292c2bdcac3"><div class="ttname"><a href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a></div><div class="ttdeci">#define MACH3LOG_INFO</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00023">MaCh3Logger.h:23</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a26618d3f5633b33ce20e38ce8261b3ee"><div class="ttname"><a href="classcovarianceBase.html#a26618d3f5633b33ce20e38ce8261b3ee">covarianceBase::matrixName</a></div><div class="ttdeci">std::string matrixName</div><div class="ttdoc">Name of cov matrix.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00429">covarianceBase.h:429</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a2960c489f6aafdb5a2291e1a48b14e9a"><div class="ttname"><a href="classcovarianceBase.html#a2960c489f6aafdb5a2291e1a48b14e9a">covarianceBase::init</a></div><div class="ttdeci">void init(std::string name, std::string file)</div><div class="ttdoc">Initialisation of the class using matrix from root file.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8cpp_source.html#l00085">covarianceBase.cpp:85</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a5451d4189a9fb7591c8ce728852ba82e"><div class="ttname"><a href="classcovarianceBase.html#a5451d4189a9fb7591c8ce728852ba82e">covarianceBase::inputFile</a></div><div class="ttdeci">const std::string inputFile</div><div class="ttdoc">The input root file we read in.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00426">covarianceBase.h:426</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a5ebdc744b733656972a15f1657915a3f"><div class="ttname"><a href="classcovarianceBase.html#a5ebdc744b733656972a15f1657915a3f">covarianceBase::LastPCAdpar</a></div><div class="ttdeci">int LastPCAdpar</div><div class="ttdoc">Index of the last param that is being decomposed.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00488">covarianceBase.h:488</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a8ac3a458097817eca534c23554a7635b"><div class="ttname"><a href="classcovarianceBase.html#a8ac3a458097817eca534c23554a7635b">covarianceBase::ConstructPCA</a></div><div class="ttdeci">void ConstructPCA()</div><div class="ttdoc">CW: Calculate eigen values, prepare transition matrices and remove param based on defined threshold.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8cpp_source.html#l00063">covarianceBase.cpp:63</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_ab4b7f96d3e977a0b3307ceecbd0baeb4"><div class="ttname"><a href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">covarianceBase::pca</a></div><div class="ttdeci">bool pca</div><div class="ttdoc">perform PCA or not</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00480">covarianceBase.h:480</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_abba75182305d556818c76974a054a17d"><div class="ttname"><a href="classcovarianceBase.html#abba75182305d556818c76974a054a17d">covarianceBase::FirstPCAdpar</a></div><div class="ttdeci">int FirstPCAdpar</div><div class="ttdoc">Index of the first param that is being decomposed.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00486">covarianceBase.h:486</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_add54ab1ba46b723fa23d7c95dfad671a"><div class="ttname"><a href="classcovarianceBase.html#add54ab1ba46b723fa23d7c95dfad671a">covarianceBase::eigen_threshold</a></div><div class="ttdeci">double eigen_threshold</div><div class="ttdoc">CW: Threshold based on which we remove parameters in eigen base.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00482">covarianceBase.h:482</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a12f3d613f4acccf595599bd6bd6cbeb5" name="a12f3d613f4acccf595599bd6bd6cbeb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12f3d613f4acccf595599bd6bd6cbeb5">&#9670;&#160;</a></span>covarianceBase() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">covarianceBase::covarianceBase </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>threshold</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>FirstPCAdpar</em> = <code>-999</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>LastPCAdpar</em> = <code>-999</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>"Usual" constructors from root file </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Matrix name </td></tr>
    <tr><td class="paramname">file</td><td>Path to matrix root file </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00005">5</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">    5</span>                                                                                                          : <a class="code hl_variable" href="classcovarianceBase.html#a5451d4189a9fb7591c8ce728852ba82e">inputFile</a>(file), <a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>(<span class="keyword">false</span>),</div>
<div class="line"><span class="lineno">    6</span><a class="code hl_variable" href="classcovarianceBase.html#add54ab1ba46b723fa23d7c95dfad671a">eigen_threshold</a>(threshold), <a class="code hl_variable" href="classcovarianceBase.html#abba75182305d556818c76974a054a17d">FirstPCAdpar</a>(FirstPCA), <a class="code hl_variable" href="classcovarianceBase.html#a5ebdc744b733656972a15f1657915a3f">LastPCAdpar</a>(LastPCA) {</div>
<div class="line"><span class="lineno">    7</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">    8</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Constructing instance of covarianceBase&quot;</span>);</div>
<div class="line"><span class="lineno">    9</span>  <span class="keywordflow">if</span> (threshold &lt; 0 || threshold &gt;= 1) {</div>
<div class="line"><span class="lineno">   10</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;NOTE: {} {}&quot;</span>, name, file);</div>
<div class="line"><span class="lineno">   11</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Principal component analysis but given the threshold for the principal components to be less than 0, or greater than (or equal to) 1. This will not work&quot;</span>);</div>
<div class="line"><span class="lineno">   12</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Please specify a number between 0 and 1&quot;</span>);</div>
<div class="line"><span class="lineno">   13</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;You specified: &quot;</span>);</div>
<div class="line"><span class="lineno">   14</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Am instead calling the usual non-PCA constructor...&quot;</span>);</div>
<div class="line"><span class="lineno">   15</span>    <a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   16</span>  }</div>
<div class="line"><span class="lineno">   17</span>  <a class="code hl_function" href="classcovarianceBase.html#a2960c489f6aafdb5a2291e1a48b14e9a">init</a>(name, file);</div>
<div class="line"><span class="lineno">   18</span> </div>
<div class="line"><span class="lineno">   19</span>  <span class="comment">// Call the innocent helper function</span></div>
<div class="line"><span class="lineno">   20</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>) <a class="code hl_function" href="classcovarianceBase.html#a8ac3a458097817eca534c23554a7635b">ConstructPCA</a>();</div>
<div class="line"><span class="lineno">   21</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1e7a87a1d7e054475b4b921407e0a2d1" name="a1e7a87a1d7e054475b4b921407e0a2d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e7a87a1d7e054475b4b921407e0a2d1">&#9670;&#160;</a></span>~covarianceBase()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">covarianceBase::~covarianceBase </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00047">47</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   47</span>                               {</div>
<div class="line"><span class="lineno">   48</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">   49</span>  <span class="keyword">delete</span>[] <a class="code hl_variable" href="classcovarianceBase.html#a705e648220c06083cd1acc5fba4f2ef7">randParams</a>;</div>
<div class="line"><span class="lineno">   50</span>  <span class="keyword">delete</span>[] <a class="code hl_variable" href="classcovarianceBase.html#a7b70de3f098aae1d537d80bac5969d88">corr_throw</a>;</div>
<div class="line"><span class="lineno">   51</span> </div>
<div class="line"><span class="lineno">   52</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcovarianceBase.html#a6c3fe8db34c06299fd1633951ac00937">covMatrix</a> != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classcovarianceBase.html#a6c3fe8db34c06299fd1633951ac00937">covMatrix</a>;</div>
<div class="line"><span class="lineno">   53</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcovarianceBase.html#a35c7dc7817eaf4058e9775b6bc792ebc">invCovMatrix</a> != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classcovarianceBase.html#a35c7dc7817eaf4058e9775b6bc792ebc">invCovMatrix</a>;</div>
<div class="line"><span class="lineno">   54</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcovarianceBase.html#ab95f5e066c2dfb1d20d120bc6c85dda2">throwMatrix_CholDecomp</a> != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classcovarianceBase.html#ab95f5e066c2dfb1d20d120bc6c85dda2">throwMatrix_CholDecomp</a>;</div>
<div class="line"><span class="lineno">   55</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcovarianceBase.html#a6cb3d0b4096fbb55b040f70cd5b6e32b">throwMatrix</a> != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classcovarianceBase.html#a6cb3d0b4096fbb55b040f70cd5b6e32b">throwMatrix</a>;</div>
<div class="line"><span class="lineno">   56</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; i++) {</div>
<div class="line"><span class="lineno">   57</span>    <span class="keyword">delete</span>[] <a class="code hl_variable" href="classcovarianceBase.html#aca17e48a5fa8e353317d58c205fb89df">throwMatrixCholDecomp</a>[i];</div>
<div class="line"><span class="lineno">   58</span>  }</div>
<div class="line"><span class="lineno">   59</span>  <span class="keyword">delete</span>[] <a class="code hl_variable" href="classcovarianceBase.html#aca17e48a5fa8e353317d58c205fb89df">throwMatrixCholDecomp</a>;</div>
<div class="line"><span class="lineno">   60</span>}</div>
<div class="ttc" id="aclasscovarianceBase_html_a35c7dc7817eaf4058e9775b6bc792ebc"><div class="ttname"><a href="classcovarianceBase.html#a35c7dc7817eaf4058e9775b6bc792ebc">covarianceBase::invCovMatrix</a></div><div class="ttdeci">TMatrixDSym * invCovMatrix</div><div class="ttdoc">The inverse covariance matrix.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00433">covarianceBase.h:433</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a6c3fe8db34c06299fd1633951ac00937"><div class="ttname"><a href="classcovarianceBase.html#a6c3fe8db34c06299fd1633951ac00937">covarianceBase::covMatrix</a></div><div class="ttdeci">TMatrixDSym * covMatrix</div><div class="ttdoc">The covariance matrix.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00431">covarianceBase.h:431</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a6cb3d0b4096fbb55b040f70cd5b6e32b"><div class="ttname"><a href="classcovarianceBase.html#a6cb3d0b4096fbb55b040f70cd5b6e32b">covarianceBase::throwMatrix</a></div><div class="ttdeci">TMatrixDSym * throwMatrix</div><div class="ttdoc">Matrix which we use for step proposal before Cholesky decomposition (not actually used for step propo...</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00491">covarianceBase.h:491</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a705e648220c06083cd1acc5fba4f2ef7"><div class="ttname"><a href="classcovarianceBase.html#a705e648220c06083cd1acc5fba4f2ef7">covarianceBase::randParams</a></div><div class="ttdeci">double * randParams</div><div class="ttdoc">Random number taken from gaussian around prior error used for corr_throw.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00441">covarianceBase.h:441</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a7b70de3f098aae1d537d80bac5969d88"><div class="ttname"><a href="classcovarianceBase.html#a7b70de3f098aae1d537d80bac5969d88">covarianceBase::corr_throw</a></div><div class="ttdeci">double * corr_throw</div><div class="ttdoc">Result of multiplication of Cholesky matrix and randParams.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00443">covarianceBase.h:443</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_ab95f5e066c2dfb1d20d120bc6c85dda2"><div class="ttname"><a href="classcovarianceBase.html#ab95f5e066c2dfb1d20d120bc6c85dda2">covarianceBase::throwMatrix_CholDecomp</a></div><div class="ttdeci">TMatrixD * throwMatrix_CholDecomp</div><div class="ttdoc">Matrix which we use for step proposal after Cholesky decomposition.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00493">covarianceBase.h:493</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_ac5d922f1a4163b38ebc7a3ef21eec376"><div class="ttname"><a href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">covarianceBase::_fNumPar</a></div><div class="ttdeci">int _fNumPar</div><div class="ttdoc">Number of systematic parameters.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00457">covarianceBase.h:457</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_aca17e48a5fa8e353317d58c205fb89df"><div class="ttname"><a href="classcovarianceBase.html#aca17e48a5fa8e353317d58c205fb89df">covarianceBase::throwMatrixCholDecomp</a></div><div class="ttdeci">double ** throwMatrixCholDecomp</div><div class="ttdoc">Throw matrix that is being used in the fit, much faster as TMatrixDSym cache miss.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00495">covarianceBase.h:495</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a54712c01de98adcaaa0ecb5a650a3457" name="a54712c01de98adcaaa0ecb5a650a3457"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54712c01de98adcaaa0ecb5a650a3457">&#9670;&#160;</a></span>acceptStep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::acceptStep </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Accepted this step. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00555">555</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  555</span>                                           {</div>
<div class="line"><span class="lineno">  556</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">  557</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>) {</div>
<div class="line"><span class="lineno">  558</span><span class="preprocessor">    #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  559</span><span class="preprocessor">    #pragma omp parallel for</span></div>
<div class="line"><span class="lineno">  560</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  561</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; ++i) {</div>
<div class="line"><span class="lineno">  562</span>      <span class="comment">// Update state so that current state is proposed state</span></div>
<div class="line"><span class="lineno">  563</span>      <a class="code hl_variable" href="classcovarianceBase.html#ae70f51df3976975b2dc78fd3bfc28b65">_fCurrVal</a>[i] = <a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[i];</div>
<div class="line"><span class="lineno">  564</span>    }</div>
<div class="line"><span class="lineno">  565</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  566</span>    <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;AcceptStep();</div>
<div class="line"><span class="lineno">  567</span>  }</div>
<div class="line"><span class="lineno">  568</span>}</div>
<div class="ttc" id="aclasscovarianceBase_html_a12f0eb31a5ef48b014baa11d4ab919e9"><div class="ttname"><a href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">covarianceBase::_fPropVal</a></div><div class="ttdeci">std::vector&lt; double &gt; _fPropVal</div><div class="ttdoc">Proposed value of the parameter.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00463">covarianceBase.h:463</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_acb8262289fb5a37e849def35c04d6165"><div class="ttname"><a href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">covarianceBase::PCAObj</a></div><div class="ttdeci">std::unique_ptr&lt; PCAHandler &gt; PCAObj</div><div class="ttdoc">Struct containing information about PCA.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00501">covarianceBase.h:501</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_ae70f51df3976975b2dc78fd3bfc28b65"><div class="ttname"><a href="classcovarianceBase.html#ae70f51df3976975b2dc78fd3bfc28b65">covarianceBase::_fCurrVal</a></div><div class="ttdeci">std::vector&lt; double &gt; _fCurrVal</div><div class="ttdoc">Current value of the parameter.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00461">covarianceBase.h:461</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6c83deb921c0ee4107645752ff84e91b" name="a6c83deb921c0ee4107645752ff84e91b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c83deb921c0ee4107645752ff84e91b">&#9670;&#160;</a></span>AppliesToDetID()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool covarianceBase::AppliesToDetID </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>SystIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>DetID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if parameter is affecting given det ID. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">SystIndex</td><td>number of parameter </td></tr>
    <tr><td class="paramname">DetID</td><td>The Detector ID used to filter parameters. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l01213">1213</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1213</span>                                                                                     {</div>
<div class="line"><span class="lineno"> 1214</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno"> 1215</span>  <span class="comment">// Empty means apply to all</span></div>
<div class="line"><span class="lineno"> 1216</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcovarianceBase.html#a267523bb0f78c27208000b2856f741da">_fDetID</a>[SystIndex].<a class="code hl_variable" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>() == 0) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1217</span> </div>
<div class="line"><span class="lineno"> 1218</span>  <span class="comment">// Make a copy and to lower case to not be case sensitive</span></div>
<div class="line"><span class="lineno"> 1219</span>  std::string DetIDCopy = DetID;</div>
<div class="line"><span class="lineno"> 1220</span>  std::transform(DetIDCopy.begin(), DetIDCopy.end(), DetIDCopy.begin(), ::tolower);</div>
<div class="line"><span class="lineno"> 1221</span>  <span class="keywordtype">bool</span> Applies = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1222</span> </div>
<div class="line"><span class="lineno"> 1223</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#a267523bb0f78c27208000b2856f741da">_fDetID</a>[SystIndex].size(); i++) {</div>
<div class="line"><span class="lineno"> 1224</span>    <span class="comment">// Convert to low case to not be case sensitive</span></div>
<div class="line"><span class="lineno"> 1225</span>    std::string pattern = <a class="code hl_variable" href="classcovarianceBase.html#a267523bb0f78c27208000b2856f741da">_fDetID</a>[SystIndex][i];</div>
<div class="line"><span class="lineno"> 1226</span>    std::transform(pattern.begin(), pattern.end(), pattern.begin(), ::tolower);</div>
<div class="line"><span class="lineno"> 1227</span> </div>
<div class="line"><span class="lineno"> 1228</span>    <span class="comment">// Replace &#39;*&#39; in the pattern with &#39;.*&#39; for regex matching</span></div>
<div class="line"><span class="lineno"> 1229</span>    std::string regexPattern = <span class="stringliteral">&quot;^&quot;</span> + std::regex_replace(pattern, std::regex(<span class="stringliteral">&quot;\\*&quot;</span>), <span class="stringliteral">&quot;.*&quot;</span>) + <span class="stringliteral">&quot;$&quot;</span>;</div>
<div class="line"><span class="lineno"> 1230</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1231</span>      std::regex regex(regexPattern);</div>
<div class="line"><span class="lineno"> 1232</span>      <span class="keywordflow">if</span> (std::regex_match(DetIDCopy, regex)) {</div>
<div class="line"><span class="lineno"> 1233</span>        Applies = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1234</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1235</span>      }</div>
<div class="line"><span class="lineno"> 1236</span>    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::regex_error&amp; e) {</div>
<div class="line"><span class="lineno"> 1237</span>      <span class="comment">// Handle regex error (for invalid patterns)</span></div>
<div class="line"><span class="lineno"> 1238</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Regex error: {}&quot;</span>, e.what());</div>
<div class="line"><span class="lineno"> 1239</span>    }</div>
<div class="line"><span class="lineno"> 1240</span>  }</div>
<div class="line"><span class="lineno"> 1241</span>  <span class="keywordflow">return</span> Applies;</div>
<div class="line"><span class="lineno"> 1242</span>}</div>
<div class="ttc" id="aGetPenaltyTerm_8cpp_html_a439227feff9d7f55384e8780cfc2eb82"><div class="ttname"><a href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a></div><div class="ttdeci">int size</div><div class="ttdef"><b>Definition:</b> <a href="GetPenaltyTerm_8cpp_source.html#l00037">GetPenaltyTerm.cpp:37</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_a61052119a625282d0ec6d4a97adf3ee2"><div class="ttname"><a href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a></div><div class="ttdeci">#define MACH3LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00025">MaCh3Logger.h:25</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a267523bb0f78c27208000b2856f741da"><div class="ttname"><a href="classcovarianceBase.html#a267523bb0f78c27208000b2856f741da">covarianceBase::_fDetID</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::string &gt; &gt; _fDetID</div><div class="ttdoc">Tells to which samples object param should be applied.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00477">covarianceBase.h:477</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5aadbf9d0a50062ae401136dc6e60ffb" name="a5aadbf9d0a50062ae401136dc6e60ffb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5aadbf9d0a50062ae401136dc6e60ffb">&#9670;&#160;</a></span>CalcLikelihood()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double covarianceBase::CalcLikelihood </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calc penalty term based on inverted covariance matrix. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00661">661</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  661</span>                                                       {</div>
<div class="line"><span class="lineno">  662</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">  663</span>  <span class="keywordtype">double</span> logL = 0.0;</div>
<div class="line"><span class="lineno">  664</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  665</span><span class="preprocessor">  #pragma omp parallel for reduction(+:logL)</span></div>
<div class="line"><span class="lineno">  666</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  667</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; ++i){</div>
<div class="line"><span class="lineno">  668</span><span class="preprocessor">    #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  669</span><span class="preprocessor">    #pragma omp simd</span></div>
<div class="line"><span class="lineno">  670</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  671</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j) {</div>
<div class="line"><span class="lineno">  672</span>      <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classcovarianceBase.html#ad9c47deb7009bff81210f666e80012eb">_fFlatPrior</a>[i] &amp;&amp; !<a class="code hl_variable" href="classcovarianceBase.html#ad9c47deb7009bff81210f666e80012eb">_fFlatPrior</a>[j]) {</div>
<div class="line"><span class="lineno">  673</span>        <span class="comment">//KS: Since matrix is symmetric we can calculate non diagonal elements only once and multiply by 2, can bring up to factor speed decrease.</span></div>
<div class="line"><span class="lineno">  674</span>        <span class="keywordtype">double</span> scale = (i != j) ? 1. : 0.5;</div>
<div class="line"><span class="lineno">  675</span>        logL += scale * (<a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[i] - <a class="code hl_variable" href="classcovarianceBase.html#a7578a2cc2e8e9100fad88310a824cb1c">_fPreFitValue</a>[i])*(<a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[j] - <a class="code hl_variable" href="classcovarianceBase.html#a7578a2cc2e8e9100fad88310a824cb1c">_fPreFitValue</a>[j])*<a class="code hl_variable" href="classcovarianceBase.html#a5973f7f446d6058af9bcd006a6cf562d">InvertCovMatrix</a>[i][j];</div>
<div class="line"><span class="lineno">  676</span>      }</div>
<div class="line"><span class="lineno">  677</span>    }</div>
<div class="line"><span class="lineno">  678</span>  }</div>
<div class="line"><span class="lineno">  679</span>  <span class="keywordflow">return</span> logL;</div>
<div class="line"><span class="lineno">  680</span>}</div>
<div class="ttc" id="aclasscovarianceBase_html_a5973f7f446d6058af9bcd006a6cf562d"><div class="ttname"><a href="classcovarianceBase.html#a5973f7f446d6058af9bcd006a6cf562d">covarianceBase::InvertCovMatrix</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; InvertCovMatrix</div><div class="ttdoc">KS: Same as above but much faster as TMatrixDSym cache miss.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00435">covarianceBase.h:435</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a7578a2cc2e8e9100fad88310a824cb1c"><div class="ttname"><a href="classcovarianceBase.html#a7578a2cc2e8e9100fad88310a824cb1c">covarianceBase::_fPreFitValue</a></div><div class="ttdeci">std::vector&lt; double &gt; _fPreFitValue</div><div class="ttdoc">Parameter value dictated by the prior model. Based on it penalty term is calculated.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00459">covarianceBase.h:459</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_ad9c47deb7009bff81210f666e80012eb"><div class="ttname"><a href="classcovarianceBase.html#ad9c47deb7009bff81210f666e80012eb">covarianceBase::_fFlatPrior</a></div><div class="ttdeci">std::vector&lt; bool &gt; _fFlatPrior</div><div class="ttdoc">Whether to apply flat prior or not.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00475">covarianceBase.h:475</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab0e457ad3d7acfdc2b29b14a8553eee2" name="ab0e457ad3d7acfdc2b29b14a8553eee2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0e457ad3d7acfdc2b29b14a8553eee2">&#9670;&#160;</a></span>CheckBounds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int covarianceBase::CheckBounds </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if parameters were proposed outside physical boundary. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00683">683</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  683</span>                                                 {</div>
<div class="line"><span class="lineno">  684</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">  685</span>  <span class="keywordtype">int</span> NOutside = 0;</div>
<div class="line"><span class="lineno">  686</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  687</span><span class="preprocessor">  #pragma omp parallel for reduction(+:NOutside)</span></div>
<div class="line"><span class="lineno">  688</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  689</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; ++i){</div>
<div class="line"><span class="lineno">  690</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[i] &gt; <a class="code hl_variable" href="classcovarianceBase.html#a31e636cb6de871bd0c2c8e7e299df9e7">_fUpBound</a>[i] || <a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[i] &lt; <a class="code hl_variable" href="classcovarianceBase.html#a8f1d94838f188cc85c4f82557c0b0b66">_fLowBound</a>[i]){</div>
<div class="line"><span class="lineno">  691</span>      NOutside++;</div>
<div class="line"><span class="lineno">  692</span>    }</div>
<div class="line"><span class="lineno">  693</span>  }</div>
<div class="line"><span class="lineno">  694</span>  <span class="keywordflow">return</span> NOutside;</div>
<div class="line"><span class="lineno">  695</span>}</div>
<div class="ttc" id="aclasscovarianceBase_html_a31e636cb6de871bd0c2c8e7e299df9e7"><div class="ttname"><a href="classcovarianceBase.html#a31e636cb6de871bd0c2c8e7e299df9e7">covarianceBase::_fUpBound</a></div><div class="ttdeci">std::vector&lt; double &gt; _fUpBound</div><div class="ttdoc">Upper physical bound, parameter will not be able to go beyond it.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00471">covarianceBase.h:471</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a8f1d94838f188cc85c4f82557c0b0b66"><div class="ttname"><a href="classcovarianceBase.html#a8f1d94838f188cc85c4f82557c0b0b66">covarianceBase::_fLowBound</a></div><div class="ttdeci">std::vector&lt; double &gt; _fLowBound</div><div class="ttdoc">Lowest physical bound, parameter will not be able to go beyond it.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00469">covarianceBase.h:469</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8ac3a458097817eca534c23554a7635b" name="a8ac3a458097817eca534c23554a7635b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ac3a458097817eca534c23554a7635b">&#9670;&#160;</a></span>ConstructPCA()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::ConstructPCA </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CW: Calculate eigen values, prepare transition matrices and remove param based on defined threshold. </p>
<dl class="section see"><dt>See also</dt><dd>For more details, visit the <a href="https://github.com/mach3-software/MaCh3/wiki/03.-Eigen-Decomposition-%E2%80%90-PCA">Wiki</a>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00063">63</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   63</span>                                  {</div>
<div class="line"><span class="lineno">   64</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">   65</span>  <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a> = std::make_unique&lt;PCAHandler&gt;();</div>
<div class="line"><span class="lineno">   66</span>  <span class="comment">//Check whether first and last pcadpar are set and if not just PCA everything</span></div>
<div class="line"><span class="lineno">   67</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classcovarianceBase.html#abba75182305d556818c76974a054a17d">FirstPCAdpar</a> == -999 || <a class="code hl_variable" href="classcovarianceBase.html#a5ebdc744b733656972a15f1657915a3f">LastPCAdpar</a> == -999){</div>
<div class="line"><span class="lineno">   68</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classcovarianceBase.html#abba75182305d556818c76974a054a17d">FirstPCAdpar</a> == -999 &amp;&amp; <a class="code hl_variable" href="classcovarianceBase.html#a5ebdc744b733656972a15f1657915a3f">LastPCAdpar</a> == -999){</div>
<div class="line"><span class="lineno">   69</span>      <a class="code hl_variable" href="classcovarianceBase.html#abba75182305d556818c76974a054a17d">FirstPCAdpar</a> = 0;</div>
<div class="line"><span class="lineno">   70</span>      <a class="code hl_variable" href="classcovarianceBase.html#a5ebdc744b733656972a15f1657915a3f">LastPCAdpar</a> = <a class="code hl_variable" href="classcovarianceBase.html#a6c3fe8db34c06299fd1633951ac00937">covMatrix</a>-&gt;GetNrows()-1;</div>
<div class="line"><span class="lineno">   71</span>    }</div>
<div class="line"><span class="lineno">   72</span>    <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno">   73</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;You must either leave FirstPCAdpar and LastPCAdpar at -999 or set them both to something&quot;</span>);</div>
<div class="line"><span class="lineno">   74</span>      <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">   75</span>    }</div>
<div class="line"><span class="lineno">   76</span>  }</div>
<div class="line"><span class="lineno">   77</span> </div>
<div class="line"><span class="lineno">   78</span>  <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;ConstructPCA(<a class="code hl_variable" href="classcovarianceBase.html#a6c3fe8db34c06299fd1633951ac00937">covMatrix</a>, <a class="code hl_variable" href="classcovarianceBase.html#abba75182305d556818c76974a054a17d">FirstPCAdpar</a>, <a class="code hl_variable" href="classcovarianceBase.html#a5ebdc744b733656972a15f1657915a3f">LastPCAdpar</a>, <a class="code hl_variable" href="classcovarianceBase.html#add54ab1ba46b723fa23d7c95dfad671a">eigen_threshold</a>, <a class="code hl_variable" href="classcovarianceBase.html#ac57285a48d41ef764b4c659959a36c2d">_fNumParPCA</a>, <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><span class="lineno">   79</span>  <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;SetupPointers(&amp;<a class="code hl_variable" href="classcovarianceBase.html#ae70f51df3976975b2dc78fd3bfc28b65">_fCurrVal</a>, &amp;<a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>);</div>
<div class="line"><span class="lineno">   80</span>  <span class="comment">// Make a note that we have now done PCA</span></div>
<div class="line"><span class="lineno">   81</span>  <a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   82</span>}</div>
<div class="ttc" id="aclassMaCh3Exception_html"><div class="ttname"><a href="classMaCh3Exception.html">MaCh3Exception</a></div><div class="ttdoc">Custom exception class for MaCh3 errors.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Exception_8h_source.html#l00013">MaCh3Exception.h:13</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_ac57285a48d41ef764b4c659959a36c2d"><div class="ttname"><a href="classcovarianceBase.html#ac57285a48d41ef764b4c659959a36c2d">covarianceBase::_fNumParPCA</a></div><div class="ttdeci">int _fNumParPCA</div><div class="ttdoc">Number of parameters in PCA base.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00484">covarianceBase.h:484</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a044a1c9e5642d9f2f7e713999898a2f8" name="a044a1c9e5642d9f2f7e713999898a2f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a044a1c9e5642d9f2f7e713999898a2f8">&#9670;&#160;</a></span>CorrelateSteps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::CorrelateSteps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use Cholesky throw matrix for better step proposal. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00533">533</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  533</span>                                               {</div>
<div class="line"><span class="lineno">  534</span><span class="comment">// ************************************************</span></div>
<div class="line"><span class="lineno">  535</span>  <span class="comment">//KS: Using custom function compared to ROOT one with 8 threads we have almost factor 2 performance increase, by replacing TMatrix with just double we increase it even more</span></div>
<div class="line"><span class="lineno">  536</span>  <a class="code hl_function" href="classcovarianceBase.html#a43367db263b2607232077410f27b1146">MatrixVectorMulti</a>(<a class="code hl_variable" href="classcovarianceBase.html#a7b70de3f098aae1d537d80bac5969d88">corr_throw</a>, <a class="code hl_variable" href="classcovarianceBase.html#aca17e48a5fa8e353317d58c205fb89df">throwMatrixCholDecomp</a>, <a class="code hl_variable" href="classcovarianceBase.html#a705e648220c06083cd1acc5fba4f2ef7">randParams</a>, <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><span class="lineno">  537</span> </div>
<div class="line"><span class="lineno">  538</span>  <span class="comment">// If not doing PCA</span></div>
<div class="line"><span class="lineno">  539</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>) {</div>
<div class="line"><span class="lineno">  540</span><span class="preprocessor">    #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  541</span><span class="preprocessor">    #pragma omp parallel for</span></div>
<div class="line"><span class="lineno">  542</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  543</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; ++i) {</div>
<div class="line"><span class="lineno">  544</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcovarianceBase.html#a34f877fc160b4a93a3aab1b3a8977858">_fError</a>[i] &gt; 0.) {</div>
<div class="line"><span class="lineno">  545</span>        <a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[i] = <a class="code hl_variable" href="classcovarianceBase.html#ae70f51df3976975b2dc78fd3bfc28b65">_fCurrVal</a>[i] + <a class="code hl_variable" href="classcovarianceBase.html#a7b70de3f098aae1d537d80bac5969d88">corr_throw</a>[i]*<a class="code hl_variable" href="classcovarianceBase.html#a0088413d6a15d12cd34ec06166302f5c">_fGlobalStepScale</a>*<a class="code hl_variable" href="classcovarianceBase.html#a3cda39026e336a49cef482efd4062561">_fIndivStepScale</a>[i];</div>
<div class="line"><span class="lineno">  546</span>      }</div>
<div class="line"><span class="lineno">  547</span>    }</div>
<div class="line"><span class="lineno">  548</span>    <span class="comment">// If doing PCA throw uncorrelated in PCA basis (orthogonal basis by definition)</span></div>
<div class="line"><span class="lineno">  549</span>  } <span class="keywordflow">else</span> { </div>
<div class="line"><span class="lineno">  550</span>    <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;CorrelateSteps(<a class="code hl_variable" href="classcovarianceBase.html#a3cda39026e336a49cef482efd4062561">_fIndivStepScale</a>, <a class="code hl_variable" href="classcovarianceBase.html#a0088413d6a15d12cd34ec06166302f5c">_fGlobalStepScale</a>, <a class="code hl_variable" href="classcovarianceBase.html#a705e648220c06083cd1acc5fba4f2ef7">randParams</a>, <a class="code hl_variable" href="classcovarianceBase.html#a7b70de3f098aae1d537d80bac5969d88">corr_throw</a>);</div>
<div class="line"><span class="lineno">  551</span>  }</div>
<div class="line"><span class="lineno">  552</span>}</div>
<div class="ttc" id="aclasscovarianceBase_html_a0088413d6a15d12cd34ec06166302f5c"><div class="ttname"><a href="classcovarianceBase.html#a0088413d6a15d12cd34ec06166302f5c">covarianceBase::_fGlobalStepScale</a></div><div class="ttdeci">double _fGlobalStepScale</div><div class="ttdoc">Global step scale applied to all params in this class.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00445">covarianceBase.h:445</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a34f877fc160b4a93a3aab1b3a8977858"><div class="ttname"><a href="classcovarianceBase.html#a34f877fc160b4a93a3aab1b3a8977858">covarianceBase::_fError</a></div><div class="ttdeci">std::vector&lt; double &gt; _fError</div><div class="ttdoc">Prior error on the parameter.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00467">covarianceBase.h:467</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a3cda39026e336a49cef482efd4062561"><div class="ttname"><a href="classcovarianceBase.html#a3cda39026e336a49cef482efd4062561">covarianceBase::_fIndivStepScale</a></div><div class="ttdeci">std::vector&lt; double &gt; _fIndivStepScale</div><div class="ttdoc">Individual step scale used by MCMC algorithm.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00473">covarianceBase.h:473</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a43367db263b2607232077410f27b1146"><div class="ttname"><a href="classcovarianceBase.html#a43367db263b2607232077410f27b1146">covarianceBase::MatrixVectorMulti</a></div><div class="ttdeci">void MatrixVectorMulti(double *_restrict_ VecMulti, double **_restrict_ matrix, const double *_restrict_ vector, const int n) const</div><div class="ttdoc">KS: Custom function to perform multiplication of matrix and vector with multithreading.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8cpp_source.html#l00873">covarianceBase.cpp:873</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a61936f5c39ad7902624222fc49ad1362" name="a61936f5c39ad7902624222fc49ad1362"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61936f5c39ad7902624222fc49ad1362">&#9670;&#160;</a></span>GetConfig()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">YAML::Node covarianceBase::GetConfig </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Getter to return a copy of the YAML node. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00391">391</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  391</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#a933ff3dc0af99629ba3582a5d9d89d23">_fYAMLDoc</a>; }</div>
<div class="ttc" id="aclasscovarianceBase_html_a933ff3dc0af99629ba3582a5d9d89d23"><div class="ttname"><a href="classcovarianceBase.html#a933ff3dc0af99629ba3582a5d9d89d23">covarianceBase::_fYAMLDoc</a></div><div class="ttdeci">YAML::Node _fYAMLDoc</div><div class="ttdoc">Stores config describing systematics.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00455">covarianceBase.h:455</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac14fabdb87f5101cdbfcecb8e6b6b811" name="ac14fabdb87f5101cdbfcecb8e6b6b811"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac14fabdb87f5101cdbfcecb8e6b6b811">&#9670;&#160;</a></span>GetCorrelationMatrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TH2D * covarianceBase::GetCorrelationMatrix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>KS: Convert covariance matrix to correlation matrix and return TH2D which can be used for fancy plotting. </p>
<p>This function converts the covariance matrix to a correlation matrix and returns a TH2D object, which can be used for advanced plotting purposes. </p><dl class="section return"><dt>Returns</dt><dd>A pointer to a TH2D object representing the correlation matrix </dd></dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l01160">1160</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1160</span>                                           {</div>
<div class="line"><span class="lineno"> 1161</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno"> 1162</span>  TH2D* hMatrix = <span class="keyword">new</span> TH2D(<a class="code hl_function" href="group__Setters.html#gafae8445e4cdef85c27c4863adb9e7fe4">getName</a>().c_str(), <a class="code hl_function" href="group__Setters.html#gafae8445e4cdef85c27c4863adb9e7fe4">getName</a>().c_str(), <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>, 0.0, <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>, <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>, 0.0, <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><span class="lineno"> 1163</span> </div>
<div class="line"><span class="lineno"> 1164</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; i++)</div>
<div class="line"><span class="lineno"> 1165</span>  {</div>
<div class="line"><span class="lineno"> 1166</span>    hMatrix-&gt;SetBinContent(i+1, i+1, 1.);</div>
<div class="line"><span class="lineno"> 1167</span>    hMatrix-&gt;GetXaxis()-&gt;SetBinLabel(i+1, <a class="code hl_function" href="group__Setters.html#ga295f5fe63911d4c704b73e0b0c8c7971">GetParFancyName</a>(i).c_str());</div>
<div class="line"><span class="lineno"> 1168</span>    hMatrix-&gt;GetYaxis()-&gt;SetBinLabel(i+1, <a class="code hl_function" href="group__Setters.html#ga295f5fe63911d4c704b73e0b0c8c7971">GetParFancyName</a>(i).c_str());</div>
<div class="line"><span class="lineno"> 1169</span>  }</div>
<div class="line"><span class="lineno"> 1170</span> </div>
<div class="line"><span class="lineno"> 1171</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 1172</span><span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><span class="lineno"> 1173</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 1174</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; i++)</div>
<div class="line"><span class="lineno"> 1175</span>  {</div>
<div class="line"><span class="lineno"> 1176</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt;= i; j++)</div>
<div class="line"><span class="lineno"> 1177</span>    {</div>
<div class="line"><span class="lineno"> 1178</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> Corr = (*covMatrix)(i,j) / ( <a class="code hl_function" href="group__Setters.html#ga279d5470e3f83ec53a6c2dfce77de537">getDiagonalError</a>(i) * <a class="code hl_function" href="group__Setters.html#ga279d5470e3f83ec53a6c2dfce77de537">getDiagonalError</a>(j));</div>
<div class="line"><span class="lineno"> 1179</span>      hMatrix-&gt;SetBinContent(i+1, j+1, Corr);</div>
<div class="line"><span class="lineno"> 1180</span>      hMatrix-&gt;SetBinContent(j+1, i+1, Corr);</div>
<div class="line"><span class="lineno"> 1181</span>    }</div>
<div class="line"><span class="lineno"> 1182</span>  }</div>
<div class="line"><span class="lineno"> 1183</span>  <span class="keywordflow">return</span> hMatrix;</div>
<div class="line"><span class="lineno"> 1184</span>}</div>
<div class="ttc" id="agroup__Setters_html_ga279d5470e3f83ec53a6c2dfce77de537"><div class="ttname"><a href="group__Setters.html#ga279d5470e3f83ec53a6c2dfce77de537">covarianceBase::getDiagonalError</a></div><div class="ttdeci">double getDiagonalError(const int i) const</div><div class="ttdoc">Get diagonal error for ith parameter.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00161">covarianceBase.h:161</a></div></div>
<div class="ttc" id="agroup__Setters_html_ga295f5fe63911d4c704b73e0b0c8c7971"><div class="ttname"><a href="group__Setters.html#ga295f5fe63911d4c704b73e0b0c8c7971">covarianceBase::GetParFancyName</a></div><div class="ttdeci">std::string GetParFancyName(const int i) const</div><div class="ttdoc">Get fancy name of the Parameter.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00153">covarianceBase.h:153</a></div></div>
<div class="ttc" id="agroup__Setters_html_gafae8445e4cdef85c27c4863adb9e7fe4"><div class="ttname"><a href="group__Setters.html#gafae8445e4cdef85c27c4863adb9e7fe4">covarianceBase::getName</a></div><div class="ttdeci">std::string getName() const</div><div class="ttdoc">Get name of covariance.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00145">covarianceBase.h:145</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa6e490033dbd3db0965eaa443811f355" name="aa6e490033dbd3db0965eaa443811f355"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6e490033dbd3db0965eaa443811f355">&#9670;&#160;</a></span>GetCorrThrows()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double covarianceBase::GetCorrThrows </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return correlated throws. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>Parameter index </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00137">137</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  137</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#a7b70de3f098aae1d537d80bac5969d88">corr_throw</a>[i]; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5968a05b1139d72344ea08b8cd6c76c6" name="a5968a05b1139d72344ea08b8cd6c76c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5968a05b1139d72344ea08b8cd6c76c6">&#9670;&#160;</a></span>getCovMatrix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TMatrixDSym * covarianceBase::getCovMatrix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return covariance matrix. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00129">129</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  129</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#a6c3fe8db34c06299fd1633951ac00937">covMatrix</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a11075f684f5d2d7eff9c222867e33bb7" name="a11075f684f5d2d7eff9c222867e33bb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11075f684f5d2d7eff9c222867e33bb7">&#9670;&#160;</a></span>getDoAdaption()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool covarianceBase::getDoAdaption </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Do we adapt or not. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00178">178</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  178</span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#a838731abd6716940043b484b2b266f86">use_adaptive</a>;}</div>
<div class="ttc" id="aclasscovarianceBase_html_a838731abd6716940043b484b2b266f86"><div class="ttname"><a href="classcovarianceBase.html#a838731abd6716940043b484b2b266f86">covarianceBase::use_adaptive</a></div><div class="ttdeci">bool use_adaptive</div><div class="ttdoc">Are we using AMCMC?</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00498">covarianceBase.h:498</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="add3d24e738cde5a2f5ab1b2b377a2afb" name="add3d24e738cde5a2f5ab1b2b377a2afb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add3d24e738cde5a2f5ab1b2b377a2afb">&#9670;&#160;</a></span>getEigenValues()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const TVectorD covarianceBase::getEigenValues </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get eigen values for all parameters, if you want for decomposed only parameters use getEigenValuesMaster. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00285">285</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  285</span>                                         {</div>
<div class="line"><span class="lineno">  286</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>) { <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Am not running in PCA mode&quot;</span>); <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ ); }</div>
<div class="line"><span class="lineno">  287</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;eigen_values;</div>
<div class="line"><span class="lineno">  288</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a104f2d2f1b7f60693bba489ac4e753cc" name="a104f2d2f1b7f60693bba489ac4e753cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a104f2d2f1b7f60693bba489ac4e753cc">&#9670;&#160;</a></span>getEigenValuesMaster()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; double &gt; covarianceBase::getEigenValuesMaster </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get eigen value of only decomposed parameters, if you want for all parameters use getEigenValues. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00290">290</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  290</span>                                                        {</div>
<div class="line"><span class="lineno">  291</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>) { <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Am not running in PCA mode&quot;</span>); <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ ); }</div>
<div class="line"><span class="lineno">  292</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;eigen_values_master;</div>
<div class="line"><span class="lineno">  293</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad1b0e5f25843ee77ec1c6094856cda27" name="ad1b0e5f25843ee77ec1c6094856cda27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1b0e5f25843ee77ec1c6094856cda27">&#9670;&#160;</a></span>getEigenVectors()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const TMatrixD covarianceBase::getEigenVectors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get eigen vectors of covariance matrix, only works with PCA. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00280">280</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  280</span>                                          {</div>
<div class="line"><span class="lineno">  281</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>) { <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Am not running in PCA mode&quot;</span>); <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ ); }</div>
<div class="line"><span class="lineno">  282</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;eigen_vectors;</div>
<div class="line"><span class="lineno">  283</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0278e73361d955ab1e39984552acb3b7" name="a0278e73361d955ab1e39984552acb3b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0278e73361d955ab1e39984552acb3b7">&#9670;&#160;</a></span>getFlatPrior()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool covarianceBase::getFlatPrior </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get if param has flat prior or not. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>Parameter index </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00141">141</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  141</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#ad9c47deb7009bff81210f666e80012eb">_fFlatPrior</a>[i]; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a80262f5ee8ecb5b6195f188787b47f13" name="a80262f5ee8ecb5b6195f188787b47f13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80262f5ee8ecb5b6195f188787b47f13">&#9670;&#160;</a></span>GetGenerated()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double covarianceBase::GetGenerated </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return generated value for a given parameter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>Parameter index </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00242">242</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  242</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#a9b753f52711600a9f8d648531d95b044">_fGenerated</a>[i];}</div>
<div class="ttc" id="aclasscovarianceBase_html_a9b753f52711600a9f8d648531d95b044"><div class="ttname"><a href="classcovarianceBase.html#a9b753f52711600a9f8d648531d95b044">covarianceBase::_fGenerated</a></div><div class="ttdeci">std::vector&lt; double &gt; _fGenerated</div><div class="ttdoc">Generated value of the parameter.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00465">covarianceBase.h:465</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad047151c0216a32b3967a8a5bceb4eb0" name="ad047151c0216a32b3967a8a5bceb4eb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad047151c0216a32b3967a8a5bceb4eb0">&#9670;&#160;</a></span>getGeneratedValues()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; covarianceBase::getGeneratedValues </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the generated values of the parameters. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00225">225</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  225</span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#a9b753f52711600a9f8d648531d95b044">_fGenerated</a>;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1811a06eb22c5d76e3642085706fbaa0" name="a1811a06eb22c5d76e3642085706fbaa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1811a06eb22c5d76e3642085706fbaa0">&#9670;&#160;</a></span>GetGlobalStepScale()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double covarianceBase::GetGlobalStepScale </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get global step scale for covariance object. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00253">253</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  253</span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#a0088413d6a15d12cd34ec06166302f5c">_fGlobalStepScale</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a60159e8c0428a9b83187a28ce56f1c9e" name="a60159e8c0428a9b83187a28ce56f1c9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60159e8c0428a9b83187a28ce56f1c9e">&#9670;&#160;</a></span>GetIndivStepScale()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double covarianceBase::GetIndivStepScale </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ParameterIndex</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get individual step scale for selected parameter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ParameterIndex</td><td>Parameter index </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00251">251</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  251</span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#a3cda39026e336a49cef482efd4062561">_fIndivStepScale</a>.at(ParameterIndex); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a12221dba3e93480881d1195482ef6d87" name="a12221dba3e93480881d1195482ef6d87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12221dba3e93480881d1195482ef6d87">&#9670;&#160;</a></span>getInvCovMatrix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TMatrixDSym * covarianceBase::getInvCovMatrix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return inverted covariance matrix. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00131">131</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  131</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#a35c7dc7817eaf4058e9775b6bc792ebc">invCovMatrix</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5d3e0859942a48136bc446b0b6d5012a" name="a5d3e0859942a48136bc446b0b6d5012a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d3e0859942a48136bc446b0b6d5012a">&#9670;&#160;</a></span>GetInvCovMatrix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double covarianceBase::GetInvCovMatrix </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return inverted covariance matrix. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00133">133</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  133</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#a5973f7f446d6058af9bcd006a6cf562d">InvertCovMatrix</a>[i][j]; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9ee2fbfe0f1ac86c8c129095638e0f76" name="a9ee2fbfe0f1ac86c8c129095638e0f76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ee2fbfe0f1ac86c8c129095638e0f76">&#9670;&#160;</a></span>GetLikelihood()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double covarianceBase::GetLikelihood </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return CalcLikelihood if some params were thrown out of boundary return <em>LARGE_LOGL</em> </p>

<p>Reimplemented in <a class="el" href="classPyCovarianceBase.html#a8be2563cd8f0905deb6109e0c3068ec1">PyCovarianceBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00698">698</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  698</span>                                     {</div>
<div class="line"><span class="lineno">  699</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">  700</span>  <span class="comment">// Checkbounds and calclikelihood are virtual</span></div>
<div class="line"><span class="lineno">  701</span>  <span class="comment">// Default behaviour is to reject negative values + do std llh calculation</span></div>
<div class="line"><span class="lineno">  702</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> NOutside = <a class="code hl_function" href="classcovarianceBase.html#ab0e457ad3d7acfdc2b29b14a8553eee2">CheckBounds</a>();</div>
<div class="line"><span class="lineno">  703</span>  </div>
<div class="line"><span class="lineno">  704</span>  <span class="keywordflow">if</span>(NOutside &gt; 0) <span class="keywordflow">return</span> NOutside*<a class="code hl_variable" href="namespaceM3.html#aaf4ba720c8ab2982beaa3c243aee1b98">M3::_LARGE_LOGL_</a>;</div>
<div class="line"><span class="lineno">  705</span> </div>
<div class="line"><span class="lineno">  706</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="classcovarianceBase.html#a5aadbf9d0a50062ae401136dc6e60ffb">CalcLikelihood</a>();</div>
<div class="line"><span class="lineno">  707</span>}</div>
<div class="ttc" id="aclasscovarianceBase_html_a5aadbf9d0a50062ae401136dc6e60ffb"><div class="ttname"><a href="classcovarianceBase.html#a5aadbf9d0a50062ae401136dc6e60ffb">covarianceBase::CalcLikelihood</a></div><div class="ttdeci">double CalcLikelihood() const _noexcept_</div><div class="ttdoc">Calc penalty term based on inverted covariance matrix.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8cpp_source.html#l00661">covarianceBase.cpp:661</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_ab0e457ad3d7acfdc2b29b14a8553eee2"><div class="ttname"><a href="classcovarianceBase.html#ab0e457ad3d7acfdc2b29b14a8553eee2">covarianceBase::CheckBounds</a></div><div class="ttdeci">int CheckBounds() const _noexcept_</div><div class="ttdoc">Check if parameters were proposed outside physical boundary.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8cpp_source.html#l00683">covarianceBase.cpp:683</a></div></div>
<div class="ttc" id="anamespaceM3_html_aaf4ba720c8ab2982beaa3c243aee1b98"><div class="ttname"><a href="namespaceM3.html#aaf4ba720c8ab2982beaa3c243aee1b98">M3::_LARGE_LOGL_</a></div><div class="ttdeci">static constexpr const double _LARGE_LOGL_</div><div class="ttdoc">Large Likelihood is used it parameter go out of physical boundary, this indicates in MCMC that such s...</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00052">Core.h:52</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2fa216c45b8e66e15091cffcefcc85ce" name="a2fa216c45b8e66e15091cffcefcc85ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fa216c45b8e66e15091cffcefcc85ce">&#9670;&#160;</a></span>GetLowerBound()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double covarianceBase::GetLowerBound </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get lower parameter bound in which it is physically valid. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>Parameter index </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00248">248</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  248</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#a8f1d94838f188cc85c4f82557c0b0b66">_fLowBound</a>[i]; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5bf31f7d7a5e24c49d4157d411080dbf" name="a5bf31f7d7a5e24c49d4157d411080dbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bf31f7d7a5e24c49d4157d411080dbf">&#9670;&#160;</a></span>getNominal()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double covarianceBase::getNominal </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return generated value, although is virtual so class inheriting might actual get prior not generated. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>Parameter index </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classPyCovarianceBase.html#a51a06669bbb2dfb5dd4f189592576878">PyCovarianceBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00239">239</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  239</span>{ <span class="keywordflow">return</span> <a class="code hl_function" href="classcovarianceBase.html#add825b13bf6604725577cb229f8372d8">getParInit</a>(i); }</div>
<div class="ttc" id="aclasscovarianceBase_html_add825b13bf6604725577cb229f8372d8"><div class="ttname"><a href="classcovarianceBase.html#add825b13bf6604725577cb229f8372d8">covarianceBase::getParInit</a></div><div class="ttdeci">double getParInit(const int i) const</div><div class="ttdoc">Get prior parameter value.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00236">covarianceBase.h:236</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae0a231f87266048a3cd2e0032eaf0f30" name="ae0a231f87266048a3cd2e0032eaf0f30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0a231f87266048a3cd2e0032eaf0f30">&#9670;&#160;</a></span>getNominalArray()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; covarianceBase::getNominalArray </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the prior array for parameters. </p>

<p>Reimplemented in <a class="el" href="classcovarianceXsec.html#a98cf4b870e62badc83bcda99ae3574ae">covarianceXsec</a>, and <a class="el" href="classPyCovarianceBase.html#a895c823ae3d9660c1cfa6dcde97886d5">PyCovarianceBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l01148">1148</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1148</span>                                                  {</div>
<div class="line"><span class="lineno"> 1149</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno"> 1150</span>  std::vector&lt;double&gt; prior(<a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><span class="lineno"> 1151</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; ++i)</div>
<div class="line"><span class="lineno"> 1152</span>  {</div>
<div class="line"><span class="lineno"> 1153</span>    prior[i] = <a class="code hl_variable" href="classcovarianceBase.html#a7578a2cc2e8e9100fad88310a824cb1c">_fPreFitValue</a>[i];</div>
<div class="line"><span class="lineno"> 1154</span>  }</div>
<div class="line"><span class="lineno"> 1155</span>  <span class="keywordflow">return</span> prior;</div>
<div class="line"><span class="lineno"> 1156</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a261941a4c06e5d875174d8769a4d02f1" name="a261941a4c06e5d875174d8769a4d02f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a261941a4c06e5d875174d8769a4d02f1">&#9670;&#160;</a></span>getNpars()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int covarianceBase::getNpars </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get number of params which will be different depending if using Eigen decomposition or not. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00330">330</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  330</span>                        {</div>
<div class="line"><span class="lineno">  331</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>) <span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#ac57285a48d41ef764b4c659959a36c2d">_fNumParPCA</a>;</div>
<div class="line"><span class="lineno">  332</span>    <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>;</div>
<div class="line"><span class="lineno">  333</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a87f80dff42b1f82433aaa7f69966343a" name="a87f80dff42b1f82433aaa7f69966343a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87f80dff42b1f82433aaa7f69966343a">&#9670;&#160;</a></span>GetNumParams()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int covarianceBase::GetNumParams </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get total number of parameters. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00219">219</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  219</span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab89b754afc93b63f41070710af4c0f2d" name="ab89b754afc93b63f41070710af4c0f2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab89b754afc93b63f41070710af4c0f2d">&#9670;&#160;</a></span>getParameterMeans()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; covarianceBase::getParameterMeans </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the parameter means used in the adaptive handler. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00195">195</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  195</span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#ab3833dc51a81afc9dca7c3dcbb107af7">AdaptiveHandler</a>.<a class="code hl_variable" href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#a066984e9598e073d04edec51511cdf0a">par_means</a>;}</div>
<div class="ttc" id="aclassadaptive__mcmc_1_1AdaptiveMCMCHandler_html_a066984e9598e073d04edec51511cdf0a"><div class="ttname"><a href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#a066984e9598e073d04edec51511cdf0a">adaptive_mcmc::AdaptiveMCMCHandler::par_means</a></div><div class="ttdeci">std::vector&lt; double &gt; par_means</div><div class="ttdoc">Mean values for all parameters.</div><div class="ttdef"><b>Definition:</b> <a href="AdaptiveMCMCHandler_8h_source.html#l00087">AdaptiveMCMCHandler.h:87</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_ab3833dc51a81afc9dca7c3dcbb107af7"><div class="ttname"><a href="classcovarianceBase.html#ab3833dc51a81afc9dca7c3dcbb107af7">covarianceBase::AdaptiveHandler</a></div><div class="ttdeci">adaptive_mcmc::AdaptiveMCMCHandler AdaptiveHandler</div><div class="ttdoc">Struct containing information about adaption.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00503">covarianceBase.h:503</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a532619abf240021223f48fa73869106b" name="a532619abf240021223f48fa73869106b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a532619abf240021223f48fa73869106b">&#9670;&#160;</a></span>getParCurr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double covarianceBase::getParCurr </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get current parameter value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>Parameter index </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00233">233</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  233</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#ae70f51df3976975b2dc78fd3bfc28b65">_fCurrVal</a>[i]; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af4c0edbf1bd150484bc4696480ef9a77" name="af4c0edbf1bd150484bc4696480ef9a77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4c0edbf1bd150484bc4696480ef9a77">&#9670;&#160;</a></span>getParCurr_PCA()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double covarianceBase::getParCurr_PCA </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get current parameter value using PCA. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>Parameter index </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00263">263</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  263</span>                                            {</div>
<div class="line"><span class="lineno">  264</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>) { <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Am not running in PCA mode&quot;</span>); <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ ); }</div>
<div class="line"><span class="lineno">  265</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;fParCurr_PCA(i);</div>
<div class="line"><span class="lineno">  266</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="add825b13bf6604725577cb229f8372d8" name="add825b13bf6604725577cb229f8372d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add825b13bf6604725577cb229f8372d8">&#9670;&#160;</a></span>getParInit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double covarianceBase::getParInit </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get prior parameter value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>Parameter index </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00236">236</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  236</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#a7578a2cc2e8e9100fad88310a824cb1c">_fPreFitValue</a>[i]; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af298d9a2d624b02c4953e735d870fcf5" name="af298d9a2d624b02c4953e735d870fcf5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af298d9a2d624b02c4953e735d870fcf5">&#9670;&#160;</a></span>getParProp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double covarianceBase::getParProp </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get proposed parameter value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>Parameter index </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00230">230</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  230</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[i]; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3e29910a1706f60db5f615b3b6f05994" name="a3e29910a1706f60db5f615b3b6f05994"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e29910a1706f60db5f615b3b6f05994">&#9670;&#160;</a></span>getParProp_PCA()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double covarianceBase::getParProp_PCA </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get current parameter value using PCA. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>Parameter index </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00256">256</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  256</span>                                             {</div>
<div class="line"><span class="lineno">  257</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>) { <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Am not running in PCA mode&quot;</span>); <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ ); }</div>
<div class="line"><span class="lineno">  258</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;fParProp_PCA(i);</div>
<div class="line"><span class="lineno">  259</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a43c569248e176e14330cd002bfc2bff6" name="a43c569248e176e14330cd002bfc2bff6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43c569248e176e14330cd002bfc2bff6">&#9670;&#160;</a></span>getParPropVec()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; double &gt; &amp; covarianceBase::getParPropVec </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get a reference to the proposed parameter values Can be useful if you want to track these without having to copy values using <a class="el" href="classcovarianceBase.html#a63db139faf1e42d7a1c3c3c661c0b7d9" title="Get vector of all proposed parameter values.">getProposed()</a> </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00215">215</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  215</span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3961d4bdb1479609dbc1b01401fb765f" name="a3961d4bdb1479609dbc1b01401fb765f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3961d4bdb1479609dbc1b01401fb765f">&#9670;&#160;</a></span>getPreFitValues()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; covarianceBase::getPreFitValues </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the pre-fit values of the parameters. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00223">223</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  223</span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#a7578a2cc2e8e9100fad88310a824cb1c">_fPreFitValue</a>;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a63db139faf1e42d7a1c3c3c661c0b7d9" name="a63db139faf1e42d7a1c3c3c661c0b7d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63db139faf1e42d7a1c3c3c661c0b7d9">&#9670;&#160;</a></span>getProposed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; covarianceBase::getProposed </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get vector of all proposed parameter values. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00366">366</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  366</span>                                                    {</div>
<div class="line"><span class="lineno">  367</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">  368</span>  std::vector&lt;double&gt; props(<a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><span class="lineno">  369</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; ++i) props[i] = <a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[i];</div>
<div class="line"><span class="lineno">  370</span>  <span class="keywordflow">return</span> props;</div>
<div class="line"><span class="lineno">  371</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac32b276beb1fa595404bf1b9a62ef9c2" name="ac32b276beb1fa595404bf1b9a62ef9c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac32b276beb1fa595404bf1b9a62ef9c2">&#9670;&#160;</a></span>GetRandomThrow()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double covarianceBase::GetRandomThrow </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get random value useful for debugging/CI. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>Parameter index </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00083">83</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   83</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#a705e648220c06083cd1acc5fba4f2ef7">randParams</a>[i];}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa306bea2b30013ca55f2a95b8d16ec42" name="aa306bea2b30013ca55f2a95b8d16ec42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa306bea2b30013ca55f2a95b8d16ec42">&#9670;&#160;</a></span>getThrowMatrix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TMatrixDSym * covarianceBase::getThrowMatrix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get matrix used for step proposal. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00189">189</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  189</span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#a6cb3d0b4096fbb55b040f70cd5b6e32b">throwMatrix</a>;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a15273ab6a1a9b189cca2ac62339a1b66" name="a15273ab6a1a9b189cca2ac62339a1b66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15273ab6a1a9b189cca2ac62339a1b66">&#9670;&#160;</a></span>GetThrowMatrix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double covarianceBase::GetThrowMatrix </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get matrix used for step proposal. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00191">191</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  191</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#aca17e48a5fa8e353317d58c205fb89df">throwMatrixCholDecomp</a>[i][j];}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a563a904298d0bd5ec5518708396e0e22" name="a563a904298d0bd5ec5518708396e0e22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a563a904298d0bd5ec5518708396e0e22">&#9670;&#160;</a></span>getThrowMatrix_CholDecomp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TMatrixD * covarianceBase::getThrowMatrix_CholDecomp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the Cholesky decomposition of the throw matrix. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00193">193</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  193</span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#ab95f5e066c2dfb1d20d120bc6c85dda2">throwMatrix_CholDecomp</a>;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="acdcf459e3ef443e93c66d83cde87e238" name="acdcf459e3ef443e93c66d83cde87e238"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdcf459e3ef443e93c66d83cde87e238">&#9670;&#160;</a></span>getTransferMatrix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const TMatrixD covarianceBase::getTransferMatrix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get transfer matrix allowing to go from PCA base to normal base. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00275">275</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  275</span>                                            {</div>
<div class="line"><span class="lineno">  276</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>) { <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Am not running in PCA mode&quot;</span>); <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ ); }</div>
<div class="line"><span class="lineno">  277</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;TransferMat;</div>
<div class="line"><span class="lineno">  278</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9a350821c0cf735a32934c6b27b87c5e" name="a9a350821c0cf735a32934c6b27b87c5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a350821c0cf735a32934c6b27b87c5e">&#9670;&#160;</a></span>GetUpperBound()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double covarianceBase::GetUpperBound </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get upper parameter bound in which it is physically valid. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>Parameter index </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00245">245</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  245</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#a31e636cb6de871bd0c2c8e7e299df9e7">_fUpBound</a>[i];}</div>
</div><!-- fragment -->
</div>
</div>
<a id="acec1e1c7fd83d21e1ad55a03acfeb8c4" name="acec1e1c7fd83d21e1ad55a03acfeb8c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acec1e1c7fd83d21e1ad55a03acfeb8c4">&#9670;&#160;</a></span>init() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::init </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>YAMLFile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialisation of the class using config. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">YAMLFile</td><td>A vector of strings representing the YAML files used for initialisation of matrix </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00148">148</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  148</span>                                                              {</div>
<div class="line"><span class="lineno">  149</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">  150</span>  <a class="code hl_variable" href="classcovarianceBase.html#a933ff3dc0af99629ba3582a5d9d89d23">_fYAMLDoc</a>[<span class="stringliteral">&quot;Systematics&quot;</span>] = YAML::Node(YAML::NodeType::Sequence);</div>
<div class="line"><span class="lineno">  151</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; YAMLFile.size(); i++)</div>
<div class="line"><span class="lineno">  152</span>  {</div>
<div class="line"><span class="lineno">  153</span>    YAML::Node YAMLDocTemp = <a class="code hl_define" href="YamlHelper_8h.html#ad802d5a5acdc16a796b21af74f6f5f59">M3OpenConfig</a>(YAMLFile[i]);</div>
<div class="line"><span class="lineno">  154</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; item : YAMLDocTemp[<span class="stringliteral">&quot;Systematics&quot;</span>]) {</div>
<div class="line"><span class="lineno">  155</span>      <a class="code hl_variable" href="classcovarianceBase.html#a933ff3dc0af99629ba3582a5d9d89d23">_fYAMLDoc</a>[<span class="stringliteral">&quot;Systematics&quot;</span>].push_back(item);</div>
<div class="line"><span class="lineno">  156</span>    }</div>
<div class="line"><span class="lineno">  157</span>  }</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nThreads = <a class="code hl_function" href="namespaceM3.html#ad1896bacf74c409a461dd1ea43f8bc99">M3::GetNThreads</a>();</div>
<div class="line"><span class="lineno">  160</span>  <span class="comment">//KS: set Random numbers for each thread so each thread has different seed</span></div>
<div class="line"><span class="lineno">  161</span>  <span class="comment">//or for one thread if without MULTITHREAD</span></div>
<div class="line"><span class="lineno">  162</span>  <a class="code hl_variable" href="classcovarianceBase.html#a0704c430bdc8e87fd6f03f01b2ab00df">random_number</a>.reserve(nThreads);</div>
<div class="line"><span class="lineno">  163</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iThread = 0; iThread &lt; nThreads; iThread++) {</div>
<div class="line"><span class="lineno">  164</span>    <a class="code hl_variable" href="classcovarianceBase.html#a0704c430bdc8e87fd6f03f01b2ab00df">random_number</a>.emplace_back(std::make_unique&lt;TRandom3&gt;(0));</div>
<div class="line"><span class="lineno">  165</span>  }</div>
<div class="line"><span class="lineno">  166</span>  <a class="code hl_variable" href="classcovarianceBase.html#a8d821ce805f2426fe95549170866821f">PrintLength</a> = 35;</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>  <span class="comment">// Set the covariance matrix</span></div>
<div class="line"><span class="lineno">  169</span>  <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a> = int(<a class="code hl_variable" href="classcovarianceBase.html#a933ff3dc0af99629ba3582a5d9d89d23">_fYAMLDoc</a>[<span class="stringliteral">&quot;Systematics&quot;</span>].<a class="code hl_variable" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>());</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>  <a class="code hl_variable" href="classcovarianceBase.html#a838731abd6716940043b484b2b266f86">use_adaptive</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>  <a class="code hl_variable" href="classcovarianceBase.html#a5973f7f446d6058af9bcd006a6cf562d">InvertCovMatrix</a>.resize(<a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>, std::vector&lt;double&gt;(<a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>, 0.0));</div>
<div class="line"><span class="lineno">  174</span>  <a class="code hl_variable" href="classcovarianceBase.html#aca17e48a5fa8e353317d58c205fb89df">throwMatrixCholDecomp</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>*[<a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>]();</div>
<div class="line"><span class="lineno">  175</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; i++) {</div>
<div class="line"><span class="lineno">  176</span>    <a class="code hl_variable" href="classcovarianceBase.html#aca17e48a5fa8e353317d58c205fb89df">throwMatrixCholDecomp</a>[i] = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>]();</div>
<div class="line"><span class="lineno">  177</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; j++) {</div>
<div class="line"><span class="lineno">  178</span>      <a class="code hl_variable" href="classcovarianceBase.html#aca17e48a5fa8e353317d58c205fb89df">throwMatrixCholDecomp</a>[i][j] = 0.;</div>
<div class="line"><span class="lineno">  179</span>    }</div>
<div class="line"><span class="lineno">  180</span>  }</div>
<div class="line"><span class="lineno">  181</span>  <a class="code hl_function" href="classcovarianceBase.html#a75b5553823335bb82026ff46369fb67e">ReserveMemory</a>(<a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>  TMatrixDSym* _fCovMatrix = <span class="keyword">new</span> TMatrixDSym(<a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><span class="lineno">  184</span>  <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><span class="lineno">  185</span>  std::vector&lt;std::map&lt;std::string,double&gt;&gt; Correlations(<a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><span class="lineno">  186</span>  std::map&lt;std::string, int&gt; CorrNamesMap;</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>  <span class="comment">//ETA - read in the systematics. Would be good to add in some checks to make sure</span></div>
<div class="line"><span class="lineno">  189</span>  <span class="comment">//that there are the correct number of entries i.e. are the _fNumPar for Names,</span></div>
<div class="line"><span class="lineno">  190</span>  <span class="comment">//PreFitValues etc etc.</span></div>
<div class="line"><span class="lineno">  191</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> &amp;param : <a class="code hl_variable" href="classcovarianceBase.html#a933ff3dc0af99629ba3582a5d9d89d23">_fYAMLDoc</a>[<span class="stringliteral">&quot;Systematics&quot;</span>])</div>
<div class="line"><span class="lineno">  192</span>  {</div>
<div class="line"><span class="lineno">  193</span>    <a class="code hl_variable" href="classcovarianceBase.html#a973671386a2f8ea924f25f8f5404654c">_fFancyNames</a>[i] = Get&lt;std::string&gt;(param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;Names&quot;</span>][<span class="stringliteral">&quot;FancyName&quot;</span>], __FILE__ , __LINE__);</div>
<div class="line"><span class="lineno">  194</span>    <a class="code hl_variable" href="classcovarianceBase.html#a7578a2cc2e8e9100fad88310a824cb1c">_fPreFitValue</a>[i] = Get&lt;double&gt;(param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;ParameterValues&quot;</span>][<span class="stringliteral">&quot;PreFitValue&quot;</span>], __FILE__ , __LINE__);</div>
<div class="line"><span class="lineno">  195</span>    <a class="code hl_variable" href="classcovarianceBase.html#a9b753f52711600a9f8d648531d95b044">_fGenerated</a>[i] = Get&lt;double&gt;(param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;ParameterValues&quot;</span>][<span class="stringliteral">&quot;Generated&quot;</span>], __FILE__ , __LINE__);</div>
<div class="line"><span class="lineno">  196</span>    <a class="code hl_variable" href="classcovarianceBase.html#a3cda39026e336a49cef482efd4062561">_fIndivStepScale</a>[i] = Get&lt;double&gt;(param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;StepScale&quot;</span>][<span class="stringliteral">&quot;MCMC&quot;</span>], __FILE__ , __LINE__);</div>
<div class="line"><span class="lineno">  197</span>    <a class="code hl_variable" href="classcovarianceBase.html#a34f877fc160b4a93a3aab1b3a8977858">_fError</a>[i] = Get&lt;double&gt;(param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;Error&quot;</span>], __FILE__ , __LINE__);</div>
<div class="line"><span class="lineno">  198</span>    <a class="code hl_variable" href="classcovarianceBase.html#a267523bb0f78c27208000b2856f741da">_fDetID</a>[i] = GetFromManager&lt;std::vector&lt;std::string&gt;&gt;(param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;DetID&quot;</span>], {}, __FILE__, __LINE__);</div>
<div class="line"><span class="lineno">  199</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classcovarianceBase.html#a34f877fc160b4a93a3aab1b3a8977858">_fError</a>[i] &lt;= 0) {</div>
<div class="line"><span class="lineno">  200</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Error for param {}({}) is negative and equal to {}&quot;</span>, <a class="code hl_variable" href="classcovarianceBase.html#a973671386a2f8ea924f25f8f5404654c">_fFancyNames</a>[i], i, <a class="code hl_variable" href="classcovarianceBase.html#a34f877fc160b4a93a3aab1b3a8977858">_fError</a>[i]);</div>
<div class="line"><span class="lineno">  201</span>      <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">  202</span>    }</div>
<div class="line"><span class="lineno">  203</span>    <span class="comment">//ETA - a bit of a fudge but works</span></div>
<div class="line"><span class="lineno">  204</span>    <span class="keyword">auto</span> TempBoundsVec = Get&lt;std::vector&lt;double&gt;&gt;(param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;ParameterBounds&quot;</span>], __FILE__ , __LINE__);</div>
<div class="line"><span class="lineno">  205</span>    <span class="keywordflow">if</span>(TempBoundsVec.size() != 2) {</div>
<div class="line"><span class="lineno">  206</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Size of param bounds isn&#39;t 2 and is equal to {}&quot;</span>, TempBoundsVec.size());</div>
<div class="line"><span class="lineno">  207</span>      <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">  208</span>    }</div>
<div class="line"><span class="lineno">  209</span>    <a class="code hl_variable" href="classcovarianceBase.html#a8f1d94838f188cc85c4f82557c0b0b66">_fLowBound</a>[i] = TempBoundsVec[0];</div>
<div class="line"><span class="lineno">  210</span>    <a class="code hl_variable" href="classcovarianceBase.html#a31e636cb6de871bd0c2c8e7e299df9e7">_fUpBound</a>[i] = TempBoundsVec[1];</div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span>    <span class="comment">//ETA - now for parameters which are optional and have default values</span></div>
<div class="line"><span class="lineno">  213</span>    <a class="code hl_variable" href="classcovarianceBase.html#ad9c47deb7009bff81210f666e80012eb">_fFlatPrior</a>[i] = GetFromManager&lt;bool&gt;(param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;FlatPrior&quot;</span>], <span class="keyword">false</span>, __FILE__ , __LINE__);</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>    <span class="comment">// Allow to fix param, this setting should be used only for params which are permanently fixed like baseline, please use global config for fixing param more flexibly</span></div>
<div class="line"><span class="lineno">  216</span>    <span class="keywordflow">if</span>(GetFromManager&lt;bool&gt;(param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;FixParam&quot;</span>], <span class="keyword">false</span>, __FILE__ , __LINE__)) {</div>
<div class="line"><span class="lineno">  217</span>      <a class="code hl_function" href="classcovarianceBase.html#aafbbdc05b87df882dc341e20fe870603">toggleFixParameter</a>(<a class="code hl_variable" href="classcovarianceBase.html#a973671386a2f8ea924f25f8f5404654c">_fFancyNames</a>[i]);</div>
<div class="line"><span class="lineno">  218</span>    }</div>
<div class="line"><span class="lineno">  219</span>    <span class="comment">//Fill the map to get the correlations later as well</span></div>
<div class="line"><span class="lineno">  220</span>    CorrNamesMap[param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;Names&quot;</span>][<span class="stringliteral">&quot;FancyName&quot;</span>].as&lt;std::string&gt;()]=i;</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span>    <span class="comment">//Also loop through the correlations</span></div>
<div class="line"><span class="lineno">  223</span>    <span class="keywordflow">if</span>(param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;Correlations&quot;</span>]) {</div>
<div class="line"><span class="lineno">  224</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Corr_i = 0; Corr_i &lt; param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;Correlations&quot;</span>].size(); ++Corr_i){</div>
<div class="line"><span class="lineno">  225</span>        <span class="keywordflow">for</span> (YAML::const_iterator it = param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;Correlations&quot;</span>][Corr_i].begin(); it!=param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;Correlations&quot;</span>][Corr_i].end();++it) {</div>
<div class="line"><span class="lineno">  226</span>          Correlations[i][it-&gt;first.as&lt;std::string&gt;()] = it-&gt;second.as&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><span class="lineno">  227</span>        }</div>
<div class="line"><span class="lineno">  228</span>      }</div>
<div class="line"><span class="lineno">  229</span>    }</div>
<div class="line"><span class="lineno">  230</span>    i++;</div>
<div class="line"><span class="lineno">  231</span>  } <span class="comment">// end loop over para</span></div>
<div class="line"><span class="lineno">  232</span>  <span class="keywordflow">if</span>(i != <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>) {</div>
<div class="line"><span class="lineno">  233</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a07ff6d6a15b24f94afc88a1b89779beb">MACH3LOG_CRITICAL</a>(<span class="stringliteral">&quot;Inconsistent number of params in Yaml  {} vs {}, this indicate wrong syntax&quot;</span>, i, i, <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><span class="lineno">  234</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">  235</span>  }</div>
<div class="line"><span class="lineno">  236</span>  <span class="comment">// ETA Now that we&#39;ve been through all systematic let&#39;s fill the covmatrix</span></div>
<div class="line"><span class="lineno">  237</span>  <span class="comment">//This makes the root TCov from YAML</span></div>
<div class="line"><span class="lineno">  238</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; j++) {</div>
<div class="line"><span class="lineno">  239</span>    (*_fCovMatrix)(j, j) = <a class="code hl_variable" href="classcovarianceBase.html#a34f877fc160b4a93a3aab1b3a8977858">_fError</a>[j]*<a class="code hl_variable" href="classcovarianceBase.html#a34f877fc160b4a93a3aab1b3a8977858">_fError</a>[j];</div>
<div class="line"><span class="lineno">  240</span>    <span class="comment">//Get the map of parameter name to correlation from the Correlations object</span></div>
<div class="line"><span class="lineno">  241</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; pair : Correlations[j]) {</div>
<div class="line"><span class="lineno">  242</span>      <span class="keyword">auto</span> <span class="keyword">const</span>&amp; key = pair.first;</div>
<div class="line"><span class="lineno">  243</span>      <span class="keyword">auto</span> <span class="keyword">const</span>&amp; val = pair.second;</div>
<div class="line"><span class="lineno">  244</span>      <span class="keywordtype">int</span> index = -1;</div>
<div class="line"><span class="lineno">  245</span>      <span class="comment">//If you found the parameter name then get the index</span></div>
<div class="line"><span class="lineno">  246</span>      <span class="keywordflow">if</span> (CorrNamesMap.find(key) != CorrNamesMap.end()) {</div>
<div class="line"><span class="lineno">  247</span>        index = CorrNamesMap[key];</div>
<div class="line"><span class="lineno">  248</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  249</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Parameter {} not in list! Check your spelling?&quot;</span>, key);</div>
<div class="line"><span class="lineno">  250</span>        <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">  251</span>      }</div>
<div class="line"><span class="lineno">  252</span>      <span class="keywordtype">double</span> Corr1 = val;</div>
<div class="line"><span class="lineno">  253</span>      <span class="keywordtype">double</span> Corr2 = 0;</div>
<div class="line"><span class="lineno">  254</span>      <span class="keywordflow">if</span>(Correlations[index].find(<a class="code hl_variable" href="classcovarianceBase.html#a973671386a2f8ea924f25f8f5404654c">_fFancyNames</a>[j]) != Correlations[index].end()) {</div>
<div class="line"><span class="lineno">  255</span>        Corr2 = Correlations[index][<a class="code hl_variable" href="classcovarianceBase.html#a973671386a2f8ea924f25f8f5404654c">_fFancyNames</a>[j]];</div>
<div class="line"><span class="lineno">  256</span>        <span class="comment">//Do they agree to better than float precision?</span></div>
<div class="line"><span class="lineno">  257</span>        <span class="keywordflow">if</span>(std::abs(Corr2 - Corr1) &gt; FLT_EPSILON) {</div>
<div class="line"><span class="lineno">  258</span>          <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Correlations are not equal between {} and {}&quot;</span>, <a class="code hl_variable" href="classcovarianceBase.html#a973671386a2f8ea924f25f8f5404654c">_fFancyNames</a>[j], key);</div>
<div class="line"><span class="lineno">  259</span>          <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Got : {} and {}&quot;</span>, Corr2, Corr1);</div>
<div class="line"><span class="lineno">  260</span>          <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">  261</span>        }</div>
<div class="line"><span class="lineno">  262</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  263</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Correlation does not appear reciprocally between {} and {}&quot;</span>, <a class="code hl_variable" href="classcovarianceBase.html#a973671386a2f8ea924f25f8f5404654c">_fFancyNames</a>[j], key);</div>
<div class="line"><span class="lineno">  264</span>        <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">  265</span>      }</div>
<div class="line"><span class="lineno">  266</span>      (*_fCovMatrix)(j, index)= (*_fCovMatrix)(index, j) = Corr1*<a class="code hl_variable" href="classcovarianceBase.html#a34f877fc160b4a93a3aab1b3a8977858">_fError</a>[j]*<a class="code hl_variable" href="classcovarianceBase.html#a34f877fc160b4a93a3aab1b3a8977858">_fError</a>[index];</div>
<div class="line"><span class="lineno">  267</span>    }</div>
<div class="line"><span class="lineno">  268</span>  }</div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span>  <span class="comment">//Now make positive definite</span></div>
<div class="line"><span class="lineno">  271</span>  <a class="code hl_function" href="classcovarianceBase.html#ae2850c8e2f2d4acfe322b0ebe65b07cf">MakePosDef</a>(_fCovMatrix);</div>
<div class="line"><span class="lineno">  272</span>  <a class="code hl_function" href="group__Setters.html#ga5f28f7294d25cca6334f7033a63596b9">setCovMatrix</a>(_fCovMatrix);</div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a> &lt;= 0) {</div>
<div class="line"><span class="lineno">  275</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Covariance object has {} systematics!&quot;</span>, <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><span class="lineno">  276</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">  277</span>  }</div>
<div class="line"><span class="lineno">  278</span>  <a class="code hl_variable" href="classcovarianceBase.html#ac57285a48d41ef764b4c659959a36c2d">_fNumParPCA</a> = <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>;</div>
<div class="line"><span class="lineno">  279</span> </div>
<div class="line"><span class="lineno">  280</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Created covariance matrix from files: &quot;</span>);</div>
<div class="line"><span class="lineno">  281</span>  <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;file : YAMLFile){</div>
<div class="line"><span class="lineno">  282</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{} &quot;</span>, file);</div>
<div class="line"><span class="lineno">  283</span>  }</div>
<div class="line"><span class="lineno">  284</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;----------------&quot;</span>);</div>
<div class="line"><span class="lineno">  285</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Found {} systematics parameters in total&quot;</span>, <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><span class="lineno">  286</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;----------------&quot;</span>);</div>
<div class="line"><span class="lineno">  287</span>}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a07ff6d6a15b24f94afc88a1b89779beb"><div class="ttname"><a href="MaCh3Logger_8h.html#a07ff6d6a15b24f94afc88a1b89779beb">MACH3LOG_CRITICAL</a></div><div class="ttdeci">#define MACH3LOG_CRITICAL</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00026">MaCh3Logger.h:26</a></div></div>
<div class="ttc" id="aYamlHelper_8h_html_ad802d5a5acdc16a796b21af74f6f5f59"><div class="ttname"><a href="YamlHelper_8h.html#ad802d5a5acdc16a796b21af74f6f5f59">M3OpenConfig</a></div><div class="ttdeci">#define M3OpenConfig(filename)</div><div class="ttdoc">Macro to simplify calling LoadYaml with file and line info.</div><div class="ttdef"><b>Definition:</b> <a href="YamlHelper_8h_source.html#l00328">YamlHelper.h:328</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a0704c430bdc8e87fd6f03f01b2ab00df"><div class="ttname"><a href="classcovarianceBase.html#a0704c430bdc8e87fd6f03f01b2ab00df">covarianceBase::random_number</a></div><div class="ttdeci">std::vector&lt; std::unique_ptr&lt; TRandom3 &gt; &gt; random_number</div><div class="ttdoc">KS: Set Random numbers for each thread so each thread has different seed.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00438">covarianceBase.h:438</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a75b5553823335bb82026ff46369fb67e"><div class="ttname"><a href="classcovarianceBase.html#a75b5553823335bb82026ff46369fb67e">covarianceBase::ReserveMemory</a></div><div class="ttdeci">void ReserveMemory(const int size)</div><div class="ttdoc">Initialise vectors with parameters information.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8cpp_source.html#l00313">covarianceBase.cpp:313</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a8d821ce805f2426fe95549170866821f"><div class="ttname"><a href="classcovarianceBase.html#a8d821ce805f2426fe95549170866821f">covarianceBase::PrintLength</a></div><div class="ttdeci">int PrintLength</div><div class="ttdoc">KS: This is used when printing parameters, sometimes we have super long parameters name,...</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00448">covarianceBase.h:448</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a973671386a2f8ea924f25f8f5404654c"><div class="ttname"><a href="classcovarianceBase.html#a973671386a2f8ea924f25f8f5404654c">covarianceBase::_fFancyNames</a></div><div class="ttdeci">std::vector&lt; std::string &gt; _fFancyNames</div><div class="ttdoc">Fancy name for example rather than xsec_0 it is MAQE, useful for human reading.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00453">covarianceBase.h:453</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_aafbbdc05b87df882dc341e20fe870603"><div class="ttname"><a href="classcovarianceBase.html#aafbbdc05b87df882dc341e20fe870603">covarianceBase::toggleFixParameter</a></div><div class="ttdeci">void toggleFixParameter(const int i)</div><div class="ttdoc">fix parameter at prior values</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8cpp_source.html#l00802">covarianceBase.cpp:802</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_ae2850c8e2f2d4acfe322b0ebe65b07cf"><div class="ttname"><a href="classcovarianceBase.html#ae2850c8e2f2d4acfe322b0ebe65b07cf">covarianceBase::MakePosDef</a></div><div class="ttdeci">void MakePosDef(TMatrixDSym *cov=nullptr)</div><div class="ttdoc">Make matrix positive definite by adding small values to diagonal, necessary for inverting matrix.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8cpp_source.html#l00935">covarianceBase.cpp:935</a></div></div>
<div class="ttc" id="agroup__Setters_html_ga5f28f7294d25cca6334f7033a63596b9"><div class="ttname"><a href="group__Setters.html#ga5f28f7294d25cca6334f7033a63596b9">covarianceBase::setCovMatrix</a></div><div class="ttdeci">void setCovMatrix(TMatrixDSym *cov)</div><div class="ttdoc">Set covariance matrix.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8cpp_source.html#l00291">covarianceBase.cpp:291</a></div></div>
<div class="ttc" id="anamespaceM3_html_ad1896bacf74c409a461dd1ea43f8bc99"><div class="ttname"><a href="namespaceM3.html#ad1896bacf74c409a461dd1ea43f8bc99">M3::GetNThreads</a></div><div class="ttdeci">int GetNThreads()</div><div class="ttdoc">number of threads which we need for example for TRandom3</div><div class="ttdef"><b>Definition:</b> <a href="Monitor_8cpp_source.html#l00295">Monitor.cpp:295</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2960c489f6aafdb5a2291e1a48b14e9a" name="a2960c489f6aafdb5a2291e1a48b14e9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2960c489f6aafdb5a2291e1a48b14e9a">&#9670;&#160;</a></span>init() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::init </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialisation of the class using matrix from root file. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00085">85</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   85</span>                                                        {</div>
<div class="line"><span class="lineno">   86</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">   87</span>  <span class="comment">// Set the covariance matrix from input ROOT file (e.g. flux, ND280, NIWG)</span></div>
<div class="line"><span class="lineno">   88</span>  TFile *infile = <span class="keyword">new</span> TFile(file.c_str(), <span class="stringliteral">&quot;READ&quot;</span>);</div>
<div class="line"><span class="lineno">   89</span>  <span class="keywordflow">if</span> (infile-&gt;IsZombie()) {</div>
<div class="line"><span class="lineno">   90</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Could not open input covariance ROOT file {} !!!&quot;</span>, file);</div>
<div class="line"><span class="lineno">   91</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Was about to retrieve matrix with name {}&quot;</span>, name);</div>
<div class="line"><span class="lineno">   92</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">   93</span>  }</div>
<div class="line"><span class="lineno">   94</span> </div>
<div class="line"><span class="lineno">   95</span>  TMatrixDSym *CovMat = <span class="keyword">static_cast&lt;</span>TMatrixDSym*<span class="keyword">&gt;</span>(infile-&gt;Get(name.c_str()));</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>  <span class="keywordflow">if</span> (!CovMat) {</div>
<div class="line"><span class="lineno">   98</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Could not find covariance matrix name {} in file {}&quot;</span>, name, file);</div>
<div class="line"><span class="lineno">   99</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Are you really sure {} exists in the file?&quot;</span>, name);</div>
<div class="line"><span class="lineno">  100</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">  101</span>  } </div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>  <a class="code hl_variable" href="classcovarianceBase.html#a8d821ce805f2426fe95549170866821f">PrintLength</a> = 35;</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nThreads = <a class="code hl_function" href="namespaceM3.html#ad1896bacf74c409a461dd1ea43f8bc99">M3::GetNThreads</a>();</div>
<div class="line"><span class="lineno">  106</span>  <span class="comment">//KS: set Random numbers for each thread so each thread has different seed</span></div>
<div class="line"><span class="lineno">  107</span>  <span class="comment">//or for one thread if without MULTITHREAD</span></div>
<div class="line"><span class="lineno">  108</span>  <a class="code hl_variable" href="classcovarianceBase.html#a0704c430bdc8e87fd6f03f01b2ab00df">random_number</a>.reserve(nThreads);</div>
<div class="line"><span class="lineno">  109</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iThread = 0; iThread &lt; nThreads; iThread++) {</div>
<div class="line"><span class="lineno">  110</span>    <a class="code hl_variable" href="classcovarianceBase.html#a0704c430bdc8e87fd6f03f01b2ab00df">random_number</a>.emplace_back(std::make_unique&lt;TRandom3&gt;(0));</div>
<div class="line"><span class="lineno">  111</span>  }</div>
<div class="line"><span class="lineno">  112</span>  <span class="comment">// Not using adaptive by default</span></div>
<div class="line"><span class="lineno">  113</span>  <a class="code hl_variable" href="classcovarianceBase.html#a838731abd6716940043b484b2b266f86">use_adaptive</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  114</span>  <span class="comment">// Set the covariance matrix</span></div>
<div class="line"><span class="lineno">  115</span>  <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a> = CovMat-&gt;GetNrows();</div>
<div class="line"><span class="lineno">  116</span>    </div>
<div class="line"><span class="lineno">  117</span>  <a class="code hl_variable" href="classcovarianceBase.html#a5973f7f446d6058af9bcd006a6cf562d">InvertCovMatrix</a>.resize(<a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>, std::vector&lt;double&gt;(<a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>, 0.0));</div>
<div class="line"><span class="lineno">  118</span>  <a class="code hl_variable" href="classcovarianceBase.html#aca17e48a5fa8e353317d58c205fb89df">throwMatrixCholDecomp</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>*[<a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>]();</div>
<div class="line"><span class="lineno">  119</span>  <span class="comment">// Set the defaults to true</span></div>
<div class="line"><span class="lineno">  120</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; i++) {</div>
<div class="line"><span class="lineno">  121</span>    <a class="code hl_variable" href="classcovarianceBase.html#aca17e48a5fa8e353317d58c205fb89df">throwMatrixCholDecomp</a>[i] = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>]();</div>
<div class="line"><span class="lineno">  122</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; j++) {</div>
<div class="line"><span class="lineno">  123</span>      <a class="code hl_variable" href="classcovarianceBase.html#aca17e48a5fa8e353317d58c205fb89df">throwMatrixCholDecomp</a>[i][j] = 0.;</div>
<div class="line"><span class="lineno">  124</span>    }</div>
<div class="line"><span class="lineno">  125</span>  }</div>
<div class="line"><span class="lineno">  126</span>  <a class="code hl_function" href="classcovarianceBase.html#a9f980a259c5952f9ca907832f99ad2a7">setName</a>(name);</div>
<div class="line"><span class="lineno">  127</span>  <a class="code hl_function" href="classcovarianceBase.html#ae2850c8e2f2d4acfe322b0ebe65b07cf">MakePosDef</a>(CovMat);</div>
<div class="line"><span class="lineno">  128</span>  <a class="code hl_function" href="group__Setters.html#ga5f28f7294d25cca6334f7033a63596b9">setCovMatrix</a>(CovMat);</div>
<div class="line"><span class="lineno">  129</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a> &lt;= 0) {</div>
<div class="line"><span class="lineno">  130</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a07ff6d6a15b24f94afc88a1b89779beb">MACH3LOG_CRITICAL</a>(<span class="stringliteral">&quot;Covariance matrix {} has {} entries!&quot;</span>, <a class="code hl_function" href="group__Setters.html#gafae8445e4cdef85c27c4863adb9e7fe4">getName</a>(), <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><span class="lineno">  131</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">  132</span>  }</div>
<div class="line"><span class="lineno">  133</span>  <a class="code hl_variable" href="classcovarianceBase.html#ac57285a48d41ef764b4c659959a36c2d">_fNumParPCA</a> = <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>;</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span>  <a class="code hl_function" href="classcovarianceBase.html#a75b5553823335bb82026ff46369fb67e">ReserveMemory</a>(<a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>  infile-&gt;Close();</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Created covariance matrix named: {}&quot;</span>, <a class="code hl_function" href="group__Setters.html#gafae8445e4cdef85c27c4863adb9e7fe4">getName</a>());</div>
<div class="line"><span class="lineno">  140</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;from file: {}&quot;</span>, file);</div>
<div class="line"><span class="lineno">  141</span>  <span class="keyword">delete</span> infile;</div>
<div class="line"><span class="lineno">  142</span>}</div>
<div class="ttc" id="aclasscovarianceBase_html_a9f980a259c5952f9ca907832f99ad2a7"><div class="ttname"><a href="classcovarianceBase.html#a9f980a259c5952f9ca907832f99ad2a7">covarianceBase::setName</a></div><div class="ttdeci">void setName(std::string name)</div><div class="ttdoc">Set matrix name.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00040">covarianceBase.h:40</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a715900cc67fcc598090399ee931938e9" name="a715900cc67fcc598090399ee931938e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a715900cc67fcc598090399ee931938e9">&#9670;&#160;</a></span>initialiseAdaption()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::initialiseAdaption </td>
          <td>(</td>
          <td class="paramtype">const YAML::Node &amp;&#160;</td>
          <td class="paramname"><em>adapt_manager</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise adaptive MCMC. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">adapt_manager</td><td>Node having from which we load all adaptation options </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l01046">1046</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1046</span>                                                                    {</div>
<div class="line"><span class="lineno"> 1047</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno"> 1048</span>  <span class="comment">// Now we read the general settings [these SHOULD be common across all matrices!]</span></div>
<div class="line"><span class="lineno"> 1049</span>  <span class="keywordtype">bool</span> success = <a class="code hl_variable" href="classcovarianceBase.html#ab3833dc51a81afc9dca7c3dcbb107af7">AdaptiveHandler</a>.<a class="code hl_function" href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#a192304475bc377ef975ef40d2bd2b254">InitFromConfig</a>(adapt_manager, <a class="code hl_variable" href="classcovarianceBase.html#a26618d3f5633b33ce20e38ce8261b3ee">matrixName</a>, <a class="code hl_function" href="classcovarianceBase.html#a261941a4c06e5d875174d8769a4d02f1">getNpars</a>());</div>
<div class="line"><span class="lineno"> 1050</span>  <span class="keywordflow">if</span>(!success) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1051</span>  <a class="code hl_variable" href="classcovarianceBase.html#ab3833dc51a81afc9dca7c3dcbb107af7">AdaptiveHandler</a>.<a class="code hl_function" href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#a5997a813faf68d891c62cbaf65984aca">Print</a>();</div>
<div class="line"><span class="lineno"> 1052</span> </div>
<div class="line"><span class="lineno"> 1053</span>  <span class="comment">// Next let&quot;s check for external matrices</span></div>
<div class="line"><span class="lineno"> 1054</span>  <span class="comment">// We&quot;re going to grab this info from the YAML manager</span></div>
<div class="line"><span class="lineno"> 1055</span>  <span class="keywordflow">if</span>(!GetFromManager&lt;bool&gt;(adapt_manager[<span class="stringliteral">&quot;AdaptionOptions&quot;</span>][<span class="stringliteral">&quot;Covariance&quot;</span>][<a class="code hl_variable" href="classcovarianceBase.html#a26618d3f5633b33ce20e38ce8261b3ee">matrixName</a>][<span class="stringliteral">&quot;UseExternalMatrix&quot;</span>], <span class="keyword">false</span>, __FILE__ , __LINE__)) {</div>
<div class="line"><span class="lineno"> 1056</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Not using external matrix for {}, initialising adaption from scratch&quot;</span>, <a class="code hl_variable" href="classcovarianceBase.html#a26618d3f5633b33ce20e38ce8261b3ee">matrixName</a>);</div>
<div class="line"><span class="lineno"> 1057</span>    <span class="comment">// If we don&#39;t have a covariance matrix to start from for adaptive tune we need to make one!</span></div>
<div class="line"><span class="lineno"> 1058</span>    <a class="code hl_variable" href="classcovarianceBase.html#a838731abd6716940043b484b2b266f86">use_adaptive</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1059</span>    <a class="code hl_variable" href="classcovarianceBase.html#ab3833dc51a81afc9dca7c3dcbb107af7">AdaptiveHandler</a>.<a class="code hl_function" href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#ad7df80045651df99c2d1c375fea4ac74">CreateNewAdaptiveCovariance</a>(<a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><span class="lineno"> 1060</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1061</span>  }</div>
<div class="line"><span class="lineno"> 1062</span> </div>
<div class="line"><span class="lineno"> 1063</span>  <span class="comment">// Finally, we accept that we want to read the matrix from a file!</span></div>
<div class="line"><span class="lineno"> 1064</span>  <span class="keyword">auto</span> external_file_name = GetFromManager&lt;std::string&gt;(adapt_manager[<span class="stringliteral">&quot;AdaptionOptions&quot;</span>][<span class="stringliteral">&quot;Covariance&quot;</span>][<a class="code hl_variable" href="classcovarianceBase.html#a26618d3f5633b33ce20e38ce8261b3ee">matrixName</a>][<span class="stringliteral">&quot;ExternalMatrixFileName&quot;</span>], <span class="stringliteral">&quot;&quot;</span>, __FILE__ , __LINE__);</div>
<div class="line"><span class="lineno"> 1065</span>  <span class="keyword">auto</span> external_matrix_name = GetFromManager&lt;std::string&gt;(adapt_manager[<span class="stringliteral">&quot;AdaptionOptions&quot;</span>][<span class="stringliteral">&quot;Covariance&quot;</span>][<a class="code hl_variable" href="classcovarianceBase.html#a26618d3f5633b33ce20e38ce8261b3ee">matrixName</a>][<span class="stringliteral">&quot;ExternalMatrixName&quot;</span>], <span class="stringliteral">&quot;&quot;</span>, __FILE__ , __LINE__);</div>
<div class="line"><span class="lineno"> 1066</span>  <span class="keyword">auto</span> external_mean_name = GetFromManager&lt;std::string&gt;(adapt_manager[<span class="stringliteral">&quot;AdaptionOptions&quot;</span>][<span class="stringliteral">&quot;Covariance&quot;</span>][<a class="code hl_variable" href="classcovarianceBase.html#a26618d3f5633b33ce20e38ce8261b3ee">matrixName</a>][<span class="stringliteral">&quot;ExternalMeansName&quot;</span>], <span class="stringliteral">&quot;&quot;</span>, __FILE__ , __LINE__);</div>
<div class="line"><span class="lineno"> 1067</span> </div>
<div class="line"><span class="lineno"> 1068</span>  <a class="code hl_variable" href="classcovarianceBase.html#ab3833dc51a81afc9dca7c3dcbb107af7">AdaptiveHandler</a>.<a class="code hl_function" href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#aebd1df26766a9f106fe6ce4255ceb0d9">SetThrowMatrixFromFile</a>(external_file_name, external_matrix_name, external_mean_name, <a class="code hl_variable" href="classcovarianceBase.html#a838731abd6716940043b484b2b266f86">use_adaptive</a>, <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><span class="lineno"> 1069</span>  <a class="code hl_function" href="classcovarianceBase.html#af30ca7861452e1446e55700f4b49b608">setThrowMatrix</a>(<a class="code hl_variable" href="classcovarianceBase.html#ab3833dc51a81afc9dca7c3dcbb107af7">AdaptiveHandler</a>.<a class="code hl_variable" href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#afd61e64f18f5c25dbbd6bb2bd619a268">adaptive_covariance</a>);</div>
<div class="line"><span class="lineno"> 1070</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Successfully Set External Throw Matrix Stored in {}&quot;</span>, external_file_name);</div>
<div class="line"><span class="lineno"> 1071</span>}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_ad5b2eb6377721e3ac95def22c2386bb1"><div class="ttname"><a href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a></div><div class="ttdeci">#define MACH3LOG_WARN</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00024">MaCh3Logger.h:24</a></div></div>
<div class="ttc" id="aclassadaptive__mcmc_1_1AdaptiveMCMCHandler_html_a192304475bc377ef975ef40d2bd2b254"><div class="ttname"><a href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#a192304475bc377ef975ef40d2bd2b254">adaptive_mcmc::AdaptiveMCMCHandler::InitFromConfig</a></div><div class="ttdeci">bool InitFromConfig(const YAML::Node &amp;adapt_manager, const std::string &amp;matrix_name_str, const int Npars)</div><div class="ttdoc">Read initial values from config file.</div><div class="ttdef"><b>Definition:</b> <a href="AdaptiveMCMCHandler_8cpp_source.html#l00027">AdaptiveMCMCHandler.cpp:27</a></div></div>
<div class="ttc" id="aclassadaptive__mcmc_1_1AdaptiveMCMCHandler_html_a5997a813faf68d891c62cbaf65984aca"><div class="ttname"><a href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#a5997a813faf68d891c62cbaf65984aca">adaptive_mcmc::AdaptiveMCMCHandler::Print</a></div><div class="ttdeci">void Print()</div><div class="ttdoc">Print all class members.</div><div class="ttdef"><b>Definition:</b> <a href="AdaptiveMCMCHandler_8cpp_source.html#l00267">AdaptiveMCMCHandler.cpp:267</a></div></div>
<div class="ttc" id="aclassadaptive__mcmc_1_1AdaptiveMCMCHandler_html_ad7df80045651df99c2d1c375fea4ac74"><div class="ttname"><a href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#ad7df80045651df99c2d1c375fea4ac74">adaptive_mcmc::AdaptiveMCMCHandler::CreateNewAdaptiveCovariance</a></div><div class="ttdeci">void CreateNewAdaptiveCovariance(const int Npars)</div><div class="ttdoc">If we don't have a covariance matrix to start from for adaptive tune we need to make one!</div><div class="ttdef"><b>Definition:</b> <a href="AdaptiveMCMCHandler_8cpp_source.html#l00075">AdaptiveMCMCHandler.cpp:75</a></div></div>
<div class="ttc" id="aclassadaptive__mcmc_1_1AdaptiveMCMCHandler_html_aebd1df26766a9f106fe6ce4255ceb0d9"><div class="ttname"><a href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#aebd1df26766a9f106fe6ce4255ceb0d9">adaptive_mcmc::AdaptiveMCMCHandler::SetThrowMatrixFromFile</a></div><div class="ttdeci">void SetThrowMatrixFromFile(const std::string &amp;matrix_file_name, const std::string &amp;matrix_name, const std::string &amp;means_name, bool &amp;use_adaptive, const int Npars)</div><div class="ttdoc">sets throw matrix from a file</div><div class="ttdef"><b>Definition:</b> <a href="AdaptiveMCMCHandler_8cpp_source.html#l00145">AdaptiveMCMCHandler.cpp:145</a></div></div>
<div class="ttc" id="aclassadaptive__mcmc_1_1AdaptiveMCMCHandler_html_afd61e64f18f5c25dbbd6bb2bd619a268"><div class="ttname"><a href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#afd61e64f18f5c25dbbd6bb2bd619a268">adaptive_mcmc::AdaptiveMCMCHandler::adaptive_covariance</a></div><div class="ttdeci">TMatrixDSym * adaptive_covariance</div><div class="ttdoc">Full adaptive covariance matrix.</div><div class="ttdef"><b>Definition:</b> <a href="AdaptiveMCMCHandler_8h_source.html#l00090">AdaptiveMCMCHandler.h:90</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a261941a4c06e5d875174d8769a4d02f1"><div class="ttname"><a href="classcovarianceBase.html#a261941a4c06e5d875174d8769a4d02f1">covarianceBase::getNpars</a></div><div class="ttdeci">int getNpars()</div><div class="ttdoc">Get number of params which will be different depending if using Eigen decomposition or not.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00330">covarianceBase.h:330</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_af30ca7861452e1446e55700f4b49b608"><div class="ttname"><a href="classcovarianceBase.html#af30ca7861452e1446e55700f4b49b608">covarianceBase::setThrowMatrix</a></div><div class="ttdeci">void setThrowMatrix(TMatrixDSym *cov)</div><div class="ttdoc">Use new throw matrix, used in adaptive MCMC.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8cpp_source.html#l00993">covarianceBase.cpp:993</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a76cad7ebfd2ca8c4f1a8b69e0153436e" name="a76cad7ebfd2ca8c4f1a8b69e0153436e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76cad7ebfd2ca8c4f1a8b69e0153436e">&#9670;&#160;</a></span>isParameterFixed() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool covarianceBase::isParameterFixed </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Is parameter fixed or not. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>Parameter index </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00366">366</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  366</span>                                           {</div>
<div class="line"><span class="lineno">  367</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcovarianceBase.html#a34f877fc160b4a93a3aab1b3a8977858">_fError</a>[i] &lt; 0) { <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><span class="lineno">  368</span>    <span class="keywordflow">else</span>                { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><span class="lineno">  369</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aedb669ab47a5c4e610dfd12b2ffcc2ab" name="aedb669ab47a5c4e610dfd12b2ffcc2ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedb669ab47a5c4e610dfd12b2ffcc2ab">&#9670;&#160;</a></span>isParameterFixed() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool covarianceBase::isParameterFixed </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Is parameter fixed or not. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of parameter you want to check if is fixed </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00841">841</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  841</span>                                                                 {</div>
<div class="line"><span class="lineno">  842</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">  843</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;<a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; ++i) {</div>
<div class="line"><span class="lineno">  844</span>    <span class="keywordflow">if</span>(name == <a class="code hl_variable" href="classcovarianceBase.html#a973671386a2f8ea924f25f8f5404654c">_fFancyNames</a>[i]) {</div>
<div class="line"><span class="lineno">  845</span>      <span class="keywordflow">return</span> <a class="code hl_function" href="classcovarianceBase.html#a76cad7ebfd2ca8c4f1a8b69e0153436e">isParameterFixed</a>(i);</div>
<div class="line"><span class="lineno">  846</span>    }</div>
<div class="line"><span class="lineno">  847</span>  }</div>
<div class="line"><span class="lineno">  848</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;I couldn&#39;t find parameter with name {}, therefore will not fix it&quot;</span>, name);</div>
<div class="line"><span class="lineno">  849</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  850</span>}</div>
<div class="ttc" id="aclasscovarianceBase_html_a76cad7ebfd2ca8c4f1a8b69e0153436e"><div class="ttname"><a href="classcovarianceBase.html#a76cad7ebfd2ca8c4f1a8b69e0153436e">covarianceBase::isParameterFixed</a></div><div class="ttdeci">bool isParameterFixed(const int i) const</div><div class="ttdoc">Is parameter fixed or not.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00366">covarianceBase.h:366</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab7cb212b7fda7f402629855b58a69cec" name="ab7cb212b7fda7f402629855b58a69cec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7cb212b7fda7f402629855b58a69cec">&#9670;&#160;</a></span>isParameterFixedPCA()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool covarianceBase::isParameterFixedPCA </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Is parameter fixed in PCA base or not. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>Parameter index </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00270">270</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  270</span>                                               {</div>
<div class="line"><span class="lineno">  271</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;fParSigma_PCA[i] &lt; 0) { <span class="keywordflow">return</span> <span class="keyword">true</span>;  }</div>
<div class="line"><span class="lineno">  272</span>    <span class="keywordflow">else</span>                              { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><span class="lineno">  273</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a30f3f34243be0f6bc901e525497e7f56" name="a30f3f34243be0f6bc901e525497e7f56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30f3f34243be0f6bc901e525497e7f56">&#9670;&#160;</a></span>IsPCA()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool covarianceBase::IsPCA </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>is PCA, can use to query e.g. LLH scans </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00379">379</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  379</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8a709e1c6c58618cf65400eef1741cc7" name="a8a709e1c6c58618cf65400eef1741cc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a709e1c6c58618cf65400eef1741cc7">&#9670;&#160;</a></span>makeClosestPosDef()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::makeClosestPosDef </td>
          <td>(</td>
          <td class="paramtype">TMatrixDSym *&#160;</td>
          <td class="paramname"><em>cov</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>HW: Finds closest possible positive definite matrix in Frobenius Norm ||.||_frob Where ||X||_frob=sqrt[sum_ij(x_ij^2)] (basically just turns an n,n matrix into vector in n^2 space then does Euclidean norm) </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l01102">1102</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1102</span>                                                       {</div>
<div class="line"><span class="lineno"> 1103</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno"> 1104</span>  <span class="comment">// Want to get cov&#39; = (cov_sym+cov_polar)/2</span></div>
<div class="line"><span class="lineno"> 1105</span>  <span class="comment">// cov_sym=(cov+cov^T)/2</span></div>
<div class="line"><span class="lineno"> 1106</span>  <span class="comment">// cov_polar-&gt; SVD cov to cov=USV^T then cov_polar=VSV^T</span></div>
<div class="line"><span class="lineno"> 1107</span> </div>
<div class="line"><span class="lineno"> 1108</span>  <span class="comment">//Get frob norm of cov</span></div>
<div class="line"><span class="lineno"> 1109</span>  <span class="comment">//  Double_t cov_norm=cov-&gt;E2Norm();</span></div>
<div class="line"><span class="lineno"> 1110</span>  </div>
<div class="line"><span class="lineno"> 1111</span>  TMatrixDSym* cov_trans = cov;</div>
<div class="line"><span class="lineno"> 1112</span>  cov_trans-&gt;T();</div>
<div class="line"><span class="lineno"> 1113</span>  TMatrixDSym cov_sym = 0.5*(*cov+*cov_trans); <span class="comment">//If cov is symmetric does nothing, otherwise just ensures symmetry</span></div>
<div class="line"><span class="lineno"> 1114</span> </div>
<div class="line"><span class="lineno"> 1115</span>  <span class="comment">//Do SVD to get polar form</span></div>
<div class="line"><span class="lineno"> 1116</span>  TDecompSVD cov_sym_svd=TDecompSVD(cov_sym);</div>
<div class="line"><span class="lineno"> 1117</span>  <span class="keywordflow">if</span>(!cov_sym_svd.Decompose()){</div>
<div class="line"><span class="lineno"> 1118</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Cannot do SVD on input matrix!&quot;</span>);</div>
<div class="line"><span class="lineno"> 1119</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno"> 1120</span>  }</div>
<div class="line"><span class="lineno"> 1121</span>  </div>
<div class="line"><span class="lineno"> 1122</span>  TMatrixD cov_sym_v = cov_sym_svd.GetV();</div>
<div class="line"><span class="lineno"> 1123</span>  TMatrixD cov_sym_vt = cov_sym_v;</div>
<div class="line"><span class="lineno"> 1124</span>  cov_sym_vt.T();</div>
<div class="line"><span class="lineno"> 1125</span>  <span class="comment">//SVD returns as vector (grrr) so need to get into matrix form for multiplying!</span></div>
<div class="line"><span class="lineno"> 1126</span>  TVectorD cov_sym_sigvect = cov_sym_svd.GetSig();</div>
<div class="line"><span class="lineno"> 1127</span> </div>
<div class="line"><span class="lineno"> 1128</span>  <span class="keyword">const</span> Int_t nCols = cov_sym_v.GetNcols(); <span class="comment">//square so only need rows hence lack of cols</span></div>
<div class="line"><span class="lineno"> 1129</span>  TMatrixDSym cov_sym_sig(nCols);</div>
<div class="line"><span class="lineno"> 1130</span>  TMatrixDDiag cov_sym_sig_diag(cov_sym_sig);</div>
<div class="line"><span class="lineno"> 1131</span>  cov_sym_sig_diag=cov_sym_sigvect;</div>
<div class="line"><span class="lineno"> 1132</span> </div>
<div class="line"><span class="lineno"> 1133</span>  <span class="comment">//Can finally get H=VSV</span></div>
<div class="line"><span class="lineno"> 1134</span>  TMatrixDSym cov_sym_polar = cov_sym_sig.SimilarityT(cov_sym_vt);<span class="comment">//V*S*V^T (this took forver to find!)</span></div>
<div class="line"><span class="lineno"> 1135</span>  </div>
<div class="line"><span class="lineno"> 1136</span>  <span class="comment">//Now we can construct closest approximater Ahat=0.5*(B+H)</span></div>
<div class="line"><span class="lineno"> 1137</span>  TMatrixDSym cov_closest_approx  = 0.5*(cov_sym+cov_sym_polar);<span class="comment">//Not fully sure why this is even needed since symmetric B -&gt; U=V</span></div>
<div class="line"><span class="lineno"> 1138</span>  <span class="comment">//Get norm of transformed</span></div>
<div class="line"><span class="lineno"> 1139</span>  <span class="comment">//  Double_t approx_norm=cov_closest_approx.E2Norm();</span></div>
<div class="line"><span class="lineno"> 1140</span>  <span class="comment">//MACH3LOG_INFO(&quot;Initial Norm: {:.6f} | Norm after transformation: {:.6f} | Ratio: {:.6f}&quot;, cov_norm, approx_norm, cov_norm / approx_norm);</span></div>
<div class="line"><span class="lineno"> 1141</span>  </div>
<div class="line"><span class="lineno"> 1142</span>  *cov = cov_closest_approx;</div>
<div class="line"><span class="lineno"> 1143</span>  <span class="comment">//Now can just add a makeposdef!</span></div>
<div class="line"><span class="lineno"> 1144</span>  <a class="code hl_function" href="classcovarianceBase.html#ae2850c8e2f2d4acfe322b0ebe65b07cf">MakePosDef</a>(cov);</div>
<div class="line"><span class="lineno"> 1145</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae2850c8e2f2d4acfe322b0ebe65b07cf" name="ae2850c8e2f2d4acfe322b0ebe65b07cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2850c8e2f2d4acfe322b0ebe65b07cf">&#9670;&#160;</a></span>MakePosDef()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::MakePosDef </td>
          <td>(</td>
          <td class="paramtype">TMatrixDSym *&#160;</td>
          <td class="paramname"><em>cov</em> = <code>nullptr</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Make matrix positive definite by adding small values to diagonal, necessary for inverting matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cov</td><td>Matrix which we evaluate Positive Definitiveness </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00935">935</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  935</span>                                                {</div>
<div class="line"><span class="lineno">  936</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">  937</span>  <span class="keywordflow">if</span>(cov == <span class="keyword">nullptr</span>){</div>
<div class="line"><span class="lineno">  938</span>    cov = &amp;*<a class="code hl_variable" href="classcovarianceBase.html#a6c3fe8db34c06299fd1633951ac00937">covMatrix</a>;</div>
<div class="line"><span class="lineno">  939</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Passed nullptr to cov matrix in {}&quot;</span>, <a class="code hl_variable" href="classcovarianceBase.html#a26618d3f5633b33ce20e38ce8261b3ee">matrixName</a>);</div>
<div class="line"><span class="lineno">  940</span>  }</div>
<div class="line"><span class="lineno">  941</span> </div>
<div class="line"><span class="lineno">  942</span>  <span class="comment">//DB Save original warning state and then increase it in this function to suppress &#39;matrix not positive definite&#39; messages</span></div>
<div class="line"><span class="lineno">  943</span>  <span class="comment">//Means we no longer need to overload</span></div>
<div class="line"><span class="lineno">  944</span>  <span class="keywordtype">int</span> originalErrorWarning = gErrorIgnoreLevel;</div>
<div class="line"><span class="lineno">  945</span>  gErrorIgnoreLevel = kFatal;</div>
<div class="line"><span class="lineno">  946</span>  </div>
<div class="line"><span class="lineno">  947</span>  <span class="comment">//DB Loop 1000 times adding 1e-9 which tops out at 1e-6 shift on the diagonal before throwing error</span></div>
<div class="line"><span class="lineno">  948</span>  <span class="keywordtype">int</span> MaxAttempts = 1e5;</div>
<div class="line"><span class="lineno">  949</span>  <span class="keywordtype">int</span> iAttempt = 0;</div>
<div class="line"><span class="lineno">  950</span>  <span class="keywordtype">bool</span> CanDecomp = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  951</span>  TDecompChol chdcmp;</div>
<div class="line"><span class="lineno">  952</span>  </div>
<div class="line"><span class="lineno">  953</span>  <span class="keywordflow">for</span> (iAttempt = 0; iAttempt &lt; MaxAttempts; iAttempt++) {</div>
<div class="line"><span class="lineno">  954</span>    chdcmp = TDecompChol(*cov);</div>
<div class="line"><span class="lineno">  955</span>    <span class="keywordflow">if</span> (chdcmp.Decompose()) {</div>
<div class="line"><span class="lineno">  956</span>      CanDecomp = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  957</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  958</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  959</span><span class="preprocessor">      #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  960</span><span class="preprocessor">      #pragma omp parallel for</span></div>
<div class="line"><span class="lineno">  961</span><span class="preprocessor">      #endif</span></div>
<div class="line"><span class="lineno">  962</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iVar = 0 ; iVar &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; iVar++) {</div>
<div class="line"><span class="lineno">  963</span>        (*cov)(iVar,iVar) += pow(10, -9);</div>
<div class="line"><span class="lineno">  964</span>      }</div>
<div class="line"><span class="lineno">  965</span>    }</div>
<div class="line"><span class="lineno">  966</span>  }</div>
<div class="line"><span class="lineno">  967</span> </div>
<div class="line"><span class="lineno">  968</span>  <span class="keywordflow">if</span> (!CanDecomp) {</div>
<div class="line"><span class="lineno">  969</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Tried {} times to shift diagonal but still can not decompose the matrix&quot;</span>, MaxAttempts);</div>
<div class="line"><span class="lineno">  970</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;This indicates that something is wrong with the input matrix&quot;</span>);</div>
<div class="line"><span class="lineno">  971</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">  972</span>  }</div>
<div class="line"><span class="lineno">  973</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classcovarianceBase.html#ab3833dc51a81afc9dca7c3dcbb107af7">AdaptiveHandler</a>.<a class="code hl_variable" href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#ab2837af4566e2d62db7b76f9527fb6d7">total_steps</a> &lt; 2) {</div>
<div class="line"><span class="lineno">  974</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Had to shift diagonal {} time(s) to allow the covariance matrix to be decomposed&quot;</span>, iAttempt);</div>
<div class="line"><span class="lineno">  975</span>  }</div>
<div class="line"><span class="lineno">  976</span>  <span class="comment">//DB Resetting warning level</span></div>
<div class="line"><span class="lineno">  977</span>  gErrorIgnoreLevel = originalErrorWarning;</div>
<div class="line"><span class="lineno">  978</span>}</div>
<div class="ttc" id="aclassadaptive__mcmc_1_1AdaptiveMCMCHandler_html_ab2837af4566e2d62db7b76f9527fb6d7"><div class="ttname"><a href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#ab2837af4566e2d62db7b76f9527fb6d7">adaptive_mcmc::AdaptiveMCMCHandler::total_steps</a></div><div class="ttdeci">int total_steps</div><div class="ttdoc">Total number of MCMC steps.</div><div class="ttdef"><b>Definition:</b> <a href="AdaptiveMCMCHandler_8h_source.html#l00093">AdaptiveMCMCHandler.h:93</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a43367db263b2607232077410f27b1146" name="a43367db263b2607232077410f27b1146"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43367db263b2607232077410f27b1146">&#9670;&#160;</a></span>MatrixVectorMulti()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::MatrixVectorMulti </td>
          <td>(</td>
          <td class="paramtype">double *<a class="el" href="Core_8h.html#ab6a7e23420f0bcfb04f42f45f8283101">_restrict_</a>&#160;</td>
          <td class="paramname"><em>VecMulti</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **<a class="el" href="Core_8h.html#ab6a7e23420f0bcfb04f42f45f8283101">_restrict_</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *<a class="el" href="Core_8h.html#ab6a7e23420f0bcfb04f42f45f8283101">_restrict_</a>&#160;</td>
          <td class="paramname"><em>vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: Custom function to perform multiplication of matrix and vector with multithreading. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VecMulti</td><td>Output Vector, VecMulti = matrix x vector </td></tr>
    <tr><td class="paramname">matrix</td><td>This matrix is used for multiplication VecMulti = matrix x vector </td></tr>
    <tr><td class="paramname">VecMulti</td><td>This vector is used for multiplication VecMulti = matrix x vector </td></tr>
    <tr><td class="paramname">n</td><td>this is size of matrix and vector, we assume matrix is symmetric </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00873">873</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  873</span>                                                                                                                                                  {</div>
<div class="line"><span class="lineno">  874</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">  875</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  876</span><span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><span class="lineno">  877</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  878</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; ++i)</div>
<div class="line"><span class="lineno">  879</span>  {</div>
<div class="line"><span class="lineno">  880</span>    <span class="keywordtype">double</span> result = 0.0;</div>
<div class="line"><span class="lineno">  881</span><span class="preprocessor">    #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  882</span><span class="preprocessor">    #pragma omp simd</span></div>
<div class="line"><span class="lineno">  883</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  884</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; n; ++j)</div>
<div class="line"><span class="lineno">  885</span>    {</div>
<div class="line"><span class="lineno">  886</span>      result += matrix[i][j]*vector[j];</div>
<div class="line"><span class="lineno">  887</span>    }</div>
<div class="line"><span class="lineno">  888</span>    VecMulti[i] = result;</div>
<div class="line"><span class="lineno">  889</span>  }</div>
<div class="line"><span class="lineno">  890</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a29d3a7af51740c17ae5002b579923446" name="a29d3a7af51740c17ae5002b579923446"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29d3a7af51740c17ae5002b579923446">&#9670;&#160;</a></span>MatrixVectorMultiSingle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double covarianceBase::MatrixVectorMultiSingle </td>
          <td>(</td>
          <td class="paramtype">double **<a class="el" href="Core_8h.html#ab6a7e23420f0bcfb04f42f45f8283101">_restrict_</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *<a class="el" href="Core_8h.html#ab6a7e23420f0bcfb04f42f45f8283101">_restrict_</a>&#160;</td>
          <td class="paramname"><em>vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: Custom function to perform multiplication of matrix and single element which is thread safe. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00893">893</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  893</span>                                                                                                                                               {</div>
<div class="line"><span class="lineno">  894</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">  895</span>  <span class="keywordtype">double</span> Element = 0.0;</div>
<div class="line"><span class="lineno">  896</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  897</span><span class="preprocessor">  #pragma omp simd</span></div>
<div class="line"><span class="lineno">  898</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  899</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; Length; ++j) {</div>
<div class="line"><span class="lineno">  900</span>    Element += matrix[i][j]*vector[j];</div>
<div class="line"><span class="lineno">  901</span>  }</div>
<div class="line"><span class="lineno">  902</span>  <span class="keywordflow">return</span> Element;</div>
<div class="line"><span class="lineno">  903</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac6666769aa222368338d943826122bb4" name="ac6666769aa222368338d943826122bb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6666769aa222368338d943826122bb4">&#9670;&#160;</a></span>printIndivStepScale()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::printIndivStepScale </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print step scale for each parameter. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00923">923</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  923</span>                                               {</div>
<div class="line"><span class="lineno">  924</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">  925</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;============================================================&quot;</span>);</div>
<div class="line"><span class="lineno">  926</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{:&lt;{}} | {:&lt;11}&quot;</span>, <span class="stringliteral">&quot;Parameter:&quot;</span>, <a class="code hl_variable" href="classcovarianceBase.html#a8d821ce805f2426fe95549170866821f">PrintLength</a>, <span class="stringliteral">&quot;Step scale:&quot;</span>);</div>
<div class="line"><span class="lineno">  927</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iParam = 0; iParam &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; iParam++) {</div>
<div class="line"><span class="lineno">  928</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{:&lt;{}} | {:&lt;11}&quot;</span>, <a class="code hl_variable" href="classcovarianceBase.html#a3e502d80fd2c30a7da4fe75a3e05b0da">_fNames</a>[iParam].c_str(), <a class="code hl_variable" href="classcovarianceBase.html#a8d821ce805f2426fe95549170866821f">PrintLength</a>, <a class="code hl_variable" href="classcovarianceBase.html#a3cda39026e336a49cef482efd4062561">_fIndivStepScale</a>[iParam]);</div>
<div class="line"><span class="lineno">  929</span>  }</div>
<div class="line"><span class="lineno">  930</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;============================================================&quot;</span>);</div>
<div class="line"><span class="lineno">  931</span>}</div>
<div class="ttc" id="aclasscovarianceBase_html_a3e502d80fd2c30a7da4fe75a3e05b0da"><div class="ttname"><a href="classcovarianceBase.html#a3e502d80fd2c30a7da4fe75a3e05b0da">covarianceBase::_fNames</a></div><div class="ttdeci">std::vector&lt; std::string &gt; _fNames</div><div class="ttdoc">ETA _fNames is set automatically in the covariance class to be something like xsec_i,...</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00451">covarianceBase.h:451</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a925903433ed900714d2930b5db338214" name="a925903433ed900714d2930b5db338214"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a925903433ed900714d2930b5db338214">&#9670;&#160;</a></span>printNominal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::printNominal </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print prior value for every parameter. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00630">630</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  630</span>                                        {</div>
<div class="line"><span class="lineno">  631</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">  632</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Prior values for {} covarianceBase:&quot;</span>, <a class="code hl_function" href="group__Setters.html#gafae8445e4cdef85c27c4863adb9e7fe4">getName</a>());</div>
<div class="line"><span class="lineno">  633</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; i++) {</div>
<div class="line"><span class="lineno">  634</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;    {}   {} &quot;</span>, <a class="code hl_function" href="group__Setters.html#ga295f5fe63911d4c704b73e0b0c8c7971">GetParFancyName</a>(i), <a class="code hl_function" href="classcovarianceBase.html#add825b13bf6604725577cb229f8372d8">getParInit</a>(i));</div>
<div class="line"><span class="lineno">  635</span>  }</div>
<div class="line"><span class="lineno">  636</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae992ca06f3313a7e5f9584ac1798e59f" name="ae992ca06f3313a7e5f9584ac1798e59f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae992ca06f3313a7e5f9584ac1798e59f">&#9670;&#160;</a></span>printNominalCurrProp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::printNominalCurrProp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print prior, current and proposed value for each parameter. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00640">640</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  640</span>                                                {</div>
<div class="line"><span class="lineno">  641</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">  642</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Printing parameters for {}&quot;</span>, <a class="code hl_function" href="group__Setters.html#gafae8445e4cdef85c27c4863adb9e7fe4">getName</a>());</div>
<div class="line"><span class="lineno">  643</span>  <span class="comment">// Dump out the PCA parameters too</span></div>
<div class="line"><span class="lineno">  644</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>) {</div>
<div class="line"><span class="lineno">  645</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;PCA:&quot;</span>);</div>
<div class="line"><span class="lineno">  646</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac57285a48d41ef764b4c659959a36c2d">_fNumParPCA</a>; ++i) {</div>
<div class="line"><span class="lineno">  647</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;PCA {:&lt;2} Current: {:&lt;10.2f} Proposed: {:&lt;10.2f}&quot;</span>, i, <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;fParCurr_PCA(i), <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;fParProp_PCA(i));</div>
<div class="line"><span class="lineno">  648</span>    }</div>
<div class="line"><span class="lineno">  649</span>  }</div>
<div class="line"><span class="lineno">  650</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{:&lt;30} {:&lt;10} {:&lt;10} {:&lt;10}&quot;</span>, <span class="stringliteral">&quot;Name&quot;</span>, <span class="stringliteral">&quot;Prior&quot;</span>, <span class="stringliteral">&quot;Current&quot;</span>, <span class="stringliteral">&quot;Proposed&quot;</span>);</div>
<div class="line"><span class="lineno">  651</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; ++i) {</div>
<div class="line"><span class="lineno">  652</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{:&lt;30} {:&lt;10.2f} {:&lt;10.2f} {:&lt;10.2f}&quot;</span>, <a class="code hl_function" href="group__Setters.html#ga295f5fe63911d4c704b73e0b0c8c7971">GetParFancyName</a>(i), <a class="code hl_variable" href="classcovarianceBase.html#a7578a2cc2e8e9100fad88310a824cb1c">_fPreFitValue</a>[i], <a class="code hl_variable" href="classcovarianceBase.html#ae70f51df3976975b2dc78fd3bfc28b65">_fCurrVal</a>[i], <a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[i]);</div>
<div class="line"><span class="lineno">  653</span>  }</div>
<div class="line"><span class="lineno">  654</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a18ed4e7527f25c3c80eff28139267abd" name="a18ed4e7527f25c3c80eff28139267abd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18ed4e7527f25c3c80eff28139267abd">&#9670;&#160;</a></span>printPars()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::printPars </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section warning"><dt>Warning</dt><dd>only for backward compatibility </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000034">Todo:</a></b></dt><dd>remove it </dd></dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00341">341</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  341</span>{<a class="code hl_function" href="classcovarianceBase.html#ae992ca06f3313a7e5f9584ac1798e59f">printNominalCurrProp</a>();};</div>
<div class="ttc" id="aclasscovarianceBase_html_ae992ca06f3313a7e5f9584ac1798e59f"><div class="ttname"><a href="classcovarianceBase.html#ae992ca06f3313a7e5f9584ac1798e59f">covarianceBase::printNominalCurrProp</a></div><div class="ttdeci">void printNominalCurrProp() const</div><div class="ttdoc">Print prior, current and proposed value for each parameter.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8cpp_source.html#l00640">covarianceBase.cpp:640</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a95c7ca23995af579cfa7f199833fe24a" name="a95c7ca23995af579cfa7f199833fe24a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95c7ca23995af579cfa7f199833fe24a">&#9670;&#160;</a></span>proposeStep()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::proposeStep </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate a new proposed state. </p>

<p>Reimplemented in <a class="el" href="classcovarianceOsc.html#abb8df24417b380af9b96763b8abc6b2e">covarianceOsc</a>, and <a class="el" href="classPyCovarianceBase.html#ab0aaac71243a7e4c26656412e15af48f">PyCovarianceBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00485">485</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  485</span>                                 {</div>
<div class="line"><span class="lineno">  486</span><span class="comment">// ************************************************</span></div>
<div class="line"><span class="lineno">  487</span>  <span class="comment">// Make the random numbers for the step proposal</span></div>
<div class="line"><span class="lineno">  488</span>  <a class="code hl_function" href="classcovarianceBase.html#a8d58b8e8ac3b2a8f1c6867e8b6cd7ff8">randomize</a>();</div>
<div class="line"><span class="lineno">  489</span>  <a class="code hl_function" href="classcovarianceBase.html#a044a1c9e5642d9f2f7e713999898a2f8">CorrelateSteps</a>();</div>
<div class="line"><span class="lineno">  490</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classcovarianceBase.html#a838731abd6716940043b484b2b266f86">use_adaptive</a>) <a class="code hl_function" href="classcovarianceBase.html#a50ce8ebb96ebd64190dc37e4bf950a9b">updateAdaptiveCovariance</a>();</div>
<div class="line"><span class="lineno">  491</span>}</div>
<div class="ttc" id="aclasscovarianceBase_html_a044a1c9e5642d9f2f7e713999898a2f8"><div class="ttname"><a href="classcovarianceBase.html#a044a1c9e5642d9f2f7e713999898a2f8">covarianceBase::CorrelateSteps</a></div><div class="ttdeci">void CorrelateSteps() _noexcept_</div><div class="ttdoc">Use Cholesky throw matrix for better step proposal.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8cpp_source.html#l00533">covarianceBase.cpp:533</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a50ce8ebb96ebd64190dc37e4bf950a9b"><div class="ttname"><a href="classcovarianceBase.html#a50ce8ebb96ebd64190dc37e4bf950a9b">covarianceBase::updateAdaptiveCovariance</a></div><div class="ttdeci">void updateAdaptiveCovariance()</div><div class="ttdoc">Method to update adaptive MCMC .</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8cpp_source.html#l01075">covarianceBase.cpp:1075</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a8d58b8e8ac3b2a8f1c6867e8b6cd7ff8"><div class="ttname"><a href="classcovarianceBase.html#a8d58b8e8ac3b2a8f1c6867e8b6cd7ff8">covarianceBase::randomize</a></div><div class="ttdeci">void randomize() _noexcept_</div><div class="ttdoc">&quot;Randomize&quot; the parameters in the covariance class for the proposed step. Used the proposal kernel an...</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8cpp_source.html#l00497">covarianceBase.cpp:497</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a867bff214af25bba68f921eaea8b5cdd" name="a867bff214af25bba68f921eaea8b5cdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a867bff214af25bba68f921eaea8b5cdd">&#9670;&#160;</a></span>RandomConfiguration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::RandomConfiguration </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Randomly throw the parameters in their 1 sigma range. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00429">429</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  429</span>                                         {</div>
<div class="line"><span class="lineno">  430</span><span class="comment">// *************************************</span></div>
<div class="line"><span class="lineno">  431</span>  <span class="comment">// Have the 1 sigma for each parameter in each covariance class, sweet!</span></div>
<div class="line"><span class="lineno">  432</span>  <span class="comment">// Don&#39;t want to change the prior array because that&#39;s what determines our likelihood</span></div>
<div class="line"><span class="lineno">  433</span>  <span class="comment">// Want to change the fParProp, fParCurr, fParInit</span></div>
<div class="line"><span class="lineno">  434</span>  <span class="comment">// fParInit and the others will already be set</span></div>
<div class="line"><span class="lineno">  435</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; ++i) {</div>
<div class="line"><span class="lineno">  436</span>    <span class="comment">// Check if parameter is fixed first: if so don&#39;t randomly throw</span></div>
<div class="line"><span class="lineno">  437</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classcovarianceBase.html#a76cad7ebfd2ca8c4f1a8b69e0153436e">isParameterFixed</a>(i)) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  438</span>    <span class="comment">// Check that the sigma range is larger than the parameter range</span></div>
<div class="line"><span class="lineno">  439</span>    <span class="comment">// If not, throw in the valid parameter range instead</span></div>
<div class="line"><span class="lineno">  440</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> paramrange = <a class="code hl_variable" href="classcovarianceBase.html#a31e636cb6de871bd0c2c8e7e299df9e7">_fUpBound</a>[i] - <a class="code hl_variable" href="classcovarianceBase.html#a8f1d94838f188cc85c4f82557c0b0b66">_fLowBound</a>[i];</div>
<div class="line"><span class="lineno">  441</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> sigma = sqrt((*<a class="code hl_variable" href="classcovarianceBase.html#a6c3fe8db34c06299fd1633951ac00937">covMatrix</a>)(i,i));</div>
<div class="line"><span class="lineno">  442</span>    <span class="keywordtype">double</span> throwrange = sigma;</div>
<div class="line"><span class="lineno">  443</span>    <span class="keywordflow">if</span> (paramrange &lt; sigma) throwrange = paramrange;</div>
<div class="line"><span class="lineno">  444</span> </div>
<div class="line"><span class="lineno">  445</span>    <a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[i] = <a class="code hl_variable" href="classcovarianceBase.html#a7578a2cc2e8e9100fad88310a824cb1c">_fPreFitValue</a>[i] + <a class="code hl_variable" href="classcovarianceBase.html#a0704c430bdc8e87fd6f03f01b2ab00df">random_number</a>[0]-&gt;Gaus(0, 1)*throwrange;</div>
<div class="line"><span class="lineno">  446</span>    <span class="comment">// Try again if we the initial parameter proposal falls outside of the range of the parameter</span></div>
<div class="line"><span class="lineno">  447</span>    <span class="comment">// Really only relevant for the xsec parameters; the flux and ND280 have -999 and 999 set to the limits!</span></div>
<div class="line"><span class="lineno">  448</span>    <span class="keywordtype">int</span> <span class="keywordflow">throws</span> = 0;</div>
<div class="line"><span class="lineno">  449</span>    <span class="keywordflow">while</span> (<a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[i] &gt; <a class="code hl_variable" href="classcovarianceBase.html#a31e636cb6de871bd0c2c8e7e299df9e7">_fUpBound</a>[i] || <a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[i] &lt; <a class="code hl_variable" href="classcovarianceBase.html#a8f1d94838f188cc85c4f82557c0b0b66">_fLowBound</a>[i]) {</div>
<div class="line"><span class="lineno">  450</span>      <span class="keywordflow">if</span> (<span class="keywordflow">throws</span> &gt; 1000) {</div>
<div class="line"><span class="lineno">  451</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Tried {} times to throw parameter {} but failed&quot;</span>, <span class="keywordflow">throws</span>, i);</div>
<div class="line"><span class="lineno">  452</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Matrix: {}&quot;</span>, <a class="code hl_variable" href="classcovarianceBase.html#a26618d3f5633b33ce20e38ce8261b3ee">matrixName</a>);</div>
<div class="line"><span class="lineno">  453</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Param: {}&quot;</span>, <a class="code hl_variable" href="classcovarianceBase.html#a3e502d80fd2c30a7da4fe75a3e05b0da">_fNames</a>[i]);</div>
<div class="line"><span class="lineno">  454</span>        <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">  455</span>      }</div>
<div class="line"><span class="lineno">  456</span>      <a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[i] = <a class="code hl_variable" href="classcovarianceBase.html#a7578a2cc2e8e9100fad88310a824cb1c">_fPreFitValue</a>[i] + <a class="code hl_variable" href="classcovarianceBase.html#a0704c430bdc8e87fd6f03f01b2ab00df">random_number</a>[0]-&gt;Gaus(0, 1)*throwrange;</div>
<div class="line"><span class="lineno">  457</span>      <span class="keywordflow">throws</span>++;</div>
<div class="line"><span class="lineno">  458</span>    }</div>
<div class="line"><span class="lineno">  459</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Setting current step in {} param {} = {} from {}&quot;</span>, <a class="code hl_variable" href="classcovarianceBase.html#a26618d3f5633b33ce20e38ce8261b3ee">matrixName</a>, i, <a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[i], <a class="code hl_variable" href="classcovarianceBase.html#ae70f51df3976975b2dc78fd3bfc28b65">_fCurrVal</a>[i]);</div>
<div class="line"><span class="lineno">  460</span>    <a class="code hl_variable" href="classcovarianceBase.html#ae70f51df3976975b2dc78fd3bfc28b65">_fCurrVal</a>[i] = <a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[i];</div>
<div class="line"><span class="lineno">  461</span>  }</div>
<div class="line"><span class="lineno">  462</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>) <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;TransferToPCA();</div>
<div class="line"><span class="lineno">  463</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8d58b8e8ac3b2a8f1c6867e8b6cd7ff8" name="a8d58b8e8ac3b2a8f1c6867e8b6cd7ff8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d58b8e8ac3b2a8f1c6867e8b6cd7ff8">&#9670;&#160;</a></span>randomize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::randomize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>"Randomize" the parameters in the covariance class for the proposed step. Used the proposal kernel and the current parameter value to set proposed step </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00497">497</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  497</span>                                          {</div>
<div class="line"><span class="lineno">  498</span><span class="comment">// ************************************************</span></div>
<div class="line"><span class="lineno">  499</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>) {</div>
<div class="line"><span class="lineno">  500</span>    <span class="comment">//KS: By multithreading here we gain at least factor 2 with 8 threads with ND only fit</span></div>
<div class="line"><span class="lineno">  501</span><span class="preprocessor">    #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  502</span><span class="preprocessor">    #pragma omp parallel for</span></div>
<div class="line"><span class="lineno">  503</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  504</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; ++i) {</div>
<div class="line"><span class="lineno">  505</span>      <span class="comment">// If parameter isn&#39;t fixed</span></div>
<div class="line"><span class="lineno">  506</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcovarianceBase.html#a34f877fc160b4a93a3aab1b3a8977858">_fError</a>[i] &gt; 0.0) {</div>
<div class="line"><span class="lineno">  507</span>        <a class="code hl_variable" href="classcovarianceBase.html#a705e648220c06083cd1acc5fba4f2ef7">randParams</a>[i] = <a class="code hl_variable" href="classcovarianceBase.html#a0704c430bdc8e87fd6f03f01b2ab00df">random_number</a>[<a class="code hl_function" href="namespaceM3.html#a5ed0accdbf66626c16b6c3b00bd5d030">M3::GetThreadIndex</a>()]-&gt;Gaus(0, 1);</div>
<div class="line"><span class="lineno">  508</span>        <span class="comment">// If parameter IS fixed</span></div>
<div class="line"><span class="lineno">  509</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  510</span>        <a class="code hl_variable" href="classcovarianceBase.html#a705e648220c06083cd1acc5fba4f2ef7">randParams</a>[i] = 0.0;</div>
<div class="line"><span class="lineno">  511</span>      }</div>
<div class="line"><span class="lineno">  512</span>    } <span class="comment">// end for</span></div>
<div class="line"><span class="lineno">  513</span>  <span class="comment">// If we&#39;re in the PCA basis we instead throw parameters there (only _fNumParPCA parameter)</span></div>
<div class="line"><span class="lineno">  514</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  515</span>    <span class="comment">// Scale the random parameters by the sqrt of eigen values for the throw</span></div>
<div class="line"><span class="lineno">  516</span><span class="preprocessor">    #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  517</span><span class="preprocessor">    #pragma omp parallel for</span></div>
<div class="line"><span class="lineno">  518</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  519</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; ++i)</div>
<div class="line"><span class="lineno">  520</span>    {</div>
<div class="line"><span class="lineno">  521</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;fParSigma_PCA[i] &gt; 0. &amp;&amp; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac57285a48d41ef764b4c659959a36c2d">_fNumParPCA</a>)</div>
<div class="line"><span class="lineno">  522</span>      {</div>
<div class="line"><span class="lineno">  523</span>        <a class="code hl_variable" href="classcovarianceBase.html#a705e648220c06083cd1acc5fba4f2ef7">randParams</a>[i] = <a class="code hl_variable" href="classcovarianceBase.html#a0704c430bdc8e87fd6f03f01b2ab00df">random_number</a>[<a class="code hl_function" href="namespaceM3.html#a5ed0accdbf66626c16b6c3b00bd5d030">M3::GetThreadIndex</a>()]-&gt;Gaus(0,1);</div>
<div class="line"><span class="lineno">  524</span>      } <span class="keywordflow">else</span> { <span class="comment">// If parameter IS fixed or out od bounds</span></div>
<div class="line"><span class="lineno">  525</span>        <a class="code hl_variable" href="classcovarianceBase.html#a705e648220c06083cd1acc5fba4f2ef7">randParams</a>[i] = 0.0;</div>
<div class="line"><span class="lineno">  526</span>      }</div>
<div class="line"><span class="lineno">  527</span>    }</div>
<div class="line"><span class="lineno">  528</span>  }</div>
<div class="line"><span class="lineno">  529</span>}</div>
<div class="ttc" id="anamespaceM3_html_a5ed0accdbf66626c16b6c3b00bd5d030"><div class="ttname"><a href="namespaceM3.html#a5ed0accdbf66626c16b6c3b00bd5d030">M3::GetThreadIndex</a></div><div class="ttdeci">int GetThreadIndex()</div><div class="ttdoc">thread index inside parallel loop</div><div class="ttdef"><b>Definition:</b> <a href="Monitor_8h_source.html#l00080">Monitor.h:80</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a75b5553823335bb82026ff46369fb67e" name="a75b5553823335bb82026ff46369fb67e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75b5553823335bb82026ff46369fb67e">&#9670;&#160;</a></span>ReserveMemory()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::ReserveMemory </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialise vectors with parameters information. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>integer telling size to which we will resize all vectors/allocate memory </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00313">313</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  313</span>                                                    {</div>
<div class="line"><span class="lineno">  314</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">  315</span>  <a class="code hl_variable" href="classcovarianceBase.html#a3e502d80fd2c30a7da4fe75a3e05b0da">_fNames</a> = std::vector&lt;std::string&gt;(SizeVec);</div>
<div class="line"><span class="lineno">  316</span>  <a class="code hl_variable" href="classcovarianceBase.html#a973671386a2f8ea924f25f8f5404654c">_fFancyNames</a> = std::vector&lt;std::string&gt;(SizeVec);</div>
<div class="line"><span class="lineno">  317</span>  <a class="code hl_variable" href="classcovarianceBase.html#a9b753f52711600a9f8d648531d95b044">_fGenerated</a> = std::vector&lt;double&gt;(SizeVec);</div>
<div class="line"><span class="lineno">  318</span>  <a class="code hl_variable" href="classcovarianceBase.html#a7578a2cc2e8e9100fad88310a824cb1c">_fPreFitValue</a> = std::vector&lt;double&gt;(SizeVec);</div>
<div class="line"><span class="lineno">  319</span>  <a class="code hl_variable" href="classcovarianceBase.html#a34f877fc160b4a93a3aab1b3a8977858">_fError</a> = std::vector&lt;double&gt;(SizeVec);</div>
<div class="line"><span class="lineno">  320</span>  <a class="code hl_variable" href="classcovarianceBase.html#ae70f51df3976975b2dc78fd3bfc28b65">_fCurrVal</a> = std::vector&lt;double&gt;(SizeVec);</div>
<div class="line"><span class="lineno">  321</span>  <a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a> = std::vector&lt;double&gt;(SizeVec);</div>
<div class="line"><span class="lineno">  322</span>  <a class="code hl_variable" href="classcovarianceBase.html#a8f1d94838f188cc85c4f82557c0b0b66">_fLowBound</a> = std::vector&lt;double&gt;(SizeVec);</div>
<div class="line"><span class="lineno">  323</span>  <a class="code hl_variable" href="classcovarianceBase.html#a31e636cb6de871bd0c2c8e7e299df9e7">_fUpBound</a> = std::vector&lt;double&gt;(SizeVec);</div>
<div class="line"><span class="lineno">  324</span>  <a class="code hl_variable" href="classcovarianceBase.html#ad9c47deb7009bff81210f666e80012eb">_fFlatPrior</a> = std::vector&lt;bool&gt;(SizeVec);</div>
<div class="line"><span class="lineno">  325</span>  <a class="code hl_variable" href="classcovarianceBase.html#a3cda39026e336a49cef482efd4062561">_fIndivStepScale</a> = std::vector&lt;double&gt;(SizeVec);</div>
<div class="line"><span class="lineno">  326</span>  <a class="code hl_variable" href="classcovarianceBase.html#a267523bb0f78c27208000b2856f741da">_fDetID</a> = std::vector&lt;std::vector&lt;std::string&gt;&gt;(<a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><span class="lineno">  327</span> </div>
<div class="line"><span class="lineno">  328</span>  <a class="code hl_variable" href="classcovarianceBase.html#a7b70de3f098aae1d537d80bac5969d88">corr_throw</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[SizeVec]();</div>
<div class="line"><span class="lineno">  329</span>  <span class="comment">// set random parameter vector (for correlated steps)</span></div>
<div class="line"><span class="lineno">  330</span>  <a class="code hl_variable" href="classcovarianceBase.html#a705e648220c06083cd1acc5fba4f2ef7">randParams</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[SizeVec];</div>
<div class="line"><span class="lineno">  331</span> </div>
<div class="line"><span class="lineno">  332</span>  <span class="comment">// Set the defaults to true</span></div>
<div class="line"><span class="lineno">  333</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; SizeVec; i++) {</div>
<div class="line"><span class="lineno">  334</span>    <a class="code hl_variable" href="classcovarianceBase.html#a9b753f52711600a9f8d648531d95b044">_fGenerated</a>.at(i) = 1.;</div>
<div class="line"><span class="lineno">  335</span>    <a class="code hl_variable" href="classcovarianceBase.html#a7578a2cc2e8e9100fad88310a824cb1c">_fPreFitValue</a>.at(i) = 1.;</div>
<div class="line"><span class="lineno">  336</span>    <a class="code hl_variable" href="classcovarianceBase.html#a34f877fc160b4a93a3aab1b3a8977858">_fError</a>.at(i) = 1.;</div>
<div class="line"><span class="lineno">  337</span>    <a class="code hl_variable" href="classcovarianceBase.html#ae70f51df3976975b2dc78fd3bfc28b65">_fCurrVal</a>.at(i) = 0.;</div>
<div class="line"><span class="lineno">  338</span>    <a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>.at(i) = 0.;</div>
<div class="line"><span class="lineno">  339</span>    <a class="code hl_variable" href="classcovarianceBase.html#a8f1d94838f188cc85c4f82557c0b0b66">_fLowBound</a>.at(i) = -999.99;</div>
<div class="line"><span class="lineno">  340</span>    <a class="code hl_variable" href="classcovarianceBase.html#a31e636cb6de871bd0c2c8e7e299df9e7">_fUpBound</a>.at(i) = 999.99;</div>
<div class="line"><span class="lineno">  341</span>    <a class="code hl_variable" href="classcovarianceBase.html#ad9c47deb7009bff81210f666e80012eb">_fFlatPrior</a>.at(i) = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  342</span>    <a class="code hl_variable" href="classcovarianceBase.html#a3cda39026e336a49cef482efd4062561">_fIndivStepScale</a>.at(i) = 1.;</div>
<div class="line"><span class="lineno">  343</span>    <a class="code hl_variable" href="classcovarianceBase.html#a7b70de3f098aae1d537d80bac5969d88">corr_throw</a>[i] = 0.0;</div>
<div class="line"><span class="lineno">  344</span>  }</div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>  <a class="code hl_variable" href="classcovarianceBase.html#a0088413d6a15d12cd34ec06166302f5c">_fGlobalStepScale</a> = 1.0;</div>
<div class="line"><span class="lineno">  347</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0993a1ea6c5b06ba834e9e70af87ee9e" name="a0993a1ea6c5b06ba834e9e70af87ee9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0993a1ea6c5b06ba834e9e70af87ee9e">&#9670;&#160;</a></span>resetIndivStepScale()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::resetIndivStepScale </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adaptive Step Tuning Stuff. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00981">981</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  981</span>                                         {</div>
<div class="line"><span class="lineno">  982</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">  983</span>  std::vector&lt;double&gt; stepScales(<a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><span class="lineno">  984</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;<a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; i++) {</div>
<div class="line"><span class="lineno">  985</span>    stepScales[i] = 1.;</div>
<div class="line"><span class="lineno">  986</span>  }</div>
<div class="line"><span class="lineno">  987</span>  <a class="code hl_variable" href="classcovarianceBase.html#a0088413d6a15d12cd34ec06166302f5c">_fGlobalStepScale</a> = 1.0;</div>
<div class="line"><span class="lineno">  988</span>  <a class="code hl_function" href="group__Setters.html#ga21b912b31c888a2bdae9145a0c10a614">setIndivStepScale</a>(stepScales);</div>
<div class="line"><span class="lineno">  989</span>}</div>
<div class="ttc" id="agroup__Setters_html_ga21b912b31c888a2bdae9145a0c10a614"><div class="ttname"><a href="group__Setters.html#ga21b912b31c888a2bdae9145a0c10a614">covarianceBase::setIndivStepScale</a></div><div class="ttdeci">void setIndivStepScale(const int ParameterIndex, const double StepScale)</div><div class="ttdoc">DB Function to set fIndivStepScale from a vector (Can be used from execs and inside covariance constr...</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00099">covarianceBase.h:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa970d7a68497a3765723bf34629f79f7" name="aa970d7a68497a3765723bf34629f79f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa970d7a68497a3765723bf34629f79f7">&#9670;&#160;</a></span>retPointer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double * covarianceBase::retPointer </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iParam</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>DB Pointer return to param position. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iParam</td><td>The index of the parameter in the vector. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the parameter value at the specified index.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>ETA - This might be a bit squiffy? If the vector gots moved from say a push_back then the pointer is no longer valid... maybe need a better way to deal with this? It was fine before when the return was to an element of a new array. There must be a clever C++ way to be careful </dd></dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00211">211</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  211</span>{<span class="keywordflow">return</span> &amp;(<a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>.data()[iParam]);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae4c26e3f2a727a39e9db7ed88e72ac38" name="ae4c26e3f2a727a39e9db7ed88e72ac38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4c26e3f2a727a39e9db7ed88e72ac38">&#9670;&#160;</a></span>saveAdaptiveToFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::saveAdaptiveToFile </td>
          <td>(</td>
          <td class="paramtype">const TString &amp;&#160;</td>
          <td class="paramname"><em>outFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TString &amp;&#160;</td>
          <td class="paramname"><em>systematicName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Save adaptive throw matrix to file. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00174">174</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  174</span>                                                                                     {</div>
<div class="line"><span class="lineno">  175</span>    <a class="code hl_variable" href="classcovarianceBase.html#ab3833dc51a81afc9dca7c3dcbb107af7">AdaptiveHandler</a>.<a class="code hl_function" href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#a752d312d5fdd755af88b58880a9845ec">SaveAdaptiveToFile</a>(outFileName, systematicName); }</div>
<div class="ttc" id="aclassadaptive__mcmc_1_1AdaptiveMCMCHandler_html_a752d312d5fdd755af88b58880a9845ec"><div class="ttname"><a href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#a752d312d5fdd755af88b58880a9845ec">adaptive_mcmc::AdaptiveMCMCHandler::SaveAdaptiveToFile</a></div><div class="ttdeci">void SaveAdaptiveToFile(const TString &amp;outFileName, const TString &amp;systematicName)</div><div class="ttdoc">HW: Save adaptive throw matrix to file.</div><div class="ttdef"><b>Definition:</b> <a href="AdaptiveMCMCHandler_8cpp_source.html#l00123">AdaptiveMCMCHandler.cpp:123</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab36f40d40f4747718c98d368c04f41b7" name="ab36f40d40f4747718c98d368c04f41b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab36f40d40f4747718c98d368c04f41b7">&#9670;&#160;</a></span>SaveUpdatedMatrixConfig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::SaveUpdatedMatrixConfig </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>KS: After step scale, prefit etc. value were modified save this modified config. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l01188">1188</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1188</span>                                             {</div>
<div class="line"><span class="lineno"> 1189</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno"> 1190</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classcovarianceBase.html#a933ff3dc0af99629ba3582a5d9d89d23">_fYAMLDoc</a>)</div>
<div class="line"><span class="lineno"> 1191</span>  {</div>
<div class="line"><span class="lineno"> 1192</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a07ff6d6a15b24f94afc88a1b89779beb">MACH3LOG_CRITICAL</a>(<span class="stringliteral">&quot;Yaml node hasn&#39;t been initialised for matrix {}, something is not right&quot;</span>, <a class="code hl_variable" href="classcovarianceBase.html#a26618d3f5633b33ce20e38ce8261b3ee">matrixName</a>);</div>
<div class="line"><span class="lineno"> 1193</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a07ff6d6a15b24f94afc88a1b89779beb">MACH3LOG_CRITICAL</a>(<span class="stringliteral">&quot;I am not throwing error but should be investigated&quot;</span>);</div>
<div class="line"><span class="lineno"> 1194</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1195</span>  }</div>
<div class="line"><span class="lineno"> 1196</span> </div>
<div class="line"><span class="lineno"> 1197</span>  YAML::Node copyNode = <a class="code hl_variable" href="classcovarianceBase.html#a933ff3dc0af99629ba3582a5d9d89d23">_fYAMLDoc</a>;</div>
<div class="line"><span class="lineno"> 1198</span>  <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><span class="lineno"> 1199</span> </div>
<div class="line"><span class="lineno"> 1200</span>  <span class="keywordflow">for</span> (YAML::Node param : copyNode[<span class="stringliteral">&quot;Systematics&quot;</span>])</div>
<div class="line"><span class="lineno"> 1201</span>  {</div>
<div class="line"><span class="lineno"> 1202</span>    <span class="comment">//KS: Feel free to update it, if you need updated prefit value etc</span></div>
<div class="line"><span class="lineno"> 1203</span>    param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;StepScale&quot;</span>][<span class="stringliteral">&quot;MCMC&quot;</span>] = std::round(<a class="code hl_variable" href="classcovarianceBase.html#a3cda39026e336a49cef482efd4062561">_fIndivStepScale</a>[i] * 100.0) / 100.0; <span class="comment">// Round to 2 decimal places</span></div>
<div class="line"><span class="lineno"> 1204</span>    i++;</div>
<div class="line"><span class="lineno"> 1205</span>  }</div>
<div class="line"><span class="lineno"> 1206</span>  <span class="comment">// Save the modified node to a file</span></div>
<div class="line"><span class="lineno"> 1207</span>  std::ofstream fout(<span class="stringliteral">&quot;Modified_Matrix.yaml&quot;</span>);</div>
<div class="line"><span class="lineno"> 1208</span>  fout &lt;&lt; copyNode;</div>
<div class="line"><span class="lineno"> 1209</span>  fout.close();</div>
<div class="line"><span class="lineno"> 1210</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9f980a259c5952f9ca907832f99ad2a7" name="a9f980a259c5952f9ca907832f99ad2a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f980a259c5952f9ca907832f99ad2a7">&#9670;&#160;</a></span>setName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::setName </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set matrix name. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00040">40</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   40</span>{ <a class="code hl_variable" href="classcovarianceBase.html#a26618d3f5633b33ce20e38ce8261b3ee">matrixName</a> = name; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1e5aec8c073799ac9d40e65c0996b2c1" name="a1e5aec8c073799ac9d40e65c0996b2c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e5aec8c073799ac9d40e65c0996b2c1">&#9670;&#160;</a></span>setNumberOfSteps()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::setNumberOfSteps </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nsteps</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set number of MCMC step, when running adaptive MCMC it is updated with given frequency. We need number of steps to determine frequency. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00183">183</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  183</span>                                                 {</div>
<div class="line"><span class="lineno">  184</span>    <a class="code hl_variable" href="classcovarianceBase.html#ab3833dc51a81afc9dca7c3dcbb107af7">AdaptiveHandler</a>.<a class="code hl_variable" href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#ab2837af4566e2d62db7b76f9527fb6d7">total_steps</a> = nsteps;</div>
<div class="line"><span class="lineno">  185</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classcovarianceBase.html#ab3833dc51a81afc9dca7c3dcbb107af7">AdaptiveHandler</a>.<a class="code hl_function" href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#a39a099e5712cf605190a53a4355c700c">AdaptionUpdate</a>()) <a class="code hl_function" href="classcovarianceBase.html#a0993a1ea6c5b06ba834e9e70af87ee9e">resetIndivStepScale</a>();</div>
<div class="line"><span class="lineno">  186</span>  }</div>
<div class="ttc" id="aclassadaptive__mcmc_1_1AdaptiveMCMCHandler_html_a39a099e5712cf605190a53a4355c700c"><div class="ttname"><a href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#a39a099e5712cf605190a53a4355c700c">adaptive_mcmc::AdaptiveMCMCHandler::AdaptionUpdate</a></div><div class="ttdeci">bool AdaptionUpdate()</div><div class="ttdoc">To be fair not a clue...</div><div class="ttdef"><b>Definition:</b> <a href="AdaptiveMCMCHandler_8cpp_source.html#l00260">AdaptiveMCMCHandler.cpp:260</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a0993a1ea6c5b06ba834e9e70af87ee9e"><div class="ttname"><a href="classcovarianceBase.html#a0993a1ea6c5b06ba834e9e70af87ee9e">covarianceBase::resetIndivStepScale</a></div><div class="ttdeci">void resetIndivStepScale()</div><div class="ttdoc">Adaptive Step Tuning Stuff.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8cpp_source.html#l00981">covarianceBase.cpp:981</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5888af0b4b6e1d7826fca0f6777bf3ae" name="a5888af0b4b6e1d7826fca0f6777bf3ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5888af0b4b6e1d7826fca0f6777bf3ae">&#9670;&#160;</a></span>setParameters_PCA()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::setParameters_PCA </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>pars</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set values for PCA parameters in PCA base. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pars</td><td>vector with new values of PCA params </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00315">315</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  315</span>                                                               {</div>
<div class="line"><span class="lineno">  316</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>) { <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Am not running in PCA mode&quot;</span>); <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ ); }</div>
<div class="line"><span class="lineno">  317</span>    <span class="keywordflow">if</span> (<span class="keywordtype">int</span>(pars.size()) != <a class="code hl_variable" href="classcovarianceBase.html#ac57285a48d41ef764b4c659959a36c2d">_fNumParPCA</a>) {</div>
<div class="line"><span class="lineno">  318</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Warning: parameter arrays of incompatible size! Not changing parameters! {} has size {} but was expecting {}&quot;</span>, <a class="code hl_variable" href="classcovarianceBase.html#a26618d3f5633b33ce20e38ce8261b3ee">matrixName</a>, pars.size(), <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><span class="lineno">  319</span>      <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">  320</span>    }</div>
<div class="line"><span class="lineno">  321</span>    <span class="keywordtype">int</span> parsSize = int(pars.size());</div>
<div class="line"><span class="lineno">  322</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; parsSize; i++) {</div>
<div class="line"><span class="lineno">  323</span>      <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;fParProp_PCA(i) = pars[i];</div>
<div class="line"><span class="lineno">  324</span>    }</div>
<div class="line"><span class="lineno">  325</span>    <span class="comment">//KS: Transfer to normal base</span></div>
<div class="line"><span class="lineno">  326</span>    <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;TransferToParam();</div>
<div class="line"><span class="lineno">  327</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a593457c3ae0a2d1892846b484833274f" name="a593457c3ae0a2d1892846b484833274f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a593457c3ae0a2d1892846b484833274f">&#9670;&#160;</a></span>setParCurr_PCA()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::setParCurr_PCA </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set current value for parameter in PCA base. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>Parameter index </td></tr>
    <tr><td class="paramname">value</td><td>new value </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00306">306</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  306</span>                                                              {</div>
<div class="line"><span class="lineno">  307</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>) { <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Am not running in PCA mode&quot;</span>); <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ ); }</div>
<div class="line"><span class="lineno">  308</span>    <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;fParCurr_PCA(i) = value;</div>
<div class="line"><span class="lineno">  309</span>    <span class="comment">// And then transfer back to the parameter basis</span></div>
<div class="line"><span class="lineno">  310</span>    <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;TransferToParam();</div>
<div class="line"><span class="lineno">  311</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c9b2ae1b4144448385b47a576e4d07d" name="a7c9b2ae1b4144448385b47a576e4d07d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c9b2ae1b4144448385b47a576e4d07d">&#9670;&#160;</a></span>setParProp_PCA()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::setParProp_PCA </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set proposed value for parameter in PCA base. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>Parameter index </td></tr>
    <tr><td class="paramname">value</td><td>new value </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00297">297</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  297</span>                                                              {</div>
<div class="line"><span class="lineno">  298</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>) { <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Am not running in PCA mode&quot;</span>); <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ ); }</div>
<div class="line"><span class="lineno">  299</span>    <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;fParProp_PCA(i) = value;</div>
<div class="line"><span class="lineno">  300</span>    <span class="comment">// And then transfer back to the parameter basis</span></div>
<div class="line"><span class="lineno">  301</span>    <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;TransferToParam();</div>
<div class="line"><span class="lineno">  302</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af30ca7861452e1446e55700f4b49b608" name="af30ca7861452e1446e55700f4b49b608"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af30ca7861452e1446e55700f4b49b608">&#9670;&#160;</a></span>setThrowMatrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::setThrowMatrix </td>
          <td>(</td>
          <td class="paramtype">TMatrixDSym *&#160;</td>
          <td class="paramname"><em>cov</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use new throw matrix, used in adaptive MCMC. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00993">993</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  993</span>                                                   {</div>
<div class="line"><span class="lineno">  994</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">  995</span>   <span class="keywordflow">if</span> (cov == <span class="keyword">nullptr</span>) {</div>
<div class="line"><span class="lineno">  996</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Could not find covariance matrix you provided to setThrowMatrix&quot;</span>);</div>
<div class="line"><span class="lineno">  997</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">  998</span>  }</div>
<div class="line"><span class="lineno">  999</span> </div>
<div class="line"><span class="lineno"> 1000</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcovarianceBase.html#a6c3fe8db34c06299fd1633951ac00937">covMatrix</a>-&gt;GetNrows() != cov-&gt;GetNrows()) {</div>
<div class="line"><span class="lineno"> 1001</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Matrix given for throw Matrix is not the same size as the covariance matrix stored in object!&quot;</span>);</div>
<div class="line"><span class="lineno"> 1002</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Stored covariance matrix size: {}&quot;</span>, <a class="code hl_variable" href="classcovarianceBase.html#a6c3fe8db34c06299fd1633951ac00937">covMatrix</a>-&gt;GetNrows());</div>
<div class="line"><span class="lineno"> 1003</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Given matrix size: {}&quot;</span>, cov-&gt;GetNrows());</div>
<div class="line"><span class="lineno"> 1004</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno"> 1005</span>  }</div>
<div class="line"><span class="lineno"> 1006</span> </div>
<div class="line"><span class="lineno"> 1007</span>  <a class="code hl_variable" href="classcovarianceBase.html#a6cb3d0b4096fbb55b040f70cd5b6e32b">throwMatrix</a> = <span class="keyword">static_cast&lt;</span>TMatrixDSym*<span class="keyword">&gt;</span>(cov-&gt;Clone());</div>
<div class="line"><span class="lineno"> 1008</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classcovarianceBase.html#a838731abd6716940043b484b2b266f86">use_adaptive</a> &amp;&amp; <a class="code hl_variable" href="classcovarianceBase.html#ab3833dc51a81afc9dca7c3dcbb107af7">AdaptiveHandler</a>.<a class="code hl_function" href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#a39a099e5712cf605190a53a4355c700c">AdaptionUpdate</a>()) <a class="code hl_function" href="classcovarianceBase.html#a8a709e1c6c58618cf65400eef1741cc7">makeClosestPosDef</a>(<a class="code hl_variable" href="classcovarianceBase.html#a6cb3d0b4096fbb55b040f70cd5b6e32b">throwMatrix</a>);</div>
<div class="line"><span class="lineno"> 1009</span>  <span class="keywordflow">else</span> <a class="code hl_function" href="classcovarianceBase.html#ae2850c8e2f2d4acfe322b0ebe65b07cf">MakePosDef</a>(<a class="code hl_variable" href="classcovarianceBase.html#a6cb3d0b4096fbb55b040f70cd5b6e32b">throwMatrix</a>);</div>
<div class="line"><span class="lineno"> 1010</span>  </div>
<div class="line"><span class="lineno"> 1011</span>  TDecompChol TDecompChol_throwMatrix(*<a class="code hl_variable" href="classcovarianceBase.html#a6cb3d0b4096fbb55b040f70cd5b6e32b">throwMatrix</a>);</div>
<div class="line"><span class="lineno"> 1012</span>  </div>
<div class="line"><span class="lineno"> 1013</span>  <span class="keywordflow">if</span>(!TDecompChol_throwMatrix.Decompose()) {</div>
<div class="line"><span class="lineno"> 1014</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Cholesky decomposition failed for {} trying to make positive definite&quot;</span>, <a class="code hl_variable" href="classcovarianceBase.html#a26618d3f5633b33ce20e38ce8261b3ee">matrixName</a>);</div>
<div class="line"><span class="lineno"> 1015</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno"> 1016</span>  }</div>
<div class="line"><span class="lineno"> 1017</span> </div>
<div class="line"><span class="lineno"> 1018</span>  <a class="code hl_variable" href="classcovarianceBase.html#ab95f5e066c2dfb1d20d120bc6c85dda2">throwMatrix_CholDecomp</a> = <span class="keyword">new</span> TMatrixD(TDecompChol_throwMatrix.GetU());</div>
<div class="line"><span class="lineno"> 1019</span>  <a class="code hl_variable" href="classcovarianceBase.html#ab95f5e066c2dfb1d20d120bc6c85dda2">throwMatrix_CholDecomp</a>-&gt;T();</div>
<div class="line"><span class="lineno"> 1020</span> </div>
<div class="line"><span class="lineno"> 1021</span>  <span class="comment">//KS: ROOT has bad memory management, using standard double means we can decrease most operation by factor 2 simply due to cache hits</span></div>
<div class="line"><span class="lineno"> 1022</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 1023</span><span class="preprocessor">  #pragma omp parallel for collapse(2)</span></div>
<div class="line"><span class="lineno"> 1024</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 1025</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; ++i)</div>
<div class="line"><span class="lineno"> 1026</span>  {</div>
<div class="line"><span class="lineno"> 1027</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; ++j)</div>
<div class="line"><span class="lineno"> 1028</span>    {</div>
<div class="line"><span class="lineno"> 1029</span>      <a class="code hl_variable" href="classcovarianceBase.html#aca17e48a5fa8e353317d58c205fb89df">throwMatrixCholDecomp</a>[i][j] = (*throwMatrix_CholDecomp)(i,j);</div>
<div class="line"><span class="lineno"> 1030</span>    }</div>
<div class="line"><span class="lineno"> 1031</span>  }</div>
<div class="line"><span class="lineno"> 1032</span>}</div>
<div class="ttc" id="aclasscovarianceBase_html_a8a709e1c6c58618cf65400eef1741cc7"><div class="ttname"><a href="classcovarianceBase.html#a8a709e1c6c58618cf65400eef1741cc7">covarianceBase::makeClosestPosDef</a></div><div class="ttdeci">void makeClosestPosDef(TMatrixDSym *cov)</div><div class="ttdoc">HW: Finds closest possible positive definite matrix in Frobenius Norm ||.||_frob Where ||X||_frob=sqr...</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8cpp_source.html#l01102">covarianceBase.cpp:1102</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5ab3d89b7fe6103ae6f750c984bcefc8" name="a5ab3d89b7fe6103ae6f750c984bcefc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ab3d89b7fe6103ae6f750c984bcefc8">&#9670;&#160;</a></span>setThrowMatrixFromFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::setThrowMatrixFromFile </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>matrix_file_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>matrix_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>means_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>sets throw matrix from a file </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix_file_name</td><td>name of file matrix lives in </td></tr>
    <tr><td class="paramname">matrix_name</td><td>name of matrix in file </td></tr>
    <tr><td class="paramname">means_name</td><td>name of means vec in file </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa5d82895bcbae7773b6813c02cf2f485" name="aa5d82895bcbae7773b6813c02cf2f485"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5d82895bcbae7773b6813c02cf2f485">&#9670;&#160;</a></span>throwParameters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::throwParameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Throw the parameters according to the covariance matrix. This shouldn't be used in MCMC code ase it can break Detailed Balance;. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00376">376</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  376</span>                                     {</div>
<div class="line"><span class="lineno">  377</span><span class="comment">// *************************************</span></div>
<div class="line"><span class="lineno">  378</span>  <span class="comment">// First draw new randParams</span></div>
<div class="line"><span class="lineno">  379</span>  <a class="code hl_function" href="classcovarianceBase.html#a8d58b8e8ac3b2a8f1c6867e8b6cd7ff8">randomize</a>();</div>
<div class="line"><span class="lineno">  380</span> </div>
<div class="line"><span class="lineno">  381</span>  <span class="comment">// KS: We use PCA very rarely on top PCA functionality isn&#39;t implemented for this function.</span></div>
<div class="line"><span class="lineno">  382</span>  <span class="comment">// Use __builtin_expect to give compiler a hint which option is more likely, which should help</span></div>
<div class="line"><span class="lineno">  383</span>  <span class="comment">// with better optimisation. This isn&#39;t critical but more to have example</span></div>
<div class="line"><span class="lineno">  384</span>  <span class="keywordflow">if</span> (__builtin_expect(!<a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>, 1)) {</div>
<div class="line"><span class="lineno">  385</span>    <a class="code hl_function" href="classcovarianceBase.html#a43367db263b2607232077410f27b1146">MatrixVectorMulti</a>(<a class="code hl_variable" href="classcovarianceBase.html#a7b70de3f098aae1d537d80bac5969d88">corr_throw</a>, <a class="code hl_variable" href="classcovarianceBase.html#aca17e48a5fa8e353317d58c205fb89df">throwMatrixCholDecomp</a>, <a class="code hl_variable" href="classcovarianceBase.html#a705e648220c06083cd1acc5fba4f2ef7">randParams</a>, <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span><span class="preprocessor">    #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  388</span><span class="preprocessor">    #pragma omp parallel for</span></div>
<div class="line"><span class="lineno">  389</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  390</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; ++i) {</div>
<div class="line"><span class="lineno">  391</span>      <span class="comment">// Check if parameter is fixed first: if so don&#39;t randomly throw</span></div>
<div class="line"><span class="lineno">  392</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="classcovarianceBase.html#a76cad7ebfd2ca8c4f1a8b69e0153436e">isParameterFixed</a>(i)) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span>      <a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[i] = <a class="code hl_variable" href="classcovarianceBase.html#a7578a2cc2e8e9100fad88310a824cb1c">_fPreFitValue</a>[i] + <a class="code hl_variable" href="classcovarianceBase.html#a7b70de3f098aae1d537d80bac5969d88">corr_throw</a>[i];</div>
<div class="line"><span class="lineno">  395</span>      <span class="keywordtype">int</span> <span class="keywordflow">throws</span> = 0;</div>
<div class="line"><span class="lineno">  396</span>      <span class="comment">// Try again if we the initial parameter proposal falls outside of the range of the parameter</span></div>
<div class="line"><span class="lineno">  397</span>      <span class="keywordflow">while</span> (<a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[i] &gt; <a class="code hl_variable" href="classcovarianceBase.html#a31e636cb6de871bd0c2c8e7e299df9e7">_fUpBound</a>[i] || <a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[i] &lt; <a class="code hl_variable" href="classcovarianceBase.html#a8f1d94838f188cc85c4f82557c0b0b66">_fLowBound</a>[i]) {</div>
<div class="line"><span class="lineno">  398</span>        <a class="code hl_variable" href="classcovarianceBase.html#a705e648220c06083cd1acc5fba4f2ef7">randParams</a>[i] = <a class="code hl_variable" href="classcovarianceBase.html#a0704c430bdc8e87fd6f03f01b2ab00df">random_number</a>[<a class="code hl_function" href="namespaceM3.html#a5ed0accdbf66626c16b6c3b00bd5d030">M3::GetThreadIndex</a>()]-&gt;Gaus(0, 1);</div>
<div class="line"><span class="lineno">  399</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> corr_throw_single = <a class="code hl_function" href="classcovarianceBase.html#a29d3a7af51740c17ae5002b579923446">MatrixVectorMultiSingle</a>(<a class="code hl_variable" href="classcovarianceBase.html#aca17e48a5fa8e353317d58c205fb89df">throwMatrixCholDecomp</a>, <a class="code hl_variable" href="classcovarianceBase.html#a705e648220c06083cd1acc5fba4f2ef7">randParams</a>, <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>, i);</div>
<div class="line"><span class="lineno">  400</span>        <a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[i] = <a class="code hl_variable" href="classcovarianceBase.html#a7578a2cc2e8e9100fad88310a824cb1c">_fPreFitValue</a>[i] + corr_throw_single;</div>
<div class="line"><span class="lineno">  401</span>        <span class="keywordflow">if</span> (<span class="keywordflow">throws</span> &gt; 10000) </div>
<div class="line"><span class="lineno">  402</span>        {</div>
<div class="line"><span class="lineno">  403</span>          <span class="comment">//KS: Since we are multithreading there is danger that those messages</span></div>
<div class="line"><span class="lineno">  404</span>          <span class="comment">//will be all over the place, small price to pay for faster code</span></div>
<div class="line"><span class="lineno">  405</span>          <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Tried {} times to throw parameter {} but failed&quot;</span>, <span class="keywordflow">throws</span>, i);</div>
<div class="line"><span class="lineno">  406</span>          <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Matrix: {}&quot;</span>, <a class="code hl_variable" href="classcovarianceBase.html#a26618d3f5633b33ce20e38ce8261b3ee">matrixName</a>);</div>
<div class="line"><span class="lineno">  407</span>          <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Param: {}&quot;</span>, <a class="code hl_variable" href="classcovarianceBase.html#a3e502d80fd2c30a7da4fe75a3e05b0da">_fNames</a>[i]);</div>
<div class="line"><span class="lineno">  408</span>          <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Setting _fPropVal:  {} to {}&quot;</span>, <a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[i], <a class="code hl_variable" href="classcovarianceBase.html#a7578a2cc2e8e9100fad88310a824cb1c">_fPreFitValue</a>[i]);</div>
<div class="line"><span class="lineno">  409</span>          <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;I live at {}:{}&quot;</span>, __FILE__, __LINE__);</div>
<div class="line"><span class="lineno">  410</span>          <a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[i] = <a class="code hl_variable" href="classcovarianceBase.html#a7578a2cc2e8e9100fad88310a824cb1c">_fPreFitValue</a>[i];</div>
<div class="line"><span class="lineno">  411</span>          <span class="comment">//throw MaCh3Exception(__FILE__ , __LINE__ );</span></div>
<div class="line"><span class="lineno">  412</span>        }</div>
<div class="line"><span class="lineno">  413</span>        <span class="keywordflow">throws</span>++;</div>
<div class="line"><span class="lineno">  414</span>      }</div>
<div class="line"><span class="lineno">  415</span>      <a class="code hl_variable" href="classcovarianceBase.html#ae70f51df3976975b2dc78fd3bfc28b65">_fCurrVal</a>[i] = <a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[i];</div>
<div class="line"><span class="lineno">  416</span>    }</div>
<div class="line"><span class="lineno">  417</span>  }</div>
<div class="line"><span class="lineno">  418</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  419</span>  {</div>
<div class="line"><span class="lineno">  420</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a07ff6d6a15b24f94afc88a1b89779beb">MACH3LOG_CRITICAL</a>(<span class="stringliteral">&quot;Hold on, you are trying to run Prior Predictive Code with PCA, which is wrong&quot;</span>);</div>
<div class="line"><span class="lineno">  421</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a07ff6d6a15b24f94afc88a1b89779beb">MACH3LOG_CRITICAL</a>(<span class="stringliteral">&quot;Sorry I have to kill you, I mean your job&quot;</span>);</div>
<div class="line"><span class="lineno">  422</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">  423</span>  }</div>
<div class="line"><span class="lineno">  424</span>}</div>
<div class="ttc" id="aclasscovarianceBase_html_a29d3a7af51740c17ae5002b579923446"><div class="ttname"><a href="classcovarianceBase.html#a29d3a7af51740c17ae5002b579923446">covarianceBase::MatrixVectorMultiSingle</a></div><div class="ttdeci">double MatrixVectorMultiSingle(double **_restrict_ matrix, const double *_restrict_ vector, const int Length, const int i) const</div><div class="ttdoc">KS: Custom function to perform multiplication of matrix and single element which is thread safe.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8cpp_source.html#l00893">covarianceBase.cpp:893</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4e92a9db846d956473efbe5712c71d31" name="a4e92a9db846d956473efbe5712c71d31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e92a9db846d956473efbe5712c71d31">&#9670;&#160;</a></span>throwParCurr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::throwParCurr </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>mag</em> = <code>1.</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Helper function to throw the current parameter by mag sigma. Can study bias in MCMC with this; put different starting parameters. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00601">601</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  601</span>                                                  {</div>
<div class="line"><span class="lineno">  602</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">  603</span>  <a class="code hl_function" href="classcovarianceBase.html#a8d58b8e8ac3b2a8f1c6867e8b6cd7ff8">randomize</a>();</div>
<div class="line"><span class="lineno">  604</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>) {</div>
<div class="line"><span class="lineno">  605</span>    <span class="comment">// Get the correlated throw vector</span></div>
<div class="line"><span class="lineno">  606</span>    <a class="code hl_function" href="classcovarianceBase.html#a43367db263b2607232077410f27b1146">MatrixVectorMulti</a>(<a class="code hl_variable" href="classcovarianceBase.html#a7b70de3f098aae1d537d80bac5969d88">corr_throw</a>, <a class="code hl_variable" href="classcovarianceBase.html#aca17e48a5fa8e353317d58c205fb89df">throwMatrixCholDecomp</a>, <a class="code hl_variable" href="classcovarianceBase.html#a705e648220c06083cd1acc5fba4f2ef7">randParams</a>, <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><span class="lineno">  607</span>    <span class="comment">// The number of sigmas to throw</span></div>
<div class="line"><span class="lineno">  608</span>    <span class="comment">// Should probably have this as a default parameter input to the function instead</span></div>
<div class="line"><span class="lineno">  609</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; i++) {</div>
<div class="line"><span class="lineno">  610</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcovarianceBase.html#a34f877fc160b4a93a3aab1b3a8977858">_fError</a>[i] &gt; 0.){</div>
<div class="line"><span class="lineno">  611</span>        <a class="code hl_variable" href="classcovarianceBase.html#ae70f51df3976975b2dc78fd3bfc28b65">_fCurrVal</a>[i] = <a class="code hl_variable" href="classcovarianceBase.html#a7b70de3f098aae1d537d80bac5969d88">corr_throw</a>[i]*mag;</div>
<div class="line"><span class="lineno">  612</span>      }</div>
<div class="line"><span class="lineno">  613</span>    }</div>
<div class="line"><span class="lineno">  614</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  615</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; i++) {</div>
<div class="line"><span class="lineno">  616</span>      <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;fParProp_PCA(i) = mag*<a class="code hl_variable" href="classcovarianceBase.html#a705e648220c06083cd1acc5fba4f2ef7">randParams</a>[i];</div>
<div class="line"><span class="lineno">  617</span>    }</div>
<div class="line"><span class="lineno">  618</span>    <span class="comment">// And update the fParCurr in the basis</span></div>
<div class="line"><span class="lineno">  619</span>    <span class="comment">// Then update the fParProp in the parameter basis using the transfer matrix, so likelihood is evaluated correctly</span></div>
<div class="line"><span class="lineno">  620</span>    TVectorD current = <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;TransferMat*<a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;fParCurr_PCA;</div>
<div class="line"><span class="lineno">  621</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; ++i) {</div>
<div class="line"><span class="lineno">  622</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;fParSigma_PCA[i] &gt; 0.) {</div>
<div class="line"><span class="lineno">  623</span>        <a class="code hl_variable" href="classcovarianceBase.html#ae70f51df3976975b2dc78fd3bfc28b65">_fCurrVal</a>[i] = current(i);</div>
<div class="line"><span class="lineno">  624</span>      }</div>
<div class="line"><span class="lineno">  625</span>    }</div>
<div class="line"><span class="lineno">  626</span>  }</div>
<div class="line"><span class="lineno">  627</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af4d127ff4761379dd11843523835c4dc" name="af4d127ff4761379dd11843523835c4dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4d127ff4761379dd11843523835c4dc">&#9670;&#160;</a></span>throwParProp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::throwParProp </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>mag</em> = <code>1.</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Throw the proposed parameter by mag sigma. Should really just have the user specify this throw by having argument double. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00573">573</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  573</span>                                                  {</div>
<div class="line"><span class="lineno">  574</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">  575</span>  <a class="code hl_function" href="classcovarianceBase.html#a8d58b8e8ac3b2a8f1c6867e8b6cd7ff8">randomize</a>();</div>
<div class="line"><span class="lineno">  576</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>) {</div>
<div class="line"><span class="lineno">  577</span>    <span class="comment">// Make the correlated throw</span></div>
<div class="line"><span class="lineno">  578</span>    <a class="code hl_function" href="classcovarianceBase.html#a43367db263b2607232077410f27b1146">MatrixVectorMulti</a>(<a class="code hl_variable" href="classcovarianceBase.html#a7b70de3f098aae1d537d80bac5969d88">corr_throw</a>, <a class="code hl_variable" href="classcovarianceBase.html#aca17e48a5fa8e353317d58c205fb89df">throwMatrixCholDecomp</a>, <a class="code hl_variable" href="classcovarianceBase.html#a705e648220c06083cd1acc5fba4f2ef7">randParams</a>, <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><span class="lineno">  579</span>    <span class="comment">// Number of sigmas we throw</span></div>
<div class="line"><span class="lineno">  580</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; i++) {</div>
<div class="line"><span class="lineno">  581</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcovarianceBase.html#a34f877fc160b4a93a3aab1b3a8977858">_fError</a>[i] &gt; 0.)</div>
<div class="line"><span class="lineno">  582</span>        <a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[i] = <a class="code hl_variable" href="classcovarianceBase.html#ae70f51df3976975b2dc78fd3bfc28b65">_fCurrVal</a>[i] + <a class="code hl_variable" href="classcovarianceBase.html#a7b70de3f098aae1d537d80bac5969d88">corr_throw</a>[i]*mag;</div>
<div class="line"><span class="lineno">  583</span>    }</div>
<div class="line"><span class="lineno">  584</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  585</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; i++) {</div>
<div class="line"><span class="lineno">  586</span>      <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;fParProp_PCA(i) = <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;fParCurr_PCA(i)+mag*<a class="code hl_variable" href="classcovarianceBase.html#a705e648220c06083cd1acc5fba4f2ef7">randParams</a>[i];</div>
<div class="line"><span class="lineno">  587</span>    }</div>
<div class="line"><span class="lineno">  588</span>    <span class="comment">// And update the fParCurr in the basis</span></div>
<div class="line"><span class="lineno">  589</span>    <span class="comment">// Then update the fParProp in the parameter basis using the transfer matrix, so likelihood is evaluated correctly</span></div>
<div class="line"><span class="lineno">  590</span>    TVectorD proposed = <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;TransferMat*<a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;fParProp_PCA;</div>
<div class="line"><span class="lineno">  591</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; ++i) {</div>
<div class="line"><span class="lineno">  592</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;fParSigma_PCA[i] &gt; 0.) {</div>
<div class="line"><span class="lineno">  593</span>        <a class="code hl_variable" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[i] = proposed(i);</div>
<div class="line"><span class="lineno">  594</span>      }</div>
<div class="line"><span class="lineno">  595</span>    }</div>
<div class="line"><span class="lineno">  596</span>  }</div>
<div class="line"><span class="lineno">  597</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="adb2d1a39cd2bd160257bc9e34e32df4c" name="adb2d1a39cd2bd160257bc9e34e32df4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb2d1a39cd2bd160257bc9e34e32df4c">&#9670;&#160;</a></span>toggleFixAllParameters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::toggleFixAllParameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>fix parameters at prior values </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00791">791</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  791</span>                                            {</div>
<div class="line"><span class="lineno">  792</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">  793</span>  <span class="comment">// fix or unfix all parameters by multiplying by -1</span></div>
<div class="line"><span class="lineno">  794</span>  <span class="keywordflow">if</span>(!<a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>) {</div>
<div class="line"><span class="lineno">  795</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; i++) <a class="code hl_variable" href="classcovarianceBase.html#a34f877fc160b4a93a3aab1b3a8977858">_fError</a>[i] *= -1.0;</div>
<div class="line"><span class="lineno">  796</span>  } <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno">  797</span>     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac57285a48d41ef764b4c659959a36c2d">_fNumParPCA</a>; i++) <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;fParSigma_PCA[i] *= -1.0;</div>
<div class="line"><span class="lineno">  798</span>  }</div>
<div class="line"><span class="lineno">  799</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aafbbdc05b87df882dc341e20fe870603" name="aafbbdc05b87df882dc341e20fe870603"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafbbdc05b87df882dc341e20fe870603">&#9670;&#160;</a></span>toggleFixParameter() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::toggleFixParameter </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>fix parameter at prior values </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>Parameter index </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00802">802</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  802</span>                                                   {</div>
<div class="line"><span class="lineno">  803</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">  804</span>  <span class="keywordflow">if</span>(!<a class="code hl_variable" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>) {</div>
<div class="line"><span class="lineno">  805</span>    <span class="keywordflow">if</span> (i &gt; <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>) {</div>
<div class="line"><span class="lineno">  806</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Can&#39;t toggleFixParameter for parameter {} because size of covariance ={}&quot;</span>, i, <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><span class="lineno">  807</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Fix this in your config file please!&quot;</span>);</div>
<div class="line"><span class="lineno">  808</span>      <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">  809</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  810</span>      <a class="code hl_variable" href="classcovarianceBase.html#a34f877fc160b4a93a3aab1b3a8977858">_fError</a>[i] *= -1.0;</div>
<div class="line"><span class="lineno">  811</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Setting {}(parameter {}) to fixed at {}&quot;</span>, <a class="code hl_function" href="group__Setters.html#ga295f5fe63911d4c704b73e0b0c8c7971">GetParFancyName</a>(i), i, <a class="code hl_variable" href="classcovarianceBase.html#ae70f51df3976975b2dc78fd3bfc28b65">_fCurrVal</a>[i]);</div>
<div class="line"><span class="lineno">  812</span>    }</div>
<div class="line"><span class="lineno">  813</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  814</span>    <span class="keywordtype">int</span> isDecom = -1;</div>
<div class="line"><span class="lineno">  815</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> im = 0; im &lt; <a class="code hl_variable" href="classcovarianceBase.html#ac57285a48d41ef764b4c659959a36c2d">_fNumParPCA</a>; ++im) {</div>
<div class="line"><span class="lineno">  816</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;isDecomposed_PCA[im] == i) {isDecom = im;}</div>
<div class="line"><span class="lineno">  817</span>    }</div>
<div class="line"><span class="lineno">  818</span>    <span class="keywordflow">if</span>(isDecom &lt; 0) {</div>
<div class="line"><span class="lineno">  819</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Parameter {} is PCA decomposed can&#39;t fix this&quot;</span>, <a class="code hl_function" href="group__Setters.html#gab4ac97e0e881db5ca0f28cdeba39e228">GetParName</a>(i));</div>
<div class="line"><span class="lineno">  820</span>      <span class="comment">//throw MaCh3Exception(__FILE__ , __LINE__ );</span></div>
<div class="line"><span class="lineno">  821</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  822</span>      <a class="code hl_variable" href="classcovarianceBase.html#acb8262289fb5a37e849def35c04d6165">PCAObj</a>-&gt;fParSigma_PCA[isDecom] *= -1.0;</div>
<div class="line"><span class="lineno">  823</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Setting un-decomposed {}(parameter {}/{} in PCA base) to fixed at {}&quot;</span>, <a class="code hl_function" href="group__Setters.html#gab4ac97e0e881db5ca0f28cdeba39e228">GetParName</a>(i), i, isDecom, <a class="code hl_variable" href="classcovarianceBase.html#ae70f51df3976975b2dc78fd3bfc28b65">_fCurrVal</a>[i]);</div>
<div class="line"><span class="lineno">  824</span>    }</div>
<div class="line"><span class="lineno">  825</span>  }</div>
<div class="line"><span class="lineno">  826</span>}</div>
<div class="ttc" id="agroup__Setters_html_gab4ac97e0e881db5ca0f28cdeba39e228"><div class="ttname"><a href="group__Setters.html#gab4ac97e0e881db5ca0f28cdeba39e228">covarianceBase::GetParName</a></div><div class="ttdeci">std::string GetParName(const int i) const</div><div class="ttdoc">Get name of covariance.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00149">covarianceBase.h:149</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a41cc8dd2185af7cee380f3c6d463e5a4" name="a41cc8dd2185af7cee380f3c6d463e5a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41cc8dd2185af7cee380f3c6d463e5a4">&#9670;&#160;</a></span>toggleFixParameter() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::toggleFixParameter </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fix parameter at prior values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of parameter you want to fix </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l00829">829</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  829</span>                                                             {</div>
<div class="line"><span class="lineno">  830</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno">  831</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;<a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; ++i) {</div>
<div class="line"><span class="lineno">  832</span>    <span class="keywordflow">if</span>(name == <a class="code hl_variable" href="classcovarianceBase.html#a973671386a2f8ea924f25f8f5404654c">_fFancyNames</a>[i]) {</div>
<div class="line"><span class="lineno">  833</span>      <a class="code hl_function" href="classcovarianceBase.html#aafbbdc05b87df882dc341e20fe870603">toggleFixParameter</a>(i);</div>
<div class="line"><span class="lineno">  834</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  835</span>    }</div>
<div class="line"><span class="lineno">  836</span>  }</div>
<div class="line"><span class="lineno">  837</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;I couldn&#39;t find parameter with name {}, therefore will not fix it&quot;</span>, name);</div>
<div class="line"><span class="lineno">  838</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a50ce8ebb96ebd64190dc37e4bf950a9b" name="a50ce8ebb96ebd64190dc37e4bf950a9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50ce8ebb96ebd64190dc37e4bf950a9b">&#9670;&#160;</a></span>updateAdaptiveCovariance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::updateAdaptiveCovariance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method to update adaptive MCMC <a class="el" href="citelist.html#CITEREF_haario2001adaptive">[10]</a>. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l01075">1075</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1075</span>                                             {</div>
<div class="line"><span class="lineno"> 1076</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno"> 1077</span>  <span class="comment">// Updates adaptive matrix</span></div>
<div class="line"><span class="lineno"> 1078</span>  <span class="comment">// First we update the total means</span></div>
<div class="line"><span class="lineno"> 1079</span> </div>
<div class="line"><span class="lineno"> 1080</span>  <span class="comment">// Skip this if we&#39;re at a large number of steps</span></div>
<div class="line"><span class="lineno"> 1081</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classcovarianceBase.html#ab3833dc51a81afc9dca7c3dcbb107af7">AdaptiveHandler</a>.<a class="code hl_function" href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#af797ab969eb8c1802afa12df8c2106d8">SkipAdaption</a>()) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1082</span> </div>
<div class="line"><span class="lineno"> 1083</span>  <span class="comment">// Call main adaption function</span></div>
<div class="line"><span class="lineno"> 1084</span>  <a class="code hl_variable" href="classcovarianceBase.html#ab3833dc51a81afc9dca7c3dcbb107af7">AdaptiveHandler</a>.<a class="code hl_function" href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#a828e12f4ecb82252341af5f5e54f7ad3">UpdateAdaptiveCovariance</a>(<a class="code hl_variable" href="classcovarianceBase.html#ae70f51df3976975b2dc78fd3bfc28b65">_fCurrVal</a>, <a class="code hl_variable" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><span class="lineno"> 1085</span> </div>
<div class="line"><span class="lineno"> 1086</span>  <span class="comment">//This is likely going to be the slow bit!</span></div>
<div class="line"><span class="lineno"> 1087</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classcovarianceBase.html#ab3833dc51a81afc9dca7c3dcbb107af7">AdaptiveHandler</a>.<a class="code hl_function" href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#a77726d0255edf32a817339fcbac30bee">IndivStepScaleAdapt</a>()) {</div>
<div class="line"><span class="lineno"> 1088</span>    <a class="code hl_function" href="classcovarianceBase.html#a0993a1ea6c5b06ba834e9e70af87ee9e">resetIndivStepScale</a>();</div>
<div class="line"><span class="lineno"> 1089</span>  }</div>
<div class="line"><span class="lineno"> 1090</span> </div>
<div class="line"><span class="lineno"> 1091</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classcovarianceBase.html#ab3833dc51a81afc9dca7c3dcbb107af7">AdaptiveHandler</a>.<a class="code hl_function" href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#a217c72a492c9d3e1b3a7b14626d19ab2">UpdateMatrixAdapt</a>()) {</div>
<div class="line"><span class="lineno"> 1092</span>    TMatrixDSym* update_matrix = <span class="keyword">static_cast&lt;</span>TMatrixDSym*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classcovarianceBase.html#ab3833dc51a81afc9dca7c3dcbb107af7">AdaptiveHandler</a>.<a class="code hl_variable" href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#afd61e64f18f5c25dbbd6bb2bd619a268">adaptive_covariance</a>-&gt;Clone());</div>
<div class="line"><span class="lineno"> 1093</span>    <a class="code hl_function" href="classcovarianceBase.html#a7e2d3623bbbf3edee558e04737fe2add">updateThrowMatrix</a>(update_matrix); <span class="comment">//Now we update and continue!</span></div>
<div class="line"><span class="lineno"> 1094</span>  }</div>
<div class="line"><span class="lineno"> 1095</span>  <a class="code hl_variable" href="classcovarianceBase.html#ab3833dc51a81afc9dca7c3dcbb107af7">AdaptiveHandler</a>.<a class="code hl_variable" href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#ab2837af4566e2d62db7b76f9527fb6d7">total_steps</a>++;</div>
<div class="line"><span class="lineno"> 1096</span>}</div>
<div class="ttc" id="aclassadaptive__mcmc_1_1AdaptiveMCMCHandler_html_a217c72a492c9d3e1b3a7b14626d19ab2"><div class="ttname"><a href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#a217c72a492c9d3e1b3a7b14626d19ab2">adaptive_mcmc::AdaptiveMCMCHandler::UpdateMatrixAdapt</a></div><div class="ttdeci">bool UpdateMatrixAdapt()</div><div class="ttdoc">Tell whether matrix should be updated.</div><div class="ttdef"><b>Definition:</b> <a href="AdaptiveMCMCHandler_8cpp_source.html#l00244">AdaptiveMCMCHandler.cpp:244</a></div></div>
<div class="ttc" id="aclassadaptive__mcmc_1_1AdaptiveMCMCHandler_html_a77726d0255edf32a817339fcbac30bee"><div class="ttname"><a href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#a77726d0255edf32a817339fcbac30bee">adaptive_mcmc::AdaptiveMCMCHandler::IndivStepScaleAdapt</a></div><div class="ttdeci">bool IndivStepScaleAdapt()</div><div class="ttdoc">Tell whether we want reset step scale or not.</div><div class="ttdef"><b>Definition:</b> <a href="AdaptiveMCMCHandler_8cpp_source.html#l00237">AdaptiveMCMCHandler.cpp:237</a></div></div>
<div class="ttc" id="aclassadaptive__mcmc_1_1AdaptiveMCMCHandler_html_a828e12f4ecb82252341af5f5e54f7ad3"><div class="ttname"><a href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#a828e12f4ecb82252341af5f5e54f7ad3">adaptive_mcmc::AdaptiveMCMCHandler::UpdateAdaptiveCovariance</a></div><div class="ttdeci">void UpdateAdaptiveCovariance(const std::vector&lt; double &gt; &amp;_fCurrVal, const int Npars)</div><div class="ttdoc">Method to update adaptive MCMC .</div><div class="ttdef"><b>Definition:</b> <a href="AdaptiveMCMCHandler_8cpp_source.html#l00198">AdaptiveMCMCHandler.cpp:198</a></div></div>
<div class="ttc" id="aclassadaptive__mcmc_1_1AdaptiveMCMCHandler_html_af797ab969eb8c1802afa12df8c2106d8"><div class="ttname"><a href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html#af797ab969eb8c1802afa12df8c2106d8">adaptive_mcmc::AdaptiveMCMCHandler::SkipAdaption</a></div><div class="ttdeci">bool SkipAdaption()</div><div class="ttdoc">Tell if we are Skipping Adaption.</div><div class="ttdef"><b>Definition:</b> <a href="AdaptiveMCMCHandler_8cpp_source.html#l00252">AdaptiveMCMCHandler.cpp:252</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a7e2d3623bbbf3edee558e04737fe2add"><div class="ttname"><a href="classcovarianceBase.html#a7e2d3623bbbf3edee558e04737fe2add">covarianceBase::updateThrowMatrix</a></div><div class="ttdeci">void updateThrowMatrix(TMatrixDSym *cov)</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8cpp_source.html#l01035">covarianceBase.cpp:1035</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7e2d3623bbbf3edee558e04737fe2add" name="a7e2d3623bbbf3edee558e04737fe2add"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e2d3623bbbf3edee558e04737fe2add">&#9670;&#160;</a></span>updateThrowMatrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void covarianceBase::updateThrowMatrix </td>
          <td>(</td>
          <td class="paramtype">TMatrixDSym *&#160;</td>
          <td class="paramname"><em>cov</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="covarianceBase_8cpp_source.html#l01035">1035</a> of file <a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1035</span>                                                      {</div>
<div class="line"><span class="lineno"> 1036</span><span class="comment">// ********************************************</span></div>
<div class="line"><span class="lineno"> 1037</span>  <span class="keyword">delete</span> <a class="code hl_variable" href="classcovarianceBase.html#a6cb3d0b4096fbb55b040f70cd5b6e32b">throwMatrix</a>;</div>
<div class="line"><span class="lineno"> 1038</span>  <a class="code hl_variable" href="classcovarianceBase.html#a6cb3d0b4096fbb55b040f70cd5b6e32b">throwMatrix</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 1039</span>  <span class="keyword">delete</span> <a class="code hl_variable" href="classcovarianceBase.html#ab95f5e066c2dfb1d20d120bc6c85dda2">throwMatrix_CholDecomp</a>;</div>
<div class="line"><span class="lineno"> 1040</span>  <a class="code hl_variable" href="classcovarianceBase.html#ab95f5e066c2dfb1d20d120bc6c85dda2">throwMatrix_CholDecomp</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 1041</span>  <a class="code hl_function" href="classcovarianceBase.html#af30ca7861452e1446e55700f4b49b608">setThrowMatrix</a>(cov);</div>
<div class="line"><span class="lineno"> 1042</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ae70f51df3976975b2dc78fd3bfc28b65" name="ae70f51df3976975b2dc78fd3bfc28b65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae70f51df3976975b2dc78fd3bfc28b65">&#9670;&#160;</a></span>_fCurrVal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; covarianceBase::_fCurrVal</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Current value of the parameter. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00461">461</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="a267523bb0f78c27208000b2856f741da" name="a267523bb0f78c27208000b2856f741da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a267523bb0f78c27208000b2856f741da">&#9670;&#160;</a></span>_fDetID</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;std::string&gt; &gt; covarianceBase::_fDetID</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Tells to which samples object param should be applied. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00477">477</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="a34f877fc160b4a93a3aab1b3a8977858" name="a34f877fc160b4a93a3aab1b3a8977858"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34f877fc160b4a93a3aab1b3a8977858">&#9670;&#160;</a></span>_fError</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; covarianceBase::_fError</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prior error on the parameter. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00467">467</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="a973671386a2f8ea924f25f8f5404654c" name="a973671386a2f8ea924f25f8f5404654c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a973671386a2f8ea924f25f8f5404654c">&#9670;&#160;</a></span>_fFancyNames</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; covarianceBase::_fFancyNames</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fancy name for example rather than xsec_0 it is MAQE, useful for human reading. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00453">453</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="ad9c47deb7009bff81210f666e80012eb" name="ad9c47deb7009bff81210f666e80012eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9c47deb7009bff81210f666e80012eb">&#9670;&#160;</a></span>_fFlatPrior</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;bool&gt; covarianceBase::_fFlatPrior</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether to apply flat prior or not. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00475">475</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="a9b753f52711600a9f8d648531d95b044" name="a9b753f52711600a9f8d648531d95b044"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b753f52711600a9f8d648531d95b044">&#9670;&#160;</a></span>_fGenerated</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; covarianceBase::_fGenerated</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generated value of the parameter. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00465">465</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="a0088413d6a15d12cd34ec06166302f5c" name="a0088413d6a15d12cd34ec06166302f5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0088413d6a15d12cd34ec06166302f5c">&#9670;&#160;</a></span>_fGlobalStepScale</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double covarianceBase::_fGlobalStepScale</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Global step scale applied to all params in this class. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00445">445</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="a3cda39026e336a49cef482efd4062561" name="a3cda39026e336a49cef482efd4062561"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cda39026e336a49cef482efd4062561">&#9670;&#160;</a></span>_fIndivStepScale</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; covarianceBase::_fIndivStepScale</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Individual step scale used by MCMC algorithm. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00473">473</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="a8f1d94838f188cc85c4f82557c0b0b66" name="a8f1d94838f188cc85c4f82557c0b0b66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f1d94838f188cc85c4f82557c0b0b66">&#9670;&#160;</a></span>_fLowBound</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; covarianceBase::_fLowBound</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Lowest physical bound, parameter will not be able to go beyond it. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00469">469</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="a3e502d80fd2c30a7da4fe75a3e05b0da" name="a3e502d80fd2c30a7da4fe75a3e05b0da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e502d80fd2c30a7da4fe75a3e05b0da">&#9670;&#160;</a></span>_fNames</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; covarianceBase::_fNames</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>ETA _fNames is set automatically in the covariance class to be something like xsec_i, this is currently to make things compatible with the Diagnostic tools. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00451">451</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="ac5d922f1a4163b38ebc7a3ef21eec376" name="ac5d922f1a4163b38ebc7a3ef21eec376"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5d922f1a4163b38ebc7a3ef21eec376">&#9670;&#160;</a></span>_fNumPar</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int covarianceBase::_fNumPar</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of systematic parameters. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00457">457</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="ac57285a48d41ef764b4c659959a36c2d" name="ac57285a48d41ef764b4c659959a36c2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac57285a48d41ef764b4c659959a36c2d">&#9670;&#160;</a></span>_fNumParPCA</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int covarianceBase::_fNumParPCA</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of parameters in PCA base. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00484">484</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="a7578a2cc2e8e9100fad88310a824cb1c" name="a7578a2cc2e8e9100fad88310a824cb1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7578a2cc2e8e9100fad88310a824cb1c">&#9670;&#160;</a></span>_fPreFitValue</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; covarianceBase::_fPreFitValue</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Parameter value dictated by the prior model. Based on it penalty term is calculated. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00459">459</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="a12f0eb31a5ef48b014baa11d4ab919e9" name="a12f0eb31a5ef48b014baa11d4ab919e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12f0eb31a5ef48b014baa11d4ab919e9">&#9670;&#160;</a></span>_fPropVal</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; covarianceBase::_fPropVal</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Proposed value of the parameter. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00463">463</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="a31e636cb6de871bd0c2c8e7e299df9e7" name="a31e636cb6de871bd0c2c8e7e299df9e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31e636cb6de871bd0c2c8e7e299df9e7">&#9670;&#160;</a></span>_fUpBound</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; covarianceBase::_fUpBound</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Upper physical bound, parameter will not be able to go beyond it. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00471">471</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="a933ff3dc0af99629ba3582a5d9d89d23" name="a933ff3dc0af99629ba3582a5d9d89d23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a933ff3dc0af99629ba3582a5d9d89d23">&#9670;&#160;</a></span>_fYAMLDoc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">YAML::Node covarianceBase::_fYAMLDoc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stores config describing systematics. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00455">455</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="ab3833dc51a81afc9dca7c3dcbb107af7" name="ab3833dc51a81afc9dca7c3dcbb107af7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3833dc51a81afc9dca7c3dcbb107af7">&#9670;&#160;</a></span>AdaptiveHandler</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classadaptive__mcmc_1_1AdaptiveMCMCHandler.html">adaptive_mcmc::AdaptiveMCMCHandler</a> covarianceBase::AdaptiveHandler</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Struct containing information about adaption. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00503">503</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="a7b70de3f098aae1d537d80bac5969d88" name="a7b70de3f098aae1d537d80bac5969d88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b70de3f098aae1d537d80bac5969d88">&#9670;&#160;</a></span>corr_throw</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double* covarianceBase::corr_throw</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Result of multiplication of Cholesky matrix and randParams. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00443">443</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="a6c3fe8db34c06299fd1633951ac00937" name="a6c3fe8db34c06299fd1633951ac00937"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c3fe8db34c06299fd1633951ac00937">&#9670;&#160;</a></span>covMatrix</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TMatrixDSym* covarianceBase::covMatrix</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The covariance matrix. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00431">431</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="add54ab1ba46b723fa23d7c95dfad671a" name="add54ab1ba46b723fa23d7c95dfad671a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add54ab1ba46b723fa23d7c95dfad671a">&#9670;&#160;</a></span>eigen_threshold</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double covarianceBase::eigen_threshold</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CW: Threshold based on which we remove parameters in eigen base. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00482">482</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="abba75182305d556818c76974a054a17d" name="abba75182305d556818c76974a054a17d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abba75182305d556818c76974a054a17d">&#9670;&#160;</a></span>FirstPCAdpar</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int covarianceBase::FirstPCAdpar</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Index of the first param that is being decomposed. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00486">486</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="a5451d4189a9fb7591c8ce728852ba82e" name="a5451d4189a9fb7591c8ce728852ba82e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5451d4189a9fb7591c8ce728852ba82e">&#9670;&#160;</a></span>inputFile</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string covarianceBase::inputFile</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The input root file we read in. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00426">426</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="a35c7dc7817eaf4058e9775b6bc792ebc" name="a35c7dc7817eaf4058e9775b6bc792ebc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35c7dc7817eaf4058e9775b6bc792ebc">&#9670;&#160;</a></span>invCovMatrix</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TMatrixDSym* covarianceBase::invCovMatrix</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The inverse covariance matrix. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00433">433</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="a5973f7f446d6058af9bcd006a6cf562d" name="a5973f7f446d6058af9bcd006a6cf562d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5973f7f446d6058af9bcd006a6cf562d">&#9670;&#160;</a></span>InvertCovMatrix</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;double&gt; &gt; covarianceBase::InvertCovMatrix</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: Same as above but much faster as TMatrixDSym cache miss. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00435">435</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="a5ebdc744b733656972a15f1657915a3f" name="a5ebdc744b733656972a15f1657915a3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ebdc744b733656972a15f1657915a3f">&#9670;&#160;</a></span>LastPCAdpar</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int covarianceBase::LastPCAdpar</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Index of the last param that is being decomposed. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00488">488</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="a26618d3f5633b33ce20e38ce8261b3ee" name="a26618d3f5633b33ce20e38ce8261b3ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26618d3f5633b33ce20e38ce8261b3ee">&#9670;&#160;</a></span>matrixName</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string covarianceBase::matrixName</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Name of cov matrix. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00429">429</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="ab4b7f96d3e977a0b3307ceecbd0baeb4" name="ab4b7f96d3e977a0b3307ceecbd0baeb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4b7f96d3e977a0b3307ceecbd0baeb4">&#9670;&#160;</a></span>pca</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool covarianceBase::pca</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>perform PCA or not </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00480">480</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="acb8262289fb5a37e849def35c04d6165" name="acb8262289fb5a37e849def35c04d6165"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb8262289fb5a37e849def35c04d6165">&#9670;&#160;</a></span>PCAObj</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classPCAHandler.html">PCAHandler</a>&gt; covarianceBase::PCAObj</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Struct containing information about PCA. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00501">501</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="a8d821ce805f2426fe95549170866821f" name="a8d821ce805f2426fe95549170866821f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d821ce805f2426fe95549170866821f">&#9670;&#160;</a></span>PrintLength</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int covarianceBase::PrintLength</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: This is used when printing parameters, sometimes we have super long parameters name, we want to flexibly adjust couts. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00448">448</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="a0704c430bdc8e87fd6f03f01b2ab00df" name="a0704c430bdc8e87fd6f03f01b2ab00df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0704c430bdc8e87fd6f03f01b2ab00df">&#9670;&#160;</a></span>random_number</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::unique_ptr&lt;TRandom3&gt; &gt; covarianceBase::random_number</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: Set Random numbers for each thread so each thread has different seed. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00438">438</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="a705e648220c06083cd1acc5fba4f2ef7" name="a705e648220c06083cd1acc5fba4f2ef7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a705e648220c06083cd1acc5fba4f2ef7">&#9670;&#160;</a></span>randParams</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double* covarianceBase::randParams</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Random number taken from gaussian around prior error used for corr_throw. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00441">441</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="a6cb3d0b4096fbb55b040f70cd5b6e32b" name="a6cb3d0b4096fbb55b040f70cd5b6e32b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cb3d0b4096fbb55b040f70cd5b6e32b">&#9670;&#160;</a></span>throwMatrix</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TMatrixDSym* covarianceBase::throwMatrix</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Matrix which we use for step proposal before Cholesky decomposition (not actually used for step proposal) </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00491">491</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="ab95f5e066c2dfb1d20d120bc6c85dda2" name="ab95f5e066c2dfb1d20d120bc6c85dda2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab95f5e066c2dfb1d20d120bc6c85dda2">&#9670;&#160;</a></span>throwMatrix_CholDecomp</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TMatrixD* covarianceBase::throwMatrix_CholDecomp</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Matrix which we use for step proposal after Cholesky decomposition. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00493">493</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="aca17e48a5fa8e353317d58c205fb89df" name="aca17e48a5fa8e353317d58c205fb89df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca17e48a5fa8e353317d58c205fb89df">&#9670;&#160;</a></span>throwMatrixCholDecomp</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double** covarianceBase::throwMatrixCholDecomp</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Throw matrix that is being used in the fit, much faster as TMatrixDSym cache miss. </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00495">495</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<a id="a838731abd6716940043b484b2b266f86" name="a838731abd6716940043b484b2b266f86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a838731abd6716940043b484b2b266f86">&#9670;&#160;</a></span>use_adaptive</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool covarianceBase::use_adaptive</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Are we using AMCMC? </p>

<p class="definition">Definition at line <a class="el" href="covarianceBase_8h_source.html#l00498">498</a> of file <a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>covariance/<a class="el" href="covarianceBase_8h_source.html">covarianceBase.h</a></li>
<li>covariance/<a class="el" href="covarianceBase_8cpp_source.html">covarianceBase.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
