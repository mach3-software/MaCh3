<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MaCh3: 04.-Making-a-samplePDF-experiment-class</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="MaCh3.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mach3logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MaCh3
   &#160;<span id="projectnumber">2.4.2</span>
   </div>
   <div id="projectbrief">Reference Guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">04.-Making-a-samplePDF-experiment-class </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The samplePDF classes contain information about a particular sample in your analysis. Practically this involves storing the number of events predicted in each analysis bin for each sample as well as modifying this for a given set of systematic and oscillation parameter values (i.e. "reweighting" the nominal Monte-Carlo prediction). Therefore, the samplePDF class also "talks" to a lot of other classes in MaCh3 especially the covariance and spline classes. In turn the <a class="el" href="classFitterBase.html" title="Base class for implementing fitting algorithms.">FitterBase</a> class then gets a poisson likelihood value from comparing the MC prediction and data in the samplePDF class.</p>
<p>Each experiment will need to create a samplePDF experiment class which inherits from a the samplePDFFDBase class in the core repository. This is intended as a guide to help you produce your own samplePDF class for your own experiment. This is intended to be as lightweight as possible and should mainly relate to the MC format that a particular experiment is using. You need to read this information into the data structures which the samplePDFFDBase class is expecting so that it can handle the "heavy lifting" such as the reweighting of the MC prediction.</p>
<p><b>N.B.</b> - Currently (April 2024), experiment samplePDF classes should inherit from the samplePDFFDBase class in core (where FD stands for Far Detector). There is a samplePDFND (Near Detector) base class but this has not been tested for multiple experiments yet. In future releases of the core code (v2) we plan to have a single samplePDF class for both ND and FD to simplify this inheritance structure.</p>
<h1><a class="anchor" id="autotoc_md69"></a>
Constructing a samplePDF experiment class</h1>
<p>Discussion of FD data structures; FDMC and ExpFDMC. The main purpose of any samplePDF class is to contain all the information you need to make MC predictions of your selections for some given set of systematic parameter values. To do this, the samplePDF object needs to read in information from different input files and keep track of them in some data structures. Most of your samplePDF class will be reading in this information and putting it in the correct place.</p>
<p>Below is a skeleton of what the constructor of your samplePDF class will look like. </p><div class="fragment"><div class="line">samplePDFSKBase::samplePDFSKBase(double pot, std::string samplecfgfile, covarianceXsec* xsec_cov)</div>
<div class="line">  : samplePDFFDBase(pot, mc_version, xsec_cov)</div>
<div class="line">{</div>
<div class="line">  manager* SampleManager = new manager(samplecfgfile);</div>
<div class="line"> </div>
<div class="line">  ////////////////</div>
<div class="line">  /// Read information about sample from sample.yaml config file</div>
<div class="line">  ////////////////</div>
<div class="line">  //Need to set this before call to SetXecCov as SampleDetID is used there</div>
<div class="line">  ReadInformationFromSampleCfg();</div>
<div class="line"> </div>
<div class="line">  //Read input MC and spline file names for each oscillation channel</div>
<div class="line">  //also need to store oscillation channel information i.e. numu-&gt;nue? or numu-&gt;numu etc. </div>
<div class="line">  ReadMCandSplineFiles(SampleManager);</div>
<div class="line"> </div>
<div class="line">  //Read any selection cuts</div>
<div class="line">  GetSelectionCuts(SampleManager);</div>
<div class="line"> </div>
<div class="line">  //Set the xsec covariance</div>
<div class="line">  SetXsecCov(xsec_cov);</div>
<div class="line"> </div>
<div class="line">  //Now create a spline object </div>
<div class="line">  splineFile = new splineExpBase(XsecCov);</div>
<div class="line">  </div>
<div class="line">  ////////////////</div>
<div class="line">  //Create some structs to store the information in both for the expimernt</div>
<div class="line">  //and the information for the core samplePDF FD class</div>
<div class="line">  //then fill these. There is one of these for each oscillaiton channel.</div>
<div class="line">  ////////////////</div>
<div class="line"> </div>
<div class="line">  for(unsigned iOscChannel=0 ; iOscChannel &lt; nOscChannels ; iOscChannel++){</div>
<div class="line">    //Fill from MC file</div>
<div class="line">    SetupExpMC(&amp;ExpStructs[iSample]);</div>
<div class="line"> </div>
<div class="line">        //Now fill the core bits in the samplePDFFDBase class</div>
<div class="line">        //This is often just pointing to information in the experiment class</div>
<div class="line">    SetupFDMC(&amp;BaseClassStructs[iSample]);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  //Setup the splines</div>
<div class="line">  SetupSplines();</div>
<div class="line"> </div>
<div class="line">  ////////////////////////////////////</div>
<div class="line">  // Setup your norm parameters as well here</div>
<div class="line">  ////////////////////////////////////</div>
<div class="line">  SetupNormParameters();</div>
<div class="line"> </div>
<div class="line">  //Also your func parameters if you&#39;re lucky</div>
<div class="line">  //enough to have them</div>
<div class="line">  SetupFuncParameters();</div>
<div class="line"> </div>
<div class="line">  //Setup pointers to all the weights you will apply</div>
<div class="line">  //e.g. from xsec systsematics, detector, pot weight etc.</div>
<div class="line">  SetupWeightPointers();</div>
<div class="line"> </div>
<div class="line">  //The binning here is arbitrary, now we get info from cfg so the</div>
<div class="line">  //set1DBinning and set2Dbinning calls below will make the binning</div>
<div class="line">  //to be what we actually want</div>
<div class="line">  _hPDF1D   = new TH1D(&quot;h&quot;+histname1D+samplename,histtitle1D, 1, 0, 1);</div>
<div class="line">  dathist   = new TH1D(&quot;d&quot;+histname1D+samplename,histtitle1D, 1, 0, 1);</div>
<div class="line">  _hPDF2D   = new TH2D(&quot;h&quot;+histname2D+samplename,histtitle2D, 1, 0, 1, 1, 0, 1);</div>
<div class="line">  dathist2d = new TH2D(&quot;d&quot;+histname2D+samplename,histtitle2D, 1, 0, 1, 1, 0, 1);</div>
<div class="line"> </div>
<div class="line">  //Make some arrays so we can initialise _hPDF1D and _hPDF2D with these</div>
<div class="line">  double XBinEdges[SampleXBins.size()];</div>
<div class="line">  double YBinEdges[SampleYBins.size()];</div>
<div class="line">  for(unsigned XBin_i = 0 ; XBin_i &lt; SampleXBins.size() ; XBin_i++){</div>
<div class="line">        XBinEdges[XBin_i] = SampleXBins[XBin_i];</div>
<div class="line">  }</div>
<div class="line">  //And now the YBin Edges</div>
<div class="line">  for(unsigned YBin_i = 0 ; YBin_i &lt; SampleYBins.size() ; YBin_i++){</div>
<div class="line">        YBinEdges[YBin_i] = SampleYBins[YBin_i];</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  //Calls to functions in the core code</div>
<div class="line">  set1DBinning(SampleXBins);</div>
<div class="line">  set2DBinning(SampleXBins, SampleYBins);</div>
<div class="line"> </div>
<div class="line">  //This then points each event to all the splines it is associated with</div>
<div class="line">  fillSplineBins();</div>
<div class="line">  splineFile-&gt;cleanUpMemory();</div>
<div class="line">}</div>
</div><!-- fragment --><p> The code above will not compile and is only illustrative only the main steps. As you can see the majority of the setup is above grabbing things from a <b>sample yaml file</b> and <b>passing information into an experiment struct and a core struct</b>. The discussion below is intended to expand on these. A discussion of the spline setup is given in another section.</p>
<h1><a class="anchor" id="autotoc_md70"></a>
Sample Config files</h1>
<p>As described above, a lot of information is specified in a "sample config". This is a yaml file which contains information about the MC events you would like to read in. Below is an example: </p><div class="fragment"><div class="line">SampleName: &quot;YourFavouriteSample&quot;</div>
<div class="line">Selection:</div>
<div class="line">  #See below for a discussion on this</div>
<div class="line">  SampleDetID: 8</div>
<div class="line">#Apply cuts on particular variables if you would like to</div>
<div class="line">#You will need to make sure this string maps to a variable</div>
<div class="line">SelectionCuts:</div>
<div class="line">  - KinematicStr: &quot;RecoNeutrinoEnergy&quot;</div>
<div class="line">    Bounds: [ 0., 30000. ]</div>
<div class="line">Binning:</div>
<div class="line">  #See below for a discussion on this</div>
<div class="line">  BinningOpt: 0</div>
<div class="line">  XVarBins: [0.0, 100.0, 200.0, 300.0, 450.0, 600.0, 750.0, 1000.0]</div>
<div class="line">  #If you want another axis as well specify this here</div>
<div class="line">  YVarBins: [0.0, 180.0]</div>
<div class="line">#Any bools you might want to keep track of</div>
<div class="line">SampleBools:</div>
<div class="line">  isrhc: no</div>
<div class="line">#Paths to the MC inputs and the spline files</div>
<div class="line">InputFiles:</div>
<div class="line">  mtupleprefix: &quot;inputs/PrefixFileName&quot;</div>
<div class="line">  mtuplesuffix: &quot;_blah.root&quot;</div>
<div class="line">  splineprefix: &quot;inputs/PrefixSplineFileName&quot;</div>
<div class="line">  splinesuffix: &quot;_blah.root&quot;</div>
<div class="line">#This corresponds to the number of oscillation channels present</div>
<div class="line">#you probably have 6 of these (if you don&#39;t have tau channels) otherwise you have the full 12</div>
<div class="line">NSubSamples: 1</div>
<div class="line">SubSamples:</div>
<div class="line">  - name: &quot;numu-x-numu&quot;</div>
<div class="line">    mtuplefile: &quot;numu_x_numu&quot;</div>
<div class="line">    splinefile: &quot;numu_x_numu&quot;</div>
<div class="line">    samplevecno: 0</div>
<div class="line">    #PDG pre oscillation</div>
<div class="line">    nutype: 14</div>
<div class="line">    #PDG post oscillation</div>
<div class="line">    oscnutype: 14</div>
<div class="line">    signal: false</div>
</div><!-- fragment --><p> This information simply needs to be grabbed from the yaml file and stored in your samplePDFExperiment base. <b>A note on SampleDetID</b>: SampleDetID is a little complicated. This needs to be a unique number that is a power of 2. This is used to check whether a systematic applies to a sample or not. It has to be a power of two as this is checked using bit-shifting. This will be replaced in the future. <b>A note on BinningOpt</b>: BinningOpt is currently used to describe the number of variables you want to bin in and what they are. This is quite hard-coded and will be replaced in the future to be flexible. <b>A note on KinematicStr</b>: we will discussion the Kinematic Variables later in the virtual functions. But you will need to supply a string which can be mapped back to get the value of a specific variable for an event so you can cut on it.</p>
<h1><a class="anchor" id="autotoc_md71"></a>
The Far Detector Struct</h1>
<p>One of the most important things is passing information from your MC file to the core code. All the information required for the core code to reweight MC.</p>
<p>The far detector struct can be seen <a href="https://github.com/mach3-software/MaCh3/blob/develop/samplePDF/FDMCStruct.h">here</a>. All of these variables must be filled from your MC. It is highly recommended that you also create a similar struct to hold the information of your experiment. A lot of the members of the Far Detector struct are arrays of pointers, this is so they can point to your experiment struct without storing lots of floats or double twice. Also this has the advantage that if you update a value in your samplePDFExperiment class then the far detector struct does not need updating as your are just pointing to the same part of memory. This structure means that your SetupExpMC and SetupFDMC() functions would look something like this:</p>
<div class="fragment"><div class="line">void SetupExpMC(){</div>
<div class="line">  //Grab variables from your MC file (let&#39;s say it&#39;s a ROOT TTree)</div>
<div class="line">  TTree *MCTree = InputFile-&gt;Get(&quot;MyExperimentsMC&quot;);</div>
<div class="line"> </div>
<div class="line">  double TrueNeutrinoEnergy;</div>
<div class="line">  double RecoNeutrinoEnergy;</div>
<div class="line"> </div>
<div class="line">  MCTree-&gt;SetBranchAddress(&quot;TrueNeutrinoEnergy&quot;, &amp;TrueNeutrinoEnergy);</div>
<div class="line">  MCTree-&gt;SetBranchAddress(&quot;RecoNeutrinoEnergy&quot;, &amp;RecoNeutrinoEnergy);</div>
<div class="line"> </div>
<div class="line">  //Now create the &quot;space&quot; to store these variables in your experiment struct (ExpMC)</div>
<div class="line">  struct ExpMC ExpObj = ExpMC();</div>
<div class="line">  ExpObj-&gt;TrueEnu = new double[MCTree-&gt;GetEntries()];</div>
<div class="line">  ExpObj-&gt;RecoEnu = new double[MCTree-&gt;GetEntries()];</div>
<div class="line"> </div>
<div class="line">  //Loop over all your MC events and fill your Exp MC struct with the info you need</div>
<div class="line">  for(unsigned int iEntry = 0 ; iEntry &lt; MCTree-&gt;GetEntries() ; ++iEntry){</div>
<div class="line">    ExpObj-&gt;TrueEnu[iEntry] = TrueNeutrinoEnergy;</div>
<div class="line">    ExpObj-&gt;RecoEnu[iEntry] = RecoNeutrinoEnergy;</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">void SetupFDMC(){</div>
<div class="line">  </div>
<div class="line">  struct fdmc_base FDObj = fdmc_base();</div>
<div class="line">  FDObj-&gt;x_var = new double*[nEvents];</div>
<div class="line">  FDObj-&gt;rw_etrue = new double*[nEvents];</div>
<div class="line"> </div>
<div class="line">  //Loop over and setup your fdmc_base struct to point to or to copy values from you experiment struct</div>
<div class="line">  for(unsigned int iEvent = 0 ; iEvent &lt; nEvents ; ++iEvent){</div>
<div class="line">    //Let&#39;s say you want your sample to be binned in reconstructed neutrino energy</div>
<div class="line">    //To do this we set the x_var to point to the Reconstructed neutrino energy value in the experiment struct</div>
<div class="line">    FDObj-&gt;x_var[iEvent] = &amp;(ExpObj-&gt;RecoEnu[iEvent]);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p> Some of the variables are setup automatically for you by the core code. For example NomXBin, NomYBin, XBin, YBin, rw_lower_xbinedge, rw_upper_xbinedge, rw_lower_lower_xbinedge and rw_upper_upper_xbinedge are set in the <a href="https://github.com/mach3-software/MaCh3/blob/develop/samplePDF/samplePDFFDBase.cpp#L1036C23-L1036C47">FindNominalBinAndEdges1D</a> function (or it's 2D counterpart). So in SetupFDMC you just need to create the array and set it to some dummy value to begin with.</p>
<h1><a class="anchor" id="autotoc_md72"></a>
Setting Up Systematics</h1>
<p>Thankfully, a lot of this is now handled in the core code and if you have passed all the information to the fdmc_base struct you should not have to worry too much about this. The information for systematics is stored in your covarianceXsec class which parses information from a YAML file. <a href="https://github.com/mach3-software/MaCh3/blob/develop/samplePDF/samplePDFFDBase.cpp#L684"><b>SetupNormParameters()</b></a> will check whether normalisation parameters apply to events and automatically set this up for you. <b>SetupSplines()</b> is discussed in the spline page of the wiki <a href="https://github.com/mach3-software/MaCh3/wiki/5.-Splines">here</a>. <b>SetupFuncParameters()</b> setups up functional parameters. These will be experiment specific systematics and you will need to define this function. What you really need to do for these is keep track of the parameter value which then gets passed to a custom function to apply your systematic (this could be changing a kinematic variable, it could be scaling something etc.). A basic template is below: </p><div class="fragment"><div class="line">void SetupFuncParameters(){</div>
<div class="line">  funcParsIndex = XsecCov-&gt;GetFuncParsIndexFromDetID(SampleDetID);</div>
<div class="line">  funcParsNames = XsecCov-&gt;GetFuncParsNamesFromDetID(SampleDetID);</div>
<div class="line"> </div>
<div class="line">  // The value of the functional parameter. Initialised to -999</div>
<div class="line">  func_par_pos = -999;</div>
<div class="line"> </div>
<div class="line">  int func_it = 0;</div>
<div class="line">  //Now find the correct index of xsec parameters to point to</div>
<div class="line">  for (std::vector&lt;int&gt;::iterator it = funcParsIndex.begin(); it != funcParsIndex.end(); ++it, ++func_it) {</div>
<div class="line">    std::string name = funcParsNames.at(func_it);</div>
<div class="line">    if (name == &quot;FuncParNameInYaml&quot;) {</div>
<div class="line">      func_par_pos = *it;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p> The other simple Setup function is <b>SetupWeightPointers()</b> this is meant to fill the <a href="https://github.com/mach3-software/MaCh3/blob/develop/samplePDF/FDMCStruct.h#L39">total_weights_pointer</a> of the fdmc_base struct. This is a convenient way to loop over all of the weights which you might want to apply to your events from different sources (xsec, detector, oscillation). See below for a dummy example: </p><div class="fragment"><div class="line">void samplePDFSKBase::SetupWeightPointers() {</div>
<div class="line">for (int i = 0; i &lt; nOscillationChannels; ++i) {</div>
<div class="line">  for (int j = 0; j &lt; MCSamples[i].nEvents; ++j) {</div>
<div class="line">    MCSamples[i].ntotal_weight_pointers[j] = 7;</div>
<div class="line">    MCSamples[i].total_weight_pointers[j] = new double*[MCSamples[i].ntotal_weight_pointers[j]];</div>
<div class="line">    MCSamples[i].total_weight_pointers[j][2] = &amp;(MCSamples[i].osc_w[j]);</div>
<div class="line">    MCSamples[i].total_weight_pointers[j][5] = &amp;(MCSamples[i].xsec_w[j]);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md73"></a>
Pure Virtual Functions</h1>
<p>The samplePDFFDBase class is a virtual object and cannot be initialised on its own due to it having several pure virtual functions. It is these virtual functions which must be implemented in the experiment samplePDFFDBase class. Below is a list of the pure virtual functions that exist in the <a href="https://github.com/mach3-software/MaCh3/blob/develop/samplePDF/samplePDFFDBase.h">samplePDFFDBase.h</a> file. These are functions which are likely to be very experiment specific and so you need to help the core code to grab key bits of information. Some of these we have already encountered. </p><div class="fragment"><div class="line">virtual void SetupWeightPointers() = 0;</div>
<div class="line">// Calculate the norm weight for a given event</div>
<div class="line">virtual double ReturnKinematicParameter(std::string KinematicParameter, int iSample, int iEvent) = 0;</div>
<div class="line">virtual double ReturnKinematicParameter(double KinematicVariable, int iSample, int iEvent) = 0;</div>
<div class="line">virtual std::vector&lt;double&gt; ReturnKinematicParameterBinning(std::string KinematicParameter) = 0;</div>
</div><!-- fragment --><p> SetupWeightPointers has already been described above. ReturnKinematicParameter and ReturnKinematicParameterBinning are all functions related to getting specific variables from your experiment specific samplePDF and passing it to core. It is recommended that this is done through a set of enums and strings which match these. For example: </p><div class="fragment"><div class="line">enum KinematicVariables{</div>
<div class="line">  kTrueNeutrinoEnergy = 0,</div>
<div class="line">  kRecoNeutrinoEnergy = 1,</div>
<div class="line">  kNKinematicParameters</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">inline int ReturnKinematicParameterFromString(std::string KinematicParameterStr){</div>
<div class="line">  if(KinematicParameterStr.find(&quot;TrueNeutrinoEnergy&quot;) != std::npos){return kTrueNeutrinoEnergy;}</div>
<div class="line">  else if(KinematicParameterStr.find(&quot;RecoNeutrinoEnergy&quot;) != std::npos){return kRecoNeutrinoEnergy;}</div>
<div class="line">  </div>
<div class="line">  return kNKinematicParameters;</div>
<div class="line">}</div>
</div><!-- fragment --><p> This will then make the ReturnKinematicParaeter and ReturnKinematicParameterBinning functions simpler. </p><div class="fragment"><div class="line">double ReturnKinematicParameter(double KinematicVariable, int iEvent, int iOscChannel){</div>
<div class="line">  //Convert double into an enum</div>
<div class="line">  KinematicVariables Var = static_cast&lt;KinematicVariables&gt;(KinematicVariable);</div>
<div class="line">  double Val;</div>
<div class="line">  switch(Var){</div>
<div class="line">    case(kTrueNeutrinoEnergy):</div>
<div class="line">      Val = ExpObj-&gt;TrueEnu[i];</div>
<div class="line">      break;</div>
<div class="line">    case(kRecoNeutrinoEnergy):</div>
<div class="line">      Val = ExpObj-&gt;RecoEnu[i];</div>
<div class="line">      break;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  return Val;</div>
<div class="line">}</div>
</div><!-- fragment --><p> similarly then the ReturnKinematicParameter function can be passed a string </p><div class="fragment"><div class="line">double ReturnKinematicParameter(std::string KinematicString, int iEvent, int iOscChannel){</div>
<div class="line">  KinematicVariables Var = static_cast&lt;KinematicVariables&gt;(ReturnKinematicParameterFromString(KinematicParameterStr));</div>
<div class="line">  return ReturnKinematicParameter(Var, iEvent, iOscChannel);</div>
<div class="line">}</div>
</div><!-- fragment --><p> It is this second function which allows you to go from a string in your sample or xsec config to an actual value to cut on. This way the core code can "know" which variable to get by reading in from a config file. This is aimed at making the code as flexible across different experiments as possible. The core code only needs to be told how to associate a string with an actual value.</p>
<p>Finally the ReturnKinematicBinning function can be handy if you want to create a histogram in different variables. You can do this by defining a binning to associate with a variable. </p><div class="fragment"><div class="line">std::vector&lt;double&gt; ReturnKinematicParameter(double KinematicVariable){</div>
<div class="line">  //Convert double into an enum</div>
<div class="line">  KinematicVariables Var = static_cast&lt;KinematicVariables&gt;(KinematicVariable);</div>
<div class="line">  std::vector&lt;double&gt; Binning;</div>
<div class="line">  switch(Var){</div>
<div class="line">    case(kTrueNeutrinoEnergy):</div>
<div class="line">      double BinWidth = 50;//50MeV bin widths</div>
<div class="line">      for(int ibin = 0 ; ibin &lt; 10 ; ++ibin){</div>
<div class="line">        Binning.push_back(BinWidth*ibin);</div>
<div class="line">      }</div>
<div class="line">      break;</div>
<div class="line">    case(kRecoNeutrinoEnergy):</div>
<div class="line">      double BinWidth = 40;//40MeV bin widths</div>
<div class="line">      for(int ibin = 0 ; ibin &lt; 10 ; ++ibin){</div>
<div class="line">        Binning.push_back(BinWidth*ibin);</div>
<div class="line">      }</div>
<div class="line">      break;</div>
<div class="line">  }</div>
<div class="line">  return Binning;</div>
<div class="line">}  </div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- Footer for MaCh3 Doxygen documentation -->
<footer class="mach3-footer" style="text-align: center;">
    <div style="margin-bottom: 15px;">
        <span style="font-weight: bold;">The MaCh3 Collaboration</span>
    </div>
    <!-- Dropdown to jump between doc versions -->
    <div style="margin-bottom: 10px;">
        <span>Select Software Version: </span>
        <select id="versionSelector" onchange="window.location.href=this.value" style="padding: 5px; border-radius: 4px; border: 1px solid #ccc;">
            <option value="">-- Select --</option>
            <option value="https://mach3-software.github.io/MaCh3/">develop</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.4.0/index.html">v2.4.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.3.0/index.html">v2.3.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.2.0/index.html">v2.2.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.1.0/index.html">v2.1.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.0.0/index.html">v2.0.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.5.0/index.html">v1.5.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.4.0/index.html">v1.4.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.3.0/index.html">v1.3.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.2.0/index.html">v1.2.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.1.0/index.html">v1.1.0</option>
        </select>
    </div>
    <!-- Footer info about doxygen -->
    <div style="font-size: 0.9em; color: #666; margin-top: 10px;">
        Documentation generated with
        <a href="https://www.doxygen.nl/" target="_blank" style="color: #666;">Doxygen</a>
        <span id="doxygenVersion"></span>
    </div>
    <!-- Now grab doxygen version from metadata -->
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        const meta = document.querySelector('meta[name="generator"]');
        if (meta) {
            const version = meta.getAttribute("content").replace("Doxygen ", "");
            document.getElementById("doxygenVersion").textContent = " " + version;
        }
    });
    </script>
</footer>
