<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MaCh3: Sample Handler Getters</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="MaCh3.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mach3logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MaCh3
   &#160;<span id="projectnumber">2.2.3</span>
   </div>
   <div id="projectbrief">Reference Guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Sample Handler Getters</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gac4b73a8841ff9bab2fb08b578ad4137f"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gac4b73a8841ff9bab2fb08b578ad4137f">SampleHandlerBase::GetNsamples</a> ()</td></tr>
<tr class="separator:gac4b73a8841ff9bab2fb08b578ad4137f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga97d4dfa8ea998240fab6c09786c5b7c1"><td class="memItemLeft" align="right" valign="top">virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga97d4dfa8ea998240fab6c09786c5b7c1">SampleHandlerBase::GetTitle</a> () const</td></tr>
<tr class="separator:ga97d4dfa8ea998240fab6c09786c5b7c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0ed9dd339235b3bdea2680078ab129ab"><td class="memItemLeft" align="right" valign="top">virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga0ed9dd339235b3bdea2680078ab129ab">SampleHandlerBase::GetSampleName</a> (int Sample) const =0</td></tr>
<tr class="separator:ga0ed9dd339235b3bdea2680078ab129ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3f4388fbe27168c5dae8fa722a7c1299"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga3f4388fbe27168c5dae8fa722a7c1299">SampleHandlerBase::GetSampleLikelihood</a> (const int isample)</td></tr>
<tr class="separator:ga3f4388fbe27168c5dae8fa722a7c1299"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4e232eb59bc09c3f8ff4cbed69fcd688"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMaCh3Modes.html">MaCh3Modes</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga4e232eb59bc09c3f8ff4cbed69fcd688">SampleHandlerBase::GetMaCh3Modes</a> () const</td></tr>
<tr class="memdesc:ga4e232eb59bc09c3f8ff4cbed69fcd688"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to MaCh3 modes.  <a href="group__SampleHandlerGetters.html#ga4e232eb59bc09c3f8ff4cbed69fcd688">More...</a><br /></td></tr>
<tr class="separator:ga4e232eb59bc09c3f8ff4cbed69fcd688"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga65bbd8a3084731b4bdb0c4d3fcaf641e"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga65bbd8a3084731b4bdb0c4d3fcaf641e">SampleHandlerBase::GetLikelihood</a> ()=0</td></tr>
<tr class="separator:ga65bbd8a3084731b4bdb0c4d3fcaf641e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6ceca02f83e878ef1aec6e54e7b2f331"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga6ceca02f83e878ef1aec6e54e7b2f331">SampleHandlerBase::GetNEvents</a> () const</td></tr>
<tr class="separator:ga6ceca02f83e878ef1aec6e54e7b2f331"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaeb7b2ceb1ff0720b5f4976035d5900c7"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gaeb7b2ceb1ff0720b5f4976035d5900c7">SampleHandlerBase::GetNOscChannels</a> ()</td></tr>
<tr class="separator:gaeb7b2ceb1ff0720b5f4976035d5900c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae5849766fbbc7aa71672da8b0f189fe5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gae5849766fbbc7aa71672da8b0f189fe5">SampleHandlerBase::GetPoissonLLH</a> (const double data, const double mc) const</td></tr>
<tr class="memdesc:gae5849766fbbc7aa71672da8b0f189fe5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate test statistic for a single bin using Poisson.  <a href="group__SampleHandlerGetters.html#gae5849766fbbc7aa71672da8b0f189fe5">More...</a><br /></td></tr>
<tr class="separator:gae5849766fbbc7aa71672da8b0f189fe5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga527307a4186e2eb61475ea975108aa65"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga527307a4186e2eb61475ea975108aa65">SampleHandlerBase::GetTestStatLLH</a> (const double data, const double mc, const double w2) const</td></tr>
<tr class="memdesc:ga527307a4186e2eb61475ea975108aa65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate test statistic for a single bin. Calculation depends on setting of <code>fTestStatistic</code>. Data and mc -&gt; 0 cut-offs are defined in <a class="el" href="namespaceM3.html">M3</a>::<em>LOW_MC_BOUND</em>.  <a href="group__SampleHandlerGetters.html#ga527307a4186e2eb61475ea975108aa65">More...</a><br /></td></tr>
<tr class="separator:ga527307a4186e2eb61475ea975108aa65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1c81b6b7a7e70b04c6c6ca1c81c70fc5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga1c81b6b7a7e70b04c6c6ca1c81c70fc5">SampleHandlerBase::SetTestStatistic</a> (<a class="el" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67">TestStatistic</a> testStat)</td></tr>
<tr class="memdesc:ga1c81b6b7a7e70b04c6c6ca1c81c70fc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the test statistic to be used when calculating the binned likelihoods.  <a href="group__SampleHandlerGetters.html#ga1c81b6b7a7e70b04c6c6ca1c81c70fc5">More...</a><br /></td></tr>
<tr class="separator:ga1c81b6b7a7e70b04c6c6ca1c81c70fc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6cab155b5644a3ad263ea1a35facd8b9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga6cab155b5644a3ad263ea1a35facd8b9">SampleHandlerFD::GetNDim</a> () const</td></tr>
<tr class="memdesc:ga6cab155b5644a3ad263ea1a35facd8b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">DB Function to differentiate 1D or 2D binning.  <a href="group__SampleHandlerGetters.html#ga6cab155b5644a3ad263ea1a35facd8b9">More...</a><br /></td></tr>
<tr class="separator:ga6cab155b5644a3ad263ea1a35facd8b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga46ca9963ed2f9b9b337db72bf52d99e6"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga46ca9963ed2f9b9b337db72bf52d99e6">SampleHandlerFD::GetSampleName</a> (int iSample=0) const override</td></tr>
<tr class="separator:ga46ca9963ed2f9b9b337db72bf52d99e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga80a62c0759d4df18e8d641a3cbceea46"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga80a62c0759d4df18e8d641a3cbceea46">SampleHandlerFD::GetTitle</a> () const override</td></tr>
<tr class="separator:ga80a62c0759d4df18e8d641a3cbceea46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1e1ef726c2c67cc3f8bb93b0ef9989fa"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga1e1ef726c2c67cc3f8bb93b0ef9989fa">SampleHandlerFD::GetXBinVarName</a> () const</td></tr>
<tr class="separator:ga1e1ef726c2c67cc3f8bb93b0ef9989fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga20478b6d0ab397e3d1b87ef466a81e13"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga20478b6d0ab397e3d1b87ef466a81e13">SampleHandlerFD::GetYBinVarName</a> () const</td></tr>
<tr class="separator:ga20478b6d0ab397e3d1b87ef466a81e13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabf1cb9517984e9c1f1094f8f936a5df9"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gabf1cb9517984e9c1f1094f8f936a5df9">SampleHandlerFD::GetMCHist</a> (const int Dimension)</td></tr>
<tr class="memdesc:gabf1cb9517984e9c1f1094f8f936a5df9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get MC histogram.  <a href="group__SampleHandlerGetters.html#gabf1cb9517984e9c1f1094f8f936a5df9">More...</a><br /></td></tr>
<tr class="separator:gabf1cb9517984e9c1f1094f8f936a5df9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa9c7e72a888eb224f9d045f718944243"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gaa9c7e72a888eb224f9d045f718944243">SampleHandlerFD::GetW2Hist</a> (const int Dimension)</td></tr>
<tr class="memdesc:gaa9c7e72a888eb224f9d045f718944243"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get W2 histogram.  <a href="group__SampleHandlerGetters.html#gaa9c7e72a888eb224f9d045f718944243">More...</a><br /></td></tr>
<tr class="separator:gaa9c7e72a888eb224f9d045f718944243"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae92915fce9d4b308aea94e6934bd0e75"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gae92915fce9d4b308aea94e6934bd0e75">SampleHandlerFD::GetDataHist</a> (const int Dimension)</td></tr>
<tr class="memdesc:gae92915fce9d4b308aea94e6934bd0e75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get Data histogram.  <a href="group__SampleHandlerGetters.html#gae92915fce9d4b308aea94e6934bd0e75">More...</a><br /></td></tr>
<tr class="separator:gae92915fce9d4b308aea94e6934bd0e75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa619e7779b3faa873dc418da07112a12"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gaa619e7779b3faa873dc418da07112a12">SampleHandlerFD::GetNOscChannels</a> () override</td></tr>
<tr class="separator:gaa619e7779b3faa873dc418da07112a12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9eb3d4a487ed877beb252738b9de9443"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga9eb3d4a487ed877beb252738b9de9443">SampleHandlerFD::GetFlavourName</a> (const int iChannel)</td></tr>
<tr class="separator:ga9eb3d4a487ed877beb252738b9de9443"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga39870e48ee550ce8902ccd62b2311a57"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga39870e48ee550ce8902ccd62b2311a57">SampleHandlerFD::Get1DVarHist</a> (const std::string &amp;ProjectionVar, const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;EventSelectionVec=std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt;(), int WeightStyle=0, TAxis *Axis=nullptr, const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;SubEventSelectionVec=std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt;())</td></tr>
<tr class="separator:ga39870e48ee550ce8902ccd62b2311a57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6adbe3dd0c7809ecd9e83f0ee5399f8e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga6adbe3dd0c7809ecd9e83f0ee5399f8e">SampleHandlerFD::Fill1DSubEventHist</a> (TH1D *_h1DVar, const std::string &amp;ProjectionVar, const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;SubEventSelectionVec=std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt;(), int WeightStyle=0)</td></tr>
<tr class="separator:ga6adbe3dd0c7809ecd9e83f0ee5399f8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaac0dad7d2090250cf8094eb8ceaab932"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gaac0dad7d2090250cf8094eb8ceaab932">SampleHandlerFD::Get1DVarHistByModeAndChannel</a> (const std::string &amp;ProjectionVar_Str, int kModeToFill=-1, int kChannelToFill=-1, int WeightStyle=0, TAxis *Axis=nullptr)</td></tr>
<tr class="separator:gaac0dad7d2090250cf8094eb8ceaab932"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa78d7bcfe9377cb7d47d596b39eda84c"><td class="memItemLeft" align="right" valign="top">TH2 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gaa78d7bcfe9377cb7d47d596b39eda84c">SampleHandlerFD::Get2DVarHistByModeAndChannel</a> (const std::string &amp;ProjectionVar_StrX, const std::string &amp;ProjectionVar_StrY, int kModeToFill=-1, int kChannelToFill=-1, int WeightStyle=0, TAxis *AxisX=nullptr, TAxis *AxisY=nullptr)</td></tr>
<tr class="separator:gaa78d7bcfe9377cb7d47d596b39eda84c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabb8ac1e8e55d6ea2097380e5078a0198"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gabb8ac1e8e55d6ea2097380e5078a0198">SampleHandlerFD::GetModeHist1D</a> (int s, int m, int style=0)</td></tr>
<tr class="separator:gabb8ac1e8e55d6ea2097380e5078a0198"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3100796be3a94b715355d045a530ba43"><td class="memItemLeft" align="right" valign="top">TH2 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga3100796be3a94b715355d045a530ba43">SampleHandlerFD::GetModeHist2D</a> (int s, int m, int style=0)</td></tr>
<tr class="separator:ga3100796be3a94b715355d045a530ba43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac7f3dd7b022e7c0714ab12db1184eb47"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH1 * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gac7f3dd7b022e7c0714ab12db1184eb47">SampleHandlerFD::ReturnHistsBySelection1D</a> (std::string KinematicProjection, int Selection1, int Selection2=-1, int WeightStyle=0, TAxis *Axis=0)</td></tr>
<tr class="separator:gac7f3dd7b022e7c0714ab12db1184eb47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7aa8723e32e056e1247341d41378ab60"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH2 * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga7aa8723e32e056e1247341d41378ab60">SampleHandlerFD::ReturnHistsBySelection2D</a> (std::string KinematicProjectionX, std::string KinematicProjectionY, int Selection1, int Selection2=-1, int WeightStyle=0, TAxis *XAxis=0, TAxis *YAxis=0)</td></tr>
<tr class="separator:ga7aa8723e32e056e1247341d41378ab60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafab4fb4f384c540493af65a3efa55287"><td class="memItemLeft" align="right" valign="top">THStack *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gafab4fb4f384c540493af65a3efa55287">SampleHandlerFD::ReturnStackedHistBySelection1D</a> (std::string KinematicProjection, int Selection1, int Selection2=-1, int WeightStyle=0, TAxis *Axis=0)</td></tr>
<tr class="separator:gafab4fb4f384c540493af65a3efa55287"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8be73835c2d9f0e50d738c4f204a0286"><td class="memItemLeft" align="right" valign="top">TLegend *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga8be73835c2d9f0e50d738c4f204a0286">SampleHandlerFD::ReturnStackHistLegend</a> ()</td></tr>
<tr class="separator:ga8be73835c2d9f0e50d738c4f204a0286"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae2769d593f34e8356b545af076818f89"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#gae2769d593f34e8356b545af076818f89">SampleHandlerFD::ReturnKinematicParameterFromString</a> (const std::string &amp;KinematicStr) const</td></tr>
<tr class="memdesc:gae2769d593f34e8356b545af076818f89"><td class="mdescLeft">&#160;</td><td class="mdescRight">ETA function to generically convert a string from xsec cov to a kinematic type.  <a href="group__SampleHandlerGetters.html#gae2769d593f34e8356b545af076818f89">More...</a><br /></td></tr>
<tr class="separator:gae2769d593f34e8356b545af076818f89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3e88e3720a6a8d3384a6b8d317795c74"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SampleHandlerGetters.html#ga3e88e3720a6a8d3384a6b8d317795c74">SampleHandlerFD::ReturnStringFromKinematicParameter</a> (const int KinematicVariable) const</td></tr>
<tr class="memdesc:ga3e88e3720a6a8d3384a6b8d317795c74"><td class="mdescLeft">&#160;</td><td class="mdescRight">ETA function to generically convert a kinematic type from xsec cov to a string.  <a href="group__SampleHandlerGetters.html#ga3e88e3720a6a8d3384a6b8d317795c74">More...</a><br /></td></tr>
<tr class="separator:ga3e88e3720a6a8d3384a6b8d317795c74"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Group of functions to get various parameters, names, and values. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga6adbe3dd0c7809ecd9e83f0ee5399f8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6adbe3dd0c7809ecd9e83f0ee5399f8e">&#9670;&nbsp;</a></span>Fill1DSubEventHist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerFD::Fill1DSubEventHist </td>
          <td>(</td>
          <td class="paramtype">TH1D *&#160;</td>
          <td class="paramname"><em>_h1DVar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>SubEventSelectionVec</em> = <code>std::vector&lt;&#160;<a class="el" href="structKinematicCut.html">KinematicCut</a>&#160;&gt;()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01491">1491</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                                                                                                                                                                  {</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;  <span class="keywordtype">int</span> ProjectionVar_Int = <a class="code" href="classSampleHandlerFD.html#ad81e082a5a4c86e51fc748bffd1dfa9e">ReturnKinematicVectorFromString</a>(ProjectionVar_Str);</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160; </div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  <span class="comment">//JM Loop over all events</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iEvent = 0; iEvent &lt; <a class="code" href="group__SampleHandlerGetters.html#ga6ceca02f83e878ef1aec6e54e7b2f331">GetNEvents</a>(); iEvent++) {</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#a1ce3d6b9d9f6cce379fe1e8dd404369a">IsEventSelected</a>(iEvent)) {</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;      <span class="keywordtype">double</span> Weight = <a class="code" href="classSampleHandlerFD.html#a9e735d294d926fef87a6fc4c0ec54dca">GetEventWeight</a>(iEvent);</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;      <span class="keywordflow">if</span> (WeightStyle == 1) {</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;        Weight = 1.;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;      }</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;      std::vector&lt;double&gt; Vec = <a class="code" href="classSampleHandlerFD.html#ae98d72c6c30697e32fcb464923456fc0">ReturnKinematicVector</a>(ProjectionVar_Int,iEvent);</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;      <span class="keywordtype">size_t</span> nsubevents = Vec.size();</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;      <span class="comment">//JM Loop over all subevents in event</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iSubEvent = 0; iSubEvent &lt; nsubevents; iSubEvent++) {</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#aacc4d573b8e4569269b51ac325bc0092">IsSubEventSelected</a>(SubEventSelectionVec, iEvent, iSubEvent, nsubevents)) {</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;          <span class="keywordtype">double</span> Var = Vec[iSubEvent];</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;          _h1DVar-&gt;Fill(Var,Weight);</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;        }</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;      }</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    }</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  }</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a1ce3d6b9d9f6cce379fe1e8dd404369a"><div class="ttname"><a href="classSampleHandlerFD.html#a1ce3d6b9d9f6cce379fe1e8dd404369a">SampleHandlerFD::IsEventSelected</a></div><div class="ttdeci">bool IsEventSelected(const int iEvent)</div><div class="ttdoc">DB Function which determines if an event is selected, where Selection double looks like {{ND280Kinema...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00334">SampleHandlerFD.cpp:334</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a9e735d294d926fef87a6fc4c0ec54dca"><div class="ttname"><a href="classSampleHandlerFD.html#a9e735d294d926fef87a6fc4c0ec54dca">SampleHandlerFD::GetEventWeight</a></div><div class="ttdeci">M3::float_t GetEventWeight(const int iEntry) const</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01287">SampleHandlerFD.cpp:1287</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_aacc4d573b8e4569269b51ac325bc0092"><div class="ttname"><a href="classSampleHandlerFD.html#aacc4d573b8e4569269b51ac325bc0092">SampleHandlerFD::IsSubEventSelected</a></div><div class="ttdeci">bool IsSubEventSelected(const std::vector&lt; KinematicCut &gt; &amp;SubEventCuts, const int iEvent, unsigned const int iSubEvent, size_t nsubevents)</div><div class="ttdoc">JM Function which determines if a subevent is selected.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00349">SampleHandlerFD.cpp:349</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ad81e082a5a4c86e51fc748bffd1dfa9e"><div class="ttname"><a href="classSampleHandlerFD.html#ad81e082a5a4c86e51fc748bffd1dfa9e">SampleHandlerFD::ReturnKinematicVectorFromString</a></div><div class="ttdeci">int ReturnKinematicVectorFromString(const std::string &amp;KinematicStr) const</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01654">SampleHandlerFD.cpp:1654</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ae98d72c6c30697e32fcb464923456fc0"><div class="ttname"><a href="classSampleHandlerFD.html#ae98d72c6c30697e32fcb464923456fc0">SampleHandlerFD::ReturnKinematicVector</a></div><div class="ttdeci">virtual std::vector&lt; double &gt; ReturnKinematicVector(std::string KinematicParameter, int iEvent)</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00266">SampleHandlerFD.h:266</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_ga6ceca02f83e878ef1aec6e54e7b2f331"><div class="ttname"><a href="group__SampleHandlerGetters.html#ga6ceca02f83e878ef1aec6e54e7b2f331">SampleHandlerBase::GetNEvents</a></div><div class="ttdeci">unsigned int GetNEvents() const</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00060">SampleHandlerBase.h:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga39870e48ee550ce8902ccd62b2311a57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga39870e48ee550ce8902ccd62b2311a57">&#9670;&nbsp;</a></span>Get1DVarHist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TH1 * SampleHandlerFD::Get1DVarHist </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>EventSelectionVec</em> = <code>std::vector&lt;&#160;<a class="el" href="structKinematicCut.html">KinematicCut</a>&#160;&gt;()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>Axis</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>SubEventSelectionVec</em> = <code>std::vector&lt;&#160;<a class="el" href="structKinematicCut.html">KinematicCut</a>&#160;&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01437">1437</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                                                                                         {</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;  <span class="comment">//DB Need to overwrite the Selection member variable so that IsEventSelected function operates correctly.</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  <span class="comment">//   Consequently, store the selection cuts already saved in the sample, overwrite the Selection variable, then reset</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  std::vector&lt; KinematicCut &gt; tmp_Selection = <a class="code" href="classSampleHandlerFD.html#a2b0a7ada3c931e66211eebd91de0c0d0">Selection</a>;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  std::vector&lt; KinematicCut &gt; SelectionVecToApply;</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160; </div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;  <span class="comment">//DB Add all the predefined selections to the selection vector which will be applied</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iSelec=0;iSelec&lt;<a class="code" href="classSampleHandlerFD.html#a2b0a7ada3c931e66211eebd91de0c0d0">Selection</a>.size();iSelec++) {</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    SelectionVecToApply.emplace_back(<a class="code" href="classSampleHandlerFD.html#a2b0a7ada3c931e66211eebd91de0c0d0">Selection</a>[iSelec]);</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  }</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160; </div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;  <span class="comment">//DB Add all requested cuts from the argument to the selection vector which will be applied</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iSelec=0;iSelec&lt;EventSelectionVec.size();iSelec++) {</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    SelectionVecToApply.emplace_back(EventSelectionVec[iSelec]);</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;  }</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160; </div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;  <span class="comment">//DB Set the member variable to be the cuts to apply</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a2b0a7ada3c931e66211eebd91de0c0d0">Selection</a> = SelectionVecToApply;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160; </div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;  <span class="comment">//DB Define the histogram which will be returned</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;  TH1D* _h1DVar;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;  <span class="keywordflow">if</span> (Axis) {</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    _h1DVar = <span class="keyword">new</span> TH1D(<span class="stringliteral">&quot;&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,Axis-&gt;GetNbins(),Axis-&gt;GetXbins()-&gt;GetArray());</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    std::vector&lt;double&gt; xBinEdges = <a class="code" href="classSampleHandlerFD.html#a0eee2ae1aed3c66aa7d6513c9785ee67">ReturnKinematicParameterBinning</a>(ProjectionVar_Str);</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    _h1DVar = <span class="keyword">new</span> TH1D(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="keywordtype">int</span>(xBinEdges.size())-1, xBinEdges.data());</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;  }</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;  _h1DVar-&gt;GetXaxis()-&gt;SetTitle(ProjectionVar_Str.c_str());</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160; </div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#ad14d9728400a7b87f095aca00761b829">IsSubEventVarString</a>(ProjectionVar_Str)) {</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <a class="code" href="group__SampleHandlerGetters.html#ga6adbe3dd0c7809ecd9e83f0ee5399f8e">Fill1DSubEventHist</a>(_h1DVar, ProjectionVar_Str, SubEventSelectionVec, WeightStyle);</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="comment">//DB Grab the associated enum with the argument string</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="keywordtype">int</span> ProjectionVar_Int = <a class="code" href="group__SampleHandlerGetters.html#gae2769d593f34e8356b545af076818f89">ReturnKinematicParameterFromString</a>(ProjectionVar_Str);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160; </div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <span class="comment">//DB Loop over all events</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iEvent = 0; iEvent &lt; <a class="code" href="group__SampleHandlerGetters.html#ga6ceca02f83e878ef1aec6e54e7b2f331">GetNEvents</a>(); iEvent++) {</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#a1ce3d6b9d9f6cce379fe1e8dd404369a">IsEventSelected</a>(iEvent)) {</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        <span class="keywordtype">double</span> Weight = <a class="code" href="classSampleHandlerFD.html#a9e735d294d926fef87a6fc4c0ec54dca">GetEventWeight</a>(iEvent);</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        <span class="keywordflow">if</span> (WeightStyle == 1) {</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;          Weight = 1.;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        }</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;        <span class="keywordtype">double</span> Var = <a class="code" href="classSampleHandlerFD.html#ad0f549802b5625871e11d86905989697">ReturnKinematicParameter</a>(ProjectionVar_Int,iEvent);</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;        _h1DVar-&gt;Fill(Var,Weight);</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;      }</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    }</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  }</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;  <span class="comment">//DB Reset the saved selection</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a2b0a7ada3c931e66211eebd91de0c0d0">Selection</a> = tmp_Selection;</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160; </div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;  <span class="keywordflow">return</span> _h1DVar;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a0eee2ae1aed3c66aa7d6513c9785ee67"><div class="ttname"><a href="classSampleHandlerFD.html#a0eee2ae1aed3c66aa7d6513c9785ee67">SampleHandlerFD::ReturnKinematicParameterBinning</a></div><div class="ttdeci">std::vector&lt; double &gt; ReturnKinematicParameterBinning(const std::string &amp;KinematicParameter)</div><div class="ttdoc">Return the binning used to draw a kinematic parameter.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01680">SampleHandlerFD.cpp:1680</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_a2b0a7ada3c931e66211eebd91de0c0d0"><div class="ttname"><a href="classSampleHandlerFD.html#a2b0a7ada3c931e66211eebd91de0c0d0">SampleHandlerFD::Selection</a></div><div class="ttdeci">std::vector&lt; KinematicCut &gt; Selection</div><div class="ttdoc">a way to store selection cuts which you may push back in the get1DVar functions most of the time this...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00345">SampleHandlerFD.h:345</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ad0f549802b5625871e11d86905989697"><div class="ttname"><a href="classSampleHandlerFD.html#ad0f549802b5625871e11d86905989697">SampleHandlerFD::ReturnKinematicParameter</a></div><div class="ttdeci">virtual double ReturnKinematicParameter(std::string KinematicParamter, int iEvent)=0</div><div class="ttdoc">Return the value of an associated kinematic parameter for an event.</div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_ad14d9728400a7b87f095aca00761b829"><div class="ttname"><a href="classSampleHandlerFD.html#ad14d9728400a7b87f095aca00761b829">SampleHandlerFD::IsSubEventVarString</a></div><div class="ttdeci">bool IsSubEventVarString(const std::string &amp;VarStr)</div><div class="ttdoc">JM Check if a kinematic parameter string corresponds to a subevent-level variable.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01714">SampleHandlerFD.cpp:1714</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_ga6adbe3dd0c7809ecd9e83f0ee5399f8e"><div class="ttname"><a href="group__SampleHandlerGetters.html#ga6adbe3dd0c7809ecd9e83f0ee5399f8e">SampleHandlerFD::Fill1DSubEventHist</a></div><div class="ttdeci">void Fill1DSubEventHist(TH1D *_h1DVar, const std::string &amp;ProjectionVar, const std::vector&lt; KinematicCut &gt; &amp;SubEventSelectionVec=std::vector&lt; KinematicCut &gt;(), int WeightStyle=0)</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01491">SampleHandlerFD.cpp:1491</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_gae2769d593f34e8356b545af076818f89"><div class="ttname"><a href="group__SampleHandlerGetters.html#gae2769d593f34e8356b545af076818f89">SampleHandlerFD::ReturnKinematicParameterFromString</a></div><div class="ttdeci">int ReturnKinematicParameterFromString(const std::string &amp;KinematicStr) const</div><div class="ttdoc">ETA function to generically convert a string from xsec cov to a kinematic type.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01627">SampleHandlerFD.cpp:1627</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gaac0dad7d2090250cf8094eb8ceaab932"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaac0dad7d2090250cf8094eb8ceaab932">&#9670;&nbsp;</a></span>Get1DVarHistByModeAndChannel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TH1 * SampleHandlerFD::Get1DVarHistByModeAndChannel </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVar_Str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kModeToFill</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kChannelToFill</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>Axis</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01728">1728</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                                                                       {</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;  <span class="keywordtype">bool</span> fChannel;</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  <span class="keywordtype">bool</span> fMode;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160; </div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;  <span class="keywordflow">if</span> (kChannelToFill != -1) {</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    <span class="keywordflow">if</span> (kChannelToFill &gt; <a class="code" href="group__SampleHandlerGetters.html#gaa619e7779b3faa873dc418da07112a12">GetNOscChannels</a>()) {</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Required channel is not available. kChannelToFill should be between 0 and {}&quot;</span>, <a class="code" href="group__SampleHandlerGetters.html#gaa619e7779b3faa873dc418da07112a12">GetNOscChannels</a>());</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;kChannelToFill given:{}&quot;</span>, kChannelToFill);</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Exiting.&quot;</span>);</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    }</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    fChannel = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    fChannel = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  }</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160; </div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  <span class="keywordflow">if</span> (kModeToFill!=-1) {</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    <span class="keywordflow">if</span> (!(kModeToFill &gt;= 0) &amp;&amp; (kModeToFill &lt; Modes-&gt;GetNModes())) {</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Required mode is not available. kModeToFill should be between 0 and {}&quot;</span>, <a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetNModes());</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;kModeToFill given:{}&quot;</span>, kModeToFill);</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Exiting..&quot;</span>);</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    }</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    fMode = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    fMode = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;  }</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160; </div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;  std::vector&lt; KinematicCut &gt; SelectionVec;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160; </div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;  <span class="keywordflow">if</span> (fMode) {</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <a class="code" href="structKinematicCut.html">KinematicCut</a> SelecMode;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    SelecMode.<a class="code" href="structKinematicCut.html#aedd261d6e8e3f72e3570cfe3753cbd2f">ParamToCutOnIt</a> = <a class="code" href="group__SampleHandlerGetters.html#gae2769d593f34e8356b545af076818f89">ReturnKinematicParameterFromString</a>(<span class="stringliteral">&quot;Mode&quot;</span>);</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    SelecMode.<a class="code" href="structKinematicCut.html#aa654b5f2ef7ca1b57d9238c428fdc11f">LowerBound</a> = kModeToFill;</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    SelecMode.<a class="code" href="structKinematicCut.html#a244bd4ada65739a6984a2039a5a6f200">UpperBound</a> = kModeToFill+1;</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    SelectionVec.push_back(SelecMode);</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;  }</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160; </div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;  <span class="keywordflow">if</span> (fChannel) {</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    <a class="code" href="structKinematicCut.html">KinematicCut</a> SelecChannel;</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    SelecChannel.<a class="code" href="structKinematicCut.html#aedd261d6e8e3f72e3570cfe3753cbd2f">ParamToCutOnIt</a> = <a class="code" href="group__SampleHandlerGetters.html#gae2769d593f34e8356b545af076818f89">ReturnKinematicParameterFromString</a>(<span class="stringliteral">&quot;OscillationChannel&quot;</span>);</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    SelecChannel.<a class="code" href="structKinematicCut.html#aa654b5f2ef7ca1b57d9238c428fdc11f">LowerBound</a> = kChannelToFill;</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    SelecChannel.<a class="code" href="structKinematicCut.html#a244bd4ada65739a6984a2039a5a6f200">UpperBound</a> = kChannelToFill+1;</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    SelectionVec.push_back(SelecChannel);</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;  }</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160; </div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__SampleHandlerGetters.html#ga39870e48ee550ce8902ccd62b2311a57">Get1DVarHist</a>(ProjectionVar_Str,SelectionVec,WeightStyle,Axis);</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a61052119a625282d0ec6d4a97adf3ee2"><div class="ttname"><a href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a></div><div class="ttdeci">#define MACH3LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00027">MaCh3Logger.h:27</a></div></div>
<div class="ttc" id="aclassMaCh3Exception_html"><div class="ttname"><a href="classMaCh3Exception.html">MaCh3Exception</a></div><div class="ttdoc">Custom exception class for MaCh3 errors.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Exception_8h_source.html#l00013">MaCh3Exception.h:13</a></div></div>
<div class="ttc" id="aclassSampleHandlerBase_html_a2f86c6158b755b9d2d400415ccac45f2"><div class="ttname"><a href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">SampleHandlerBase::Modes</a></div><div class="ttdeci">std::unique_ptr&lt; MaCh3Modes &gt; Modes</div><div class="ttdoc">Holds information about used Generator and MaCh3 modes.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00204">SampleHandlerBase.h:204</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_ga39870e48ee550ce8902ccd62b2311a57"><div class="ttname"><a href="group__SampleHandlerGetters.html#ga39870e48ee550ce8902ccd62b2311a57">SampleHandlerFD::Get1DVarHist</a></div><div class="ttdeci">TH1 * Get1DVarHist(const std::string &amp;ProjectionVar, const std::vector&lt; KinematicCut &gt; &amp;EventSelectionVec=std::vector&lt; KinematicCut &gt;(), int WeightStyle=0, TAxis *Axis=nullptr, const std::vector&lt; KinematicCut &gt; &amp;SubEventSelectionVec=std::vector&lt; KinematicCut &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01437">SampleHandlerFD.cpp:1437</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_gaa619e7779b3faa873dc418da07112a12"><div class="ttname"><a href="group__SampleHandlerGetters.html#gaa619e7779b3faa873dc418da07112a12">SampleHandlerFD::GetNOscChannels</a></div><div class="ttdeci">int GetNOscChannels() override</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00080">SampleHandlerFD.h:80</a></div></div>
<div class="ttc" id="astructKinematicCut_html"><div class="ttname"><a href="structKinematicCut.html">KinematicCut</a></div><div class="ttdoc">KS: Small struct used for applying kinematic cuts.</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00156">SampleStructs.h:156</a></div></div>
<div class="ttc" id="astructKinematicCut_html_a244bd4ada65739a6984a2039a5a6f200"><div class="ttname"><a href="structKinematicCut.html#a244bd4ada65739a6984a2039a5a6f200">KinematicCut::UpperBound</a></div><div class="ttdeci">double UpperBound</div><div class="ttdoc">Upper bound on which we apply cut.</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00163">SampleStructs.h:163</a></div></div>
<div class="ttc" id="astructKinematicCut_html_aa654b5f2ef7ca1b57d9238c428fdc11f"><div class="ttname"><a href="structKinematicCut.html#aa654b5f2ef7ca1b57d9238c428fdc11f">KinematicCut::LowerBound</a></div><div class="ttdeci">double LowerBound</div><div class="ttdoc">Lower bound on which we apply cut.</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00161">SampleStructs.h:161</a></div></div>
<div class="ttc" id="astructKinematicCut_html_aedd261d6e8e3f72e3570cfe3753cbd2f"><div class="ttname"><a href="structKinematicCut.html#aedd261d6e8e3f72e3570cfe3753cbd2f">KinematicCut::ParamToCutOnIt</a></div><div class="ttdeci">int ParamToCutOnIt</div><div class="ttdoc">Index or enum value identifying the kinematic variable to cut on.</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00159">SampleStructs.h:159</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gaa78d7bcfe9377cb7d47d596b39eda84c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa78d7bcfe9377cb7d47d596b39eda84c">&#9670;&nbsp;</a></span>Get2DVarHistByModeAndChannel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TH2 * SampleHandlerFD::Get2DVarHistByModeAndChannel </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVar_StrX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVar_StrY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kModeToFill</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kChannelToFill</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>AxisX</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>AxisY</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01778">1778</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;                                                                                      {</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;  <span class="keywordtype">bool</span> fChannel;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;  <span class="keywordtype">bool</span> fMode;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160; </div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;  <span class="keywordflow">if</span> (kChannelToFill!=-1) {</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    <span class="keywordflow">if</span> (kChannelToFill &gt; <a class="code" href="group__SampleHandlerGetters.html#gaa619e7779b3faa873dc418da07112a12">GetNOscChannels</a>()) {</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Required channel is not available. kChannelToFill should be between 0 and {}&quot;</span>, <a class="code" href="group__SampleHandlerGetters.html#gaa619e7779b3faa873dc418da07112a12">GetNOscChannels</a>());</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;kChannelToFill given:{}&quot;</span>, kChannelToFill);</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Exiting.&quot;</span>);</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    }</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    fChannel = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    fChannel = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;  }</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160; </div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;  <span class="keywordflow">if</span> (kModeToFill!=-1) {</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    <span class="keywordflow">if</span> (!(kModeToFill &gt;= 0) &amp;&amp; (kModeToFill &lt; Modes-&gt;GetNModes())) {</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Required mode is not available. kModeToFill should be between 0 and {}&quot;</span>, <a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetNModes());</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;kModeToFill given:{}&quot;</span>, kModeToFill);</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Exiting..&quot;</span>);</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    }</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    fMode = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    fMode = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;  }</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160; </div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;  std::vector&lt; KinematicCut &gt; SelectionVec;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160; </div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  <span class="keywordflow">if</span> (fMode) {</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    <a class="code" href="structKinematicCut.html">KinematicCut</a> SelecMode;</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    SelecMode.<a class="code" href="structKinematicCut.html#aedd261d6e8e3f72e3570cfe3753cbd2f">ParamToCutOnIt</a> = <a class="code" href="group__SampleHandlerGetters.html#gae2769d593f34e8356b545af076818f89">ReturnKinematicParameterFromString</a>(<span class="stringliteral">&quot;Mode&quot;</span>);</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    SelecMode.<a class="code" href="structKinematicCut.html#aa654b5f2ef7ca1b57d9238c428fdc11f">LowerBound</a> = kModeToFill;</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    SelecMode.<a class="code" href="structKinematicCut.html#a244bd4ada65739a6984a2039a5a6f200">UpperBound</a> = kModeToFill+1;</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    SelectionVec.push_back(SelecMode);</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;  }</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160; </div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;  <span class="keywordflow">if</span> (fChannel) {</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    <a class="code" href="structKinematicCut.html">KinematicCut</a> SelecChannel;</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    SelecChannel.<a class="code" href="structKinematicCut.html#aedd261d6e8e3f72e3570cfe3753cbd2f">ParamToCutOnIt</a> = <a class="code" href="group__SampleHandlerGetters.html#gae2769d593f34e8356b545af076818f89">ReturnKinematicParameterFromString</a>(<span class="stringliteral">&quot;OscillationChannel&quot;</span>);</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    SelecChannel.<a class="code" href="structKinematicCut.html#aa654b5f2ef7ca1b57d9238c428fdc11f">LowerBound</a> = kChannelToFill;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    SelecChannel.<a class="code" href="structKinematicCut.html#a244bd4ada65739a6984a2039a5a6f200">UpperBound</a> = kChannelToFill+1;</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    SelectionVec.push_back(SelecChannel);</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;  }</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160; </div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#ab36169bf01540dd38eabcd4222b92fea">Get2DVarHist</a>(ProjectionVar_StrX,ProjectionVar_StrY,SelectionVec,WeightStyle,AxisX,AxisY);</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_ab36169bf01540dd38eabcd4222b92fea"><div class="ttname"><a href="classSampleHandlerFD.html#ab36169bf01540dd38eabcd4222b92fea">SampleHandlerFD::Get2DVarHist</a></div><div class="ttdeci">TH2 * Get2DVarHist(const std::string &amp;ProjectionVarX, const std::string &amp;ProjectionVarY, const std::vector&lt; KinematicCut &gt; &amp;EventSelectionVec=std::vector&lt; KinematicCut &gt;(), int WeightStyle=0, TAxis *AxisX=nullptr, TAxis *AxisY=nullptr, const std::vector&lt; KinematicCut &gt; &amp;SubEventSelectionVec=std::vector&lt; KinematicCut &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01515">SampleHandlerFD.cpp:1515</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gae92915fce9d4b308aea94e6934bd0e75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae92915fce9d4b308aea94e6934bd0e75">&#9670;&nbsp;</a></span>GetDataHist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TH1 * SampleHandlerFD::GetDataHist </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Dimension</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get Data histogram. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01049">1049</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                                                     {</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  <span class="keywordflow">if</span>(Dimension == 1) {</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a1cada8a34d03db4ffe9dd170036c6ce1">SampleDetails</a>.<a class="code" href="structSampleInfo.html#aa8a6c969046ca812c76198faa0175b89">dathist</a>;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(Dimension == 2) {</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a1cada8a34d03db4ffe9dd170036c6ce1">SampleDetails</a>.<a class="code" href="structSampleInfo.html#aa6f0af6a7e4c166fcf3422ceb3b2d3f7">dathist2d</a>;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  } <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Asdking for {} with N Dimension = {}. This is not implemented&quot;</span>, __func__, Dimension);</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  }</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a1cada8a34d03db4ffe9dd170036c6ce1"><div class="ttname"><a href="classSampleHandlerFD.html#a1cada8a34d03db4ffe9dd170036c6ce1">SampleHandlerFD::SampleDetails</a></div><div class="ttdeci">SampleInfo SampleDetails</div><div class="ttdoc">Stores info about currently initialised sample.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00319">SampleHandlerFD.h:319</a></div></div>
<div class="ttc" id="astructSampleInfo_html_aa6f0af6a7e4c166fcf3422ceb3b2d3f7"><div class="ttname"><a href="structSampleInfo.html#aa6f0af6a7e4c166fcf3422ceb3b2d3f7">SampleInfo::dathist2d</a></div><div class="ttdeci">TH2D * dathist2d</div><div class="ttdoc">histogram used for plotting storing 2D data distribution</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00066">FarDetectorCoreInfoStruct.h:66</a></div></div>
<div class="ttc" id="astructSampleInfo_html_aa8a6c969046ca812c76198faa0175b89"><div class="ttname"><a href="structSampleInfo.html#aa8a6c969046ca812c76198faa0175b89">SampleInfo::dathist</a></div><div class="ttdeci">TH1D * dathist</div><div class="ttdoc">histogram used for plotting storing 1D data distribution</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00064">FarDetectorCoreInfoStruct.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga9eb3d4a487ed877beb252738b9de9443"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9eb3d4a487ed877beb252738b9de9443">&#9670;&nbsp;</a></span>GetFlavourName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::GetFlavourName </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iChannel</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00083">83</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                                               {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">if</span> (iChannel &lt; 0 || iChannel &gt; <a class="code" href="group__SampleHandlerGetters.html#gaa619e7779b3faa873dc418da07112a12">GetNOscChannels</a>()) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Invalid Channel Requested: {}&quot;</span>, iChannel);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__);      </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a57f378f84f66caa817e52c0bfb5ff0be">OscChannels</a>[iChannel].flavourName;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  }</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a57f378f84f66caa817e52c0bfb5ff0be"><div class="ttname"><a href="classSampleHandlerFD.html#a57f378f84f66caa817e52c0bfb5ff0be">SampleHandlerFD::OscChannels</a></div><div class="ttdeci">std::vector&lt; OscChannelInfo &gt; OscChannels</div><div class="ttdoc">Stores info about oscillation channel for a single sample.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00321">SampleHandlerFD.h:321</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga65bbd8a3084731b4bdb0c4d3fcaf641e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga65bbd8a3084731b4bdb0c4d3fcaf641e">&#9670;&nbsp;</a></span>GetLikelihood()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double SampleHandlerBase::GetLikelihood </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classSampleHandlerFD.html#a4f8116b84ce4dd9f2ab55983f793fe14">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#a8309f7b5490faa56109d2f9cf99b8cd8">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="ga4e232eb59bc09c3f8ff4cbed69fcd688"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4e232eb59bc09c3f8ff4cbed69fcd688">&#9670;&nbsp;</a></span>GetMaCh3Modes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMaCh3Modes.html">MaCh3Modes</a>* SampleHandlerBase::GetMaCh3Modes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return pointer to MaCh3 modes. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8h_source.html#l00053">53</a> of file <a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>.get(); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="gabf1cb9517984e9c1f1094f8f936a5df9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabf1cb9517984e9c1f1094f8f936a5df9">&#9670;&nbsp;</a></span>GetMCHist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TH1 * SampleHandlerFD::GetMCHist </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Dimension</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get MC histogram. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01034">1034</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                                                   {</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  <a class="code" href="classSampleHandlerFD.html#a3e633588ffc1bf0ec04acd190452bd55">FillMCHist</a>(Dimension);</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160; </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <span class="keywordflow">if</span>(Dimension == 1) {</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a1cada8a34d03db4ffe9dd170036c6ce1">SampleDetails</a>.<a class="code" href="structSampleInfo.html#a164184cba17531aeb71fa507cb44f9ab">_hPDF1D</a>;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(Dimension == 2) {</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a1cada8a34d03db4ffe9dd170036c6ce1">SampleDetails</a>.<a class="code" href="structSampleInfo.html#a34cf26cf1fa2cfb5c20c34968abbb551">_hPDF2D</a>;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  } <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Asking for {} with N Dimension = {}. This is not implemented&quot;</span>, __func__, Dimension);</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  }</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a3e633588ffc1bf0ec04acd190452bd55"><div class="ttname"><a href="classSampleHandlerFD.html#a3e633588ffc1bf0ec04acd190452bd55">SampleHandlerFD::FillMCHist</a></div><div class="ttdeci">void FillMCHist(const int Dimension)</div><div class="ttdoc">Fill a histogram with the event-level information used in the fit.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l00263">SampleHandlerFD.cpp:263</a></div></div>
<div class="ttc" id="astructSampleInfo_html_a164184cba17531aeb71fa507cb44f9ab"><div class="ttname"><a href="structSampleInfo.html#a164184cba17531aeb71fa507cb44f9ab">SampleInfo::_hPDF1D</a></div><div class="ttdeci">TH1D * _hPDF1D</div><div class="ttdoc">histogram used for plotting storing 1D MC distribution</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00069">FarDetectorCoreInfoStruct.h:69</a></div></div>
<div class="ttc" id="astructSampleInfo_html_a34cf26cf1fa2cfb5c20c34968abbb551"><div class="ttname"><a href="structSampleInfo.html#a34cf26cf1fa2cfb5c20c34968abbb551">SampleInfo::_hPDF2D</a></div><div class="ttdeci">TH2D * _hPDF2D</div><div class="ttdoc">histogram used for plotting storing 2D MC distribution</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00071">FarDetectorCoreInfoStruct.h:71</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gabb8ac1e8e55d6ea2097380e5078a0198"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabb8ac1e8e55d6ea2097380e5078a0198">&#9670;&nbsp;</a></span>GetModeHist1D()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH1* SampleHandlerFD::GetModeHist1D </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>style</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00111">111</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                                                  {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__SampleHandlerGetters.html#gaac0dad7d2090250cf8094eb8ceaab932">Get1DVarHistByModeAndChannel</a>(<a class="code" href="group__SampleHandlerGetters.html#ga1e1ef726c2c67cc3f8bb93b0ef9989fa">GetXBinVarName</a>(),m,s,style);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  }</div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_ga1e1ef726c2c67cc3f8bb93b0ef9989fa"><div class="ttname"><a href="group__SampleHandlerGetters.html#ga1e1ef726c2c67cc3f8bb93b0ef9989fa">SampleHandlerFD::GetXBinVarName</a></div><div class="ttdeci">std::string GetXBinVarName() const</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00038">SampleHandlerFD.h:38</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_gaac0dad7d2090250cf8094eb8ceaab932"><div class="ttname"><a href="group__SampleHandlerGetters.html#gaac0dad7d2090250cf8094eb8ceaab932">SampleHandlerFD::Get1DVarHistByModeAndChannel</a></div><div class="ttdeci">TH1 * Get1DVarHistByModeAndChannel(const std::string &amp;ProjectionVar_Str, int kModeToFill=-1, int kChannelToFill=-1, int WeightStyle=0, TAxis *Axis=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01728">SampleHandlerFD.cpp:1728</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga3100796be3a94b715355d045a530ba43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3100796be3a94b715355d045a530ba43">&#9670;&nbsp;</a></span>GetModeHist2D()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH2* SampleHandlerFD::GetModeHist2D </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>style</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00115">115</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                                                  {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__SampleHandlerGetters.html#gaa78d7bcfe9377cb7d47d596b39eda84c">Get2DVarHistByModeAndChannel</a>(<a class="code" href="group__SampleHandlerGetters.html#ga1e1ef726c2c67cc3f8bb93b0ef9989fa">GetXBinVarName</a>(),<a class="code" href="group__SampleHandlerGetters.html#ga20478b6d0ab397e3d1b87ef466a81e13">GetYBinVarName</a>(),m,s,style);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }</div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_ga20478b6d0ab397e3d1b87ef466a81e13"><div class="ttname"><a href="group__SampleHandlerGetters.html#ga20478b6d0ab397e3d1b87ef466a81e13">SampleHandlerFD::GetYBinVarName</a></div><div class="ttdeci">std::string GetYBinVarName() const</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00040">SampleHandlerFD.h:40</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_gaa78d7bcfe9377cb7d47d596b39eda84c"><div class="ttname"><a href="group__SampleHandlerGetters.html#gaa78d7bcfe9377cb7d47d596b39eda84c">SampleHandlerFD::Get2DVarHistByModeAndChannel</a></div><div class="ttdeci">TH2 * Get2DVarHistByModeAndChannel(const std::string &amp;ProjectionVar_StrX, const std::string &amp;ProjectionVar_StrY, int kModeToFill=-1, int kChannelToFill=-1, int WeightStyle=0, TAxis *AxisX=nullptr, TAxis *AxisY=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01778">SampleHandlerFD.cpp:1778</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga6cab155b5644a3ad263ea1a35facd8b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6cab155b5644a3ad263ea1a35facd8b9">&#9670;&nbsp;</a></span>GetNDim()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SampleHandlerFD::GetNDim </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>DB Function to differentiate 1D or 2D binning. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00031">31</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a1cada8a34d03db4ffe9dd170036c6ce1">SampleDetails</a>.<a class="code" href="structSampleInfo.html#a4402b585d1e3fde1dcd040ea59a0b209">nDimensions</a>; }</div>
<div class="ttc" id="astructSampleInfo_html_a4402b585d1e3fde1dcd040ea59a0b209"><div class="ttname"><a href="structSampleInfo.html#a4402b585d1e3fde1dcd040ea59a0b209">SampleInfo::nDimensions</a></div><div class="ttdeci">int nDimensions</div><div class="ttdoc">Keep track of the dimensions of the sample binning.</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00061">FarDetectorCoreInfoStruct.h:61</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga6ceca02f83e878ef1aec6e54e7b2f331"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6ceca02f83e878ef1aec6e54e7b2f331">&#9670;&nbsp;</a></span>GetNEvents()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int SampleHandlerBase::GetNEvents </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8h_source.html#l00060">60</a> of file <a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="classSampleHandlerBase.html#ab497b52d94868283a8a7cedbd1a4d777">nEvents</a>;}</div>
<div class="ttc" id="aclassSampleHandlerBase_html_ab497b52d94868283a8a7cedbd1a4d777"><div class="ttname"><a href="classSampleHandlerBase.html#ab497b52d94868283a8a7cedbd1a4d777">SampleHandlerBase::nEvents</a></div><div class="ttdeci">unsigned int nEvents</div><div class="ttdoc">Number of MC events are there.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00201">SampleHandlerBase.h:201</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gaeb7b2ceb1ff0720b5f4976035d5900c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaeb7b2ceb1ff0720b5f4976035d5900c7">&#9670;&nbsp;</a></span>GetNOscChannels() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual int SampleHandlerBase::GetNOscChannels </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented in <a class="el" href="group__SampleHandlerGetters.html#gaa619e7779b3faa873dc418da07112a12">SampleHandlerFD</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8h_source.html#l00062">62</a> of file <a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;{ <span class="keywordflow">return</span> 1; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="gaa619e7779b3faa873dc418da07112a12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa619e7779b3faa873dc418da07112a12">&#9670;&nbsp;</a></span>GetNOscChannels() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SampleHandlerFD::GetNOscChannels </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="group__SampleHandlerGetters.html#gaeb7b2ceb1ff0720b5f4976035d5900c7">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00080">80</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;{<span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerFD.html#a57f378f84f66caa817e52c0bfb5ff0be">OscChannels</a>.size());}</div>
</div><!-- fragment -->
</div>
</div>
<a id="gac4b73a8841ff9bab2fb08b578ad4137f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac4b73a8841ff9bab2fb08b578ad4137f">&#9670;&nbsp;</a></span>GetNsamples()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a> SampleHandlerBase::GetNsamples </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8h_source.html#l00040">40</a> of file <a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerBase.html#aa7a13af22c2314c718fb6438d493d3d1">nSamples</a>; };</div>
<div class="ttc" id="aclassSampleHandlerBase_html_aa7a13af22c2314c718fb6438d493d3d1"><div class="ttname"><a href="classSampleHandlerBase.html#aa7a13af22c2314c718fb6438d493d3d1">SampleHandlerBase::nSamples</a></div><div class="ttdeci">M3::int_t nSamples</div><div class="ttdoc">Contains how many samples we've got.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00198">SampleHandlerBase.h:198</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gae5849766fbbc7aa71672da8b0f189fe5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae5849766fbbc7aa71672da8b0f189fe5">&#9670;&nbsp;</a></span>GetPoissonLLH()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double SampleHandlerBase::GetPoissonLLH </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>mc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate test statistic for a single bin using Poisson. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>is data </td></tr>
    <tr><td class="paramname">mc</td><td>is mc </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8cpp_source.html#l00018">18</a> of file <a class="el" href="SampleHandlerBase_8cpp_source.html">SampleHandlerBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                                                                                {</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="comment">// Return MC if there are no data, returns 0 for data == 0 &amp;&amp; mc == 0  </span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keywordflow">if</span> ( data == 0 ) <span class="keywordflow">return</span> mc;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="comment">// If there are some data, but the prediction falls below the MC bound =&gt; return Poisson LogL for the low MC bound</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keywordflow">if</span> ( mc &lt; <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) {</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keywordflow">if</span> ( data &gt; <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) <span class="keywordflow">return</span> ( <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> - data + data * std::log( data/<a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) );</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( data &gt;= mc ) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  }</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="comment">// Otherwise, just return usual Poisson LogL using Stirling&#39;s approximation</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="comment">// http://hyperphysics.phy-astr.gsu.edu/hbase/math/stirling.html</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordflow">return</span> ( mc - data + data * std::log( data / mc ) );</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;}</div>
<div class="ttc" id="anamespaceM3_html_ad6bd1a7e1e5b714f2985b91f8bdc4104"><div class="ttname"><a href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a></div><div class="ttdeci">constexpr static const double _LOW_MC_BOUND_</div><div class="ttdoc">MC prediction lower bound in bin to identify problematic binning definitions and handle LogL calculat...</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00076">Core.h:76</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga3f4388fbe27168c5dae8fa722a7c1299"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3f4388fbe27168c5dae8fa722a7c1299">&#9670;&nbsp;</a></span>GetSampleLikelihood()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double SampleHandlerBase::GetSampleLikelihood </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>isample</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8h_source.html#l00046">46</a> of file <a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;{(void) isample; <span class="keywordflow">return</span> <a class="code" href="group__SampleHandlerGetters.html#ga65bbd8a3084731b4bdb0c4d3fcaf641e">GetLikelihood</a>();};</div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_ga65bbd8a3084731b4bdb0c4d3fcaf641e"><div class="ttname"><a href="group__SampleHandlerGetters.html#ga65bbd8a3084731b4bdb0c4d3fcaf641e">SampleHandlerBase::GetLikelihood</a></div><div class="ttdeci">virtual double GetLikelihood()=0</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga46ca9963ed2f9b9b337db72bf52d99e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga46ca9963ed2f9b9b337db72bf52d99e6">&#9670;&nbsp;</a></span>GetSampleName() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::GetSampleName </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iSample</em> = <code>0</code></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="group__SampleHandlerGetters.html#ga0ed9dd339235b3bdea2680078ab129ab">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01273">1273</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                                                          {</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  <span class="comment">//ETA - this is just to suppress a warning for an unused variable</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  (void)iSample;</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160; </div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  <span class="comment">//ETA - extra safety to make sure SampleName is actually set</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  <span class="comment">// probably unnecessary due to the requirement for it to be in the yaml config</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classSampleHandlerFD.html#afc09fc72a5d00762fa023ab617f9a54d">SampleName</a>.length() == 0){</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;No sample name provided&quot;</span>);</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Please provide a SampleName in your configuration file: {}&quot;</span>, <a class="code" href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleManager</a>-&gt;GetFileName());</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  }</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#afc09fc72a5d00762fa023ab617f9a54d">SampleName</a>;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a9ccc0e26810ded77d0615e95e8a9b277"><div class="ttname"><a href="classSampleHandlerFD.html#a9ccc0e26810ded77d0615e95e8a9b277">SampleHandlerFD::SampleManager</a></div><div class="ttdeci">std::unique_ptr&lt; manager &gt; SampleManager</div><div class="ttdoc">The manager object used to read the sample yaml file.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00359">SampleHandlerFD.h:359</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_afc09fc72a5d00762fa023ab617f9a54d"><div class="ttname"><a href="classSampleHandlerFD.html#afc09fc72a5d00762fa023ab617f9a54d">SampleHandlerFD::SampleName</a></div><div class="ttdeci">std::string SampleName</div><div class="ttdoc">A unique ID for each sample based on which we can define what systematic should be applied.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00332">SampleHandlerFD.h:332</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga0ed9dd339235b3bdea2680078ab129ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0ed9dd339235b3bdea2680078ab129ab">&#9670;&nbsp;</a></span>GetSampleName() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::string SampleHandlerBase::GetSampleName </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="group__SampleHandlerGetters.html#ga46ca9963ed2f9b9b337db72bf52d99e6">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#a11fa6d8b67b61b75d1f8c1a63dae36f5">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="ga527307a4186e2eb61475ea975108aa65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga527307a4186e2eb61475ea975108aa65">&#9670;&nbsp;</a></span>GetTestStatLLH()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double SampleHandlerBase::GetTestStatLLH </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>mc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>w2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate test statistic for a single bin. Calculation depends on setting of <code>fTestStatistic</code>. Data and mc -&gt; 0 cut-offs are defined in <a class="el" href="namespaceM3.html">M3</a>::<em>LOW_MC_BOUND</em>. </p>
<h3><a class="anchor" id="autotoc_md23"></a>
Poisson</h3>
<p>Standard Poisson log-likelihood (Stirling approximation) <a class="el" href="citelist.html#CITEREF_BakerCousins1984">[2]</a> </p><p class="formulaDsp">
\[ - \log \mathcal{L}_\mathrm{Poisson} = \sum_i N_i^\mathrm{MC} - N_i^\mathrm{data} + N_i^\mathrm{data} \ln \frac{N_i^\mathrm{data}}{N_i^\mathrm{MC}}, \]
</p>
<h3><a class="anchor" id="autotoc_md24"></a>
Pearson</h3>
<p>Standard Pearson likelihood <a class="el" href="citelist.html#CITEREF_Pearson1900">[24]</a> (assumes Gaussian approximation of bin counts): </p><p class="formulaDsp">
\[ - \log \mathcal{L}_\mathrm{Pearson} = \sum_i \frac{(N_i^\mathrm{data} - N_i^\mathrm{MC})^2}{2 \, N_i^\mathrm{MC}} \]
</p>
<h3><a class="anchor" id="autotoc_md25"></a>
Barlow-Beeston</h3>
<p>Based on <a class="el" href="citelist.html#CITEREF_Barlow:1993dm">[3]</a> and following Conway approximation (<a class="el" href="citelist.html#CITEREF_Conway:2011in">[5]</a>) The generation of MC is a stochastic process, so even identical settings can lead to different outputs (assuming that the seeds of the random number generator are different). This introduces uncertainty in MC distributions, especially in bins with low statistics.</p>
<p class="formulaDsp">
\[ - \log \mathcal{L}_\mathrm{BB} = - \log \mathcal{L}_\mathrm{Poisson} - \log \mathcal{L}_\mathrm{MC_{stat}} = \sum_i \Biggl[ N_i^\mathrm{MC}(\vec{\theta}) - N_i^\mathrm{data} + N_i^\mathrm{data} \ln \frac{N_i^\mathrm{data}}{N_i^\mathrm{MC}(\vec{\theta})} + \frac{(\beta_i - 1)^2}{2 \sigma_{\beta_i}^2} \Biggr], \]
</p>
<p>where \(\beta_i\) is a scaling parameter between ideal ("true") and generated MC in a bin ( \(N^\mathrm{true}_{\mathrm{MC},i} = \beta_i N_i^\mathrm{MC}\)), and \(\sigma^2_{\beta_i} = \frac{\sum_i w_i^2}{N_i^\mathrm{MC}}\), with \(\sum_i w_i^2\) being the sum of the squares of weights in bin \(i\). Assuming \(\beta_i\) follows a Gaussian, its mean can be found by solving the quadratic equation derived by Conway:</p>
<p class="formulaDsp">
\[ \beta_i^2 + (N_i^\mathrm{MC} \sigma_{\beta_i}^2 - 1)\beta_i - N_i^\mathrm{data} \sigma_{\beta_i}^2 = 0 \]
</p>
<h3><a class="anchor" id="autotoc_md26"></a>
Dembinski-Abdelmotteleb</h3>
<p>Alternative treatment of MC statistical uncertainty following Hans Dembinski and Ahmed Abdelmotteleb <a class="el" href="citelist.html#CITEREF_Dembinski:2022ios">[6]</a></p>
<p>This approach extends the Barlow-Beeston method. For each bin: </p><p class="formulaDsp">
\[ - \log \mathcal{L}_\mathrm{DA} = (N_i^{\mathrm{MC},\prime} - N_i^\mathrm{data} + N_i^\mathrm{data} \ln \frac{N_i^\mathrm{data}}{N_i^{\mathrm{MC},\prime}}) + k \beta - k + k \ln \frac{k}{k \beta} \]
</p>
<p> where </p><p class="formulaDsp">
\[ k = \frac{(N_i^\mathrm{MC})^2}{\sum_i w_i^2} \]
</p>
<p> and </p><p class="formulaDsp">
\[ \beta = \frac{N_i^\mathrm{data} + k}{N_i^\mathrm{MC} + k}, \quad N_i^{\mathrm{MC},\prime} = N_i^\mathrm{MC} \cdot \beta \]
</p>
<h3><a class="anchor" id="autotoc_md27"></a>
IceCube</h3>
<p>Alternative likelihood definition described by the IceCube collaboration <a class="el" href="citelist.html#CITEREF_Arguelles:2019izp">[1]</a> </p><p class="formulaDsp">
\[ - \log \mathcal{L} = - \sum_i \Biggl( a_i \log(b_i) + \log[\Gamma(N_i^{\mathrm{data}}+a_i)] - (N_i^{\mathrm{data}}+a_i)\log(b_i+1) - \log[\Gamma(a_i)] \Biggr), \]
</p>
<p> where the auxiliary variables are </p><p class="formulaDsp">
\[ a_i = N^{\mathrm{gen}}_{\mathrm{MC},i} \, b_i + 1, \quad b_i = \frac{N^{\mathrm{gen}}_{\mathrm{MC},i}}{\sum_i w_i^2}. \]
</p>
<h3><a class="anchor" id="autotoc_md28"></a>
Treatment of low data/mc</h3>
<p>Implemented fTestStatistic are <code>kPoisson</code> (with Stirling's approx.), <code>kBarlowBeeston</code> (arXiv:1103.0354), <code>kDembinskiAbdelmotteleb</code> (arXiv:2206.12346), <code>kIceCube</code> (arxiv:1901.04645), and <code>kPearson</code>. Test statistics require mc &gt; 0, therefore low mc and data values are treated with cut-offs based on <a class="el" href="namespaceM3.html">M3</a>::<em>LOW_MC_BOUND</em> = .00001 by default. For <code>kPoisson</code>, <code>kBarlowBeeston</code>, <code>kDembinskiAbdelmotteleb</code>, <code>kPearson:</code> data &gt; <em>LOW_MC_BOUND</em> &amp; mc &lt;= <em>LOW_MC_BOUND</em>: returns GetTestStatLLH(data, <em>LOW_MC_BOUND</em>, w2), with Poisson(data,<em>LOW_MC_BOUND</em>) limit for mc-&gt;0, w2-&gt;0. mc &lt; data &lt;= <em>LOW_MC_BOUND</em>: returns 0 (as if any data &lt;= <em>LOW_MC_BOUND</em> were effectively consistent with 0 data count), with a limit of 0 for mc-&gt;0. data = 0: returns mc (or mc/2. for <code>kPearson</code>), with a limit of 0 for mc-&gt;0. For <code>kIceCube:</code> mc &lt; data returns the lower of IceCube(data,mc,w2) and Poisson(data,mc) penalties, with a Poisson(data,<em>LOW_MC_BOUND</em>) limit for mc-&gt;0, w2-&gt;0. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>is data </td></tr>
    <tr><td class="paramname">mc</td><td>is mc </td></tr>
    <tr><td class="paramname">w2</td><td>is \(\sum_{i} w_{i}^2\) (sum of weights squared), which is \(\sigma^2_{\text{MC stats}}\) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8cpp_source.html#l00036">36</a> of file <a class="el" href="SampleHandlerBase_8cpp_source.html">SampleHandlerBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                                                                                                  {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">// *************************</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="classSampleHandlerBase.html#a87670dbcda5d09b09675e8f407fe3a30">fTestStatistic</a>)</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">//CW: Not full Barlow-Beeston or what is referred to as &quot;light&quot;: we&#39;re not introducing any more parameters</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// Assume the MC has a Gaussian distribution around generated</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">// As in https://arxiv.org/abs/1103.0354 eq 10, 11</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">//CW: Calculate the Barlow-Beeston likelihood contribution from MC statistics</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">// Assumes the beta scaling parameters are Gaussian distributed</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">// Follows arXiv:1103.0354 section 5 and equation 8, 9, 10, 11 on page 4/5</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">// Essentially solves equation 11</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">case</span> (<a class="code" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a3c9b50397bd37ce679bbdda14f6108c4">kBarlowBeeston</a>):</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="comment">// The MC used in the likelihood calculation is allowed to be changed by Barlow Beeston beta parameters</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <span class="keywordtype">double</span> newmc = mc;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="comment">// If MC falls below the low MC bound, use low MC bound for newmc</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keywordflow">if</span> ( mc &lt; <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">if</span> ( data &gt; <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) newmc = <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( data &gt;= mc ) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="comment">// Barlow-Beeston uses fractional uncertainty on MC, so sqrt(sum[w^2])/mc</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> fractional = std::sqrt( w2 ) / newmc;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="comment">// fractional^2 to avoid doing same operation several times</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> fractional2 = fractional * fractional;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="comment">// b in quadratic equation</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> temp = newmc * fractional2 - 1;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="comment">// b^2 - 4ac in quadratic equation</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> temp2 = temp * temp + 4 * data * fractional2;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordflow">if</span> ( temp2 &lt; 0 ) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Negative square root in Barlow Beeston coefficient calculation!&quot;</span>);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="comment">// Solve for the positive beta</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> beta = ( -1 * temp + sqrt( temp2 ) ) / 2.;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="comment">// If there is no data, test-stat shall return only MC*beta</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="keywordtype">double</span> stat = mc * beta;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="comment">// With data, test-stat shall return LogL for newMC*beta which includes the low MC bound</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="keywordflow">if</span> ( data &gt; 0 ) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        newmc *= beta;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        stat = newmc - data + data * std::log( data / newmc );</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="comment">// Now, MC stat penalty</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="comment">// The penalty from MC statistics using Conways approach (https://cds.cern.ch/record/1333496?)</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="keywordtype">double</span> penalty = 0;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="keywordflow">if</span> ( fractional &gt; 0 )  penalty = ( beta - 1 ) * ( beta - 1 ) / ( 2 * fractional2 );</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="comment">// Returns test-stat plus the MC stat penalty </span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <span class="keywordflow">return</span> stat+penalty;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">//KS: Alternative calculation of Barlow-Beeston following Hans Dembinski and Ahmed Abdelmottele arXiv:2206.12346v2</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">case</span> (<a class="code" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a7d4e059541c7ec9737f5c884cd6cd0f0">kDembinskiAbdelmotteleb</a>):</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="comment">//KS: code follows authors implementation from:</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <span class="comment">//https://github.com/scikit-hep/iminuit/blob/059d06b00cae097ebf340b218b4eb57357111df8/src/iminuit/cost.py#L274-L300</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="comment">// If there is no MC stat error for any reason, return Poisson LogL</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="keywordflow">if</span> ( w2 == 0 ) <span class="keywordflow">return</span> <a class="code" href="group__SampleHandlerGetters.html#gae5849766fbbc7aa71672da8b0f189fe5">GetPoissonLLH</a>(data,mc);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <span class="comment">// The MC can be changed</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordtype">double</span> newmc = mc;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="comment">// If MC falls below the low MC bound, use low MC bound for newmc</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="keywordflow">if</span> ( mc &lt; <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">if</span> ( data &gt; <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) newmc = <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( data &gt;= mc ) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="comment">//the so-called effective count</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> k = newmc * newmc / w2;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="comment">//Calculate beta which is scaling factor between true and generated MC</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> beta = ( data + k ) / ( newmc + k );</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      newmc *= beta;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="comment">// And penalise the movement in beta relative the mc uncertainty</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> penalty = k * beta - k + k * std::log( k / ( k * beta ) );</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="comment">// If there are no data, this shall return newmc</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="keywordtype">double</span> stat = newmc;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="comment">// All likelihood calculations may use the bare Poisson likelihood, so calculate here</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="comment">// Only if there are some data</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <span class="keywordflow">if</span> ( data &gt; 0 ) stat = newmc - data + data * std::log( data / newmc );</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="comment">// Return the statistical contribution and penalty</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keywordflow">return</span> stat+penalty;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">//CW: Also try the IceCube likelihood</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// It does not modify the MC content</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// https://arxiv.org/abs/1901.04645</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">// Argelles, C.A., Schneider, A. &amp; Yuan, T. J. High Energ. Phys. (2019) 2019: 30. https://doi.org/10.1007/JHEP06(2019)030</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// We essentially construct eq 3.16 and take the logarithm</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// in eq 3.16, mu is MC, sigma2 is w2, k is data</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">case</span> (<a class="code" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a5a1aedce85942661f297f503d606c472">kIceCube</a>):</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="comment">// IceCube low MC bound is implemented to return Poisson(data, _LOW_MC_BOUND_)</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <span class="comment">// up until the IceCube(data, mc) test-statistic is less than Poisson(data, _LOW_MC_BOUND_)</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="comment">// The 0 MC limit is set to Poisson(data, 0.) as there is no way to get a non-diverging and reasonable guess on w2</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="comment">// If there is 0 MC uncertainty (technically also when MC is 0) =&gt; Return Poisson(data, mc)</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="keywordflow">if</span> ( w2 == 0 ) <span class="keywordflow">return</span> <a class="code" href="group__SampleHandlerGetters.html#gae5849766fbbc7aa71672da8b0f189fe5">GetPoissonLLH</a>(data,mc);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="comment">// Auxiliary variables</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">double</span> b = mc / w2;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">double</span> a = mc * b + 1;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="comment">// Use C99&#39;s implementation of log of gamma function to not be C++11 dependent</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> stat = double( -1 * ( a * logl( b ) + lgammal( data + a ) - lgammal( data + 1 ) - ( ( data + a ) * log1pl( b ) ) - lgammal( a ) ) );</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="comment">// Check whether the stat is more than Poisson-like bound for low mc (mc &lt; data)</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="comment">// TN: I believe this might get some extra optimization</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordflow">if</span> ( mc &lt;= data ) {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">if</span> ( data &lt;= <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> poisson = <a class="code" href="group__SampleHandlerGetters.html#gae5849766fbbc7aa71672da8b0f189fe5">GetPoissonLLH</a>(data, <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a>);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">if</span> ( stat &gt; poisson ) <span class="keywordflow">return</span> poisson;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="comment">// Otherwise, return IceCube test-stat</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="keywordflow">return</span> stat;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">//KS: Pearson works on assumption that event distribution in each bin is described by a Gaussian which in our case is not fulfilled for all bins, hence use it at your own risk</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">case</span> (<a class="code" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a1ac0c03f07bf2bb9ad083e449d69ffd7">kPearson</a>):</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="comment">//KS: 2 is because this function returns -LLH not -2LLH</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="comment">// With no data return the MC/2.</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="keywordflow">if</span> ( data == 0 ) <span class="keywordflow">return</span> mc/2.;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="comment">// If MC is lower than the low MC bound, return the test-stat at the bound</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="keywordflow">if</span> ( mc &lt; <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordflow">if</span> ( data &gt; <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) <span class="keywordflow">return</span> ( data - <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) * ( data - <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) / ( 2. * <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ); </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( data &gt;= mc ) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="comment">// Return the Pearson metric</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="keywordflow">return</span> ( data - mc ) * ( data - mc ) / ( 2 * mc );</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">case</span> (<a class="code" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a82f43d91f1eda213c4b5c486672a32a5">kPoisson</a>):</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="comment">//Just call GetPoissonLLH which doesn&#39;t take in weights</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="comment">//and is a Poisson likelihood comparison.</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="group__SampleHandlerGetters.html#gae5849766fbbc7aa71672da8b0f189fe5">GetPoissonLLH</a>(data, mc);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a1459dbcc0f1b68b266cf0ddc37c34aee">TestStatistic::kNTestStatistics</a>:</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;kNTestStatistics is not a valid TestStatistic!&quot;</span>);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Couldn&#39;t find TestStatistic {} exiting!&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerBase.html#a87670dbcda5d09b09675e8f407fe3a30">fTestStatistic</a>));</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  } <span class="comment">// end switch</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;}</div>
<div class="ttc" id="aSampleStructs_8h_html_a960da89e33ac45a56f7bbfac3068dc67a1459dbcc0f1b68b266cf0ddc37c34aee"><div class="ttname"><a href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a1459dbcc0f1b68b266cf0ddc37c34aee">kNTestStatistics</a></div><div class="ttdeci">@ kNTestStatistics</div><div class="ttdoc">Number of test statistics.</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00119">SampleStructs.h:118</a></div></div>
<div class="ttc" id="aSampleStructs_8h_html_a960da89e33ac45a56f7bbfac3068dc67a1ac0c03f07bf2bb9ad083e449d69ffd7"><div class="ttname"><a href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a1ac0c03f07bf2bb9ad083e449d69ffd7">kPearson</a></div><div class="ttdeci">@ kPearson</div><div class="ttdoc">Standard Pearson likelihood .</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00116">SampleStructs.h:116</a></div></div>
<div class="ttc" id="aSampleStructs_8h_html_a960da89e33ac45a56f7bbfac3068dc67a3c9b50397bd37ce679bbdda14f6108c4"><div class="ttname"><a href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a3c9b50397bd37ce679bbdda14f6108c4">kBarlowBeeston</a></div><div class="ttdeci">@ kBarlowBeeston</div><div class="ttdoc">Barlow-Beeston () following Conway approximation ()</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00114">SampleStructs.h:114</a></div></div>
<div class="ttc" id="aSampleStructs_8h_html_a960da89e33ac45a56f7bbfac3068dc67a5a1aedce85942661f297f503d606c472"><div class="ttname"><a href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a5a1aedce85942661f297f503d606c472">kIceCube</a></div><div class="ttdeci">@ kIceCube</div><div class="ttdoc">Based on .</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00115">SampleStructs.h:115</a></div></div>
<div class="ttc" id="aSampleStructs_8h_html_a960da89e33ac45a56f7bbfac3068dc67a7d4e059541c7ec9737f5c884cd6cd0f0"><div class="ttname"><a href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a7d4e059541c7ec9737f5c884cd6cd0f0">kDembinskiAbdelmotteleb</a></div><div class="ttdeci">@ kDembinskiAbdelmotteleb</div><div class="ttdoc">Based on .</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00117">SampleStructs.h:117</a></div></div>
<div class="ttc" id="aSampleStructs_8h_html_a960da89e33ac45a56f7bbfac3068dc67a82f43d91f1eda213c4b5c486672a32a5"><div class="ttname"><a href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a82f43d91f1eda213c4b5c486672a32a5">kPoisson</a></div><div class="ttdeci">@ kPoisson</div><div class="ttdoc">Standard Poisson likelihood .</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00113">SampleStructs.h:113</a></div></div>
<div class="ttc" id="aclassSampleHandlerBase_html_a87670dbcda5d09b09675e8f407fe3a30"><div class="ttname"><a href="classSampleHandlerBase.html#a87670dbcda5d09b09675e8f407fe3a30">SampleHandlerBase::fTestStatistic</a></div><div class="ttdeci">TestStatistic fTestStatistic</div><div class="ttdoc">Test statistic tells what kind of likelihood sample is using.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00190">SampleHandlerBase.h:190</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_gae5849766fbbc7aa71672da8b0f189fe5"><div class="ttname"><a href="group__SampleHandlerGetters.html#gae5849766fbbc7aa71672da8b0f189fe5">SampleHandlerBase::GetPoissonLLH</a></div><div class="ttdeci">double GetPoissonLLH(const double data, const double mc) const</div><div class="ttdoc">Calculate test statistic for a single bin using Poisson.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8cpp_source.html#l00018">SampleHandlerBase.cpp:18</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga97d4dfa8ea998240fab6c09786c5b7c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga97d4dfa8ea998240fab6c09786c5b7c1">&#9670;&nbsp;</a></span>GetTitle() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::string SampleHandlerBase::GetTitle </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented in <a class="el" href="group__SampleHandlerGetters.html#ga80a62c0759d4df18e8d641a3cbceea46">SampleHandlerFD</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8h_source.html#l00042">42</a> of file <a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;{<span class="keywordflow">return</span> <span class="stringliteral">&quot;SampleHandler&quot;</span>;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga80a62c0759d4df18e8d641a3cbceea46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga80a62c0759d4df18e8d641a3cbceea46">&#9670;&nbsp;</a></span>GetTitle() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::GetTitle </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="group__SampleHandlerGetters.html#ga97d4dfa8ea998240fab6c09786c5b7c1">SampleHandlerBase</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00035">35</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a1cada8a34d03db4ffe9dd170036c6ce1">SampleDetails</a>.<a class="code" href="structSampleInfo.html#aa08cf57ea6717add258666f4966cde6d">SampleTitle</a>;}</div>
<div class="ttc" id="astructSampleInfo_html_aa08cf57ea6717add258666f4966cde6d"><div class="ttname"><a href="structSampleInfo.html#aa08cf57ea6717add258666f4966cde6d">SampleInfo::SampleTitle</a></div><div class="ttdeci">std::string SampleTitle</div><div class="ttdoc">the name of this sample e.g.&quot;muon-like&quot;</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00058">FarDetectorCoreInfoStruct.h:58</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gaa9c7e72a888eb224f9d045f718944243"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa9c7e72a888eb224f9d045f718944243">&#9670;&nbsp;</a></span>GetW2Hist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TH1 * SampleHandlerFD::GetW2Hist </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Dimension</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get W2 histogram. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l00996">996</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                                                   {</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="keywordflow">if</span>(Dimension == 1) {</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    TH1D* W2Hist = <span class="keyword">dynamic_cast&lt;</span>TH1D*<span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerFD.html#a1cada8a34d03db4ffe9dd170036c6ce1">SampleDetails</a>.<a class="code" href="structSampleInfo.html#a164184cba17531aeb71fa507cb44f9ab">_hPDF1D</a>-&gt;Clone((<a class="code" href="classSampleHandlerFD.html#a1cada8a34d03db4ffe9dd170036c6ce1">SampleDetails</a>.<a class="code" href="structSampleInfo.html#a164184cba17531aeb71fa507cb44f9ab">_hPDF1D</a>-&gt;GetName() + std::string(<span class="stringliteral">&quot;_W2&quot;</span>)).c_str()));</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordflow">if</span> (!W2Hist) {</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Failed to cast&quot;</span>);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    }</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    W2Hist-&gt;Reset();</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> yBin = 0; yBin &lt; <a class="code" href="classSampleHandlerFD.html#a18efb1f51f72f1b131e3889a8b50c353">Binning</a>.<a class="code" href="structSampleBinningInfo.html#a6fde8c8353eceaccfca0bfece5094ead">nYBins</a>; ++yBin) {</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> xBin = 0; xBin &lt; <a class="code" href="classSampleHandlerFD.html#a18efb1f51f72f1b131e3889a8b50c353">Binning</a>.<a class="code" href="structSampleBinningInfo.html#a6db26440b230c9c3ded5882135393422">nXBins</a>; ++xBin) {</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> idx = <a class="code" href="classSampleHandlerFD.html#a18efb1f51f72f1b131e3889a8b50c353">Binning</a>.<a class="code" href="structSampleBinningInfo.html#acd4cf8f183e39211d090b69687213de8">GetBinSafe</a>(xBin, yBin);</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        W2Hist-&gt;AddBinContent(idx + 1, <a class="code" href="classSampleHandlerFD.html#af5c6a3701c6ac76a96886ff13300a53b">SampleHandlerFD_array_w2</a>[idx]);</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      }</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    }</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <span class="keywordflow">return</span> W2Hist;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(Dimension == 2) {</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    TH2D* W2Hist = <span class="keyword">dynamic_cast&lt;</span>TH2D*<span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerFD.html#a1cada8a34d03db4ffe9dd170036c6ce1">SampleDetails</a>.<a class="code" href="structSampleInfo.html#a34cf26cf1fa2cfb5c20c34968abbb551">_hPDF2D</a>-&gt;Clone((<a class="code" href="classSampleHandlerFD.html#a1cada8a34d03db4ffe9dd170036c6ce1">SampleDetails</a>.<a class="code" href="structSampleInfo.html#a34cf26cf1fa2cfb5c20c34968abbb551">_hPDF2D</a>-&gt;GetName() + std::string(<span class="stringliteral">&quot;_W2&quot;</span>)).c_str()));</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <span class="keywordflow">if</span> (!W2Hist) {</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Failed to cast&quot;</span>);</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    }</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    W2Hist-&gt;Reset();</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> yBin = 0; yBin &lt; <a class="code" href="classSampleHandlerFD.html#a18efb1f51f72f1b131e3889a8b50c353">Binning</a>.<a class="code" href="structSampleBinningInfo.html#a6fde8c8353eceaccfca0bfece5094ead">nYBins</a>; ++yBin) {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> xBin = 0; xBin &lt; <a class="code" href="classSampleHandlerFD.html#a18efb1f51f72f1b131e3889a8b50c353">Binning</a>.<a class="code" href="structSampleBinningInfo.html#a6db26440b230c9c3ded5882135393422">nXBins</a>; ++xBin) {</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> idx = <a class="code" href="classSampleHandlerFD.html#a18efb1f51f72f1b131e3889a8b50c353">Binning</a>.<a class="code" href="structSampleBinningInfo.html#acd4cf8f183e39211d090b69687213de8">GetBinSafe</a>(xBin, yBin);</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        W2Hist-&gt;SetBinContent(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(xBin + 1), <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(yBin + 1), <a class="code" href="classSampleHandlerFD.html#af5c6a3701c6ac76a96886ff13300a53b">SampleHandlerFD_array_w2</a>[idx]);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;      }</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    }</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="keywordflow">return</span> W2Hist;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  } <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Asking for {} with N Dimension = {}. This is not implemented&quot;</span>, __func__, Dimension);</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  }</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_a18efb1f51f72f1b131e3889a8b50c353"><div class="ttname"><a href="classSampleHandlerFD.html#a18efb1f51f72f1b131e3889a8b50c353">SampleHandlerFD::Binning</a></div><div class="ttdeci">SampleBinningInfo Binning</div><div class="ttdoc">KS: This stores binning information, in future could be come vector to store binning for every used s...</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00305">SampleHandlerFD.h:305</a></div></div>
<div class="ttc" id="aclassSampleHandlerFD_html_af5c6a3701c6ac76a96886ff13300a53b"><div class="ttname"><a href="classSampleHandlerFD.html#af5c6a3701c6ac76a96886ff13300a53b">SampleHandlerFD::SampleHandlerFD_array_w2</a></div><div class="ttdeci">double * SampleHandlerFD_array_w2</div><div class="ttdoc">KS Array used for MC stat.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00310">SampleHandlerFD.h:310</a></div></div>
<div class="ttc" id="astructSampleBinningInfo_html_a6db26440b230c9c3ded5882135393422"><div class="ttname"><a href="structSampleBinningInfo.html#a6db26440b230c9c3ded5882135393422">SampleBinningInfo::nXBins</a></div><div class="ttdeci">size_t nXBins</div><div class="ttdoc">Number of X axis bins in the histogram used for likelihood calculation.</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00191">SampleStructs.h:191</a></div></div>
<div class="ttc" id="astructSampleBinningInfo_html_a6fde8c8353eceaccfca0bfece5094ead"><div class="ttname"><a href="structSampleBinningInfo.html#a6fde8c8353eceaccfca0bfece5094ead">SampleBinningInfo::nYBins</a></div><div class="ttdeci">size_t nYBins</div><div class="ttdoc">Number of Y axis bins in the histogram used for likelihood calculation.</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00193">SampleStructs.h:193</a></div></div>
<div class="ttc" id="astructSampleBinningInfo_html_acd4cf8f183e39211d090b69687213de8"><div class="ttname"><a href="structSampleBinningInfo.html#acd4cf8f183e39211d090b69687213de8">SampleBinningInfo::GetBinSafe</a></div><div class="ttdeci">int GetBinSafe(const int xBin, const int yBin) const</div><div class="ttdoc">Get linear bin index from 2D bin indices with additional checks.</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00214">SampleStructs.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga1e1ef726c2c67cc3f8bb93b0ef9989fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1e1ef726c2c67cc3f8bb93b0ef9989fa">&#9670;&nbsp;</a></span>GetXBinVarName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::GetXBinVarName </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00038">38</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a1cada8a34d03db4ffe9dd170036c6ce1">SampleDetails</a>.<a class="code" href="structSampleInfo.html#a94ef862377431975710a3ca0c761b01c">XVarStr</a>;}</div>
<div class="ttc" id="astructSampleInfo_html_a94ef862377431975710a3ca0c761b01c"><div class="ttname"><a href="structSampleInfo.html#a94ef862377431975710a3ca0c761b01c">SampleInfo::XVarStr</a></div><div class="ttdeci">std::string XVarStr</div><div class="ttdoc">the strings associated with the variables used for the X binning e.g. &quot;RecoNeutrinoEnergy&quot;</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00053">FarDetectorCoreInfoStruct.h:53</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga20478b6d0ab397e3d1b87ef466a81e13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga20478b6d0ab397e3d1b87ef466a81e13">&#9670;&nbsp;</a></span>GetYBinVarName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::GetYBinVarName </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00040">40</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#a1cada8a34d03db4ffe9dd170036c6ce1">SampleDetails</a>.<a class="code" href="structSampleInfo.html#ad2989f69823dbac9c39edabc4e034340">YVarStr</a>;}</div>
<div class="ttc" id="astructSampleInfo_html_ad2989f69823dbac9c39edabc4e034340"><div class="ttname"><a href="structSampleInfo.html#ad2989f69823dbac9c39edabc4e034340">SampleInfo::YVarStr</a></div><div class="ttdeci">std::string YVarStr</div><div class="ttdoc">the strings associated with the variables used for the Y binning e.g. &quot;RecoNeutrinoEnergy&quot;</div><div class="ttdef"><b>Definition:</b> <a href="FarDetectorCoreInfoStruct_8h_source.html#l00055">FarDetectorCoreInfoStruct.h:55</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gac7f3dd7b022e7c0714ab12db1184eb47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac7f3dd7b022e7c0714ab12db1184eb47">&#9670;&nbsp;</a></span>ReturnHistsBySelection1D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; TH1 * &gt; SampleHandlerFD::ReturnHistsBySelection1D </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>KinematicProjection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Selection1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Selection2</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>Axis</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01970">1970</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;                                                                                                                                                      {</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;  std::vector&lt;TH1*&gt; hHistList;</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;  std::string legendEntry;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160; </div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">THStackLeg</a> != <span class="keyword">nullptr</span>) {<span class="keyword">delete</span> <a class="code" href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">THStackLeg</a>;}</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;  <a class="code" href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">THStackLeg</a> = <span class="keyword">new</span> TLegend(0.1,0.1,0.9,0.9);</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160; </div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;  <span class="keywordtype">int</span> iMax = -1;</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;  <span class="keywordflow">if</span> (Selection1 == FDPlotType::kModePlot) {</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    iMax = <a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetNModes();</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;  }</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;  <span class="keywordflow">if</span> (Selection1 == FDPlotType::kOscChannelPlot) {</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    iMax = <a class="code" href="group__SampleHandlerGetters.html#gaa619e7779b3faa873dc418da07112a12">GetNOscChannels</a>();</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;  }</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;  <span class="keywordflow">if</span> (iMax == -1) {</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;You&#39;ve passed me a Selection1 which was not implemented in ReturnHistsBySelection1D. Selection1 and Selection2 are counters for different indexable quantities&quot;</span>);</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;  }</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160; </div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;iMax;i++) {</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    <span class="keywordflow">if</span> (Selection1 == FDPlotType::kModePlot) {</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;      hHistList.push_back(<a class="code" href="group__SampleHandlerGetters.html#gaac0dad7d2090250cf8094eb8ceaab932">Get1DVarHistByModeAndChannel</a>(KinematicProjection,i,Selection2,WeightStyle,XAxis));</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;      <a class="code" href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">THStackLeg</a>-&gt;AddEntry(hHistList[i],(<a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetMaCh3ModeName(i)+Form(<span class="stringliteral">&quot; : (%4.2f)&quot;</span>,hHistList[i]-&gt;Integral())).c_str(),<span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160; </div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;      hHistList[i]-&gt;SetFillColor(<span class="keyword">static_cast&lt;</span>Color_t<span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetMaCh3ModePlotColor(i)));</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;      hHistList[i]-&gt;SetLineColor(<span class="keyword">static_cast&lt;</span>Color_t<span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetMaCh3ModePlotColor(i)));</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    }</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    <span class="keywordflow">if</span> (Selection1 == FDPlotType::kOscChannelPlot) {</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;      hHistList.push_back(<a class="code" href="group__SampleHandlerGetters.html#gaac0dad7d2090250cf8094eb8ceaab932">Get1DVarHistByModeAndChannel</a>(KinematicProjection,Selection2,i,WeightStyle,XAxis));</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;      <a class="code" href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">THStackLeg</a>-&gt;AddEntry(hHistList[i],(<a class="code" href="group__SampleHandlerGetters.html#ga9eb3d4a487ed877beb252738b9de9443">GetFlavourName</a>(i)+Form(<span class="stringliteral">&quot; | %4.2f&quot;</span>,hHistList[i]-&gt;Integral())).c_str(),<span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    }</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;  }</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160; </div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;  <span class="keywordflow">return</span> hHistList;</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_af60df24f4eb7954a3297c9841c60624b"><div class="ttname"><a href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">SampleHandlerFD::THStackLeg</a></div><div class="ttdeci">TLegend * THStackLeg</div><div class="ttdoc">DB Miscellaneous Variables.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00374">SampleHandlerFD.h:374</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_ga9eb3d4a487ed877beb252738b9de9443"><div class="ttname"><a href="group__SampleHandlerGetters.html#ga9eb3d4a487ed877beb252738b9de9443">SampleHandlerFD::GetFlavourName</a></div><div class="ttdeci">std::string GetFlavourName(const int iChannel)</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00083">SampleHandlerFD.h:83</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga7aa8723e32e056e1247341d41378ab60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7aa8723e32e056e1247341d41378ab60">&#9670;&nbsp;</a></span>ReturnHistsBySelection2D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; TH2 * &gt; SampleHandlerFD::ReturnHistsBySelection2D </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>KinematicProjectionX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>KinematicProjectionY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Selection1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Selection2</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>XAxis</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>YAxis</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l02006">2006</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;                                                                                        {</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;  std::vector&lt;TH2*&gt; hHistList;</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160; </div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;  <span class="keywordtype">int</span> iMax = -1;</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;  <span class="keywordflow">if</span> (Selection1 == FDPlotType::kModePlot) {</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    iMax = <a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>-&gt;GetNModes();</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;  }</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;  <span class="keywordflow">if</span> (Selection1 == FDPlotType::kOscChannelPlot) {</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    iMax = <a class="code" href="group__SampleHandlerGetters.html#gaa619e7779b3faa873dc418da07112a12">GetNOscChannels</a>();</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;  }</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;  <span class="keywordflow">if</span> (iMax == -1) {</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;You&#39;ve passed me a Selection1 which was not implemented in ReturnHistsBySelection1D. Selection1 and Selection2 are counters for different indexable quantities&quot;</span>);</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;  }</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160; </div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;iMax;i++) {</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;    <span class="keywordflow">if</span> (Selection1 == FDPlotType::kModePlot) {</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;      hHistList.push_back(<a class="code" href="group__SampleHandlerGetters.html#gaa78d7bcfe9377cb7d47d596b39eda84c">Get2DVarHistByModeAndChannel</a>(KinematicProjectionX,KinematicProjectionY,i,Selection2,WeightStyle,XAxis,YAxis));</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    }</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    <span class="keywordflow">if</span> (Selection1 == FDPlotType::kOscChannelPlot) {</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;      hHistList.push_back(<a class="code" href="group__SampleHandlerGetters.html#gaa78d7bcfe9377cb7d47d596b39eda84c">Get2DVarHistByModeAndChannel</a>(KinematicProjectionX,KinematicProjectionY,Selection2,i,WeightStyle,XAxis,YAxis));</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    }</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;  }</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160; </div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;  <span class="keywordflow">return</span> hHistList;</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="gae2769d593f34e8356b545af076818f89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae2769d593f34e8356b545af076818f89">&#9670;&nbsp;</a></span>ReturnKinematicParameterFromString()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SampleHandlerFD::ReturnKinematicParameterFromString </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>KinematicStr</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ETA function to generically convert a string from xsec cov to a kinematic type. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01627">1627</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                                                                                                    {</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;  <span class="keyword">auto</span> it = <a class="code" href="classSampleHandlerFD.html#aae37732e76f0b17b6f124bd5543177e4">KinematicParameters</a>-&gt;find(KinematicParameterStr);</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  <span class="keywordflow">if</span> (it != <a class="code" href="classSampleHandlerFD.html#aae37732e76f0b17b6f124bd5543177e4">KinematicParameters</a>-&gt;end()) <span class="keywordflow">return</span> it-&gt;second;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160; </div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Did not recognise Kinematic Parameter type: {}&quot;</span>, KinematicParameterStr);</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;  <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160; </div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a>;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_aae37732e76f0b17b6f124bd5543177e4"><div class="ttname"><a href="classSampleHandlerFD.html#aae37732e76f0b17b6f124bd5543177e4">SampleHandlerFD::KinematicParameters</a></div><div class="ttdeci">const std::unordered_map&lt; std::string, int &gt; * KinematicParameters</div><div class="ttdoc">Mapping between string and kinematic enum.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00349">SampleHandlerFD.h:349</a></div></div>
<div class="ttc" id="anamespaceM3_html_ac289df32a5b3b05c61a87cbac5702b25"><div class="ttname"><a href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a></div><div class="ttdeci">constexpr static const int _BAD_INT_</div><div class="ttdoc">Default value used for int initialisation.</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00048">Core.h:48</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gafab4fb4f384c540493af65a3efa55287"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafab4fb4f384c540493af65a3efa55287">&#9670;&nbsp;</a></span>ReturnStackedHistBySelection1D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">THStack * SampleHandlerFD::ReturnStackedHistBySelection1D </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>KinematicProjection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Selection1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Selection2</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>Axis</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l02036">2036</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;                                                                                                                                                     {</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;  std::vector&lt;TH1*&gt; HistList = <a class="code" href="group__SampleHandlerGetters.html#gac7f3dd7b022e7c0714ab12db1184eb47">ReturnHistsBySelection1D</a>(KinematicProjection, Selection1, Selection2, WeightStyle, XAxis);</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;  THStack* StackHist = <span class="keyword">new</span> THStack((<a class="code" href="group__SampleHandlerGetters.html#ga80a62c0759d4df18e8d641a3cbceea46">GetTitle</a>()+<span class="stringliteral">&quot;_&quot;</span>+KinematicProjection+<span class="stringliteral">&quot;_Stack&quot;</span>).c_str(),<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;HistList.size();i++) {</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    StackHist-&gt;Add(HistList[i]);</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;  }</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;  <span class="keywordflow">return</span> StackHist;</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;}</div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_ga80a62c0759d4df18e8d641a3cbceea46"><div class="ttname"><a href="group__SampleHandlerGetters.html#ga80a62c0759d4df18e8d641a3cbceea46">SampleHandlerFD::GetTitle</a></div><div class="ttdeci">std::string GetTitle() const override</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00035">SampleHandlerFD.h:35</a></div></div>
<div class="ttc" id="agroup__SampleHandlerGetters_html_gac7f3dd7b022e7c0714ab12db1184eb47"><div class="ttname"><a href="group__SampleHandlerGetters.html#gac7f3dd7b022e7c0714ab12db1184eb47">SampleHandlerFD::ReturnHistsBySelection1D</a></div><div class="ttdeci">std::vector&lt; TH1 * &gt; ReturnHistsBySelection1D(std::string KinematicProjection, int Selection1, int Selection2=-1, int WeightStyle=0, TAxis *Axis=0)</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8cpp_source.html#l01970">SampleHandlerFD.cpp:1970</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga8be73835c2d9f0e50d738c4f204a0286"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8be73835c2d9f0e50d738c4f204a0286">&#9670;&nbsp;</a></span>ReturnStackHistLegend()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TLegend* SampleHandlerFD::ReturnStackHistLegend </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8h_source.html#l00126">126</a> of file <a class="el" href="SampleHandlerFD_8h_source.html">SampleHandlerFD.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="classSampleHandlerFD.html#af60df24f4eb7954a3297c9841c60624b">THStackLeg</a>;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga3e88e3720a6a8d3384a6b8d317795c74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3e88e3720a6a8d3384a6b8d317795c74">&#9670;&nbsp;</a></span>ReturnStringFromKinematicParameter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleHandlerFD::ReturnStringFromKinematicParameter </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>KinematicVariable</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ETA function to generically convert a kinematic type from xsec cov to a string. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerFD_8cpp_source.html#l01639">1639</a> of file <a class="el" href="SampleHandlerFD_8cpp_source.html">SampleHandlerFD.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                                                                                                {</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;<span class="comment">// ************************************************</span></div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;  <span class="keyword">auto</span> it = <a class="code" href="classSampleHandlerFD.html#ad7ac675cc4ce81bec42e0700f1ff2620">ReversedKinematicParameters</a>-&gt;find(KinematicParameter);</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;  <span class="keywordflow">if</span> (it != <a class="code" href="classSampleHandlerFD.html#ad7ac675cc4ce81bec42e0700f1ff2620">ReversedKinematicParameters</a>-&gt;end()) {</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    <span class="keywordflow">return</span> it-&gt;second;</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  }</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160; </div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Did not recognise Kinematic Parameter type: {}&quot;</span>, KinematicParameter);</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;  <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160; </div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;  <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerFD_html_ad7ac675cc4ce81bec42e0700f1ff2620"><div class="ttname"><a href="classSampleHandlerFD.html#ad7ac675cc4ce81bec42e0700f1ff2620">SampleHandlerFD::ReversedKinematicParameters</a></div><div class="ttdeci">const std::unordered_map&lt; int, std::string &gt; * ReversedKinematicParameters</div><div class="ttdoc">Mapping between kinematic enum and string.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerFD_8h_source.html#l00351">SampleHandlerFD.h:351</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga1c81b6b7a7e70b04c6c6ca1c81c70fc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1c81b6b7a7e70b04c6c6ca1c81c70fc5">&#9670;&nbsp;</a></span>SetTestStatistic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerBase::SetTestStatistic </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67">TestStatistic</a>&#160;</td>
          <td class="paramname"><em>testStat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the test statistic to be used when calculating the binned likelihoods. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">testStat</td><td>The test statistic to use. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8h_source.html#l00172">172</a> of file <a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;{ <a class="code" href="classSampleHandlerBase.html#a87670dbcda5d09b09675e8f407fe3a30">fTestStatistic</a> = testStat; }</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- Footer for MaCh3 Doxygen documentation -->
<footer class="mach3-footer" style="text-align: center;">
    <div style="margin-bottom: 15px;">
        <span style="font-weight: bold;">The MaCh3 Collaboration</span>
    </div>
    <!-- Dropdown to jump between doc versions -->
    <div style="margin-bottom: 10px;">
        <span>Select Software Version: </span>
        <select id="versionSelector" onchange="window.location.href=this.value" style="padding: 5px; border-radius: 4px; border: 1px solid #ccc;">
            <option value="">-- Select --</option>
            <option value="https://mach3-software.github.io/MaCh3/">develop</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.2.0/index.html">v2.2.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.1.0/index.html">v2.1.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.0.0/index.html">v2.0.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.5.0/index.html">v1.5.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.4.0/index.html">v1.4.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.3.0/index.html">v1.3.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.2.0/index.html">v1.2.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.1.0/index.html">v1.1.0</option>
        </select>
    </div>
    <!-- Footer info about doxygen -->
    <div style="font-size: 0.9em; color: #666; margin-top: 10px;">
        Documentation generated with
        <a href="https://www.doxygen.nl/" target="_blank" style="color: #666;">Doxygen</a>
        <span id="doxygenVersion"></span>
    </div>
    <!-- Now grab doxygen version from metadata -->
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        const meta = document.querySelector('meta[name="generator"]');
        if (meta) {
            const version = meta.getAttribute("content").replace("Doxygen ", "");
            document.getElementById("doxygenVersion").textContent = " " + version;
        }
    });
    </script>
</footer>
