<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MaCh3: /hosthome/v1.3.0/covariance/covarianceXsec.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="MaCh3.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mach3logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MaCh3
   &#160;<span id="projectnumber">1.3.0</span>
   </div>
   <div id="projectbrief">Reference Guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_abce92e5f6d3eeff39dff8d05ee3c623.html">hosthome</a></li><li class="navelem"><a class="el" href="dir_5ab5eba0c405d3ed5eb62f1d7d3f1ee1.html">v1.3.0</a></li><li class="navelem"><a class="el" href="dir_5e61c8788336254b78c1214509e78ee9.html">covariance</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">covarianceXsec.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="covarianceXsec_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="covarianceXsec_8h.html">covariance/covarianceXsec.h</a>&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Structs_8h.html">samplePDF/Structs.h</a>&quot;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// ETA - YAML constructor</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// this will replace the root file constructor but let&#39;s keep it in</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// to do some validations</span></div>
<div class="line"><a name="l00008"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#a2e6c281c3f7f902076043ca9776b241d">    8</a></span>&#160;<a class="code" href="classcovarianceXsec.html#a2e6c281c3f7f902076043ca9776b241d">covarianceXsec::covarianceXsec</a>(<span class="keyword">const</span> std::vector&lt;std::string&gt;&amp; YAMLFile, std::string name, <span class="keywordtype">double</span> threshold, <span class="keywordtype">int</span> FirstPCA, <span class="keywordtype">int</span> LastPCA)</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;               : <a class="code" href="classcovarianceBase.html">covarianceBase</a>(YAMLFile, name, threshold, FirstPCA, LastPCA){</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  <a class="code" href="classcovarianceXsec.html#a90bd7a32f16efc88c070e57fabafd13b">InitXsecFromConfig</a>();</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  <span class="comment">//ETA - again this really doesn&#39;t need to be hear...</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; i++)</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  {</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="comment">// Sort out the print length</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="keywordflow">if</span>(<span class="keywordtype">int</span>(<a class="code" href="classcovarianceBase.html#a3e502d80fd2c30a7da4fe75a3e05b0da">_fNames</a>[i].length()) &gt; <a class="code" href="classcovarianceBase.html#a8d821ce805f2426fe95549170866821f">PrintLength</a>) <a class="code" href="classcovarianceBase.html#a8d821ce805f2426fe95549170866821f">PrintLength</a> = int(<a class="code" href="classcovarianceBase.html#a3e502d80fd2c30a7da4fe75a3e05b0da">_fNames</a>[i].length());</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  } <span class="comment">// end the for loop</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a>(<span class="stringliteral">&quot;Constructing instance of covarianceXsec&quot;</span>);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <a class="code" href="classcovarianceXsec.html#aea65a8b1ad6399f0b9f356810249bfd1">initParams</a>();</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="comment">// Print</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <a class="code" href="classcovarianceXsec.html#ade0e8f83dcf75c50e6dad08ab6715093">Print</a>();</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;}</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#a90bd7a32f16efc88c070e57fabafd13b">   27</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcovarianceXsec.html#a90bd7a32f16efc88c070e57fabafd13b">covarianceXsec::InitXsecFromConfig</a>() {</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <a class="code" href="classcovarianceXsec.html#adddfbaa235113603542826df331ed61e">_fSystToGlobalSystIndexMap</a>.resize(<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa32e7da18117f9defb24042a71776e5cb">SystType::kSystTypes</a>);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <a class="code" href="classcovarianceXsec.html#a183f01056fc0e9b42db202e944021332">_fDetID</a> = std::vector&lt;int&gt;(<a class="code" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <a class="code" href="classcovarianceXsec.html#aae3338ca71027adab7fdfd3e828c0f79">_fParamType</a> = std::vector&lt;SystType&gt;(<a class="code" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="classcovarianceXsec.html#a47cd1802e0dac0c22c8c16f214272c34">_ParameterGroup</a> = std::vector&lt;std::string&gt;(<a class="code" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="comment">//KS: We know at most how params we expect so reserve memory for max possible params. Later we will shrink to size to not waste memory. Reserving means slightly faster loading and possible less memory fragmentation.</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>.reserve(<a class="code" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <a class="code" href="classcovarianceXsec.html#ae95bafab0c674dc838635aaeca40bc2c">SplineParams</a>.reserve(<a class="code" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ParamCounter[<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa32e7da18117f9defb24042a71776e5cb">SystType::kSystTypes</a>] = {0};</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="comment">//ETA - read in the systematics. Would be good to add in some checks to make sure</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="comment">//that there are the correct number of entries i.e. are the _fNumPars for Names,</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="comment">//PreFitValues etc etc.</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> &amp;param : <a class="code" href="classcovarianceBase.html#a933ff3dc0af99629ba3582a5d9d89d23">_fYAMLDoc</a>[<span class="stringliteral">&quot;Systematics&quot;</span>])</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="classcovarianceXsec.html#a183f01056fc0e9b42db202e944021332">_fDetID</a>[i] = (param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;DetID&quot;</span>].as&lt;<span class="keywordtype">int</span>&gt;());</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="classcovarianceXsec.html#a47cd1802e0dac0c22c8c16f214272c34">_ParameterGroup</a>[i] = (param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;ParameterGroup&quot;</span>].as&lt;std::string&gt;());</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">//Fill the map to get the correlations later as well</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    std::string ParamType = param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;Type&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">//Now load in variables for spline systematics only</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">if</span> (ParamType.find(<a class="code" href="Structs_8h.html#ad39c312dc44177340e2ebccd3d3f2d4c">SystType_ToString</a>(<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa29d6ccf6cf507f6e66c72b1d3c2aed00">SystType::kSpline</a>)) != std::string::npos)</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <span class="comment">//Set param type</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <a class="code" href="classcovarianceXsec.html#aae3338ca71027adab7fdfd3e828c0f79">_fParamType</a>[i] = <a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa29d6ccf6cf507f6e66c72b1d3c2aed00">SystType::kSpline</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="comment">// Fill Spline info</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <a class="code" href="classcovarianceXsec.html#ae95bafab0c674dc838635aaeca40bc2c">SplineParams</a>.push_back(<a class="code" href="classcovarianceXsec.html#acf3b87f72369d597d27d2a32fc01e779">GetXsecSpline</a>(param[<span class="stringliteral">&quot;Systematic&quot;</span>]));</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keywordflow">if</span> (param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;SplineInformation&quot;</span>][<span class="stringliteral">&quot;SplineName&quot;</span>]) {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <a class="code" href="classcovarianceXsec.html#a4d3074db3c9edb7465a4409abd9c91fc">_fSplineNames</a>.push_back(param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;SplineInformation&quot;</span>][<span class="stringliteral">&quot;SplineName&quot;</span>].as&lt;std::string&gt;());</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="comment">//Insert the mapping from the spline index i.e. the length of _fSplineNames etc</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="comment">//to the Systematic index i.e. the counter for things like _fDetID and _fDetID</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <a class="code" href="classcovarianceXsec.html#adddfbaa235113603542826df331ed61e">_fSystToGlobalSystIndexMap</a>[<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa29d6ccf6cf507f6e66c72b1d3c2aed00">SystType::kSpline</a>].insert(std::make_pair(ParamCounter[<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa29d6ccf6cf507f6e66c72b1d3c2aed00">SystType::kSpline</a>], i));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      ParamCounter[<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa29d6ccf6cf507f6e66c72b1d3c2aed00">SystType::kSpline</a>]++;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;Type&quot;</span>].as&lt;std::string&gt;() == <a class="code" href="Structs_8h.html#ad39c312dc44177340e2ebccd3d3f2d4c">SystType_ToString</a>(<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa085cb29127b1cf7b1ddd429ff4440b17">SystType::kNorm</a>)) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <a class="code" href="classcovarianceXsec.html#aae3338ca71027adab7fdfd3e828c0f79">_fParamType</a>[i] = <a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa085cb29127b1cf7b1ddd429ff4440b17">SystType::kNorm</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>.push_back(<a class="code" href="classcovarianceXsec.html#a68938d9079d05782eb1f415a5204284c">GetXsecNorm</a>(param[<span class="stringliteral">&quot;Systematic&quot;</span>], i));</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <a class="code" href="classcovarianceXsec.html#adddfbaa235113603542826df331ed61e">_fSystToGlobalSystIndexMap</a>[<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa085cb29127b1cf7b1ddd429ff4440b17">SystType::kNorm</a>].insert(std::make_pair(ParamCounter[<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa085cb29127b1cf7b1ddd429ff4440b17">SystType::kNorm</a>], i));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      ParamCounter[<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa085cb29127b1cf7b1ddd429ff4440b17">SystType::kNorm</a>]++;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;Type&quot;</span>].as&lt;std::string&gt;() == <a class="code" href="Structs_8h.html#ad39c312dc44177340e2ebccd3d3f2d4c">SystType_ToString</a>(<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fad9b1ac76e80f59684cfb7dc996fc870d">SystType::kFunc</a>)){</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <a class="code" href="classcovarianceXsec.html#aae3338ca71027adab7fdfd3e828c0f79">_fParamType</a>[i] = <a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fad9b1ac76e80f59684cfb7dc996fc870d">SystType::kFunc</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <a class="code" href="classcovarianceXsec.html#adddfbaa235113603542826df331ed61e">_fSystToGlobalSystIndexMap</a>[<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fad9b1ac76e80f59684cfb7dc996fc870d">SystType::kFunc</a>].insert(std::make_pair(ParamCounter[<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fad9b1ac76e80f59684cfb7dc996fc870d">SystType::kFunc</a>], i));</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      ParamCounter[<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fad9b1ac76e80f59684cfb7dc996fc870d">SystType::kFunc</a>]++;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Given unrecognised systematic type: {}&quot;</span>, param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;Type&quot;</span>].as&lt;std::string&gt;());</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      std::string expectedTypes = <span class="stringliteral">&quot;Expecting &quot;</span>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s = 0; s &lt; <a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa32e7da18117f9defb24042a71776e5cb">SystType::kSystTypes</a>; ++s) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">if</span> (s &gt; 0) expectedTypes += <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        expectedTypes += <a class="code" href="Structs_8h.html#ad39c312dc44177340e2ebccd3d3f2d4c">SystType_ToString</a>(<span class="keyword">static_cast&lt;</span><a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2f">SystType</a><span class="keyword">&gt;</span>(s)) + <span class="stringliteral">&quot;\&quot;&quot;</span>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      expectedTypes += <span class="stringliteral">&quot;.&quot;</span>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(expectedTypes);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    i++;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="comment">//Add a sanity check,</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classcovarianceXsec.html#a4d3074db3c9edb7465a4409abd9c91fc">_fSplineNames</a>.size() != ParamCounter[<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa29d6ccf6cf507f6e66c72b1d3c2aed00">SystType::kSpline</a>]){</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;_fSplineNames is of size {} but found {} spline parameters&quot;</span>, <a class="code" href="classcovarianceXsec.html#a4d3074db3c9edb7465a4409abd9c91fc">_fSplineNames</a>.size(), ParamCounter[<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa29d6ccf6cf507f6e66c72b1d3c2aed00">SystType::kSpline</a>]);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">//KS We resized them above to all params to fight memory fragmentation, now let&#39;s resize to fit only allocated memory to save RAM</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>.shrink_to_fit();</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <a class="code" href="classcovarianceXsec.html#ae95bafab0c674dc838635aaeca40bc2c">SplineParams</a>.shrink_to_fit();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;}</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#af84383b735f450c33c9c34f7ca207a66">  105</a></span>&#160;<a class="code" href="classcovarianceXsec.html#af84383b735f450c33c9c34f7ca207a66">covarianceXsec::~covarianceXsec</a>() {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a>(<span class="stringliteral">&quot;Deleting covarianceXsec&quot;</span>);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;}</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">// DB Grab the Spline Names for the relevant DetID</span></div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#a7678bbdb59c36f032fb414d62928f47e">  112</a></span>&#160;<span class="keyword">const</span> std::vector&lt;std::string&gt; <a class="code" href="classcovarianceXsec.html#a7678bbdb59c36f032fb414d62928f47e">covarianceXsec::GetSplineParsNamesFromDetID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> DetID) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  std::vector&lt;std::string&gt; returnVec;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;pair : <a class="code" href="classcovarianceXsec.html#adddfbaa235113603542826df331ed61e">_fSystToGlobalSystIndexMap</a>[<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa29d6ccf6cf507f6e66c72b1d3c2aed00">SystType::kSpline</a>]) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keyword">auto</span> &amp;SplineIndex = pair.first;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keyword">auto</span> &amp;SystIndex = pair.second;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classcovarianceXsec.html#a5b8c672fce660dd1b8d25f34ddf14474">AppliesToDetID</a>(SystIndex, DetID)) { <span class="comment">//If parameter applies to required DetID</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      returnVec.push_back(<a class="code" href="classcovarianceXsec.html#a4d3074db3c9edb7465a4409abd9c91fc">_fSplineNames</a>.at(SplineIndex));</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">return</span> returnVec;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;}</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#ac1b149bd12637390477c5a1d82eef195">  126</a></span>&#160;<span class="keyword">const</span> std::vector&lt;SplineInterpolation&gt; <a class="code" href="classcovarianceXsec.html#ac1b149bd12637390477c5a1d82eef195">covarianceXsec::GetSplineInterpolationFromDetID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> DetID) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  std::vector&lt;SplineInterpolation&gt; returnVec;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;pair : <a class="code" href="classcovarianceXsec.html#adddfbaa235113603542826df331ed61e">_fSystToGlobalSystIndexMap</a>[<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa29d6ccf6cf507f6e66c72b1d3c2aed00">SystType::kSpline</a>]) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keyword">auto</span> &amp;SplineIndex = pair.first;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keyword">auto</span> &amp;SystIndex = pair.second;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classcovarianceXsec.html#a5b8c672fce660dd1b8d25f34ddf14474">AppliesToDetID</a>(SystIndex, DetID)) { <span class="comment">//If parameter applies to required DetID</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      returnVec.push_back(<a class="code" href="classcovarianceXsec.html#ae95bafab0c674dc838635aaeca40bc2c">SplineParams</a>.at(SplineIndex)._SplineInterpolationType);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// if ((GetParDetID(SystIndex) &amp; DetID )){</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">//   returnVec.push_back(SplineParams.at(SplineIndex)._SplineInterpolationType);</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordflow">return</span> returnVec;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;}</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">// DB Grab the Spline Modes for the relevant DetID</span></div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#a63b4fb1e0caf3b71f372db7273c40c47">  146</a></span>&#160;<span class="keyword">const</span> std::vector&lt; std::vector&lt;int&gt; &gt; <a class="code" href="classcovarianceXsec.html#a63b4fb1e0caf3b71f372db7273c40c47">covarianceXsec::GetSplineModeVecFromDetID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> DetID) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  std::vector&lt; std::vector&lt;int&gt; &gt; returnVec;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="comment">//Need a counter or something to correctly get the index in _fSplineModes since it&#39;s not of length nPars</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="comment">//Should probably just make a std::map&lt;std::string, int&gt; for param name to FD spline index</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;pair : <a class="code" href="classcovarianceXsec.html#adddfbaa235113603542826df331ed61e">_fSystToGlobalSystIndexMap</a>[<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa29d6ccf6cf507f6e66c72b1d3c2aed00">SystType::kSpline</a>]) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keyword">auto</span> &amp;SplineIndex = pair.first;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keyword">auto</span> &amp;SystIndex = pair.second;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="classcovarianceXsec.html#aad522479b06581729efd6c1cd12d11df">GetParDetID</a>(SystIndex) &amp; DetID)) { <span class="comment">//If parameter applies to required DetID</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      returnVec.push_back(<a class="code" href="classcovarianceXsec.html#ae95bafab0c674dc838635aaeca40bc2c">SplineParams</a>.at(SplineIndex)._fSplineModes);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">return</span> returnVec;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">// Get Norm params</span></div>
<div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#a68938d9079d05782eb1f415a5204284c">  163</a></span>&#160;<a class="code" href="structXsecNorms4.html">XsecNorms4</a> <a class="code" href="classcovarianceXsec.html#a68938d9079d05782eb1f415a5204284c">covarianceXsec::GetXsecNorm</a>(<span class="keyword">const</span> YAML::Node&amp; param, <span class="keyword">const</span> <span class="keywordtype">int</span> Index) {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <a class="code" href="structXsecNorms4.html">XsecNorms4</a> norm;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  norm.<a class="code" href="structXsecNorms4.html#a848104ff97acc9a0df9861acc8615aa7">name</a> = <a class="code" href="classcovarianceBase.html#a6a46b5fed3e7feb6e9e151e90927bdbc">GetParFancyName</a>(Index);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="comment">// ETA Empty DummyVector can be used to specify no cut for mode, target and neutrino flavour</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="comment">// ETA Has to be of size 0 to mean apply to all</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  std::vector&lt;int&gt; DummyModeVec;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="comment">//Ultimately all this information ends up in the NormParams vector</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">//Copy the mode information into an XsecNorms4 struct</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  norm.<a class="code" href="structXsecNorms4.html#ad0632d5a94a37ee5ce297698abadd844">modes</a> = GetFromManager&lt;std::vector&lt;int&gt;&gt;(param[<span class="stringliteral">&quot;Mode&quot;</span>], DummyModeVec);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  norm.<a class="code" href="structXsecNorms4.html#afed4b95759559016df72bfed03763b6e">pdgs</a> = GetFromManager&lt;std::vector&lt;int&gt;&gt;(param[<span class="stringliteral">&quot;NeutrinoFlavour&quot;</span>], DummyModeVec);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  norm.<a class="code" href="structXsecNorms4.html#ac2e3b749d0c629e425861d2f6ecf82b0">preoscpdgs</a> = GetFromManager&lt;std::vector&lt;int&gt;&gt;(param[<span class="stringliteral">&quot;NeutrinoFlavourUnosc&quot;</span>], DummyModeVec);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  norm.<a class="code" href="structXsecNorms4.html#a0f6b21994200f446f21c42ec1cebf9bb">targets</a> = GetFromManager&lt;std::vector&lt;int&gt;&gt;(param[<span class="stringliteral">&quot;TargetNuclei&quot;</span>], DummyModeVec);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="comment">//ETA - I think this can go in the norm parameters only if statement above</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordtype">int</span> NumKinematicCuts = 0;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keywordflow">if</span>(param[<span class="stringliteral">&quot;KinematicCuts&quot;</span>]){</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    NumKinematicCuts = int(param[<span class="stringliteral">&quot;KinematicCuts&quot;</span>].<a class="code" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>());</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    std::vector&lt;std::string&gt; TempKinematicStrings;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    std::vector&lt;std::vector&lt;double&gt;&gt; TempKinematicBounds;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">//First element of TempKinematicBounds is always -999, and size is then 3</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> KinVar_i = 0 ; KinVar_i &lt; NumKinematicCuts ; ++KinVar_i){</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="comment">//ETA</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="comment">//This is a bit messy, Kinematic cuts is a list of maps</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keywordflow">for</span> (YAML::const_iterator it = param[<span class="stringliteral">&quot;KinematicCuts&quot;</span>][KinVar_i].begin();it!=param[<span class="stringliteral">&quot;KinematicCuts&quot;</span>][KinVar_i].end();++it) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        TempKinematicStrings.push_back(it-&gt;first.as&lt;std::string&gt;());</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        TempKinematicBounds.push_back(it-&gt;second.as&lt;std::vector&lt;double&gt;&gt;());</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordflow">if</span>(TempKinematicStrings.size() == 0) {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Recived a KinematicCuts node but couldn&#39;t read the contents (it&#39;s a list of single-element dictionaries (python) = map of pairs (C++))&quot;</span>);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    }<span class="comment">//KinVar_i</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    norm.<a class="code" href="structXsecNorms4.html#a67a1d237f1fdb41a0c11898fada0f00c">KinematicVarStr</a> = TempKinematicStrings;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    norm.<a class="code" href="structXsecNorms4.html#a1723c13b5d04cff5ce48718cae5b6e14">Selection</a> = TempKinematicBounds;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="comment">//Next ones are kinematic bounds on where normalisation parameter should apply (at the moment only etrue but hope to add q2</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="comment">//We set a bool to see if any bounds exist so we can short-circuit checking all of them every step</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keywordtype">bool</span> HasKinBounds = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="keywordflow">if</span>(norm.<a class="code" href="structXsecNorms4.html#a67a1d237f1fdb41a0c11898fada0f00c">KinematicVarStr</a>.size() &gt; 0) HasKinBounds = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  norm.<a class="code" href="structXsecNorms4.html#ab5d815107d57b4f7ae22ccb3f2ae318b">hasKinBounds</a> = HasKinBounds;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="comment">//End of kinematic bound checking</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="comment">// Set the global parameter index of the normalisation parameter</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  norm.<a class="code" href="structXsecNorms4.html#a6c45244b8c559ada13c1c886dea37cc2">index</a> = Index;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keywordflow">return</span> norm;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;}</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">// Grab the global syst index for the relevant DetID</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">// i.e. get a vector of size nSplines where each entry is filled with the global syst number</span></div>
<div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#a7669f8e01cc0aba5670784c786ff2645">  222</a></span>&#160;<span class="keyword">const</span> std::vector&lt;int&gt; <a class="code" href="classcovarianceXsec.html#a7669f8e01cc0aba5670784c786ff2645">covarianceXsec::GetGlobalSystIndexFromDetID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> DetID, <span class="keyword">const</span> <a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2f">SystType</a> Type) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  std::vector&lt;int&gt; returnVec;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;pair : <a class="code" href="classcovarianceXsec.html#adddfbaa235113603542826df331ed61e">_fSystToGlobalSystIndexMap</a>[Type]) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keyword">auto</span> &amp;SystIndex = pair.second;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classcovarianceXsec.html#a5b8c672fce660dd1b8d25f34ddf14474">AppliesToDetID</a>(SystIndex, DetID)) { <span class="comment">//If parameter applies to required DetID</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      returnVec.push_back(SystIndex);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordflow">return</span> returnVec;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;}</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">// Grab the global syst index for the relevant DetID</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">// i.e. get a vector of size nSplines where each entry is filled with the global syst number</span></div>
<div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#a0246245453554d222bb14cdaa53f014a">  237</a></span>&#160;<span class="keyword">const</span> std::vector&lt;int&gt; <a class="code" href="classcovarianceXsec.html#a0246245453554d222bb14cdaa53f014a">covarianceXsec::GetSystIndexFromDetID</a>(<span class="keywordtype">int</span> DetID,  <span class="keyword">const</span> <a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2f">SystType</a> Type) {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  std::vector&lt;int&gt; returnVec;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;pair : <a class="code" href="classcovarianceXsec.html#adddfbaa235113603542826df331ed61e">_fSystToGlobalSystIndexMap</a>[Type]) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keyword">auto</span> &amp;SplineIndex = pair.first;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keyword">auto</span> &amp;systIndex = pair.second;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classcovarianceXsec.html#a5b8c672fce660dd1b8d25f34ddf14474">AppliesToDetID</a>(systIndex, DetID)) { <span class="comment">//If parameter applies to required DetID</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      returnVec.push_back(SplineIndex);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordflow">return</span> returnVec;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;}</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">// Get Norm params</span></div>
<div class="line"><a name="l00252"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#acf3b87f72369d597d27d2a32fc01e779">  252</a></span>&#160;<a class="code" href="structXsecSplines1.html">XsecSplines1</a> <a class="code" href="classcovarianceXsec.html#acf3b87f72369d597d27d2a32fc01e779">covarianceXsec::GetXsecSpline</a>(<span class="keyword">const</span> YAML::Node&amp; param) {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <a class="code" href="structXsecSplines1.html">XsecSplines1</a> Spline;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="comment">//Now get the Spline interpolation type</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordflow">if</span> (param[<span class="stringliteral">&quot;SplineInformation&quot;</span>][<span class="stringliteral">&quot;InterpolationType&quot;</span>]){</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> InterpType = 0; InterpType &lt; <a class="code" href="Structs_8h.html#a6720d732608767153550aebebcf8fbf4a9e1a345912f2baebd863ab7d40c9ab7b">kSplineInterpolations</a> ; ++InterpType){</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="keywordflow">if</span>(param[<span class="stringliteral">&quot;SplineInformation&quot;</span>][<span class="stringliteral">&quot;InterpolationType&quot;</span>].as&lt;std::string&gt;() == <a class="code" href="Structs_8h.html#a2d969ce667e41bd2492cff1775456837">SplineInterpolation_ToString</a>(<a class="code" href="Structs_8h.html#a6720d732608767153550aebebcf8fbf4">SplineInterpolation</a>(InterpType)))</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        Spline.<a class="code" href="structXsecSplines1.html#aaa0e82ade2dbe697f625c06d9c79cffb">_SplineInterpolationType</a> = <a class="code" href="Structs_8h.html#a6720d732608767153550aebebcf8fbf4">SplineInterpolation</a>(InterpType);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  } <span class="keywordflow">else</span> { <span class="comment">//KS: By default use TSpline3</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    Spline.<a class="code" href="structXsecSplines1.html#aaa0e82ade2dbe697f625c06d9c79cffb">_SplineInterpolationType</a> = <a class="code" href="Structs_8h.html#a6720d732608767153550aebebcf8fbf4a56c886e7b34c938027a7140748999c8a">kTSpline3</a>;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  Spline.<a class="code" href="structXsecSplines1.html#aa253e0c9ad458756613665a5e28e8f3c">_SplineKnotUpBound</a> = GetFromManager&lt;double&gt;(param[<span class="stringliteral">&quot;SplineInformation&quot;</span>][<span class="stringliteral">&quot;SplineKnotUpBound&quot;</span>], 9999);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  Spline.<a class="code" href="structXsecSplines1.html#a44d06d261a524bf6d7e1b3e2b3ae08c0">_SplineKnotLowBound</a> = GetFromManager&lt;double&gt;(param[<span class="stringliteral">&quot;SplineInformation&quot;</span>][<span class="stringliteral">&quot;SplineKnotLowBound&quot;</span>], -9999);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="comment">//If there is no mode information given then this will be an empty vector</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  Spline.<a class="code" href="structXsecSplines1.html#a70fd38fe1866c2672c4d733d994886c9">_fSplineModes</a> = <a class="code" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">GetFromManager</a>(param[<span class="stringliteral">&quot;SplineInformation&quot;</span>][<span class="stringliteral">&quot;Mode&quot;</span>], std::vector&lt;int&gt;());</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordflow">return</span> Spline;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;}</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">// DB Grab the Normalisation parameters for the relevant DetID</span></div>
<div class="line"><a name="l00276"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#a98c68c6c894132a984c6bdd90c3e85dd">  276</a></span>&#160;<span class="keyword">const</span> std::vector&lt;XsecNorms4&gt; <a class="code" href="classcovarianceXsec.html#a98c68c6c894132a984c6bdd90c3e85dd">covarianceXsec::GetNormParsFromDetID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> DetID) {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  std::vector&lt;XsecNorms4&gt; returnVec;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keywordtype">int</span> norm_counter = 0;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <a class="code" href="classcovarianceXsec.html#a17c24905af91f1fc7b806cfc39e50035">IterateOverParams</a>(DetID,</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    [&amp;](<span class="keywordtype">int</span> i) { <span class="keywordflow">return</span> <a class="code" href="classcovarianceXsec.html#a50cca3de3274be7a57d25cc1b454e890">GetParamType</a>(i) == <a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa085cb29127b1cf7b1ddd429ff4440b17">kNorm</a>; }, <span class="comment">// Filter condition</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    [&amp;](<span class="keyword">auto</span>) {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <a class="code" href="structXsecNorms4.html">XsecNorms4</a> Temp = <a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>[norm_counter];</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      returnVec.push_back(Temp);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      norm_counter++;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  );</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keywordflow">return</span> returnVec;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;}</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">// DB Grab the number of parameters for the relevant DetID</span></div>
<div class="line"><a name="l00293"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#a0103e8fe156dccedee05619697fe0467">  293</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classcovarianceXsec.html#a0103e8fe156dccedee05619697fe0467">covarianceXsec::GetNumParamsFromDetID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> DetID, <span class="keyword">const</span> <a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2f">SystType</a> Type) {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="keywordtype">int</span> returnVal = 0;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <a class="code" href="classcovarianceXsec.html#a17c24905af91f1fc7b806cfc39e50035">IterateOverParams</a>(DetID,</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    [&amp;](<span class="keywordtype">int</span> i) { <span class="keywordflow">return</span> <a class="code" href="classcovarianceXsec.html#a50cca3de3274be7a57d25cc1b454e890">GetParamType</a>(i) == Type; }, <span class="comment">// Filter condition</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    [&amp;](int) { returnVal += 1; } <span class="comment">// Action to perform if filter passes</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  );</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordflow">return</span> returnVal;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;}</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">// DB Grab the parameter names for the relevant DetID</span></div>
<div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#a86bd213e24e1c7b574d2b07c8c5c15b8">  305</a></span>&#160;<span class="keyword">const</span> std::vector&lt;std::string&gt; <a class="code" href="classcovarianceXsec.html#a86bd213e24e1c7b574d2b07c8c5c15b8">covarianceXsec::GetParsNamesFromDetID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> DetID, <span class="keyword">const</span> <a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2f">SystType</a> Type) {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  std::vector&lt;std::string&gt; returnVec;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <a class="code" href="classcovarianceXsec.html#a17c24905af91f1fc7b806cfc39e50035">IterateOverParams</a>(DetID,</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    [&amp;](<span class="keywordtype">int</span> i) { <span class="keywordflow">return</span> <a class="code" href="classcovarianceXsec.html#a50cca3de3274be7a57d25cc1b454e890">GetParamType</a>(i) == Type; }, <span class="comment">// Filter condition</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    [&amp;](<span class="keywordtype">int</span> i) { returnVec.push_back(<a class="code" href="classcovarianceBase.html#a6a46b5fed3e7feb6e9e151e90927bdbc">GetParFancyName</a>(i)); } <span class="comment">// Action to perform if filter passes</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  );</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordflow">return</span> returnVec;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;}</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">// DB DB Grab the parameter indices for the relevant DetID</span></div>
<div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#aa5f13d2836d1de71dec80c0746fc05ae">  317</a></span>&#160;<span class="keyword">const</span> std::vector&lt;int&gt; <a class="code" href="classcovarianceXsec.html#aa5f13d2836d1de71dec80c0746fc05ae">covarianceXsec::GetParsIndexFromDetID</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> DetID, <span class="keyword">const</span> <a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2f">SystType</a> Type) {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  std::vector&lt;int&gt; returnVec;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <a class="code" href="classcovarianceXsec.html#a17c24905af91f1fc7b806cfc39e50035">IterateOverParams</a>(DetID,</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    [&amp;](<span class="keywordtype">int</span> i) { <span class="keywordflow">return</span> <a class="code" href="classcovarianceXsec.html#a50cca3de3274be7a57d25cc1b454e890">GetParamType</a>(i) == Type; }, <span class="comment">// Filter condition</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    [&amp;](<span class="keywordtype">int</span> i) { returnVec.push_back(i); } <span class="comment">// Action to perform if filter passes</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  );</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">return</span> returnVec;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;}</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> FilterFunc, <span class="keyword">typename</span> ActionFunc&gt;</div>
<div class="line"><a name="l00329"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#a17c24905af91f1fc7b806cfc39e50035">  329</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcovarianceXsec.html#a17c24905af91f1fc7b806cfc39e50035">covarianceXsec::IterateOverParams</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> DetID, FilterFunc filter, ActionFunc action) {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; ++i) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="classcovarianceXsec.html#a5b8c672fce660dd1b8d25f34ddf14474">AppliesToDetID</a>(i, DetID)) &amp;&amp; filter(i)) { <span class="comment">// Common filter logic</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      action(i); <span class="comment">// Specific action for each function</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;}</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00339"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#aea65a8b1ad6399f0b9f356810249bfd1">  339</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcovarianceXsec.html#aea65a8b1ad6399f0b9f356810249bfd1">covarianceXsec::initParams</a>() {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; ++i) {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">//ETA - set the name to be xsec_% as this is what ProcessorMCMC expects</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <a class="code" href="classcovarianceBase.html#a3e502d80fd2c30a7da4fe75a3e05b0da">_fNames</a>[i] = <span class="stringliteral">&quot;xsec_&quot;</span>+std::to_string(i);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">// Set covarianceBase parameters (Curr = current, Prop = proposed, Sigma = step)</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <a class="code" href="classcovarianceBase.html#ae70f51df3976975b2dc78fd3bfc28b65">_fCurrVal</a>[i] = <a class="code" href="classcovarianceBase.html#a7578a2cc2e8e9100fad88310a824cb1c">_fPreFitValue</a>[i];</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <a class="code" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[i] = <a class="code" href="classcovarianceBase.html#ae70f51df3976975b2dc78fd3bfc28b65">_fCurrVal</a>[i];</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="comment">//DB Set Individual Step scale for PCA parameters to the LastPCAdpar fIndivStepScale because the step scale for those parameters is set by &#39;eigen_values[i]&#39; but needs an overall step scale</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="comment">//   However, individual step scale for non-PCA parameters needs to be set correctly</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>) {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = <a class="code" href="classcovarianceBase.html#abba75182305d556818c76974a054a17d">FirstPCAdpar</a>; i &lt;= <a class="code" href="classcovarianceBase.html#a5ebdc744b733656972a15f1657915a3f">LastPCAdpar</a>; i++) {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <a class="code" href="classcovarianceBase.html#a3cda39026e336a49cef482efd4062561">_fIndivStepScale</a>[i] = <a class="code" href="classcovarianceBase.html#a3cda39026e336a49cef482efd4062561">_fIndivStepScale</a>[<a class="code" href="classcovarianceBase.html#a5ebdc744b733656972a15f1657915a3f">LastPCAdpar</a>-1];</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <a class="code" href="classcovarianceBase.html#a8d58b8e8ac3b2a8f1c6867e8b6cd7ff8">randomize</a>();</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="comment">//KS: Transfer the starting parameters to the PCA basis, you don&#39;t want to start with zero..</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>)</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <a class="code" href="classcovarianceBase.html#a651f5ecd8973918d5683606a607fa88c">TransferToPCA</a>();</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classcovarianceBase.html#ac57285a48d41ef764b4c659959a36c2d">_fNumParPCA</a>; ++i) {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <a class="code" href="classcovarianceBase.html#ae6aada94037640a68e3f37898f276019">_fPreFitValue_PCA</a>[i] = <a class="code" href="classcovarianceBase.html#aa96f87ab90dc26fc1b5e157149b9dfd3">fParCurr_PCA</a>(i);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;}</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">// Print everything we know about the inputs we&#39;re Getting</span></div>
<div class="line"><a name="l00369"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#ade0e8f83dcf75c50e6dad08ab6715093">  369</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcovarianceXsec.html#ade0e8f83dcf75c50e6dad08ab6715093">covarianceXsec::Print</a>() {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;#################################################&quot;</span>);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Printing covarianceXsec:&quot;</span>);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <a class="code" href="classcovarianceXsec.html#a41d7f1b1010bddd3e938eb589a089593">PrintGlobablInfo</a>();</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <a class="code" href="classcovarianceXsec.html#a8b408060d825769eec6c8e4594397ec8">PrintNormParams</a>();</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <a class="code" href="classcovarianceXsec.html#a02678dad88cf9dafb7d001208f8b0348">PrintSplineParams</a>();</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <a class="code" href="classcovarianceXsec.html#a36b690efce9b6d073482e461b350871f">PrintFunctionalParams</a>();</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <a class="code" href="classcovarianceXsec.html#ae62615b039cb1e1510934406200bde3a">PrintParameterGroups</a>();</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Finished&quot;</span>);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;#################################################&quot;</span>);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <a class="code" href="classcovarianceXsec.html#a688e670224e9e1fac3d6de97a2016f1a">CheckCorrectInitialisation</a>();</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;} <span class="comment">// End</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00392"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#a41d7f1b1010bddd3e938eb589a089593">  392</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcovarianceXsec.html#a41d7f1b1010bddd3e938eb589a089593">covarianceXsec::PrintGlobablInfo</a>() {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;============================================================================================================================================================&quot;</span>);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{:&lt;5} {:2} {:&lt;40} {:2} {:&lt;10} {:2} {:&lt;10} {:2} {:&lt;10} {:2} {:&lt;10} {:2} {:&lt;10} {:2} {:&lt;10} {:2} {:&lt;5} {:2} {:&lt;10}&quot;</span>, <span class="stringliteral">&quot;#&quot;</span>, <span class="stringliteral">&quot;|&quot;</span>, <span class="stringliteral">&quot;Name&quot;</span>, <span class="stringliteral">&quot;|&quot;</span>, <span class="stringliteral">&quot;Gen.&quot;</span>, <span class="stringliteral">&quot;|&quot;</span>, <span class="stringliteral">&quot;Prior&quot;</span>, <span class="stringliteral">&quot;|&quot;</span>, <span class="stringliteral">&quot;Error&quot;</span>, <span class="stringliteral">&quot;|&quot;</span>, <span class="stringliteral">&quot;Lower&quot;</span>, <span class="stringliteral">&quot;|&quot;</span>, <span class="stringliteral">&quot;Upper&quot;</span>, <span class="stringliteral">&quot;|&quot;</span>, <span class="stringliteral">&quot;StepScale&quot;</span>, <span class="stringliteral">&quot;|&quot;</span>, <span class="stringliteral">&quot;DetID&quot;</span>, <span class="stringliteral">&quot;|&quot;</span>, <span class="stringliteral">&quot;Type&quot;</span>);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;------------------------------------------------------------------------------------------------------------------------------------------------------------&quot;</span>);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classcovarianceBase.html#a3daac6405cc791347b768a5afe8a13d2">GetNumParams</a>(); i++) {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    std::string ErrString = fmt::format(<span class="stringliteral">&quot;{:.2f}&quot;</span>, <a class="code" href="classcovarianceBase.html#a34f877fc160b4a93a3aab1b3a8977858">_fError</a>[i]);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{:&lt;5} {:2} {:&lt;40} {:2} {:&lt;10} {:2} {:&lt;10} {:2} {:&lt;10} {:2} {:&lt;10} {:2} {:&lt;10} {:2} {:&lt;10} {:2} {:&lt;5} {:2} {:&lt;10}&quot;</span>, i, <span class="stringliteral">&quot;|&quot;</span>, <a class="code" href="classcovarianceBase.html#a6a46b5fed3e7feb6e9e151e90927bdbc">GetParFancyName</a>(i), <span class="stringliteral">&quot;|&quot;</span>, <a class="code" href="classcovarianceBase.html#a9b753f52711600a9f8d648531d95b044">_fGenerated</a>[i], <span class="stringliteral">&quot;|&quot;</span>, <a class="code" href="classcovarianceBase.html#a7578a2cc2e8e9100fad88310a824cb1c">_fPreFitValue</a>[i], <span class="stringliteral">&quot;|&quot;</span>, <span class="stringliteral">&quot;+/- &quot;</span> + ErrString, <span class="stringliteral">&quot;|&quot;</span>, <a class="code" href="classcovarianceBase.html#a8f1d94838f188cc85c4f82557c0b0b66">_fLowBound</a>[i], <span class="stringliteral">&quot;|&quot;</span>, <a class="code" href="classcovarianceBase.html#a31e636cb6de871bd0c2c8e7e299df9e7">_fUpBound</a>[i], <span class="stringliteral">&quot;|&quot;</span>, <a class="code" href="classcovarianceBase.html#a3cda39026e336a49cef482efd4062561">_fIndivStepScale</a>[i], <span class="stringliteral">&quot;|&quot;</span>, <a class="code" href="classcovarianceXsec.html#a183f01056fc0e9b42db202e944021332">_fDetID</a>[i], <span class="stringliteral">&quot;|&quot;</span>, <a class="code" href="Structs_8h.html#ad39c312dc44177340e2ebccd3d3f2d4c">SystType_ToString</a>(<a class="code" href="classcovarianceXsec.html#aae3338ca71027adab7fdfd3e828c0f79">_fParamType</a>[i]));</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  }</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;============================================================================================================================================================&quot;</span>);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;}</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00405"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#a8b408060d825769eec6c8e4594397ec8">  405</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcovarianceXsec.html#a8b408060d825769eec6c8e4594397ec8">covarianceXsec::PrintNormParams</a>() {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="comment">// Output the normalisation parameters as a sanity check!</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Normalisation parameters:  {}&quot;</span>, <a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>.size());</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classcovarianceXsec.html#adddfbaa235113603542826df331ed61e">_fSystToGlobalSystIndexMap</a>[<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa085cb29127b1cf7b1ddd429ff4440b17">SystType::kNorm</a>].<a class="code" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>() == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keywordtype">bool</span> have_parameter_with_kin_bounds = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="comment">//KS: Consider making some class producing table..</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{0:4}{1:10}{2:40}{3:20}{4:20}{5:20}&quot;</span>, <span class="stringliteral">&quot;#&quot;</span>, <span class="stringliteral">&quot;Global #&quot;</span>, <span class="stringliteral">&quot;Name&quot;</span>, <span class="stringliteral">&quot;Int. mode&quot;</span>, <span class="stringliteral">&quot;Target&quot;</span>, <span class="stringliteral">&quot;pdg&quot;</span>);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>.size(); ++i)</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    std::string intModeString;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>[i].modes.size(); j++) {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      intModeString += std::to_string(<a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>[i].modes[j]);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      intModeString += <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    }</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>[i].modes.empty()) intModeString += <span class="stringliteral">&quot;all&quot;</span>;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    std::string targetString;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>[i].targets.size(); j++) {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      targetString += std::to_string(<a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>[i].targets[j]);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      targetString += <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>[i].targets.empty()) targetString += <span class="stringliteral">&quot;all&quot;</span>;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    std::string pdgString;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>[i].pdgs.size(); j++) {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      pdgString += std::to_string(<a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>[i].pdgs[j]);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      pdgString += <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>[i].pdgs.empty()) pdgString += <span class="stringliteral">&quot;all&quot;</span>;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{: &lt;4}{: &lt;10}{: &lt;40}{: &lt;20}{: &lt;20}{: &lt;20}&quot;</span>, i, <a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>[i].index, <a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>[i].name, intModeString, targetString, pdgString);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>[i].hasKinBounds) have_parameter_with_kin_bounds = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keywordflow">if</span>(have_parameter_with_kin_bounds) {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Normalisation parameters KinematicCuts information&quot;</span>);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{0:4}{1:10}{2:40}{3:20}{4:40}&quot;</span>, <span class="stringliteral">&quot;#&quot;</span>, <span class="stringliteral">&quot;Global #&quot;</span>, <span class="stringliteral">&quot;Name&quot;</span>, <span class="stringliteral">&quot;KinematicCut&quot;</span>, <span class="stringliteral">&quot;Value&quot;</span>);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>.size(); ++i)</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      {</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="comment">//skip parameters with no KinematicCuts</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>[i].hasKinBounds) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ncuts = <a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>[i].KinematicVarStr.size();</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> icut = 0; icut &lt; ncuts; icut++) {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      std::string kinematicCutValueString;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp; value : <a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>[i].Selection[icut]) {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        kinematicCutValueString += std::to_string(value);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        kinematicCutValueString += <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <span class="keywordflow">if</span>(icut == 0)</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{: &lt;4}{: &lt;10}{: &lt;40}{: &lt;20}{: &lt;40}&quot;</span>, i, <a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>[i].index, <a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>[i].name, <a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>[i].KinematicVarStr[icut], kinematicCutValueString);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{: &lt;4}{: &lt;10}{: &lt;40}{: &lt;20}{: &lt;40}&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">NormParams</a>[i].KinematicVarStr[icut], kinematicCutValueString);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    }<span class="comment">//icut</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      }<span class="comment">//i</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;No normalisation parameters have KinematicCuts defined&quot;</span>);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;}</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00478"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#a02678dad88cf9dafb7d001208f8b0348">  478</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcovarianceXsec.html#a02678dad88cf9dafb7d001208f8b0348">covarianceXsec::PrintSplineParams</a>() {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Spline parameters: {}&quot;</span>, <a class="code" href="classcovarianceXsec.html#adddfbaa235113603542826df331ed61e">_fSystToGlobalSystIndexMap</a>[<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa29d6ccf6cf507f6e66c72b1d3c2aed00">SystType::kSpline</a>].<a class="code" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>());</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classcovarianceXsec.html#adddfbaa235113603542826df331ed61e">_fSystToGlobalSystIndexMap</a>[<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa29d6ccf6cf507f6e66c72b1d3c2aed00">SystType::kSpline</a>].<a class="code" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>() == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;=====================================================================================================================================================================&quot;</span>);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{:&lt;4} {:&lt;2} {:&lt;40} {:&lt;2} {:&lt;40} {:&lt;2} {:&lt;20} {:&lt;2} {:&lt;20} {:&lt;2} {:&lt;20} {:&lt;2}&quot;</span>, <span class="stringliteral">&quot;#&quot;</span>, <span class="stringliteral">&quot;|&quot;</span>, <span class="stringliteral">&quot;Name&quot;</span>, <span class="stringliteral">&quot;|&quot;</span>, <span class="stringliteral">&quot;Spline Name&quot;</span>, <span class="stringliteral">&quot;|&quot;</span>, <span class="stringliteral">&quot;Spline Interpolation&quot;</span>, <span class="stringliteral">&quot;|&quot;</span>, <span class="stringliteral">&quot;Low Knot Bound&quot;</span>, <span class="stringliteral">&quot;|&quot;</span>, <span class="stringliteral">&quot;Up Knot Bound&quot;</span>, <span class="stringliteral">&quot;|&quot;</span>);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;---------------------------------------------------------------------------------------------------------------------------------------------------------------------&quot;</span>);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;pair : <a class="code" href="classcovarianceXsec.html#adddfbaa235113603542826df331ed61e">_fSystToGlobalSystIndexMap</a>[<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa29d6ccf6cf507f6e66c72b1d3c2aed00">SystType::kSpline</a>]) {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keyword">auto</span> &amp;SplineIndex = pair.first;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keyword">auto</span> &amp;GlobalIndex = pair.second;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{:&lt;4} {:&lt;2} {:&lt;40} {:&lt;2} {:&lt;40} {:&lt;2} {:&lt;20} {:&lt;2} {:&lt;20} {:&lt;2} {:&lt;20} {:&lt;2}&quot;</span>,</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                  SplineIndex, <span class="stringliteral">&quot;|&quot;</span>, <a class="code" href="classcovarianceBase.html#a6a46b5fed3e7feb6e9e151e90927bdbc">GetParFancyName</a>(GlobalIndex), <span class="stringliteral">&quot;|&quot;</span>,</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                  <a class="code" href="classcovarianceXsec.html#a4d3074db3c9edb7465a4409abd9c91fc">_fSplineNames</a>[SplineIndex], <span class="stringliteral">&quot;|&quot;</span>,</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                  <a class="code" href="Structs_8h.html#a2d969ce667e41bd2492cff1775456837">SplineInterpolation_ToString</a>(<a class="code" href="classcovarianceXsec.html#a6e7661f9bd67500b66c7499f776b594d">GetParSplineInterpolation</a>(SplineIndex)), <span class="stringliteral">&quot;|&quot;</span>,</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                  <a class="code" href="classcovarianceXsec.html#a9ea6bd6b0e021f154ebd1f23605ff3e5">GetParSplineKnotLowerBound</a>(SplineIndex), <span class="stringliteral">&quot;|&quot;</span>,</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                  <a class="code" href="classcovarianceXsec.html#ac612a0f939f2f070906af574f98590d6">GetParSplineKnotUpperBound</a>(SplineIndex), <span class="stringliteral">&quot;|&quot;</span>);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  }</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;=====================================================================================================================================================================&quot;</span>);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;}</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00500"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#a36b690efce9b6d073482e461b350871f">  500</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcovarianceXsec.html#a36b690efce9b6d073482e461b350871f">covarianceXsec::PrintFunctionalParams</a>() {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Functional parameters: {}&quot;</span>, <a class="code" href="classcovarianceXsec.html#adddfbaa235113603542826df331ed61e">_fSystToGlobalSystIndexMap</a>[<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fad9b1ac76e80f59684cfb7dc996fc870d">SystType::kFunc</a>].<a class="code" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>());</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classcovarianceXsec.html#adddfbaa235113603542826df331ed61e">_fSystToGlobalSystIndexMap</a>[<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fad9b1ac76e80f59684cfb7dc996fc870d">SystType::kFunc</a>].<a class="code" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>() == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{0:4}{1:10}{2:40}&quot;</span>, <span class="stringliteral">&quot;#&quot;</span>, <span class="stringliteral">&quot;Global #&quot;</span>, <span class="stringliteral">&quot;Name&quot;</span>);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;pair : <a class="code" href="classcovarianceXsec.html#adddfbaa235113603542826df331ed61e">_fSystToGlobalSystIndexMap</a>[<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fad9b1ac76e80f59684cfb7dc996fc870d">SystType::kFunc</a>]) {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keyword">auto</span> &amp;FuncIndex = pair.first;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keyword">auto</span> &amp;GlobalIndex = pair.second;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{0:4}{1:&lt;10}{2:40}&quot;</span>, std::to_string(FuncIndex), GlobalIndex, <a class="code" href="classcovarianceBase.html#a6a46b5fed3e7feb6e9e151e90927bdbc">GetParFancyName</a>(GlobalIndex));</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;}</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160; </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00516"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#ae62615b039cb1e1510934406200bde3a">  516</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcovarianceXsec.html#ae62615b039cb1e1510934406200bde3a">covarianceXsec::PrintParameterGroups</a>() {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="comment">// KS: Create a map to store the counts of unique strings, in principle this could be in header file</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  std::unordered_map&lt;std::string, int&gt; paramCounts;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  std::for_each(<a class="code" href="classcovarianceXsec.html#a47cd1802e0dac0c22c8c16f214272c34">_ParameterGroup</a>.begin(), <a class="code" href="classcovarianceXsec.html#a47cd1802e0dac0c22c8c16f214272c34">_ParameterGroup</a>.end(),</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                [&amp;paramCounts](<span class="keyword">const</span> std::string&amp; param) {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                  paramCounts[param]++;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                });</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Printing parameter groups&quot;</span>);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="comment">// Output the counts</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; pair : paramCounts) {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Found {}: {} params&quot;</span>, pair.second, pair.first);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;}</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">// KS: Check if matrix is correctly initialised</span></div>
<div class="line"><a name="l00535"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#a688e670224e9e1fac3d6de97a2016f1a">  535</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcovarianceXsec.html#a688e670224e9e1fac3d6de97a2016f1a">covarianceXsec::CheckCorrectInitialisation</a>() {</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="comment">// KS: Lambda Function which simply checks if there are no duplicates in std::vector</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="keyword">auto</span> CheckForDuplicates = [](<span class="keyword">const</span> std::vector&lt;std::string&gt;&amp; names, <span class="keyword">const</span> std::string&amp; nameType) {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    std::unordered_map&lt;std::string, size_t&gt; seenStrings;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; names.size(); ++i) {</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; name = names[i];</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <span class="keywordflow">if</span> (seenStrings.find(name) != seenStrings.end()) {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="keywordtype">size_t</span> firstIndex = seenStrings[name];</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a07ff6d6a15b24f94afc88a1b89779beb">MACH3LOG_CRITICAL</a>(<span class="stringliteral">&quot;There are two systematics with the same {} &#39;{}&#39;, first at index {}, and again at index {}&quot;</span>, nameType, name, firstIndex, i);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      }</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      seenStrings[name] = i;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    }</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  };</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="comment">// KS: Checks if there are no duplicates in fancy names etc, this can happen if we merge configs etc</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  CheckForDuplicates(<a class="code" href="classcovarianceBase.html#a973671386a2f8ea924f25f8f5404654c">_fFancyNames</a>, <span class="stringliteral">&quot;_fFancyNames&quot;</span>);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  CheckForDuplicates(<a class="code" href="classcovarianceXsec.html#a4d3074db3c9edb7465a4409abd9c91fc">_fSplineNames</a>, <span class="stringliteral">&quot;_fSplineNames&quot;</span>);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;}</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">// Function to set to prior parameters of a given group</span></div>
<div class="line"><a name="l00558"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#a8e602fcc62a2c930c89987e06af9def1">  558</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcovarianceXsec.html#a8e602fcc62a2c930c89987e06af9def1">covarianceXsec::SetGroupOnlyParameters</a>(<span class="keyword">const</span> std::string&amp; Group) {</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">pca</a>) {</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; i++) {</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classcovarianceXsec.html#a5dc8900054a498107e39cc41641879a8">IsParFromGroup</a>(i, Group)) <a class="code" href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">_fPropVal</a>[i] = <a class="code" href="classcovarianceBase.html#a7578a2cc2e8e9100fad88310a824cb1c">_fPreFitValue</a>[i];</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    }</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;SetGroupOnlyParameters not implemented for PCA&quot;</span>);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  }</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;}</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">// Checks if parameter belongs to a given group</span></div>
<div class="line"><a name="l00572"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#a5dc8900054a498107e39cc41641879a8">  572</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcovarianceXsec.html#a5dc8900054a498107e39cc41641879a8">covarianceXsec::IsParFromGroup</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> i, <span class="keyword">const</span> std::string&amp; Group) {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  std::string groupLower = Group;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  std::string paramGroupLower = <a class="code" href="classcovarianceXsec.html#a47cd1802e0dac0c22c8c16f214272c34">_ParameterGroup</a>[i];</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="comment">// KS: Convert both strings to lowercase, this way comparison will be case insensitive</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  std::transform(groupLower.begin(), groupLower.end(), groupLower.begin(), ::tolower);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  std::transform(paramGroupLower.begin(), paramGroupLower.end(), paramGroupLower.begin(), ::tolower);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <span class="keywordflow">return</span> groupLower == paramGroupLower;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;}</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">// Dump Matrix to ROOT file, useful when we need to pass matrix info to another fitting group</span></div>
<div class="line"><a name="l00586"></a><span class="lineno"><a class="line" href="classcovarianceXsec.html#a5cffa7b3221e1a49706ea8a9fe0f826c">  586</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcovarianceXsec.html#a5cffa7b3221e1a49706ea8a9fe0f826c">covarianceXsec::DumpMatrixToFile</a>(<span class="keyword">const</span> std::string&amp; Name) {</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">// ********************************************</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  TFile* outputFile = <span class="keyword">new</span> TFile(Name.c_str(), <span class="stringliteral">&quot;RECREATE&quot;</span>);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  TObjArray* xsec_param_names = <span class="keyword">new</span> TObjArray();</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  TObjArray* xsec_spline_interpolation = <span class="keyword">new</span> TObjArray();</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  TObjArray* xsec_spline_names = <span class="keyword">new</span> TObjArray();</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  TVectorD* xsec_param_prior = <span class="keyword">new</span> TVectorD(<a class="code" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  TVectorD* xsec_flat_prior = <span class="keyword">new</span> TVectorD(<a class="code" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  TVectorD* xsec_stepscale = <span class="keyword">new</span> TVectorD(<a class="code" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  TVectorD* xsec_param_generated = <span class="keyword">new</span> TVectorD(<a class="code" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  TVectorD* xsec_param_lb = <span class="keyword">new</span> TVectorD(<a class="code" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  TVectorD* xsec_param_ub = <span class="keyword">new</span> TVectorD(<a class="code" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  TVectorD* xsec_param_knot_weight_lb = <span class="keyword">new</span> TVectorD(<a class="code" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  TVectorD* xsec_param_knot_weight_ub = <span class="keyword">new</span> TVectorD(<a class="code" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  TVectorD* xsec_error = <span class="keyword">new</span> TVectorD(<a class="code" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  TVectorD* xsec_param_id = <span class="keyword">new</span> TVectorD(<a class="code" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">_fNumPar</a>; ++i)</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    TObjString* nameObj = <span class="keyword">new</span> TObjString(<a class="code" href="classcovarianceBase.html#a973671386a2f8ea924f25f8f5404654c">_fFancyNames</a>[i].c_str());</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    xsec_param_names-&gt;AddLast(nameObj);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160; </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    TObjString* splineType = <span class="keyword">new</span> TObjString(<span class="stringliteral">&quot;TSpline3&quot;</span>);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    xsec_spline_interpolation-&gt;AddLast(splineType);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    TObjString* splineName = <span class="keyword">new</span> TObjString(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    xsec_spline_names-&gt;AddLast(splineName);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    (*xsec_param_prior)[i] = <a class="code" href="classcovarianceBase.html#a7578a2cc2e8e9100fad88310a824cb1c">_fPreFitValue</a>[i];</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    (*xsec_param_generated)[i] = <a class="code" href="classcovarianceBase.html#a9b753f52711600a9f8d648531d95b044">_fGenerated</a>[i];</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    (*xsec_flat_prior)[i] = <a class="code" href="classcovarianceBase.html#ad9c47deb7009bff81210f666e80012eb">_fFlatPrior</a>[i];</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    (*xsec_stepscale)[i] = <a class="code" href="classcovarianceBase.html#a3cda39026e336a49cef482efd4062561">_fIndivStepScale</a>[i];</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    (*xsec_error)[i] = <a class="code" href="classcovarianceBase.html#a34f877fc160b4a93a3aab1b3a8977858">_fError</a>[i];</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    (*xsec_param_id)[i] = <a class="code" href="classcovarianceXsec.html#a183f01056fc0e9b42db202e944021332">_fDetID</a>[i];</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    (*xsec_param_lb)[i] = <a class="code" href="classcovarianceBase.html#a8f1d94838f188cc85c4f82557c0b0b66">_fLowBound</a>[i];</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    (*xsec_param_ub)[i] = <a class="code" href="classcovarianceBase.html#a31e636cb6de871bd0c2c8e7e299df9e7">_fUpBound</a>[i];</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="comment">//Default values</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    (*xsec_param_knot_weight_lb)[i] = -9999;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    (*xsec_param_knot_weight_ub)[i] = +9999;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  }</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;pair : <a class="code" href="classcovarianceXsec.html#adddfbaa235113603542826df331ed61e">_fSystToGlobalSystIndexMap</a>[<a class="code" href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa29d6ccf6cf507f6e66c72b1d3c2aed00">SystType::kSpline</a>]) {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keyword">auto</span> &amp;SplineIndex = pair.first;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keyword">auto</span> &amp;SystIndex = pair.second;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160; </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    (*xsec_param_knot_weight_lb)[SystIndex] = <a class="code" href="classcovarianceXsec.html#ae95bafab0c674dc838635aaeca40bc2c">SplineParams</a>.at(SplineIndex)._SplineKnotLowBound;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    (*xsec_param_knot_weight_ub)[SystIndex] = <a class="code" href="classcovarianceXsec.html#ae95bafab0c674dc838635aaeca40bc2c">SplineParams</a>.at(SplineIndex)._SplineKnotUpBound;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    TObjString* splineType = <span class="keyword">new</span> TObjString(<a class="code" href="Structs_8h.html#a2d969ce667e41bd2492cff1775456837">SplineInterpolation_ToString</a>(<a class="code" href="classcovarianceXsec.html#ae95bafab0c674dc838635aaeca40bc2c">SplineParams</a>.at(SplineIndex)._SplineInterpolationType).c_str());</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    xsec_spline_interpolation-&gt;AddAt(splineType, SystIndex);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    TObjString* splineName = <span class="keyword">new</span> TObjString(<a class="code" href="classcovarianceXsec.html#a4d3074db3c9edb7465a4409abd9c91fc">_fSplineNames</a>[SplineIndex].c_str());</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    xsec_spline_names-&gt;AddAt(splineName, SystIndex);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  }</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  xsec_param_names-&gt;Write(<span class="stringliteral">&quot;xsec_param_names&quot;</span>, TObject::kSingleKey);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="keyword">delete</span> xsec_param_names;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  xsec_spline_interpolation-&gt;Write(<span class="stringliteral">&quot;xsec_spline_interpolation&quot;</span>, TObject::kSingleKey);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="keyword">delete</span> xsec_spline_interpolation;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  xsec_spline_names-&gt;Write(<span class="stringliteral">&quot;xsec_spline_names&quot;</span>, TObject::kSingleKey);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keyword">delete</span> xsec_spline_names;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160; </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  xsec_param_prior-&gt;Write(<span class="stringliteral">&quot;xsec_param_prior&quot;</span>);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="keyword">delete</span> xsec_param_prior;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  xsec_flat_prior-&gt;Write(<span class="stringliteral">&quot;xsec_flat_prior&quot;</span>);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="keyword">delete</span> xsec_flat_prior;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  xsec_stepscale-&gt;Write(<span class="stringliteral">&quot;xsec_stepscale&quot;</span>);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="keyword">delete</span> xsec_stepscale;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  xsec_param_generated-&gt;Write(<span class="stringliteral">&quot;xsec_param_nom&quot;</span>);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <span class="keyword">delete</span> xsec_param_generated;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  xsec_param_lb-&gt;Write(<span class="stringliteral">&quot;xsec_param_lb&quot;</span>);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="keyword">delete</span> xsec_param_lb;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  xsec_param_ub-&gt;Write(<span class="stringliteral">&quot;xsec_param_ub&quot;</span>);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="keyword">delete</span> xsec_param_ub;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  xsec_param_knot_weight_lb-&gt;Write(<span class="stringliteral">&quot;xsec_param_knot_weight_lb&quot;</span>);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <span class="keyword">delete</span> xsec_param_knot_weight_lb;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  xsec_param_knot_weight_ub-&gt;Write(<span class="stringliteral">&quot;xsec_param_knot_weight_ub&quot;</span>);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="keyword">delete</span> xsec_param_knot_weight_ub;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160; </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  xsec_param_id-&gt;Write(<span class="stringliteral">&quot;xsec_param_id&quot;</span>);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <span class="keyword">delete</span> xsec_param_id;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  xsec_error-&gt;Write(<span class="stringliteral">&quot;xsec_error&quot;</span>);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="keyword">delete</span> xsec_error;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <a class="code" href="classcovarianceBase.html#a6c3fe8db34c06299fd1633951ac00937">covMatrix</a>-&gt;Write(<span class="stringliteral">&quot;xsec_cov&quot;</span>);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  TH2D* CorrMatrix = <a class="code" href="classcovarianceBase.html#ac14fabdb87f5101cdbfcecb8e6b6b811">GetCorrelationMatrix</a>();</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  CorrMatrix-&gt;Write(<span class="stringliteral">&quot;hcov&quot;</span>);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="keyword">delete</span> CorrMatrix;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  outputFile-&gt;Close();</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="keyword">delete</span> outputFile;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160; </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Finished dumping covariance object&quot;</span>);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;}</div>
<div class="ttc" id="aGetPenaltyTerm_8cpp_html_a439227feff9d7f55384e8780cfc2eb82"><div class="ttname"><a href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a></div><div class="ttdeci">int size</div><div class="ttdef"><b>Definition:</b> <a href="GetPenaltyTerm_8cpp_source.html#l00038">GetPenaltyTerm.cpp:38</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_a07ff6d6a15b24f94afc88a1b89779beb"><div class="ttname"><a href="MaCh3Logger_8h.html#a07ff6d6a15b24f94afc88a1b89779beb">MACH3LOG_CRITICAL</a></div><div class="ttdeci">#define MACH3LOG_CRITICAL</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00019">MaCh3Logger.h:19</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_a4db4657acad5c79ac4bbb66a9d1c5905"><div class="ttname"><a href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a></div><div class="ttdeci">#define MACH3LOG_DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00015">MaCh3Logger.h:15</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_a61052119a625282d0ec6d4a97adf3ee2"><div class="ttname"><a href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a></div><div class="ttdeci">#define MACH3LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00018">MaCh3Logger.h:18</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_a95fa4dffc648e4c5536c9292c2bdcac3"><div class="ttname"><a href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a></div><div class="ttdeci">#define MACH3LOG_INFO</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00016">MaCh3Logger.h:16</a></div></div>
<div class="ttc" id="aStructs_8h_html"><div class="ttname"><a href="Structs_8h.html">Structs.h</a></div></div>
<div class="ttc" id="aStructs_8h_html_a2d969ce667e41bd2492cff1775456837"><div class="ttname"><a href="Structs_8h.html#a2d969ce667e41bd2492cff1775456837">SplineInterpolation_ToString</a></div><div class="ttdeci">std::string SplineInterpolation_ToString(const SplineInterpolation i)</div><div class="ttdoc">Convert a LLH type to a string.</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00187">Structs.h:187</a></div></div>
<div class="ttc" id="aStructs_8h_html_a6720d732608767153550aebebcf8fbf4"><div class="ttname"><a href="Structs_8h.html#a6720d732608767153550aebebcf8fbf4">SplineInterpolation</a></div><div class="ttdeci">SplineInterpolation</div><div class="ttdoc">Make an enum of the spline interpolation type.</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00126">Structs.h:126</a></div></div>
<div class="ttc" id="aStructs_8h_html_a6720d732608767153550aebebcf8fbf4a56c886e7b34c938027a7140748999c8a"><div class="ttname"><a href="Structs_8h.html#a6720d732608767153550aebebcf8fbf4a56c886e7b34c938027a7140748999c8a">kTSpline3</a></div><div class="ttdeci">@ kTSpline3</div><div class="ttdoc">Default TSpline3 interpolation.</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00127">Structs.h:127</a></div></div>
<div class="ttc" id="aStructs_8h_html_a6720d732608767153550aebebcf8fbf4a9e1a345912f2baebd863ab7d40c9ab7b"><div class="ttname"><a href="Structs_8h.html#a6720d732608767153550aebebcf8fbf4a9e1a345912f2baebd863ab7d40c9ab7b">kSplineInterpolations</a></div><div class="ttdeci">@ kSplineInterpolations</div><div class="ttdoc">This only enumerates.</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00133">Structs.h:132</a></div></div>
<div class="ttc" id="aStructs_8h_html_ad39c312dc44177340e2ebccd3d3f2d4c"><div class="ttname"><a href="Structs_8h.html#ad39c312dc44177340e2ebccd3d3f2d4c">SystType_ToString</a></div><div class="ttdeci">std::string SystType_ToString(const SystType i)</div><div class="ttdoc">Convert a Syst type type to a string.</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00243">Structs.h:243</a></div></div>
<div class="ttc" id="aStructs_8h_html_affc27d8b7b82d3713f45af17873fde2f"><div class="ttname"><a href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2f">SystType</a></div><div class="ttdeci">SystType</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00218">Structs.h:218</a></div></div>
<div class="ttc" id="aStructs_8h_html_affc27d8b7b82d3713f45af17873fde2fa085cb29127b1cf7b1ddd429ff4440b17"><div class="ttname"><a href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa085cb29127b1cf7b1ddd429ff4440b17">kNorm</a></div><div class="ttdeci">@ kNorm</div><div class="ttdoc">For normalisation parameters.</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00219">Structs.h:219</a></div></div>
<div class="ttc" id="aStructs_8h_html_affc27d8b7b82d3713f45af17873fde2fa29d6ccf6cf507f6e66c72b1d3c2aed00"><div class="ttname"><a href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa29d6ccf6cf507f6e66c72b1d3c2aed00">kSpline</a></div><div class="ttdeci">@ kSpline</div><div class="ttdoc">For splined parameters (1D)</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00220">Structs.h:220</a></div></div>
<div class="ttc" id="aStructs_8h_html_affc27d8b7b82d3713f45af17873fde2fa32e7da18117f9defb24042a71776e5cb"><div class="ttname"><a href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fa32e7da18117f9defb24042a71776e5cb">kSystTypes</a></div><div class="ttdeci">@ kSystTypes</div><div class="ttdoc">This only enumerates.</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00223">Structs.h:222</a></div></div>
<div class="ttc" id="aStructs_8h_html_affc27d8b7b82d3713f45af17873fde2fad9b1ac76e80f59684cfb7dc996fc870d"><div class="ttname"><a href="Structs_8h.html#affc27d8b7b82d3713f45af17873fde2fad9b1ac76e80f59684cfb7dc996fc870d">kFunc</a></div><div class="ttdeci">@ kFunc</div><div class="ttdoc">For functional parameters.</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00221">Structs.h:221</a></div></div>
<div class="ttc" id="aYamlHelper_8h_html_a1a6adcb8b24bfbdcb936ced6812e1b0c"><div class="ttname"><a href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">GetFromManager</a></div><div class="ttdeci">Type GetFromManager(const YAML::Node &amp;node, Type defval)</div><div class="ttdoc">Get content of config file if node is not found take default value specified.</div><div class="ttdef"><b>Definition:</b> <a href="YamlHelper_8h_source.html#l00024">YamlHelper.h:24</a></div></div>
<div class="ttc" id="aclassMaCh3Exception_html"><div class="ttname"><a href="classMaCh3Exception.html">MaCh3Exception</a></div><div class="ttdoc">Custom exception class for MaCh3 errors.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Exception_8h_source.html#l00012">MaCh3Exception.h:12</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html"><div class="ttname"><a href="classcovarianceBase.html">covarianceBase</a></div><div class="ttdoc">Base class responsible for handling of systematic error parameters. Capable of using PCA or using ada...</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00015">covarianceBase.h:15</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a12f0eb31a5ef48b014baa11d4ab919e9"><div class="ttname"><a href="classcovarianceBase.html#a12f0eb31a5ef48b014baa11d4ab919e9">covarianceBase::_fPropVal</a></div><div class="ttdeci">std::vector&lt; double &gt; _fPropVal</div><div class="ttdoc">Proposed value of the parameter.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00422">covarianceBase.h:422</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a31e636cb6de871bd0c2c8e7e299df9e7"><div class="ttname"><a href="classcovarianceBase.html#a31e636cb6de871bd0c2c8e7e299df9e7">covarianceBase::_fUpBound</a></div><div class="ttdeci">std::vector&lt; double &gt; _fUpBound</div><div class="ttdoc">Upper physical bound, parameter will not be able to go beyond it.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00430">covarianceBase.h:430</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a34f877fc160b4a93a3aab1b3a8977858"><div class="ttname"><a href="classcovarianceBase.html#a34f877fc160b4a93a3aab1b3a8977858">covarianceBase::_fError</a></div><div class="ttdeci">std::vector&lt; double &gt; _fError</div><div class="ttdoc">Prior error on the parameter.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00426">covarianceBase.h:426</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a3cda39026e336a49cef482efd4062561"><div class="ttname"><a href="classcovarianceBase.html#a3cda39026e336a49cef482efd4062561">covarianceBase::_fIndivStepScale</a></div><div class="ttdeci">std::vector&lt; double &gt; _fIndivStepScale</div><div class="ttdoc">Individual step scale used by MCMC algorithm.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00432">covarianceBase.h:432</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a3daac6405cc791347b768a5afe8a13d2"><div class="ttname"><a href="classcovarianceBase.html#a3daac6405cc791347b768a5afe8a13d2">covarianceBase::GetNumParams</a></div><div class="ttdeci">int GetNumParams()</div><div class="ttdoc">Get total number of parameters.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00179">covarianceBase.h:179</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a3e502d80fd2c30a7da4fe75a3e05b0da"><div class="ttname"><a href="classcovarianceBase.html#a3e502d80fd2c30a7da4fe75a3e05b0da">covarianceBase::_fNames</a></div><div class="ttdeci">std::vector&lt; std::string &gt; _fNames</div><div class="ttdoc">ETA _fNames is set automatically in the covariance class to be something like xsec_i,...</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00410">covarianceBase.h:410</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a5ebdc744b733656972a15f1657915a3f"><div class="ttname"><a href="classcovarianceBase.html#a5ebdc744b733656972a15f1657915a3f">covarianceBase::LastPCAdpar</a></div><div class="ttdeci">int LastPCAdpar</div><div class="ttdoc">Index of the last param that is being decomposed.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00448">covarianceBase.h:448</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a651f5ecd8973918d5683606a607fa88c"><div class="ttname"><a href="classcovarianceBase.html#a651f5ecd8973918d5683606a607fa88c">covarianceBase::TransferToPCA</a></div><div class="ttdeci">void TransferToPCA()</div><div class="ttdoc">Transfer param values from normal base to PCA base.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8cpp_source.html#l00427">covarianceBase.cpp:427</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a6a46b5fed3e7feb6e9e151e90927bdbc"><div class="ttname"><a href="classcovarianceBase.html#a6a46b5fed3e7feb6e9e151e90927bdbc">covarianceBase::GetParFancyName</a></div><div class="ttdeci">std::string GetParFancyName(const int i)</div><div class="ttdoc">Get fancy name of the Parameter.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00118">covarianceBase.h:118</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a6c3fe8db34c06299fd1633951ac00937"><div class="ttname"><a href="classcovarianceBase.html#a6c3fe8db34c06299fd1633951ac00937">covarianceBase::covMatrix</a></div><div class="ttdeci">TMatrixDSym * covMatrix</div><div class="ttdoc">The covariance matrix.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00390">covarianceBase.h:390</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a7578a2cc2e8e9100fad88310a824cb1c"><div class="ttname"><a href="classcovarianceBase.html#a7578a2cc2e8e9100fad88310a824cb1c">covarianceBase::_fPreFitValue</a></div><div class="ttdeci">std::vector&lt; double &gt; _fPreFitValue</div><div class="ttdoc">Parameter value dictated by the prior model. Based on it penalty term is calculated.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00418">covarianceBase.h:418</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a8d58b8e8ac3b2a8f1c6867e8b6cd7ff8"><div class="ttname"><a href="classcovarianceBase.html#a8d58b8e8ac3b2a8f1c6867e8b6cd7ff8">covarianceBase::randomize</a></div><div class="ttdeci">void randomize() _noexcept_</div><div class="ttdoc">&quot;Randomize&quot; the parameters in the covariance class for the proposed step. Used the proposal kernel an...</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8cpp_source.html#l00601">covarianceBase.cpp:601</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a8d821ce805f2426fe95549170866821f"><div class="ttname"><a href="classcovarianceBase.html#a8d821ce805f2426fe95549170866821f">covarianceBase::PrintLength</a></div><div class="ttdeci">int PrintLength</div><div class="ttdoc">KS: This is used when printing parameters, sometimes we have super long parameters name,...</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00407">covarianceBase.h:407</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a8f1d94838f188cc85c4f82557c0b0b66"><div class="ttname"><a href="classcovarianceBase.html#a8f1d94838f188cc85c4f82557c0b0b66">covarianceBase::_fLowBound</a></div><div class="ttdeci">std::vector&lt; double &gt; _fLowBound</div><div class="ttdoc">Lowest physical bound, parameter will not be able to go beyond it.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00428">covarianceBase.h:428</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a933ff3dc0af99629ba3582a5d9d89d23"><div class="ttname"><a href="classcovarianceBase.html#a933ff3dc0af99629ba3582a5d9d89d23">covarianceBase::_fYAMLDoc</a></div><div class="ttdeci">YAML::Node _fYAMLDoc</div><div class="ttdoc">Stores config describing systematics.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00414">covarianceBase.h:414</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a973671386a2f8ea924f25f8f5404654c"><div class="ttname"><a href="classcovarianceBase.html#a973671386a2f8ea924f25f8f5404654c">covarianceBase::_fFancyNames</a></div><div class="ttdeci">std::vector&lt; std::string &gt; _fFancyNames</div><div class="ttdoc">Fancy name for example rather than xsec_0 it is MAQE, useful for human reading.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00412">covarianceBase.h:412</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_a9b753f52711600a9f8d648531d95b044"><div class="ttname"><a href="classcovarianceBase.html#a9b753f52711600a9f8d648531d95b044">covarianceBase::_fGenerated</a></div><div class="ttdeci">std::vector&lt; double &gt; _fGenerated</div><div class="ttdoc">Generated value of the parameter.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00424">covarianceBase.h:424</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_aa96f87ab90dc26fc1b5e157149b9dfd3"><div class="ttname"><a href="classcovarianceBase.html#aa96f87ab90dc26fc1b5e157149b9dfd3">covarianceBase::fParCurr_PCA</a></div><div class="ttdeci">TVectorD fParCurr_PCA</div><div class="ttdoc">CW: Proposed parameter value in PCA base.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00455">covarianceBase.h:455</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_ab4b7f96d3e977a0b3307ceecbd0baeb4"><div class="ttname"><a href="classcovarianceBase.html#ab4b7f96d3e977a0b3307ceecbd0baeb4">covarianceBase::pca</a></div><div class="ttdeci">bool pca</div><div class="ttdoc">perform PCA or not</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00440">covarianceBase.h:440</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_abba75182305d556818c76974a054a17d"><div class="ttname"><a href="classcovarianceBase.html#abba75182305d556818c76974a054a17d">covarianceBase::FirstPCAdpar</a></div><div class="ttdeci">int FirstPCAdpar</div><div class="ttdoc">Index of the first param that is being decomposed.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00446">covarianceBase.h:446</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_ac14fabdb87f5101cdbfcecb8e6b6b811"><div class="ttname"><a href="classcovarianceBase.html#ac14fabdb87f5101cdbfcecb8e6b6b811">covarianceBase::GetCorrelationMatrix</a></div><div class="ttdeci">TH2D * GetCorrelationMatrix()</div><div class="ttdoc">KS: Convert covariance matrix to correlation matrix and return TH2D which can be used for fancy plott...</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8cpp_source.html#l01316">covarianceBase.cpp:1316</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_ac57285a48d41ef764b4c659959a36c2d"><div class="ttname"><a href="classcovarianceBase.html#ac57285a48d41ef764b4c659959a36c2d">covarianceBase::_fNumParPCA</a></div><div class="ttdeci">int _fNumParPCA</div><div class="ttdoc">Number of parameters in PCA base.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00444">covarianceBase.h:444</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_ac5d922f1a4163b38ebc7a3ef21eec376"><div class="ttname"><a href="classcovarianceBase.html#ac5d922f1a4163b38ebc7a3ef21eec376">covarianceBase::_fNumPar</a></div><div class="ttdeci">int _fNumPar</div><div class="ttdoc">Number of systematic parameters.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00416">covarianceBase.h:416</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_ad9c47deb7009bff81210f666e80012eb"><div class="ttname"><a href="classcovarianceBase.html#ad9c47deb7009bff81210f666e80012eb">covarianceBase::_fFlatPrior</a></div><div class="ttdeci">std::vector&lt; bool &gt; _fFlatPrior</div><div class="ttdoc">Whether to apply flat prior or not.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00434">covarianceBase.h:434</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_ae6aada94037640a68e3f37898f276019"><div class="ttname"><a href="classcovarianceBase.html#ae6aada94037640a68e3f37898f276019">covarianceBase::_fPreFitValue_PCA</a></div><div class="ttdeci">std::vector&lt; double &gt; _fPreFitValue_PCA</div><div class="ttdoc">Prefit value for PCA params.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00451">covarianceBase.h:451</a></div></div>
<div class="ttc" id="aclasscovarianceBase_html_ae70f51df3976975b2dc78fd3bfc28b65"><div class="ttname"><a href="classcovarianceBase.html#ae70f51df3976975b2dc78fd3bfc28b65">covarianceBase::_fCurrVal</a></div><div class="ttdeci">std::vector&lt; double &gt; _fCurrVal</div><div class="ttdoc">Current value of the parameter.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceBase_8h_source.html#l00420">covarianceBase.h:420</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a0103e8fe156dccedee05619697fe0467"><div class="ttname"><a href="classcovarianceXsec.html#a0103e8fe156dccedee05619697fe0467">covarianceXsec::GetNumParamsFromDetID</a></div><div class="ttdeci">int GetNumParamsFromDetID(const int DetID, const SystType Type)</div><div class="ttdoc">DB Grab the number of parameters for the relevant DetID.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00293">covarianceXsec.cpp:293</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a0246245453554d222bb14cdaa53f014a"><div class="ttname"><a href="classcovarianceXsec.html#a0246245453554d222bb14cdaa53f014a">covarianceXsec::GetSystIndexFromDetID</a></div><div class="ttdeci">const std::vector&lt; int &gt; GetSystIndexFromDetID(const int DetID, const SystType Type)</div><div class="ttdoc">Grab the index of the syst relative to global numbering.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00237">covarianceXsec.cpp:237</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a02678dad88cf9dafb7d001208f8b0348"><div class="ttname"><a href="classcovarianceXsec.html#a02678dad88cf9dafb7d001208f8b0348">covarianceXsec::PrintSplineParams</a></div><div class="ttdeci">void PrintSplineParams()</div><div class="ttdoc">Prints spline parameters.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00478">covarianceXsec.cpp:478</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a17c24905af91f1fc7b806cfc39e50035"><div class="ttname"><a href="classcovarianceXsec.html#a17c24905af91f1fc7b806cfc39e50035">covarianceXsec::IterateOverParams</a></div><div class="ttdeci">void IterateOverParams(const int DetID, FilterFunc filter, ActionFunc action)</div><div class="ttdoc">Iterates over parameters and applies a filter and action function.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00329">covarianceXsec.cpp:329</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a183f01056fc0e9b42db202e944021332"><div class="ttname"><a href="classcovarianceXsec.html#a183f01056fc0e9b42db202e944021332">covarianceXsec::_fDetID</a></div><div class="ttdeci">std::vector&lt; int &gt; _fDetID</div><div class="ttdoc">Tells to which samples object param should be applied.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8h_source.html#l00153">covarianceXsec.h:153</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a2e6c281c3f7f902076043ca9776b241d"><div class="ttname"><a href="classcovarianceXsec.html#a2e6c281c3f7f902076043ca9776b241d">covarianceXsec::covarianceXsec</a></div><div class="ttdeci">covarianceXsec(const std::vector&lt; std::string &gt; &amp;FileNames, std::string name=&quot;xsec_cov&quot;, double threshold=-1, int FirstPCAdpar=-999, int LastPCAdpar=-999)</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00008">covarianceXsec.cpp:8</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a36b690efce9b6d073482e461b350871f"><div class="ttname"><a href="classcovarianceXsec.html#a36b690efce9b6d073482e461b350871f">covarianceXsec::PrintFunctionalParams</a></div><div class="ttdeci">void PrintFunctionalParams()</div><div class="ttdoc">Prints functional parameters.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00500">covarianceXsec.cpp:500</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a41d7f1b1010bddd3e938eb589a089593"><div class="ttname"><a href="classcovarianceXsec.html#a41d7f1b1010bddd3e938eb589a089593">covarianceXsec::PrintGlobablInfo</a></div><div class="ttdeci">void PrintGlobablInfo()</div><div class="ttdoc">Prints general information about the covarianceXsec object.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00392">covarianceXsec.cpp:392</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a47cd1802e0dac0c22c8c16f214272c34"><div class="ttname"><a href="classcovarianceXsec.html#a47cd1802e0dac0c22c8c16f214272c34">covarianceXsec::_ParameterGroup</a></div><div class="ttdeci">std::vector&lt; std::string &gt; _ParameterGroup</div><div class="ttdoc">KS: Allow to group parameters for example to affect only cross-section or only flux etc.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8h_source.html#l00161">covarianceXsec.h:161</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a4d3074db3c9edb7465a4409abd9c91fc"><div class="ttname"><a href="classcovarianceXsec.html#a4d3074db3c9edb7465a4409abd9c91fc">covarianceXsec::_fSplineNames</a></div><div class="ttdeci">std::vector&lt; std::string &gt; _fSplineNames</div><div class="ttdoc">Name of spline in TTree (TBranch),.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8h_source.html#l00158">covarianceXsec.h:158</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a50cca3de3274be7a57d25cc1b454e890"><div class="ttname"><a href="classcovarianceXsec.html#a50cca3de3274be7a57d25cc1b454e890">covarianceXsec::GetParamType</a></div><div class="ttdeci">SystType GetParamType(const int i) const</div><div class="ttdoc">Returns enum describing our param type.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8h_source.html#l00030">covarianceXsec.h:30</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a5b8c672fce660dd1b8d25f34ddf14474"><div class="ttname"><a href="classcovarianceXsec.html#a5b8c672fce660dd1b8d25f34ddf14474">covarianceXsec::AppliesToDetID</a></div><div class="ttdeci">bool AppliesToDetID(const int SystIndex, const int DetID) const</div><div class="ttdoc">Check if parameter is affecting given det ID.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8h_source.html#l00134">covarianceXsec.h:134</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a5cffa7b3221e1a49706ea8a9fe0f826c"><div class="ttname"><a href="classcovarianceXsec.html#a5cffa7b3221e1a49706ea8a9fe0f826c">covarianceXsec::DumpMatrixToFile</a></div><div class="ttdeci">void DumpMatrixToFile(const std::string &amp;Name)</div><div class="ttdoc">Dump Matrix to ROOT file, useful when we need to pass matrix info to another fitting group.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00586">covarianceXsec.cpp:586</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a5dc8900054a498107e39cc41641879a8"><div class="ttname"><a href="classcovarianceXsec.html#a5dc8900054a498107e39cc41641879a8">covarianceXsec::IsParFromGroup</a></div><div class="ttdeci">bool IsParFromGroup(const int i, const std::string &amp;Group)</div><div class="ttdoc">Checks if parameter belongs to a given group.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00572">covarianceXsec.cpp:572</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a63b4fb1e0caf3b71f372db7273c40c47"><div class="ttname"><a href="classcovarianceXsec.html#a63b4fb1e0caf3b71f372db7273c40c47">covarianceXsec::GetSplineModeVecFromDetID</a></div><div class="ttdeci">const std::vector&lt; std::vector&lt; int &gt; &gt; GetSplineModeVecFromDetID(const int DetID)</div><div class="ttdoc">DB Grab the Spline Modes for the relevant DetID.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00146">covarianceXsec.cpp:146</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a688e670224e9e1fac3d6de97a2016f1a"><div class="ttname"><a href="classcovarianceXsec.html#a688e670224e9e1fac3d6de97a2016f1a">covarianceXsec::CheckCorrectInitialisation</a></div><div class="ttdeci">void CheckCorrectInitialisation()</div><div class="ttdoc">KS: Check if matrix is correctly initialised.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00535">covarianceXsec.cpp:535</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a68938d9079d05782eb1f415a5204284c"><div class="ttname"><a href="classcovarianceXsec.html#a68938d9079d05782eb1f415a5204284c">covarianceXsec::GetXsecNorm</a></div><div class="ttdeci">XsecNorms4 GetXsecNorm(const YAML::Node &amp;param, const int Index)</div><div class="ttdoc">Get Norm params.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00163">covarianceXsec.cpp:163</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a6e7661f9bd67500b66c7499f776b594d"><div class="ttname"><a href="classcovarianceXsec.html#a6e7661f9bd67500b66c7499f776b594d">covarianceXsec::GetParSplineInterpolation</a></div><div class="ttdeci">SplineInterpolation GetParSplineInterpolation(const int i)</div><div class="ttdoc">Get interpolation type for a given parameter.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8h_source.html#l00034">covarianceXsec.h:34</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a7669f8e01cc0aba5670784c786ff2645"><div class="ttname"><a href="classcovarianceXsec.html#a7669f8e01cc0aba5670784c786ff2645">covarianceXsec::GetGlobalSystIndexFromDetID</a></div><div class="ttdeci">const std::vector&lt; int &gt; GetGlobalSystIndexFromDetID(const int DetID, const SystType Type)</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00222">covarianceXsec.cpp:222</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a7678bbdb59c36f032fb414d62928f47e"><div class="ttname"><a href="classcovarianceXsec.html#a7678bbdb59c36f032fb414d62928f47e">covarianceXsec::GetSplineParsNamesFromDetID</a></div><div class="ttdeci">const std::vector&lt; std::string &gt; GetSplineParsNamesFromDetID(const int DetID)</div><div class="ttdoc">DB Get spline parameters depending on given DetID.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00112">covarianceXsec.cpp:112</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a86bd213e24e1c7b574d2b07c8c5c15b8"><div class="ttname"><a href="classcovarianceXsec.html#a86bd213e24e1c7b574d2b07c8c5c15b8">covarianceXsec::GetParsNamesFromDetID</a></div><div class="ttdeci">const std::vector&lt; std::string &gt; GetParsNamesFromDetID(const int DetID, const SystType Type)</div><div class="ttdoc">DB Grab the parameter names for the relevant DetID.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00305">covarianceXsec.cpp:305</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a8b408060d825769eec6c8e4594397ec8"><div class="ttname"><a href="classcovarianceXsec.html#a8b408060d825769eec6c8e4594397ec8">covarianceXsec::PrintNormParams</a></div><div class="ttdeci">void PrintNormParams()</div><div class="ttdoc">Prints normalization parameters.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00405">covarianceXsec.cpp:405</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a8e602fcc62a2c930c89987e06af9def1"><div class="ttname"><a href="classcovarianceXsec.html#a8e602fcc62a2c930c89987e06af9def1">covarianceXsec::SetGroupOnlyParameters</a></div><div class="ttdeci">void SetGroupOnlyParameters(const std::string &amp;Group)</div><div class="ttdoc">KS Function to set to prior parameters of a given group.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00558">covarianceXsec.cpp:558</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a90bd7a32f16efc88c070e57fabafd13b"><div class="ttname"><a href="classcovarianceXsec.html#a90bd7a32f16efc88c070e57fabafd13b">covarianceXsec::InitXsecFromConfig</a></div><div class="ttdeci">void InitXsecFromConfig()</div><div class="ttdoc">Parses the YAML configuration to set up cross-section parameters. The YAML file defines the types of ...</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00027">covarianceXsec.cpp:27</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a98c68c6c894132a984c6bdd90c3e85dd"><div class="ttname"><a href="classcovarianceXsec.html#a98c68c6c894132a984c6bdd90c3e85dd">covarianceXsec::GetNormParsFromDetID</a></div><div class="ttdeci">const std::vector&lt; XsecNorms4 &gt; GetNormParsFromDetID(const int DetID)</div><div class="ttdoc">DB Get norm/func parameters depending on given DetID.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00276">covarianceXsec.cpp:276</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_a9ea6bd6b0e021f154ebd1f23605ff3e5"><div class="ttname"><a href="classcovarianceXsec.html#a9ea6bd6b0e021f154ebd1f23605ff3e5">covarianceXsec::GetParSplineKnotLowerBound</a></div><div class="ttdeci">double GetParSplineKnotLowerBound(const int i)</div><div class="ttdoc">EM: value at which we cap spline knot weight.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8h_source.html#l00048">covarianceXsec.h:48</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_aa5f13d2836d1de71dec80c0746fc05ae"><div class="ttname"><a href="classcovarianceXsec.html#aa5f13d2836d1de71dec80c0746fc05ae">covarianceXsec::GetParsIndexFromDetID</a></div><div class="ttdeci">const std::vector&lt; int &gt; GetParsIndexFromDetID(const int DetID, const SystType Type)</div><div class="ttdoc">DB Grab the parameter indices for the relevant DetID.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00317">covarianceXsec.cpp:317</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_aad522479b06581729efd6c1cd12d11df"><div class="ttname"><a href="classcovarianceXsec.html#aad522479b06581729efd6c1cd12d11df">covarianceXsec::GetParDetID</a></div><div class="ttdeci">int GetParDetID(const int i) const</div><div class="ttdoc">ETA - just return the int of the DetID, this can be removed to do a string comp at some point.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8h_source.html#l00024">covarianceXsec.h:24</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_aae3338ca71027adab7fdfd3e828c0f79"><div class="ttname"><a href="classcovarianceXsec.html#aae3338ca71027adab7fdfd3e828c0f79">covarianceXsec::_fParamType</a></div><div class="ttdeci">std::vector&lt; SystType &gt; _fParamType</div><div class="ttdoc">Type of parameter like norm, spline etc.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8h_source.html#l00155">covarianceXsec.h:155</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_ac1b149bd12637390477c5a1d82eef195"><div class="ttname"><a href="classcovarianceXsec.html#ac1b149bd12637390477c5a1d82eef195">covarianceXsec::GetSplineInterpolationFromDetID</a></div><div class="ttdeci">const std::vector&lt; SplineInterpolation &gt; GetSplineInterpolationFromDetID(int DetID)</div><div class="ttdoc">Get the interpolation types for splines affecting a particular DetID.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00126">covarianceXsec.cpp:126</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_ac612a0f939f2f070906af574f98590d6"><div class="ttname"><a href="classcovarianceXsec.html#ac612a0f939f2f070906af574f98590d6">covarianceXsec::GetParSplineKnotUpperBound</a></div><div class="ttdeci">double GetParSplineKnotUpperBound(const int i)</div><div class="ttdoc">EM: value at which we cap spline knot weight.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8h_source.html#l00045">covarianceXsec.h:45</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_acd6c2346a5b808c6917e4828bbb633f5"><div class="ttname"><a href="classcovarianceXsec.html#acd6c2346a5b808c6917e4828bbb633f5">covarianceXsec::NormParams</a></div><div class="ttdeci">std::vector&lt; XsecNorms4 &gt; NormParams</div><div class="ttdoc">Vector containing info for normalisation systematics.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8h_source.html#l00170">covarianceXsec.h:170</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_acf3b87f72369d597d27d2a32fc01e779"><div class="ttname"><a href="classcovarianceXsec.html#acf3b87f72369d597d27d2a32fc01e779">covarianceXsec::GetXsecSpline</a></div><div class="ttdeci">XsecSplines1 GetXsecSpline(const YAML::Node &amp;param)</div><div class="ttdoc">Get Spline params.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00252">covarianceXsec.cpp:252</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_adddfbaa235113603542826df331ed61e"><div class="ttname"><a href="classcovarianceXsec.html#adddfbaa235113603542826df331ed61e">covarianceXsec::_fSystToGlobalSystIndexMap</a></div><div class="ttdeci">std::vector&lt; std::map&lt; int, int &gt; &gt; _fSystToGlobalSystIndexMap</div><div class="ttdoc">Map between number of given parameter type with global parameter numbering. For example 2nd norm para...</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8h_source.html#l00164">covarianceXsec.h:164</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_ade0e8f83dcf75c50e6dad08ab6715093"><div class="ttname"><a href="classcovarianceXsec.html#ade0e8f83dcf75c50e6dad08ab6715093">covarianceXsec::Print</a></div><div class="ttdeci">void Print()</div><div class="ttdoc">Print information about the whole object once it is set.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00369">covarianceXsec.cpp:369</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_ae62615b039cb1e1510934406200bde3a"><div class="ttname"><a href="classcovarianceXsec.html#ae62615b039cb1e1510934406200bde3a">covarianceXsec::PrintParameterGroups</a></div><div class="ttdeci">void PrintParameterGroups()</div><div class="ttdoc">Prints groups of parameters.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00516">covarianceXsec.cpp:516</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_ae95bafab0c674dc838635aaeca40bc2c"><div class="ttname"><a href="classcovarianceXsec.html#ae95bafab0c674dc838635aaeca40bc2c">covarianceXsec::SplineParams</a></div><div class="ttdeci">std::vector&lt; XsecSplines1 &gt; SplineParams</div><div class="ttdoc">Vector containing info for normalisation systematics.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8h_source.html#l00167">covarianceXsec.h:167</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_aea65a8b1ad6399f0b9f356810249bfd1"><div class="ttname"><a href="classcovarianceXsec.html#aea65a8b1ad6399f0b9f356810249bfd1">covarianceXsec::initParams</a></div><div class="ttdeci">void initParams()</div><div class="ttdoc">Initializes the systematic parameters from the configuration file. This function loads parameters lik...</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00339">covarianceXsec.cpp:339</a></div></div>
<div class="ttc" id="aclasscovarianceXsec_html_af84383b735f450c33c9c34f7ca207a66"><div class="ttname"><a href="classcovarianceXsec.html#af84383b735f450c33c9c34f7ca207a66">covarianceXsec::~covarianceXsec</a></div><div class="ttdeci">~covarianceXsec()</div><div class="ttdoc">Destructor.</div><div class="ttdef"><b>Definition:</b> <a href="covarianceXsec_8cpp_source.html#l00105">covarianceXsec.cpp:105</a></div></div>
<div class="ttc" id="acovarianceXsec_8h_html"><div class="ttname"><a href="covarianceXsec_8h.html">covarianceXsec.h</a></div></div>
<div class="ttc" id="astructXsecNorms4_html"><div class="ttname"><a href="structXsecNorms4.html">XsecNorms4</a></div><div class="ttdoc">ETA - Normalisations for cross-section parameters Carrier for whether you want to apply a systematic ...</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00088">Structs.h:88</a></div></div>
<div class="ttc" id="astructXsecNorms4_html_a0f6b21994200f446f21c42ec1cebf9bb"><div class="ttname"><a href="structXsecNorms4.html#a0f6b21994200f446f21c42ec1cebf9bb">XsecNorms4::targets</a></div><div class="ttdeci">std::vector&lt; int &gt; targets</div><div class="ttdoc">Targets which parameter applies to.</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00101">Structs.h:101</a></div></div>
<div class="ttc" id="astructXsecNorms4_html_a1723c13b5d04cff5ce48718cae5b6e14"><div class="ttname"><a href="structXsecNorms4.html#a1723c13b5d04cff5ce48718cae5b6e14">XsecNorms4::Selection</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; Selection</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00106">Structs.h:106</a></div></div>
<div class="ttc" id="astructXsecNorms4_html_a67a1d237f1fdb41a0c11898fada0f00c"><div class="ttname"><a href="structXsecNorms4.html#a67a1d237f1fdb41a0c11898fada0f00c">XsecNorms4::KinematicVarStr</a></div><div class="ttdeci">std::vector&lt; std::string &gt; KinematicVarStr</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00112">Structs.h:112</a></div></div>
<div class="ttc" id="astructXsecNorms4_html_a6c45244b8c559ada13c1c886dea37cc2"><div class="ttname"><a href="structXsecNorms4.html#a6c45244b8c559ada13c1c886dea37cc2">XsecNorms4::index</a></div><div class="ttdeci">int index</div><div class="ttdoc">Parameter number of this normalisation in current systematic model.</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00115">Structs.h:115</a></div></div>
<div class="ttc" id="astructXsecNorms4_html_a848104ff97acc9a0df9861acc8615aa7"><div class="ttname"><a href="structXsecNorms4.html#a848104ff97acc9a0df9861acc8615aa7">XsecNorms4::name</a></div><div class="ttdeci">std::string name</div><div class="ttdoc">Name of parameters.</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00091">Structs.h:91</a></div></div>
<div class="ttc" id="astructXsecNorms4_html_ab5d815107d57b4f7ae22ccb3f2ae318b"><div class="ttname"><a href="structXsecNorms4.html#ab5d815107d57b4f7ae22ccb3f2ae318b">XsecNorms4::hasKinBounds</a></div><div class="ttdeci">bool hasKinBounds</div><div class="ttdoc">Does this parameter have kinematic bounds.</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00103">Structs.h:103</a></div></div>
<div class="ttc" id="astructXsecNorms4_html_ac2e3b749d0c629e425861d2f6ecf82b0"><div class="ttname"><a href="structXsecNorms4.html#ac2e3b749d0c629e425861d2f6ecf82b0">XsecNorms4::preoscpdgs</a></div><div class="ttdeci">std::vector&lt; int &gt; preoscpdgs</div><div class="ttdoc">Preosc PDG which parameter applies to.</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00099">Structs.h:99</a></div></div>
<div class="ttc" id="astructXsecNorms4_html_ad0632d5a94a37ee5ce297698abadd844"><div class="ttname"><a href="structXsecNorms4.html#ad0632d5a94a37ee5ce297698abadd844">XsecNorms4::modes</a></div><div class="ttdeci">std::vector&lt; int &gt; modes</div><div class="ttdoc">Mode which parameter applies to.</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00093">Structs.h:93</a></div></div>
<div class="ttc" id="astructXsecNorms4_html_afed4b95759559016df72bfed03763b6e"><div class="ttname"><a href="structXsecNorms4.html#afed4b95759559016df72bfed03763b6e">XsecNorms4::pdgs</a></div><div class="ttdeci">std::vector&lt; int &gt; pdgs</div><div class="ttdoc">PDG which parameter applies to.</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00097">Structs.h:97</a></div></div>
<div class="ttc" id="astructXsecSplines1_html"><div class="ttname"><a href="structXsecSplines1.html">XsecSplines1</a></div><div class="ttdoc">KS: Struct holding info about Spline Systematics.</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00227">Structs.h:227</a></div></div>
<div class="ttc" id="astructXsecSplines1_html_a44d06d261a524bf6d7e1b3e2b3ae08c0"><div class="ttname"><a href="structXsecSplines1.html#a44d06d261a524bf6d7e1b3e2b3ae08c0">XsecSplines1::_SplineKnotLowBound</a></div><div class="ttdeci">double _SplineKnotLowBound</div><div class="ttdoc">EM: Cap spline knot lower value.</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00236">Structs.h:236</a></div></div>
<div class="ttc" id="astructXsecSplines1_html_a70fd38fe1866c2672c4d733d994886c9"><div class="ttname"><a href="structXsecSplines1.html#a70fd38fe1866c2672c4d733d994886c9">XsecSplines1::_fSplineModes</a></div><div class="ttdeci">std::vector&lt; int &gt; _fSplineModes</div><div class="ttdoc">Modes to which spline applies (valid only for binned splines)</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00233">Structs.h:233</a></div></div>
<div class="ttc" id="astructXsecSplines1_html_aa253e0c9ad458756613665a5e28e8f3c"><div class="ttname"><a href="structXsecSplines1.html#aa253e0c9ad458756613665a5e28e8f3c">XsecSplines1::_SplineKnotUpBound</a></div><div class="ttdeci">double _SplineKnotUpBound</div><div class="ttdoc">EM: Cap spline knot higher value.</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00238">Structs.h:238</a></div></div>
<div class="ttc" id="astructXsecSplines1_html_aaa0e82ade2dbe697f625c06d9c79cffb"><div class="ttname"><a href="structXsecSplines1.html#aaa0e82ade2dbe697f625c06d9c79cffb">XsecSplines1::_SplineInterpolationType</a></div><div class="ttdeci">SplineInterpolation _SplineInterpolationType</div><div class="ttdoc">Spline interpolation vector.</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00230">Structs.h:230</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<footer class="mach3-footer" style="text-align: center;">
    <div style="margin-bottom: 15px;">
        <span style="font-weight: bold;">The MaCh3 Collaboration</span>
    </div>
    <div style="margin-bottom: 10px;">
        <span>Select Software Version: </span>
        <select id="versionSelector" onchange="window.location.href=this.value" style="padding: 5px; border-radius: 4px; border: 1px solid #ccc;">
            <option value="">-- Select --</option>
            <option value="https://mach3-software.github.io/MaCh3/">develop</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.2.0/index.html">v2.2.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.1.0/index.html">v2.1.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.0.0/index.html">v2.0.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.5.0/index.html">v1.5.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.4.0/index.html">v1.4.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.3.0/index.html">v1.3.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.2.0/index.html">v1.2.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.1.0/index.html">v1.1.0</option>
        </select>
    </div>
    <div style="font-size: 0.9em; color: #666; margin-top: 10px;">
        Documentation generated with <a href="https://www.doxygen.nl/" target="_blank" style="color: #666;">Doxygen</a>
    </div>
</footer>
