<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MaCh3: SampleHandlerBase Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="MaCh3.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mach3logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MaCh3
   &#160;<span id="projectnumber">2.4.2</span>
   </div>
   <div id="projectbrief">Reference Guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classSampleHandlerBase-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">SampleHandlerBase Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span><div class="ingroups"><a class="el" href="group__CoreClasses.html">Core Classes</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Class responsible for handling implementation of samples used in analysis, reweighting and returning LLH.  
 <a href="classSampleHandlerBase.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="SampleHandlerBase_8h_source.html">Samples/SampleHandlerBase.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for SampleHandlerBase:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classSampleHandlerBase__inherit__graph.svg" width="331" height="187"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for SampleHandlerBase:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classSampleHandlerBase__coll__graph.svg" width="224" height="127"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a6a6d7e5d275154ed550cd6c9dfc36000"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a6a6d7e5d275154ed550cd6c9dfc36000">SampleHandlerBase</a> ()</td></tr>
<tr class="memdesc:a6a6d7e5d275154ed550cd6c9dfc36000"><td class="mdescLeft">&#160;</td><td class="mdescRight">The main constructor.  <a href="classSampleHandlerBase.html#a6a6d7e5d275154ed550cd6c9dfc36000">More...</a><br /></td></tr>
<tr class="separator:a6a6d7e5d275154ed550cd6c9dfc36000"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07b6726b71241ea71e12cfa78fbc49ed"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a07b6726b71241ea71e12cfa78fbc49ed">~SampleHandlerBase</a> ()</td></tr>
<tr class="memdesc:a07b6726b71241ea71e12cfa78fbc49ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">destructor  <a href="classSampleHandlerBase.html#a07b6726b71241ea71e12cfa78fbc49ed">More...</a><br /></td></tr>
<tr class="separator:a07b6726b71241ea71e12cfa78fbc49ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4b73a8841ff9bab2fb08b578ad4137f"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#ac4b73a8841ff9bab2fb08b578ad4137f">GetNsamples</a> ()</td></tr>
<tr class="separator:ac4b73a8841ff9bab2fb08b578ad4137f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3df6900450be4bbb05453e3b166e09e"><td class="memItemLeft" align="right" valign="top">virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#ad3df6900450be4bbb05453e3b166e09e">GetSampleTitle</a> (const int Sample) const =0</td></tr>
<tr class="separator:ad3df6900450be4bbb05453e3b166e09e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc0365a430cbe628f5ec63ef49bf6f5e"><td class="memItemLeft" align="right" valign="top">virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#adc0365a430cbe628f5ec63ef49bf6f5e">GetName</a> () const =0</td></tr>
<tr class="separator:adc0365a430cbe628f5ec63ef49bf6f5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60ce18ee8d7adbc78b9be1269f081aa3"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a60ce18ee8d7adbc78b9be1269f081aa3">GetSampleLikelihood</a> (const int isample) const =0</td></tr>
<tr class="separator:a60ce18ee8d7adbc78b9be1269f081aa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6e807de9ac80fb9f12722e033c44f7e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#ab6e807de9ac80fb9f12722e033c44f7e">CleanMemoryBeforeFit</a> ()=0</td></tr>
<tr class="memdesc:ab6e807de9ac80fb9f12722e033c44f7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allow to clean not used memory before fit starts.  <a href="classSampleHandlerBase.html#ab6e807de9ac80fb9f12722e033c44f7e">More...</a><br /></td></tr>
<tr class="separator:ab6e807de9ac80fb9f12722e033c44f7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abaee29f1c5b8229417a0de3b5a36ddb0"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#abaee29f1c5b8229417a0de3b5a36ddb0">SaveAdditionalInfo</a> (TDirectory *Dir)</td></tr>
<tr class="memdesc:abaee29f1c5b8229417a0de3b5a36ddb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Store additional info in a chan.  <a href="classSampleHandlerBase.html#abaee29f1c5b8229417a0de3b5a36ddb0">More...</a><br /></td></tr>
<tr class="separator:abaee29f1c5b8229417a0de3b5a36ddb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e232eb59bc09c3f8ff4cbed69fcd688"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMaCh3Modes.html">MaCh3Modes</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a4e232eb59bc09c3f8ff4cbed69fcd688">GetMaCh3Modes</a> () const</td></tr>
<tr class="memdesc:a4e232eb59bc09c3f8ff4cbed69fcd688"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to MaCh3 modes.  <a href="classSampleHandlerBase.html#a4e232eb59bc09c3f8ff4cbed69fcd688">More...</a><br /></td></tr>
<tr class="separator:a4e232eb59bc09c3f8ff4cbed69fcd688"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3efb49c2a39d87b71e4dec7c7115fa88"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a3efb49c2a39d87b71e4dec7c7115fa88">Reweight</a> ()=0</td></tr>
<tr class="separator:a3efb49c2a39d87b71e4dec7c7115fa88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4cd44c594061bfc45da228220dcd950"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#ac4cd44c594061bfc45da228220dcd950">GetLikelihood</a> () const =0</td></tr>
<tr class="separator:ac4cd44c594061bfc45da228220dcd950"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd2dfe54e6c99965f68ee08c2deba7d7"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#afd2dfe54e6c99965f68ee08c2deba7d7">PrintRates</a> (const bool DataOnly=false)=0</td></tr>
<tr class="memdesc:afd2dfe54e6c99965f68ee08c2deba7d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to print rates for the samples with LLH.  <a href="classSampleHandlerBase.html#afd2dfe54e6c99965f68ee08c2deba7d7">More...</a><br /></td></tr>
<tr class="separator:afd2dfe54e6c99965f68ee08c2deba7d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ceca02f83e878ef1aec6e54e7b2f331"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a6ceca02f83e878ef1aec6e54e7b2f331">GetNEvents</a> () const</td></tr>
<tr class="separator:a6ceca02f83e878ef1aec6e54e7b2f331"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d9a63f16c4acc2ab7bdd39df77712d4"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a9d9a63f16c4acc2ab7bdd39df77712d4">GetNOscChannels</a> (const int iSample) const =0</td></tr>
<tr class="separator:a9d9a63f16c4acc2ab7bdd39df77712d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e55d089cbc7f13fbe43308e654e723d"><td class="memItemLeft" align="right" valign="top">virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a1e55d089cbc7f13fbe43308e654e723d">GetKinVarName</a> (const int iSample, const int Dimension) const =0</td></tr>
<tr class="memdesc:a1e55d089cbc7f13fbe43308e654e723d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return Kinematic Variable name for specified sample and dimension for example "Reconstructed_Neutrino_Energy".  <a href="classSampleHandlerBase.html#a1e55d089cbc7f13fbe43308e654e723d">More...</a><br /></td></tr>
<tr class="separator:a1e55d089cbc7f13fbe43308e654e723d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae30e9cf2ee9dfa805f9a87432558e600"><td class="memItemLeft" align="right" valign="top">virtual TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#ae30e9cf2ee9dfa805f9a87432558e600">GetDataHist</a> (const int Sample)=0</td></tr>
<tr class="memdesc:ae30e9cf2ee9dfa805f9a87432558e600"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get Data histogram.  <a href="classSampleHandlerBase.html#ae30e9cf2ee9dfa805f9a87432558e600">More...</a><br /></td></tr>
<tr class="separator:ae30e9cf2ee9dfa805f9a87432558e600"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a6f0525d4e4f941fc1af4709042add3"><td class="memItemLeft" align="right" valign="top">virtual TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a7a6f0525d4e4f941fc1af4709042add3">GetMCHist</a> (const int Sample)=0</td></tr>
<tr class="memdesc:a7a6f0525d4e4f941fc1af4709042add3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get MC histogram.  <a href="classSampleHandlerBase.html#a7a6f0525d4e4f941fc1af4709042add3">More...</a><br /></td></tr>
<tr class="separator:a7a6f0525d4e4f941fc1af4709042add3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ea53e5e6adb5b4e6281a3d1ce910c3a"><td class="memItemLeft" align="right" valign="top">virtual TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a5ea53e5e6adb5b4e6281a3d1ce910c3a">GetW2Hist</a> (const int Sample)=0</td></tr>
<tr class="memdesc:a5ea53e5e6adb5b4e6281a3d1ce910c3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get W2 histogram.  <a href="classSampleHandlerBase.html#a5ea53e5e6adb5b4e6281a3d1ce910c3a">More...</a><br /></td></tr>
<tr class="separator:a5ea53e5e6adb5b4e6281a3d1ce910c3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2eca1fb4ee3bc3a4852fce4d0abb5b3"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#ae2eca1fb4ee3bc3a4852fce4d0abb5b3">GetNDim</a> (const int Sample) const =0</td></tr>
<tr class="memdesc:ae2eca1fb4ee3bc3a4852fce4d0abb5b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">DB Function to differentiate 1D or 2D binning.  <a href="classSampleHandlerBase.html#ae2eca1fb4ee3bc3a4852fce4d0abb5b3">More...</a><br /></td></tr>
<tr class="separator:ae2eca1fb4ee3bc3a4852fce4d0abb5b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ece7768a8c337d89f6841865b7e2ff9"><td class="memItemLeft" align="right" valign="top">virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a5ece7768a8c337d89f6841865b7e2ff9">GetFlavourName</a> (const int iSample, const int iChannel) const =0</td></tr>
<tr class="separator:a5ece7768a8c337d89f6841865b7e2ff9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab140c97a440fec2ea4a62a481992c81"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#aab140c97a440fec2ea4a62a481992c81">ReturnKinematicParameterBinning</a> (const int Sample, const std::string &amp;KinematicParameter) const =0</td></tr>
<tr class="memdesc:aab140c97a440fec2ea4a62a481992c81"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the binning used to draw a kinematic parameter.  <a href="classSampleHandlerBase.html#aab140c97a440fec2ea4a62a481992c81">More...</a><br /></td></tr>
<tr class="separator:aab140c97a440fec2ea4a62a481992c81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a764b98b3c56f3bd04a279b0810b87a21"><td class="memItemLeft" align="right" valign="top">virtual TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a764b98b3c56f3bd04a279b0810b87a21">Get1DVarHistByModeAndChannel</a> (const int iSample, const std::string &amp;ProjectionVar_Str, int kModeToFill=-1, int kChannelToFill=-1, int WeightStyle=0, TAxis *Axis=nullptr)=0</td></tr>
<tr class="separator:a764b98b3c56f3bd04a279b0810b87a21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2ae5fc7a84bce5c570a9a1aae0ba126"><td class="memItemLeft" align="right" valign="top">virtual TH2 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#ae2ae5fc7a84bce5c570a9a1aae0ba126">Get2DVarHistByModeAndChannel</a> (const int iSample, const std::string &amp;ProjectionVar_StrX, const std::string &amp;ProjectionVar_StrY, int kModeToFill=-1, int kChannelToFill=-1, int WeightStyle=0, TAxis *AxisX=nullptr, TAxis *AxisY=nullptr)=0</td></tr>
<tr class="separator:ae2ae5fc7a84bce5c570a9a1aae0ba126"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e2aa3101b5f41d0fe6a08e2668bfc09"><td class="memItemLeft" align="right" valign="top">virtual TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a7e2aa3101b5f41d0fe6a08e2668bfc09">Get1DVarHist</a> (const int iSample, const std::string &amp;ProjectionVar, const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;EventSelectionVec={}, int WeightStyle=0, TAxis *Axis=nullptr, const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;SubEventSelectionVec={})=0</td></tr>
<tr class="separator:a7e2aa3101b5f41d0fe6a08e2668bfc09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6198a3752b7965d7548efb708f0b7df1"><td class="memItemLeft" align="right" valign="top">virtual TH2 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a6198a3752b7965d7548efb708f0b7df1">Get2DVarHist</a> (const int iSample, const std::string &amp;ProjectionVarX, const std::string &amp;ProjectionVarY, const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;EventSelectionVec={}, int WeightStyle=0, TAxis *AxisX=nullptr, TAxis *AxisY=nullptr, const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;SubEventSelectionVec={})=0</td></tr>
<tr class="separator:a6198a3752b7965d7548efb708f0b7df1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5849766fbbc7aa71672da8b0f189fe5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#ae5849766fbbc7aa71672da8b0f189fe5">GetPoissonLLH</a> (const double data, const double mc) const</td></tr>
<tr class="memdesc:ae5849766fbbc7aa71672da8b0f189fe5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate test statistic for a single bin using Poisson.  <a href="classSampleHandlerBase.html#ae5849766fbbc7aa71672da8b0f189fe5">More...</a><br /></td></tr>
<tr class="separator:ae5849766fbbc7aa71672da8b0f189fe5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a527307a4186e2eb61475ea975108aa65"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a527307a4186e2eb61475ea975108aa65">GetTestStatLLH</a> (const double data, const double mc, const double w2) const</td></tr>
<tr class="memdesc:a527307a4186e2eb61475ea975108aa65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate test statistic for a single bin. Calculation depends on setting of <code>fTestStatistic</code>. Data and mc -&gt; 0 cut-offs are defined in <a class="el" href="namespaceM3.html" title="Main namespace for MaCh3 software.">M3</a>::<em>LOW_MC_BOUND</em>.  <a href="classSampleHandlerBase.html#a527307a4186e2eb61475ea975108aa65">More...</a><br /></td></tr>
<tr class="separator:a527307a4186e2eb61475ea975108aa65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c81b6b7a7e70b04c6c6ca1c81c70fc5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a1c81b6b7a7e70b04c6c6ca1c81c70fc5">SetTestStatistic</a> (<a class="el" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67">TestStatistic</a> testStat)</td></tr>
<tr class="memdesc:a1c81b6b7a7e70b04c6c6ca1c81c70fc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the test statistic to be used when calculating the binned likelihoods.  <a href="classSampleHandlerBase.html#a1c81b6b7a7e70b04c6c6ca1c81c70fc5">More...</a><br /></td></tr>
<tr class="separator:a1c81b6b7a7e70b04c6c6ca1c81c70fc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a619c91c640207a243d0868d386359c52"><td class="memItemLeft" align="right" valign="top"><a class="el" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67">TestStatistic</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a619c91c640207a243d0868d386359c52">GetTestStatistic</a> () const</td></tr>
<tr class="memdesc:a619c91c640207a243d0868d386359c52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the test statistic used when calculating the binned likelihoods.  <a href="classSampleHandlerBase.html#a619c91c640207a243d0868d386359c52">More...</a><br /></td></tr>
<tr class="separator:a619c91c640207a243d0868d386359c52"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ad1e91b3accfd9269e794f43aa7f9b979"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#ad1e91b3accfd9269e794f43aa7f9b979">QuietPlease</a> ()</td></tr>
<tr class="memdesc:ad1e91b3accfd9269e794f43aa7f9b979"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Redirect std::cout to silence some experiment specific libraries.  <a href="classSampleHandlerBase.html#ad1e91b3accfd9269e794f43aa7f9b979">More...</a><br /></td></tr>
<tr class="separator:ad1e91b3accfd9269e794f43aa7f9b979"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2da39aacd5ba10a3a745d546eccb859f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a2da39aacd5ba10a3a745d546eccb859f">NowTalk</a> ()</td></tr>
<tr class="memdesc:a2da39aacd5ba10a3a745d546eccb859f"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Redirect std::cout to silence some experiment specific libraries.  <a href="classSampleHandlerBase.html#a2da39aacd5ba10a3a745d546eccb859f">More...</a><br /></td></tr>
<tr class="separator:a2da39aacd5ba10a3a745d546eccb859f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad16c838d4dc86e98445f199a16cf9bdf"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ad16c838d4dc86e98445f199a16cf9bdf"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#ad16c838d4dc86e98445f199a16cf9bdf">MatchCondition</a> (const std::vector&lt; T &gt; &amp;allowedValues, const T &amp;value)</td></tr>
<tr class="memdesc:ad16c838d4dc86e98445f199a16cf9bdf"><td class="mdescLeft">&#160;</td><td class="mdescRight">check if event is affected by following conditions, for example pdg, or modes etc  <a href="classSampleHandlerBase.html#ad16c838d4dc86e98445f199a16cf9bdf">More...</a><br /></td></tr>
<tr class="separator:ad16c838d4dc86e98445f199a16cf9bdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a87670dbcda5d09b09675e8f407fe3a30"><td class="memItemLeft" align="right" valign="top"><a class="el" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67">TestStatistic</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a87670dbcda5d09b09675e8f407fe3a30">fTestStatistic</a></td></tr>
<tr class="memdesc:a87670dbcda5d09b09675e8f407fe3a30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test statistic tells what kind of likelihood sample is using.  <a href="classSampleHandlerBase.html#a87670dbcda5d09b09675e8f407fe3a30">More...</a><br /></td></tr>
<tr class="separator:a87670dbcda5d09b09675e8f407fe3a30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47d291148fa6153a7e05beebde6cfdb9"><td class="memItemLeft" align="right" valign="top">std::streambuf *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a47d291148fa6153a7e05beebde6cfdb9">buf</a></td></tr>
<tr class="memdesc:a47d291148fa6153a7e05beebde6cfdb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Keep the cout buffer.  <a href="classSampleHandlerBase.html#a47d291148fa6153a7e05beebde6cfdb9">More...</a><br /></td></tr>
<tr class="separator:a47d291148fa6153a7e05beebde6cfdb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b884367733c4f3a93c75127ed6e9df9"><td class="memItemLeft" align="right" valign="top">std::streambuf *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a6b884367733c4f3a93c75127ed6e9df9">errbuf</a></td></tr>
<tr class="memdesc:a6b884367733c4f3a93c75127ed6e9df9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Keep the cerr buffer.  <a href="classSampleHandlerBase.html#a6b884367733c4f3a93c75127ed6e9df9">More...</a><br /></td></tr>
<tr class="separator:a6b884367733c4f3a93c75127ed6e9df9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7a13af22c2314c718fb6438d493d3d1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#aa7a13af22c2314c718fb6438d493d3d1">nSamples</a></td></tr>
<tr class="memdesc:aa7a13af22c2314c718fb6438d493d3d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contains how many samples we've got.  <a href="classSampleHandlerBase.html#aa7a13af22c2314c718fb6438d493d3d1">More...</a><br /></td></tr>
<tr class="separator:aa7a13af22c2314c718fb6438d493d3d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab497b52d94868283a8a7cedbd1a4d777"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#ab497b52d94868283a8a7cedbd1a4d777">nEvents</a></td></tr>
<tr class="memdesc:ab497b52d94868283a8a7cedbd1a4d777"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of MC events are there.  <a href="classSampleHandlerBase.html#ab497b52d94868283a8a7cedbd1a4d777">More...</a><br /></td></tr>
<tr class="separator:ab497b52d94868283a8a7cedbd1a4d777"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f86c6158b755b9d2d400415ccac45f2"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classMaCh3Modes.html">MaCh3Modes</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a></td></tr>
<tr class="memdesc:a2f86c6158b755b9d2d400415ccac45f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds information about used Generator and MaCh3 modes.  <a href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">More...</a><br /></td></tr>
<tr class="separator:a2f86c6158b755b9d2d400415ccac45f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class responsible for handling implementation of samples used in analysis, reweighting and returning LLH. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8h_source.html#l00026">26</a> of file <a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a6a6d7e5d275154ed550cd6c9dfc36000"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a6d7e5d275154ed550cd6c9dfc36000">&#9670;&nbsp;</a></span>SampleHandlerBase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SampleHandlerBase::SampleHandlerBase </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The main constructor. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8cpp_source.html#l00004">4</a> of file <a class="el" href="SampleHandlerBase_8cpp_source.html">SampleHandlerBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;                                     {</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;  <a class="code" href="classSampleHandlerBase.html#ab497b52d94868283a8a7cedbd1a4d777">nEvents</a> = 0;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  <a class="code" href="classSampleHandlerBase.html#aa7a13af22c2314c718fb6438d493d3d1">nSamples</a> = 0;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerBase_html_aa7a13af22c2314c718fb6438d493d3d1"><div class="ttname"><a href="classSampleHandlerBase.html#aa7a13af22c2314c718fb6438d493d3d1">SampleHandlerBase::nSamples</a></div><div class="ttdeci">M3::int_t nSamples</div><div class="ttdoc">Contains how many samples we've got.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00210">SampleHandlerBase.h:210</a></div></div>
<div class="ttc" id="aclassSampleHandlerBase_html_ab497b52d94868283a8a7cedbd1a4d777"><div class="ttname"><a href="classSampleHandlerBase.html#ab497b52d94868283a8a7cedbd1a4d777">SampleHandlerBase::nEvents</a></div><div class="ttdeci">unsigned int nEvents</div><div class="ttdoc">Number of MC events are there.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00213">SampleHandlerBase.h:213</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a07b6726b71241ea71e12cfa78fbc49ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07b6726b71241ea71e12cfa78fbc49ed">&#9670;&nbsp;</a></span>~SampleHandlerBase()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SampleHandlerBase::~SampleHandlerBase </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>destructor </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8cpp_source.html#l00011">11</a> of file <a class="el" href="SampleHandlerBase_8cpp_source.html">SampleHandlerBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;                                      {</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ab6e807de9ac80fb9f12722e033c44f7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6e807de9ac80fb9f12722e033c44f7e">&#9670;&nbsp;</a></span>CleanMemoryBeforeFit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void SampleHandlerBase::CleanMemoryBeforeFit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allow to clean not used memory before fit starts. </p>

<p>Implemented in <a class="el" href="classPySampleHandlerFD.html#a2a723b3ba22bd94a4f250e5c35332ee9">PySampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#a5c795e9eed36782d6193f7f88372153b">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="a7e2aa3101b5f41d0fe6a08e2668bfc09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e2aa3101b5f41d0fe6a08e2668bfc09">&#9670;&nbsp;</a></span>Get1DVarHist()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual TH1* SampleHandlerBase::Get1DVarHist </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>EventSelectionVec</em> = <code>{}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>Axis</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>SubEventSelectionVec</em> = <code>{}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classSampleHandlerFD.html#a968ebdb74da3d252803215da8cec387e">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#a2608a8ca9845037f7e0a3c8c04807eb5">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="a764b98b3c56f3bd04a279b0810b87a21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a764b98b3c56f3bd04a279b0810b87a21">&#9670;&nbsp;</a></span>Get1DVarHistByModeAndChannel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual TH1* SampleHandlerBase::Get1DVarHistByModeAndChannel </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVar_Str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kModeToFill</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kChannelToFill</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>Axis</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classSampleHandlerFD.html#afa55768f84faef3f9f438d197dd46194">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#af6d2a9b08e8aba240f5893a9de38033b">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="a6198a3752b7965d7548efb708f0b7df1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6198a3752b7965d7548efb708f0b7df1">&#9670;&nbsp;</a></span>Get2DVarHist()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual TH2* SampleHandlerBase::Get2DVarHist </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVarX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVarY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>EventSelectionVec</em> = <code>{}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>AxisX</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>AxisY</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structKinematicCut.html">KinematicCut</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>SubEventSelectionVec</em> = <code>{}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classSampleHandlerFD.html#a9ae5d89712796bfe77f985656235c93b">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#abf498059aa72b0455e00b9daff793d54">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="ae2ae5fc7a84bce5c570a9a1aae0ba126"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2ae5fc7a84bce5c570a9a1aae0ba126">&#9670;&nbsp;</a></span>Get2DVarHistByModeAndChannel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual TH2* SampleHandlerBase::Get2DVarHistByModeAndChannel </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVar_StrX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ProjectionVar_StrY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kModeToFill</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kChannelToFill</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>WeightStyle</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>AxisX</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TAxis *&#160;</td>
          <td class="paramname"><em>AxisY</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classSampleHandlerFD.html#a86394ef51d6bab1b9943f11774e99c23">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#afc9be3f9a7e872bdeaa81603237400c2">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="ae30e9cf2ee9dfa805f9a87432558e600"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae30e9cf2ee9dfa805f9a87432558e600">&#9670;&nbsp;</a></span>GetDataHist()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual TH1* SampleHandlerBase::GetDataHist </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get Data histogram. </p>

<p>Implemented in <a class="el" href="classSampleHandlerFD.html#ac2fa527d43bfe7b5dccf767b2445fbb0">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#abf412be6b795ad8d4b76e0d0d8a737ce">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="a5ece7768a8c337d89f6841865b7e2ff9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ece7768a8c337d89f6841865b7e2ff9">&#9670;&nbsp;</a></span>GetFlavourName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::string SampleHandlerBase::GetFlavourName </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iChannel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classSampleHandlerFD.html#a802e5b253f0b23d1e206ef9c0008301a">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#abea063c5548246405ff9138285909d50">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="a1e55d089cbc7f13fbe43308e654e723d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e55d089cbc7f13fbe43308e654e723d">&#9670;&nbsp;</a></span>GetKinVarName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::string SampleHandlerBase::GetKinVarName </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Dimension</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return Kinematic Variable name for specified sample and dimension for example "Reconstructed_Neutrino_Energy". </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iSample</td><td>Sample index </td></tr>
    <tr><td class="paramname">Dimension</td><td>Dimension index </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classSampleHandlerFD.html#a7f3923d1e2b39df2e1bf2348312925a6">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#a8dab325f56215c56ecf058707459dfb9">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="ac4cd44c594061bfc45da228220dcd950"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4cd44c594061bfc45da228220dcd950">&#9670;&nbsp;</a></span>GetLikelihood()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double SampleHandlerBase::GetLikelihood </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classSampleHandlerFD.html#a25b63e394dab02d0b2d278ff55642fd9">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#a6bcfa5975956a489634a8540d3f231c1">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="a4e232eb59bc09c3f8ff4cbed69fcd688"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e232eb59bc09c3f8ff4cbed69fcd688">&#9670;&nbsp;</a></span>GetMaCh3Modes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMaCh3Modes.html">MaCh3Modes</a>* SampleHandlerBase::GetMaCh3Modes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return pointer to MaCh3 modes. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8h_source.html#l00043">43</a> of file <a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">Modes</a>.get(); }</div>
<div class="ttc" id="aclassSampleHandlerBase_html_a2f86c6158b755b9d2d400415ccac45f2"><div class="ttname"><a href="classSampleHandlerBase.html#a2f86c6158b755b9d2d400415ccac45f2">SampleHandlerBase::Modes</a></div><div class="ttdeci">std::unique_ptr&lt; MaCh3Modes &gt; Modes</div><div class="ttdoc">Holds information about used Generator and MaCh3 modes.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00216">SampleHandlerBase.h:216</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a6f0525d4e4f941fc1af4709042add3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a6f0525d4e4f941fc1af4709042add3">&#9670;&nbsp;</a></span>GetMCHist()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual TH1* SampleHandlerBase::GetMCHist </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get MC histogram. </p>

<p>Implemented in <a class="el" href="classSampleHandlerFD.html#aef4a66f22b067c8125af5fe799f5a804">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#a20e359c2f53e3266215392cf129a50f9">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="adc0365a430cbe628f5ec63ef49bf6f5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc0365a430cbe628f5ec63ef49bf6f5e">&#9670;&nbsp;</a></span>GetName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::string SampleHandlerBase::GetName </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classSampleHandlerFD.html#a6101b46360ae54fe37dd1243f3f7f51e">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#a239f38bf2aca5262213196c0ff26e6cd">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="ae2eca1fb4ee3bc3a4852fce4d0abb5b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2eca1fb4ee3bc3a4852fce4d0abb5b3">&#9670;&nbsp;</a></span>GetNDim()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual int SampleHandlerBase::GetNDim </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>DB Function to differentiate 1D or 2D binning. </p>

<p>Implemented in <a class="el" href="classSampleHandlerFD.html#a768fdb89852db345ec267d30bd462cb2">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#a9071473aa7dde3bef4c8bb4061165e58">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="a6ceca02f83e878ef1aec6e54e7b2f331"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ceca02f83e878ef1aec6e54e7b2f331">&#9670;&nbsp;</a></span>GetNEvents()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int SampleHandlerBase::GetNEvents </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8h_source.html#l00052">52</a> of file <a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="classSampleHandlerBase.html#ab497b52d94868283a8a7cedbd1a4d777">nEvents</a>;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9d9a63f16c4acc2ab7bdd39df77712d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d9a63f16c4acc2ab7bdd39df77712d4">&#9670;&nbsp;</a></span>GetNOscChannels()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual int SampleHandlerBase::GetNOscChannels </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>iSample</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classSampleHandlerFD.html#aac276e3f10be081ce8e7f94df131490d">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#ab4005935fa8cb04fb06e7d2d9b490b8a">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="ac4b73a8841ff9bab2fb08b578ad4137f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4b73a8841ff9bab2fb08b578ad4137f">&#9670;&nbsp;</a></span>GetNsamples()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a> SampleHandlerBase::GetNsamples </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8h_source.html#l00034">34</a> of file <a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerBase.html#aa7a13af22c2314c718fb6438d493d3d1">nSamples</a>; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5849766fbbc7aa71672da8b0f189fe5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5849766fbbc7aa71672da8b0f189fe5">&#9670;&nbsp;</a></span>GetPoissonLLH()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double SampleHandlerBase::GetPoissonLLH </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>mc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate test statistic for a single bin using Poisson. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>is data </td></tr>
    <tr><td class="paramname">mc</td><td>is mc </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8cpp_source.html#l00017">17</a> of file <a class="el" href="SampleHandlerBase_8cpp_source.html">SampleHandlerBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;                                                                                {</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="comment">// Return MC if there are no data, returns 0 for data == 0 &amp;&amp; mc == 0  </span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="keywordflow">if</span> ( data == 0 ) <span class="keywordflow">return</span> mc;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="comment">// If there are some data, but the prediction falls below the MC bound =&gt; return Poisson LogL for the low MC bound</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keywordflow">if</span> ( mc &lt; <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) {</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keywordflow">if</span> ( data &gt; <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) <span class="keywordflow">return</span> ( <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> - data + data * std::log( data/<a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) );</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( data &gt;= mc ) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  }</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="comment">// Otherwise, just return usual Poisson LogL using Stirling&#39;s approximation</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="comment">// http://hyperphysics.phy-astr.gsu.edu/hbase/math/stirling.html</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordflow">return</span> ( mc - data + data * std::log( data / mc ) );</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;}</div>
<div class="ttc" id="anamespaceM3_html_ad6bd1a7e1e5b714f2985b91f8bdc4104"><div class="ttname"><a href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a></div><div class="ttdeci">constexpr static const double _LOW_MC_BOUND_</div><div class="ttdoc">MC prediction lower bound in bin to identify problematic binning definitions and handle LogL calculat...</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00083">Core.h:83</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a60ce18ee8d7adbc78b9be1269f081aa3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60ce18ee8d7adbc78b9be1269f081aa3">&#9670;&nbsp;</a></span>GetSampleLikelihood()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double SampleHandlerBase::GetSampleLikelihood </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>isample</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classSampleHandlerFD.html#aaac2deb8881a00c85951a3e8a6653393">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#a70fdee6b3ba405ef04a0f83ab63a8c3f">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="ad3df6900450be4bbb05453e3b166e09e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3df6900450be4bbb05453e3b166e09e">&#9670;&nbsp;</a></span>GetSampleTitle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::string SampleHandlerBase::GetSampleTitle </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classSampleHandlerFD.html#adfad2507ad845ad36fff3c82231a143c">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#ab5e1742f6636b3c05d078250b8611366">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="a619c91c640207a243d0868d386359c52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a619c91c640207a243d0868d386359c52">&#9670;&nbsp;</a></span>GetTestStatistic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67">TestStatistic</a> SampleHandlerBase::GetTestStatistic </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the test statistic used when calculating the binned likelihoods. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8h_source.html#l00184">184</a> of file <a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerBase.html#a87670dbcda5d09b09675e8f407fe3a30">fTestStatistic</a>; }</div>
<div class="ttc" id="aclassSampleHandlerBase_html_a87670dbcda5d09b09675e8f407fe3a30"><div class="ttname"><a href="classSampleHandlerBase.html#a87670dbcda5d09b09675e8f407fe3a30">SampleHandlerBase::fTestStatistic</a></div><div class="ttdeci">TestStatistic fTestStatistic</div><div class="ttdoc">Test statistic tells what kind of likelihood sample is using.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00202">SampleHandlerBase.h:202</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a527307a4186e2eb61475ea975108aa65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a527307a4186e2eb61475ea975108aa65">&#9670;&nbsp;</a></span>GetTestStatLLH()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double SampleHandlerBase::GetTestStatLLH </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>mc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>w2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate test statistic for a single bin. Calculation depends on setting of <code>fTestStatistic</code>. Data and mc -&gt; 0 cut-offs are defined in <a class="el" href="namespaceM3.html" title="Main namespace for MaCh3 software.">M3</a>::<em>LOW_MC_BOUND</em>. </p>
<h3><a class="anchor" id="autotoc_md32"></a>
Poisson</h3>
<p>Standard Poisson log-likelihood (Stirling approximation) <a class="el" href="citelist.html#CITEREF_BakerCousins1984">[2]</a> </p><p class="formulaDsp">
\[ - \log \mathcal{L}_\mathrm{Poisson} = \sum_i N_i^\mathrm{MC} - N_i^\mathrm{data} + N_i^\mathrm{data} \ln \frac{N_i^\mathrm{data}}{N_i^\mathrm{MC}}, \]
</p>
<h3><a class="anchor" id="autotoc_md33"></a>
Pearson</h3>
<p>Standard Pearson likelihood <a class="el" href="citelist.html#CITEREF_Pearson1900">[25]</a> (assumes Gaussian approximation of bin counts): </p><p class="formulaDsp">
\[ - \log \mathcal{L}_\mathrm{Pearson} = \sum_i \frac{(N_i^\mathrm{data} - N_i^\mathrm{MC})^2}{2 \, N_i^\mathrm{MC}} \]
</p>
<h3><a class="anchor" id="autotoc_md34"></a>
Barlow-Beeston</h3>
<p>Based on <a class="el" href="citelist.html#CITEREF_Barlow:1993dm">[3]</a> and following Conway approximation (<a class="el" href="citelist.html#CITEREF_Conway:2011in">[5]</a>) The generation of MC is a stochastic process, so even identical settings can lead to different outputs (assuming that the seeds of the random number generator are different). This introduces uncertainty in MC distributions, especially in bins with low statistics.</p>
<p class="formulaDsp">
\[ - \log \mathcal{L}_\mathrm{BB} = - \log \mathcal{L}_\mathrm{Poisson} - \log \mathcal{L}_\mathrm{MC_{stat}} = \sum_i \Biggl[ N_i^\mathrm{MC}(\vec{\theta}) - N_i^\mathrm{data} + N_i^\mathrm{data} \ln \frac{N_i^\mathrm{data}}{N_i^\mathrm{MC}(\vec{\theta})} + \frac{(\beta_i - 1)^2}{2 \sigma_{\beta_i}^2} \Biggr], \]
</p>
<p>where \(\beta_i\) is a scaling parameter between ideal ("true") and generated MC in a bin ( \(N^\mathrm{true}_{\mathrm{MC},i} = \beta_i N_i^\mathrm{MC}\)), and \(\sigma^2_{\beta_i} = \frac{\sum_i w_i^2}{N_i^\mathrm{MC}}\), with \(\sum_i w_i^2\) being the sum of the squares of weights in bin \(i\). Assuming \(\beta_i\) follows a Gaussian, its mean can be found by solving the quadratic equation derived by Conway:</p>
<p class="formulaDsp">
\[ \beta_i^2 + (N_i^\mathrm{MC} \sigma_{\beta_i}^2 - 1)\beta_i - N_i^\mathrm{data} \sigma_{\beta_i}^2 = 0 \]
</p>
<h3><a class="anchor" id="autotoc_md35"></a>
Dembinski-Abdelmotteleb</h3>
<p>Alternative treatment of MC statistical uncertainty following Hans Dembinski and Ahmed Abdelmotteleb <a class="el" href="citelist.html#CITEREF_Dembinski:2022ios">[6]</a></p>
<p>This approach extends the Barlow-Beeston method. For each bin: </p><p class="formulaDsp">
\[ - \log \mathcal{L}_\mathrm{DA} = (N_i^{\mathrm{MC},\prime} - N_i^\mathrm{data} + N_i^\mathrm{data} \ln \frac{N_i^\mathrm{data}}{N_i^{\mathrm{MC},\prime}}) + k \beta - k + k \ln \frac{k}{k \beta} \]
</p>
<p> where </p><p class="formulaDsp">
\[ k = \frac{(N_i^\mathrm{MC})^2}{\sum_i w_i^2} \]
</p>
<p> and </p><p class="formulaDsp">
\[ \beta = \frac{N_i^\mathrm{data} + k}{N_i^\mathrm{MC} + k}, \quad N_i^{\mathrm{MC},\prime} = N_i^\mathrm{MC} \cdot \beta \]
</p>
<h3><a class="anchor" id="autotoc_md36"></a>
IceCube</h3>
<p>Alternative likelihood definition described by the IceCube collaboration <a class="el" href="citelist.html#CITEREF_Arguelles:2019izp">[1]</a> </p><p class="formulaDsp">
\[ - \log \mathcal{L} = - \sum_i \Biggl( a_i \log(b_i) + \log[\Gamma(N_i^{\mathrm{data}}+a_i)] - (N_i^{\mathrm{data}}+a_i)\log(b_i+1) - \log[\Gamma(a_i)] \Biggr), \]
</p>
<p> where the auxiliary variables are </p><p class="formulaDsp">
\[ a_i = N^{\mathrm{gen}}_{\mathrm{MC},i} \, b_i + 1, \quad b_i = \frac{N^{\mathrm{gen}}_{\mathrm{MC},i}}{\sum_i w_i^2}. \]
</p>
<h3><a class="anchor" id="autotoc_md37"></a>
Treatment of low data/mc</h3>
<p>Implemented fTestStatistic are <code>kPoisson</code> (with Stirling's approx.), <code>kBarlowBeeston</code> (arXiv:1103.0354), <code>kDembinskiAbdelmotteleb</code> (arXiv:2206.12346), <code>kIceCube</code> (arxiv:1901.04645), and <code>kPearson</code>. Test statistics require mc &gt; 0, therefore low mc and data values are treated with cut-offs based on <a class="el" href="namespaceM3.html" title="Main namespace for MaCh3 software.">M3</a>::<em>LOW_MC_BOUND</em> = .00001 by default. For <code>kPoisson</code>, <code>kBarlowBeeston</code>, <code>kDembinskiAbdelmotteleb</code>, <code>kPearson:</code> data &gt; <em>LOW_MC_BOUND</em> &amp; mc &lt;= <em>LOW_MC_BOUND</em>: returns GetTestStatLLH(data, <em>LOW_MC_BOUND</em>, w2), with Poisson(data,<em>LOW_MC_BOUND</em>) limit for mc-&gt;0, w2-&gt;0. mc &lt; data &lt;= <em>LOW_MC_BOUND</em>: returns 0 (as if any data &lt;= <em>LOW_MC_BOUND</em> were effectively consistent with 0 data count), with a limit of 0 for mc-&gt;0. data = 0: returns mc (or mc/2. for <code>kPearson</code>), with a limit of 0 for mc-&gt;0. For <code>kIceCube:</code> mc &lt; data returns the lower of IceCube(data,mc,w2) and Poisson(data,mc) penalties, with a Poisson(data,<em>LOW_MC_BOUND</em>) limit for mc-&gt;0, w2-&gt;0. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>is data </td></tr>
    <tr><td class="paramname">mc</td><td>is mc </td></tr>
    <tr><td class="paramname">w2</td><td>is \(\sum_{i} w_{i}^2\) (sum of weights squared), which is \(\sigma^2_{\text{MC stats}}\) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8cpp_source.html#l00035">35</a> of file <a class="el" href="SampleHandlerBase_8cpp_source.html">SampleHandlerBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                                                                                                  {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">// *************************</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="classSampleHandlerBase.html#a87670dbcda5d09b09675e8f407fe3a30">fTestStatistic</a>)</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">//CW: Not full Barlow-Beeston or what is referred to as &quot;light&quot;: we&#39;re not introducing any more parameters</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">// Assume the MC has a Gaussian distribution around generated</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// As in https://arxiv.org/abs/1103.0354 eq 10, 11</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">//CW: Calculate the Barlow-Beeston likelihood contribution from MC statistics</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// Assumes the beta scaling parameters are Gaussian distributed</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">// Follows arXiv:1103.0354 section 5 and equation 8, 9, 10, 11 on page 4/5</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">// Essentially solves equation 11</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">case</span> (<a class="code" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a3c9b50397bd37ce679bbdda14f6108c4">kBarlowBeeston</a>):</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <span class="comment">// The MC used in the likelihood calculation is allowed to be changed by Barlow Beeston beta parameters</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keywordtype">double</span> newmc = mc;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <span class="comment">// If MC falls below the low MC bound, use low MC bound for newmc</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="keywordflow">if</span> ( mc &lt; <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">if</span> ( data &gt; <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) newmc = <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( data &gt;= mc ) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="comment">// Barlow-Beeston uses fractional uncertainty on MC, so sqrt(sum[w^2])/mc</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> fractional = std::sqrt( w2 ) / newmc;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="comment">// fractional^2 to avoid doing same operation several times</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> fractional2 = fractional * fractional;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="comment">// b in quadratic equation</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> temp = newmc * fractional2 - 1;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="comment">// b^2 - 4ac in quadratic equation</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> temp2 = temp * temp + 4 * data * fractional2;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordflow">if</span> ( temp2 &lt; 0 ) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Negative square root in Barlow Beeston coefficient calculation!&quot;</span>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <span class="comment">// Solve for the positive beta</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> beta = ( -1 * temp + sqrt( temp2 ) ) / 2.;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <span class="comment">// If there is no data, test-stat shall return only MC*beta</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keywordtype">double</span> stat = mc * beta;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="comment">// With data, test-stat shall return LogL for newMC*beta which includes the low MC bound</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="keywordflow">if</span> ( data &gt; 0 ) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        newmc *= beta;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        stat = newmc - data + data * std::log( data / newmc );</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="comment">// Now, MC stat penalty</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="comment">// The penalty from MC statistics using Conways approach (https://cds.cern.ch/record/1333496?)</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordtype">double</span> penalty = 0;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="keywordflow">if</span> ( fractional &gt; 0 )  penalty = ( beta - 1 ) * ( beta - 1 ) / ( 2 * fractional2 );</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="comment">// Returns test-stat plus the MC stat penalty </span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keywordflow">return</span> stat+penalty;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">//KS: Alternative calculation of Barlow-Beeston following Hans Dembinski and Ahmed Abdelmottele arXiv:2206.12346v2</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">case</span> (<a class="code" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a7d4e059541c7ec9737f5c884cd6cd0f0">kDembinskiAbdelmotteleb</a>):</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="comment">//KS: code follows authors implementation from:</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="comment">//https://github.com/scikit-hep/iminuit/blob/059d06b00cae097ebf340b218b4eb57357111df8/src/iminuit/cost.py#L274-L300</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="comment">// If there is no MC stat error for any reason, return Poisson LogL</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keywordflow">if</span> ( w2 == 0 ) <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerBase.html#ae5849766fbbc7aa71672da8b0f189fe5">GetPoissonLLH</a>(data,mc);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="comment">// The MC can be changed</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <span class="keywordtype">double</span> newmc = mc;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="comment">// If MC falls below the low MC bound, use low MC bound for newmc</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="keywordflow">if</span> ( mc &lt; <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">if</span> ( data &gt; <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) newmc = <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( data &gt;= mc ) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <span class="comment">//the so-called effective count</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> k = newmc * newmc / w2;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="comment">//Calculate beta which is scaling factor between true and generated MC</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> beta = ( data + k ) / ( newmc + k );</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      newmc *= beta;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="comment">// And penalise the movement in beta relative the mc uncertainty</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> penalty = k * beta - k + k * std::log( k / ( k * beta ) );</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="comment">// If there are no data, this shall return newmc</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordtype">double</span> stat = newmc;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="comment">// All likelihood calculations may use the bare Poisson likelihood, so calculate here</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="comment">// Only if there are some data</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">if</span> ( data &gt; 0 ) stat = newmc - data + data * std::log( data / newmc );</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="comment">// Return the statistical contribution and penalty</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keywordflow">return</span> stat+penalty;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">//CW: Also try the IceCube likelihood</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">// It does not modify the MC content</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// https://arxiv.org/abs/1901.04645</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// Argelles, C.A., Schneider, A. &amp; Yuan, T. J. High Energ. Phys. (2019) 2019: 30. https://doi.org/10.1007/JHEP06(2019)030</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">// We essentially construct eq 3.16 and take the logarithm</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// in eq 3.16, mu is MC, sigma2 is w2, k is data</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">case</span> (<a class="code" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a5a1aedce85942661f297f503d606c472">kIceCube</a>):</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="comment">// IceCube low MC bound is implemented to return Poisson(data, _LOW_MC_BOUND_)</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="comment">// up until the IceCube(data, mc) test-statistic is less than Poisson(data, _LOW_MC_BOUND_)</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <span class="comment">// The 0 MC limit is set to Poisson(data, 0.) as there is no way to get a non-diverging and reasonable guess on w2</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="comment">// If there is 0 MC uncertainty (technically also when MC is 0) =&gt; Return Poisson(data, mc)</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="keywordflow">if</span> ( w2 == 0 ) <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerBase.html#ae5849766fbbc7aa71672da8b0f189fe5">GetPoissonLLH</a>(data,mc);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="comment">// Auxiliary variables</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">double</span> b = mc / w2;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">double</span> a = mc * b + 1;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="comment">// Use C99&#39;s implementation of log of gamma function to not be C++11 dependent</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> stat = double( -1 * ( a * logl( b ) + lgammal( data + a ) - lgammal( data + 1 ) - ( ( data + a ) * log1pl( b ) ) - lgammal( a ) ) );</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="comment">// Check whether the stat is more than Poisson-like bound for low mc (mc &lt; data)</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="comment">// TN: I believe this might get some extra optimization</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keywordflow">if</span> ( mc &lt;= data ) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">if</span> ( data &lt;= <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> poisson = <a class="code" href="classSampleHandlerBase.html#ae5849766fbbc7aa71672da8b0f189fe5">GetPoissonLLH</a>(data, <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a>);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">if</span> ( stat &gt; poisson ) <span class="keywordflow">return</span> poisson;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="comment">// Otherwise, return IceCube test-stat</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="keywordflow">return</span> stat;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">//KS: Pearson works on assumption that event distribution in each bin is described by a Gaussian which in our case is not fulfilled for all bins, hence use it at your own risk</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">case</span> (<a class="code" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a1ac0c03f07bf2bb9ad083e449d69ffd7">kPearson</a>):</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="comment">//KS: 2 is because this function returns -LLH not -2LLH</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="comment">// With no data return the MC/2.</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keywordflow">if</span> ( data == 0 ) <span class="keywordflow">return</span> mc/2.;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <span class="comment">// If MC is lower than the low MC bound, return the test-stat at the bound</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="keywordflow">if</span> ( mc &lt; <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">if</span> ( data &gt; <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) <span class="keywordflow">return</span> ( data - <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) * ( data - <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ) / ( 2. * <a class="code" href="namespaceM3.html#ad6bd1a7e1e5b714f2985b91f8bdc4104">M3::_LOW_MC_BOUND_</a> ); </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( data &gt;= mc ) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="comment">// Return the Pearson metric</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="keywordflow">return</span> ( data - mc ) * ( data - mc ) / ( 2 * mc );</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">case</span> (<a class="code" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a82f43d91f1eda213c4b5c486672a32a5">kPoisson</a>):</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="comment">//Just call GetPoissonLLH which doesn&#39;t take in weights</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="comment">//and is a Poisson likelihood comparison.</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classSampleHandlerBase.html#ae5849766fbbc7aa71672da8b0f189fe5">GetPoissonLLH</a>(data, mc);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a1459dbcc0f1b68b266cf0ddc37c34aee">TestStatistic::kNTestStatistics</a>:</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;kNTestStatistics is not a valid TestStatistic!&quot;</span>);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Couldn&#39;t find TestStatistic {} exiting!&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classSampleHandlerBase.html#a87670dbcda5d09b09675e8f407fe3a30">fTestStatistic</a>));</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  } <span class="comment">// end switch</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a61052119a625282d0ec6d4a97adf3ee2"><div class="ttname"><a href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a></div><div class="ttdeci">#define MACH3LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00037">MaCh3Logger.h:37</a></div></div>
<div class="ttc" id="aSampleStructs_8h_html_a960da89e33ac45a56f7bbfac3068dc67a1459dbcc0f1b68b266cf0ddc37c34aee"><div class="ttname"><a href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a1459dbcc0f1b68b266cf0ddc37c34aee">kNTestStatistics</a></div><div class="ttdeci">@ kNTestStatistics</div><div class="ttdoc">Number of test statistics.</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00112">SampleStructs.h:111</a></div></div>
<div class="ttc" id="aSampleStructs_8h_html_a960da89e33ac45a56f7bbfac3068dc67a1ac0c03f07bf2bb9ad083e449d69ffd7"><div class="ttname"><a href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a1ac0c03f07bf2bb9ad083e449d69ffd7">kPearson</a></div><div class="ttdeci">@ kPearson</div><div class="ttdoc">Standard Pearson likelihood .</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00109">SampleStructs.h:109</a></div></div>
<div class="ttc" id="aSampleStructs_8h_html_a960da89e33ac45a56f7bbfac3068dc67a3c9b50397bd37ce679bbdda14f6108c4"><div class="ttname"><a href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a3c9b50397bd37ce679bbdda14f6108c4">kBarlowBeeston</a></div><div class="ttdeci">@ kBarlowBeeston</div><div class="ttdoc">Barlow-Beeston () following Conway approximation ()</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00107">SampleStructs.h:107</a></div></div>
<div class="ttc" id="aSampleStructs_8h_html_a960da89e33ac45a56f7bbfac3068dc67a5a1aedce85942661f297f503d606c472"><div class="ttname"><a href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a5a1aedce85942661f297f503d606c472">kIceCube</a></div><div class="ttdeci">@ kIceCube</div><div class="ttdoc">Based on .</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00108">SampleStructs.h:108</a></div></div>
<div class="ttc" id="aSampleStructs_8h_html_a960da89e33ac45a56f7bbfac3068dc67a7d4e059541c7ec9737f5c884cd6cd0f0"><div class="ttname"><a href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a7d4e059541c7ec9737f5c884cd6cd0f0">kDembinskiAbdelmotteleb</a></div><div class="ttdeci">@ kDembinskiAbdelmotteleb</div><div class="ttdoc">Based on .</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00110">SampleStructs.h:110</a></div></div>
<div class="ttc" id="aSampleStructs_8h_html_a960da89e33ac45a56f7bbfac3068dc67a82f43d91f1eda213c4b5c486672a32a5"><div class="ttname"><a href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67a82f43d91f1eda213c4b5c486672a32a5">kPoisson</a></div><div class="ttdeci">@ kPoisson</div><div class="ttdoc">Standard Poisson likelihood .</div><div class="ttdef"><b>Definition:</b> <a href="SampleStructs_8h_source.html#l00106">SampleStructs.h:106</a></div></div>
<div class="ttc" id="aclassMaCh3Exception_html"><div class="ttname"><a href="classMaCh3Exception.html">MaCh3Exception</a></div><div class="ttdoc">Custom exception class used throughout MaCh3.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Exception_8h_source.html#l00023">MaCh3Exception.h:23</a></div></div>
<div class="ttc" id="aclassSampleHandlerBase_html_ae5849766fbbc7aa71672da8b0f189fe5"><div class="ttname"><a href="classSampleHandlerBase.html#ae5849766fbbc7aa71672da8b0f189fe5">SampleHandlerBase::GetPoissonLLH</a></div><div class="ttdeci">double GetPoissonLLH(const double data, const double mc) const</div><div class="ttdoc">Calculate test statistic for a single bin using Poisson.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8cpp_source.html#l00017">SampleHandlerBase.cpp:17</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5ea53e5e6adb5b4e6281a3d1ce910c3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ea53e5e6adb5b4e6281a3d1ce910c3a">&#9670;&nbsp;</a></span>GetW2Hist()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual TH1* SampleHandlerBase::GetW2Hist </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get W2 histogram. </p>

<p>Implemented in <a class="el" href="classSampleHandlerFD.html#a9a47c08f11d5019f5f237cddd279ef9c">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#ab542ee8c1dc30a252529576a784ff9dd">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="ad16c838d4dc86e98445f199a16cf9bdf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad16c838d4dc86e98445f199a16cf9bdf">&#9670;&nbsp;</a></span>MatchCondition()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool SampleHandlerBase::MatchCondition </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>allowedValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T &amp;&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>check if event is affected by following conditions, for example pdg, or modes etc </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8h_source.html#l00194">194</a> of file <a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                                                         {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">if</span> (allowedValues.empty()) {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;  <span class="comment">// Apply to all if no specific values are specified</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">return</span> std::find(allowedValues.begin(), allowedValues.end(), value) != allowedValues.end();</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2da39aacd5ba10a3a745d546eccb859f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2da39aacd5ba10a3a745d546eccb859f">&#9670;&nbsp;</a></span>NowTalk()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerBase::NowTalk </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CW: Redirect std::cout to silence some experiment specific libraries. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8cpp_source.html#l00210">210</a> of file <a class="el" href="SampleHandlerBase_8cpp_source.html">SampleHandlerBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                                {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="preprocessor">  #if DEBUG &gt; 0</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="preprocessor">  #else</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  std::cout.rdbuf(<a class="code" href="classSampleHandlerBase.html#a47d291148fa6153a7e05beebde6cfdb9">buf</a>);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  std::cerr.rdbuf(<a class="code" href="classSampleHandlerBase.html#a6b884367733c4f3a93c75127ed6e9df9">errbuf</a>);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;}</div>
<div class="ttc" id="aclassSampleHandlerBase_html_a47d291148fa6153a7e05beebde6cfdb9"><div class="ttname"><a href="classSampleHandlerBase.html#a47d291148fa6153a7e05beebde6cfdb9">SampleHandlerBase::buf</a></div><div class="ttdeci">std::streambuf * buf</div><div class="ttdoc">Keep the cout buffer.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00205">SampleHandlerBase.h:205</a></div></div>
<div class="ttc" id="aclassSampleHandlerBase_html_a6b884367733c4f3a93c75127ed6e9df9"><div class="ttname"><a href="classSampleHandlerBase.html#a6b884367733c4f3a93c75127ed6e9df9">SampleHandlerBase::errbuf</a></div><div class="ttdeci">std::streambuf * errbuf</div><div class="ttdoc">Keep the cerr buffer.</div><div class="ttdef"><b>Definition:</b> <a href="SampleHandlerBase_8h_source.html#l00207">SampleHandlerBase.h:207</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afd2dfe54e6c99965f68ee08c2deba7d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd2dfe54e6c99965f68ee08c2deba7d7">&#9670;&nbsp;</a></span>PrintRates()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void SampleHandlerBase::PrintRates </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>DataOnly</em> = <code>false</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function to print rates for the samples with LLH. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">DataOnly</td><td>whether to print data only rates </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classSampleHandlerFD.html#a991deded5e6460cc2f3becaf8d856ae9">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#ae1c5304ecda47b3c3c9fee9beafaa8f4">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="ad1e91b3accfd9269e794f43aa7f9b979"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1e91b3accfd9269e794f43aa7f9b979">&#9670;&nbsp;</a></span>QuietPlease()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerBase::QuietPlease </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CW: Redirect std::cout to silence some experiment specific libraries. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8cpp_source.html#l00196">196</a> of file <a class="el" href="SampleHandlerBase_8cpp_source.html">SampleHandlerBase.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                                    {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">// ***************************************************************************</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="preprocessor">  #if DEBUG &gt; 0</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="preprocessor">  #else</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <a class="code" href="classSampleHandlerBase.html#a47d291148fa6153a7e05beebde6cfdb9">buf</a> = std::cout.rdbuf();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <a class="code" href="classSampleHandlerBase.html#a6b884367733c4f3a93c75127ed6e9df9">errbuf</a> = std::cerr.rdbuf();</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  std::cout.rdbuf( <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  std::cerr.rdbuf( <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aab140c97a440fec2ea4a62a481992c81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab140c97a440fec2ea4a62a481992c81">&#9670;&nbsp;</a></span>ReturnKinematicParameterBinning()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::vector&lt;double&gt; SampleHandlerBase::ReturnKinematicParameterBinning </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Sample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>KinematicParameter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the binning used to draw a kinematic parameter. </p>

<p>Implemented in <a class="el" href="classSampleHandlerFD.html#a2cee961e07a80484fe568898f41e4965">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#ab32d963eb2ca7c30986b88fd57cefd38">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="a3efb49c2a39d87b71e4dec7c7115fa88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3efb49c2a39d87b71e4dec7c7115fa88">&#9670;&nbsp;</a></span>Reweight()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void SampleHandlerBase::Reweight </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classSampleHandlerFD.html#ae3e03bd9beffb8b31acfd3bb5ebb44a2">SampleHandlerFD</a>, and <a class="el" href="classPySampleHandlerBase.html#a6e3629f5e902771c7812daf4003958f0">PySampleHandlerBase</a>.</p>

</div>
</div>
<a id="abaee29f1c5b8229417a0de3b5a36ddb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abaee29f1c5b8229417a0de3b5a36ddb0">&#9670;&nbsp;</a></span>SaveAdditionalInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void SampleHandlerBase::SaveAdditionalInfo </td>
          <td>(</td>
          <td class="paramtype">TDirectory *&#160;</td>
          <td class="paramname"><em>Dir</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Store additional info in a chan. </p>

<p>Reimplemented in <a class="el" href="classSampleHandlerFD.html#a90c390753da5f5561c66450440a19beb">SampleHandlerFD</a>.</p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8h_source.html#l00041">41</a> of file <a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{(void) Dir;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1c81b6b7a7e70b04c6c6ca1c81c70fc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c81b6b7a7e70b04c6c6ca1c81c70fc5">&#9670;&nbsp;</a></span>SetTestStatistic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleHandlerBase::SetTestStatistic </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67">TestStatistic</a>&#160;</td>
          <td class="paramname"><em>testStat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the test statistic to be used when calculating the binned likelihoods. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">testStat</td><td>The test statistic to use. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8h_source.html#l00182">182</a> of file <a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;{ <a class="code" href="classSampleHandlerBase.html#a87670dbcda5d09b09675e8f407fe3a30">fTestStatistic</a> = testStat; }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a47d291148fa6153a7e05beebde6cfdb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47d291148fa6153a7e05beebde6cfdb9">&#9670;&nbsp;</a></span>buf</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::streambuf* SampleHandlerBase::buf</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Keep the cout buffer. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8h_source.html#l00205">205</a> of file <a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a>.</p>

</div>
</div>
<a id="a6b884367733c4f3a93c75127ed6e9df9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b884367733c4f3a93c75127ed6e9df9">&#9670;&nbsp;</a></span>errbuf</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::streambuf* SampleHandlerBase::errbuf</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Keep the cerr buffer. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8h_source.html#l00207">207</a> of file <a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a>.</p>

</div>
</div>
<a id="a87670dbcda5d09b09675e8f407fe3a30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87670dbcda5d09b09675e8f407fe3a30">&#9670;&nbsp;</a></span>fTestStatistic</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="SampleStructs_8h.html#a960da89e33ac45a56f7bbfac3068dc67">TestStatistic</a> SampleHandlerBase::fTestStatistic</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Test statistic tells what kind of likelihood sample is using. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8h_source.html#l00202">202</a> of file <a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a>.</p>

</div>
</div>
<a id="a2f86c6158b755b9d2d400415ccac45f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f86c6158b755b9d2d400415ccac45f2">&#9670;&nbsp;</a></span>Modes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classMaCh3Modes.html">MaCh3Modes</a>&gt; SampleHandlerBase::Modes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds information about used Generator and MaCh3 modes. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8h_source.html#l00216">216</a> of file <a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a>.</p>

</div>
</div>
<a id="ab497b52d94868283a8a7cedbd1a4d777"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab497b52d94868283a8a7cedbd1a4d777">&#9670;&nbsp;</a></span>nEvents</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int SampleHandlerBase::nEvents</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of MC events are there. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8h_source.html#l00213">213</a> of file <a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a>.</p>

</div>
</div>
<a id="aa7a13af22c2314c718fb6438d493d3d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7a13af22c2314c718fb6438d493d3d1">&#9670;&nbsp;</a></span>nSamples</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a> SampleHandlerBase::nSamples</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Contains how many samples we've got. </p>

<p class="definition">Definition at line <a class="el" href="SampleHandlerBase_8h_source.html#l00210">210</a> of file <a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>Samples/<a class="el" href="SampleHandlerBase_8h_source.html">SampleHandlerBase.h</a></li>
<li>Samples/<a class="el" href="SampleHandlerBase_8cpp_source.html">SampleHandlerBase.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- Footer for MaCh3 Doxygen documentation -->
<footer class="mach3-footer" style="text-align: center;">
    <div style="margin-bottom: 15px;">
        <span style="font-weight: bold;">The MaCh3 Collaboration</span>
    </div>
    <!-- Dropdown to jump between doc versions -->
    <div style="margin-bottom: 10px;">
        <span>Select Software Version: </span>
        <select id="versionSelector" onchange="window.location.href=this.value" style="padding: 5px; border-radius: 4px; border: 1px solid #ccc;">
            <option value="">-- Select --</option>
            <option value="https://mach3-software.github.io/MaCh3/">develop</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.4.0/index.html">v2.4.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.3.0/index.html">v2.3.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.2.0/index.html">v2.2.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.1.0/index.html">v2.1.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.0.0/index.html">v2.0.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.5.0/index.html">v1.5.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.4.0/index.html">v1.4.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.3.0/index.html">v1.3.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.2.0/index.html">v1.2.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.1.0/index.html">v1.1.0</option>
        </select>
    </div>
    <!-- Footer info about doxygen -->
    <div style="font-size: 0.9em; color: #666; margin-top: 10px;">
        Documentation generated with
        <a href="https://www.doxygen.nl/" target="_blank" style="color: #666;">Doxygen</a>
        <span id="doxygenVersion"></span>
    </div>
    <!-- Now grab doxygen version from metadata -->
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        const meta = document.querySelector('meta[name="generator"]');
        if (meta) {
            const version = meta.getAttribute("content").replace("Doxygen ", "");
            document.getElementById("doxygenVersion").textContent = " " + version;
        }
    });
    </script>
</footer>
