<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MaCh3: MCMCProcessor Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="MaCh3.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mach3logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MaCh3
   &#160;<span id="projectnumber">2.4.0</span>
   </div>
   <div id="projectbrief">Reference Guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classMCMCProcessor-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">MCMCProcessor Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Class responsible for processing MCMC chains, performing diagnostics, generating plots, and managing Bayesian analysis.  
 <a href="classMCMCProcessor.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="MCMCProcessor_8h_source.html">Fitters/MCMCProcessor.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for MCMCProcessor:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classMCMCProcessor__inherit__graph.svg" width="134" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for MCMCProcessor:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classMCMCProcessor__coll__graph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a23c3d6934899266401e336a8d7142774"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a23c3d6934899266401e336a8d7142774">MCMCProcessor</a> (const std::string &amp;InputFile)</td></tr>
<tr class="memdesc:a23c3d6934899266401e336a8d7142774"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs an <a class="el" href="classMCMCProcessor.html" title="Class responsible for processing MCMC chains, performing diagnostics, generating plots,...">MCMCProcessor</a> object with the specified input file and options.  <a href="classMCMCProcessor.html#a23c3d6934899266401e336a8d7142774">More...</a><br /></td></tr>
<tr class="separator:a23c3d6934899266401e336a8d7142774"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50810cd50c5a4545bd5c1e486aae7b1c"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a50810cd50c5a4545bd5c1e486aae7b1c">~MCMCProcessor</a> ()</td></tr>
<tr class="memdesc:a50810cd50c5a4545bd5c1e486aae7b1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroys the <a class="el" href="classMCMCProcessor.html" title="Class responsible for processing MCMC chains, performing diagnostics, generating plots,...">MCMCProcessor</a> object.  <a href="classMCMCProcessor.html#a50810cd50c5a4545bd5c1e486aae7b1c">More...</a><br /></td></tr>
<tr class="separator:a50810cd50c5a4545bd5c1e486aae7b1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a224995a0b47bd9cbd04e099cc3ca634c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a224995a0b47bd9cbd04e099cc3ca634c">Initialise</a> ()</td></tr>
<tr class="memdesc:a224995a0b47bd9cbd04e099cc3ca634c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scan chain, what parameters we have and load information from covariance matrices.  <a href="classMCMCProcessor.html#a224995a0b47bd9cbd04e099cc3ca634c">More...</a><br /></td></tr>
<tr class="separator:a224995a0b47bd9cbd04e099cc3ca634c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55f6d14a81943e03bef0ddc47721ce25"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a55f6d14a81943e03bef0ddc47721ce25">MakePostfit</a> (const std::map&lt; std::string, std::pair&lt; double, double &gt;&gt; &amp;Edges={})</td></tr>
<tr class="memdesc:a55f6d14a81943e03bef0ddc47721ce25"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make 1D projection for each parameter and prepare structure.  <a href="classMCMCProcessor.html#a55f6d14a81943e03bef0ddc47721ce25">More...</a><br /></td></tr>
<tr class="separator:a55f6d14a81943e03bef0ddc47721ce25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc94f21ffd599b1e2dd7e62f24f6c4de"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#afc94f21ffd599b1e2dd7e62f24f6c4de">MakeCovariance</a> ()</td></tr>
<tr class="memdesc:afc94f21ffd599b1e2dd7e62f24f6c4de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate covariance by making 2D projection of each combination of parameters.  <a href="classMCMCProcessor.html#afc94f21ffd599b1e2dd7e62f24f6c4de">More...</a><br /></td></tr>
<tr class="separator:afc94f21ffd599b1e2dd7e62f24f6c4de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace48a54fb08e2a3943d4e2ed1f8c4a4b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ace48a54fb08e2a3943d4e2ed1f8c4a4b">CacheSteps</a> ()</td></tr>
<tr class="memdesc:ace48a54fb08e2a3943d4e2ed1f8c4a4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS:By caching each step we use multithreading.  <a href="classMCMCProcessor.html#ace48a54fb08e2a3943d4e2ed1f8c4a4b">More...</a><br /></td></tr>
<tr class="separator:ace48a54fb08e2a3943d4e2ed1f8c4a4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab367cb5f56606338bb1fce780f2414e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ab367cb5f56606338bb1fce780f2414e8">MakeCovariance_MP</a> (const bool Mute=false)</td></tr>
<tr class="memdesc:ab367cb5f56606338bb1fce780f2414e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate covariance by making 2D projection of each combination of parameters using multithreading.  <a href="classMCMCProcessor.html#ab367cb5f56606338bb1fce780f2414e8">More...</a><br /></td></tr>
<tr class="separator:ab367cb5f56606338bb1fce780f2414e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afac304b884238cc3624f5471b43f1a7e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#afac304b884238cc3624f5471b43f1a7e">MakeSubOptimality</a> (const int NIntervals=10)</td></tr>
<tr class="memdesc:afac304b884238cc3624f5471b43f1a7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make and Draw SubOptimality <a class="el" href="citelist.html#CITEREF_roberts2009adaptive">[28]</a>.  <a href="classMCMCProcessor.html#afac304b884238cc3624f5471b43f1a7e">More...</a><br /></td></tr>
<tr class="separator:afac304b884238cc3624f5471b43f1a7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08d9a19ff49682bfea54381419d6432a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a08d9a19ff49682bfea54381419d6432a">Reset2DPosteriors</a> ()</td></tr>
<tr class="memdesc:a08d9a19ff49682bfea54381419d6432a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset 2D posteriors, in case we would like to calculate in again with different BurnInCut.  <a href="classMCMCProcessor.html#a08d9a19ff49682bfea54381419d6432a">More...</a><br /></td></tr>
<tr class="separator:a08d9a19ff49682bfea54381419d6432a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab420de77e598da4b02ba74cdc20f2ea9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ab420de77e598da4b02ba74cdc20f2ea9">DrawPostfit</a> ()</td></tr>
<tr class="memdesc:ab420de77e598da4b02ba74cdc20f2ea9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Draw the post-fit comparisons.  <a href="classMCMCProcessor.html#ab420de77e598da4b02ba74cdc20f2ea9">More...</a><br /></td></tr>
<tr class="separator:ab420de77e598da4b02ba74cdc20f2ea9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04976c69f0ef0b3f39edcf5f25f90981"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a04976c69f0ef0b3f39edcf5f25f90981">MakeViolin</a> ()</td></tr>
<tr class="memdesc:a04976c69f0ef0b3f39edcf5f25f90981"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make and Draw Violin.  <a href="classMCMCProcessor.html#a04976c69f0ef0b3f39edcf5f25f90981">More...</a><br /></td></tr>
<tr class="separator:a04976c69f0ef0b3f39edcf5f25f90981"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17c0f09bfce82d1701a83645f748988a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a17c0f09bfce82d1701a83645f748988a">MakeCredibleIntervals</a> (const std::vector&lt; double &gt; &amp;CredibleIntervals={0.99, 0.90, 0.68 }, const std::vector&lt; Color_t &gt; &amp;CredibleIntervalsColours={kCyan+4, kCyan-2, kCyan-10}, const bool CredibleInSigmas=false)</td></tr>
<tr class="memdesc:a17c0f09bfce82d1701a83645f748988a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make and Draw Credible intervals.  <a href="classMCMCProcessor.html#a17c0f09bfce82d1701a83645f748988a">More...</a><br /></td></tr>
<tr class="separator:a17c0f09bfce82d1701a83645f748988a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d9b9c1c780a51b130fe528583dc5019"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a8d9b9c1c780a51b130fe528583dc5019">DrawCovariance</a> ()</td></tr>
<tr class="memdesc:a8d9b9c1c780a51b130fe528583dc5019"><td class="mdescLeft">&#160;</td><td class="mdescRight">Draw the post-fit covariances.  <a href="classMCMCProcessor.html#a8d9b9c1c780a51b130fe528583dc5019">More...</a><br /></td></tr>
<tr class="separator:a8d9b9c1c780a51b130fe528583dc5019"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afae102a167a1fb7995729af7e7c2fb19"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#afae102a167a1fb7995729af7e7c2fb19">MakeCovarianceYAML</a> (const std::string &amp;OutputYAMLFile, const std::string &amp;MeansMethod) const</td></tr>
<tr class="memdesc:afae102a167a1fb7995729af7e7c2fb19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make YAML file from post-fit covariance.  <a href="classMCMCProcessor.html#afae102a167a1fb7995729af7e7c2fb19">More...</a><br /></td></tr>
<tr class="separator:afae102a167a1fb7995729af7e7c2fb19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a570d38cc55c2d75e3313c0e621f0ecab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a570d38cc55c2d75e3313c0e621f0ecab">MakeCredibleRegions</a> (const std::vector&lt; double &gt; &amp;CredibleRegions={0.99, 0.90, 0.68}, const std::vector&lt; Style_t &gt; &amp;CredibleRegionStyle={kDashed, kSolid, kDotted}, const std::vector&lt; Color_t &gt; &amp;CredibleRegionColor={kGreen-3, kGreen-10, kGreen}, const bool CredibleInSigmas=false, const bool Draw2DPosterior=true, const bool DrawBestFit=true)</td></tr>
<tr class="memdesc:a570d38cc55c2d75e3313c0e621f0ecab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make and Draw Credible Regions.  <a href="classMCMCProcessor.html#a570d38cc55c2d75e3313c0e621f0ecab">More...</a><br /></td></tr>
<tr class="separator:a570d38cc55c2d75e3313c0e621f0ecab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ae80722efa0c94eec066ee91f3cf997"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a3ae80722efa0c94eec066ee91f3cf997">MakeTrianglePlot</a> (const std::vector&lt; std::string &gt; &amp;ParNames, const std::vector&lt; double &gt; &amp;CredibleIntervals={0.99, 0.90, 0.68 }, const std::vector&lt; Color_t &gt; &amp;CredibleIntervalsColours={kCyan+4, kCyan-2, kCyan-10}, const std::vector&lt; double &gt; &amp;CredibleRegions={0.99, 0.90, 0.68}, const std::vector&lt; Style_t &gt; &amp;CredibleRegionStyle={kDashed, kSolid, kDotted}, const std::vector&lt; Color_t &gt; &amp;CredibleRegionColor={kGreen-3, kGreen-10, kGreen}, const bool CredibleInSigmas=false)</td></tr>
<tr class="memdesc:a3ae80722efa0c94eec066ee91f3cf997"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make fancy triangle plot for selected parameters.  <a href="classMCMCProcessor.html#a3ae80722efa0c94eec066ee91f3cf997">More...</a><br /></td></tr>
<tr class="separator:a3ae80722efa0c94eec066ee91f3cf997"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7db7e3aa4403a239b8b2b865cea91f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aa7db7e3aa4403a239b8b2b865cea91f6">CheckCredibleIntervalsOrder</a> (const std::vector&lt; double &gt; &amp;CredibleIntervals, const std::vector&lt; Color_t &gt; &amp;CredibleIntervalsColours) const</td></tr>
<tr class="memdesc:aa7db7e3aa4403a239b8b2b865cea91f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks the order and size consistency of the <code>CredibleIntervals</code> and <code>CredibleIntervalsColours</code> vectors.  <a href="classMCMCProcessor.html#aa7db7e3aa4403a239b8b2b865cea91f6">More...</a><br /></td></tr>
<tr class="separator:aa7db7e3aa4403a239b8b2b865cea91f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab11b70175cd1e63722942a063192968a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ab11b70175cd1e63722942a063192968a">CheckCredibleRegionsOrder</a> (const std::vector&lt; double &gt; &amp;CredibleRegions, const std::vector&lt; Style_t &gt; &amp;CredibleRegionStyle, const std::vector&lt; Color_t &gt; &amp;CredibleRegionColor)</td></tr>
<tr class="memdesc:ab11b70175cd1e63722942a063192968a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks the order and size consistency of the <code>CredibleRegions</code>, <code>CredibleRegionStyle</code>, and <code>CredibleRegionColor</code> vectors.  <a href="classMCMCProcessor.html#ab11b70175cd1e63722942a063192968a">More...</a><br /></td></tr>
<tr class="separator:ab11b70175cd1e63722942a063192968a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac358c3ffe7c060e8872c762259973c6b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ac358c3ffe7c060e8872c762259973c6b">GetPolarPlot</a> (const std::vector&lt; std::string &gt; &amp;ParNames)</td></tr>
<tr class="memdesc:ac358c3ffe7c060e8872c762259973c6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make funny polar plot.  <a href="classMCMCProcessor.html#ac358c3ffe7c060e8872c762259973c6b">More...</a><br /></td></tr>
<tr class="separator:ac358c3ffe7c060e8872c762259973c6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38dafb84a053401afa91c80899454927"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a38dafb84a053401afa91c80899454927">GetBayesFactor</a> (const std::vector&lt; std::string &gt; &amp;ParName, const std::vector&lt; std::vector&lt; double &gt;&gt; &amp;Model1Bounds, const std::vector&lt; std::vector&lt; double &gt;&gt; &amp;Model2Bounds, const std::vector&lt; std::vector&lt; std::string &gt;&gt; &amp;ModelNames)</td></tr>
<tr class="memdesc:a38dafb84a053401afa91c80899454927"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate Bayes factor for vector of params, and model boundaries.  <a href="classMCMCProcessor.html#a38dafb84a053401afa91c80899454927">More...</a><br /></td></tr>
<tr class="separator:a38dafb84a053401afa91c80899454927"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9c3ef9ecc7cb66791837e5127970d9f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ad9c3ef9ecc7cb66791837e5127970d9f">GetSavageDickey</a> (const std::vector&lt; std::string &gt; &amp;ParName, const std::vector&lt; double &gt; &amp;EvaluationPoint, const std::vector&lt; std::vector&lt; double &gt;&gt; &amp;Bounds)</td></tr>
<tr class="memdesc:ad9c3ef9ecc7cb66791837e5127970d9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate Bayes factor for point like hypothesis using SavageDickey.  <a href="classMCMCProcessor.html#ad9c3ef9ecc7cb66791837e5127970d9f">More...</a><br /></td></tr>
<tr class="separator:ad9c3ef9ecc7cb66791837e5127970d9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af69384c2db282bb76e74beb15644ec2a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#af69384c2db282bb76e74beb15644ec2a">SavageDickeyPlot</a> (std::unique_ptr&lt; TH1D &gt; &amp;PriorHist, std::unique_ptr&lt; TH1D &gt; &amp;PosteriorHist, const std::string &amp;Title, const double EvaluationPoint) const</td></tr>
<tr class="memdesc:af69384c2db282bb76e74beb15644ec2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Produce Savage Dickey plot.  <a href="classMCMCProcessor.html#af69384c2db282bb76e74beb15644ec2a">More...</a><br /></td></tr>
<tr class="separator:af69384c2db282bb76e74beb15644ec2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3b1cfab21c7063bc29d1cf5dcca888c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ad3b1cfab21c7063bc29d1cf5dcca888c">ReweightPrior</a> (const std::vector&lt; std::string &gt; &amp;Names, const std::vector&lt; double &gt; &amp;NewCentral, const std::vector&lt; double &gt; &amp;NewError)</td></tr>
<tr class="memdesc:ad3b1cfab21c7063bc29d1cf5dcca888c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reweight Prior by giving new central value and new error.  <a href="classMCMCProcessor.html#ad3b1cfab21c7063bc29d1cf5dcca888c">More...</a><br /></td></tr>
<tr class="separator:ad3b1cfab21c7063bc29d1cf5dcca888c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe9e39306543ec4447f9a59d7ef58e9e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#afe9e39306543ec4447f9a59d7ef58e9e">SmearChain</a> (const std::vector&lt; std::string &gt; &amp;Names, const std::vector&lt; double &gt; &amp;Error, const bool &amp;SaveBranch) const</td></tr>
<tr class="memdesc:afe9e39306543ec4447f9a59d7ef58e9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Smear chain contours.  <a href="classMCMCProcessor.html#afe9e39306543ec4447f9a59d7ef58e9e">More...</a><br /></td></tr>
<tr class="separator:afe9e39306543ec4447f9a59d7ef58e9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9a5fc93b5ac3f6ef7850d21f47fd5dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ac9a5fc93b5ac3f6ef7850d21f47fd5dd">ParameterEvolution</a> (const std::vector&lt; std::string &gt; &amp;Names, const std::vector&lt; int &gt; &amp;NIntervals)</td></tr>
<tr class="memdesc:ac9a5fc93b5ac3f6ef7850d21f47fd5dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make .gif of parameter evolution.  <a href="classMCMCProcessor.html#ac9a5fc93b5ac3f6ef7850d21f47fd5dd">More...</a><br /></td></tr>
<tr class="separator:ac9a5fc93b5ac3f6ef7850d21f47fd5dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ac5ba63d8bf9ee38d4be8c1977214e5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a0ac5ba63d8bf9ee38d4be8c1977214e5">ThinMCMC</a> (const int ThinningCut) const</td></tr>
<tr class="memdesc:a0ac5ba63d8bf9ee38d4be8c1977214e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Thin MCMC Chain, to save space and maintain low autocorrelations.  <a href="classMCMCProcessor.html#a0ac5ba63d8bf9ee38d4be8c1977214e5">More...</a><br /></td></tr>
<tr class="separator:a0ac5ba63d8bf9ee38d4be8c1977214e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f8faecae63616ba100cf24ae42ecc08"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a7f8faecae63616ba100cf24ae42ecc08">DiagMCMC</a> ()</td></tr>
<tr class="memdesc:a7f8faecae63616ba100cf24ae42ecc08"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Perform MCMC diagnostic including Autocorrelation, Trace etc.  <a href="classMCMCProcessor.html#a7f8faecae63616ba100cf24ae42ecc08">More...</a><br /></td></tr>
<tr class="separator:a7f8faecae63616ba100cf24ae42ecc08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7332c6550c57c1e8b77917eeb9401491"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a7332c6550c57c1e8b77917eeb9401491">GetNParams</a> () const</td></tr>
<tr class="memdesc:a7332c6550c57c1e8b77917eeb9401491"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get total number of used parameters.  <a href="classMCMCProcessor.html#a7332c6550c57c1e8b77917eeb9401491">More...</a><br /></td></tr>
<tr class="separator:a7332c6550c57c1e8b77917eeb9401491"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3751e8e0fec34c895aa5a3fb1794880"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aa3751e8e0fec34c895aa5a3fb1794880">GetNXSec</a> () const</td></tr>
<tr class="separator:aa3751e8e0fec34c895aa5a3fb1794880"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9ad8c1a2890d3f1ee5487a296252cab"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ad9ad8c1a2890d3f1ee5487a296252cab">GetNND</a> () const</td></tr>
<tr class="separator:ad9ad8c1a2890d3f1ee5487a296252cab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b1f7d739f2e8266cc8b26b4c7d2474d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a5b1f7d739f2e8266cc8b26b4c7d2474d">GetNFD</a> () const</td></tr>
<tr class="separator:a5b1f7d739f2e8266cc8b26b4c7d2474d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7aea2db5f7e27378c1499923943687c4"><td class="memItemLeft" align="right" valign="top">YAML::Node&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a7aea2db5f7e27378c1499923943687c4">GetCovConfig</a> (const int i) const</td></tr>
<tr class="memdesc:a7aea2db5f7e27378c1499923943687c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get Yaml config obtained from a Chain.  <a href="classMCMCProcessor.html#a7aea2db5f7e27378c1499923943687c4">More...</a><br /></td></tr>
<tr class="separator:a7aea2db5f7e27378c1499923943687c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43afff108cd7e8942194cb9bd14f41ae"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a43afff108cd7e8942194cb9bd14f41ae">GetGroup</a> (const std::string &amp;name) const</td></tr>
<tr class="memdesc:a43afff108cd7e8942194cb9bd14f41ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of params from a given group, for example flux.  <a href="classMCMCProcessor.html#a43afff108cd7e8942194cb9bd14f41ae">More...</a><br /></td></tr>
<tr class="separator:a43afff108cd7e8942194cb9bd14f41ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66fd25d5cf38bfc0c0b99f799d0f02e9"><td class="memItemLeft" align="right" valign="top">TH1D *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a66fd25d5cf38bfc0c0b99f799d0f02e9">GetHpost</a> (const int i) const</td></tr>
<tr class="memdesc:a66fd25d5cf38bfc0c0b99f799d0f02e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get 1D posterior for a given parameter.  <a href="classMCMCProcessor.html#a66fd25d5cf38bfc0c0b99f799d0f02e9">More...</a><br /></td></tr>
<tr class="separator:a66fd25d5cf38bfc0c0b99f799d0f02e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a963d009bc7325e36d31737207b0fdca6"><td class="memItemLeft" align="right" valign="top">TH2D *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a963d009bc7325e36d31737207b0fdca6">GetHpost2D</a> (const int i, const int j) const</td></tr>
<tr class="memdesc:a963d009bc7325e36d31737207b0fdca6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get 2D posterior for a given parameter combination.  <a href="classMCMCProcessor.html#a963d009bc7325e36d31737207b0fdca6">More...</a><br /></td></tr>
<tr class="separator:a963d009bc7325e36d31737207b0fdca6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f54781e8a32bfa48036212ee0ae9e3d"><td class="memItemLeft" align="right" valign="top">TH2D *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a6f54781e8a32bfa48036212ee0ae9e3d">GetViolin</a> () const</td></tr>
<tr class="memdesc:a6f54781e8a32bfa48036212ee0ae9e3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get Violin plot for all parameters with posterior values.  <a href="classMCMCProcessor.html#a6f54781e8a32bfa48036212ee0ae9e3d">More...</a><br /></td></tr>
<tr class="separator:a6f54781e8a32bfa48036212ee0ae9e3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaebda73d2ab4fd560e83dcf6e0c68e58"><td class="memItemLeft" align="right" valign="top">TH2D *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aaebda73d2ab4fd560e83dcf6e0c68e58">GetViolinPrior</a> () const</td></tr>
<tr class="memdesc:aaebda73d2ab4fd560e83dcf6e0c68e58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get Violin plot for all parameters with prior values.  <a href="classMCMCProcessor.html#aaebda73d2ab4fd560e83dcf6e0c68e58">More...</a><br /></td></tr>
<tr class="separator:aaebda73d2ab4fd560e83dcf6e0c68e58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae97dab2090292a7f5ede3a9b3f48828f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ae97dab2090292a7f5ede3a9b3f48828f">GetXSecCov</a> () const</td></tr>
<tr class="separator:ae97dab2090292a7f5ede3a9b3f48828f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad26a853f53f50f5625b1c8043534dbe0"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ad26a853f53f50f5625b1c8043534dbe0">GetNDCov</a> () const</td></tr>
<tr class="separator:ad26a853f53f50f5625b1c8043534dbe0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab831ff0257b1f3137e1711df115a8b8d"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ab831ff0257b1f3137e1711df115a8b8d">GetFDCov</a> () const</td></tr>
<tr class="separator:ab831ff0257b1f3137e1711df115a8b8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fc015740496b821648f0e5ca8cffe80"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a5fc015740496b821648f0e5ca8cffe80">GetPostfit</a> (TVectorD *&amp;Central, TVectorD *&amp;<a class="el" href="classMCMCProcessor.html#a5174aaa900edf16ddc6e841ea4adae83">Errors</a>, TVectorD *&amp;Central_Gauss, TVectorD *&amp;<a class="el" href="classMCMCProcessor.html#aa78b7ed1bb9966f84f4eaf8cedf5e688">Errors_Gauss</a>, TVectorD *&amp;Peaks)</td></tr>
<tr class="memdesc:a5fc015740496b821648f0e5ca8cffe80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the post-fit results (arithmetic and Gaussian)  <a href="classMCMCProcessor.html#a5fc015740496b821648f0e5ca8cffe80">More...</a><br /></td></tr>
<tr class="separator:a5fc015740496b821648f0e5ca8cffe80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9e4fdea5d2de92a1abad5b79b7daf88"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ac9e4fdea5d2de92a1abad5b79b7daf88">GetCovariance</a> (TMatrixDSym *&amp;Cov, TMatrixDSym *&amp;Corr)</td></tr>
<tr class="memdesc:ac9e4fdea5d2de92a1abad5b79b7daf88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the post-fit covariances and correlations.  <a href="classMCMCProcessor.html#ac9e4fdea5d2de92a1abad5b79b7daf88">More...</a><br /></td></tr>
<tr class="separator:ac9e4fdea5d2de92a1abad5b79b7daf88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59fa9550b7c69c616929217ae89c2f42"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a59fa9550b7c69c616929217ae89c2f42">GetPostfit_Ind</a> (TVectorD *&amp;Central, TVectorD *&amp;<a class="el" href="classMCMCProcessor.html#a5174aaa900edf16ddc6e841ea4adae83">Errors</a>, TVectorD *&amp;Peaks, <a class="el" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20b">ParameterEnum</a> kParam)</td></tr>
<tr class="memdesc:a59fa9550b7c69c616929217ae89c2f42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Or the individual post-fits.  <a href="classMCMCProcessor.html#a59fa9550b7c69c616929217ae89c2f42">More...</a><br /></td></tr>
<tr class="separator:a59fa9550b7c69c616929217ae89c2f42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ca82be371ad0a0a9a22a0452a6ff8be"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; TString &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a0ca82be371ad0a0a9a22a0452a6ff8be">GetBranchNames</a> () const</td></tr>
<tr class="memdesc:a0ca82be371ad0a0a9a22a0452a6ff8be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the vector of branch names from root file.  <a href="classMCMCProcessor.html#a0ca82be371ad0a0a9a22a0452a6ff8be">More...</a><br /></td></tr>
<tr class="separator:a0ca82be371ad0a0a9a22a0452a6ff8be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07204936619139b886e9a877bc46d1a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">GetNthParameter</a> (const int param, double &amp;Prior, double &amp;PriorError, TString &amp;Title) const</td></tr>
<tr class="memdesc:a07204936619139b886e9a877bc46d1a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get properties of parameter by passing it number.  <a href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">More...</a><br /></td></tr>
<tr class="separator:a07204936619139b886e9a877bc46d1a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a563df09ed03a95aa8ad2781db9c8807b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a563df09ed03a95aa8ad2781db9c8807b">GetParamIndexFromName</a> (const std::string &amp;Name) const</td></tr>
<tr class="memdesc:a563df09ed03a95aa8ad2781db9c8807b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get parameter number based on name.  <a href="classMCMCProcessor.html#a563df09ed03a95aa8ad2781db9c8807b">More...</a><br /></td></tr>
<tr class="separator:a563df09ed03a95aa8ad2781db9c8807b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f00ad66e9eb7a910ef6e9e081c4154d"><td class="memItemLeft" align="right" valign="top">Long64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a7f00ad66e9eb7a910ef6e9e081c4154d">GetnEntries</a> ()</td></tr>
<tr class="memdesc:a7f00ad66e9eb7a910ef6e9e081c4154d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get Number of entries that Chain has, for merged chains will not be the same Nsteps.  <a href="classMCMCProcessor.html#a7f00ad66e9eb7a910ef6e9e081c4154d">More...</a><br /></td></tr>
<tr class="separator:a7f00ad66e9eb7a910ef6e9e081c4154d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2ebe9262f7f28778d92148164a54d4b"><td class="memItemLeft" align="right" valign="top">Long64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aa2ebe9262f7f28778d92148164a54d4b">GetnSteps</a> ()</td></tr>
<tr class="memdesc:aa2ebe9262f7f28778d92148164a54d4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get Number of Steps that Chain has, for merged chains will not be the same nEntries.  <a href="classMCMCProcessor.html#aa2ebe9262f7f28778d92148164a54d4b">More...</a><br /></td></tr>
<tr class="separator:aa2ebe9262f7f28778d92148164a54d4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa44a8304e28e48f29ad786f7a80ab43e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aa44a8304e28e48f29ad786f7a80ab43e">SetNBins</a> (const int NewBins)</td></tr>
<tr class="memdesc:aa44a8304e28e48f29ad786f7a80ab43e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modify number of bins used for 1D and 2D Histograms.  <a href="classMCMCProcessor.html#aa44a8304e28e48f29ad786f7a80ab43e">More...</a><br /></td></tr>
<tr class="separator:aa44a8304e28e48f29ad786f7a80ab43e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b7725985614e45ea318a331d581fe9e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a5b7725985614e45ea318a331d581fe9e">SetEntries</a> (const int NewEntries)</td></tr>
<tr class="memdesc:a5b7725985614e45ea318a331d581fe9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set number of entries to make potentially MCMC Processing faster.  <a href="classMCMCProcessor.html#a5b7725985614e45ea318a331d581fe9e">More...</a><br /></td></tr>
<tr class="separator:a5b7725985614e45ea318a331d581fe9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad610d8e835031872b428e759ef4045f1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ad610d8e835031872b428e759ef4045f1">SetStepCut</a> (const std::string &amp;Cuts)</td></tr>
<tr class="memdesc:ad610d8e835031872b428e759ef4045f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the step cutting by string.  <a href="classMCMCProcessor.html#ad610d8e835031872b428e759ef4045f1">More...</a><br /></td></tr>
<tr class="separator:ad610d8e835031872b428e759ef4045f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16f653dcb6358f2a8e393e3946a7e6d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a16f653dcb6358f2a8e393e3946a7e6d2">SetStepCut</a> (const int Cuts)</td></tr>
<tr class="memdesc:a16f653dcb6358f2a8e393e3946a7e6d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the step cutting by int.  <a href="classMCMCProcessor.html#a16f653dcb6358f2a8e393e3946a7e6d2">More...</a><br /></td></tr>
<tr class="separator:a16f653dcb6358f2a8e393e3946a7e6d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02eebcff814d7ce3ec3d9eb4e3bad857"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a02eebcff814d7ce3ec3d9eb4e3bad857">CheckStepCut</a> () const</td></tr>
<tr class="memdesc:a02eebcff814d7ce3ec3d9eb4e3bad857"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if step cut isn't larger than highest values of step in a chain.  <a href="classMCMCProcessor.html#a02eebcff814d7ce3ec3d9eb4e3bad857">More...</a><br /></td></tr>
<tr class="separator:a02eebcff814d7ce3ec3d9eb4e3bad857"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ea549289949ac19d2fc768d82c8f1c9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a6ea549289949ac19d2fc768d82c8f1c9">SetPlotRelativeToPrior</a> (const bool PlotOrNot)</td></tr>
<tr class="memdesc:a6ea549289949ac19d2fc768d82c8f1c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">You can set relative to prior or relative to generated. It is advised to use relate to prior.  <a href="classMCMCProcessor.html#a6ea549289949ac19d2fc768d82c8f1c9">More...</a><br /></td></tr>
<tr class="separator:a6ea549289949ac19d2fc768d82c8f1c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9db87211d9f066011daed18af7f4631e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a9db87211d9f066011daed18af7f4631e">SetPrintToPDF</a> (const bool PlotOrNot)</td></tr>
<tr class="memdesc:a9db87211d9f066011daed18af7f4631e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether to dump all plots into PDF.  <a href="classMCMCProcessor.html#a9db87211d9f066011daed18af7f4631e">More...</a><br /></td></tr>
<tr class="separator:a9db87211d9f066011daed18af7f4631e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbe0ec06ce30447cb1c03a961364b929"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#adbe0ec06ce30447cb1c03a961364b929">SetPlotErrorForFlatPrior</a> (const bool PlotOrNot)</td></tr>
<tr class="memdesc:adbe0ec06ce30447cb1c03a961364b929"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set whether you want to plot error for parameters which have flat prior.  <a href="classMCMCProcessor.html#adbe0ec06ce30447cb1c03a961364b929">More...</a><br /></td></tr>
<tr class="separator:adbe0ec06ce30447cb1c03a961364b929"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed120fafdfe97615f4c2a30aedde03dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aed120fafdfe97615f4c2a30aedde03dd">SetPlotBinValue</a> (const bool PlotOrNot)</td></tr>
<tr class="separator:aed120fafdfe97615f4c2a30aedde03dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f61cf0a51670f24f16dd7d77b7f5ae4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a7f61cf0a51670f24f16dd7d77b7f5ae4">SetFancyNames</a> (const bool PlotOrNot)</td></tr>
<tr class="separator:a7f61cf0a51670f24f16dd7d77b7f5ae4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bec41cdc9af977a51b269e2a07fe961"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a4bec41cdc9af977a51b269e2a07fe961">SetSmoothing</a> (const bool PlotOrNot)</td></tr>
<tr class="memdesc:a4bec41cdc9af977a51b269e2a07fe961"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set whether want to use smoothing for histograms using ROOT algorithm.  <a href="classMCMCProcessor.html#a4bec41cdc9af977a51b269e2a07fe961">More...</a><br /></td></tr>
<tr class="separator:a4bec41cdc9af977a51b269e2a07fe961"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab605f4d7bf4e2b24b4c0b1c5853b479f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ab605f4d7bf4e2b24b4c0b1c5853b479f">SetPost2DPlotThreshold</a> (const double Threshold)</td></tr>
<tr class="memdesc:ab605f4d7bf4e2b24b4c0b1c5853b479f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Code will only plot 2D posteriors if Correlation are larger than defined threshold.  <a href="classMCMCProcessor.html#ab605f4d7bf4e2b24b4c0b1c5853b479f">More...</a><br /></td></tr>
<tr class="separator:ab605f4d7bf4e2b24b4c0b1c5853b479f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab90c5ec77c57103dfaa72648c330a390"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ab90c5ec77c57103dfaa72648c330a390">SetUseFFTAutoCorrelation</a> (const bool useFFT)</td></tr>
<tr class="memdesc:ab90c5ec77c57103dfaa72648c330a390"><td class="mdescLeft">&#160;</td><td class="mdescRight">Toggle using the FFT-based autocorrelation calculator.  <a href="classMCMCProcessor.html#ab90c5ec77c57103dfaa72648c330a390">More...</a><br /></td></tr>
<tr class="separator:ab90c5ec77c57103dfaa72648c330a390"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4364a8ab084906c8925c9db9dc110485"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a4364a8ab084906c8925c9db9dc110485">SetExcludedTypes</a> (std::vector&lt; std::string &gt; Name)</td></tr>
<tr class="memdesc:a4364a8ab084906c8925c9db9dc110485"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setter related what parameters we want to exclude from analysis, for example if cross-section parameters look like param_, then passing "param_" will.  <a href="classMCMCProcessor.html#a4364a8ab084906c8925c9db9dc110485">More...</a><br /></td></tr>
<tr class="separator:a4364a8ab084906c8925c9db9dc110485"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09a6fa6cefcb20c00bee22c1dc5718c5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a09a6fa6cefcb20c00bee22c1dc5718c5">SetExcludedNames</a> (std::vector&lt; std::string &gt; Name)</td></tr>
<tr class="separator:a09a6fa6cefcb20c00bee22c1dc5718c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07d8ee7d0fdb9576505e4434a62d25c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a07d8ee7d0fdb9576505e4434a62d25c1">SetExcludedGroups</a> (std::vector&lt; std::string &gt; Name)</td></tr>
<tr class="separator:a07d8ee7d0fdb9576505e4434a62d25c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b13f1879f84d13b7d139432a9b993c6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a5b13f1879f84d13b7d139432a9b993c6">SetnBatches</a> (const int Batches)</td></tr>
<tr class="memdesc:a5b13f1879f84d13b7d139432a9b993c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set value of Nbatches used for batched mean, this need to be done earlier as batches are made when reading tree.  <a href="classMCMCProcessor.html#a5b13f1879f84d13b7d139432a9b993c6">More...</a><br /></td></tr>
<tr class="separator:a5b13f1879f84d13b7d139432a9b993c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a173d37d528ff201e66db8f92c156e3bb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a173d37d528ff201e66db8f92c156e3bb">SetnLags</a> (const int nLags)</td></tr>
<tr class="separator:a173d37d528ff201e66db8f92c156e3bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f4bf14c95b830c457a73be5399403ad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a2f4bf14c95b830c457a73be5399403ad">SetOutputSuffix</a> (const std::string Suffix)</td></tr>
<tr class="memdesc:a2f4bf14c95b830c457a73be5399403ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sett output suffix, this way jobs using the same file will have different names.  <a href="classMCMCProcessor.html#a2f4bf14c95b830c457a73be5399403ad">More...</a><br /></td></tr>
<tr class="separator:a2f4bf14c95b830c457a73be5399403ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a641da7f5e018d48d480638fbad6406a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a641da7f5e018d48d480638fbad6406a4">SetPosterior1DCut</a> (const std::string Cut)</td></tr>
<tr class="memdesc:a641da7f5e018d48d480638fbad6406a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allow to set addtional cuts based on ROOT TBrowser cut, for to only affect one mass ordering.  <a href="classMCMCProcessor.html#a641da7f5e018d48d480638fbad6406a4">More...</a><br /></td></tr>
<tr class="separator:a641da7f5e018d48d480638fbad6406a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a7627041b5ea3e1bbe038046ebb71a5dc"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; TH1D &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a7627041b5ea3e1bbe038046ebb71a5dc">MakePrefit</a> ()</td></tr>
<tr class="memdesc:a7627041b5ea3e1bbe038046ebb71a5dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare prefit histogram for parameter overlay plot.  <a href="classMCMCProcessor.html#a7627041b5ea3e1bbe038046ebb71a5dc">More...</a><br /></td></tr>
<tr class="separator:a7627041b5ea3e1bbe038046ebb71a5dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5a7761e97cf2e24c7d877a5374b7333"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aa5a7761e97cf2e24c7d877a5374b7333">MakeOutputFile</a> ()</td></tr>
<tr class="memdesc:aa5a7761e97cf2e24c7d877a5374b7333"><td class="mdescLeft">&#160;</td><td class="mdescRight">prepare output root file and canvas to which we will save EVERYTHING  <a href="classMCMCProcessor.html#aa5a7761e97cf2e24c7d877a5374b7333">More...</a><br /></td></tr>
<tr class="separator:aa5a7761e97cf2e24c7d877a5374b7333"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b0961bcb0eea7a347e6a29ef7738d80"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a5b0961bcb0eea7a347e6a29ef7738d80">DrawCorrelations1D</a> ()</td></tr>
<tr class="memdesc:a5b0961bcb0eea7a347e6a29ef7738d80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Draw 1D correlations which might be more helpful than looking at huge 2D Corr matrix.  <a href="classMCMCProcessor.html#a5b0961bcb0eea7a347e6a29ef7738d80">More...</a><br /></td></tr>
<tr class="separator:a5b0961bcb0eea7a347e6a29ef7738d80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c9c0c6da5530f5cf1f6fd673d2cc44f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a7c9c0c6da5530f5cf1f6fd673d2cc44f">DrawCorrelationsGroup</a> (const std::unique_ptr&lt; TH2D &gt; &amp;CorrMatrix) const</td></tr>
<tr class="memdesc:a7c9c0c6da5530f5cf1f6fd673d2cc44f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Produces correlation matrix but instead of giving name for each param it only give name for param group.  <a href="classMCMCProcessor.html#a7c9c0c6da5530f5cf1f6fd673d2cc44f">More...</a><br /></td></tr>
<tr class="separator:a7c9c0c6da5530f5cf1f6fd673d2cc44f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afef48d4fccf7551dc1845f8f6c08864f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#afef48d4fccf7551dc1845f8f6c08864f">ReadInputCov</a> ()</td></tr>
<tr class="memdesc:afef48d4fccf7551dc1845f8f6c08864f"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Read the input Covariance matrix entries. Get stuff like parameter input errors, names, and so on.  <a href="classMCMCProcessor.html#afef48d4fccf7551dc1845f8f6c08864f">More...</a><br /></td></tr>
<tr class="separator:afef48d4fccf7551dc1845f8f6c08864f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0e758c91b6f57a75544a0c61228f8dc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ac0e758c91b6f57a75544a0c61228f8dc">ReadInputCovLegacy</a> ()</td></tr>
<tr class="separator:ac0e758c91b6f57a75544a0c61228f8dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea15e730ff77556bb93bc4cff675744c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aea15e730ff77556bb93bc4cff675744c">FindInputFiles</a> ()</td></tr>
<tr class="memdesc:aea15e730ff77556bb93bc4cff675744c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the output MCMC file and find what inputs were used.  <a href="classMCMCProcessor.html#aea15e730ff77556bb93bc4cff675744c">More...</a><br /></td></tr>
<tr class="separator:aea15e730ff77556bb93bc4cff675744c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a897c04312518965436704334ebbc9c01"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a897c04312518965436704334ebbc9c01">FindInputFilesLegacy</a> ()</td></tr>
<tr class="separator:a897c04312518965436704334ebbc9c01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1862b7515a306c21916e2992d897d2ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a1862b7515a306c21916e2992d897d2ea">ReadModelFile</a> ()</td></tr>
<tr class="memdesc:a1862b7515a306c21916e2992d897d2ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the xsec file and get the input central values and errors.  <a href="classMCMCProcessor.html#a1862b7515a306c21916e2992d897d2ea">More...</a><br /></td></tr>
<tr class="separator:a1862b7515a306c21916e2992d897d2ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabac168d6ff10dc3d57667db532476a2"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aabac168d6ff10dc3d57667db532476a2">LoadAdditionalInfo</a> ()</td></tr>
<tr class="memdesc:aabac168d6ff10dc3d57667db532476a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">allow loading additional info for example used for oscillation parameters  <a href="classMCMCProcessor.html#aabac168d6ff10dc3d57667db532476a2">More...</a><br /></td></tr>
<tr class="separator:aabac168d6ff10dc3d57667db532476a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66dd0f1f88dbeb2b6a1976d42f77e136"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a66dd0f1f88dbeb2b6a1976d42f77e136">ReadNDFile</a> ()</td></tr>
<tr class="memdesc:a66dd0f1f88dbeb2b6a1976d42f77e136"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the ND cov file and get the input central values and errors.  <a href="classMCMCProcessor.html#a66dd0f1f88dbeb2b6a1976d42f77e136">More...</a><br /></td></tr>
<tr class="separator:a66dd0f1f88dbeb2b6a1976d42f77e136"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5ea421c8dd77ceac2e748008633b573"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ae5ea421c8dd77ceac2e748008633b573">ReadFDFile</a> ()</td></tr>
<tr class="memdesc:ae5ea421c8dd77ceac2e748008633b573"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the FD cov file and get the input central values and errors.  <a href="classMCMCProcessor.html#ae5ea421c8dd77ceac2e748008633b573">More...</a><br /></td></tr>
<tr class="separator:ae5ea421c8dd77ceac2e748008633b573"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1229c5b253883017c4efd636cdd7071e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a1229c5b253883017c4efd636cdd7071e">PrintInfo</a> () const</td></tr>
<tr class="memdesc:a1229c5b253883017c4efd636cdd7071e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print info like how many params have been loaded etc.  <a href="classMCMCProcessor.html#a1229c5b253883017c4efd636cdd7071e">More...</a><br /></td></tr>
<tr class="separator:a1229c5b253883017c4efd636cdd7071e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeff2174617268c1e55333529459bffb6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aeff2174617268c1e55333529459bffb6">ScanInput</a> ()</td></tr>
<tr class="memdesc:aeff2174617268c1e55333529459bffb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scan Input etc.  <a href="classMCMCProcessor.html#aeff2174617268c1e55333529459bffb6">More...</a><br /></td></tr>
<tr class="separator:aeff2174617268c1e55333529459bffb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a015cf0d6925d026e5bd9d82aa31083b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a015cf0d6925d026e5bd9d82aa31083b6">ScanParameterOrder</a> ()</td></tr>
<tr class="memdesc:a015cf0d6925d026e5bd9d82aa31083b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scan order of params from a different groups.  <a href="classMCMCProcessor.html#a015cf0d6925d026e5bd9d82aa31083b6">More...</a><br /></td></tr>
<tr class="separator:a015cf0d6925d026e5bd9d82aa31083b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4761be1345f1be3defe162b278a9d8e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aa4761be1345f1be3defe162b278a9d8e">SetupOutput</a> ()</td></tr>
<tr class="memdesc:aa4761be1345f1be3defe162b278a9d8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare all objects used for output.  <a href="classMCMCProcessor.html#aa4761be1345f1be3defe162b278a9d8e">More...</a><br /></td></tr>
<tr class="separator:aa4761be1345f1be3defe162b278a9d8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a930cadafa41b31b58066dea68628de9f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a930cadafa41b31b58066dea68628de9f">PrepareDiagMCMC</a> ()</td></tr>
<tr class="memdesc:a930cadafa41b31b58066dea68628de9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Prepare branches etc. for DiagMCMC.  <a href="classMCMCProcessor.html#a930cadafa41b31b58066dea68628de9f">More...</a><br /></td></tr>
<tr class="separator:a930cadafa41b31b58066dea68628de9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ad18f84ede354149dd37534995e061c"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a8ad18f84ede354149dd37534995e061c">GetParameterSums</a> ()</td></tr>
<tr class="memdesc:a8ad18f84ede354149dd37534995e061c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the average of each parameter across all MCMC entries. Useful for autocorrelation.  <a href="classMCMCProcessor.html#a8ad18f84ede354149dd37534995e061c">More...</a><br /></td></tr>
<tr class="separator:a8ad18f84ede354149dd37534995e061c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a929d6efec80bb4de05eea7011257439a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a929d6efec80bb4de05eea7011257439a">ParamTraces</a> ()</td></tr>
<tr class="memdesc:a929d6efec80bb4de05eea7011257439a"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Draw trace plots of the parameters i.e. parameter vs step.  <a href="classMCMCProcessor.html#a929d6efec80bb4de05eea7011257439a">More...</a><br /></td></tr>
<tr class="separator:a929d6efec80bb4de05eea7011257439a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a322bee0c362ba83df8c45769d299ce9f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a322bee0c362ba83df8c45769d299ce9f">AutoCorrelation</a> ()</td></tr>
<tr class="memdesc:a322bee0c362ba83df8c45769d299ce9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Calculate autocorrelations supports both OpenMP and CUDA :)  <a href="classMCMCProcessor.html#a322bee0c362ba83df8c45769d299ce9f">More...</a><br /></td></tr>
<tr class="separator:a322bee0c362ba83df8c45769d299ce9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abeb5e115fa9f58ea7872af5cf13c6b79"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#abeb5e115fa9f58ea7872af5cf13c6b79">AutoCorrelation_FFT</a> ()</td></tr>
<tr class="memdesc:abeb5e115fa9f58ea7872af5cf13c6b79"><td class="mdescLeft">&#160;</td><td class="mdescRight">MJR: Autocorrelation function using FFT algorithm for extra speed.  <a href="classMCMCProcessor.html#abeb5e115fa9f58ea7872af5cf13c6b79">More...</a><br /></td></tr>
<tr class="separator:abeb5e115fa9f58ea7872af5cf13c6b79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9f3e028ad30d09e5a14a984385b95f0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aa9f3e028ad30d09e5a14a984385b95f0">CalculateESS</a> (const int nLags, const std::vector&lt; std::vector&lt; double &gt;&gt; &amp;LagL)</td></tr>
<tr class="memdesc:aa9f3e028ad30d09e5a14a984385b95f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: calc Effective Sample Size.  <a href="classMCMCProcessor.html#aa9f3e028ad30d09e5a14a984385b95f0">More...</a><br /></td></tr>
<tr class="separator:aa9f3e028ad30d09e5a14a984385b95f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29d492906e0c027d089331a0509cd2c3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a29d492906e0c027d089331a0509cd2c3">BatchedAnalysis</a> ()</td></tr>
<tr class="memdesc:a29d492906e0c027d089331a0509cd2c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the batched means variance estimation and variable indicating if number of batches is sensible <a class="el" href="citelist.html#CITEREF_chakraborty2019estimating">[4]</a> <a class="el" href="citelist.html#CITEREF_rossetti2024batch">[29]</a>.  <a href="classMCMCProcessor.html#a29d492906e0c027d089331a0509cd2c3">More...</a><br /></td></tr>
<tr class="separator:a29d492906e0c027d089331a0509cd2c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3658b8adee50f6ef5557ebbd1c87b8e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#af3658b8adee50f6ef5557ebbd1c87b8e">BatchedMeans</a> ()</td></tr>
<tr class="memdesc:af3658b8adee50f6ef5557ebbd1c87b8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Batched means, literally read from an array and chuck into TH1D.  <a href="classMCMCProcessor.html#af3658b8adee50f6ef5557ebbd1c87b8e">More...</a><br /></td></tr>
<tr class="separator:af3658b8adee50f6ef5557ebbd1c87b8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03b7c4bb9cd9a90aa7d284b0f1a6156b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a03b7c4bb9cd9a90aa7d284b0f1a6156b">GewekeDiagnostic</a> ()</td></tr>
<tr class="memdesc:a03b7c4bb9cd9a90aa7d284b0f1a6156b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Geweke Diagnostic based on the methods described by Fang (2014) and Karlsbakk (2011). <a class="el" href="citelist.html#CITEREF_Fang2014GewekeDiagnostics">[8]</a> <a class="el" href="citelist.html#CITEREF_karlsbakk2011">[21]</a>.  <a href="classMCMCProcessor.html#a03b7c4bb9cd9a90aa7d284b0f1a6156b">More...</a><br /></td></tr>
<tr class="separator:a03b7c4bb9cd9a90aa7d284b0f1a6156b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a278b82fa945d847e57ae6ed6357d8f61"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a278b82fa945d847e57ae6ed6357d8f61">AcceptanceProbabilities</a> ()</td></tr>
<tr class="memdesc:a278b82fa945d847e57ae6ed6357d8f61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Acceptance Probability.  <a href="classMCMCProcessor.html#a278b82fa945d847e57ae6ed6357d8f61">More...</a><br /></td></tr>
<tr class="separator:a278b82fa945d847e57ae6ed6357d8f61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef760d8c4bb70690a5c4114f4b2409b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aef760d8c4bb70690a5c4114f4b2409b3">PowerSpectrumAnalysis</a> ()</td></tr>
<tr class="memdesc:aef760d8c4bb70690a5c4114f4b2409b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">RC: Perform spectral analysis of MCMC <a class="el" href="citelist.html#CITEREF_Dunkley:2004sv">[7]</a>.  <a href="classMCMCProcessor.html#aef760d8c4bb70690a5c4114f4b2409b3">More...</a><br /></td></tr>
<tr class="separator:aef760d8c4bb70690a5c4114f4b2409b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dfc05edf0b1295e561d5956b43b1c6b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a1dfc05edf0b1295e561d5956b43b1c6b">GetMargins</a> (const std::unique_ptr&lt; TCanvas &gt; &amp;Canv) const</td></tr>
<tr class="memdesc:a1dfc05edf0b1295e561d5956b43b1c6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get TCanvas margins, to be able to reset them if particular function need different margins.  <a href="classMCMCProcessor.html#a1dfc05edf0b1295e561d5956b43b1c6b">More...</a><br /></td></tr>
<tr class="separator:a1dfc05edf0b1295e561d5956b43b1c6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a922f4c04b67ca9c6faab00efdb5277ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a922f4c04b67ca9c6faab00efdb5277ea">SetMargins</a> (std::unique_ptr&lt; TCanvas &gt; &amp;Canv, const std::vector&lt; double &gt; &amp;margins)</td></tr>
<tr class="memdesc:a922f4c04b67ca9c6faab00efdb5277ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set TCanvas margins to specified values.  <a href="classMCMCProcessor.html#a922f4c04b67ca9c6faab00efdb5277ea">More...</a><br /></td></tr>
<tr class="separator:a922f4c04b67ca9c6faab00efdb5277ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0763bc26066a8cf7ea00148eb45af7a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ac0763bc26066a8cf7ea00148eb45af7a">SetTLineStyle</a> (TLine *Line, const Color_t Colour, const Width_t Width, const ELineStyle <a class="el" href="PlotSigmaVariation_8cpp.html#a2c1881be081f561337336d11d34572a9">Style</a>) const</td></tr>
<tr class="memdesc:ac0763bc26066a8cf7ea00148eb45af7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configures a TLine object with the specified style parameters.  <a href="classMCMCProcessor.html#ac0763bc26066a8cf7ea00148eb45af7a">More...</a><br /></td></tr>
<tr class="separator:ac0763bc26066a8cf7ea00148eb45af7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a704afa8c216722e730be2c2a33b594f0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a704afa8c216722e730be2c2a33b594f0">SetLegendStyle</a> (TLegend *Legend, const double size) const</td></tr>
<tr class="memdesc:a704afa8c216722e730be2c2a33b594f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configures the style of a TLegend object.  <a href="classMCMCProcessor.html#a704afa8c216722e730be2c2a33b594f0">More...</a><br /></td></tr>
<tr class="separator:a704afa8c216722e730be2c2a33b594f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a6d212d77a818304a8674a7b9b18d43b8"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a></td></tr>
<tr class="memdesc:a6d212d77a818304a8674a7b9b18d43b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name of MCMC file.  <a href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">More...</a><br /></td></tr>
<tr class="separator:a6d212d77a818304a8674a7b9b18d43b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa34b50ce33fb2cb7d9e9ef2d9f2f67c1"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aa34b50ce33fb2cb7d9e9ef2d9f2f67c1">OutputSuffix</a></td></tr>
<tr class="memdesc:aa34b50ce33fb2cb7d9e9ef2d9f2f67c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output file suffix useful when running over same file with different settings.  <a href="classMCMCProcessor.html#aa34b50ce33fb2cb7d9e9ef2d9f2f67c1">More...</a><br /></td></tr>
<tr class="separator:aa34b50ce33fb2cb7d9e9ef2d9f2f67c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c6afb0ed75207fd02c28e408f0592d4"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; std::string &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a></td></tr>
<tr class="memdesc:a7c6afb0ed75207fd02c28e408f0592d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Covariance matrix file name position.  <a href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">More...</a><br /></td></tr>
<tr class="separator:a7c6afb0ed75207fd02c28e408f0592d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a43ac10847a053db74553682f15e1d5"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a4a43ac10847a053db74553682f15e1d5">CovNamePos</a></td></tr>
<tr class="memdesc:a4a43ac10847a053db74553682f15e1d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Covariance matrix name position.  <a href="classMCMCProcessor.html#a4a43ac10847a053db74553682f15e1d5">More...</a><br /></td></tr>
<tr class="separator:a4a43ac10847a053db74553682f15e1d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c1330a025c0b91e382bdc29c960424a"><td class="memItemLeft" align="right" valign="top">std::vector&lt; YAML::Node &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a4c1330a025c0b91e382bdc29c960424a">CovConfig</a></td></tr>
<tr class="memdesc:a4c1330a025c0b91e382bdc29c960424a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Covariance matrix config.  <a href="classMCMCProcessor.html#a4c1330a025c0b91e382bdc29c960424a">More...</a><br /></td></tr>
<tr class="separator:a4c1330a025c0b91e382bdc29c960424a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6be3bbebd4a79fe9814a3da09b3bb820"><td class="memItemLeft" align="right" valign="top">TChain *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a></td></tr>
<tr class="memdesc:a6be3bbebd4a79fe9814a3da09b3bb820"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main chain storing all steps etc.  <a href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">More...</a><br /></td></tr>
<tr class="separator:a6be3bbebd4a79fe9814a3da09b3bb820"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a576f0eb874afaf7e31ff5c86b9e5b8f9"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a576f0eb874afaf7e31ff5c86b9e5b8f9">StepCut</a></td></tr>
<tr class="memdesc:a576f0eb874afaf7e31ff5c86b9e5b8f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">BurnIn Cuts.  <a href="classMCMCProcessor.html#a576f0eb874afaf7e31ff5c86b9e5b8f9">More...</a><br /></td></tr>
<tr class="separator:a576f0eb874afaf7e31ff5c86b9e5b8f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85917e25c4f5b5b966c50cccd9ddd6a0"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a85917e25c4f5b5b966c50cccd9ddd6a0">Posterior1DCut</a></td></tr>
<tr class="memdesc:a85917e25c4f5b5b966c50cccd9ddd6a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cut used when making 1D Posterior distribution.  <a href="classMCMCProcessor.html#a85917e25c4f5b5b966c50cccd9ddd6a0">More...</a><br /></td></tr>
<tr class="separator:a85917e25c4f5b5b966c50cccd9ddd6a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b14dd9e571803d8946781642348bee1"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a6b14dd9e571803d8946781642348bee1">UpperCut</a></td></tr>
<tr class="memdesc:a6b14dd9e571803d8946781642348bee1"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Used only for SubOptimality.  <a href="classMCMCProcessor.html#a6b14dd9e571803d8946781642348bee1">More...</a><br /></td></tr>
<tr class="separator:a6b14dd9e571803d8946781642348bee1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afca259b5bdee2b248d4b1a64ac3e7930"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#afca259b5bdee2b248d4b1a64ac3e7930">BurnInCut</a></td></tr>
<tr class="memdesc:afca259b5bdee2b248d4b1a64ac3e7930"><td class="mdescLeft">&#160;</td><td class="mdescRight">Value of burn in cut.  <a href="classMCMCProcessor.html#afca259b5bdee2b248d4b1a64ac3e7930">More...</a><br /></td></tr>
<tr class="separator:afca259b5bdee2b248d4b1a64ac3e7930"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6ba5d9aec5350fafebbf81309e813cb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#af6ba5d9aec5350fafebbf81309e813cb">nBranches</a></td></tr>
<tr class="memdesc:af6ba5d9aec5350fafebbf81309e813cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of branches in a TTree.  <a href="classMCMCProcessor.html#af6ba5d9aec5350fafebbf81309e813cb">More...</a><br /></td></tr>
<tr class="separator:af6ba5d9aec5350fafebbf81309e813cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3a19b885e9c34e1674aea8cfbe14e1c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a></td></tr>
<tr class="memdesc:af3a19b885e9c34e1674aea8cfbe14e1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: For merged chains number of entries will be different from nSteps.  <a href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">More...</a><br /></td></tr>
<tr class="separator:af3a19b885e9c34e1674aea8cfbe14e1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae0016a4e1d105d5d65243438c622a97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aae0016a4e1d105d5d65243438c622a97">nSteps</a></td></tr>
<tr class="memdesc:aae0016a4e1d105d5d65243438c622a97"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: For merged chains number of entries will be different from nSteps.  <a href="classMCMCProcessor.html#aae0016a4e1d105d5d65243438c622a97">More...</a><br /></td></tr>
<tr class="separator:aae0016a4e1d105d5d65243438c622a97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87a358cbace8251ea3f8dec14ecd4af3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a87a358cbace8251ea3f8dec14ecd4af3">nSampleHandlers</a></td></tr>
<tr class="memdesc:a87a358cbace8251ea3f8dec14ecd4af3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of sample PDF objects.  <a href="classMCMCProcessor.html#a87a358cbace8251ea3f8dec14ecd4af3">More...</a><br /></td></tr>
<tr class="separator:a87a358cbace8251ea3f8dec14ecd4af3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa075d77fe6d0be897d5ebf7320f8fe2e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aa075d77fe6d0be897d5ebf7320f8fe2e">nParameterHandlers</a></td></tr>
<tr class="memdesc:aa075d77fe6d0be897d5ebf7320f8fe2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of covariance objects.  <a href="classMCMCProcessor.html#aa075d77fe6d0be897d5ebf7320f8fe2e">More...</a><br /></td></tr>
<tr class="separator:aa075d77fe6d0be897d5ebf7320f8fe2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa30545fedb0af2ad9619d6accf42a10d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a></td></tr>
<tr class="memdesc:aa30545fedb0af2ad9619d6accf42a10d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of all parameters used in the analysis.  <a href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">More...</a><br /></td></tr>
<tr class="separator:aa30545fedb0af2ad9619d6accf42a10d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad043b6b2c885f47ab9967831bc8d0f5a"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TString &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a></td></tr>
<tr class="separator:ad043b6b2c885f47ab9967831bc8d0f5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aada4aadea10661586b46c1013a9d018f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aada4aadea10661586b46c1013a9d018f">ExcludedTypes</a></td></tr>
<tr class="separator:aada4aadea10661586b46c1013a9d018f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7425f7802e50bcb5ff4b38e20157c423"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a7425f7802e50bcb5ff4b38e20157c423">ExcludedNames</a></td></tr>
<tr class="separator:a7425f7802e50bcb5ff4b38e20157c423"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8221ad9d7c814e978a302be016d5f6b8"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a8221ad9d7c814e978a302be016d5f6b8">ExcludedGroups</a></td></tr>
<tr class="separator:a8221ad9d7c814e978a302be016d5f6b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95fa49737432818bc830a44898d0d850"><td class="memItemLeft" align="right" valign="top">std::vector&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a95fa49737432818bc830a44898d0d850">IamVaried</a></td></tr>
<tr class="memdesc:a95fa49737432818bc830a44898d0d850"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is the ith parameter varied.  <a href="classMCMCProcessor.html#a95fa49737432818bc830a44898d0d850">More...</a><br /></td></tr>
<tr class="separator:a95fa49737432818bc830a44898d0d850"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adecc55689f7d37b9412f8886fe3480dc"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; TString &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">ParamNames</a></td></tr>
<tr class="memdesc:adecc55689f7d37b9412f8886fe3480dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name of parameters which we are going to analyse.  <a href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">More...</a><br /></td></tr>
<tr class="separator:adecc55689f7d37b9412f8886fe3480dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a6614826ae320e462211e38e96d9d02"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a3a6614826ae320e462211e38e96d9d02">ParamCentral</a></td></tr>
<tr class="memdesc:a3a6614826ae320e462211e38e96d9d02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parameters central values which we are going to analyse.  <a href="classMCMCProcessor.html#a3a6614826ae320e462211e38e96d9d02">More...</a><br /></td></tr>
<tr class="separator:a3a6614826ae320e462211e38e96d9d02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a97e3cb4be3ceb9eb721eac51d82d60"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a3a97e3cb4be3ceb9eb721eac51d82d60">ParamErrors</a></td></tr>
<tr class="memdesc:a3a97e3cb4be3ceb9eb721eac51d82d60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Uncertainty on a single parameter.  <a href="classMCMCProcessor.html#a3a97e3cb4be3ceb9eb721eac51d82d60">More...</a><br /></td></tr>
<tr class="separator:a3a97e3cb4be3ceb9eb721eac51d82d60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4be1eedb743e4ea410009a4fa45720f7"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; bool &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a4be1eedb743e4ea410009a4fa45720f7">ParamFlat</a></td></tr>
<tr class="memdesc:a4be1eedb743e4ea410009a4fa45720f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether Param has flat prior or not.  <a href="classMCMCProcessor.html#a4be1eedb743e4ea410009a4fa45720f7">More...</a><br /></td></tr>
<tr class="separator:a4be1eedb743e4ea410009a4fa45720f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4200e7cbe1c8f811d3640ebfd648ca85"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a></td></tr>
<tr class="memdesc:a4200e7cbe1c8f811d3640ebfd648ca85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of parameters per type.  <a href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">More...</a><br /></td></tr>
<tr class="separator:a4200e7cbe1c8f811d3640ebfd648ca85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa903949bde8f1a69800c71fe1eb538e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20b">ParameterEnum</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a></td></tr>
<tr class="memdesc:aaa903949bde8f1a69800c71fe1eb538e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make an enum for which class this parameter belongs to so we don't have to keep string comparing.  <a href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">More...</a><br /></td></tr>
<tr class="separator:aaa903949bde8f1a69800c71fe1eb538e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeab63979ff36256072c046a15d981875"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a></td></tr>
<tr class="separator:aeab63979ff36256072c046a15d981875"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab72dd21faa732ec38e550c37635ee66d"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ab72dd21faa732ec38e550c37635ee66d">ParameterGroup</a></td></tr>
<tr class="separator:ab72dd21faa732ec38e550c37635ee66d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3660e404a6631cfa913a815481730a9b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TString &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a3660e404a6631cfa913a815481730a9b">SampleName_v</a></td></tr>
<tr class="memdesc:a3660e404a6631cfa913a815481730a9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector of each systematic.  <a href="classMCMCProcessor.html#a3660e404a6631cfa913a815481730a9b">More...</a><br /></td></tr>
<tr class="separator:a3660e404a6631cfa913a815481730a9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb1871575fdd3ae156aed4bf7c7a0a73"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TString &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#acb1871575fdd3ae156aed4bf7c7a0a73">SystName_v</a></td></tr>
<tr class="memdesc:acb1871575fdd3ae156aed4bf7c7a0a73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector of each sample PDF object.  <a href="classMCMCProcessor.html#acb1871575fdd3ae156aed4bf7c7a0a73">More...</a><br /></td></tr>
<tr class="separator:acb1871575fdd3ae156aed4bf7c7a0a73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d17c1720b91d6d0361da0b5dabfbbff"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a3d17c1720b91d6d0361da0b5dabfbbff">OutputName</a></td></tr>
<tr class="memdesc:a3d17c1720b91d6d0361da0b5dabfbbff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name of output files.  <a href="classMCMCProcessor.html#a3d17c1720b91d6d0361da0b5dabfbbff">More...</a><br /></td></tr>
<tr class="separator:a3d17c1720b91d6d0361da0b5dabfbbff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5aec3dc293919701d31e6ae705601dd"><td class="memItemLeft" align="right" valign="top">TString&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a></td></tr>
<tr class="memdesc:ab5aec3dc293919701d31e6ae705601dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name of canvas which help to save to the sample pdf.  <a href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">More...</a><br /></td></tr>
<tr class="separator:ab5aec3dc293919701d31e6ae705601dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad24411a2556504c440ff0af045e8e7aa"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ad24411a2556504c440ff0af045e8e7aa">PlotFlatPrior</a></td></tr>
<tr class="memdesc:ad24411a2556504c440ff0af045e8e7aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether we plot flat prior or not, we usually provide error even for flat prior params.  <a href="classMCMCProcessor.html#ad24411a2556504c440ff0af045e8e7aa">More...</a><br /></td></tr>
<tr class="separator:ad24411a2556504c440ff0af045e8e7aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbac2a114c15ca7db4abe71dd549504c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#afbac2a114c15ca7db4abe71dd549504c">plotRelativeToPrior</a></td></tr>
<tr class="memdesc:afbac2a114c15ca7db4abe71dd549504c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether we plot relative to prior or nominal, in most cases is prior.  <a href="classMCMCProcessor.html#afbac2a114c15ca7db4abe71dd549504c">More...</a><br /></td></tr>
<tr class="separator:afbac2a114c15ca7db4abe71dd549504c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecc35d4ea7d2c7e020e50388ba0ffb64"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aecc35d4ea7d2c7e020e50388ba0ffb64">MadePostfit</a></td></tr>
<tr class="memdesc:aecc35d4ea7d2c7e020e50388ba0ffb64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sanity check if Postfit is already done to not make several times.  <a href="classMCMCProcessor.html#aecc35d4ea7d2c7e020e50388ba0ffb64">More...</a><br /></td></tr>
<tr class="separator:aecc35d4ea7d2c7e020e50388ba0ffb64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad73755714ae3d6dc951158d5513c6eee"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a></td></tr>
<tr class="memdesc:ad73755714ae3d6dc951158d5513c6eee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Will plot all plot to PDF not only to root file.  <a href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">More...</a><br /></td></tr>
<tr class="separator:ad73755714ae3d6dc951158d5513c6eee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad25fe818c94163b0c4a8fcdfd387c148"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ad25fe818c94163b0c4a8fcdfd387c148">FancyPlotNames</a></td></tr>
<tr class="memdesc:ad25fe818c94163b0c4a8fcdfd387c148"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether we want fancy plot names or not.  <a href="classMCMCProcessor.html#ad25fe818c94163b0c4a8fcdfd387c148">More...</a><br /></td></tr>
<tr class="separator:ad25fe818c94163b0c4a8fcdfd387c148"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7611f55ac3c0ea70607761d037fbd91"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aa7611f55ac3c0ea70607761d037fbd91">plotBinValue</a></td></tr>
<tr class="memdesc:aa7611f55ac3c0ea70607761d037fbd91"><td class="mdescLeft">&#160;</td><td class="mdescRight">If true it will print value on each bin of covariance matrix.  <a href="classMCMCProcessor.html#aa7611f55ac3c0ea70607761d037fbd91">More...</a><br /></td></tr>
<tr class="separator:aa7611f55ac3c0ea70607761d037fbd91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a682c1c47626542f5820d633ba2bc010c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a682c1c47626542f5820d633ba2bc010c">ApplySmoothing</a></td></tr>
<tr class="memdesc:a682c1c47626542f5820d633ba2bc010c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply smoothing for 2D histos using root algorithm.  <a href="classMCMCProcessor.html#a682c1c47626542f5820d633ba2bc010c">More...</a><br /></td></tr>
<tr class="separator:a682c1c47626542f5820d633ba2bc010c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25e4685b6299181021b02ac0e0b74681"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a25e4685b6299181021b02ac0e0b74681">Post2DPlotThreshold</a></td></tr>
<tr class="memdesc:a25e4685b6299181021b02ac0e0b74681"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Set Threshold when to plot 2D posterior as by default we get a LOT of plots.  <a href="classMCMCProcessor.html#a25e4685b6299181021b02ac0e0b74681">More...</a><br /></td></tr>
<tr class="separator:a25e4685b6299181021b02ac0e0b74681"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a562261269f0f4ec4a209b2fca64ff443"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a562261269f0f4ec4a209b2fca64ff443">useFFTAutoCorrelation</a></td></tr>
<tr class="memdesc:a562261269f0f4ec4a209b2fca64ff443"><td class="mdescLeft">&#160;</td><td class="mdescRight">MJR: Use FFT-based autocorrelation algorithm (save time &amp; resources)?  <a href="classMCMCProcessor.html#a562261269f0f4ec4a209b2fca64ff443">More...</a><br /></td></tr>
<tr class="separator:a562261269f0f4ec4a209b2fca64ff443"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2649d6e851ec0a08985a35da299fa5b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ab2649d6e851ec0a08985a35da299fa5b">NDSamplesBins</a></td></tr>
<tr class="separator:ab2649d6e851ec0a08985a35da299fa5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab80e0a8be27cc9206e1834a2f1f1ca2"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aab80e0a8be27cc9206e1834a2f1f1ca2">NDSamplesNames</a></td></tr>
<tr class="separator:aab80e0a8be27cc9206e1834a2f1f1ca2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20ee00d448413b8a2653b252d70e88b3"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; TF1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a20ee00d448413b8a2653b252d70e88b3">Gauss</a></td></tr>
<tr class="memdesc:a20ee00d448413b8a2653b252d70e88b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gaussian fitter.  <a href="classMCMCProcessor.html#a20ee00d448413b8a2653b252d70e88b3">More...</a><br /></td></tr>
<tr class="separator:a20ee00d448413b8a2653b252d70e88b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62035b99df4617ab334cd1abd6ed0346"><td class="memItemLeft" align="right" valign="top">TFile *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a></td></tr>
<tr class="memdesc:a62035b99df4617ab334cd1abd6ed0346"><td class="mdescLeft">&#160;</td><td class="mdescRight">The output file.  <a href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">More...</a><br /></td></tr>
<tr class="separator:a62035b99df4617ab334cd1abd6ed0346"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61deb3c399dc10813b5cd116f041e981"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; TCanvas &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a></td></tr>
<tr class="memdesc:a61deb3c399dc10813b5cd116f041e981"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fancy canvas used for our beautiful plots.  <a href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">More...</a><br /></td></tr>
<tr class="separator:a61deb3c399dc10813b5cd116f041e981"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad661c6d53f9f891e18ff8ccdbd08479"><td class="memItemLeft" align="right" valign="top">TVectorD *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aad661c6d53f9f891e18ff8ccdbd08479">Central_Value</a></td></tr>
<tr class="memdesc:aad661c6d53f9f891e18ff8ccdbd08479"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector with central value for each parameter.  <a href="classMCMCProcessor.html#aad661c6d53f9f891e18ff8ccdbd08479">More...</a><br /></td></tr>
<tr class="separator:aad661c6d53f9f891e18ff8ccdbd08479"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acaf7f239136dfa3506d095b612323d0a"><td class="memItemLeft" align="right" valign="top">TVectorD *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#acaf7f239136dfa3506d095b612323d0a">Means</a></td></tr>
<tr class="memdesc:acaf7f239136dfa3506d095b612323d0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector with mean values using Arithmetic Mean.  <a href="classMCMCProcessor.html#acaf7f239136dfa3506d095b612323d0a">More...</a><br /></td></tr>
<tr class="separator:acaf7f239136dfa3506d095b612323d0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5174aaa900edf16ddc6e841ea4adae83"><td class="memItemLeft" align="right" valign="top">TVectorD *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a5174aaa900edf16ddc6e841ea4adae83">Errors</a></td></tr>
<tr class="memdesc:a5174aaa900edf16ddc6e841ea4adae83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector with errors values using RMS.  <a href="classMCMCProcessor.html#a5174aaa900edf16ddc6e841ea4adae83">More...</a><br /></td></tr>
<tr class="separator:a5174aaa900edf16ddc6e841ea4adae83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a600fc8c39af2750df91fb7a0ff85ac74"><td class="memItemLeft" align="right" valign="top">TVectorD *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a600fc8c39af2750df91fb7a0ff85ac74">Means_Gauss</a></td></tr>
<tr class="memdesc:a600fc8c39af2750df91fb7a0ff85ac74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector with mean values using Gaussian fit.  <a href="classMCMCProcessor.html#a600fc8c39af2750df91fb7a0ff85ac74">More...</a><br /></td></tr>
<tr class="separator:a600fc8c39af2750df91fb7a0ff85ac74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa78b7ed1bb9966f84f4eaf8cedf5e688"><td class="memItemLeft" align="right" valign="top">TVectorD *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aa78b7ed1bb9966f84f4eaf8cedf5e688">Errors_Gauss</a></td></tr>
<tr class="memdesc:aa78b7ed1bb9966f84f4eaf8cedf5e688"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector with error values using Gaussian fit.  <a href="classMCMCProcessor.html#aa78b7ed1bb9966f84f4eaf8cedf5e688">More...</a><br /></td></tr>
<tr class="separator:aa78b7ed1bb9966f84f4eaf8cedf5e688"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32657dc39a7fc0d04804f6195a3d8c3e"><td class="memItemLeft" align="right" valign="top">TVectorD *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a32657dc39a7fc0d04804f6195a3d8c3e">Means_HPD</a></td></tr>
<tr class="memdesc:a32657dc39a7fc0d04804f6195a3d8c3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector with mean values using Highest Posterior Density.  <a href="classMCMCProcessor.html#a32657dc39a7fc0d04804f6195a3d8c3e">More...</a><br /></td></tr>
<tr class="separator:a32657dc39a7fc0d04804f6195a3d8c3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb5c6ad85c89227bbb9bc5de2eb71272"><td class="memItemLeft" align="right" valign="top">TVectorD *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#abb5c6ad85c89227bbb9bc5de2eb71272">Errors_HPD</a></td></tr>
<tr class="memdesc:abb5c6ad85c89227bbb9bc5de2eb71272"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector with error values using Highest Posterior Density.  <a href="classMCMCProcessor.html#abb5c6ad85c89227bbb9bc5de2eb71272">More...</a><br /></td></tr>
<tr class="separator:abb5c6ad85c89227bbb9bc5de2eb71272"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af96664fa8cc51c49ad1385da07a343b8"><td class="memItemLeft" align="right" valign="top">TVectorD *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#af96664fa8cc51c49ad1385da07a343b8">Errors_HPD_Positive</a></td></tr>
<tr class="memdesc:af96664fa8cc51c49ad1385da07a343b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector with positive error (right hand side) values using Highest Posterior Density.  <a href="classMCMCProcessor.html#af96664fa8cc51c49ad1385da07a343b8">More...</a><br /></td></tr>
<tr class="separator:af96664fa8cc51c49ad1385da07a343b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b85df39f22390dac24f4d66a89518e5"><td class="memItemLeft" align="right" valign="top">TVectorD *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a7b85df39f22390dac24f4d66a89518e5">Errors_HPD_Negative</a></td></tr>
<tr class="memdesc:a7b85df39f22390dac24f4d66a89518e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector with negative error (left hand side) values using Highest Posterior Density.  <a href="classMCMCProcessor.html#a7b85df39f22390dac24f4d66a89518e5">More...</a><br /></td></tr>
<tr class="separator:a7b85df39f22390dac24f4d66a89518e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9a40632e2d7f1266d69a74d5b5f2244"><td class="memItemLeft" align="right" valign="top">TMatrixDSym *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a></td></tr>
<tr class="memdesc:af9a40632e2d7f1266d69a74d5b5f2244"><td class="mdescLeft">&#160;</td><td class="mdescRight">Posterior Covariance Matrix.  <a href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">More...</a><br /></td></tr>
<tr class="separator:af9a40632e2d7f1266d69a74d5b5f2244"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03f28431158777cdd81d058b6632a92f"><td class="memItemLeft" align="right" valign="top">TMatrixDSym *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a></td></tr>
<tr class="memdesc:a03f28431158777cdd81d058b6632a92f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Posterior Correlation Matrix.  <a href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">More...</a><br /></td></tr>
<tr class="separator:a03f28431158777cdd81d058b6632a92f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a795f661ed1ba8b8ae54c41fde5fb9496"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH1D * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a></td></tr>
<tr class="memdesc:a795f661ed1ba8b8ae54c41fde5fb9496"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds 1D Posterior Distributions.  <a href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">More...</a><br /></td></tr>
<tr class="separator:a795f661ed1ba8b8ae54c41fde5fb9496"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac924273ef73ef60a5f6e8a166918bb31"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; TH2D * &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a></td></tr>
<tr class="memdesc:ac924273ef73ef60a5f6e8a166918bb31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds 2D Posterior Distributions.  <a href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">More...</a><br /></td></tr>
<tr class="separator:ac924273ef73ef60a5f6e8a166918bb31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97a9669445c141d9dddc19f1b3562479"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; TH2D &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a97a9669445c141d9dddc19f1b3562479">hviolin</a></td></tr>
<tr class="memdesc:a97a9669445c141d9dddc19f1b3562479"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds violin plot for all dials.  <a href="classMCMCProcessor.html#a97a9669445c141d9dddc19f1b3562479">More...</a><br /></td></tr>
<tr class="separator:a97a9669445c141d9dddc19f1b3562479"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4061fd7eeeee55dd709fe844146ed815"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; TH2D &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a4061fd7eeeee55dd709fe844146ed815">hviolin_prior</a></td></tr>
<tr class="memdesc:a4061fd7eeeee55dd709fe844146ed815"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds prior violin plot for all dials,.  <a href="classMCMCProcessor.html#a4061fd7eeeee55dd709fe844146ed815">More...</a><br /></td></tr>
<tr class="separator:a4061fd7eeeee55dd709fe844146ed815"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a200b389934dcb87bf091229fb7b3fa9f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a></td></tr>
<tr class="memdesc:a200b389934dcb87bf091229fb7b3fa9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array holding values for all parameters.  <a href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">More...</a><br /></td></tr>
<tr class="separator:a200b389934dcb87bf091229fb7b3fa9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6058bb3e817401423231f85a71db46a0"><td class="memItemLeft" align="right" valign="top">unsigned int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a6058bb3e817401423231f85a71db46a0">StepNumber</a></td></tr>
<tr class="memdesc:a6058bb3e817401423231f85a71db46a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Step number for step, important if chains were merged.  <a href="classMCMCProcessor.html#a6058bb3e817401423231f85a71db46a0">More...</a><br /></td></tr>
<tr class="separator:a6058bb3e817401423231f85a71db46a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b74f8195bcbca0979f9e9fe43468bae"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a></td></tr>
<tr class="memdesc:a6b74f8195bcbca0979f9e9fe43468bae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of bins.  <a href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">More...</a><br /></td></tr>
<tr class="separator:a6b74f8195bcbca0979f9e9fe43468bae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4abe633b264acd9b0459c7b8ccd8b9df"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a4abe633b264acd9b0459c7b8ccd8b9df">DrawRange</a></td></tr>
<tr class="memdesc:a4abe633b264acd9b0459c7b8ccd8b9df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Drawrange for SetMaximum.  <a href="classMCMCProcessor.html#a4abe633b264acd9b0459c7b8ccd8b9df">More...</a><br /></td></tr>
<tr class="separator:a4abe633b264acd9b0459c7b8ccd8b9df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea84f0315695aa05ec41fcf965b1b031"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aea84f0315695aa05ec41fcf965b1b031">CacheMCMC</a></td></tr>
<tr class="memdesc:aea84f0315695aa05ec41fcf965b1b031"><td class="mdescLeft">&#160;</td><td class="mdescRight">MCMC Chain has been cached.  <a href="classMCMCProcessor.html#aea84f0315695aa05ec41fcf965b1b031">More...</a><br /></td></tr>
<tr class="separator:aea84f0315695aa05ec41fcf965b1b031"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf449e50cf358f737fe4a2b65d9668e9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#adf449e50cf358f737fe4a2b65d9668e9">doDiagMCMC</a></td></tr>
<tr class="memdesc:adf449e50cf358f737fe4a2b65d9668e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Doing MCMC Diagnostic.  <a href="classMCMCProcessor.html#adf449e50cf358f737fe4a2b65d9668e9">More...</a><br /></td></tr>
<tr class="separator:adf449e50cf358f737fe4a2b65d9668e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02c5a3f849cf217705816c650c678d19"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a></td></tr>
<tr class="memdesc:a02c5a3f849cf217705816c650c678d19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of batches for Batched Mean.  <a href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">More...</a><br /></td></tr>
<tr class="separator:a02c5a3f849cf217705816c650c678d19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6156bba72e1f076e66f0356e48506a36"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a6156bba72e1f076e66f0356e48506a36">AutoCorrLag</a></td></tr>
<tr class="memdesc:a6156bba72e1f076e66f0356e48506a36"><td class="mdescLeft">&#160;</td><td class="mdescRight">LagL used in AutoCorrelation.  <a href="classMCMCProcessor.html#a6156bba72e1f076e66f0356e48506a36">More...</a><br /></td></tr>
<tr class="separator:a6156bba72e1f076e66f0356e48506a36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3f590b501162fc2ee5b78ce75689771"><td class="memItemLeft" align="right" valign="top">double **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a></td></tr>
<tr class="memdesc:ab3f590b501162fc2ee5b78ce75689771"><td class="mdescLeft">&#160;</td><td class="mdescRight">Values of batched average for every param and batch.  <a href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">More...</a><br /></td></tr>
<tr class="separator:ab3f590b501162fc2ee5b78ce75689771"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28e89498420221149ec97c353c430bf8"><td class="memItemLeft" align="right" valign="top">double **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a28e89498420221149ec97c353c430bf8">SampleValues</a></td></tr>
<tr class="memdesc:a28e89498420221149ec97c353c430bf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds the sample values.  <a href="classMCMCProcessor.html#a28e89498420221149ec97c353c430bf8">More...</a><br /></td></tr>
<tr class="separator:a28e89498420221149ec97c353c430bf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4eb2748c81b0aef9bd7e14785559e301"><td class="memItemLeft" align="right" valign="top">double **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a4eb2748c81b0aef9bd7e14785559e301">SystValues</a></td></tr>
<tr class="memdesc:a4eb2748c81b0aef9bd7e14785559e301"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds the systs values.  <a href="classMCMCProcessor.html#a4eb2748c81b0aef9bd7e14785559e301">More...</a><br /></td></tr>
<tr class="separator:a4eb2748c81b0aef9bd7e14785559e301"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88cab29770fd6098a674a0ab3628a251"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a88cab29770fd6098a674a0ab3628a251">AccProbValues</a></td></tr>
<tr class="memdesc:a88cab29770fd6098a674a0ab3628a251"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds all accProb.  <a href="classMCMCProcessor.html#a88cab29770fd6098a674a0ab3628a251">More...</a><br /></td></tr>
<tr class="separator:a88cab29770fd6098a674a0ab3628a251"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a523a223a4754c133121796f4591c7be3"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a523a223a4754c133121796f4591c7be3">AccProbBatchedAverages</a></td></tr>
<tr class="memdesc:a523a223a4754c133121796f4591c7be3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds all accProb in batches.  <a href="classMCMCProcessor.html#a523a223a4754c133121796f4591c7be3">More...</a><br /></td></tr>
<tr class="separator:a523a223a4754c133121796f4591c7be3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f27039da3508952600b1ef26e76fe19"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a6f27039da3508952600b1ef26e76fe19">ReweightPosterior</a></td></tr>
<tr class="memdesc:a6f27039da3508952600b1ef26e76fe19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether to apply reweighting weight or not.  <a href="classMCMCProcessor.html#a6f27039da3508952600b1ef26e76fe19">More...</a><br /></td></tr>
<tr class="separator:a6f27039da3508952600b1ef26e76fe19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad56b25b03eb5caab7b2a9c2ebf3ec178"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ad56b25b03eb5caab7b2a9c2ebf3ec178">ReweightName</a></td></tr>
<tr class="memdesc:ad56b25b03eb5caab7b2a9c2ebf3ec178"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name of branch used for chain reweighting.  <a href="classMCMCProcessor.html#ad56b25b03eb5caab7b2a9c2ebf3ec178">More...</a><br /></td></tr>
<tr class="separator:ad56b25b03eb5caab7b2a9c2ebf3ec178"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39d4d6d8cfccf1974a6b084f808211a9"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a39d4d6d8cfccf1974a6b084f808211a9">WeightValue</a></td></tr>
<tr class="memdesc:a39d4d6d8cfccf1974a6b084f808211a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores value of weight for each step.  <a href="classMCMCProcessor.html#a39d4d6d8cfccf1974a6b084f808211a9">More...</a><br /></td></tr>
<tr class="separator:a39d4d6d8cfccf1974a6b084f808211a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class responsible for processing MCMC chains, performing diagnostics, generating plots, and managing Bayesian analysis. </p>
<p>This class provides utilities to handle MCMC output generated by mcmc::runMCMC. It is particularly useful for extracting values from previous MCMC runs and initiating new MCMC runs with those values. Inspired by nd280_utils/DrawComp.cpp. </p><dl class="section see"><dt>See also</dt><dd>For more details and examples, visit the <a href="https://github.com/mach3-software/MaCh3/wiki/09.-Bayesian-Analysis,-Plotting-and-MCMC-Processor">Wiki</a>. </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Clarence Wret </dd>
<dd>
Kamil Skwarczynski </dd></dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00058">58</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a23c3d6934899266401e336a8d7142774"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23c3d6934899266401e336a8d7142774">&#9670;&nbsp;</a></span>MCMCProcessor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="Core_8h.html#a46b8fa28114cf68de4549061568b5ade">_MaCh3_Safe_Include_Start_</a> <a class="el" href="Core_8h.html#a91209a17295738b34b124b79faa68a1b">_MaCh3_Safe_Include_End_</a> MCMCProcessor::MCMCProcessor </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>InputFile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructs an <a class="el" href="classMCMCProcessor.html" title="Class responsible for processing MCMC chains, performing diagnostics, generating plots,...">MCMCProcessor</a> object with the specified input file and options. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">InputFile</td><td>The path to the input file containing MCMC data. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l00018">18</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                                                       :</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>(<span class="keyword">nullptr</span>), <a class="code" href="classMCMCProcessor.html#a576f0eb874afaf7e31ff5c86b9e5b8f9">StepCut</a>(<span class="stringliteral">&quot;&quot;</span>), <a class="code" href="classMCMCProcessor.html#aecc35d4ea7d2c7e020e50388ba0ffb64">MadePostfit</a>(<span class="keyword">false</span>) {</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// ****************************</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <a class="code" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a> = InputFile;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#aa603c55ea73cd86d1994901227883e1e">SetMaCh3LoggerFormat</a>();</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <a class="code" href="namespaceMaCh3Utils.html#ac6f4a3b6a7749967ff9a011469352f6c">MaCh3Utils::MaCh3Welcome</a>();</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making post-fit processor for: {}&quot;</span>, <a class="code" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a>);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <a class="code" href="classMCMCProcessor.html#a6058bb3e817401423231f85a71db46a0">StepNumber</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <a class="code" href="classMCMCProcessor.html#a6f27039da3508952600b1ef26e76fe19">ReweightPosterior</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <a class="code" href="classMCMCProcessor.html#a39d4d6d8cfccf1974a6b084f808211a9">WeightValue</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="classMCMCProcessor.html#a97a9669445c141d9dddc19f1b3562479">hviolin</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <a class="code" href="classMCMCProcessor.html#a4061fd7eeeee55dd709fe844146ed815">hviolin_prior</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <a class="code" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="classMCMCProcessor.html#a28e89498420221149ec97c353c430bf8">SampleValues</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <a class="code" href="classMCMCProcessor.html#a4eb2748c81b0aef9bd7e14785559e301">SystValues</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <a class="code" href="classMCMCProcessor.html#a88cab29770fd6098a674a0ab3628a251">AccProbValues</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="classMCMCProcessor.html#a523a223a4754c133121796f4591c7be3">AccProbBatchedAverages</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="comment">//KS:Hardcoded should be a way to get it via config or something</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="classMCMCProcessor.html#afbac2a114c15ca7db4abe71dd549504c">plotRelativeToPrior</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <a class="code" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <a class="code" href="classMCMCProcessor.html#aa7611f55ac3c0ea70607761d037fbd91">plotBinValue</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <a class="code" href="classMCMCProcessor.html#ad24411a2556504c440ff0af045e8e7aa">PlotFlatPrior</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <a class="code" href="classMCMCProcessor.html#aea84f0315695aa05ec41fcf965b1b031">CacheMCMC</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <a class="code" href="classMCMCProcessor.html#a682c1c47626542f5820d633ba2bc010c">ApplySmoothing</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <a class="code" href="classMCMCProcessor.html#ad25fe818c94163b0c4a8fcdfd387c148">FancyPlotNames</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <a class="code" href="classMCMCProcessor.html#adf449e50cf358f737fe4a2b65d9668e9">doDiagMCMC</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="comment">// KS: ROOT can compile FFT code but it will crash during run time. Turn off FFT dynamically</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#ifdef MaCh3_FFT</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <a class="code" href="classMCMCProcessor.html#a562261269f0f4ec4a209b2fca64ff443">useFFTAutoCorrelation</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <a class="code" href="classMCMCProcessor.html#a562261269f0f4ec4a209b2fca64ff443">useFFTAutoCorrelation</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <a class="code" href="classMCMCProcessor.html#aa34b50ce33fb2cb7d9e9ef2d9f2f67c1">OutputSuffix</a> = <span class="stringliteral">&quot;_Process&quot;</span>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <a class="code" href="classMCMCProcessor.html#a25e4685b6299181021b02ac0e0b74681">Post2DPlotThreshold</a> = 1.e-5;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a> = 0;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a> = 0;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="classMCMCProcessor.html#a6b14dd9e571803d8946781642348bee1">UpperCut</a> = <a class="code" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <a class="code" href="classMCMCProcessor.html#aae0016a4e1d105d5d65243438c622a97">nSteps</a> = 0;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a> = 0;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <a class="code" href="classMCMCProcessor.html#a6156bba72e1f076e66f0356e48506a36">AutoCorrLag</a> = 0;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <a class="code" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a> = 70;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="classMCMCProcessor.html#a4abe633b264acd9b0459c7b8ccd8b9df">DrawRange</a> = 1.5;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <a class="code" href="classMCMCProcessor.html#a85917e25c4f5b5b966c50cccd9ddd6a0">Posterior1DCut</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">//KS:Those keep basic information for ParameterEnum</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <a class="code" href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">ParamNames</a>.resize(<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a">kNParameterEnum</a>);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="classMCMCProcessor.html#a3a6614826ae320e462211e38e96d9d02">ParamCentral</a>.resize(<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a">kNParameterEnum</a>);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <a class="code" href="classMCMCProcessor.html#a3a97e3cb4be3ceb9eb721eac51d82d60">ParamErrors</a>.resize(<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a">kNParameterEnum</a>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="classMCMCProcessor.html#a4be1eedb743e4ea410009a4fa45720f7">ParamFlat</a>.resize(<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a">kNParameterEnum</a>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <a class="code" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>.resize(<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a">kNParameterEnum</a>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <a class="code" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>.resize(<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a">kNParameterEnum</a>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <a class="code" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>.resize(<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a">kNParameterEnum</a>);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <a class="code" href="classMCMCProcessor.html#a4a43ac10847a053db74553682f15e1d5">CovNamePos</a>.resize(<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a">kNParameterEnum</a>);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <a class="code" href="classMCMCProcessor.html#a4c1330a025c0b91e382bdc29c960424a">CovConfig</a>.resize(<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a">kNParameterEnum</a>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a">kNParameterEnum</a>; i++)</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[i] = 0;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[i] = 0;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">//Only if GPU is enabled</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">  #ifdef MaCh3_CUDA</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;   GPUProcessor = std::make_unique&lt;MCMCProcessorGPU&gt;();</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;}</div>
<div class="ttc" id="aMCMCProcessor_8h_html_acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a"><div class="ttname"><a href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a">kNParameterEnum</a></div><div class="ttdeci">@ kNParameterEnum</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00051">MCMCProcessor.h:50</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_a95fa4dffc648e4c5536c9292c2bdcac3"><div class="ttname"><a href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a></div><div class="ttdeci">#define MACH3LOG_INFO</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00035">MaCh3Logger.h:35</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_aa603c55ea73cd86d1994901227883e1e"><div class="ttname"><a href="MaCh3Logger_8h.html#aa603c55ea73cd86d1994901227883e1e">SetMaCh3LoggerFormat</a></div><div class="ttdeci">void SetMaCh3LoggerFormat()</div><div class="ttdoc">Set messaging format of the logger.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00061">MaCh3Logger.h:61</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a02c5a3f849cf217705816c650c678d19"><div class="ttname"><a href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">MCMCProcessor::nBatches</a></div><div class="ttdeci">int nBatches</div><div class="ttdoc">Number of batches for Batched Mean.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00570">MCMCProcessor.h:570</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a200b389934dcb87bf091229fb7b3fa9f"><div class="ttname"><a href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">MCMCProcessor::ParStep</a></div><div class="ttdeci">M3::float_t ** ParStep</div><div class="ttdoc">Array holding values for all parameters.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00554">MCMCProcessor.h:554</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a25e4685b6299181021b02ac0e0b74681"><div class="ttname"><a href="classMCMCProcessor.html#a25e4685b6299181021b02ac0e0b74681">MCMCProcessor::Post2DPlotThreshold</a></div><div class="ttdeci">double Post2DPlotThreshold</div><div class="ttdoc">KS: Set Threshold when to plot 2D posterior as by default we get a LOT of plots.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00503">MCMCProcessor.h:503</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a28e89498420221149ec97c353c430bf8"><div class="ttname"><a href="classMCMCProcessor.html#a28e89498420221149ec97c353c430bf8">MCMCProcessor::SampleValues</a></div><div class="ttdeci">double ** SampleValues</div><div class="ttdoc">Holds the sample values.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00578">MCMCProcessor.h:578</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a39d4d6d8cfccf1974a6b084f808211a9"><div class="ttname"><a href="classMCMCProcessor.html#a39d4d6d8cfccf1974a6b084f808211a9">MCMCProcessor::WeightValue</a></div><div class="ttdeci">double * WeightValue</div><div class="ttdoc">Stores value of weight for each step.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00592">MCMCProcessor.h:592</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a3a6614826ae320e462211e38e96d9d02"><div class="ttname"><a href="classMCMCProcessor.html#a3a6614826ae320e462211e38e96d9d02">MCMCProcessor::ParamCentral</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; ParamCentral</div><div class="ttdoc">Parameters central values which we are going to analyse.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00461">MCMCProcessor.h:461</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a3a97e3cb4be3ceb9eb721eac51d82d60"><div class="ttname"><a href="classMCMCProcessor.html#a3a97e3cb4be3ceb9eb721eac51d82d60">MCMCProcessor::ParamErrors</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; ParamErrors</div><div class="ttdoc">Uncertainty on a single parameter.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00463">MCMCProcessor.h:463</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a4061fd7eeeee55dd709fe844146ed815"><div class="ttname"><a href="classMCMCProcessor.html#a4061fd7eeeee55dd709fe844146ed815">MCMCProcessor::hviolin_prior</a></div><div class="ttdeci">std::unique_ptr&lt; TH2D &gt; hviolin_prior</div><div class="ttdoc">Holds prior violin plot for all dials,.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00551">MCMCProcessor.h:551</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a4200e7cbe1c8f811d3640ebfd648ca85"><div class="ttname"><a href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">MCMCProcessor::nParam</a></div><div class="ttdeci">std::vector&lt; int &gt; nParam</div><div class="ttdoc">Number of parameters per type.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00467">MCMCProcessor.h:467</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a4a43ac10847a053db74553682f15e1d5"><div class="ttname"><a href="classMCMCProcessor.html#a4a43ac10847a053db74553682f15e1d5">MCMCProcessor::CovNamePos</a></div><div class="ttdeci">std::vector&lt; std::string &gt; CovNamePos</div><div class="ttdoc">Covariance matrix name position.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00423">MCMCProcessor.h:423</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a4abe633b264acd9b0459c7b8ccd8b9df"><div class="ttname"><a href="classMCMCProcessor.html#a4abe633b264acd9b0459c7b8ccd8b9df">MCMCProcessor::DrawRange</a></div><div class="ttdeci">double DrawRange</div><div class="ttdoc">Drawrange for SetMaximum.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00561">MCMCProcessor.h:561</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a4be1eedb743e4ea410009a4fa45720f7"><div class="ttname"><a href="classMCMCProcessor.html#a4be1eedb743e4ea410009a4fa45720f7">MCMCProcessor::ParamFlat</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; bool &gt; &gt; ParamFlat</div><div class="ttdoc">Whether Param has flat prior or not.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00465">MCMCProcessor.h:465</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a4c1330a025c0b91e382bdc29c960424a"><div class="ttname"><a href="classMCMCProcessor.html#a4c1330a025c0b91e382bdc29c960424a">MCMCProcessor::CovConfig</a></div><div class="ttdeci">std::vector&lt; YAML::Node &gt; CovConfig</div><div class="ttdoc">Covariance matrix config.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00425">MCMCProcessor.h:425</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a4eb2748c81b0aef9bd7e14785559e301"><div class="ttname"><a href="classMCMCProcessor.html#a4eb2748c81b0aef9bd7e14785559e301">MCMCProcessor::SystValues</a></div><div class="ttdeci">double ** SystValues</div><div class="ttdoc">Holds the systs values.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00580">MCMCProcessor.h:580</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a523a223a4754c133121796f4591c7be3"><div class="ttname"><a href="classMCMCProcessor.html#a523a223a4754c133121796f4591c7be3">MCMCProcessor::AccProbBatchedAverages</a></div><div class="ttdeci">double * AccProbBatchedAverages</div><div class="ttdoc">Holds all accProb in batches.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00585">MCMCProcessor.h:585</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a562261269f0f4ec4a209b2fca64ff443"><div class="ttname"><a href="classMCMCProcessor.html#a562261269f0f4ec4a209b2fca64ff443">MCMCProcessor::useFFTAutoCorrelation</a></div><div class="ttdeci">bool useFFTAutoCorrelation</div><div class="ttdoc">MJR: Use FFT-based autocorrelation algorithm (save time &amp; resources)?</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00505">MCMCProcessor.h:505</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a576f0eb874afaf7e31ff5c86b9e5b8f9"><div class="ttname"><a href="classMCMCProcessor.html#a576f0eb874afaf7e31ff5c86b9e5b8f9">MCMCProcessor::StepCut</a></div><div class="ttdeci">std::string StepCut</div><div class="ttdoc">BurnIn Cuts.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00430">MCMCProcessor.h:430</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a6058bb3e817401423231f85a71db46a0"><div class="ttname"><a href="classMCMCProcessor.html#a6058bb3e817401423231f85a71db46a0">MCMCProcessor::StepNumber</a></div><div class="ttdeci">unsigned int * StepNumber</div><div class="ttdoc">Step number for step, important if chains were merged.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00556">MCMCProcessor.h:556</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a6156bba72e1f076e66f0356e48506a36"><div class="ttname"><a href="classMCMCProcessor.html#a6156bba72e1f076e66f0356e48506a36">MCMCProcessor::AutoCorrLag</a></div><div class="ttdeci">int AutoCorrLag</div><div class="ttdoc">LagL used in AutoCorrelation.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00572">MCMCProcessor.h:572</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a61deb3c399dc10813b5cd116f041e981"><div class="ttname"><a href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">MCMCProcessor::Posterior</a></div><div class="ttdeci">std::unique_ptr&lt; TCanvas &gt; Posterior</div><div class="ttdoc">Fancy canvas used for our beautiful plots.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00517">MCMCProcessor.h:517</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a62035b99df4617ab334cd1abd6ed0346"><div class="ttname"><a href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">MCMCProcessor::OutputFile</a></div><div class="ttdeci">TFile * OutputFile</div><div class="ttdoc">The output file.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00514">MCMCProcessor.h:514</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a682c1c47626542f5820d633ba2bc010c"><div class="ttname"><a href="classMCMCProcessor.html#a682c1c47626542f5820d633ba2bc010c">MCMCProcessor::ApplySmoothing</a></div><div class="ttdeci">bool ApplySmoothing</div><div class="ttdoc">Apply smoothing for 2D histos using root algorithm.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00501">MCMCProcessor.h:501</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a6b14dd9e571803d8946781642348bee1"><div class="ttname"><a href="classMCMCProcessor.html#a6b14dd9e571803d8946781642348bee1">MCMCProcessor::UpperCut</a></div><div class="ttdeci">unsigned int UpperCut</div><div class="ttdoc">KS: Used only for SubOptimality.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00434">MCMCProcessor.h:434</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a6b74f8195bcbca0979f9e9fe43468bae"><div class="ttname"><a href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">MCMCProcessor::nBins</a></div><div class="ttdeci">int nBins</div><div class="ttdoc">Number of bins.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00559">MCMCProcessor.h:559</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a6be3bbebd4a79fe9814a3da09b3bb820"><div class="ttname"><a href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">MCMCProcessor::Chain</a></div><div class="ttdeci">TChain * Chain</div><div class="ttdoc">Main chain storing all steps etc.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00428">MCMCProcessor.h:428</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a6d212d77a818304a8674a7b9b18d43b8"><div class="ttname"><a href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCProcessor::MCMCFile</a></div><div class="ttdeci">std::string MCMCFile</div><div class="ttdoc">Name of MCMC file.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00417">MCMCProcessor.h:417</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a6f27039da3508952600b1ef26e76fe19"><div class="ttname"><a href="classMCMCProcessor.html#a6f27039da3508952600b1ef26e76fe19">MCMCProcessor::ReweightPosterior</a></div><div class="ttdeci">bool ReweightPosterior</div><div class="ttdoc">Whether to apply reweighting weight or not.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00588">MCMCProcessor.h:588</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a7c6afb0ed75207fd02c28e408f0592d4"><div class="ttname"><a href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">MCMCProcessor::CovPos</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::string &gt; &gt; CovPos</div><div class="ttdoc">Covariance matrix file name position.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00421">MCMCProcessor.h:421</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a85917e25c4f5b5b966c50cccd9ddd6a0"><div class="ttname"><a href="classMCMCProcessor.html#a85917e25c4f5b5b966c50cccd9ddd6a0">MCMCProcessor::Posterior1DCut</a></div><div class="ttdeci">std::string Posterior1DCut</div><div class="ttdoc">Cut used when making 1D Posterior distribution.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00432">MCMCProcessor.h:432</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a88cab29770fd6098a674a0ab3628a251"><div class="ttname"><a href="classMCMCProcessor.html#a88cab29770fd6098a674a0ab3628a251">MCMCProcessor::AccProbValues</a></div><div class="ttdeci">double * AccProbValues</div><div class="ttdoc">Holds all accProb.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00583">MCMCProcessor.h:583</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a97a9669445c141d9dddc19f1b3562479"><div class="ttname"><a href="classMCMCProcessor.html#a97a9669445c141d9dddc19f1b3562479">MCMCProcessor::hviolin</a></div><div class="ttdeci">std::unique_ptr&lt; TH2D &gt; hviolin</div><div class="ttdoc">Holds violin plot for all dials.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00549">MCMCProcessor.h:549</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aa30545fedb0af2ad9619d6accf42a10d"><div class="ttname"><a href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">MCMCProcessor::nDraw</a></div><div class="ttdeci">int nDraw</div><div class="ttdoc">Number of all parameters used in the analysis.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00448">MCMCProcessor.h:448</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aa34b50ce33fb2cb7d9e9ef2d9f2f67c1"><div class="ttname"><a href="classMCMCProcessor.html#aa34b50ce33fb2cb7d9e9ef2d9f2f67c1">MCMCProcessor::OutputSuffix</a></div><div class="ttdeci">std::string OutputSuffix</div><div class="ttdoc">Output file suffix useful when running over same file with different settings.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00419">MCMCProcessor.h:419</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aa7611f55ac3c0ea70607761d037fbd91"><div class="ttname"><a href="classMCMCProcessor.html#aa7611f55ac3c0ea70607761d037fbd91">MCMCProcessor::plotBinValue</a></div><div class="ttdeci">bool plotBinValue</div><div class="ttdoc">If true it will print value on each bin of covariance matrix.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00499">MCMCProcessor.h:499</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aae0016a4e1d105d5d65243438c622a97"><div class="ttname"><a href="classMCMCProcessor.html#aae0016a4e1d105d5d65243438c622a97">MCMCProcessor::nSteps</a></div><div class="ttdeci">int nSteps</div><div class="ttdoc">KS: For merged chains number of entries will be different from nSteps.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00442">MCMCProcessor.h:442</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ab3f590b501162fc2ee5b78ce75689771"><div class="ttname"><a href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">MCMCProcessor::BatchedAverages</a></div><div class="ttdeci">double ** BatchedAverages</div><div class="ttdoc">Values of batched average for every param and batch.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00575">MCMCProcessor.h:575</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ad24411a2556504c440ff0af045e8e7aa"><div class="ttname"><a href="classMCMCProcessor.html#ad24411a2556504c440ff0af045e8e7aa">MCMCProcessor::PlotFlatPrior</a></div><div class="ttdeci">bool PlotFlatPrior</div><div class="ttdoc">Whether we plot flat prior or not, we usually provide error even for flat prior params.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00487">MCMCProcessor.h:487</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ad25fe818c94163b0c4a8fcdfd387c148"><div class="ttname"><a href="classMCMCProcessor.html#ad25fe818c94163b0c4a8fcdfd387c148">MCMCProcessor::FancyPlotNames</a></div><div class="ttdeci">bool FancyPlotNames</div><div class="ttdoc">Whether we want fancy plot names or not.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00497">MCMCProcessor.h:497</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ad73755714ae3d6dc951158d5513c6eee"><div class="ttname"><a href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">MCMCProcessor::printToPDF</a></div><div class="ttdeci">bool printToPDF</div><div class="ttdoc">Will plot all plot to PDF not only to root file.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00495">MCMCProcessor.h:495</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_adecc55689f7d37b9412f8886fe3480dc"><div class="ttname"><a href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">MCMCProcessor::ParamNames</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; TString &gt; &gt; ParamNames</div><div class="ttdoc">Name of parameters which we are going to analyse.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00459">MCMCProcessor.h:459</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_adf449e50cf358f737fe4a2b65d9668e9"><div class="ttname"><a href="classMCMCProcessor.html#adf449e50cf358f737fe4a2b65d9668e9">MCMCProcessor::doDiagMCMC</a></div><div class="ttdeci">bool doDiagMCMC</div><div class="ttdoc">Doing MCMC Diagnostic.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00566">MCMCProcessor.h:566</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aea84f0315695aa05ec41fcf965b1b031"><div class="ttname"><a href="classMCMCProcessor.html#aea84f0315695aa05ec41fcf965b1b031">MCMCProcessor::CacheMCMC</a></div><div class="ttdeci">bool CacheMCMC</div><div class="ttdoc">MCMC Chain has been cached.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00564">MCMCProcessor.h:564</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aeab63979ff36256072c046a15d981875"><div class="ttname"><a href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">MCMCProcessor::ParamTypeStartPos</a></div><div class="ttdeci">std::vector&lt; int &gt; ParamTypeStartPos</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00472">MCMCProcessor.h:472</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aecc35d4ea7d2c7e020e50388ba0ffb64"><div class="ttname"><a href="classMCMCProcessor.html#aecc35d4ea7d2c7e020e50388ba0ffb64">MCMCProcessor::MadePostfit</a></div><div class="ttdeci">bool MadePostfit</div><div class="ttdoc">Sanity check if Postfit is already done to not make several times.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00493">MCMCProcessor.h:493</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_af3a19b885e9c34e1674aea8cfbe14e1c"><div class="ttname"><a href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">MCMCProcessor::nEntries</a></div><div class="ttdeci">int nEntries</div><div class="ttdoc">KS: For merged chains number of entries will be different from nSteps.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00440">MCMCProcessor.h:440</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_afbac2a114c15ca7db4abe71dd549504c"><div class="ttname"><a href="classMCMCProcessor.html#afbac2a114c15ca7db4abe71dd549504c">MCMCProcessor::plotRelativeToPrior</a></div><div class="ttdeci">bool plotRelativeToPrior</div><div class="ttdoc">Whether we plot relative to prior or nominal, in most cases is prior.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00491">MCMCProcessor.h:491</a></div></div>
<div class="ttc" id="anamespaceM3_html_ac289df32a5b3b05c61a87cbac5702b25"><div class="ttname"><a href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a></div><div class="ttdeci">constexpr static const int _BAD_INT_</div><div class="ttdoc">Default value used for int initialisation.</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00055">Core.h:55</a></div></div>
<div class="ttc" id="anamespaceMaCh3Utils_html_ac6f4a3b6a7749967ff9a011469352f6c"><div class="ttname"><a href="namespaceMaCh3Utils.html#ac6f4a3b6a7749967ff9a011469352f6c">MaCh3Utils::MaCh3Welcome</a></div><div class="ttdeci">void MaCh3Welcome()</div><div class="ttdoc">KS: Prints welcome message with MaCh3 logo.</div><div class="ttdef"><b>Definition:</b> <a href="Monitor_8cpp_source.html#l00012">Monitor.cpp:12</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a50810cd50c5a4545bd5c1e486aae7b1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50810cd50c5a4545bd5c1e486aae7b1c">&#9670;&nbsp;</a></span>~MCMCProcessor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MCMCProcessor::~MCMCProcessor </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destroys the <a class="el" href="classMCMCProcessor.html" title="Class responsible for processing MCMC chains, performing diagnostics, generating plots,...">MCMCProcessor</a> object. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l00098">98</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                              {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">// ****************************</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="comment">// Close the pdf file</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Closing pdf in MCMCProcessor: {}&quot;</span>, <a class="code" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>.Data());</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a> += <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Print(<a class="code" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keyword">delete</span> <a class="code" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keyword">delete</span> <a class="code" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keyword">delete</span> <a class="code" href="classMCMCProcessor.html#aad661c6d53f9f891e18ff8ccdbd08479">Central_Value</a>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keyword">delete</span> <a class="code" href="classMCMCProcessor.html#acaf7f239136dfa3506d095b612323d0a">Means</a>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keyword">delete</span> <a class="code" href="classMCMCProcessor.html#a5174aaa900edf16ddc6e841ea4adae83">Errors</a>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keyword">delete</span> <a class="code" href="classMCMCProcessor.html#a600fc8c39af2750df91fb7a0ff85ac74">Means_Gauss</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keyword">delete</span> <a class="code" href="classMCMCProcessor.html#aa78b7ed1bb9966f84f4eaf8cedf5e688">Errors_Gauss</a>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keyword">delete</span> <a class="code" href="classMCMCProcessor.html#a32657dc39a7fc0d04804f6195a3d8c3e">Means_HPD</a>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keyword">delete</span> <a class="code" href="classMCMCProcessor.html#abb5c6ad85c89227bbb9bc5de2eb71272">Errors_HPD</a>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keyword">delete</span> <a class="code" href="classMCMCProcessor.html#af96664fa8cc51c49ad1385da07a343b8">Errors_HPD_Positive</a>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keyword">delete</span> <a class="code" href="classMCMCProcessor.html#a7b85df39f22390dac24f4d66a89518e5">Errors_HPD_Negative</a>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a39d4d6d8cfccf1974a6b084f808211a9">WeightValue</a>) <span class="keyword">delete</span>[] <a class="code" href="classMCMCProcessor.html#a39d4d6d8cfccf1974a6b084f808211a9">WeightValue</a>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i] != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i];</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#aea84f0315695aa05ec41fcf965b1b031">CacheMCMC</a>)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i) </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keyword">delete</span> <a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i][j];</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keyword">delete</span>[] <a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>[i];</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a6058bb3e817401423231f85a71db46a0">StepNumber</a> != <span class="keyword">nullptr</span>) <span class="keyword">delete</span>[] <a class="code" href="classMCMCProcessor.html#a6058bb3e817401423231f85a71db46a0">StepNumber</a>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a> != <span class="keyword">nullptr</span>) <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;Close();</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a> != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keyword">delete</span> <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a03f28431158777cdd81d058b6632a92f"><div class="ttname"><a href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">MCMCProcessor::Correlation</a></div><div class="ttdeci">TMatrixDSym * Correlation</div><div class="ttdoc">Posterior Correlation Matrix.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00542">MCMCProcessor.h:542</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a32657dc39a7fc0d04804f6195a3d8c3e"><div class="ttname"><a href="classMCMCProcessor.html#a32657dc39a7fc0d04804f6195a3d8c3e">MCMCProcessor::Means_HPD</a></div><div class="ttdeci">TVectorD * Means_HPD</div><div class="ttdoc">Vector with mean values using Highest Posterior Density.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00531">MCMCProcessor.h:531</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a5174aaa900edf16ddc6e841ea4adae83"><div class="ttname"><a href="classMCMCProcessor.html#a5174aaa900edf16ddc6e841ea4adae83">MCMCProcessor::Errors</a></div><div class="ttdeci">TVectorD * Errors</div><div class="ttdoc">Vector with errors values using RMS.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00525">MCMCProcessor.h:525</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a600fc8c39af2750df91fb7a0ff85ac74"><div class="ttname"><a href="classMCMCProcessor.html#a600fc8c39af2750df91fb7a0ff85ac74">MCMCProcessor::Means_Gauss</a></div><div class="ttdeci">TVectorD * Means_Gauss</div><div class="ttdoc">Vector with mean values using Gaussian fit.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00527">MCMCProcessor.h:527</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a795f661ed1ba8b8ae54c41fde5fb9496"><div class="ttname"><a href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">MCMCProcessor::hpost</a></div><div class="ttdeci">std::vector&lt; TH1D * &gt; hpost</div><div class="ttdoc">Holds 1D Posterior Distributions.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00545">MCMCProcessor.h:545</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a7b85df39f22390dac24f4d66a89518e5"><div class="ttname"><a href="classMCMCProcessor.html#a7b85df39f22390dac24f4d66a89518e5">MCMCProcessor::Errors_HPD_Negative</a></div><div class="ttdeci">TVectorD * Errors_HPD_Negative</div><div class="ttdoc">Vector with negative error (left hand side) values using Highest Posterior Density.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00537">MCMCProcessor.h:537</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aa78b7ed1bb9966f84f4eaf8cedf5e688"><div class="ttname"><a href="classMCMCProcessor.html#aa78b7ed1bb9966f84f4eaf8cedf5e688">MCMCProcessor::Errors_Gauss</a></div><div class="ttdeci">TVectorD * Errors_Gauss</div><div class="ttdoc">Vector with error values using Gaussian fit.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00529">MCMCProcessor.h:529</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aad661c6d53f9f891e18ff8ccdbd08479"><div class="ttname"><a href="classMCMCProcessor.html#aad661c6d53f9f891e18ff8ccdbd08479">MCMCProcessor::Central_Value</a></div><div class="ttdeci">TVectorD * Central_Value</div><div class="ttdoc">Vector with central value for each parameter.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00521">MCMCProcessor.h:521</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ab5aec3dc293919701d31e6ae705601dd"><div class="ttname"><a href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">MCMCProcessor::CanvasName</a></div><div class="ttdeci">TString CanvasName</div><div class="ttdoc">Name of canvas which help to save to the sample pdf.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00484">MCMCProcessor.h:484</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_abb5c6ad85c89227bbb9bc5de2eb71272"><div class="ttname"><a href="classMCMCProcessor.html#abb5c6ad85c89227bbb9bc5de2eb71272">MCMCProcessor::Errors_HPD</a></div><div class="ttdeci">TVectorD * Errors_HPD</div><div class="ttdoc">Vector with error values using Highest Posterior Density.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00533">MCMCProcessor.h:533</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ac924273ef73ef60a5f6e8a166918bb31"><div class="ttname"><a href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">MCMCProcessor::hpost2D</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; TH2D * &gt; &gt; hpost2D</div><div class="ttdoc">Holds 2D Posterior Distributions.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00547">MCMCProcessor.h:547</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_acaf7f239136dfa3506d095b612323d0a"><div class="ttname"><a href="classMCMCProcessor.html#acaf7f239136dfa3506d095b612323d0a">MCMCProcessor::Means</a></div><div class="ttdeci">TVectorD * Means</div><div class="ttdoc">Vector with mean values using Arithmetic Mean.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00523">MCMCProcessor.h:523</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_af96664fa8cc51c49ad1385da07a343b8"><div class="ttname"><a href="classMCMCProcessor.html#af96664fa8cc51c49ad1385da07a343b8">MCMCProcessor::Errors_HPD_Positive</a></div><div class="ttdeci">TVectorD * Errors_HPD_Positive</div><div class="ttdoc">Vector with positive error (right hand side) values using Highest Posterior Density.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00535">MCMCProcessor.h:535</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_af9a40632e2d7f1266d69a74d5b5f2244"><div class="ttname"><a href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">MCMCProcessor::Covariance</a></div><div class="ttdeci">TMatrixDSym * Covariance</div><div class="ttdoc">Posterior Covariance Matrix.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00540">MCMCProcessor.h:540</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a278b82fa945d847e57ae6ed6357d8f61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a278b82fa945d847e57ae6ed6357d8f61">&#9670;&nbsp;</a></span>AcceptanceProbabilities()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::AcceptanceProbabilities </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Acceptance Probability. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l04466">4466</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;                                            {</div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#a523a223a4754c133121796f4591c7be3">AccProbBatchedAverages</a> == <span class="keyword">nullptr</span>) <a class="code" href="classMCMCProcessor.html#a930cadafa41b31b58066dea68628de9f">PrepareDiagMCMC</a>();</div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160; </div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making AccProb plots...&quot;</span>);</div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160; </div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;  <span class="comment">// Set the titles and limits for TH1Ds</span></div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;  <span class="keyword">auto</span> AcceptanceProbPlot = std::make_unique&lt;TH1D&gt;(<span class="stringliteral">&quot;AcceptanceProbability&quot;</span>, <span class="stringliteral">&quot;Acceptance Probability&quot;</span>, <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>, 0, <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;  AcceptanceProbPlot-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;  AcceptanceProbPlot-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Step&quot;</span>);</div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;  AcceptanceProbPlot-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Acceptance Probability&quot;</span>);</div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160; </div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;  <span class="keyword">auto</span> BatchedAcceptanceProblot = std::make_unique&lt;TH1D&gt;(<span class="stringliteral">&quot;AcceptanceProbability_Batch&quot;</span>, <span class="stringliteral">&quot;AcceptanceProbability_Batch&quot;</span>, <a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>, 0, <a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>);</div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;  BatchedAcceptanceProblot-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;  BatchedAcceptanceProblot-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Acceptance Probability&quot;</span>);</div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;  </div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>; ++i) {</div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;    BatchedAcceptanceProblot-&gt;SetBinContent(i+1, <a class="code" href="classMCMCProcessor.html#a523a223a4754c133121796f4591c7be3">AccProbBatchedAverages</a>[i]);</div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> BatchRangeLow = double(i)*double(<a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>)/double(<a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>);</div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> BatchRangeHigh = double(i+1)*double(<a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>)/double(<a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>);</div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;    std::stringstream ss;</div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;    ss &lt;&lt; BatchRangeLow &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; BatchRangeHigh;</div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;    BatchedAcceptanceProblot-&gt;GetXaxis()-&gt;SetBinLabel(i+1, ss.str().c_str());</div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;  }</div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;  </div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;<span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i) {</div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;    <span class="comment">// Set bin content for the i-th bin to the parameter values</span></div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;    AcceptanceProbPlot-&gt;SetBinContent(i, <a class="code" href="classMCMCProcessor.html#a88cab29770fd6098a674a0ab3628a251">AccProbValues</a>[i]);</div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;  }</div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;    </div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;  TDirectory *probDir = <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;AccProb&quot;</span>);</div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;  probDir-&gt;cd();</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;  </div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;  AcceptanceProbPlot-&gt;Write();</div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;  BatchedAcceptanceProblot-&gt;Write();</div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;  <span class="keyword">delete</span>[] <a class="code" href="classMCMCProcessor.html#a88cab29770fd6098a674a0ab3628a251">AccProbValues</a>;</div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;  <span class="keyword">delete</span>[] <a class="code" href="classMCMCProcessor.html#a523a223a4754c133121796f4591c7be3">AccProbBatchedAverages</a>;</div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160; </div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;  probDir-&gt;Close();</div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;  <span class="keyword">delete</span> probDir;</div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160; </div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a930cadafa41b31b58066dea68628de9f"><div class="ttname"><a href="classMCMCProcessor.html#a930cadafa41b31b58066dea68628de9f">MCMCProcessor::PrepareDiagMCMC</a></div><div class="ttdeci">void PrepareDiagMCMC()</div><div class="ttdoc">CW: Prepare branches etc. for DiagMCMC.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l03370">MCMCProcessor.cpp:3370</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a322bee0c362ba83df8c45769d299ce9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a322bee0c362ba83df8c45769d299ce9f">&#9670;&nbsp;</a></span>AutoCorrelation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::AutoCorrelation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: Calculate autocorrelations supports both OpenMP and CUDA :) </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l03737">3737</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;                                    {</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;<span class="comment">// *********************************</span></div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a> == <span class="keyword">nullptr</span>) <a class="code" href="classMCMCProcessor.html#a930cadafa41b31b58066dea68628de9f">PrepareDiagMCMC</a>();</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160; </div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;  TStopwatch clock;</div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;  clock.Start();</div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> nLags = <a class="code" href="classMCMCProcessor.html#a6156bba72e1f076e66f0356e48506a36">AutoCorrLag</a>;</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making auto-correlations for nLags = {}&quot;</span>, nLags);</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160; </div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;  <span class="comment">// The sum of (Y-Ymean)^2 over all steps for each parameter</span></div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;  std::vector&lt;std::vector&lt;double&gt;&gt; DenomSum(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;  std::vector&lt;std::vector&lt;double&gt;&gt; NumeratorSum(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;  std::vector&lt;std::vector&lt;double&gt;&gt; LagL(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;  <span class="keyword">auto</span> ParamSums = <a class="code" href="classMCMCProcessor.html#a8ad18f84ede354149dd37534995e061c">GetParameterSums</a>();</div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;    DenomSum[j].resize(nLags);</div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;    NumeratorSum[j].resize(nLags);</div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;    LagL[j].resize(nLags);</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;  }</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;  std::vector&lt;std::unique_ptr&lt;TH1D&gt;&gt; LagKPlots(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;  <span class="comment">// Loop over the parameters of interest</span></div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;  {</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;    <span class="comment">// Loop over each lag</span></div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nLags; ++k) {</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;      NumeratorSum[j][k] = 0.0;</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;      DenomSum[j][k] = 0.0;</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;      LagL[j][k] = 0.0;</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;    }</div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160; </div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;    <span class="comment">// Make TH1Ds for each parameter which hold the lag</span></div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;    <span class="keywordtype">double</span> Prior = 1.0, PriorError = 1.0;</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;    </div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;    <a class="code" href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">GetNthParameter</a>(j, Prior, PriorError, Title);</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;    std::string HistName = Form(<span class="stringliteral">&quot;%s_%s_Lag&quot;</span>, Title.Data(), <a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[j].Data());</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;    LagKPlots[j] = std::make_unique&lt;TH1D&gt;(HistName.c_str(), HistName.c_str(), nLags, 0.0, nLags);</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;    LagKPlots[j]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;    LagKPlots[j]-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Lag&quot;</span>);</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;    LagKPlots[j]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Auto-correlation function&quot;</span>);</div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;  }</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;<span class="comment">//KS: If CUDA is not enabled do calculations on CPU</span></div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;<span class="preprocessor">#ifndef MaCh3_CUDA</span></div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;  <span class="comment">// Loop over the lags</span></div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;  <span class="comment">//CW: Each lag is independent so might as well multi-thread them!</span></div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Using multi-threading...&quot;</span>);</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;<span class="preprocessor">  #pragma omp parallel for collapse(2)</span></div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;<span class="preprocessor">  #endif      </span><span class="comment">// Loop over the number of parameters</span></div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nLags; ++k) {</div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;      <span class="comment">// Loop over the number of entries</span></div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i) {</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> Diff = <a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>[j][i]-ParamSums[j];</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160; </div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;        <span class="comment">// Only sum the numerator up to i = N-k</span></div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;        <span class="keywordflow">if</span> (i &lt; <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>-k) {</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span> LagTerm = <a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>[j][i+k]-ParamSums[j];</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span> Product = Diff*LagTerm;</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;          NumeratorSum[j][k] += Product;</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;        }</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;        <span class="comment">// Square the difference to form the denominator</span></div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> Denom = Diff*Diff;</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;        DenomSum[j][k] += Denom;</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;      }</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;    }</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;  }</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;<span class="preprocessor">#else </span><span class="comment">//NOW GPU specific code</span></div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Using GPU&quot;</span>);</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;  <span class="keywordtype">float</span>* ParStep_cpu = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;  <span class="keywordtype">float</span>* NumeratorSum_cpu = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;  <span class="keywordtype">float</span>* ParamSums_cpu = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;  <span class="keywordtype">float</span>* DenomSum_cpu = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160; </div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;  <span class="comment">//KS: This allocates memory and copy data from CPU to GPU</span></div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;  PrepareGPU_AutoCorr(nLags, ParamSums, ParStep_cpu, NumeratorSum_cpu, ParamSums_cpu, DenomSum_cpu);</div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160; </div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;  <span class="comment">//KS: This runs the main kernel and copy results back to CPU</span></div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;  GPUProcessor-&gt;RunGPU_AutoCorr(NumeratorSum_cpu,</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;                                DenomSum_cpu);</div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160; </div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;<span class="preprocessor">  #pragma omp parallel for collapse(2)</span></div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;  <span class="comment">//KS: Now that that we received data from GPU convert it to CPU-like format</span></div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;  {</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nLags; ++k)</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;    {</div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> temp_index = j*nLags+k;</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;      NumeratorSum[j][k] = NumeratorSum_cpu[temp_index];</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;      DenomSum[j][k] = DenomSum_cpu[temp_index];</div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;    }</div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;  }</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;  <span class="comment">//delete auxiliary variables</span></div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;  <span class="keywordflow">if</span>(NumeratorSum_cpu) <span class="keyword">delete</span>[] NumeratorSum_cpu;</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;  <span class="keywordflow">if</span>(DenomSum_cpu)     <span class="keyword">delete</span>[] DenomSum_cpu;</div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;  <span class="keywordflow">if</span>(ParStep_cpu)      <span class="keyword">delete</span>[] ParStep_cpu;</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;  <span class="keywordflow">if</span>(ParamSums_cpu)    <span class="keyword">delete</span>[] ParamSums_cpu;</div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160; </div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;  <span class="comment">//KS: Delete stuff at GPU as well</span></div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;  GPUProcessor-&gt;CleanupGPU_AutoCorr();</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160; </div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;<span class="comment">//KS: End of GPU specific code</span></div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160; </div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;  TDirectory *AutoCorrDir = <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Auto_corr&quot;</span>);</div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;  <span class="comment">// Now fill the LagK auto-correlation plots</span></div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nLags; ++k) {</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;      LagL[j][k] = NumeratorSum[j][k]/DenomSum[j][k];</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;      LagKPlots[j]-&gt;SetBinContent(k, NumeratorSum[j][k]/DenomSum[j][k]);</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;    }</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;    AutoCorrDir-&gt;cd();</div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;    LagKPlots[j]-&gt;Write();</div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;  }</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160; </div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;  <span class="comment">//KS: This is different diagnostic however it relies on calculated Lag, thus we call it before we delete LagKPlots</span></div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;  <a class="code" href="classMCMCProcessor.html#aa9f3e028ad30d09e5a14a984385b95f0">CalculateESS</a>(nLags, LagL);</div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160; </div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;  AutoCorrDir-&gt;Close();</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;  <span class="keyword">delete</span> AutoCorrDir;</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160; </div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160; </div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;  clock.Stop();</div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making auto-correlations took {:.2f}s&quot;</span>, clock.RealTime());</div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a07204936619139b886e9a877bc46d1a4"><div class="ttname"><a href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">MCMCProcessor::GetNthParameter</a></div><div class="ttdeci">void GetNthParameter(const int param, double &amp;Prior, double &amp;PriorError, TString &amp;Title) const</div><div class="ttdoc">Get properties of parameter by passing it number.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02720">MCMCProcessor.cpp:2720</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a8ad18f84ede354149dd37534995e061c"><div class="ttname"><a href="classMCMCProcessor.html#a8ad18f84ede354149dd37534995e061c">MCMCProcessor::GetParameterSums</a></div><div class="ttdeci">std::vector&lt; double &gt; GetParameterSums()</div><div class="ttdoc">Computes the average of each parameter across all MCMC entries. Useful for autocorrelation.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l03615">MCMCProcessor.cpp:3615</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aa9f3e028ad30d09e5a14a984385b95f0"><div class="ttname"><a href="classMCMCProcessor.html#aa9f3e028ad30d09e5a14a984385b95f0">MCMCProcessor::CalculateESS</a></div><div class="ttdeci">void CalculateESS(const int nLags, const std::vector&lt; std::vector&lt; double &gt;&gt; &amp;LagL)</div><div class="ttdoc">KS: calc Effective Sample Size.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l03943">MCMCProcessor.cpp:3943</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ad043b6b2c885f47ab9967831bc8d0f5a"><div class="ttname"><a href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">MCMCProcessor::BranchNames</a></div><div class="ttdeci">std::vector&lt; TString &gt; BranchNames</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00451">MCMCProcessor.h:451</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abeb5e115fa9f58ea7872af5cf13c6b79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abeb5e115fa9f58ea7872af5cf13c6b79">&#9670;&nbsp;</a></span>AutoCorrelation_FFT()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::AutoCorrelation_FFT </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>MJR: Autocorrelation function using FFT algorithm for extra speed. </p>
<dl class="section author"><dt>Author</dt><dd>Michael Reh </dd></dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l03641">3641</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;                                        {</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;<span class="comment">// *********************************</span></div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a> == <span class="keyword">nullptr</span>) <a class="code" href="classMCMCProcessor.html#a930cadafa41b31b58066dea68628de9f">PrepareDiagMCMC</a>();</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160; </div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;  TStopwatch clock;</div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;  clock.Start();</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> nLags = <a class="code" href="classMCMCProcessor.html#a6156bba72e1f076e66f0356e48506a36">AutoCorrLag</a>;</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making auto-correlations for nLags = {}&quot;</span>, nLags);</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160; </div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;  <span class="comment">// Prep outputs</span></div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;  TDirectory* AutoCorrDir = <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Auto_corr&quot;</span>);</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;  std::vector&lt;std::unique_ptr&lt;TH1D&gt;&gt; LagKPlots(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;  std::vector&lt;std::vector&lt;double&gt;&gt; LagL(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160; </div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;  <span class="comment">// Arrays needed to perform FFT using ROOT</span></div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;  std::vector&lt;double&gt; ACFFT(<a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>, 0.0);  <span class="comment">// Main autocorrelation array</span></div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;  std::vector&lt;double&gt; ParVals(<a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>, 0.0);  <span class="comment">// Param values for full chain</span></div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;  std::vector&lt;double&gt; ParValsFFTR(<a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>, 0.0);  <span class="comment">// FFT Real part</span></div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;  std::vector&lt;double&gt; ParValsFFTI(<a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>, 0.0);  <span class="comment">// FFT Imaginary part</span></div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;  std::vector&lt;double&gt; ParValsFFTSquare(<a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>, 0.0);  <span class="comment">// FFT Absolute square</span></div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;  std::vector&lt;double&gt; ParValsComplex(<a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>, 0.0);  <span class="comment">// Input Imaginary values (0)</span></div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160; </div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;  <span class="keyword">auto</span> ParamSums = <a class="code" href="classMCMCProcessor.html#a8ad18f84ede354149dd37534995e061c">GetParameterSums</a>();</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;  <span class="comment">// Create forward and reverse FFT objects. I don&#39;t love using ROOT here,</span></div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;  <span class="comment">// but it works so I can&#39;t complain</span></div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;  TVirtualFFT* fftf = TVirtualFFT::FFT(1, &amp;<a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>, <span class="stringliteral">&quot;C2CFORWARD&quot;</span>);</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;  TVirtualFFT* fftb = TVirtualFFT::FFT(1, &amp;<a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>, <span class="stringliteral">&quot;C2CBACKWARD&quot;</span>);</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160; </div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;  <span class="comment">// Loop over all pars and calculate the full autocorrelation function using FFT</span></div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;    <span class="comment">// Initialize</span></div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;    LagL[j].resize(nLags);</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i) {</div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;      ParVals[i] = <a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>[j][i]-ParamSums[j]; <span class="comment">// Subtract the mean to make it numerically tractable</span></div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;      ParValsComplex[i] = 0.; <span class="comment">// Reset dummy array</span></div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;    }</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160; </div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;    <span class="comment">// Transform</span></div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;    fftf-&gt;SetPointsComplex(ParVals.data(), ParValsComplex.data());</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;    fftf-&gt;Transform();</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;    fftf-&gt;GetPointsComplex(ParValsFFTR.data(), ParValsFFTI.data());</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160; </div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;    <span class="comment">// Square the results to get the power spectrum</span></div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i) {</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;      ParValsFFTSquare[i] = ParValsFFTR[i]*ParValsFFTR[i] + ParValsFFTI[i]*ParValsFFTI[i];</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;    }</div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160; </div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;    <span class="comment">// Transforming back gives the autocovariance</span></div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;    fftb-&gt;SetPointsComplex(ParValsFFTSquare.data(), ParValsComplex.data());</div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;    fftb-&gt;Transform();</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;    fftb-&gt;GetPointsComplex(ACFFT.data(), ParValsComplex.data());</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160; </div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;    <span class="comment">// Divide by norm to get autocorrelation</span></div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;    <span class="keywordtype">double</span> normAC = ACFFT[0];</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i) {</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;      ACFFT[i] /= normAC;</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;    }</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160; </div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;    <span class="comment">// Get plotting info</span></div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;    <span class="keywordtype">double</span> Prior = 1.0, PriorError = 1.0;</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;    <a class="code" href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">GetNthParameter</a>(j, Prior, PriorError, Title);</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;    std::string HistName = Form(<span class="stringliteral">&quot;%s_%s_Lag&quot;</span>, Title.Data(), <a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[j].Data());</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160; </div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;    <span class="comment">// Initialize Lag plot</span></div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;    LagKPlots[j] = std::make_unique&lt;TH1D&gt;(HistName.c_str(), HistName.c_str(), nLags, 0.0, nLags);</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;    LagKPlots[j]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;    LagKPlots[j]-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Lag&quot;</span>);</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;    LagKPlots[j]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Auto-correlation function&quot;</span>);</div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160; </div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;    <span class="comment">// Fill plot</span></div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nLags; ++k) {</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;      LagL[j][k] = ACFFT[k];</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;      LagKPlots[j]-&gt;SetBinContent(k, ACFFT[k]);</div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;    }</div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160; </div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;    <span class="comment">// Write and clean up</span></div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;    AutoCorrDir-&gt;cd();</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;    LagKPlots[j]-&gt;Write();</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;  }</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160; </div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;  <span class="comment">//KS: This is different diagnostic however it relies on calculated Lag, thus we call it before we delete LagKPlots</span></div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;  <a class="code" href="classMCMCProcessor.html#aa9f3e028ad30d09e5a14a984385b95f0">CalculateESS</a>(nLags, LagL);</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160; </div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;  AutoCorrDir-&gt;Close();</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;  <span class="keyword">delete</span> AutoCorrDir;</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160; </div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160; </div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;  clock.Stop();</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making auto-correlations took {:.2f}s&quot;</span>, clock.RealTime());</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a29d492906e0c027d089331a0509cd2c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29d492906e0c027d089331a0509cd2c3">&#9670;&nbsp;</a></span>BatchedAnalysis()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::BatchedAnalysis </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the batched means variance estimation and variable indicating if number of batches is sensible <a class="el" href="citelist.html#CITEREF_chakraborty2019estimating">[4]</a> <a class="el" href="citelist.html#CITEREF_rossetti2024batch">[29]</a>. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l04098">4098</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;                                    {</div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a> == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;  {</div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;BatchedAverages haven&#39;t been initialises or have been deleted something is wrong&quot;</span>);</div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;I need it and refuse to go further&quot;</span>);</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;  }</div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160; </div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;  <span class="comment">// Calculate variance estimator using batched means following @cite chakraborty2019estimating see Eq. 1.2</span></div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;  TVectorD* BatchedVariance = <span class="keyword">new</span> TVectorD(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;  <span class="comment">//KS: The hypothesis is rejected if C &gt; z  for a given confidence level . If the batch means do not pass the test, Correlated is reported for the half-width on the statistical reports following @cite rossetti2024batch alternatively for more old-school see Alexopoulos and Seila 1998 section 3.4.3</span></div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;  TVectorD* C_Test_Statistics = <span class="keyword">new</span> TVectorD(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160; </div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;  std::vector&lt;double&gt; OverallBatchMean(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;  std::vector&lt;double&gt; C_Rho_Nominator(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;  std::vector&lt;double&gt; C_Rho_Denominator(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;  std::vector&lt;double&gt; C_Nominator(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;  std::vector&lt;double&gt; C_Denominator(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> BatchLength = <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>/<a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>+1;</div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;<span class="comment">//KS: Start parallel region</span></div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;<span class="preprocessor">#ifdef MULTITHREAD</span></div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;<span class="preprocessor">#pragma omp parallel</span></div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;{</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;<span class="preprocessor">  #pragma omp for</span></div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;  <span class="comment">//KS: First calculate mean of batched means for each param and Initialise everything to 0</span></div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;  {</div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;    OverallBatchMean[j] = 0.0;</div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;    C_Rho_Nominator[j] = 0.0;</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;    C_Rho_Denominator[j] = 0.0;</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;    C_Nominator[j] = 0.0;</div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;    C_Denominator[j] = 0.0;</div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160; </div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;    (*BatchedVariance)(j) = 0.0;</div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;    (*C_Test_Statistics)(j) = 0.0;</div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>; ++i)</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;    {</div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;      OverallBatchMean[j] += <a class="code" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i][j];</div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;    }</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;    OverallBatchMean[j] /= <a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>;</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;  }</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160; </div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;<span class="preprocessor">  #pragma omp for nowait</span></div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;  <span class="comment">//KS: next loop is completely independent thus nowait clause</span></div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;  {</div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>; ++i)</div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;    {</div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;      (*BatchedVariance)(j) += (OverallBatchMean[j] - <a class="code" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i][j])*(OverallBatchMean[j] - <a class="code" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i][j]);</div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;    }</div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;    (*BatchedVariance)(j) = (BatchLength/(<a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>-1))* (*BatchedVariance)(j);</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;  }</div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;  </div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;  <span class="comment">//KS: Now we focus on C test statistic, again use nowait as next is calculation is independent</span></div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;<span class="preprocessor">  #pragma omp for nowait</span></div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;  {</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;    C_Nominator[j] = (OverallBatchMean[j] - <a class="code" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[0][j])*(OverallBatchMean[j] - <a class="code" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[0][j]) + </div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;                      (OverallBatchMean[j] - <a class="code" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[<a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>-1][j])*(OverallBatchMean[j] - <a class="code" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[<a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>-1][j]);</div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>; ++i)</div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;    {</div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;      C_Denominator[j] += (OverallBatchMean[j] - <a class="code" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i][j])*(OverallBatchMean[j] - <a class="code" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i][j]);</div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;    }</div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;    C_Denominator[j] = 2*C_Denominator[j];</div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;  }</div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;  </div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;  <span class="comment">//KS: We still calculate C and for this we need rho wee need autocorrelations between batches</span></div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;<span class="preprocessor">  #pragma omp for</span></div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;  {</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>-1; ++i)</div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;    {</div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;      C_Rho_Nominator[j] += (OverallBatchMean[j] - <a class="code" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i][j])*(OverallBatchMean[j] - <a class="code" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i+1][j]);</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;    }</div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;    </div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>; ++i)</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;    {</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;      C_Rho_Denominator[j] += (OverallBatchMean[j] - <a class="code" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i][j])*(OverallBatchMean[j] - <a class="code" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i][j]);</div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;    }</div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;  }</div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;  </div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;  <span class="comment">//KS: Final calculations of C</span></div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;<span class="preprocessor">  #pragma omp for</span></div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;  {</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;    (*C_Test_Statistics)(j) = std::sqrt((<a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>*<a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a> - 1)/(<a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>-2)) * ( C_Rho_Nominator[j]/C_Rho_Denominator[j] + C_Nominator[j]/ C_Denominator[j]);</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;  }</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;<span class="preprocessor">#ifdef MULTITHREAD</span></div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;} <span class="comment">//End parallel region</span></div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160; </div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;  <span class="comment">//Save to file</span></div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;  BatchedVariance-&gt;Write(<span class="stringliteral">&quot;BatchedMeansVariance&quot;</span>);</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;  C_Test_Statistics-&gt;Write(<span class="stringliteral">&quot;C_Test_Statistics&quot;</span>);</div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160; </div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;  <span class="comment">//Delete all variables</span></div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;  <span class="keyword">delete</span> BatchedVariance;</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;  <span class="keyword">delete</span> C_Test_Statistics;</div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a61052119a625282d0ec6d4a97adf3ee2"><div class="ttname"><a href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a></div><div class="ttdeci">#define MACH3LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00037">MaCh3Logger.h:37</a></div></div>
<div class="ttc" id="aclassMaCh3Exception_html"><div class="ttname"><a href="classMaCh3Exception.html">MaCh3Exception</a></div><div class="ttdoc">Custom exception class used throughout MaCh3.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Exception_8h_source.html#l00023">MaCh3Exception.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af3658b8adee50f6ef5557ebbd1c87b8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3658b8adee50f6ef5557ebbd1c87b8e">&#9670;&nbsp;</a></span>BatchedMeans()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::BatchedMeans </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CW: Batched means, literally read from an array and chuck into TH1D. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l04041">4041</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;                                 {</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a> == <span class="keyword">nullptr</span>) <a class="code" href="classMCMCProcessor.html#a930cadafa41b31b58066dea68628de9f">PrepareDiagMCMC</a>();</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making BatchedMeans plots...&quot;</span>);</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;  </div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;  std::vector&lt;std::unique_ptr&lt;TH1D&gt;&gt; BatchedParamPlots(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;    <span class="keywordtype">double</span> Prior = 1.0, PriorError = 1.0;</div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;    </div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;    <a class="code" href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">GetNthParameter</a>(j, Prior, PriorError, Title);</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;    </div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;    std::string HistName = Form(<span class="stringliteral">&quot;%s_%s_batch&quot;</span>, Title.Data(), <a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[j].Data());</div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;    BatchedParamPlots[j] = std::make_unique&lt;TH1D&gt;(HistName.c_str(), HistName.c_str(), <a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>, 0, <a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>);</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;    BatchedParamPlots[j]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;  }</div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160; </div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;<span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>; ++i) {</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;      BatchedParamPlots[j]-&gt;SetBinContent(i+1, <a class="code" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i][j]);</div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> BatchRangeLow = double(i)*double(<a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>)/double(<a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>);</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> BatchRangeHigh = double(i+1)*double(<a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>)/double(<a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>);</div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;      std::stringstream ss;</div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;      ss &lt;&lt; BatchRangeLow &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; BatchRangeHigh;</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;      BatchedParamPlots[j]-&gt;GetXaxis()-&gt;SetBinLabel(i+1, ss.str().c_str());</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;    }</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;  }</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160; </div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;  TDirectory *BatchDir = <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Batched_means&quot;</span>);</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;  BatchDir-&gt;cd();</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;    <span class="keyword">auto</span> Fitter = std::make_unique&lt;TF1&gt;(<span class="stringliteral">&quot;Fitter&quot;</span>, <span class="stringliteral">&quot;[0]&quot;</span>, 0, <a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>);</div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;    Fitter-&gt;SetLineColor(kRed);</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;    BatchedParamPlots[j]-&gt;Fit(<span class="stringliteral">&quot;Fitter&quot;</span>,<span class="stringliteral">&quot;Rq&quot;</span>);</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;    BatchedParamPlots[j]-&gt;Write();</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;  }</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160; </div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;  <span class="comment">//KS: Get the batched means variance estimation and variable indicating if number of batches is sensible</span></div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;  <span class="comment">// We do this before deleting BatchedAverages</span></div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;  <a class="code" href="classMCMCProcessor.html#a29d492906e0c027d089331a0509cd2c3">BatchedAnalysis</a>();</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160; </div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>; ++i) {</div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i];</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;  }</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;  <span class="keyword">delete</span>[] <a class="code" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>;</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160; </div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;  BatchDir-&gt;Close();</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;  <span class="keyword">delete</span> BatchDir;</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160; </div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a29d492906e0c027d089331a0509cd2c3"><div class="ttname"><a href="classMCMCProcessor.html#a29d492906e0c027d089331a0509cd2c3">MCMCProcessor::BatchedAnalysis</a></div><div class="ttdeci">void BatchedAnalysis()</div><div class="ttdoc">Get the batched means variance estimation and variable indicating if number of batches is sensible  .</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l04098">MCMCProcessor.cpp:4098</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ace48a54fb08e2a3943d4e2ed1f8c4a4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace48a54fb08e2a3943d4e2ed1f8c4a4b">&#9670;&nbsp;</a></span>CacheSteps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::CacheSteps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>KS:By caching each step we use multithreading. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l01054">1054</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                               {</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment">// ***************</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#aea84f0315695aa05ec41fcf965b1b031">CacheMCMC</a> == <span class="keyword">true</span>) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  </div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  <a class="code" href="classMCMCProcessor.html#aea84f0315695aa05ec41fcf965b1b031">CacheMCMC</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  </div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a> != <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  {</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;It look like ParStep was already filled &quot;</span>);</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Even though it is used for MakeCovariance_MP and for DiagMCMC &quot;</span>);</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;it has different structure in both for cache hits, sorry &quot;</span>);</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  }</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160; </div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Caching input tree...&quot;</span>);</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Allocating {:.2f} MB&quot;</span>, <span class="keywordtype">double</span>(<span class="keyword">sizeof</span>(<a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>)*<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>*<a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>)/1.E6);</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  TStopwatch clock;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  clock.Start();</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  </div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  <a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a> = <span class="keyword">new</span> <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>*[<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>];</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  <a class="code" href="classMCMCProcessor.html#a6058bb3e817401423231f85a71db46a0">StepNumber</a> = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>[<a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>];</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  </div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  <a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>.resize(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i) </div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  {</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>[i] = <span class="keyword">new</span> <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>[<a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>];</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i].resize(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++j)</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      <a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>[i][j] = -999.99;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;      <span class="comment">//KS: Set this only once</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      <span class="keywordflow">if</span>(i == 0) <a class="code" href="classMCMCProcessor.html#a6058bb3e817401423231f85a71db46a0">StepNumber</a>[j] = 0;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    }</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  }</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160; </div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="comment">// Set all the branches to off</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchStatus(<span class="stringliteral">&quot;*&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> stepBranch = 0;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  std::vector&lt;double&gt; ParValBranch(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="comment">// Turn on the branches which we want for parameters</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  {</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchStatus(<a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i].Data(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchAddress(<a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i].Data(), &amp;ParValBranch[i]);</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  }</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchStatus(<span class="stringliteral">&quot;step&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchAddress(<span class="stringliteral">&quot;step&quot;</span>, &amp;stepBranch);</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <span class="keywordtype">double</span> ReweightWeight = 1.;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a6f27039da3508952600b1ef26e76fe19">ReweightPosterior</a>)</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  {</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <a class="code" href="classMCMCProcessor.html#a39d4d6d8cfccf1974a6b084f808211a9">WeightValue</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>]();</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchStatus(<a class="code" href="classMCMCProcessor.html#ad56b25b03eb5caab7b2a9c2ebf3ec178">ReweightName</a>.c_str(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchAddress(<a class="code" href="classMCMCProcessor.html#ad56b25b03eb5caab7b2a9c2ebf3ec178">ReweightName</a>.c_str(), &amp;ReweightWeight);</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  }</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160; </div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  <span class="keyword">const</span> Long64_t countwidth = <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>/10;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160; </div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  <span class="comment">// Loop over the entries</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  <span class="comment">//KS: This is really a bottleneck right now, thus revisit with ROOT6 https://pep-root6.github.io/docs/analysis/parallell/root.html</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  <span class="keywordflow">for</span> (Long64_t j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++j) </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  {</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="keywordflow">if</span> (j % countwidth == 0) {</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        <a class="code" href="namespaceMaCh3Utils.html#a4c8bdeb1d34606aed192e9f1311a72f5">MaCh3Utils::PrintProgressBar</a>(j, <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        <a class="code" href="namespaceMaCh3Utils.html#afb0be593dc0d5e481b78afa4625c858c">MaCh3Utils::EstimateDataTransferRate</a>(<a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>, j);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetEntry(j);</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    }</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <a class="code" href="classMCMCProcessor.html#a6058bb3e817401423231f85a71db46a0">StepNumber</a>[j] = stepBranch;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <span class="comment">// Set the branch addresses for params</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i) {</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      <a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>[i][j] = ParValBranch[i];</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    }</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160; </div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a6f27039da3508952600b1ef26e76fe19">ReweightPosterior</a>){</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      <a class="code" href="classMCMCProcessor.html#a39d4d6d8cfccf1974a6b084f808211a9">WeightValue</a>[j] = ReweightWeight;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    }</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  }</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  <span class="comment">// Set all the branches to on</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchStatus(<span class="stringliteral">&quot;*&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160; </div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  <span class="comment">// KS: Set temporary branch address to allow min/max, otherwise ROOT can segfaults</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  <span class="keywordtype">double</span> tempVal = 0.0;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  std::vector&lt;double&gt; Min_Chain(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  std::vector&lt;double&gt; Max_Chain(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  {</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchAddress(<a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i].Data(), &amp;tempVal);</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    Min_Chain[i] = <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMinimum(<a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i]);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    Max_Chain[i] = <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMaximum(<a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i]);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  }</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160; </div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  <span class="comment">// Calculate the total number of TH2D objects</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  <span class="keywordtype">size_t</span> nHistograms = <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a> * (<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a> + 1) / 2;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Caching 2D posterior histograms...&quot;</span>);</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Allocating {:.2f} MB for {} 2D Posteriors (each {}x{} bins)&quot;</span>,</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                <span class="keywordtype">double</span>(nHistograms * <a class="code" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a> * <a class="code" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)) / 1.E6, nHistograms, <a class="code" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a>, <a class="code" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a>);</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  <span class="comment">// Cache max and min in chain for covariance matrix</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  {</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    TString Title_i = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="keywordtype">double</span> Prior_i, PriorError_i;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <a class="code" href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">GetNthParameter</a>(i, Prior_i, PriorError_i, Title_i);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160; </div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    {</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;      TString Title_j = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      <span class="keywordtype">double</span> Prior_j, PriorError_j;</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      <a class="code" href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">GetNthParameter</a>(j, Prior_j, PriorError_j, Title_j);</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160; </div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      <span class="comment">// TH2D to hold the Correlation</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      <a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i][j] = <span class="keyword">new</span> TH2D((Title_i + <span class="stringliteral">&quot;_&quot;</span> + Title_j).Data(), (Title_i + <span class="stringliteral">&quot;_&quot;</span> + Title_j).Data(),</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                               <a class="code" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a>, <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetXaxis()-&gt;GetXmin(), <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetXaxis()-&gt;GetXmax(),</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                               <a class="code" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a>, <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[j]-&gt;GetXaxis()-&gt;GetXmin(), <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[j]-&gt;GetXaxis()-&gt;GetXmax());</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      <a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i][j]-&gt;SetMinimum(0);</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      <a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i][j]-&gt;GetXaxis()-&gt;SetTitle(Title_i);</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      <a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i][j]-&gt;GetYaxis()-&gt;SetTitle(Title_j);</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      <a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i][j]-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Steps&quot;</span>);</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    }</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  }</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  clock.Stop();</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Caching steps took {:.2f}s to finish for {} steps&quot;</span>, clock.RealTime(), <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a> );</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;}</div>
<div class="ttc" id="aclassMCMCProcessor_html_ad56b25b03eb5caab7b2a9c2ebf3ec178"><div class="ttname"><a href="classMCMCProcessor.html#ad56b25b03eb5caab7b2a9c2ebf3ec178">MCMCProcessor::ReweightName</a></div><div class="ttdeci">std::string ReweightName</div><div class="ttdoc">Name of branch used for chain reweighting.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00590">MCMCProcessor.h:590</a></div></div>
<div class="ttc" id="anamespaceM3_html_a1f95274549f25fc19fe7db343c8a7a68"><div class="ttname"><a href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a></div><div class="ttdeci">double float_t</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00037">Core.h:37</a></div></div>
<div class="ttc" id="anamespaceMaCh3Utils_html_a4c8bdeb1d34606aed192e9f1311a72f5"><div class="ttname"><a href="namespaceMaCh3Utils.html#a4c8bdeb1d34606aed192e9f1311a72f5">MaCh3Utils::PrintProgressBar</a></div><div class="ttdeci">void PrintProgressBar(const Long64_t Done, const Long64_t All)</div><div class="ttdoc">KS: Simply print progress bar.</div><div class="ttdef"><b>Definition:</b> <a href="Monitor_8cpp_source.html#l00228">Monitor.cpp:228</a></div></div>
<div class="ttc" id="anamespaceMaCh3Utils_html_afb0be593dc0d5e481b78afa4625c858c"><div class="ttname"><a href="namespaceMaCh3Utils.html#afb0be593dc0d5e481b78afa4625c858c">MaCh3Utils::EstimateDataTransferRate</a></div><div class="ttdeci">void EstimateDataTransferRate(TChain *chain, const Long64_t entry)</div><div class="ttdoc">KS: Check what CPU you are using.</div><div class="ttdef"><b>Definition:</b> <a href="Monitor_8cpp_source.html#l00211">Monitor.cpp:211</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa9f3e028ad30d09e5a14a984385b95f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9f3e028ad30d09e5a14a984385b95f0">&#9670;&nbsp;</a></span>CalculateESS()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::CalculateESS </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nLags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; double &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>LagL</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: calc Effective Sample Size. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nLags</td><td>Should be the same nLags as used in <a class="el" href="classMCMCProcessor.html#a322bee0c362ba83df8c45769d299ce9f" title="KS: Calculate autocorrelations supports both OpenMP and CUDA :)">AutoCorrelation()</a> </td></tr>
    <tr><td class="paramname">LagL</td><td>Value of LagL for each dial and each Lag</td></tr>
  </table>
  </dd>
</dl>
<p>This function computes the Effective Sample Size (ESS) using the autocorrelations calculated by <a class="el" href="classMCMCProcessor.html#a322bee0c362ba83df8c45769d299ce9f" title="KS: Calculate autocorrelations supports both OpenMP and CUDA :)">AutoCorrelation()</a>. Ensure that the parameter nLags here matches the number of lags used in <a class="el" href="classMCMCProcessor.html#a322bee0c362ba83df8c45769d299ce9f" title="KS: Calculate autocorrelations supports both OpenMP and CUDA :)">AutoCorrelation()</a> to obtain accurate results. <a class="el" href="citelist.html#CITEREF_StanManual">[31]</a> <a class="el" href="citelist.html#CITEREF_hanson2008mcmc">[15]</a> <a class="el" href="citelist.html#CITEREF_gabry2024visual">[9]</a> </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l03943">3943</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;                                                                                          {</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;  <span class="keywordflow">if</span>(LagL.size() == 0)</div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;  {</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Size of LagL is {}&quot;</span>, LagL.size());</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;  }</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making ESS plots...&quot;</span>);</div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;  TVectorD* <a class="code" href="RHat_8cpp.html#ae673254e98992bd483de55c6c1d1dcaf">EffectiveSampleSize</a> = <span class="keyword">new</span> TVectorD(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;  TVectorD* SamplingEfficiency = <span class="keyword">new</span> TVectorD(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;  std::vector&lt;double&gt; TempDenominator(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160; </div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;  constexpr <span class="keywordtype">int</span> Nhists = 5;</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;  constexpr <span class="keywordtype">double</span> Thresholds[Nhists + 1] = {1, 0.02, 0.005, 0.001, 0.0001, 0.0};</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;  constexpr Color_t ESSColours[Nhists] = {kGreen, kGreen + 2, kYellow, kOrange, kRed};</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160; </div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;  <span class="comment">//KS: This histogram is inspired by the following: @cite gabry2024visual</span></div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;  std::vector&lt;std::unique_ptr&lt;TH1D&gt;&gt; EffectiveSampleSizeHist(Nhists);</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; Nhists; ++i)</div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;  {</div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;    EffectiveSampleSizeHist[i] =</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;      std::make_unique&lt;TH1D&gt;(Form(<span class="stringliteral">&quot;EffectiveSampleSizeHist_%i&quot;</span>, i), Form(<span class="stringliteral">&quot;EffectiveSampleSizeHist_%i&quot;</span>, i), <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;    EffectiveSampleSizeHist[i]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;    EffectiveSampleSizeHist[i]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;N_{eff}/N&quot;</span>);</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;    EffectiveSampleSizeHist[i]-&gt;SetFillColor(ESSColours[i]);</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;    EffectiveSampleSizeHist[i]-&gt;SetLineColor(ESSColours[i]);</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;    EffectiveSampleSizeHist[i]-&gt;Sumw2();</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;    {</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;      TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;      <span class="keywordtype">double</span> Prior = 1.0, PriorError = 1.0;</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;      <a class="code" href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">GetNthParameter</a>(j, Prior, PriorError, Title);</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;      EffectiveSampleSizeHist[i]-&gt;GetXaxis()-&gt;SetBinLabel(j+1, Title.Data());</div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;    }</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;  }</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160; </div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;<span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;  <span class="comment">//KS: Calculate ESS and MCMC efficiency for each parameter</span></div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;  {</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;    (*EffectiveSampleSize)(j) = <a class="code" href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a>;</div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;    (*SamplingEfficiency)(j) = <a class="code" href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a>;</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;    TempDenominator[j] = 0.;</div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;    <span class="comment">//KS: Firs sum over all Calculated autocorrelations</span></div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nLags; ++k)</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;    {</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;      TempDenominator[j] += LagL[j][k];</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;    }</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;    TempDenominator[j] = 1+2*TempDenominator[j];</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;    (*EffectiveSampleSize)(j) = <span class="keywordtype">double</span>(<a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>)/TempDenominator[j];</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;    <span class="comment">// 100 because we convert to percentage</span></div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;    (*SamplingEfficiency)(j) = 100 * 1/TempDenominator[j];</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160; </div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; Nhists; ++i)</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;    {</div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;      EffectiveSampleSizeHist[i]-&gt;SetBinContent(j+1, 0);</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;      EffectiveSampleSizeHist[i]-&gt;SetBinError(j+1, 0);</div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160; </div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> TempEntry = std::fabs((*<a class="code" href="RHat_8cpp.html#ae673254e98992bd483de55c6c1d1dcaf">EffectiveSampleSize</a>)(j)) / double(<a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;      <span class="keywordflow">if</span>(Thresholds[i] &gt;= TempEntry &amp;&amp; TempEntry &gt; Thresholds[i+1])</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;      {</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;        <span class="keywordflow">if</span>( std::isnan((*<a class="code" href="RHat_8cpp.html#ae673254e98992bd483de55c6c1d1dcaf">EffectiveSampleSize</a>)(j)) ) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;        EffectiveSampleSizeHist[i]-&gt;SetBinContent(j+1, TempEntry);</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;      }</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;    }</div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;  }</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160; </div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;  <span class="comment">//KS Write to the output tree</span></div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;  <span class="comment">//Save to file</span></div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;  <a class="code" href="RHat_8cpp.html#ae673254e98992bd483de55c6c1d1dcaf">EffectiveSampleSize</a>-&gt;Write(<span class="stringliteral">&quot;EffectiveSampleSize&quot;</span>);</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;  SamplingEfficiency-&gt;Write(<span class="stringliteral">&quot;SamplingEfficiency&quot;</span>);</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160; </div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;  EffectiveSampleSizeHist[0]-&gt;SetTitle(<span class="stringliteral">&quot;Effective Sample Size&quot;</span>);</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;  EffectiveSampleSizeHist[0]-&gt;Draw();</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i &lt; Nhists; ++i)</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;  {</div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;    EffectiveSampleSizeHist[i]-&gt;Draw(<span class="stringliteral">&quot;SAME&quot;</span>);</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;  }</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160; </div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;  <span class="keyword">auto</span> leg = std::make_unique&lt;TLegend&gt;(0.2, 0.7, 0.6, 0.95);</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;  <a class="code" href="classMCMCProcessor.html#a704afa8c216722e730be2c2a33b594f0">SetLegendStyle</a>(leg.get(), 0.03);</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; Nhists; ++i)</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;  {</div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;    leg-&gt;AddEntry(EffectiveSampleSizeHist[i].get(), Form(<span class="stringliteral">&quot;%.4f &gt;= N_{eff}/N &gt; %.4f&quot;</span>, Thresholds[i], Thresholds[i+1]), <span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;  }  leg-&gt;Draw(<span class="stringliteral">&quot;SAME&quot;</span>);</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160; </div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Write(<span class="stringliteral">&quot;EffectiveSampleSizeCanvas&quot;</span>);</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160; </div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;  <span class="comment">//Delete all variables</span></div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;  <span class="keyword">delete</span> <a class="code" href="RHat_8cpp.html#ae673254e98992bd483de55c6c1d1dcaf">EffectiveSampleSize</a>;</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;  <span class="keyword">delete</span> SamplingEfficiency;</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;}</div>
<div class="ttc" id="aRHat_8cpp_html_ae673254e98992bd483de55c6c1d1dcaf"><div class="ttname"><a href="RHat_8cpp.html#ae673254e98992bd483de55c6c1d1dcaf">EffectiveSampleSize</a></div><div class="ttdeci">double * EffectiveSampleSize</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00070">RHat.cpp:70</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a704afa8c216722e730be2c2a33b594f0"><div class="ttname"><a href="classMCMCProcessor.html#a704afa8c216722e730be2c2a33b594f0">MCMCProcessor::SetLegendStyle</a></div><div class="ttdeci">void SetLegendStyle(TLegend *Legend, const double size) const</div><div class="ttdoc">Configures the style of a TLegend object.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l04628">MCMCProcessor.cpp:4628</a></div></div>
<div class="ttc" id="anamespaceM3_html_a2aed672aeeb4fcf51069966193176ff3"><div class="ttname"><a href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a></div><div class="ttdeci">constexpr static const double _BAD_DOUBLE_</div><div class="ttdoc">Default value used for double initialisation.</div><div class="ttdef"><b>Definition:</b> <a href="Core_8h_source.html#l00053">Core.h:53</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa7db7e3aa4403a239b8b2b865cea91f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7db7e3aa4403a239b8b2b865cea91f6">&#9670;&nbsp;</a></span>CheckCredibleIntervalsOrder()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::CheckCredibleIntervalsOrder </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>CredibleIntervals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Color_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>CredibleIntervalsColours</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks the order and size consistency of the <code>CredibleIntervals</code> and <code>CredibleIntervalsColours</code> vectors. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CredibleIntervals</td><td>A vector of credible interval values. </td></tr>
    <tr><td class="paramname">CredibleIntervalsColours</td><td>A vector of colors associated with each credible interval. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classMaCh3Exception.html" title="Custom exception class used throughout MaCh3.">MaCh3Exception</a></td><td>If the sizes are not equal or the intervals are not in decreasing order. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l04514">4514</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;                                                                                                                                                    {</div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;  <span class="keywordflow">if</span> (CredibleIntervals.size() != CredibleIntervalsColours.size()) {</div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;size of CredibleIntervals is not equal to size of CredibleIntervalsColours&quot;</span>);</div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;  }</div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;  <span class="keywordflow">if</span> (CredibleIntervals.size() &gt; 1) {</div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 1; i &lt; CredibleIntervals.size(); i++) {</div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;      <span class="keywordflow">if</span> (CredibleIntervals[i] &gt; CredibleIntervals[i - 1]) {</div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Interval {} is smaller than {}&quot;</span>, i, i - 1);</div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;{:.2f} {:.2f}&quot;</span>, CredibleIntervals[i], CredibleIntervals[i - 1]);</div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;They should be grouped in decreasing order&quot;</span>);</div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;      }</div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;    }</div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;  }</div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab11b70175cd1e63722942a063192968a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab11b70175cd1e63722942a063192968a">&#9670;&nbsp;</a></span>CheckCredibleRegionsOrder()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::CheckCredibleRegionsOrder </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>CredibleRegions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Style_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>CredibleRegionStyle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Color_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>CredibleRegionColor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks the order and size consistency of the <code>CredibleRegions</code>, <code>CredibleRegionStyle</code>, and <code>CredibleRegionColor</code> vectors. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CredibleRegions</td><td>A vector of credible region values. </td></tr>
    <tr><td class="paramname">CredibleRegionStyle</td><td>A vector of styles associated with each credible region. </td></tr>
    <tr><td class="paramname">CredibleRegionColor</td><td>A vector of colors associated with each credible region. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classMaCh3Exception.html" title="Custom exception class used throughout MaCh3.">MaCh3Exception</a></td><td>If the sizes are not equal or the regions are not in decreasing order. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l04533">4533</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;                                                                              {</div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;  <span class="keywordflow">if</span> ((CredibleRegions.size() != CredibleRegionStyle.size()) || (CredibleRegionStyle.size() != CredibleRegionColor.size())) {</div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;size of CredibleRegions is not equal to size of CredibleRegionStyle or CredibleRegionColor&quot;</span>);</div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;  }</div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 1; i &lt; CredibleRegions.size(); i++) {</div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;    <span class="keywordflow">if</span> (CredibleRegions[i] &gt; CredibleRegions[i - 1]) {</div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Interval {} is smaller than {}&quot;</span>, i, i - 1);</div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;{:.2f} {:.2f}&quot;</span>, CredibleRegions[i], CredibleRegions[i - 1]);</div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;They should be grouped in decreasing order&quot;</span>);</div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;    }</div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;  }</div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a02eebcff814d7ce3ec3d9eb4e3bad857"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02eebcff814d7ce3ec3d9eb4e3bad857">&#9670;&nbsp;</a></span>CheckStepCut()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::CheckStepCut </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if step cut isn't larger than highest values of step in a chain. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02709">2709</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;                                       {</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;<span class="comment">// ***************</span></div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxNsteps = <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMaximum(<span class="stringliteral">&quot;step&quot;</span>);</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#afca259b5bdee2b248d4b1a64ac3e7930">BurnInCut</a> &gt; maxNsteps){</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;StepCut({}) is larger than highest value of step({})&quot;</span>, <a class="code" href="classMCMCProcessor.html#afca259b5bdee2b248d4b1a64ac3e7930">BurnInCut</a>, maxNsteps);</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;  }</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;}</div>
<div class="ttc" id="aclassMCMCProcessor_html_afca259b5bdee2b248d4b1a64ac3e7930"><div class="ttname"><a href="classMCMCProcessor.html#afca259b5bdee2b248d4b1a64ac3e7930">MCMCProcessor::BurnInCut</a></div><div class="ttdeci">unsigned int BurnInCut</div><div class="ttdoc">Value of burn in cut.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00436">MCMCProcessor.h:436</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7f8faecae63616ba100cf24ae42ecc08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f8faecae63616ba100cf24ae42ecc08">&#9670;&nbsp;</a></span>DiagMCMC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::DiagMCMC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>KS: Perform MCMC diagnostic including Autocorrelation, Trace etc. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l03340">3340</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;                             {</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;  <span class="comment">// Prepare branches etc for DiagMCMC</span></div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;  <a class="code" href="classMCMCProcessor.html#a930cadafa41b31b58066dea68628de9f">PrepareDiagMCMC</a>();</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160; </div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;  <span class="comment">// Draw the simple trace matrices</span></div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;  <a class="code" href="classMCMCProcessor.html#a929d6efec80bb4de05eea7011257439a">ParamTraces</a>();</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160; </div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;  <span class="comment">// Get the batched means</span></div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;  <a class="code" href="classMCMCProcessor.html#af3658b8adee50f6ef5557ebbd1c87b8e">BatchedMeans</a>();</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160; </div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;  <span class="comment">// Draw the auto-correlations</span></div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#a562261269f0f4ec4a209b2fca64ff443">useFFTAutoCorrelation</a>) {</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;    <a class="code" href="classMCMCProcessor.html#abeb5e115fa9f58ea7872af5cf13c6b79">AutoCorrelation_FFT</a>();</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;    <a class="code" href="classMCMCProcessor.html#a322bee0c362ba83df8c45769d299ce9f">AutoCorrelation</a>();</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;  }</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160; </div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;  <span class="comment">// Calculate Power Spectrum for each param</span></div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;  <a class="code" href="classMCMCProcessor.html#aef760d8c4bb70690a5c4114f4b2409b3">PowerSpectrumAnalysis</a>();</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160; </div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;  <span class="comment">// Get Geweke Z score helping select burn-in</span></div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;  <a class="code" href="classMCMCProcessor.html#a03b7c4bb9cd9a90aa7d284b0f1a6156b">GewekeDiagnostic</a>();</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160; </div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;  <span class="comment">// Draw acceptance Probability</span></div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;  <a class="code" href="classMCMCProcessor.html#a278b82fa945d847e57ae6ed6357d8f61">AcceptanceProbabilities</a>();</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a03b7c4bb9cd9a90aa7d284b0f1a6156b"><div class="ttname"><a href="classMCMCProcessor.html#a03b7c4bb9cd9a90aa7d284b0f1a6156b">MCMCProcessor::GewekeDiagnostic</a></div><div class="ttdeci">void GewekeDiagnostic()</div><div class="ttdoc">Geweke Diagnostic based on the methods described by Fang (2014) and Karlsbakk (2011)....</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l04333">MCMCProcessor.cpp:4333</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a278b82fa945d847e57ae6ed6357d8f61"><div class="ttname"><a href="classMCMCProcessor.html#a278b82fa945d847e57ae6ed6357d8f61">MCMCProcessor::AcceptanceProbabilities</a></div><div class="ttdeci">void AcceptanceProbabilities()</div><div class="ttdoc">Acceptance Probability.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l04466">MCMCProcessor.cpp:4466</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a322bee0c362ba83df8c45769d299ce9f"><div class="ttname"><a href="classMCMCProcessor.html#a322bee0c362ba83df8c45769d299ce9f">MCMCProcessor::AutoCorrelation</a></div><div class="ttdeci">void AutoCorrelation()</div><div class="ttdoc">KS: Calculate autocorrelations supports both OpenMP and CUDA :)</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l03737">MCMCProcessor.cpp:3737</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a929d6efec80bb4de05eea7011257439a"><div class="ttname"><a href="classMCMCProcessor.html#a929d6efec80bb4de05eea7011257439a">MCMCProcessor::ParamTraces</a></div><div class="ttdeci">void ParamTraces()</div><div class="ttdoc">CW: Draw trace plots of the parameters i.e. parameter vs step.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l03526">MCMCProcessor.cpp:3526</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_abeb5e115fa9f58ea7872af5cf13c6b79"><div class="ttname"><a href="classMCMCProcessor.html#abeb5e115fa9f58ea7872af5cf13c6b79">MCMCProcessor::AutoCorrelation_FFT</a></div><div class="ttdeci">void AutoCorrelation_FFT()</div><div class="ttdoc">MJR: Autocorrelation function using FFT algorithm for extra speed.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l03641">MCMCProcessor.cpp:3641</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aef760d8c4bb70690a5c4114f4b2409b3"><div class="ttname"><a href="classMCMCProcessor.html#aef760d8c4bb70690a5c4114f4b2409b3">MCMCProcessor::PowerSpectrumAnalysis</a></div><div class="ttdeci">void PowerSpectrumAnalysis()</div><div class="ttdoc">RC: Perform spectral analysis of MCMC .</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l04213">MCMCProcessor.cpp:4213</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_af3658b8adee50f6ef5557ebbd1c87b8e"><div class="ttname"><a href="classMCMCProcessor.html#af3658b8adee50f6ef5557ebbd1c87b8e">MCMCProcessor::BatchedMeans</a></div><div class="ttdeci">void BatchedMeans()</div><div class="ttdoc">CW: Batched means, literally read from an array and chuck into TH1D.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l04041">MCMCProcessor.cpp:4041</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5b0961bcb0eea7a347e6a29ef7738d80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b0961bcb0eea7a347e6a29ef7738d80">&#9670;&nbsp;</a></span>DrawCorrelations1D()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::DrawCorrelations1D </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Draw 1D correlations which might be more helpful than looking at huge 2D Corr matrix. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l01625">1625</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                                       {</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;<span class="comment">// *********************</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;  <span class="comment">//KS: Store it as we go back to them at the end</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;  <span class="keyword">const</span> std::vector&lt;double&gt; Margins = <a class="code" href="classMCMCProcessor.html#a1dfc05edf0b1295e561d5956b43b1c6b">GetMargins</a>(<a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>);</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> OptTitle = gStyle-&gt;GetOptTitle();</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160; </div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetTopMargin(0.1);</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetBottomMargin(0.2);</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;  gStyle-&gt;SetOptTitle(1);</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160; </div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;  constexpr <span class="keywordtype">int</span> Nhists = 3;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;  <span class="comment">//KS: Highest value is just meant bo be sliglhy higher than 1 to catch &gt;,</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;  constexpr <span class="keywordtype">double</span> Thresholds[Nhists+1] = {0, 0.25, 0.5, 1.0001};</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;  constexpr Color_t CorrColours[Nhists] = {kRed-10, kRed-6,  kRed};</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160; </div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;  <span class="comment">//KS: This store necessary entries for stripped covariance which store only &quot;meaningful correlations</span></div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;  std::vector&lt;std::vector&lt;double&gt;&gt; CorrOfInterest;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;  CorrOfInterest.resize(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;  std::vector&lt;std::vector&lt;std::string&gt;&gt; NameCorrOfInterest;</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  NameCorrOfInterest.resize(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160; </div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  std::vector&lt;std::vector&lt;std::unique_ptr&lt;TH1D&gt;&gt;&gt; Corr1DHist(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;  <span class="comment">//KS: Initialising ROOT objects is never safe in MP loop</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    {    </div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <span class="keywordtype">double</span> Prior = 1.0, PriorError = 1.0;</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    <a class="code" href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">GetNthParameter</a>(i, Prior, PriorError, Title);</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160; </div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    Corr1DHist[i].resize(Nhists);</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; Nhists; ++j)</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    {</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;      Corr1DHist[i][j] = std::make_unique&lt;TH1D&gt;(Form(<span class="stringliteral">&quot;Corr1DHist_%i_%i&quot;</span>, i, j), Form(<span class="stringliteral">&quot;Corr1DHist_%i_%i&quot;</span>, i, j), <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;      Corr1DHist[i][j]-&gt;SetTitle(Form(<span class="stringliteral">&quot;%s&quot;</span>,Title.Data()));</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;      Corr1DHist[i][j]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;      Corr1DHist[i][j]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Correlation&quot;</span>);</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;      Corr1DHist[i][j]-&gt;SetFillColor(CorrColours[j]);</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;      Corr1DHist[i][j]-&gt;SetLineColor(kBlack);</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160; </div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++k)</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;      {</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        TString Title_y = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        <span class="keywordtype">double</span> Prior_y = 1.0;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;        <span class="keywordtype">double</span> PriorError_y = 1.0;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;        <a class="code" href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">GetNthParameter</a>(k, Prior_y, PriorError_y, Title_y);</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;        Corr1DHist[i][j]-&gt;GetXaxis()-&gt;SetBinLabel(k+1, Title_y.Data());</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;      }</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    }</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;  }</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160; </div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;  <span class="comment">// KS: Do not add collapse(2) otherwise one can intorduce race condition :(</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;<span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  {</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    {</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; Nhists; ++k)</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    {</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> TempEntry = std::fabs((*<a class="code" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>)(i,j));</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;        <span class="keywordflow">if</span>(Thresholds[k+1] &gt; TempEntry &amp;&amp; TempEntry &gt;= Thresholds[k])</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;        {</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;          Corr1DHist[i][k]-&gt;SetBinContent(j+1, (*<a class="code" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>)(i,j));</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;        }</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;      }</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;      <span class="keywordflow">if</span>(std::fabs((*<a class="code" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>)(i,j)) &gt; <a class="code" href="classMCMCProcessor.html#a25e4685b6299181021b02ac0e0b74681">Post2DPlotThreshold</a> &amp;&amp; i != j)</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;  {</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;        CorrOfInterest[i].push_back((*<a class="code" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>)(i,j));</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;        NameCorrOfInterest[i].push_back(Corr1DHist[i][0]-&gt;GetXaxis()-&gt;GetBinLabel(j+1));</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;      }</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    }</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;  }</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160; </div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  TDirectory *CorrDir = <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Corr1D&quot;</span>);</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;  CorrDir-&gt;cd();</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160; </div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; i++)</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;  {</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#a95fa49737432818bc830a44898d0d850">IamVaried</a>[i] == <span class="keyword">false</span>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160; </div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    Corr1DHist[i][0]-&gt;GetXaxis()-&gt;LabelsOption(<span class="stringliteral">&quot;v&quot;</span>);</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    Corr1DHist[i][0]-&gt;SetMaximum(+1.);</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    Corr1DHist[i][0]-&gt;SetMinimum(-1.);</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    Corr1DHist[i][0]-&gt;Draw();</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 1; k &lt; Nhists; k++) {</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;      Corr1DHist[i][k]-&gt;Draw(<span class="stringliteral">&quot;SAME&quot;</span>);</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    }</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160; </div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    <span class="keyword">auto</span> leg = std::make_unique&lt;TLegend&gt;(0.3, 0.75, 0.6, 0.90);</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <a class="code" href="classMCMCProcessor.html#a704afa8c216722e730be2c2a33b594f0">SetLegendStyle</a>(leg.get(), 0.02);</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; Nhists; k++) {</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;      leg-&gt;AddEntry(Corr1DHist[i][k].get(), Form(<span class="stringliteral">&quot;%.2f &gt; |Corr| &gt;= %.2f&quot;</span>, Thresholds[k+1], Thresholds[k]), <span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    }</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    leg-&gt;Draw(<span class="stringliteral">&quot;SAME&quot;</span>);</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160; </div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Write(Corr1DHist[i][0]-&gt;GetTitle());</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Print(<a class="code" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;  }</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160; </div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;  <span class="comment">//KS: Plot only meaningful correlations</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; i++)</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  {</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> size = int(CorrOfInterest[i].size());</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160; </div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="keywordflow">if</span>(size == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    <span class="keyword">auto</span> Corr1DHist_Reduced = std::make_unique&lt;TH1D&gt;(<span class="stringliteral">&quot;Corr1DHist_Reduced&quot;</span>, <span class="stringliteral">&quot;Corr1DHist_Reduced&quot;</span>, size, 0, size);</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    Corr1DHist_Reduced-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    Corr1DHist_Reduced-&gt;SetTitle(Corr1DHist[i][0]-&gt;GetTitle());</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    Corr1DHist_Reduced-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Correlation&quot;</span>);</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    Corr1DHist_Reduced-&gt;SetFillColor(kBlue);</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    Corr1DHist_Reduced-&gt;SetLineColor(kBlue);</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    </div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; size; ++j)</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    {</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;      Corr1DHist_Reduced-&gt;GetXaxis()-&gt;SetBinLabel(j+1, NameCorrOfInterest[i][j].c_str());</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;      Corr1DHist_Reduced-&gt;SetBinContent(j+1, CorrOfInterest[i][j]);</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    }</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    Corr1DHist_Reduced-&gt;GetXaxis()-&gt;LabelsOption(<span class="stringliteral">&quot;v&quot;</span>);</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160; </div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    Corr1DHist_Reduced-&gt;SetMaximum(+1.);</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    Corr1DHist_Reduced-&gt;SetMinimum(-1.);</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    Corr1DHist_Reduced-&gt;Draw();</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160; </div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Write(Form(<span class="stringliteral">&quot;%s_Red&quot;</span>, Corr1DHist_Reduced-&gt;GetTitle()));</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Print(<a class="code" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;  }</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160; </div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  CorrDir-&gt;Close();</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;  <span class="keyword">delete</span> CorrDir;</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160; </div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;  <a class="code" href="classMCMCProcessor.html#a922f4c04b67ca9c6faab00efdb5277ea">SetMargins</a>(<a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>, Margins);</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;  gStyle-&gt;SetOptTitle(OptTitle);</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a1dfc05edf0b1295e561d5956b43b1c6b"><div class="ttname"><a href="classMCMCProcessor.html#a1dfc05edf0b1295e561d5956b43b1c6b">MCMCProcessor::GetMargins</a></div><div class="ttdeci">std::vector&lt; double &gt; GetMargins(const std::unique_ptr&lt; TCanvas &gt; &amp;Canv) const</div><div class="ttdoc">Get TCanvas margins, to be able to reset them if particular function need different margins.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l04596">MCMCProcessor.cpp:4596</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a922f4c04b67ca9c6faab00efdb5277ea"><div class="ttname"><a href="classMCMCProcessor.html#a922f4c04b67ca9c6faab00efdb5277ea">MCMCProcessor::SetMargins</a></div><div class="ttdeci">void SetMargins(std::unique_ptr&lt; TCanvas &gt; &amp;Canv, const std::vector&lt; double &gt; &amp;margins)</div><div class="ttdoc">Set TCanvas margins to specified values.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l04603">MCMCProcessor.cpp:4603</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a95fa49737432818bc830a44898d0d850"><div class="ttname"><a href="classMCMCProcessor.html#a95fa49737432818bc830a44898d0d850">MCMCProcessor::IamVaried</a></div><div class="ttdeci">std::vector&lt; bool &gt; IamVaried</div><div class="ttdoc">Is the ith parameter varied.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00457">MCMCProcessor.h:457</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c9c0c6da5530f5cf1f6fd673d2cc44f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c9c0c6da5530f5cf1f6fd673d2cc44f">&#9670;&nbsp;</a></span>DrawCorrelationsGroup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::DrawCorrelationsGroup </td>
          <td>(</td>
          <td class="paramtype">const std::unique_ptr&lt; TH2D &gt; &amp;&#160;</td>
          <td class="paramname"><em>CorrMatrix</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Produces correlation matrix but instead of giving name for each param it only give name for param group. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CorrMatrix</td><td>correlation matrix that we are going to plot </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Inspired by plot in Ewan thesis see <a href="https://www.t2k.org/docs/thesis/152/Thesis#page=147">https://www.t2k.org/docs/thesis/152/Thesis#page=147</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l01515">1515</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                                                                                     {</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="comment">// *********************</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Starting {}&quot;</span>, __func__);</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> RightMargin = <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;GetRightMargin();</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetRightMargin(0.15);</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;  <span class="keyword">auto</span> MatrixCopy = <a class="code" href="namespaceM3.html#a174fa82e79c5b38edecbc0552a4ce5b1">M3::Clone</a>(CorrMatrix.get());</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160; </div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;  std::vector&lt;std::string&gt; GroupName;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;  std::vector&lt;int&gt; GroupStart;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;  std::vector&lt;int&gt; GroupEnd;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160; </div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;  <span class="comment">// Loop over the Covariance matrix entries</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iPar = 0; iPar &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++iPar)</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;  {</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    std::string GroupNameCurr;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>[iPar] == <a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>){</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> InternalNumeration = iPar - <a class="code" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>];</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;      GroupNameCurr = <a class="code" href="classMCMCProcessor.html#ab72dd21faa732ec38e550c37635ee66d">ParameterGroup</a>[InternalNumeration];</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;      GroupNameCurr = <span class="stringliteral">&quot;Other&quot;</span>; <span class="comment">// Use Other for all legacy params</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    }</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160; </div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="keywordflow">if</span>(iPar == 0) {</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;      GroupName.push_back(GroupNameCurr);</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;      GroupStart.push_back(0);</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(GroupName.back() != GroupNameCurr ){</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;      GroupName.push_back(GroupNameCurr);</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;      GroupEnd.push_back(iPar);</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;      GroupStart.push_back(iPar);</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    }</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160; </div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    MatrixCopy-&gt;GetXaxis()-&gt;SetBinLabel(iPar+1, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    MatrixCopy-&gt;GetYaxis()-&gt;SetBinLabel(iPar+1, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  }</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  GroupEnd.push_back(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160; </div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> iPar = 0; iPar &lt; GroupName.size(); iPar++) {</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Group name {} from {} to {}&quot;</span>, GroupName[iPar], GroupStart[iPar], GroupEnd[iPar]);</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  }</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;cd();</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Clear();</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  MatrixCopy-&gt;Draw(<span class="stringliteral">&quot;colz&quot;</span>);</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160; </div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  std::vector&lt;std::unique_ptr&lt;TLine&gt;&gt; groupLines; <span class="comment">//((GroupStart.size() - 1) * 2);</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160; </div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  <span class="keywordtype">int</span> nBinsX = MatrixCopy-&gt;GetNbinsX();</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;  <span class="keywordtype">int</span> nBinsY = MatrixCopy-&gt;GetNbinsY();</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160; </div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  <span class="comment">// Axis bounds from the histogram itself</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  <span class="keywordtype">double</span> xMin = MatrixCopy-&gt;GetXaxis()-&gt;GetBinLowEdge(1);</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  <span class="keywordtype">double</span> xMax = MatrixCopy-&gt;GetXaxis()-&gt;GetBinUpEdge(nBinsX);</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  <span class="keywordtype">double</span> yMin = MatrixCopy-&gt;GetYaxis()-&gt;GetBinLowEdge(1);</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;  <span class="keywordtype">double</span> yMax = MatrixCopy-&gt;GetYaxis()-&gt;GetBinUpEdge(nBinsY);</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160; </div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> g = 1; g &lt; GroupStart.size(); ++g) {</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> posX = MatrixCopy-&gt;GetXaxis()-&gt;GetBinLowEdge(GroupStart[g] + 1);</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> posY = MatrixCopy-&gt;GetYaxis()-&gt;GetBinLowEdge(GroupStart[g] + 1);</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160; </div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <span class="comment">// Vertical line at group start</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    <span class="keyword">auto</span> vLine = std::make_unique&lt;TLine&gt;(posX, yMin, posX, yMax);</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    vLine-&gt;SetLineColor(kBlack);</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    vLine-&gt;SetLineWidth(2);</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    vLine-&gt;Draw();</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    groupLines.push_back(std::move(vLine));</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160; </div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    <span class="comment">// Horizontal line at group start</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <span class="keyword">auto</span> hLine = std::make_unique&lt;TLine&gt;(xMin, posY, xMax, posY);</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    hLine-&gt;SetLineColor(kBlack);</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    hLine-&gt;SetLineWidth(2);</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    hLine-&gt;Draw();</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    groupLines.push_back(std::move(hLine));</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  }</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160; </div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;  std::vector&lt;std::unique_ptr&lt;TText&gt;&gt; groupLabels(GroupName.size() * 2);</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> yOffsetBelow = 0.05 * (yMax - yMin); <span class="comment">// space below x-axis</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> xOffsetRight = 0.02 * (xMax - xMin); <span class="comment">// space right of y-axis</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160; </div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> g = 0; g &lt; GroupName.size(); ++g) {</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> startBin = GroupStart[g] + 1; <span class="comment">// hist bins start at 1</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> endBin   = GroupEnd[g];</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160; </div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> xStart = MatrixCopy-&gt;GetXaxis()-&gt;GetBinLowEdge(startBin);</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> xEnd   = MatrixCopy-&gt;GetXaxis()-&gt;GetBinUpEdge(endBin);</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> xMid   = 0.5 * (xStart + xEnd);</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160; </div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> yStart = MatrixCopy-&gt;GetYaxis()-&gt;GetBinLowEdge(startBin);</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> yEnd   = MatrixCopy-&gt;GetYaxis()-&gt;GetBinUpEdge(endBin);</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> yMid   = 0.5 * (yStart + yEnd);</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160; </div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    <span class="comment">// Label along X-axis (below histogram)</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    <span class="keyword">auto</span> labelX = std::make_unique&lt;TText&gt;(xMid, yMin - yOffsetBelow, GroupName[g].c_str());</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    labelX-&gt;SetTextAlign(23); <span class="comment">// center horizontally, top-aligned vertically</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    labelX-&gt;SetTextSize(0.025);</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    labelX-&gt;Draw();</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    groupLabels.push_back(std::move(labelX));</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160; </div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="comment">// Label along Y-axis (left of histogram)</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <span class="keyword">auto</span> labelY = std::make_unique&lt;TText&gt;(xMin - xOffsetRight, yMid, GroupName[g].c_str());</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    labelY-&gt;SetTextAlign(32); <span class="comment">// right-aligned horizontally, center vertically</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    labelY-&gt;SetTextSize(0.025);</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    labelY-&gt;Draw();</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    groupLabels.push_back(std::move(labelY));</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;  }</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160; </div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Print(<a class="code" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetRightMargin(RightMargin);</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;}</div>
<div class="ttc" id="aMCMCProcessor_8h_html_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f"><div class="ttname"><a href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a></div><div class="ttdeci">@ kXSecPar</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00046">MCMCProcessor.h:46</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aaa903949bde8f1a69800c71fe1eb538e"><div class="ttname"><a href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">MCMCProcessor::ParamType</a></div><div class="ttdeci">std::vector&lt; ParameterEnum &gt; ParamType</div><div class="ttdoc">Make an enum for which class this parameter belongs to so we don't have to keep string comparing.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00469">MCMCProcessor.h:469</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ab72dd21faa732ec38e550c37635ee66d"><div class="ttname"><a href="classMCMCProcessor.html#ab72dd21faa732ec38e550c37635ee66d">MCMCProcessor::ParameterGroup</a></div><div class="ttdeci">std::vector&lt; std::string &gt; ParameterGroup</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00474">MCMCProcessor.h:474</a></div></div>
<div class="ttc" id="anamespaceM3_html_a174fa82e79c5b38edecbc0552a4ce5b1"><div class="ttname"><a href="namespaceM3.html#a174fa82e79c5b38edecbc0552a4ce5b1">M3::Clone</a></div><div class="ttdeci">std::unique_ptr&lt; ObjectType &gt; Clone(const ObjectType *obj, const std::string &amp;name=&quot;&quot;)</div><div class="ttdoc">KS: Creates a copy of a ROOT-like object and wraps it in a smart pointer.</div><div class="ttdef"><b>Definition:</b> <a href="HistogramUtils_8h_source.html#l00142">HistogramUtils.h:142</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8d9b9c1c780a51b130fe528583dc5019"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d9b9c1c780a51b130fe528583dc5019">&#9670;&nbsp;</a></span>DrawCovariance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::DrawCovariance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Draw the post-fit covariances. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l01366">1366</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                                   {</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;<span class="comment">// *********************</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> RightMargin = <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;GetRightMargin();</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetRightMargin(0.15);</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160; </div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  <span class="comment">// The Covariance matrix from the fit</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  <span class="keyword">auto</span> hCov = std::make_unique&lt;TH2D&gt;(<span class="stringliteral">&quot;hCov&quot;</span>, <span class="stringliteral">&quot;hCov&quot;</span>, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  hCov-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Covariance&quot;</span>);</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  hCov-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  <span class="comment">// The Covariance matrix square root, with correct sign</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  <span class="keyword">auto</span> hCovSq = std::make_unique&lt;TH2D&gt;(<span class="stringliteral">&quot;hCovSq&quot;</span>, <span class="stringliteral">&quot;hCovSq&quot;</span>, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;  hCovSq-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;  hCovSq-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Covariance&quot;</span>);</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;  <span class="comment">// The Correlation</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  <span class="keyword">auto</span> hCorr = std::make_unique&lt;TH2D&gt;(<span class="stringliteral">&quot;hCorr&quot;</span>, <span class="stringliteral">&quot;hCorr&quot;</span>, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  hCorr-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;  hCorr-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Correlation&quot;</span>);</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  hCorr-&gt;SetMinimum(-1);</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;  hCorr-&gt;SetMaximum(1);</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;  hCov-&gt;GetXaxis()-&gt;SetLabelSize(0.015);</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;  hCov-&gt;GetYaxis()-&gt;SetLabelSize(0.015);</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;  hCovSq-&gt;GetXaxis()-&gt;SetLabelSize(0.015);</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;  hCovSq-&gt;GetYaxis()-&gt;SetLabelSize(0.015);</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;  hCorr-&gt;GetXaxis()-&gt;SetLabelSize(0.015);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  hCorr-&gt;GetYaxis()-&gt;SetLabelSize(0.015);</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160; </div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;  <span class="comment">// Loop over the Covariance matrix entries</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i) </div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;  {</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    TString titlex = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <span class="keywordtype">double</span> nom, err;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <a class="code" href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">GetNthParameter</a>(i, nom, err, titlex);</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    </div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    hCov-&gt;GetXaxis()-&gt;SetBinLabel(i+1, titlex);</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    hCovSq-&gt;GetXaxis()-&gt;SetBinLabel(i+1, titlex);</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    hCorr-&gt;GetXaxis()-&gt;SetBinLabel(i+1, titlex);</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    </div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    {</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      <span class="comment">// The value of the Covariance</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> cov = (*Covariance)(i,j);</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> corr = (*Correlation)(i,j);</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160; </div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      hCov-&gt;SetBinContent(i+1, j+1, cov);</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      hCovSq-&gt;SetBinContent(i+1, j+1, ((cov &gt; 0) - (cov &lt; 0))*std::sqrt(std::fabs(cov)));</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;      hCorr-&gt;SetBinContent(i+1, j+1, corr);</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160; </div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;      TString titley = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      <span class="keywordtype">double</span> nom_j, err_j;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;      <a class="code" href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">GetNthParameter</a>(j, nom_j, err_j, titley);</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;  </div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      hCov-&gt;GetYaxis()-&gt;SetBinLabel(j+1, titley);</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      hCovSq-&gt;GetYaxis()-&gt;SetBinLabel(j+1, titley);</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      hCorr-&gt;GetYaxis()-&gt;SetBinLabel(j+1, titley);</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    }</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;  }</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160; </div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;  <span class="comment">// Take away the stat box</span></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;  gStyle-&gt;SetOptStat(0);</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#aa7611f55ac3c0ea70607761d037fbd91">plotBinValue</a>)gStyle-&gt;SetPaintTextFormat(<span class="stringliteral">&quot;4.1f&quot;</span>); <span class="comment">//Precision of value in matrix element</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  <span class="comment">// Make pretty Correlation colors (red to blue)</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;  constexpr <span class="keywordtype">int</span> NRGBs = 5;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;  TColor::InitializeColors();</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;  Double_t stops[NRGBs] = { 0.00, 0.25, 0.50, 0.75, 1.00 };</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;  Double_t red[NRGBs]   = { 0.00, 0.25, 1.00, 1.00, 0.50 };</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  Double_t green[NRGBs] = { 0.00, 0.25, 1.00, 0.25, 0.00 };</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  Double_t blue[NRGBs]  = { 0.50, 1.00, 1.00, 0.25, 0.00 };</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  TColor::CreateGradientColorTable(5, stops, red, green, blue, 255);</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;  gStyle-&gt;SetNumberContours(255);</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160; </div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;  <span class="comment">// cd into the correlation directory</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160; </div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;cd();</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Clear();</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#aa7611f55ac3c0ea70607761d037fbd91">plotBinValue</a>) hCov-&gt;Draw(<span class="stringliteral">&quot;colz text&quot;</span>);</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  <span class="keywordflow">else</span> hCov-&gt;Draw(<span class="stringliteral">&quot;colz&quot;</span>);</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Print(<a class="code" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160; </div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;cd();</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Clear();</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#aa7611f55ac3c0ea70607761d037fbd91">plotBinValue</a>) hCorr-&gt;Draw(<span class="stringliteral">&quot;colz text&quot;</span>);</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  <span class="keywordflow">else</span> hCorr-&gt;Draw(<span class="stringliteral">&quot;colz&quot;</span>);</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Print(<a class="code" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160; </div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  hCov-&gt;Write(<span class="stringliteral">&quot;Covariance_plot&quot;</span>);</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;  hCovSq-&gt;Write(<span class="stringliteral">&quot;Covariance_sq_plot&quot;</span>);</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  hCorr-&gt;Write(<span class="stringliteral">&quot;Correlation_plot&quot;</span>);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;  </div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;  <span class="comment">//Back to normal</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetRightMargin(RightMargin);</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;  <a class="code" href="classMCMCProcessor.html#a7c9c0c6da5530f5cf1f6fd673d2cc44f">DrawCorrelationsGroup</a>(hCorr);</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;  <a class="code" href="classMCMCProcessor.html#a5b0961bcb0eea7a347e6a29ef7738d80">DrawCorrelations1D</a>();</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a5b0961bcb0eea7a347e6a29ef7738d80"><div class="ttname"><a href="classMCMCProcessor.html#a5b0961bcb0eea7a347e6a29ef7738d80">MCMCProcessor::DrawCorrelations1D</a></div><div class="ttdeci">void DrawCorrelations1D()</div><div class="ttdoc">Draw 1D correlations which might be more helpful than looking at huge 2D Corr matrix.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l01625">MCMCProcessor.cpp:1625</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a7c9c0c6da5530f5cf1f6fd673d2cc44f"><div class="ttname"><a href="classMCMCProcessor.html#a7c9c0c6da5530f5cf1f6fd673d2cc44f">MCMCProcessor::DrawCorrelationsGroup</a></div><div class="ttdeci">void DrawCorrelationsGroup(const std::unique_ptr&lt; TH2D &gt; &amp;CorrMatrix) const</div><div class="ttdoc">Produces correlation matrix but instead of giving name for each param it only give name for param gro...</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l01515">MCMCProcessor.cpp:1515</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab420de77e598da4b02ba74cdc20f2ea9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab420de77e598da4b02ba74cdc20f2ea9">&#9670;&nbsp;</a></span>DrawPostfit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::DrawPostfit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Draw the post-fit comparisons. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l00421">421</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                                {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">// *******************</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a> == <span class="keyword">nullptr</span>) <a class="code" href="classMCMCProcessor.html#aa5a7761e97cf2e24c7d877a5374b7333">MakeOutputFile</a>();</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="comment">// Make the prefit plot</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  std::unique_ptr&lt;TH1D&gt; prefit = <a class="code" href="classMCMCProcessor.html#a7627041b5ea3e1bbe038046ebb71a5dc">MakePrefit</a>();</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  prefit-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="comment">// cd into the output file</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  std::string CutPosterior1D = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a85917e25c4f5b5b966c50cccd9ddd6a0">Posterior1DCut</a> != <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    CutPosterior1D = <a class="code" href="classMCMCProcessor.html#a576f0eb874afaf7e31ff5c86b9e5b8f9">StepCut</a> +<span class="stringliteral">&quot; &amp;&amp; &quot;</span> + <a class="code" href="classMCMCProcessor.html#a85917e25c4f5b5b966c50cccd9ddd6a0">Posterior1DCut</a>;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="keywordflow">else</span> CutPosterior1D = <a class="code" href="classMCMCProcessor.html#a576f0eb874afaf7e31ff5c86b9e5b8f9">StepCut</a>;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="comment">// Make a TH1D of the central values and the errors</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  std::unique_ptr&lt;TH1D&gt; paramPlot = std::make_unique&lt;TH1D&gt;(<span class="stringliteral">&quot;paramPlot&quot;</span>, <span class="stringliteral">&quot;paramPlot&quot;</span>, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  paramPlot-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  paramPlot-&gt;SetName(<span class="stringliteral">&quot;mach3params&quot;</span>);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  paramPlot-&gt;SetTitle(CutPosterior1D.c_str());</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  paramPlot-&gt;SetFillStyle(3001);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  paramPlot-&gt;SetFillColor(kBlue-1);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  paramPlot-&gt;SetMarkerColor(paramPlot-&gt;GetFillColor());</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  paramPlot-&gt;SetMarkerStyle(20);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  paramPlot-&gt;SetLineColor(paramPlot-&gt;GetFillColor());</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  paramPlot-&gt;SetMarkerSize(prefit-&gt;GetMarkerSize());</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  paramPlot-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="comment">// Same but with Gaussian output</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  std::unique_ptr&lt;TH1D&gt; paramPlot_Gauss = <a class="code" href="namespaceM3.html#a174fa82e79c5b38edecbc0552a4ce5b1">M3::Clone</a>(paramPlot.get());</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  paramPlot_Gauss-&gt;SetMarkerColor(kOrange-5);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  paramPlot_Gauss-&gt;SetMarkerStyle(23);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  paramPlot_Gauss-&gt;SetLineWidth(2);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  paramPlot_Gauss-&gt;SetMarkerSize((prefit-&gt;GetMarkerSize())*0.75);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  paramPlot_Gauss-&gt;SetFillColor(paramPlot_Gauss-&gt;GetMarkerColor());</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  paramPlot_Gauss-&gt;SetFillStyle(3244);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  paramPlot_Gauss-&gt;SetLineColor(paramPlot_Gauss-&gt;GetMarkerColor());</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  paramPlot_Gauss-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="comment">// Same but with Gaussian output</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  std::unique_ptr&lt;TH1D&gt; paramPlot_HPD = <a class="code" href="namespaceM3.html#a174fa82e79c5b38edecbc0552a4ce5b1">M3::Clone</a>(paramPlot.get());</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  paramPlot_HPD-&gt;SetMarkerColor(kBlack);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  paramPlot_HPD-&gt;SetMarkerStyle(25);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  paramPlot_HPD-&gt;SetLineWidth(2);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  paramPlot_HPD-&gt;SetMarkerSize((prefit-&gt;GetMarkerSize())*0.5);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  paramPlot_HPD-&gt;SetFillColor(0);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  paramPlot_HPD-&gt;SetFillStyle(0);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  paramPlot_HPD-&gt;SetLineColor(paramPlot_HPD-&gt;GetMarkerColor());</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  paramPlot_HPD-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="comment">// Set labels and data</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  {</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">//Those keep which parameter type we run currently and realtive number  </span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordtype">int</span> ParamEnu = <a class="code" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>[i];</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordtype">int</span> ParamNo = i - <a class="code" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20b">ParameterEnum</a>(ParamEnu)];</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">//KS: Slightly hacky way to get relative to prior or nominal as this is convention we use</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">//This only applies for xsec for other systematic types doesn&#39;t matter</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keywordtype">double</span> CentralValueTemp = 0;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keywordtype">double</span> Central, Central_gauss, Central_HPD;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordtype">double</span> Err, Err_Gauss, Err_HPD;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#afbac2a114c15ca7db4abe71dd549504c">plotRelativeToPrior</a>)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      CentralValueTemp = <a class="code" href="classMCMCProcessor.html#a3a6614826ae320e462211e38e96d9d02">ParamCentral</a>[ParamEnu][ParamNo];</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      <span class="comment">// Normalise the prior relative the nominal/prior, just the way we get our fit results in MaCh3</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <span class="keywordflow">if</span> ( CentralValueTemp != 0) </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        Central = (*Means)(i) / CentralValueTemp;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        Err = (*Errors)(i) / CentralValueTemp;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        Central_gauss = (*Means_Gauss)(i) / CentralValueTemp;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        Err_Gauss = (*Errors_Gauss)(i) / CentralValueTemp;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        Central_HPD = (*Means_HPD)(i) / CentralValueTemp;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        Err_HPD = (*Errors_HPD)(i) / CentralValueTemp;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      } </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        Central = 1+(*Means)(i);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        Err = (*Errors)(i);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        Central_gauss = 1+(*Means_Gauss)(i);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        Err_Gauss = (*Errors_Gauss)(i);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        Central_HPD = 1+(*Means_HPD)(i) ;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        Err_HPD = (*Errors_HPD)(i);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="comment">//KS: Just get value of each parameter without dividing by prior</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      Central = (*Means)(i);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      Err = (*Errors)(i);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;          </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      Central_gauss = (*Means_Gauss)(i);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      Err_Gauss = (*Errors_Gauss)(i);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      Central_HPD = (*Means_HPD)(i) ;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      Err_HPD = (*Errors_HPD)(i);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    paramPlot-&gt;SetBinContent(i+1, Central);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    paramPlot-&gt;SetBinError(i+1, Err);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    paramPlot_Gauss-&gt;SetBinContent(i+1, Central_gauss);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    paramPlot_Gauss-&gt;SetBinError(i+1, Err_Gauss);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    paramPlot_HPD-&gt;SetBinContent(i+1, Central_HPD);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    paramPlot_HPD-&gt;SetBinError(i+1, Err_HPD);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    paramPlot-&gt;GetXaxis()-&gt;SetBinLabel(i+1, prefit-&gt;GetXaxis()-&gt;GetBinLabel(i+1));</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    paramPlot_Gauss-&gt;GetXaxis()-&gt;SetBinLabel(i+1, prefit-&gt;GetXaxis()-&gt;GetBinLabel(i+1));</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    paramPlot_HPD-&gt;GetXaxis()-&gt;SetBinLabel(i+1, prefit-&gt;GetXaxis()-&gt;GetBinLabel(i+1));</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  prefit-&gt;GetXaxis()-&gt;LabelsOption(<span class="stringliteral">&quot;v&quot;</span>);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  paramPlot-&gt;GetXaxis()-&gt;LabelsOption(<span class="stringliteral">&quot;v&quot;</span>);\</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  paramPlot_Gauss-&gt;GetXaxis()-&gt;LabelsOption(<span class="stringliteral">&quot;v&quot;</span>);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  paramPlot_HPD-&gt;GetXaxis()-&gt;LabelsOption(<span class="stringliteral">&quot;v&quot;</span>);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="comment">// Make a TLegend</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="keyword">auto</span> CompLeg = std::make_unique&lt;TLegend&gt;(0.33, 0.73, 0.76, 0.95);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  CompLeg-&gt;AddEntry(prefit.get(), <span class="stringliteral">&quot;Prefit&quot;</span>, <span class="stringliteral">&quot;fp&quot;</span>);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  CompLeg-&gt;AddEntry(paramPlot.get(), <span class="stringliteral">&quot;Postfit PDF&quot;</span>, <span class="stringliteral">&quot;fp&quot;</span>);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  CompLeg-&gt;AddEntry(paramPlot_Gauss.get(), <span class="stringliteral">&quot;Postfit Gauss&quot;</span>, <span class="stringliteral">&quot;fp&quot;</span>);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  CompLeg-&gt;AddEntry(paramPlot_HPD.get(), <span class="stringliteral">&quot;Postfit HPD&quot;</span>, <span class="stringliteral">&quot;lfep&quot;</span>);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  CompLeg-&gt;SetFillColor(0);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  CompLeg-&gt;SetFillStyle(0);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  CompLeg-&gt;SetLineWidth(0);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  CompLeg-&gt;SetLineStyle(0);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  CompLeg-&gt;SetBorderSize(0);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="keyword">const</span> std::vector&lt;double&gt; Margins = <a class="code" href="classMCMCProcessor.html#a1dfc05edf0b1295e561d5956b43b1c6b">GetMargins</a>(<a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetBottomMargin(0.2);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="comment">// Write the individual ones</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  prefit-&gt;Write(<span class="stringliteral">&quot;param_xsec_prefit&quot;</span>);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  paramPlot-&gt;Write(<span class="stringliteral">&quot;param_xsec&quot;</span>);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  paramPlot_Gauss-&gt;Write(<span class="stringliteral">&quot;param_xsec_gaus&quot;</span>);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  paramPlot_HPD-&gt;Write(<span class="stringliteral">&quot;param_xsec_HPD&quot;</span>);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="comment">// Plot the xsec parameters (0 to ~nXsec-nFlux) nXsec == xsec + flux, quite confusing I know</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="comment">// Have already looked through the branches earlier</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#afbac2a114c15ca7db4abe71dd549504c">plotRelativeToPrior</a>)  prefit-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Variation rel. prior&quot;</span>);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordflow">else</span> prefit-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Parameter Value&quot;</span>);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  prefit-&gt;GetYaxis()-&gt;SetRangeUser(-2.5, 2.5);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="comment">// And the combined</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  prefit-&gt;Draw(<span class="stringliteral">&quot;e2&quot;</span>);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  paramPlot-&gt;Draw(<span class="stringliteral">&quot;e2, same&quot;</span>);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  paramPlot_Gauss-&gt;Draw(<span class="stringliteral">&quot;e2, same&quot;</span>);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  paramPlot_HPD-&gt;Draw(<span class="stringliteral">&quot;e1, same&quot;</span>);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  CompLeg-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Write(<span class="stringliteral">&quot;param_xsec_canv&quot;</span>);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <span class="comment">//KS: Tells how many parameters in one canvas we want</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  constexpr <span class="keywordtype">int</span> IntervalsSize = 20;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> NIntervals = <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>/IntervalsSize;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; NIntervals+1; ++i)</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  {</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordtype">int</span> RangeMin = i*IntervalsSize;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordtype">int</span> RangeMax =RangeMin + IntervalsSize;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordflow">if</span>(i == NIntervals+1) {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      RangeMin = i*IntervalsSize;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      RangeMax = <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    }</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordflow">if</span>(RangeMin &gt;= <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keywordtype">double</span> ymin = std::numeric_limits&lt;double&gt;::max();</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordtype">double</span> ymax = -std::numeric_limits&lt;double&gt;::max();</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b = RangeMin; b &lt;= RangeMax; ++b) {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <span class="comment">// prefit</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="keywordtype">double</span> val = prefit-&gt;GetBinContent(b);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="keywordtype">double</span> err = prefit-&gt;GetBinError(b);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        ymin = std::min(ymin, val - err);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        ymax = std::max(ymax, val + err);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      <span class="comment">// paramPlot_HPD</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <span class="keywordtype">double</span> val = paramPlot_HPD-&gt;GetBinContent(b);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="keywordtype">double</span> err = paramPlot_HPD-&gt;GetBinError(b);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        ymin = std::min(ymin, val - err);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        ymax = std::max(ymax, val + err);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    }</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keywordtype">double</span> margin = 0.1 * (ymax - ymin);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    prefit-&gt;GetYaxis()-&gt;SetRangeUser(ymin - margin, ymax + margin);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160; </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    prefit-&gt;GetXaxis()-&gt;SetRangeUser(RangeMin, RangeMax);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    paramPlot-&gt;GetXaxis()-&gt;SetRangeUser(RangeMin, RangeMax);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    paramPlot_Gauss-&gt;GetXaxis()-&gt;SetRangeUser(RangeMin, RangeMax);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    paramPlot_HPD-&gt;GetXaxis()-&gt;SetRangeUser(RangeMin, RangeMax);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160; </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="comment">// And the combined</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    prefit-&gt;Draw(<span class="stringliteral">&quot;e2&quot;</span>);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    paramPlot-&gt;Draw(<span class="stringliteral">&quot;e2, same&quot;</span>);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    paramPlot_Gauss-&gt;Draw(<span class="stringliteral">&quot;e2, same&quot;</span>);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    paramPlot_HPD-&gt;Draw(<span class="stringliteral">&quot;e1, same&quot;</span>);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    CompLeg-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Print(<a class="code" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Clear();</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  }</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160; </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>] &gt; 0)</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordtype">int</span> Start = <a class="code" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>];</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keywordtype">int</span> NDbinCounter = Start;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="comment">//KS: Make prefit postfit for each ND sample, having all of them at the same plot is unreadable</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aab80e0a8be27cc9206e1834a2f1f1ca2">NDSamplesNames</a>.size(); i++ )</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      std::string NDname = <a class="code" href="classMCMCProcessor.html#aab80e0a8be27cc9206e1834a2f1f1ca2">NDSamplesNames</a>[i];</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      NDbinCounter += <a class="code" href="classMCMCProcessor.html#ab2649d6e851ec0a08985a35da299fa5b">NDSamplesBins</a>[i];</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      prefit-&gt;GetYaxis()-&gt;SetTitle((<span class="stringliteral">&quot;Variation for &quot;</span>+NDname).c_str());</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      prefit-&gt;GetYaxis()-&gt;SetRangeUser(0.6, 1.4);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      prefit-&gt;GetXaxis()-&gt;SetRangeUser(Start, NDbinCounter);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      paramPlot-&gt;GetYaxis()-&gt;SetTitle((<span class="stringliteral">&quot;Variation for &quot;</span>+NDname).c_str());</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      paramPlot-&gt;GetYaxis()-&gt;SetRangeUser(0.6, 1.4);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      paramPlot-&gt;GetXaxis()-&gt;SetRangeUser(Start, NDbinCounter);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      paramPlot-&gt;SetTitle(CutPosterior1D.c_str());</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      paramPlot_Gauss-&gt;GetYaxis()-&gt;SetTitle((<span class="stringliteral">&quot;Variation for &quot;</span>+NDname).c_str());</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      paramPlot_Gauss-&gt;GetYaxis()-&gt;SetRangeUser(0.6, 1.4);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      paramPlot_Gauss-&gt;GetXaxis()-&gt;SetRangeUser(Start, NDbinCounter);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      paramPlot_Gauss-&gt;SetTitle(CutPosterior1D.c_str());</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      paramPlot_HPD-&gt;GetYaxis()-&gt;SetTitle((<span class="stringliteral">&quot;Variation for &quot;</span>+NDname).c_str());</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      paramPlot_HPD-&gt;GetYaxis()-&gt;SetRangeUser(0.6, 1.4);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      paramPlot_HPD-&gt;GetXaxis()-&gt;SetRangeUser(Start, NDbinCounter);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      paramPlot_HPD-&gt;SetTitle(CutPosterior1D.c_str());</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      prefit-&gt;Write((<span class="stringliteral">&quot;param_&quot;</span>+NDname+<span class="stringliteral">&quot;_prefit&quot;</span>).c_str());</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      paramPlot-&gt;Write((<span class="stringliteral">&quot;param_&quot;</span>+NDname).c_str());</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      paramPlot_Gauss-&gt;Write((<span class="stringliteral">&quot;param_&quot;</span>+NDname+<span class="stringliteral">&quot;_gaus&quot;</span>).c_str());</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      paramPlot_HPD-&gt;Write((<span class="stringliteral">&quot;param_&quot;</span>+NDname+<span class="stringliteral">&quot;_HPD&quot;</span>).c_str());</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      prefit-&gt;Draw(<span class="stringliteral">&quot;e2&quot;</span>);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      paramPlot-&gt;Draw(<span class="stringliteral">&quot;e2, same&quot;</span>);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      paramPlot_Gauss-&gt;Draw(<span class="stringliteral">&quot;e1, same&quot;</span>);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      paramPlot_HPD-&gt;Draw(<span class="stringliteral">&quot;e1, same&quot;</span>);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      CompLeg-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Write((<span class="stringliteral">&quot;param_&quot;</span>+NDname+<span class="stringliteral">&quot;_canv&quot;</span>).c_str());</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Print(<a class="code" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Clear();</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      Start += <a class="code" href="classMCMCProcessor.html#ab2649d6e851ec0a08985a35da299fa5b">NDSamplesBins</a>[i];</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  }</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="comment">//KS: Return Margin to default one</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <a class="code" href="classMCMCProcessor.html#a922f4c04b67ca9c6faab00efdb5277ea">SetMargins</a>(<a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>, Margins);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;}</div>
<div class="ttc" id="aMCMCProcessor_8h_html_acd2848273413543fe14936252942c20b"><div class="ttname"><a href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20b">ParameterEnum</a></div><div class="ttdeci">ParameterEnum</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00045">MCMCProcessor.h:45</a></div></div>
<div class="ttc" id="aMCMCProcessor_8h_html_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4"><div class="ttname"><a href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a></div><div class="ttdeci">@ kNDPar</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00047">MCMCProcessor.h:47</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a7627041b5ea3e1bbe038046ebb71a5dc"><div class="ttname"><a href="classMCMCProcessor.html#a7627041b5ea3e1bbe038046ebb71a5dc">MCMCProcessor::MakePrefit</a></div><div class="ttdeci">std::unique_ptr&lt; TH1D &gt; MakePrefit()</div><div class="ttdoc">Prepare prefit histogram for parameter overlay plot.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02368">MCMCProcessor.cpp:2368</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aa5a7761e97cf2e24c7d877a5374b7333"><div class="ttname"><a href="classMCMCProcessor.html#aa5a7761e97cf2e24c7d877a5374b7333">MCMCProcessor::MakeOutputFile</a></div><div class="ttdeci">void MakeOutputFile()</div><div class="ttdoc">prepare output root file and canvas to which we will save EVERYTHING</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l00194">MCMCProcessor.cpp:194</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aab80e0a8be27cc9206e1834a2f1f1ca2"><div class="ttname"><a href="classMCMCProcessor.html#aab80e0a8be27cc9206e1834a2f1f1ca2">MCMCProcessor::NDSamplesNames</a></div><div class="ttdeci">std::vector&lt; std::string &gt; NDSamplesNames</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00508">MCMCProcessor.h:508</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ab2649d6e851ec0a08985a35da299fa5b"><div class="ttname"><a href="classMCMCProcessor.html#ab2649d6e851ec0a08985a35da299fa5b">MCMCProcessor::NDSamplesBins</a></div><div class="ttdeci">std::vector&lt; int &gt; NDSamplesBins</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00507">MCMCProcessor.h:507</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aea15e730ff77556bb93bc4cff675744c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea15e730ff77556bb93bc4cff675744c">&#9670;&nbsp;</a></span>FindInputFiles()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::FindInputFiles </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read the output MCMC file and find what inputs were used. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02448">2448</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;                                   {</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;  <span class="comment">// Now read the MCMC file</span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;  TFile *TempFile = <a class="code" href="namespaceM3.html#a87841bdbf0e0a2a733d9e4ca499f820d">M3::Open</a>(<a class="code" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a>, <span class="stringliteral">&quot;open&quot;</span>, __FILE__, __LINE__);</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;  TDirectory* CovarianceFolder = TempFile-&gt;Get&lt;TDirectory&gt;(<span class="stringliteral">&quot;CovarianceFolder&quot;</span>);</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160; </div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;  <span class="comment">// Get the settings for the MCMC</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;  TMacro *Config = TempFile-&gt;Get&lt;TMacro&gt;(<span class="stringliteral">&quot;MaCh3_Config&quot;</span>);</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160; </div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;  <span class="keywordflow">if</span> (Config == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Didn&#39;t find MaCh3_Config tree in MCMC file! {}&quot;</span>, <a class="code" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a>);</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;    TempFile-&gt;ls();</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;  }</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Loading YAML config from MCMC chain&quot;</span>);</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160; </div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;  YAML::Node Settings = <a class="code" href="YamlHelper_8h.html#a7e0ade2fd295a927676c243c97d0aa64">TMacroToYAML</a>(*Config);</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160; </div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;  <span class="keywordtype">bool</span> InputNotFound = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;  <span class="comment">//CW: Get the xsec Covariance matrix</span></div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;  <a class="code" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>] = GetFromManager&lt;std::vector&lt;std::string&gt;&gt;(Settings[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;Systematics&quot;</span>][<span class="stringliteral">&quot;XsecCovFile&quot;</span>], {<span class="stringliteral">&quot;none&quot;</span>});</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>].back() == <span class="stringliteral">&quot;none&quot;</span>)</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;  {</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Couldn&#39;t find XsecCov branch in output&quot;</span>);</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;    InputNotFound = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;  }</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160; </div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;  TMacro *XsecConfig = <a class="code" href="namespaceM3.html#aeaf33acc05b9d2471c580098250e5d2c">M3::GetConfigMacroFromChain</a>(CovarianceFolder);</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;  <span class="keywordflow">if</span> (XsecConfig == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Didn&#39;t find Config_xsec_cov tree in MCMC file! {}&quot;</span>, <a class="code" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a>);</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;    <a class="code" href="classMCMCProcessor.html#a4c1330a025c0b91e382bdc29c960424a">CovConfig</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>] = <a class="code" href="YamlHelper_8h.html#a7e0ade2fd295a927676c243c97d0aa64">TMacroToYAML</a>(*XsecConfig);</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;  }</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;  <span class="keywordflow">if</span>(InputNotFound) <a class="code" href="namespaceMaCh3Utils.html#aaf39f873ebf93550a417418e583ebcf8">MaCh3Utils::PrintConfig</a>(Settings);</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160; </div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>].size(); i++)</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    <a class="code" href="namespaceM3.html#ad7693a9e309503bd894b04443f163f3c">M3::AddPath</a>(<a class="code" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>][i]);</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160; </div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;  <span class="comment">// Delete the TTrees and the input file handle since we&#39;ve now got the settings we need</span></div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;  <span class="keyword">delete</span> Config;</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;  <span class="keyword">delete</span> XsecConfig;</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160; </div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;  TMacro *<a class="code" href="structReweightConfig.html">ReweightConfig</a> = TempFile-&gt;Get&lt;TMacro&gt;(<span class="stringliteral">&quot;Reweight_Config&quot;</span>);</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structReweightConfig.html">ReweightConfig</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;    YAML::Node ReweightSettings = <a class="code" href="YamlHelper_8h.html#a7e0ade2fd295a927676c243c97d0aa64">TMacroToYAML</a>(*<a class="code" href="structReweightConfig.html">ReweightConfig</a>);</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160; </div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;    <span class="keywordflow">if</span> (ReweightSettings[<span class="stringliteral">&quot;Weight&quot;</span>]) {</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;      <a class="code" href="classMCMCProcessor.html#ad56b25b03eb5caab7b2a9c2ebf3ec178">ReweightName</a> = <span class="stringliteral">&quot;Weight&quot;</span>;</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;      <a class="code" href="classMCMCProcessor.html#a6f27039da3508952600b1ef26e76fe19">ReweightPosterior</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Enabling reweighting with following Config&quot;</span>);</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Found reweight config but without field &#39;&#39;Weight&#39;&#39;&quot;</span>);</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;    }</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;    <a class="code" href="namespaceMaCh3Utils.html#aaf39f873ebf93550a417418e583ebcf8">MaCh3Utils::PrintConfig</a>(ReweightSettings);</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;  }</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160; </div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;  <span class="comment">// Delete the MCMCFile pointer we&#39;re reading</span></div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;  CovarianceFolder-&gt;Close();</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;  <span class="keyword">delete</span> CovarianceFolder;</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;  TempFile-&gt;Close();</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;  <span class="keyword">delete</span> TempFile;</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_ad5b2eb6377721e3ac95def22c2386bb1"><div class="ttname"><a href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a></div><div class="ttdeci">#define MACH3LOG_WARN</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00036">MaCh3Logger.h:36</a></div></div>
<div class="ttc" id="aYamlHelper_8h_html_a7e0ade2fd295a927676c243c97d0aa64"><div class="ttname"><a href="YamlHelper_8h.html#a7e0ade2fd295a927676c243c97d0aa64">TMacroToYAML</a></div><div class="ttdeci">YAML::Node TMacroToYAML(const TMacro &amp;macro)</div><div class="ttdoc">KS: Convert a ROOT TMacro object to a YAML node.</div><div class="ttdef"><b>Definition:</b> <a href="YamlHelper_8h_source.html#l00152">YamlHelper.h:152</a></div></div>
<div class="ttc" id="anamespaceM3_html_a87841bdbf0e0a2a733d9e4ca499f820d"><div class="ttname"><a href="namespaceM3.html#a87841bdbf0e0a2a733d9e4ca499f820d">M3::Open</a></div><div class="ttdeci">TFile * Open(const std::string &amp;Name, const std::string &amp;Type, const std::string &amp;File, const int Line)</div><div class="ttdoc">Opens a ROOT file with the given name and mode.</div><div class="ttdef"><b>Definition:</b> <a href="HistogramUtils_8cpp_source.html#l00627">HistogramUtils.cpp:627</a></div></div>
<div class="ttc" id="anamespaceM3_html_ad7693a9e309503bd894b04443f163f3c"><div class="ttname"><a href="namespaceM3.html#ad7693a9e309503bd894b04443f163f3c">M3::AddPath</a></div><div class="ttdeci">void AddPath(std::string &amp;FilePath)</div><div class="ttdoc">Prepends the MACH3 environment path to FilePath if it is not already present.</div><div class="ttdef"><b>Definition:</b> <a href="Monitor_8cpp_source.html#l00382">Monitor.cpp:382</a></div></div>
<div class="ttc" id="anamespaceM3_html_aeaf33acc05b9d2471c580098250e5d2c"><div class="ttname"><a href="namespaceM3.html#aeaf33acc05b9d2471c580098250e5d2c">M3::GetConfigMacroFromChain</a></div><div class="ttdeci">TMacro * GetConfigMacroFromChain(TDirectory *CovarianceFolder)</div><div class="ttdoc">KS: We store configuration macros inside the chain. In the past, multiple configs were stored,...</div><div class="ttdef"><b>Definition:</b> <a href="ParameterHandlerUtils_8h_source.html#l00382">ParameterHandlerUtils.h:382</a></div></div>
<div class="ttc" id="anamespaceMaCh3Utils_html_aaf39f873ebf93550a417418e583ebcf8"><div class="ttname"><a href="namespaceMaCh3Utils.html#aaf39f873ebf93550a417418e583ebcf8">MaCh3Utils::PrintConfig</a></div><div class="ttdeci">void PrintConfig(const YAML::Node &amp;node)</div><div class="ttdoc">KS: Print Yaml config using logger.</div><div class="ttdef"><b>Definition:</b> <a href="Monitor_8cpp_source.html#l00310">Monitor.cpp:310</a></div></div>
<div class="ttc" id="astructReweightConfig_html"><div class="ttname"><a href="structReweightConfig.html">ReweightConfig</a></div><div class="ttdoc">Structure to hold reweight configuration.</div><div class="ttdef"><b>Definition:</b> <a href="ReweightMCMC_8cpp_source.html#l00030">ReweightMCMC.cpp:30</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a897c04312518965436704334ebbc9c01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a897c04312518965436704334ebbc9c01">&#9670;&nbsp;</a></span>FindInputFilesLegacy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::FindInputFilesLegacy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section warning"><dt>Warning</dt><dd>This will no longer be supported in future </dd></dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02513">2513</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;                                         {</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;  <span class="comment">// Now read the MCMC file</span></div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;  TFile *TempFile = <a class="code" href="namespaceM3.html#a87841bdbf0e0a2a733d9e4ca499f820d">M3::Open</a>(<a class="code" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a>, <span class="stringliteral">&quot;open&quot;</span>, __FILE__, __LINE__);</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;  <span class="comment">// Get the settings for the MCMC</span></div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;  TMacro *Config = TempFile-&gt;Get&lt;TMacro&gt;(<span class="stringliteral">&quot;MaCh3_Config&quot;</span>);</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160; </div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;  <span class="keywordflow">if</span> (Config == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Didn&#39;t find MaCh3_Config tree in MCMC file! {}&quot;</span>, <a class="code" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a>);</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;    TempFile-&gt;ls();</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;  }</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;  YAML::Node Settings = <a class="code" href="YamlHelper_8h.html#a7e0ade2fd295a927676c243c97d0aa64">TMacroToYAML</a>(*Config);</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160; </div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;  <span class="comment">//CW: And the ND Covariance matrix</span></div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;  <a class="code" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>].push_back(GetFromManager&lt;std::string&gt;(Settings[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;Systematics&quot;</span>][<span class="stringliteral">&quot;NDCovFile&quot;</span>], <span class="stringliteral">&quot;none&quot;</span>));</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160; </div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>].back() == <span class="stringliteral">&quot;none&quot;</span>) {</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Couldn&#39;t find NDCov (legacy) branch in output&quot;</span>);</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;  } <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;    <span class="comment">//If the FD Cov is not none, then you need the name of the covariance object to grab</span></div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;    <a class="code" href="classMCMCProcessor.html#a4a43ac10847a053db74553682f15e1d5">CovNamePos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>] = GetFromManager&lt;std::string&gt;(Settings[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;Systematics&quot;</span>][<span class="stringliteral">&quot;NDCovName&quot;</span>], <span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Given NDCovFile {} and NDCovName {}&quot;</span>, <a class="code" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>].back(), <a class="code" href="classMCMCProcessor.html#a4a43ac10847a053db74553682f15e1d5">CovNamePos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>]);</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;  }</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160; </div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;  <span class="comment">//CW: And the FD Covariance matrix</span></div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;  <a class="code" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>].push_back(GetFromManager&lt;std::string&gt;(Settings[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;Systematics&quot;</span>][<span class="stringliteral">&quot;FDCovFile&quot;</span>], <span class="stringliteral">&quot;none&quot;</span>));</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160; </div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>].back() == <span class="stringliteral">&quot;none&quot;</span>) {</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Couldn&#39;t find FDCov (legacy) branch in output&quot;</span>);</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;    <span class="comment">//If the FD Cov is not none, then you need the name of the covariance object to grab</span></div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;    <a class="code" href="classMCMCProcessor.html#a4a43ac10847a053db74553682f15e1d5">CovNamePos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>] = GetFromManager&lt;std::string&gt;(Settings[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;Systematics&quot;</span>][<span class="stringliteral">&quot;FDCovName&quot;</span>], <span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Given FDCovFile {} and FDCovName {}&quot;</span>, <a class="code" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>].back(), <a class="code" href="classMCMCProcessor.html#a4a43ac10847a053db74553682f15e1d5">CovNamePos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>]);</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;  }</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160; </div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>].size(); i++)</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;    <a class="code" href="namespaceM3.html#ad7693a9e309503bd894b04443f163f3c">M3::AddPath</a>(<a class="code" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>][i]);</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160; </div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>].size(); i++)</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    <a class="code" href="namespaceM3.html#ad7693a9e309503bd894b04443f163f3c">M3::AddPath</a>(<a class="code" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>][i]);</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160; </div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;  TempFile-&gt;Close();</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;  <span class="keyword">delete</span> TempFile;</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;}</div>
<div class="ttc" id="aMCMCProcessor_8h_html_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae"><div class="ttname"><a href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a></div><div class="ttdeci">@ kFDDetPar</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00048">MCMCProcessor.h:48</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a38dafb84a053401afa91c80899454927"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38dafb84a053401afa91c80899454927">&#9670;&nbsp;</a></span>GetBayesFactor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::GetBayesFactor </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>ParName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; double &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>Model1Bounds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; double &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>Model2Bounds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; std::string &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>ModelNames</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate Bayes factor for vector of params, and model boundaries. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ParName</td><td>Vector with parameter names for which we calculate Bayes factor </td></tr>
    <tr><td class="paramname">Model1Bounds</td><td>Lower and upper bound for hypothesis 1. Within this bound we calculate integral used later for Bayes Factor </td></tr>
    <tr><td class="paramname">Model2Bounds</td><td>Lower and upper bound for hypothesis 2. Within this bound we calculate integral used later for Bayes Factor </td></tr>
    <tr><td class="paramname">ModelNames</td><td>Names for hypothesis 1 and 2 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02840">2840</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;                                                                                     {</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[0] == <span class="keyword">nullptr</span>) <a class="code" href="classMCMCProcessor.html#a55f6d14a81943e03bef0ddc47721ce25">MakePostfit</a>();</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160; </div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Calculating Bayes Factor&quot;</span>);</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;  <span class="keywordflow">if</span>((ParNames.size() != Model1Bounds.size()) || (Model2Bounds.size() != Model1Bounds.size())  || (Model2Bounds.size() != ModelNames.size()))</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;  {</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Size doesn&#39;t match&quot;</span>);</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;  }</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; ParNames.size(); ++k)</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;  {</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;    <span class="comment">//KS: First we need to find parameter number based on name</span></div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;    <span class="keywordtype">int</span> ParamNo = <a class="code" href="classMCMCProcessor.html#a563df09ed03a95aa8ad2781db9c8807b">GetParamIndexFromName</a>(ParNames[k]);</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;    <span class="keywordflow">if</span>(ParamNo == <a class="code" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a>)</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;    {</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Couldn&#39;t find param {}. Will not calculate Bayes Factor&quot;</span>, ParNames[k]);</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;    }</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160; </div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> M1_min = Model1Bounds[k][0];</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> M2_min = Model2Bounds[k][0];</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> M1_max = Model1Bounds[k][1];</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> M2_max = Model2Bounds[k][1];</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160; </div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">double</span> IntegralMode1 = <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNo]-&gt;Integral(<a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNo]-&gt;FindFixBin(M1_min), <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNo]-&gt;FindFixBin(M1_max));</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">double</span> IntegralMode2 = <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNo]-&gt;Integral(<a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNo]-&gt;FindFixBin(M2_min), <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNo]-&gt;FindFixBin(M2_max));</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160; </div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;    <span class="keywordtype">double</span> BayesFactor = 0.;</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;    std::string Name = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;    <span class="comment">//KS: Calc Bayes Factor</span></div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;    <span class="comment">//If M1 is more likely</span></div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;    <span class="keywordflow">if</span>(IntegralMode1 &gt;= IntegralMode2)</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;    {</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;      BayesFactor = IntegralMode1/IntegralMode2;</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;      Name = <span class="stringliteral">&quot;\\mathfrak{B}(&quot;</span> + ModelNames[k][0]+ <span class="stringliteral">&quot;/&quot;</span> + ModelNames[k][1] + <span class="stringliteral">&quot;) = &quot;</span> + std::to_string(BayesFactor);</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;    }</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    <span class="keywordflow">else</span> <span class="comment">//If M2 is more likely</span></div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;    {</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;      BayesFactor = IntegralMode2/IntegralMode1;</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;      Name = <span class="stringliteral">&quot;\\mathfrak{B}(&quot;</span> + ModelNames[k][1]+ <span class="stringliteral">&quot;/&quot;</span> + ModelNames[k][0] + <span class="stringliteral">&quot;) = &quot;</span> + std::to_string(BayesFactor);</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;    }</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;    std::string JeffreysScale = <a class="code" href="StatisticalUtils_8cpp.html#aac0e253784ed2f2a3258d68df22a2568">GetJeffreysScale</a>(BayesFactor);</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;    std::string DunneKabothScale = <a class="code" href="StatisticalUtils_8cpp.html#acf403b05be9baa719893db7449e833c7">GetDunneKaboth</a>(BayesFactor);</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160; </div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{} for {}&quot;</span>, Name, ParNames[k]);</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Following Jeffreys Scale = {}&quot;</span>, JeffreysScale);</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Following Dunne-Kaboth Scale = {}&quot;</span>, DunneKabothScale);</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;  }</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;}</div>
<div class="ttc" id="aStatisticalUtils_8cpp_html_aac0e253784ed2f2a3258d68df22a2568"><div class="ttname"><a href="StatisticalUtils_8cpp.html#aac0e253784ed2f2a3258d68df22a2568">GetJeffreysScale</a></div><div class="ttdeci">std::string GetJeffreysScale(const double BayesFactor)</div><div class="ttdoc">KS: Following H. Jeffreys .</div><div class="ttdef"><b>Definition:</b> <a href="StatisticalUtils_8cpp_source.html#l00005">StatisticalUtils.cpp:5</a></div></div>
<div class="ttc" id="aStatisticalUtils_8cpp_html_acf403b05be9baa719893db7449e833c7"><div class="ttname"><a href="StatisticalUtils_8cpp.html#acf403b05be9baa719893db7449e833c7">GetDunneKaboth</a></div><div class="ttdeci">std::string GetDunneKaboth(const double BayesFactor)</div><div class="ttdoc">KS: Based on Table 1 in https://www.t2k.org/docs/technotes/435.</div><div class="ttdef"><b>Definition:</b> <a href="StatisticalUtils_8cpp_source.html#l00020">StatisticalUtils.cpp:20</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a55f6d14a81943e03bef0ddc47721ce25"><div class="ttname"><a href="classMCMCProcessor.html#a55f6d14a81943e03bef0ddc47721ce25">MCMCProcessor::MakePostfit</a></div><div class="ttdeci">void MakePostfit(const std::map&lt; std::string, std::pair&lt; double, double &gt;&gt; &amp;Edges={})</div><div class="ttdoc">Make 1D projection for each parameter and prepare structure.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l00228">MCMCProcessor.cpp:228</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a563df09ed03a95aa8ad2781db9c8807b"><div class="ttname"><a href="classMCMCProcessor.html#a563df09ed03a95aa8ad2781db9c8807b">MCMCProcessor::GetParamIndexFromName</a></div><div class="ttdeci">int GetParamIndexFromName(const std::string &amp;Name) const</div><div class="ttdoc">Get parameter number based on name.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02733">MCMCProcessor.cpp:2733</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0ca82be371ad0a0a9a22a0452a6ff8be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ca82be371ad0a0a9a22a0452a6ff8be">&#9670;&nbsp;</a></span>GetBranchNames()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt;TString&gt;&amp; MCMCProcessor::GetBranchNames </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the vector of branch names from root file. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00250">250</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac9e4fdea5d2de92a1abad5b79b7daf88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9e4fdea5d2de92a1abad5b79b7daf88">&#9670;&nbsp;</a></span>GetCovariance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::GetCovariance </td>
          <td>(</td>
          <td class="paramtype">TMatrixDSym *&amp;&#160;</td>
          <td class="paramname"><em>Cov</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixDSym *&amp;&#160;</td>
          <td class="paramname"><em>Corr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the post-fit covariances and correlations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Cov</td><td>Covariance matrix </td></tr>
    <tr><td class="paramname">Corr</td><td>Correlation matrix </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l00185">185</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                                                                       {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">// ***************</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#aea84f0315695aa05ec41fcf965b1b031">CacheMCMC</a>) <a class="code" href="classMCMCProcessor.html#ab367cb5f56606338bb1fce780f2414e8">MakeCovariance_MP</a>();</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordflow">else</span> <a class="code" href="classMCMCProcessor.html#afc94f21ffd599b1e2dd7e62f24f6c4de">MakeCovariance</a>();</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  Cov = <span class="keyword">static_cast&lt;</span>TMatrixDSym*<span class="keyword">&gt;</span>(<a class="code" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a>-&gt;Clone());</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  Corr = <span class="keyword">static_cast&lt;</span>TMatrixDSym*<span class="keyword">&gt;</span>(<a class="code" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>-&gt;Clone());</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;}</div>
<div class="ttc" id="aclassMCMCProcessor_html_ab367cb5f56606338bb1fce780f2414e8"><div class="ttname"><a href="classMCMCProcessor.html#ab367cb5f56606338bb1fce780f2414e8">MCMCProcessor::MakeCovariance_MP</a></div><div class="ttdeci">void MakeCovariance_MP(const bool Mute=false)</div><div class="ttdoc">Calculate covariance by making 2D projection of each combination of parameters using multithreading.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l01180">MCMCProcessor.cpp:1180</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_afc94f21ffd599b1e2dd7e62f24f6c4de"><div class="ttname"><a href="classMCMCProcessor.html#afc94f21ffd599b1e2dd7e62f24f6c4de">MCMCProcessor::MakeCovariance</a></div><div class="ttdeci">void MakeCovariance()</div><div class="ttdoc">Calculate covariance by making 2D projection of each combination of parameters.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l00940">MCMCProcessor.cpp:940</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7aea2db5f7e27378c1499923943687c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7aea2db5f7e27378c1499923943687c4">&#9670;&nbsp;</a></span>GetCovConfig()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">YAML::Node MCMCProcessor::GetCovConfig </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get Yaml config obtained from a Chain. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00218">218</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="classMCMCProcessor.html#a4c1330a025c0b91e382bdc29c960424a">CovConfig</a>.at(i); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab831ff0257b1f3137e1711df115a8b8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab831ff0257b1f3137e1711df115a8b8d">&#9670;&nbsp;</a></span>GetFDCov()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string MCMCProcessor::GetFDCov </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00238">238</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>].back(); };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a43afff108cd7e8942194cb9bd14f41ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43afff108cd7e8942194cb9bd14f41ae">&#9670;&nbsp;</a></span>GetGroup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::GetGroup </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of params from a given group, for example flux. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l04552">4552</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;                                                       {</div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;  <span class="comment">// Lambda to compare strings case-insensitively</span></div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;  <span class="keyword">auto</span> caseInsensitiveCompare = [](<span class="keyword">const</span> std::string&amp; a, <span class="keyword">const</span> std::string&amp; b) {</div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;    <span class="keywordflow">return</span> std::equal(a.begin(), a.end(), b.begin(), b.end(),</div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;                      [](<span class="keywordtype">char</span> c1, <span class="keywordtype">char</span> c2) { return std::tolower(c1) == std::tolower(c2); });</div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;  };</div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;  <span class="keywordtype">int</span> numerator = 0;</div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; groupName : <a class="code" href="classMCMCProcessor.html#ab72dd21faa732ec38e550c37635ee66d">ParameterGroup</a>) {</div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;    <span class="keywordflow">if</span> (caseInsensitiveCompare(groupName, name)) {</div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;      numerator++;</div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;    }</div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;  }</div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;  <span class="keywordflow">return</span> numerator;</div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a66fd25d5cf38bfc0c0b99f799d0f02e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66fd25d5cf38bfc0c0b99f799d0f02e9">&#9670;&nbsp;</a></span>GetHpost()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH1D* MCMCProcessor::GetHpost </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get 1D posterior for a given parameter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>parameter index </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00225">225</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a963d009bc7325e36d31737207b0fdca6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a963d009bc7325e36d31737207b0fdca6">&#9670;&nbsp;</a></span>GetHpost2D()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH2D* MCMCProcessor::GetHpost2D </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get 2D posterior for a given parameter combination. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>parameter index X </td></tr>
    <tr><td class="paramname">j</td><td>parameter index Y </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00229">229</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i][j]; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1dfc05edf0b1295e561d5956b43b1c6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dfc05edf0b1295e561d5956b43b1c6b">&#9670;&nbsp;</a></span>GetMargins()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; MCMCProcessor::GetMargins </td>
          <td>(</td>
          <td class="paramtype">const std::unique_ptr&lt; TCanvas &gt; &amp;&#160;</td>
          <td class="paramname"><em>Canv</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get TCanvas margins, to be able to reset them if particular function need different margins. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l04596">4596</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;                                                                                    {</div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;  <span class="keywordflow">return</span> std::vector&lt;double&gt;{Canv-&gt;GetTopMargin(), Canv-&gt;GetBottomMargin(),</div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;                              Canv-&gt;GetLeftMargin(), Canv-&gt;GetRightMargin()};</div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad26a853f53f50f5625b1c8043534dbe0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad26a853f53f50f5625b1c8043534dbe0">&#9670;&nbsp;</a></span>GetNDCov()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string MCMCProcessor::GetNDCov </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00237">237</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>].back(); };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7f00ad66e9eb7a910ef6e9e081c4154d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f00ad66e9eb7a910ef6e9e081c4154d">&#9670;&nbsp;</a></span>GetnEntries()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Long64_t MCMCProcessor::GetnEntries </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get Number of entries that Chain has, for merged chains will not be the same Nsteps. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00256">256</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5b1f7d739f2e8266cc8b26b4c7d2474d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b1f7d739f2e8266cc8b26b4c7d2474d">&#9670;&nbsp;</a></span>GetNFD()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::GetNFD </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00215">215</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>]; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad9ad8c1a2890d3f1ee5487a296252cab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9ad8c1a2890d3f1ee5487a296252cab">&#9670;&nbsp;</a></span>GetNND()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::GetNND </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00214">214</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>]; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7332c6550c57c1e8b77917eeb9401491"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7332c6550c57c1e8b77917eeb9401491">&#9670;&nbsp;</a></span>GetNParams()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::GetNParams </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get total number of used parameters. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00212">212</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa2ebe9262f7f28778d92148164a54d4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2ebe9262f7f28778d92148164a54d4b">&#9670;&nbsp;</a></span>GetnSteps()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Long64_t MCMCProcessor::GetnSteps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get Number of Steps that Chain has, for merged chains will not be the same nEntries. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00258">258</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;{<span class="keywordflow">return</span> <a class="code" href="classMCMCProcessor.html#aae0016a4e1d105d5d65243438c622a97">nSteps</a>;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a07204936619139b886e9a877bc46d1a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07204936619139b886e9a877bc46d1a4">&#9670;&nbsp;</a></span>GetNthParameter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::GetNthParameter </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>Prior</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>PriorError</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TString &amp;&#160;</td>
          <td class="paramname"><em>Title</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get properties of parameter by passing it number. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02720">2720</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;                                                                                                            {</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;  <a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20b">ParameterEnum</a> ParType = <a class="code" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>[param];</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;  <span class="keywordtype">int</span> ParamNo = <a class="code" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a>;</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;  ParamNo = param - <a class="code" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[ParType];</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160; </div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;  Prior = <a class="code" href="classMCMCProcessor.html#a3a6614826ae320e462211e38e96d9d02">ParamCentral</a>[ParType][ParamNo];</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;  PriorError = <a class="code" href="classMCMCProcessor.html#a3a97e3cb4be3ceb9eb721eac51d82d60">ParamErrors</a>[ParType][ParamNo];</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;  Title = <a class="code" href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">ParamNames</a>[ParType][ParamNo];</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa3751e8e0fec34c895aa5a3fb1794880"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3751e8e0fec34c895aa5a3fb1794880">&#9670;&nbsp;</a></span>GetNXSec()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::GetNXSec </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00213">213</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>]; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8ad18f84ede354149dd37534995e061c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ad18f84ede354149dd37534995e061c">&#9670;&nbsp;</a></span>GetParameterSums()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; MCMCProcessor::GetParameterSums </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the average of each parameter across all MCMC entries. Useful for autocorrelation. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l03615">3615</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;                                                   {</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;<span class="comment">// *********************************</span></div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;  <span class="comment">// Initialise the sums</span></div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;  std::vector &lt;double&gt; ParamSums(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>,0);</div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160; </div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;<span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i) {</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;      ParamSums[j] += <a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>[j][i];</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;    }</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;  }</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;  <span class="comment">// Make the sums into average</span></div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;<span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i) {</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;    ParamSums[i] /= double(<a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;  }</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;  <span class="keywordflow">return</span> ParamSums;</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a563df09ed03a95aa8ad2781db9c8807b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a563df09ed03a95aa8ad2781db9c8807b">&#9670;&nbsp;</a></span>GetParamIndexFromName()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::GetParamIndexFromName </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>Name</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get parameter number based on name. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02733">2733</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;                                                                    {</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;  <span class="keywordtype">int</span> ParamNo = <a class="code" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a>;</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;  {</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;    <span class="keywordtype">double</span> Prior = 1.0, PriorError = 1.0;</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;    <a class="code" href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">GetNthParameter</a>(i, Prior, PriorError, Title);</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160; </div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;    <span class="keywordflow">if</span>(Name == Title)</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;    {</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;      ParamNo = i;</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;    }</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;  }</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;  <span class="keywordflow">return</span> ParamNo;</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac358c3ffe7c060e8872c762259973c6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac358c3ffe7c060e8872c762259973c6b">&#9670;&nbsp;</a></span>GetPolarPlot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::GetPolarPlot </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>ParNames</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make funny polar plot. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ParNames</td><td>Vector with parameter names for which Polar Plot will be made </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02771">2771</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;                                                                    {</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[0] == <span class="keyword">nullptr</span>) <a class="code" href="classMCMCProcessor.html#a55f6d14a81943e03bef0ddc47721ce25">MakePostfit</a>();</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160; </div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;  std::vector&lt;double&gt; Margins = <a class="code" href="classMCMCProcessor.html#a1dfc05edf0b1295e561d5956b43b1c6b">GetMargins</a>(<a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>);</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160; </div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetTopMargin(0.1);</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetBottomMargin(0.1);</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetLeftMargin(0.1);</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetRightMargin(0.1);</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Update();</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160; </div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Calculating Polar Plot&quot;</span>);</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;  TDirectory *PolarDir = <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;PolarDir&quot;</span>);</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;  PolarDir-&gt;cd();</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160; </div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; ParNames.size(); ++k)</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;  {</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;    <span class="comment">//KS: First we need to find parameter number based on name</span></div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;    <span class="keywordtype">int</span> ParamNo = <a class="code" href="classMCMCProcessor.html#a563df09ed03a95aa8ad2781db9c8807b">GetParamIndexFromName</a>(ParNames[k]);</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;    <span class="keywordflow">if</span>(ParamNo == <a class="code" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a>)</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;    {</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Couldn&#39;t find param {}. Will not calculate Polar Plot&quot;</span>, ParNames[k]);</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;    }</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160; </div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;    <span class="keywordtype">double</span> Prior = 1.0, PriorError = 1.0;</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;    <a class="code" href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">GetNthParameter</a>(ParamNo, Prior, PriorError, Title);</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160; </div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;    std::vector&lt;double&gt; x_val(<a class="code" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a>);</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;    std::vector&lt;double&gt; y_val(<a class="code" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a>);</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160; </div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;    constexpr <span class="keywordtype">double</span> xmin = 0;</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;    constexpr <span class="keywordtype">double</span> xmax = 2*TMath::Pi();</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160; </div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;    <span class="keywordtype">double</span> Integral = <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNo]-&gt;Integral();</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;    <span class="keywordflow">for</span> (Int_t ipt = 0; ipt &lt; <a class="code" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a>; ipt++)</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;    {</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;      x_val[ipt] = ipt*(xmax-xmin)/<a class="code" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a>+xmin;</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;      y_val[ipt] = <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNo]-&gt;GetBinContent(ipt+1)/Integral;</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;    }</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160; </div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;    <span class="keyword">auto</span> PolarGraph = std::make_unique&lt;TGraphPolar&gt;(<a class="code" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a>, x_val.data(), y_val.data());</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;    PolarGraph-&gt;SetLineWidth(2);</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;    PolarGraph-&gt;SetFillStyle(3001);</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;    PolarGraph-&gt;SetLineColor(kRed);</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;    PolarGraph-&gt;SetFillColor(kRed);</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;    PolarGraph-&gt;Draw(<span class="stringliteral">&quot;AFL&quot;</span>);</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160; </div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;    <span class="keyword">auto</span> Text = std::make_unique&lt;TText&gt;(0.6, 0.1, Title);</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;    Text-&gt;SetTextSize(0.04);</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;    Text-&gt;SetNDC(<span class="keyword">true</span>);</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;    Text-&gt;Draw(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160; </div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;    <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Print(<a class="code" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;    <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Write(Title);</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;  } <span class="comment">//End loop over parameters</span></div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160; </div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;  PolarDir-&gt;Close();</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;  <span class="keyword">delete</span> PolarDir;</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160; </div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160; </div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;  <a class="code" href="classMCMCProcessor.html#a922f4c04b67ca9c6faab00efdb5277ea">SetMargins</a>(<a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>, Margins);</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5fc015740496b821648f0e5ca8cffe80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fc015740496b821648f0e5ca8cffe80">&#9670;&nbsp;</a></span>GetPostfit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::GetPostfit </td>
          <td>(</td>
          <td class="paramtype">TVectorD *&amp;&#160;</td>
          <td class="paramname"><em>Central</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TVectorD *&amp;&#160;</td>
          <td class="paramname"><em>Errors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TVectorD *&amp;&#160;</td>
          <td class="paramname"><em>Central_Gauss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TVectorD *&amp;&#160;</td>
          <td class="paramname"><em>Errors_Gauss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TVectorD *&amp;&#160;</td>
          <td class="paramname"><em>Peaks</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the post-fit results (arithmetic and Gaussian) </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l00152">152</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                                                                                                                                               {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">// ***************</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="comment">// Make the post fit</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <a class="code" href="classMCMCProcessor.html#a55f6d14a81943e03bef0ddc47721ce25">MakePostfit</a>();</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="comment">// We now have the private members</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  Central_PDF = <a class="code" href="classMCMCProcessor.html#acaf7f239136dfa3506d095b612323d0a">Means</a>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  Errors_PDF = <a class="code" href="classMCMCProcessor.html#a5174aaa900edf16ddc6e841ea4adae83">Errors</a>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  Central_G = <a class="code" href="classMCMCProcessor.html#a600fc8c39af2750df91fb7a0ff85ac74">Means_Gauss</a>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  Errors_G = <a class="code" href="classMCMCProcessor.html#aa78b7ed1bb9966f84f4eaf8cedf5e688">Errors_Gauss</a>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  Peak_Values = <a class="code" href="classMCMCProcessor.html#a32657dc39a7fc0d04804f6195a3d8c3e">Means_HPD</a>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a59fa9550b7c69c616929217ae89c2f42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59fa9550b7c69c616929217ae89c2f42">&#9670;&nbsp;</a></span>GetPostfit_Ind()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::GetPostfit_Ind </td>
          <td>(</td>
          <td class="paramtype">TVectorD *&amp;&#160;</td>
          <td class="paramname"><em>Central</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TVectorD *&amp;&#160;</td>
          <td class="paramname"><em>Errors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TVectorD *&amp;&#160;</td>
          <td class="paramname"><em>Peaks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20b">ParameterEnum</a>&#160;</td>
          <td class="paramname"><em>kParam</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Or the individual post-fits. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l00167">167</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                                                                                                                              {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">// ***************</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="comment">// Make the post fit</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <a class="code" href="classMCMCProcessor.html#a55f6d14a81943e03bef0ddc47721ce25">MakePostfit</a>();</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="comment">// Loop over the loaded param types</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> ParamTypeSize = int(<a class="code" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>.size());</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordtype">int</span> ParamNumber = 0;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ParamTypeSize; ++i) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>[i] != kParam) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    (*PDF_Central)(ParamNumber) = (*<a class="code" href="classMCMCProcessor.html#acaf7f239136dfa3506d095b612323d0a">Means</a>)(i);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    (*PDF_Errors)(ParamNumber) = (*<a class="code" href="classMCMCProcessor.html#a5174aaa900edf16ddc6e841ea4adae83">Errors</a>)(i);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    (*Peak_Values)(ParamNumber) = (*<a class="code" href="classMCMCProcessor.html#a32657dc39a7fc0d04804f6195a3d8c3e">Means_HPD</a>)(i);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    ++ParamNumber;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad9c3ef9ecc7cb66791837e5127970d9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9c3ef9ecc7cb66791837e5127970d9f">&#9670;&nbsp;</a></span>GetSavageDickey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::GetSavageDickey </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>ParName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>EvaluationPoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; double &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>Bounds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate Bayes factor for point like hypothesis using SavageDickey. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02897">2897</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;                                                                               {</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;  <span class="keywordflow">if</span>((ParNames.size() != EvaluationPoint.size()) || (Bounds.size() != EvaluationPoint.size()))</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;  {</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Size doesn&#39;t match&quot;</span>);</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;  }</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;  </div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[0] == <span class="keyword">nullptr</span>) <a class="code" href="classMCMCProcessor.html#a55f6d14a81943e03bef0ddc47721ce25">MakePostfit</a>();</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160; </div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Calculating Savage Dickey&quot;</span>);</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;  TDirectory *SavageDickeyDir = <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;SavageDickey&quot;</span>);</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;  SavageDickeyDir-&gt;cd();</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;  </div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; ParNames.size(); ++k)</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;  {</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;    <span class="comment">//KS: First we need to find parameter number based on name</span></div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;    <span class="keywordtype">int</span> ParamNo = <a class="code" href="classMCMCProcessor.html#a563df09ed03a95aa8ad2781db9c8807b">GetParamIndexFromName</a>(ParNames[k]);</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;    <span class="keywordflow">if</span>(ParamNo == <a class="code" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a>)</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;    {</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Couldn&#39;t find param {}. Will not calculate SavageDickey&quot;</span>, ParNames[k]);</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;    }</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;    </div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;    <span class="keywordtype">double</span> Prior = 1.0, PriorError = 1.0;</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;    <span class="keywordtype">bool</span> FlatPrior = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;    <a class="code" href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">GetNthParameter</a>(ParamNo, Prior, PriorError, Title);</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;    </div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;    <a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20b">ParameterEnum</a> ParType = <a class="code" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>[ParamNo];</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;    <span class="keywordtype">int</span> ParamTemp = ParamNo - <a class="code" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[ParType];</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;    FlatPrior = <a class="code" href="classMCMCProcessor.html#a4be1eedb743e4ea410009a4fa45720f7">ParamFlat</a>[ParType][ParamTemp];</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;    </div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;    <span class="keyword">auto</span> PosteriorHist = M3::Clone&lt;TH1D&gt;(<a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNo], std::string(Title));</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;    <a class="code" href="HistogramUtils_8cpp.html#a85463c0c6943e3d544d5fcb3f96bf18a">RemoveFitter</a>(PosteriorHist.get(), <span class="stringliteral">&quot;Gauss&quot;</span>);</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;            </div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;    std::unique_ptr&lt;TH1D&gt; PriorHist;</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;    <span class="comment">//KS: If flat prior we need to have well defined bounds otherwise Prior distribution will not make sense</span></div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;    <span class="keywordflow">if</span>(FlatPrior)</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;    {</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;      <span class="keywordtype">int</span> NBins = PosteriorHist-&gt;GetNbinsX();</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;      <span class="keywordflow">if</span>(Bounds[k][0] &gt; Bounds[k][1])</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;      {</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Lower bound is higher than upper bound&quot;</span>);</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;      }</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;      PriorHist = std::make_unique&lt;TH1D&gt;(<span class="stringliteral">&quot;PriorHist&quot;</span>, Title, NBins, Bounds[k][0], Bounds[k][1]);</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;      PriorHist-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;      <span class="keywordtype">double</span> FlatProb = ( Bounds[k][1] - Bounds[k][0]) / NBins;</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> g = 0; g &lt; NBins + 1; ++g) </div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;      {</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;        PriorHist-&gt;SetBinContent(g+1, FlatProb);</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;      }</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;    }</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;    <span class="keywordflow">else</span> <span class="comment">//KS: Otherwise throw from Gaussian</span></div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;    {</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;      PriorHist = M3::Clone&lt;TH1D&gt;(PosteriorHist.get(), <span class="stringliteral">&quot;Prior&quot;</span>);</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;      PriorHist-&gt;Reset(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;      PriorHist-&gt;Fill(0.0, 0.0);</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;      </div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;      <span class="keyword">auto</span> rand = std::make_unique&lt;TRandom3&gt;(0);</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;      <span class="comment">//KS: Throw nice gaussian, just need big number to have smooth distribution</span></div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> g = 0; g &lt; 1000000; ++g)</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;      {</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;        PriorHist-&gt;Fill(rand-&gt;Gaus(Prior, PriorError));</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;      }</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;    }</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;    <a class="code" href="classMCMCProcessor.html#af69384c2db282bb76e74beb15644ec2a">SavageDickeyPlot</a>(PriorHist, PosteriorHist, std::string(Title), EvaluationPoint[k]);</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;  } <span class="comment">//End loop over parameters</span></div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160; </div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;  SavageDickeyDir-&gt;Close();</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;  <span class="keyword">delete</span> SavageDickeyDir;</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160; </div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;}</div>
<div class="ttc" id="aHistogramUtils_8cpp_html_a85463c0c6943e3d544d5fcb3f96bf18a"><div class="ttname"><a href="HistogramUtils_8cpp.html#a85463c0c6943e3d544d5fcb3f96bf18a">RemoveFitter</a></div><div class="ttdeci">void RemoveFitter(TH1D *hist, const std::string &amp;name)</div><div class="ttdoc">KS: Remove fitted TF1 from hist to make comparison easier.</div><div class="ttdef"><b>Definition:</b> <a href="HistogramUtils_8cpp_source.html#l00394">HistogramUtils.cpp:394</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_af69384c2db282bb76e74beb15644ec2a"><div class="ttname"><a href="classMCMCProcessor.html#af69384c2db282bb76e74beb15644ec2a">MCMCProcessor::SavageDickeyPlot</a></div><div class="ttdeci">void SavageDickeyPlot(std::unique_ptr&lt; TH1D &gt; &amp;PriorHist, std::unique_ptr&lt; TH1D &gt; &amp;PosteriorHist, const std::string &amp;Title, const double EvaluationPoint) const</div><div class="ttdoc">Produce Savage Dickey plot.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02977">MCMCProcessor.cpp:2977</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6f54781e8a32bfa48036212ee0ae9e3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f54781e8a32bfa48036212ee0ae9e3d">&#9670;&nbsp;</a></span>GetViolin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH2D* MCMCProcessor::GetViolin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get Violin plot for all parameters with posterior values. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00231">231</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classMCMCProcessor.html#a97a9669445c141d9dddc19f1b3562479">hviolin</a>.get(); };</div>
</div><!-- fragment -->
</div>
</div>
<a id="aaebda73d2ab4fd560e83dcf6e0c68e58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaebda73d2ab4fd560e83dcf6e0c68e58">&#9670;&nbsp;</a></span>GetViolinPrior()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH2D* MCMCProcessor::GetViolinPrior </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get Violin plot for all parameters with prior values. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00233">233</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classMCMCProcessor.html#a4061fd7eeeee55dd709fe844146ed815">hviolin_prior</a>.get(); };</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae97dab2090292a7f5ede3a9b3f48828f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae97dab2090292a7f5ede3a9b3f48828f">&#9670;&nbsp;</a></span>GetXSecCov()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; MCMCProcessor::GetXSecCov </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00236">236</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>]; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a03b7c4bb9cd9a90aa7d284b0f1a6156b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03b7c4bb9cd9a90aa7d284b0f1a6156b">&#9670;&nbsp;</a></span>GewekeDiagnostic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::GewekeDiagnostic </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Geweke Diagnostic based on the methods described by Fang (2014) and Karlsbakk (2011). <a class="el" href="citelist.html#CITEREF_Fang2014GewekeDiagnostics">[8]</a> <a class="el" href="citelist.html#CITEREF_karlsbakk2011">[21]</a>. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l04333">4333</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;                                     {</div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making Geweke Diagnostic&quot;</span>);</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;  <span class="comment">//KS: Up refers to upper limit we check, it stays constant, in literature it is mostly 50% thus using 0.5 for threshold</span></div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;  std::vector&lt;double&gt; MeanUp(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0.0);</div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;  std::vector&lt;double&gt; SpectralVarianceUp(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0.0);</div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;  std::vector&lt;int&gt; DenomCounterUp(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0);</div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> Threshold = 0.5 * <a class="code" href="classMCMCProcessor.html#aae0016a4e1d105d5d65243438c622a97">nSteps</a>;</div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160; </div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;  <span class="comment">//KS: Select values between which you want to scan, for example 0 means 0% burn in and 1 100% burn in.</span></div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;  constexpr <span class="keywordtype">double</span> LowerThreshold = 0;</div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;  constexpr <span class="keywordtype">double</span> UpperThreshold = 1.0;</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;  <span class="comment">// Tells how many intervals between thresholds we want to check</span></div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;  constexpr <span class="keywordtype">int</span> NChecks = 100;</div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;  constexpr <span class="keywordtype">double</span> Division = (UpperThreshold - LowerThreshold)/NChecks;</div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160; </div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;  std::vector&lt;std::unique_ptr&lt;TH1D&gt;&gt; GewekePlots(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;  {</div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;    <span class="keywordtype">double</span> Prior = 1.0, PriorError = 1.0;</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;    <a class="code" href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">GetNthParameter</a>(j, Prior, PriorError, Title);</div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;    std::string HistName = Form(<span class="stringliteral">&quot;%s_%s_Geweke&quot;</span>, Title.Data(), <a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[j].Data());</div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;    GewekePlots[j] = std::make_unique&lt;TH1D&gt;(HistName.c_str(), HistName.c_str(), NChecks, 0.0, 100 * UpperThreshold);</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;    GewekePlots[j]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;    GewekePlots[j]-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Burn-In (%)&quot;</span>);</div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;    GewekePlots[j]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Geweke T score&quot;</span>);</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;  }</div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160; </div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;<span class="comment">//KS: Start parallel region</span></div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;<span class="preprocessor">#ifdef MULTITHREAD</span></div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;<span class="preprocessor">#pragma omp parallel</span></div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;{</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;  <span class="comment">//KS: First we calculate mean and spectral variance for the upper limit, this doesn&#39;t change and in literature is most often 50%</span></div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;<span class="preprocessor">  #pragma omp for</span></div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;  {</div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i)</div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;    {</div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a6058bb3e817401423231f85a71db46a0">StepNumber</a>[i] &gt; Threshold)</div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;      {</div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;        MeanUp[j] += <a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>[j][i];</div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;        DenomCounterUp[j]++;</div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;      }</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;    }</div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;    MeanUp[j] = MeanUp[j]/DenomCounterUp[j];</div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;  }</div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160; </div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;  <span class="comment">//KS: now Spectral variance which in this case is sample variance</span></div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;<span class="preprocessor">  #pragma omp for collapse(2)</span></div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;  {</div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i)</div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;    {</div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a6058bb3e817401423231f85a71db46a0">StepNumber</a>[i] &gt; Threshold)</div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;      {</div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;        SpectralVarianceUp[j] += (<a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>[j][i] - MeanUp[j])*(<a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>[j][i] - MeanUp[j]);</div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;      }</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;    }</div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;  }</div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160; </div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;  <span class="comment">//Loop over how many intervals we calculate</span></div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;<span class="preprocessor">  #pragma omp for</span></div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; NChecks+1; ++k)</div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;  {</div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;    <span class="comment">//KS each thread has it&#39;s own</span></div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;    std::vector&lt;double&gt; MeanDown(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0.0);</div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;    std::vector&lt;double&gt; SpectralVarianceDown(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0.0);</div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;    std::vector&lt;int&gt; DenomCounterDown(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0);</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160; </div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ThresholsCheck = Division*k*<a class="code" href="classMCMCProcessor.html#aae0016a4e1d105d5d65243438c622a97">nSteps</a>;</div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;    <span class="comment">//KS: First mean</span></div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;    {</div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i)</div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;      {</div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a6058bb3e817401423231f85a71db46a0">StepNumber</a>[i] &lt; ThresholsCheck)</div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;        {</div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;          MeanDown[j] += <a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>[j][i];</div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;          DenomCounterDown[j]++;</div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;        }</div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;      }</div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;      MeanDown[j] = MeanDown[j]/DenomCounterDown[j];</div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;    }</div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;    <span class="comment">//Now spectral variance</span></div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;    {</div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i)</div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;      {</div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a6058bb3e817401423231f85a71db46a0">StepNumber</a>[i] &lt; ThresholsCheck)</div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;        {</div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;          SpectralVarianceDown[j] += (<a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>[j][i] - MeanDown[j])*(<a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>[j][i] - MeanDown[j]);</div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;        }</div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;      }</div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;    }</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;    <span class="comment">//Lastly calc T score and fill histogram entry</span></div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;    {</div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;      <span class="keywordtype">double</span> T_score = std::fabs((MeanDown[j] - MeanUp[j])/std::sqrt(SpectralVarianceDown[j]/DenomCounterDown[j] + SpectralVarianceUp[j]/DenomCounterUp[j]));</div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;      GewekePlots[j]-&gt;SetBinContent(k, T_score);</div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;    }</div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;  } <span class="comment">//end loop over intervals</span></div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;<span class="preprocessor">#ifdef MULTITHREAD</span></div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;} <span class="comment">//End parallel region</span></div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160; </div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;  <span class="comment">//Finally save it to TFile</span></div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;  TDirectory *GewekeDir = <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Geweke&quot;</span>);</div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;  {</div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;    GewekeDir-&gt;cd();</div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;    GewekePlots[j]-&gt;Write();</div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;  }</div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i) {</div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>[i];</div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;  }</div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;  <span class="keyword">delete</span>[] <a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>;</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160; </div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;  GewekeDir-&gt;Close();</div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;  <span class="keyword">delete</span> GewekeDir;</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a224995a0b47bd9cbd04e099cc3ca634c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a224995a0b47bd9cbd04e099cc3ca634c">&#9670;&nbsp;</a></span>Initialise()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::Initialise </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Scan chain, what parameters we have and load information from covariance matrices. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l00142">142</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                              {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">// ***************</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="comment">// Scan the ROOT file for useful branches</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <a class="code" href="classMCMCProcessor.html#aeff2174617268c1e55333529459bffb6">ScanInput</a>();</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="comment">// Setup the output</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <a class="code" href="classMCMCProcessor.html#aa4761be1345f1be3defe162b278a9d8e">SetupOutput</a>();</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;}</div>
<div class="ttc" id="aclassMCMCProcessor_html_aa4761be1345f1be3defe162b278a9d8e"><div class="ttname"><a href="classMCMCProcessor.html#aa4761be1345f1be3defe162b278a9d8e">MCMCProcessor::SetupOutput</a></div><div class="ttdeci">void SetupOutput()</div><div class="ttdoc">Prepare all objects used for output.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02293">MCMCProcessor.cpp:2293</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aeff2174617268c1e55333529459bffb6"><div class="ttname"><a href="classMCMCProcessor.html#aeff2174617268c1e55333529459bffb6">MCMCProcessor::ScanInput</a></div><div class="ttdeci">void ScanInput()</div><div class="ttdoc">Scan Input etc.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02190">MCMCProcessor.cpp:2190</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aabac168d6ff10dc3d57667db532476a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabac168d6ff10dc3d57667db532476a2">&#9670;&nbsp;</a></span>LoadAdditionalInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void MCMCProcessor::LoadAdditionalInfo </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>allow loading additional info for example used for oscillation parameters </p>

<p>Reimplemented in <a class="el" href="classOscProcessor.html#aa5b2ecf52ca107e11ac55bb9721db2c5">OscProcessor</a>.</p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00346">346</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;{};</div>
</div><!-- fragment -->
</div>
</div>
<a id="afc94f21ffd599b1e2dd7e62f24f6c4de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc94f21ffd599b1e2dd7e62f24f6c4de">&#9670;&nbsp;</a></span>MakeCovariance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::MakeCovariance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate covariance by making 2D projection of each combination of parameters. </p>
<dl class="section warning"><dt>Warning</dt><dd>This is deprecated and slower, however it is less RAM intensive </dd></dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l00940">940</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                                   {</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">// *********************</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a> == <span class="keyword">nullptr</span>) <a class="code" href="classMCMCProcessor.html#aa5a7761e97cf2e24c7d877a5374b7333">MakeOutputFile</a>();</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <span class="keywordtype">bool</span> HaveMadeDiagonal = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making post-fit covariances...&quot;</span>);</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <span class="comment">// Check that the diagonal entries have been filled</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <span class="comment">// i.e. MakePostfit() has been called</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i) {</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="keywordflow">if</span> ((*<a class="code" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a>)(i,i) == <a class="code" href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a>) {</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      HaveMadeDiagonal = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Have not run diagonal elements in covariance, will do so now by calling MakePostfit()&quot;</span>);</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      HaveMadeDiagonal = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    }</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  }</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  <span class="keywordflow">if</span> (HaveMadeDiagonal == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <a class="code" href="classMCMCProcessor.html#a55f6d14a81943e03bef0ddc47721ce25">MakePostfit</a>();</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  }</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160; </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  TDirectory *PostHistDir = <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Post_2d_hists&quot;</span>);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  PostHistDir-&gt;cd();</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  gStyle-&gt;SetPalette(55);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  <span class="comment">// Now we are sure we have the diagonal elements, let&#39;s make the off-diagonals</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  {</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="keywordflow">if</span> (i % (<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>/5) == 0)</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;      <a class="code" href="namespaceMaCh3Utils.html#a4c8bdeb1d34606aed192e9f1311a72f5">MaCh3Utils::PrintProgressBar</a>(i, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160; </div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    TString Title_i = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="keywordtype">double</span> Prior_i, PriorError;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160; </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <a class="code" href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">GetNthParameter</a>(i, Prior_i, PriorError, Title_i);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    </div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <span class="comment">// Loop over the other parameters to get the correlations</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j) {</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      <span class="comment">// Skip the diagonal elements which we&#39;ve already done above</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      <span class="keywordflow">if</span> (j == i) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160; </div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      <span class="comment">// If this parameter isn&#39;t varied</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#a95fa49737432818bc830a44898d0d850">IamVaried</a>[j] == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        (*Covariance)(i,j) = 0.0;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        (*Covariance)(j,i) = (*<a class="code" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a>)(i,j);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        (*Correlation)(i,j) = 0.0;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        (*Correlation)(j,i) = (*<a class="code" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>)(i,j);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      }</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160; </div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      TString Title_j = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      <span class="keywordtype">double</span> Prior_j, PriorError_j;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      <a class="code" href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">GetNthParameter</a>(j, Prior_j, PriorError_j, Title_j);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160; </div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;      <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;      <span class="comment">// The draw which we want to perform</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      TString DrawMe = <a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[j]+<span class="stringliteral">&quot;:&quot;</span>+<a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i];</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;      <span class="comment">// TH2F to hold the Correlation </span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      <span class="keyword">auto</span> hpost_2D = <span class="keyword">new</span> TH2D(DrawMe, DrawMe,</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                      <a class="code" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a>, <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetXaxis()-&gt;GetXmin(), <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetXaxis()-&gt;GetXmax(),</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                      <a class="code" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a>, <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[j]-&gt;GetXaxis()-&gt;GetXmin(), <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[j]-&gt;GetXaxis()-&gt;GetXmax());</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      hpost_2D-&gt;SetMinimum(0);</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      hpost_2D-&gt;GetXaxis()-&gt;SetTitle(Title_i);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      hpost_2D-&gt;GetYaxis()-&gt;SetTitle(Title_j);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      hpost_2D-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Steps&quot;</span>);</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160; </div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;      std::string SelectionStr = <a class="code" href="classMCMCProcessor.html#a576f0eb874afaf7e31ff5c86b9e5b8f9">StepCut</a>;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#a6f27039da3508952600b1ef26e76fe19">ReweightPosterior</a>) {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        SelectionStr = <span class="stringliteral">&quot;(&quot;</span> + <a class="code" href="classMCMCProcessor.html#a576f0eb874afaf7e31ff5c86b9e5b8f9">StepCut</a> + <span class="stringliteral">&quot;)*(&quot;</span> + <a class="code" href="classMCMCProcessor.html#ad56b25b03eb5caab7b2a9c2ebf3ec178">ReweightName</a> + <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;      }</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      <span class="comment">// The draw command we want, i.e. draw param j vs param i</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;      <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;Project(DrawMe, DrawMe, SelectionStr.c_str());</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a682c1c47626542f5820d633ba2bc010c">ApplySmoothing</a>) hpost_2D-&gt;Smooth();</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      <span class="comment">// Get the Covariance for these two parameters</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      (*Covariance)(i,j) = hpost_2D-&gt;GetCovariance();</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      (*Covariance)(j,i) = (*<a class="code" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a>)(i,j);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160; </div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      (*Correlation)(i,j) = hpost_2D-&gt;GetCorrelationFactor();</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      (*Correlation)(j,i) = (*<a class="code" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>)(i,j);</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; </div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>)</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        <span class="comment">//KS: Skip Flux Params</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>[i] == <a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a> &amp;&amp; <a class="code" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>[j] == <a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>)</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        {</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;          <span class="keywordflow">if</span>(std::fabs((*<a class="code" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>)(i,j)) &gt; <a class="code" href="classMCMCProcessor.html#a25e4685b6299181021b02ac0e0b74681">Post2DPlotThreshold</a>)</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;          {</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;            <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;cd();</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            hpost_2D-&gt;Draw(<span class="stringliteral">&quot;colz&quot;</span>);</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;            <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetName(hpost_2D-&gt;GetName());</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetTitle(hpost_2D-&gt;GetTitle());</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;            <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Print(<a class="code" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;            <a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i][j]-&gt;Write(<a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i][j]-&gt;GetTitle());</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;          }</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        }</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      }</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      <span class="comment">// Write it to root file</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      <span class="comment">//OutputFile-&gt;cd();</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <span class="comment">//if( std::fabs((*Correlation)(i,j)) &gt; Post2DPlotThreshold ) hpost_2D-&gt;Write();</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;      <span class="keyword">delete</span> hpost_2D;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    } <span class="comment">// End j loop</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  } <span class="comment">// End i loop</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  PostHistDir-&gt;Close();</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  <span class="keyword">delete</span> PostHistDir;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  <a class="code" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a>-&gt;Write(<span class="stringliteral">&quot;Covariance&quot;</span>);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <a class="code" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>-&gt;Write(<span class="stringliteral">&quot;Correlation&quot;</span>);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab367cb5f56606338bb1fce780f2414e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab367cb5f56606338bb1fce780f2414e8">&#9670;&nbsp;</a></span>MakeCovariance_MP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::MakeCovariance_MP </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>Mute</em> = <code>false</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate covariance by making 2D projection of each combination of parameters using multithreading. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Mute</td><td>Allow silencing many messages, especially important if we calculate matrix many times </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l01180">1180</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                                                     {</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="comment">// *********************</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a> == <span class="keyword">nullptr</span>) <a class="code" href="classMCMCProcessor.html#aa5a7761e97cf2e24c7d877a5374b7333">MakeOutputFile</a>();</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    </div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="classMCMCProcessor.html#aea84f0315695aa05ec41fcf965b1b031">CacheMCMC</a>) <a class="code" href="classMCMCProcessor.html#ace48a54fb08e2a3943d4e2ed1f8c4a4b">CacheSteps</a>();</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  </div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  <span class="keywordtype">bool</span> HaveMadeDiagonal = <span class="keyword">false</span>;    </div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <span class="comment">// Check that the diagonal entries have been filled</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <span class="comment">// i.e. MakePostfit() has been called</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i) {</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="keywordflow">if</span> ((*<a class="code" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a>)(i,i) == <a class="code" href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a>) {</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      HaveMadeDiagonal = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Have not run diagonal elements in covariance, will do so now by calling MakePostfit()&quot;</span>);</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      HaveMadeDiagonal = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    }</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  }</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    </div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  <span class="keywordflow">if</span> (HaveMadeDiagonal == <span class="keyword">false</span>) <a class="code" href="classMCMCProcessor.html#a55f6d14a81943e03bef0ddc47721ce25">MakePostfit</a>();</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  TStopwatch clock;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  TDirectory *PostHistDir = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  <span class="keywordflow">if</span>(!Mute)</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  {</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Calculating covariance matrix&quot;</span>);</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    clock.Start();</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    PostHistDir = <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Post_2d_hists&quot;</span>);</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    PostHistDir-&gt;cd();</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  }</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160; </div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  <span class="keywordflow">if</span>(!Mute)</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160; </div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;  gStyle-&gt;SetPalette(55);</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  <span class="comment">// Now we are sure we have the diagonal elements, let&#39;s make the off-diagonals</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  {    </div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    {</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      <span class="comment">// Skip the diagonal elements which we&#39;ve already done above</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      <span class="keywordflow">if</span> (j == i) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      </div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      <span class="comment">// If this parameter isn&#39;t varied</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#a95fa49737432818bc830a44898d0d850">IamVaried</a>[j] == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        (*Covariance)(i,j) = 0.0;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        (*Covariance)(j,i) = (*<a class="code" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a>)(i,j);</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        (*Correlation)(i,j) = 0.0;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        (*Correlation)(j,i) = (*<a class="code" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>)(i,j);</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;      }</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      <a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i][j]-&gt;SetMinimum(0);</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;          </div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++k)</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      {</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        <span class="comment">//KS: Burn in cut</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a6058bb3e817401423231f85a71db46a0">StepNumber</a>[k] &lt; <a class="code" href="classMCMCProcessor.html#afca259b5bdee2b248d4b1a64ac3e7930">BurnInCut</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160; </div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> Weight = <a class="code" href="classMCMCProcessor.html#a6f27039da3508952600b1ef26e76fe19">ReweightPosterior</a> ? <a class="code" href="classMCMCProcessor.html#a39d4d6d8cfccf1974a6b084f808211a9">WeightValue</a>[i] : 1.;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        <span class="comment">//KS: Fill histogram with cached steps</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        <a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i][j]-&gt;Fill(<a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>[i][k], <a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>[j][k], Weight);</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;      }</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a682c1c47626542f5820d633ba2bc010c">ApplySmoothing</a>) <a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i][j]-&gt;Smooth();</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;      </div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      <span class="comment">// Get the Covariance for these two parameters</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;      (*Covariance)(i,j) = <a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i][j]-&gt;<a class="code" href="classMCMCProcessor.html#ac9e4fdea5d2de92a1abad5b79b7daf88">GetCovariance</a>();</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;      (*Covariance)(j,i) = (*<a class="code" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a>)(i,j);</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160; </div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;      <span class="comment">//KS: Since we already have covariance consider calculating correlation using it, right now we effectively calculate covariance twice</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;      <span class="comment">//https://root.cern.ch/doc/master/TH2_8cxx_source.html#l01099</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;      (*Correlation)(i,j) = <a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i][j]-&gt;GetCorrelationFactor();</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      (*Correlation)(j,i) = (*<a class="code" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>)(i,j);</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    }<span class="comment">// End j loop</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  }<span class="comment">// End i loop</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160; </div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  <span class="keywordflow">if</span>(!Mute) {</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    clock.Stop();</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making Covariance took {:.2f}s to finish for {} steps&quot;</span>, clock.RealTime(), <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>)</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    {</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;cd();</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      {</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        {</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;          <span class="comment">// Skip the diagonal elements which we&#39;ve already done above</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;          <span class="keywordflow">if</span> (j == i) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#a95fa49737432818bc830a44898d0d850">IamVaried</a>[j] == <span class="keyword">false</span>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160; </div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>[i] == <a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a> &amp;&amp; <a class="code" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>[j] == <a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>)</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;          {</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;            <span class="keywordflow">if</span>(std::fabs((*<a class="code" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>)(i,j)) &gt; <a class="code" href="classMCMCProcessor.html#a25e4685b6299181021b02ac0e0b74681">Post2DPlotThreshold</a>)</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;            {</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;              <a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i][j]-&gt;Draw(<span class="stringliteral">&quot;colz&quot;</span>);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;              <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetName(<a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i][j]-&gt;GetName());</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;              <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetTitle(<a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i][j]-&gt;GetTitle());</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;              <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Print(<a class="code" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;              <a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i][j]-&gt;Write(<a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i][j]-&gt;GetTitle());</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;            }</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;          }</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;          <span class="comment">//if( std::fabs((*Correlation)(i,j)) &gt; Post2DPlotThreshold) hpost2D[i][j]-&gt;Write();</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        }<span class="comment">// End j loop</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;      }<span class="comment">// End i loop</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    } <span class="comment">//end if pdf</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    PostHistDir-&gt;Close();</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="keyword">delete</span> PostHistDir;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <a class="code" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a>-&gt;Write(<span class="stringliteral">&quot;Covariance&quot;</span>);</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <a class="code" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>-&gt;Write(<span class="stringliteral">&quot;Correlation&quot;</span>);</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  } <span class="comment">// end if not mute</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;}</div>
<div class="ttc" id="aclassMCMCProcessor_html_ac9e4fdea5d2de92a1abad5b79b7daf88"><div class="ttname"><a href="classMCMCProcessor.html#ac9e4fdea5d2de92a1abad5b79b7daf88">MCMCProcessor::GetCovariance</a></div><div class="ttdeci">void GetCovariance(TMatrixDSym *&amp;Cov, TMatrixDSym *&amp;Corr)</div><div class="ttdoc">Get the post-fit covariances and correlations.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l00185">MCMCProcessor.cpp:185</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ace48a54fb08e2a3943d4e2ed1f8c4a4b"><div class="ttname"><a href="classMCMCProcessor.html#ace48a54fb08e2a3943d4e2ed1f8c4a4b">MCMCProcessor::CacheSteps</a></div><div class="ttdeci">void CacheSteps()</div><div class="ttdoc">KS:By caching each step we use multithreading.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l01054">MCMCProcessor.cpp:1054</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afae102a167a1fb7995729af7e7c2fb19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afae102a167a1fb7995729af7e7c2fb19">&#9670;&nbsp;</a></span>MakeCovarianceYAML()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::MakeCovarianceYAML </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>OutputYAMLFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>MeansMethod</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make YAML file from post-fit covariance. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l01462">1462</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                                                                                                          {</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;<span class="comment">// *********************</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making covariance matrix YAML file&quot;</span>);</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160; </div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">ParamNames</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>].size() != <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>)) {</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Using Legacy Parameters i.e. not one from Parameter Handler Generic, this will not work&quot;</span>);</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  }</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;  std::vector&lt;double&gt; MeanArray(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;  std::vector&lt;double&gt; ErrorArray(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;  std::vector&lt;std::vector&lt;double&gt;&gt; CorrelationMatrix(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, std::vector&lt;double&gt;(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0.0));</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160; </div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;  TVectorD* means_vec;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  TVectorD* errors_vec;</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160; </div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  <span class="keywordflow">if</span> (MeansMethod == <span class="stringliteral">&quot;Arithmetic&quot;</span>) {</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    means_vec = <a class="code" href="classMCMCProcessor.html#acaf7f239136dfa3506d095b612323d0a">Means</a>;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    errors_vec = <a class="code" href="classMCMCProcessor.html#a5174aaa900edf16ddc6e841ea4adae83">Errors</a>;</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (MeansMethod == <span class="stringliteral">&quot;Gaussian&quot;</span>) {</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    means_vec = <a class="code" href="classMCMCProcessor.html#a600fc8c39af2750df91fb7a0ff85ac74">Means_Gauss</a>;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    errors_vec = <a class="code" href="classMCMCProcessor.html#aa78b7ed1bb9966f84f4eaf8cedf5e688">Errors_Gauss</a>;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (MeansMethod == <span class="stringliteral">&quot;HPD&quot;</span>) {</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    means_vec = <a class="code" href="classMCMCProcessor.html#a32657dc39a7fc0d04804f6195a3d8c3e">Means_HPD</a>;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    errors_vec = <a class="code" href="classMCMCProcessor.html#abb5c6ad85c89227bbb9bc5de2eb71272">Errors_HPD</a>;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Unknown means method: {}, should be either &#39;Arithmetic&#39;, &#39;Gaussian&#39;, or &#39;HPD&#39;.&quot;</span>, MeansMethod);</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  }</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160; </div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  <span class="comment">//Make vectors of mean, error, and correlations</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; i++)</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;  {</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    MeanArray[i]  = (*means_vec)(i);</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    ErrorArray[i] = (*errors_vec)(i);</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; j++)</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    {</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;      CorrelationMatrix[i][j] = (*Correlation)(i,j);</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;      <span class="keywordflow">if</span>(i != j) CorrelationMatrix[j][i] = (*Correlation)(i,j);</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    }</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  }</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160; </div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  <span class="comment">//Make std::string param name vector</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  std::vector&lt;std::string&gt; ParamStrings(<a class="code" href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">ParamNames</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>].size());</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">ParamNames</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>].size(); ++i) {</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    ParamStrings[i] = <span class="keyword">static_cast&lt;</span>std::string<span class="keyword">&gt;</span>(<a class="code" href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">ParamNames</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>][i]);</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;  }</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160; </div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;  YAML::Node XSecFile = <a class="code" href="classMCMCProcessor.html#a4c1330a025c0b91e382bdc29c960424a">CovConfig</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>];</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  <a class="code" href="namespaceM3.html#a8db7c365e6cff53f8dbfa681fb8bacca">M3::MakeCorrelationMatrix</a>(XSecFile, MeanArray, ErrorArray, CorrelationMatrix, OutputYAMLFile, ParamStrings);</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;}</div>
<div class="ttc" id="anamespaceM3_html_a8db7c365e6cff53f8dbfa681fb8bacca"><div class="ttname"><a href="namespaceM3.html#a8db7c365e6cff53f8dbfa681fb8bacca">M3::MakeCorrelationMatrix</a></div><div class="ttdeci">void MakeCorrelationMatrix(YAML::Node &amp;root, const std::vector&lt; double &gt; &amp;Values, const std::vector&lt; double &gt; &amp;Errors, const std::vector&lt; std::vector&lt; double &gt;&gt; &amp;Correlation, const std::string &amp;OutYAMLName, const std::vector&lt; std::string &gt; &amp;FancyNames={})</div><div class="ttdoc">KS: Replace correlation matrix and tune values in YAML covariance matrix.</div><div class="ttdef"><b>Definition:</b> <a href="ParameterHandlerUtils_8h_source.html#l00268">ParameterHandlerUtils.h:268</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a17c0f09bfce82d1701a83645f748988a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17c0f09bfce82d1701a83645f748988a">&#9670;&nbsp;</a></span>MakeCredibleIntervals()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::MakeCredibleIntervals </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>CredibleIntervals</em> = <code>{0.99,&#160;0.90,&#160;0.68&#160;}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Color_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>CredibleIntervalsColours</em> = <code>{kCyan+4,&#160;kCyan-2,&#160;kCyan-10}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>CredibleInSigmas</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make and Draw Credible intervals. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CredibleIntervals</td><td>Vector with values of credible intervals, must be in descending order </td></tr>
    <tr><td class="paramname">CredibleIntervalsColours</td><td>Color_t telling what colour to use for each Interval line </td></tr>
    <tr><td class="paramname">CredibleInSigmas</td><td>Bool telling whether intervals are in percentage or in sigmas, then special conversions is used </td></tr>
  </table>
  </dd>
</dl>
<p>Scale the histograms so it shows the posterior probability</p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l00683">683</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                                                                       {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">// *********************</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[0] == <span class="keyword">nullptr</span>) <a class="code" href="classMCMCProcessor.html#a55f6d14a81943e03bef0ddc47721ce25">MakePostfit</a>();</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Starting {}&quot;</span>, __func__);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> LeftMargin = <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;GetLeftMargin();</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetLeftMargin(0.15);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="comment">// KS: Sanity check of size and ordering is correct</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <a class="code" href="classMCMCProcessor.html#aa7db7e3aa4403a239b8b2b865cea91f6">CheckCredibleIntervalsOrder</a>(CredibleIntervals, CredibleIntervalsColours);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> nCredible = int(CredibleIntervals.size());</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  std::vector&lt;std::unique_ptr&lt;TH1D&gt;&gt; hpost_copy(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  std::vector&lt;std::vector&lt;std::unique_ptr&lt;TH1D&gt;&gt;&gt; hpost_cl(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="comment">//KS: Copy all histograms to be thread safe</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  {</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    hpost_copy[i] = M3::Clone&lt;TH1D&gt;(<a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i], Form(<span class="stringliteral">&quot;hpost_copy_%i&quot;</span>, i));</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    hpost_cl[i].resize(nCredible);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nCredible; ++j)</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    {</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      hpost_cl[i][j] = M3::Clone&lt;TH1D&gt;(<a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i], Form(<span class="stringliteral">&quot;hpost_copy_%i_CL_%f&quot;</span>, i, CredibleIntervals[j]));</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      <span class="comment">//KS: Reset to get rid to TF1 otherwise we run into segfault :(</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      hpost_cl[i][j]-&gt;Reset(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      hpost_cl[i][j]-&gt;Fill(0.0, 0.0);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    }</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  }</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  {</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    hpost_copy[i]-&gt;Scale(1. / hpost_copy[i]-&gt;Integral());</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nCredible; ++j)</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    {</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      <span class="comment">// Scale the histograms before gettindg credible intervals</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      hpost_cl[i][j]-&gt;Scale(1. / hpost_cl[i][j]-&gt;Integral());</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      <a class="code" href="StatisticalUtils_8cpp.html#a83d228a56830a0b5800ac956216c424b">GetCredibleIntervalSig</a>(hpost_copy[i], hpost_cl[i][j], CredibleInSigmas, CredibleIntervals[j]);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;      hpost_cl[i][j]-&gt;SetFillColor(CredibleIntervalsColours[j]);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;      hpost_cl[i][j]-&gt;SetLineWidth(1);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    }</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    hpost_copy[i]-&gt;GetYaxis()-&gt;SetTitleOffset(1.8);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    hpost_copy[i]-&gt;SetLineWidth(1);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    hpost_copy[i]-&gt;SetMaximum(hpost_copy[i]-&gt;GetMaximum()*1.2);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    hpost_copy[i]-&gt;SetLineWidth(2);</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    hpost_copy[i]-&gt;SetLineColor(kBlack);</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    hpost_copy[i]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Posterior Probability&quot;</span>);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  }</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  TDirectory *CredibleDir = <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Credible&quot;</span>);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160; </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  {</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="classMCMCProcessor.html#a95fa49737432818bc830a44898d0d850">IamVaried</a>[i]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160; </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="comment">// Now make the TLine for the Asimov</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="keywordtype">double</span> Prior = 1.0, PriorError = 1.0;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <a class="code" href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">GetNthParameter</a>(i, Prior, PriorError, Title);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="keyword">auto</span> Asimov = std::make_unique&lt;TLine&gt;(Prior, hpost_copy[i]-&gt;GetMinimum(), Prior, hpost_copy[i]-&gt;GetMaximum());</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <a class="code" href="classMCMCProcessor.html#ac0763bc26066a8cf7ea00148eb45af7a">SetTLineStyle</a>(Asimov.get(), kRed-3, 2, kDashed);</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="keyword">auto</span> legend = std::make_unique&lt;TLegend&gt;(0.20, 0.7, 0.4, 0.92);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <a class="code" href="classMCMCProcessor.html#a704afa8c216722e730be2c2a33b594f0">SetLegendStyle</a>(legend.get(), 0.03);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    hpost_copy[i]-&gt;Draw(<span class="stringliteral">&quot;HIST&quot;</span>);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160; </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nCredible; ++j)</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        hpost_cl[i][j]-&gt;Draw(<span class="stringliteral">&quot;HIST SAME&quot;</span>);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = nCredible-1; j &gt;= 0; --j)</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    {</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      <span class="keywordflow">if</span>(CredibleInSigmas)</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        legend-&gt;AddEntry(hpost_cl[i][j].get(), Form(<span class="stringliteral">&quot;%.0f#sigma Credible Interval&quot;</span>, CredibleIntervals[j]), <span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        legend-&gt;AddEntry(hpost_cl[i][j].get(), Form(<span class="stringliteral">&quot;%.0f%% Credible Interval&quot;</span>, CredibleIntervals[j]*100), <span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    }</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    legend-&gt;AddEntry(Asimov.get(), Form(<span class="stringliteral">&quot;#splitline{Prior}{x = %.2f , #sigma = %.2f}&quot;</span>, Prior, PriorError), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    legend-&gt;Draw(<span class="stringliteral">&quot;SAME&quot;</span>);</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    Asimov-&gt;Draw(<span class="stringliteral">&quot;SAME&quot;</span>);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="comment">// Write to file</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetName(<a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetName());</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetTitle(<a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetTitle());</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Print(<a class="code" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="comment">// cd into directory in root file</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    CredibleDir-&gt;cd();</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Write();</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  }</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  CredibleDir-&gt;Close();</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <span class="keyword">delete</span> CredibleDir;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160; </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <span class="comment">//Set back to normal</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetLeftMargin(LeftMargin);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;}</div>
<div class="ttc" id="aStatisticalUtils_8cpp_html_a83d228a56830a0b5800ac956216c424b"><div class="ttname"><a href="StatisticalUtils_8cpp.html#a83d228a56830a0b5800ac956216c424b">GetCredibleIntervalSig</a></div><div class="ttdeci">void GetCredibleIntervalSig(const std::unique_ptr&lt; TH1D &gt; &amp;hist, std::unique_ptr&lt; TH1D &gt; &amp;hpost_copy, const bool CredibleInSigmas, const double coverage)</div><div class="ttdoc">KS: Get 1D histogram within credible interval, hpost_copy has to have the same binning,...</div><div class="ttdef"><b>Definition:</b> <a href="StatisticalUtils_8cpp_source.html#l00374">StatisticalUtils.cpp:374</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aa7db7e3aa4403a239b8b2b865cea91f6"><div class="ttname"><a href="classMCMCProcessor.html#aa7db7e3aa4403a239b8b2b865cea91f6">MCMCProcessor::CheckCredibleIntervalsOrder</a></div><div class="ttdeci">void CheckCredibleIntervalsOrder(const std::vector&lt; double &gt; &amp;CredibleIntervals, const std::vector&lt; Color_t &gt; &amp;CredibleIntervalsColours) const</div><div class="ttdoc">Checks the order and size consistency of the CredibleIntervals and CredibleIntervalsColours vectors.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l04514">MCMCProcessor.cpp:4514</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ac0763bc26066a8cf7ea00148eb45af7a"><div class="ttname"><a href="classMCMCProcessor.html#ac0763bc26066a8cf7ea00148eb45af7a">MCMCProcessor::SetTLineStyle</a></div><div class="ttdeci">void SetTLineStyle(TLine *Line, const Color_t Colour, const Width_t Width, const ELineStyle Style) const</div><div class="ttdoc">Configures a TLine object with the specified style parameters.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l04620">MCMCProcessor.cpp:4620</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a570d38cc55c2d75e3313c0e621f0ecab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a570d38cc55c2d75e3313c0e621f0ecab">&#9670;&nbsp;</a></span>MakeCredibleRegions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::MakeCredibleRegions </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>CredibleRegions</em> = <code>{0.99,&#160;0.90,&#160;0.68}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Style_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>CredibleRegionStyle</em> = <code>{kDashed,&#160;kSolid,&#160;kDotted}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Color_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>CredibleRegionColor</em> = <code>{kGreen-3,&#160;kGreen-10,&#160;kGreen}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>CredibleInSigmas</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>Draw2DPosterior</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>DrawBestFit</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make and Draw Credible Regions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CredibleRegions</td><td>Vector with values of credible intervals, must be in descending order </td></tr>
    <tr><td class="paramname">CredibleRegionStyle</td><td>Style_t telling what line style to use for each Interval line </td></tr>
    <tr><td class="paramname">CredibleRegionColor</td><td>Color_t telling what colour to use for each Interval line </td></tr>
    <tr><td class="paramname">CredibleInSigmas</td><td>Bool telling whether intervals are in percentage or in sigmas, then special conversions is used </td></tr>
    <tr><td class="paramname">Draw2DPosterior</td><td>Bool telling whether to draw the 2D posterior distributions </td></tr>
    <tr><td class="paramname">DrawBestFit</td><td>Bool telling whether to draw the best-fit point on the plots </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l01763">1763</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;                                                                {</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;<span class="comment">// *********************</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>.size() == 0) <a class="code" href="classMCMCProcessor.html#ab367cb5f56606338bb1fce780f2414e8">MakeCovariance_MP</a>();</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making Credible Regions&quot;</span>);</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160; </div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;  <a class="code" href="classMCMCProcessor.html#ab11b70175cd1e63722942a063192968a">CheckCredibleRegionsOrder</a>(CredibleRegions, CredibleRegionStyle, CredibleRegionColor);</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> nCredible = int(CredibleRegions.size());</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160; </div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;  std::vector&lt;std::vector&lt;std::unique_ptr&lt;TH2D&gt;&gt;&gt; hpost_2D_copy(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;  std::vector&lt;std::vector&lt;std::vector&lt;std::unique_ptr&lt;TH2D&gt;&gt;&gt;&gt; hpost_2D_cl(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;  <span class="comment">//KS: Copy all histograms to be thread safe</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;  {</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    hpost_2D_copy[i].resize(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    hpost_2D_cl[i].resize(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    {</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;      hpost_2D_copy[i][j] = M3::Clone&lt;TH2D&gt;(<a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i][j], Form(<span class="stringliteral">&quot;hpost_copy_%i_%i&quot;</span>, i, j));</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;      hpost_2D_cl[i][j].resize(nCredible);</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nCredible; ++k)</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;      {</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;        hpost_2D_cl[i][j][k] = M3::Clone&lt;TH2D&gt;(<a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i][j], Form(<span class="stringliteral">&quot;hpost_copy_%i_%i_CL_%f&quot;</span>, i, j, CredibleRegions[k]));</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;      }</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    }</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;  }</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160; </div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;<span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;  <span class="comment">//Calculate credible histogram</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;  {</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    {</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nCredible; ++k)</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;      {</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;        <a class="code" href="StatisticalUtils_8cpp.html#ab0babebde48f51680e675beaa1dd8c33">GetCredibleRegionSig</a>(hpost_2D_cl[i][j][k], CredibleInSigmas, CredibleRegions[k]);</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;        hpost_2D_cl[i][j][k]-&gt;SetLineColor(CredibleRegionColor[k]);</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;        hpost_2D_cl[i][j][k]-&gt;SetLineWidth(2);</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;        hpost_2D_cl[i][j][k]-&gt;SetLineStyle(CredibleRegionStyle[k]);</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;      }</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    }</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;  }</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160; </div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;  gStyle-&gt;SetPalette(51);</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;  {    </div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    {</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;      <span class="comment">// Skip the diagonal elements which we&#39;ve already done above</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;      <span class="keywordflow">if</span> (j == i) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#a95fa49737432818bc830a44898d0d850">IamVaried</a>[j] == <span class="keyword">false</span>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160; </div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;      <span class="keyword">auto</span> legend = std::make_unique&lt;TLegend&gt;(0.20, 0.7, 0.4, 0.92);</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;      legend-&gt;SetTextColor(kRed);</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;      <a class="code" href="classMCMCProcessor.html#a704afa8c216722e730be2c2a33b594f0">SetLegendStyle</a>(legend.get(), 0.03);</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160; </div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;      <span class="comment">//Get Best point</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;      <span class="keyword">auto</span> bestfitM = std::make_unique&lt;TGraph&gt;(1);</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> MaxBin = hpost_2D_copy[i][j]-&gt;GetMaximumBin();</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;      <span class="keywordtype">int</span> Mbx, Mby, Mbz;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;      hpost_2D_copy[i][j]-&gt;GetBinXYZ(MaxBin, Mbx, Mby, Mbz);</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> Mx = hpost_2D_copy[i][j]-&gt;GetXaxis()-&gt;GetBinCenter(Mbx);</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> My = hpost_2D_copy[i][j]-&gt;GetYaxis()-&gt;GetBinCenter(Mby);</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160; </div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;      bestfitM-&gt;SetPoint(0, Mx, My);</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;      bestfitM-&gt;SetMarkerStyle(22);</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;      bestfitM-&gt;SetMarkerSize(1);</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;      bestfitM-&gt;SetMarkerColor(kMagenta);</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    </div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;      <span class="comment">//Plot default 2D posterior</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160; </div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;      <span class="keywordflow">if</span>(Draw2DPosterior){</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;        hpost_2D_copy[i][j]-&gt;Draw(<span class="stringliteral">&quot;COLZ&quot;</span>);</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;      } <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;        hpost_2D_copy[i][j]-&gt;Draw(<span class="stringliteral">&quot;AXIS&quot;</span>);</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;      }</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160; </div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;      <span class="comment">//Now credible regions</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nCredible; ++k)</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;        hpost_2D_cl[i][j][k]-&gt;Draw(<span class="stringliteral">&quot;CONT3 SAME&quot;</span>);</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = nCredible-1; k &gt;= 0; --k)</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;      {</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;        <span class="keywordflow">if</span>(CredibleInSigmas)</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;          legend-&gt;AddEntry(hpost_2D_cl[i][j][k].get(), Form(<span class="stringliteral">&quot;%.0f#sigma Credible Interval&quot;</span>, CredibleRegions[k]), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;          legend-&gt;AddEntry(hpost_2D_cl[i][j][k].get(), Form(<span class="stringliteral">&quot;%.0f%% Credible Region&quot;</span>, CredibleRegions[k]*100), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;      }</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;      legend-&gt;Draw(<span class="stringliteral">&quot;SAME&quot;</span>);</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;  </div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="keywordflow">if</span>(DrawBestFit){</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;      legend-&gt;AddEntry(bestfitM.get(),<span class="stringliteral">&quot;Best Fit&quot;</span>,<span class="stringliteral">&quot;p&quot;</span>);</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;      bestfitM-&gt;Draw(<span class="stringliteral">&quot;SAME.P&quot;</span>);</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;     }</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160; </div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;      <span class="comment">// Write to file</span></div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;      <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetName(<a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i][j]-&gt;GetName());</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;      <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetTitle(<a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i][j]-&gt;GetTitle());</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;      </div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;      <span class="comment">//KS: Print only regions with correlation greater than specified value, by default 0.2. This is done to avoid dumping thousands of plots</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a> &amp;&amp; std::fabs((*<a class="code" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>)(i,j)) &gt; <a class="code" href="classMCMCProcessor.html#a25e4685b6299181021b02ac0e0b74681">Post2DPlotThreshold</a>) <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Print(<a class="code" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;      <span class="comment">// Write it to root file</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;      <span class="comment">//OutputFile-&gt;cd();</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;      <span class="comment">//if( std::fabs((*Correlation)(i,j)) &gt; Post2DPlotThreshold ) Posterior-&gt;Write();</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    }</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;  }</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160; </div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;}</div>
<div class="ttc" id="aStatisticalUtils_8cpp_html_ab0babebde48f51680e675beaa1dd8c33"><div class="ttname"><a href="StatisticalUtils_8cpp.html#ab0babebde48f51680e675beaa1dd8c33">GetCredibleRegionSig</a></div><div class="ttdeci">void GetCredibleRegionSig(std::unique_ptr&lt; TH2D &gt; &amp;hist2D, const bool CredibleInSigmas, const double coverage)</div><div class="ttdoc">KS: Set 2D contour within some coverage.</div><div class="ttdef"><b>Definition:</b> <a href="StatisticalUtils_8cpp_source.html#l00438">StatisticalUtils.cpp:438</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ab11b70175cd1e63722942a063192968a"><div class="ttname"><a href="classMCMCProcessor.html#ab11b70175cd1e63722942a063192968a">MCMCProcessor::CheckCredibleRegionsOrder</a></div><div class="ttdeci">void CheckCredibleRegionsOrder(const std::vector&lt; double &gt; &amp;CredibleRegions, const std::vector&lt; Style_t &gt; &amp;CredibleRegionStyle, const std::vector&lt; Color_t &gt; &amp;CredibleRegionColor)</div><div class="ttdoc">Checks the order and size consistency of the CredibleRegions, CredibleRegionStyle,...</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l04533">MCMCProcessor.cpp:4533</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa5a7761e97cf2e24c7d877a5374b7333"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5a7761e97cf2e24c7d877a5374b7333">&#9670;&nbsp;</a></span>MakeOutputFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::MakeOutputFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>prepare output root file and canvas to which we will save EVERYTHING </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l00194">194</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                   {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">// ***************</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="comment">//KS: ROOT hates me... but we can create several instances of MCMC Processor, each with own TCanvas ROOT is mad and will delete if there is more than one canvas with the same name, so we add random number to avoid issue</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keyword">auto</span> rand = std::make_unique&lt;TRandom3&gt;(0);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> uniform = int(rand-&gt;Uniform(0, 10000));</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="comment">// Open a TCanvas to write the posterior onto</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a> = std::make_unique&lt;TCanvas&gt;((<span class="stringliteral">&quot;Posterior&quot;</span> + std::to_string(uniform)).c_str(), (<span class="stringliteral">&quot;Posterior&quot;</span> + std::to_string(uniform)).c_str(), 0, 0, 1024, 1024);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">//KS: No idea why but ROOT changed treatment of violin in R6. If you have non uniform binning this will results in very hard to see violin plots.</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  TCandle::SetScaledViolin(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetGrid();</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  gStyle-&gt;SetOptStat(0);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  gStyle-&gt;SetOptTitle(0);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetTickx();</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetTicky();</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetBottomMargin(0.1);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetTopMargin(0.05);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetRightMargin(0.03);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetLeftMargin(0.15);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="comment">//To avoid TCanvas::Print&gt; messages</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  gErrorIgnoreLevel = kWarning;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="comment">// Output file to write to</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <a class="code" href="classMCMCProcessor.html#a3d17c1720b91d6d0361da0b5dabfbbff">OutputName</a> = <a class="code" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a> + <a class="code" href="classMCMCProcessor.html#aa34b50ce33fb2cb7d9e9ef2d9f2f67c1">OutputSuffix</a> +<span class="stringliteral">&quot;.root&quot;</span>;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="comment">// Output file</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a> = <a class="code" href="namespaceM3.html#a87841bdbf0e0a2a733d9e4ca499f820d">M3::Open</a>(<a class="code" href="classMCMCProcessor.html#a3d17c1720b91d6d0361da0b5dabfbbff">OutputName</a>, <span class="stringliteral">&quot;recreate&quot;</span>, __FILE__, __LINE__);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a3d17c1720b91d6d0361da0b5dabfbbff"><div class="ttname"><a href="classMCMCProcessor.html#a3d17c1720b91d6d0361da0b5dabfbbff">MCMCProcessor::OutputName</a></div><div class="ttdeci">std::string OutputName</div><div class="ttdoc">Name of output files.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00482">MCMCProcessor.h:482</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a55f6d14a81943e03bef0ddc47721ce25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55f6d14a81943e03bef0ddc47721ce25">&#9670;&nbsp;</a></span>MakePostfit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::MakePostfit </td>
          <td>(</td>
          <td class="paramtype">const std::map&lt; std::string, std::pair&lt; double, double &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>Edges</em> = <code>{}</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make 1D projection for each parameter and prepare structure. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l00228">228</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                                                                                       {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">// ****************************</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="comment">// Check if we&#39;ve already made post-fit</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#aecc35d4ea7d2c7e020e50388ba0ffb64">MadePostfit</a> == <span class="keyword">true</span>) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <a class="code" href="classMCMCProcessor.html#aecc35d4ea7d2c7e020e50388ba0ffb64">MadePostfit</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="comment">// Check if the output file is ready</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a> == <span class="keyword">nullptr</span>) <a class="code" href="classMCMCProcessor.html#aa5a7761e97cf2e24c7d877a5374b7333">MakeOutputFile</a>();</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;MCMCProcessor is making post-fit plots...&quot;</span>);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordtype">int</span> originalErrorLevel = gErrorIgnoreLevel;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  gErrorIgnoreLevel = kFatal;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="comment">// Directory for posteriors</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  TDirectory *PostDir = <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Post&quot;</span>);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  TDirectory *PostHistDir = <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Post_1d_hists&quot;</span>);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="comment">//KS: Apply additional Cuts, like mass ordering</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  std::string CutPosterior1D = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a85917e25c4f5b5b966c50cccd9ddd6a0">Posterior1DCut</a> != <span class="stringliteral">&quot;&quot;</span>) {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    CutPosterior1D = <a class="code" href="classMCMCProcessor.html#a576f0eb874afaf7e31ff5c86b9e5b8f9">StepCut</a> +<span class="stringliteral">&quot; &amp;&amp; &quot;</span> + <a class="code" href="classMCMCProcessor.html#a85917e25c4f5b5b966c50cccd9ddd6a0">Posterior1DCut</a>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  } <span class="keywordflow">else</span> CutPosterior1D = <a class="code" href="classMCMCProcessor.html#a576f0eb874afaf7e31ff5c86b9e5b8f9">StepCut</a>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="comment">// Apply reweighting</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#a6f27039da3508952600b1ef26e76fe19">ReweightPosterior</a>) {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    CutPosterior1D = <span class="stringliteral">&quot;(&quot;</span> + CutPosterior1D + <span class="stringliteral">&quot;)*(&quot;</span> + <a class="code" href="classMCMCProcessor.html#ad56b25b03eb5caab7b2a9c2ebf3ec178">ReweightName</a> + <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a>(<span class="stringliteral">&quot;Using following cut {}&quot;</span>, CutPosterior1D);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="comment">// nDraw is number of draws we want to do</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">if</span> (i % (<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>/5) == 0) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <a class="code" href="namespaceMaCh3Utils.html#a4c8bdeb1d34606aed192e9f1311a72f5">MaCh3Utils::PrintProgressBar</a>(i, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordtype">double</span> Prior = 1.0, PriorError = 1.0;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">GetNthParameter</a>(i, Prior, PriorError, Title);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">// Get bin edges for histograms</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordtype">double</span> maxi, mini = <a class="code" href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">if</span> (Edges.find(Title.Data()) != Edges.end()) {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      mini = Edges.at(Title.Data()).first;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      maxi = Edges.at(Title.Data()).second;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      maxi = <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMaximum(<a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i]);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      mini = <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMinimum(<a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i]);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a>(<span class="stringliteral">&quot;Initialising histogram for {} with binning {:.4f}, {:.4f}&quot;</span>, Title, mini, maxi);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">// This holds the posterior density</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">// KS: WARNING do NOT SetDirectory(nullptr) this will cause issue with Project()</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">// I know is tempting to avoid ROOT memory management but please do not.</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i] = <span class="keyword">new</span> TH1D(<a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i], <a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i], <a class="code" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a>, mini, maxi);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;SetMinimum(0);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Steps&quot;</span>);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetYaxis()-&gt;SetNoExponent(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">// Project BranchNames[i] onto hpost, applying stepcut</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;Project(<a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i], <a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i], CutPosterior1D.c_str());</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a682c1c47626542f5820d633ba2bc010c">ApplySmoothing</a>) <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;Smooth();</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    (*Central_Value)(i) = Prior;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a>, Err, Err_p, Err_m;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <a class="code" href="StatisticalUtils_8cpp.html#ab4dc9e4455015e55031e2cc8a076349d">GetArithmetic</a>(<a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i], <a class="code" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a>, Err);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    (*Means)(i) = <a class="code" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    (*Errors)(i) = Err;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <a class="code" href="StatisticalUtils_8cpp.html#a7237fc819d10a341c286a5597f584a96">GetGaussian</a>(<a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i], <a class="code" href="classMCMCProcessor.html#a20ee00d448413b8a2653b252d70e88b3">Gauss</a>.get(), <a class="code" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a>, Err);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    (*Means_Gauss)(i) = <a class="code" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    (*Errors_Gauss)(i) = Err;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="code" href="StatisticalUtils_8cpp.html#aaf9d02010c94cac104e7987880adfb24">GetHPD</a>(<a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i], <a class="code" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a>, Err, Err_p, Err_m);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    (*Means_HPD)(i) = <a class="code" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    (*Errors_HPD)(i) = Err;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    (*Errors_HPD_Positive)(i) = Err_p;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    (*Errors_HPD_Negative)(i) = Err_m;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">// Write the results from the projection into the TVectors and TMatrices</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    (*Covariance)(i,i) = (*<a class="code" href="classMCMCProcessor.html#a5174aaa900edf16ddc6e841ea4adae83">Errors</a>)(i)*(*<a class="code" href="classMCMCProcessor.html#a5174aaa900edf16ddc6e841ea4adae83">Errors</a>)(i);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    (*Correlation)(i,i) = 1.0;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">//KS: This need to be before SetMaximum(), this way plot is nicer as line end at the maximum</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keyword">auto</span> hpd = std::make_unique&lt;TLine&gt;((*<a class="code" href="classMCMCProcessor.html#a32657dc39a7fc0d04804f6195a3d8c3e">Means_HPD</a>)(i), <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetMinimum(), (*<a class="code" href="classMCMCProcessor.html#a32657dc39a7fc0d04804f6195a3d8c3e">Means_HPD</a>)(i), <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetMaximum());</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="classMCMCProcessor.html#ac0763bc26066a8cf7ea00148eb45af7a">SetTLineStyle</a>(hpd.get(), kBlack, 2, kSolid);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;SetLineWidth(2);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;SetLineColor(kBlue-1);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;SetMaximum(<a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetMaximum()*<a class="code" href="classMCMCProcessor.html#a4abe633b264acd9b0459c7b8ccd8b9df">DrawRange</a>);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;SetTitle(Title);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetXaxis()-&gt;SetTitle(<a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetTitle());</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">// Now make the TLine for the Asimov</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keyword">auto</span> Asimov = std::make_unique&lt;TLine&gt;(Prior, <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetMinimum(), Prior, <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetMaximum());</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <a class="code" href="classMCMCProcessor.html#ac0763bc26066a8cf7ea00148eb45af7a">SetTLineStyle</a>(Asimov.get(), kRed-3, 2, kDashed);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keyword">auto</span> leg = std::make_unique&lt;TLegend&gt;(0.12, 0.6, 0.6, 0.97);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <a class="code" href="classMCMCProcessor.html#a704afa8c216722e730be2c2a33b594f0">SetLegendStyle</a>(leg.get(), 0.04);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    leg-&gt;AddEntry(<a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i], Form(<span class="stringliteral">&quot;#splitline{PDF}{#mu = %.2f, #sigma = %.2f}&quot;</span>, <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetMean(), <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetRMS()), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    leg-&gt;AddEntry(<a class="code" href="classMCMCProcessor.html#a20ee00d448413b8a2653b252d70e88b3">Gauss</a>.get(), Form(<span class="stringliteral">&quot;#splitline{Gauss}{#mu = %.2f, #sigma = %.2f}&quot;</span>, <a class="code" href="classMCMCProcessor.html#a20ee00d448413b8a2653b252d70e88b3">Gauss</a>-&gt;GetParameter(1), <a class="code" href="classMCMCProcessor.html#a20ee00d448413b8a2653b252d70e88b3">Gauss</a>-&gt;GetParameter(2)), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    leg-&gt;AddEntry(hpd.get(), Form(<span class="stringliteral">&quot;#splitline{HPD}{#mu = %.2f, #sigma = %.2f (+%.2f-%.2f)}&quot;</span>, (*<a class="code" href="classMCMCProcessor.html#a32657dc39a7fc0d04804f6195a3d8c3e">Means_HPD</a>)(i), (*<a class="code" href="classMCMCProcessor.html#abb5c6ad85c89227bbb9bc5de2eb71272">Errors_HPD</a>)(i), (*<a class="code" href="classMCMCProcessor.html#af96664fa8cc51c49ad1385da07a343b8">Errors_HPD_Positive</a>)(i), (*<a class="code" href="classMCMCProcessor.html#a7b85df39f22390dac24f4d66a89518e5">Errors_HPD_Negative</a>)(i)), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    leg-&gt;AddEntry(Asimov.get(), Form(<span class="stringliteral">&quot;#splitline{Prior}{x = %.2f , #sigma = %.2f}&quot;</span>, Prior, PriorError), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">// Write to file</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetName(Title);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetTitle(Title);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">//CW: Don&#39;t plot if this is a fixed histogram (i.e. the peak is the whole integral)</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetMaximum() == <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;Integral()*<a class="code" href="classMCMCProcessor.html#a4abe633b264acd9b0459c7b8ccd8b9df">DrawRange</a>) </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Found fixed parameter: {} ({}), moving on&quot;</span>, Title, i);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <a class="code" href="classMCMCProcessor.html#a95fa49737432818bc830a44898d0d850">IamVaried</a>[i] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="comment">//KS:Set mean and error to prior for fixed parameters, it looks much better when fixed parameter has mean on prior rather than on 0 with 0 error.</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      (*Means_HPD)(i)  = Prior;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      (*Errors_HPD)(i) = PriorError;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      (*Errors_HPD_Positive)(i)  = PriorError;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      (*Errors_HPD_Negative)(i) = PriorError;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      (*Means_Gauss)(i)  = Prior;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      (*Errors_Gauss)(i) = PriorError;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      (*Means)(i)  = Prior;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      (*Errors)(i) = PriorError;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">// Store that this parameter is indeed being varied</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="classMCMCProcessor.html#a95fa49737432818bc830a44898d0d850">IamVaried</a>[i] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">// Draw onto the TCanvas</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;Draw();</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    hpd-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    Asimov-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    leg-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);  </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Print(<a class="code" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">// cd into params directory in root file</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    PostDir-&gt;cd();</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Write();</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;SetName(Title);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;SetTitle(Title);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    PostHistDir-&gt;cd();</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;Write();</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  } <span class="comment">// end the for loop over nDraw</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  TTree *SettingsBranch = <span class="keyword">new</span> TTree(<span class="stringliteral">&quot;Settings&quot;</span>, <span class="stringliteral">&quot;Settings&quot;</span>);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="GetPostfitParamPlots_8cpp.html#adb4ee3a874472b4ffccc8734da66250e">NDParameters</a> = <a class="code" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>];</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  SettingsBranch-&gt;Branch(<span class="stringliteral">&quot;NDParameters&quot;</span>, &amp;<a class="code" href="GetPostfitParamPlots_8cpp.html#adb4ee3a874472b4ffccc8734da66250e">NDParameters</a>);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="GetPostfitParamPlots_8cpp.html#aa7bc6e5554391b57acf10c691b6374e0">NDParametersStartingPos</a> = <a class="code" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>];</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  SettingsBranch-&gt;Branch(<span class="stringliteral">&quot;NDParametersStartingPos&quot;</span>, &amp;<a class="code" href="GetPostfitParamPlots_8cpp.html#aa7bc6e5554391b57acf10c691b6374e0">NDParametersStartingPos</a>);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  SettingsBranch-&gt;Branch(<span class="stringliteral">&quot;NDSamplesBins&quot;</span>, &amp;<a class="code" href="classMCMCProcessor.html#ab2649d6e851ec0a08985a35da299fa5b">NDSamplesBins</a>);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  SettingsBranch-&gt;Branch(<span class="stringliteral">&quot;NDSamplesNames&quot;</span>, &amp;<a class="code" href="classMCMCProcessor.html#aab80e0a8be27cc9206e1834a2f1f1ca2">NDSamplesNames</a>);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  SettingsBranch-&gt;Fill();</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  SettingsBranch-&gt;Write();</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="keyword">delete</span> SettingsBranch;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  TDirectory *Names = <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Names&quot;</span>);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  Names-&gt;cd();</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keywordflow">for</span> (std::vector&lt;TString&gt;::iterator it = <a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>.begin(); it != <a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>.end(); ++it) {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    TObjString((*it)).Write();</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  Names-&gt;Close();</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keyword">delete</span> Names;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <a class="code" href="classMCMCProcessor.html#aad661c6d53f9f891e18ff8ccdbd08479">Central_Value</a>-&gt;Write(<span class="stringliteral">&quot;Central_Value&quot;</span>);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <a class="code" href="classMCMCProcessor.html#acaf7f239136dfa3506d095b612323d0a">Means</a>-&gt;Write(<span class="stringliteral">&quot;PDF_Means&quot;</span>);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <a class="code" href="classMCMCProcessor.html#a5174aaa900edf16ddc6e841ea4adae83">Errors</a>-&gt;Write(<span class="stringliteral">&quot;PDF_Error&quot;</span>);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <a class="code" href="classMCMCProcessor.html#a600fc8c39af2750df91fb7a0ff85ac74">Means_Gauss</a>-&gt;Write(<span class="stringliteral">&quot;Gauss_Means&quot;</span>);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <a class="code" href="classMCMCProcessor.html#aa78b7ed1bb9966f84f4eaf8cedf5e688">Errors_Gauss</a>-&gt;Write(<span class="stringliteral">&quot;Gauss_Errors&quot;</span>);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <a class="code" href="classMCMCProcessor.html#a32657dc39a7fc0d04804f6195a3d8c3e">Means_HPD</a>-&gt;Write(<span class="stringliteral">&quot;Means_HPD&quot;</span>);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <a class="code" href="classMCMCProcessor.html#abb5c6ad85c89227bbb9bc5de2eb71272">Errors_HPD</a>-&gt;Write(<span class="stringliteral">&quot;Errors_HPD&quot;</span>);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <a class="code" href="classMCMCProcessor.html#af96664fa8cc51c49ad1385da07a343b8">Errors_HPD_Positive</a>-&gt;Write(<span class="stringliteral">&quot;Errors_HPD_Positive&quot;</span>);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <a class="code" href="classMCMCProcessor.html#a7b85df39f22390dac24f4d66a89518e5">Errors_HPD_Negative</a>-&gt;Write(<span class="stringliteral">&quot;Errors_HPD_Negative&quot;</span>);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  PostDir-&gt;Close();</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keyword">delete</span> PostDir;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  PostHistDir-&gt;Close();</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keyword">delete</span> PostHistDir;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="comment">// restore original warning setting</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  gErrorIgnoreLevel = originalErrorLevel;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;} <span class="comment">// Have now written the postfit projections</span></div>
<div class="ttc" id="aGetPostfitParamPlots_8cpp_html_aa7bc6e5554391b57acf10c691b6374e0"><div class="ttname"><a href="GetPostfitParamPlots_8cpp.html#aa7bc6e5554391b57acf10c691b6374e0">NDParametersStartingPos</a></div><div class="ttdeci">int NDParametersStartingPos</div><div class="ttdef"><b>Definition:</b> <a href="GetPostfitParamPlots_8cpp_source.html#l00053">GetPostfitParamPlots.cpp:53</a></div></div>
<div class="ttc" id="aGetPostfitParamPlots_8cpp_html_adb4ee3a874472b4ffccc8734da66250e"><div class="ttname"><a href="GetPostfitParamPlots_8cpp.html#adb4ee3a874472b4ffccc8734da66250e">NDParameters</a></div><div class="ttdeci">int NDParameters</div><div class="ttdef"><b>Definition:</b> <a href="GetPostfitParamPlots_8cpp_source.html#l00052">GetPostfitParamPlots.cpp:52</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_a4db4657acad5c79ac4bbb66a9d1c5905"><div class="ttname"><a href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a></div><div class="ttdeci">#define MACH3LOG_DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00034">MaCh3Logger.h:34</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_ab7d224b5fffa9367046f2976bb4972d1"><div class="ttname"><a href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a></div><div class="ttdeci">double ** Mean</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00061">RHat.cpp:61</a></div></div>
<div class="ttc" id="aStatisticalUtils_8cpp_html_a7237fc819d10a341c286a5597f584a96"><div class="ttname"><a href="StatisticalUtils_8cpp.html#a7237fc819d10a341c286a5597f584a96">GetGaussian</a></div><div class="ttdeci">void GetGaussian(TH1D *&amp;hist, TF1 *gauss, double &amp;Mean, double &amp;Error)</div><div class="ttdoc">CW: Fit Gaussian to posterior.</div><div class="ttdef"><b>Definition:</b> <a href="StatisticalUtils_8cpp_source.html#l00208">StatisticalUtils.cpp:208</a></div></div>
<div class="ttc" id="aStatisticalUtils_8cpp_html_aaf9d02010c94cac104e7987880adfb24"><div class="ttname"><a href="StatisticalUtils_8cpp.html#aaf9d02010c94cac104e7987880adfb24">GetHPD</a></div><div class="ttdeci">void GetHPD(TH1D *const hist, double &amp;Mean, double &amp;Error, double &amp;Error_p, double &amp;Error_m, const double coverage)</div><div class="ttdoc">Get Highest Posterior Density (HPD)</div><div class="ttdef"><b>Definition:</b> <a href="StatisticalUtils_8cpp_source.html#l00235">StatisticalUtils.cpp:235</a></div></div>
<div class="ttc" id="aStatisticalUtils_8cpp_html_ab4dc9e4455015e55031e2cc8a076349d"><div class="ttname"><a href="StatisticalUtils_8cpp.html#ab4dc9e4455015e55031e2cc8a076349d">GetArithmetic</a></div><div class="ttdeci">void GetArithmetic(TH1D *const hist, double &amp;Mean, double &amp;Error)</div><div class="ttdoc">CW: Get Arithmetic mean from posterior.</div><div class="ttdef"><b>Definition:</b> <a href="StatisticalUtils_8cpp_source.html#l00201">StatisticalUtils.cpp:201</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a20ee00d448413b8a2653b252d70e88b3"><div class="ttname"><a href="classMCMCProcessor.html#a20ee00d448413b8a2653b252d70e88b3">MCMCProcessor::Gauss</a></div><div class="ttdeci">std::unique_ptr&lt; TF1 &gt; Gauss</div><div class="ttdoc">Gaussian fitter.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00511">MCMCProcessor.h:511</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7627041b5ea3e1bbe038046ebb71a5dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7627041b5ea3e1bbe038046ebb71a5dc">&#9670;&nbsp;</a></span>MakePrefit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt; TH1D &gt; MCMCProcessor::MakePrefit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prepare prefit histogram for parameter overlay plot. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02368">2368</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;                                              {</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;<span class="comment">// *****************************</span></div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a> == <span class="keyword">nullptr</span>) <a class="code" href="classMCMCProcessor.html#aa5a7761e97cf2e24c7d877a5374b7333">MakeOutputFile</a>();</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160; </div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;  <span class="keyword">auto</span> PreFitPlot = std::make_unique&lt;TH1D&gt;(<span class="stringliteral">&quot;Prefit&quot;</span>, <span class="stringliteral">&quot;Prefit&quot;</span>, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;  PreFitPlot-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; PreFitPlot-&gt;GetNbinsX() + 1; ++i) {</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;    PreFitPlot-&gt;SetBinContent(i+1, 0);</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;    PreFitPlot-&gt;SetBinError(i+1, 0);</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;  }</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160; </div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;  <span class="comment">//KS: Slightly hacky way to get relative to prior or nominal as this is convention we use,</span></div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;  <span class="comment">//Only applies for xsec, for other systematic it make no difference</span></div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;  <span class="keywordtype">double</span> CentralValueTemp, Central, Error;</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160; </div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;  <span class="comment">// Set labels and data</span></div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;  {</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;    <span class="comment">//Those keep which parameter type we run currently and relative number</span></div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;    <span class="keywordtype">int</span> ParamEnum = <a class="code" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>[i];</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;    <span class="keywordtype">int</span> ParamNo = i - <a class="code" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20b">ParameterEnum</a>(ParamEnum)];</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    CentralValueTemp = <a class="code" href="classMCMCProcessor.html#a3a6614826ae320e462211e38e96d9d02">ParamCentral</a>[ParamEnum][ParamNo];</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#afbac2a114c15ca7db4abe71dd549504c">plotRelativeToPrior</a>) </div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;    {</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;      <span class="comment">// Normalise the prior relative the nominal/prior, just the way we get our fit results in MaCh3</span></div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;      <span class="keywordflow">if</span> ( CentralValueTemp != 0) {</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;        Central = <a class="code" href="classMCMCProcessor.html#a3a6614826ae320e462211e38e96d9d02">ParamCentral</a>[ParamEnum][ParamNo] / CentralValueTemp;</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;        Error = <a class="code" href="classMCMCProcessor.html#a3a97e3cb4be3ceb9eb721eac51d82d60">ParamErrors</a>[ParamEnum][ParamNo]/CentralValueTemp;</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;        Central = CentralValueTemp + 1.0;</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;        Error = <a class="code" href="classMCMCProcessor.html#a3a97e3cb4be3ceb9eb721eac51d82d60">ParamErrors</a>[ParamEnum][ParamNo];</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;      }</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    }</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;    {</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;      Central = CentralValueTemp;</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;      Error = <a class="code" href="classMCMCProcessor.html#a3a97e3cb4be3ceb9eb721eac51d82d60">ParamErrors</a>[ParamEnum][ParamNo];</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;    }</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    <span class="comment">//KS: If plotting error for param with flat prior is turned off and given param really has flat prior set error to 0</span></div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="classMCMCProcessor.html#ad24411a2556504c440ff0af045e8e7aa">PlotFlatPrior</a> &amp;&amp; <a class="code" href="classMCMCProcessor.html#a4be1eedb743e4ea410009a4fa45720f7">ParamFlat</a>[ParamEnum][ParamNo]) {</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;      Error = 0.;</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;    }</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;    PreFitPlot-&gt;SetBinContent(i+1, Central);</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;    PreFitPlot-&gt;SetBinError(i+1, Error);</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;    PreFitPlot-&gt;GetXaxis()-&gt;SetBinLabel(i+1, <a class="code" href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">ParamNames</a>[ParamEnum][ParamNo]);</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;  }</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;  PreFitPlot-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160; </div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;  PreFitPlot-&gt;SetFillStyle(1001);</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;  PreFitPlot-&gt;SetFillColor(kRed-3);</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;  PreFitPlot-&gt;SetMarkerStyle(21);</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;  PreFitPlot-&gt;SetMarkerSize(2.4);</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;  PreFitPlot-&gt;SetMarkerColor(kWhite);</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;  PreFitPlot-&gt;SetLineColor(PreFitPlot-&gt;GetFillColor());</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;  PreFitPlot-&gt;GetXaxis()-&gt;LabelsOption(<span class="stringliteral">&quot;v&quot;</span>);</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160; </div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;  <span class="keywordflow">return</span> PreFitPlot;</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afac304b884238cc3624f5471b43f1a7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afac304b884238cc3624f5471b43f1a7e">&#9670;&nbsp;</a></span>MakeSubOptimality()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::MakeSubOptimality </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>NIntervals</em> = <code>10</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make and Draw SubOptimality <a class="el" href="citelist.html#CITEREF_roberts2009adaptive">[28]</a>. </p>
<dl class="section author"><dt>Author</dt><dd>Henry Wallace </dd></dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l01296">1296</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                                                          {</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="comment">// *********************</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <span class="comment">//Save burn in cut, at the end of the loop we will return to default values</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> DefaultUpperCut = <a class="code" href="classMCMCProcessor.html#a6b14dd9e571803d8946781642348bee1">UpperCut</a>;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> DefaultBurnInCut = <a class="code" href="classMCMCProcessor.html#afca259b5bdee2b248d4b1a64ac3e7930">BurnInCut</a>;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  <span class="keywordtype">bool</span> defaultPrintToPDF = <a class="code" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  <a class="code" href="classMCMCProcessor.html#afca259b5bdee2b248d4b1a64ac3e7930">BurnInCut</a> = 0;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  <a class="code" href="classMCMCProcessor.html#a6b14dd9e571803d8946781642348bee1">UpperCut</a> = 0;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  <a class="code" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160; </div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  <span class="comment">//Set via config in future</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;  <span class="keywordtype">int</span> MaxStep = <a class="code" href="classMCMCProcessor.html#aae0016a4e1d105d5d65243438c622a97">nSteps</a>;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  <span class="keywordtype">int</span> MinStep = 0;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> IntervalsSize = <a class="code" href="classMCMCProcessor.html#aae0016a4e1d105d5d65243438c622a97">nSteps</a>/NIntervals;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160; </div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making Suboptimality&quot;</span>);</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  TStopwatch clock;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  clock.Start();</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  </div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  std::unique_ptr&lt;TH1D&gt; SubOptimality = std::make_unique&lt;TH1D&gt;(<span class="stringliteral">&quot;Suboptimality&quot;</span>, <span class="stringliteral">&quot;Suboptimality&quot;</span>, NIntervals, MinStep, MaxStep);</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  SubOptimality-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  SubOptimality-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Step&quot;</span>);</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  SubOptimality-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Suboptimality&quot;</span>);</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  SubOptimality-&gt;SetLineWidth(2);</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;  SubOptimality-&gt;SetLineColor(kBlue);</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160; </div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; NIntervals; ++i)</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    {</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="comment">//Reset our cov matrix</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <a class="code" href="classMCMCProcessor.html#a08d9a19ff49682bfea54381419d6432a">Reset2DPosteriors</a>();</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160; </div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <span class="comment">//Set threshold for calculating new matrix</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <a class="code" href="classMCMCProcessor.html#a6b14dd9e571803d8946781642348bee1">UpperCut</a> = i*IntervalsSize;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    <span class="comment">//Calculate cov matrix</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <a class="code" href="classMCMCProcessor.html#ab367cb5f56606338bb1fce780f2414e8">MakeCovariance_MP</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160; </div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <span class="comment">//Calculate eigen values</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    TMatrixDSymEigen eigen(*<a class="code" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a>);</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    TVectorD eigen_values;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    eigen_values.ResizeTo(eigen.GetEigenValues());</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    eigen_values = eigen.GetEigenValues();</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160; </div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    <span class="comment">//KS: Converting from ROOT to vector as to make using other libraires (Eigen) easier in future</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    std::vector&lt;double&gt; EigenValues(eigen_values.GetNrows());</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; EigenValues.size(); j++)</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  {</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      EigenValues[j] = eigen_values(j);</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    }</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> SubOptimalityValue = <a class="code" href="StatisticalUtils_8cpp.html#a34d5232bfb12e29ec9d63acaa8744b58">GetSubOptimality</a>(EigenValues, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    SubOptimality-&gt;SetBinContent(i+1, SubOptimalityValue);</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;  }</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  clock.Stop();</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making Suboptimality took {:.2f}s to finish for {} steps&quot;</span>, clock.RealTime(), <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160; </div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  <a class="code" href="classMCMCProcessor.html#a6b14dd9e571803d8946781642348bee1">UpperCut</a> = DefaultUpperCut;</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  <a class="code" href="classMCMCProcessor.html#afca259b5bdee2b248d4b1a64ac3e7930">BurnInCut</a> = DefaultBurnInCut;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  <a class="code" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a> = defaultPrintToPDF;</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160; </div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;  SubOptimality-&gt;Draw(<span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetName(SubOptimality-&gt;GetName());</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetTitle(SubOptimality-&gt;GetTitle());</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160; </div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Print(<a class="code" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  <span class="comment">// Write it to root file</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Write();</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;}</div>
<div class="ttc" id="aStatisticalUtils_8cpp_html_a34d5232bfb12e29ec9d63acaa8744b58"><div class="ttname"><a href="StatisticalUtils_8cpp.html#a34d5232bfb12e29ec9d63acaa8744b58">GetSubOptimality</a></div><div class="ttdeci">double GetSubOptimality(const std::vector&lt; double &gt; &amp;EigenValues, const int TotalTarameters)</div><div class="ttdoc">Based on .</div><div class="ttdef"><b>Definition:</b> <a href="StatisticalUtils_8cpp_source.html#l00184">StatisticalUtils.cpp:184</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a08d9a19ff49682bfea54381419d6432a"><div class="ttname"><a href="classMCMCProcessor.html#a08d9a19ff49682bfea54381419d6432a">MCMCProcessor::Reset2DPosteriors</a></div><div class="ttdeci">void Reset2DPosteriors()</div><div class="ttdoc">Reset 2D posteriors, in case we would like to calculate in again with different BurnInCut.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02753">MCMCProcessor.cpp:2753</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3ae80722efa0c94eec066ee91f3cf997"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ae80722efa0c94eec066ee91f3cf997">&#9670;&nbsp;</a></span>MakeTrianglePlot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::MakeTrianglePlot </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>ParNames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>CredibleIntervals</em> = <code>{0.99,&#160;0.90,&#160;0.68&#160;}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Color_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>CredibleIntervalsColours</em> = <code>{kCyan+4,&#160;kCyan-2,&#160;kCyan-10}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>CredibleRegions</em> = <code>{0.99,&#160;0.90,&#160;0.68}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Style_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>CredibleRegionStyle</em> = <code>{kDashed,&#160;kSolid,&#160;kDotted}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Color_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>CredibleRegionColor</em> = <code>{kGreen-3,&#160;kGreen-10,&#160;kGreen}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>CredibleInSigmas</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make fancy triangle plot for selected parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ParNames</td><td>Parameters for which Triangle plot will be made </td></tr>
    <tr><td class="paramname">CredibleIntervals</td><td>Vector with values of credible intervals, must be in descending order </td></tr>
    <tr><td class="paramname">CredibleIntervalsColours</td><td>Color_t telling what colour to use for each Interval line </td></tr>
    <tr><td class="paramname">CredibleRegions</td><td>Vector with values of credible intervals, must be in descending order </td></tr>
    <tr><td class="paramname">CredibleRegionStyle</td><td>Style_t telling what line style to use for each Interval line </td></tr>
    <tr><td class="paramname">CredibleRegionColor</td><td>Color_t telling what colour to use for each Interval line </td></tr>
    <tr><td class="paramname">CredibleInSigmas</td><td>Bool telling whether intervals are in percentage or in sigmas, then special conversions is used </td></tr>
  </table>
  </dd>
</dl>
<p>Scale the histograms so it shows the posterior probability</p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l01880">1880</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;                                                                  {</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;<span class="comment">// *********************</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>.size() == 0) <a class="code" href="classMCMCProcessor.html#ab367cb5f56606338bb1fce780f2414e8">MakeCovariance_MP</a>();</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160; </div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> nParamPlot = int(ParNames.size());</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;  std::vector&lt;int&gt; ParamNumber;</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;  std::string ParamInfoNames = <span class="stringliteral">&quot;Making Triangle Plot for { &quot;</span>;</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; nParamPlot; ++j)</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;  {</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    ParamInfoNames += fmt::format(<span class="stringliteral">&quot;{} &quot;</span>, ParNames[j]);</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    <span class="keywordtype">int</span> ParamNo = <a class="code" href="classMCMCProcessor.html#a563df09ed03a95aa8ad2781db9c8807b">GetParamIndexFromName</a>(ParNames[j]);</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    <span class="keywordflow">if</span>(ParamNo == <a class="code" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a>)</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    {</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Couldn&#39;t find param {}. Will not plot Triangle plot&quot;</span>, ParNames[j]);</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    }</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    ParamNumber.push_back(ParamNo);</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;  }</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;  ParamInfoNames += <span class="stringliteral">&quot;}&quot;</span>;</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{}&quot;</span>, ParamInfoNames);</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160; </div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;  <span class="comment">//KS: Store it as we go back to them at the end</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;  <span class="keyword">const</span> std::vector&lt;double&gt; Margins = <a class="code" href="classMCMCProcessor.html#a1dfc05edf0b1295e561d5956b43b1c6b">GetMargins</a>(<a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>);</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetTopMargin(0.001);</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetBottomMargin(0.001);</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetLeftMargin(0.001);</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetRightMargin(0.001);</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160; </div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;  <span class="comment">// KS: We later format hist several times so make one unfired lambda</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;  <span class="keyword">auto</span> FormatHistogram = [](<span class="keyword">auto</span>&amp; hist) {</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    hist-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    hist-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    hist-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160; </div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    hist-&gt;GetXaxis()-&gt;SetLabelSize(0.1);</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    hist-&gt;GetYaxis()-&gt;SetLabelSize(0.1);</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160; </div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    hist-&gt;GetXaxis()-&gt;SetNdivisions(4);</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    hist-&gt;GetYaxis()-&gt;SetNdivisions(4);</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;  };</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160; </div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;cd();</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Clear();</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Update();</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160; </div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;  <span class="comment">//KS: We sort to have parameters from highest to lowest, this is related to how we make 2D projections in MakeCovariance_MP</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;  std::sort(ParamNumber.begin(), ParamNumber.end(),  std::greater&lt;int&gt;());</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160; </div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;  <span class="comment">//KS: Calculate how many pads/plots we need</span></div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;  <span class="keywordtype">int</span> Npad = 0;</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 1; j &lt; nParamPlot+1; j++) Npad += j;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;cd();</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;  <span class="comment">// KS: Sanity check of size and ordering is correct</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;  <a class="code" href="classMCMCProcessor.html#aa7db7e3aa4403a239b8b2b865cea91f6">CheckCredibleIntervalsOrder</a>(CredibleIntervals, CredibleIntervalsColours);</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;  <a class="code" href="classMCMCProcessor.html#ab11b70175cd1e63722942a063192968a">CheckCredibleRegionsOrder</a>(CredibleRegions, CredibleRegionStyle, CredibleRegionColor);</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160; </div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> nCredibleIntervals = int(CredibleIntervals.size());</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> nCredibleRegions = int(CredibleRegions.size());</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160; </div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  <span class="comment">//KS: Initialise Tpad histograms etc we will need</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;  std::vector&lt;TPad*&gt; TrianglePad(Npad);</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;  <span class="comment">//KS: 1D copy of posterior, we need it as we modify them</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;  std::vector&lt;std::unique_ptr&lt;TH1D&gt;&gt; hpost_copy(nParamPlot);</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;  std::vector&lt;std::vector&lt;std::unique_ptr&lt;TH1D&gt;&gt;&gt; hpost_cl(nParamPlot);</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;  std::vector&lt;std::unique_ptr&lt;TText&gt;&gt; TriangleText(nParamPlot * 2);</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;  std::vector&lt;std::unique_ptr&lt;TH2D&gt;&gt; hpost_2D_copy(Npad-nParamPlot);</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;  std::vector&lt;std::vector&lt;std::unique_ptr&lt;TH2D&gt;&gt;&gt; hpost_2D_cl(Npad-nParamPlot);</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;  gStyle-&gt;SetPalette(51);</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160; </div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;  <span class="comment">//KS: Super convoluted way of calculating ranges for our pads, trust me it works...</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;  std::vector&lt;double&gt; X_Min(nParamPlot);</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;  std::vector&lt;double&gt; X_Max(nParamPlot);</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160; </div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;  <span class="comment">//TN:</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;  <span class="comment">// n = number of params (nParamPlot)</span></div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;  <span class="comment">// a_x = width of the left margin space for pad axis labels on the left in canvas coordinates</span></div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;  <span class="comment">// a_y = height of the bottom margin space for pad axis labels on the bottom in canvas coordinates</span></div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;  <span class="comment">// b_x = pad plot width in canvas coordinates</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;  <span class="comment">// b_y = pad plot height in canvas coordinates</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;  <span class="comment">// Pm = a/(a+b) = actual margin within the first plot from the left (a_x,b_x) or bottom (a_y,b_y); Pm = {left,bottom}</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;  <span class="comment">// TPm = desired margin of the whole triangle plot in canvas coordinates; TPm = {left, bottom, right, top}</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;  <span class="comment">// TPw = 1.-TPm[0]-TPm[2] width of the triangle plot in canvas coordinates</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;  <span class="comment">// TPh = 1.-TPm[1]-TPm[3] height of the triangle plot in canvas coordinates</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;  <span class="comment">// Then a_x+n*b_x = TPw = 1.-TPm[0]-TPm[1]</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;  <span class="comment">// Hence from that:</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;  <span class="comment">// a_x = Pm[0]*(a_x+b_x) = Pm[0]*(a_x+(TPw-a_x)/n) =&gt; a_x = (Pm[0]*TPw)/(n+Pm[0]*(1-n))</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;  <span class="comment">// b_x = (TPw-a_x)/n</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160; </div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;  <span class="comment">// The inputs:</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> TPm[4] = {.07,.07,.05,.05};</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> Pm[2] = {.2,.1};</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160; </div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;  <span class="comment">// Auxiliary x-direction:</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> TPw = 1. - TPm[0] - TPm[2];</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> a_x = ( Pm[0] * TPw ) / ( 1. * nParamPlot + Pm[0] * ( 1. - 1.*nParamPlot ) );</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> b_x = ( TPw - a_x ) / ( 1. * nParamPlot );</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160; </div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;  X_Min[0] = TPm[0];</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;  X_Max[0] = X_Min[0] + a_x + b_x;</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i &lt; nParamPlot; i++)</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;  {</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    X_Min[i] = X_Max[i-1];</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;    X_Max[i] = X_Min[i]+b_x;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;  }</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160; </div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;  std::vector&lt;double&gt; Y_Min(nParamPlot);</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;  std::vector&lt;double&gt; Y_Max(nParamPlot);</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160; </div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;  <span class="comment">// Auxiliary y-direction:</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> TPh = 1. - TPm[1] - TPm[3];</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> a_y = ( Pm[1] * TPh ) / ( 1. * nParamPlot + Pm[1] * ( 1. - 1.*nParamPlot ) );</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> b_y = ( TPh - a_y ) / ( 1. * nParamPlot );</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160; </div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;  Y_Min[nParamPlot-1] = TPm[1];</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;  Y_Max[nParamPlot-1] = Y_Min[nParamPlot-1] + a_y + b_y;</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = nParamPlot-2; i &gt;= 0; i--)</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;  {</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    Y_Min[i] = Y_Max[i+1];</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    Y_Max[i] = Y_Min[i]+b_y;</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;  }</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160; </div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;  <span class="comment">//KS: We store as numbering of isn&#39;t straightforward</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;  <span class="keywordtype">int</span> counterPad = 0, counterText = 0, counterPost = 0, counter2DPost = 0;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;  <span class="comment">//KS: We start from top of the plot, might be confusing but works very well</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> y = 0; y &lt; nParamPlot; y++)</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;  {</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    <span class="comment">//KS: start from left and go right, depending on y</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> x = 0; x &lt;= y; x++)</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    {</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;      <span class="comment">//KS: Need to go to canvas every time to have our pads in the same canvas, not pads in the pads</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;      <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;cd();</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;      TrianglePad[counterPad] = <span class="keyword">new</span> TPad(Form(<span class="stringliteral">&quot;TPad_%i&quot;</span>, counterPad), Form(<span class="stringliteral">&quot;TPad_%i&quot;</span>, counterPad), X_Min[x], Y_Min[y], X_Max[x], Y_Max[y]);</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160; </div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;      TrianglePad[counterPad]-&gt;SetTopMargin(0);</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;      TrianglePad[counterPad]-&gt;SetRightMargin(0);</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160; </div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;      TrianglePad[counterPad]-&gt;SetGrid();</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;      TrianglePad[counterPad]-&gt;SetFrameBorderMode(0);</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;      TrianglePad[counterPad]-&gt;SetBorderMode(0);</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;      TrianglePad[counterPad]-&gt;SetBorderSize(0);</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160; </div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;      <span class="comment">//KS: Corresponds to bottom part of the plot, need margins for labels</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;      TrianglePad[counterPad]-&gt;SetBottomMargin(y == (nParamPlot - 1) ? Pm[1] : 0);</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;      <span class="comment">//KS: Corresponds to left part, need margins for labels</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;      TrianglePad[counterPad]-&gt;SetLeftMargin(x == 0 ? Pm[0] : 0);</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160; </div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;      TrianglePad[counterPad]-&gt;Draw();</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;      TrianglePad[counterPad]-&gt;cd();</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160; </div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;      <span class="comment">//KS:if diagonal plot main posterior</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;      <span class="keywordflow">if</span>(x == y)</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;      {</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;        hpost_copy[counterPost] = M3::Clone&lt;TH1D&gt;(<a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNumber[x]], Form(<span class="stringliteral">&quot;hpost_copy_%i&quot;</span>, ParamNumber[x]));</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;        hpost_cl[counterPost].resize(nCredibleIntervals);</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;        hpost_copy[counterPost]-&gt;Scale(1. / hpost_copy[counterPost]-&gt;Integral());</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nCredibleIntervals; ++j)</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;        {</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;          hpost_cl[counterPost][j] = M3::Clone&lt;TH1D&gt;(<a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNumber[x]], Form(<span class="stringliteral">&quot;hpost_copy_%i_CL_%f&quot;</span>, ParamNumber[x], CredibleIntervals[j]));</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;          <span class="comment">//KS: Reset to get rid to TF1 otherwise we run into segfault :(</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;          hpost_cl[counterPost][j]-&gt;Reset(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;          hpost_cl[counterPost][j]-&gt;Fill(0.0, 0.0);</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160; </div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;          <span class="comment">// Scale the histograms before gettindg credible intervals</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;          hpost_cl[counterPost][j]-&gt;Scale(1. / hpost_cl[counterPost][j]-&gt;Integral());</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;          <a class="code" href="StatisticalUtils_8cpp.html#a83d228a56830a0b5800ac956216c424b">GetCredibleIntervalSig</a>(hpost_copy[counterPost], hpost_cl[counterPost][j], CredibleInSigmas, CredibleIntervals[j]);</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160; </div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;          hpost_cl[counterPost][j]-&gt;SetFillColor(CredibleIntervalsColours[j]);</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;          hpost_cl[counterPost][j]-&gt;SetLineWidth(1);</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;        }</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160; </div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;        hpost_copy[counterPost]-&gt;SetMaximum(hpost_copy[counterPost]-&gt;GetMaximum()*1.2);</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;        hpost_copy[counterPost]-&gt;SetLineWidth(2);</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;        hpost_copy[counterPost]-&gt;SetLineColor(kBlack);</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160; </div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;        <span class="comment">//KS: Don&#39;t want any titles</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;        FormatHistogram(hpost_copy[counterPost]);</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160; </div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;        <span class="comment">//TN: Scale the size of labels with the plots size.</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;        <span class="comment">//Unfortunately, this needs to managed through absolute sizes</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;        <span class="comment">//as each pad is of different size.</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;        hpost_copy[counterPost]-&gt;GetXaxis()-&gt;SetLabelFont(133);</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;        hpost_copy[counterPost]-&gt;GetXaxis()-&gt;SetLabelSize(.08*(a_y+b_y)*<a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;GetWh());</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160; </div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;        hpost_copy[counterPost]-&gt;GetYaxis()-&gt;SetLabelFont(133);</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;        hpost_copy[counterPost]-&gt;GetYaxis()-&gt;SetLabelSize(.08*(a_y+b_y)*<a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;GetWh());</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160; </div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;        hpost_copy[counterPost]-&gt;Draw(<span class="stringliteral">&quot;HIST&quot;</span>);</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nCredibleIntervals; ++j){</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;          hpost_cl[counterPost][j]-&gt;Draw(<span class="stringliteral">&quot;HIST SAME&quot;</span>);</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;        }</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;        counterPost++;</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;      }</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;      <span class="comment">//KS: Here we plot 2D credible regions</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;      {</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;        hpost_2D_copy[counter2DPost] = M3::Clone&lt;TH2D&gt;(<a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[ParamNumber[x]][ParamNumber[y]],</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;                                                       Form(<span class="stringliteral">&quot;hpost_copy_%i_%i&quot;</span>, ParamNumber[x], ParamNumber[y]));</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;        hpost_2D_cl[counter2DPost].resize(nCredibleRegions);</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;        <span class="comment">//KS: Now copy for every credible region</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nCredibleRegions; ++k)</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;        {</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;          hpost_2D_cl[counter2DPost][k] = M3::Clone&lt;TH2D&gt;(<a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[ParamNumber[x]][ParamNumber[y]],</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                                                          Form(<span class="stringliteral">&quot;hpost_copy_%i_%i_CL_%f&quot;</span>, ParamNumber[x], ParamNumber[y], CredibleRegions[k]));</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;          <a class="code" href="StatisticalUtils_8cpp.html#ab0babebde48f51680e675beaa1dd8c33">GetCredibleRegionSig</a>(hpost_2D_cl[counter2DPost][k], CredibleInSigmas, CredibleRegions[k]);</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160; </div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;          hpost_2D_cl[counter2DPost][k]-&gt;SetLineColor(CredibleRegionColor[k]);</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;          hpost_2D_cl[counter2DPost][k]-&gt;SetLineWidth(2);</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;          hpost_2D_cl[counter2DPost][k]-&gt;SetLineStyle(CredibleRegionStyle[k]);</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;        }</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;        <span class="comment">//KS: Don&#39;t want any titles</span></div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;        FormatHistogram(hpost_2D_copy[counter2DPost]);</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160; </div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;        <span class="comment">//TN: Scale the size of labels with the plots size.</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;        <span class="comment">//Unfortunately, this needs to managed through absolute sizes</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;        <span class="comment">//as each pad is of different size.</span></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;        hpost_2D_copy[counter2DPost]-&gt;GetXaxis()-&gt;SetLabelFont(133);</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;        hpost_2D_copy[counter2DPost]-&gt;GetXaxis()-&gt;SetLabelSize(.08*(a_y+b_y)*<a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;GetWh());</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160; </div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;        hpost_2D_copy[counter2DPost]-&gt;GetYaxis()-&gt;SetLabelFont(133);</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;        hpost_2D_copy[counter2DPost]-&gt;GetYaxis()-&gt;SetLabelSize(.08*(a_y+b_y)*<a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;GetWh());</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160; </div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;        hpost_2D_copy[counter2DPost]-&gt;Draw(<span class="stringliteral">&quot;COL&quot;</span>);</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;        <span class="comment">//Now credible regions</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nCredibleRegions; ++k){</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;          hpost_2D_cl[counter2DPost][k]-&gt;Draw(<span class="stringliteral">&quot;CONT3 SAME&quot;</span>);</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;        }</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;        counter2DPost++;</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;      }</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;      <span class="comment">//KS: Corresponds to bottom part of the plot</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;      <span class="keywordflow">if</span>(y == (nParamPlot-1))</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;      {</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;        <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;cd();</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;        TriangleText[counterText] = std::make_unique&lt;TText&gt;(X_Min[x] + (X_Max[x]-X_Min[x]+(x == 0 ? a_x : .0))/2., .05, <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNumber[x]]-&gt;GetTitle());</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;        <span class="comment">//KS: Unfortunately for many plots or long names this can go out of bounds :(</span></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;        <span class="comment">//TN: Align the axis titles and scale them with the size of the plots</span></div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;        TriangleText[counterText]-&gt;SetTextAlign(22);</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;        TriangleText[counterText]-&gt;SetTextSize(.08*(a_y+b_y));</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;        TriangleText[counterText]-&gt;SetNDC(<span class="keyword">true</span>);</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;        TriangleText[counterText]-&gt;Draw();</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;        counterText++;</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;      }</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;      <span class="comment">//KS: Corresponds to left part</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;      <span class="keywordflow">if</span>(x == 0)</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;      {</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;        <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;cd();</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;        TriangleText[counterText] = std::make_unique&lt;TText&gt;(.05, Y_Min[y] + (Y_Max[y]-Y_Min[y]+(y == nParamPlot-1 ? a_y : .0))/2., <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNumber[y]]-&gt;GetTitle());</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;        <span class="comment">//KS: Rotate as this is y axis</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;        TriangleText[counterText]-&gt;SetTextAngle(90);</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;        <span class="comment">//KS: Unfortunately for many plots or long names this can go out of bounds :(</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;        <span class="comment">//TN: Align the axis titles and scale them with the size of the plots</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;        TriangleText[counterText]-&gt;SetTextAlign(22);</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;        TriangleText[counterText]-&gt;SetTextSize(.08*(a_y+b_y));</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;        TriangleText[counterText]-&gt;SetNDC(<span class="keyword">true</span>);</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;        TriangleText[counterText]-&gt;Draw();</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;        counterText++;</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;      }</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;      <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Update();</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;      counterPad++;</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    }</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;  }</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160; </div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;cd();</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;  <span class="keyword">auto</span> legend = std::make_unique&lt;TLegend&gt;(0.60, 0.7, 0.9, 0.9);</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;  <a class="code" href="classMCMCProcessor.html#a704afa8c216722e730be2c2a33b594f0">SetLegendStyle</a>(legend.get(), 0.03);</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;  <span class="comment">//KS: Legend is shared so just take first histograms</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = nCredibleIntervals-1; j &gt;= 0; --j)</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;  {</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    <span class="keywordflow">if</span>(CredibleInSigmas)</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;      legend-&gt;AddEntry(hpost_cl[0][j].get(), Form(<span class="stringliteral">&quot;%.0f#sigma Credible Interval&quot;</span>, CredibleIntervals[j]), <span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;      legend-&gt;AddEntry(hpost_cl[0][j].get(), Form(<span class="stringliteral">&quot;%.0f%% Credible Interval&quot;</span>, CredibleRegions[j]*100), <span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;  }</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = nCredibleRegions-1; k &gt;= 0; --k)</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;  {</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    <span class="keywordflow">if</span>(CredibleInSigmas)</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;      legend-&gt;AddEntry(hpost_2D_cl[0][k].get(), Form(<span class="stringliteral">&quot;%.0f#sigma Credible Region&quot;</span>, CredibleRegions[k]), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;      legend-&gt;AddEntry(hpost_2D_cl[0][k].get(), Form(<span class="stringliteral">&quot;%.0f%% Credible Region&quot;</span>, CredibleRegions[k]*100), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;  }</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;  legend-&gt;Draw(<span class="stringliteral">&quot;SAME&quot;</span>);</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Update();</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160; </div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;  <span class="comment">// Write to file</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetName(<span class="stringliteral">&quot;TrianglePlot&quot;</span>);</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetTitle(<span class="stringliteral">&quot;TrianglePlot&quot;</span>);</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160; </div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Print(<a class="code" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;  <span class="comment">// Write it to root file</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Write();</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160; </div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;  <span class="comment">//KS: Remove allocated structures</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; Npad; i++) <span class="keyword">delete</span> TrianglePad[i];</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160; </div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;  <span class="comment">//KS: Restore margin</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;  <a class="code" href="classMCMCProcessor.html#a922f4c04b67ca9c6faab00efdb5277ea">SetMargins</a>(<a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>, Margins);</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a04976c69f0ef0b3f39edcf5f25f90981"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04976c69f0ef0b3f39edcf5f25f90981">&#9670;&nbsp;</a></span>MakeViolin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::MakeViolin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make and Draw Violin. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l00790">790</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                               {</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">// *********************</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="comment">//KS: Make sure we have steps</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="classMCMCProcessor.html#aea84f0315695aa05ec41fcf965b1b031">CacheMCMC</a>) <a class="code" href="classMCMCProcessor.html#ace48a54fb08e2a3943d4e2ed1f8c4a4b">CacheSteps</a>();</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Starting {}&quot;</span>, __func__);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <span class="comment">// KS: Set temporary branch address to allow min/max, otherwise ROOT can segfaults</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="keywordtype">double</span> tempVal = 0.0;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="comment">//KS: Find min and max to make histogram in range</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="keywordtype">double</span> maxi_y = -9999;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <span class="keywordtype">double</span> mini_y = +9999;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  {</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchAddress(<a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i].Data(), &amp;tempVal);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> max_val = <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMaximum(<a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i]);</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> min_val = <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMinimum(<a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i]);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    maxi_y = std::max(maxi_y, max_val);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    mini_y = std::min(mini_y, min_val);</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  }</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> vBins = (maxi_y-mini_y)*25;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <a class="code" href="classMCMCProcessor.html#a97a9669445c141d9dddc19f1b3562479">hviolin</a> = std::make_unique&lt;TH2D&gt;(<span class="stringliteral">&quot;hviolin&quot;</span>, <span class="stringliteral">&quot;hviolin&quot;</span>, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, vBins, mini_y, maxi_y);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  <a class="code" href="classMCMCProcessor.html#a97a9669445c141d9dddc19f1b3562479">hviolin</a>-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <span class="comment">//KS: Prior has larger errors so we increase range and number of bins</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  constexpr <span class="keywordtype">int</span> PriorFactor = 4;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <a class="code" href="classMCMCProcessor.html#a4061fd7eeeee55dd709fe844146ed815">hviolin_prior</a> = std::make_unique&lt;TH2D&gt;(<span class="stringliteral">&quot;hviolin_prior&quot;</span>, <span class="stringliteral">&quot;hviolin_prior&quot;</span>, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, PriorFactor*vBins, PriorFactor*mini_y, PriorFactor*maxi_y);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <a class="code" href="classMCMCProcessor.html#a4061fd7eeeee55dd709fe844146ed815">hviolin_prior</a>-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <span class="keyword">auto</span> rand = std::make_unique&lt;TRandom3&gt;(0);</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  std::vector&lt;double&gt; PriorVec(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  std::vector&lt;double&gt; PriorErrorVec(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  std::vector&lt;bool&gt; PriorFlatVec(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160; </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++x)</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  {</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    TString Title;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordtype">double</span> Prior, PriorError;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160; </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <a class="code" href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">GetNthParameter</a>(x, Prior, PriorError, Title);</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="comment">//Set fancy labels</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <a class="code" href="classMCMCProcessor.html#a97a9669445c141d9dddc19f1b3562479">hviolin</a>-&gt;GetXaxis()-&gt;SetBinLabel(x+1, Title);</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <a class="code" href="classMCMCProcessor.html#a4061fd7eeeee55dd709fe844146ed815">hviolin_prior</a>-&gt;GetXaxis()-&gt;SetBinLabel(x+1, Title);</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    PriorVec[x] = Prior;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    PriorErrorVec[x] = PriorError;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20b">ParameterEnum</a> ParType = <a class="code" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>[x];</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="keywordtype">int</span> ParamTemp = x - <a class="code" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[ParType];</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    PriorFlatVec[x] = <a class="code" href="classMCMCProcessor.html#a4be1eedb743e4ea410009a4fa45720f7">ParamFlat</a>[ParType][ParamTemp];</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  }</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160; </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  TStopwatch clock;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  clock.Start();</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="comment">// nDraw is number of draws we want to do</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++x)</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  {</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="comment">//KS: Consider another treatment for fixed params</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="comment">//if (IamVaried[x] == false) continue;</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++k)</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    {</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      <span class="comment">//KS: Burn in cut</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a6058bb3e817401423231f85a71db46a0">StepNumber</a>[k] &lt; <a class="code" href="classMCMCProcessor.html#afca259b5bdee2b248d4b1a64ac3e7930">BurnInCut</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160; </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      <span class="comment">//Only used for Suboptimatlity</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a6058bb3e817401423231f85a71db46a0">StepNumber</a>[k] &gt; <a class="code" href="classMCMCProcessor.html#a6b14dd9e571803d8946781642348bee1">UpperCut</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      <span class="comment">//KS: We know exactly which x bin we will end up, find y bin. This allow to avoid coslty Fill() and enable multithreading becasue I am master of faster</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> y = <a class="code" href="classMCMCProcessor.html#a97a9669445c141d9dddc19f1b3562479">hviolin</a>-&gt;GetYaxis()-&gt;FindBin(<a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>[x][k]);</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      <a class="code" href="classMCMCProcessor.html#a97a9669445c141d9dddc19f1b3562479">hviolin</a>-&gt;SetBinContent(x+1, y,  <a class="code" href="classMCMCProcessor.html#a97a9669445c141d9dddc19f1b3562479">hviolin</a>-&gt;GetBinContent(x+1, y)+1);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    }</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="comment">//KS: If we set option to not plot flat prior and param has flat prior then we skip this step</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keywordflow">if</span>(!(!<a class="code" href="classMCMCProcessor.html#ad24411a2556504c440ff0af045e8e7aa">PlotFlatPrior</a> &amp;&amp; PriorFlatVec[x]))</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    {</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++k)</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      {</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> Entry = rand-&gt;Gaus(PriorVec[x], PriorErrorVec[x]);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> y = <a class="code" href="classMCMCProcessor.html#a4061fd7eeeee55dd709fe844146ed815">hviolin_prior</a>-&gt;GetYaxis()-&gt;FindBin(Entry);</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <a class="code" href="classMCMCProcessor.html#a4061fd7eeeee55dd709fe844146ed815">hviolin_prior</a>-&gt;SetBinContent(x+1, y,  <a class="code" href="classMCMCProcessor.html#a4061fd7eeeee55dd709fe844146ed815">hviolin_prior</a>-&gt;GetBinContent(x+1, y)+1);</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      }</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    }</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  } <span class="comment">// end the for loop over nDraw</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  clock.Stop();</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making Violin plot took {:.2f}s to finish for {} steps&quot;</span>, clock.RealTime(), <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <span class="comment">//KS: Tells how many parameters in one canvas we want</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  constexpr <span class="keywordtype">int</span> IntervalsSize = 10;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> NIntervals = <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>/IntervalsSize;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160; </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  <a class="code" href="classMCMCProcessor.html#a97a9669445c141d9dddc19f1b3562479">hviolin</a>-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Parameter Value&quot;</span>);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  <a class="code" href="classMCMCProcessor.html#a97a9669445c141d9dddc19f1b3562479">hviolin</a>-&gt;GetXaxis()-&gt;SetTitle();</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <a class="code" href="classMCMCProcessor.html#a97a9669445c141d9dddc19f1b3562479">hviolin</a>-&gt;GetXaxis()-&gt;LabelsOption(<span class="stringliteral">&quot;v&quot;</span>);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <a class="code" href="classMCMCProcessor.html#a4061fd7eeeee55dd709fe844146ed815">hviolin_prior</a>-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Parameter Value&quot;</span>);</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <a class="code" href="classMCMCProcessor.html#a4061fd7eeeee55dd709fe844146ed815">hviolin_prior</a>-&gt;GetXaxis()-&gt;SetTitle();</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <a class="code" href="classMCMCProcessor.html#a4061fd7eeeee55dd709fe844146ed815">hviolin_prior</a>-&gt;GetXaxis()-&gt;LabelsOption(<span class="stringliteral">&quot;v&quot;</span>);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; </div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <a class="code" href="classMCMCProcessor.html#a4061fd7eeeee55dd709fe844146ed815">hviolin_prior</a>-&gt;SetLineColor(kRed);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <a class="code" href="classMCMCProcessor.html#a4061fd7eeeee55dd709fe844146ed815">hviolin_prior</a>-&gt;SetMarkerColor(kRed);</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  <a class="code" href="classMCMCProcessor.html#a4061fd7eeeee55dd709fe844146ed815">hviolin_prior</a>-&gt;SetFillColorAlpha(kRed, 0.35);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  <a class="code" href="classMCMCProcessor.html#a4061fd7eeeee55dd709fe844146ed815">hviolin_prior</a>-&gt;SetMarkerStyle(20);</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  <a class="code" href="classMCMCProcessor.html#a4061fd7eeeee55dd709fe844146ed815">hviolin_prior</a>-&gt;SetMarkerSize(0.5);</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160; </div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <span class="comment">// These control violin width, if you use larger then 1 they will most likely overlay, so be cautious</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <a class="code" href="classMCMCProcessor.html#a4061fd7eeeee55dd709fe844146ed815">hviolin_prior</a>-&gt;SetBarWidth(1.0);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <a class="code" href="classMCMCProcessor.html#a4061fd7eeeee55dd709fe844146ed815">hviolin_prior</a>-&gt;SetBarOffset(0);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160; </div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  <a class="code" href="classMCMCProcessor.html#a97a9669445c141d9dddc19f1b3562479">hviolin</a>-&gt;SetLineColor(kBlue);</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <a class="code" href="classMCMCProcessor.html#a97a9669445c141d9dddc19f1b3562479">hviolin</a>-&gt;SetMarkerColor(kBlue);</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <a class="code" href="classMCMCProcessor.html#a97a9669445c141d9dddc19f1b3562479">hviolin</a>-&gt;SetFillColorAlpha(kBlue, 0.35);</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <a class="code" href="classMCMCProcessor.html#a97a9669445c141d9dddc19f1b3562479">hviolin</a>-&gt;SetMarkerStyle(20);</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <a class="code" href="classMCMCProcessor.html#a97a9669445c141d9dddc19f1b3562479">hviolin</a>-&gt;SetMarkerSize(1.0);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> BottomMargin = <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;GetBottomMargin();</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetBottomMargin(0.2);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <a class="code" href="classMCMCProcessor.html#a97a9669445c141d9dddc19f1b3562479">hviolin</a>-&gt;Write(<span class="stringliteral">&quot;param_violin&quot;</span>);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <a class="code" href="classMCMCProcessor.html#a4061fd7eeeee55dd709fe844146ed815">hviolin_prior</a>-&gt;Write(<span class="stringliteral">&quot;param_violin_prior&quot;</span>);</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <span class="comment">//KS: This is mostly for example plots, we have full file in the ROOT file so can do much better plot later</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  <a class="code" href="classMCMCProcessor.html#a97a9669445c141d9dddc19f1b3562479">hviolin</a>-&gt;GetYaxis()-&gt;SetRangeUser(-1, +2);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <a class="code" href="classMCMCProcessor.html#a4061fd7eeeee55dd709fe844146ed815">hviolin_prior</a>-&gt;GetYaxis()-&gt;SetRangeUser(-1, +2);</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; NIntervals+1; ++i)</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  {</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="keywordtype">int</span> RangeMin = i*IntervalsSize;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="keywordtype">int</span> RangeMax =RangeMin + IntervalsSize;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="keywordflow">if</span>(i == NIntervals+1) {</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      RangeMin = i*IntervalsSize;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      RangeMax = <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    }</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="keywordflow">if</span>(RangeMin &gt;= <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160; </div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <a class="code" href="classMCMCProcessor.html#a97a9669445c141d9dddc19f1b3562479">hviolin</a>-&gt;GetXaxis()-&gt;SetRangeUser(RangeMin, RangeMax);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <a class="code" href="classMCMCProcessor.html#a4061fd7eeeee55dd709fe844146ed815">hviolin_prior</a>-&gt;GetXaxis()-&gt;SetRangeUser(RangeMin, RangeMax);</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160; </div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="comment">//KS: ROOT6 has some additional options, consider updating it. more https://root.cern/doc/master/classTHistPainter.html#HP140b</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <a class="code" href="classMCMCProcessor.html#a4061fd7eeeee55dd709fe844146ed815">hviolin_prior</a>-&gt;Draw(<span class="stringliteral">&quot;violinX(03100300)&quot;</span>);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <a class="code" href="classMCMCProcessor.html#a97a9669445c141d9dddc19f1b3562479">hviolin</a>-&gt;Draw(<span class="stringliteral">&quot;violinX(03100300) SAME&quot;</span>);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Print(<a class="code" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  }</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <span class="comment">//KS: Return Margin to default one</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetBottomMargin(BottomMargin);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac9a5fc93b5ac3f6ef7850d21f47fd5dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9a5fc93b5ac3f6ef7850d21f47fd5dd">&#9670;&nbsp;</a></span>ParameterEvolution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::ParameterEvolution </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>Names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>NIntervals</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make .gif of parameter evolution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Names</td><td>Parameter names for which we do .gif </td></tr>
    <tr><td class="paramname">NIntervals</td><td>Number of intervals for a gif </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l03258">3258</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;                                                                         {</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Starting {}&quot;</span>, __func__);</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160; </div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;  <span class="comment">//KS: First we need to find parameter number based on name</span></div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; Names.size(); ++k)</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;  {</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;    <span class="comment">//KS: First we need to find parameter number based on name</span></div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;    <span class="keywordtype">int</span> ParamNo = <a class="code" href="classMCMCProcessor.html#a563df09ed03a95aa8ad2781db9c8807b">GetParamIndexFromName</a>(Names[k]);</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;    <span class="keywordflow">if</span>(ParamNo == <a class="code" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a>)</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;    {</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Couldn&#39;t find param {}. Can&#39;t reweight Prior&quot;</span>, Names[k]);</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;    }</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160; </div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> IntervalsSize = <a class="code" href="classMCMCProcessor.html#aae0016a4e1d105d5d65243438c622a97">nSteps</a>/NIntervals[k];</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;    <span class="comment">// ROOT won&#39;t overwrite gifs so we need to delete the file if it&#39;s there already</span></div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;    std::string filename = Names[k] + <span class="stringliteral">&quot;.gif&quot;</span>;</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;    std::ifstream f(filename);</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;    <span class="keywordflow">if</span> (f.good()) {</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;      f.close();</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;      <span class="keywordtype">int</span> ret = system(fmt::format(<span class="stringliteral">&quot;rm {}&quot;</span>, filename).c_str());</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;      <span class="keywordflow">if</span> (ret != 0) {</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Error: system call to delete {} failed with code {}&quot;</span>, filename, ret);</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;      }</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;    }</div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160; </div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;    <span class="keywordtype">int</span> Counter = 0;</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = NIntervals[k]-1; i &gt;= 0; --i)</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;    {</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;      <span class="comment">// This holds the posterior density</span></div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;      <span class="comment">// KS: WARNING do not change to smart pointer, it breaks and I don&#39;t know why</span></div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;      TH1D* EvePlot = <span class="keyword">new</span> TH1D(<a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[ParamNo], <a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[ParamNo], <a class="code" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a>,</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;                               <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNo]-&gt;GetXaxis()-&gt;GetXmin(), <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNo]-&gt;GetXaxis()-&gt;GetXmax());</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;      EvePlot-&gt;SetMinimum(0);</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;      EvePlot-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;PDF&quot;</span>);</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;      EvePlot-&gt;GetYaxis()-&gt;SetNoExponent(<span class="keyword">false</span>);</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160; </div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;      <span class="comment">//KS: Apply additional Cuts, like mass ordering</span></div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;      std::string CutPosterior1D = <span class="stringliteral">&quot;step &gt; &quot;</span> + std::to_string(i*IntervalsSize+IntervalsSize);</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160; </div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;      <span class="comment">// If Posterior1DCut is not empty, append it</span></div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classMCMCProcessor.html#a85917e25c4f5b5b966c50cccd9ddd6a0">Posterior1DCut</a>.empty()) {</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;        CutPosterior1D += <span class="stringliteral">&quot; &amp;&amp; &quot;</span> + <a class="code" href="classMCMCProcessor.html#a85917e25c4f5b5b966c50cccd9ddd6a0">Posterior1DCut</a>;</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;      }</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160; </div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;      <span class="comment">// Apply reweighting if requested</span></div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#a6f27039da3508952600b1ef26e76fe19">ReweightPosterior</a>) {</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;        CutPosterior1D = <span class="stringliteral">&quot;(&quot;</span> + CutPosterior1D + <span class="stringliteral">&quot;)*(&quot;</span> + <a class="code" href="classMCMCProcessor.html#ad56b25b03eb5caab7b2a9c2ebf3ec178">ReweightName</a> + <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;      }</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160; </div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;      std::string TextTitle = <span class="stringliteral">&quot;Steps = 0 - &quot;</span>+std::to_string(Counter*IntervalsSize+IntervalsSize);</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;      <span class="comment">// Project BranchNames[ParamNo] onto hpost, applying stepcut</span></div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;        <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;Project(<a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[ParamNo], <a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[ParamNo], CutPosterior1D.c_str());</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160; </div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;      EvePlot-&gt;SetLineWidth(2);</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;      EvePlot-&gt;SetLineColor(kBlue-1);</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;      EvePlot-&gt;SetTitle(Names[k].c_str());</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;      EvePlot-&gt;GetXaxis()-&gt;SetTitle(EvePlot-&gt;GetTitle());</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;      EvePlot-&gt;GetYaxis()-&gt;SetLabelOffset(1000);</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a682c1c47626542f5820d633ba2bc010c">ApplySmoothing</a>) EvePlot-&gt;Smooth();</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160; </div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;      EvePlot-&gt;Scale(1. / EvePlot-&gt;Integral());</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;      EvePlot-&gt;Draw(<span class="stringliteral">&quot;HIST&quot;</span>);</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160; </div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;      TText text(0.3, 0.8, TextTitle.c_str());</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;      text.SetTextFont (43);</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;      text.SetTextSize (40);</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;      text.SetNDC(<span class="keyword">true</span>);</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;      text.Draw(<span class="stringliteral">&quot;SAME&quot;</span>);</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160; </div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;      <span class="keywordflow">if</span>(i == 0) <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Print((Names[k] + <span class="stringliteral">&quot;.gif++20&quot;</span>).c_str()); <span class="comment">// produces infinite loop animated GIF</span></div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;      <span class="keywordflow">else</span> <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Print((Names[k] + <span class="stringliteral">&quot;.gif+20&quot;</span>).c_str()); <span class="comment">// add picture to .gif</span></div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;      <span class="keyword">delete</span> EvePlot;</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;      Counter++;</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;    }</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;  }</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a929d6efec80bb4de05eea7011257439a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a929d6efec80bb4de05eea7011257439a">&#9670;&nbsp;</a></span>ParamTraces()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::ParamTraces </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CW: Draw trace plots of the parameters i.e. parameter vs step. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l03526">3526</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;                                {</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;<span class="comment">// *****************</span></div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a> == <span class="keyword">nullptr</span>) <a class="code" href="classMCMCProcessor.html#a930cadafa41b31b58066dea68628de9f">PrepareDiagMCMC</a>();</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making trace plots...&quot;</span>);</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;  <span class="comment">// Make the TH1Ds</span></div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;  std::vector&lt;std::unique_ptr&lt;TH1D&gt;&gt; TraceParamPlots(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;  std::vector&lt;std::unique_ptr&lt;TH1D&gt;&gt; TraceSamplePlots(<a class="code" href="classMCMCProcessor.html#a3660e404a6631cfa913a815481730a9b">SampleName_v</a>.size());</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;  std::vector&lt;std::unique_ptr&lt;TH1D&gt;&gt; TraceSystsPlots(<a class="code" href="classMCMCProcessor.html#acb1871575fdd3ae156aed4bf7c7a0a73">SystName_v</a>.size());</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160; </div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;  <span class="comment">// Set the titles and limits for TH2Ds</span></div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;    <span class="keywordtype">double</span> Prior = 1.0, PriorError = 1.0;</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;    </div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;    <a class="code" href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">GetNthParameter</a>(j, Prior, PriorError, Title);</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;    std::string HistName = Form(<span class="stringliteral">&quot;%s_%s_Trace&quot;</span>, Title.Data(), <a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[j].Data());</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;    TraceParamPlots[j] = std::make_unique&lt;TH1D&gt;(HistName.c_str(), HistName.c_str(), <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>, 0, <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;    TraceParamPlots[j]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;    TraceParamPlots[j]-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Step&quot;</span>);</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;    TraceParamPlots[j]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Parameter Variation&quot;</span>);</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;  }</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160; </div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#a3660e404a6631cfa913a815481730a9b">SampleName_v</a>.size(); ++j) {</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;    std::string HistName = <a class="code" href="classMCMCProcessor.html#a3660e404a6631cfa913a815481730a9b">SampleName_v</a>[j].Data();</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;    TraceSamplePlots[j] = std::make_unique&lt;TH1D&gt;(HistName.c_str(), HistName.c_str(), <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>, 0, <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;    TraceSamplePlots[j]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;    TraceSamplePlots[j]-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Step&quot;</span>);</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;    TraceSamplePlots[j]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Sample -logL&quot;</span>);</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;  }</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160; </div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#acb1871575fdd3ae156aed4bf7c7a0a73">SystName_v</a>.size(); ++j) {</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;    std::string HistName = <a class="code" href="classMCMCProcessor.html#acb1871575fdd3ae156aed4bf7c7a0a73">SystName_v</a>[j].Data();</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;    TraceSystsPlots[j] = std::make_unique&lt;TH1D&gt;(HistName.c_str(), HistName.c_str(), <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>, 0, <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;    TraceSystsPlots[j]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;    TraceSystsPlots[j]-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Step&quot;</span>);</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;    TraceSystsPlots[j]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Systematic -logL&quot;</span>);</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;  }</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160; </div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;  <span class="comment">// Have now made the empty TH1Ds, now for writing content to them!</span></div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;  <span class="comment">// Loop over the number of parameters to draw their traces</span></div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;  <span class="comment">// Each histogram</span></div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;<span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i) {</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;    <span class="comment">// Set bin content for the ith bin to the parameter values</span></div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;      TraceParamPlots[j]-&gt;SetBinContent(i, <a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>[j][i]);</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;    }</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#a3660e404a6631cfa913a815481730a9b">SampleName_v</a>.size(); ++j) {</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;      TraceSamplePlots[j]-&gt;SetBinContent(i, <a class="code" href="classMCMCProcessor.html#a28e89498420221149ec97c353c430bf8">SampleValues</a>[i][j]);</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;    }</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#acb1871575fdd3ae156aed4bf7c7a0a73">SystName_v</a>.size(); ++j) {</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;      TraceSystsPlots[j]-&gt;SetBinContent(i, <a class="code" href="classMCMCProcessor.html#a4eb2748c81b0aef9bd7e14785559e301">SystValues</a>[i][j]);</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;    }</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;  }</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160; </div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;  <span class="comment">// Write the output and delete the TH2Ds</span></div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;  TDirectory *TraceDir = <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Trace&quot;</span>);</div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;  TraceDir-&gt;cd();</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;    <span class="comment">// Fit a linear function to the traces</span></div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;    <span class="keyword">auto</span> Fitter = std::make_unique&lt;TF1&gt;(<span class="stringliteral">&quot;Fitter&quot;</span>, <span class="stringliteral">&quot;[0]&quot;</span>, <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>/2, <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;    Fitter-&gt;SetLineColor(kRed);</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;    TraceParamPlots[j]-&gt;Fit(<span class="stringliteral">&quot;Fitter&quot;</span>,<span class="stringliteral">&quot;Rq&quot;</span>);</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;    TraceParamPlots[j]-&gt;Write();</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;  }</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160; </div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;  TDirectory *LLDir = <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;LogL&quot;</span>);</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;  LLDir-&gt;cd();</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#a3660e404a6631cfa913a815481730a9b">SampleName_v</a>.size(); ++j) {</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;    TraceSamplePlots[j]-&gt;Write();</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="classMCMCProcessor.html#a28e89498420221149ec97c353c430bf8">SampleValues</a>[j];</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;  }</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;  <span class="keyword">delete</span>[] <a class="code" href="classMCMCProcessor.html#a28e89498420221149ec97c353c430bf8">SampleValues</a>;</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160; </div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#acb1871575fdd3ae156aed4bf7c7a0a73">SystName_v</a>.size(); ++j) {</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;    TraceSystsPlots[j]-&gt;Write();</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classMCMCProcessor.html#a4eb2748c81b0aef9bd7e14785559e301">SystValues</a>[j];</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;  }</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;  <span class="keyword">delete</span>[] <a class="code" href="classMCMCProcessor.html#a4eb2748c81b0aef9bd7e14785559e301">SystValues</a>;</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160; </div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;  TraceDir-&gt;Close();</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;  <span class="keyword">delete</span> TraceDir;</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160; </div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a3660e404a6631cfa913a815481730a9b"><div class="ttname"><a href="classMCMCProcessor.html#a3660e404a6631cfa913a815481730a9b">MCMCProcessor::SampleName_v</a></div><div class="ttdeci">std::vector&lt; TString &gt; SampleName_v</div><div class="ttdoc">Vector of each systematic.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00477">MCMCProcessor.h:477</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_acb1871575fdd3ae156aed4bf7c7a0a73"><div class="ttname"><a href="classMCMCProcessor.html#acb1871575fdd3ae156aed4bf7c7a0a73">MCMCProcessor::SystName_v</a></div><div class="ttdeci">std::vector&lt; TString &gt; SystName_v</div><div class="ttdoc">Vector of each sample PDF object.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00479">MCMCProcessor.h:479</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aef760d8c4bb70690a5c4114f4b2409b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef760d8c4bb70690a5c4114f4b2409b3">&#9670;&nbsp;</a></span>PowerSpectrumAnalysis()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::PowerSpectrumAnalysis </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>RC: Perform spectral analysis of MCMC <a class="el" href="citelist.html#CITEREF_Dunkley:2004sv">[7]</a>. </p>
<dl class="section author"><dt>Author</dt><dd>Richard Calland </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000014">Todo:</a></b></dt><dd>KS: Code is awfully slow... I know how to make it faster (GPU scream in a distant) but for now just make it for two params, bit hacky sry... </dd></dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l04213">4213</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;                                          {</div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;  TStopwatch clock;</div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;  clock.Start();</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160; </div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;  <span class="comment">//KS: Store it as we go back to them at the end</span></div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> TopMargin  = <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;GetTopMargin();</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> OptTitle = gStyle-&gt;GetOptTitle();</div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160; </div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetTopMargin(0.1);</div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;  gStyle-&gt;SetOptTitle(1);</div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160; </div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making Power Spectrum plots...&quot;</span>);</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160; </div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;  <span class="comment">// This is only to reduce number of computations...</span></div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> N_Coeffs = std::min(10000, <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> start = -(N_Coeffs/2-1);</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> end = N_Coeffs/2-1;</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> v_size = end - start;</div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160; </div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;  <span class="keywordtype">int</span> nPrams = <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>;</div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;  nPrams = 1;</div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160; </div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;  std::vector&lt;std::vector&lt;float&gt;&gt; k_j(nPrams, std::vector&lt;float&gt;(v_size, 0.0));</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;  std::vector&lt;std::vector&lt;float&gt;&gt; P_j(nPrams, std::vector&lt;float&gt;(v_size, 0.0));</div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160; </div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;  <span class="keywordtype">int</span> _N = <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>;</div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;  <span class="keywordflow">if</span> (_N % 2 != 0) _N -= 1; <span class="comment">// N must be even</span></div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160; </div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;  <span class="comment">//This is being used a lot so calculate it once to increase performance</span></div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> two_pi_over_N = 2 * TMath::Pi() / <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(_N);</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160; </div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;  <span class="comment">// KS: This could be moved to GPU I guess</span></div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;<span class="preprocessor">  #pragma omp parallel for collapse(2)</span></div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;  <span class="comment">// RC: equation 11: for each value of j coef, from range -N/2 -&gt; N/2</span></div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nPrams; ++j)</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;  {</div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = start; jj &lt; end; ++jj)</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;    {</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;      std::complex&lt;M3::float_t&gt; a_j = 0.0;</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> two_pi_over_N_jj = two_pi_over_N * jj;</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; _N; ++n)</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;      {</div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;        <span class="comment">//if(StepNumber[n] &lt; BurnInCut) continue;</span></div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;        std::complex&lt;M3::float_t&gt; exp_temp(0, two_pi_over_N_jj * n);</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;        a_j += <a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>[j][n] * std::exp(exp_temp);</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;      }</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;      a_j /= std::sqrt(<span class="keywordtype">float</span>(_N));</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> _c = jj - start;</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160; </div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;      k_j[j][_c] = two_pi_over_N_jj;</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;      <span class="comment">// Equation 13</span></div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;      P_j[j][_c] = std::norm(a_j);</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;    }</div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;  }</div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160; </div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;  TDirectory *PowerDir = <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;PowerSpectrum&quot;</span>);</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;  PowerDir-&gt;cd();</div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160; </div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;  TVectorD* PowerSpectrumStepSize = <span class="keyword">new</span> TVectorD(nPrams);</div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nPrams; ++j)</div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;  {</div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;    <span class="keyword">auto</span> plot = std::make_unique&lt;TGraph&gt;(v_size, k_j[j].data(), P_j[j].data());</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160; </div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;    <span class="keywordtype">double</span> Prior = 1.0, PriorError = 1.0;</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;    <a class="code" href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">GetNthParameter</a>(j, Prior, PriorError, Title);</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160; </div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;    std::string name = Form(<span class="stringliteral">&quot;Power Spectrum of %s;k;P(k)&quot;</span>, Title.Data());</div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160; </div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;    plot-&gt;SetTitle(name.c_str());</div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;    name = Form(<span class="stringliteral">&quot;%s_power_spectrum&quot;</span>, Title.Data());</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;    plot-&gt;SetName(name.c_str());</div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;    plot-&gt;SetMarkerStyle(7);</div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160; </div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;    <span class="comment">// Equation 18</span></div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;    <span class="keyword">auto</span> func = std::make_unique&lt;TF1&gt;(<span class="stringliteral">&quot;power_template&quot;</span>, <span class="stringliteral">&quot;[0]*( ([1] / x)^[2] / (([1] / x)^[2] +1) )&quot;</span>, 0.0, 1.0);</div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;    <span class="comment">// P0 gives the amplitude of the white noise spectrum in the k  0 limit</span></div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;    func-&gt;SetParameter(0, 10.0);</div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;    <span class="comment">// k* indicates the position of the turnover to a different power law behaviour</span></div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;    func-&gt;SetParameter(1, 0.1);</div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;    <span class="comment">// alpha free parameter</span></div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;    func-&gt;SetParameter(2, 2.0);</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160; </div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;    <span class="comment">// Set parameter limits for stability</span></div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;    func-&gt;SetParLimits(0, 0.0, 100.0); <span class="comment">// Amplitude should be non-negative</span></div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;    func-&gt;SetParLimits(1, 0.001, 1.0); <span class="comment">// k* should be within a reasonable range</span></div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;    func-&gt;SetParLimits(2, 0.0, 5.0);   <span class="comment">// alpha should be positive</span></div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160; </div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;    plot-&gt;Fit(<span class="stringliteral">&quot;power_template&quot;</span>,<span class="stringliteral">&quot;Rq&quot;</span>);</div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160; </div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;    <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetLogx();</div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;    <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetLogy();</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;    <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetGrid();</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;    plot-&gt;Draw(<span class="stringliteral">&quot;AL&quot;</span>);</div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;    func-&gt;Draw(<span class="stringliteral">&quot;SAME&quot;</span>);</div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160; </div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;    <span class="comment">//KS: I have no clue what is the reason behind this. Found this in Rick Calland code...</span></div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;    (*PowerSpectrumStepSize)(j) = std::sqrt(func-&gt;GetParameter(0)/float(v_size*0.5));</div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;  }</div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160; </div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;  PowerSpectrumStepSize-&gt;Write(<span class="stringliteral">&quot;PowerSpectrumStepSize&quot;</span>);</div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;  <span class="keyword">delete</span> PowerSpectrumStepSize;</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;  PowerDir-&gt;Close();</div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;  <span class="keyword">delete</span> PowerDir;</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160; </div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;  clock.Stop();</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making Power Spectrum took {:.2f}s&quot;</span>, clock.RealTime());</div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160; </div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;SetTopMargin(TopMargin);</div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;  gStyle-&gt;SetOptTitle(OptTitle);</div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a930cadafa41b31b58066dea68628de9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a930cadafa41b31b58066dea68628de9f">&#9670;&nbsp;</a></span>PrepareDiagMCMC()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::PrepareDiagMCMC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CW: Prepare branches etc. for DiagMCMC. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l03370">3370</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;                                    {</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;  <a class="code" href="classMCMCProcessor.html#adf449e50cf358f737fe4a2b65d9668e9">doDiagMCMC</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;    </div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;It look like ParStep was already filled &quot;</span>);</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Even though it is used for MakeCovariance_MP and for DiagMCMC&quot;</span>);</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;it has different structure in both for cache hits, sorry &quot;</span>);</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;  }</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a> == 0) {</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;nBatches is equal to 0&quot;</span>);</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;please use SetnBatches to set other value fore example 20&quot;</span>);</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;  }</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;    </div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;  <span class="comment">// Initialise ParStep</span></div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;  <a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a> = <span class="keyword">new</span> <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>*[<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>]();</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;    <a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>[j] = <span class="keyword">new</span> <a class="code" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>[<a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>]();</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i) {</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;      <a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>[j][i] = -999.99;</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;    }</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;  }</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160; </div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;  <a class="code" href="classMCMCProcessor.html#a28e89498420221149ec97c353c430bf8">SampleValues</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>*[<a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>]();</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;  <a class="code" href="classMCMCProcessor.html#a4eb2748c81b0aef9bd7e14785559e301">SystValues</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>*[<a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>]();</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;  <a class="code" href="classMCMCProcessor.html#a88cab29770fd6098a674a0ab3628a251">AccProbValues</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>]();</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;  <a class="code" href="classMCMCProcessor.html#a6058bb3e817401423231f85a71db46a0">StepNumber</a> = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>[<a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>]();</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i) {</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;    <a class="code" href="classMCMCProcessor.html#a28e89498420221149ec97c353c430bf8">SampleValues</a>[i] = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classMCMCProcessor.html#a3660e404a6631cfa913a815481730a9b">SampleName_v</a>.size()]();</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;    <a class="code" href="classMCMCProcessor.html#a4eb2748c81b0aef9bd7e14785559e301">SystValues</a>[i] = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classMCMCProcessor.html#acb1871575fdd3ae156aed4bf7c7a0a73">SystName_v</a>.size()]();</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160; </div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#a3660e404a6631cfa913a815481730a9b">SampleName_v</a>.size(); ++j) {</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;      <a class="code" href="classMCMCProcessor.html#a28e89498420221149ec97c353c430bf8">SampleValues</a>[i][j] = -999.99;</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;    }</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#acb1871575fdd3ae156aed4bf7c7a0a73">SystName_v</a>.size(); ++j) {</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;      <a class="code" href="classMCMCProcessor.html#a4eb2748c81b0aef9bd7e14785559e301">SystValues</a>[i][j] = -999.99;</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;    }</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;    <a class="code" href="classMCMCProcessor.html#a88cab29770fd6098a674a0ab3628a251">AccProbValues</a>[i] = -999.99;</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;    <a class="code" href="classMCMCProcessor.html#a6058bb3e817401423231f85a71db46a0">StepNumber</a>[i] = 0;</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;  }</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160; </div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Reading input tree...&quot;</span>);</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;  TStopwatch clock;</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;  clock.Start();</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160; </div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;  <span class="comment">// Set all the branches to off</span></div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;  <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchStatus(<span class="stringliteral">&quot;*&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160; </div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;  <span class="comment">// 10 entries output</span></div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> countwidth = <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>/10;</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160; </div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;  <span class="comment">// Can also do the batched means here to minimize excessive loops</span></div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;  <span class="comment">// The length of each batch</span></div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> BatchLength = <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>/<a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>+1;</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;  <a class="code" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>*[<a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>]();</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;  <a class="code" href="classMCMCProcessor.html#a523a223a4754c133121796f4591c7be3">AccProbBatchedAverages</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>]();</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>; ++i) {</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;    <a class="code" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i] = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>];</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;    <a class="code" href="classMCMCProcessor.html#a523a223a4754c133121796f4591c7be3">AccProbBatchedAverages</a>[i] = 0;</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;      <a class="code" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i][j] = 0.0;</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;    }</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;  }</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;  std::vector&lt;double&gt; ParStepBranch(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;  std::vector&lt;double&gt; SampleValuesBranch(<a class="code" href="classMCMCProcessor.html#a3660e404a6631cfa913a815481730a9b">SampleName_v</a>.size());</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;  std::vector&lt;double&gt; SystValuesBranch(<a class="code" href="classMCMCProcessor.html#acb1871575fdd3ae156aed4bf7c7a0a73">SystName_v</a>.size());</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> StepNumberBranch = 0;</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;  <span class="keywordtype">double</span> AccProbValuesBranch = 0;</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;  <span class="comment">// Set the branch addresses for params</span></div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;    <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchStatus(<a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[j].Data(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;    <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchAddress(<a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[j].Data(), &amp;ParStepBranch[j]);</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;  }</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;  <span class="comment">// Set the branch addresses for samples</span></div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#a3660e404a6631cfa913a815481730a9b">SampleName_v</a>.size(); ++j) {</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;    <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchStatus(<a class="code" href="classMCMCProcessor.html#a3660e404a6631cfa913a815481730a9b">SampleName_v</a>[j].Data(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;    <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchAddress(<a class="code" href="classMCMCProcessor.html#a3660e404a6631cfa913a815481730a9b">SampleName_v</a>[j].Data(), &amp;SampleValuesBranch[j]);</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;  }</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;  <span class="comment">// Set the branch addresses for systematics</span></div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#acb1871575fdd3ae156aed4bf7c7a0a73">SystName_v</a>.size(); ++j) {</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;    <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchStatus(<a class="code" href="classMCMCProcessor.html#acb1871575fdd3ae156aed4bf7c7a0a73">SystName_v</a>[j].Data(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;    <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchAddress(<a class="code" href="classMCMCProcessor.html#acb1871575fdd3ae156aed4bf7c7a0a73">SystName_v</a>[j].Data(), &amp;SystValuesBranch[j]);</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;  }</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;  <span class="comment">// Only needed for Geweke right now</span></div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;  <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchStatus(<span class="stringliteral">&quot;step&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;  <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchAddress(<span class="stringliteral">&quot;step&quot;</span>, &amp;StepNumberBranch);</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;  <span class="comment">// Turn on the branches which we want for acc prob</span></div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;  <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchStatus(<span class="stringliteral">&quot;accProb&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;  <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchAddress(<span class="stringliteral">&quot;accProb&quot;</span>, &amp;AccProbValuesBranch);</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160; </div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;  <span class="comment">// Loop over the entries</span></div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;  <span class="comment">//KS: This is really a bottleneck right now, thus revisit with ROOT6 https://pep-root6.github.io/docs/analysis/parallell/root.html</span></div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i) {</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;    <span class="comment">// Fill up the arrays</span></div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;    <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetEntry(i);</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160; </div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;    <span class="keywordflow">if</span> (i % countwidth == 0)</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;      <a class="code" href="namespaceMaCh3Utils.html#a4c8bdeb1d34606aed192e9f1311a72f5">MaCh3Utils::PrintProgressBar</a>(i, <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160; </div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;    <span class="comment">// Set the branch addresses for params</span></div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;      <a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>[j][i] = ParStepBranch[j];</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;    }</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;    <span class="comment">// Set the branch addresses for samples</span></div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#a3660e404a6631cfa913a815481730a9b">SampleName_v</a>.size(); ++j) {</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;      <a class="code" href="classMCMCProcessor.html#a28e89498420221149ec97c353c430bf8">SampleValues</a>[i][j] = SampleValuesBranch[j];</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;    }</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;    <span class="comment">// Set the branch addresses for systematics</span></div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#acb1871575fdd3ae156aed4bf7c7a0a73">SystName_v</a>.size(); ++j) {</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;      <a class="code" href="classMCMCProcessor.html#a4eb2748c81b0aef9bd7e14785559e301">SystValues</a>[i][j] = SystValuesBranch[j];</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;    }</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;      </div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;    <span class="comment">// Set the branch addresses for Acceptance Probability</span></div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;    <a class="code" href="classMCMCProcessor.html#a88cab29770fd6098a674a0ab3628a251">AccProbValues</a>[i] = AccProbValuesBranch;</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;    <a class="code" href="classMCMCProcessor.html#a6058bb3e817401423231f85a71db46a0">StepNumber</a>[i] = StepNumberBranch;</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160; </div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;    <span class="comment">// Find which batch the event belongs in</span></div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;    <span class="keywordtype">int</span> BatchNumber = -1;</div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;    <span class="comment">// I&#39;m so lazy! But it&#39;s OK, the major overhead here is GetEntry: saved by ROOT!</span></div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>; ++j) {</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;      <span class="keywordflow">if</span> (i &lt; (j+1)*BatchLength) {</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;        BatchNumber = j;</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;      }</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;    }</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;    <span class="comment">// Fill up the sum for each j param</span></div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;      <a class="code" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[BatchNumber][j] += <a class="code" href="classMCMCProcessor.html#a200b389934dcb87bf091229fb7b3fa9f">ParStep</a>[j][i];</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;    }</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;    </div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;    <span class="comment">//KS: Could easily add this to above loop but I accProb is different beast so better keep it like this</span></div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;    <a class="code" href="classMCMCProcessor.html#a523a223a4754c133121796f4591c7be3">AccProbBatchedAverages</a>[BatchNumber] += <a class="code" href="classMCMCProcessor.html#a88cab29770fd6098a674a0ab3628a251">AccProbValues</a>[i];</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;  }</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;  clock.Stop();</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Took {:.2f}s to finish caching statistic for Diag MCMC with {} steps&quot;</span>, clock.RealTime(), <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160; </div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;  <span class="comment">// Make the sums into average</span></div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;<span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i) {</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>; ++j) {</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;      <span class="comment">// Divide by the total number of events in the batch</span></div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;      <a class="code" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[j][i] /= BatchLength;</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;      <span class="keywordflow">if</span>(i == 0) <a class="code" href="classMCMCProcessor.html#a523a223a4754c133121796f4591c7be3">AccProbBatchedAverages</a>[j] /= BatchLength; <span class="comment">//KS: we have only one accProb, keep it like this for now</span></div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;    }</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;  }</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160; </div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;  <span class="comment">// And make our sweet output file</span></div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a> == <span class="keyword">nullptr</span>) <a class="code" href="classMCMCProcessor.html#aa5a7761e97cf2e24c7d877a5374b7333">MakeOutputFile</a>();</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1229c5b253883017c4efd636cdd7071e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1229c5b253883017c4efd636cdd7071e">&#9670;&nbsp;</a></span>PrintInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::PrintInfo </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Print info like how many params have been loaded etc. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l04569">4569</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;                                    {</div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;  <span class="comment">// KS: Create a map to store the counts of unique strings</span></div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;  std::unordered_map&lt;std::string, int&gt; paramCounts;</div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;  std::vector&lt;std::string&gt; orderedKeys;</div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160; </div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> std::string&amp; param : <a class="code" href="classMCMCProcessor.html#ab72dd21faa732ec38e550c37635ee66d">ParameterGroup</a>) {</div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;    <span class="keywordflow">if</span> (paramCounts[param] == 0) {</div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;      orderedKeys.push_back(param);  <span class="comment">// preserve order of first appearance</span></div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;    }</div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;    paramCounts[param]++;</div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;  }</div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160; </div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;************************************************&quot;</span>);</div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Scanning output branches...&quot;</span>);</div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;# Useful entries in tree: \033[1;32m {} \033[0m &quot;</span>, <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;# Model params:  \033[1;32m {} starting at {} \033[0m &quot;</span>, <a class="code" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>], <a class="code" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>]);</div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;# With following groups: &quot;</span>);</div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> std::string&amp; key : orderedKeys) {</div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot; # {} params: {}&quot;</span>, key, paramCounts[key]);</div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;  }</div>
<div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;# ND params (legacy):    \033[1;32m {} starting at {} \033[0m &quot;</span>, <a class="code" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>], <a class="code" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>]);</div>
<div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;# FD params (legacy):    \033[1;32m {} starting at {} \033[0m &quot;</span>, <a class="code" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>], <a class="code" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>]);</div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;************************************************&quot;</span>);</div>
<div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5ea421c8dd77ceac2e748008633b573"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5ea421c8dd77ceac2e748008633b573">&#9670;&nbsp;</a></span>ReadFDFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::ReadFDFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read the FD cov file and get the input central values and errors. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02658">2658</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;                               {</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;<span class="comment">// ***************</span></div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;  <span class="comment">// Do the same for the FD</span></div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;  TFile *FDdetFile = <a class="code" href="namespaceM3.html#a87841bdbf0e0a2a733d9e4ca499f820d">M3::Open</a>(<a class="code" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>].back(), <span class="stringliteral">&quot;open&quot;</span>, __FILE__, __LINE__);</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;  FDdetFile-&gt;cd();</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160; </div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;  TMatrixD *FDdetMatrix = FDdetFile-&gt;Get&lt;TMatrixD&gt;(<a class="code" href="classMCMCProcessor.html#a4a43ac10847a053db74553682f15e1d5">CovNamePos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>].c_str());</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160; </div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; FDdetMatrix-&gt;GetNrows(); ++i)</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;  {</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;    <span class="comment">//KS: FD parameters start at 1. in contrary to ND280</span></div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;    <a class="code" href="classMCMCProcessor.html#a3a6614826ae320e462211e38e96d9d02">ParamCentral</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>].push_back(1.);</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160; </div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;    <a class="code" href="classMCMCProcessor.html#a3a97e3cb4be3ceb9eb721eac51d82d60">ParamErrors</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>].push_back( std::sqrt((*FDdetMatrix)(i,i)) );</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;    <a class="code" href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">ParamNames</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>].push_back( Form(<span class="stringliteral">&quot;FD Det %i&quot;</span>, i) );</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160; </div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;    <span class="comment">//KS: Currently we can only set it via config, change it in future</span></div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;    <a class="code" href="classMCMCProcessor.html#a4be1eedb743e4ea410009a4fa45720f7">ParamFlat</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>].push_back( <span class="keyword">false</span> );</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;  }</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;  <span class="comment">//KS: The last parameter is p scale</span></div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;  <span class="comment">//ETA: we need to be careful here, this is only true for SK in the T2K beam analysis...</span></div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#ad25fe818c94163b0c4a8fcdfd387c148">FancyPlotNames</a>) <a class="code" href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">ParamNames</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>].back() = <span class="stringliteral">&quot;Momentum Scale&quot;</span>;</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160; </div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;  FDdetFile-&gt;Close();</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;  <span class="keyword">delete</span> FDdetFile;</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;  <span class="keyword">delete</span> FDdetMatrix;</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afef48d4fccf7551dc1845f8f6c08864f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afef48d4fccf7551dc1845f8f6c08864f">&#9670;&nbsp;</a></span>ReadInputCov()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::ReadInputCov </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CW: Read the input Covariance matrix entries. Get stuff like parameter input errors, names, and so on. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02430">2430</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;                                 {</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;  <a class="code" href="classMCMCProcessor.html#aea15e730ff77556bb93bc4cff675744c">FindInputFiles</a>();</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>].back() != <span class="stringliteral">&quot;none&quot;</span>) <a class="code" href="classMCMCProcessor.html#a1862b7515a306c21916e2992d897d2ea">ReadModelFile</a>();</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a1862b7515a306c21916e2992d897d2ea"><div class="ttname"><a href="classMCMCProcessor.html#a1862b7515a306c21916e2992d897d2ea">MCMCProcessor::ReadModelFile</a></div><div class="ttdeci">void ReadModelFile()</div><div class="ttdoc">Read the xsec file and get the input central values and errors.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02561">MCMCProcessor.cpp:2561</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aea15e730ff77556bb93bc4cff675744c"><div class="ttname"><a href="classMCMCProcessor.html#aea15e730ff77556bb93bc4cff675744c">MCMCProcessor::FindInputFiles</a></div><div class="ttdeci">void FindInputFiles()</div><div class="ttdoc">Read the output MCMC file and find what inputs were used.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02448">MCMCProcessor.cpp:2448</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0e758c91b6f57a75544a0c61228f8dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0e758c91b6f57a75544a0c61228f8dc">&#9670;&nbsp;</a></span>ReadInputCovLegacy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::ReadInputCovLegacy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section warning"><dt>Warning</dt><dd>This will no longer be supported in future </dd></dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02439">2439</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;                                       {</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;  <a class="code" href="classMCMCProcessor.html#a897c04312518965436704334ebbc9c01">FindInputFilesLegacy</a>();</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>] &gt; 0)    <a class="code" href="classMCMCProcessor.html#a66dd0f1f88dbeb2b6a1976d42f77e136">ReadNDFile</a>();</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>] &gt; 0) <a class="code" href="classMCMCProcessor.html#ae5ea421c8dd77ceac2e748008633b573">ReadFDFile</a>();</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a66dd0f1f88dbeb2b6a1976d42f77e136"><div class="ttname"><a href="classMCMCProcessor.html#a66dd0f1f88dbeb2b6a1976d42f77e136">MCMCProcessor::ReadNDFile</a></div><div class="ttdeci">void ReadNDFile()</div><div class="ttdoc">Read the ND cov file and get the input central values and errors.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02620">MCMCProcessor.cpp:2620</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a897c04312518965436704334ebbc9c01"><div class="ttname"><a href="classMCMCProcessor.html#a897c04312518965436704334ebbc9c01">MCMCProcessor::FindInputFilesLegacy</a></div><div class="ttdeci">void FindInputFilesLegacy()</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02513">MCMCProcessor.cpp:2513</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ae5ea421c8dd77ceac2e748008633b573"><div class="ttname"><a href="classMCMCProcessor.html#ae5ea421c8dd77ceac2e748008633b573">MCMCProcessor::ReadFDFile</a></div><div class="ttdeci">void ReadFDFile()</div><div class="ttdoc">Read the FD cov file and get the input central values and errors.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02658">MCMCProcessor.cpp:2658</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1862b7515a306c21916e2992d897d2ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1862b7515a306c21916e2992d897d2ea">&#9670;&nbsp;</a></span>ReadModelFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::ReadModelFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read the xsec file and get the input central values and errors. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02561">2561</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;                                  {</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;<span class="comment">// ***************</span></div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;  YAML::Node XSecFile = <a class="code" href="classMCMCProcessor.html#a4c1330a025c0b91e382bdc29c960424a">CovConfig</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>];</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160; </div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;  <span class="keyword">auto</span> systematics = XSecFile[<span class="stringliteral">&quot;Systematics&quot;</span>];</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;  <span class="keywordtype">int</span> paramIndex  = 0;</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = systematics.begin(); it != systematics.end(); ++it, ++paramIndex )</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;  {</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> &amp;param = *it;</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;    <span class="comment">// Push back the name</span></div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    std::string ParName = (param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;Names&quot;</span>][<span class="stringliteral">&quot;FancyName&quot;</span>].as&lt;std::string&gt;());</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    std::string Group = param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;ParameterGroup&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160; </div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;    <span class="keywordtype">bool</span> rejected = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ik = 0; ik &lt; <a class="code" href="classMCMCProcessor.html#a7425f7802e50bcb5ff4b38e20157c423">ExcludedNames</a>.size(); ++ik)</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;    {</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;      <span class="keywordflow">if</span> (ParName.rfind(<a class="code" href="classMCMCProcessor.html#a7425f7802e50bcb5ff4b38e20157c423">ExcludedNames</a>[ik], 0) == 0)</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;      {</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a>(<span class="stringliteral">&quot;Excluding param {}, from group {}&quot;</span>, ParName, Group);</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;        rejected = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;      }</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;    }</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ik = 0; ik &lt; <a class="code" href="classMCMCProcessor.html#a8221ad9d7c814e978a302be016d5f6b8">ExcludedGroups</a>.size(); ++ik)</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;    {</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;      <span class="keywordflow">if</span> (Group == <a class="code" href="classMCMCProcessor.html#a8221ad9d7c814e978a302be016d5f6b8">ExcludedGroups</a>[ik])</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;      {</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a>(<span class="stringliteral">&quot;Excluding param {}, from group {}&quot;</span>, ParName, Group);</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;        rejected = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;      }</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;    }</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;    <span class="keywordflow">if</span>(rejected) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160; </div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;    <a class="code" href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">ParamNames</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>].push_back(ParName);</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;    <a class="code" href="classMCMCProcessor.html#a3a6614826ae320e462211e38e96d9d02">ParamCentral</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>].push_back(param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;ParameterValues&quot;</span>][<span class="stringliteral">&quot;PreFitValue&quot;</span>].as&lt;double&gt;());</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;    <a class="code" href="classMCMCProcessor.html#a3a97e3cb4be3ceb9eb721eac51d82d60">ParamErrors</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>].push_back(param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;Error&quot;</span>].as&lt;double&gt;() );</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;    <a class="code" href="classMCMCProcessor.html#a4be1eedb743e4ea410009a4fa45720f7">ParamFlat</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>].push_back(GetFromManager&lt;bool&gt;(param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;FlatPrior&quot;</span>], <span class="keyword">false</span>));</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160; </div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;    <a class="code" href="classMCMCProcessor.html#ab72dd21faa732ec38e550c37635ee66d">ParameterGroup</a>.push_back(Group);</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160; </div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;    <a class="code" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>]++;</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;    <a class="code" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>.push_back(<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>);</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;    <span class="comment">// Params from osc group have branch name equal to fancy name while all others are basically xsec_0 for example</span></div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#ab72dd21faa732ec38e550c37635ee66d">ParameterGroup</a>.back() == <span class="stringliteral">&quot;Osc&quot;</span>) {</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;      <a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>.push_back(<a class="code" href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">ParamNames</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>].back());</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;      <a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>.push_back(<span class="stringliteral">&quot;param_&quot;</span> + std::to_string(paramIndex));</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;    }</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160; </div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;    <span class="comment">// Check that the branch exists before setting address</span></div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetBranch(<a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>.back())) {</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Couldn&#39;t find branch &#39;{}&#39;, if you are not planning to draw posteriors this might be fine&quot;</span>, <a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>.back());</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;    }</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;  }</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a7425f7802e50bcb5ff4b38e20157c423"><div class="ttname"><a href="classMCMCProcessor.html#a7425f7802e50bcb5ff4b38e20157c423">MCMCProcessor::ExcludedNames</a></div><div class="ttdeci">std::vector&lt; std::string &gt; ExcludedNames</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00453">MCMCProcessor.h:453</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a8221ad9d7c814e978a302be016d5f6b8"><div class="ttname"><a href="classMCMCProcessor.html#a8221ad9d7c814e978a302be016d5f6b8">MCMCProcessor::ExcludedGroups</a></div><div class="ttdeci">std::vector&lt; std::string &gt; ExcludedGroups</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00454">MCMCProcessor.h:454</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a66dd0f1f88dbeb2b6a1976d42f77e136"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66dd0f1f88dbeb2b6a1976d42f77e136">&#9670;&nbsp;</a></span>ReadNDFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::ReadNDFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read the ND cov file and get the input central values and errors. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02620">2620</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;                               {</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;<span class="comment">// ***************</span></div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;  <span class="comment">// Do the same for the ND280</span></div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;  TFile *NDdetFile = <a class="code" href="namespaceM3.html#a87841bdbf0e0a2a733d9e4ca499f820d">M3::Open</a>(<a class="code" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>].back(), <span class="stringliteral">&quot;open&quot;</span>, __FILE__, __LINE__);</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;  NDdetFile-&gt;cd();</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160; </div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;  TMatrixDSym *NDdetMatrix = NDdetFile-&gt;Get&lt;TMatrixDSym&gt;(<a class="code" href="classMCMCProcessor.html#a4a43ac10847a053db74553682f15e1d5">CovNamePos</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>].c_str());</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;  TVectorD *NDdetNominal = NDdetFile-&gt;Get&lt;TVectorD&gt;(<span class="stringliteral">&quot;det_weights&quot;</span>);</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;  TDirectory *BinningDirectory = NDdetFile-&gt;Get&lt;TDirectory&gt;(<span class="stringliteral">&quot;Binning&quot;</span>);</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160; </div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; NDdetNominal-&gt;GetNrows(); ++i)</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;  {</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;    <a class="code" href="classMCMCProcessor.html#a3a6614826ae320e462211e38e96d9d02">ParamCentral</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>].push_back( (*NDdetNominal)(i) );</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160; </div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    <a class="code" href="classMCMCProcessor.html#a3a97e3cb4be3ceb9eb721eac51d82d60">ParamErrors</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>].push_back( std::sqrt((*NDdetMatrix)(i,i)) );</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;    <a class="code" href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">ParamNames</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>].push_back( Form(<span class="stringliteral">&quot;ND Det %i&quot;</span>, i) );</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;    <span class="comment">//KS: Currently we can only set it via config, change it in future</span></div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;    <a class="code" href="classMCMCProcessor.html#a4be1eedb743e4ea410009a4fa45720f7">ParamFlat</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>].push_back( <span class="keyword">false</span> );</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;  }</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160; </div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;  TIter next(BinningDirectory-&gt;GetListOfKeys());</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;  TKey *key = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;  <span class="comment">// Loop through all entries</span></div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;  <span class="keywordflow">while</span> ((key = <span class="keyword">static_cast&lt;</span>TKey*<span class="keyword">&gt;</span>(next())))</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;  {</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;    std::string name = std::string(key-&gt;GetName());</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;    TH2Poly* RefPoly = BinningDirectory-&gt;Get&lt;TH2Poly&gt;((name).c_str());</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;    <span class="keywordtype">int</span> size = RefPoly-&gt;GetNumberOfBins();</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;    <a class="code" href="classMCMCProcessor.html#ab2649d6e851ec0a08985a35da299fa5b">NDSamplesBins</a>.push_back(size);</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;    <a class="code" href="classMCMCProcessor.html#aab80e0a8be27cc9206e1834a2f1f1ca2">NDSamplesNames</a>.push_back(RefPoly-&gt;GetTitle());</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;  }</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160; </div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;  NDdetFile-&gt;Close();</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;  <span class="keyword">delete</span> NDdetFile;</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a08d9a19ff49682bfea54381419d6432a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08d9a19ff49682bfea54381419d6432a">&#9670;&nbsp;</a></span>Reset2DPosteriors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::Reset2DPosteriors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset 2D posteriors, in case we would like to calculate in again with different BurnInCut. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02753">2753</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;                                      {</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;<span class="comment">// **************************************************</span></div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;<span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i) </div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;  {</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;    {</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;      <span class="comment">// TH2D to hold the Correlation </span></div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;      <a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i][j]-&gt;Reset(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;      <a class="code" href="classMCMCProcessor.html#ac924273ef73ef60a5f6e8a166918bb31">hpost2D</a>[i][j]-&gt;Fill(0.0, 0.0, 0.0);</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;    }</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;  }</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad3b1cfab21c7063bc29d1cf5dcca888c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3b1cfab21c7063bc29d1cf5dcca888c">&#9670;&nbsp;</a></span>ReweightPrior()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::ReweightPrior </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>Names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>NewCentral</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>NewError</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reweight Prior by giving new central value and new error. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Names</td><td>Parameter names for which we do reweighting </td></tr>
    <tr><td class="paramname">NewCentral</td><td>New central value for which we reweight </td></tr>
    <tr><td class="paramname">NewError</td><td>New error used for calculating weight </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l03039">3039</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;                                                                     {</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Reweighting Prior&quot;</span>);</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160; </div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;  <span class="keywordflow">if</span>( (Names.size() != NewCentral.size()) || (NewCentral.size() != NewError.size()))</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;  {</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Size of passed vectors doesn&#39;t match in {}&quot;</span>, __func__);</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;  }</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;  std::vector&lt;int&gt; Param;</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;  std::vector&lt;double&gt; OldCentral;</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;  std::vector&lt;double&gt; OldError;</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;  std::vector&lt;bool&gt; FlatPrior;</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160; </div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;  <span class="comment">//KS: First we need to find parameter number based on name</span></div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; Names.size(); ++k)</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;  {</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;    <span class="comment">//KS: First we need to find parameter number based on name</span></div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;    <span class="keywordtype">int</span> ParamNo = <a class="code" href="classMCMCProcessor.html#a563df09ed03a95aa8ad2781db9c8807b">GetParamIndexFromName</a>(Names[k]);</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;    <span class="keywordflow">if</span>(ParamNo == <a class="code" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a>)</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;    {</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Couldn&#39;t find param {}. Can&#39;t reweight Prior&quot;</span>, Names[k]);</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;    }</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160; </div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;    <span class="keywordtype">double</span> Prior = 1.0, PriorError = 1.0;</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;    <a class="code" href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">GetNthParameter</a>(ParamNo, Prior, PriorError, Title);</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160; </div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;    Param.push_back(ParamNo);</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;    OldCentral.push_back(Prior);</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;    OldError.push_back(PriorError);</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160; </div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;    <a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20b">ParameterEnum</a> ParType = <a class="code" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>[ParamNo];</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;    <span class="keywordtype">int</span> ParamTemp = ParamNo - <a class="code" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[ParType];</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160; </div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;    FlatPrior.push_back(<a class="code" href="classMCMCProcessor.html#a4be1eedb743e4ea410009a4fa45720f7">ParamFlat</a>[ParType][ParamTemp]);</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;  }</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;  std::vector&lt;double&gt; ParameterPos(Names.size());</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160; </div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;  std::string InputFile = <a class="code" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a>+<span class="stringliteral">&quot;.root&quot;</span>;</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;  std::string OutputFilename = <a class="code" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a> + <span class="stringliteral">&quot;_reweighted.root&quot;</span>;</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160; </div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;  <span class="comment">//KS: Simply create copy of file and add there new branch</span></div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;  <span class="keywordtype">int</span> ret = system((<span class="stringliteral">&quot;cp &quot;</span> + InputFile + <span class="stringliteral">&quot; &quot;</span> + OutputFilename).c_str());</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;  <span class="keywordflow">if</span> (ret != 0)</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Error: system call to copy file failed with code {}&quot;</span>, ret);</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160; </div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;  TFile *OutputChain = <a class="code" href="namespaceM3.html#a87841bdbf0e0a2a733d9e4ca499f820d">M3::Open</a>(OutputFilename, <span class="stringliteral">&quot;UPDATE&quot;</span>, __FILE__, __LINE__);</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;  OutputChain-&gt;cd();</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;  TTree *post = OutputChain-&gt;Get&lt;TTree&gt;(<span class="stringliteral">&quot;posteriors&quot;</span>);</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160; </div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;  <span class="keywordtype">double</span> Weight = 1.;</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160; </div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;  post-&gt;SetBranchStatus(<span class="stringliteral">&quot;*&quot;</span>,<span class="keyword">false</span>);</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;  <span class="comment">// Set the branch addresses for params</span></div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; Names.size(); ++j) {</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;    post-&gt;SetBranchStatus(<a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[Param[j]].Data(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;    post-&gt;SetBranchAddress(<a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[Param[j]].Data(), &amp;ParameterPos[j]);</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;  }</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;  TBranch *bpt = post-&gt;Branch(<span class="stringliteral">&quot;Weight&quot;</span>, &amp;Weight, <span class="stringliteral">&quot;Weight/D&quot;</span>);</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;  post-&gt;SetBranchStatus(<span class="stringliteral">&quot;Weight&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160; </div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i)</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;  {</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;    <span class="keywordflow">if</span>(i % (<a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>/10) == 0) <a class="code" href="namespaceMaCh3Utils.html#a4c8bdeb1d34606aed192e9f1311a72f5">MaCh3Utils::PrintProgressBar</a>(i, <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;    post-&gt;GetEntry(i);</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;    Weight = 1.;</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160; </div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;    <span class="comment">//KS: Calculate reweight weight. Weights are multiplicative so we can do several reweights at once. FIXME Big limitation is that code only works for uncorrelated parameters :(</span></div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; Names.size(); ++j)</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;    {</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;      <span class="keywordtype">double</span> new_chi = (ParameterPos[j] - NewCentral[j])/NewError[j];</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;      <span class="keywordtype">double</span> new_prior = std::exp(-0.5 * new_chi * new_chi);</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160; </div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;      <span class="keywordtype">double</span> old_chi = -1;</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;      <span class="keywordtype">double</span> old_prior = -1;</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;      <span class="keywordflow">if</span>(FlatPrior[j]) {</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;        old_prior = 1.0;</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;        old_chi = (ParameterPos[j] - OldCentral[j])/OldError[j];</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;        old_prior = std::exp(-0.5 * old_chi * old_chi);</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;      }</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;      Weight *= new_prior/old_prior;</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;    }</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;    bpt-&gt;Fill();</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;  }</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;  post-&gt;SetBranchStatus(<span class="stringliteral">&quot;*&quot;</span>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;  OutputChain-&gt;cd();</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;  post-&gt;Write(<span class="stringliteral">&quot;posteriors&quot;</span>, TObject::kOverwrite);</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160; </div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;  <span class="comment">// KS: Save reweight metadeta</span></div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;  std::ostringstream yaml_stream;</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;  yaml_stream &lt;&lt; <span class="stringliteral">&quot;Weight:\n&quot;</span>;</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;  yaml_stream &lt;&lt; <span class="stringliteral">&quot;  ReweightDim: 1\n&quot;</span>;</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;  yaml_stream &lt;&lt; <span class="stringliteral">&quot;  ReweightType: \&quot;Gaussian\&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;  yaml_stream &lt;&lt; <span class="stringliteral">&quot;  ReweightVar: [&quot;</span>;</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; Names.size(); ++k) {</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;    yaml_stream &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt; Names[k] &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span>;</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;    <span class="keywordflow">if</span> (k &lt; Names.size() - 1) yaml_stream &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;  }</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;  yaml_stream &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>;</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;  yaml_stream &lt;&lt; <span class="stringliteral">&quot;  ReweightPrior: [&quot;</span>;</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; Names.size(); ++k) {</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;    yaml_stream &lt;&lt; <span class="stringliteral">&quot;[&quot;</span> &lt;&lt; NewCentral[k] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; NewError[k] &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;    <span class="keywordflow">if</span> (k &lt; Names.size() - 1) yaml_stream &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;  }</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;  yaml_stream &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>;</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;  std::string yaml_string = yaml_stream.str();</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;  YAML::Node root = <a class="code" href="YamlHelper_8h.html#a3ff1f2154c0a70ad5a145fcc5891e7ec">STRINGtoYAML</a>(yaml_string);</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;  TMacro ConfigSave = <a class="code" href="YamlHelper_8h.html#a2d4f3247b6e13ef8c127ff66e699d3cb">YAMLtoTMacro</a>(root, <span class="stringliteral">&quot;Reweight_Config&quot;</span>);</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;  ConfigSave.Write();</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160; </div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;  OutputChain-&gt;Close();</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;  <span class="keyword">delete</span> OutputChain;</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160; </div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;  <a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;}</div>
<div class="ttc" id="aYamlHelper_8h_html_a2d4f3247b6e13ef8c127ff66e699d3cb"><div class="ttname"><a href="YamlHelper_8h.html#a2d4f3247b6e13ef8c127ff66e699d3cb">YAMLtoTMacro</a></div><div class="ttdeci">TMacro YAMLtoTMacro(const YAML::Node &amp;yaml_node, const std::string &amp;name)</div><div class="ttdoc">Convert a YAML node to a ROOT TMacro object.</div><div class="ttdef"><b>Definition:</b> <a href="YamlHelper_8h_source.html#l00167">YamlHelper.h:167</a></div></div>
<div class="ttc" id="aYamlHelper_8h_html_a3ff1f2154c0a70ad5a145fcc5891e7ec"><div class="ttname"><a href="YamlHelper_8h.html#a3ff1f2154c0a70ad5a145fcc5891e7ec">STRINGtoYAML</a></div><div class="ttdeci">YAML::Node STRINGtoYAML(const std::string &amp;yaml_string)</div><div class="ttdoc">Function to convert a YAML string to a YAML node.</div><div class="ttdef"><b>Definition:</b> <a href="YamlHelper_8h_source.html#l00097">YamlHelper.h:97</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af69384c2db282bb76e74beb15644ec2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af69384c2db282bb76e74beb15644ec2a">&#9670;&nbsp;</a></span>SavageDickeyPlot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SavageDickeyPlot </td>
          <td>(</td>
          <td class="paramtype">std::unique_ptr&lt; TH1D &gt; &amp;&#160;</td>
          <td class="paramname"><em>PriorHist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; TH1D &gt; &amp;&#160;</td>
          <td class="paramname"><em>PosteriorHist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>Title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>EvaluationPoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Produce Savage Dickey plot. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PriorHist</td><td>Histogram with prior distribution </td></tr>
    <tr><td class="paramname">PosteriorHist</td><td>Histogram with posterior distribution </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02977">2977</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;                                                                         {</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;  <span class="comment">// Area normalise the distributions</span></div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;  PriorHist-&gt;Scale(1./PriorHist-&gt;Integral(), <span class="stringliteral">&quot;width&quot;</span>);</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;  PosteriorHist-&gt;Scale(1./PosteriorHist-&gt;Integral(), <span class="stringliteral">&quot;width&quot;</span>);</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160; </div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;  PriorHist-&gt;SetLineColor(kRed);</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;  PriorHist-&gt;SetMarkerColor(kRed);</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;  PriorHist-&gt;SetFillColorAlpha(kRed, 0.35);</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;  PriorHist-&gt;SetFillStyle(1001);</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;  PriorHist-&gt;GetXaxis()-&gt;SetTitle(Title.c_str());</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;  PriorHist-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Posterior Probability&quot;</span>);</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;  PriorHist-&gt;SetMaximum(PosteriorHist-&gt;GetMaximum()*1.5);</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;  PriorHist-&gt;GetYaxis()-&gt;SetLabelOffset(999);</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;  PriorHist-&gt;GetYaxis()-&gt;SetLabelSize(0);</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;  PriorHist-&gt;SetLineWidth(2);</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;  PriorHist-&gt;SetLineStyle(kSolid);</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160; </div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;  PosteriorHist-&gt;SetLineColor(kBlue);</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;  PosteriorHist-&gt;SetMarkerColor(kBlue);</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;  PosteriorHist-&gt;SetFillColorAlpha(kBlue, 0.35);</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;  PosteriorHist-&gt;SetFillStyle(1001);</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160; </div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;  PriorHist-&gt;Draw(<span class="stringliteral">&quot;hist&quot;</span>);</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;  PosteriorHist-&gt;Draw(<span class="stringliteral">&quot;hist same&quot;</span>);</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160; </div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;  <span class="keywordtype">double</span> ProbPrior = PriorHist-&gt;GetBinContent(PriorHist-&gt;FindBin(EvaluationPoint));</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;  <span class="comment">//KS: In case we go so far away that prior is 0, set this to small value to avoid dividing by 0</span></div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;  <span class="keywordflow">if</span>(ProbPrior &lt; 0) ProbPrior = 0.00001;</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;  <span class="keywordtype">double</span> ProbPosterior = PosteriorHist-&gt;GetBinContent(PosteriorHist-&gt;FindBin(EvaluationPoint));</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;  <span class="keywordtype">double</span> SavageDickey = ProbPosterior/ProbPrior;</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160; </div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;  std::string DunneKabothScale = <a class="code" href="StatisticalUtils_8cpp.html#acf403b05be9baa719893db7449e833c7">GetDunneKaboth</a>(SavageDickey);</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;  <span class="comment">//Get Best point</span></div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;  <span class="keyword">auto</span> PostPoint = std::make_unique&lt;TGraph&gt;(1);</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;  PostPoint-&gt;SetPoint(0, EvaluationPoint, ProbPosterior);</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;  PostPoint-&gt;SetMarkerStyle(20);</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;  PostPoint-&gt;SetMarkerSize(1);</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;  PostPoint-&gt;Draw(<span class="stringliteral">&quot;P same&quot;</span>);</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160; </div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;  <span class="keyword">auto</span> PriorPoint = std::make_unique&lt;TGraph&gt;(1);</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;  PriorPoint-&gt;SetPoint(0, EvaluationPoint, ProbPrior);</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;  PriorPoint-&gt;SetMarkerStyle(20);</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;  PriorPoint-&gt;SetMarkerSize(1);</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;  PriorPoint-&gt;Draw(<span class="stringliteral">&quot;P same&quot;</span>);</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160; </div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;  <span class="keyword">auto</span> legend = std::make_unique&lt;TLegend&gt;(0.12, 0.6, 0.6, 0.97);</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;  <a class="code" href="classMCMCProcessor.html#a704afa8c216722e730be2c2a33b594f0">SetLegendStyle</a>(legend.get(), 0.04);</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;  legend-&gt;AddEntry(PriorHist.get(), <span class="stringliteral">&quot;Prior&quot;</span>, <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;  legend-&gt;AddEntry(PosteriorHist.get(), <span class="stringliteral">&quot;Posterior&quot;</span>, <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;  legend-&gt;AddEntry(PostPoint.get(), Form(<span class="stringliteral">&quot;SavageDickey = %.2f, (%s)&quot;</span>, SavageDickey, DunneKabothScale.c_str()),<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;  legend-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160; </div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Print(<a class="code" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;  <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Write(Title.c_str());</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aeff2174617268c1e55333529459bffb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeff2174617268c1e55333529459bffb6">&#9670;&nbsp;</a></span>ScanInput()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::ScanInput </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Scan Input etc. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02190">2190</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;                              {</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;  <span class="comment">// KS: This can reduce time necessary for caching even by half</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;  <span class="comment">//ROOT::EnableImplicitMT();</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160; </div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;  <span class="comment">// Open the Chain</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;  <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a> = <span class="keyword">new</span> TChain(<span class="stringliteral">&quot;posteriors&quot;</span>,<span class="stringliteral">&quot;posteriors&quot;</span>);</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;  <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;Add(<a class="code" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a>.c_str());</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160; </div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;  <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a> = int(<a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetEntries());</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;  </div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;  <span class="comment">//Only is suboptimality we might want to change it, therefore set it high enough so it doesn&#39;t affect other functionality</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;  <a class="code" href="classMCMCProcessor.html#a6b14dd9e571803d8946781642348bee1">UpperCut</a> = <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>+1;</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160; </div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;  <span class="comment">// Get the list of branches</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;  TObjArray* brlis = <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetListOfBranches();</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160; </div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;  <span class="comment">// Get the number of branches</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;  <a class="code" href="classMCMCProcessor.html#af6ba5d9aec5350fafebbf81309e813cb">nBranches</a> = brlis-&gt;GetEntries();</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160; </div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;  <a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>.reserve(<a class="code" href="classMCMCProcessor.html#af6ba5d9aec5350fafebbf81309e813cb">nBranches</a>);</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;  <a class="code" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>.reserve(<a class="code" href="classMCMCProcessor.html#af6ba5d9aec5350fafebbf81309e813cb">nBranches</a>);</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160; </div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;  <span class="comment">// Read the input Covariances</span></div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;  <a class="code" href="classMCMCProcessor.html#afef48d4fccf7551dc1845f8f6c08864f">ReadInputCov</a>();</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160; </div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;  <span class="comment">// Set all the branches to off</span></div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;  <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchStatus(<span class="stringliteral">&quot;*&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160; </div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;  <span class="comment">// Loop over the number of branches</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;  <span class="comment">// Find the name and how many of each systematic we have</span></div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#af6ba5d9aec5350fafebbf81309e813cb">nBranches</a>; i++)</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;  {</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    <span class="comment">// Get the TBranch and its name</span></div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;    TBranch* br = <span class="keyword">static_cast&lt;</span>TBranch*<span class="keyword">&gt;</span>(brlis-&gt;At(i));</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;    <span class="keywordflow">if</span>(!br){</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Invalid branch at position {}&quot;</span>, i);</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__,__LINE__);</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;    }</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;    TString bname = br-&gt;GetName();</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160; </div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;    <span class="comment">//KS: Exclude parameter types</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;    <span class="keywordtype">bool</span> rejected = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ik = 0; ik &lt; <a class="code" href="classMCMCProcessor.html#aada4aadea10661586b46c1013a9d018f">ExcludedTypes</a>.size(); ++ik )</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    {</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;      <span class="keywordflow">if</span>(bname.BeginsWith(<a class="code" href="classMCMCProcessor.html#aada4aadea10661586b46c1013a9d018f">ExcludedTypes</a>[ik]))</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;      {</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;        rejected = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;      }</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;    }</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;    <span class="keywordflow">if</span>(rejected) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160; </div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;    <span class="comment">// Turn on the branches which we want for parameters</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchStatus(bname.Data(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160; </div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;    <span class="keywordflow">if</span> (bname.BeginsWith(<span class="stringliteral">&quot;ndd_&quot;</span>))</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;    {</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;      <a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>.push_back(bname);</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;      <a class="code" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>.push_back(<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>);</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;      <a class="code" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>]++;</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    }</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bname.BeginsWith(<span class="stringliteral">&quot;skd_joint_&quot;</span>))</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    {</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;      <a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>.push_back(bname);</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;      <a class="code" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>.push_back(<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>);</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;      <a class="code" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>]++;</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    }</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160; </div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;    <span class="comment">//KS: as a bonus get LogL systematic</span></div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;    <span class="keywordflow">if</span> (bname.BeginsWith(<span class="stringliteral">&quot;LogL_sample_&quot;</span>)) {</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;      <a class="code" href="classMCMCProcessor.html#a3660e404a6631cfa913a815481730a9b">SampleName_v</a>.push_back(bname);</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;    }</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bname.BeginsWith(<span class="stringliteral">&quot;LogL_systematic_&quot;</span>)) {</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;      <a class="code" href="classMCMCProcessor.html#acb1871575fdd3ae156aed4bf7c7a0a73">SystName_v</a>.push_back(bname);</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;    }</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;  }</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;  <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a> = int(<a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>.size());</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160; </div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;  <span class="comment">// Read the input Covariances</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;  <a class="code" href="classMCMCProcessor.html#ac0e758c91b6f57a75544a0c61228f8dc">ReadInputCovLegacy</a>();</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;  </div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;  <span class="comment">// Check order of parameter types</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;  <a class="code" href="classMCMCProcessor.html#a015cf0d6925d026e5bd9d82aa31083b6">ScanParameterOrder</a>();</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160; </div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;  <a class="code" href="classMCMCProcessor.html#a95fa49737432818bc830a44898d0d850">IamVaried</a>.resize(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160; </div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;  <span class="comment">// Print useful Info</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;  <a class="code" href="classMCMCProcessor.html#a1229c5b253883017c4efd636cdd7071e">PrintInfo</a>();</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160; </div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;  <a class="code" href="classMCMCProcessor.html#aae0016a4e1d105d5d65243438c622a97">nSteps</a> = <a class="code" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMaximum(<span class="stringliteral">&quot;step&quot;</span>);</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;  <span class="comment">// Set the step cut to be 20%</span></div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;  <span class="keywordtype">int</span> cut = <a class="code" href="classMCMCProcessor.html#aae0016a4e1d105d5d65243438c622a97">nSteps</a>/5;</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;  <a class="code" href="classMCMCProcessor.html#ad610d8e835031872b428e759ef4045f1">SetStepCut</a>(cut);</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160; </div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;  <span class="comment">// Basically allow loading oscillation parameters</span></div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;  <a class="code" href="classMCMCProcessor.html#aabac168d6ff10dc3d57667db532476a2">LoadAdditionalInfo</a>();</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a015cf0d6925d026e5bd9d82aa31083b6"><div class="ttname"><a href="classMCMCProcessor.html#a015cf0d6925d026e5bd9d82aa31083b6">MCMCProcessor::ScanParameterOrder</a></div><div class="ttdeci">void ScanParameterOrder()</div><div class="ttdoc">Scan order of params from a different groups.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02350">MCMCProcessor.cpp:2350</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a1229c5b253883017c4efd636cdd7071e"><div class="ttname"><a href="classMCMCProcessor.html#a1229c5b253883017c4efd636cdd7071e">MCMCProcessor::PrintInfo</a></div><div class="ttdeci">void PrintInfo() const</div><div class="ttdoc">Print info like how many params have been loaded etc.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l04569">MCMCProcessor.cpp:4569</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aabac168d6ff10dc3d57667db532476a2"><div class="ttname"><a href="classMCMCProcessor.html#aabac168d6ff10dc3d57667db532476a2">MCMCProcessor::LoadAdditionalInfo</a></div><div class="ttdeci">virtual void LoadAdditionalInfo()</div><div class="ttdoc">allow loading additional info for example used for oscillation parameters</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00346">MCMCProcessor.h:346</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aada4aadea10661586b46c1013a9d018f"><div class="ttname"><a href="classMCMCProcessor.html#aada4aadea10661586b46c1013a9d018f">MCMCProcessor::ExcludedTypes</a></div><div class="ttdeci">std::vector&lt; std::string &gt; ExcludedTypes</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00452">MCMCProcessor.h:452</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ac0e758c91b6f57a75544a0c61228f8dc"><div class="ttname"><a href="classMCMCProcessor.html#ac0e758c91b6f57a75544a0c61228f8dc">MCMCProcessor::ReadInputCovLegacy</a></div><div class="ttdeci">void ReadInputCovLegacy()</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02439">MCMCProcessor.cpp:2439</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ad610d8e835031872b428e759ef4045f1"><div class="ttname"><a href="classMCMCProcessor.html#ad610d8e835031872b428e759ef4045f1">MCMCProcessor::SetStepCut</a></div><div class="ttdeci">void SetStepCut(const std::string &amp;Cuts)</div><div class="ttdoc">Set the step cutting by string.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02688">MCMCProcessor.cpp:2688</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_af6ba5d9aec5350fafebbf81309e813cb"><div class="ttname"><a href="classMCMCProcessor.html#af6ba5d9aec5350fafebbf81309e813cb">MCMCProcessor::nBranches</a></div><div class="ttdeci">int nBranches</div><div class="ttdoc">Number of branches in a TTree.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00438">MCMCProcessor.h:438</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_afef48d4fccf7551dc1845f8f6c08864f"><div class="ttname"><a href="classMCMCProcessor.html#afef48d4fccf7551dc1845f8f6c08864f">MCMCProcessor::ReadInputCov</a></div><div class="ttdeci">void ReadInputCov()</div><div class="ttdoc">CW: Read the input Covariance matrix entries. Get stuff like parameter input errors,...</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02430">MCMCProcessor.cpp:2430</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a015cf0d6925d026e5bd9d82aa31083b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a015cf0d6925d026e5bd9d82aa31083b6">&#9670;&nbsp;</a></span>ScanParameterOrder()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::ScanParameterOrder </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Scan order of params from a different groups. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02350">2350</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;                                       {</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;<span class="comment">// *****************************</span></div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a">kNParameterEnum</a>; i++)</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;  {</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>.size(); j++)</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;    {</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>[j] == <a class="code" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20b">ParameterEnum</a>(i)) </div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;      {</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;        <span class="comment">//KS: When we find that i-th parameter types start at j, save and move to the next parameter.</span></div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;        <a class="code" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[i] = j;</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;      }</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;    }</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;  }</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5b7725985614e45ea318a331d581fe9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b7725985614e45ea318a331d581fe9e">&#9670;&nbsp;</a></span>SetEntries()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetEntries </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>NewEntries</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set number of entries to make potentially MCMC Processing faster. </p>
<dl class="section warning"><dt>Warning</dt><dd>This option only sets an upper limit; burn-in events will NOT be discarded </dd></dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00264">264</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                                                 {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="keywordflow">if</span> (NewEntries &gt; <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Cannot increase entries from {} to {}. Only decreasing is allowed.&quot;</span>, <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>, NewEntries);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <span class="keywordflow">if</span> (NewEntries &lt;= 0) {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Entries cannot be below 0, but {} was passed.&quot;</span>, NewEntries);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classMCMCProcessor.html#afca259b5bdee2b248d4b1a64ac3e7930">BurnInCut</a>) &gt; NewEntries) {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;          <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;BurnInCut ({}) is larger than NewEntries ({})&quot;</span>, <a class="code" href="classMCMCProcessor.html#afca259b5bdee2b248d4b1a64ac3e7930">BurnInCut</a>, NewEntries);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;          <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Setting entries to {} from {}.&quot;</span>, NewEntries, <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;This may behave not as expected when using merged multiple chains&quot;</span>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <a class="code" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a> = NewEntries;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a07d8ee7d0fdb9576505e4434a62d25c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07d8ee7d0fdb9576505e4434a62d25c1">&#9670;&nbsp;</a></span>SetExcludedGroups()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetExcludedGroups </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>Name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00312">312</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;{<a class="code" href="classMCMCProcessor.html#a8221ad9d7c814e978a302be016d5f6b8">ExcludedGroups</a> = Name; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a09a6fa6cefcb20c00bee22c1dc5718c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09a6fa6cefcb20c00bee22c1dc5718c5">&#9670;&nbsp;</a></span>SetExcludedNames()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetExcludedNames </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>Name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00311">311</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;{<a class="code" href="classMCMCProcessor.html#a7425f7802e50bcb5ff4b38e20157c423">ExcludedNames</a> = Name; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4364a8ab084906c8925c9db9dc110485"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4364a8ab084906c8925c9db9dc110485">&#9670;&nbsp;</a></span>SetExcludedTypes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetExcludedTypes </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>Name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Setter related what parameters we want to exclude from analysis, for example if cross-section parameters look like param_, then passing "param_" will. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00310">310</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;{<a class="code" href="classMCMCProcessor.html#aada4aadea10661586b46c1013a9d018f">ExcludedTypes</a> = Name; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7f61cf0a51670f24f16dd7d77b7f5ae4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f61cf0a51670f24f16dd7d77b7f5ae4">&#9670;&nbsp;</a></span>SetFancyNames()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetFancyNames </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>PlotOrNot</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00300">300</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;{<a class="code" href="classMCMCProcessor.html#ad25fe818c94163b0c4a8fcdfd387c148">FancyPlotNames</a> = PlotOrNot; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a704afa8c216722e730be2c2a33b594f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a704afa8c216722e730be2c2a33b594f0">&#9670;&nbsp;</a></span>SetLegendStyle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetLegendStyle </td>
          <td>(</td>
          <td class="paramtype">TLegend *&#160;</td>
          <td class="paramname"><em>Legend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Configures the style of a TLegend object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Legend</td><td>Pointer to the TLegend object to modify </td></tr>
    <tr><td class="paramname">size</td><td>The text size to set for the legend </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l04628">4628</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;                                                                           {</div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;  Legend-&gt;SetTextSize(size);</div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;  Legend-&gt;SetLineColor(0);</div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;  Legend-&gt;SetLineStyle(0);</div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;  Legend-&gt;SetFillColor(0);</div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;  Legend-&gt;SetFillStyle(0);</div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;  Legend-&gt;SetBorderSize(0);</div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a922f4c04b67ca9c6faab00efdb5277ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a922f4c04b67ca9c6faab00efdb5277ea">&#9670;&nbsp;</a></span>SetMargins()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetMargins </td>
          <td>(</td>
          <td class="paramtype">std::unique_ptr&lt; TCanvas &gt; &amp;&#160;</td>
          <td class="paramname"><em>Canv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>margins</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set TCanvas margins to specified values. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l04603">4603</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;                                                                                             {</div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;  <span class="keywordflow">if</span> (!Canv) {</div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Canv is nullptr&quot;</span>);</div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;  }</div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;  <span class="keywordflow">if</span> (margins.size() != 4) {</div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Margin vector must have exactly 4 elements&quot;</span>);</div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__, __LINE__);</div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;  }</div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;  Canv-&gt;SetTopMargin(margins[0]);</div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;  Canv-&gt;SetBottomMargin(margins[1]);</div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;  Canv-&gt;SetLeftMargin(margins[2]);</div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;  Canv-&gt;SetRightMargin(margins[3]);</div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5b13f1879f84d13b7d139432a9b993c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b13f1879f84d13b7d139432a9b993c6">&#9670;&nbsp;</a></span>SetnBatches()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetnBatches </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Batches</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set value of Nbatches used for batched mean, this need to be done earlier as batches are made when reading tree. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Batches</td><td>Number of batches, default is 20 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00316">316</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;{<a class="code" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a> = Batches; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa44a8304e28e48f29ad786f7a80ab43e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa44a8304e28e48f29ad786f7a80ab43e">&#9670;&nbsp;</a></span>SetNBins()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetNBins </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>NewBins</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Modify number of bins used for 1D and 2D Histograms. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00260">260</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;{<a class="code" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a> = NewBins;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a173d37d528ff201e66db8f92c156e3bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a173d37d528ff201e66db8f92c156e3bb">&#9670;&nbsp;</a></span>SetnLags()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetnLags </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nLags</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00317">317</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;{<a class="code" href="classMCMCProcessor.html#a6156bba72e1f076e66f0356e48506a36">AutoCorrLag</a> = nLags; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2f4bf14c95b830c457a73be5399403ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f4bf14c95b830c457a73be5399403ad">&#9670;&nbsp;</a></span>SetOutputSuffix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetOutputSuffix </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>Suffix</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sett output suffix, this way jobs using the same file will have different names. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00320">320</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;{<a class="code" href="classMCMCProcessor.html#aa34b50ce33fb2cb7d9e9ef2d9f2f67c1">OutputSuffix</a> = Suffix; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="aed120fafdfe97615f4c2a30aedde03dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed120fafdfe97615f4c2a30aedde03dd">&#9670;&nbsp;</a></span>SetPlotBinValue()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetPlotBinValue </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>PlotOrNot</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00299">299</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;{<a class="code" href="classMCMCProcessor.html#aa7611f55ac3c0ea70607761d037fbd91">plotBinValue</a> = PlotOrNot; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="adbe0ec06ce30447cb1c03a961364b929"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbe0ec06ce30447cb1c03a961364b929">&#9670;&nbsp;</a></span>SetPlotErrorForFlatPrior()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetPlotErrorForFlatPrior </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>PlotOrNot</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set whether you want to plot error for parameters which have flat prior. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00298">298</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;{<a class="code" href="classMCMCProcessor.html#ad24411a2556504c440ff0af045e8e7aa">PlotFlatPrior</a> = PlotOrNot; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6ea549289949ac19d2fc768d82c8f1c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ea549289949ac19d2fc768d82c8f1c9">&#9670;&nbsp;</a></span>SetPlotRelativeToPrior()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetPlotRelativeToPrior </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>PlotOrNot</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>You can set relative to prior or relative to generated. It is advised to use relate to prior. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PlotOrNot</td><td>bool controlling plotRelativeToPrior argument </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00294">294</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;{<a class="code" href="classMCMCProcessor.html#afbac2a114c15ca7db4abe71dd549504c">plotRelativeToPrior</a> = PlotOrNot; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab605f4d7bf4e2b24b4c0b1c5853b479f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab605f4d7bf4e2b24b4c0b1c5853b479f">&#9670;&nbsp;</a></span>SetPost2DPlotThreshold()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetPost2DPlotThreshold </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>Threshold</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Code will only plot 2D posteriors if Correlation are larger than defined threshold. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Threshold</td><td>This threshold is compared with correlation value </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00305">305</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;{<a class="code" href="classMCMCProcessor.html#a25e4685b6299181021b02ac0e0b74681">Post2DPlotThreshold</a> = Threshold; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a641da7f5e018d48d480638fbad6406a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a641da7f5e018d48d480638fbad6406a4">&#9670;&nbsp;</a></span>SetPosterior1DCut()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetPosterior1DCut </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>Cut</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allow to set addtional cuts based on ROOT TBrowser cut, for to only affect one mass ordering. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00322">322</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;{<a class="code" href="classMCMCProcessor.html#a85917e25c4f5b5b966c50cccd9ddd6a0">Posterior1DCut</a> = Cut; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9db87211d9f066011daed18af7f4631e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9db87211d9f066011daed18af7f4631e">&#9670;&nbsp;</a></span>SetPrintToPDF()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetPrintToPDF </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>PlotOrNot</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether to dump all plots into PDF. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00296">296</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;{<a class="code" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a> = PlotOrNot; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4bec41cdc9af977a51b269e2a07fe961"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bec41cdc9af977a51b269e2a07fe961">&#9670;&nbsp;</a></span>SetSmoothing()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetSmoothing </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>PlotOrNot</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set whether want to use smoothing for histograms using ROOT algorithm. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00302">302</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;{<a class="code" href="classMCMCProcessor.html#a682c1c47626542f5820d633ba2bc010c">ApplySmoothing</a> = PlotOrNot; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a16f653dcb6358f2a8e393e3946a7e6d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16f653dcb6358f2a8e393e3946a7e6d2">&#9670;&nbsp;</a></span>SetStepCut() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetStepCut </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Cuts</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the step cutting by int. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Cuts</td><td>integer telling cut value </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02698">2698</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;                                             {</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;<span class="comment">// ***************</span></div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;  std::stringstream TempStream;</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;  TempStream &lt;&lt; <span class="stringliteral">&quot;step &gt; &quot;</span> &lt;&lt; Cuts;</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;  <a class="code" href="classMCMCProcessor.html#a576f0eb874afaf7e31ff5c86b9e5b8f9">StepCut</a> = TempStream.str();</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;  <a class="code" href="classMCMCProcessor.html#afca259b5bdee2b248d4b1a64ac3e7930">BurnInCut</a> = Cuts;</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;  <a class="code" href="classMCMCProcessor.html#a02eebcff814d7ce3ec3d9eb4e3bad857">CheckStepCut</a>();</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a02eebcff814d7ce3ec3d9eb4e3bad857"><div class="ttname"><a href="classMCMCProcessor.html#a02eebcff814d7ce3ec3d9eb4e3bad857">MCMCProcessor::CheckStepCut</a></div><div class="ttdeci">void CheckStepCut() const</div><div class="ttdoc">Check if step cut isn't larger than highest values of step in a chain.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02709">MCMCProcessor.cpp:2709</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad610d8e835031872b428e759ef4045f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad610d8e835031872b428e759ef4045f1">&#9670;&nbsp;</a></span>SetStepCut() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetStepCut </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>Cuts</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the step cutting by string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Cuts</td><td>string telling cut value </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02688">2688</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;                                                    {</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;<span class="comment">// ***************</span></div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;  <a class="code" href="classMCMCProcessor.html#a576f0eb874afaf7e31ff5c86b9e5b8f9">StepCut</a> = Cuts;</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;  <a class="code" href="classMCMCProcessor.html#afca259b5bdee2b248d4b1a64ac3e7930">BurnInCut</a> = std::stoi( Cuts );</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160; </div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;  <a class="code" href="classMCMCProcessor.html#a02eebcff814d7ce3ec3d9eb4e3bad857">CheckStepCut</a>();</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0763bc26066a8cf7ea00148eb45af7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0763bc26066a8cf7ea00148eb45af7a">&#9670;&nbsp;</a></span>SetTLineStyle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetTLineStyle </td>
          <td>(</td>
          <td class="paramtype">TLine *&#160;</td>
          <td class="paramname"><em>Line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Color_t&#160;</td>
          <td class="paramname"><em>Colour</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Width_t&#160;</td>
          <td class="paramname"><em>Width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ELineStyle&#160;</td>
          <td class="paramname"><em>Style</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Configures a TLine object with the specified style parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Line</td><td>Pointer to the TLine object to modify. Must not be nullptr. </td></tr>
    <tr><td class="paramname">Colour</td><td>The color to set for the line. </td></tr>
    <tr><td class="paramname">Width</td><td>The width of the line. </td></tr>
    <tr><td class="paramname">Style</td><td>The line style (e.g., solid, dashed, etc.). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l04620">4620</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;                                                                                                                      {</div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;  Line-&gt;SetLineColor(Colour);</div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;  Line-&gt;SetLineWidth(Width);</div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;  Line-&gt;SetLineStyle(<a class="code" href="PlotSigmaVariation_8cpp.html#a2c1881be081f561337336d11d34572a9">Style</a>);</div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;}</div>
<div class="ttc" id="aPlotSigmaVariation_8cpp_html_a2c1881be081f561337336d11d34572a9"><div class="ttname"><a href="PlotSigmaVariation_8cpp.html#a2c1881be081f561337336d11d34572a9">Style</a></div><div class="ttdeci">constexpr ELineStyle Style[NVars]</div><div class="ttdef"><b>Definition:</b> <a href="PlotSigmaVariation_8cpp_source.html#l00020">PlotSigmaVariation.cpp:20</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa4761be1345f1be3defe162b278a9d8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4761be1345f1be3defe162b278a9d8e">&#9670;&nbsp;</a></span>SetupOutput()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetupOutput </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prepare all objects used for output. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02293">2293</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;                                {</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;<span class="comment">// ****************************</span></div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;  <span class="comment">// Make sure we can read files located anywhere and strip the .root ending</span></div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;  <a class="code" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a> = <a class="code" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a>.substr(0, <a class="code" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a>.find(<span class="stringliteral">&quot;.root&quot;</span>));</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160; </div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;  <span class="comment">// Check if the output file is ready</span></div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a> == <span class="keyword">nullptr</span>) <a class="code" href="classMCMCProcessor.html#aa5a7761e97cf2e24c7d877a5374b7333">MakeOutputFile</a>();</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;  </div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;  <a class="code" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a> = <a class="code" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a> + <a class="code" href="classMCMCProcessor.html#aa34b50ce33fb2cb7d9e9ef2d9f2f67c1">OutputSuffix</a> + <span class="stringliteral">&quot;.pdf[&quot;</span>;</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code" href="classMCMCProcessor.html#a61deb3c399dc10813b5cd116f041e981">Posterior</a>-&gt;Print(<a class="code" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160; </div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;  <span class="comment">// Once the pdf file is open no longer need to bracket</span></div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;  <a class="code" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>.ReplaceAll(<span class="stringliteral">&quot;[&quot;</span>,<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160; </div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;  <span class="comment">// We fit with this Gaussian</span></div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;  <a class="code" href="classMCMCProcessor.html#a20ee00d448413b8a2653b252d70e88b3">Gauss</a> = std::make_unique&lt;TF1&gt;(<span class="stringliteral">&quot;Gauss&quot;</span>, <span class="stringliteral">&quot;[0]/sqrt(2.0*3.14159)/[2]*TMath::Exp(-0.5*pow(x-[1],2)/[2]/[2])&quot;</span>, -5, 5);</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;  <a class="code" href="classMCMCProcessor.html#a20ee00d448413b8a2653b252d70e88b3">Gauss</a>-&gt;SetLineWidth(2);</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;  <a class="code" href="classMCMCProcessor.html#a20ee00d448413b8a2653b252d70e88b3">Gauss</a>-&gt;SetLineColor(kOrange-5);</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160; </div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;  <span class="comment">// Declare the TVectors</span></div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;  <a class="code" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a> = <span class="keyword">new</span> TMatrixDSym(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;  <a class="code" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a> = <span class="keyword">new</span> TMatrixDSym(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;  <a class="code" href="classMCMCProcessor.html#aad661c6d53f9f891e18ff8ccdbd08479">Central_Value</a> = <span class="keyword">new</span> TVectorD(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;  <a class="code" href="classMCMCProcessor.html#acaf7f239136dfa3506d095b612323d0a">Means</a> = <span class="keyword">new</span> TVectorD(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;  <a class="code" href="classMCMCProcessor.html#a5174aaa900edf16ddc6e841ea4adae83">Errors</a> = <span class="keyword">new</span> TVectorD(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;  <a class="code" href="classMCMCProcessor.html#a600fc8c39af2750df91fb7a0ff85ac74">Means_Gauss</a> = <span class="keyword">new</span> TVectorD(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;  <a class="code" href="classMCMCProcessor.html#aa78b7ed1bb9966f84f4eaf8cedf5e688">Errors_Gauss</a> = <span class="keyword">new</span> TVectorD(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;  <a class="code" href="classMCMCProcessor.html#a32657dc39a7fc0d04804f6195a3d8c3e">Means_HPD</a>    = <span class="keyword">new</span> TVectorD(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;  <a class="code" href="classMCMCProcessor.html#abb5c6ad85c89227bbb9bc5de2eb71272">Errors_HPD</a>   = <span class="keyword">new</span> TVectorD(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;  <a class="code" href="classMCMCProcessor.html#af96664fa8cc51c49ad1385da07a343b8">Errors_HPD_Positive</a> = <span class="keyword">new</span> TVectorD(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;  <a class="code" href="classMCMCProcessor.html#a7b85df39f22390dac24f4d66a89518e5">Errors_HPD_Negative</a> = <span class="keyword">new</span> TVectorD(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160; </div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;  <span class="comment">// Initialise to something silly</span></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;<span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;<span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;  {</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    (*Central_Value)(i) = <a class="code" href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a>;</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    (*Means)(i) = <a class="code" href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a>;</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;    (*Errors)(i) = <a class="code" href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a>;</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;    (*Means_Gauss)(i) = <a class="code" href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a>;</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    (*Errors_Gauss)(i) = <a class="code" href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a>;</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    (*Means_HPD)(i) = <a class="code" href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a>;</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    (*Errors_HPD)(i) = <a class="code" href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a>;</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    (*Errors_HPD_Positive)(i) = <a class="code" href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a>;</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    (*Errors_HPD_Negative)(i) = <a class="code" href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a>;</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;      (*Covariance)(i, j) = <a class="code" href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a>;</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;      (*Correlation)(i, j) = <a class="code" href="namespaceM3.html#a2aed672aeeb4fcf51069966193176ff3">M3::_BAD_DOUBLE_</a>;</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    }</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;  }</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;  <a class="code" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>.resize(<a class="code" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab90c5ec77c57103dfaa72648c330a390"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab90c5ec77c57103dfaa72648c330a390">&#9670;&nbsp;</a></span>SetUseFFTAutoCorrelation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetUseFFTAutoCorrelation </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>useFFT</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Toggle using the FFT-based autocorrelation calculator. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00307">307</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;{<a class="code" href="classMCMCProcessor.html#a562261269f0f4ec4a209b2fca64ff443">useFFTAutoCorrelation</a> = useFFT; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="afe9e39306543ec4447f9a59d7ef58e9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe9e39306543ec4447f9a59d7ef58e9e">&#9670;&nbsp;</a></span>SmearChain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SmearChain </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>Names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>SaveBranch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Smear chain contours. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Names</td><td>Parameter names for which we do smearing </td></tr>
    <tr><td class="paramname">Error</td><td>Error based on which we smear </td></tr>
    <tr><td class="paramname">SaveBranch</td><td>Whether we save unsmeared branch or not </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>based on smear_parameter.C </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Dan Barrow </dd></dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l03163">3163</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;                                                             {</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;<span class="comment">// **************************</span></div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;  <a class="code" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Starting {}&quot;</span>, __func__);</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160; </div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;  <span class="keywordflow">if</span>( (Names.size() != Error.size()))</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;  {</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Size of passed vectors doesn&#39;t match in {}&quot;</span>, __func__);</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;  }</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;  std::vector&lt;int&gt; Param;</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160; </div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;  <span class="comment">//KS: First we need to find parameter number based on name</span></div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; Names.size(); ++k)</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;  {</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;    <span class="comment">//KS: First we need to find parameter number based on name</span></div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;    <span class="keywordtype">int</span> ParamNo = <a class="code" href="classMCMCProcessor.html#a563df09ed03a95aa8ad2781db9c8807b">GetParamIndexFromName</a>(Names[k]);</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;    <span class="keywordflow">if</span>(ParamNo == <a class="code" href="namespaceM3.html#ac289df32a5b3b05c61a87cbac5702b25">M3::_BAD_INT_</a>)</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;    {</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;      <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Couldn&#39;t find param {}. Can&#39;t Smear&quot;</span>, Names[k]);</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;    }</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160; </div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;    <span class="keywordtype">double</span> Prior = 1.0, PriorError = 1.0;</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;    <a class="code" href="classMCMCProcessor.html#a07204936619139b886e9a877bc46d1a4">GetNthParameter</a>(ParamNo, Prior, PriorError, Title);</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160; </div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;    Param.push_back(ParamNo);</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;  }</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;  std::string InputFile = <a class="code" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a>+<span class="stringliteral">&quot;.root&quot;</span>;</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;  std::string OutputFilename = <a class="code" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a> + <span class="stringliteral">&quot;_smeared.root&quot;</span>;</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160; </div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;  <span class="comment">//KS: Simply create copy of file and add there new branch</span></div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;  <span class="keywordtype">int</span> ret = system((<span class="stringliteral">&quot;cp &quot;</span> + InputFile + <span class="stringliteral">&quot; &quot;</span> + OutputFilename).c_str());</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;  <span class="keywordflow">if</span> (ret != 0)</div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;    <a class="code" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Error: system call to copy file failed with code {}&quot;</span>, ret);</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160; </div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;  TFile *OutputChain = <a class="code" href="namespaceM3.html#a87841bdbf0e0a2a733d9e4ca499f820d">M3::Open</a>(OutputFilename, <span class="stringliteral">&quot;UPDATE&quot;</span>, __FILE__, __LINE__);</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;  OutputChain-&gt;cd();</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;  TTree *post = OutputChain-&gt;Get&lt;TTree&gt;(<span class="stringliteral">&quot;posteriors&quot;</span>);</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;  TTree *treeNew = post-&gt;CloneTree(0);</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160; </div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;  std::vector&lt;double&gt; NewParameter(Names.size());</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; Param.size(); i++) {</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;    post-&gt;SetBranchAddress(<a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[Param[i]], &amp;NewParameter[i]);</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;  }</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160; </div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;  std::vector&lt;double&gt; Unsmeared_Parameter;</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;  <span class="keywordflow">if</span>(SaveBranch){</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;    Unsmeared_Parameter.resize(Param.size());</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; Param.size(); i++) {</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;      treeNew-&gt;Branch((<a class="code" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[Param[i]] + <span class="stringliteral">&quot;_unsmeared&quot;</span>), &amp;Unsmeared_Parameter[i]);</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;    }</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;  }</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160; </div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;  <span class="keyword">auto</span> rand = std::make_unique&lt;TRandom3&gt;(0);</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;  Long64_t AllEntries = post-&gt;GetEntries();</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;  <span class="keywordflow">for</span> (Long64_t i = 0; i &lt; AllEntries; ++i) {</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;    <span class="comment">// Entry from the old chain</span></div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;    post-&gt;GetEntry(i);</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160; </div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;    <span class="keywordflow">if</span>(SaveBranch){</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> iPar = 0; iPar &lt; Param.size(); iPar++) {</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;        Unsmeared_Parameter[iPar] = NewParameter[iPar];</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;      }</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;    }</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;    <span class="comment">// Smear it</span></div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> iPar = 0; iPar &lt; Param.size(); iPar++) {</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;      NewParameter[iPar] = NewParameter[iPar] + rand-&gt;Gaus(0, Error[iPar]);</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;    }</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;    <span class="comment">// Fill to the new chain</span></div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;    treeNew-&gt;Fill();</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;  }</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160; </div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;  OutputChain-&gt;cd();</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;  treeNew-&gt;Write(<span class="stringliteral">&quot;posteriors&quot;</span>, TObject::kOverwrite);</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160; </div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;  <span class="comment">// KS: Save reweight metadeta</span></div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;  std::ostringstream yaml_stream;</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;  yaml_stream &lt;&lt; <span class="stringliteral">&quot;Smearing:\n&quot;</span>;</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; Names.size(); ++k) {</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;    yaml_stream &lt;&lt; <span class="stringliteral">&quot;    &quot;</span> &lt;&lt; Names[k] &lt;&lt; <span class="stringliteral">&quot;: [&quot;</span> &lt;&lt; Error[k] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <span class="stringliteral">&quot;Gauss&quot;</span> &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>;</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;  }</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;  std::string yaml_string = yaml_stream.str();</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;  YAML::Node root = <a class="code" href="YamlHelper_8h.html#a3ff1f2154c0a70ad5a145fcc5891e7ec">STRINGtoYAML</a>(yaml_string);</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;  TMacro ConfigSave = <a class="code" href="YamlHelper_8h.html#a2d4f3247b6e13ef8c127ff66e699d3cb">YAMLtoTMacro</a>(root, <span class="stringliteral">&quot;Smearing_Config&quot;</span>);</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;  ConfigSave.Write();</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160; </div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;  OutputChain-&gt;Close();</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;  <span class="keyword">delete</span> OutputChain;</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0ac5ba63d8bf9ee38d4be8c1977214e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ac5ba63d8bf9ee38d4be8c1977214e5">&#9670;&nbsp;</a></span>ThinMCMC()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::ThinMCMC </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ThinningCut</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Thin MCMC Chain, to save space and maintain low autocorrelations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ThinningCut</td><td>every which entry you want to thin </td></tr>
    <tr><td class="paramname">Average</td><td>If true will perform MCMC averaging instead of thinning </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00205">205</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;{ <a class="code" href="StatisticalUtils_8cpp.html#aa6fd944e00fcda133cfef10782f08de0">ThinningMCMC</a>(<a class="code" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a>+<span class="stringliteral">&quot;.root&quot;</span>, ThinningCut); };</div>
<div class="ttc" id="aStatisticalUtils_8cpp_html_aa6fd944e00fcda133cfef10782f08de0"><div class="ttname"><a href="StatisticalUtils_8cpp.html#aa6fd944e00fcda133cfef10782f08de0">ThinningMCMC</a></div><div class="ttdeci">void ThinningMCMC(const std::string &amp;FilePath, const int ThinningCut)</div><div class="ttdoc">Thin MCMC Chain, to save space and maintain low autocorrelations.</div><div class="ttdef"><b>Definition:</b> <a href="StatisticalUtils_8cpp_source.html#l00494">StatisticalUtils.cpp:494</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a523a223a4754c133121796f4591c7be3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a523a223a4754c133121796f4591c7be3">&#9670;&nbsp;</a></span>AccProbBatchedAverages</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double* MCMCProcessor::AccProbBatchedAverages</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds all accProb in batches. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00585">585</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a88cab29770fd6098a674a0ab3628a251"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88cab29770fd6098a674a0ab3628a251">&#9670;&nbsp;</a></span>AccProbValues</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double* MCMCProcessor::AccProbValues</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds all accProb. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00583">583</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a682c1c47626542f5820d633ba2bc010c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a682c1c47626542f5820d633ba2bc010c">&#9670;&nbsp;</a></span>ApplySmoothing</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MCMCProcessor::ApplySmoothing</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Apply smoothing for 2D histos using root algorithm. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00501">501</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a6156bba72e1f076e66f0356e48506a36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6156bba72e1f076e66f0356e48506a36">&#9670;&nbsp;</a></span>AutoCorrLag</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::AutoCorrLag</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>LagL used in AutoCorrelation. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00572">572</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="ab3f590b501162fc2ee5b78ce75689771"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3f590b501162fc2ee5b78ce75689771">&#9670;&nbsp;</a></span>BatchedAverages</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double** MCMCProcessor::BatchedAverages</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Values of batched average for every param and batch. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00575">575</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="ad043b6b2c885f47ab9967831bc8d0f5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad043b6b2c885f47ab9967831bc8d0f5a">&#9670;&nbsp;</a></span>BranchNames</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TString&gt; MCMCProcessor::BranchNames</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00451">451</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="afca259b5bdee2b248d4b1a64ac3e7930"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afca259b5bdee2b248d4b1a64ac3e7930">&#9670;&nbsp;</a></span>BurnInCut</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int MCMCProcessor::BurnInCut</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Value of burn in cut. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00436">436</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="aea84f0315695aa05ec41fcf965b1b031"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea84f0315695aa05ec41fcf965b1b031">&#9670;&nbsp;</a></span>CacheMCMC</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MCMCProcessor::CacheMCMC</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>MCMC Chain has been cached. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00564">564</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="ab5aec3dc293919701d31e6ae705601dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5aec3dc293919701d31e6ae705601dd">&#9670;&nbsp;</a></span>CanvasName</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TString MCMCProcessor::CanvasName</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Name of canvas which help to save to the sample pdf. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00484">484</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="aad661c6d53f9f891e18ff8ccdbd08479"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad661c6d53f9f891e18ff8ccdbd08479">&#9670;&nbsp;</a></span>Central_Value</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TVectorD* MCMCProcessor::Central_Value</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector with central value for each parameter. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00521">521</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a6be3bbebd4a79fe9814a3da09b3bb820"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6be3bbebd4a79fe9814a3da09b3bb820">&#9670;&nbsp;</a></span>Chain</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TChain* MCMCProcessor::Chain</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Main chain storing all steps etc. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00428">428</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a03f28431158777cdd81d058b6632a92f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03f28431158777cdd81d058b6632a92f">&#9670;&nbsp;</a></span>Correlation</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TMatrixDSym* MCMCProcessor::Correlation</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Posterior Correlation Matrix. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00542">542</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="af9a40632e2d7f1266d69a74d5b5f2244"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9a40632e2d7f1266d69a74d5b5f2244">&#9670;&nbsp;</a></span>Covariance</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TMatrixDSym* MCMCProcessor::Covariance</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Posterior Covariance Matrix. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00540">540</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a4c1330a025c0b91e382bdc29c960424a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c1330a025c0b91e382bdc29c960424a">&#9670;&nbsp;</a></span>CovConfig</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;YAML::Node&gt; MCMCProcessor::CovConfig</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Covariance matrix config. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00425">425</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a4a43ac10847a053db74553682f15e1d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a43ac10847a053db74553682f15e1d5">&#9670;&nbsp;</a></span>CovNamePos</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; MCMCProcessor::CovNamePos</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Covariance matrix name position. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00423">423</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a7c6afb0ed75207fd02c28e408f0592d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c6afb0ed75207fd02c28e408f0592d4">&#9670;&nbsp;</a></span>CovPos</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;std::string&gt; &gt; MCMCProcessor::CovPos</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Covariance matrix file name position. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00421">421</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="adf449e50cf358f737fe4a2b65d9668e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf449e50cf358f737fe4a2b65d9668e9">&#9670;&nbsp;</a></span>doDiagMCMC</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MCMCProcessor::doDiagMCMC</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Doing MCMC Diagnostic. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00566">566</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a4abe633b264acd9b0459c7b8ccd8b9df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4abe633b264acd9b0459c7b8ccd8b9df">&#9670;&nbsp;</a></span>DrawRange</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double MCMCProcessor::DrawRange</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Drawrange for SetMaximum. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00561">561</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a5174aaa900edf16ddc6e841ea4adae83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5174aaa900edf16ddc6e841ea4adae83">&#9670;&nbsp;</a></span>Errors</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TVectorD* MCMCProcessor::Errors</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector with errors values using RMS. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00525">525</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="aa78b7ed1bb9966f84f4eaf8cedf5e688"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa78b7ed1bb9966f84f4eaf8cedf5e688">&#9670;&nbsp;</a></span>Errors_Gauss</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TVectorD* MCMCProcessor::Errors_Gauss</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector with error values using Gaussian fit. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00529">529</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="abb5c6ad85c89227bbb9bc5de2eb71272"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb5c6ad85c89227bbb9bc5de2eb71272">&#9670;&nbsp;</a></span>Errors_HPD</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TVectorD* MCMCProcessor::Errors_HPD</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector with error values using Highest Posterior Density. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00533">533</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a7b85df39f22390dac24f4d66a89518e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b85df39f22390dac24f4d66a89518e5">&#9670;&nbsp;</a></span>Errors_HPD_Negative</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TVectorD* MCMCProcessor::Errors_HPD_Negative</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector with negative error (left hand side) values using Highest Posterior Density. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00537">537</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="af96664fa8cc51c49ad1385da07a343b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af96664fa8cc51c49ad1385da07a343b8">&#9670;&nbsp;</a></span>Errors_HPD_Positive</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TVectorD* MCMCProcessor::Errors_HPD_Positive</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector with positive error (right hand side) values using Highest Posterior Density. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00535">535</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a8221ad9d7c814e978a302be016d5f6b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8221ad9d7c814e978a302be016d5f6b8">&#9670;&nbsp;</a></span>ExcludedGroups</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; MCMCProcessor::ExcludedGroups</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00454">454</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a7425f7802e50bcb5ff4b38e20157c423"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7425f7802e50bcb5ff4b38e20157c423">&#9670;&nbsp;</a></span>ExcludedNames</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; MCMCProcessor::ExcludedNames</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00453">453</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="aada4aadea10661586b46c1013a9d018f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aada4aadea10661586b46c1013a9d018f">&#9670;&nbsp;</a></span>ExcludedTypes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; MCMCProcessor::ExcludedTypes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00452">452</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="ad25fe818c94163b0c4a8fcdfd387c148"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad25fe818c94163b0c4a8fcdfd387c148">&#9670;&nbsp;</a></span>FancyPlotNames</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MCMCProcessor::FancyPlotNames</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether we want fancy plot names or not. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00497">497</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a20ee00d448413b8a2653b252d70e88b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20ee00d448413b8a2653b252d70e88b3">&#9670;&nbsp;</a></span>Gauss</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;TF1&gt; MCMCProcessor::Gauss</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gaussian fitter. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00511">511</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a795f661ed1ba8b8ae54c41fde5fb9496"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a795f661ed1ba8b8ae54c41fde5fb9496">&#9670;&nbsp;</a></span>hpost</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TH1D*&gt; MCMCProcessor::hpost</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds 1D Posterior Distributions. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00545">545</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="ac924273ef73ef60a5f6e8a166918bb31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac924273ef73ef60a5f6e8a166918bb31">&#9670;&nbsp;</a></span>hpost2D</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;TH2D*&gt; &gt; MCMCProcessor::hpost2D</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds 2D Posterior Distributions. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00547">547</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a97a9669445c141d9dddc19f1b3562479"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97a9669445c141d9dddc19f1b3562479">&#9670;&nbsp;</a></span>hviolin</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;TH2D&gt; MCMCProcessor::hviolin</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds violin plot for all dials. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00549">549</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a4061fd7eeeee55dd709fe844146ed815"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4061fd7eeeee55dd709fe844146ed815">&#9670;&nbsp;</a></span>hviolin_prior</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;TH2D&gt; MCMCProcessor::hviolin_prior</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds prior violin plot for all dials,. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00551">551</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a95fa49737432818bc830a44898d0d850"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95fa49737432818bc830a44898d0d850">&#9670;&nbsp;</a></span>IamVaried</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;bool&gt; MCMCProcessor::IamVaried</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Is the ith parameter varied. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00457">457</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="aecc35d4ea7d2c7e020e50388ba0ffb64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecc35d4ea7d2c7e020e50388ba0ffb64">&#9670;&nbsp;</a></span>MadePostfit</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MCMCProcessor::MadePostfit</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sanity check if Postfit is already done to not make several times. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00493">493</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a6d212d77a818304a8674a7b9b18d43b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d212d77a818304a8674a7b9b18d43b8">&#9670;&nbsp;</a></span>MCMCFile</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string MCMCProcessor::MCMCFile</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Name of MCMC file. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00417">417</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="acaf7f239136dfa3506d095b612323d0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acaf7f239136dfa3506d095b612323d0a">&#9670;&nbsp;</a></span>Means</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TVectorD* MCMCProcessor::Means</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector with mean values using Arithmetic Mean. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00523">523</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a600fc8c39af2750df91fb7a0ff85ac74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a600fc8c39af2750df91fb7a0ff85ac74">&#9670;&nbsp;</a></span>Means_Gauss</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TVectorD* MCMCProcessor::Means_Gauss</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector with mean values using Gaussian fit. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00527">527</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a32657dc39a7fc0d04804f6195a3d8c3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32657dc39a7fc0d04804f6195a3d8c3e">&#9670;&nbsp;</a></span>Means_HPD</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TVectorD* MCMCProcessor::Means_HPD</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector with mean values using Highest Posterior Density. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00531">531</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a02c5a3f849cf217705816c650c678d19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02c5a3f849cf217705816c650c678d19">&#9670;&nbsp;</a></span>nBatches</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::nBatches</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of batches for Batched Mean. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00570">570</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a6b74f8195bcbca0979f9e9fe43468bae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b74f8195bcbca0979f9e9fe43468bae">&#9670;&nbsp;</a></span>nBins</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::nBins</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of bins. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00559">559</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="af6ba5d9aec5350fafebbf81309e813cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6ba5d9aec5350fafebbf81309e813cb">&#9670;&nbsp;</a></span>nBranches</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::nBranches</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of branches in a TTree. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00438">438</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="aa30545fedb0af2ad9619d6accf42a10d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa30545fedb0af2ad9619d6accf42a10d">&#9670;&nbsp;</a></span>nDraw</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::nDraw</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of all parameters used in the analysis. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00448">448</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="ab2649d6e851ec0a08985a35da299fa5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2649d6e851ec0a08985a35da299fa5b">&#9670;&nbsp;</a></span>NDSamplesBins</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; MCMCProcessor::NDSamplesBins</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00507">507</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="aab80e0a8be27cc9206e1834a2f1f1ca2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab80e0a8be27cc9206e1834a2f1f1ca2">&#9670;&nbsp;</a></span>NDSamplesNames</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; MCMCProcessor::NDSamplesNames</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00508">508</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="af3a19b885e9c34e1674aea8cfbe14e1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3a19b885e9c34e1674aea8cfbe14e1c">&#9670;&nbsp;</a></span>nEntries</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::nEntries</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: For merged chains number of entries will be different from nSteps. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00440">440</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a4200e7cbe1c8f811d3640ebfd648ca85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4200e7cbe1c8f811d3640ebfd648ca85">&#9670;&nbsp;</a></span>nParam</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; MCMCProcessor::nParam</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of parameters per type. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00467">467</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="aa075d77fe6d0be897d5ebf7320f8fe2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa075d77fe6d0be897d5ebf7320f8fe2e">&#9670;&nbsp;</a></span>nParameterHandlers</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::nParameterHandlers</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of covariance objects. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00446">446</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a87a358cbace8251ea3f8dec14ecd4af3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87a358cbace8251ea3f8dec14ecd4af3">&#9670;&nbsp;</a></span>nSampleHandlers</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::nSampleHandlers</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of sample PDF objects. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00444">444</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="aae0016a4e1d105d5d65243438c622a97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae0016a4e1d105d5d65243438c622a97">&#9670;&nbsp;</a></span>nSteps</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::nSteps</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: For merged chains number of entries will be different from nSteps. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00442">442</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a62035b99df4617ab334cd1abd6ed0346"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62035b99df4617ab334cd1abd6ed0346">&#9670;&nbsp;</a></span>OutputFile</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TFile* MCMCProcessor::OutputFile</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The output file. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00514">514</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a3d17c1720b91d6d0361da0b5dabfbbff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d17c1720b91d6d0361da0b5dabfbbff">&#9670;&nbsp;</a></span>OutputName</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string MCMCProcessor::OutputName</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Name of output files. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00482">482</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="aa34b50ce33fb2cb7d9e9ef2d9f2f67c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa34b50ce33fb2cb7d9e9ef2d9f2f67c1">&#9670;&nbsp;</a></span>OutputSuffix</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string MCMCProcessor::OutputSuffix</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Output file suffix useful when running over same file with different settings. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00419">419</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a3a6614826ae320e462211e38e96d9d02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a6614826ae320e462211e38e96d9d02">&#9670;&nbsp;</a></span>ParamCentral</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;double&gt; &gt; MCMCProcessor::ParamCentral</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Parameters central values which we are going to analyse. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00461">461</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a3a97e3cb4be3ceb9eb721eac51d82d60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a97e3cb4be3ceb9eb721eac51d82d60">&#9670;&nbsp;</a></span>ParamErrors</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;double&gt; &gt; MCMCProcessor::ParamErrors</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Uncertainty on a single parameter. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00463">463</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="ab72dd21faa732ec38e550c37635ee66d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab72dd21faa732ec38e550c37635ee66d">&#9670;&nbsp;</a></span>ParameterGroup</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; MCMCProcessor::ParameterGroup</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00474">474</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a4be1eedb743e4ea410009a4fa45720f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4be1eedb743e4ea410009a4fa45720f7">&#9670;&nbsp;</a></span>ParamFlat</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;bool&gt; &gt; MCMCProcessor::ParamFlat</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether Param has flat prior or not. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00465">465</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="adecc55689f7d37b9412f8886fe3480dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adecc55689f7d37b9412f8886fe3480dc">&#9670;&nbsp;</a></span>ParamNames</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;TString&gt; &gt; MCMCProcessor::ParamNames</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Name of parameters which we are going to analyse. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00459">459</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="aaa903949bde8f1a69800c71fe1eb538e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa903949bde8f1a69800c71fe1eb538e">&#9670;&nbsp;</a></span>ParamType</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20b">ParameterEnum</a>&gt; MCMCProcessor::ParamType</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Make an enum for which class this parameter belongs to so we don't have to keep string comparing. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00469">469</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="aeab63979ff36256072c046a15d981875"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeab63979ff36256072c046a15d981875">&#9670;&nbsp;</a></span>ParamTypeStartPos</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; MCMCProcessor::ParamTypeStartPos</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>KS: in MCMC output there is order of parameters so for example first goes xsec then nd det etc. Idea is that this parameter will keep track of it so code is flexible </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00472">472</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a200b389934dcb87bf091229fb7b3fa9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a200b389934dcb87bf091229fb7b3fa9f">&#9670;&nbsp;</a></span>ParStep</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceM3.html#a1f95274549f25fc19fe7db343c8a7a68">M3::float_t</a>** MCMCProcessor::ParStep</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Array holding values for all parameters. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00554">554</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="aa7611f55ac3c0ea70607761d037fbd91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7611f55ac3c0ea70607761d037fbd91">&#9670;&nbsp;</a></span>plotBinValue</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MCMCProcessor::plotBinValue</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>If true it will print value on each bin of covariance matrix. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00499">499</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="ad24411a2556504c440ff0af045e8e7aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad24411a2556504c440ff0af045e8e7aa">&#9670;&nbsp;</a></span>PlotFlatPrior</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MCMCProcessor::PlotFlatPrior</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether we plot flat prior or not, we usually provide error even for flat prior params. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00487">487</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="afbac2a114c15ca7db4abe71dd549504c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbac2a114c15ca7db4abe71dd549504c">&#9670;&nbsp;</a></span>plotRelativeToPrior</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MCMCProcessor::plotRelativeToPrior</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether we plot relative to prior or nominal, in most cases is prior. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00491">491</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a25e4685b6299181021b02ac0e0b74681"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25e4685b6299181021b02ac0e0b74681">&#9670;&nbsp;</a></span>Post2DPlotThreshold</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double MCMCProcessor::Post2DPlotThreshold</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: Set Threshold when to plot 2D posterior as by default we get a LOT of plots. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00503">503</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a61deb3c399dc10813b5cd116f041e981"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61deb3c399dc10813b5cd116f041e981">&#9670;&nbsp;</a></span>Posterior</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;TCanvas&gt; MCMCProcessor::Posterior</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fancy canvas used for our beautiful plots. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00517">517</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a85917e25c4f5b5b966c50cccd9ddd6a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85917e25c4f5b5b966c50cccd9ddd6a0">&#9670;&nbsp;</a></span>Posterior1DCut</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string MCMCProcessor::Posterior1DCut</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Cut used when making 1D Posterior distribution. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00432">432</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="ad73755714ae3d6dc951158d5513c6eee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad73755714ae3d6dc951158d5513c6eee">&#9670;&nbsp;</a></span>printToPDF</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MCMCProcessor::printToPDF</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Will plot all plot to PDF not only to root file. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00495">495</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="ad56b25b03eb5caab7b2a9c2ebf3ec178"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad56b25b03eb5caab7b2a9c2ebf3ec178">&#9670;&nbsp;</a></span>ReweightName</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string MCMCProcessor::ReweightName</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Name of branch used for chain reweighting. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00590">590</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a6f27039da3508952600b1ef26e76fe19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f27039da3508952600b1ef26e76fe19">&#9670;&nbsp;</a></span>ReweightPosterior</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MCMCProcessor::ReweightPosterior</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether to apply reweighting weight or not. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00588">588</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a3660e404a6631cfa913a815481730a9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3660e404a6631cfa913a815481730a9b">&#9670;&nbsp;</a></span>SampleName_v</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TString&gt; MCMCProcessor::SampleName_v</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector of each systematic. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00477">477</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a28e89498420221149ec97c353c430bf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28e89498420221149ec97c353c430bf8">&#9670;&nbsp;</a></span>SampleValues</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double** MCMCProcessor::SampleValues</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds the sample values. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00578">578</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a576f0eb874afaf7e31ff5c86b9e5b8f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a576f0eb874afaf7e31ff5c86b9e5b8f9">&#9670;&nbsp;</a></span>StepCut</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string MCMCProcessor::StepCut</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>BurnIn Cuts. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00430">430</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a6058bb3e817401423231f85a71db46a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6058bb3e817401423231f85a71db46a0">&#9670;&nbsp;</a></span>StepNumber</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int* MCMCProcessor::StepNumber</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Step number for step, important if chains were merged. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00556">556</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="acb1871575fdd3ae156aed4bf7c7a0a73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb1871575fdd3ae156aed4bf7c7a0a73">&#9670;&nbsp;</a></span>SystName_v</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TString&gt; MCMCProcessor::SystName_v</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector of each sample PDF object. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00479">479</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a4eb2748c81b0aef9bd7e14785559e301"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4eb2748c81b0aef9bd7e14785559e301">&#9670;&nbsp;</a></span>SystValues</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double** MCMCProcessor::SystValues</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds the systs values. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00580">580</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a6b14dd9e571803d8946781642348bee1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b14dd9e571803d8946781642348bee1">&#9670;&nbsp;</a></span>UpperCut</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int MCMCProcessor::UpperCut</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: Used only for SubOptimality. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00434">434</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a562261269f0f4ec4a209b2fca64ff443"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a562261269f0f4ec4a209b2fca64ff443">&#9670;&nbsp;</a></span>useFFTAutoCorrelation</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MCMCProcessor::useFFTAutoCorrelation</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>MJR: Use FFT-based autocorrelation algorithm (save time &amp; resources)? </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00505">505</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a39d4d6d8cfccf1974a6b084f808211a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39d4d6d8cfccf1974a6b084f808211a9">&#9670;&nbsp;</a></span>WeightValue</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double* MCMCProcessor::WeightValue</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stores value of weight for each step. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00592">592</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>Fitters/<a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a></li>
<li>Fitters/<a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- Footer for MaCh3 Doxygen documentation -->
<footer class="mach3-footer" style="text-align: center;">
    <div style="margin-bottom: 15px;">
        <span style="font-weight: bold;">The MaCh3 Collaboration</span>
    </div>
    <!-- Dropdown to jump between doc versions -->
    <div style="margin-bottom: 10px;">
        <span>Select Software Version: </span>
        <select id="versionSelector" onchange="window.location.href=this.value" style="padding: 5px; border-radius: 4px; border: 1px solid #ccc;">
            <option value="">-- Select --</option>
            <option value="https://mach3-software.github.io/MaCh3/">develop</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.3.0/index.html">v2.3.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.2.0/index.html">v2.2.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.1.0/index.html">v2.1.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v2.0.0/index.html">v2.0.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.5.0/index.html">v1.5.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.4.0/index.html">v1.4.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.3.0/index.html">v1.3.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.2.0/index.html">v1.2.0</option>
            <option value="https://mach3-software.github.io/MaCh3/.Archive/v1.1.0/index.html">v1.1.0</option>
        </select>
    </div>
    <!-- Footer info about doxygen -->
    <div style="font-size: 0.9em; color: #666; margin-top: 10px;">
        Documentation generated with
        <a href="https://www.doxygen.nl/" target="_blank" style="color: #666;">Doxygen</a>
        <span id="doxygenVersion"></span>
    </div>
    <!-- Now grab doxygen version from metadata -->
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        const meta = document.querySelector('meta[name="generator"]');
        if (meta) {
            const version = meta.getAttribute("content").replace("Doxygen ", "");
            document.getElementById("doxygenVersion").textContent = " " + version;
        }
    });
    </script>
</footer>
