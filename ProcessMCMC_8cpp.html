<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MaCh3: Diagnostics/ProcessMCMC.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="MaCh3.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="mach3logo_small.png"/></td>
  <td id="projectalign">
   <div id="projectname">MaCh3<span id="projectnumber">&#160;1.3.3</span>
   </div>
   <div id="projectbrief">Reference Guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_335e938d2c12c5a13717c0a8a9316e75.html">Diagnostics</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">ProcessMCMC.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Main exectable responsible for different types of MCMC processing like drawing posteriors, triangle plots etc. Actual implantation of methods is in <a class="el" href="classMCMCProcessor.html" title="Class responsible for processing MCMC chains, performing diagnostics, generating plots,...">MCMCProcessor</a>.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="MCMCProcessor_8h_source.html">mcmc/MCMCProcessor.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="manager_8h_source.html">manager/manager.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ProcessMCMC.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="ProcessMCMC_8cpp__incl.png" border="0" usemap="#aDiagnostics_2ProcessMCMC_8cpp" alt=""/></div>
<map name="aDiagnostics_2ProcessMCMC_8cpp" id="aDiagnostics_2ProcessMCMC_8cpp">
<area shape="rect" title="Main exectable responsible for different types of MCMC processing like drawing posteriors,..." alt="" coords="1197,5,1418,31"/>
<area shape="rect" href="MCMCProcessor_8h.html" title=" " alt="" coords="2029,79,2212,104"/>
<area shape="rect" href="manager_8h.html" title=" " alt="" coords="416,225,569,251"/>
<area shape="rect" title=" " alt="" coords="3361,152,3440,177"/>
<area shape="rect" title=" " alt="" coords="3465,152,3526,177"/>
<area shape="rect" title=" " alt="" coords="1400,519,1465,544"/>
<area shape="rect" title=" " alt="" coords="737,445,824,471"/>
<area shape="rect" title=" " alt="" coords="1297,152,1387,177"/>
<area shape="rect" title=" " alt="" coords="1411,152,1481,177"/>
<area shape="rect" title=" " alt="" coords="1505,152,1595,177"/>
<area shape="rect" title=" " alt="" coords="1619,152,1699,177"/>
<area shape="rect" title=" " alt="" coords="1724,152,1843,177"/>
<area shape="rect" title=" " alt="" coords="1867,152,1961,177"/>
<area shape="rect" title=" " alt="" coords="1985,152,2059,177"/>
<area shape="rect" title=" " alt="" coords="2083,152,2158,177"/>
<area shape="rect" title=" " alt="" coords="848,445,959,471"/>
<area shape="rect" title=" " alt="" coords="2182,152,2251,177"/>
<area shape="rect" title=" " alt="" coords="2276,152,2355,177"/>
<area shape="rect" title=" " alt="" coords="983,445,1053,471"/>
<area shape="rect" title=" " alt="" coords="2379,152,2457,177"/>
<area shape="rect" title=" " alt="" coords="2482,152,2546,177"/>
<area shape="rect" title=" " alt="" coords="2570,152,2674,177"/>
<area shape="rect" title=" " alt="" coords="2699,152,2812,177"/>
<area shape="rect" title=" " alt="" coords="2836,152,2923,177"/>
<area shape="rect" title=" " alt="" coords="2947,152,3022,177"/>
<area shape="rect" title=" " alt="" coords="3047,152,3205,177"/>
<area shape="rect" title=" " alt="" coords="3230,152,3337,177"/>
<area shape="rect" href="StatisticalUtils_8h.html" title="Utility functions for statistical interpretations in MaCh3." alt="" coords="1049,152,1222,177"/>
<area shape="rect" href="HistogramUtils_8h.html" title=" " alt="" coords="1518,225,1729,251"/>
<area shape="rect" title=" " alt="" coords="617,665,697,691"/>
<area shape="rect" title=" " alt="" coords="1226,665,1301,691"/>
<area shape="rect" title=" " alt="" coords="1301,519,1375,544"/>
<area shape="rect" title=" " alt="" coords="1045,519,1108,544"/>
<area shape="rect" title=" " alt="" coords="1173,225,1258,251"/>
<area shape="rect" title=" " alt="" coords="657,372,720,397"/>
<area shape="rect" href="Structs_8h.html" title=" " alt="" coords="1127,445,1285,471"/>
<area shape="rect" title=" " alt="" coords="620,519,693,544"/>
<area shape="rect" title=" " alt="" coords="1183,519,1226,544"/>
<area shape="rect" href="MaCh3Exception_8h.html" title=" " alt="" coords="187,519,393,544"/>
<area shape="rect" href="MaCh3Logger_8h.html" title="KS: Based on this https://github.com/gabime/spdlog/blob/a2b4262090fd3f005c2315dcb5be2f0f1774a005/incl..." alt="" coords="158,592,342,617"/>
<area shape="rect" title=" " alt="" coords="867,519,969,544"/>
<area shape="rect" title=" " alt="" coords="375,665,434,691"/>
<area shape="rect" title=" " alt="" coords="116,665,240,691"/>
<area shape="rect" title=" " alt="" coords="264,665,351,691"/>
<area shape="rect" title=" " alt="" coords="5,665,92,691"/>
<area shape="rect" href="YamlHelper_8h.html" title="Utility functions for handling YAML nodes." alt="" coords="340,445,509,471"/>
<area shape="rect" href="Monitor_8h.html" title="System and monitoring utilities for printing system information and status updates." alt="" coords="488,372,633,397"/>
<area shape="rect" href="MaCh3Modes_8h.html" title=" " alt="" coords="333,299,517,324"/>
<area shape="rect" title=" " alt="" coords="1539,299,1708,324"/>
<area shape="rect" title=" " alt="" coords="1733,299,1863,324"/>
</map>
</div>
</div>
<p><a href="ProcessMCMC_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a52c48199a4bcad577b88768020a91041"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProcessMCMC_8cpp.html#a52c48199a4bcad577b88768020a91041">ProcessMCMC</a> (const std::string &amp;inputFile)</td></tr>
<tr class="memdesc:a52c48199a4bcad577b88768020a91041"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main function processing MCMC and Producing plots.  <br /></td></tr>
<tr class="separator:a52c48199a4bcad577b88768020a91041"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83be70750a728e4deae518ea3ffaf388"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProcessMCMC_8cpp.html#a83be70750a728e4deae518ea3ffaf388">MultipleProcessMCMC</a> ()</td></tr>
<tr class="memdesc:a83be70750a728e4deae518ea3ffaf388"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function producing comparison of posterior and more betwen a few MCMC chains.  <br /></td></tr>
<tr class="separator:a83be70750a728e4deae518ea3ffaf388"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a245ba87c995dcf10ed6cf0dac6cfc1db"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProcessMCMC_8cpp.html#a245ba87c995dcf10ed6cf0dac6cfc1db">CalcBayesFactor</a> (const std::unique_ptr&lt; <a class="el" href="classMCMCProcessor.html">MCMCProcessor</a> &gt; &amp;Processor)</td></tr>
<tr class="separator:a245ba87c995dcf10ed6cf0dac6cfc1db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87fd44b861c503ca5e439678c6686dd4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProcessMCMC_8cpp.html#a87fd44b861c503ca5e439678c6686dd4">CalcSavageDickey</a> (const std::unique_ptr&lt; <a class="el" href="classMCMCProcessor.html">MCMCProcessor</a> &gt; &amp;Processor)</td></tr>
<tr class="separator:a87fd44b861c503ca5e439678c6686dd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25ccf00b1b90332a01ed03d9b61dbd1a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProcessMCMC_8cpp.html#a25ccf00b1b90332a01ed03d9b61dbd1a">CalcBipolarPlot</a> (const std::unique_ptr&lt; <a class="el" href="classMCMCProcessor.html">MCMCProcessor</a> &gt; &amp;Processor)</td></tr>
<tr class="separator:a25ccf00b1b90332a01ed03d9b61dbd1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af636045ccba99a8080c1ddd19466fcf8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProcessMCMC_8cpp.html#af636045ccba99a8080c1ddd19466fcf8">CalcParameterEvolution</a> (const std::unique_ptr&lt; <a class="el" href="classMCMCProcessor.html">MCMCProcessor</a> &gt; &amp;Processor)</td></tr>
<tr class="separator:af636045ccba99a8080c1ddd19466fcf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36519c64a11fdb905e91fd3db08e0f80"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProcessMCMC_8cpp.html#a36519c64a11fdb905e91fd3db08e0f80">GetTrianglePlot</a> (const std::unique_ptr&lt; <a class="el" href="classMCMCProcessor.html">MCMCProcessor</a> &gt; &amp;Processor)</td></tr>
<tr class="separator:a36519c64a11fdb905e91fd3db08e0f80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a721fcdb3001f72ff5e40d6334d56e0d0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProcessMCMC_8cpp.html#a721fcdb3001f72ff5e40d6334d56e0d0">DiagnoseCovarianceMatrix</a> (const std::unique_ptr&lt; <a class="el" href="classMCMCProcessor.html">MCMCProcessor</a> &gt; &amp;Processor, const std::string &amp;inputFile)</td></tr>
<tr class="memdesc:a721fcdb3001f72ff5e40d6334d56e0d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: You validate stability of posterior covariance matrix, you set burn calc cov matrix increase burn calc again and compare. By performing such operation several hundred times we can check when matrix becomes stable.  <br /></td></tr>
<tr class="separator:a721fcdb3001f72ff5e40d6334d56e0d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65a553e49041cfa24ab0432d1307416a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProcessMCMC_8cpp.html#a65a553e49041cfa24ab0432d1307416a">ReweightPrior</a> (const std::unique_ptr&lt; <a class="el" href="classMCMCProcessor.html">MCMCProcessor</a> &gt; &amp;Processor)</td></tr>
<tr class="separator:a65a553e49041cfa24ab0432d1307416a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2052da75bc58457dc290c8cbd06efe30"><td class="memItemLeft" align="right" valign="top">TH2D *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProcessMCMC_8cpp.html#a2052da75bc58457dc290c8cbd06efe30">TMatrixIntoTH2D</a> (TMatrixDSym *Matrix, const std::string &amp;title)</td></tr>
<tr class="memdesc:a2052da75bc58457dc290c8cbd06efe30"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Convert TMatrix to TH2D, mostly useful for making fancy plots.  <br /></td></tr>
<tr class="separator:a2052da75bc58457dc290c8cbd06efe30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7dc6e50355636d9c3d51a627e5dfbb3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProcessMCMC_8cpp.html#af7dc6e50355636d9c3d51a627e5dfbb3">KolmogorovSmirnovTest</a> (const std::vector&lt; std::unique_ptr&lt; <a class="el" href="classMCMCProcessor.html">MCMCProcessor</a> &gt; &gt; &amp;Processor, const std::unique_ptr&lt; TCanvas &gt; &amp;Posterior, const TString &amp;canvasname)</td></tr>
<tr class="memdesc:af7dc6e50355636d9c3d51a627e5dfbb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Perform KS test to check if two posteriors for the same parameter came from the same distribution.  <br /></td></tr>
<tr class="separator:af7dc6e50355636d9c3d51a627e5dfbb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProcessMCMC_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a6b25bcddaae9b868109dc98a54476e46"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a></td></tr>
<tr class="separator:a6b25bcddaae9b868109dc98a54476e46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e90c1478f4be185364988cac765a163"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProcessMCMC_8cpp.html#a8e90c1478f4be185364988cac765a163">FileNames</a></td></tr>
<tr class="separator:a8e90c1478f4be185364988cac765a163"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bff863f66d44b865ce21762802730c8"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProcessMCMC_8cpp.html#a2bff863f66d44b865ce21762802730c8">TitleNames</a></td></tr>
<tr class="separator:a2bff863f66d44b865ce21762802730c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13056efd080ab16304b6f7be0ebf0a61"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProcessMCMC_8cpp.html#a13056efd080ab16304b6f7be0ebf0a61">config</a></td></tr>
<tr class="separator:a13056efd080ab16304b6f7be0ebf0a61"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Main exectable responsible for different types of MCMC processing like drawing posteriors, triangle plots etc. Actual implantation of methods is in <a class="el" href="classMCMCProcessor.html" title="Class responsible for processing MCMC chains, performing diagnostics, generating plots,...">MCMCProcessor</a>. </p>

<p class="definition">Definition in file <a class="el" href="ProcessMCMC_8cpp_source.html">ProcessMCMC.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a245ba87c995dcf10ed6cf0dac6cfc1db" name="a245ba87c995dcf10ed6cf0dac6cfc1db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a245ba87c995dcf10ed6cf0dac6cfc1db">&#9670;&#160;</a></span>CalcBayesFactor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CalcBayesFactor </td>
          <td>(</td>
          <td class="paramtype">const std::unique_ptr&lt; <a class="el" href="classMCMCProcessor.html">MCMCProcessor</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>Processor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ProcessMCMC_8cpp_source.html#l00319">319</a> of file <a class="el" href="ProcessMCMC_8cpp_source.html">ProcessMCMC.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  320</span>{</div>
<div class="line"><span class="lineno">  321</span>  YAML::Node card_yaml = YAML::LoadFile(<a class="code hl_variable" href="ProcessMCMC_8cpp.html#a13056efd080ab16304b6f7be0ebf0a61">config</a>.c_str());</div>
<div class="line"><span class="lineno">  322</span>  YAML::Node Settings = card_yaml[<span class="stringliteral">&quot;ProcessMCMC&quot;</span>];</div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span>  std::vector&lt;std::string&gt; ParNames;</div>
<div class="line"><span class="lineno">  325</span>  std::vector&lt;std::vector&lt;double&gt;&gt; Model1Bounds;</div>
<div class="line"><span class="lineno">  326</span>  std::vector&lt;std::vector&lt;double&gt;&gt; Model2Bounds;</div>
<div class="line"><span class="lineno">  327</span>  std::vector&lt;std::vector&lt;std::string&gt;&gt; ModelNames;</div>
<div class="line"><span class="lineno">  328</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; dg : Settings[<span class="stringliteral">&quot;BayesFactor&quot;</span>])</div>
<div class="line"><span class="lineno">  329</span>  {</div>
<div class="line"><span class="lineno">  330</span>    ParNames.push_back(dg[0].as&lt;std::string&gt;());</div>
<div class="line"><span class="lineno">  331</span>    ModelNames.push_back(dg[1].as&lt;std::vector&lt;std::string&gt;&gt;());</div>
<div class="line"><span class="lineno">  332</span>    Model1Bounds.push_back(dg[2].as&lt;std::vector&lt;double&gt;&gt;());</div>
<div class="line"><span class="lineno">  333</span>    Model2Bounds.push_back(dg[3].as&lt;std::vector&lt;double&gt;&gt;());</div>
<div class="line"><span class="lineno">  334</span>  }</div>
<div class="line"><span class="lineno">  335</span> </div>
<div class="line"><span class="lineno">  336</span>  Processor-&gt;GetBayesFactor(ParNames, Model1Bounds, Model2Bounds, ModelNames);</div>
<div class="line"><span class="lineno">  337</span>}</div>
<div class="ttc" id="aProcessMCMC_8cpp_html_a13056efd080ab16304b6f7be0ebf0a61"><div class="ttname"><a href="ProcessMCMC_8cpp.html#a13056efd080ab16304b6f7be0ebf0a61">config</a></div><div class="ttdeci">std::string config</div><div class="ttdef"><b>Definition:</b> <a href="ProcessMCMC_8cpp_source.html#l00029">ProcessMCMC.cpp:29</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a25ccf00b1b90332a01ed03d9b61dbd1a" name="a25ccf00b1b90332a01ed03d9b61dbd1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25ccf00b1b90332a01ed03d9b61dbd1a">&#9670;&#160;</a></span>CalcBipolarPlot()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CalcBipolarPlot </td>
          <td>(</td>
          <td class="paramtype">const std::unique_ptr&lt; <a class="el" href="classMCMCProcessor.html">MCMCProcessor</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>Processor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ProcessMCMC_8cpp_source.html#l00372">372</a> of file <a class="el" href="ProcessMCMC_8cpp_source.html">ProcessMCMC.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  373</span>{</div>
<div class="line"><span class="lineno">  374</span>  YAML::Node card_yaml = YAML::LoadFile(<a class="code hl_variable" href="ProcessMCMC_8cpp.html#a13056efd080ab16304b6f7be0ebf0a61">config</a>.c_str());</div>
<div class="line"><span class="lineno">  375</span>  YAML::Node Settings = card_yaml[<span class="stringliteral">&quot;ProcessMCMC&quot;</span>];</div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span>  std::vector&lt;std::string&gt; ParNames;</div>
<div class="line"><span class="lineno">  378</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; d : Settings[<span class="stringliteral">&quot;BipolarPlot&quot;</span>])</div>
<div class="line"><span class="lineno">  379</span>  {</div>
<div class="line"><span class="lineno">  380</span>    ParNames.push_back(d[0].as&lt;std::string&gt;());</div>
<div class="line"><span class="lineno">  381</span>  }</div>
<div class="line"><span class="lineno">  382</span>  Processor-&gt;GetPolarPlot(ParNames);</div>
<div class="line"><span class="lineno">  383</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af636045ccba99a8080c1ddd19466fcf8" name="af636045ccba99a8080c1ddd19466fcf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af636045ccba99a8080c1ddd19466fcf8">&#9670;&#160;</a></span>CalcParameterEvolution()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CalcParameterEvolution </td>
          <td>(</td>
          <td class="paramtype">const std::unique_ptr&lt; <a class="el" href="classMCMCProcessor.html">MCMCProcessor</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>Processor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ProcessMCMC_8cpp_source.html#l00357">357</a> of file <a class="el" href="ProcessMCMC_8cpp_source.html">ProcessMCMC.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  358</span>{</div>
<div class="line"><span class="lineno">  359</span>  YAML::Node card_yaml = YAML::LoadFile(<a class="code hl_variable" href="ProcessMCMC_8cpp.html#a13056efd080ab16304b6f7be0ebf0a61">config</a>.c_str());</div>
<div class="line"><span class="lineno">  360</span>  YAML::Node Settings = card_yaml[<span class="stringliteral">&quot;ProcessMCMC&quot;</span>];</div>
<div class="line"><span class="lineno">  361</span> </div>
<div class="line"><span class="lineno">  362</span>  std::vector&lt;std::string&gt; ParNames;</div>
<div class="line"><span class="lineno">  363</span>  std::vector&lt;int&gt; Intervals;</div>
<div class="line"><span class="lineno">  364</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; d : Settings[<span class="stringliteral">&quot;ParameterEvolution&quot;</span>])</div>
<div class="line"><span class="lineno">  365</span>  {</div>
<div class="line"><span class="lineno">  366</span>    ParNames.push_back(d[0].as&lt;std::string&gt;());</div>
<div class="line"><span class="lineno">  367</span>    Intervals.push_back(d[1].as&lt;int&gt;());</div>
<div class="line"><span class="lineno">  368</span>  }</div>
<div class="line"><span class="lineno">  369</span>  Processor-&gt;ParameterEvolution(ParNames, Intervals);</div>
<div class="line"><span class="lineno">  370</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a87fd44b861c503ca5e439678c6686dd4" name="a87fd44b861c503ca5e439678c6686dd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87fd44b861c503ca5e439678c6686dd4">&#9670;&#160;</a></span>CalcSavageDickey()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CalcSavageDickey </td>
          <td>(</td>
          <td class="paramtype">const std::unique_ptr&lt; <a class="el" href="classMCMCProcessor.html">MCMCProcessor</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>Processor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ProcessMCMC_8cpp_source.html#l00339">339</a> of file <a class="el" href="ProcessMCMC_8cpp_source.html">ProcessMCMC.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  340</span>{</div>
<div class="line"><span class="lineno">  341</span>  YAML::Node card_yaml = YAML::LoadFile(<a class="code hl_variable" href="ProcessMCMC_8cpp.html#a13056efd080ab16304b6f7be0ebf0a61">config</a>.c_str());</div>
<div class="line"><span class="lineno">  342</span>  YAML::Node Settings = card_yaml[<span class="stringliteral">&quot;ProcessMCMC&quot;</span>];</div>
<div class="line"><span class="lineno">  343</span> </div>
<div class="line"><span class="lineno">  344</span>  std::vector&lt;std::string&gt; ParNames;</div>
<div class="line"><span class="lineno">  345</span>  std::vector&lt;double&gt; EvaluationPoint;</div>
<div class="line"><span class="lineno">  346</span>  std::vector&lt;std::vector&lt;double&gt;&gt; Bounds;</div>
<div class="line"><span class="lineno">  347</span>  </div>
<div class="line"><span class="lineno">  348</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; d : Settings[<span class="stringliteral">&quot;SavageDickey&quot;</span>])</div>
<div class="line"><span class="lineno">  349</span>  {</div>
<div class="line"><span class="lineno">  350</span>    ParNames.push_back(d[0].as&lt;std::string&gt;());</div>
<div class="line"><span class="lineno">  351</span>    EvaluationPoint.push_back(d[1].as&lt;double&gt;());</div>
<div class="line"><span class="lineno">  352</span>    Bounds.push_back(d[2].as&lt;std::vector&lt;double&gt;&gt;());</div>
<div class="line"><span class="lineno">  353</span>  }</div>
<div class="line"><span class="lineno">  354</span>  Processor-&gt;GetSavageDickey(ParNames, EvaluationPoint, Bounds);</div>
<div class="line"><span class="lineno">  355</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a721fcdb3001f72ff5e40d6334d56e0d0" name="a721fcdb3001f72ff5e40d6334d56e0d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a721fcdb3001f72ff5e40d6334d56e0d0">&#9670;&#160;</a></span>DiagnoseCovarianceMatrix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DiagnoseCovarianceMatrix </td>
          <td>(</td>
          <td class="paramtype">const std::unique_ptr&lt; <a class="el" href="classMCMCProcessor.html">MCMCProcessor</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>Processor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>inputFile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: You validate stability of posterior covariance matrix, you set burn calc cov matrix increase burn calc again and compare. By performing such operation several hundred times we can check when matrix becomes stable. </p>

<p class="definition">Definition at line <a class="el" href="ProcessMCMC_8cpp_source.html#l00405">405</a> of file <a class="el" href="ProcessMCMC_8cpp_source.html">ProcessMCMC.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  406</span>{</div>
<div class="line"><span class="lineno">  407</span>  <span class="comment">//Turn of plots from Processor</span></div>
<div class="line"><span class="lineno">  408</span>  Processor-&gt;SetPrintToPDF(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  409</span>  <span class="comment">// Open a TCanvas to write the posterior onto</span></div>
<div class="line"><span class="lineno">  410</span>  <span class="keyword">auto</span> Canvas = std::make_unique&lt;TCanvas&gt;(<span class="stringliteral">&quot;Canvas&quot;</span>, <span class="stringliteral">&quot;Canvas&quot;</span>, 0, 0, 1024, 1024);</div>
<div class="line"><span class="lineno">  411</span>  Canvas-&gt;SetGrid();</div>
<div class="line"><span class="lineno">  412</span>  gStyle-&gt;SetOptStat(0);</div>
<div class="line"><span class="lineno">  413</span>  gStyle-&gt;SetOptTitle(0);</div>
<div class="line"><span class="lineno">  414</span>  Canvas-&gt;SetTickx();</div>
<div class="line"><span class="lineno">  415</span>  Canvas-&gt;SetTicky();</div>
<div class="line"><span class="lineno">  416</span>  Canvas-&gt;SetBottomMargin(0.1f);</div>
<div class="line"><span class="lineno">  417</span>  Canvas-&gt;SetTopMargin(0.05f);</div>
<div class="line"><span class="lineno">  418</span>  Canvas-&gt;SetRightMargin(0.15f);</div>
<div class="line"><span class="lineno">  419</span>  Canvas-&gt;SetLeftMargin(0.10f);</div>
<div class="line"><span class="lineno">  420</span>  </div>
<div class="line"><span class="lineno">  421</span>  <span class="comment">//KS: Fancy colours</span></div>
<div class="line"><span class="lineno">  422</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> NRGBs = 10;</div>
<div class="line"><span class="lineno">  423</span>  TColor::InitializeColors();</div>
<div class="line"><span class="lineno">  424</span>  Double_t stops[NRGBs] = { 0.00, 0.10, 0.25, 0.35, 0.50, 0.60, 0.65, 0.75, 0.90, 1.00 };</div>
<div class="line"><span class="lineno">  425</span>  Double_t red[NRGBs]   = { 0.50, 1.00, 1.00, 0.25, 0.00, 0.10, 0.50, 1.00, 0.75, 0.55 };</div>
<div class="line"><span class="lineno">  426</span>  Double_t green[NRGBs] = { 0.00, 0.25, 1.00, 0.25, 0.00, 0.60, 0.90, 1.00, 0.75, 0.75 };</div>
<div class="line"><span class="lineno">  427</span>  Double_t blue[NRGBs]  = { 0.00, 0.25, 1.00, 1.00, 0.50, 0.60, 0.90, 1.00, 0.05, 0.05 };</div>
<div class="line"><span class="lineno">  428</span>  TColor::CreateGradientColorTable(NRGBs, stops, red, green, blue, 255);</div>
<div class="line"><span class="lineno">  429</span>  gStyle-&gt;SetNumberContours(255);</div>
<div class="line"><span class="lineno">  430</span>  </div>
<div class="line"><span class="lineno">  431</span>  std::string OutName = inputFile;</div>
<div class="line"><span class="lineno">  432</span>  OutName = OutName.substr(0, OutName.find(<span class="stringliteral">&quot;.root&quot;</span>));</div>
<div class="line"><span class="lineno">  433</span>  Canvas-&gt;Print(Form(<span class="stringliteral">&quot;Correlation_%s.pdf[&quot;</span>, OutName.c_str()), <span class="stringliteral">&quot;pdf&quot;</span>);</div>
<div class="line"><span class="lineno">  434</span>  Canvas-&gt;Print(Form(<span class="stringliteral">&quot;Covariance_%s.pdf[&quot;</span>, OutName.c_str()), <span class="stringliteral">&quot;pdf&quot;</span>);</div>
<div class="line"><span class="lineno">  435</span>  </div>
<div class="line"><span class="lineno">  436</span>  YAML::Node card_yaml = YAML::LoadFile(<a class="code hl_variable" href="ProcessMCMC_8cpp.html#a13056efd080ab16304b6f7be0ebf0a61">config</a>.c_str());</div>
<div class="line"><span class="lineno">  437</span>  YAML::Node Settings = card_yaml[<span class="stringliteral">&quot;ProcessMCMC&quot;</span>];</div>
<div class="line"><span class="lineno">  438</span> </div>
<div class="line"><span class="lineno">  439</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> entries = int(Processor-&gt;GetnSteps());</div>
<div class="line"><span class="lineno">  440</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> NIntervals = GetFromManager&lt;int&gt;(Settings[<span class="stringliteral">&quot;NIntervals&quot;</span>], 5);</div>
<div class="line"><span class="lineno">  441</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> IntervalsSize = entries/NIntervals;</div>
<div class="line"><span class="lineno">  442</span>  <span class="comment">//We start with burn from 0 (no burn in at all)</span></div>
<div class="line"><span class="lineno">  443</span>  <span class="keywordtype">int</span> BurnIn = 0;</div>
<div class="line"><span class="lineno">  444</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Diagnosing matrices with entries={}, NIntervals={} and IntervalsSize={}&quot;</span>, entries, NIntervals, IntervalsSize);</div>
<div class="line"><span class="lineno">  445</span> </div>
<div class="line"><span class="lineno">  446</span>  TMatrixDSym *Covariance = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  447</span>  TMatrixDSym *Correlation = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  448</span>  </div>
<div class="line"><span class="lineno">  449</span>  TH2D *CovariancePreviousHist = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  450</span>  TH2D *CorrelationPreviousHist = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  451</span> </div>
<div class="line"><span class="lineno">  452</span>  TH2D *CovarianceHist = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  453</span>  TH2D *CorrelationHist = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>  <span class="comment">//KS: Get first covariances, we need two for comparison...</span></div>
<div class="line"><span class="lineno">  456</span>  Processor-&gt;SetStepCut(BurnIn);</div>
<div class="line"><span class="lineno">  457</span>  Processor-&gt;GetCovariance(Covariance, Correlation);</div>
<div class="line"><span class="lineno">  458</span>  </div>
<div class="line"><span class="lineno">  459</span>  CovariancePreviousHist = <a class="code hl_function" href="ProcessMCMC_8cpp.html#a2052da75bc58457dc290c8cbd06efe30">TMatrixIntoTH2D</a>(Covariance, <span class="stringliteral">&quot;Covariance&quot;</span>); </div>
<div class="line"><span class="lineno">  460</span>  CorrelationPreviousHist = <a class="code hl_function" href="ProcessMCMC_8cpp.html#a2052da75bc58457dc290c8cbd06efe30">TMatrixIntoTH2D</a>(Correlation, <span class="stringliteral">&quot;Correlation&quot;</span>);</div>
<div class="line"><span class="lineno">  461</span>      </div>
<div class="line"><span class="lineno">  462</span>  <span class="keyword">delete</span> Covariance;</div>
<div class="line"><span class="lineno">  463</span>  Covariance = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  464</span>  <span class="keyword">delete</span> Correlation;</div>
<div class="line"><span class="lineno">  465</span>  Correlation = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  466</span>  </div>
<div class="line"><span class="lineno">  467</span>  <span class="comment">//KS: Loop over all desired cuts</span></div>
<div class="line"><span class="lineno">  468</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 1; k &lt; NIntervals; ++k)</div>
<div class="line"><span class="lineno">  469</span>  {</div>
<div class="line"><span class="lineno">  470</span>    BurnIn = k*IntervalsSize;</div>
<div class="line"><span class="lineno">  471</span>    Processor-&gt;SetStepCut(BurnIn);</div>
<div class="line"><span class="lineno">  472</span>    Processor-&gt;GetCovariance(Covariance, Correlation);</div>
<div class="line"><span class="lineno">  473</span>    Processor-&gt;ResetHistograms();</div>
<div class="line"><span class="lineno">  474</span>    </div>
<div class="line"><span class="lineno">  475</span>    CovarianceHist = <a class="code hl_function" href="ProcessMCMC_8cpp.html#a2052da75bc58457dc290c8cbd06efe30">TMatrixIntoTH2D</a>(Covariance, <span class="stringliteral">&quot;Covariance&quot;</span>); </div>
<div class="line"><span class="lineno">  476</span>    CorrelationHist = <a class="code hl_function" href="ProcessMCMC_8cpp.html#a2052da75bc58457dc290c8cbd06efe30">TMatrixIntoTH2D</a>(Correlation, <span class="stringliteral">&quot;Correlation&quot;</span>);</div>
<div class="line"><span class="lineno">  477</span>            </div>
<div class="line"><span class="lineno">  478</span>    TH2D *CovarianceDiff = <span class="keyword">static_cast&lt;</span>TH2D*<span class="keyword">&gt;</span>(CovarianceHist-&gt;Clone(<span class="stringliteral">&quot;Covariance_Ratio&quot;</span>));</div>
<div class="line"><span class="lineno">  479</span>    TH2D *CorrelationDiff = <span class="keyword">static_cast&lt;</span>TH2D*<span class="keyword">&gt;</span>(CorrelationHist-&gt;Clone(<span class="stringliteral">&quot;Correlation_Ratio&quot;</span>));</div>
<div class="line"><span class="lineno">  480</span>    </div>
<div class="line"><span class="lineno">  481</span>    <span class="comment">//KS: Bit messy but quite often covariance is 0 is divided by 0 is problematic so</span></div>
<div class="line"><span class="lineno">  482</span><span class="preprocessor">    #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  483</span><span class="preprocessor">    #pragma omp parallel for</span></div>
<div class="line"><span class="lineno">  484</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  485</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; CovarianceDiff-&gt;GetXaxis()-&gt;GetNbins()+1; ++j)</div>
<div class="line"><span class="lineno">  486</span>    {</div>
<div class="line"><span class="lineno">  487</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; CovarianceDiff-&gt;GetYaxis()-&gt;GetNbins()+1; ++i)</div>
<div class="line"><span class="lineno">  488</span>      {</div>
<div class="line"><span class="lineno">  489</span>        <span class="keywordflow">if</span>( std::fabs (CovarianceDiff-&gt;GetBinContent(j, i)) &lt; 1.e-5 &amp;&amp; std::fabs (CovariancePreviousHist-&gt;GetBinContent(j, i)) &lt; 1.e-5)</div>
<div class="line"><span class="lineno">  490</span>        {</div>
<div class="line"><span class="lineno">  491</span>          CovarianceDiff-&gt;SetBinContent(j, i, <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>);</div>
<div class="line"><span class="lineno">  492</span>          CovariancePreviousHist-&gt;SetBinContent(j, i, <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>);</div>
<div class="line"><span class="lineno">  493</span>        }</div>
<div class="line"><span class="lineno">  494</span>        <span class="keywordflow">if</span>( std::fabs (CorrelationDiff-&gt;GetBinContent(j, i)) &lt; 1.e-5 &amp;&amp; std::fabs (CorrelationPreviousHist-&gt;GetBinContent(j, i)) &lt; 1.e-5)</div>
<div class="line"><span class="lineno">  495</span>        {</div>
<div class="line"><span class="lineno">  496</span>          CorrelationDiff-&gt;SetBinContent(j, i, <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>);</div>
<div class="line"><span class="lineno">  497</span>          CorrelationPreviousHist-&gt;SetBinContent(j, i, <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>);</div>
<div class="line"><span class="lineno">  498</span>        }</div>
<div class="line"><span class="lineno">  499</span>      }</div>
<div class="line"><span class="lineno">  500</span>    }</div>
<div class="line"><span class="lineno">  501</span>    <span class="comment">//Divide matrices</span></div>
<div class="line"><span class="lineno">  502</span>    CovarianceDiff-&gt;Divide(CovariancePreviousHist);</div>
<div class="line"><span class="lineno">  503</span>    CorrelationDiff-&gt;Divide(CorrelationPreviousHist);</div>
<div class="line"><span class="lineno">  504</span>    </div>
<div class="line"><span class="lineno">  505</span>    <span class="comment">//Now it is time for fancy names etc.</span></div>
<div class="line"><span class="lineno">  506</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; CovarianceDiff-&gt;GetXaxis()-&gt;GetNbins(); ++j)</div>
<div class="line"><span class="lineno">  507</span>    {</div>
<div class="line"><span class="lineno">  508</span>      TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  509</span>      <span class="keywordtype">double</span> Prior = 1.0;</div>
<div class="line"><span class="lineno">  510</span>      <span class="keywordtype">double</span> PriorError = 1.0;</div>
<div class="line"><span class="lineno">  511</span>  </div>
<div class="line"><span class="lineno">  512</span>      Processor-&gt;GetNthParameter(j, Prior, PriorError, Title);</div>
<div class="line"><span class="lineno">  513</span>      </div>
<div class="line"><span class="lineno">  514</span>      CovarianceDiff-&gt;GetXaxis()-&gt;SetBinLabel(j+1, Title);</div>
<div class="line"><span class="lineno">  515</span>      CovarianceDiff-&gt;GetYaxis()-&gt;SetBinLabel(j+1, Title);</div>
<div class="line"><span class="lineno">  516</span>      CorrelationDiff-&gt;GetXaxis()-&gt;SetBinLabel(j+1, Title);</div>
<div class="line"><span class="lineno">  517</span>      CorrelationDiff-&gt;GetYaxis()-&gt;SetBinLabel(j+1, Title);</div>
<div class="line"><span class="lineno">  518</span>    }</div>
<div class="line"><span class="lineno">  519</span>    CovarianceDiff-&gt;GetXaxis()-&gt;SetLabelSize(0.015f);</div>
<div class="line"><span class="lineno">  520</span>    CovarianceDiff-&gt;GetYaxis()-&gt;SetLabelSize(0.015f);</div>
<div class="line"><span class="lineno">  521</span>    CorrelationDiff-&gt;GetXaxis()-&gt;SetLabelSize(0.015f);</div>
<div class="line"><span class="lineno">  522</span>    CorrelationDiff-&gt;GetYaxis()-&gt;SetLabelSize(0.015f);</div>
<div class="line"><span class="lineno">  523</span>    </div>
<div class="line"><span class="lineno">  524</span>    std::stringstream ss;</div>
<div class="line"><span class="lineno">  525</span>    ss &lt;&lt; <span class="stringliteral">&quot;BCut_&quot;</span>;</div>
<div class="line"><span class="lineno">  526</span>    ss &lt;&lt; BurnIn;</div>
<div class="line"><span class="lineno">  527</span>    ss &lt;&lt; <span class="stringliteral">&quot;/&quot;</span>;</div>
<div class="line"><span class="lineno">  528</span>    ss &lt;&lt; <span class="stringliteral">&quot;BCut_&quot;</span>;</div>
<div class="line"><span class="lineno">  529</span>    ss &lt;&lt; (k-1)*IntervalsSize;</div>
<div class="line"><span class="lineno">  530</span>    std::string str = ss.str();</div>
<div class="line"><span class="lineno">  531</span>    </div>
<div class="line"><span class="lineno">  532</span>    TString Title = <span class="stringliteral">&quot;Cov &quot;</span> + str;</div>
<div class="line"><span class="lineno">  533</span>    CovarianceDiff-&gt;GetZaxis()-&gt;SetTitle( Title );</div>
<div class="line"><span class="lineno">  534</span>    Title = <span class="stringliteral">&quot;Corr &quot;</span> + str;</div>
<div class="line"><span class="lineno">  535</span>    CorrelationDiff-&gt;GetZaxis()-&gt;SetTitle(Title);</div>
<div class="line"><span class="lineno">  536</span>    </div>
<div class="line"><span class="lineno">  537</span>    CovarianceDiff-&gt;SetMinimum(-2);</div>
<div class="line"><span class="lineno">  538</span>    CovarianceDiff-&gt;SetMaximum(2);</div>
<div class="line"><span class="lineno">  539</span>    CorrelationDiff-&gt;SetMinimum(-2);</div>
<div class="line"><span class="lineno">  540</span>    CorrelationDiff-&gt;SetMaximum(2);</div>
<div class="line"><span class="lineno">  541</span> </div>
<div class="line"><span class="lineno">  542</span>    Canvas-&gt;cd();</div>
<div class="line"><span class="lineno">  543</span>    CovarianceDiff-&gt;Draw(<span class="stringliteral">&quot;colz&quot;</span>);</div>
<div class="line"><span class="lineno">  544</span>    Canvas-&gt;Print(Form(<span class="stringliteral">&quot;Covariance_%s.pdf&quot;</span>, OutName.c_str()), <span class="stringliteral">&quot;pdf&quot;</span>);</div>
<div class="line"><span class="lineno">  545</span> </div>
<div class="line"><span class="lineno">  546</span>    CorrelationDiff-&gt;Draw(<span class="stringliteral">&quot;colz&quot;</span>);</div>
<div class="line"><span class="lineno">  547</span>    Canvas-&gt;Print(Form(<span class="stringliteral">&quot;Correlation_%s.pdf&quot;</span>, OutName.c_str()), <span class="stringliteral">&quot;pdf&quot;</span>);</div>
<div class="line"><span class="lineno">  548</span>        </div>
<div class="line"><span class="lineno">  549</span>    <span class="comment">//KS: Current hist become previous as we need it for further comparison</span></div>
<div class="line"><span class="lineno">  550</span>    <span class="keyword">delete</span> CovariancePreviousHist;</div>
<div class="line"><span class="lineno">  551</span>    CovariancePreviousHist = <span class="keyword">static_cast&lt;</span>TH2D*<span class="keyword">&gt;</span>(CovarianceHist-&gt;Clone());</div>
<div class="line"><span class="lineno">  552</span>    <span class="keyword">delete</span> CorrelationPreviousHist;</div>
<div class="line"><span class="lineno">  553</span>    CorrelationPreviousHist = <span class="keyword">static_cast&lt;</span>TH2D*<span class="keyword">&gt;</span>(CorrelationHist-&gt;Clone());</div>
<div class="line"><span class="lineno">  554</span>    </div>
<div class="line"><span class="lineno">  555</span>    <span class="keyword">delete</span> CovarianceHist;</div>
<div class="line"><span class="lineno">  556</span>    CovarianceHist = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  557</span>    <span class="keyword">delete</span> CorrelationHist;</div>
<div class="line"><span class="lineno">  558</span>    CorrelationHist = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  559</span>    </div>
<div class="line"><span class="lineno">  560</span>    <span class="keyword">delete</span> CovarianceDiff;</div>
<div class="line"><span class="lineno">  561</span>    <span class="keyword">delete</span> CorrelationDiff;</div>
<div class="line"><span class="lineno">  562</span>    <span class="keyword">delete</span> Covariance;</div>
<div class="line"><span class="lineno">  563</span>    Covariance = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  564</span>    <span class="keyword">delete</span> Correlation;</div>
<div class="line"><span class="lineno">  565</span>    Correlation = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  566</span>  }</div>
<div class="line"><span class="lineno">  567</span>  Canvas-&gt;cd();</div>
<div class="line"><span class="lineno">  568</span>  Canvas-&gt;Print(Form(<span class="stringliteral">&quot;Covariance_%s.pdf]&quot;</span>, OutName.c_str()), <span class="stringliteral">&quot;pdf&quot;</span>);</div>
<div class="line"><span class="lineno">  569</span>  Canvas-&gt;Print(Form(<span class="stringliteral">&quot;Correlation_%s.pdf]&quot;</span>, OutName.c_str()), <span class="stringliteral">&quot;pdf&quot;</span>);</div>
<div class="line"><span class="lineno">  570</span>  </div>
<div class="line"><span class="lineno">  571</span>  Processor-&gt;SetPrintToPDF(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  572</span>  <span class="keywordflow">if</span>(Covariance != <span class="keyword">nullptr</span>)              <span class="keyword">delete</span> Covariance;</div>
<div class="line"><span class="lineno">  573</span>  <span class="keywordflow">if</span>(Correlation != <span class="keyword">nullptr</span>)             <span class="keyword">delete</span> Correlation;</div>
<div class="line"><span class="lineno">  574</span>  <span class="keywordflow">if</span>(CovariancePreviousHist != <span class="keyword">nullptr</span>)  <span class="keyword">delete</span> CovariancePreviousHist;</div>
<div class="line"><span class="lineno">  575</span>  <span class="keywordflow">if</span>(CorrelationPreviousHist != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> CorrelationPreviousHist;</div>
<div class="line"><span class="lineno">  576</span>  <span class="keywordflow">if</span>(CovarianceHist != <span class="keyword">nullptr</span>)          <span class="keyword">delete</span> CovarianceHist;</div>
<div class="line"><span class="lineno">  577</span>  <span class="keywordflow">if</span>(CorrelationHist != <span class="keyword">nullptr</span>)         <span class="keyword">delete</span> CorrelationHist;</div>
<div class="line"><span class="lineno">  578</span>}</div>
<div class="ttc" id="aMCMCProcessor_8h_html_a82a6d79039474bc403b627437a7b97ec"><div class="ttname"><a href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a></div><div class="ttdeci">#define _UNDEF_</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00004">MCMCProcessor.h:4</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_a95fa4dffc648e4c5536c9292c2bdcac3"><div class="ttname"><a href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a></div><div class="ttdeci">#define MACH3LOG_INFO</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00019">MaCh3Logger.h:19</a></div></div>
<div class="ttc" id="aProcessMCMC_8cpp_html_a2052da75bc58457dc290c8cbd06efe30"><div class="ttname"><a href="ProcessMCMC_8cpp.html#a2052da75bc58457dc290c8cbd06efe30">TMatrixIntoTH2D</a></div><div class="ttdeci">TH2D * TMatrixIntoTH2D(TMatrixDSym *Matrix, const std::string &amp;title)</div><div class="ttdoc">KS: Convert TMatrix to TH2D, mostly useful for making fancy plots.</div><div class="ttdef"><b>Definition:</b> <a href="ProcessMCMC_8cpp_source.html#l00594">ProcessMCMC.cpp:594</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a36519c64a11fdb905e91fd3db08e0f80" name="a36519c64a11fdb905e91fd3db08e0f80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36519c64a11fdb905e91fd3db08e0f80">&#9670;&#160;</a></span>GetTrianglePlot()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void GetTrianglePlot </td>
          <td>(</td>
          <td class="paramtype">const std::unique_ptr&lt; <a class="el" href="classMCMCProcessor.html">MCMCProcessor</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>Processor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ProcessMCMC_8cpp_source.html#l00385">385</a> of file <a class="el" href="ProcessMCMC_8cpp_source.html">ProcessMCMC.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  385</span>                                                                    {</div>
<div class="line"><span class="lineno">  386</span>  YAML::Node card_yaml = YAML::LoadFile(<a class="code hl_variable" href="ProcessMCMC_8cpp.html#a13056efd080ab16304b6f7be0ebf0a61">config</a>.c_str());</div>
<div class="line"><span class="lineno">  387</span>  YAML::Node Settings = card_yaml[<span class="stringliteral">&quot;ProcessMCMC&quot;</span>];</div>
<div class="line"><span class="lineno">  388</span> </div>
<div class="line"><span class="lineno">  389</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; dg : Settings[<span class="stringliteral">&quot;TrianglePlot&quot;</span>])</div>
<div class="line"><span class="lineno">  390</span>  {</div>
<div class="line"><span class="lineno">  391</span>    std::string ParName = dg[0].as&lt;std::string&gt;();</div>
<div class="line"><span class="lineno">  392</span> </div>
<div class="line"><span class="lineno">  393</span>    std::vector&lt;std::string&gt; NameVec = dg[1].as&lt;std::vector&lt;std::string&gt;&gt;();</div>
<div class="line"><span class="lineno">  394</span>    Processor-&gt;MakeTrianglePlot(NameVec,</div>
<div class="line"><span class="lineno">  395</span>                                <a class="code hl_function" href="YamlHelper_8h.html#a1247d9088f9521c2758d1d7c21dcfa87">GetFromManager</a>&lt;std::vector&lt;double&gt;&gt;(Settings[<span class="stringliteral">&quot;CredibleIntervals&quot;</span>], {0.99, 0.90, 0.68}),</div>
<div class="line"><span class="lineno">  396</span>                                <a class="code hl_function" href="YamlHelper_8h.html#a1247d9088f9521c2758d1d7c21dcfa87">GetFromManager</a>&lt;std::vector&lt;short int&gt;&gt;(Settings[<span class="stringliteral">&quot;CredibleIntervalsColours&quot;</span>], {436, 430, 422}),</div>
<div class="line"><span class="lineno">  397</span>                                <a class="code hl_function" href="YamlHelper_8h.html#a1247d9088f9521c2758d1d7c21dcfa87">GetFromManager</a>&lt;std::vector&lt;double&gt;&gt;(Settings[<span class="stringliteral">&quot;CredibleRegions&quot;</span>], {0.99, 0.90, 0.68}),</div>
<div class="line"><span class="lineno">  398</span>                                <a class="code hl_function" href="YamlHelper_8h.html#a1247d9088f9521c2758d1d7c21dcfa87">GetFromManager</a>&lt;std::vector&lt;short int&gt;&gt;(Settings[<span class="stringliteral">&quot;CredibleRegionStyle&quot;</span>], {2, 1, 3}),</div>
<div class="line"><span class="lineno">  399</span>                                <a class="code hl_function" href="YamlHelper_8h.html#a1247d9088f9521c2758d1d7c21dcfa87">GetFromManager</a>&lt;std::vector&lt;short int&gt;&gt;(Settings[<span class="stringliteral">&quot;CredibleRegionColor&quot;</span>], {413, 406, 416}),</div>
<div class="line"><span class="lineno">  400</span>                                GetFromManager&lt;bool&gt;(Settings[<span class="stringliteral">&quot;CredibleInSigmas&quot;</span>], <span class="keyword">false</span>));</div>
<div class="line"><span class="lineno">  401</span>  }</div>
<div class="line"><span class="lineno">  402</span>}</div>
<div class="ttc" id="aYamlHelper_8h_html_a1247d9088f9521c2758d1d7c21dcfa87"><div class="ttname"><a href="YamlHelper_8h.html#a1247d9088f9521c2758d1d7c21dcfa87">GetFromManager</a></div><div class="ttdeci">Type GetFromManager(const YAML::Node &amp;node, Type defval, const std::string File=&quot;&quot;, const int Line=1)</div><div class="ttdoc">Get content of config file if node is not found take default value specified.</div><div class="ttdef"><b>Definition:</b> <a href="YamlHelper_8h_source.html#l00286">YamlHelper.h:286</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af7dc6e50355636d9c3d51a627e5dfbb3" name="af7dc6e50355636d9c3d51a627e5dfbb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7dc6e50355636d9c3d51a627e5dfbb3">&#9670;&#160;</a></span>KolmogorovSmirnovTest()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void KolmogorovSmirnovTest </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::unique_ptr&lt; <a class="el" href="classMCMCProcessor.html">MCMCProcessor</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>Processor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::unique_ptr&lt; TCanvas &gt; &amp;&#160;</td>
          <td class="paramname"><em>Posterior</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TString &amp;&#160;</td>
          <td class="paramname"><em>canvasname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: Perform KS test to check if two posteriors for the same parameter came from the same distribution. </p>

<p class="definition">Definition at line <a class="el" href="ProcessMCMC_8cpp_source.html#l00609">609</a> of file <a class="el" href="ProcessMCMC_8cpp_source.html">ProcessMCMC.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  612</span>{</div>
<div class="line"><span class="lineno">  613</span>  <span class="keyword">const</span> Color_t CumulativeColor[] = {kBlue-1, kRed, kGreen+2};</div>
<div class="line"><span class="lineno">  614</span>  <span class="keyword">const</span> Style_t CumulativeStyle[] = {kSolid, kDashed, kDotted};</div>
<div class="line"><span class="lineno">  615</span> </div>
<div class="line"><span class="lineno">  616</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; Processor[0]-&gt;GetNParams(); ++i) </div>
<div class="line"><span class="lineno">  617</span>  {</div>
<div class="line"><span class="lineno">  618</span>    <span class="comment">// This holds the posterior density</span></div>
<div class="line"><span class="lineno">  619</span>    std::vector&lt;TH1D*&gt; hpost(<a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>);</div>
<div class="line"><span class="lineno">  620</span>    std::vector&lt;TH1D*&gt; CumulativeDistribution(<a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>);</div>
<div class="line"><span class="lineno">  621</span>       </div>
<div class="line"><span class="lineno">  622</span>    TString Title;</div>
<div class="line"><span class="lineno">  623</span>    <span class="keywordtype">double</span> Prior = 1.0;</div>
<div class="line"><span class="lineno">  624</span>    <span class="keywordtype">double</span> PriorError = 1.0;</div>
<div class="line"><span class="lineno">  625</span> </div>
<div class="line"><span class="lineno">  626</span>    Processor[0]-&gt;GetNthParameter(i, Prior, PriorError, Title);</div>
<div class="line"><span class="lineno">  627</span>    <span class="keywordtype">bool</span> Skip = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  628</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ik = 0 ; ik &lt; <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>;  ik++)</div>
<div class="line"><span class="lineno">  629</span>    {</div>
<div class="line"><span class="lineno">  630</span>      <span class="keywordtype">int</span> Index = 0;</div>
<div class="line"><span class="lineno">  631</span>      <span class="keywordflow">if</span>(ik == 0 ) Index = i;</div>
<div class="line"><span class="lineno">  632</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  633</span>      {</div>
<div class="line"><span class="lineno">  634</span>        <span class="comment">// KS: If somehow this chain doesn&#39;t given params we skip it</span></div>
<div class="line"><span class="lineno">  635</span>        Index = Processor[ik]-&gt;GetParamIndexFromName(hpost[0]-&gt;GetTitle());</div>
<div class="line"><span class="lineno">  636</span>        <span class="keywordflow">if</span>(Index == <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>)</div>
<div class="line"><span class="lineno">  637</span>        {</div>
<div class="line"><span class="lineno">  638</span>          Skip = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  639</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  640</span>        }</div>
<div class="line"><span class="lineno">  641</span>      }</div>
<div class="line"><span class="lineno">  642</span>      hpost[ik] = <span class="keyword">static_cast&lt;</span>TH1D*<span class="keyword">&gt;</span>(Processor[ik]-&gt;GetHpost(Index)-&gt;Clone());</div>
<div class="line"><span class="lineno">  643</span>      CumulativeDistribution[ik] = <span class="keyword">static_cast&lt;</span>TH1D*<span class="keyword">&gt;</span>(Processor[ik]-&gt;GetHpost(Index)-&gt;Clone());</div>
<div class="line"><span class="lineno">  644</span>      CumulativeDistribution[ik]-&gt;Fill(0., 0.);</div>
<div class="line"><span class="lineno">  645</span>      CumulativeDistribution[ik]-&gt;Reset();</div>
<div class="line"><span class="lineno">  646</span>      CumulativeDistribution[ik]-&gt;SetMaximum(1.);</div>
<div class="line"><span class="lineno">  647</span>      TString TempTittle = Title+<span class="stringliteral">&quot; Kolmogorov Smirnov&quot;</span>;</div>
<div class="line"><span class="lineno">  648</span>      CumulativeDistribution[ik]-&gt;SetTitle(TempTittle);</div>
<div class="line"><span class="lineno">  649</span>      </div>
<div class="line"><span class="lineno">  650</span>      TempTittle = Title+<span class="stringliteral">&quot; Value&quot;</span>;</div>
<div class="line"><span class="lineno">  651</span>      CumulativeDistribution[ik]-&gt;GetXaxis()-&gt;SetTitle(TempTittle);</div>
<div class="line"><span class="lineno">  652</span>      CumulativeDistribution[ik]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Cumulative Probability&quot;</span>);</div>
<div class="line"><span class="lineno">  653</span>      </div>
<div class="line"><span class="lineno">  654</span>      CumulativeDistribution[ik]-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno">  655</span>      CumulativeDistribution[ik]-&gt;SetLineColor(CumulativeColor[ik]);</div>
<div class="line"><span class="lineno">  656</span>      CumulativeDistribution[ik]-&gt;SetLineStyle(CumulativeStyle[ik]);</div>
<div class="line"><span class="lineno">  657</span>    }</div>
<div class="line"><span class="lineno">  658</span> </div>
<div class="line"><span class="lineno">  659</span>    <span class="comment">// Don&#39;t plot if this is a fixed histogram (i.e. the peak is the whole integral)</span></div>
<div class="line"><span class="lineno">  660</span>    <span class="keywordflow">if</span>(hpost[0]-&gt;GetMaximum() == hpost[0]-&gt;Integral()*1.5 || Skip)</div>
<div class="line"><span class="lineno">  661</span>    {</div>
<div class="line"><span class="lineno">  662</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ik = 0; ik &lt; <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>;  ik++)</div>
<div class="line"><span class="lineno">  663</span>      {</div>
<div class="line"><span class="lineno">  664</span>        <span class="keyword">delete</span> hpost[ik];</div>
<div class="line"><span class="lineno">  665</span>        <span class="keyword">delete</span> CumulativeDistribution[ik];</div>
<div class="line"><span class="lineno">  666</span>      }</div>
<div class="line"><span class="lineno">  667</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  668</span>    }</div>
<div class="line"><span class="lineno">  669</span>    </div>
<div class="line"><span class="lineno">  670</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ik = 0 ; ik &lt; <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>;  ik++)</div>
<div class="line"><span class="lineno">  671</span>    {</div>
<div class="line"><span class="lineno">  672</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> NumberOfBins = hpost[ik]-&gt;GetXaxis()-&gt;GetNbins();</div>
<div class="line"><span class="lineno">  673</span>      <span class="keywordtype">double</span> Cumulative = 0;</div>
<div class="line"><span class="lineno">  674</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> Integral = hpost[ik]-&gt;Integral();</div>
<div class="line"><span class="lineno">  675</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; NumberOfBins+1; ++j)</div>
<div class="line"><span class="lineno">  676</span>      {</div>
<div class="line"><span class="lineno">  677</span>        Cumulative += hpost[ik]-&gt;GetBinContent(j)/Integral;</div>
<div class="line"><span class="lineno">  678</span>        CumulativeDistribution[ik]-&gt;SetBinContent(j, Cumulative);</div>
<div class="line"><span class="lineno">  679</span>      }</div>
<div class="line"><span class="lineno">  680</span>      <span class="comment">//KS: Set overflow to 1 just in case</span></div>
<div class="line"><span class="lineno">  681</span>      CumulativeDistribution[ik]-&gt;SetBinContent(NumberOfBins+1, 1.);</div>
<div class="line"><span class="lineno">  682</span>    }</div>
<div class="line"><span class="lineno">  683</span>    </div>
<div class="line"><span class="lineno">  684</span>    std::vector&lt;int&gt; TestStatBin(<a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>, 0);</div>
<div class="line"><span class="lineno">  685</span>    std::vector&lt;double&gt; TestStatD(<a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>, -999);</div>
<div class="line"><span class="lineno">  686</span>    std::vector&lt;std::unique_ptr&lt;TLine&gt;&gt; LineD(<a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>);</div>
<div class="line"><span class="lineno">  687</span>    <span class="comment">//Find KS statistic</span></div>
<div class="line"><span class="lineno">  688</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ik = 1 ; ik &lt; <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>;  ik++)</div>
<div class="line"><span class="lineno">  689</span>    {</div>
<div class="line"><span class="lineno">  690</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> NumberOfBins = CumulativeDistribution[0]-&gt;GetXaxis()-&gt;GetNbins();</div>
<div class="line"><span class="lineno">  691</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; NumberOfBins+1; ++j)</div>
<div class="line"><span class="lineno">  692</span>      {</div>
<div class="line"><span class="lineno">  693</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> BinValue = CumulativeDistribution[0]-&gt;GetBinCenter(j);</div>
<div class="line"><span class="lineno">  694</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> BinNumber = CumulativeDistribution[ik]-&gt;FindBin(BinValue);</div>
<div class="line"><span class="lineno">  695</span>        <span class="comment">//KS: Calculate D statistic for this bin, only save it if it&#39;s bigger than previously found value</span></div>
<div class="line"><span class="lineno">  696</span>        <span class="keywordtype">double</span> TempDstat = std::fabs(CumulativeDistribution[0]-&gt;GetBinContent(j) - CumulativeDistribution[ik]-&gt;GetBinContent(BinNumber));</div>
<div class="line"><span class="lineno">  697</span>        <span class="keywordflow">if</span>(TempDstat &gt; TestStatD[ik])</div>
<div class="line"><span class="lineno">  698</span>        {</div>
<div class="line"><span class="lineno">  699</span>          TestStatD[ik] = TempDstat;</div>
<div class="line"><span class="lineno">  700</span>          TestStatBin[ik] = j;</div>
<div class="line"><span class="lineno">  701</span>        }</div>
<div class="line"><span class="lineno">  702</span>      }</div>
<div class="line"><span class="lineno">  703</span>    }</div>
<div class="line"><span class="lineno">  704</span> </div>
<div class="line"><span class="lineno">  705</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ik = 0 ; ik &lt; <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>;  ik++)</div>
<div class="line"><span class="lineno">  706</span>    {</div>
<div class="line"><span class="lineno">  707</span>      LineD[ik] = std::make_unique&lt;TLine&gt;(CumulativeDistribution[0]-&gt;GetBinCenter(TestStatBin[ik]), 0, CumulativeDistribution[0]-&gt;GetBinCenter(TestStatBin[ik]), CumulativeDistribution[0]-&gt;GetBinContent(TestStatBin[ik]));</div>
<div class="line"><span class="lineno">  708</span>      LineD[ik]-&gt;SetLineColor(CumulativeColor[ik]);</div>
<div class="line"><span class="lineno">  709</span>      LineD[ik]-&gt;SetLineWidth(2.0);</div>
<div class="line"><span class="lineno">  710</span>    }</div>
<div class="line"><span class="lineno">  711</span>    CumulativeDistribution[0]-&gt;Draw();</div>
<div class="line"><span class="lineno">  712</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ik = 0 ; ik &lt; <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>;  ik++)</div>
<div class="line"><span class="lineno">  713</span>      CumulativeDistribution[ik]-&gt;Draw(<span class="stringliteral">&quot;SAME&quot;</span>);</div>
<div class="line"><span class="lineno">  714</span>    </div>
<div class="line"><span class="lineno">  715</span>    <span class="keyword">auto</span> leg = std::make_unique&lt;TLegend&gt;(0.15, 0.7, 0.5, 0.90);</div>
<div class="line"><span class="lineno">  716</span>    leg-&gt;SetTextSize(0.04f);</div>
<div class="line"><span class="lineno">  717</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ik = 0; ik &lt; <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>;  ik++)</div>
<div class="line"><span class="lineno">  718</span>      leg-&gt;AddEntry(CumulativeDistribution[ik], <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a2bff863f66d44b865ce21762802730c8">TitleNames</a>[ik].c_str(), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno">  719</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ik = 1; ik &lt; <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>;  ik++)</div>
<div class="line"><span class="lineno">  720</span>      leg-&gt;AddEntry(LineD[ik].get(), Form(<span class="stringliteral">&quot;#Delta D = %.4f&quot;</span>, TestStatD[ik]), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno">  721</span>    </div>
<div class="line"><span class="lineno">  722</span>    leg-&gt;SetLineColor(0);</div>
<div class="line"><span class="lineno">  723</span>    leg-&gt;SetLineStyle(0);</div>
<div class="line"><span class="lineno">  724</span>    leg-&gt;SetFillColor(0);</div>
<div class="line"><span class="lineno">  725</span>    leg-&gt;SetFillStyle(0);</div>
<div class="line"><span class="lineno">  726</span>    leg-&gt;Draw(<span class="stringliteral">&quot;SAME&quot;</span>);</div>
<div class="line"><span class="lineno">  727</span> </div>
<div class="line"><span class="lineno">  728</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ik = 1; ik &lt; <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>;  ik++)</div>
<div class="line"><span class="lineno">  729</span>      LineD[ik]-&gt;Draw(<span class="stringliteral">&quot;sam&quot;</span>);</div>
<div class="line"><span class="lineno">  730</span>      </div>
<div class="line"><span class="lineno">  731</span>    Posterior-&gt;cd();</div>
<div class="line"><span class="lineno">  732</span>    Posterior-&gt;Print(canvasname);</div>
<div class="line"><span class="lineno">  733</span>    </div>
<div class="line"><span class="lineno">  734</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ik = 0; ik &lt; <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>;  ik++)</div>
<div class="line"><span class="lineno">  735</span>    {</div>
<div class="line"><span class="lineno">  736</span>      <span class="keyword">delete</span> hpost[ik];</div>
<div class="line"><span class="lineno">  737</span>      <span class="keyword">delete</span> CumulativeDistribution[ik];</div>
<div class="line"><span class="lineno">  738</span>    }</div>
<div class="line"><span class="lineno">  739</span>  } <span class="comment">//End loop over parameter</span></div>
<div class="line"><span class="lineno">  740</span>}</div>
<div class="ttc" id="aProcessMCMC_8cpp_html_a2bff863f66d44b865ce21762802730c8"><div class="ttname"><a href="ProcessMCMC_8cpp.html#a2bff863f66d44b865ce21762802730c8">TitleNames</a></div><div class="ttdeci">std::vector&lt; std::string &gt; TitleNames</div><div class="ttdef"><b>Definition:</b> <a href="ProcessMCMC_8cpp_source.html#l00028">ProcessMCMC.cpp:28</a></div></div>
<div class="ttc" id="aProcessMCMC_8cpp_html_a6b25bcddaae9b868109dc98a54476e46"><div class="ttname"><a href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a></div><div class="ttdeci">int nFiles</div><div class="ttdef"><b>Definition:</b> <a href="ProcessMCMC_8cpp_source.html#l00026">ProcessMCMC.cpp:26</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0ddf1224851353fc92bfbff6f499fa97" name="a0ddf1224851353fc92bfbff6f499fa97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ddf1224851353fc92bfbff6f499fa97">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ProcessMCMC_8cpp_source.html#l00031">31</a> of file <a class="el" href="ProcessMCMC_8cpp_source.html">ProcessMCMC.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   32</span>{</div>
<div class="line"><span class="lineno">   33</span>  <a class="code hl_function" href="MaCh3Logger_8h.html#aa603c55ea73cd86d1994901227883e1e">SetMaCh3LoggerFormat</a>();</div>
<div class="line"><span class="lineno">   34</span>  <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a> = 0;</div>
<div class="line"><span class="lineno">   35</span>  <span class="keywordflow">if</span> (argc != 3 &amp;&amp; argc !=6 &amp;&amp; argc != 8)</div>
<div class="line"><span class="lineno">   36</span>  {</div>
<div class="line"><span class="lineno">   37</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;How to use: {} &lt;Config&gt; &lt;MCMM_ND_Output.root&gt;&quot;</span>, argv[0]);</div>
<div class="line"><span class="lineno">   38</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">   39</span>  }</div>
<div class="line"><span class="lineno">   40</span> </div>
<div class="line"><span class="lineno">   41</span>  <span class="keywordflow">if</span> (argc == 3)</div>
<div class="line"><span class="lineno">   42</span>  {</div>
<div class="line"><span class="lineno">   43</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Producing single fit output&quot;</span>);</div>
<div class="line"><span class="lineno">   44</span>    <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a13056efd080ab16304b6f7be0ebf0a61">config</a> = argv[1];</div>
<div class="line"><span class="lineno">   45</span>    std::string filename = argv[2];</div>
<div class="line"><span class="lineno">   46</span>    <a class="code hl_function" href="ProcessMCMC_8cpp.html#a52c48199a4bcad577b88768020a91041">ProcessMCMC</a>(filename);</div>
<div class="line"><span class="lineno">   47</span>  }</div>
<div class="line"><span class="lineno">   48</span>  <span class="comment">// If we want to compare two or more fits (e.g. binning changes or introducing new params/priors)</span></div>
<div class="line"><span class="lineno">   49</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (argc == 6 || argc == 8)</div>
<div class="line"><span class="lineno">   50</span>  {</div>
<div class="line"><span class="lineno">   51</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Producing two fit comparison&quot;</span>);</div>
<div class="line"><span class="lineno">   52</span>    <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a13056efd080ab16304b6f7be0ebf0a61">config</a> = argv[1];</div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span>    <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a8e90c1478f4be185364988cac765a163">FileNames</a>.push_back(argv[2]);</div>
<div class="line"><span class="lineno">   55</span>    <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a2bff863f66d44b865ce21762802730c8">TitleNames</a>.push_back(argv[3]);</div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span>    <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a8e90c1478f4be185364988cac765a163">FileNames</a>.push_back(argv[4]);</div>
<div class="line"><span class="lineno">   58</span>    <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a2bff863f66d44b865ce21762802730c8">TitleNames</a>.push_back(argv[5]);</div>
<div class="line"><span class="lineno">   59</span>    <span class="comment">//KS: If there is third file add it</span></div>
<div class="line"><span class="lineno">   60</span>    <span class="keywordflow">if</span>(argc == 8)</div>
<div class="line"><span class="lineno">   61</span>    {</div>
<div class="line"><span class="lineno">   62</span>      <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a8e90c1478f4be185364988cac765a163">FileNames</a>.push_back(argv[6]);</div>
<div class="line"><span class="lineno">   63</span>      <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a2bff863f66d44b865ce21762802730c8">TitleNames</a>.push_back(argv[7]);</div>
<div class="line"><span class="lineno">   64</span>    }</div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span>    <a class="code hl_function" href="ProcessMCMC_8cpp.html#a83be70750a728e4deae518ea3ffaf388">MultipleProcessMCMC</a>();</div>
<div class="line"><span class="lineno">   67</span>  }</div>
<div class="line"><span class="lineno">   68</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   69</span>}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a61052119a625282d0ec6d4a97adf3ee2"><div class="ttname"><a href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a></div><div class="ttdeci">#define MACH3LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00021">MaCh3Logger.h:21</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_aa603c55ea73cd86d1994901227883e1e"><div class="ttname"><a href="MaCh3Logger_8h.html#aa603c55ea73cd86d1994901227883e1e">SetMaCh3LoggerFormat</a></div><div class="ttdeci">void SetMaCh3LoggerFormat()</div><div class="ttdoc">Set messaging format of the logger.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00026">MaCh3Logger.h:26</a></div></div>
<div class="ttc" id="aProcessMCMC_8cpp_html_a52c48199a4bcad577b88768020a91041"><div class="ttname"><a href="ProcessMCMC_8cpp.html#a52c48199a4bcad577b88768020a91041">ProcessMCMC</a></div><div class="ttdeci">void ProcessMCMC(const std::string &amp;inputFile)</div><div class="ttdoc">Main function processing MCMC and Producing plots.</div><div class="ttdef"><b>Definition:</b> <a href="ProcessMCMC_8cpp_source.html#l00071">ProcessMCMC.cpp:71</a></div></div>
<div class="ttc" id="aProcessMCMC_8cpp_html_a83be70750a728e4deae518ea3ffaf388"><div class="ttname"><a href="ProcessMCMC_8cpp.html#a83be70750a728e4deae518ea3ffaf388">MultipleProcessMCMC</a></div><div class="ttdeci">void MultipleProcessMCMC()</div><div class="ttdoc">Function producing comparison of posterior and more betwen a few MCMC chains.</div><div class="ttdef"><b>Definition:</b> <a href="ProcessMCMC_8cpp_source.html#l00153">ProcessMCMC.cpp:153</a></div></div>
<div class="ttc" id="aProcessMCMC_8cpp_html_a8e90c1478f4be185364988cac765a163"><div class="ttname"><a href="ProcessMCMC_8cpp.html#a8e90c1478f4be185364988cac765a163">FileNames</a></div><div class="ttdeci">std::vector&lt; std::string &gt; FileNames</div><div class="ttdef"><b>Definition:</b> <a href="ProcessMCMC_8cpp_source.html#l00027">ProcessMCMC.cpp:27</a></div></div>
<div class="ttc" id="aclassMaCh3Exception_html"><div class="ttname"><a href="classMaCh3Exception.html">MaCh3Exception</a></div><div class="ttdoc">Custom exception class for MaCh3 errors.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Exception_8h_source.html#l00012">MaCh3Exception.h:12</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a83be70750a728e4deae518ea3ffaf388" name="a83be70750a728e4deae518ea3ffaf388"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83be70750a728e4deae518ea3ffaf388">&#9670;&#160;</a></span>MultipleProcessMCMC()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MultipleProcessMCMC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function producing comparison of posterior and more betwen a few MCMC chains. </p>

<p class="definition">Definition at line <a class="el" href="ProcessMCMC_8cpp_source.html#l00153">153</a> of file <a class="el" href="ProcessMCMC_8cpp_source.html">ProcessMCMC.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  154</span>{</div>
<div class="line"><span class="lineno">  155</span>  YAML::Node card_yaml = YAML::LoadFile(<a class="code hl_variable" href="ProcessMCMC_8cpp.html#a13056efd080ab16304b6f7be0ebf0a61">config</a>.c_str());</div>
<div class="line"><span class="lineno">  156</span>  YAML::Node Settings = card_yaml[<span class="stringliteral">&quot;ProcessMCMC&quot;</span>];</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>  <span class="keyword">constexpr</span> Color_t PosteriorColor[] = {kBlue-1, kRed, kGreen+2};</div>
<div class="line"><span class="lineno">  159</span>  <span class="comment">//constexpr Style_t PosteriorStyle[] = {kSolid, kDashed, kDotted};</span></div>
<div class="line"><span class="lineno">  160</span>  <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a> = int(<a class="code hl_variable" href="ProcessMCMC_8cpp.html#a8e90c1478f4be185364988cac765a163">FileNames</a>.size());</div>
<div class="line"><span class="lineno">  161</span>  std::vector&lt;std::unique_ptr&lt;MCMCProcessor&gt;&gt; Processor(<a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>);</div>
<div class="line"><span class="lineno">  162</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ik = 0; ik &lt; <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>;  ik++)</div>
<div class="line"><span class="lineno">  163</span>  {</div>
<div class="line"><span class="lineno">  164</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;File for study: {}&quot;</span>, <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a8e90c1478f4be185364988cac765a163">FileNames</a>[ik]);</div>
<div class="line"><span class="lineno">  165</span>    <span class="comment">// Make the processor</span></div>
<div class="line"><span class="lineno">  166</span>    Processor[ik] = std::make_unique&lt;MCMCProcessor&gt;(<a class="code hl_variable" href="ProcessMCMC_8cpp.html#a8e90c1478f4be185364988cac765a163">FileNames</a>[ik]);</div>
<div class="line"><span class="lineno">  167</span>    Processor[ik]-&gt;SetOutputSuffix((<span class="stringliteral">&quot;_&quot;</span> + std::to_string(ik)).c_str());</div>
<div class="line"><span class="lineno">  168</span> </div>
<div class="line"><span class="lineno">  169</span>    Processor[ik]-&gt;SetExcludedTypes(<a class="code hl_function" href="YamlHelper_8h.html#a1247d9088f9521c2758d1d7c21dcfa87">GetFromManager</a>&lt;std::vector&lt;std::string&gt;&gt;(Settings[<span class="stringliteral">&quot;ExcludedTypes&quot;</span>], {}));</div>
<div class="line"><span class="lineno">  170</span>    Processor[ik]-&gt;SetExcludedNames(<a class="code hl_function" href="YamlHelper_8h.html#a1247d9088f9521c2758d1d7c21dcfa87">GetFromManager</a>&lt;std::vector&lt;std::string&gt;&gt;(Settings[<span class="stringliteral">&quot;ExcludedNames&quot;</span>], {}));</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>    <span class="comment">//Apply additional cuts to 1D posterior</span></div>
<div class="line"><span class="lineno">  173</span>    Processor[ik]-&gt;SetPosterior1DCut(GetFromManager&lt;std::string&gt;(Settings[<span class="stringliteral">&quot;Posterior1DCut&quot;</span>], <span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>    Processor[ik]-&gt;SetPlotRelativeToPrior(GetFromManager&lt;bool&gt;(Settings[<span class="stringliteral">&quot;PlotRelativeToPrior&quot;</span>], <span class="keyword">false</span>));</div>
<div class="line"><span class="lineno">  176</span>    Processor[ik]-&gt;SetFancyNames(GetFromManager&lt;bool&gt;(Settings[<span class="stringliteral">&quot;FancyNames&quot;</span>], <span class="keyword">true</span>));</div>
<div class="line"><span class="lineno">  177</span>    Processor[ik]-&gt;Initialise();</div>
<div class="line"><span class="lineno">  178</span>  }</div>
<div class="line"><span class="lineno">  179</span>  <span class="comment">//KS: Multithreading here is very tempting but there are some issues with root that need to be resovled :(</span></div>
<div class="line"><span class="lineno">  180</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ik = 0; ik &lt; <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>;  ik++)</div>
<div class="line"><span class="lineno">  181</span>  {</div>
<div class="line"><span class="lineno">  182</span>    <span class="comment">// Make the postfit</span></div>
<div class="line"><span class="lineno">  183</span>    Processor[ik]-&gt;MakePostfit();</div>
<div class="line"><span class="lineno">  184</span>    Processor[ik]-&gt;DrawPostfit();</div>
<div class="line"><span class="lineno">  185</span>  }</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>  <span class="comment">// Open a TCanvas to write the posterior onto</span></div>
<div class="line"><span class="lineno">  188</span>  <span class="keyword">auto</span> Posterior = std::make_unique&lt;TCanvas&gt;(<span class="stringliteral">&quot;PosteriorMulti&quot;</span>, <span class="stringliteral">&quot;PosteriorMulti&quot;</span>, 0, 0, 1024, 1024);</div>
<div class="line"><span class="lineno">  189</span>  gStyle-&gt;SetOptStat(0);</div>
<div class="line"><span class="lineno">  190</span>  gStyle-&gt;SetOptTitle(0);</div>
<div class="line"><span class="lineno">  191</span>  Posterior-&gt;SetGrid();</div>
<div class="line"><span class="lineno">  192</span>  Posterior-&gt;SetBottomMargin(0.1f);</div>
<div class="line"><span class="lineno">  193</span>  Posterior-&gt;SetTopMargin(0.05f);</div>
<div class="line"><span class="lineno">  194</span>  Posterior-&gt;SetRightMargin(0.03f);</div>
<div class="line"><span class="lineno">  195</span>  Posterior-&gt;SetLeftMargin(0.10f);</div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span>  <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a8e90c1478f4be185364988cac765a163">FileNames</a>[0] = <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a8e90c1478f4be185364988cac765a163">FileNames</a>[0].substr(0, <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a8e90c1478f4be185364988cac765a163">FileNames</a>[0].find(<span class="stringliteral">&quot;.root&quot;</span>)-1);</div>
<div class="line"><span class="lineno">  198</span>  TString canvasname = <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a8e90c1478f4be185364988cac765a163">FileNames</a>[0];</div>
<div class="line"><span class="lineno">  199</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ik = 1; ik &lt; <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>;  ik++)</div>
<div class="line"><span class="lineno">  200</span>  {</div>
<div class="line"><span class="lineno">  201</span>    <span class="keywordflow">while</span> (<a class="code hl_variable" href="ProcessMCMC_8cpp.html#a8e90c1478f4be185364988cac765a163">FileNames</a>[ik].find(<span class="stringliteral">&quot;/&quot;</span>) != std::string::npos)</div>
<div class="line"><span class="lineno">  202</span>    {</div>
<div class="line"><span class="lineno">  203</span>      <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a8e90c1478f4be185364988cac765a163">FileNames</a>[ik] = <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a8e90c1478f4be185364988cac765a163">FileNames</a>[ik].substr(<a class="code hl_variable" href="ProcessMCMC_8cpp.html#a8e90c1478f4be185364988cac765a163">FileNames</a>[ik].find(<span class="stringliteral">&quot;/&quot;</span>)+1, <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a8e90c1478f4be185364988cac765a163">FileNames</a>[ik].find(<span class="stringliteral">&quot;.root&quot;</span>)-1);</div>
<div class="line"><span class="lineno">  204</span>    }</div>
<div class="line"><span class="lineno">  205</span>    canvasname = canvasname + <span class="stringliteral">&quot;_&quot;</span>+<a class="code hl_variable" href="ProcessMCMC_8cpp.html#a8e90c1478f4be185364988cac765a163">FileNames</a>[ik];</div>
<div class="line"><span class="lineno">  206</span>  }</div>
<div class="line"><span class="lineno">  207</span> </div>
<div class="line"><span class="lineno">  208</span>  canvasname = canvasname +<span class="stringliteral">&quot;.pdf[&quot;</span>;</div>
<div class="line"><span class="lineno">  209</span> </div>
<div class="line"><span class="lineno">  210</span>  Posterior-&gt;Print(canvasname);</div>
<div class="line"><span class="lineno">  211</span>  <span class="comment">// Once the pdf file is open no longer need to bracket</span></div>
<div class="line"><span class="lineno">  212</span>  canvasname.ReplaceAll(<span class="stringliteral">&quot;[&quot;</span>,<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; Processor[0]-&gt;GetNParams(); ++i) </div>
<div class="line"><span class="lineno">  215</span>  {</div>
<div class="line"><span class="lineno">  216</span>    <span class="comment">// This holds the posterior density</span></div>
<div class="line"><span class="lineno">  217</span>    std::vector&lt;TH1D*&gt; hpost(<a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>);</div>
<div class="line"><span class="lineno">  218</span>    std::vector&lt;std::unique_ptr&lt;TLine&gt;&gt; hpd(<a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>);</div>
<div class="line"><span class="lineno">  219</span>    hpost[0] = <span class="keyword">static_cast&lt;</span>TH1D *<span class="keyword">&gt;</span>(Processor[0]-&gt;GetHpost(i)-&gt;Clone());</div>
<div class="line"><span class="lineno">  220</span> </div>
<div class="line"><span class="lineno">  221</span>    <span class="keywordtype">bool</span> Skip = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  222</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ik = 1 ; ik &lt; <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>;  ik++)</div>
<div class="line"><span class="lineno">  223</span>    {</div>
<div class="line"><span class="lineno">  224</span>      <span class="comment">// KS: If somehow this chain doesn&#39;t given params we skip it</span></div>
<div class="line"><span class="lineno">  225</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> Index = Processor[ik]-&gt;GetParamIndexFromName(hpost[0]-&gt;GetTitle());</div>
<div class="line"><span class="lineno">  226</span>      <span class="keywordflow">if</span>(Index == <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>)</div>
<div class="line"><span class="lineno">  227</span>      {</div>
<div class="line"><span class="lineno">  228</span>        Skip = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  229</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  230</span>      }</div>
<div class="line"><span class="lineno">  231</span>      hpost[ik] = <span class="keyword">static_cast&lt;</span>TH1D *<span class="keyword">&gt;</span>(Processor[ik]-&gt;GetHpost(Index)-&gt;Clone());</div>
<div class="line"><span class="lineno">  232</span>    }</div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>    <span class="comment">// Don&#39;t plot if this is a fixed histogram (i.e. the peak is the whole integral)</span></div>
<div class="line"><span class="lineno">  235</span>    <span class="keywordflow">if</span>(hpost[0]-&gt;GetMaximum() == hpost[0]-&gt;Integral()*1.5 || Skip)</div>
<div class="line"><span class="lineno">  236</span>    {</div>
<div class="line"><span class="lineno">  237</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ik = 0; ik &lt; <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>;  ik++)</div>
<div class="line"><span class="lineno">  238</span>        <span class="keyword">delete</span> hpost[ik];</div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  241</span>    }</div>
<div class="line"><span class="lineno">  242</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ik = 0; ik &lt; <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>;  ik++)</div>
<div class="line"><span class="lineno">  243</span>    {</div>
<div class="line"><span class="lineno">  244</span>      <a class="code hl_function" href="HistogramUtils_8cpp.html#a85463c0c6943e3d544d5fcb3f96bf18a">RemoveFitter</a>(hpost[ik], <span class="stringliteral">&quot;Gauss&quot;</span>);</div>
<div class="line"><span class="lineno">  245</span> </div>
<div class="line"><span class="lineno">  246</span>      <span class="comment">// Set some nice colours</span></div>
<div class="line"><span class="lineno">  247</span>      hpost[ik]-&gt;SetLineColor(PosteriorColor[ik]);</div>
<div class="line"><span class="lineno">  248</span>      <span class="comment">//hpost[ik]-&gt;SetLineStyle(PosteriorStyle[ik]);</span></div>
<div class="line"><span class="lineno">  249</span>      hpost[ik]-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span>      <span class="comment">// Area normalise the distributions</span></div>
<div class="line"><span class="lineno">  252</span>      hpost[ik]-&gt;Scale(1./hpost[ik]-&gt;Integral(), <span class="stringliteral">&quot;width&quot;</span>);</div>
<div class="line"><span class="lineno">  253</span>    }</div>
<div class="line"><span class="lineno">  254</span>    TString Title;</div>
<div class="line"><span class="lineno">  255</span>    <span class="keywordtype">double</span> Prior = 1.0;</div>
<div class="line"><span class="lineno">  256</span>    <span class="keywordtype">double</span> PriorError = 1.0;</div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span>    Processor[0]-&gt;GetNthParameter(i, Prior, PriorError, Title);</div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>    <span class="comment">// Now make the TLine for the Asimov</span></div>
<div class="line"><span class="lineno">  261</span>    <span class="keyword">auto</span> Asimov = std::make_unique&lt;TLine&gt;(Prior, hpost[0]-&gt;GetMinimum(), Prior, hpost[0]-&gt;GetMaximum());</div>
<div class="line"><span class="lineno">  262</span>    Asimov-&gt;SetLineColor(kRed-3);</div>
<div class="line"><span class="lineno">  263</span>    Asimov-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno">  264</span>    Asimov-&gt;SetLineStyle(kDashed);</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span>    <span class="comment">// Make a nice little TLegend</span></div>
<div class="line"><span class="lineno">  267</span>    <span class="keyword">auto</span> leg = std::make_unique&lt;TLegend&gt;(0.12, 0.7, 0.6, 0.97);</div>
<div class="line"><span class="lineno">  268</span>    leg-&gt;SetTextSize(0.03f);</div>
<div class="line"><span class="lineno">  269</span>    leg-&gt;SetFillColor(0);</div>
<div class="line"><span class="lineno">  270</span>    leg-&gt;SetFillStyle(0);</div>
<div class="line"><span class="lineno">  271</span>    leg-&gt;SetLineColor(0);</div>
<div class="line"><span class="lineno">  272</span>    leg-&gt;SetLineStyle(0);</div>
<div class="line"><span class="lineno">  273</span>    TString asimovLeg = Form(<span class="stringliteral">&quot;#splitline{Prior}{x = %.2f , #sigma = %.2f}&quot;</span>, Prior, PriorError);</div>
<div class="line"><span class="lineno">  274</span>    leg-&gt;AddEntry(Asimov.get(), asimovLeg, <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno">  275</span> </div>
<div class="line"><span class="lineno">  276</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ik = 0; ik &lt; <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>;  ik++)</div>
<div class="line"><span class="lineno">  277</span>    {</div>
<div class="line"><span class="lineno">  278</span>      TString rebinLeg = Form(<span class="stringliteral">&quot;#splitline{%s}{#mu = %.2f, #sigma = %.2f}&quot;</span>, <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a2bff863f66d44b865ce21762802730c8">TitleNames</a>[ik].c_str(), hpost[ik]-&gt;GetMean(), hpost[ik]-&gt;GetRMS());</div>
<div class="line"><span class="lineno">  279</span>      leg-&gt;AddEntry(hpost[ik],  rebinLeg, <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>      hpd[ik] = std::make_unique&lt;TLine&gt;(hpost[ik]-&gt;GetBinCenter(hpost[ik]-&gt;GetMaximumBin()), hpost[ik]-&gt;GetMinimum(),</div>
<div class="line"><span class="lineno">  282</span>                                        hpost[ik]-&gt;GetBinCenter(hpost[ik]-&gt;GetMaximumBin()), hpost[ik]-&gt;GetMaximum());</div>
<div class="line"><span class="lineno">  283</span>      hpd[ik]-&gt;SetLineColor(hpost[ik]-&gt;GetLineColor());</div>
<div class="line"><span class="lineno">  284</span>      hpd[ik]-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno">  285</span>      hpd[ik]-&gt;SetLineStyle(kSolid);</div>
<div class="line"><span class="lineno">  286</span>    }</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>    <span class="comment">// Find the maximum value to nicely resize hist</span></div>
<div class="line"><span class="lineno">  289</span>    <span class="keywordtype">double</span> maximum = 0;</div>
<div class="line"><span class="lineno">  290</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ik = 0; ik &lt; <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>;  ik++) maximum = std::max(maximum, hpost[ik]-&gt;GetMaximum());</div>
<div class="line"><span class="lineno">  291</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ik = 0; ik &lt; <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>;  ik++) hpost[ik]-&gt;SetMaximum(1.3*maximum);</div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span>    hpost[0]-&gt;Draw(<span class="stringliteral">&quot;hist&quot;</span>);</div>
<div class="line"><span class="lineno">  294</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ik = 1; ik &lt; <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>;  ik++) hpost[ik]-&gt;Draw(<span class="stringliteral">&quot;hist same&quot;</span>);</div>
<div class="line"><span class="lineno">  295</span>    Asimov-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><span class="lineno">  296</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ik = 0; ik &lt; <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>;  ik++) hpd[ik]-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><span class="lineno">  297</span>    leg-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><span class="lineno">  298</span>    Posterior-&gt;cd();</div>
<div class="line"><span class="lineno">  299</span>    Posterior-&gt;Print(canvasname);</div>
<div class="line"><span class="lineno">  300</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ik = 0; ik &lt; <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a6b25bcddaae9b868109dc98a54476e46">nFiles</a>;  ik++) {</div>
<div class="line"><span class="lineno">  301</span>      <span class="keyword">delete</span> hpost[ik];</div>
<div class="line"><span class="lineno">  302</span>    }</div>
<div class="line"><span class="lineno">  303</span>  }<span class="comment">//End loop over parameters</span></div>
<div class="line"><span class="lineno">  304</span>    </div>
<div class="line"><span class="lineno">  305</span>  <span class="comment">// Finally draw the parameter plot onto the PDF</span></div>
<div class="line"><span class="lineno">  306</span>  <span class="comment">// Close the .pdf file with all the posteriors</span></div>
<div class="line"><span class="lineno">  307</span>  Posterior-&gt;cd();</div>
<div class="line"><span class="lineno">  308</span>  Posterior-&gt;Clear();</div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span>  <span class="keywordflow">if</span>(GetFromManager&lt;bool&gt;(Settings[<span class="stringliteral">&quot;PerformKStest&quot;</span>], <span class="keyword">true</span>)) <a class="code hl_function" href="ProcessMCMC_8cpp.html#af7dc6e50355636d9c3d51a627e5dfbb3">KolmogorovSmirnovTest</a>(Processor, Posterior, canvasname);</div>
<div class="line"><span class="lineno">  311</span>  </div>
<div class="line"><span class="lineno">  312</span>  <span class="comment">// Close the pdf file</span></div>
<div class="line"><span class="lineno">  313</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Closing pdf {}&quot;</span>, canvasname);</div>
<div class="line"><span class="lineno">  314</span>  canvasname+=<span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><span class="lineno">  315</span>  Posterior-&gt;Print(canvasname);</div>
<div class="line"><span class="lineno">  316</span>}</div>
<div class="ttc" id="aHistogramUtils_8cpp_html_a85463c0c6943e3d544d5fcb3f96bf18a"><div class="ttname"><a href="HistogramUtils_8cpp.html#a85463c0c6943e3d544d5fcb3f96bf18a">RemoveFitter</a></div><div class="ttdeci">void RemoveFitter(TH1D *hist, const std::string &amp;name)</div><div class="ttdoc">KS: Remove fitted TF1 from hist to make comparison easier.</div><div class="ttdef"><b>Definition:</b> <a href="HistogramUtils_8cpp_source.html#l00362">HistogramUtils.cpp:362</a></div></div>
<div class="ttc" id="aProcessMCMC_8cpp_html_af7dc6e50355636d9c3d51a627e5dfbb3"><div class="ttname"><a href="ProcessMCMC_8cpp.html#af7dc6e50355636d9c3d51a627e5dfbb3">KolmogorovSmirnovTest</a></div><div class="ttdeci">void KolmogorovSmirnovTest(const std::vector&lt; std::unique_ptr&lt; MCMCProcessor &gt; &gt; &amp;Processor, const std::unique_ptr&lt; TCanvas &gt; &amp;Posterior, const TString &amp;canvasname)</div><div class="ttdoc">KS: Perform KS test to check if two posteriors for the same parameter came from the same distribution...</div><div class="ttdef"><b>Definition:</b> <a href="ProcessMCMC_8cpp_source.html#l00609">ProcessMCMC.cpp:609</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a52c48199a4bcad577b88768020a91041" name="a52c48199a4bcad577b88768020a91041"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52c48199a4bcad577b88768020a91041">&#9670;&#160;</a></span>ProcessMCMC()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ProcessMCMC </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>inputFile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Main function processing MCMC and Producing plots. </p>

<p class="definition">Definition at line <a class="el" href="ProcessMCMC_8cpp_source.html#l00071">71</a> of file <a class="el" href="ProcessMCMC_8cpp_source.html">ProcessMCMC.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   72</span>{</div>
<div class="line"><span class="lineno">   73</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;File for study: {} with config  {}&quot;</span>, inputFile, <a class="code hl_variable" href="ProcessMCMC_8cpp.html#a13056efd080ab16304b6f7be0ebf0a61">config</a>);</div>
<div class="line"><span class="lineno">   74</span>  <span class="comment">// Make the processor)</span></div>
<div class="line"><span class="lineno">   75</span>  <span class="keyword">auto</span> Processor = std::make_unique&lt;MCMCProcessor&gt;(inputFile);</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span>  YAML::Node card_yaml = YAML::LoadFile(<a class="code hl_variable" href="ProcessMCMC_8cpp.html#a13056efd080ab16304b6f7be0ebf0a61">config</a>.c_str());</div>
<div class="line"><span class="lineno">   78</span>  YAML::Node Settings = card_yaml[<span class="stringliteral">&quot;ProcessMCMC&quot;</span>];</div>
<div class="line"><span class="lineno">   79</span> </div>
<div class="line"><span class="lineno">   80</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> PlotCorr = GetFromManager&lt;bool&gt;(Settings[<span class="stringliteral">&quot;PlotCorr&quot;</span>], <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>  Processor-&gt;SetExcludedTypes(<a class="code hl_function" href="YamlHelper_8h.html#a1247d9088f9521c2758d1d7c21dcfa87">GetFromManager</a>&lt;std::vector&lt;std::string&gt;&gt;(Settings[<span class="stringliteral">&quot;ExcludedTypes&quot;</span>], {}));</div>
<div class="line"><span class="lineno">   83</span>  Processor-&gt;SetExcludedNames(<a class="code hl_function" href="YamlHelper_8h.html#a1247d9088f9521c2758d1d7c21dcfa87">GetFromManager</a>&lt;std::vector&lt;std::string&gt;&gt;(Settings[<span class="stringliteral">&quot;ExcludedNames&quot;</span>], {}));</div>
<div class="line"><span class="lineno">   84</span>  <span class="comment">//Apply additional cuts to 1D posterior</span></div>
<div class="line"><span class="lineno">   85</span>  Processor-&gt;SetPosterior1DCut(GetFromManager&lt;std::string&gt;(Settings[<span class="stringliteral">&quot;Posterior1DCut&quot;</span>], <span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>  <span class="keywordflow">if</span>(PlotCorr) Processor-&gt;SetOutputSuffix(<span class="stringliteral">&quot;_drawCorr&quot;</span>);</div>
<div class="line"><span class="lineno">   88</span>  <span class="comment">//KS:Turn off plotting detector and some other setting, should be via some config</span></div>
<div class="line"><span class="lineno">   89</span>  Processor-&gt;SetPlotRelativeToPrior(GetFromManager&lt;bool&gt;(Settings[<span class="stringliteral">&quot;PlotRelativeToPrior&quot;</span>], <span class="keyword">false</span>));</div>
<div class="line"><span class="lineno">   90</span>  Processor-&gt;SetPrintToPDF(GetFromManager&lt;bool&gt;(Settings[<span class="stringliteral">&quot;PrintToPDF&quot;</span>], <span class="keyword">true</span>));</div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span>  <span class="comment">//KS: Whether you want prior error bands for parameters with flat prior or not</span></div>
<div class="line"><span class="lineno">   93</span>  Processor-&gt;SetPlotErrorForFlatPrior(GetFromManager&lt;bool&gt;(Settings[<span class="stringliteral">&quot;PlotErrorForFlatPrior&quot;</span>], <span class="keyword">true</span>));</div>
<div class="line"><span class="lineno">   94</span>  Processor-&gt;SetFancyNames(GetFromManager&lt;bool&gt;(Settings[<span class="stringliteral">&quot;FancyNames&quot;</span>], <span class="keyword">true</span>));</div>
<div class="line"><span class="lineno">   95</span>  Processor-&gt;SetPlotBinValue(GetFromManager&lt;bool&gt;(Settings[<span class="stringliteral">&quot;PlotBinValue&quot;</span>], <span class="keyword">false</span>));</div>
<div class="line"><span class="lineno">   96</span>  <span class="comment">//KS: Plot only 2D posteriors with correlations greater than 0.2</span></div>
<div class="line"><span class="lineno">   97</span>  Processor-&gt;SetPost2DPlotThreshold(GetFromManager&lt;double&gt;(Settings[<span class="stringliteral">&quot;Post2DPlotThreshold&quot;</span>], 0.2));</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>  Processor-&gt;Initialise();</div>
<div class="line"><span class="lineno">  100</span>  <span class="keywordflow">if</span>(Settings[<span class="stringliteral">&quot;Thinning&quot;</span>])</div>
<div class="line"><span class="lineno">  101</span>  {</div>
<div class="line"><span class="lineno">  102</span>    <span class="keywordflow">if</span>(Settings[<span class="stringliteral">&quot;Thinning&quot;</span>][0].as&lt;bool&gt;()){</div>
<div class="line"><span class="lineno">  103</span>      Processor-&gt;ThinMCMC(Settings[<span class="stringliteral">&quot;Thinning&quot;</span>][1].as&lt;int&gt;());</div>
<div class="line"><span class="lineno">  104</span>    }</div>
<div class="line"><span class="lineno">  105</span>  }</div>
<div class="line"><span class="lineno">  106</span>  <span class="comment">// Make the postfit</span></div>
<div class="line"><span class="lineno">  107</span>  Processor-&gt;MakePostfit();</div>
<div class="line"><span class="lineno">  108</span>  Processor-&gt;DrawPostfit();</div>
<div class="line"><span class="lineno">  109</span>  <span class="comment">//KS: Should set via config whether you want below or not</span></div>
<div class="line"><span class="lineno">  110</span>  <span class="keywordflow">if</span>(GetFromManager&lt;bool&gt;(Settings[<span class="stringliteral">&quot;MakeCredibleIntervals&quot;</span>], <span class="keyword">true</span>)) {</div>
<div class="line"><span class="lineno">  111</span>    Processor-&gt;MakeCredibleIntervals(<a class="code hl_function" href="YamlHelper_8h.html#a1247d9088f9521c2758d1d7c21dcfa87">GetFromManager</a>&lt;std::vector&lt;double&gt;&gt;(Settings[<span class="stringliteral">&quot;CredibleIntervals&quot;</span>], {0.99, 0.90, 0.68}),</div>
<div class="line"><span class="lineno">  112</span>                                     <a class="code hl_function" href="YamlHelper_8h.html#a1247d9088f9521c2758d1d7c21dcfa87">GetFromManager</a>&lt;std::vector&lt;short int&gt;&gt;(Settings[<span class="stringliteral">&quot;CredibleIntervalsColours&quot;</span>], {436, 430, 422}),</div>
<div class="line"><span class="lineno">  113</span>                                     GetFromManager&lt;bool&gt;(Settings[<span class="stringliteral">&quot;CredibleInSigmas&quot;</span>], <span class="keyword">false</span>));</div>
<div class="line"><span class="lineno">  114</span>  }</div>
<div class="line"><span class="lineno">  115</span>  <span class="keywordflow">if</span>(GetFromManager&lt;bool&gt;(Settings[<span class="stringliteral">&quot;CalcBayesFactor&quot;</span>], <span class="keyword">true</span>))  <a class="code hl_function" href="ProcessMCMC_8cpp.html#a245ba87c995dcf10ed6cf0dac6cfc1db">CalcBayesFactor</a>(Processor);</div>
<div class="line"><span class="lineno">  116</span>  <span class="keywordflow">if</span>(GetFromManager&lt;bool&gt;(Settings[<span class="stringliteral">&quot;CalcSavageDickey&quot;</span>], <span class="keyword">true</span>)) <a class="code hl_function" href="ProcessMCMC_8cpp.html#a87fd44b861c503ca5e439678c6686dd4">CalcSavageDickey</a>(Processor);</div>
<div class="line"><span class="lineno">  117</span>  <span class="keywordflow">if</span>(GetFromManager&lt;bool&gt;(Settings[<span class="stringliteral">&quot;CalcBipolarPlot&quot;</span>], <span class="keyword">false</span>)) <a class="code hl_function" href="ProcessMCMC_8cpp.html#a25ccf00b1b90332a01ed03d9b61dbd1a">CalcBipolarPlot</a>(Processor);</div>
<div class="line"><span class="lineno">  118</span>  <span class="keywordflow">if</span>(GetFromManager&lt;bool&gt;(Settings[<span class="stringliteral">&quot;CalcParameterEvolution&quot;</span>], <span class="keyword">false</span>)) <a class="code hl_function" href="ProcessMCMC_8cpp.html#af636045ccba99a8080c1ddd19466fcf8">CalcParameterEvolution</a>(Processor);</div>
<div class="line"><span class="lineno">  119</span> </div>
<div class="line"><span class="lineno">  120</span>  <span class="keywordflow">if</span>(PlotCorr)</div>
<div class="line"><span class="lineno">  121</span>  {</div>
<div class="line"><span class="lineno">  122</span>    Processor-&gt;SetSmoothing(GetFromManager&lt;bool&gt;(Settings[<span class="stringliteral">&quot;Smoothing&quot;</span>], <span class="keyword">true</span>));</div>
<div class="line"><span class="lineno">  123</span>    <span class="comment">// Make the covariance matrix</span></div>
<div class="line"><span class="lineno">  124</span>    <span class="comment">//We have different treatment for multithread</span></div>
<div class="line"><span class="lineno">  125</span><span class="comment">//#ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  126</span>    Processor-&gt;CacheSteps();</div>
<div class="line"><span class="lineno">  127</span>    <span class="comment">//KS: Since we cached let&#39;s make fancy violins :)</span></div>
<div class="line"><span class="lineno">  128</span>    <span class="keywordflow">if</span>(GetFromManager&lt;bool&gt;(Settings[<span class="stringliteral">&quot;MakeViolin&quot;</span>], <span class="keyword">true</span>)) Processor-&gt;MakeViolin();</div>
<div class="line"><span class="lineno">  129</span>    Processor-&gt;MakeCovariance_MP();</div>
<div class="line"><span class="lineno">  130</span><span class="comment">//#else</span></div>
<div class="line"><span class="lineno">  131</span>    <span class="comment">//Processor-&gt;MakeCovariance();</span></div>
<div class="line"><span class="lineno">  132</span><span class="comment">//#endif</span></div>
<div class="line"><span class="lineno">  133</span>    Processor-&gt;DrawCovariance();</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span>    <span class="keyword">auto</span> <span class="keyword">const</span> &amp;MakeSubOptimality = Settings[<span class="stringliteral">&quot;MakeSubOptimality&quot;</span>];</div>
<div class="line"><span class="lineno">  136</span>    <span class="keywordflow">if</span>(MakeSubOptimality[0].as&lt;bool&gt;()) Processor-&gt;MakeSubOptimality(MakeSubOptimality[1].as&lt;int&gt;());</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>    <span class="keywordflow">if</span>(GetFromManager&lt;bool&gt;(Settings[<span class="stringliteral">&quot;MakeCredibleRegions&quot;</span>], <span class="keyword">false</span>)) {</div>
<div class="line"><span class="lineno">  139</span>      Processor-&gt;MakeCredibleRegions(<a class="code hl_function" href="YamlHelper_8h.html#a1247d9088f9521c2758d1d7c21dcfa87">GetFromManager</a>&lt;std::vector&lt;double&gt;&gt;(Settings[<span class="stringliteral">&quot;CredibleRegions&quot;</span>], {0.99, 0.90, 0.68}),</div>
<div class="line"><span class="lineno">  140</span>                                     <a class="code hl_function" href="YamlHelper_8h.html#a1247d9088f9521c2758d1d7c21dcfa87">GetFromManager</a>&lt;std::vector&lt;short int&gt;&gt;(Settings[<span class="stringliteral">&quot;CredibleRegionStyle&quot;</span>], {2, 1, 3}),</div>
<div class="line"><span class="lineno">  141</span>                                     <a class="code hl_function" href="YamlHelper_8h.html#a1247d9088f9521c2758d1d7c21dcfa87">GetFromManager</a>&lt;std::vector&lt;short int&gt;&gt;(Settings[<span class="stringliteral">&quot;CredibleRegionColor&quot;</span>], {413, 406, 416}),</div>
<div class="line"><span class="lineno">  142</span>                                     GetFromManager&lt;bool&gt;(Settings[<span class="stringliteral">&quot;CredibleInSigmas&quot;</span>], <span class="keyword">false</span>)</div>
<div class="line"><span class="lineno">  143</span>                                     );</div>
<div class="line"><span class="lineno">  144</span>    }</div>
<div class="line"><span class="lineno">  145</span>    <span class="keywordflow">if</span>(GetFromManager&lt;bool&gt;(Settings[<span class="stringliteral">&quot;GetTrianglePlot&quot;</span>], <span class="keyword">true</span>)) <a class="code hl_function" href="ProcessMCMC_8cpp.html#a36519c64a11fdb905e91fd3db08e0f80">GetTrianglePlot</a>(Processor);</div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span>    <span class="comment">//KS: When creating covariance matrix longest time is spend on caching every step, since we already cached we can run some fancy covariance stability diagnostic</span></div>
<div class="line"><span class="lineno">  148</span>    <span class="keywordflow">if</span>(GetFromManager&lt;bool&gt;(Settings[<span class="stringliteral">&quot;DiagnoseCovarianceMatrix&quot;</span>], <span class="keyword">false</span>)) <a class="code hl_function" href="ProcessMCMC_8cpp.html#a721fcdb3001f72ff5e40d6334d56e0d0">DiagnoseCovarianceMatrix</a>(Processor, inputFile);</div>
<div class="line"><span class="lineno">  149</span>  }</div>
<div class="line"><span class="lineno">  150</span>  <span class="keywordflow">if</span>(GetFromManager&lt;bool&gt;(Settings[<span class="stringliteral">&quot;ReweightPrior&quot;</span>], <span class="keyword">false</span>)) <a class="code hl_function" href="ProcessMCMC_8cpp.html#a65a553e49041cfa24ab0432d1307416a">ReweightPrior</a>(Processor);</div>
<div class="line"><span class="lineno">  151</span>}</div>
<div class="ttc" id="aProcessMCMC_8cpp_html_a245ba87c995dcf10ed6cf0dac6cfc1db"><div class="ttname"><a href="ProcessMCMC_8cpp.html#a245ba87c995dcf10ed6cf0dac6cfc1db">CalcBayesFactor</a></div><div class="ttdeci">void CalcBayesFactor(const std::unique_ptr&lt; MCMCProcessor &gt; &amp;Processor)</div><div class="ttdef"><b>Definition:</b> <a href="ProcessMCMC_8cpp_source.html#l00319">ProcessMCMC.cpp:319</a></div></div>
<div class="ttc" id="aProcessMCMC_8cpp_html_a25ccf00b1b90332a01ed03d9b61dbd1a"><div class="ttname"><a href="ProcessMCMC_8cpp.html#a25ccf00b1b90332a01ed03d9b61dbd1a">CalcBipolarPlot</a></div><div class="ttdeci">void CalcBipolarPlot(const std::unique_ptr&lt; MCMCProcessor &gt; &amp;Processor)</div><div class="ttdef"><b>Definition:</b> <a href="ProcessMCMC_8cpp_source.html#l00372">ProcessMCMC.cpp:372</a></div></div>
<div class="ttc" id="aProcessMCMC_8cpp_html_a36519c64a11fdb905e91fd3db08e0f80"><div class="ttname"><a href="ProcessMCMC_8cpp.html#a36519c64a11fdb905e91fd3db08e0f80">GetTrianglePlot</a></div><div class="ttdeci">void GetTrianglePlot(const std::unique_ptr&lt; MCMCProcessor &gt; &amp;Processor)</div><div class="ttdef"><b>Definition:</b> <a href="ProcessMCMC_8cpp_source.html#l00385">ProcessMCMC.cpp:385</a></div></div>
<div class="ttc" id="aProcessMCMC_8cpp_html_a65a553e49041cfa24ab0432d1307416a"><div class="ttname"><a href="ProcessMCMC_8cpp.html#a65a553e49041cfa24ab0432d1307416a">ReweightPrior</a></div><div class="ttdeci">void ReweightPrior(const std::unique_ptr&lt; MCMCProcessor &gt; &amp;Processor)</div><div class="ttdef"><b>Definition:</b> <a href="ProcessMCMC_8cpp_source.html#l00580">ProcessMCMC.cpp:580</a></div></div>
<div class="ttc" id="aProcessMCMC_8cpp_html_a721fcdb3001f72ff5e40d6334d56e0d0"><div class="ttname"><a href="ProcessMCMC_8cpp.html#a721fcdb3001f72ff5e40d6334d56e0d0">DiagnoseCovarianceMatrix</a></div><div class="ttdeci">void DiagnoseCovarianceMatrix(const std::unique_ptr&lt; MCMCProcessor &gt; &amp;Processor, const std::string &amp;inputFile)</div><div class="ttdoc">KS: You validate stability of posterior covariance matrix, you set burn calc cov matrix increase burn...</div><div class="ttdef"><b>Definition:</b> <a href="ProcessMCMC_8cpp_source.html#l00405">ProcessMCMC.cpp:405</a></div></div>
<div class="ttc" id="aProcessMCMC_8cpp_html_a87fd44b861c503ca5e439678c6686dd4"><div class="ttname"><a href="ProcessMCMC_8cpp.html#a87fd44b861c503ca5e439678c6686dd4">CalcSavageDickey</a></div><div class="ttdeci">void CalcSavageDickey(const std::unique_ptr&lt; MCMCProcessor &gt; &amp;Processor)</div><div class="ttdef"><b>Definition:</b> <a href="ProcessMCMC_8cpp_source.html#l00339">ProcessMCMC.cpp:339</a></div></div>
<div class="ttc" id="aProcessMCMC_8cpp_html_af636045ccba99a8080c1ddd19466fcf8"><div class="ttname"><a href="ProcessMCMC_8cpp.html#af636045ccba99a8080c1ddd19466fcf8">CalcParameterEvolution</a></div><div class="ttdeci">void CalcParameterEvolution(const std::unique_ptr&lt; MCMCProcessor &gt; &amp;Processor)</div><div class="ttdef"><b>Definition:</b> <a href="ProcessMCMC_8cpp_source.html#l00357">ProcessMCMC.cpp:357</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a65a553e49041cfa24ab0432d1307416a" name="a65a553e49041cfa24ab0432d1307416a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65a553e49041cfa24ab0432d1307416a">&#9670;&#160;</a></span>ReweightPrior()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ReweightPrior </td>
          <td>(</td>
          <td class="paramtype">const std::unique_ptr&lt; <a class="el" href="classMCMCProcessor.html">MCMCProcessor</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>Processor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ProcessMCMC_8cpp_source.html#l00580">580</a> of file <a class="el" href="ProcessMCMC_8cpp_source.html">ProcessMCMC.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  581</span>{</div>
<div class="line"><span class="lineno">  582</span>  YAML::Node card_yaml = YAML::LoadFile(<a class="code hl_variable" href="ProcessMCMC_8cpp.html#a13056efd080ab16304b6f7be0ebf0a61">config</a>.c_str());</div>
<div class="line"><span class="lineno">  583</span>  YAML::Node Settings = card_yaml[<span class="stringliteral">&quot;ProcessMCMC&quot;</span>];</div>
<div class="line"><span class="lineno">  584</span> </div>
<div class="line"><span class="lineno">  585</span>  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; Prior = Settings[<span class="stringliteral">&quot;PriorReweighting&quot;</span>];</div>
<div class="line"><span class="lineno">  586</span>  std::vector&lt;std::string&gt; Names = Prior[0].as&lt;std::vector&lt;std::string&gt;&gt;();</div>
<div class="line"><span class="lineno">  587</span>  std::vector&lt;double&gt; NewCentral = Prior[1].as&lt;std::vector&lt;double&gt;&gt;();</div>
<div class="line"><span class="lineno">  588</span>  std::vector&lt;double&gt; NewError = Prior[2].as&lt;std::vector&lt;double&gt;&gt;();</div>
<div class="line"><span class="lineno">  589</span> </div>
<div class="line"><span class="lineno">  590</span>  Processor-&gt;ReweightPrior(Names, NewCentral, NewError);</div>
<div class="line"><span class="lineno">  591</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2052da75bc58457dc290c8cbd06efe30" name="a2052da75bc58457dc290c8cbd06efe30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2052da75bc58457dc290c8cbd06efe30">&#9670;&#160;</a></span>TMatrixIntoTH2D()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH2D * TMatrixIntoTH2D </td>
          <td>(</td>
          <td class="paramtype">TMatrixDSym *&#160;</td>
          <td class="paramname"><em>Matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>title</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: Convert TMatrix to TH2D, mostly useful for making fancy plots. </p>

<p class="definition">Definition at line <a class="el" href="ProcessMCMC_8cpp_source.html#l00594">594</a> of file <a class="el" href="ProcessMCMC_8cpp_source.html">ProcessMCMC.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  595</span>{</div>
<div class="line"><span class="lineno">  596</span>  TH2D* hMatrix = <span class="keyword">new</span> TH2D(title.c_str(), title.c_str(), Matrix-&gt;GetNrows(), 0.0, Matrix-&gt;GetNrows(), Matrix-&gt;GetNcols(), 0.0, Matrix-&gt;GetNcols());</div>
<div class="line"><span class="lineno">  597</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; Matrix-&gt;GetNrows(); i++)</div>
<div class="line"><span class="lineno">  598</span>  {</div>
<div class="line"><span class="lineno">  599</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; Matrix-&gt;GetNcols(); j++)</div>
<div class="line"><span class="lineno">  600</span>    {</div>
<div class="line"><span class="lineno">  601</span>      <span class="comment">//KS: +1 because there is offset in histogram relative to TMatrix</span></div>
<div class="line"><span class="lineno">  602</span>      hMatrix-&gt;SetBinContent(i+1,j+1, (*Matrix)(i,j));</div>
<div class="line"><span class="lineno">  603</span>    }</div>
<div class="line"><span class="lineno">  604</span>  }</div>
<div class="line"><span class="lineno">  605</span>  <span class="keywordflow">return</span> hMatrix;</div>
<div class="line"><span class="lineno">  606</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a13056efd080ab16304b6f7be0ebf0a61" name="a13056efd080ab16304b6f7be0ebf0a61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13056efd080ab16304b6f7be0ebf0a61">&#9670;&#160;</a></span>config</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string config</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ProcessMCMC_8cpp_source.html#l00029">29</a> of file <a class="el" href="ProcessMCMC_8cpp_source.html">ProcessMCMC.cpp</a>.</p>

</div>
</div>
<a id="a8e90c1478f4be185364988cac765a163" name="a8e90c1478f4be185364988cac765a163"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e90c1478f4be185364988cac765a163">&#9670;&#160;</a></span>FileNames</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; FileNames</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ProcessMCMC_8cpp_source.html#l00027">27</a> of file <a class="el" href="ProcessMCMC_8cpp_source.html">ProcessMCMC.cpp</a>.</p>

</div>
</div>
<a id="a6b25bcddaae9b868109dc98a54476e46" name="a6b25bcddaae9b868109dc98a54476e46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b25bcddaae9b868109dc98a54476e46">&#9670;&#160;</a></span>nFiles</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int nFiles</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ProcessMCMC_8cpp_source.html#l00026">26</a> of file <a class="el" href="ProcessMCMC_8cpp_source.html">ProcessMCMC.cpp</a>.</p>

</div>
</div>
<a id="a2bff863f66d44b865ce21762802730c8" name="a2bff863f66d44b865ce21762802730c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bff863f66d44b865ce21762802730c8">&#9670;&#160;</a></span>TitleNames</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; TitleNames</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ProcessMCMC_8cpp_source.html#l00028">28</a> of file <a class="el" href="ProcessMCMC_8cpp_source.html">ProcessMCMC.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
