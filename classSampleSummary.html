<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MaCh3: SampleSummary Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="MaCh3.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="mach3logo_small.png"/></td>
  <td id="projectalign">
   <div id="projectname">MaCh3<span id="projectnumber">&#160;1.3.1</span>
   </div>
   <div id="projectbrief">Reference Guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classSampleSummary-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">SampleSummary Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Class to calculate pvalue produce posterior predictive and many fancy Bayesian stuff <a class="el" href="citelist.html#CITEREF_gelman1996posterior">[8]</a>.  
 <a href="classSampleSummary.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="SampleSummary_8h_source.html">mcmc/SampleSummary.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for SampleSummary:</div>
<div class="dyncontent">
<div class="center"><img src="classSampleSummary__coll__graph.png" border="0" usemap="#aSampleSummary_coll__map" alt="Collaboration graph"/></div>
<map name="aSampleSummary_coll__map" id="aSampleSummary_coll__map">
<area shape="rect" title="Class to calculate pvalue produce posterior predictive and many fancy Bayesian stuff ." alt="" coords="1961,577,2096,602"/>
<area shape="rect" title=" " alt="" coords="1489,22,1707,47"/>
<area shape="rect" title=" " alt="" coords="1161,109,1335,149"/>
<area shape="rect" title=" " alt="" coords="1511,150,1685,205"/>
<area shape="rect" title=" " alt="" coords="1515,323,1681,349"/>
<area shape="rect" title=" " alt="" coords="1155,550,1341,575"/>
<area shape="rect" href="classsamplePDFBase.html" title="Class responsible for handling implementation of samples used in analysis, reweighting and returning ..." alt="" coords="1534,498,1662,523"/>
<area shape="rect" title=" " alt="" coords="219,506,306,531"/>
<area shape="rect" href="classMaCh3Modes.html" title="KS: Class describing MaCh3 modes used in the analysis, it is being initialised from config." alt="" coords="1193,437,1303,462"/>
<area shape="rect" title=" " alt="" coords="649,497,812,537"/>
<area shape="rect" href="structMaCh3ModeInfo.html" title="KS: Class containing information for a single MaCh3Mode." alt="" coords="497,390,625,415"/>
<area shape="rect" title=" " alt="" coords="5,499,144,539"/>
<area shape="rect" title=" " alt="" coords="1483,661,1713,701"/>
<area shape="rect" title=" " alt="" coords="1514,726,1682,751"/>
<area shape="rect" title=" " alt="" coords="1505,909,1691,934"/>
<area shape="rect" title=" " alt="" coords="1514,1057,1682,1082"/>
<area shape="rect" title=" " alt="" coords="1505,1161,1691,1186"/>
<area shape="rect" title=" " alt="" coords="1505,1250,1691,1275"/>
<area shape="rect" title=" " alt="" coords="193,333,332,358"/>
<area shape="rect" title=" " alt="" coords="1498,1299,1698,1325"/>
<area shape="rect" title=" " alt="" coords="836,383,1019,423"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:afa739654e03cce78c48eb99bcd58c99a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#afa739654e03cce78c48eb99bcd58c99a">SampleSummary</a> (const int n_Samples, const std::string &amp;Filename, <a class="el" href="classsamplePDFBase.html">samplePDFBase</a> *const sample, const int nSteps)</td></tr>
<tr class="memdesc:afa739654e03cce78c48eb99bcd58c99a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <br /></td></tr>
<tr class="separator:afa739654e03cce78c48eb99bcd58c99a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ff4ad11cdada6c57e9e525decdfc6a6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a0ff4ad11cdada6c57e9e525decdfc6a6">~SampleSummary</a> ()</td></tr>
<tr class="memdesc:a0ff4ad11cdada6c57e9e525decdfc6a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <br /></td></tr>
<tr class="separator:a0ff4ad11cdada6c57e9e525decdfc6a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a681bee322172bef35a64e86c23c415b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a681bee322172bef35a64e86c23c415b6">AddData</a> (std::vector&lt; TH2Poly * &gt; &amp;<a class="el" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>)</td></tr>
<tr class="memdesc:a681bee322172bef35a64e86c23c415b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Add data histograms.  <br /></td></tr>
<tr class="separator:a681bee322172bef35a64e86c23c415b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c870b718bccf37fc7f91b5201345f8e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a8c870b718bccf37fc7f91b5201345f8e">AddNominal</a> (std::vector&lt; TH2Poly * &gt; &amp;<a class="el" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>, std::vector&lt; TH2Poly * &gt; &amp;W2Nom)</td></tr>
<tr class="memdesc:a8c870b718bccf37fc7f91b5201345f8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Add prior histograms.  <br /></td></tr>
<tr class="separator:a8c870b718bccf37fc7f91b5201345f8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10d0df830c319f3d8b76d2c3b85b4215"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a10d0df830c319f3d8b76d2c3b85b4215">AddThrow</a> (std::vector&lt; TH2Poly * &gt; &amp;MCHist, std::vector&lt; TH2Poly * &gt; &amp;W2Hist, const double LLHPenalty=0.0, const double Weight=1.0, const int DrawNumber=0)</td></tr>
<tr class="memdesc:a10d0df830c319f3d8b76d2c3b85b4215"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Add histograms with throws.  <br /></td></tr>
<tr class="separator:a10d0df830c319f3d8b76d2c3b85b4215"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00d7dbefac4ec95c256dfd2aa7e4e1a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a00d7dbefac4ec95c256dfd2aa7e4e1a3">AddThrowByMode</a> (std::vector&lt; std::vector&lt; TH2Poly * &gt; &gt; &amp;SampleVector_ByMode)</td></tr>
<tr class="memdesc:a00d7dbefac4ec95c256dfd2aa7e4e1a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Add histograms for each mode.  <br /></td></tr>
<tr class="separator:a00d7dbefac4ec95c256dfd2aa7e4e1a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacf987756d2024868bf28b9c2c4a5a99"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#aacf987756d2024868bf28b9c2c4a5a99">Write</a> ()</td></tr>
<tr class="memdesc:aacf987756d2024868bf28b9c2c4a5a99"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Write results into root file.  <br /></td></tr>
<tr class="separator:aacf987756d2024868bf28b9c2c4a5a99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec9b5e17c269714496bf717bd7d6ae81"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#aec9b5e17c269714496bf717bd7d6ae81">SetLikelihood</a> (const <a class="el" href="Structs_8h.html#a960da89e33ac45a56f7bbfac3068dc67">TestStatistic</a> TestStat)</td></tr>
<tr class="memdesc:aec9b5e17c269714496bf717bd7d6ae81"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Set likelihood type.  <br /></td></tr>
<tr class="separator:aec9b5e17c269714496bf717bd7d6ae81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab659605093e8fb68607a0fd5691e0535"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#ab659605093e8fb68607a0fd5691e0535">SetNModelParams</a> (const int nPars)</td></tr>
<tr class="memdesc:ab659605093e8fb68607a0fd5691e0535"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set number of model params used for BIC.  <br /></td></tr>
<tr class="separator:ab659605093e8fb68607a0fd5691e0535"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a44baf8959ced974c9a0b8ae640c336bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a44baf8959ced974c9a0b8ae640c336bd">MakePredictive</a> ()</td></tr>
<tr class="memdesc:a44baf8959ced974c9a0b8ae640c336bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finalise the distributions from the thrown samples.  <br /></td></tr>
<tr class="separator:a44baf8959ced974c9a0b8ae640c336bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b87a7ce0c38e968fb841f228aea7212"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a7b87a7ce0c38e968fb841f228aea7212">PrepareOutput</a> ()</td></tr>
<tr class="memdesc:a7b87a7ce0c38e968fb841f228aea7212"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Prepare output tree and necessary variables.  <br /></td></tr>
<tr class="separator:a7b87a7ce0c38e968fb841f228aea7212"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a197d9d30abc14a76d65bd876b28cca32"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a197d9d30abc14a76d65bd876b28cca32">CalcLLH</a> (TH2Poly *const &amp;Data, TH2Poly *const &amp;MC, TH2Poly *const &amp;W2)</td></tr>
<tr class="memdesc:a197d9d30abc14a76d65bd876b28cca32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper functions to calculate likelihoods using TH2Poly, will modify MC hist tittle to include LLH.  <br /></td></tr>
<tr class="separator:a197d9d30abc14a76d65bd876b28cca32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cd35f899a9f6dce138e6d99561aebdf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a5cd35f899a9f6dce138e6d99561aebdf">CalcLLH</a> (TH1D *const &amp;Data, TH1D *const &amp;MC, TH1D *const &amp;W2)</td></tr>
<tr class="memdesc:a5cd35f899a9f6dce138e6d99561aebdf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper functions to calculate likelihoods using TH1D, will modify MC hist tittle to include LLH.  <br /></td></tr>
<tr class="separator:a5cd35f899a9f6dce138e6d99561aebdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad027b0716b707691e6a9565ee497b66f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#ad027b0716b707691e6a9565ee497b66f">GetLLH</a> (TH2Poly *const &amp;Data, TH2Poly *const &amp;MC, TH2Poly *const &amp;W2)</td></tr>
<tr class="memdesc:ad027b0716b707691e6a9565ee497b66f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper functions to calculate likelihoods using TH2Poly.  <br /></td></tr>
<tr class="separator:ad027b0716b707691e6a9565ee497b66f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89b4a0897346caf484c356155792fce3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a89b4a0897346caf484c356155792fce3">GetLLH</a> (TH1D *const &amp;Data, TH1D *const &amp;MC, TH1D *const &amp;W2)</td></tr>
<tr class="memdesc:a89b4a0897346caf484c356155792fce3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper functions to calculate likelihoods using TH1D.  <br /></td></tr>
<tr class="separator:a89b4a0897346caf484c356155792fce3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac49aa59702b5e24cb0718c2642d6d793"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#ac49aa59702b5e24cb0718c2642d6d793">PlotBetaParameters</a> ()</td></tr>
<tr class="memdesc:ac49aa59702b5e24cb0718c2642d6d793"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: In Barlow Beeston we have Beta Parameters which scale generated MC.  <br /></td></tr>
<tr class="separator:ac49aa59702b5e24cb0718c2642d6d793"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa199f8841fcbf007c293187ea60d795"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#afa199f8841fcbf007c293187ea60d795">StudyKinematicCorrelations</a> ()</td></tr>
<tr class="memdesc:afa199f8841fcbf007c293187ea60d795"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Study how correlated are sample or kinematic bins.  <br /></td></tr>
<tr class="separator:afa199f8841fcbf007c293187ea60d795"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab28f4325f8104ab783fa3094a2fbbc44"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#ab28f4325f8104ab783fa3094a2fbbc44">MakeCutLLH</a> ()</td></tr>
<tr class="memdesc:ab28f4325f8104ab783fa3094a2fbbc44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make the cut LLH histogram.  <br /></td></tr>
<tr class="separator:ab28f4325f8104ab783fa3094a2fbbc44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf964a8fd459fff903faaea17a98f8b1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#abf964a8fd459fff903faaea17a98f8b1">MakeCutLLH1D</a> (TH1D *Histogram, double llh_ref=-999)</td></tr>
<tr class="separator:abf964a8fd459fff903faaea17a98f8b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24fff19d07a5b11c9c4149a45d0265cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a24fff19d07a5b11c9c4149a45d0265cd">MakeCutLLH2D</a> (TH2D *Histogram)</td></tr>
<tr class="memdesc:a24fff19d07a5b11c9c4149a45d0265cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make the 2D cut distribution and give the 2D p-value.  <br /></td></tr>
<tr class="separator:a24fff19d07a5b11c9c4149a45d0265cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e21a2b9fd429261e378f4e505ba2f75"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a0e21a2b9fd429261e378f4e505ba2f75">MakeCutEventRate</a> (TH1D *Histogram, const double DataRate)</td></tr>
<tr class="memdesc:a0e21a2b9fd429261e378f4e505ba2f75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make the 1D Event Rate Hist.  <br /></td></tr>
<tr class="separator:a0e21a2b9fd429261e378f4e505ba2f75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a316974fb99c5a775e1c7099be3bccc7b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a316974fb99c5a775e1c7099be3bccc7b">MakeChi2Hists</a> ()</td></tr>
<tr class="memdesc:a316974fb99c5a775e1c7099be3bccc7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make the fluctuated histograms (2D and 1D) for the chi2s Essentially taking the MCMC draws and calculating their LLH to the Posterior predictive distribution And additionally taking the data histogram and calculating the LLH to the predictive distribution Additionally we calculate the chi2 of the draws (fluctuated) of the MC with the prior/posterior predictive and plot it vs the chi2 from the draws of MCMC and the data.  <br /></td></tr>
<tr class="separator:a316974fb99c5a775e1c7099be3bccc7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c5a4ed4db695ce5c5820d857c76b4ff"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a8c5a4ed4db695ce5c5820d857c76b4ff">CheckSamples</a> (const int Length)</td></tr>
<tr class="memdesc:a8c5a4ed4db695ce5c5820d857c76b4ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check the length of samples agrees.  <br /></td></tr>
<tr class="separator:a8c5a4ed4db695ce5c5820d857c76b4ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cd67dc7cbc004f9b1581ac3a68e1924"><td class="memTemplParams" colspan="2">template&lt;class HistType &gt; </td></tr>
<tr class="memitem:a6cd67dc7cbc004f9b1581ac3a68e1924"><td class="memTemplItemLeft" align="right" valign="top">HistType *&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a6cd67dc7cbc004f9b1581ac3a68e1924">RatioHists</a> (HistType *NumHist, HistType *DenomHist)</td></tr>
<tr class="memdesc:a6cd67dc7cbc004f9b1581ac3a68e1924"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper to make ratio histograms.  <br /></td></tr>
<tr class="separator:a6cd67dc7cbc004f9b1581ac3a68e1924"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d7ad3d2ee9868e80548b8a73299bd5b"><td class="memItemLeft" align="right" valign="top">TH2Poly *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a6d7ad3d2ee9868e80548b8a73299bd5b">RatioPolys</a> (TH2Poly *NumPoly, TH2Poly *DenomPoly)</td></tr>
<tr class="memdesc:a6d7ad3d2ee9868e80548b8a73299bd5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper to make ratio of TH2Polys.  <br /></td></tr>
<tr class="separator:a6d7ad3d2ee9868e80548b8a73299bd5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9277cfce437396a23e3fb22c55196f9"><td class="memItemLeft" align="right" valign="top">TH1D *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#af9277cfce437396a23e3fb22c55196f9">ProjectHist</a> (TH2D *Histogram, const bool ProjectX)</td></tr>
<tr class="memdesc:af9277cfce437396a23e3fb22c55196f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper to project TH2D onto axis.  <br /></td></tr>
<tr class="separator:af9277cfce437396a23e3fb22c55196f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a685a8ef3180d4f6474328b5c806d8b74"><td class="memItemLeft" align="right" valign="top">TH1D *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a685a8ef3180d4f6474328b5c806d8b74">ProjectPoly</a> (TH2Poly *Histogram, const bool ProjectX, const int selection, const bool MakeErrorHist=false)</td></tr>
<tr class="memdesc:a685a8ef3180d4f6474328b5c806d8b74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper to project TH2Poly onto axis.  <br /></td></tr>
<tr class="separator:a685a8ef3180d4f6474328b5c806d8b74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada2f0b7b9b7bb687e67023e84151610e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#ada2f0b7b9b7bb687e67023e84151610e">MakeFluctuatedHistogram</a> (TH1D *FluctHist, TH1D *PolyHist)</td></tr>
<tr class="memdesc:ada2f0b7b9b7bb687e67023e84151610e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make Poisson fluctuation of TH1D hist.  <br /></td></tr>
<tr class="separator:ada2f0b7b9b7bb687e67023e84151610e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ac933c68cff9451eaf1cde713f2eedc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a8ac933c68cff9451eaf1cde713f2eedc">MakeFluctuatedHistogramStandard</a> (TH1D *FluctHist, TH1D *PolyHist)</td></tr>
<tr class="memdesc:a8ac933c68cff9451eaf1cde713f2eedc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make Poisson fluctuation of TH1D hist using default fast method.  <br /></td></tr>
<tr class="separator:a8ac933c68cff9451eaf1cde713f2eedc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7cda55ff5d54f442f39181f8478bd7f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#af7cda55ff5d54f442f39181f8478bd7f">MakeFluctuatedHistogramAlternative</a> (TH1D *FluctHist, TH1D *PolyHist)</td></tr>
<tr class="memdesc:af7cda55ff5d54f442f39181f8478bd7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make Poisson fluctuation of TH1D hist using slow method which is only for cross-check.  <br /></td></tr>
<tr class="separator:af7cda55ff5d54f442f39181f8478bd7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af05fa75a97eeb8890d7bc2d2204761f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#af05fa75a97eeb8890d7bc2d2204761f5">MakeFluctuatedHistogram</a> (TH2Poly *FluctHist, TH2Poly *PolyHist)</td></tr>
<tr class="memdesc:af05fa75a97eeb8890d7bc2d2204761f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make Poisson fluctuation of TH2Poly hist.  <br /></td></tr>
<tr class="separator:af05fa75a97eeb8890d7bc2d2204761f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8fdfe9143603490ebf0f9927c9e5ea6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#ad8fdfe9143603490ebf0f9927c9e5ea6">MakeFluctuatedHistogramStandard</a> (TH2Poly *FluctHist, TH2Poly *PolyHist)</td></tr>
<tr class="memdesc:ad8fdfe9143603490ebf0f9927c9e5ea6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make Poisson fluctuation of TH2Poly hist using default fast method.  <br /></td></tr>
<tr class="separator:ad8fdfe9143603490ebf0f9927c9e5ea6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1efcadb382307fc99ce01170401ffbaf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a1efcadb382307fc99ce01170401ffbaf">MakeFluctuatedHistogramAlternative</a> (TH2Poly *FluctHist, TH2Poly *PolyHist)</td></tr>
<tr class="memdesc:a1efcadb382307fc99ce01170401ffbaf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make Poisson fluctuation of TH2Poly hist using slow method which is only for cross-check.  <br /></td></tr>
<tr class="separator:a1efcadb382307fc99ce01170401ffbaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90fbcfacacf629b0b5f0de3fdab3fdfd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a90fbcfacacf629b0b5f0de3fdab3fdfd">FastViolinFill</a> (TH2D *violin, TH1D *hist_1d)</td></tr>
<tr class="memdesc:a90fbcfacacf629b0b5f0de3fdab3fdfd"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Fill Violin histogram with entry from a toy.  <br /></td></tr>
<tr class="separator:a90fbcfacacf629b0b5f0de3fdab3fdfd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a938ba96c39db535ede194bfe9f15d626"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a938ba96c39db535ede194bfe9f15d626">GetRandomPoly2</a> (const TH2Poly *PolyHist)</td></tr>
<tr class="memdesc:a938ba96c39db535ede194bfe9f15d626"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: ROOT developers were too lazy do develop getRanom2 for TH2Poly, this implementation is based on <a href="https://root.cern.ch/doc/master/classTH2.html#a883f419e1f6899f9c4255b458d2afe2e">link</a>  <br /></td></tr>
<tr class="separator:a938ba96c39db535ede194bfe9f15d626"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ed7c379dc433cb1dc3b71eb7aec9713"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a1ed7c379dc433cb1dc3b71eb7aec9713">GetModeError</a> (TH1D *hpost)</td></tr>
<tr class="memdesc:a1ed7c379dc433cb1dc3b71eb7aec9713"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the mode error from a TH1D.  <br /></td></tr>
<tr class="separator:a1ed7c379dc433cb1dc3b71eb7aec9713"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02dcccd537e6e9a9ffc46b31429306ce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a02dcccd537e6e9a9ffc46b31429306ce">StudyInformationCriterion</a> (<a class="el" href="namespaceM3.html#a007e5ed320c3672a3faf79da0a38fb7a">M3::kInfCrit</a> Criterion)</td></tr>
<tr class="memdesc:a02dcccd537e6e9a9ffc46b31429306ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Information Criterion.  <br /></td></tr>
<tr class="separator:a02dcccd537e6e9a9ffc46b31429306ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3560f062913ea70912e7b9a1cb93e2a5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a3560f062913ea70912e7b9a1cb93e2a5">StudyBIC</a> ()</td></tr>
<tr class="memdesc:a3560f062913ea70912e7b9a1cb93e2a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Study Bayesian Information Criterion (BIC) <a class="el" href="citelist.html#CITEREF_Gelman2014">[9]</a>.  <br /></td></tr>
<tr class="separator:a3560f062913ea70912e7b9a1cb93e2a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e73fe07b8b8dfb1e2ee9245df4e7a4b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a8e73fe07b8b8dfb1e2ee9245df4e7a4b">StudyDIC</a> ()</td></tr>
<tr class="memdesc:a8e73fe07b8b8dfb1e2ee9245df4e7a4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Get the Deviance Information Criterion (DIC) <a class="el" href="citelist.html#CITEREF_Spiegelhalter2002">[21]</a> <a class="el" href="citelist.html#CITEREF_BRugsDIC">[23]</a>.  <br /></td></tr>
<tr class="separator:a8e73fe07b8b8dfb1e2ee9245df4e7a4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f8198603d809480506cdc9bf171e9e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a9f8198603d809480506cdc9bf171e9e8">StudyWAIC</a> ()</td></tr>
<tr class="memdesc:a9f8198603d809480506cdc9bf171e9e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Get the Watanabe-Akaike information criterion (WAIC) <a class="el" href="citelist.html#CITEREF_Gelman2014">[9]</a> <a class="el" href="citelist.html#CITEREF_Hartig2024WAIC">[12]</a>.  <br /></td></tr>
<tr class="separator:a9f8198603d809480506cdc9bf171e9e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acab977d5e63eaca5862c352fea8a01c2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#acab977d5e63eaca5862c352fea8a01c2">NormaliseTH2Poly</a> (TH2Poly *Histogram)</td></tr>
<tr class="memdesc:acab977d5e63eaca5862c352fea8a01c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper to Normalise histograms.  <br /></td></tr>
<tr class="separator:acab977d5e63eaca5862c352fea8a01c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a364fb16938a26adbe59fdd057f4b9405"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; TRandom3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a364fb16938a26adbe59fdd057f4b9405">rnd</a></td></tr>
<tr class="memdesc:a364fb16938a26adbe59fdd057f4b9405"><td class="mdescLeft">&#160;</td><td class="mdescRight">Random number generator.  <br /></td></tr>
<tr class="separator:a364fb16938a26adbe59fdd057f4b9405"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ade2ccb94981d4483f0b4e6e367b1a0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a4ade2ccb94981d4483f0b4e6e367b1a0">first_pass</a></td></tr>
<tr class="memdesc:a4ade2ccb94981d4483f0b4e6e367b1a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Hacky flag to let us know if this is first toy.  <br /></td></tr>
<tr class="separator:a4ade2ccb94981d4483f0b4e6e367b1a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae502645ddf5c53a7a3f2c52566956bf3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#ae502645ddf5c53a7a3f2c52566956bf3">StandardFluctuation</a></td></tr>
<tr class="memdesc:ae502645ddf5c53a7a3f2c52566956bf3"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: We have two methods for Poissonian fluctuation.  <br /></td></tr>
<tr class="separator:ae502645ddf5c53a7a3f2c52566956bf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13177305e8fd4b97812b2ca563740bf2"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; TH2Poly * &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a13177305e8fd4b97812b2ca563740bf2">MCVector</a></td></tr>
<tr class="memdesc:a13177305e8fd4b97812b2ca563740bf2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector of vectors which holds the loaded MC histograms.  <br /></td></tr>
<tr class="separator:a13177305e8fd4b97812b2ca563740bf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a263b7541545b8b0ba735e0a3ac2d31e7"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; TH2Poly * &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a263b7541545b8b0ba735e0a3ac2d31e7">W2MCVector</a></td></tr>
<tr class="memdesc:a263b7541545b8b0ba735e0a3ac2d31e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector of vectors which holds the loaded W2 histograms.  <br /></td></tr>
<tr class="separator:a263b7541545b8b0ba735e0a3ac2d31e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3eeac18b62f7ee3a5c943c3cd0e9b76"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; std::vector&lt; TH2Poly * &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#ab3eeac18b62f7ee3a5c943c3cd0e9b76">MCVectorByMode</a></td></tr>
<tr class="memdesc:ab3eeac18b62f7ee3a5c943c3cd0e9b76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector of vectors which holds the loaded MC histograms for each mode.  <br /></td></tr>
<tr class="separator:ab3eeac18b62f7ee3a5c943c3cd0e9b76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a068e2a5ad0c02aaa57a27d2b12e37810"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a068e2a5ad0c02aaa57a27d2b12e37810">LLHPenaltyVector</a></td></tr>
<tr class="memdesc:a068e2a5ad0c02aaa57a27d2b12e37810"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector to hold the penalty term.  <br /></td></tr>
<tr class="separator:a068e2a5ad0c02aaa57a27d2b12e37810"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad40a0514f4be18ef026ea41bd5965fa3"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#ad40a0514f4be18ef026ea41bd5965fa3">WeightVector</a></td></tr>
<tr class="memdesc:ad40a0514f4be18ef026ea41bd5965fa3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector holding weight.  <br /></td></tr>
<tr class="separator:ad40a0514f4be18ef026ea41bd5965fa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab16d22bf65d2a9c15072901161fc160a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a></td></tr>
<tr class="memdesc:ab16d22bf65d2a9c15072901161fc160a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of samples.  <br /></td></tr>
<tr class="separator:ab16d22bf65d2a9c15072901161fc160a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ba7df41774c45a14c0a97e4accc9cc0"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a9ba7df41774c45a14c0a97e4accc9cc0">SampleNames</a></td></tr>
<tr class="memdesc:a9ba7df41774c45a14c0a97e4accc9cc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">name for each sample  <br /></td></tr>
<tr class="separator:a9ba7df41774c45a14c0a97e4accc9cc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a508ef812c8b1275580759832e33c98ee"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; std::unique_ptr&lt; TH1D &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a></td></tr>
<tr class="memdesc:a508ef812c8b1275580759832e33c98ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">The posterior predictive for the whole selection: this gets built after adding in the toys. Now an array of Th1ds, 1 for each poly bin, for each sample.  <br /></td></tr>
<tr class="separator:a508ef812c8b1275580759832e33c98ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6773885be1b6a2660493718823a2f3f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; std::unique_ptr&lt; TH1D &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#aa6773885be1b6a2660493718823a2f3f">w2Hist</a></td></tr>
<tr class="memdesc:aa6773885be1b6a2660493718823a2f3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The posterior predictive for the whole selection: this gets built after adding in the toys. Now an array of Th1ds, 1 for each poly bin, for each sample for W2.  <br /></td></tr>
<tr class="separator:aa6773885be1b6a2660493718823a2f3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a93fa8d52abe2828a4a25e49cf6fee8"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH2D * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a4a93fa8d52abe2828a4a25e49cf6fee8">ViolinHists_ProjectX</a></td></tr>
<tr class="memdesc:a4a93fa8d52abe2828a4a25e49cf6fee8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Posterior predictive but for X projection but as a violin plot.  <br /></td></tr>
<tr class="separator:a4a93fa8d52abe2828a4a25e49cf6fee8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93714cf9b778fa7713a641da0cd2d534"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH2D * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a93714cf9b778fa7713a641da0cd2d534">ViolinHists_ProjectY</a></td></tr>
<tr class="memdesc:a93714cf9b778fa7713a641da0cd2d534"><td class="mdescLeft">&#160;</td><td class="mdescRight">Posterior predictive but for Y projection but as a violin plot.  <br /></td></tr>
<tr class="separator:a93714cf9b778fa7713a641da0cd2d534"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e962b36331edb6ff1e9de849cbabee3"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH2Poly * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a></td></tr>
<tr class="memdesc:a7e962b36331edb6ff1e9de849cbabee3"><td class="mdescLeft">&#160;</td><td class="mdescRight">The data histogram for the selection.  <br /></td></tr>
<tr class="separator:a7e962b36331edb6ff1e9de849cbabee3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abeaca1195db794d9e660a377d81c1b21"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH1D * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#abeaca1195db794d9e660a377d81c1b21">DataHist_ProjectX</a></td></tr>
<tr class="memdesc:abeaca1195db794d9e660a377d81c1b21"><td class="mdescLeft">&#160;</td><td class="mdescRight">The data histogram for the selection X projection.  <br /></td></tr>
<tr class="separator:abeaca1195db794d9e660a377d81c1b21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfeb54f4d95b5b74257a1abf5c98824f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH1D * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#abfeb54f4d95b5b74257a1abf5c98824f">DataHist_ProjectY</a></td></tr>
<tr class="memdesc:abfeb54f4d95b5b74257a1abf5c98824f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The data histogram for the selection Y projection.  <br /></td></tr>
<tr class="separator:abfeb54f4d95b5b74257a1abf5c98824f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a503b0dc19bb1ad57e7f2560cc64feef9"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH2Poly * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a></td></tr>
<tr class="memdesc:a503b0dc19bb1ad57e7f2560cc64feef9"><td class="mdescLeft">&#160;</td><td class="mdescRight">The nominal histogram for the selection.  <br /></td></tr>
<tr class="separator:a503b0dc19bb1ad57e7f2560cc64feef9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c37d8669c0f55f6a4620b4f0d7b6e20"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH2Poly * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a9c37d8669c0f55f6a4620b4f0d7b6e20">W2NomHist</a></td></tr>
<tr class="memdesc:a9c37d8669c0f55f6a4620b4f0d7b6e20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the w2 histograms (for nominal values).  <br /></td></tr>
<tr class="separator:a9c37d8669c0f55f6a4620b4f0d7b6e20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2828111584f80f855b56a9a093987673"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH2Poly * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">W2MeanHist</a></td></tr>
<tr class="memdesc:a2828111584f80f855b56a9a093987673"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the w2 histograms (for mean values).  <br /></td></tr>
<tr class="separator:a2828111584f80f855b56a9a093987673"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf9b943ba381875b3f2e0c4807a9b8c4"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH2Poly * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#adf9b943ba381875b3f2e0c4807a9b8c4">W2ModeHist</a></td></tr>
<tr class="memdesc:adf9b943ba381875b3f2e0c4807a9b8c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the w2 histograms (for mode values).  <br /></td></tr>
<tr class="separator:adf9b943ba381875b3f2e0c4807a9b8c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70b109c60b7c82a3e36708bd2674cb5e"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; TH1D &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a70b109c60b7c82a3e36708bd2674cb5e">lnLHist</a></td></tr>
<tr class="memdesc:a70b109c60b7c82a3e36708bd2674cb5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The histogram containing the lnL for each throw.  <br /></td></tr>
<tr class="separator:a70b109c60b7c82a3e36708bd2674cb5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aead1702a4c1522e685a8af5a875f05ab"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; TH1D &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#aead1702a4c1522e685a8af5a875f05ab">lnLHist_drawfluc</a></td></tr>
<tr class="memdesc:aead1702a4c1522e685a8af5a875f05ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">The lnLhist for the draw vs MC fluctuated.  <br /></td></tr>
<tr class="separator:aead1702a4c1522e685a8af5a875f05ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6f15a5750ae0224168d487e44ad3d94"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; TH1D &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#aa6f15a5750ae0224168d487e44ad3d94">lnLHist_drawflucdraw</a></td></tr>
<tr class="memdesc:aa6f15a5750ae0224168d487e44ad3d94"><td class="mdescLeft">&#160;</td><td class="mdescRight">The lnLhist for the draw vs draw fluctuated.  <br /></td></tr>
<tr class="separator:aa6f15a5750ae0224168d487e44ad3d94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf23ed9a699d625adc8639a57de801e8"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; TH1D &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#aaf23ed9a699d625adc8639a57de801e8">lnLHist_drawdata</a></td></tr>
<tr class="memdesc:aaf23ed9a699d625adc8639a57de801e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">The lnLhist for the draw vs data.  <br /></td></tr>
<tr class="separator:aaf23ed9a699d625adc8639a57de801e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c7537f32164be9192f8ba2b12a69cdb"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; TH2D &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a8c7537f32164be9192f8ba2b12a69cdb">lnLDrawHist</a></td></tr>
<tr class="memdesc:a8c7537f32164be9192f8ba2b12a69cdb"><td class="mdescLeft">&#160;</td><td class="mdescRight">The 2D lnLhist, showing (draw vs data) and (draw vs fluct), anything above y=x axis is the p-value.  <br /></td></tr>
<tr class="separator:a8c7537f32164be9192f8ba2b12a69cdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1aafef6414eafb5572893dded50a1b1"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; TH2D &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#ae1aafef6414eafb5572893dded50a1b1">lnLFlucHist</a></td></tr>
<tr class="memdesc:ae1aafef6414eafb5572893dded50a1b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">The 2D lnLHist, showing (draw vs data) and (draw vs draw fluct), anything above y=x axis is the p-value.  <br /></td></tr>
<tr class="separator:ae1aafef6414eafb5572893dded50a1b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae188cf135af004d5364e5b4f3b1bb31"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; TH2D &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#aae188cf135af004d5364e5b4f3b1bb31">lnLDrawHistRate</a></td></tr>
<tr class="memdesc:aae188cf135af004d5364e5b4f3b1bb31"><td class="mdescLeft">&#160;</td><td class="mdescRight">The 2D lnLhist, showing (draw vs data) and (draw vs fluct), using rate, anything above y=x axis is the p-value.  <br /></td></tr>
<tr class="separator:aae188cf135af004d5364e5b4f3b1bb31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae509f51ec2d0323e005e05c255bc0c1f"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; TH2D &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#ae509f51ec2d0323e005e05c255bc0c1f">lnLFlucHist_ProjectX</a></td></tr>
<tr class="memdesc:ae509f51ec2d0323e005e05c255bc0c1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The 2D lnLHist but for ProjectionX histogram (pmu), showing (draw vs data) and (draw vs draw fluct), anything above y=x axis is the p-value.  <br /></td></tr>
<tr class="separator:ae509f51ec2d0323e005e05c255bc0c1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa61561a1e3594ac9250aaee26409245e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH1D * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#aa61561a1e3594ac9250aaee26409245e">lnLHist_Sample_DrawData</a></td></tr>
<tr class="memdesc:aa61561a1e3594ac9250aaee26409245e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The histogram containing the lnL (draw vs data) for each throw for each sample.  <br /></td></tr>
<tr class="separator:aa61561a1e3594ac9250aaee26409245e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afddd2abc0ec07b52dc9004880522ab5a"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH1D * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#afddd2abc0ec07b52dc9004880522ab5a">lnLHist_Sample_DrawflucDraw</a></td></tr>
<tr class="memdesc:afddd2abc0ec07b52dc9004880522ab5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The histogram containing the lnL (draw vs draw fluct) for each throw for each sample.  <br /></td></tr>
<tr class="separator:afddd2abc0ec07b52dc9004880522ab5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecf1c224162e1055e8306d438e1a3761"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH1D * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#aecf1c224162e1055e8306d438e1a3761">lnLHist_Sample_PredflucDraw</a></td></tr>
<tr class="memdesc:aecf1c224162e1055e8306d438e1a3761"><td class="mdescLeft">&#160;</td><td class="mdescRight">The histogram containing the lnL (draw vs pred fluct) for each throw for each sample.  <br /></td></tr>
<tr class="separator:aecf1c224162e1055e8306d438e1a3761"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a154c9bd15825713c48154fab66190d39"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH2Poly * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a154c9bd15825713c48154fab66190d39">lnLHist_Mean</a></td></tr>
<tr class="memdesc:a154c9bd15825713c48154fab66190d39"><td class="mdescLeft">&#160;</td><td class="mdescRight">The LLH distribution in pmu cosmu for using the mean in each bin.  <br /></td></tr>
<tr class="separator:a154c9bd15825713c48154fab66190d39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03bbc94ee26b66875becf22255a205d2"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH2Poly * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a03bbc94ee26b66875becf22255a205d2">lnLHist_Mode</a></td></tr>
<tr class="memdesc:a03bbc94ee26b66875becf22255a205d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">The LLH distribution in pmu cosmu for using the mode in each bin.  <br /></td></tr>
<tr class="separator:a03bbc94ee26b66875becf22255a205d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b1ba5b3b465f78019bb8c36ec5f56d7"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH1D * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a7b1ba5b3b465f78019bb8c36ec5f56d7">lnLHist_Mean_ProjectX</a></td></tr>
<tr class="memdesc:a7b1ba5b3b465f78019bb8c36ec5f56d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">The LLH distribution in pmu using the mean in each bin.  <br /></td></tr>
<tr class="separator:a7b1ba5b3b465f78019bb8c36ec5f56d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0edee6c71137e2a8150c7ba3e8fb6e0"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH2Poly * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a></td></tr>
<tr class="memdesc:af0edee6c71137e2a8150c7ba3e8fb6e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">The posterior predictive distribution in pmu cosmu using the mean.  <br /></td></tr>
<tr class="separator:af0edee6c71137e2a8150c7ba3e8fb6e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6191a0fc1c8f1f0889b3dedcc5485a3d"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH2Poly * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a6191a0fc1c8f1f0889b3dedcc5485a3d">MeanHistCorrected</a></td></tr>
<tr class="memdesc:a6191a0fc1c8f1f0889b3dedcc5485a3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">The posterior predictive distribution in pmu cosmu using the mean after applying Barlow-Beeston Correction.  <br /></td></tr>
<tr class="separator:a6191a0fc1c8f1f0889b3dedcc5485a3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b21ff74bb8ebd7c3af2c24e02f3d7dc"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH2Poly * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a9b21ff74bb8ebd7c3af2c24e02f3d7dc">ModeHist</a></td></tr>
<tr class="memdesc:a9b21ff74bb8ebd7c3af2c24e02f3d7dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">The posterior predictive distribution in pmu cosmu using the mode.  <br /></td></tr>
<tr class="separator:a9b21ff74bb8ebd7c3af2c24e02f3d7dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a718c83e1952f948a5c063c2039a68a19"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH1D * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a718c83e1952f948a5c063c2039a68a19">lnLHist_Mean1D</a></td></tr>
<tr class="memdesc:a718c83e1952f948a5c063c2039a68a19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds the bin-by-bin LLH for the mean posterior predictive vs the data.  <br /></td></tr>
<tr class="separator:a718c83e1952f948a5c063c2039a68a19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a424b53de4d9e896526667ddb565e4a6b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH1D * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a424b53de4d9e896526667ddb565e4a6b">lnLHist_Mode1D</a></td></tr>
<tr class="memdesc:a424b53de4d9e896526667ddb565e4a6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds the bin-by-bin LLH for the mode posterior predictive vs the data.  <br /></td></tr>
<tr class="separator:a424b53de4d9e896526667ddb565e4a6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ced5be9bc8ba79530464d53b9c23797"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; TH1D &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a2ced5be9bc8ba79530464d53b9c23797">RandomHist</a></td></tr>
<tr class="memdesc:a2ced5be9bc8ba79530464d53b9c23797"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds the history of which entries have been drawn in the MCMC file.  <br /></td></tr>
<tr class="separator:a2ced5be9bc8ba79530464d53b9c23797"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a479f46f89c0c752c3e3e147d5b04b458"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; std::unique_ptr&lt; TH1D &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a479f46f89c0c752c3e3e147d5b04b458">BetaHist</a></td></tr>
<tr class="memdesc:a479f46f89c0c752c3e3e147d5b04b458"><td class="mdescLeft">&#160;</td><td class="mdescRight">Distribution of beta parameters in Barlow Beeston formalisms.  <br /></td></tr>
<tr class="separator:a479f46f89c0c752c3e3e147d5b04b458"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf610d698a50c4930d95be320e99a8e8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#adf610d698a50c4930d95be320e99a8e8">DoBetaParam</a></td></tr>
<tr class="memdesc:adf610d698a50c4930d95be320e99a8e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Are we making Beta Histograms.  <br /></td></tr>
<tr class="separator:adf610d698a50c4930d95be320e99a8e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4767862e5c1f4e3319d16b861213555"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#af4767862e5c1f4e3319d16b861213555">nChainSteps</a></td></tr>
<tr class="memdesc:af4767862e5c1f4e3319d16b861213555"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of throws by user.  <br /></td></tr>
<tr class="separator:af4767862e5c1f4e3319d16b861213555"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb737e335e68edeb14a6ce2ca112dc8c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#adb737e335e68edeb14a6ce2ca112dc8c">isPriorPredictive</a></td></tr>
<tr class="memdesc:adb737e335e68edeb14a6ce2ca112dc8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">bool whether we have Prior or Posterior Predictive  <br /></td></tr>
<tr class="separator:adb737e335e68edeb14a6ce2ca112dc8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebd01b201cf04608b251cd3e272878b7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#aebd01b201cf04608b251cd3e272878b7">doShapeOnly</a></td></tr>
<tr class="memdesc:aebd01b201cf04608b251cd3e272878b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">bool whether to normalise each toy to have shape based p-value and pos pred distribution  <br /></td></tr>
<tr class="separator:aebd01b201cf04608b251cd3e272878b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5c4055d4bb4dc720a4118032cdb4910"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">nThrows</a></td></tr>
<tr class="memdesc:aa5c4055d4bb4dc720a4118032cdb4910"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of throws.  <br /></td></tr>
<tr class="separator:aa5c4055d4bb4dc720a4118032cdb4910"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5a3139cef917abfddc36dbb8d4ac2fd"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a></td></tr>
<tr class="memdesc:af5a3139cef917abfddc36dbb8d4ac2fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max Number of Bins per each sample.  <br /></td></tr>
<tr class="separator:af5a3139cef917abfddc36dbb8d4ac2fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacac73b24f1e8b05d35fabe2322578e8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#aacac73b24f1e8b05d35fabe2322578e8">llh_total</a></td></tr>
<tr class="memdesc:aacac73b24f1e8b05d35fabe2322578e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total LLH for the posterior predictive distribution.  <br /></td></tr>
<tr class="separator:aacac73b24f1e8b05d35fabe2322578e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4463f635de4e83c7ada683768454da82"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a4463f635de4e83c7ada683768454da82">OutputName</a></td></tr>
<tr class="memdesc:a4463f635de4e83c7ada683768454da82"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output filename.  <br /></td></tr>
<tr class="separator:a4463f635de4e83c7ada683768454da82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7b948f290517a052f04f61dfa6af68f"><td class="memItemLeft" align="right" valign="top">TFile *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#aa7b948f290517a052f04f61dfa6af68f">Outputfile</a></td></tr>
<tr class="memdesc:aa7b948f290517a052f04f61dfa6af68f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output filename.  <br /></td></tr>
<tr class="separator:aa7b948f290517a052f04f61dfa6af68f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2064e7455c3164ee5118a5e5162f282"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TDirectory * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#aa2064e7455c3164ee5118a5e5162f282">Dir</a></td></tr>
<tr class="memdesc:aa2064e7455c3164ee5118a5e5162f282"><td class="mdescLeft">&#160;</td><td class="mdescRight">Directory for each sample.  <br /></td></tr>
<tr class="separator:aa2064e7455c3164ee5118a5e5162f282"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78eb4766cc8b4758b909b6ce9113a56e"><td class="memItemLeft" align="right" valign="top">TTree *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a></td></tr>
<tr class="memdesc:a78eb4766cc8b4758b909b6ce9113a56e"><td class="mdescLeft">&#160;</td><td class="mdescRight">TTree which we save useful information to.  <br /></td></tr>
<tr class="separator:a78eb4766cc8b4758b909b6ce9113a56e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a668c1a7ce4ef8592eae4a91ef99c60dc"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a668c1a7ce4ef8592eae4a91ef99c60dc">llh_data_draw</a></td></tr>
<tr class="memdesc:a668c1a7ce4ef8592eae4a91ef99c60dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data vs Draw.  <br /></td></tr>
<tr class="separator:a668c1a7ce4ef8592eae4a91ef99c60dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a596fc0b5e504bf382c342e950dd7cb95"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a596fc0b5e504bf382c342e950dd7cb95">llh_drawfluc_draw</a></td></tr>
<tr class="memdesc:a596fc0b5e504bf382c342e950dd7cb95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fluctuated Draw vs Draw.  <br /></td></tr>
<tr class="separator:a596fc0b5e504bf382c342e950dd7cb95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a107a3073ee178eff7107ccd5f41b91c5"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a107a3073ee178eff7107ccd5f41b91c5">llh_predfluc_draw</a></td></tr>
<tr class="memdesc:a107a3073ee178eff7107ccd5f41b91c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fluctuated Predictive vs Draw.  <br /></td></tr>
<tr class="separator:a107a3073ee178eff7107ccd5f41b91c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adae47fb3a91f5946c7329c6e3643ae9a"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#adae47fb3a91f5946c7329c6e3643ae9a">llh_rate_data_draw</a></td></tr>
<tr class="memdesc:adae47fb3a91f5946c7329c6e3643ae9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data vs Draw using rate only.  <br /></td></tr>
<tr class="separator:adae47fb3a91f5946c7329c6e3643ae9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa27591c1aff4c4e8e25fbf9c13ae37c5"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#aa27591c1aff4c4e8e25fbf9c13ae37c5">llh_rate_predfluc_draw</a></td></tr>
<tr class="memdesc:aa27591c1aff4c4e8e25fbf9c13ae37c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fluctuated Predictive vs Draw using rate only.  <br /></td></tr>
<tr class="separator:aa27591c1aff4c4e8e25fbf9c13ae37c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a999cbd0982694a364f8706ca2b435d81"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a999cbd0982694a364f8706ca2b435d81">llh_data_drawfluc</a></td></tr>
<tr class="memdesc:a999cbd0982694a364f8706ca2b435d81"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data vs Fluctuated Draw.  <br /></td></tr>
<tr class="separator:a999cbd0982694a364f8706ca2b435d81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a325a83aec886a90ed6d4c96ccf573c56"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a325a83aec886a90ed6d4c96ccf573c56">llh_data_predfluc</a></td></tr>
<tr class="memdesc:a325a83aec886a90ed6d4c96ccf573c56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data vs Fluctuated Predictive.  <br /></td></tr>
<tr class="separator:a325a83aec886a90ed6d4c96ccf573c56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f46ee13ef20275c5dc162196190984b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a7f46ee13ef20275c5dc162196190984b">llh_draw_pred</a></td></tr>
<tr class="memdesc:a7f46ee13ef20275c5dc162196190984b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Draw vs Predictive.  <br /></td></tr>
<tr class="separator:a7f46ee13ef20275c5dc162196190984b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc8205a6fddca44ed7c5b3e5c50612e7"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#abc8205a6fddca44ed7c5b3e5c50612e7">llh_drawfluc_pred</a></td></tr>
<tr class="memdesc:abc8205a6fddca44ed7c5b3e5c50612e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fluctuated Draw vs Predictive.  <br /></td></tr>
<tr class="separator:abc8205a6fddca44ed7c5b3e5c50612e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a464faf180667c999aec72c140ddb515a"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a464faf180667c999aec72c140ddb515a">llh_predfluc_pred</a></td></tr>
<tr class="memdesc:a464faf180667c999aec72c140ddb515a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fluctuated Predictive vs Predictive.  <br /></td></tr>
<tr class="separator:a464faf180667c999aec72c140ddb515a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a642d0e2bb5bc0729744684a3f8bbc459"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a642d0e2bb5bc0729744684a3f8bbc459">llh_drawfluc_predfluc</a></td></tr>
<tr class="memdesc:a642d0e2bb5bc0729744684a3f8bbc459"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fluctuated Draw vs Fluctuated Predictive.  <br /></td></tr>
<tr class="separator:a642d0e2bb5bc0729744684a3f8bbc459"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe225db63f8137df4b74d138ab1eb6f2"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#abe225db63f8137df4b74d138ab1eb6f2">llh_datafluc_draw</a></td></tr>
<tr class="memdesc:abe225db63f8137df4b74d138ab1eb6f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fluctuated Data vs Draw.  <br /></td></tr>
<tr class="separator:abe225db63f8137df4b74d138ab1eb6f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a083eb13c61fe7d1b88b2ebe845312640"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a083eb13c61fe7d1b88b2ebe845312640">llh_data_draw_ProjectX</a></td></tr>
<tr class="memdesc:a083eb13c61fe7d1b88b2ebe845312640"><td class="mdescLeft">&#160;</td><td class="mdescRight">Projection X (most likely muon momentum) of LLH.  <br /></td></tr>
<tr class="separator:a083eb13c61fe7d1b88b2ebe845312640"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81be1b29e649529930276daab33f7b69"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a81be1b29e649529930276daab33f7b69">llh_drawfluc_draw_ProjectX</a></td></tr>
<tr class="separator:a81be1b29e649529930276daab33f7b69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef70c5ef9c8432dc42ff7f6c73c7e8d5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a></td></tr>
<tr class="memdesc:aef70c5ef9c8432dc42ff7f6c73c7e8d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">LLH penalty for each throw.  <br /></td></tr>
<tr class="separator:aef70c5ef9c8432dc42ff7f6c73c7e8d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cb3d8dcbab49b62be3bc2a4a7e4d5f3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a2cb3d8dcbab49b62be3bc2a4a7e4d5f3">total_llh_data_draw</a></td></tr>
<tr class="memdesc:a2cb3d8dcbab49b62be3bc2a4a7e4d5f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data vs Draw.  <br /></td></tr>
<tr class="separator:a2cb3d8dcbab49b62be3bc2a4a7e4d5f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e418146cce2c4201c3aa7e1eaad4a38"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a7e418146cce2c4201c3aa7e1eaad4a38">total_llh_drawfluc_draw</a></td></tr>
<tr class="memdesc:a7e418146cce2c4201c3aa7e1eaad4a38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fluctuated Draw vs Draw.  <br /></td></tr>
<tr class="separator:a7e418146cce2c4201c3aa7e1eaad4a38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a804a117990fd1441c9e3a9d8e8d32e98"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a804a117990fd1441c9e3a9d8e8d32e98">total_llh_predfluc_draw</a></td></tr>
<tr class="memdesc:a804a117990fd1441c9e3a9d8e8d32e98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fluctuated Predictive vs Draw.  <br /></td></tr>
<tr class="separator:a804a117990fd1441c9e3a9d8e8d32e98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf055562efe3e5f2592942f5151ece22"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#aaf055562efe3e5f2592942f5151ece22">total_llh_rate_data_draw</a></td></tr>
<tr class="memdesc:aaf055562efe3e5f2592942f5151ece22"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rate Data vs Draw.  <br /></td></tr>
<tr class="separator:aaf055562efe3e5f2592942f5151ece22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ebe701d114669fdfcf61e1680bb144d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a2ebe701d114669fdfcf61e1680bb144d">total_llh_rate_predfluc_draw</a></td></tr>
<tr class="memdesc:a2ebe701d114669fdfcf61e1680bb144d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fluctuated Predictive vs Draw using Rate.  <br /></td></tr>
<tr class="separator:a2ebe701d114669fdfcf61e1680bb144d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeee48af77dc4e0beee5eab13c30f3d38"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#aeee48af77dc4e0beee5eab13c30f3d38">total_llh_data_predfluc</a></td></tr>
<tr class="memdesc:aeee48af77dc4e0beee5eab13c30f3d38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data vs Fluctuated Predictive.  <br /></td></tr>
<tr class="separator:aeee48af77dc4e0beee5eab13c30f3d38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a670c890357fd77997279c83c197f989c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a670c890357fd77997279c83c197f989c">total_llh_data_drawfluc</a></td></tr>
<tr class="memdesc:a670c890357fd77997279c83c197f989c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data vs Fluctuated Draw.  <br /></td></tr>
<tr class="separator:a670c890357fd77997279c83c197f989c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58efe34df7c43fb40d211036e30a1b5d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a58efe34df7c43fb40d211036e30a1b5d">total_llh_draw_pred</a></td></tr>
<tr class="memdesc:a58efe34df7c43fb40d211036e30a1b5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Draw vs Predictive.  <br /></td></tr>
<tr class="separator:a58efe34df7c43fb40d211036e30a1b5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c8b444ac7f80a5af63d5b9f4a150b79"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a9c8b444ac7f80a5af63d5b9f4a150b79">total_llh_drawfluc_pred</a></td></tr>
<tr class="memdesc:a9c8b444ac7f80a5af63d5b9f4a150b79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fluctuated Draw vs Predictive.  <br /></td></tr>
<tr class="separator:a9c8b444ac7f80a5af63d5b9f4a150b79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af92a42a666e1bfcb2dc761ffa2253b7e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#af92a42a666e1bfcb2dc761ffa2253b7e">total_llh_drawfluc_predfluc</a></td></tr>
<tr class="memdesc:af92a42a666e1bfcb2dc761ffa2253b7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fluctuated Draw vs Fluctuated Predictive.  <br /></td></tr>
<tr class="separator:af92a42a666e1bfcb2dc761ffa2253b7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9e5d89095e6c6a81aedb5ea2402e3fb"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#af9e5d89095e6c6a81aedb5ea2402e3fb">total_llh_datafluc_draw</a></td></tr>
<tr class="memdesc:af9e5d89095e6c6a81aedb5ea2402e3fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fluctuated Data vs Draw.  <br /></td></tr>
<tr class="separator:af9e5d89095e6c6a81aedb5ea2402e3fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f6c2e7ed8f9024cf928da5b56054e07"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a1f6c2e7ed8f9024cf928da5b56054e07">total_llh_predfluc_pred</a></td></tr>
<tr class="memdesc:a1f6c2e7ed8f9024cf928da5b56054e07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fluctuated Predictive vs Predictive.  <br /></td></tr>
<tr class="separator:a1f6c2e7ed8f9024cf928da5b56054e07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a973692db89f52c19c9195ffe95c9a1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a5a973692db89f52c19c9195ffe95c9a1">total_llh_data_draw_ProjectX</a></td></tr>
<tr class="memdesc:a5a973692db89f52c19c9195ffe95c9a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data vs Draw for projection X (most likely muon momentum)  <br /></td></tr>
<tr class="separator:a5a973692db89f52c19c9195ffe95c9a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22df11667306c7892f9ed3f8935a5c9e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a22df11667306c7892f9ed3f8935a5c9e">total_llh_drawfluc_draw_ProjectX</a></td></tr>
<tr class="memdesc:a22df11667306c7892f9ed3f8935a5c9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fluctuated Draw vs Draw for projection X (most likely muon momentum)  <br /></td></tr>
<tr class="separator:a22df11667306c7892f9ed3f8935a5c9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a795ac96bf6958c8a2f38c9de23c3c081"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a795ac96bf6958c8a2f38c9de23c3c081">DoByModePlots</a></td></tr>
<tr class="memdesc:a795ac96bf6958c8a2f38c9de23c3c081"><td class="mdescLeft">&#160;</td><td class="mdescRight">By mode variables.  <br /></td></tr>
<tr class="separator:a795ac96bf6958c8a2f38c9de23c3c081"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20237446a72eda2dc833bfc72c7e42e1"><td class="memItemLeft" align="right" valign="top">TH2Poly ***&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a20237446a72eda2dc833bfc72c7e42e1">MeanHist_ByMode</a></td></tr>
<tr class="memdesc:a20237446a72eda2dc833bfc72c7e42e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">The posterior predictive distribution in pmu cosmu using the mean.  <br /></td></tr>
<tr class="separator:a20237446a72eda2dc833bfc72c7e42e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6cfe4fb92b67f08b0d94f0fe1d8a3a2"><td class="memItemLeft" align="right" valign="top">TH1D ****&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#aa6cfe4fb92b67f08b0d94f0fe1d8a3a2">PosteriorHist_ByMode</a></td></tr>
<tr class="memdesc:aa6cfe4fb92b67f08b0d94f0fe1d8a3a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Histogram which corresponds to each bin in the sample's th2poly.  <br /></td></tr>
<tr class="separator:aa6cfe4fb92b67f08b0d94f0fe1d8a3a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd938805245ca6cfeb8c49363f5ff11c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classsamplePDFBase.html">samplePDFBase</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#abd938805245ca6cfeb8c49363f5ff11c">SamplePDF</a></td></tr>
<tr class="memdesc:abd938805245ca6cfeb8c49363f5ff11c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to samplePDF object, mostly used to get sample names, binning etc.  <br /></td></tr>
<tr class="separator:abd938805245ca6cfeb8c49363f5ff11c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6593fed9709673a6910f96adc88fc8f2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMaCh3Modes.html">MaCh3Modes</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a></td></tr>
<tr class="memdesc:a6593fed9709673a6910f96adc88fc8f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">MaCh3 Modes.  <br /></td></tr>
<tr class="separator:a6593fed9709673a6910f96adc88fc8f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafb18632bb987ae9a302d95781d5fdba"><td class="memItemLeft" align="right" valign="top"><a class="el" href="Structs_8h.html#a960da89e33ac45a56f7bbfac3068dc67">TestStatistic</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#aafb18632bb987ae9a302d95781d5fdba">likelihood</a></td></tr>
<tr class="memdesc:aafb18632bb987ae9a302d95781d5fdba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type of likelihood for example Poisson, Barlow-Beeston or Ice Cube.  <br /></td></tr>
<tr class="separator:aafb18632bb987ae9a302d95781d5fdba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49215601479aaa99f9f64d8f7c900385"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a49215601479aaa99f9f64d8f7c900385">nModelParams</a></td></tr>
<tr class="memdesc:a49215601479aaa99f9f64d8f7c900385"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of parameters.  <br /></td></tr>
<tr class="separator:a49215601479aaa99f9f64d8f7c900385"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a807e348a85fb460c5ca4a1ce56d08aab"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSampleSummary.html#a807e348a85fb460c5ca4a1ce56d08aab">Debug</a></td></tr>
<tr class="memdesc:a807e348a85fb460c5ca4a1ce56d08aab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tells Debug level to save additional histograms.  <br /></td></tr>
<tr class="separator:a807e348a85fb460c5ca4a1ce56d08aab"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class to calculate pvalue produce posterior predictive and many fancy Bayesian stuff <a class="el" href="citelist.html#CITEREF_gelman1996posterior">[8]</a>. </p>
<p>For more information, visit the <a href="https://github.com/mach3-software/MaCh3/wiki/10.-Posterior-Predictive,-p%E2%80%90value-etc.">Wiki</a>. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00023">23</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="afa739654e03cce78c48eb99bcd58c99a" name="afa739654e03cce78c48eb99bcd58c99a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa739654e03cce78c48eb99bcd58c99a">&#9670;&#160;</a></span>SampleSummary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SampleSummary::SampleSummary </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n_Samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>Filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsamplePDFBase.html">samplePDFBase</a> *const&#160;</td>
          <td class="paramname"><em>sample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nSteps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n_Samples</td><td>total number of samples </td></tr>
    <tr><td class="paramname">Filename</td><td>name of output file </td></tr>
    <tr><td class="paramname">sample</td><td>pointer to sample PDF object </td></tr>
    <tr><td class="paramname">nChainSteps</td><td>number of steps in a chain, 0 indicate prior predictive was used </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l00009">9</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">    9</span>                                                                                                                          {</div>
<div class="line"><span class="lineno">   10</span><span class="comment">// *******************</span></div>
<div class="line"><span class="lineno">   11</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a>(<span class="stringliteral">&quot;Making sample summary class...&quot;</span>);</div>
<div class="line"><span class="lineno">   12</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">   13</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a>(<span class="stringliteral">&quot;With OpenMP and {} threads&quot;</span>, omp_get_max_threads());</div>
<div class="line"><span class="lineno">   14</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">   15</span>  </div>
<div class="line"><span class="lineno">   16</span>  <a class="code hl_variable" href="classSampleSummary.html#ae502645ddf5c53a7a3f2c52566956bf3">StandardFluctuation</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   17</span>  </div>
<div class="line"><span class="lineno">   18</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#ae502645ddf5c53a7a3f2c52566956bf3">StandardFluctuation</a>) <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Using standard method of statistical fluctuation&quot;</span>);</div>
<div class="line"><span class="lineno">   19</span>  <span class="keywordflow">else</span> <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Using alternative method of statistical fluctuation, which is much slower&quot;</span>);</div>
<div class="line"><span class="lineno">   20</span>  </div>
<div class="line"><span class="lineno">   21</span>  <span class="comment">//KS: If true it will print posterior predictive for every beta parameter it is quite useful but make root big number of plots</span></div>
<div class="line"><span class="lineno">   22</span>  <a class="code hl_variable" href="classSampleSummary.html#adf610d698a50c4930d95be320e99a8e8">DoBetaParam</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   23</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#adf610d698a50c4930d95be320e99a8e8">DoBetaParam</a>) <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;I will calculate #beta parameters from Barlow-Beeston formalism&quot;</span>);</div>
<div class="line"><span class="lineno">   24</span> </div>
<div class="line"><span class="lineno">   25</span>  <span class="comment">//If true code will normalise each histogram, this way you can calculate shape only error. etc. pvalue will be completely wrong unfortunately</span></div>
<div class="line"><span class="lineno">   26</span>  <a class="code hl_variable" href="classSampleSummary.html#aebd01b201cf04608b251cd3e272878b7">doShapeOnly</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   27</span> </div>
<div class="line"><span class="lineno">   28</span>  <a class="code hl_variable" href="classSampleSummary.html#af4767862e5c1f4e3319d16b861213555">nChainSteps</a> = nSteps;</div>
<div class="line"><span class="lineno">   29</span>  <span class="comment">//KS: nChainSteps == 0 means we run PriorPredcitive</span></div>
<div class="line"><span class="lineno">   30</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#af4767862e5c1f4e3319d16b861213555">nChainSteps</a> == 0) <a class="code hl_variable" href="classSampleSummary.html#adb737e335e68edeb14a6ce2ca112dc8c">isPriorPredictive</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   31</span>  <span class="keywordflow">else</span> <a class="code hl_variable" href="classSampleSummary.html#adb737e335e68edeb14a6ce2ca112dc8c">isPriorPredictive</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   32</span>  </div>
<div class="line"><span class="lineno">   33</span>  <a class="code hl_variable" href="classSampleSummary.html#a4463f635de4e83c7ada683768454da82">OutputName</a> = Filename;</div>
<div class="line"><span class="lineno">   34</span>  <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a> = n_Samples;</div>
<div class="line"><span class="lineno">   35</span>  <a class="code hl_variable" href="classSampleSummary.html#abd938805245ca6cfeb8c49363f5ff11c">SamplePDF</a> = sample;</div>
<div class="line"><span class="lineno">   36</span> </div>
<div class="line"><span class="lineno">   37</span>  <span class="comment">//Get mach3 modes from manager</span></div>
<div class="line"><span class="lineno">   38</span>  <a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a> = <a class="code hl_variable" href="classSampleSummary.html#abd938805245ca6cfeb8c49363f5ff11c">SamplePDF</a>-&gt;<a class="code hl_function" href="classsamplePDFBase.html#ad7ab324d8b7ac73f92ef6a8d74b9dc72">GetMaCh3Modes</a>();</div>
<div class="line"><span class="lineno">   39</span> </div>
<div class="line"><span class="lineno">   40</span>  <a class="code hl_variable" href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">nThrows</a> = 0;</div>
<div class="line"><span class="lineno">   41</span>  <a class="code hl_variable" href="classSampleSummary.html#a4ade2ccb94981d4483f0b4e6e367b1a0">first_pass</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   42</span>  <a class="code hl_variable" href="classSampleSummary.html#aa7b948f290517a052f04f61dfa6af68f">Outputfile</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   43</span>  <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   44</span>  <a class="code hl_variable" href="classSampleSummary.html#a364fb16938a26adbe59fdd057f4b9405">rnd</a> = std::make_unique&lt;TRandom3&gt;();</div>
<div class="line"><span class="lineno">   45</span> </div>
<div class="line"><span class="lineno">   46</span>  <a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">   47</span>  <a class="code hl_variable" href="classSampleSummary.html#abeaca1195db794d9e660a377d81c1b21">DataHist_ProjectX</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">   48</span>  <a class="code hl_variable" href="classSampleSummary.html#abfeb54f4d95b5b74257a1abf5c98824f">DataHist_ProjectY</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">   49</span>  <a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">   50</span>  <a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">   51</span>  <a class="code hl_variable" href="classSampleSummary.html#a9c37d8669c0f55f6a4620b4f0d7b6e20">W2NomHist</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">   52</span>  <a class="code hl_variable" href="classSampleSummary.html#aa6773885be1b6a2660493718823a2f3f">w2Hist</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span>  <a class="code hl_variable" href="classSampleSummary.html#a4a93fa8d52abe2828a4a25e49cf6fee8">ViolinHists_ProjectX</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">   55</span>  <a class="code hl_variable" href="classSampleSummary.html#a93714cf9b778fa7713a641da0cd2d534">ViolinHists_ProjectY</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">   56</span>    </div>
<div class="line"><span class="lineno">   57</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#adf610d698a50c4930d95be320e99a8e8">DoBetaParam</a>) <a class="code hl_variable" href="classSampleSummary.html#a479f46f89c0c752c3e3e147d5b04b458">BetaHist</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">   58</span> </div>
<div class="line"><span class="lineno">   59</span>  <a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">   60</span>  </div>
<div class="line"><span class="lineno">   61</span>  <a class="code hl_variable" href="classSampleSummary.html#a154c9bd15825713c48154fab66190d39">lnLHist_Mean</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">   62</span>  <a class="code hl_variable" href="classSampleSummary.html#a03bbc94ee26b66875becf22255a205d2">lnLHist_Mode</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">   63</span>  <a class="code hl_variable" href="classSampleSummary.html#a7b1ba5b3b465f78019bb8c36ec5f56d7">lnLHist_Mean_ProjectX</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">   64</span>  <a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);;</div>
<div class="line"><span class="lineno">   65</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#adf610d698a50c4930d95be320e99a8e8">DoBetaParam</a>) <a class="code hl_variable" href="classSampleSummary.html#a6191a0fc1c8f1f0889b3dedcc5485a3d">MeanHistCorrected</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);;</div>
<div class="line"><span class="lineno">   66</span>  <a class="code hl_variable" href="classSampleSummary.html#a9b21ff74bb8ebd7c3af2c24e02f3d7dc">ModeHist</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">   67</span>  <a class="code hl_variable" href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">W2MeanHist</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">   68</span>  <a class="code hl_variable" href="classSampleSummary.html#adf9b943ba381875b3f2e0c4807a9b8c4">W2ModeHist</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">   69</span>  <a class="code hl_variable" href="classSampleSummary.html#a718c83e1952f948a5c063c2039a68a19">lnLHist_Mean1D</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">   70</span>  <a class="code hl_variable" href="classSampleSummary.html#a424b53de4d9e896526667ddb565e4a6b">lnLHist_Mode1D</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">   71</span>  <a class="code hl_variable" href="classSampleSummary.html#aa61561a1e3594ac9250aaee26409245e">lnLHist_Sample_DrawData</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">   72</span>  <a class="code hl_variable" href="classSampleSummary.html#afddd2abc0ec07b52dc9004880522ab5a">lnLHist_Sample_DrawflucDraw</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">   73</span>  <a class="code hl_variable" href="classSampleSummary.html#aecf1c224162e1055e8306d438e1a3761">lnLHist_Sample_PredflucDraw</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">   74</span>    </div>
<div class="line"><span class="lineno">   75</span>  <span class="comment">//KS: When a histogram is created with an axis lower limit greater or equal to its upper limit ROOT will automatically adjust histogram range</span></div>
<div class="line"><span class="lineno">   76</span>  <span class="comment">// https://root.cern.ch/doc/master/classTH1.html#auto-bin</span></div>
<div class="line"><span class="lineno">   77</span>  <a class="code hl_variable" href="classSampleSummary.html#a70b109c60b7c82a3e36708bd2674cb5e">lnLHist</a> = std::make_unique&lt;TH1D&gt;(<span class="stringliteral">&quot;lnLHist_predpredfluc&quot;</span>, <span class="stringliteral">&quot;lnLHist_predpredfluc&quot;</span>, 100, 1, -1);</div>
<div class="line"><span class="lineno">   78</span>  <a class="code hl_variable" href="classSampleSummary.html#a70b109c60b7c82a3e36708bd2674cb5e">lnLHist</a>-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">   79</span>  <a class="code hl_variable" href="classSampleSummary.html#a70b109c60b7c82a3e36708bd2674cb5e">lnLHist</a>-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;-2LLH (Pred Fluc, Pred)&quot;</span>);</div>
<div class="line"><span class="lineno">   80</span>  <a class="code hl_variable" href="classSampleSummary.html#a70b109c60b7c82a3e36708bd2674cb5e">lnLHist</a>-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Counts&quot;</span>);</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>  <a class="code hl_variable" href="classSampleSummary.html#aaf23ed9a699d625adc8639a57de801e8">lnLHist_drawdata</a> = std::make_unique&lt;TH1D&gt;(<span class="stringliteral">&quot;lnLHist_drawdata&quot;</span>, <span class="stringliteral">&quot;lnLHist_drawdata&quot;</span>, 100, 1, -1);</div>
<div class="line"><span class="lineno">   83</span>  <a class="code hl_variable" href="classSampleSummary.html#aaf23ed9a699d625adc8639a57de801e8">lnLHist_drawdata</a>-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">   84</span>  <a class="code hl_variable" href="classSampleSummary.html#aaf23ed9a699d625adc8639a57de801e8">lnLHist_drawdata</a>-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;-2LLH (Data, Draw)&quot;</span>);</div>
<div class="line"><span class="lineno">   85</span>  <a class="code hl_variable" href="classSampleSummary.html#aaf23ed9a699d625adc8639a57de801e8">lnLHist_drawdata</a>-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Counts&quot;</span>);</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>  <a class="code hl_variable" href="classSampleSummary.html#aead1702a4c1522e685a8af5a875f05ab">lnLHist_drawfluc</a> = std::make_unique&lt;TH1D&gt;(<span class="stringliteral">&quot;lnLHist_drawpredfluc&quot;</span>, <span class="stringliteral">&quot;lnLHist_drawpredfluc&quot;</span>, 100, 1, -1);</div>
<div class="line"><span class="lineno">   88</span>  <a class="code hl_variable" href="classSampleSummary.html#aead1702a4c1522e685a8af5a875f05ab">lnLHist_drawfluc</a>-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">   89</span>  <a class="code hl_variable" href="classSampleSummary.html#aead1702a4c1522e685a8af5a875f05ab">lnLHist_drawfluc</a>-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;-2LLH (Pred Fluc, Draw)&quot;</span>);</div>
<div class="line"><span class="lineno">   90</span>  <a class="code hl_variable" href="classSampleSummary.html#aead1702a4c1522e685a8af5a875f05ab">lnLHist_drawfluc</a>-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Counts&quot;</span>);</div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span>  <a class="code hl_variable" href="classSampleSummary.html#aa6f15a5750ae0224168d487e44ad3d94">lnLHist_drawflucdraw</a> = std::make_unique&lt;TH1D&gt;(<span class="stringliteral">&quot;lnLHist_drawflucdraw&quot;</span>, <span class="stringliteral">&quot;lnLHist_drawflucdraw&quot;</span>, 100, 1, -1);</div>
<div class="line"><span class="lineno">   93</span>  <a class="code hl_variable" href="classSampleSummary.html#aa6f15a5750ae0224168d487e44ad3d94">lnLHist_drawflucdraw</a>-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">   94</span>  <a class="code hl_variable" href="classSampleSummary.html#aa6f15a5750ae0224168d487e44ad3d94">lnLHist_drawflucdraw</a>-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;-2LLH (Draw Fluc, Draw)&quot;</span>);</div>
<div class="line"><span class="lineno">   95</span>  <a class="code hl_variable" href="classSampleSummary.html#aa6f15a5750ae0224168d487e44ad3d94">lnLHist_drawflucdraw</a>-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Counts&quot;</span>);</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>  <a class="code hl_variable" href="classSampleSummary.html#a8c7537f32164be9192f8ba2b12a69cdb">lnLDrawHist</a> = std::make_unique&lt;TH2D&gt;(<span class="stringliteral">&quot;lnLDrawHist&quot;</span>, <span class="stringliteral">&quot;lnLDrawHist&quot;</span>, 50, 1, -1, 50, 1, -1);</div>
<div class="line"><span class="lineno">   98</span>  <a class="code hl_variable" href="classSampleSummary.html#a8c7537f32164be9192f8ba2b12a69cdb">lnLDrawHist</a>-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">   99</span>  <a class="code hl_variable" href="classSampleSummary.html#a8c7537f32164be9192f8ba2b12a69cdb">lnLDrawHist</a>-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;-2LLH_{Pred Fluc, Draw}&quot;</span>);</div>
<div class="line"><span class="lineno">  100</span>  <a class="code hl_variable" href="classSampleSummary.html#a8c7537f32164be9192f8ba2b12a69cdb">lnLDrawHist</a>-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;-2LLH_{Data, Draw}&quot;</span>);</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>  <a class="code hl_variable" href="classSampleSummary.html#ae1aafef6414eafb5572893dded50a1b1">lnLFlucHist</a> = std::make_unique&lt;TH2D&gt;(<span class="stringliteral">&quot;lnLFlucHist&quot;</span>, <span class="stringliteral">&quot;lnLFlucHist&quot;</span>, 50, 1, -1, 50, 1, -1);</div>
<div class="line"><span class="lineno">  103</span>  <a class="code hl_variable" href="classSampleSummary.html#ae1aafef6414eafb5572893dded50a1b1">lnLFlucHist</a>-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  104</span>  <a class="code hl_variable" href="classSampleSummary.html#ae1aafef6414eafb5572893dded50a1b1">lnLFlucHist</a>-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;-2LLH_{Draw Fluc, Draw}&quot;</span>);</div>
<div class="line"><span class="lineno">  105</span>  <a class="code hl_variable" href="classSampleSummary.html#ae1aafef6414eafb5572893dded50a1b1">lnLFlucHist</a>-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;-2LLH_{Data, Draw}&quot;</span>);</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>  <a class="code hl_variable" href="classSampleSummary.html#aae188cf135af004d5364e5b4f3b1bb31">lnLDrawHistRate</a> = std::make_unique&lt;TH2D&gt;(<span class="stringliteral">&quot;lnLDrawHistRate&quot;</span>, <span class="stringliteral">&quot;lnLDrawHistRate&quot;</span>, 50, 1, -1, 50, 1, -1);</div>
<div class="line"><span class="lineno">  108</span>  <a class="code hl_variable" href="classSampleSummary.html#aae188cf135af004d5364e5b4f3b1bb31">lnLDrawHistRate</a>-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  109</span>  <a class="code hl_variable" href="classSampleSummary.html#aae188cf135af004d5364e5b4f3b1bb31">lnLDrawHistRate</a>-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;-2LLH_{Pred Fluc, Draw}&quot;</span>);</div>
<div class="line"><span class="lineno">  110</span>  <a class="code hl_variable" href="classSampleSummary.html#aae188cf135af004d5364e5b4f3b1bb31">lnLDrawHistRate</a>-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;-2LLH_{Data, Draw}&quot;</span>);</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>  <span class="comment">//KS: This is silly as it assumes all samples uses same kinematics</span></div>
<div class="line"><span class="lineno">  113</span>  <a class="code hl_variable" href="classSampleSummary.html#ae509f51ec2d0323e005e05c255bc0c1f">lnLFlucHist_ProjectX</a> = std::make_unique&lt;TH2D&gt;(<span class="stringliteral">&quot;lnLFlucHist_ProjectX&quot;</span>, <span class="stringliteral">&quot;lnLFlucHist_ProjectX&quot;</span>, 50, 1, -1, 50, 1, -1);</div>
<div class="line"><span class="lineno">  114</span>  <a class="code hl_variable" href="classSampleSummary.html#ae509f51ec2d0323e005e05c255bc0c1f">lnLFlucHist_ProjectX</a>-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  115</span>  <a class="code hl_variable" href="classSampleSummary.html#ae509f51ec2d0323e005e05c255bc0c1f">lnLFlucHist_ProjectX</a>-&gt;GetXaxis()-&gt;SetTitle((<span class="stringliteral">&quot;-2LLH_{Draw Fluc, Draw} for &quot;</span> + <a class="code hl_variable" href="classSampleSummary.html#abd938805245ca6cfeb8c49363f5ff11c">SamplePDF</a>-&gt;<a class="code hl_function" href="classsamplePDFBase.html#a2c02e6a8107a0fd8b9deed6d98015ba3">GetKinVarLabel</a>(0, 0)).c_str());</div>
<div class="line"><span class="lineno">  116</span>  <a class="code hl_variable" href="classSampleSummary.html#ae509f51ec2d0323e005e05c255bc0c1f">lnLFlucHist_ProjectX</a>-&gt;GetYaxis()-&gt;SetTitle((<span class="stringliteral">&quot;-2LLH_{Data, Draw} for &quot;</span> + <a class="code hl_variable" href="classSampleSummary.html#abd938805245ca6cfeb8c49363f5ff11c">SamplePDF</a>-&gt;<a class="code hl_function" href="classsamplePDFBase.html#a2c02e6a8107a0fd8b9deed6d98015ba3">GetKinVarLabel</a>(0, 0)).c_str());</div>
<div class="line"><span class="lineno">  117</span>  </div>
<div class="line"><span class="lineno">  118</span>  <span class="comment">// Holds the hist of random number draws, only works for posterior predictive</span></div>
<div class="line"><span class="lineno">  119</span>  <span class="keywordflow">if</span>(!<a class="code hl_variable" href="classSampleSummary.html#adb737e335e68edeb14a6ce2ca112dc8c">isPriorPredictive</a>)</div>
<div class="line"><span class="lineno">  120</span>  {</div>
<div class="line"><span class="lineno">  121</span>    <a class="code hl_variable" href="classSampleSummary.html#a2ced5be9bc8ba79530464d53b9c23797">RandomHist</a> = std::make_unique&lt;TH1D&gt;(<span class="stringliteral">&quot;RandomHist&quot;</span>, <span class="stringliteral">&quot;RandomHist&quot;</span>, 100, 0, <a class="code hl_variable" href="classSampleSummary.html#af4767862e5c1f4e3319d16b861213555">nChainSteps</a>);</div>
<div class="line"><span class="lineno">  122</span>    <a class="code hl_variable" href="classSampleSummary.html#a2ced5be9bc8ba79530464d53b9c23797">RandomHist</a>-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  123</span>    <a class="code hl_variable" href="classSampleSummary.html#a2ced5be9bc8ba79530464d53b9c23797">RandomHist</a>-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Step&quot;</span>);</div>
<div class="line"><span class="lineno">  124</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> binwidth = <a class="code hl_variable" href="classSampleSummary.html#af4767862e5c1f4e3319d16b861213555">nChainSteps</a>/<a class="code hl_variable" href="classSampleSummary.html#a2ced5be9bc8ba79530464d53b9c23797">RandomHist</a>-&gt;GetNbinsX();</div>
<div class="line"><span class="lineno">  125</span>    std::stringstream ss;</div>
<div class="line"><span class="lineno">  126</span>    ss &lt;&lt; <span class="stringliteral">&quot;Draws/&quot;</span> &lt;&lt; binwidth;</div>
<div class="line"><span class="lineno">  127</span>    <a class="code hl_variable" href="classSampleSummary.html#a2ced5be9bc8ba79530464d53b9c23797">RandomHist</a>-&gt;GetYaxis()-&gt;SetTitle(ss.str().c_str());</div>
<div class="line"><span class="lineno">  128</span>    <a class="code hl_variable" href="classSampleSummary.html#a2ced5be9bc8ba79530464d53b9c23797">RandomHist</a>-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno">  129</span>  }</div>
<div class="line"><span class="lineno">  130</span>  <span class="keywordflow">else</span> <a class="code hl_variable" href="classSampleSummary.html#a2ced5be9bc8ba79530464d53b9c23797">RandomHist</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++i)</div>
<div class="line"><span class="lineno">  133</span>  {</div>
<div class="line"><span class="lineno">  134</span>    <a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  135</span>    <a class="code hl_variable" href="classSampleSummary.html#abeaca1195db794d9e660a377d81c1b21">DataHist_ProjectX</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  136</span>    <a class="code hl_variable" href="classSampleSummary.html#abfeb54f4d95b5b74257a1abf5c98824f">DataHist_ProjectY</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  137</span>    <a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  138</span>    </div>
<div class="line"><span class="lineno">  139</span>    <a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  140</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#adf610d698a50c4930d95be320e99a8e8">DoBetaParam</a>) <a class="code hl_variable" href="classSampleSummary.html#a6191a0fc1c8f1f0889b3dedcc5485a3d">MeanHistCorrected</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  141</span>    <a class="code hl_variable" href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">W2MeanHist</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  142</span>    <a class="code hl_variable" href="classSampleSummary.html#adf9b943ba381875b3f2e0c4807a9b8c4">W2ModeHist</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  143</span>    <a class="code hl_variable" href="classSampleSummary.html#a154c9bd15825713c48154fab66190d39">lnLHist_Mean</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  144</span>    <a class="code hl_variable" href="classSampleSummary.html#a03bbc94ee26b66875becf22255a205d2">lnLHist_Mode</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  145</span>    <a class="code hl_variable" href="classSampleSummary.html#a7b1ba5b3b465f78019bb8c36ec5f56d7">lnLHist_Mean_ProjectX</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  146</span>    <a class="code hl_variable" href="classSampleSummary.html#a718c83e1952f948a5c063c2039a68a19">lnLHist_Mean1D</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  147</span>    <a class="code hl_variable" href="classSampleSummary.html#a424b53de4d9e896526667ddb565e4a6b">lnLHist_Mode1D</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  148</span>    <a class="code hl_variable" href="classSampleSummary.html#aa61561a1e3594ac9250aaee26409245e">lnLHist_Sample_DrawData</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  149</span>    <a class="code hl_variable" href="classSampleSummary.html#afddd2abc0ec07b52dc9004880522ab5a">lnLHist_Sample_DrawflucDraw</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  150</span>    <a class="code hl_variable" href="classSampleSummary.html#aecf1c224162e1055e8306d438e1a3761">lnLHist_Sample_PredflucDraw</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  151</span>  }<span class="comment">//end loop over samples</span></div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>  <a class="code hl_variable" href="classSampleSummary.html#a795ac96bf6958c8a2f38c9de23c3c081">DoByModePlots</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  154</span>  <a class="code hl_variable" href="classSampleSummary.html#a20237446a72eda2dc833bfc72c7e42e1">MeanHist_ByMode</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  155</span>  <a class="code hl_variable" href="classSampleSummary.html#aa6cfe4fb92b67f08b0d94f0fe1d8a3a2">PosteriorHist_ByMode</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>  <a class="code hl_variable" href="classSampleSummary.html#a49215601479aaa99f9f64d8f7c900385">nModelParams</a> = 0;</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span>  <a class="code hl_variable" href="classSampleSummary.html#a807e348a85fb460c5ca4a1ce56d08aab">Debug</a> = 0;</div>
<div class="line"><span class="lineno">  160</span>}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a4db4657acad5c79ac4bbb66a9d1c5905"><div class="ttname"><a href="MaCh3Logger_8h.html#a4db4657acad5c79ac4bbb66a9d1c5905">MACH3LOG_DEBUG</a></div><div class="ttdeci">#define MACH3LOG_DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00015">MaCh3Logger.h:15</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_a95fa4dffc648e4c5536c9292c2bdcac3"><div class="ttname"><a href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a></div><div class="ttdeci">#define MACH3LOG_INFO</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00016">MaCh3Logger.h:16</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a03bbc94ee26b66875becf22255a205d2"><div class="ttname"><a href="classSampleSummary.html#a03bbc94ee26b66875becf22255a205d2">SampleSummary::lnLHist_Mode</a></div><div class="ttdeci">std::vector&lt; TH2Poly * &gt; lnLHist_Mode</div><div class="ttdoc">The LLH distribution in pmu cosmu for using the mode in each bin.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00240">SampleSummary.h:240</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a154c9bd15825713c48154fab66190d39"><div class="ttname"><a href="classSampleSummary.html#a154c9bd15825713c48154fab66190d39">SampleSummary::lnLHist_Mean</a></div><div class="ttdeci">std::vector&lt; TH2Poly * &gt; lnLHist_Mean</div><div class="ttdoc">The LLH distribution in pmu cosmu for using the mean in each bin.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00238">SampleSummary.h:238</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a20237446a72eda2dc833bfc72c7e42e1"><div class="ttname"><a href="classSampleSummary.html#a20237446a72eda2dc833bfc72c7e42e1">SampleSummary::MeanHist_ByMode</a></div><div class="ttdeci">TH2Poly *** MeanHist_ByMode</div><div class="ttdoc">The posterior predictive distribution in pmu cosmu using the mean.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00362">SampleSummary.h:362</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a2828111584f80f855b56a9a093987673"><div class="ttname"><a href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">SampleSummary::W2MeanHist</a></div><div class="ttdeci">std::vector&lt; TH2Poly * &gt; W2MeanHist</div><div class="ttdoc">Pointer to the w2 histograms (for mean values).</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00208">SampleSummary.h:208</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a2ced5be9bc8ba79530464d53b9c23797"><div class="ttname"><a href="classSampleSummary.html#a2ced5be9bc8ba79530464d53b9c23797">SampleSummary::RandomHist</a></div><div class="ttdeci">std::unique_ptr&lt; TH1D &gt; RandomHist</div><div class="ttdoc">Holds the history of which entries have been drawn in the MCMC file.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00258">SampleSummary.h:258</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a364fb16938a26adbe59fdd057f4b9405"><div class="ttname"><a href="classSampleSummary.html#a364fb16938a26adbe59fdd057f4b9405">SampleSummary::rnd</a></div><div class="ttdeci">std::unique_ptr&lt; TRandom3 &gt; rnd</div><div class="ttdoc">Random number generator.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00162">SampleSummary.h:162</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a424b53de4d9e896526667ddb565e4a6b"><div class="ttname"><a href="classSampleSummary.html#a424b53de4d9e896526667ddb565e4a6b">SampleSummary::lnLHist_Mode1D</a></div><div class="ttdeci">std::vector&lt; TH1D * &gt; lnLHist_Mode1D</div><div class="ttdoc">Holds the bin-by-bin LLH for the mode posterior predictive vs the data.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00255">SampleSummary.h:255</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a4463f635de4e83c7ada683768454da82"><div class="ttname"><a href="classSampleSummary.html#a4463f635de4e83c7ada683768454da82">SampleSummary::OutputName</a></div><div class="ttdeci">std::string OutputName</div><div class="ttdoc">Output filename.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00284">SampleSummary.h:284</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a479f46f89c0c752c3e3e147d5b04b458"><div class="ttname"><a href="classSampleSummary.html#a479f46f89c0c752c3e3e147d5b04b458">SampleSummary::BetaHist</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::unique_ptr&lt; TH1D &gt; &gt; &gt; BetaHist</div><div class="ttdoc">Distribution of beta parameters in Barlow Beeston formalisms.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00261">SampleSummary.h:261</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a49215601479aaa99f9f64d8f7c900385"><div class="ttname"><a href="classSampleSummary.html#a49215601479aaa99f9f64d8f7c900385">SampleSummary::nModelParams</a></div><div class="ttdeci">int nModelParams</div><div class="ttdoc">Number of parameters.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00376">SampleSummary.h:376</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a4a93fa8d52abe2828a4a25e49cf6fee8"><div class="ttname"><a href="classSampleSummary.html#a4a93fa8d52abe2828a4a25e49cf6fee8">SampleSummary::ViolinHists_ProjectX</a></div><div class="ttdeci">std::vector&lt; TH2D * &gt; ViolinHists_ProjectX</div><div class="ttdoc">Posterior predictive but for X projection but as a violin plot.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00193">SampleSummary.h:193</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a4ade2ccb94981d4483f0b4e6e367b1a0"><div class="ttname"><a href="classSampleSummary.html#a4ade2ccb94981d4483f0b4e6e367b1a0">SampleSummary::first_pass</a></div><div class="ttdeci">bool first_pass</div><div class="ttdoc">KS: Hacky flag to let us know if this is first toy.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00164">SampleSummary.h:164</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a503b0dc19bb1ad57e7f2560cc64feef9"><div class="ttname"><a href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">SampleSummary::NominalHist</a></div><div class="ttdeci">std::vector&lt; TH2Poly * &gt; NominalHist</div><div class="ttdoc">The nominal histogram for the selection.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00204">SampleSummary.h:204</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a508ef812c8b1275580759832e33c98ee"><div class="ttname"><a href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">SampleSummary::PosteriorHist</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::unique_ptr&lt; TH1D &gt; &gt; &gt; PosteriorHist</div><div class="ttdoc">The posterior predictive for the whole selection: this gets built after adding in the toys....</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00188">SampleSummary.h:188</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a6191a0fc1c8f1f0889b3dedcc5485a3d"><div class="ttname"><a href="classSampleSummary.html#a6191a0fc1c8f1f0889b3dedcc5485a3d">SampleSummary::MeanHistCorrected</a></div><div class="ttdeci">std::vector&lt; TH2Poly * &gt; MeanHistCorrected</div><div class="ttdoc">The posterior predictive distribution in pmu cosmu using the mean after applying Barlow-Beeston Corre...</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00248">SampleSummary.h:248</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a6593fed9709673a6910f96adc88fc8f2"><div class="ttname"><a href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">SampleSummary::Modes</a></div><div class="ttdeci">MaCh3Modes * Modes</div><div class="ttdoc">MaCh3 Modes.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00370">SampleSummary.h:370</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a70b109c60b7c82a3e36708bd2674cb5e"><div class="ttname"><a href="classSampleSummary.html#a70b109c60b7c82a3e36708bd2674cb5e">SampleSummary::lnLHist</a></div><div class="ttdeci">std::unique_ptr&lt; TH1D &gt; lnLHist</div><div class="ttdoc">The histogram containing the lnL for each throw.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00213">SampleSummary.h:213</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a718c83e1952f948a5c063c2039a68a19"><div class="ttname"><a href="classSampleSummary.html#a718c83e1952f948a5c063c2039a68a19">SampleSummary::lnLHist_Mean1D</a></div><div class="ttdeci">std::vector&lt; TH1D * &gt; lnLHist_Mean1D</div><div class="ttdoc">Holds the bin-by-bin LLH for the mean posterior predictive vs the data.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00253">SampleSummary.h:253</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a78eb4766cc8b4758b909b6ce9113a56e"><div class="ttname"><a href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">SampleSummary::OutputTree</a></div><div class="ttdeci">TTree * OutputTree</div><div class="ttdoc">TTree which we save useful information to.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00291">SampleSummary.h:291</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a795ac96bf6958c8a2f38c9de23c3c081"><div class="ttname"><a href="classSampleSummary.html#a795ac96bf6958c8a2f38c9de23c3c081">SampleSummary::DoByModePlots</a></div><div class="ttdeci">bool DoByModePlots</div><div class="ttdoc">By mode variables.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00360">SampleSummary.h:360</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a7b1ba5b3b465f78019bb8c36ec5f56d7"><div class="ttname"><a href="classSampleSummary.html#a7b1ba5b3b465f78019bb8c36ec5f56d7">SampleSummary::lnLHist_Mean_ProjectX</a></div><div class="ttdeci">std::vector&lt; TH1D * &gt; lnLHist_Mean_ProjectX</div><div class="ttdoc">The LLH distribution in pmu using the mean in each bin.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00243">SampleSummary.h:243</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a7e962b36331edb6ff1e9de849cbabee3"><div class="ttname"><a href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">SampleSummary::DataHist</a></div><div class="ttdeci">std::vector&lt; TH2Poly * &gt; DataHist</div><div class="ttdoc">The data histogram for the selection.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00198">SampleSummary.h:198</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a807e348a85fb460c5ca4a1ce56d08aab"><div class="ttname"><a href="classSampleSummary.html#a807e348a85fb460c5ca4a1ce56d08aab">SampleSummary::Debug</a></div><div class="ttdeci">int Debug</div><div class="ttdoc">Tells Debug level to save additional histograms.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00379">SampleSummary.h:379</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a8c7537f32164be9192f8ba2b12a69cdb"><div class="ttname"><a href="classSampleSummary.html#a8c7537f32164be9192f8ba2b12a69cdb">SampleSummary::lnLDrawHist</a></div><div class="ttdeci">std::unique_ptr&lt; TH2D &gt; lnLDrawHist</div><div class="ttdoc">The 2D lnLhist, showing (draw vs data) and (draw vs fluct), anything above y=x axis is the p-value.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00221">SampleSummary.h:221</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a93714cf9b778fa7713a641da0cd2d534"><div class="ttname"><a href="classSampleSummary.html#a93714cf9b778fa7713a641da0cd2d534">SampleSummary::ViolinHists_ProjectY</a></div><div class="ttdeci">std::vector&lt; TH2D * &gt; ViolinHists_ProjectY</div><div class="ttdoc">Posterior predictive but for Y projection but as a violin plot.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00195">SampleSummary.h:195</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a9b21ff74bb8ebd7c3af2c24e02f3d7dc"><div class="ttname"><a href="classSampleSummary.html#a9b21ff74bb8ebd7c3af2c24e02f3d7dc">SampleSummary::ModeHist</a></div><div class="ttdeci">std::vector&lt; TH2Poly * &gt; ModeHist</div><div class="ttdoc">The posterior predictive distribution in pmu cosmu using the mode.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00250">SampleSummary.h:250</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a9c37d8669c0f55f6a4620b4f0d7b6e20"><div class="ttname"><a href="classSampleSummary.html#a9c37d8669c0f55f6a4620b4f0d7b6e20">SampleSummary::W2NomHist</a></div><div class="ttdeci">std::vector&lt; TH2Poly * &gt; W2NomHist</div><div class="ttdoc">Pointer to the w2 histograms (for nominal values).</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00206">SampleSummary.h:206</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_aa5c4055d4bb4dc720a4118032cdb4910"><div class="ttname"><a href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">SampleSummary::nThrows</a></div><div class="ttdeci">unsigned int nThrows</div><div class="ttdoc">Number of throws.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00275">SampleSummary.h:275</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_aa61561a1e3594ac9250aaee26409245e"><div class="ttname"><a href="classSampleSummary.html#aa61561a1e3594ac9250aaee26409245e">SampleSummary::lnLHist_Sample_DrawData</a></div><div class="ttdeci">std::vector&lt; TH1D * &gt; lnLHist_Sample_DrawData</div><div class="ttdoc">The histogram containing the lnL (draw vs data) for each throw for each sample.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00231">SampleSummary.h:231</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_aa6773885be1b6a2660493718823a2f3f"><div class="ttname"><a href="classSampleSummary.html#aa6773885be1b6a2660493718823a2f3f">SampleSummary::w2Hist</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::unique_ptr&lt; TH1D &gt; &gt; &gt; w2Hist</div><div class="ttdoc">The posterior predictive for the whole selection: this gets built after adding in the toys....</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00190">SampleSummary.h:190</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_aa6cfe4fb92b67f08b0d94f0fe1d8a3a2"><div class="ttname"><a href="classSampleSummary.html#aa6cfe4fb92b67f08b0d94f0fe1d8a3a2">SampleSummary::PosteriorHist_ByMode</a></div><div class="ttdeci">TH1D **** PosteriorHist_ByMode</div><div class="ttdoc">Histogram which corresponds to each bin in the sample's th2poly.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00364">SampleSummary.h:364</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_aa6f15a5750ae0224168d487e44ad3d94"><div class="ttname"><a href="classSampleSummary.html#aa6f15a5750ae0224168d487e44ad3d94">SampleSummary::lnLHist_drawflucdraw</a></div><div class="ttdeci">std::unique_ptr&lt; TH1D &gt; lnLHist_drawflucdraw</div><div class="ttdoc">The lnLhist for the draw vs draw fluctuated.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00217">SampleSummary.h:217</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_aa7b948f290517a052f04f61dfa6af68f"><div class="ttname"><a href="classSampleSummary.html#aa7b948f290517a052f04f61dfa6af68f">SampleSummary::Outputfile</a></div><div class="ttdeci">TFile * Outputfile</div><div class="ttdoc">Output filename.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00286">SampleSummary.h:286</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_aae188cf135af004d5364e5b4f3b1bb31"><div class="ttname"><a href="classSampleSummary.html#aae188cf135af004d5364e5b4f3b1bb31">SampleSummary::lnLDrawHistRate</a></div><div class="ttdeci">std::unique_ptr&lt; TH2D &gt; lnLDrawHistRate</div><div class="ttdoc">The 2D lnLhist, showing (draw vs data) and (draw vs fluct), using rate, anything above y=x axis is th...</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00226">SampleSummary.h:226</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_aaf23ed9a699d625adc8639a57de801e8"><div class="ttname"><a href="classSampleSummary.html#aaf23ed9a699d625adc8639a57de801e8">SampleSummary::lnLHist_drawdata</a></div><div class="ttdeci">std::unique_ptr&lt; TH1D &gt; lnLHist_drawdata</div><div class="ttdoc">The lnLhist for the draw vs data.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00219">SampleSummary.h:219</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_ab16d22bf65d2a9c15072901161fc160a"><div class="ttname"><a href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">SampleSummary::nSamples</a></div><div class="ttdeci">int nSamples</div><div class="ttdoc">Number of samples.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00182">SampleSummary.h:182</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_abd938805245ca6cfeb8c49363f5ff11c"><div class="ttname"><a href="classSampleSummary.html#abd938805245ca6cfeb8c49363f5ff11c">SampleSummary::SamplePDF</a></div><div class="ttdeci">samplePDFBase * SamplePDF</div><div class="ttdoc">Pointer to samplePDF object, mostly used to get sample names, binning etc.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00367">SampleSummary.h:367</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_abeaca1195db794d9e660a377d81c1b21"><div class="ttname"><a href="classSampleSummary.html#abeaca1195db794d9e660a377d81c1b21">SampleSummary::DataHist_ProjectX</a></div><div class="ttdeci">std::vector&lt; TH1D * &gt; DataHist_ProjectX</div><div class="ttdoc">The data histogram for the selection X projection.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00200">SampleSummary.h:200</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_abfeb54f4d95b5b74257a1abf5c98824f"><div class="ttname"><a href="classSampleSummary.html#abfeb54f4d95b5b74257a1abf5c98824f">SampleSummary::DataHist_ProjectY</a></div><div class="ttdeci">std::vector&lt; TH1D * &gt; DataHist_ProjectY</div><div class="ttdoc">The data histogram for the selection Y projection.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00202">SampleSummary.h:202</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_adb737e335e68edeb14a6ce2ca112dc8c"><div class="ttname"><a href="classSampleSummary.html#adb737e335e68edeb14a6ce2ca112dc8c">SampleSummary::isPriorPredictive</a></div><div class="ttdeci">bool isPriorPredictive</div><div class="ttdoc">bool whether we have Prior or Posterior Predictive</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00269">SampleSummary.h:269</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_adf610d698a50c4930d95be320e99a8e8"><div class="ttname"><a href="classSampleSummary.html#adf610d698a50c4930d95be320e99a8e8">SampleSummary::DoBetaParam</a></div><div class="ttdeci">bool DoBetaParam</div><div class="ttdoc">Are we making Beta Histograms.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00263">SampleSummary.h:263</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_adf9b943ba381875b3f2e0c4807a9b8c4"><div class="ttname"><a href="classSampleSummary.html#adf9b943ba381875b3f2e0c4807a9b8c4">SampleSummary::W2ModeHist</a></div><div class="ttdeci">std::vector&lt; TH2Poly * &gt; W2ModeHist</div><div class="ttdoc">Pointer to the w2 histograms (for mode values).</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00210">SampleSummary.h:210</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_ae1aafef6414eafb5572893dded50a1b1"><div class="ttname"><a href="classSampleSummary.html#ae1aafef6414eafb5572893dded50a1b1">SampleSummary::lnLFlucHist</a></div><div class="ttdeci">std::unique_ptr&lt; TH2D &gt; lnLFlucHist</div><div class="ttdoc">The 2D lnLHist, showing (draw vs data) and (draw vs draw fluct), anything above y=x axis is the p-val...</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00223">SampleSummary.h:223</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_ae502645ddf5c53a7a3f2c52566956bf3"><div class="ttname"><a href="classSampleSummary.html#ae502645ddf5c53a7a3f2c52566956bf3">SampleSummary::StandardFluctuation</a></div><div class="ttdeci">bool StandardFluctuation</div><div class="ttdoc">KS: We have two methods for Poissonian fluctuation.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00167">SampleSummary.h:167</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_ae509f51ec2d0323e005e05c255bc0c1f"><div class="ttname"><a href="classSampleSummary.html#ae509f51ec2d0323e005e05c255bc0c1f">SampleSummary::lnLFlucHist_ProjectX</a></div><div class="ttdeci">std::unique_ptr&lt; TH2D &gt; lnLFlucHist_ProjectX</div><div class="ttdoc">The 2D lnLHist but for ProjectionX histogram (pmu), showing (draw vs data) and (draw vs draw fluct),...</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00228">SampleSummary.h:228</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_aead1702a4c1522e685a8af5a875f05ab"><div class="ttname"><a href="classSampleSummary.html#aead1702a4c1522e685a8af5a875f05ab">SampleSummary::lnLHist_drawfluc</a></div><div class="ttdeci">std::unique_ptr&lt; TH1D &gt; lnLHist_drawfluc</div><div class="ttdoc">The lnLhist for the draw vs MC fluctuated.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00215">SampleSummary.h:215</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_aebd01b201cf04608b251cd3e272878b7"><div class="ttname"><a href="classSampleSummary.html#aebd01b201cf04608b251cd3e272878b7">SampleSummary::doShapeOnly</a></div><div class="ttdeci">bool doShapeOnly</div><div class="ttdoc">bool whether to normalise each toy to have shape based p-value and pos pred distribution</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00272">SampleSummary.h:272</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_aecf1c224162e1055e8306d438e1a3761"><div class="ttname"><a href="classSampleSummary.html#aecf1c224162e1055e8306d438e1a3761">SampleSummary::lnLHist_Sample_PredflucDraw</a></div><div class="ttdeci">std::vector&lt; TH1D * &gt; lnLHist_Sample_PredflucDraw</div><div class="ttdoc">The histogram containing the lnL (draw vs pred fluct) for each throw for each sample.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00235">SampleSummary.h:235</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_af0edee6c71137e2a8150c7ba3e8fb6e0"><div class="ttname"><a href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">SampleSummary::MeanHist</a></div><div class="ttdeci">std::vector&lt; TH2Poly * &gt; MeanHist</div><div class="ttdoc">The posterior predictive distribution in pmu cosmu using the mean.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00246">SampleSummary.h:246</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_af4767862e5c1f4e3319d16b861213555"><div class="ttname"><a href="classSampleSummary.html#af4767862e5c1f4e3319d16b861213555">SampleSummary::nChainSteps</a></div><div class="ttdeci">unsigned int nChainSteps</div><div class="ttdoc">Number of throws by user.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00266">SampleSummary.h:266</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_af5a3139cef917abfddc36dbb8d4ac2fd"><div class="ttname"><a href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">SampleSummary::maxBins</a></div><div class="ttdeci">std::vector&lt; int &gt; maxBins</div><div class="ttdoc">Max Number of Bins per each sample.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00278">SampleSummary.h:278</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_afddd2abc0ec07b52dc9004880522ab5a"><div class="ttname"><a href="classSampleSummary.html#afddd2abc0ec07b52dc9004880522ab5a">SampleSummary::lnLHist_Sample_DrawflucDraw</a></div><div class="ttdeci">std::vector&lt; TH1D * &gt; lnLHist_Sample_DrawflucDraw</div><div class="ttdoc">The histogram containing the lnL (draw vs draw fluct) for each throw for each sample.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00233">SampleSummary.h:233</a></div></div>
<div class="ttc" id="aclasssamplePDFBase_html_a2c02e6a8107a0fd8b9deed6d98015ba3"><div class="ttname"><a href="classsamplePDFBase.html#a2c02e6a8107a0fd8b9deed6d98015ba3">samplePDFBase::GetKinVarLabel</a></div><div class="ttdeci">virtual std::string GetKinVarLabel(const int sample, const int Dimension)</div><div class="ttdef"><b>Definition:</b> <a href="samplePDFBase_8h_source.html#l00060">samplePDFBase.h:60</a></div></div>
<div class="ttc" id="aclasssamplePDFBase_html_ad7ab324d8b7ac73f92ef6a8d74b9dc72"><div class="ttname"><a href="classsamplePDFBase.html#ad7ab324d8b7ac73f92ef6a8d74b9dc72">samplePDFBase::GetMaCh3Modes</a></div><div class="ttdeci">MaCh3Modes * GetMaCh3Modes() const</div><div class="ttdoc">Return pointer to MaCh3 modes.</div><div class="ttdef"><b>Definition:</b> <a href="samplePDFBase_8h_source.html#l00034">samplePDFBase.h:34</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0ff4ad11cdada6c57e9e525decdfc6a6" name="a0ff4ad11cdada6c57e9e525decdfc6a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ff4ad11cdada6c57e9e525decdfc6a6">&#9670;&#160;</a></span>~SampleSummary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SampleSummary::~SampleSummary </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l00164">164</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  164</span>                              {</div>
<div class="line"><span class="lineno">  165</span><span class="comment">// *******************</span></div>
<div class="line"><span class="lineno">  166</span>  <a class="code hl_variable" href="classSampleSummary.html#aa7b948f290517a052f04f61dfa6af68f">Outputfile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>  <span class="comment">//ROOT is weird and once you write TFile claim ownership of histograms. Best is to first delete histograms and then close file</span></div>
<div class="line"><span class="lineno">  169</span>  <a class="code hl_variable" href="classSampleSummary.html#aa7b948f290517a052f04f61dfa6af68f">Outputfile</a>-&gt;Close();</div>
<div class="line"><span class="lineno">  170</span>  <span class="keyword">delete</span> <a class="code hl_variable" href="classSampleSummary.html#aa7b948f290517a052f04f61dfa6af68f">Outputfile</a>;</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#a795ac96bf6958c8a2f38c9de23c3c081">DoByModePlots</a>)</div>
<div class="line"><span class="lineno">  173</span>  {</div>
<div class="line"><span class="lineno">  174</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++i)</div>
<div class="line"><span class="lineno">  175</span>    {</div>
<div class="line"><span class="lineno">  176</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i] == <span class="keyword">nullptr</span>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  177</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1; j++)</div>
<div class="line"><span class="lineno">  178</span>      {</div>
<div class="line"><span class="lineno">  179</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt;= <a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[i]; ++k)</div>
<div class="line"><span class="lineno">  180</span>        {</div>
<div class="line"><span class="lineno">  181</span>          <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#aa6cfe4fb92b67f08b0d94f0fe1d8a3a2">PosteriorHist_ByMode</a>[i][j][k] != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classSampleSummary.html#aa6cfe4fb92b67f08b0d94f0fe1d8a3a2">PosteriorHist_ByMode</a>[i][j][k];</div>
<div class="line"><span class="lineno">  182</span>        }</div>
<div class="line"><span class="lineno">  183</span>        <span class="keyword">delete</span>[] <a class="code hl_variable" href="classSampleSummary.html#aa6cfe4fb92b67f08b0d94f0fe1d8a3a2">PosteriorHist_ByMode</a>[i][j];</div>
<div class="line"><span class="lineno">  184</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#a20237446a72eda2dc833bfc72c7e42e1">MeanHist_ByMode</a>[i][j] != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classSampleSummary.html#a20237446a72eda2dc833bfc72c7e42e1">MeanHist_ByMode</a>[i][j];</div>
<div class="line"><span class="lineno">  185</span>      }</div>
<div class="line"><span class="lineno">  186</span>      <span class="keyword">delete</span>[] <a class="code hl_variable" href="classSampleSummary.html#aa6cfe4fb92b67f08b0d94f0fe1d8a3a2">PosteriorHist_ByMode</a>[i];</div>
<div class="line"><span class="lineno">  187</span>      <span class="keyword">delete</span>[] <a class="code hl_variable" href="classSampleSummary.html#a20237446a72eda2dc833bfc72c7e42e1">MeanHist_ByMode</a>[i];</div>
<div class="line"><span class="lineno">  188</span>    }</div>
<div class="line"><span class="lineno">  189</span>    <span class="keyword">delete</span>[] <a class="code hl_variable" href="classSampleSummary.html#aa6cfe4fb92b67f08b0d94f0fe1d8a3a2">PosteriorHist_ByMode</a>;</div>
<div class="line"><span class="lineno">  190</span>    <span class="keyword">delete</span>[] <a class="code hl_variable" href="classSampleSummary.html#a20237446a72eda2dc833bfc72c7e42e1">MeanHist_ByMode</a>;</div>
<div class="line"><span class="lineno">  191</span>  }</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++i)</div>
<div class="line"><span class="lineno">  194</span>  {</div>
<div class="line"><span class="lineno">  195</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i] == <span class="keyword">nullptr</span>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  196</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i] != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i];</div>
<div class="line"><span class="lineno">  197</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i] != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i];</div>
<div class="line"><span class="lineno">  198</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[i] != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[i];</div>
<div class="line"><span class="lineno">  199</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#a9b21ff74bb8ebd7c3af2c24e02f3d7dc">ModeHist</a>[i] != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classSampleSummary.html#a9b21ff74bb8ebd7c3af2c24e02f3d7dc">ModeHist</a>[i];</div>
<div class="line"><span class="lineno">  200</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#adf610d698a50c4930d95be320e99a8e8">DoBetaParam</a> &amp;&amp; <a class="code hl_variable" href="classSampleSummary.html#a6191a0fc1c8f1f0889b3dedcc5485a3d">MeanHistCorrected</a>[i] != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classSampleSummary.html#a6191a0fc1c8f1f0889b3dedcc5485a3d">MeanHistCorrected</a>[i];</div>
<div class="line"><span class="lineno">  201</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">W2MeanHist</a>[i] != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">W2MeanHist</a>[i];</div>
<div class="line"><span class="lineno">  202</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#adf9b943ba381875b3f2e0c4807a9b8c4">W2ModeHist</a>[i] != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classSampleSummary.html#adf9b943ba381875b3f2e0c4807a9b8c4">W2ModeHist</a>[i];</div>
<div class="line"><span class="lineno">  203</span>    </div>
<div class="line"><span class="lineno">  204</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#a4a93fa8d52abe2828a4a25e49cf6fee8">ViolinHists_ProjectX</a>[i] != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classSampleSummary.html#a4a93fa8d52abe2828a4a25e49cf6fee8">ViolinHists_ProjectX</a>[i];</div>
<div class="line"><span class="lineno">  205</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#a93714cf9b778fa7713a641da0cd2d534">ViolinHists_ProjectY</a>[i] != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classSampleSummary.html#a93714cf9b778fa7713a641da0cd2d534">ViolinHists_ProjectY</a>[i];</div>
<div class="line"><span class="lineno">  206</span>    </div>
<div class="line"><span class="lineno">  207</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#a154c9bd15825713c48154fab66190d39">lnLHist_Mean</a>[i] != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classSampleSummary.html#a154c9bd15825713c48154fab66190d39">lnLHist_Mean</a>[i];</div>
<div class="line"><span class="lineno">  208</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#a03bbc94ee26b66875becf22255a205d2">lnLHist_Mode</a>[i] != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classSampleSummary.html#a03bbc94ee26b66875becf22255a205d2">lnLHist_Mode</a>[i];</div>
<div class="line"><span class="lineno">  209</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#a7b1ba5b3b465f78019bb8c36ec5f56d7">lnLHist_Mean_ProjectX</a>[i] != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classSampleSummary.html#a7b1ba5b3b465f78019bb8c36ec5f56d7">lnLHist_Mean_ProjectX</a>[i];</div>
<div class="line"><span class="lineno">  210</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#a718c83e1952f948a5c063c2039a68a19">lnLHist_Mean1D</a>[i] != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classSampleSummary.html#a718c83e1952f948a5c063c2039a68a19">lnLHist_Mean1D</a>[i];</div>
<div class="line"><span class="lineno">  211</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#a424b53de4d9e896526667ddb565e4a6b">lnLHist_Mode1D</a>[i] != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classSampleSummary.html#a424b53de4d9e896526667ddb565e4a6b">lnLHist_Mode1D</a>[i];</div>
<div class="line"><span class="lineno">  212</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#aa61561a1e3594ac9250aaee26409245e">lnLHist_Sample_DrawData</a>[i] != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classSampleSummary.html#aa61561a1e3594ac9250aaee26409245e">lnLHist_Sample_DrawData</a>[i];</div>
<div class="line"><span class="lineno">  213</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#afddd2abc0ec07b52dc9004880522ab5a">lnLHist_Sample_DrawflucDraw</a>[i] != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classSampleSummary.html#afddd2abc0ec07b52dc9004880522ab5a">lnLHist_Sample_DrawflucDraw</a>[i];</div>
<div class="line"><span class="lineno">  214</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#aecf1c224162e1055e8306d438e1a3761">lnLHist_Sample_PredflucDraw</a>[i] != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classSampleSummary.html#aecf1c224162e1055e8306d438e1a3761">lnLHist_Sample_PredflucDraw</a>[i];</div>
<div class="line"><span class="lineno">  215</span>  }</div>
<div class="line"><span class="lineno">  216</span>}</div>
<div class="ttc" id="aclassMaCh3Modes_html_aaa508822590464a0ce36d2fed94e4d03"><div class="ttname"><a href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">MaCh3Modes::GetNModes</a></div><div class="ttdeci">int GetNModes()</div><div class="ttdoc">KS: Get number of modes, keep in mind actual number is +1 greater due to unknown category.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Modes_8h_source.html#l00044">MaCh3Modes.h:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a681bee322172bef35a64e86c23c415b6" name="a681bee322172bef35a64e86c23c415b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a681bee322172bef35a64e86c23c415b6">&#9670;&#160;</a></span>AddData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::AddData </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; TH2Poly * &gt; &amp;&#160;</td>
          <td class="paramname"><em>DataHist</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>KS: Add data histograms. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">DataHist</td><td>Histogram with data even rates for each sample </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l00236">236</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  236</span>                                                     {</div>
<div class="line"><span class="lineno">  237</span><span class="comment">// *******************</span></div>
<div class="line"><span class="lineno">  238</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> Length = int(Data.size());</div>
<div class="line"><span class="lineno">  239</span>  <span class="comment">// Check length of samples are OK</span></div>
<div class="line"><span class="lineno">  240</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="classSampleSummary.html#a8c5a4ed4db695ce5c5820d857c76b4ff">CheckSamples</a>(Length)) <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">  241</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Length; ++i) {</div>
<div class="line"><span class="lineno">  242</span>    <span class="keywordflow">if</span> (Data[i] == <span class="keyword">nullptr</span>) {</div>
<div class="line"><span class="lineno">  243</span>      <a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  244</span>      <a class="code hl_variable" href="classSampleSummary.html#abeaca1195db794d9e660a377d81c1b21">DataHist_ProjectX</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  245</span>      <a class="code hl_variable" href="classSampleSummary.html#abfeb54f4d95b5b74257a1abf5c98824f">DataHist_ProjectY</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  246</span>      <a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[i] = 0;</div>
<div class="line"><span class="lineno">  247</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  248</span>      std::string classname = std::string(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i]-&gt;Class_Name());</div>
<div class="line"><span class="lineno">  249</span>      <span class="keywordflow">if</span>(classname == <span class="stringliteral">&quot;TH2Poly&quot;</span>)</div>
<div class="line"><span class="lineno">  250</span>      {</div>
<div class="line"><span class="lineno">  251</span>        <a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i] = <span class="keyword">static_cast&lt;</span>TH2Poly*<span class="keyword">&gt;</span>(Data[i]-&gt;Clone());</div>
<div class="line"><span class="lineno">  252</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#aebd01b201cf04608b251cd3e272878b7">doShapeOnly</a>) <a class="code hl_function" href="classSampleSummary.html#acab977d5e63eaca5862c352fea8a01c2">NormaliseTH2Poly</a>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i]);</div>
<div class="line"><span class="lineno">  253</span>        <a class="code hl_variable" href="classSampleSummary.html#abeaca1195db794d9e660a377d81c1b21">DataHist_ProjectX</a>[i] = <a class="code hl_function" href="classSampleSummary.html#a685a8ef3180d4f6474328b5c806d8b74">ProjectPoly</a>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i], <span class="keyword">true</span>, i);</div>
<div class="line"><span class="lineno">  254</span>        <a class="code hl_variable" href="classSampleSummary.html#abfeb54f4d95b5b74257a1abf5c98824f">DataHist_ProjectY</a>[i] = <a class="code hl_function" href="classSampleSummary.html#a685a8ef3180d4f6474328b5c806d8b74">ProjectPoly</a>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i], <span class="keyword">false</span>, i);</div>
<div class="line"><span class="lineno">  255</span>        <a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[i] = <a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i]-&gt;GetNumberOfBins();</div>
<div class="line"><span class="lineno">  256</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  257</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Somehow sample {} doesn&#39;t use TH2Poly&quot;</span>, <a class="code hl_variable" href="classSampleSummary.html#abd938805245ca6cfeb8c49363f5ff11c">SamplePDF</a>-&gt;<a class="code hl_function" href="classsamplePDFBase.html#a35ced08988cee48ac111024c70a2c7c2">GetSampleName</a>(i));</div>
<div class="line"><span class="lineno">  258</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Right now I only support TH2Poly but I am ambitious piece of code and surely will have more support in the future&quot;</span>);</div>
<div class="line"><span class="lineno">  259</span>        <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">  260</span>      }</div>
<div class="line"><span class="lineno">  261</span>    }</div>
<div class="line"><span class="lineno">  262</span>  }</div>
<div class="line"><span class="lineno">  263</span>}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a61052119a625282d0ec6d4a97adf3ee2"><div class="ttname"><a href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a></div><div class="ttdeci">#define MACH3LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00018">MaCh3Logger.h:18</a></div></div>
<div class="ttc" id="aclassMaCh3Exception_html"><div class="ttname"><a href="classMaCh3Exception.html">MaCh3Exception</a></div><div class="ttdoc">Custom exception class for MaCh3 errors.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Exception_8h_source.html#l00012">MaCh3Exception.h:12</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a685a8ef3180d4f6474328b5c806d8b74"><div class="ttname"><a href="classSampleSummary.html#a685a8ef3180d4f6474328b5c806d8b74">SampleSummary::ProjectPoly</a></div><div class="ttdeci">TH1D * ProjectPoly(TH2Poly *Histogram, const bool ProjectX, const int selection, const bool MakeErrorHist=false)</div><div class="ttdoc">Helper to project TH2Poly onto axis.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8cpp_source.html#l02264">SampleSummary.cpp:2264</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a8c5a4ed4db695ce5c5820d857c76b4ff"><div class="ttname"><a href="classSampleSummary.html#a8c5a4ed4db695ce5c5820d857c76b4ff">SampleSummary::CheckSamples</a></div><div class="ttdeci">bool CheckSamples(const int Length)</div><div class="ttdoc">Check the length of samples agrees.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8cpp_source.html#l00220">SampleSummary.cpp:220</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_acab977d5e63eaca5862c352fea8a01c2"><div class="ttname"><a href="classSampleSummary.html#acab977d5e63eaca5862c352fea8a01c2">SampleSummary::NormaliseTH2Poly</a></div><div class="ttdeci">void NormaliseTH2Poly(TH2Poly *Histogram)</div><div class="ttdoc">Helper to Normalise histograms.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8cpp_source.html#l01651">SampleSummary.cpp:1651</a></div></div>
<div class="ttc" id="aclasssamplePDFBase_html_a35ced08988cee48ac111024c70a2c7c2"><div class="ttname"><a href="classsamplePDFBase.html#a35ced08988cee48ac111024c70a2c7c2">samplePDFBase::GetSampleName</a></div><div class="ttdeci">virtual std::string GetSampleName(int Sample)</div><div class="ttdef"><b>Definition:</b> <a href="samplePDFBase_8cpp_source.html#l00255">samplePDFBase.cpp:255</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8c870b718bccf37fc7f91b5201345f8e" name="a8c870b718bccf37fc7f91b5201345f8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c870b718bccf37fc7f91b5201345f8e">&#9670;&#160;</a></span>AddNominal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::AddNominal </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; TH2Poly * &gt; &amp;&#160;</td>
          <td class="paramname"><em>NominalHist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; TH2Poly * &gt; &amp;&#160;</td>
          <td class="paramname"><em>W2Nom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>KS: Add prior histograms. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l00267">267</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  267</span>                                                                                       {</div>
<div class="line"><span class="lineno">  268</span><span class="comment">// *******************</span></div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> Length = int(Nominal.size());</div>
<div class="line"><span class="lineno">  271</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="classSampleSummary.html#a8c5a4ed4db695ce5c5820d857c76b4ff">CheckSamples</a>(Length)) <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">  272</span>  </div>
<div class="line"><span class="lineno">  273</span>  <span class="comment">//KS: ROOT is super annoying and you cannot use clone with openMP, hence we have another loop below</span></div>
<div class="line"><span class="lineno">  274</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Length; ++i) </div>
<div class="line"><span class="lineno">  275</span>  {</div>
<div class="line"><span class="lineno">  276</span>    <span class="keywordflow">if</span> (Nominal[i] == <span class="keyword">nullptr</span>) {</div>
<div class="line"><span class="lineno">  277</span>      <a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  278</span>      <a class="code hl_variable" href="classSampleSummary.html#a9c37d8669c0f55f6a4620b4f0d7b6e20">W2NomHist</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  279</span>      <a class="code hl_variable" href="classSampleSummary.html#a154c9bd15825713c48154fab66190d39">lnLHist_Mean</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  280</span>      <a class="code hl_variable" href="classSampleSummary.html#a03bbc94ee26b66875becf22255a205d2">lnLHist_Mode</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  281</span>      <a class="code hl_variable" href="classSampleSummary.html#a7b1ba5b3b465f78019bb8c36ec5f56d7">lnLHist_Mean_ProjectX</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  282</span>      <a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  283</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#adf610d698a50c4930d95be320e99a8e8">DoBetaParam</a>) <a class="code hl_variable" href="classSampleSummary.html#a6191a0fc1c8f1f0889b3dedcc5485a3d">MeanHistCorrected</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  284</span>      <a class="code hl_variable" href="classSampleSummary.html#a9b21ff74bb8ebd7c3af2c24e02f3d7dc">ModeHist</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  285</span>      <a class="code hl_variable" href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">W2MeanHist</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  286</span>      <a class="code hl_variable" href="classSampleSummary.html#adf9b943ba381875b3f2e0c4807a9b8c4">W2ModeHist</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  287</span>      <a class="code hl_variable" href="classSampleSummary.html#aa61561a1e3594ac9250aaee26409245e">lnLHist_Sample_DrawData</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  288</span>      <a class="code hl_variable" href="classSampleSummary.html#afddd2abc0ec07b52dc9004880522ab5a">lnLHist_Sample_DrawflucDraw</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  289</span>      <a class="code hl_variable" href="classSampleSummary.html#aecf1c224162e1055e8306d438e1a3761">lnLHist_Sample_PredflucDraw</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  290</span>    <span class="comment">// If not nullptr it indicates the selection was turned on, so initialise the privates</span></div>
<div class="line"><span class="lineno">  291</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  292</span>      <a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i] = <span class="keyword">static_cast&lt;</span>TH2Poly*<span class="keyword">&gt;</span>(Nominal[i]-&gt;Clone());</div>
<div class="line"><span class="lineno">  293</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#aebd01b201cf04608b251cd3e272878b7">doShapeOnly</a>) <a class="code hl_function" href="classSampleSummary.html#acab977d5e63eaca5862c352fea8a01c2">NormaliseTH2Poly</a>(<a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i]);</div>
<div class="line"><span class="lineno">  294</span>      <a class="code hl_variable" href="classSampleSummary.html#a9c37d8669c0f55f6a4620b4f0d7b6e20">W2NomHist</a>[i] = <span class="keyword">static_cast&lt;</span>TH2Poly*<span class="keyword">&gt;</span>(NomW2[i]-&gt;Clone());</div>
<div class="line"><span class="lineno">  295</span>      </div>
<div class="line"><span class="lineno">  296</span>      <a class="code hl_variable" href="classSampleSummary.html#a154c9bd15825713c48154fab66190d39">lnLHist_Mean</a>[i] = <span class="keyword">static_cast&lt;</span>TH2Poly*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i]-&gt;Clone());</div>
<div class="line"><span class="lineno">  297</span>      <a class="code hl_variable" href="classSampleSummary.html#a154c9bd15825713c48154fab66190d39">lnLHist_Mean</a>[i]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  298</span>      <a class="code hl_variable" href="classSampleSummary.html#a03bbc94ee26b66875becf22255a205d2">lnLHist_Mode</a>[i] = <span class="keyword">static_cast&lt;</span>TH2Poly*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i]-&gt;Clone());</div>
<div class="line"><span class="lineno">  299</span>      <a class="code hl_variable" href="classSampleSummary.html#a03bbc94ee26b66875becf22255a205d2">lnLHist_Mode</a>[i]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  300</span>      <a class="code hl_variable" href="classSampleSummary.html#a7b1ba5b3b465f78019bb8c36ec5f56d7">lnLHist_Mean_ProjectX</a>[i] = <span class="keyword">static_cast&lt;</span>TH1D*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classSampleSummary.html#abeaca1195db794d9e660a377d81c1b21">DataHist_ProjectX</a>[i]-&gt;Clone());</div>
<div class="line"><span class="lineno">  301</span>      <a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[i] = <span class="keyword">static_cast&lt;</span>TH2Poly*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i]-&gt;Clone());</div>
<div class="line"><span class="lineno">  302</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#adf610d698a50c4930d95be320e99a8e8">DoBetaParam</a>) <a class="code hl_variable" href="classSampleSummary.html#a6191a0fc1c8f1f0889b3dedcc5485a3d">MeanHistCorrected</a>[i] = <span class="keyword">static_cast&lt;</span>TH2Poly*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i]-&gt;Clone());</div>
<div class="line"><span class="lineno">  303</span>      <a class="code hl_variable" href="classSampleSummary.html#a9b21ff74bb8ebd7c3af2c24e02f3d7dc">ModeHist</a>[i] = <span class="keyword">static_cast&lt;</span>TH2Poly*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i]-&gt;Clone());</div>
<div class="line"><span class="lineno">  304</span>      <a class="code hl_variable" href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">W2MeanHist</a>[i] = <span class="keyword">static_cast&lt;</span>TH2Poly*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i]-&gt;Clone());</div>
<div class="line"><span class="lineno">  305</span>      <a class="code hl_variable" href="classSampleSummary.html#adf9b943ba381875b3f2e0c4807a9b8c4">W2ModeHist</a>[i] = <span class="keyword">static_cast&lt;</span>TH2Poly*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i]-&gt;Clone());</div>
<div class="line"><span class="lineno">  306</span>    }</div>
<div class="line"><span class="lineno">  307</span>  }</div>
<div class="line"><span class="lineno">  308</span>  </div>
<div class="line"><span class="lineno">  309</span>  <span class="comment">// Loop over the length of nominal and set the initial distributions up</span></div>
<div class="line"><span class="lineno">  310</span>  <span class="comment">//KS: Don&#39;t multithread, mostly due to fact that we initialise histograms</span></div>
<div class="line"><span class="lineno">  311</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Length; ++i) {</div>
<div class="line"><span class="lineno">  312</span>  <span class="comment">// If NULL it indicates the selection was turned off, so initialise all the hists to NULL</span></div>
<div class="line"><span class="lineno">  313</span>    <span class="keywordflow">if</span> (Nominal[i] != <span class="keyword">nullptr</span>)</div>
<div class="line"><span class="lineno">  314</span>    {</div>
<div class="line"><span class="lineno">  315</span>      std::string name = std::string(<a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i]-&gt;GetName());</div>
<div class="line"><span class="lineno">  316</span>      name = name.substr(0, name.find(<span class="stringliteral">&quot;_nom&quot;</span>));</div>
<div class="line"><span class="lineno">  317</span> </div>
<div class="line"><span class="lineno">  318</span>      <a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[i].resize(<a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[i]+1);</div>
<div class="line"><span class="lineno">  319</span>      <a class="code hl_variable" href="classSampleSummary.html#aa6773885be1b6a2660493718823a2f3f">w2Hist</a>[i].resize(<a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[i]+1);</div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#adf610d698a50c4930d95be320e99a8e8">DoBetaParam</a>) <a class="code hl_variable" href="classSampleSummary.html#a479f46f89c0c752c3e3e147d5b04b458">BetaHist</a>[i].resize(<a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[i]+1);</div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= <a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[i]; ++j)</div>
<div class="line"><span class="lineno">  324</span>      {</div>
<div class="line"><span class="lineno">  325</span>        <a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[i][j] = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  326</span>      }</div>
<div class="line"><span class="lineno">  327</span>      <a class="code hl_variable" href="classSampleSummary.html#a154c9bd15825713c48154fab66190d39">lnLHist_Mean</a>[i]-&gt;SetNameTitle((name+<span class="stringliteral">&quot;_MeanlnL&quot;</span>).c_str(), (name+<span class="stringliteral">&quot;_MeanlnL&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  328</span>      <a class="code hl_variable" href="classSampleSummary.html#a154c9bd15825713c48154fab66190d39">lnLHist_Mean</a>[i]-&gt;Reset(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  329</span>      <a class="code hl_variable" href="classSampleSummary.html#a154c9bd15825713c48154fab66190d39">lnLHist_Mean</a>[i]-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;-2lnL_{sample} #times sign(MC-data)&quot;</span>);</div>
<div class="line"><span class="lineno">  330</span>      </div>
<div class="line"><span class="lineno">  331</span>      <a class="code hl_variable" href="classSampleSummary.html#a03bbc94ee26b66875becf22255a205d2">lnLHist_Mode</a>[i]-&gt;SetNameTitle((name+<span class="stringliteral">&quot;_ModelnL&quot;</span>).c_str(), (name+<span class="stringliteral">&quot;_ModelnL&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  332</span>      <a class="code hl_variable" href="classSampleSummary.html#a03bbc94ee26b66875becf22255a205d2">lnLHist_Mode</a>[i]-&gt;Reset(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  333</span>      <a class="code hl_variable" href="classSampleSummary.html#a03bbc94ee26b66875becf22255a205d2">lnLHist_Mode</a>[i]-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;-2lnL_{sample} #times sign(MC-data)&quot;</span>);</div>
<div class="line"><span class="lineno">  334</span> </div>
<div class="line"><span class="lineno">  335</span>      <a class="code hl_variable" href="classSampleSummary.html#a7b1ba5b3b465f78019bb8c36ec5f56d7">lnLHist_Mean_ProjectX</a>[i]-&gt;SetNameTitle((name+<span class="stringliteral">&quot;_MeanlnL_ProjectX&quot;</span>).c_str(), (name+<span class="stringliteral">&quot;_MeanlnL_ProjectX&quot;</span>).c_str()); </div>
<div class="line"><span class="lineno">  336</span>      <a class="code hl_variable" href="classSampleSummary.html#a7b1ba5b3b465f78019bb8c36ec5f56d7">lnLHist_Mean_ProjectX</a>[i]-&gt;Reset(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  337</span>      <a class="code hl_variable" href="classSampleSummary.html#a7b1ba5b3b465f78019bb8c36ec5f56d7">lnLHist_Mean_ProjectX</a>[i]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;-2lnL_{sample} #times sign(MC-data)&quot;</span>);</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>      <a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[i]-&gt;SetNameTitle((name+<span class="stringliteral">&quot;_mean&quot;</span>).c_str(), (name+<span class="stringliteral">&quot;_mean&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  340</span>      <a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[i]-&gt;Reset(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  341</span>      <a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[i]-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Mean&quot;</span>);</div>
<div class="line"><span class="lineno">  342</span>      </div>
<div class="line"><span class="lineno">  343</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#adf610d698a50c4930d95be320e99a8e8">DoBetaParam</a>)</div>
<div class="line"><span class="lineno">  344</span>      {</div>
<div class="line"><span class="lineno">  345</span>        <a class="code hl_variable" href="classSampleSummary.html#a6191a0fc1c8f1f0889b3dedcc5485a3d">MeanHistCorrected</a>[i]-&gt;SetNameTitle((name+<span class="stringliteral">&quot;_mean_corrected&quot;</span>).c_str(), (name+<span class="stringliteral">&quot;_mean_corrected&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  346</span>        <a class="code hl_variable" href="classSampleSummary.html#a6191a0fc1c8f1f0889b3dedcc5485a3d">MeanHistCorrected</a>[i]-&gt;Reset(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  347</span>        <a class="code hl_variable" href="classSampleSummary.html#a6191a0fc1c8f1f0889b3dedcc5485a3d">MeanHistCorrected</a>[i]-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Mean&quot;</span>);</div>
<div class="line"><span class="lineno">  348</span>      }</div>
<div class="line"><span class="lineno">  349</span>      std::vector&lt;double&gt; xbins;</div>
<div class="line"><span class="lineno">  350</span>      std::vector&lt;double&gt; ybins;</div>
<div class="line"><span class="lineno">  351</span> </div>
<div class="line"><span class="lineno">  352</span>      <a class="code hl_variable" href="classSampleSummary.html#abd938805245ca6cfeb8c49363f5ff11c">SamplePDF</a>-&gt;<a class="code hl_function" href="classsamplePDFBase.html#aa3ac45cabba791d5ea5baabcc277384b">SetupBinning</a>(<a class="code hl_typedef" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a>(i), xbins, ybins);</div>
<div class="line"><span class="lineno">  353</span>      </div>
<div class="line"><span class="lineno">  354</span>      <span class="comment">//KS: Y axis is number of events to get estimate of maximal number we use integral</span></div>
<div class="line"><span class="lineno">  355</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> MaxBinning = <a class="code hl_variable" href="classSampleSummary.html#aebd01b201cf04608b251cd3e272878b7">doShapeOnly</a> ? 1 : int(<a class="code hl_function" href="Structs_8cpp.html#ab18c6b2408d7b9021bad06d47a06ee8d">NoOverflowIntegral</a>(<a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i])/4);</div>
<div class="line"><span class="lineno">  356</span>      <a class="code hl_variable" href="classSampleSummary.html#a4a93fa8d52abe2828a4a25e49cf6fee8">ViolinHists_ProjectX</a>[i] = <span class="keyword">new</span> TH2D((name+<span class="stringliteral">&quot;_Violin_ProjectX&quot;</span>).c_str(), (name+<span class="stringliteral">&quot;_Violin_ProjectX&quot;</span>).c_str(), <span class="keywordtype">int</span>(xbins.size()-1), &amp;xbins[0] , 400, 0, MaxBinning);</div>
<div class="line"><span class="lineno">  357</span>      <a class="code hl_variable" href="classSampleSummary.html#a4a93fa8d52abe2828a4a25e49cf6fee8">ViolinHists_ProjectX</a>[i]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Events&quot;</span>);</div>
<div class="line"><span class="lineno">  358</span>      <a class="code hl_variable" href="classSampleSummary.html#a4a93fa8d52abe2828a4a25e49cf6fee8">ViolinHists_ProjectX</a>[i]-&gt;GetXaxis()-&gt;SetTitle(std::string(<a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i]-&gt;GetXaxis()-&gt;GetTitle()).c_str() );</div>
<div class="line"><span class="lineno">  359</span>      <a class="code hl_variable" href="classSampleSummary.html#a4a93fa8d52abe2828a4a25e49cf6fee8">ViolinHists_ProjectX</a>[i]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span>      <a class="code hl_variable" href="classSampleSummary.html#a93714cf9b778fa7713a641da0cd2d534">ViolinHists_ProjectY</a>[i] = <span class="keyword">new</span> TH2D((name+<span class="stringliteral">&quot;_Violin_ProjectY&quot;</span>).c_str(), (name+<span class="stringliteral">&quot;_Violin_ProjectY&quot;</span>).c_str(), <span class="keywordtype">int</span>(ybins.size()-1), &amp;ybins[0] , 400, 0, MaxBinning);</div>
<div class="line"><span class="lineno">  362</span>      <a class="code hl_variable" href="classSampleSummary.html#a93714cf9b778fa7713a641da0cd2d534">ViolinHists_ProjectY</a>[i]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Events&quot;</span>);</div>
<div class="line"><span class="lineno">  363</span>      <a class="code hl_variable" href="classSampleSummary.html#a93714cf9b778fa7713a641da0cd2d534">ViolinHists_ProjectY</a>[i]-&gt;GetXaxis()-&gt;SetTitle(std::string(<a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i]-&gt;GetYaxis()-&gt;GetTitle()).c_str());</div>
<div class="line"><span class="lineno">  364</span>      <a class="code hl_variable" href="classSampleSummary.html#a93714cf9b778fa7713a641da0cd2d534">ViolinHists_ProjectY</a>[i]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>      <a class="code hl_variable" href="classSampleSummary.html#a9b21ff74bb8ebd7c3af2c24e02f3d7dc">ModeHist</a>[i]-&gt;SetNameTitle((name+<span class="stringliteral">&quot;_mode&quot;</span>).c_str(), (name+<span class="stringliteral">&quot;_mode&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  367</span>      <a class="code hl_variable" href="classSampleSummary.html#a9b21ff74bb8ebd7c3af2c24e02f3d7dc">ModeHist</a>[i]-&gt;Reset(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  368</span>      <a class="code hl_variable" href="classSampleSummary.html#a9b21ff74bb8ebd7c3af2c24e02f3d7dc">ModeHist</a>[i]-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Mode&quot;</span>);</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>      <a class="code hl_variable" href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">W2MeanHist</a>[i]-&gt;SetNameTitle((name+<span class="stringliteral">&quot;_w2mean&quot;</span>).c_str(), (name+<span class="stringliteral">&quot;_w2mean&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  371</span>      <a class="code hl_variable" href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">W2MeanHist</a>[i]-&gt;Reset(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  372</span>      <a class="code hl_variable" href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">W2MeanHist</a>[i]-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;W2Mean&quot;</span>);</div>
<div class="line"><span class="lineno">  373</span> </div>
<div class="line"><span class="lineno">  374</span>      <a class="code hl_variable" href="classSampleSummary.html#adf9b943ba381875b3f2e0c4807a9b8c4">W2ModeHist</a>[i]-&gt;SetNameTitle((name+<span class="stringliteral">&quot;_w2mode&quot;</span>).c_str(), (name+<span class="stringliteral">&quot;_w2mode&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  375</span>      <a class="code hl_variable" href="classSampleSummary.html#adf9b943ba381875b3f2e0c4807a9b8c4">W2ModeHist</a>[i]-&gt;Reset(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  376</span>      <a class="code hl_variable" href="classSampleSummary.html#adf9b943ba381875b3f2e0c4807a9b8c4">W2ModeHist</a>[i]-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;W2Mode&quot;</span>);</div>
<div class="line"><span class="lineno">  377</span> </div>
<div class="line"><span class="lineno">  378</span>      <span class="comment">// Declare the lnL histograms</span></div>
<div class="line"><span class="lineno">  379</span>      <a class="code hl_variable" href="classSampleSummary.html#a718c83e1952f948a5c063c2039a68a19">lnLHist_Mean1D</a>[i] = <span class="keyword">new</span> TH1D((name+<span class="stringliteral">&quot;_MeanlnL1D&quot;</span>).c_str(),(name+<span class="stringliteral">&quot;_MeanlnL1D&quot;</span>).c_str(), 50, 1, -1);</div>
<div class="line"><span class="lineno">  380</span>      <a class="code hl_variable" href="classSampleSummary.html#a718c83e1952f948a5c063c2039a68a19">lnLHist_Mean1D</a>[i]-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;-2LLH (Data, Pred)&quot;</span>);</div>
<div class="line"><span class="lineno">  381</span>      <a class="code hl_variable" href="classSampleSummary.html#a718c83e1952f948a5c063c2039a68a19">lnLHist_Mean1D</a>[i]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Counts&quot;</span>);</div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span>      <a class="code hl_variable" href="classSampleSummary.html#a424b53de4d9e896526667ddb565e4a6b">lnLHist_Mode1D</a>[i] = <span class="keyword">new</span> TH1D((name+<span class="stringliteral">&quot;_ModelnL1D&quot;</span>).c_str(),(name+<span class="stringliteral">&quot;_ModelnL1D&quot;</span>).c_str(), 50, 1, -1);</div>
<div class="line"><span class="lineno">  384</span>      <a class="code hl_variable" href="classSampleSummary.html#a424b53de4d9e896526667ddb565e4a6b">lnLHist_Mode1D</a>[i]-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;-2LLH (Data, Pred)&quot;</span>);</div>
<div class="line"><span class="lineno">  385</span>      <a class="code hl_variable" href="classSampleSummary.html#a424b53de4d9e896526667ddb565e4a6b">lnLHist_Mode1D</a>[i]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Counts&quot;</span>);</div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span>      <a class="code hl_variable" href="classSampleSummary.html#aa61561a1e3594ac9250aaee26409245e">lnLHist_Sample_DrawData</a>[i] = <span class="keyword">new</span> TH1D((name+<span class="stringliteral">&quot;_lnLdrawdata&quot;</span>).c_str(),(name+<span class="stringliteral">&quot;_lnL&quot;</span>).c_str(), 100, 1, -1);</div>
<div class="line"><span class="lineno">  388</span>      <a class="code hl_variable" href="classSampleSummary.html#aa61561a1e3594ac9250aaee26409245e">lnLHist_Sample_DrawData</a>[i]-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;-2LLH (Data, Draw)&quot;</span>);</div>
<div class="line"><span class="lineno">  389</span>      <a class="code hl_variable" href="classSampleSummary.html#aa61561a1e3594ac9250aaee26409245e">lnLHist_Sample_DrawData</a>[i]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Counts&quot;</span>);</div>
<div class="line"><span class="lineno">  390</span>      </div>
<div class="line"><span class="lineno">  391</span>      <a class="code hl_variable" href="classSampleSummary.html#afddd2abc0ec07b52dc9004880522ab5a">lnLHist_Sample_DrawflucDraw</a>[i] = <span class="keyword">new</span> TH1D((name+<span class="stringliteral">&quot;_lnLdrawfluc&quot;</span>).c_str(),(name+<span class="stringliteral">&quot;_lnL&quot;</span>).c_str(), 100, 1, -1);</div>
<div class="line"><span class="lineno">  392</span>      <a class="code hl_variable" href="classSampleSummary.html#afddd2abc0ec07b52dc9004880522ab5a">lnLHist_Sample_DrawflucDraw</a>[i]-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;-2LLH (Draw Fluc, Draw)&quot;</span>);</div>
<div class="line"><span class="lineno">  393</span>      <a class="code hl_variable" href="classSampleSummary.html#afddd2abc0ec07b52dc9004880522ab5a">lnLHist_Sample_DrawflucDraw</a>[i]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Counts&quot;</span>);</div>
<div class="line"><span class="lineno">  394</span>      </div>
<div class="line"><span class="lineno">  395</span>      <a class="code hl_variable" href="classSampleSummary.html#aecf1c224162e1055e8306d438e1a3761">lnLHist_Sample_PredflucDraw</a>[i] = <span class="keyword">new</span> TH1D((name+<span class="stringliteral">&quot;_lnLpredfluc&quot;</span>).c_str(),(name+<span class="stringliteral">&quot;_lnL&quot;</span>).c_str(), 100, 1, -1);</div>
<div class="line"><span class="lineno">  396</span>      <a class="code hl_variable" href="classSampleSummary.html#aecf1c224162e1055e8306d438e1a3761">lnLHist_Sample_PredflucDraw</a>[i]-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;-2LLH (Pred Fluc, Draw)&quot;</span>);</div>
<div class="line"><span class="lineno">  397</span>      <a class="code hl_variable" href="classSampleSummary.html#aecf1c224162e1055e8306d438e1a3761">lnLHist_Sample_PredflucDraw</a>[i]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Counts&quot;</span>);</div>
<div class="line"><span class="lineno">  398</span>    }</div>
<div class="line"><span class="lineno">  399</span>  }</div>
<div class="line"><span class="lineno">  400</span>  <span class="comment">//KS: Separate loop for thread safe reasons</span></div>
<div class="line"><span class="lineno">  401</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Length; ++i)</div>
<div class="line"><span class="lineno">  402</span>  {</div>
<div class="line"><span class="lineno">  403</span>    <span class="comment">//KS: We copy histograms so delete original</span></div>
<div class="line"><span class="lineno">  404</span>    <span class="keyword">delete</span> Nominal[i];</div>
<div class="line"><span class="lineno">  405</span>    <span class="keyword">delete</span> NomW2[i];</div>
<div class="line"><span class="lineno">  406</span>  }</div>
<div class="line"><span class="lineno">  407</span>}</div>
<div class="ttc" id="aStructs_8cpp_html_ab18c6b2408d7b9021bad06d47a06ee8d"><div class="ttname"><a href="Structs_8cpp.html#ab18c6b2408d7b9021bad06d47a06ee8d">NoOverflowIntegral</a></div><div class="ttdeci">double NoOverflowIntegral(TH2Poly *poly)</div><div class="ttdoc">WP: Helper function for calculating binned Integral of TH2Poly i.e not including overflow.</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8cpp_source.html#l00165">Structs.cpp:165</a></div></div>
<div class="ttc" id="aclasssamplePDFBase_html_aa3ac45cabba791d5ea5baabcc277384b"><div class="ttname"><a href="classsamplePDFBase.html#aa3ac45cabba791d5ea5baabcc277384b">samplePDFBase::SetupBinning</a></div><div class="ttdeci">virtual void SetupBinning(const M3::int_t Selection, std::vector&lt; double &gt; &amp;BinningX, std::vector&lt; double &gt; &amp;BinningY)</div><div class="ttdef"><b>Definition:</b> <a href="samplePDFBase_8h_source.html#l00053">samplePDFBase.h:53</a></div></div>
<div class="ttc" id="anamespaceM3_html_adb59b8ecdc4e1b2d5d4c826a13aa7463"><div class="ttname"><a href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a></div><div class="ttdeci">int int_t</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8h_source.html#l00016">Structs.h:16</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a10d0df830c319f3d8b76d2c3b85b4215" name="a10d0df830c319f3d8b76d2c3b85b4215"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10d0df830c319f3d8b76d2c3b85b4215">&#9670;&#160;</a></span>AddThrow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::AddThrow </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; TH2Poly * &gt; &amp;&#160;</td>
          <td class="paramname"><em>MCHist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; TH2Poly * &gt; &amp;&#160;</td>
          <td class="paramname"><em>W2Hist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>LLHPenalty</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>Weight</em> = <code>1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>DrawNumber</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>KS: Add histograms with throws. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l00412">412</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  412</span>                                                                                                                                                              {</div>
<div class="line"><span class="lineno">  413</span><span class="comment">// *******************</span></div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span>  <a class="code hl_variable" href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">nThrows</a>++;</div>
<div class="line"><span class="lineno">  416</span>  <span class="comment">//KS: Only make sense for PosteriorPredictive</span></div>
<div class="line"><span class="lineno">  417</span>  <span class="keywordflow">if</span>( !<a class="code hl_variable" href="classSampleSummary.html#adb737e335e68edeb14a6ce2ca112dc8c">isPriorPredictive</a> )<a class="code hl_variable" href="classSampleSummary.html#a2ced5be9bc8ba79530464d53b9c23797">RandomHist</a>-&gt;Fill(DrawNumber);</div>
<div class="line"><span class="lineno">  418</span> </div>
<div class="line"><span class="lineno">  419</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a> = int(SampleVector.size());</div>
<div class="line"><span class="lineno">  420</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="classSampleSummary.html#a8c5a4ed4db695ce5c5820d857c76b4ff">CheckSamples</a>(<a class="code hl_variable" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>)) <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">  421</span> </div>
<div class="line"><span class="lineno">  422</span>  <span class="comment">// Push back the throw</span></div>
<div class="line"><span class="lineno">  423</span>  <a class="code hl_variable" href="classSampleSummary.html#a13177305e8fd4b97812b2ca563740bf2">MCVector</a>.push_back(SampleVector);</div>
<div class="line"><span class="lineno">  424</span>  <a class="code hl_variable" href="classSampleSummary.html#a068e2a5ad0c02aaa57a27d2b12e37810">LLHPenaltyVector</a>.push_back(LLHPenalty);</div>
<div class="line"><span class="lineno">  425</span>  <a class="code hl_variable" href="classSampleSummary.html#ad40a0514f4be18ef026ea41bd5965fa3">WeightVector</a>.push_back(Weight);</div>
<div class="line"><span class="lineno">  426</span>  <a class="code hl_variable" href="classSampleSummary.html#a263b7541545b8b0ba735e0a3ac2d31e7">W2MCVector</a>.push_back(W2Vec);</div>
<div class="line"><span class="lineno">  427</span> </div>
<div class="line"><span class="lineno">  428</span>  <span class="comment">// Initialise the posterior hist</span></div>
<div class="line"><span class="lineno">  429</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classSampleSummary.html#a4ade2ccb94981d4483f0b4e6e367b1a0">first_pass</a>)</div>
<div class="line"><span class="lineno">  430</span>  {</div>
<div class="line"><span class="lineno">  431</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> SampleNum = 0;  SampleNum &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++SampleNum)</div>
<div class="line"><span class="lineno">  432</span>    {</div>
<div class="line"><span class="lineno">  433</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> nXBins = 500;</div>
<div class="line"><span class="lineno">  434</span>      <span class="comment">//Initialise TH1D which corresponds to each bin in the sample&#39;s th2poly</span></div>
<div class="line"><span class="lineno">  435</span>      std::string name = std::string(SampleVector[SampleNum]-&gt;GetName());</div>
<div class="line"><span class="lineno">  436</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= <a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[SampleNum]; ++i)</div>
<div class="line"><span class="lineno">  437</span>      {</div>
<div class="line"><span class="lineno">  438</span>        <span class="comment">//Get PolyBin</span></div>
<div class="line"><span class="lineno">  439</span>        TH2PolyBin* bin = <span class="keyword">static_cast&lt;</span>TH2PolyBin*<span class="keyword">&gt;</span>(SampleVector[SampleNum]-&gt;GetBins()-&gt;At(i-1));</div>
<div class="line"><span class="lineno">  440</span> </div>
<div class="line"><span class="lineno">  441</span>        <span class="comment">// Just make a little fancy name</span></div>
<div class="line"><span class="lineno">  442</span>        std::stringstream ss2;</div>
<div class="line"><span class="lineno">  443</span>        ss2 &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;_&quot;</span>;</div>
<div class="line"><span class="lineno">  444</span>        ss2 &lt;&lt; <span class="stringliteral">&quot;p_{#mu} (&quot;</span> &lt;&lt; bin-&gt;GetXMin() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; bin-&gt;GetXMax() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><span class="lineno">  445</span>        ss2 &lt;&lt; <span class="stringliteral">&quot; cos#theta_{#mu} (&quot;</span> &lt;&lt; bin-&gt;GetYMin() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; bin-&gt;GetYMax() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><span class="lineno">  446</span> </div>
<div class="line"><span class="lineno">  447</span>        <a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[SampleNum][i] = std::make_unique&lt;TH1D&gt;(ss2.str().c_str(), ss2.str().c_str(),nXBins, 1, -1);</div>
<div class="line"><span class="lineno">  448</span>        <a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[SampleNum][i]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  449</span>        <a class="code hl_variable" href="classSampleSummary.html#aa6773885be1b6a2660493718823a2f3f">w2Hist</a>[SampleNum][i] = std::make_unique&lt;TH1D&gt;((<span class="stringliteral">&quot;w2_&quot;</span>+ss2.str()).c_str(), (<span class="stringliteral">&quot;w2_&quot;</span>+ss2.str()).c_str(),nXBins, 1, -1);</div>
<div class="line"><span class="lineno">  450</span>        <a class="code hl_variable" href="classSampleSummary.html#aa6773885be1b6a2660493718823a2f3f">w2Hist</a>[SampleNum][i]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  451</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#adf610d698a50c4930d95be320e99a8e8">DoBetaParam</a>)</div>
<div class="line"><span class="lineno">  452</span>        {</div>
<div class="line"><span class="lineno">  453</span>          std::string betaName = <span class="stringliteral">&quot;#beta_param_&quot;</span>;</div>
<div class="line"><span class="lineno">  454</span>          <a class="code hl_variable" href="classSampleSummary.html#a479f46f89c0c752c3e3e147d5b04b458">BetaHist</a>[SampleNum][i] = std::make_unique&lt;TH1D&gt;((betaName + ss2.str()).c_str(), (betaName + ss2.str()).c_str(), 70, 1, -1);</div>
<div class="line"><span class="lineno">  455</span>          <a class="code hl_variable" href="classSampleSummary.html#a479f46f89c0c752c3e3e147d5b04b458">BetaHist</a>[SampleNum][i]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  456</span>          <a class="code hl_variable" href="classSampleSummary.html#a479f46f89c0c752c3e3e147d5b04b458">BetaHist</a>[SampleNum][i]-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;#beta parameter value&quot;</span>);</div>
<div class="line"><span class="lineno">  457</span>          <a class="code hl_variable" href="classSampleSummary.html#a479f46f89c0c752c3e3e147d5b04b458">BetaHist</a>[SampleNum][i]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Counts&quot;</span>);</div>
<div class="line"><span class="lineno">  458</span>        }</div>
<div class="line"><span class="lineno">  459</span>      } <span class="comment">//end loop over bins</span></div>
<div class="line"><span class="lineno">  460</span>    }<span class="comment">//end loop over samples</span></div>
<div class="line"><span class="lineno">  461</span>  }</div>
<div class="line"><span class="lineno">  462</span>  <a class="code hl_variable" href="classSampleSummary.html#a4ade2ccb94981d4483f0b4e6e367b1a0">first_pass</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  463</span> </div>
<div class="line"><span class="lineno">  464</span>  <span class="comment">// Loop over the samples</span></div>
<div class="line"><span class="lineno">  465</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  466</span><span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><span class="lineno">  467</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  468</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> SampleNum = 0;  SampleNum &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++SampleNum)</div>
<div class="line"><span class="lineno">  469</span>  {</div>
<div class="line"><span class="lineno">  470</span>    <span class="keywordflow">if</span> (SampleVector[SampleNum] == <span class="keyword">nullptr</span>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  471</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#aebd01b201cf04608b251cd3e272878b7">doShapeOnly</a>) <a class="code hl_function" href="classSampleSummary.html#acab977d5e63eaca5862c352fea8a01c2">NormaliseTH2Poly</a>(SampleVector[SampleNum]);</div>
<div class="line"><span class="lineno">  472</span>    <span class="comment">// Loop over the distribution and fill the prior/posterior predictive</span></div>
<div class="line"><span class="lineno">  473</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= <a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[SampleNum]; ++i) {</div>
<div class="line"><span class="lineno">  474</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> Content = SampleVector[SampleNum]-&gt;GetBinContent(i);</div>
<div class="line"><span class="lineno">  475</span>      <a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[SampleNum][i]-&gt;Fill(Content, Weight);</div>
<div class="line"><span class="lineno">  476</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> w2 = W2Vec[SampleNum]-&gt;GetBinContent(i);</div>
<div class="line"><span class="lineno">  477</span>      <a class="code hl_variable" href="classSampleSummary.html#aa6773885be1b6a2660493718823a2f3f">w2Hist</a>[SampleNum][i]-&gt;Fill(w2, Weight);</div>
<div class="line"><span class="lineno">  478</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#adf610d698a50c4930d95be320e99a8e8">DoBetaParam</a>)</div>
<div class="line"><span class="lineno">  479</span>      {</div>
<div class="line"><span class="lineno">  480</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> data = <a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[SampleNum]-&gt;GetBinContent(i);</div>
<div class="line"><span class="lineno">  481</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> BetaParam = <a class="code hl_function" href="StatisticalUtils_8h.html#afecd84c56d6546271c4547192aae31af">GetBetaParameter</a>(data, Content, w2, <a class="code hl_variable" href="classSampleSummary.html#aafb18632bb987ae9a302d95781d5fdba">likelihood</a>);</div>
<div class="line"><span class="lineno">  482</span>        <a class="code hl_variable" href="classSampleSummary.html#a479f46f89c0c752c3e3e147d5b04b458">BetaHist</a>[SampleNum][i]-&gt;Fill(BetaParam, Weight);</div>
<div class="line"><span class="lineno">  483</span>      }</div>
<div class="line"><span class="lineno">  484</span>    } <span class="comment">// end bin loop</span></div>
<div class="line"><span class="lineno">  485</span>  } <span class="comment">// end samples loop</span></div>
<div class="line"><span class="lineno">  486</span>} <span class="comment">// end AddThrow</span></div>
<div class="ttc" id="aGetPenaltyTerm_8cpp_html_a439227feff9d7f55384e8780cfc2eb82"><div class="ttname"><a href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a></div><div class="ttdeci">int size</div><div class="ttdef"><b>Definition:</b> <a href="GetPenaltyTerm_8cpp_source.html#l00038">GetPenaltyTerm.cpp:38</a></div></div>
<div class="ttc" id="aStatisticalUtils_8h_html_afecd84c56d6546271c4547192aae31af"><div class="ttname"><a href="StatisticalUtils_8h.html#afecd84c56d6546271c4547192aae31af">GetBetaParameter</a></div><div class="ttdeci">double GetBetaParameter(const double data, const double mc, const double w2, TestStatistic TestStat)</div><div class="ttdoc">KS: Calculate Beta parameter which will be different based on specified test statistic.</div><div class="ttdef"><b>Definition:</b> <a href="StatisticalUtils_8h_source.html#l00192">StatisticalUtils.h:192</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a068e2a5ad0c02aaa57a27d2b12e37810"><div class="ttname"><a href="classSampleSummary.html#a068e2a5ad0c02aaa57a27d2b12e37810">SampleSummary::LLHPenaltyVector</a></div><div class="ttdeci">std::vector&lt; double &gt; LLHPenaltyVector</div><div class="ttdoc">Vector to hold the penalty term.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00177">SampleSummary.h:177</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a13177305e8fd4b97812b2ca563740bf2"><div class="ttname"><a href="classSampleSummary.html#a13177305e8fd4b97812b2ca563740bf2">SampleSummary::MCVector</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; TH2Poly * &gt; &gt; MCVector</div><div class="ttdoc">Vector of vectors which holds the loaded MC histograms.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00170">SampleSummary.h:170</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a263b7541545b8b0ba735e0a3ac2d31e7"><div class="ttname"><a href="classSampleSummary.html#a263b7541545b8b0ba735e0a3ac2d31e7">SampleSummary::W2MCVector</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; TH2Poly * &gt; &gt; W2MCVector</div><div class="ttdoc">Vector of vectors which holds the loaded W2 histograms.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00172">SampleSummary.h:172</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_aafb18632bb987ae9a302d95781d5fdba"><div class="ttname"><a href="classSampleSummary.html#aafb18632bb987ae9a302d95781d5fdba">SampleSummary::likelihood</a></div><div class="ttdeci">TestStatistic likelihood</div><div class="ttdoc">Type of likelihood for example Poisson, Barlow-Beeston or Ice Cube.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00373">SampleSummary.h:373</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_ad40a0514f4be18ef026ea41bd5965fa3"><div class="ttname"><a href="classSampleSummary.html#ad40a0514f4be18ef026ea41bd5965fa3">SampleSummary::WeightVector</a></div><div class="ttdeci">std::vector&lt; double &gt; WeightVector</div><div class="ttdoc">Vector holding weight.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00179">SampleSummary.h:179</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a00d7dbefac4ec95c256dfd2aa7e4e1a3" name="a00d7dbefac4ec95c256dfd2aa7e4e1a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00d7dbefac4ec95c256dfd2aa7e4e1a3">&#9670;&#160;</a></span>AddThrowByMode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::AddThrowByMode </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; TH2Poly * &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>SampleVector_ByMode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>KS: Add histograms for each mode. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l00491">491</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  491</span>                                                                                      {</div>
<div class="line"><span class="lineno">  492</span><span class="comment">// *******************</span></div>
<div class="line"><span class="lineno">  493</span> </div>
<div class="line"><span class="lineno">  494</span>  <a class="code hl_variable" href="classSampleSummary.html#ab3eeac18b62f7ee3a5c943c3cd0e9b76">MCVectorByMode</a>.push_back(SampleVector_ByMode);</div>
<div class="line"><span class="lineno">  495</span> </div>
<div class="line"><span class="lineno">  496</span>  <span class="comment">//KS: This means this is first time</span></div>
<div class="line"><span class="lineno">  497</span>  <span class="keywordflow">if</span>(!<a class="code hl_variable" href="classSampleSummary.html#a795ac96bf6958c8a2f38c9de23c3c081">DoByModePlots</a>)</div>
<div class="line"><span class="lineno">  498</span>  {</div>
<div class="line"><span class="lineno">  499</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Turning reaction breadkwon mode, brum brum&quot;</span>);</div>
<div class="line"><span class="lineno">  500</span>    <a class="code hl_variable" href="classSampleSummary.html#aa6cfe4fb92b67f08b0d94f0fe1d8a3a2">PosteriorHist_ByMode</a> = <span class="keyword">new</span> TH1D***[<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>];</div>
<div class="line"><span class="lineno">  501</span>    <a class="code hl_variable" href="classSampleSummary.html#a20237446a72eda2dc833bfc72c7e42e1">MeanHist_ByMode</a> = <span class="keyword">new</span> TH2Poly**[<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>];</div>
<div class="line"><span class="lineno">  502</span> </div>
<div class="line"><span class="lineno">  503</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> SampleNum = 0;  SampleNum &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; SampleNum++)</div>
<div class="line"><span class="lineno">  504</span>    {</div>
<div class="line"><span class="lineno">  505</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[SampleNum] == <span class="keyword">nullptr</span>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  506</span> </div>
<div class="line"><span class="lineno">  507</span>      <a class="code hl_variable" href="classSampleSummary.html#aa6cfe4fb92b67f08b0d94f0fe1d8a3a2">PosteriorHist_ByMode</a>[SampleNum] = <span class="keyword">new</span> TH1D**[<a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1];</div>
<div class="line"><span class="lineno">  508</span>      <a class="code hl_variable" href="classSampleSummary.html#a20237446a72eda2dc833bfc72c7e42e1">MeanHist_ByMode</a>[SampleNum] = <span class="keyword">new</span> TH2Poly*[<a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1];</div>
<div class="line"><span class="lineno">  509</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1; j++)</div>
<div class="line"><span class="lineno">  510</span>      {</div>
<div class="line"><span class="lineno">  511</span>        <a class="code hl_variable" href="classSampleSummary.html#aa6cfe4fb92b67f08b0d94f0fe1d8a3a2">PosteriorHist_ByMode</a>[SampleNum][j] = <span class="keyword">new</span> TH1D*[<a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[SampleNum]+1];</div>
<div class="line"><span class="lineno">  512</span>        <span class="keyword">constexpr</span> <span class="keywordtype">int</span> nXBins = 500;</div>
<div class="line"><span class="lineno">  513</span> </div>
<div class="line"><span class="lineno">  514</span>        std::string name = std::string(<a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[SampleNum]-&gt;GetName());</div>
<div class="line"><span class="lineno">  515</span>        name = name.substr(0, name.find(<span class="stringliteral">&quot;_nom&quot;</span>));</div>
<div class="line"><span class="lineno">  516</span>        name = name + <span class="stringliteral">&quot;_&quot;</span>+<a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#abf4ac35511787907bc16ae26aa6c2a15">GetMaCh3ModeName</a>(j);</div>
<div class="line"><span class="lineno">  517</span> </div>
<div class="line"><span class="lineno">  518</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= <a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[SampleNum]; i++)</div>
<div class="line"><span class="lineno">  519</span>        {</div>
<div class="line"><span class="lineno">  520</span>          <span class="comment">//Get PolyBin</span></div>
<div class="line"><span class="lineno">  521</span>          TH2PolyBin* bin = <span class="keyword">static_cast&lt;</span>TH2PolyBin*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[SampleNum]-&gt;GetBins()-&gt;At(i-1));</div>
<div class="line"><span class="lineno">  522</span> </div>
<div class="line"><span class="lineno">  523</span>          <span class="comment">// Just make a little fancy name</span></div>
<div class="line"><span class="lineno">  524</span>          std::stringstream ss2;</div>
<div class="line"><span class="lineno">  525</span>          ss2 &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;_&quot;</span>;</div>
<div class="line"><span class="lineno">  526</span>          ss2 &lt;&lt; <span class="stringliteral">&quot;p_{#mu} (&quot;</span> &lt;&lt; bin-&gt;GetXMin() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; bin-&gt;GetXMax() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><span class="lineno">  527</span>          ss2 &lt;&lt; <span class="stringliteral">&quot; cos#theta_{#mu} (&quot;</span> &lt;&lt; bin-&gt;GetYMin() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; bin-&gt;GetYMax() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><span class="lineno">  528</span> </div>
<div class="line"><span class="lineno">  529</span>          <span class="comment">//Initialise TH1D which corresponds to each bin in the sample&#39;s th2poly</span></div>
<div class="line"><span class="lineno">  530</span>          <a class="code hl_variable" href="classSampleSummary.html#aa6cfe4fb92b67f08b0d94f0fe1d8a3a2">PosteriorHist_ByMode</a>[SampleNum][j][i] = <span class="keyword">new</span> TH1D((name+ss2.str()).c_str(),(name+ss2.str()).c_str(),nXBins, 1, -1);</div>
<div class="line"><span class="lineno">  531</span>        }</div>
<div class="line"><span class="lineno">  532</span>        <a class="code hl_variable" href="classSampleSummary.html#a20237446a72eda2dc833bfc72c7e42e1">MeanHist_ByMode</a>[SampleNum][j] = <span class="keyword">static_cast&lt;</span>TH2Poly*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[SampleNum]-&gt;Clone());</div>
<div class="line"><span class="lineno">  533</span>        <a class="code hl_variable" href="classSampleSummary.html#a20237446a72eda2dc833bfc72c7e42e1">MeanHist_ByMode</a>[SampleNum][j]-&gt;SetNameTitle((name+<span class="stringliteral">&quot;_mean&quot;</span>).c_str(), (name+<span class="stringliteral">&quot;_mean&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  534</span>        <a class="code hl_variable" href="classSampleSummary.html#a20237446a72eda2dc833bfc72c7e42e1">MeanHist_ByMode</a>[SampleNum][j]-&gt;Reset(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  535</span>        <a class="code hl_variable" href="classSampleSummary.html#a20237446a72eda2dc833bfc72c7e42e1">MeanHist_ByMode</a>[SampleNum][j]-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Mean&quot;</span>);</div>
<div class="line"><span class="lineno">  536</span>      }</div>
<div class="line"><span class="lineno">  537</span>    }</div>
<div class="line"><span class="lineno">  538</span>  }</div>
<div class="line"><span class="lineno">  539</span>  <a class="code hl_variable" href="classSampleSummary.html#a795ac96bf6958c8a2f38c9de23c3c081">DoByModePlots</a> = <span class="keyword">true</span>;    </div>
<div class="line"><span class="lineno">  540</span>  <span class="comment">// Loop over the sameples</span></div>
<div class="line"><span class="lineno">  541</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  542</span><span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><span class="lineno">  543</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  544</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> SampleNum = 0;  SampleNum &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; SampleNum++)</div>
<div class="line"><span class="lineno">  545</span>  {</div>
<div class="line"><span class="lineno">  546</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[SampleNum] == <span class="keyword">nullptr</span>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  547</span>    </div>
<div class="line"><span class="lineno">  548</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1; j++)</div>
<div class="line"><span class="lineno">  549</span>    {</div>
<div class="line"><span class="lineno">  550</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#aebd01b201cf04608b251cd3e272878b7">doShapeOnly</a>) <a class="code hl_function" href="classSampleSummary.html#acab977d5e63eaca5862c352fea8a01c2">NormaliseTH2Poly</a>(SampleVector_ByMode[SampleNum][j]);</div>
<div class="line"><span class="lineno">  551</span>      <span class="comment">// Loop over the distribution and fill the prior/posterior predictive</span></div>
<div class="line"><span class="lineno">  552</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= <a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[SampleNum]; ++i)</div>
<div class="line"><span class="lineno">  553</span>      {</div>
<div class="line"><span class="lineno">  554</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> Content = SampleVector_ByMode[SampleNum][j]-&gt;GetBinContent(i);</div>
<div class="line"><span class="lineno">  555</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> Entries = int(<a class="code hl_variable" href="classSampleSummary.html#aa6cfe4fb92b67f08b0d94f0fe1d8a3a2">PosteriorHist_ByMode</a>[SampleNum][j][i]-&gt;GetEntries());</div>
<div class="line"><span class="lineno">  556</span>        <a class="code hl_variable" href="classSampleSummary.html#aa6cfe4fb92b67f08b0d94f0fe1d8a3a2">PosteriorHist_ByMode</a>[SampleNum][j][i]-&gt;Fill(Content, <a class="code hl_variable" href="classSampleSummary.html#ad40a0514f4be18ef026ea41bd5965fa3">WeightVector</a>[Entries]);</div>
<div class="line"><span class="lineno">  557</span>      }</div>
<div class="line"><span class="lineno">  558</span>    }</div>
<div class="line"><span class="lineno">  559</span>  }</div>
<div class="line"><span class="lineno">  560</span>} <span class="comment">// end AddThrowByMode</span></div>
<div class="ttc" id="aclassMaCh3Modes_html_abf4ac35511787907bc16ae26aa6c2a15"><div class="ttname"><a href="classMaCh3Modes.html#abf4ac35511787907bc16ae26aa6c2a15">MaCh3Modes::GetMaCh3ModeName</a></div><div class="ttdeci">std::string GetMaCh3ModeName(const int Index)</div><div class="ttdoc">KS: Get normal name of mode, if mode not known you will get UNKNOWN_BAD.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Modes_8cpp_source.html#l00124">MaCh3Modes.cpp:124</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_ab3eeac18b62f7ee3a5c943c3cd0e9b76"><div class="ttname"><a href="classSampleSummary.html#ab3eeac18b62f7ee3a5c943c3cd0e9b76">SampleSummary::MCVectorByMode</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; TH2Poly * &gt; &gt; &gt; MCVectorByMode</div><div class="ttdoc">Vector of vectors which holds the loaded MC histograms for each mode.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00174">SampleSummary.h:174</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5cd35f899a9f6dce138e6d99561aebdf" name="a5cd35f899a9f6dce138e6d99561aebdf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cd35f899a9f6dce138e6d99561aebdf">&#9670;&#160;</a></span>CalcLLH() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::CalcLLH </td>
          <td>(</td>
          <td class="paramtype">TH1D *const &amp;&#160;</td>
          <td class="paramname"><em>Data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1D *const &amp;&#160;</td>
          <td class="paramname"><em>MC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1D *const &amp;&#160;</td>
          <td class="paramname"><em>W2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper functions to calculate likelihoods using TH1D, will modify MC hist tittle to include LLH. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Data</td><td>histogram with data distribution for a single sample </td></tr>
    <tr><td class="paramname">MC</td><td>histogram with MC distribution for a single sample </td></tr>
    <tr><td class="paramname">W2</td><td>histogram with W2 distribution for a single sample </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l01662">1662</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1662</span>                                                                                                {</div>
<div class="line"><span class="lineno"> 1663</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 1664</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> llh = <a class="code hl_function" href="classSampleSummary.html#ad027b0716b707691e6a9565ee497b66f">GetLLH</a>(DatHist, MCHist, W2Hist);</div>
<div class="line"><span class="lineno"> 1665</span>  std::stringstream ss;</div>
<div class="line"><span class="lineno"> 1666</span>  ss &lt;&lt; <span class="stringliteral">&quot;_2LLH=&quot;</span> &lt;&lt; llh;</div>
<div class="line"><span class="lineno"> 1667</span>  MCHist-&gt;SetTitle((std::string(MCHist-&gt;GetTitle())+ss.str()).c_str());</div>
<div class="line"><span class="lineno"> 1668</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{:&lt;55} {:&lt;10.2f} {:&lt;10.2f} {:&lt;10.2f}&quot;</span>, MCHist-&gt;GetName(), DatHist-&gt;Integral(), MCHist-&gt;Integral(), llh);</div>
<div class="line"><span class="lineno"> 1669</span>}</div>
<div class="ttc" id="aclassSampleSummary_html_ad027b0716b707691e6a9565ee497b66f"><div class="ttname"><a href="classSampleSummary.html#ad027b0716b707691e6a9565ee497b66f">SampleSummary::GetLLH</a></div><div class="ttdeci">double GetLLH(TH2Poly *const &amp;Data, TH2Poly *const &amp;MC, TH2Poly *const &amp;W2)</div><div class="ttdoc">Helper functions to calculate likelihoods using TH2Poly.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8cpp_source.html#l01683">SampleSummary.cpp:1683</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a197d9d30abc14a76d65bd876b28cca32" name="a197d9d30abc14a76d65bd876b28cca32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a197d9d30abc14a76d65bd876b28cca32">&#9670;&#160;</a></span>CalcLLH() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::CalcLLH </td>
          <td>(</td>
          <td class="paramtype">TH2Poly *const &amp;&#160;</td>
          <td class="paramname"><em>Data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH2Poly *const &amp;&#160;</td>
          <td class="paramname"><em>MC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH2Poly *const &amp;&#160;</td>
          <td class="paramname"><em>W2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper functions to calculate likelihoods using TH2Poly, will modify MC hist tittle to include LLH. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Data</td><td>histogram with data distribution for a single sample </td></tr>
    <tr><td class="paramname">MC</td><td>histogram with MC distribution for a single sample </td></tr>
    <tr><td class="paramname">W2</td><td>histogram with W2 distribution for a single sample </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l01673">1673</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1673</span>                                                                                                         {</div>
<div class="line"><span class="lineno"> 1674</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 1675</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> llh = <a class="code hl_function" href="classSampleSummary.html#ad027b0716b707691e6a9565ee497b66f">GetLLH</a>(DatHist, MCHist, W2Hist);</div>
<div class="line"><span class="lineno"> 1676</span>  std::stringstream ss;</div>
<div class="line"><span class="lineno"> 1677</span>  ss &lt;&lt; <span class="stringliteral">&quot;_2LLH=&quot;</span> &lt;&lt; llh;</div>
<div class="line"><span class="lineno"> 1678</span>  MCHist-&gt;SetTitle((std::string(MCHist-&gt;GetTitle())+ss.str()).c_str());</div>
<div class="line"><span class="lineno"> 1679</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{:&lt;55} {:&lt;10.2f} {:&lt;10.2f} {:&lt;10.2f}&quot;</span>, MCHist-&gt;GetName(), <a class="code hl_function" href="Structs_8cpp.html#ab18c6b2408d7b9021bad06d47a06ee8d">NoOverflowIntegral</a>(DatHist), <a class="code hl_function" href="Structs_8cpp.html#ab18c6b2408d7b9021bad06d47a06ee8d">NoOverflowIntegral</a>(MCHist), llh);</div>
<div class="line"><span class="lineno"> 1680</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8c5a4ed4db695ce5c5820d857c76b4ff" name="a8c5a4ed4db695ce5c5820d857c76b4ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c5a4ed4db695ce5c5820d857c76b4ff">&#9670;&#160;</a></span>CheckSamples()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool SampleSummary::CheckSamples </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Length</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check the length of samples agrees. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l00220">220</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  220</span>                                           {</div>
<div class="line"><span class="lineno">  221</span><span class="comment">// *******************</span></div>
<div class="line"><span class="lineno">  222</span>  <span class="keywordtype">bool</span> ok = (<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a> == Length);</div>
<div class="line"><span class="lineno">  223</span>  <span class="keywordflow">if</span> (!ok) {</div>
<div class="line"><span class="lineno">  224</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Size of SampleVector input != number of defined samples&quot;</span>);</div>
<div class="line"><span class="lineno">  225</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Size of SampleVector:  {}&quot;</span>, Length);</div>
<div class="line"><span class="lineno">  226</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Size of defined samples:  {}&quot;</span>, <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">  227</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Something has gone wrong with making the Samples&quot;</span>);</div>
<div class="line"><span class="lineno">  228</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">  229</span>  }</div>
<div class="line"><span class="lineno">  230</span>  <span class="keywordflow">return</span> ok;</div>
<div class="line"><span class="lineno">  231</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a90fbcfacacf629b0b5f0de3fdab3fdfd" name="a90fbcfacacf629b0b5f0de3fdab3fdfd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90fbcfacacf629b0b5f0de3fdab3fdfd">&#9670;&#160;</a></span>FastViolinFill()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::FastViolinFill </td>
          <td>(</td>
          <td class="paramtype">TH2D *&#160;</td>
          <td class="paramname"><em>violin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1D *&#160;</td>
          <td class="paramname"><em>hist_1d</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: Fill Violin histogram with entry from a toy. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">violin</td><td>hist that will be filled </td></tr>
    <tr><td class="paramname">hist_1d</td><td>refence hist from which we take entries to be filled </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l02597">2597</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2597</span>                                                             {</div>
<div class="line"><span class="lineno"> 2598</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 2599</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; violin-&gt;GetXaxis()-&gt;GetNbins(); ++x) </div>
<div class="line"><span class="lineno"> 2600</span>  {</div>
<div class="line"><span class="lineno"> 2601</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> y = violin-&gt;GetYaxis()-&gt;FindBin(hist_1d-&gt;GetBinContent(x+1));</div>
<div class="line"><span class="lineno"> 2602</span>    violin-&gt;SetBinContent(x+1, y,  violin-&gt;GetBinContent(x+1, y)+1);</div>
<div class="line"><span class="lineno"> 2603</span>  }</div>
<div class="line"><span class="lineno"> 2604</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a89b4a0897346caf484c356155792fce3" name="a89b4a0897346caf484c356155792fce3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89b4a0897346caf484c356155792fce3">&#9670;&#160;</a></span>GetLLH() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SampleSummary::GetLLH </td>
          <td>(</td>
          <td class="paramtype">TH1D *const &amp;&#160;</td>
          <td class="paramname"><em>Data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1D *const &amp;&#160;</td>
          <td class="paramname"><em>MC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1D *const &amp;&#160;</td>
          <td class="paramname"><em>W2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper functions to calculate likelihoods using TH1D. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Data</td><td>histogram with data distribution for a single sample </td></tr>
    <tr><td class="paramname">MC</td><td>histogram with MC distribution for a single sample </td></tr>
    <tr><td class="paramname">W2</td><td>histogram with W2 distribution for a single sample </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l01698">1698</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1698</span>                                                                                                 {</div>
<div class="line"><span class="lineno"> 1699</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 1700</span>  <span class="keywordtype">double</span> llh = 0.0;</div>
<div class="line"><span class="lineno"> 1701</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= DatHist-&gt;GetXaxis()-&gt;GetNbins(); ++i)</div>
<div class="line"><span class="lineno"> 1702</span>  {</div>
<div class="line"><span class="lineno"> 1703</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> data = DatHist-&gt;GetBinContent(i);</div>
<div class="line"><span class="lineno"> 1704</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> mc = MCHist-&gt;GetBinContent(i);</div>
<div class="line"><span class="lineno"> 1705</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> w2 = W2Hist-&gt;GetBinContent(i);</div>
<div class="line"><span class="lineno"> 1706</span>    llh += <a class="code hl_variable" href="classSampleSummary.html#abd938805245ca6cfeb8c49363f5ff11c">SamplePDF</a>-&gt;<a class="code hl_function" href="classsamplePDFBase.html#ab2e2eab110efc30a2aee13a5011acb8a">getTestStatLLH</a>(data, mc, w2);</div>
<div class="line"><span class="lineno"> 1707</span>  }</div>
<div class="line"><span class="lineno"> 1708</span>  <span class="comment">//KS: do times 2 because banff reports chi2</span></div>
<div class="line"><span class="lineno"> 1709</span>  <span class="keywordflow">return</span> 2*llh;</div>
<div class="line"><span class="lineno"> 1710</span>}</div>
<div class="ttc" id="aclasssamplePDFBase_html_ab2e2eab110efc30a2aee13a5011acb8a"><div class="ttname"><a href="classsamplePDFBase.html#ab2e2eab110efc30a2aee13a5011acb8a">samplePDFBase::getTestStatLLH</a></div><div class="ttdeci">double getTestStatLLH(double data, double mc) const</div><div class="ttdef"><b>Definition:</b> <a href="samplePDFBase_8cpp_source.html#l00100">samplePDFBase.cpp:100</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad027b0716b707691e6a9565ee497b66f" name="ad027b0716b707691e6a9565ee497b66f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad027b0716b707691e6a9565ee497b66f">&#9670;&#160;</a></span>GetLLH() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SampleSummary::GetLLH </td>
          <td>(</td>
          <td class="paramtype">TH2Poly *const &amp;&#160;</td>
          <td class="paramname"><em>Data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH2Poly *const &amp;&#160;</td>
          <td class="paramname"><em>MC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH2Poly *const &amp;&#160;</td>
          <td class="paramname"><em>W2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper functions to calculate likelihoods using TH2Poly. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Data</td><td>histogram with data distribution for a single sample </td></tr>
    <tr><td class="paramname">MC</td><td>histogram with MC distribution for a single sample </td></tr>
    <tr><td class="paramname">W2</td><td>histogram with W2 distribution for a single sample </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l01683">1683</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1683</span>                                                                                                          {</div>
<div class="line"><span class="lineno"> 1684</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 1685</span>  <span class="keywordtype">double</span> llh = 0.0;</div>
<div class="line"><span class="lineno"> 1686</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; DatHist-&gt;GetNumberOfBins()+1; ++i)</div>
<div class="line"><span class="lineno"> 1687</span>  {</div>
<div class="line"><span class="lineno"> 1688</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> data = DatHist-&gt;GetBinContent(i);</div>
<div class="line"><span class="lineno"> 1689</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> mc = MCHist-&gt;GetBinContent(i);</div>
<div class="line"><span class="lineno"> 1690</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> w2 = W2Hist-&gt;GetBinContent(i);</div>
<div class="line"><span class="lineno"> 1691</span>    llh += <a class="code hl_variable" href="classSampleSummary.html#abd938805245ca6cfeb8c49363f5ff11c">SamplePDF</a>-&gt;<a class="code hl_function" href="classsamplePDFBase.html#ab2e2eab110efc30a2aee13a5011acb8a">getTestStatLLH</a>(data, mc, w2);</div>
<div class="line"><span class="lineno"> 1692</span>  }</div>
<div class="line"><span class="lineno"> 1693</span>  <span class="comment">//KS: do times 2 because banff reports chi2</span></div>
<div class="line"><span class="lineno"> 1694</span>  <span class="keywordflow">return</span> 2*llh;</div>
<div class="line"><span class="lineno"> 1695</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1ed7c379dc433cb1dc3b71eb7aec9713" name="a1ed7c379dc433cb1dc3b71eb7aec9713"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ed7c379dc433cb1dc3b71eb7aec9713">&#9670;&#160;</a></span>GetModeError()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SampleSummary::GetModeError </td>
          <td>(</td>
          <td class="paramtype">TH1D *&#160;</td>
          <td class="paramname"><em>hpost</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the mode error from a TH1D. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hpost</td><td>hist from which we extract mode error </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l02406">2406</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2406</span>                                             {</div>
<div class="line"><span class="lineno"> 2407</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 2408</span>  <span class="comment">// Get the bin which has the largest posterior density</span></div>
<div class="line"><span class="lineno"> 2409</span>  <span class="keywordtype">int</span> MaxBin = hpost-&gt;GetMaximumBin();</div>
<div class="line"><span class="lineno"> 2410</span> </div>
<div class="line"><span class="lineno"> 2411</span>  <span class="comment">// The total integral of the posterior</span></div>
<div class="line"><span class="lineno"> 2412</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> Integral = hpost-&gt;Integral();</div>
<div class="line"><span class="lineno"> 2413</span> </div>
<div class="line"><span class="lineno"> 2414</span>  <span class="keywordtype">int</span> LowBin = MaxBin;</div>
<div class="line"><span class="lineno"> 2415</span>  <span class="keywordtype">int</span> HighBin = MaxBin;</div>
<div class="line"><span class="lineno"> 2416</span>  <span class="keywordtype">double</span> sum = hpost-&gt;GetBinContent(MaxBin);;</div>
<div class="line"><span class="lineno"> 2417</span>  <span class="keywordtype">double</span> LowCon = 0.0;</div>
<div class="line"><span class="lineno"> 2418</span>  <span class="keywordtype">double</span> HighCon = 0.0;</div>
<div class="line"><span class="lineno"> 2419</span>  <span class="keywordflow">while</span> (sum/Integral &lt; 0.6827 &amp;&amp; (LowBin &gt; 0 || HighBin &lt; hpost-&gt;GetNbinsX()+1) )</div>
<div class="line"><span class="lineno"> 2420</span>  {</div>
<div class="line"><span class="lineno"> 2421</span>    LowCon = 0.0;</div>
<div class="line"><span class="lineno"> 2422</span>    HighCon = 0.0;</div>
<div class="line"><span class="lineno"> 2423</span>    <span class="comment">//KS:: Move further only if you haven&#39;t reached histogram end</span></div>
<div class="line"><span class="lineno"> 2424</span>    <span class="keywordflow">if</span>(LowBin &gt; 1)</div>
<div class="line"><span class="lineno"> 2425</span>    {</div>
<div class="line"><span class="lineno"> 2426</span>      LowBin--;</div>
<div class="line"><span class="lineno"> 2427</span>      LowCon = hpost-&gt;GetBinContent(LowBin);</div>
<div class="line"><span class="lineno"> 2428</span>    }</div>
<div class="line"><span class="lineno"> 2429</span>    <span class="keywordflow">if</span>(HighBin &lt; hpost-&gt;GetNbinsX())</div>
<div class="line"><span class="lineno"> 2430</span>    {</div>
<div class="line"><span class="lineno"> 2431</span>      HighBin++;</div>
<div class="line"><span class="lineno"> 2432</span>      HighCon = hpost-&gt;GetBinContent(HighBin);</div>
<div class="line"><span class="lineno"> 2433</span>    }</div>
<div class="line"><span class="lineno"> 2434</span> </div>
<div class="line"><span class="lineno"> 2435</span>    <span class="comment">// If we&#39;re on the last slice and the lower contour is larger than the upper</span></div>
<div class="line"><span class="lineno"> 2436</span>    <span class="keywordflow">if</span> ((sum+LowCon+HighCon)/Integral &gt; 0.6827 &amp;&amp; LowCon &gt; HighCon) {</div>
<div class="line"><span class="lineno"> 2437</span>      sum += LowCon;</div>
<div class="line"><span class="lineno"> 2438</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2439</span>      <span class="comment">// If we&#39;re on the last slice and the upper contour is larger than the lower</span></div>
<div class="line"><span class="lineno"> 2440</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((sum+LowCon+HighCon)/Integral &gt; 0.6827 &amp;&amp; HighCon &gt;= LowCon) {</div>
<div class="line"><span class="lineno"> 2441</span>      sum += HighCon;</div>
<div class="line"><span class="lineno"> 2442</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2443</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2444</span>      sum += LowCon + HighCon;</div>
<div class="line"><span class="lineno"> 2445</span>    }</div>
<div class="line"><span class="lineno"> 2446</span>  }</div>
<div class="line"><span class="lineno"> 2447</span> </div>
<div class="line"><span class="lineno"> 2448</span>  <span class="keywordtype">double</span> Mode_Error = 0.0;</div>
<div class="line"><span class="lineno"> 2449</span>  <span class="keywordflow">if</span> (LowCon &gt; HighCon) {</div>
<div class="line"><span class="lineno"> 2450</span>    Mode_Error = std::fabs(hpost-&gt;GetBinCenter(LowBin)-hpost-&gt;GetBinCenter(MaxBin));</div>
<div class="line"><span class="lineno"> 2451</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2452</span>    Mode_Error = std::fabs(hpost-&gt;GetBinCenter(HighBin)-hpost-&gt;GetBinCenter(MaxBin));</div>
<div class="line"><span class="lineno"> 2453</span>  }</div>
<div class="line"><span class="lineno"> 2454</span> </div>
<div class="line"><span class="lineno"> 2455</span>  <span class="keywordflow">return</span> Mode_Error;</div>
<div class="line"><span class="lineno"> 2456</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a938ba96c39db535ede194bfe9f15d626" name="a938ba96c39db535ede194bfe9f15d626"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a938ba96c39db535ede194bfe9f15d626">&#9670;&#160;</a></span>GetRandomPoly2()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SampleSummary::GetRandomPoly2 </td>
          <td>(</td>
          <td class="paramtype">const TH2Poly *&#160;</td>
          <td class="paramname"><em>PolyHist</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: ROOT developers were too lazy do develop getRanom2 for TH2Poly, this implementation is based on <a href="https://root.cern.ch/doc/master/classTH2.html#a883f419e1f6899f9c4255b458d2afe2e">link</a> </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l02377">2377</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2377</span>                                                        {</div>
<div class="line"><span class="lineno"> 2378</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 2379</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nbins = PolyHist-&gt;GetNumberOfBins();</div>
<div class="line"><span class="lineno"> 2380</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> r1 = <a class="code hl_variable" href="classSampleSummary.html#a364fb16938a26adbe59fdd057f4b9405">rnd</a>-&gt;Rndm();</div>
<div class="line"><span class="lineno"> 2381</span>  </div>
<div class="line"><span class="lineno"> 2382</span>  <span class="keywordtype">double</span>* fIntegral = <span class="keyword">new</span> <span class="keywordtype">double</span>[nbins+2];</div>
<div class="line"><span class="lineno"> 2383</span>  fIntegral[0] = 0.0;</div>
<div class="line"><span class="lineno"> 2384</span> </div>
<div class="line"><span class="lineno"> 2385</span>  <span class="comment">//KS: This is custom version of ComputeIntegral, once again ROOT was lazy :(</span></div>
<div class="line"><span class="lineno"> 2386</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; nbins+1; ++i) </div>
<div class="line"><span class="lineno"> 2387</span>  {</div>
<div class="line"><span class="lineno"> 2388</span>    fIntegral[i] = 0.0;</div>
<div class="line"><span class="lineno"> 2389</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> content = PolyHist-&gt;GetBinContent(i);</div>
<div class="line"><span class="lineno"> 2390</span>    fIntegral[i] += fIntegral[i - 1] + content;</div>
<div class="line"><span class="lineno"> 2391</span>  }</div>
<div class="line"><span class="lineno"> 2392</span>  <span class="keywordflow">for</span> (Int_t bin = 1; bin &lt; nbins+1; ++bin)  fIntegral[bin] /= fIntegral[nbins];</div>
<div class="line"><span class="lineno"> 2393</span>  fIntegral[nbins+1] = PolyHist-&gt;GetEntries();</div>
<div class="line"><span class="lineno"> 2394</span>  </div>
<div class="line"><span class="lineno"> 2395</span>  <span class="comment">//KS: We just return one rather then X and Y, this way we can use SetBinContent rather than Fill, which is faster </span></div>
<div class="line"><span class="lineno"> 2396</span>  <span class="keywordtype">int</span> iBin = int(TMath::BinarySearch(nbins, fIntegral, r1));</div>
<div class="line"><span class="lineno"> 2397</span>  <span class="comment">//KS: Have to increment because TH2Poly has stupid offset arghh</span></div>
<div class="line"><span class="lineno"> 2398</span>  iBin += 1;</div>
<div class="line"><span class="lineno"> 2399</span>  </div>
<div class="line"><span class="lineno"> 2400</span>  <span class="keyword">delete</span>[] fIntegral;</div>
<div class="line"><span class="lineno"> 2401</span>  <span class="keywordflow">return</span> iBin;</div>
<div class="line"><span class="lineno"> 2402</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a316974fb99c5a775e1c7099be3bccc7b" name="a316974fb99c5a775e1c7099be3bccc7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a316974fb99c5a775e1c7099be3bccc7b">&#9670;&#160;</a></span>MakeChi2Hists()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::MakeChi2Hists </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Make the fluctuated histograms (2D and 1D) for the chi2s Essentially taking the MCMC draws and calculating their LLH to the Posterior predictive distribution And additionally taking the data histogram and calculating the LLH to the predictive distribution Additionally we calculate the chi2 of the draws (fluctuated) of the MC with the prior/posterior predictive and plot it vs the chi2 from the draws of MCMC and the data. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l01141">1141</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1141</span>                                  {</div>
<div class="line"><span class="lineno"> 1142</span><span class="comment">// *******************</span></div>
<div class="line"><span class="lineno"> 1143</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making the chi2 histograms...&quot;</span>);</div>
<div class="line"><span class="lineno"> 1144</span>  <span class="comment">// Have this to signify if we&#39;re doing the first pass</span></div>
<div class="line"><span class="lineno"> 1145</span>  <a class="code hl_variable" href="classSampleSummary.html#a4ade2ccb94981d4483f0b4e6e367b1a0">first_pass</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1146</span> </div>
<div class="line"><span class="lineno"> 1147</span>  <span class="keywordtype">double</span> AveragePenalty = 0;</div>
<div class="line"><span class="lineno"> 1148</span> </div>
<div class="line"><span class="lineno"> 1149</span>  <span class="comment">// Vectors to hold exact LLH</span></div>
<div class="line"><span class="lineno"> 1150</span>  std::vector&lt;double&gt; LLH_PredFluc_V(<a class="code hl_variable" href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">nThrows</a>);</div>
<div class="line"><span class="lineno"> 1151</span>  std::vector&lt;double&gt; LLH_DataDraw_V(<a class="code hl_variable" href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">nThrows</a>);</div>
<div class="line"><span class="lineno"> 1152</span>  std::vector&lt;double&gt; LLH_DrawFlucDraw_V(<a class="code hl_variable" href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">nThrows</a>);</div>
<div class="line"><span class="lineno"> 1153</span>    </div>
<div class="line"><span class="lineno"> 1154</span>  <span class="comment">// Loop over the draws</span></div>
<div class="line"><span class="lineno"> 1155</span>  <span class="comment">// Should look into multi-threading this. Would require temporary THxx structures from arrays</span></div>
<div class="line"><span class="lineno"> 1156</span>  <span class="comment">//KS: Update above would be ideal but currently we loop over samples (see loop below) which isn&#39;t as efficient as loop over throws but much much easier to implement</span></div>
<div class="line"><span class="lineno"> 1157</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">nThrows</a>; ++i)</div>
<div class="line"><span class="lineno"> 1158</span>  {</div>
<div class="line"><span class="lineno"> 1159</span>    <span class="keywordflow">if</span> (i % (<a class="code hl_variable" href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">nThrows</a>/10) == 0) {</div>
<div class="line"><span class="lineno"> 1160</span>      <a class="code hl_function" href="namespaceMaCh3Utils.html#a4c8bdeb1d34606aed192e9f1311a72f5">MaCh3Utils::PrintProgressBar</a>(i, <a class="code hl_variable" href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">nThrows</a>);</div>
<div class="line"><span class="lineno"> 1161</span>    }</div>
<div class="line"><span class="lineno"> 1162</span> </div>
<div class="line"><span class="lineno"> 1163</span>    <span class="comment">// Set the total LLH to zero to initialise</span></div>
<div class="line"><span class="lineno"> 1164</span>    <span class="keywordtype">double</span> total_llh_data_draw_temp = 0.0;</div>
<div class="line"><span class="lineno"> 1165</span>    <span class="keywordtype">double</span> total_llh_drawfluc_draw_temp = 0.0;</div>
<div class="line"><span class="lineno"> 1166</span>    <span class="keywordtype">double</span> total_llh_predfluc_draw_temp = 0.0;</div>
<div class="line"><span class="lineno"> 1167</span> </div>
<div class="line"><span class="lineno"> 1168</span>    <span class="keywordtype">double</span> total_llh_rate_data_draw_temp = 0.0;</div>
<div class="line"><span class="lineno"> 1169</span>    <span class="keywordtype">double</span> total_llh_rate_predfluc_draw_temp = 0.0;</div>
<div class="line"><span class="lineno"> 1170</span> </div>
<div class="line"><span class="lineno"> 1171</span>    <span class="keywordtype">double</span> total_llh_data_drawfluc_temp = 0.0;</div>
<div class="line"><span class="lineno"> 1172</span>    <span class="keywordtype">double</span> total_llh_data_predfluc_temp = 0.0;</div>
<div class="line"><span class="lineno"> 1173</span>    <span class="keywordtype">double</span> total_llh_draw_pred_temp = 0.0;</div>
<div class="line"><span class="lineno"> 1174</span>    <span class="keywordtype">double</span> total_llh_drawfluc_pred_temp = 0.0;</div>
<div class="line"><span class="lineno"> 1175</span>    <span class="keywordtype">double</span> total_llh_drawfluc_predfluc_temp = 0.0;</div>
<div class="line"><span class="lineno"> 1176</span>    <span class="keywordtype">double</span> total_llh_predfluc_pred_temp = 0.0;</div>
<div class="line"><span class="lineno"> 1177</span>    <span class="keywordtype">double</span> total_llh_datafluc_draw_temp = 0.0;</div>
<div class="line"><span class="lineno"> 1178</span> </div>
<div class="line"><span class="lineno"> 1179</span>    <span class="keywordtype">double</span> total_llh_data_draw_ProjectX_temp = 0.0;</div>
<div class="line"><span class="lineno"> 1180</span>    <span class="keywordtype">double</span> total_llh_drawfluc_draw_ProjectX_temp = 0.0;</div>
<div class="line"><span class="lineno"> 1181</span> </div>
<div class="line"><span class="lineno"> 1182</span>    <span class="comment">// Save the double that gets written to file</span></div>
<div class="line"><span class="lineno"> 1183</span>    <a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a> = <a class="code hl_variable" href="classSampleSummary.html#a068e2a5ad0c02aaa57a27d2b12e37810">LLHPenaltyVector</a>[i];</div>
<div class="line"><span class="lineno"> 1184</span>    AveragePenalty += <a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a>;</div>
<div class="line"><span class="lineno"> 1185</span> </div>
<div class="line"><span class="lineno"> 1186</span>    <span class="comment">// Make the Poisson fluctuated hist</span></div>
<div class="line"><span class="lineno"> 1187</span>    std::vector&lt;TH2Poly*&gt; FluctHist(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno"> 1188</span>    <span class="comment">// Also Poisson fluctuate the drawn MCMC hist</span></div>
<div class="line"><span class="lineno"> 1189</span>    std::vector&lt;TH2Poly*&gt; FluctDrawHist(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno"> 1190</span>    <span class="comment">// Finally Poisson fluctuate the data histogram</span></div>
<div class="line"><span class="lineno"> 1191</span>    std::vector&lt;TH2Poly*&gt; DataFlucHist(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno"> 1192</span> </div>
<div class="line"><span class="lineno"> 1193</span>    <span class="comment">// Finally Poisson fluctuate the data histogram</span></div>
<div class="line"><span class="lineno"> 1194</span>    std::vector&lt;TH1D*&gt; FluctDrawHistProjectX(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno"> 1195</span>    std::vector&lt;TH1D*&gt; DrawHistProjectX(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno"> 1196</span>    std::vector&lt;TH1D*&gt; DrawHistProjectY(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno"> 1197</span>    std::vector&lt;TH1D*&gt; DrawW2HistProjectX(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno"> 1198</span> </div>
<div class="line"><span class="lineno"> 1199</span>    <span class="comment">//KS: We have to clone histograms here to avoid cloning in MP loop, we have to make sure binning matches, content doesn&#39;t have to</span></div>
<div class="line"><span class="lineno"> 1200</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> SampleNum = 0;  SampleNum &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++SampleNum)</div>
<div class="line"><span class="lineno"> 1201</span>    {</div>
<div class="line"><span class="lineno"> 1202</span>      FluctHist[SampleNum] = <span class="keyword">static_cast&lt;</span>TH2Poly*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[SampleNum]-&gt;Clone());</div>
<div class="line"><span class="lineno"> 1203</span>      FluctDrawHist[SampleNum] = <span class="keyword">static_cast&lt;</span>TH2Poly*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[SampleNum]-&gt;Clone());</div>
<div class="line"><span class="lineno"> 1204</span>      DataFlucHist[SampleNum] = <span class="keyword">static_cast&lt;</span>TH2Poly*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[SampleNum]-&gt;Clone());</div>
<div class="line"><span class="lineno"> 1205</span> </div>
<div class="line"><span class="lineno"> 1206</span>      FluctDrawHistProjectX[SampleNum] = <span class="keyword">static_cast&lt;</span>TH1D*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classSampleSummary.html#abeaca1195db794d9e660a377d81c1b21">DataHist_ProjectX</a>[SampleNum]-&gt;Clone());</div>
<div class="line"><span class="lineno"> 1207</span> </div>
<div class="line"><span class="lineno"> 1208</span>      <span class="comment">// Get the ith draw for the jth sample</span></div>
<div class="line"><span class="lineno"> 1209</span>      TH2Poly *DrawHist = <a class="code hl_variable" href="classSampleSummary.html#a13177305e8fd4b97812b2ca563740bf2">MCVector</a>[i][SampleNum];</div>
<div class="line"><span class="lineno"> 1210</span>      TH2Poly *DrawW2Hist = <a class="code hl_variable" href="classSampleSummary.html#a263b7541545b8b0ba735e0a3ac2d31e7">W2MCVector</a>[i][SampleNum];</div>
<div class="line"><span class="lineno"> 1211</span> </div>
<div class="line"><span class="lineno"> 1212</span>      <span class="comment">//ProjectPoly calls new TH1D under the hood, never define new ROOT object under MP...</span></div>
<div class="line"><span class="lineno"> 1213</span>      DrawHistProjectX[SampleNum] = <a class="code hl_function" href="classSampleSummary.html#a685a8ef3180d4f6474328b5c806d8b74">ProjectPoly</a>(DrawHist, <span class="keyword">true</span>, SampleNum);</div>
<div class="line"><span class="lineno"> 1214</span>      DrawW2HistProjectX[SampleNum] = <a class="code hl_function" href="classSampleSummary.html#a685a8ef3180d4f6474328b5c806d8b74">ProjectPoly</a>(DrawW2Hist, <span class="keyword">true</span>, SampleNum);</div>
<div class="line"><span class="lineno"> 1215</span>      DrawHistProjectY[SampleNum] = <a class="code hl_function" href="classSampleSummary.html#a685a8ef3180d4f6474328b5c806d8b74">ProjectPoly</a>(DrawHist, <span class="keyword">false</span>, SampleNum);</div>
<div class="line"><span class="lineno"> 1216</span>    }</div>
<div class="line"><span class="lineno"> 1217</span><span class="preprocessor">    #ifdef MULTITHREAD </span></div>
<div class="line"><span class="lineno"> 1218</span>    <span class="comment">//KS: might be most obscure OMP reduction I have ever made...</span></div>
<div class="line"><span class="lineno"> 1219</span><span class="preprocessor">    #pragma omp parallel for reduction(+:total_llh_data_draw_temp, total_llh_drawfluc_draw_temp, total_llh_predfluc_draw_temp, total_llh_rate_data_draw_temp, total_llh_rate_predfluc_draw_temp, total_llh_data_drawfluc_temp, total_llh_data_predfluc_temp, total_llh_draw_pred_temp, total_llh_drawfluc_pred_temp, total_llh_drawfluc_predfluc_temp, total_llh_predfluc_pred_temp, total_llh_datafluc_draw_temp, total_llh_data_draw_ProjectX_temp, total_llh_drawfluc_draw_ProjectX_temp)</span></div>
<div class="line"><span class="lineno"> 1220</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno"> 1221</span>    <span class="comment">// Loop over the samples</span></div>
<div class="line"><span class="lineno"> 1222</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> SampleNum = 0;  SampleNum &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++SampleNum)</div>
<div class="line"><span class="lineno"> 1223</span>    {</div>
<div class="line"><span class="lineno"> 1224</span>      <span class="comment">// Get the ith draw for the jth sample</span></div>
<div class="line"><span class="lineno"> 1225</span>      TH2Poly *DrawHist = <a class="code hl_variable" href="classSampleSummary.html#a13177305e8fd4b97812b2ca563740bf2">MCVector</a>[i][SampleNum];</div>
<div class="line"><span class="lineno"> 1226</span>      TH2Poly *DrawW2Hist = <a class="code hl_variable" href="classSampleSummary.html#a263b7541545b8b0ba735e0a3ac2d31e7">W2MCVector</a>[i][SampleNum];</div>
<div class="line"><span class="lineno"> 1227</span>      <span class="comment">// Skip empty samples</span></div>
<div class="line"><span class="lineno"> 1228</span>      <span class="keywordflow">if</span> (DrawHist == <span class="keyword">nullptr</span>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1229</span> </div>
<div class="line"><span class="lineno"> 1230</span>      <span class="comment">// Add LLH penalties from the systematics to the LLH that use the drawn histogram</span></div>
<div class="line"><span class="lineno"> 1231</span>      <span class="comment">// Data vs Draw</span></div>
<div class="line"><span class="lineno"> 1232</span>      <a class="code hl_variable" href="classSampleSummary.html#a668c1a7ce4ef8592eae4a91ef99c60dc">llh_data_draw</a>[SampleNum] = <a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a>;</div>
<div class="line"><span class="lineno"> 1233</span>      <span class="comment">// Fluctuated Draw vs Draw</span></div>
<div class="line"><span class="lineno"> 1234</span>      <a class="code hl_variable" href="classSampleSummary.html#a596fc0b5e504bf382c342e950dd7cb95">llh_drawfluc_draw</a>[SampleNum] = <a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a>;</div>
<div class="line"><span class="lineno"> 1235</span>      <span class="comment">// Fluctuated Predicitve vs Draw</span></div>
<div class="line"><span class="lineno"> 1236</span>      <a class="code hl_variable" href="classSampleSummary.html#a107a3073ee178eff7107ccd5f41b91c5">llh_predfluc_draw</a>[SampleNum] = <a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a>;</div>
<div class="line"><span class="lineno"> 1237</span>      </div>
<div class="line"><span class="lineno"> 1238</span>      <span class="comment">// Data vs Draw using rate</span></div>
<div class="line"><span class="lineno"> 1239</span>      <a class="code hl_variable" href="classSampleSummary.html#adae47fb3a91f5946c7329c6e3643ae9a">llh_rate_data_draw</a>[SampleNum] = <a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a>;</div>
<div class="line"><span class="lineno"> 1240</span>      <span class="comment">// Fluctuated Predicitve vs Draw using rate</span></div>
<div class="line"><span class="lineno"> 1241</span>      <a class="code hl_variable" href="classSampleSummary.html#aa27591c1aff4c4e8e25fbf9c13ae37c5">llh_rate_predfluc_draw</a>[SampleNum] = <a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a>;</div>
<div class="line"><span class="lineno"> 1242</span> </div>
<div class="line"><span class="lineno"> 1243</span>       <span class="comment">// Data vs Fluctuated Draw</span></div>
<div class="line"><span class="lineno"> 1244</span>      <a class="code hl_variable" href="classSampleSummary.html#a999cbd0982694a364f8706ca2b435d81">llh_data_drawfluc</a>[SampleNum] = <a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a>;</div>
<div class="line"><span class="lineno"> 1245</span>      <span class="comment">// Draw vs Predictive</span></div>
<div class="line"><span class="lineno"> 1246</span>      <a class="code hl_variable" href="classSampleSummary.html#a7f46ee13ef20275c5dc162196190984b">llh_draw_pred</a>[SampleNum] = <a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a>;</div>
<div class="line"><span class="lineno"> 1247</span>      <span class="comment">// Fluctuated Draw vs Predictive</span></div>
<div class="line"><span class="lineno"> 1248</span>      <a class="code hl_variable" href="classSampleSummary.html#abc8205a6fddca44ed7c5b3e5c50612e7">llh_drawfluc_pred</a>[SampleNum] = <a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a>;</div>
<div class="line"><span class="lineno"> 1249</span>      <span class="comment">// Fluctuated Draw vs Fluctuated Predictive</span></div>
<div class="line"><span class="lineno"> 1250</span>      <a class="code hl_variable" href="classSampleSummary.html#a642d0e2bb5bc0729744684a3f8bbc459">llh_drawfluc_predfluc</a>[SampleNum] = <a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a>;</div>
<div class="line"><span class="lineno"> 1251</span>      <span class="comment">// Fluctuated Data vs Draw</span></div>
<div class="line"><span class="lineno"> 1252</span>      <a class="code hl_variable" href="classSampleSummary.html#abe225db63f8137df4b74d138ab1eb6f2">llh_datafluc_draw</a>[SampleNum] = <a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a>;</div>
<div class="line"><span class="lineno"> 1253</span>      </div>
<div class="line"><span class="lineno"> 1254</span>      <span class="comment">//Some LLH for 1D projections</span></div>
<div class="line"><span class="lineno"> 1255</span>      <a class="code hl_variable" href="classSampleSummary.html#a083eb13c61fe7d1b88b2ebe845312640">llh_data_draw_ProjectX</a>[SampleNum] = <a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a>;</div>
<div class="line"><span class="lineno"> 1256</span>      <a class="code hl_variable" href="classSampleSummary.html#a81be1b29e649529930276daab33f7b69">llh_drawfluc_draw_ProjectX</a>[SampleNum] = <a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a>;</div>
<div class="line"><span class="lineno"> 1257</span>      </div>
<div class="line"><span class="lineno"> 1258</span>      <span class="comment">//Other get 0 penalty term</span></div>
<div class="line"><span class="lineno"> 1259</span>      <span class="comment">// Fluctuated Predictive vs Predictive</span></div>
<div class="line"><span class="lineno"> 1260</span>      <a class="code hl_variable" href="classSampleSummary.html#a464faf180667c999aec72c140ddb515a">llh_predfluc_pred</a>[SampleNum] = 0.0;</div>
<div class="line"><span class="lineno"> 1261</span>      <span class="comment">// Data vs Fluctuated Predictive</span></div>
<div class="line"><span class="lineno"> 1262</span>      <a class="code hl_variable" href="classSampleSummary.html#a325a83aec886a90ed6d4c96ccf573c56">llh_data_predfluc</a>[SampleNum] = 0.0;</div>
<div class="line"><span class="lineno"> 1263</span> </div>
<div class="line"><span class="lineno"> 1264</span>      <span class="comment">// Make the Poisson fluctuated hist</span></div>
<div class="line"><span class="lineno"> 1265</span>      <a class="code hl_function" href="classSampleSummary.html#ada2f0b7b9b7bb687e67023e84151610e">MakeFluctuatedHistogram</a>(FluctHist[SampleNum], <a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[SampleNum]);</div>
<div class="line"><span class="lineno"> 1266</span>      <span class="comment">// Also Poisson fluctuate the drawn MCMC hist</span></div>
<div class="line"><span class="lineno"> 1267</span>      <a class="code hl_function" href="classSampleSummary.html#ada2f0b7b9b7bb687e67023e84151610e">MakeFluctuatedHistogram</a>(FluctDrawHist[SampleNum], DrawHist);</div>
<div class="line"><span class="lineno"> 1268</span>      <span class="comment">// Finally Poisson fluctuate the data histogram</span></div>
<div class="line"><span class="lineno"> 1269</span>      <a class="code hl_function" href="classSampleSummary.html#ada2f0b7b9b7bb687e67023e84151610e">MakeFluctuatedHistogram</a>(DataFlucHist[SampleNum], <a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[SampleNum]);</div>
<div class="line"><span class="lineno"> 1270</span> </div>
<div class="line"><span class="lineno"> 1271</span>      <span class="comment">// Likelihood between the drawn histogram and the data</span></div>
<div class="line"><span class="lineno"> 1272</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> DataDrawLLH = <a class="code hl_function" href="classSampleSummary.html#ad027b0716b707691e6a9565ee497b66f">GetLLH</a>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[SampleNum], DrawHist, DrawW2Hist);</div>
<div class="line"><span class="lineno"> 1273</span>      <a class="code hl_variable" href="classSampleSummary.html#a668c1a7ce4ef8592eae4a91ef99c60dc">llh_data_draw</a>[SampleNum] += DataDrawLLH;</div>
<div class="line"><span class="lineno"> 1274</span>      total_llh_data_draw_temp += DataDrawLLH;</div>
<div class="line"><span class="lineno"> 1275</span>      </div>
<div class="line"><span class="lineno"> 1276</span>      <span class="comment">// Likelihood between drawn histogram and fluctuated drawn histogram</span></div>
<div class="line"><span class="lineno"> 1277</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> DrawFlucDrawLLH = <a class="code hl_function" href="classSampleSummary.html#ad027b0716b707691e6a9565ee497b66f">GetLLH</a>(FluctDrawHist[SampleNum], DrawHist, DrawW2Hist);</div>
<div class="line"><span class="lineno"> 1278</span>      <a class="code hl_variable" href="classSampleSummary.html#a596fc0b5e504bf382c342e950dd7cb95">llh_drawfluc_draw</a>[SampleNum] += DrawFlucDrawLLH;</div>
<div class="line"><span class="lineno"> 1279</span>      total_llh_drawfluc_draw_temp += DrawFlucDrawLLH;</div>
<div class="line"><span class="lineno"> 1280</span>      </div>
<div class="line"><span class="lineno"> 1281</span>      <span class="comment">// Likelihood between drawn histogram and fluctuated posterior predictive distribution</span></div>
<div class="line"><span class="lineno"> 1282</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> PredFlucDrawLLH = <a class="code hl_function" href="classSampleSummary.html#ad027b0716b707691e6a9565ee497b66f">GetLLH</a>(FluctHist[SampleNum], DrawHist, DrawW2Hist);</div>
<div class="line"><span class="lineno"> 1283</span>      <a class="code hl_variable" href="classSampleSummary.html#a107a3073ee178eff7107ccd5f41b91c5">llh_predfluc_draw</a>[SampleNum] += PredFlucDrawLLH;</div>
<div class="line"><span class="lineno"> 1284</span>      total_llh_predfluc_draw_temp += PredFlucDrawLLH;</div>
<div class="line"><span class="lineno"> 1285</span> </div>
<div class="line"><span class="lineno"> 1286</span><span class="comment">//Rate Based p-value</span></div>
<div class="line"><span class="lineno"> 1287</span>      <span class="comment">// Likelihood between the drawn histogram and the data</span></div>
<div class="line"><span class="lineno"> 1288</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> RateDataDrawLLH = <a class="code hl_variable" href="classSampleSummary.html#abd938805245ca6cfeb8c49363f5ff11c">SamplePDF</a>-&gt;<a class="code hl_function" href="classsamplePDFBase.html#ab2e2eab110efc30a2aee13a5011acb8a">getTestStatLLH</a>(<a class="code hl_function" href="Structs_8cpp.html#ab18c6b2408d7b9021bad06d47a06ee8d">NoOverflowIntegral</a>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[SampleNum]), <a class="code hl_function" href="Structs_8cpp.html#ab18c6b2408d7b9021bad06d47a06ee8d">NoOverflowIntegral</a>(DrawHist), <a class="code hl_function" href="Structs_8cpp.html#ab18c6b2408d7b9021bad06d47a06ee8d">NoOverflowIntegral</a>(DrawW2Hist));</div>
<div class="line"><span class="lineno"> 1289</span>      <a class="code hl_variable" href="classSampleSummary.html#adae47fb3a91f5946c7329c6e3643ae9a">llh_rate_data_draw</a>[SampleNum] += RateDataDrawLLH;</div>
<div class="line"><span class="lineno"> 1290</span>      total_llh_rate_data_draw_temp += RateDataDrawLLH;</div>
<div class="line"><span class="lineno"> 1291</span> </div>
<div class="line"><span class="lineno"> 1292</span>      <span class="comment">// Likelihood between drawn histogram and fluctuated posterior predictive distribution using rate</span></div>
<div class="line"><span class="lineno"> 1293</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> RatePredFlucDrawLLH = <a class="code hl_variable" href="classSampleSummary.html#abd938805245ca6cfeb8c49363f5ff11c">SamplePDF</a>-&gt;<a class="code hl_function" href="classsamplePDFBase.html#ab2e2eab110efc30a2aee13a5011acb8a">getTestStatLLH</a>(<a class="code hl_function" href="Structs_8cpp.html#ab18c6b2408d7b9021bad06d47a06ee8d">NoOverflowIntegral</a>(FluctHist[SampleNum]), <a class="code hl_function" href="Structs_8cpp.html#ab18c6b2408d7b9021bad06d47a06ee8d">NoOverflowIntegral</a>(DrawHist), <a class="code hl_function" href="Structs_8cpp.html#ab18c6b2408d7b9021bad06d47a06ee8d">NoOverflowIntegral</a>(DrawW2Hist));</div>
<div class="line"><span class="lineno"> 1294</span>      <a class="code hl_variable" href="classSampleSummary.html#aa27591c1aff4c4e8e25fbf9c13ae37c5">llh_rate_predfluc_draw</a>[SampleNum] += RatePredFlucDrawLLH;</div>
<div class="line"><span class="lineno"> 1295</span>      total_llh_rate_predfluc_draw_temp += RatePredFlucDrawLLH;</div>
<div class="line"><span class="lineno"> 1296</span> </div>
<div class="line"><span class="lineno"> 1297</span><span class="comment">//    All LLH below are for validation reason but not used for final P-Value</span></div>
<div class="line"><span class="lineno"> 1298</span>      <span class="comment">// Likelihood between the fluctuated drawn histogram and the data</span></div>
<div class="line"><span class="lineno"> 1299</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> DataDrawFlucLLH = <a class="code hl_function" href="classSampleSummary.html#ad027b0716b707691e6a9565ee497b66f">GetLLH</a>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[SampleNum], FluctDrawHist[SampleNum], DrawW2Hist);</div>
<div class="line"><span class="lineno"> 1300</span>      <a class="code hl_variable" href="classSampleSummary.html#a999cbd0982694a364f8706ca2b435d81">llh_data_drawfluc</a>[SampleNum] += DataDrawFlucLLH;</div>
<div class="line"><span class="lineno"> 1301</span>      total_llh_data_drawfluc_temp += DataDrawFlucLLH;</div>
<div class="line"><span class="lineno"> 1302</span> </div>
<div class="line"><span class="lineno"> 1303</span>      <span class="comment">// Likelihood between the drawn histogram and the data</span></div>
<div class="line"><span class="lineno"> 1304</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> DataPredFlucLLH = <a class="code hl_function" href="classSampleSummary.html#ad027b0716b707691e6a9565ee497b66f">GetLLH</a>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[SampleNum], FluctHist[SampleNum], <a class="code hl_variable" href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">W2MeanHist</a>[SampleNum]);</div>
<div class="line"><span class="lineno"> 1305</span>      <a class="code hl_variable" href="classSampleSummary.html#a325a83aec886a90ed6d4c96ccf573c56">llh_data_predfluc</a>[SampleNum] += DataPredFlucLLH;</div>
<div class="line"><span class="lineno"> 1306</span>      total_llh_data_predfluc_temp += DataPredFlucLLH;</div>
<div class="line"><span class="lineno"> 1307</span> </div>
<div class="line"><span class="lineno"> 1308</span>      <span class="comment">// Likelihood between the drawn hist and the Posterior Predictive</span></div>
<div class="line"><span class="lineno"> 1309</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> DrawPredLLH = <a class="code hl_function" href="classSampleSummary.html#ad027b0716b707691e6a9565ee497b66f">GetLLH</a>(DrawHist, <a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[SampleNum], <a class="code hl_variable" href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">W2MeanHist</a>[SampleNum]);</div>
<div class="line"><span class="lineno"> 1310</span>      <a class="code hl_variable" href="classSampleSummary.html#a7f46ee13ef20275c5dc162196190984b">llh_draw_pred</a>[SampleNum] += DrawPredLLH;</div>
<div class="line"><span class="lineno"> 1311</span>      total_llh_draw_pred_temp += DrawPredLLH;</div>
<div class="line"><span class="lineno"> 1312</span> </div>
<div class="line"><span class="lineno"> 1313</span>      <span class="comment">// Likelihood between fluctuated drawn and predictive</span></div>
<div class="line"><span class="lineno"> 1314</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> DrawFlucPredLLH = <a class="code hl_function" href="classSampleSummary.html#ad027b0716b707691e6a9565ee497b66f">GetLLH</a>(FluctDrawHist[SampleNum], <a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[SampleNum], <a class="code hl_variable" href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">W2MeanHist</a>[SampleNum]);</div>
<div class="line"><span class="lineno"> 1315</span>      <a class="code hl_variable" href="classSampleSummary.html#abc8205a6fddca44ed7c5b3e5c50612e7">llh_drawfluc_pred</a>[SampleNum]  += DrawFlucPredLLH;</div>
<div class="line"><span class="lineno"> 1316</span>      total_llh_drawfluc_pred_temp  += DrawFlucPredLLH;</div>
<div class="line"><span class="lineno"> 1317</span> </div>
<div class="line"><span class="lineno"> 1318</span>      <span class="comment">// Likelihood between drawn histogram and fluctuated drawn histogram</span></div>
<div class="line"><span class="lineno"> 1319</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> DrawFlucPredFlucLLH = <a class="code hl_function" href="classSampleSummary.html#ad027b0716b707691e6a9565ee497b66f">GetLLH</a>(FluctDrawHist[SampleNum], FluctHist[SampleNum], <a class="code hl_variable" href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">W2MeanHist</a>[SampleNum]);</div>
<div class="line"><span class="lineno"> 1320</span>      <a class="code hl_variable" href="classSampleSummary.html#a642d0e2bb5bc0729744684a3f8bbc459">llh_drawfluc_predfluc</a>[SampleNum] += DrawFlucPredFlucLLH;</div>
<div class="line"><span class="lineno"> 1321</span>      total_llh_drawfluc_predfluc_temp += DrawFlucPredFlucLLH;</div>
<div class="line"><span class="lineno"> 1322</span> </div>
<div class="line"><span class="lineno"> 1323</span>      <span class="comment">// Likelihood between the fluctuated drawn histogram and the posterior predictive</span></div>
<div class="line"><span class="lineno"> 1324</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> PredFlucPredLLH = <a class="code hl_function" href="classSampleSummary.html#ad027b0716b707691e6a9565ee497b66f">GetLLH</a>(FluctHist[SampleNum], <a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[SampleNum], <a class="code hl_variable" href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">W2MeanHist</a>[SampleNum]);</div>
<div class="line"><span class="lineno"> 1325</span>      <a class="code hl_variable" href="classSampleSummary.html#a464faf180667c999aec72c140ddb515a">llh_predfluc_pred</a>[SampleNum] += PredFlucPredLLH;</div>
<div class="line"><span class="lineno"> 1326</span>      total_llh_predfluc_pred_temp += PredFlucPredLLH;</div>
<div class="line"><span class="lineno"> 1327</span> </div>
<div class="line"><span class="lineno"> 1328</span>      <span class="comment">// Likelihood between fluctuated data histogram and drawn histogram </span></div>
<div class="line"><span class="lineno"> 1329</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> DataFlucDrawLLH = <a class="code hl_function" href="classSampleSummary.html#ad027b0716b707691e6a9565ee497b66f">GetLLH</a>(DataFlucHist[SampleNum], DrawHist, DrawW2Hist);</div>
<div class="line"><span class="lineno"> 1330</span>      <a class="code hl_variable" href="classSampleSummary.html#abe225db63f8137df4b74d138ab1eb6f2">llh_datafluc_draw</a>[SampleNum] += DataFlucDrawLLH;</div>
<div class="line"><span class="lineno"> 1331</span>      total_llh_datafluc_draw_temp += DataFlucDrawLLH;</div>
<div class="line"><span class="lineno"> 1332</span> </div>
<div class="line"><span class="lineno"> 1333</span>      <a class="code hl_variable" href="classSampleSummary.html#aa61561a1e3594ac9250aaee26409245e">lnLHist_Sample_DrawData</a>[SampleNum]-&gt;Fill(DataDrawLLH);</div>
<div class="line"><span class="lineno"> 1334</span>      <a class="code hl_variable" href="classSampleSummary.html#afddd2abc0ec07b52dc9004880522ab5a">lnLHist_Sample_DrawflucDraw</a>[SampleNum]-&gt;Fill(DrawFlucDrawLLH);</div>
<div class="line"><span class="lineno"> 1335</span>      <a class="code hl_variable" href="classSampleSummary.html#aecf1c224162e1055e8306d438e1a3761">lnLHist_Sample_PredflucDraw</a>[SampleNum]-&gt;Fill(PredFlucDrawLLH);</div>
<div class="line"><span class="lineno"> 1336</span>      </div>
<div class="line"><span class="lineno"> 1337</span><span class="comment">//    At the end we leave LLH for 1D projections</span></div>
<div class="line"><span class="lineno"> 1338</span>      <a class="code hl_function" href="classSampleSummary.html#ada2f0b7b9b7bb687e67023e84151610e">MakeFluctuatedHistogram</a>(FluctDrawHistProjectX[SampleNum], DrawHistProjectX[SampleNum]);</div>
<div class="line"><span class="lineno"> 1339</span>      </div>
<div class="line"><span class="lineno"> 1340</span>      <span class="comment">// Likelihood between the drawn histogram and the data for muon momentum</span></div>
<div class="line"><span class="lineno"> 1341</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> DataDrawLLH_ProjectX = <a class="code hl_function" href="classSampleSummary.html#ad027b0716b707691e6a9565ee497b66f">GetLLH</a>(<a class="code hl_variable" href="classSampleSummary.html#abeaca1195db794d9e660a377d81c1b21">DataHist_ProjectX</a>[SampleNum], DrawHistProjectX[SampleNum], DrawW2HistProjectX[SampleNum]);</div>
<div class="line"><span class="lineno"> 1342</span>      <a class="code hl_variable" href="classSampleSummary.html#a083eb13c61fe7d1b88b2ebe845312640">llh_data_draw_ProjectX</a>[SampleNum] += DataDrawLLH_ProjectX;</div>
<div class="line"><span class="lineno"> 1343</span>      total_llh_data_draw_ProjectX_temp += DataDrawLLH_ProjectX;</div>
<div class="line"><span class="lineno"> 1344</span>      </div>
<div class="line"><span class="lineno"> 1345</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> DrawFlucDrawLLH_ProjectX = <a class="code hl_function" href="classSampleSummary.html#ad027b0716b707691e6a9565ee497b66f">GetLLH</a>(FluctDrawHistProjectX[SampleNum], DrawHistProjectX[SampleNum], DrawW2HistProjectX[SampleNum]);</div>
<div class="line"><span class="lineno"> 1346</span>      <a class="code hl_variable" href="classSampleSummary.html#a81be1b29e649529930276daab33f7b69">llh_drawfluc_draw_ProjectX</a>[SampleNum] += DrawFlucDrawLLH_ProjectX;</div>
<div class="line"><span class="lineno"> 1347</span>      total_llh_drawfluc_draw_ProjectX_temp += DrawFlucDrawLLH_ProjectX;</div>
<div class="line"><span class="lineno"> 1348</span>      </div>
<div class="line"><span class="lineno"> 1349</span>      <span class="comment">//KS: This might seem complicated but we make X and Y projection for each sample. Then we add this to the Violin plot making nice Gaussian in each kineatmical bin of x and y axis</span></div>
<div class="line"><span class="lineno"> 1350</span>      <a class="code hl_function" href="classSampleSummary.html#a90fbcfacacf629b0b5f0de3fdab3fdfd">FastViolinFill</a>(<a class="code hl_variable" href="classSampleSummary.html#a4a93fa8d52abe2828a4a25e49cf6fee8">ViolinHists_ProjectX</a>[SampleNum], DrawHistProjectX[SampleNum]);</div>
<div class="line"><span class="lineno"> 1351</span>      <a class="code hl_function" href="classSampleSummary.html#a90fbcfacacf629b0b5f0de3fdab3fdfd">FastViolinFill</a>(<a class="code hl_variable" href="classSampleSummary.html#a93714cf9b778fa7713a641da0cd2d534">ViolinHists_ProjectY</a>[SampleNum], DrawHistProjectY[SampleNum]);</div>
<div class="line"><span class="lineno"> 1352</span>    } <span class="comment">// End loop over samples (still looping throws)</span></div>
<div class="line"><span class="lineno"> 1353</span> </div>
<div class="line"><span class="lineno"> 1354</span>    <span class="comment">// Delete the temporary histograms</span></div>
<div class="line"><span class="lineno"> 1355</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> SampleNum = 0;  SampleNum &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++SampleNum)</div>
<div class="line"><span class="lineno"> 1356</span>    {</div>
<div class="line"><span class="lineno"> 1357</span>      <span class="keyword">delete</span> FluctHist[SampleNum];</div>
<div class="line"><span class="lineno"> 1358</span>      <span class="keyword">delete</span> FluctDrawHist[SampleNum];</div>
<div class="line"><span class="lineno"> 1359</span>      <span class="keyword">delete</span> DataFlucHist[SampleNum];</div>
<div class="line"><span class="lineno"> 1360</span>      <span class="keyword">delete</span> FluctDrawHistProjectX[SampleNum];</div>
<div class="line"><span class="lineno"> 1361</span>      <span class="keyword">delete</span> DrawHistProjectX[SampleNum];</div>
<div class="line"><span class="lineno"> 1362</span>      <span class="keyword">delete</span> DrawHistProjectY[SampleNum];</div>
<div class="line"><span class="lineno"> 1363</span>      <span class="keyword">delete</span> DrawW2HistProjectX[SampleNum];</div>
<div class="line"><span class="lineno"> 1364</span>    }</div>
<div class="line"><span class="lineno"> 1365</span> </div>
<div class="line"><span class="lineno"> 1366</span>    <a class="code hl_variable" href="classSampleSummary.html#a2cb3d8dcbab49b62be3bc2a4a7e4d5f3">total_llh_data_draw</a> = total_llh_data_draw_temp;</div>
<div class="line"><span class="lineno"> 1367</span>    <a class="code hl_variable" href="classSampleSummary.html#a7e418146cce2c4201c3aa7e1eaad4a38">total_llh_drawfluc_draw</a> = total_llh_drawfluc_draw_temp;</div>
<div class="line"><span class="lineno"> 1368</span>    <a class="code hl_variable" href="classSampleSummary.html#a804a117990fd1441c9e3a9d8e8d32e98">total_llh_predfluc_draw</a> = total_llh_predfluc_draw_temp;</div>
<div class="line"><span class="lineno"> 1369</span> </div>
<div class="line"><span class="lineno"> 1370</span>    <a class="code hl_variable" href="classSampleSummary.html#aaf055562efe3e5f2592942f5151ece22">total_llh_rate_data_draw</a> = total_llh_rate_data_draw_temp;</div>
<div class="line"><span class="lineno"> 1371</span>    <a class="code hl_variable" href="classSampleSummary.html#a2ebe701d114669fdfcf61e1680bb144d">total_llh_rate_predfluc_draw</a> = total_llh_rate_predfluc_draw_temp;</div>
<div class="line"><span class="lineno"> 1372</span> </div>
<div class="line"><span class="lineno"> 1373</span>    <a class="code hl_variable" href="classSampleSummary.html#a670c890357fd77997279c83c197f989c">total_llh_data_drawfluc</a> = total_llh_data_drawfluc_temp;</div>
<div class="line"><span class="lineno"> 1374</span>    <a class="code hl_variable" href="classSampleSummary.html#aeee48af77dc4e0beee5eab13c30f3d38">total_llh_data_predfluc</a> = total_llh_data_predfluc_temp;</div>
<div class="line"><span class="lineno"> 1375</span>    <a class="code hl_variable" href="classSampleSummary.html#a58efe34df7c43fb40d211036e30a1b5d">total_llh_draw_pred</a> = total_llh_draw_pred_temp;</div>
<div class="line"><span class="lineno"> 1376</span>    <a class="code hl_variable" href="classSampleSummary.html#a9c8b444ac7f80a5af63d5b9f4a150b79">total_llh_drawfluc_pred</a> = total_llh_drawfluc_pred_temp;</div>
<div class="line"><span class="lineno"> 1377</span>    <a class="code hl_variable" href="classSampleSummary.html#af92a42a666e1bfcb2dc761ffa2253b7e">total_llh_drawfluc_predfluc</a> = total_llh_drawfluc_predfluc_temp;</div>
<div class="line"><span class="lineno"> 1378</span>    <a class="code hl_variable" href="classSampleSummary.html#a1f6c2e7ed8f9024cf928da5b56054e07">total_llh_predfluc_pred</a> = total_llh_predfluc_pred_temp;</div>
<div class="line"><span class="lineno"> 1379</span>    <a class="code hl_variable" href="classSampleSummary.html#af9e5d89095e6c6a81aedb5ea2402e3fb">total_llh_datafluc_draw</a> = total_llh_datafluc_draw_temp;</div>
<div class="line"><span class="lineno"> 1380</span> </div>
<div class="line"><span class="lineno"> 1381</span>    <a class="code hl_variable" href="classSampleSummary.html#a5a973692db89f52c19c9195ffe95c9a1">total_llh_data_draw_ProjectX</a> = total_llh_data_draw_ProjectX_temp;</div>
<div class="line"><span class="lineno"> 1382</span>    <a class="code hl_variable" href="classSampleSummary.html#a22df11667306c7892f9ed3f8935a5c9e">total_llh_drawfluc_draw_ProjectX</a> = total_llh_drawfluc_draw_ProjectX_temp;</div>
<div class="line"><span class="lineno"> 1383</span> </div>
<div class="line"><span class="lineno"> 1384</span>    <span class="comment">// Add LLH penalties from the systematics to the LLH that use the drawn histogram</span></div>
<div class="line"><span class="lineno"> 1385</span>    <a class="code hl_variable" href="classSampleSummary.html#a2cb3d8dcbab49b62be3bc2a4a7e4d5f3">total_llh_data_draw</a>     += <a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a>;</div>
<div class="line"><span class="lineno"> 1386</span>    <a class="code hl_variable" href="classSampleSummary.html#a7e418146cce2c4201c3aa7e1eaad4a38">total_llh_drawfluc_draw</a> += <a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a>;</div>
<div class="line"><span class="lineno"> 1387</span>    <a class="code hl_variable" href="classSampleSummary.html#a804a117990fd1441c9e3a9d8e8d32e98">total_llh_predfluc_draw</a> += <a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a>;</div>
<div class="line"><span class="lineno"> 1388</span>    <span class="comment">//Rate based</span></div>
<div class="line"><span class="lineno"> 1389</span>    <a class="code hl_variable" href="classSampleSummary.html#aaf055562efe3e5f2592942f5151ece22">total_llh_rate_data_draw</a> += <a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a>;</div>
<div class="line"><span class="lineno"> 1390</span>    <a class="code hl_variable" href="classSampleSummary.html#a2ebe701d114669fdfcf61e1680bb144d">total_llh_rate_predfluc_draw</a> += <a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a>;</div>
<div class="line"><span class="lineno"> 1391</span> </div>
<div class="line"><span class="lineno"> 1392</span>    <a class="code hl_variable" href="classSampleSummary.html#a670c890357fd77997279c83c197f989c">total_llh_data_drawfluc</a> += <a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a>;</div>
<div class="line"><span class="lineno"> 1393</span>    <a class="code hl_variable" href="classSampleSummary.html#a58efe34df7c43fb40d211036e30a1b5d">total_llh_draw_pred</a>     += <a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a>;</div>
<div class="line"><span class="lineno"> 1394</span>    <a class="code hl_variable" href="classSampleSummary.html#a9c8b444ac7f80a5af63d5b9f4a150b79">total_llh_drawfluc_pred</a> += <a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a>;</div>
<div class="line"><span class="lineno"> 1395</span>    <a class="code hl_variable" href="classSampleSummary.html#af92a42a666e1bfcb2dc761ffa2253b7e">total_llh_drawfluc_predfluc</a> += <a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a>;</div>
<div class="line"><span class="lineno"> 1396</span> </div>
<div class="line"><span class="lineno"> 1397</span>    <a class="code hl_variable" href="classSampleSummary.html#a5a973692db89f52c19c9195ffe95c9a1">total_llh_data_draw_ProjectX</a> += <a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a>;</div>
<div class="line"><span class="lineno"> 1398</span>    <a class="code hl_variable" href="classSampleSummary.html#a22df11667306c7892f9ed3f8935a5c9e">total_llh_drawfluc_draw_ProjectX</a> += <a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a>;</div>
<div class="line"><span class="lineno"> 1399</span> </div>
<div class="line"><span class="lineno"> 1400</span>    <a class="code hl_variable" href="classSampleSummary.html#a70b109c60b7c82a3e36708bd2674cb5e">lnLHist</a>-&gt;Fill(<a class="code hl_variable" href="classSampleSummary.html#a1f6c2e7ed8f9024cf928da5b56054e07">total_llh_predfluc_pred</a>);</div>
<div class="line"><span class="lineno"> 1401</span>    <a class="code hl_variable" href="classSampleSummary.html#aaf23ed9a699d625adc8639a57de801e8">lnLHist_drawdata</a>-&gt;Fill(<a class="code hl_variable" href="classSampleSummary.html#a2cb3d8dcbab49b62be3bc2a4a7e4d5f3">total_llh_data_draw</a>);</div>
<div class="line"><span class="lineno"> 1402</span>    <a class="code hl_variable" href="classSampleSummary.html#aead1702a4c1522e685a8af5a875f05ab">lnLHist_drawfluc</a>-&gt;Fill(<a class="code hl_variable" href="classSampleSummary.html#a804a117990fd1441c9e3a9d8e8d32e98">total_llh_predfluc_draw</a>);</div>
<div class="line"><span class="lineno"> 1403</span>    <a class="code hl_variable" href="classSampleSummary.html#aa6f15a5750ae0224168d487e44ad3d94">lnLHist_drawflucdraw</a>-&gt;Fill(<a class="code hl_variable" href="classSampleSummary.html#a7e418146cce2c4201c3aa7e1eaad4a38">total_llh_drawfluc_draw</a>);</div>
<div class="line"><span class="lineno"> 1404</span> </div>
<div class="line"><span class="lineno"> 1405</span>    <a class="code hl_variable" href="classSampleSummary.html#a8c7537f32164be9192f8ba2b12a69cdb">lnLDrawHist</a>-&gt;Fill(<a class="code hl_variable" href="classSampleSummary.html#a804a117990fd1441c9e3a9d8e8d32e98">total_llh_predfluc_draw</a>, <a class="code hl_variable" href="classSampleSummary.html#a2cb3d8dcbab49b62be3bc2a4a7e4d5f3">total_llh_data_draw</a>);</div>
<div class="line"><span class="lineno"> 1406</span>    <a class="code hl_variable" href="classSampleSummary.html#ae1aafef6414eafb5572893dded50a1b1">lnLFlucHist</a>-&gt;Fill(<a class="code hl_variable" href="classSampleSummary.html#a7e418146cce2c4201c3aa7e1eaad4a38">total_llh_drawfluc_draw</a>, <a class="code hl_variable" href="classSampleSummary.html#a2cb3d8dcbab49b62be3bc2a4a7e4d5f3">total_llh_data_draw</a>);</div>
<div class="line"><span class="lineno"> 1407</span> </div>
<div class="line"><span class="lineno"> 1408</span>    <a class="code hl_variable" href="classSampleSummary.html#aae188cf135af004d5364e5b4f3b1bb31">lnLDrawHistRate</a>-&gt;Fill(<a class="code hl_variable" href="classSampleSummary.html#a2ebe701d114669fdfcf61e1680bb144d">total_llh_rate_predfluc_draw</a>, <a class="code hl_variable" href="classSampleSummary.html#aaf055562efe3e5f2592942f5151ece22">total_llh_rate_data_draw</a>);</div>
<div class="line"><span class="lineno"> 1409</span> </div>
<div class="line"><span class="lineno"> 1410</span>    <a class="code hl_variable" href="classSampleSummary.html#ae509f51ec2d0323e005e05c255bc0c1f">lnLFlucHist_ProjectX</a>-&gt;Fill(<a class="code hl_variable" href="classSampleSummary.html#a22df11667306c7892f9ed3f8935a5c9e">total_llh_drawfluc_draw_ProjectX</a>, <a class="code hl_variable" href="classSampleSummary.html#a5a973692db89f52c19c9195ffe95c9a1">total_llh_data_draw_ProjectX</a>);</div>
<div class="line"><span class="lineno"> 1411</span>    </div>
<div class="line"><span class="lineno"> 1412</span>    <span class="comment">// Also save to arrays to make sure we have the utmost super accuracy</span></div>
<div class="line"><span class="lineno"> 1413</span>    LLH_PredFluc_V[i] = <a class="code hl_variable" href="classSampleSummary.html#a804a117990fd1441c9e3a9d8e8d32e98">total_llh_predfluc_draw</a>;</div>
<div class="line"><span class="lineno"> 1414</span>    LLH_DataDraw_V[i] = <a class="code hl_variable" href="classSampleSummary.html#a2cb3d8dcbab49b62be3bc2a4a7e4d5f3">total_llh_data_draw</a>;</div>
<div class="line"><span class="lineno"> 1415</span>    LLH_DrawFlucDraw_V[i] = <a class="code hl_variable" href="classSampleSummary.html#a7e418146cce2c4201c3aa7e1eaad4a38">total_llh_drawfluc_draw</a>;</div>
<div class="line"><span class="lineno"> 1416</span> </div>
<div class="line"><span class="lineno"> 1417</span>    <span class="comment">// Write to the output tree</span></div>
<div class="line"><span class="lineno"> 1418</span>    <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Fill();</div>
<div class="line"><span class="lineno"> 1419</span>  } <span class="comment">// End loop over throws</span></div>
<div class="line"><span class="lineno"> 1420</span> </div>
<div class="line"><span class="lineno"> 1421</span>  AveragePenalty = AveragePenalty/double(<a class="code hl_variable" href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">nThrows</a>);</div>
<div class="line"><span class="lineno"> 1422</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Average LLH penalty over toys is {:.2f}&quot;</span>, AveragePenalty);</div>
<div class="line"><span class="lineno"> 1423</span>  <span class="comment">// Calculate exact p-value instead of binned</span></div>
<div class="line"><span class="lineno"> 1424</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Accept_PredFluc = 0;</div>
<div class="line"><span class="lineno"> 1425</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Accept_DrawFluc = 0;</div>
<div class="line"><span class="lineno"> 1426</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">nThrows</a>; ++i)</div>
<div class="line"><span class="lineno"> 1427</span>  {</div>
<div class="line"><span class="lineno"> 1428</span>    <span class="keywordflow">if</span> (LLH_DataDraw_V[i] &gt; LLH_DrawFlucDraw_V[i]) Accept_DrawFluc++;</div>
<div class="line"><span class="lineno"> 1429</span>    <span class="keywordflow">if</span> (LLH_DataDraw_V[i] &gt; LLH_PredFluc_V[i]) Accept_PredFluc++;</div>
<div class="line"><span class="lineno"> 1430</span>  }</div>
<div class="line"><span class="lineno"> 1431</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> pvalue_DrawFluc = double(Accept_DrawFluc)/double(<a class="code hl_variable" href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">nThrows</a>);</div>
<div class="line"><span class="lineno"> 1432</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> pvalue_PredFluc = double(Accept_PredFluc)/double(<a class="code hl_variable" href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">nThrows</a>);</div>
<div class="line"><span class="lineno"> 1433</span> </div>
<div class="line"><span class="lineno"> 1434</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Calculated exact p-value using Fluctuation of Draw: {:.2f}&quot;</span>, pvalue_DrawFluc);</div>
<div class="line"><span class="lineno"> 1435</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Calculated exact p-value using Fluctuation of Prediction: {:.2f}&quot;</span>, pvalue_PredFluc);</div>
<div class="line"><span class="lineno"> 1436</span>}</div>
<div class="ttc" id="aclassSampleSummary_html_a083eb13c61fe7d1b88b2ebe845312640"><div class="ttname"><a href="classSampleSummary.html#a083eb13c61fe7d1b88b2ebe845312640">SampleSummary::llh_data_draw_ProjectX</a></div><div class="ttdeci">std::vector&lt; double &gt; llh_data_draw_ProjectX</div><div class="ttdoc">Projection X (most likely muon momentum) of LLH.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00321">SampleSummary.h:321</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a107a3073ee178eff7107ccd5f41b91c5"><div class="ttname"><a href="classSampleSummary.html#a107a3073ee178eff7107ccd5f41b91c5">SampleSummary::llh_predfluc_draw</a></div><div class="ttdeci">std::vector&lt; double &gt; llh_predfluc_draw</div><div class="ttdoc">Fluctuated Predictive vs Draw.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00297">SampleSummary.h:297</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a1f6c2e7ed8f9024cf928da5b56054e07"><div class="ttname"><a href="classSampleSummary.html#a1f6c2e7ed8f9024cf928da5b56054e07">SampleSummary::total_llh_predfluc_pred</a></div><div class="ttdeci">double total_llh_predfluc_pred</div><div class="ttdoc">Fluctuated Predictive vs Predictive.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00352">SampleSummary.h:352</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a22df11667306c7892f9ed3f8935a5c9e"><div class="ttname"><a href="classSampleSummary.html#a22df11667306c7892f9ed3f8935a5c9e">SampleSummary::total_llh_drawfluc_draw_ProjectX</a></div><div class="ttdeci">double total_llh_drawfluc_draw_ProjectX</div><div class="ttdoc">Fluctuated Draw vs Draw for projection X (most likely muon momentum)</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00357">SampleSummary.h:357</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a2cb3d8dcbab49b62be3bc2a4a7e4d5f3"><div class="ttname"><a href="classSampleSummary.html#a2cb3d8dcbab49b62be3bc2a4a7e4d5f3">SampleSummary::total_llh_data_draw</a></div><div class="ttdeci">double total_llh_data_draw</div><div class="ttdoc">Data vs Draw.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00328">SampleSummary.h:328</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a2ebe701d114669fdfcf61e1680bb144d"><div class="ttname"><a href="classSampleSummary.html#a2ebe701d114669fdfcf61e1680bb144d">SampleSummary::total_llh_rate_predfluc_draw</a></div><div class="ttdeci">double total_llh_rate_predfluc_draw</div><div class="ttdoc">Fluctuated Predictive vs Draw using Rate.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00337">SampleSummary.h:337</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a325a83aec886a90ed6d4c96ccf573c56"><div class="ttname"><a href="classSampleSummary.html#a325a83aec886a90ed6d4c96ccf573c56">SampleSummary::llh_data_predfluc</a></div><div class="ttdeci">std::vector&lt; double &gt; llh_data_predfluc</div><div class="ttdoc">Data vs Fluctuated Predictive.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00307">SampleSummary.h:307</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a464faf180667c999aec72c140ddb515a"><div class="ttname"><a href="classSampleSummary.html#a464faf180667c999aec72c140ddb515a">SampleSummary::llh_predfluc_pred</a></div><div class="ttdeci">std::vector&lt; double &gt; llh_predfluc_pred</div><div class="ttdoc">Fluctuated Predictive vs Predictive.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00314">SampleSummary.h:314</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a58efe34df7c43fb40d211036e30a1b5d"><div class="ttname"><a href="classSampleSummary.html#a58efe34df7c43fb40d211036e30a1b5d">SampleSummary::total_llh_draw_pred</a></div><div class="ttdeci">double total_llh_draw_pred</div><div class="ttdoc">Draw vs Predictive.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00344">SampleSummary.h:344</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a596fc0b5e504bf382c342e950dd7cb95"><div class="ttname"><a href="classSampleSummary.html#a596fc0b5e504bf382c342e950dd7cb95">SampleSummary::llh_drawfluc_draw</a></div><div class="ttdeci">std::vector&lt; double &gt; llh_drawfluc_draw</div><div class="ttdoc">Fluctuated Draw vs Draw.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00295">SampleSummary.h:295</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a5a973692db89f52c19c9195ffe95c9a1"><div class="ttname"><a href="classSampleSummary.html#a5a973692db89f52c19c9195ffe95c9a1">SampleSummary::total_llh_data_draw_ProjectX</a></div><div class="ttdeci">double total_llh_data_draw_ProjectX</div><div class="ttdoc">Data vs Draw for projection X (most likely muon momentum)</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00355">SampleSummary.h:355</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a642d0e2bb5bc0729744684a3f8bbc459"><div class="ttname"><a href="classSampleSummary.html#a642d0e2bb5bc0729744684a3f8bbc459">SampleSummary::llh_drawfluc_predfluc</a></div><div class="ttdeci">std::vector&lt; double &gt; llh_drawfluc_predfluc</div><div class="ttdoc">Fluctuated Draw vs Fluctuated Predictive.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00316">SampleSummary.h:316</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a668c1a7ce4ef8592eae4a91ef99c60dc"><div class="ttname"><a href="classSampleSummary.html#a668c1a7ce4ef8592eae4a91ef99c60dc">SampleSummary::llh_data_draw</a></div><div class="ttdeci">std::vector&lt; double &gt; llh_data_draw</div><div class="ttdoc">Data vs Draw.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00293">SampleSummary.h:293</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a670c890357fd77997279c83c197f989c"><div class="ttname"><a href="classSampleSummary.html#a670c890357fd77997279c83c197f989c">SampleSummary::total_llh_data_drawfluc</a></div><div class="ttdeci">double total_llh_data_drawfluc</div><div class="ttdoc">Data vs Fluctuated Draw.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00342">SampleSummary.h:342</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a7e418146cce2c4201c3aa7e1eaad4a38"><div class="ttname"><a href="classSampleSummary.html#a7e418146cce2c4201c3aa7e1eaad4a38">SampleSummary::total_llh_drawfluc_draw</a></div><div class="ttdeci">double total_llh_drawfluc_draw</div><div class="ttdoc">Fluctuated Draw vs Draw.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00330">SampleSummary.h:330</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a7f46ee13ef20275c5dc162196190984b"><div class="ttname"><a href="classSampleSummary.html#a7f46ee13ef20275c5dc162196190984b">SampleSummary::llh_draw_pred</a></div><div class="ttdeci">std::vector&lt; double &gt; llh_draw_pred</div><div class="ttdoc">Draw vs Predictive.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00309">SampleSummary.h:309</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a804a117990fd1441c9e3a9d8e8d32e98"><div class="ttname"><a href="classSampleSummary.html#a804a117990fd1441c9e3a9d8e8d32e98">SampleSummary::total_llh_predfluc_draw</a></div><div class="ttdeci">double total_llh_predfluc_draw</div><div class="ttdoc">Fluctuated Predictive vs Draw.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00332">SampleSummary.h:332</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a81be1b29e649529930276daab33f7b69"><div class="ttname"><a href="classSampleSummary.html#a81be1b29e649529930276daab33f7b69">SampleSummary::llh_drawfluc_draw_ProjectX</a></div><div class="ttdeci">std::vector&lt; double &gt; llh_drawfluc_draw_ProjectX</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00322">SampleSummary.h:322</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a90fbcfacacf629b0b5f0de3fdab3fdfd"><div class="ttname"><a href="classSampleSummary.html#a90fbcfacacf629b0b5f0de3fdab3fdfd">SampleSummary::FastViolinFill</a></div><div class="ttdeci">void FastViolinFill(TH2D *violin, TH1D *hist_1d)</div><div class="ttdoc">KS: Fill Violin histogram with entry from a toy.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8cpp_source.html#l02597">SampleSummary.cpp:2597</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a999cbd0982694a364f8706ca2b435d81"><div class="ttname"><a href="classSampleSummary.html#a999cbd0982694a364f8706ca2b435d81">SampleSummary::llh_data_drawfluc</a></div><div class="ttdeci">std::vector&lt; double &gt; llh_data_drawfluc</div><div class="ttdoc">Data vs Fluctuated Draw.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00305">SampleSummary.h:305</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a9c8b444ac7f80a5af63d5b9f4a150b79"><div class="ttname"><a href="classSampleSummary.html#a9c8b444ac7f80a5af63d5b9f4a150b79">SampleSummary::total_llh_drawfluc_pred</a></div><div class="ttdeci">double total_llh_drawfluc_pred</div><div class="ttdoc">Fluctuated Draw vs Predictive.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00346">SampleSummary.h:346</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_aa27591c1aff4c4e8e25fbf9c13ae37c5"><div class="ttname"><a href="classSampleSummary.html#aa27591c1aff4c4e8e25fbf9c13ae37c5">SampleSummary::llh_rate_predfluc_draw</a></div><div class="ttdeci">std::vector&lt; double &gt; llh_rate_predfluc_draw</div><div class="ttdoc">Fluctuated Predictive vs Draw using rate only.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00302">SampleSummary.h:302</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_aaf055562efe3e5f2592942f5151ece22"><div class="ttname"><a href="classSampleSummary.html#aaf055562efe3e5f2592942f5151ece22">SampleSummary::total_llh_rate_data_draw</a></div><div class="ttdeci">double total_llh_rate_data_draw</div><div class="ttdoc">Rate Data vs Draw.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00335">SampleSummary.h:335</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_abc8205a6fddca44ed7c5b3e5c50612e7"><div class="ttname"><a href="classSampleSummary.html#abc8205a6fddca44ed7c5b3e5c50612e7">SampleSummary::llh_drawfluc_pred</a></div><div class="ttdeci">std::vector&lt; double &gt; llh_drawfluc_pred</div><div class="ttdoc">Fluctuated Draw vs Predictive.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00311">SampleSummary.h:311</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_abe225db63f8137df4b74d138ab1eb6f2"><div class="ttname"><a href="classSampleSummary.html#abe225db63f8137df4b74d138ab1eb6f2">SampleSummary::llh_datafluc_draw</a></div><div class="ttdeci">std::vector&lt; double &gt; llh_datafluc_draw</div><div class="ttdoc">Fluctuated Data vs Draw.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00318">SampleSummary.h:318</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_ada2f0b7b9b7bb687e67023e84151610e"><div class="ttname"><a href="classSampleSummary.html#ada2f0b7b9b7bb687e67023e84151610e">SampleSummary::MakeFluctuatedHistogram</a></div><div class="ttdeci">void MakeFluctuatedHistogram(TH1D *FluctHist, TH1D *PolyHist)</div><div class="ttdoc">Make Poisson fluctuation of TH1D hist.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8cpp_source.html#l02284">SampleSummary.cpp:2284</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_adae47fb3a91f5946c7329c6e3643ae9a"><div class="ttname"><a href="classSampleSummary.html#adae47fb3a91f5946c7329c6e3643ae9a">SampleSummary::llh_rate_data_draw</a></div><div class="ttdeci">std::vector&lt; double &gt; llh_rate_data_draw</div><div class="ttdoc">Data vs Draw using rate only.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00300">SampleSummary.h:300</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_aeee48af77dc4e0beee5eab13c30f3d38"><div class="ttname"><a href="classSampleSummary.html#aeee48af77dc4e0beee5eab13c30f3d38">SampleSummary::total_llh_data_predfluc</a></div><div class="ttdeci">double total_llh_data_predfluc</div><div class="ttdoc">Data vs Fluctuated Predictive.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00340">SampleSummary.h:340</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_aef70c5ef9c8432dc42ff7f6c73c7e8d5"><div class="ttname"><a href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">SampleSummary::llh_penalty</a></div><div class="ttdeci">double llh_penalty</div><div class="ttdoc">LLH penalty for each throw.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00325">SampleSummary.h:325</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_af92a42a666e1bfcb2dc761ffa2253b7e"><div class="ttname"><a href="classSampleSummary.html#af92a42a666e1bfcb2dc761ffa2253b7e">SampleSummary::total_llh_drawfluc_predfluc</a></div><div class="ttdeci">double total_llh_drawfluc_predfluc</div><div class="ttdoc">Fluctuated Draw vs Fluctuated Predictive.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00348">SampleSummary.h:348</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_af9e5d89095e6c6a81aedb5ea2402e3fb"><div class="ttname"><a href="classSampleSummary.html#af9e5d89095e6c6a81aedb5ea2402e3fb">SampleSummary::total_llh_datafluc_draw</a></div><div class="ttdeci">double total_llh_datafluc_draw</div><div class="ttdoc">Fluctuated Data vs Draw.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00350">SampleSummary.h:350</a></div></div>
<div class="ttc" id="anamespaceMaCh3Utils_html_a4c8bdeb1d34606aed192e9f1311a72f5"><div class="ttname"><a href="namespaceMaCh3Utils.html#a4c8bdeb1d34606aed192e9f1311a72f5">MaCh3Utils::PrintProgressBar</a></div><div class="ttdeci">void PrintProgressBar(const Long64_t Done, const Long64_t All)</div><div class="ttdoc">KS: Simply print progress bar.</div><div class="ttdef"><b>Definition:</b> <a href="Monitor_8cpp_source.html#l00189">Monitor.cpp:189</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e21a2b9fd429261e378f4e505ba2f75" name="a0e21a2b9fd429261e378f4e505ba2f75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e21a2b9fd429261e378f4e505ba2f75">&#9670;&#160;</a></span>MakeCutEventRate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::MakeCutEventRate </td>
          <td>(</td>
          <td class="paramtype">TH1D *&#160;</td>
          <td class="paramname"><em>Histogram</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>DataRate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Make the 1D Event Rate Hist. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l01572">1572</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1572</span>                                                                           {</div>
<div class="line"><span class="lineno"> 1573</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 1574</span>  <span class="comment">// For the event rate histogram add a TLine to the data rate</span></div>
<div class="line"><span class="lineno"> 1575</span>  <span class="keyword">auto</span> TempLine = std::make_unique&lt;TLine&gt;(DataRate, Histogram-&gt;GetMinimum(), DataRate, Histogram-&gt;GetMaximum());</div>
<div class="line"><span class="lineno"> 1576</span>  TempLine-&gt;SetLineColor(kRed);</div>
<div class="line"><span class="lineno"> 1577</span>  TempLine-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno"> 1578</span>  <span class="comment">// Also fit a Gaussian because why not?</span></div>
<div class="line"><span class="lineno"> 1579</span>  TF1 *Fitter = <span class="keyword">new</span> TF1(<span class="stringliteral">&quot;Fit&quot;</span>, <span class="stringliteral">&quot;gaus&quot;</span>, Histogram-&gt;GetBinLowEdge(1), Histogram-&gt;GetBinLowEdge(Histogram-&gt;GetNbinsX()+1));</div>
<div class="line"><span class="lineno"> 1580</span>  Histogram-&gt;Fit(Fitter, <span class="stringliteral">&quot;RQ&quot;</span>);</div>
<div class="line"><span class="lineno"> 1581</span>  Fitter-&gt;SetLineColor(kRed-5);</div>
<div class="line"><span class="lineno"> 1582</span>  <span class="comment">// Calculate a p-value</span></div>
<div class="line"><span class="lineno"> 1583</span>  <span class="keywordtype">double</span> Above = 0.0;</div>
<div class="line"><span class="lineno"> 1584</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> z = 0; z &lt; Histogram-&gt;GetNbinsX(); ++z) {</div>
<div class="line"><span class="lineno"> 1585</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> xvalue = Histogram-&gt;GetBinCenter(z+1);</div>
<div class="line"><span class="lineno"> 1586</span>    <span class="keywordflow">if</span> (xvalue &gt;= DataRate) {</div>
<div class="line"><span class="lineno"> 1587</span>      Above += Histogram-&gt;GetBinContent(z+1);</div>
<div class="line"><span class="lineno"> 1588</span>    }</div>
<div class="line"><span class="lineno"> 1589</span>  }</div>
<div class="line"><span class="lineno"> 1590</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> pvalue = Above/Histogram-&gt;Integral();</div>
<div class="line"><span class="lineno"> 1591</span>  <span class="keyword">auto</span> Legend = std::make_unique&lt;TLegend&gt;(0.4, 0.75, 0.98, 0.90);</div>
<div class="line"><span class="lineno"> 1592</span>  Legend-&gt;SetFillColor(0);</div>
<div class="line"><span class="lineno"> 1593</span>  Legend-&gt;SetFillStyle(0);</div>
<div class="line"><span class="lineno"> 1594</span>  Legend-&gt;SetLineWidth(0);</div>
<div class="line"><span class="lineno"> 1595</span>  Legend-&gt;SetLineColor(0);</div>
<div class="line"><span class="lineno"> 1596</span>  Legend-&gt;AddEntry(TempLine.get(), Form(<span class="stringliteral">&quot;Data, %.0f, p-value=%.2f&quot;</span>, DataRate, pvalue), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno"> 1597</span>  Legend-&gt;AddEntry(Histogram, Form(<span class="stringliteral">&quot;MC, #mu=%.1f#pm%.1f&quot;</span>, Histogram-&gt;GetMean(), Histogram-&gt;GetRMS()), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno"> 1598</span>  Legend-&gt;AddEntry(Fitter, Form(<span class="stringliteral">&quot;Gauss, #mu=%.1f#pm%.1f&quot;</span>, Fitter-&gt;GetParameter(1), Fitter-&gt;GetParameter(2)), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno"> 1599</span>  std::string TempTitle = std::string(Histogram-&gt;GetName());</div>
<div class="line"><span class="lineno"> 1600</span>  TempTitle += <span class="stringliteral">&quot;_canv&quot;</span>;</div>
<div class="line"><span class="lineno"> 1601</span>  TCanvas *TempCanvas = <span class="keyword">new</span> TCanvas(TempTitle.c_str(), TempTitle.c_str(), 1024, 1024);</div>
<div class="line"><span class="lineno"> 1602</span>  TempCanvas-&gt;SetGridx();</div>
<div class="line"><span class="lineno"> 1603</span>  TempCanvas-&gt;SetGridy();</div>
<div class="line"><span class="lineno"> 1604</span>  TempCanvas-&gt;SetRightMargin(0.03);</div>
<div class="line"><span class="lineno"> 1605</span>  TempCanvas-&gt;SetBottomMargin(0.08);</div>
<div class="line"><span class="lineno"> 1606</span>  TempCanvas-&gt;SetLeftMargin(0.10);</div>
<div class="line"><span class="lineno"> 1607</span>  TempCanvas-&gt;SetTopMargin(0.06);</div>
<div class="line"><span class="lineno"> 1608</span>  TempCanvas-&gt;cd();</div>
<div class="line"><span class="lineno"> 1609</span>  Histogram-&gt;Draw();</div>
<div class="line"><span class="lineno"> 1610</span>  TempLine-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><span class="lineno"> 1611</span>  Fitter-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><span class="lineno"> 1612</span>  Legend-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><span class="lineno"> 1613</span>  TempCanvas-&gt;Write();</div>
<div class="line"><span class="lineno"> 1614</span>  Histogram-&gt;Write();</div>
<div class="line"><span class="lineno"> 1615</span> </div>
<div class="line"><span class="lineno"> 1616</span>  <span class="keyword">delete</span> TempCanvas;</div>
<div class="line"><span class="lineno"> 1617</span>  <span class="keyword">delete</span> Fitter;</div>
<div class="line"><span class="lineno"> 1618</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab28f4325f8104ab783fa3094a2fbbc44" name="ab28f4325f8104ab783fa3094a2fbbc44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab28f4325f8104ab783fa3094a2fbbc44">&#9670;&#160;</a></span>MakeCutLLH()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::MakeCutLLH </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Make the cut LLH histogram. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l01440">1440</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1440</span>                               {</div>
<div class="line"><span class="lineno"> 1441</span><span class="comment">// *******************</span></div>
<div class="line"><span class="lineno"> 1442</span>  <a class="code hl_variable" href="classSampleSummary.html#aa7b948f290517a052f04f61dfa6af68f">Outputfile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 1443</span>  <a class="code hl_function" href="classSampleSummary.html#abf964a8fd459fff903faaea17a98f8b1">MakeCutLLH1D</a>(<a class="code hl_variable" href="classSampleSummary.html#a70b109c60b7c82a3e36708bd2674cb5e">lnLHist</a>.get());</div>
<div class="line"><span class="lineno"> 1444</span>  <a class="code hl_function" href="classSampleSummary.html#abf964a8fd459fff903faaea17a98f8b1">MakeCutLLH1D</a>(<a class="code hl_variable" href="classSampleSummary.html#aead1702a4c1522e685a8af5a875f05ab">lnLHist_drawfluc</a>.get());</div>
<div class="line"><span class="lineno"> 1445</span>  <a class="code hl_function" href="classSampleSummary.html#abf964a8fd459fff903faaea17a98f8b1">MakeCutLLH1D</a>(<a class="code hl_variable" href="classSampleSummary.html#aaf23ed9a699d625adc8639a57de801e8">lnLHist_drawdata</a>.get());</div>
<div class="line"><span class="lineno"> 1446</span>  <a class="code hl_function" href="classSampleSummary.html#abf964a8fd459fff903faaea17a98f8b1">MakeCutLLH1D</a>(<a class="code hl_variable" href="classSampleSummary.html#aa6f15a5750ae0224168d487e44ad3d94">lnLHist_drawflucdraw</a>.get());</div>
<div class="line"><span class="lineno"> 1447</span>  </div>
<div class="line"><span class="lineno"> 1448</span>  <a class="code hl_function" href="classSampleSummary.html#a24fff19d07a5b11c9c4149a45d0265cd">MakeCutLLH2D</a>(<a class="code hl_variable" href="classSampleSummary.html#a8c7537f32164be9192f8ba2b12a69cdb">lnLDrawHist</a>.get());</div>
<div class="line"><span class="lineno"> 1449</span>  <a class="code hl_function" href="classSampleSummary.html#a24fff19d07a5b11c9c4149a45d0265cd">MakeCutLLH2D</a>(<a class="code hl_variable" href="classSampleSummary.html#ae1aafef6414eafb5572893dded50a1b1">lnLFlucHist</a>.get());</div>
<div class="line"><span class="lineno"> 1450</span>  <a class="code hl_function" href="classSampleSummary.html#a24fff19d07a5b11c9c4149a45d0265cd">MakeCutLLH2D</a>(<a class="code hl_variable" href="classSampleSummary.html#aae188cf135af004d5364e5b4f3b1bb31">lnLDrawHistRate</a>.get());</div>
<div class="line"><span class="lineno"> 1451</span>  <a class="code hl_function" href="classSampleSummary.html#a24fff19d07a5b11c9c4149a45d0265cd">MakeCutLLH2D</a>(<a class="code hl_variable" href="classSampleSummary.html#ae509f51ec2d0323e005e05c255bc0c1f">lnLFlucHist_ProjectX</a>.get());</div>
<div class="line"><span class="lineno"> 1452</span>}</div>
<div class="ttc" id="aclassSampleSummary_html_a24fff19d07a5b11c9c4149a45d0265cd"><div class="ttname"><a href="classSampleSummary.html#a24fff19d07a5b11c9c4149a45d0265cd">SampleSummary::MakeCutLLH2D</a></div><div class="ttdeci">void MakeCutLLH2D(TH2D *Histogram)</div><div class="ttdoc">Make the 2D cut distribution and give the 2D p-value.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8cpp_source.html#l01518">SampleSummary.cpp:1518</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_abf964a8fd459fff903faaea17a98f8b1"><div class="ttname"><a href="classSampleSummary.html#abf964a8fd459fff903faaea17a98f8b1">SampleSummary::MakeCutLLH1D</a></div><div class="ttdeci">void MakeCutLLH1D(TH1D *Histogram, double llh_ref=-999)</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8cpp_source.html#l01456">SampleSummary.cpp:1456</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abf964a8fd459fff903faaea17a98f8b1" name="abf964a8fd459fff903faaea17a98f8b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf964a8fd459fff903faaea17a98f8b1">&#9670;&#160;</a></span>MakeCutLLH1D()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::MakeCutLLH1D </td>
          <td>(</td>
          <td class="paramtype">TH1D *&#160;</td>
          <td class="paramname"><em>Histogram</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>llh_ref</em> = <code>-999</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l01456">1456</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1456</span>                                                                {</div>
<div class="line"><span class="lineno"> 1457</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 1458</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> TotalIntegral = Histogram-&gt;Integral();</div>
<div class="line"><span class="lineno"> 1459</span>  <span class="keywordtype">double</span> Above = 0.0;</div>
<div class="line"><span class="lineno"> 1460</span>  <span class="comment">// Get the LLH reference from total llh or some reference histogram</span></div>
<div class="line"><span class="lineno"> 1461</span>  <span class="keywordtype">double</span> llh_reference = 0.0;</div>
<div class="line"><span class="lineno"> 1462</span>  <span class="keywordflow">if</span> (llh_ref &gt;= 0) {</div>
<div class="line"><span class="lineno"> 1463</span>    llh_reference = llh_ref;</div>
<div class="line"><span class="lineno"> 1464</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1465</span>    llh_reference = <a class="code hl_variable" href="classSampleSummary.html#aacac73b24f1e8b05d35fabe2322578e8">llh_total</a>;</div>
<div class="line"><span class="lineno"> 1466</span>  }</div>
<div class="line"><span class="lineno"> 1467</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Histogram-&gt;GetXaxis()-&gt;GetNbins(); ++i) {</div>
<div class="line"><span class="lineno"> 1468</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> xvalue = Histogram-&gt;GetBinCenter(i+1);</div>
<div class="line"><span class="lineno"> 1469</span>    <span class="keywordflow">if</span> (xvalue &gt;= llh_reference) {</div>
<div class="line"><span class="lineno"> 1470</span>      Above += Histogram-&gt;GetBinContent(i+1);</div>
<div class="line"><span class="lineno"> 1471</span>    }</div>
<div class="line"><span class="lineno"> 1472</span>  }</div>
<div class="line"><span class="lineno"> 1473</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> pvalue = Above/TotalIntegral;</div>
<div class="line"><span class="lineno"> 1474</span>  std::stringstream ss;</div>
<div class="line"><span class="lineno"> 1475</span>  ss &lt;&lt; int(Above) &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; int(TotalIntegral) &lt;&lt; <span class="stringliteral">&quot;=&quot;</span> &lt;&lt; pvalue;</div>
<div class="line"><span class="lineno"> 1476</span>  Histogram-&gt;SetTitle((std::string(Histogram-&gt;GetTitle())+<span class="stringliteral">&quot;_&quot;</span>+ss.str()).c_str());</div>
<div class="line"><span class="lineno"> 1477</span> </div>
<div class="line"><span class="lineno"> 1478</span>  <span class="comment">// Write a TCanvas and make a line and a filled histogram</span></div>
<div class="line"><span class="lineno"> 1479</span>  <span class="keyword">auto</span> TempLine = std::make_unique&lt;TLine&gt;(llh_reference , Histogram-&gt;GetMinimum(), llh_reference, Histogram-&gt;GetMaximum());</div>
<div class="line"><span class="lineno"> 1480</span>  TempLine-&gt;SetLineColor(kBlack);</div>
<div class="line"><span class="lineno"> 1481</span>  TempLine-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno"> 1482</span> </div>
<div class="line"><span class="lineno"> 1483</span>  <span class="comment">// Make the fill histogram</span></div>
<div class="line"><span class="lineno"> 1484</span>  TH1D *TempHistogram = <span class="keyword">static_cast&lt;</span>TH1D*<span class="keyword">&gt;</span>(Histogram-&gt;Clone());</div>
<div class="line"><span class="lineno"> 1485</span>  TempHistogram-&gt;SetFillStyle(1001);</div>
<div class="line"><span class="lineno"> 1486</span>  TempHistogram-&gt;SetFillColor(kRed);</div>
<div class="line"><span class="lineno"> 1487</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; TempHistogram-&gt;GetNbinsX(); ++i) {</div>
<div class="line"><span class="lineno"> 1488</span>    <span class="keywordflow">if</span> (TempHistogram-&gt;GetBinCenter(i+1) &lt; llh_reference) {</div>
<div class="line"><span class="lineno"> 1489</span>      TempHistogram-&gt;SetBinContent(i+1, 0.0);</div>
<div class="line"><span class="lineno"> 1490</span>    }</div>
<div class="line"><span class="lineno"> 1491</span>  }</div>
<div class="line"><span class="lineno"> 1492</span> </div>
<div class="line"><span class="lineno"> 1493</span>  <span class="keyword">auto</span> Legend = std::make_unique&lt;TLegend&gt;(0.6, 0.6, 0.9, 0.9);</div>
<div class="line"><span class="lineno"> 1494</span>  Legend-&gt;SetFillColor(0);</div>
<div class="line"><span class="lineno"> 1495</span>  Legend-&gt;SetFillStyle(0);</div>
<div class="line"><span class="lineno"> 1496</span>  Legend-&gt;SetLineWidth(0);</div>
<div class="line"><span class="lineno"> 1497</span>  Legend-&gt;SetLineColor(0);</div>
<div class="line"><span class="lineno"> 1498</span>  Legend-&gt;AddEntry(TempLine.get(), Form(<span class="stringliteral">&quot;Reference LLH, %.0f, p-value=%.2f&quot;</span>, llh_reference, pvalue), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno"> 1499</span>  Legend-&gt;AddEntry(Histogram, Form(<span class="stringliteral">&quot;LLH, #mu=%.1f#pm%.1f&quot;</span>, Histogram-&gt;GetMean(), Histogram-&gt;GetRMS()), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno"> 1500</span>  std::string Title = Histogram-&gt;GetName();</div>
<div class="line"><span class="lineno"> 1501</span>  Title += <span class="stringliteral">&quot;_canv&quot;</span>;</div>
<div class="line"><span class="lineno"> 1502</span>  TCanvas *TempCanvas = <span class="keyword">new</span> TCanvas(Title.c_str(), Title.c_str(), 1024, 1024);</div>
<div class="line"><span class="lineno"> 1503</span>  TempCanvas-&gt;SetGridx();</div>
<div class="line"><span class="lineno"> 1504</span>  TempCanvas-&gt;SetGridy();</div>
<div class="line"><span class="lineno"> 1505</span>  Histogram-&gt;Draw();</div>
<div class="line"><span class="lineno"> 1506</span>  TempHistogram-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><span class="lineno"> 1507</span>  TempLine-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><span class="lineno"> 1508</span>  Legend-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><span class="lineno"> 1509</span> </div>
<div class="line"><span class="lineno"> 1510</span>  TempCanvas-&gt;Write();</div>
<div class="line"><span class="lineno"> 1511</span> </div>
<div class="line"><span class="lineno"> 1512</span>  <span class="keyword">delete</span> TempHistogram;</div>
<div class="line"><span class="lineno"> 1513</span>  <span class="keyword">delete</span> TempCanvas;</div>
<div class="line"><span class="lineno"> 1514</span>}</div>
<div class="ttc" id="aclassSampleSummary_html_aacac73b24f1e8b05d35fabe2322578e8"><div class="ttname"><a href="classSampleSummary.html#aacac73b24f1e8b05d35fabe2322578e8">SampleSummary::llh_total</a></div><div class="ttdeci">double llh_total</div><div class="ttdoc">Total LLH for the posterior predictive distribution.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00281">SampleSummary.h:281</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a24fff19d07a5b11c9c4149a45d0265cd" name="a24fff19d07a5b11c9c4149a45d0265cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24fff19d07a5b11c9c4149a45d0265cd">&#9670;&#160;</a></span>MakeCutLLH2D()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::MakeCutLLH2D </td>
          <td>(</td>
          <td class="paramtype">TH2D *&#160;</td>
          <td class="paramname"><em>Histogram</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Make the 2D cut distribution and give the 2D p-value. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l01518">1518</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1518</span>                                                {</div>
<div class="line"><span class="lineno"> 1519</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 1520</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> TotalIntegral = Histogram-&gt;Integral();</div>
<div class="line"><span class="lineno"> 1521</span>  <span class="comment">// Count how many fills are above y=x axis</span></div>
<div class="line"><span class="lineno"> 1522</span>  <span class="comment">// This is the 2D p-value</span></div>
<div class="line"><span class="lineno"> 1523</span>  <span class="keywordtype">double</span> Above = 0.0;</div>
<div class="line"><span class="lineno"> 1524</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Histogram-&gt;GetXaxis()-&gt;GetNbins(); ++i) {</div>
<div class="line"><span class="lineno"> 1525</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> xvalue = Histogram-&gt;GetXaxis()-&gt;GetBinCenter(i+1);</div>
<div class="line"><span class="lineno"> 1526</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; Histogram-&gt;GetYaxis()-&gt;GetNbins(); ++j) {</div>
<div class="line"><span class="lineno"> 1527</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> yvalue = Histogram-&gt;GetYaxis()-&gt;GetBinCenter(j+1);</div>
<div class="line"><span class="lineno"> 1528</span>      <span class="comment">// We&#39;re only interested in being _ABOVE_ the y=x axis</span></div>
<div class="line"><span class="lineno"> 1529</span>      <span class="keywordflow">if</span> (xvalue &gt;= yvalue) {</div>
<div class="line"><span class="lineno"> 1530</span>        Above += Histogram-&gt;GetBinContent(i+1, j+1);</div>
<div class="line"><span class="lineno"> 1531</span>      }</div>
<div class="line"><span class="lineno"> 1532</span>    }</div>
<div class="line"><span class="lineno"> 1533</span>  }</div>
<div class="line"><span class="lineno"> 1534</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> pvalue = Above/TotalIntegral;</div>
<div class="line"><span class="lineno"> 1535</span>  std::stringstream ss;</div>
<div class="line"><span class="lineno"> 1536</span>  ss &lt;&lt; int(Above) &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; int(TotalIntegral) &lt;&lt; <span class="stringliteral">&quot;=&quot;</span> &lt;&lt; pvalue;</div>
<div class="line"><span class="lineno"> 1537</span>  Histogram-&gt;SetTitle((std::string(Histogram-&gt;GetTitle())+<span class="stringliteral">&quot;_&quot;</span>+ss.str()).c_str());</div>
<div class="line"><span class="lineno"> 1538</span> </div>
<div class="line"><span class="lineno"> 1539</span>  <span class="comment">// Now add the TLine going diagonally</span></div>
<div class="line"><span class="lineno"> 1540</span>  <span class="keywordtype">double</span> minimum = Histogram-&gt;GetXaxis()-&gt;GetBinLowEdge(1);</div>
<div class="line"><span class="lineno"> 1541</span>  <span class="keywordflow">if</span> (Histogram-&gt;GetYaxis()-&gt;GetBinLowEdge(1) &gt; minimum) {</div>
<div class="line"><span class="lineno"> 1542</span>    minimum = Histogram-&gt;GetYaxis()-&gt;GetBinLowEdge(1);</div>
<div class="line"><span class="lineno"> 1543</span>  }</div>
<div class="line"><span class="lineno"> 1544</span>  <span class="keywordtype">double</span> maximum = Histogram-&gt;GetXaxis()-&gt;GetBinLowEdge(Histogram-&gt;GetXaxis()-&gt;GetNbins());</div>
<div class="line"><span class="lineno"> 1545</span>  <span class="keywordflow">if</span> (Histogram-&gt;GetYaxis()-&gt;GetBinLowEdge(Histogram-&gt;GetYaxis()-&gt;GetNbins()) &lt; maximum) {</div>
<div class="line"><span class="lineno"> 1546</span>    maximum = Histogram-&gt;GetYaxis()-&gt;GetBinLowEdge(Histogram-&gt;GetYaxis()-&gt;GetNbins());</div>
<div class="line"><span class="lineno"> 1547</span>    <span class="comment">//KS: Extend by bin width to perfectly fit canvas</span></div>
<div class="line"><span class="lineno"> 1548</span>    maximum += Histogram-&gt;GetYaxis()-&gt;GetBinWidth(Histogram-&gt;GetYaxis()-&gt;GetNbins());</div>
<div class="line"><span class="lineno"> 1549</span>  }</div>
<div class="line"><span class="lineno"> 1550</span>  <span class="keywordflow">else</span> maximum += Histogram-&gt;GetXaxis()-&gt;GetBinWidth(Histogram-&gt;GetXaxis()-&gt;GetNbins());</div>
<div class="line"><span class="lineno"> 1551</span>  <span class="keyword">auto</span> TempLine = std::make_unique&lt;TLine&gt;(minimum, minimum, maximum, maximum);</div>
<div class="line"><span class="lineno"> 1552</span>  TempLine-&gt;SetLineColor(kRed);</div>
<div class="line"><span class="lineno"> 1553</span>  TempLine-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno"> 1554</span> </div>
<div class="line"><span class="lineno"> 1555</span>  std::string Title = Histogram-&gt;GetName();</div>
<div class="line"><span class="lineno"> 1556</span>  Title += <span class="stringliteral">&quot;_canv&quot;</span>;</div>
<div class="line"><span class="lineno"> 1557</span>  TCanvas *TempCanvas = <span class="keyword">new</span> TCanvas(Title.c_str(), Title.c_str(), 1024, 1024);</div>
<div class="line"><span class="lineno"> 1558</span>  TempCanvas-&gt;SetGridx();</div>
<div class="line"><span class="lineno"> 1559</span>  TempCanvas-&gt;SetGridy();</div>
<div class="line"><span class="lineno"> 1560</span>  TempCanvas-&gt;cd();</div>
<div class="line"><span class="lineno"> 1561</span>  gStyle-&gt;SetPalette(81);</div>
<div class="line"><span class="lineno"> 1562</span>  Histogram-&gt;SetMinimum(-0.01);</div>
<div class="line"><span class="lineno"> 1563</span>  Histogram-&gt;Draw(<span class="stringliteral">&quot;colz&quot;</span>);</div>
<div class="line"><span class="lineno"> 1564</span>  TempLine-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><span class="lineno"> 1565</span> </div>
<div class="line"><span class="lineno"> 1566</span>  TempCanvas-&gt;Write();</div>
<div class="line"><span class="lineno"> 1567</span>  <span class="keyword">delete</span> TempCanvas;</div>
<div class="line"><span class="lineno"> 1568</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ada2f0b7b9b7bb687e67023e84151610e" name="ada2f0b7b9b7bb687e67023e84151610e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada2f0b7b9b7bb687e67023e84151610e">&#9670;&#160;</a></span>MakeFluctuatedHistogram() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::MakeFluctuatedHistogram </td>
          <td>(</td>
          <td class="paramtype">TH1D *&#160;</td>
          <td class="paramname"><em>FluctHist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1D *&#160;</td>
          <td class="paramname"><em>PolyHist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Make Poisson fluctuation of TH1D hist. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l02284">2284</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2284</span>                                                                          {</div>
<div class="line"><span class="lineno"> 2285</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 2286</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#ae502645ddf5c53a7a3f2c52566956bf3">StandardFluctuation</a>) <a class="code hl_function" href="classSampleSummary.html#a8ac933c68cff9451eaf1cde713f2eedc">MakeFluctuatedHistogramStandard</a>(FluctHist, PolyHist);</div>
<div class="line"><span class="lineno"> 2287</span>  <span class="keywordflow">else</span> <a class="code hl_function" href="classSampleSummary.html#af7cda55ff5d54f442f39181f8478bd7f">MakeFluctuatedHistogramAlternative</a>(FluctHist, PolyHist);</div>
<div class="line"><span class="lineno"> 2288</span>}</div>
<div class="ttc" id="aclassSampleSummary_html_a8ac933c68cff9451eaf1cde713f2eedc"><div class="ttname"><a href="classSampleSummary.html#a8ac933c68cff9451eaf1cde713f2eedc">SampleSummary::MakeFluctuatedHistogramStandard</a></div><div class="ttdeci">void MakeFluctuatedHistogramStandard(TH1D *FluctHist, TH1D *PolyHist)</div><div class="ttdoc">Make Poisson fluctuation of TH1D hist using default fast method.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8cpp_source.html#l02300">SampleSummary.cpp:2300</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_af7cda55ff5d54f442f39181f8478bd7f"><div class="ttname"><a href="classSampleSummary.html#af7cda55ff5d54f442f39181f8478bd7f">SampleSummary::MakeFluctuatedHistogramAlternative</a></div><div class="ttdeci">void MakeFluctuatedHistogramAlternative(TH1D *FluctHist, TH1D *PolyHist)</div><div class="ttdoc">Make Poisson fluctuation of TH1D hist using slow method which is only for cross-check.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8cpp_source.html#l02338">SampleSummary.cpp:2338</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af05fa75a97eeb8890d7bc2d2204761f5" name="af05fa75a97eeb8890d7bc2d2204761f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af05fa75a97eeb8890d7bc2d2204761f5">&#9670;&#160;</a></span>MakeFluctuatedHistogram() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::MakeFluctuatedHistogram </td>
          <td>(</td>
          <td class="paramtype">TH2Poly *&#160;</td>
          <td class="paramname"><em>FluctHist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH2Poly *&#160;</td>
          <td class="paramname"><em>PolyHist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Make Poisson fluctuation of TH2Poly hist. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l02292">2292</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2292</span>                                                                                {</div>
<div class="line"><span class="lineno"> 2293</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 2294</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#ae502645ddf5c53a7a3f2c52566956bf3">StandardFluctuation</a>) <a class="code hl_function" href="classSampleSummary.html#a8ac933c68cff9451eaf1cde713f2eedc">MakeFluctuatedHistogramStandard</a>(FluctHist, PolyHist);</div>
<div class="line"><span class="lineno"> 2295</span>  <span class="keywordflow">else</span> <a class="code hl_function" href="classSampleSummary.html#af7cda55ff5d54f442f39181f8478bd7f">MakeFluctuatedHistogramAlternative</a>(FluctHist, PolyHist);</div>
<div class="line"><span class="lineno"> 2296</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af7cda55ff5d54f442f39181f8478bd7f" name="af7cda55ff5d54f442f39181f8478bd7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7cda55ff5d54f442f39181f8478bd7f">&#9670;&#160;</a></span>MakeFluctuatedHistogramAlternative() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::MakeFluctuatedHistogramAlternative </td>
          <td>(</td>
          <td class="paramtype">TH1D *&#160;</td>
          <td class="paramname"><em>FluctHist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1D *&#160;</td>
          <td class="paramname"><em>PolyHist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Make Poisson fluctuation of TH1D hist using slow method which is only for cross-check. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l02338">2338</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2338</span>                                                                                     {</div>
<div class="line"><span class="lineno"> 2339</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 2340</span>  <span class="comment">// Make the Poisson fluctuated hist</span></div>
<div class="line"><span class="lineno"> 2341</span>  FluctHist-&gt;Reset(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2342</span>  FluctHist-&gt;Fill(0.0, 0.0);</div>
<div class="line"><span class="lineno"> 2343</span> </div>
<div class="line"><span class="lineno"> 2344</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> evrate = PolyHist-&gt;Integral();</div>
<div class="line"><span class="lineno"> 2345</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> num = <a class="code hl_variable" href="classSampleSummary.html#a364fb16938a26adbe59fdd057f4b9405">rnd</a>-&gt;PoissonD(evrate);</div>
<div class="line"><span class="lineno"> 2346</span>  <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><span class="lineno"> 2347</span>  <span class="keywordflow">while</span>(count &lt; num)</div>
<div class="line"><span class="lineno"> 2348</span>  {</div>
<div class="line"><span class="lineno"> 2349</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> candidate = PolyHist-&gt;GetRandom();</div>
<div class="line"><span class="lineno"> 2350</span>    FluctHist-&gt;Fill(candidate);                 </div>
<div class="line"><span class="lineno"> 2351</span>    count++;</div>
<div class="line"><span class="lineno"> 2352</span>  }</div>
<div class="line"><span class="lineno"> 2353</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1efcadb382307fc99ce01170401ffbaf" name="a1efcadb382307fc99ce01170401ffbaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1efcadb382307fc99ce01170401ffbaf">&#9670;&#160;</a></span>MakeFluctuatedHistogramAlternative() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::MakeFluctuatedHistogramAlternative </td>
          <td>(</td>
          <td class="paramtype">TH2Poly *&#160;</td>
          <td class="paramname"><em>FluctHist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH2Poly *&#160;</td>
          <td class="paramname"><em>PolyHist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Make Poisson fluctuation of TH2Poly hist using slow method which is only for cross-check. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l02357">2357</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2357</span>                                                                                           {</div>
<div class="line"><span class="lineno"> 2358</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 2359</span>  <span class="comment">// Make the Poisson fluctuated hist</span></div>
<div class="line"><span class="lineno"> 2360</span>  FluctHist-&gt;Reset(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2361</span>  FluctHist-&gt;Fill(0.0, 0.0, 0.0);</div>
<div class="line"><span class="lineno"> 2362</span> </div>
<div class="line"><span class="lineno"> 2363</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> evrate = <a class="code hl_function" href="Structs_8cpp.html#ab18c6b2408d7b9021bad06d47a06ee8d">NoOverflowIntegral</a>(PolyHist);</div>
<div class="line"><span class="lineno"> 2364</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> num = <a class="code hl_variable" href="classSampleSummary.html#a364fb16938a26adbe59fdd057f4b9405">rnd</a>-&gt;PoissonD(evrate);</div>
<div class="line"><span class="lineno"> 2365</span>  <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><span class="lineno"> 2366</span>  <span class="keywordflow">while</span>(count &lt; num)</div>
<div class="line"><span class="lineno"> 2367</span>  {</div>
<div class="line"><span class="lineno"> 2368</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> iBin = <a class="code hl_function" href="classSampleSummary.html#a938ba96c39db535ede194bfe9f15d626">GetRandomPoly2</a>(PolyHist);</div>
<div class="line"><span class="lineno"> 2369</span>    FluctHist-&gt;SetBinContent(iBin, FluctHist-&gt;GetBinContent(iBin) + 1);                </div>
<div class="line"><span class="lineno"> 2370</span>    count++;</div>
<div class="line"><span class="lineno"> 2371</span>  }</div>
<div class="line"><span class="lineno"> 2372</span>}</div>
<div class="ttc" id="aclassSampleSummary_html_a938ba96c39db535ede194bfe9f15d626"><div class="ttname"><a href="classSampleSummary.html#a938ba96c39db535ede194bfe9f15d626">SampleSummary::GetRandomPoly2</a></div><div class="ttdeci">int GetRandomPoly2(const TH2Poly *PolyHist)</div><div class="ttdoc">KS: ROOT developers were too lazy do develop getRanom2 for TH2Poly, this implementation is based on l...</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8cpp_source.html#l02377">SampleSummary.cpp:2377</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8ac933c68cff9451eaf1cde713f2eedc" name="a8ac933c68cff9451eaf1cde713f2eedc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ac933c68cff9451eaf1cde713f2eedc">&#9670;&#160;</a></span>MakeFluctuatedHistogramStandard() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::MakeFluctuatedHistogramStandard </td>
          <td>(</td>
          <td class="paramtype">TH1D *&#160;</td>
          <td class="paramname"><em>FluctHist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1D *&#160;</td>
          <td class="paramname"><em>PolyHist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Make Poisson fluctuation of TH1D hist using default fast method. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l02300">2300</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2300</span>                                                                                  {</div>
<div class="line"><span class="lineno"> 2301</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 2302</span>  <span class="comment">// Make the Poisson fluctuated hist</span></div>
<div class="line"><span class="lineno"> 2303</span>  FluctHist-&gt;Reset(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2304</span>  FluctHist-&gt;Fill(0.0, 0.0);</div>
<div class="line"><span class="lineno"> 2305</span> </div>
<div class="line"><span class="lineno"> 2306</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= PolyHist-&gt;GetXaxis()-&gt;GetNbins(); ++i)  </div>
<div class="line"><span class="lineno"> 2307</span>  {</div>
<div class="line"><span class="lineno"> 2308</span>    <span class="comment">// Get the posterior predictive bin content</span></div>
<div class="line"><span class="lineno"> 2309</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> MeanContent = PolyHist-&gt;GetBinContent(i);</div>
<div class="line"><span class="lineno"> 2310</span>    <span class="comment">// Get a Poisson fluctuation of the content</span></div>
<div class="line"><span class="lineno"> 2311</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Random = <a class="code hl_variable" href="classSampleSummary.html#a364fb16938a26adbe59fdd057f4b9405">rnd</a>-&gt;PoissonD(MeanContent);</div>
<div class="line"><span class="lineno"> 2312</span>    <span class="comment">// Set the fluctuated histogram content to the Poisson variation of the posterior predictive histogram</span></div>
<div class="line"><span class="lineno"> 2313</span>    FluctHist-&gt;SetBinContent(i,Random);</div>
<div class="line"><span class="lineno"> 2314</span>  }</div>
<div class="line"><span class="lineno"> 2315</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad8fdfe9143603490ebf0f9927c9e5ea6" name="ad8fdfe9143603490ebf0f9927c9e5ea6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8fdfe9143603490ebf0f9927c9e5ea6">&#9670;&#160;</a></span>MakeFluctuatedHistogramStandard() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::MakeFluctuatedHistogramStandard </td>
          <td>(</td>
          <td class="paramtype">TH2Poly *&#160;</td>
          <td class="paramname"><em>FluctHist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH2Poly *&#160;</td>
          <td class="paramname"><em>PolyHist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Make Poisson fluctuation of TH2Poly hist using default fast method. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l02319">2319</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2319</span>                                                                                        {</div>
<div class="line"><span class="lineno"> 2320</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 2321</span>  <span class="comment">// Make the Poisson fluctuated hist</span></div>
<div class="line"><span class="lineno"> 2322</span>  FluctHist-&gt;Reset(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2323</span>  FluctHist-&gt;Fill(0.0, 0.0, 0.0);</div>
<div class="line"><span class="lineno"> 2324</span> </div>
<div class="line"><span class="lineno"> 2325</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; FluctHist-&gt;GetNumberOfBins()+1; ++i) </div>
<div class="line"><span class="lineno"> 2326</span>  {</div>
<div class="line"><span class="lineno"> 2327</span>    <span class="comment">// Get the posterior predictive bin content</span></div>
<div class="line"><span class="lineno"> 2328</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> MeanContent = PolyHist-&gt;GetBinContent(i);</div>
<div class="line"><span class="lineno"> 2329</span>    <span class="comment">// Get a Poisson fluctuation of the content</span></div>
<div class="line"><span class="lineno"> 2330</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Random = <a class="code hl_variable" href="classSampleSummary.html#a364fb16938a26adbe59fdd057f4b9405">rnd</a>-&gt;PoissonD(MeanContent);</div>
<div class="line"><span class="lineno"> 2331</span>    <span class="comment">// Set the fluctuated histogram content to the Poisson variation of the posterior predictive histogram</span></div>
<div class="line"><span class="lineno"> 2332</span>    FluctHist-&gt;SetBinContent(i,Random);</div>
<div class="line"><span class="lineno"> 2333</span>  }</div>
<div class="line"><span class="lineno"> 2334</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a44baf8959ced974c9a0b8ae640c336bd" name="a44baf8959ced974c9a0b8ae640c336bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44baf8959ced974c9a0b8ae640c336bd">&#9670;&#160;</a></span>MakePredictive()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::MakePredictive </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Finalise the distributions from the thrown samples. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l00985">985</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  985</span>                                   {</div>
<div class="line"><span class="lineno">  986</span><span class="comment">// *******************</span></div>
<div class="line"><span class="lineno">  987</span>  <span class="comment">// First make the projection on the z axis of the TH3D* for every pmu cosmu bin</span></div>
<div class="line"><span class="lineno">  988</span>  <span class="keywordtype">double</span> llh_total_temp = 0.0;</div>
<div class="line"><span class="lineno">  989</span> </div>
<div class="line"><span class="lineno">  990</span>  <span class="comment">// Loop over the samples</span></div>
<div class="line"><span class="lineno">  991</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  992</span><span class="preprocessor">  #pragma omp parallel for reduction(+:llh_total_temp)</span></div>
<div class="line"><span class="lineno">  993</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  994</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> SampleNum = 0;  SampleNum &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++SampleNum)</div>
<div class="line"><span class="lineno">  995</span>  {</div>
<div class="line"><span class="lineno">  996</span>    <span class="comment">// Skip disabled samples</span></div>
<div class="line"><span class="lineno">  997</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[SampleNum] == <span class="keyword">nullptr</span> || <a class="code hl_function" href="Structs_8cpp.html#ab18c6b2408d7b9021bad06d47a06ee8d">NoOverflowIntegral</a>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[SampleNum]) == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  998</span> </div>
<div class="line"><span class="lineno">  999</span>    <span class="comment">// Count the -2LLH for each histogram</span></div>
<div class="line"><span class="lineno"> 1000</span>    <span class="keywordtype">double</span> negLogL_Mean = 0.0;</div>
<div class="line"><span class="lineno"> 1001</span>    <span class="keywordtype">double</span> negLogL_Mode = 0.0;</div>
<div class="line"><span class="lineno"> 1002</span> </div>
<div class="line"><span class="lineno"> 1003</span>    <span class="comment">// Loop over each pmu cosmu bin</span></div>
<div class="line"><span class="lineno"> 1004</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; <a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[SampleNum]+1; ++j)</div>
<div class="line"><span class="lineno"> 1005</span>    {</div>
<div class="line"><span class="lineno"> 1006</span>      TH1D *Projection = <a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[SampleNum][j].get();</div>
<div class="line"><span class="lineno"> 1007</span>      TH1D *W2Projection = <a class="code hl_variable" href="classSampleSummary.html#aa6773885be1b6a2660493718823a2f3f">w2Hist</a>[SampleNum][j].get();</div>
<div class="line"><span class="lineno"> 1008</span> </div>
<div class="line"><span class="lineno"> 1009</span>      <span class="comment">// Data content for the j,kth bin</span></div>
<div class="line"><span class="lineno"> 1010</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> nData = <a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[SampleNum]-&gt;GetBinContent(j);</div>
<div class="line"><span class="lineno"> 1011</span>      </div>
<div class="line"><span class="lineno"> 1012</span>      <span class="comment">// Get the mean for this projection for all the samples</span></div>
<div class="line"><span class="lineno"> 1013</span>      <span class="comment">// This is the mean prediction for this given j,k bin</span></div>
<div class="line"><span class="lineno"> 1014</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> nMean = Projection-&gt;GetMean();</div>
<div class="line"><span class="lineno"> 1015</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> nMeanError = Projection-&gt;GetRMS();</div>
<div class="line"><span class="lineno"> 1016</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> nMode = Projection-&gt;GetBinCenter(Projection-&gt;GetMaximumBin());</div>
<div class="line"><span class="lineno"> 1017</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> nModeError = <a class="code hl_function" href="classSampleSummary.html#a1ed7c379dc433cb1dc3b71eb7aec9713">GetModeError</a>(Projection);</div>
<div class="line"><span class="lineno"> 1018</span>      </div>
<div class="line"><span class="lineno"> 1019</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> nW2Mean = W2Projection-&gt;GetMean();</div>
<div class="line"><span class="lineno"> 1020</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> nW2Mode = W2Projection-&gt;GetBinCenter(W2Projection-&gt;GetMaximumBin());</div>
<div class="line"><span class="lineno"> 1021</span>      </div>
<div class="line"><span class="lineno"> 1022</span>      <span class="keywordtype">double</span> TempLLH_Mean = 0.0;</div>
<div class="line"><span class="lineno"> 1023</span>      <span class="keywordtype">double</span> TempLLH_Mode = 0.0;</div>
<div class="line"><span class="lineno"> 1024</span>      </div>
<div class="line"><span class="lineno"> 1025</span>      <span class="comment">//KS:Get LLH contribution getTestStatLLH can calculate Barlow Beeston/IceCube or Poisson</span></div>
<div class="line"><span class="lineno"> 1026</span>      TempLLH_Mean = <a class="code hl_variable" href="classSampleSummary.html#abd938805245ca6cfeb8c49363f5ff11c">SamplePDF</a>-&gt;<a class="code hl_function" href="classsamplePDFBase.html#ab2e2eab110efc30a2aee13a5011acb8a">getTestStatLLH</a>(nData, nMean, nW2Mean);</div>
<div class="line"><span class="lineno"> 1027</span>      TempLLH_Mode = <a class="code hl_variable" href="classSampleSummary.html#abd938805245ca6cfeb8c49363f5ff11c">SamplePDF</a>-&gt;<a class="code hl_function" href="classsamplePDFBase.html#ab2e2eab110efc30a2aee13a5011acb8a">getTestStatLLH</a>(nData, nMode, nW2Mode);</div>
<div class="line"><span class="lineno"> 1028</span> </div>
<div class="line"><span class="lineno"> 1029</span>      <span class="comment">// Increment -2LLH</span></div>
<div class="line"><span class="lineno"> 1030</span>      <span class="comment">//KS: do times 2 because banff reports chi2</span></div>
<div class="line"><span class="lineno"> 1031</span>      negLogL_Mean += 2*TempLLH_Mean;</div>
<div class="line"><span class="lineno"> 1032</span>      negLogL_Mode += 2*TempLLH_Mode;</div>
<div class="line"><span class="lineno"> 1033</span>      </div>
<div class="line"><span class="lineno"> 1034</span>      <span class="comment">// Set the content and error to the mean in the bin</span></div>
<div class="line"><span class="lineno"> 1035</span>      <a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[SampleNum]-&gt;SetBinContent(j, <a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[SampleNum]-&gt;GetBinContent(j)+nMean);</div>
<div class="line"><span class="lineno"> 1036</span>      <span class="comment">// KS: This -1 is only needed for root older than 6.18 for more see https://t2k-experiment.slack.com/archives/CU9CBG6NS/p1714551365661589</span></div>
<div class="line"><span class="lineno"> 1037</span>      <a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[SampleNum]-&gt;SetBinError(j, nMeanError);</div>
<div class="line"><span class="lineno"> 1038</span> </div>
<div class="line"><span class="lineno"> 1039</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#adf610d698a50c4930d95be320e99a8e8">DoBetaParam</a>)</div>
<div class="line"><span class="lineno"> 1040</span>      {</div>
<div class="line"><span class="lineno"> 1041</span>        TH1D *BetaTemp = <a class="code hl_variable" href="classSampleSummary.html#a479f46f89c0c752c3e3e147d5b04b458">BetaHist</a>[SampleNum][j].get();</div>
<div class="line"><span class="lineno"> 1042</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> nBetaMean = BetaTemp-&gt;GetMean();</div>
<div class="line"><span class="lineno"> 1043</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> nBetaMeanError = BetaTemp-&gt;GetRMS();</div>
<div class="line"><span class="lineno"> 1044</span>        <span class="comment">//KS: Here we modify predictions by beta parameter from Barlow-Beeston</span></div>
<div class="line"><span class="lineno"> 1045</span>        <a class="code hl_variable" href="classSampleSummary.html#a6191a0fc1c8f1f0889b3dedcc5485a3d">MeanHistCorrected</a>[SampleNum]-&gt;SetBinContent(j, <a class="code hl_variable" href="classSampleSummary.html#a6191a0fc1c8f1f0889b3dedcc5485a3d">MeanHistCorrected</a>[SampleNum]-&gt;GetBinContent(j)+nMean*nBetaMean);</div>
<div class="line"><span class="lineno"> 1046</span>        <span class="comment">//KS: Use error propagation to calcuate error</span></div>
<div class="line"><span class="lineno"> 1047</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> ErrorTemp = std::sqrt( (nBetaMean*nMeanError) * (nBetaMean*nMeanError) + (nMean*nBetaMeanError) * (nMean*nBetaMeanError));</div>
<div class="line"><span class="lineno"> 1048</span>        <span class="comment">// KS: This -1 is only needed for root older than 6.18 for more see https://t2k-experiment.slack.com/archives/CU9CBG6NS/p1714551365661589</span></div>
<div class="line"><span class="lineno"> 1049</span>        <a class="code hl_variable" href="classSampleSummary.html#a6191a0fc1c8f1f0889b3dedcc5485a3d">MeanHistCorrected</a>[SampleNum]-&gt;SetBinError(j, ErrorTemp);</div>
<div class="line"><span class="lineno"> 1050</span>      }</div>
<div class="line"><span class="lineno"> 1051</span>      <span class="comment">// Set the content to the mode in the bin</span></div>
<div class="line"><span class="lineno"> 1052</span>      <a class="code hl_variable" href="classSampleSummary.html#a9b21ff74bb8ebd7c3af2c24e02f3d7dc">ModeHist</a>[SampleNum]-&gt;SetBinContent(j, <a class="code hl_variable" href="classSampleSummary.html#a9b21ff74bb8ebd7c3af2c24e02f3d7dc">ModeHist</a>[SampleNum]-&gt;GetBinContent(j)+nMode);</div>
<div class="line"><span class="lineno"> 1053</span>      <span class="comment">// KS: This -1 is only needed for root older than 6.18 for more see https://t2k-experiment.slack.com/archives/CU9CBG6NS/p1714551365661589</span></div>
<div class="line"><span class="lineno"> 1054</span>      <a class="code hl_variable" href="classSampleSummary.html#a9b21ff74bb8ebd7c3af2c24e02f3d7dc">ModeHist</a>[SampleNum]-&gt;SetBinError(j, nModeError);</div>
<div class="line"><span class="lineno"> 1055</span>      <span class="comment">// Set the content to the mean in the bin</span></div>
<div class="line"><span class="lineno"> 1056</span>      <a class="code hl_variable" href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">W2MeanHist</a>[SampleNum]-&gt;SetBinContent(j, <a class="code hl_variable" href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">W2MeanHist</a>[SampleNum]-&gt;GetBinContent(j)+nW2Mean);</div>
<div class="line"><span class="lineno"> 1057</span>      <span class="comment">// Set the content to the mode in the bin</span></div>
<div class="line"><span class="lineno"> 1058</span>      <a class="code hl_variable" href="classSampleSummary.html#adf9b943ba381875b3f2e0c4807a9b8c4">W2ModeHist</a>[SampleNum]-&gt;SetBinContent(j, <a class="code hl_variable" href="classSampleSummary.html#adf9b943ba381875b3f2e0c4807a9b8c4">W2ModeHist</a>[SampleNum]-&gt;GetBinContent(j)+nW2Mode);</div>
<div class="line"><span class="lineno"> 1059</span>      </div>
<div class="line"><span class="lineno"> 1060</span>      <span class="comment">// Set the mean and average LLH for this given bin</span></div>
<div class="line"><span class="lineno"> 1061</span>      <span class="comment">// Can use these hists to see where the largest -2LLH hists come from</span></div>
<div class="line"><span class="lineno"> 1062</span>      <a class="code hl_variable" href="classSampleSummary.html#a154c9bd15825713c48154fab66190d39">lnLHist_Mean</a>[SampleNum]-&gt;SetBinContent(j, 2.0*TempLLH_Mean);</div>
<div class="line"><span class="lineno"> 1063</span>      <a class="code hl_variable" href="classSampleSummary.html#a03bbc94ee26b66875becf22255a205d2">lnLHist_Mode</a>[SampleNum]-&gt;SetBinContent(j, 2.0*TempLLH_Mode);</div>
<div class="line"><span class="lineno"> 1064</span>      </div>
<div class="line"><span class="lineno"> 1065</span>      <a class="code hl_variable" href="classSampleSummary.html#a718c83e1952f948a5c063c2039a68a19">lnLHist_Mean1D</a>[SampleNum]-&gt;Fill(2.0*TempLLH_Mean);</div>
<div class="line"><span class="lineno"> 1066</span>      <a class="code hl_variable" href="classSampleSummary.html#a424b53de4d9e896526667ddb565e4a6b">lnLHist_Mode1D</a>[SampleNum]-&gt;Fill(2.0*TempLLH_Mode);</div>
<div class="line"><span class="lineno"> 1067</span>    } <span class="comment">// End loop over bins</span></div>
<div class="line"><span class="lineno"> 1068</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#a795ac96bf6958c8a2f38c9de23c3c081">DoByModePlots</a>)</div>
<div class="line"><span class="lineno"> 1069</span>    {</div>
<div class="line"><span class="lineno"> 1070</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1; j++)</div>
<div class="line"><span class="lineno"> 1071</span>      {</div>
<div class="line"><span class="lineno"> 1072</span>        <span class="comment">// Loop over each pmu cosmu bin</span></div>
<div class="line"><span class="lineno"> 1073</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[SampleNum]+1; ++i)</div>
<div class="line"><span class="lineno"> 1074</span>        {</div>
<div class="line"><span class="lineno"> 1075</span>          <span class="comment">// Make the posterior/prior predictive projection on z</span></div>
<div class="line"><span class="lineno"> 1076</span>          <span class="comment">// The z axis of Predictive is the bin content</span></div>
<div class="line"><span class="lineno"> 1077</span>          <span class="comment">// Essentially zooming in on one bin and looking at the mean and mode of that bin</span></div>
<div class="line"><span class="lineno"> 1078</span>          TH1D *Projection = <a class="code hl_variable" href="classSampleSummary.html#aa6cfe4fb92b67f08b0d94f0fe1d8a3a2">PosteriorHist_ByMode</a>[SampleNum][j][i];</div>
<div class="line"><span class="lineno"> 1079</span> </div>
<div class="line"><span class="lineno"> 1080</span>          <span class="comment">// Get the mean for this projection for all the samples</span></div>
<div class="line"><span class="lineno"> 1081</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> nMean = Projection-&gt;GetMean();</div>
<div class="line"><span class="lineno"> 1082</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> nMeanError = Projection-&gt;GetRMS();</div>
<div class="line"><span class="lineno"> 1083</span> </div>
<div class="line"><span class="lineno"> 1084</span>          <span class="comment">// Set the content and error to the mean in the bin</span></div>
<div class="line"><span class="lineno"> 1085</span>          <a class="code hl_variable" href="classSampleSummary.html#a20237446a72eda2dc833bfc72c7e42e1">MeanHist_ByMode</a>[SampleNum][j]-&gt;SetBinContent(i, <a class="code hl_variable" href="classSampleSummary.html#a20237446a72eda2dc833bfc72c7e42e1">MeanHist_ByMode</a>[SampleNum][j]-&gt;GetBinContent(i)+nMean);</div>
<div class="line"><span class="lineno"> 1086</span>          <span class="comment">// KS: This -1 is only needed for root older than 6.18 for more see https://t2k-experiment.slack.com/archives/CU9CBG6NS/p1714551365661589</span></div>
<div class="line"><span class="lineno"> 1087</span>          <a class="code hl_variable" href="classSampleSummary.html#a20237446a72eda2dc833bfc72c7e42e1">MeanHist_ByMode</a>[SampleNum][j]-&gt;SetBinError(i, nMeanError);</div>
<div class="line"><span class="lineno"> 1088</span>        } <span class="comment">// End loop over bins</span></div>
<div class="line"><span class="lineno"> 1089</span>      }</div>
<div class="line"><span class="lineno"> 1090</span>    }</div>
<div class="line"><span class="lineno"> 1091</span>    llh_total_temp += negLogL_Mean;</div>
<div class="line"><span class="lineno"> 1092</span>  } <span class="comment">// End loop over samples</span></div>
<div class="line"><span class="lineno"> 1093</span> </div>
<div class="line"><span class="lineno"> 1094</span>  <span class="comment">// This is not multithreaded as due to ProjectPoly it is not safe</span></div>
<div class="line"><span class="lineno"> 1095</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> SampleNum = 0;  SampleNum &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++SampleNum)</div>
<div class="line"><span class="lineno"> 1096</span>  {</div>
<div class="line"><span class="lineno"> 1097</span>    <span class="comment">// Skip disabled samples</span></div>
<div class="line"><span class="lineno"> 1098</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[SampleNum] == <span class="keyword">nullptr</span> || <a class="code hl_function" href="Structs_8cpp.html#ab18c6b2408d7b9021bad06d47a06ee8d">NoOverflowIntegral</a>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[SampleNum]) == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1099</span> </div>
<div class="line"><span class="lineno"> 1100</span>    <span class="comment">//KS:: Might consider caching it as we use it once agian much later</span></div>
<div class="line"><span class="lineno"> 1101</span>    TH1D *MeanProjectX = <a class="code hl_function" href="classSampleSummary.html#a685a8ef3180d4f6474328b5c806d8b74">ProjectPoly</a>(<a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[SampleNum], <span class="keyword">true</span>, SampleNum, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1102</span>    TH1D *W2MeanProjectX = <a class="code hl_function" href="classSampleSummary.html#a685a8ef3180d4f6474328b5c806d8b74">ProjectPoly</a>(<a class="code hl_variable" href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">W2MeanHist</a>[SampleNum], <span class="keyword">true</span>, SampleNum);</div>
<div class="line"><span class="lineno"> 1103</span>    <span class="comment">// Loop over each pmu bin for 1D projection</span></div>
<div class="line"><span class="lineno"> 1104</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt;= <a class="code hl_variable" href="classSampleSummary.html#a7b1ba5b3b465f78019bb8c36ec5f56d7">lnLHist_Mean_ProjectX</a>[SampleNum]-&gt;GetXaxis()-&gt;GetNbins(); ++j)</div>
<div class="line"><span class="lineno"> 1105</span>    {</div>
<div class="line"><span class="lineno"> 1106</span>      <span class="comment">// Data content for the j,kth bin</span></div>
<div class="line"><span class="lineno"> 1107</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> nData = <a class="code hl_variable" href="classSampleSummary.html#abeaca1195db794d9e660a377d81c1b21">DataHist_ProjectX</a>[SampleNum]-&gt;GetBinContent(j);</div>
<div class="line"><span class="lineno"> 1108</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> nMean = MeanProjectX-&gt;GetBinContent(j);</div>
<div class="line"><span class="lineno"> 1109</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> nW2Mean = W2MeanProjectX-&gt;GetBinContent(j);</div>
<div class="line"><span class="lineno"> 1110</span> </div>
<div class="line"><span class="lineno"> 1111</span>      <span class="keywordtype">double</span> TempLLH_Mean = 0.0;</div>
<div class="line"><span class="lineno"> 1112</span>      TempLLH_Mean = <a class="code hl_variable" href="classSampleSummary.html#abd938805245ca6cfeb8c49363f5ff11c">SamplePDF</a>-&gt;<a class="code hl_function" href="classsamplePDFBase.html#ab2e2eab110efc30a2aee13a5011acb8a">getTestStatLLH</a>(nData, nMean, nW2Mean);</div>
<div class="line"><span class="lineno"> 1113</span> </div>
<div class="line"><span class="lineno"> 1114</span>      <span class="comment">//KS: do times 2 because banff reports chi2</span></div>
<div class="line"><span class="lineno"> 1115</span>      <a class="code hl_variable" href="classSampleSummary.html#a7b1ba5b3b465f78019bb8c36ec5f56d7">lnLHist_Mean_ProjectX</a>[SampleNum]-&gt;SetBinContent(j, 2.0*TempLLH_Mean);</div>
<div class="line"><span class="lineno"> 1116</span>    }<span class="comment">// End loop over  bins</span></div>
<div class="line"><span class="lineno"> 1117</span> </div>
<div class="line"><span class="lineno"> 1118</span>    <span class="keyword">delete</span> MeanProjectX;</div>
<div class="line"><span class="lineno"> 1119</span>    <span class="keyword">delete</span> W2MeanProjectX;</div>
<div class="line"><span class="lineno"> 1120</span>  } <span class="comment">// End loop over samples</span></div>
<div class="line"><span class="lineno"> 1121</span> </div>
<div class="line"><span class="lineno"> 1122</span>  <a class="code hl_variable" href="classSampleSummary.html#aacac73b24f1e8b05d35fabe2322578e8">llh_total</a> = llh_total_temp;</div>
<div class="line"><span class="lineno"> 1123</span>  <span class="comment">// Now we have our posterior predictive histogram and it&#39;s LLH</span></div>
<div class="line"><span class="lineno"> 1124</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Prior/Posterior predictive LLH mean (sample only) = {:.2f}&quot;</span>, <a class="code hl_variable" href="classSampleSummary.html#aacac73b24f1e8b05d35fabe2322578e8">llh_total</a>);</div>
<div class="line"><span class="lineno"> 1125</span>  std::stringstream ss;</div>
<div class="line"><span class="lineno"> 1126</span>  ss &lt;&lt; <a class="code hl_variable" href="classSampleSummary.html#aacac73b24f1e8b05d35fabe2322578e8">llh_total</a>;</div>
<div class="line"><span class="lineno"> 1127</span>  <a class="code hl_variable" href="classSampleSummary.html#a70b109c60b7c82a3e36708bd2674cb5e">lnLHist</a>-&gt;SetTitle((std::string(<a class="code hl_variable" href="classSampleSummary.html#a70b109c60b7c82a3e36708bd2674cb5e">lnLHist</a>-&gt;GetTitle())+<span class="stringliteral">&quot;_&quot;</span>+ss.str()).c_str());</div>
<div class="line"><span class="lineno"> 1128</span> </div>
<div class="line"><span class="lineno"> 1129</span>  <span class="comment">// Now make the fluctuated hists of the MeanHist and ModeHist</span></div>
<div class="line"><span class="lineno"> 1130</span>  <a class="code hl_function" href="classSampleSummary.html#a316974fb99c5a775e1c7099be3bccc7b">MakeChi2Hists</a>();</div>
<div class="line"><span class="lineno"> 1131</span> </div>
<div class="line"><span class="lineno"> 1132</span>  <span class="comment">// Get the 1D LLH dists</span></div>
<div class="line"><span class="lineno"> 1133</span>  <a class="code hl_function" href="classSampleSummary.html#ab28f4325f8104ab783fa3094a2fbbc44">MakeCutLLH</a>();</div>
<div class="line"><span class="lineno"> 1134</span>} <span class="comment">// End MakePredictive() function</span></div>
<div class="ttc" id="aclassSampleSummary_html_a1ed7c379dc433cb1dc3b71eb7aec9713"><div class="ttname"><a href="classSampleSummary.html#a1ed7c379dc433cb1dc3b71eb7aec9713">SampleSummary::GetModeError</a></div><div class="ttdeci">double GetModeError(TH1D *hpost)</div><div class="ttdoc">Get the mode error from a TH1D.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8cpp_source.html#l02406">SampleSummary.cpp:2406</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a316974fb99c5a775e1c7099be3bccc7b"><div class="ttname"><a href="classSampleSummary.html#a316974fb99c5a775e1c7099be3bccc7b">SampleSummary::MakeChi2Hists</a></div><div class="ttdeci">void MakeChi2Hists()</div><div class="ttdoc">Make the fluctuated histograms (2D and 1D) for the chi2s Essentially taking the MCMC draws and calcul...</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8cpp_source.html#l01141">SampleSummary.cpp:1141</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_ab28f4325f8104ab783fa3094a2fbbc44"><div class="ttname"><a href="classSampleSummary.html#ab28f4325f8104ab783fa3094a2fbbc44">SampleSummary::MakeCutLLH</a></div><div class="ttdeci">void MakeCutLLH()</div><div class="ttdoc">Make the cut LLH histogram.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8cpp_source.html#l01440">SampleSummary.cpp:1440</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acab977d5e63eaca5862c352fea8a01c2" name="acab977d5e63eaca5862c352fea8a01c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acab977d5e63eaca5862c352fea8a01c2">&#9670;&#160;</a></span>NormaliseTH2Poly()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::NormaliseTH2Poly </td>
          <td>(</td>
          <td class="paramtype">TH2Poly *&#160;</td>
          <td class="paramname"><em>Histogram</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper to Normalise histograms. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Histogram</td><td>hist which we normalise </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l01651">1651</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1651</span>                                                      {</div>
<div class="line"><span class="lineno"> 1652</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 1653</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> Integral = <a class="code hl_function" href="Structs_8cpp.html#ab18c6b2408d7b9021bad06d47a06ee8d">NoOverflowIntegral</a>(Histogram);</div>
<div class="line"><span class="lineno"> 1654</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 1; j &lt; Histogram-&gt;GetNumberOfBins()+1; j++)</div>
<div class="line"><span class="lineno"> 1655</span>  {</div>
<div class="line"><span class="lineno"> 1656</span>    Histogram-&gt;SetBinContent(j, Histogram-&gt;GetBinContent(j)/Integral);</div>
<div class="line"><span class="lineno"> 1657</span>  }</div>
<div class="line"><span class="lineno"> 1658</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac49aa59702b5e24cb0718c2642d6d793" name="ac49aa59702b5e24cb0718c2642d6d793"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac49aa59702b5e24cb0718c2642d6d793">&#9670;&#160;</a></span>PlotBetaParameters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::PlotBetaParameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: In Barlow Beeston we have Beta Parameters which scale generated MC. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l01713">1713</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1713</span>                                       {</div>
<div class="line"><span class="lineno"> 1714</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 1715</span>  <span class="comment">// Make a new directory</span></div>
<div class="line"><span class="lineno"> 1716</span>  TDirectory *BetaDir = <a class="code hl_variable" href="classSampleSummary.html#aa7b948f290517a052f04f61dfa6af68f">Outputfile</a>-&gt;mkdir(<span class="stringliteral">&quot;BetaParameters&quot;</span>);</div>
<div class="line"><span class="lineno"> 1717</span>  BetaDir-&gt;cd();</div>
<div class="line"><span class="lineno"> 1718</span> </div>
<div class="line"><span class="lineno"> 1719</span>  <span class="keywordtype">int</span> originalErrorLevel = gErrorIgnoreLevel;</div>
<div class="line"><span class="lineno"> 1720</span> </div>
<div class="line"><span class="lineno"> 1721</span>  <span class="comment">//To avoid Warning in &lt;Fit&gt;: Fit data is empty</span></div>
<div class="line"><span class="lineno"> 1722</span>  gErrorIgnoreLevel = kFatal;</div>
<div class="line"><span class="lineno"> 1723</span> </div>
<div class="line"><span class="lineno"> 1724</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Writing Beta parameters&quot;</span>);</div>
<div class="line"><span class="lineno"> 1725</span>  std::vector&lt;TDirectory *&gt; DirBeta(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno"> 1726</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++i)</div>
<div class="line"><span class="lineno"> 1727</span>  {</div>
<div class="line"><span class="lineno"> 1728</span>    <span class="comment">// Make a new directory</span></div>
<div class="line"><span class="lineno"> 1729</span>    DirBeta[i] = BetaDir-&gt;mkdir((<a class="code hl_variable" href="classSampleSummary.html#a9ba7df41774c45a14c0a97e4accc9cc0">SampleNames</a>[i]).c_str());</div>
<div class="line"><span class="lineno"> 1730</span>    DirBeta[i]-&gt;cd();</div>
<div class="line"><span class="lineno"> 1731</span> </div>
<div class="line"><span class="lineno"> 1732</span>    <span class="comment">// Loop over each pmu cosmu bin</span></div>
<div class="line"><span class="lineno"> 1733</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; <a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[i]+1; ++j)</div>
<div class="line"><span class="lineno"> 1734</span>    {</div>
<div class="line"><span class="lineno"> 1735</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> data = <a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i]-&gt;GetBinContent(j);</div>
<div class="line"><span class="lineno"> 1736</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> mc = <a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i]-&gt;GetBinContent(j);</div>
<div class="line"><span class="lineno"> 1737</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> w2 = <a class="code hl_variable" href="classSampleSummary.html#a9c37d8669c0f55f6a4620b4f0d7b6e20">W2NomHist</a>[i]-&gt;GetBinContent(j);</div>
<div class="line"><span class="lineno"> 1738</span> </div>
<div class="line"><span class="lineno"> 1739</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> BetaPrior = <a class="code hl_function" href="StatisticalUtils_8h.html#afecd84c56d6546271c4547192aae31af">GetBetaParameter</a>(data, mc, w2, <a class="code hl_variable" href="classSampleSummary.html#aafb18632bb987ae9a302d95781d5fdba">likelihood</a>);</div>
<div class="line"><span class="lineno"> 1740</span> </div>
<div class="line"><span class="lineno"> 1741</span>      <span class="keyword">auto</span> TempLine = std::unique_ptr&lt;TLine&gt;(<span class="keyword">new</span> TLine(BetaPrior, <a class="code hl_variable" href="classSampleSummary.html#a479f46f89c0c752c3e3e147d5b04b458">BetaHist</a>[i][j]-&gt;GetMinimum(), BetaPrior, <a class="code hl_variable" href="classSampleSummary.html#a479f46f89c0c752c3e3e147d5b04b458">BetaHist</a>[i][j]-&gt;GetMaximum()));</div>
<div class="line"><span class="lineno"> 1742</span>      TempLine-&gt;SetLineColor(kRed);</div>
<div class="line"><span class="lineno"> 1743</span>      TempLine-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno"> 1744</span> </div>
<div class="line"><span class="lineno"> 1745</span>      <span class="comment">// Also fit a Gaussian because why not?</span></div>
<div class="line"><span class="lineno"> 1746</span>      TF1 *Fitter = <span class="keyword">new</span> TF1(<span class="stringliteral">&quot;Fit&quot;</span>, <span class="stringliteral">&quot;gaus&quot;</span>, <a class="code hl_variable" href="classSampleSummary.html#a479f46f89c0c752c3e3e147d5b04b458">BetaHist</a>[i][j]-&gt;GetBinLowEdge(1), <a class="code hl_variable" href="classSampleSummary.html#a479f46f89c0c752c3e3e147d5b04b458">BetaHist</a>[i][j]-&gt;GetBinLowEdge(<a class="code hl_variable" href="classSampleSummary.html#a479f46f89c0c752c3e3e147d5b04b458">BetaHist</a>[i][j]-&gt;GetNbinsX()+1));</div>
<div class="line"><span class="lineno"> 1747</span>      <a class="code hl_variable" href="classSampleSummary.html#a479f46f89c0c752c3e3e147d5b04b458">BetaHist</a>[i][j]-&gt;Fit(Fitter, <span class="stringliteral">&quot;RQ&quot;</span>);</div>
<div class="line"><span class="lineno"> 1748</span>      Fitter-&gt;SetLineColor(kRed-5);</div>
<div class="line"><span class="lineno"> 1749</span> </div>
<div class="line"><span class="lineno"> 1750</span>      <span class="keyword">auto</span> Legend = std::make_unique&lt;TLegend&gt;(0.4, 0.75, 0.98, 0.90);</div>
<div class="line"><span class="lineno"> 1751</span>      Legend-&gt;SetFillColor(0);</div>
<div class="line"><span class="lineno"> 1752</span>      Legend-&gt;SetFillStyle(0);</div>
<div class="line"><span class="lineno"> 1753</span>      Legend-&gt;SetLineWidth(0);</div>
<div class="line"><span class="lineno"> 1754</span>      Legend-&gt;SetLineColor(0);</div>
<div class="line"><span class="lineno"> 1755</span>      Legend-&gt;AddEntry(TempLine.get(), Form(<span class="stringliteral">&quot;Prior #mu=%.4f, N_{data}=%.0f&quot;</span>, BetaPrior, data), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno"> 1756</span>      Legend-&gt;AddEntry(<a class="code hl_variable" href="classSampleSummary.html#a479f46f89c0c752c3e3e147d5b04b458">BetaHist</a>[i][j].get(), Form(<span class="stringliteral">&quot;Post, #mu=%.4f#pm%.4f&quot;</span>, <a class="code hl_variable" href="classSampleSummary.html#a479f46f89c0c752c3e3e147d5b04b458">BetaHist</a>[i][j]-&gt;GetMean(), <a class="code hl_variable" href="classSampleSummary.html#a479f46f89c0c752c3e3e147d5b04b458">BetaHist</a>[i][j]-&gt;GetRMS()), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno"> 1757</span>      Legend-&gt;AddEntry(Fitter, Form(<span class="stringliteral">&quot;Gauss, #mu=%.4f#pm%.4f&quot;</span>, Fitter-&gt;GetParameter(1), Fitter-&gt;GetParameter(2)), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno"> 1758</span>      std::string TempTitle = std::string(<a class="code hl_variable" href="classSampleSummary.html#a479f46f89c0c752c3e3e147d5b04b458">BetaHist</a>[i][j]-&gt;GetName());</div>
<div class="line"><span class="lineno"> 1759</span> </div>
<div class="line"><span class="lineno"> 1760</span>      TempTitle += <span class="stringliteral">&quot;_canv&quot;</span>;</div>
<div class="line"><span class="lineno"> 1761</span>      TCanvas *TempCanvas = <span class="keyword">new</span> TCanvas(TempTitle.c_str(), TempTitle.c_str(), 1024, 1024);</div>
<div class="line"><span class="lineno"> 1762</span>      TempCanvas-&gt;SetGridx();</div>
<div class="line"><span class="lineno"> 1763</span>      TempCanvas-&gt;SetGridy();</div>
<div class="line"><span class="lineno"> 1764</span>      TempCanvas-&gt;SetRightMargin(0.03);</div>
<div class="line"><span class="lineno"> 1765</span>      TempCanvas-&gt;SetBottomMargin(0.08);</div>
<div class="line"><span class="lineno"> 1766</span>      TempCanvas-&gt;SetLeftMargin(0.10);</div>
<div class="line"><span class="lineno"> 1767</span>      TempCanvas-&gt;SetTopMargin(0.06);</div>
<div class="line"><span class="lineno"> 1768</span>      TempCanvas-&gt;cd();</div>
<div class="line"><span class="lineno"> 1769</span>      <a class="code hl_variable" href="classSampleSummary.html#a479f46f89c0c752c3e3e147d5b04b458">BetaHist</a>[i][j]-&gt;Draw();</div>
<div class="line"><span class="lineno"> 1770</span>      TempLine-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><span class="lineno"> 1771</span>      Fitter-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><span class="lineno"> 1772</span>      Legend-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><span class="lineno"> 1773</span>      TempCanvas-&gt;Write();</div>
<div class="line"><span class="lineno"> 1774</span>      <a class="code hl_variable" href="classSampleSummary.html#a479f46f89c0c752c3e3e147d5b04b458">BetaHist</a>[i][j]-&gt;Write();</div>
<div class="line"><span class="lineno"> 1775</span> </div>
<div class="line"><span class="lineno"> 1776</span>      <span class="keyword">delete</span> TempCanvas;</div>
<div class="line"><span class="lineno"> 1777</span>      <span class="keyword">delete</span> Fitter;</div>
<div class="line"><span class="lineno"> 1778</span>    }</div>
<div class="line"><span class="lineno"> 1779</span>    DirBeta[i]-&gt;Write();</div>
<div class="line"><span class="lineno"> 1780</span>    <span class="keyword">delete</span> DirBeta[i];</div>
<div class="line"><span class="lineno"> 1781</span>  }</div>
<div class="line"><span class="lineno"> 1782</span>  BetaDir-&gt;Write();</div>
<div class="line"><span class="lineno"> 1783</span>  <span class="keyword">delete</span> BetaDir;</div>
<div class="line"><span class="lineno"> 1784</span> </div>
<div class="line"><span class="lineno"> 1785</span>  gErrorIgnoreLevel = originalErrorLevel;</div>
<div class="line"><span class="lineno"> 1786</span>  <a class="code hl_variable" href="classSampleSummary.html#aa7b948f290517a052f04f61dfa6af68f">Outputfile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 1787</span>}</div>
<div class="ttc" id="aclassSampleSummary_html_a9ba7df41774c45a14c0a97e4accc9cc0"><div class="ttname"><a href="classSampleSummary.html#a9ba7df41774c45a14c0a97e4accc9cc0">SampleSummary::SampleNames</a></div><div class="ttdeci">std::vector&lt; std::string &gt; SampleNames</div><div class="ttdoc">name for each sample</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00185">SampleSummary.h:185</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7b87a7ce0c38e968fb841f228aea7212" name="a7b87a7ce0c38e968fb841f228aea7212"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b87a7ce0c38e968fb841f228aea7212">&#9670;&#160;</a></span>PrepareOutput()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::PrepareOutput </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: Prepare output tree and necessary variables. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l00563">563</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  563</span>                                  {</div>
<div class="line"><span class="lineno">  564</span><span class="comment">// **********************</span></div>
<div class="line"><span class="lineno">  565</span> </div>
<div class="line"><span class="lineno">  566</span>  <span class="comment">// Make the output file (MakePosterioPredictive call writes to this)</span></div>
<div class="line"><span class="lineno">  567</span>  std::string TempString = <a class="code hl_variable" href="classSampleSummary.html#a4463f635de4e83c7ada683768454da82">OutputName</a>;</div>
<div class="line"><span class="lineno">  568</span>  TempString.replace(TempString.find(<span class="stringliteral">&quot;.root&quot;</span>), 5, std::string(<span class="stringliteral">&quot;_procsW2.root&quot;</span>));</div>
<div class="line"><span class="lineno">  569</span>  <a class="code hl_variable" href="classSampleSummary.html#aa7b948f290517a052f04f61dfa6af68f">Outputfile</a> = <span class="keyword">new</span> TFile(TempString.c_str(), <span class="stringliteral">&quot;RECREATE&quot;</span>);</div>
<div class="line"><span class="lineno">  570</span> </div>
<div class="line"><span class="lineno">  571</span>  <span class="comment">// The array of doubles we write to the TTree</span></div>
<div class="line"><span class="lineno">  572</span>  <span class="comment">// Data vs Draw</span></div>
<div class="line"><span class="lineno">  573</span>  <a class="code hl_variable" href="classSampleSummary.html#a668c1a7ce4ef8592eae4a91ef99c60dc">llh_data_draw</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">  574</span>  <span class="comment">// Fluctuated Draw vs Draw</span></div>
<div class="line"><span class="lineno">  575</span>  <a class="code hl_variable" href="classSampleSummary.html#a596fc0b5e504bf382c342e950dd7cb95">llh_drawfluc_draw</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">  576</span>  <span class="comment">// Fluctuated Predicitve vs Draw</span></div>
<div class="line"><span class="lineno">  577</span>  <a class="code hl_variable" href="classSampleSummary.html#a107a3073ee178eff7107ccd5f41b91c5">llh_predfluc_draw</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">  578</span> </div>
<div class="line"><span class="lineno">  579</span>  <span class="comment">// Data vs Draw using Rate</span></div>
<div class="line"><span class="lineno">  580</span>  <a class="code hl_variable" href="classSampleSummary.html#adae47fb3a91f5946c7329c6e3643ae9a">llh_rate_data_draw</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">  581</span>  <span class="comment">// Data vs Fluctuated Predictive using Rate</span></div>
<div class="line"><span class="lineno">  582</span>  <a class="code hl_variable" href="classSampleSummary.html#aa27591c1aff4c4e8e25fbf9c13ae37c5">llh_rate_predfluc_draw</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">  583</span> </div>
<div class="line"><span class="lineno">  584</span>  <span class="comment">// Data vs Fluctuated Draw</span></div>
<div class="line"><span class="lineno">  585</span>  <a class="code hl_variable" href="classSampleSummary.html#a999cbd0982694a364f8706ca2b435d81">llh_data_drawfluc</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">  586</span>  <span class="comment">// Data vs Fluctuated Predictive</span></div>
<div class="line"><span class="lineno">  587</span>  <a class="code hl_variable" href="classSampleSummary.html#a325a83aec886a90ed6d4c96ccf573c56">llh_data_predfluc</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">  588</span>  <span class="comment">// Draw vs Predictive</span></div>
<div class="line"><span class="lineno">  589</span>  <a class="code hl_variable" href="classSampleSummary.html#a7f46ee13ef20275c5dc162196190984b">llh_draw_pred</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">  590</span>  <span class="comment">// Fluctuated Draw vs Predictive</span></div>
<div class="line"><span class="lineno">  591</span>  <a class="code hl_variable" href="classSampleSummary.html#abc8205a6fddca44ed7c5b3e5c50612e7">llh_drawfluc_pred</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">  592</span>  <span class="comment">// Fluctuated Draw vs Fluctuated Predictive</span></div>
<div class="line"><span class="lineno">  593</span>  <a class="code hl_variable" href="classSampleSummary.html#a642d0e2bb5bc0729744684a3f8bbc459">llh_drawfluc_predfluc</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span>  <span class="comment">// Fluctuated Predictive vs Predictive</span></div>
<div class="line"><span class="lineno">  596</span>  <a class="code hl_variable" href="classSampleSummary.html#a464faf180667c999aec72c140ddb515a">llh_predfluc_pred</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">  597</span>  <span class="comment">// Fluctuated Data vs Draw</span></div>
<div class="line"><span class="lineno">  598</span>  <a class="code hl_variable" href="classSampleSummary.html#abe225db63f8137df4b74d138ab1eb6f2">llh_datafluc_draw</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">  599</span>  </div>
<div class="line"><span class="lineno">  600</span>  <span class="comment">// Data vs Draw for 1D projection</span></div>
<div class="line"><span class="lineno">  601</span>  <a class="code hl_variable" href="classSampleSummary.html#a083eb13c61fe7d1b88b2ebe845312640">llh_data_draw_ProjectX</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">  602</span>  <a class="code hl_variable" href="classSampleSummary.html#a81be1b29e649529930276daab33f7b69">llh_drawfluc_draw_ProjectX</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">  603</span>    </div>
<div class="line"><span class="lineno">  604</span>  <span class="comment">// The output tree we&#39;re going to write to</span></div>
<div class="line"><span class="lineno">  605</span>  <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a> = <span class="keyword">new</span> TTree(<span class="stringliteral">&quot;LLH_draws&quot;</span>, <span class="stringliteral">&quot;LLH_draws&quot;</span>);</div>
<div class="line"><span class="lineno">  606</span>  <a class="code hl_variable" href="classSampleSummary.html#a9ba7df41774c45a14c0a97e4accc9cc0">SampleNames</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">  607</span>  <span class="comment">// Loop over the samples and set the addresses of the variables to write to file</span></div>
<div class="line"><span class="lineno">  608</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++i)</div>
<div class="line"><span class="lineno">  609</span>  {</div>
<div class="line"><span class="lineno">  610</span>    <span class="comment">// Get the name</span></div>
<div class="line"><span class="lineno">  611</span>    std::string SampleName = <a class="code hl_variable" href="classSampleSummary.html#abd938805245ca6cfeb8c49363f5ff11c">SamplePDF</a>-&gt;<a class="code hl_function" href="classsamplePDFBase.html#a35ced08988cee48ac111024c70a2c7c2">GetSampleName</a>(i);</div>
<div class="line"><span class="lineno">  612</span>    <span class="comment">// Strip out spaces</span></div>
<div class="line"><span class="lineno">  613</span>    <span class="keywordflow">while</span> (SampleName.find(<span class="stringliteral">&quot; &quot;</span>) != std::string::npos) {</div>
<div class="line"><span class="lineno">  614</span>      SampleName.replace(SampleName.find(<span class="stringliteral">&quot; &quot;</span>), 1, std::string(<span class="stringliteral">&quot;_&quot;</span>));</div>
<div class="line"><span class="lineno">  615</span>    }</div>
<div class="line"><span class="lineno">  616</span>    <a class="code hl_variable" href="classSampleSummary.html#a9ba7df41774c45a14c0a97e4accc9cc0">SampleNames</a>[i] = SampleName;</div>
<div class="line"><span class="lineno">  617</span>    <span class="comment">//CW: Also strip out - signs because it messes up TBranches</span></div>
<div class="line"><span class="lineno">  618</span>    <span class="keywordflow">while</span> (SampleName.find(<span class="stringliteral">&quot;-&quot;</span>) != std::string::npos) {</div>
<div class="line"><span class="lineno">  619</span>      SampleName.replace(SampleName.find(<span class="stringliteral">&quot;-&quot;</span>), 1, std::string(<span class="stringliteral">&quot;_&quot;</span>));</div>
<div class="line"><span class="lineno">  620</span>    }</div>
<div class="line"><span class="lineno">  621</span><span class="comment">//  All LLH below are used for actual p-value calculations</span></div>
<div class="line"><span class="lineno">  622</span>    <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch((SampleName+<span class="stringliteral">&quot;_data_draw&quot;</span>).c_str(),     &amp;<a class="code hl_variable" href="classSampleSummary.html#a668c1a7ce4ef8592eae4a91ef99c60dc">llh_data_draw</a>[i]);</div>
<div class="line"><span class="lineno">  623</span>    <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch((SampleName+<span class="stringliteral">&quot;_drawfluc_draw&quot;</span>).c_str(), &amp;<a class="code hl_variable" href="classSampleSummary.html#a596fc0b5e504bf382c342e950dd7cb95">llh_drawfluc_draw</a>[i]);</div>
<div class="line"><span class="lineno">  624</span>    <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch((SampleName+<span class="stringliteral">&quot;_predfluc_draw&quot;</span>).c_str(), &amp;<a class="code hl_variable" href="classSampleSummary.html#a107a3073ee178eff7107ccd5f41b91c5">llh_predfluc_draw</a>[i]);</div>
<div class="line"><span class="lineno">  625</span> </div>
<div class="line"><span class="lineno">  626</span><span class="comment">//  All LLH below are used for actual p-value calculations however using rate only</span></div>
<div class="line"><span class="lineno">  627</span>    <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch((SampleName+<span class="stringliteral">&quot;_rate_data_draw&quot;</span>).c_str(), &amp;<a class="code hl_variable" href="classSampleSummary.html#adae47fb3a91f5946c7329c6e3643ae9a">llh_rate_data_draw</a>[i]);</div>
<div class="line"><span class="lineno">  628</span>    <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch((SampleName+<span class="stringliteral">&quot;_rate_predfluc_draw&quot;</span>).c_str(), &amp;<a class="code hl_variable" href="classSampleSummary.html#aa27591c1aff4c4e8e25fbf9c13ae37c5">llh_rate_predfluc_draw</a>[i]);</div>
<div class="line"><span class="lineno">  629</span> </div>
<div class="line"><span class="lineno">  630</span><span class="comment">//  All LLH below are for validation reason but not used for final P-Value</span></div>
<div class="line"><span class="lineno">  631</span>    <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch((SampleName+<span class="stringliteral">&quot;_data_drawfluc&quot;</span>).c_str(), &amp;<a class="code hl_variable" href="classSampleSummary.html#a999cbd0982694a364f8706ca2b435d81">llh_data_drawfluc</a>[i]);</div>
<div class="line"><span class="lineno">  632</span>    <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch((SampleName+<span class="stringliteral">&quot;_data_predfluc&quot;</span>).c_str(), &amp;<a class="code hl_variable" href="classSampleSummary.html#a325a83aec886a90ed6d4c96ccf573c56">llh_data_predfluc</a>[i]);</div>
<div class="line"><span class="lineno">  633</span>    <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch((SampleName+<span class="stringliteral">&quot;_draw_pred&quot;</span>).c_str(),     &amp;<a class="code hl_variable" href="classSampleSummary.html#a7f46ee13ef20275c5dc162196190984b">llh_draw_pred</a>[i]);</div>
<div class="line"><span class="lineno">  634</span>    <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch((SampleName+<span class="stringliteral">&quot;_drawfluc_pred&quot;</span>).c_str(), &amp;<a class="code hl_variable" href="classSampleSummary.html#abc8205a6fddca44ed7c5b3e5c50612e7">llh_drawfluc_pred</a>[i]);</div>
<div class="line"><span class="lineno">  635</span>    <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch((SampleName+<span class="stringliteral">&quot;_drawfluc_predfluc&quot;</span>).c_str(), &amp;<a class="code hl_variable" href="classSampleSummary.html#a642d0e2bb5bc0729744684a3f8bbc459">llh_drawfluc_predfluc</a>[i]);</div>
<div class="line"><span class="lineno">  636</span>    <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch((SampleName+<span class="stringliteral">&quot;_predfluc_pred&quot;</span>).c_str(), &amp;<a class="code hl_variable" href="classSampleSummary.html#a464faf180667c999aec72c140ddb515a">llh_predfluc_pred</a>[i]);</div>
<div class="line"><span class="lineno">  637</span>    <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch((SampleName+<span class="stringliteral">&quot;_datafluc_draw&quot;</span>).c_str(), &amp;<a class="code hl_variable" href="classSampleSummary.html#abe225db63f8137df4b74d138ab1eb6f2">llh_datafluc_draw</a>[i]);</div>
<div class="line"><span class="lineno">  638</span> </div>
<div class="line"><span class="lineno">  639</span><span class="comment">//  All LLH below are used for calcauting P-Value but using 1D projections</span></div>
<div class="line"><span class="lineno">  640</span>    <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch((SampleName+<span class="stringliteral">&quot;_data_draw_ProjectX&quot;</span>).c_str(), &amp;<a class="code hl_variable" href="classSampleSummary.html#a083eb13c61fe7d1b88b2ebe845312640">llh_data_draw_ProjectX</a>[i]);</div>
<div class="line"><span class="lineno">  641</span>    <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch((SampleName+<span class="stringliteral">&quot;_drawfluc_draw_ProjectX&quot;</span>).c_str(), &amp;<a class="code hl_variable" href="classSampleSummary.html#a81be1b29e649529930276daab33f7b69">llh_drawfluc_draw_ProjectX</a>[i]);</div>
<div class="line"><span class="lineno">  642</span>  }</div>
<div class="line"><span class="lineno">  643</span><span class="comment">//All LLH below are used for actual p-value calculations</span></div>
<div class="line"><span class="lineno">  644</span>  <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch(<span class="stringliteral">&quot;LLH_Penalty&quot;</span>,         &amp;<a class="code hl_variable" href="classSampleSummary.html#aef70c5ef9c8432dc42ff7f6c73c7e8d5">llh_penalty</a>);</div>
<div class="line"><span class="lineno">  645</span>  <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch(<span class="stringliteral">&quot;Total_LLH_Data_Draw&quot;</span>, &amp;<a class="code hl_variable" href="classSampleSummary.html#a2cb3d8dcbab49b62be3bc2a4a7e4d5f3">total_llh_data_draw</a>);</div>
<div class="line"><span class="lineno">  646</span>  <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch(<span class="stringliteral">&quot;Total_LLH_DrawFluc_Draw&quot;</span>, &amp;<a class="code hl_variable" href="classSampleSummary.html#a7e418146cce2c4201c3aa7e1eaad4a38">total_llh_drawfluc_draw</a>);</div>
<div class="line"><span class="lineno">  647</span>  <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch(<span class="stringliteral">&quot;Total_LLH_PredFluc_Draw&quot;</span>, &amp;<a class="code hl_variable" href="classSampleSummary.html#a804a117990fd1441c9e3a9d8e8d32e98">total_llh_predfluc_draw</a>);</div>
<div class="line"><span class="lineno">  648</span>  </div>
<div class="line"><span class="lineno">  649</span><span class="comment">//  All LLH below are used for actual p-value calculations however using rate only</span></div>
<div class="line"><span class="lineno">  650</span>  <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch(<span class="stringliteral">&quot;Total_LLH_Rate_PredFluc_Draw&quot;</span>, &amp;<a class="code hl_variable" href="classSampleSummary.html#a2ebe701d114669fdfcf61e1680bb144d">total_llh_rate_predfluc_draw</a>);</div>
<div class="line"><span class="lineno">  651</span> </div>
<div class="line"><span class="lineno">  652</span><span class="comment">//All LLH below are for validation reason but not used for final P-Value</span></div>
<div class="line"><span class="lineno">  653</span>  <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch(<span class="stringliteral">&quot;Total_LLH_Data_DrawFluc&quot;</span>, &amp;<a class="code hl_variable" href="classSampleSummary.html#a670c890357fd77997279c83c197f989c">total_llh_data_drawfluc</a>);</div>
<div class="line"><span class="lineno">  654</span>  <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch(<span class="stringliteral">&quot;Total_LLH_Data_PredFluc&quot;</span>, &amp;<a class="code hl_variable" href="classSampleSummary.html#aeee48af77dc4e0beee5eab13c30f3d38">total_llh_data_predfluc</a>);</div>
<div class="line"><span class="lineno">  655</span>  <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch(<span class="stringliteral">&quot;Total_LLH_Draw_Pred&quot;</span>,     &amp;<a class="code hl_variable" href="classSampleSummary.html#a58efe34df7c43fb40d211036e30a1b5d">total_llh_draw_pred</a>);</div>
<div class="line"><span class="lineno">  656</span>  <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch(<span class="stringliteral">&quot;Total_LLH_DrawFluc_Pred&quot;</span>, &amp;<a class="code hl_variable" href="classSampleSummary.html#a9c8b444ac7f80a5af63d5b9f4a150b79">total_llh_drawfluc_pred</a>);</div>
<div class="line"><span class="lineno">  657</span>  <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch(<span class="stringliteral">&quot;Total_LLH_DrawFluc_PredFluc&quot;</span>, &amp;<a class="code hl_variable" href="classSampleSummary.html#af92a42a666e1bfcb2dc761ffa2253b7e">total_llh_drawfluc_predfluc</a>);</div>
<div class="line"><span class="lineno">  658</span>  <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch(<span class="stringliteral">&quot;Total_LLH_PredFluc_Pred&quot;</span>, &amp;<a class="code hl_variable" href="classSampleSummary.html#a1f6c2e7ed8f9024cf928da5b56054e07">total_llh_predfluc_pred</a>);</div>
<div class="line"><span class="lineno">  659</span>  <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch(<span class="stringliteral">&quot;Total_LLH_DataFluc_Draw&quot;</span>, &amp;<a class="code hl_variable" href="classSampleSummary.html#af9e5d89095e6c6a81aedb5ea2402e3fb">total_llh_datafluc_draw</a>);</div>
<div class="line"><span class="lineno">  660</span>  </div>
<div class="line"><span class="lineno">  661</span><span class="comment">//All LLH below are used for calcauting P-Value but 1D projections</span></div>
<div class="line"><span class="lineno">  662</span>  <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch(<span class="stringliteral">&quot;total_llh_data_draw_ProjectX&quot;</span>, &amp;<a class="code hl_variable" href="classSampleSummary.html#a5a973692db89f52c19c9195ffe95c9a1">total_llh_data_draw_ProjectX</a>);</div>
<div class="line"><span class="lineno">  663</span>  <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Branch(<span class="stringliteral">&quot;total_llh_drawfluc_draw_ProjectX&quot;</span>, &amp;<a class="code hl_variable" href="classSampleSummary.html#a22df11667306c7892f9ed3f8935a5c9e">total_llh_drawfluc_draw_ProjectX</a>);</div>
<div class="line"><span class="lineno">  664</span> </div>
<div class="line"><span class="lineno">  665</span>  <a class="code hl_variable" href="classSampleSummary.html#aa7b948f290517a052f04f61dfa6af68f">Outputfile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  666</span>  <a class="code hl_variable" href="classSampleSummary.html#aa2064e7455c3164ee5118a5e5162f282">Dir</a>.resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno">  667</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++i)</div>
<div class="line"><span class="lineno">  668</span>  {</div>
<div class="line"><span class="lineno">  669</span>    <span class="comment">// Make a new directory</span></div>
<div class="line"><span class="lineno">  670</span>    <a class="code hl_variable" href="classSampleSummary.html#aa2064e7455c3164ee5118a5e5162f282">Dir</a>[i] = <a class="code hl_variable" href="classSampleSummary.html#aa7b948f290517a052f04f61dfa6af68f">Outputfile</a>-&gt;mkdir((<a class="code hl_variable" href="classSampleSummary.html#a9ba7df41774c45a14c0a97e4accc9cc0">SampleNames</a>[i]).c_str());</div>
<div class="line"><span class="lineno">  671</span>  }</div>
<div class="line"><span class="lineno">  672</span>}</div>
<div class="ttc" id="aclassSampleSummary_html_aa2064e7455c3164ee5118a5e5162f282"><div class="ttname"><a href="classSampleSummary.html#aa2064e7455c3164ee5118a5e5162f282">SampleSummary::Dir</a></div><div class="ttdeci">std::vector&lt; TDirectory * &gt; Dir</div><div class="ttdoc">Directory for each sample.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00288">SampleSummary.h:288</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af9277cfce437396a23e3fb22c55196f9" name="af9277cfce437396a23e3fb22c55196f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9277cfce437396a23e3fb22c55196f9">&#9670;&#160;</a></span>ProjectHist()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH1D * SampleSummary::ProjectHist </td>
          <td>(</td>
          <td class="paramtype">TH2D *&#160;</td>
          <td class="paramname"><em>Histogram</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>ProjectX</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper to project TH2D onto axis. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l02248">2248</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2248</span>                                                                     {</div>
<div class="line"><span class="lineno"> 2249</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 2250</span>  TH1D* Projection = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2251</span>  std::string name;</div>
<div class="line"><span class="lineno"> 2252</span>  <span class="keywordflow">if</span> (ProjectX) {</div>
<div class="line"><span class="lineno"> 2253</span>    name = std::string(Histogram-&gt;GetName()) + <span class="stringliteral">&quot;_x&quot;</span>;</div>
<div class="line"><span class="lineno"> 2254</span>    Projection = Histogram-&gt;ProjectionX(name.c_str(), 1, Histogram-&gt;GetYaxis()-&gt;GetNbins(), <span class="stringliteral">&quot;e&quot;</span>);</div>
<div class="line"><span class="lineno"> 2255</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2256</span>    name = std::string(Histogram-&gt;GetName()) + <span class="stringliteral">&quot;_y&quot;</span>;</div>
<div class="line"><span class="lineno"> 2257</span>    Projection = Histogram-&gt;ProjectionY(name.c_str(), 1, Histogram-&gt;GetXaxis()-&gt;GetNbins(), <span class="stringliteral">&quot;e&quot;</span>);</div>
<div class="line"><span class="lineno"> 2258</span>  }</div>
<div class="line"><span class="lineno"> 2259</span>  <span class="keywordflow">return</span> Projection;</div>
<div class="line"><span class="lineno"> 2260</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a685a8ef3180d4f6474328b5c806d8b74" name="a685a8ef3180d4f6474328b5c806d8b74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a685a8ef3180d4f6474328b5c806d8b74">&#9670;&#160;</a></span>ProjectPoly()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH1D * SampleSummary::ProjectPoly </td>
          <td>(</td>
          <td class="paramtype">TH2Poly *&#160;</td>
          <td class="paramname"><em>Histogram</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>ProjectX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>selection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>MakeErrorHist</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper to project TH2Poly onto axis. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l02264">2264</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2264</span>                                                                                                                       {</div>
<div class="line"><span class="lineno"> 2265</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 2266</span>  std::vector&lt;double&gt; xbins;</div>
<div class="line"><span class="lineno"> 2267</span>  std::vector&lt;double&gt; ybins;</div>
<div class="line"><span class="lineno"> 2268</span> </div>
<div class="line"><span class="lineno"> 2269</span>  <a class="code hl_variable" href="classSampleSummary.html#abd938805245ca6cfeb8c49363f5ff11c">SamplePDF</a>-&gt;<a class="code hl_function" href="classsamplePDFBase.html#aa3ac45cabba791d5ea5baabcc277384b">SetupBinning</a>(<a class="code hl_typedef" href="namespaceM3.html#adb59b8ecdc4e1b2d5d4c826a13aa7463">M3::int_t</a>(selection), xbins, ybins);</div>
<div class="line"><span class="lineno"> 2270</span>  TH1D* Projection = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2271</span>  std::string name;</div>
<div class="line"><span class="lineno"> 2272</span>  <span class="keywordflow">if</span> (ProjectX) {</div>
<div class="line"><span class="lineno"> 2273</span>    name = std::string(Histogram-&gt;GetName()) + <span class="stringliteral">&quot;_x&quot;</span>;</div>
<div class="line"><span class="lineno"> 2274</span>    Projection = <a class="code hl_function" href="Structs_8cpp.html#a1ab7c868447cffff71227e07655b47ad">PolyProjectionX</a>(Histogram, name.c_str(), xbins, MakeErrorHist);</div>
<div class="line"><span class="lineno"> 2275</span>  }  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2276</span>    name = std::string(Histogram-&gt;GetName()) + <span class="stringliteral">&quot;_y&quot;</span>;</div>
<div class="line"><span class="lineno"> 2277</span>    Projection = <a class="code hl_function" href="Structs_8cpp.html#aa26af438a657c81f2fb3f1506c6e35f6">PolyProjectionY</a>(Histogram, name.c_str(), ybins, MakeErrorHist);</div>
<div class="line"><span class="lineno"> 2278</span>  }</div>
<div class="line"><span class="lineno"> 2279</span>  <span class="keywordflow">return</span> Projection;</div>
<div class="line"><span class="lineno"> 2280</span>}</div>
<div class="ttc" id="aStructs_8cpp_html_a1ab7c868447cffff71227e07655b47ad"><div class="ttname"><a href="Structs_8cpp.html#a1ab7c868447cffff71227e07655b47ad">PolyProjectionX</a></div><div class="ttdeci">TH1D * PolyProjectionX(TObject *poly, std::string TempName, const std::vector&lt; double &gt; &amp;xbins, const bool computeErrors)</div><div class="ttdoc">WP: Poly Projectors.</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8cpp_source.html#l00178">Structs.cpp:178</a></div></div>
<div class="ttc" id="aStructs_8cpp_html_aa26af438a657c81f2fb3f1506c6e35f6"><div class="ttname"><a href="Structs_8cpp.html#aa26af438a657c81f2fb3f1506c6e35f6">PolyProjectionY</a></div><div class="ttdeci">TH1D * PolyProjectionY(TObject *poly, std::string TempName, const std::vector&lt; double &gt; &amp;ybins, const bool computeErrors)</div><div class="ttdoc">WP: Poly Projectors.</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8cpp_source.html#l00246">Structs.cpp:246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6cd67dc7cbc004f9b1581ac3a68e1924" name="a6cd67dc7cbc004f9b1581ac3a68e1924"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cd67dc7cbc004f9b1581ac3a68e1924">&#9670;&#160;</a></span>RatioHists()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class HistType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">HistType * SampleSummary::RatioHists </td>
          <td>(</td>
          <td class="paramtype">HistType *&#160;</td>
          <td class="paramname"><em>NumHist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">HistType *&#160;</td>
          <td class="paramname"><em>DenomHist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper to make ratio histograms. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l01623">1623</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1623</span>                                                                          {</div>
<div class="line"><span class="lineno"> 1624</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 1625</span>  HistType *NumCopy = <span class="keyword">static_cast&lt;</span>HistType*<span class="keyword">&gt;</span>(NumHist-&gt;Clone());</div>
<div class="line"><span class="lineno"> 1626</span>  std::string title = std::string(DenomHist-&gt;GetName()) + <span class="stringliteral">&quot;_ratio&quot;</span>;</div>
<div class="line"><span class="lineno"> 1627</span>  NumCopy-&gt;SetNameTitle(title.c_str(), title.c_str());</div>
<div class="line"><span class="lineno"> 1628</span>  NumCopy-&gt;Divide(DenomHist);</div>
<div class="line"><span class="lineno"> 1629</span> </div>
<div class="line"><span class="lineno"> 1630</span>  <span class="keywordflow">return</span> NumCopy;</div>
<div class="line"><span class="lineno"> 1631</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6d7ad3d2ee9868e80548b8a73299bd5b" name="a6d7ad3d2ee9868e80548b8a73299bd5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d7ad3d2ee9868e80548b8a73299bd5b">&#9670;&#160;</a></span>RatioPolys()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH2Poly * SampleSummary::RatioPolys </td>
          <td>(</td>
          <td class="paramtype">TH2Poly *&#160;</td>
          <td class="paramname"><em>NumPoly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH2Poly *&#160;</td>
          <td class="paramname"><em>DenomPoly</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper to make ratio of TH2Polys. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l01635">1635</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1635</span>                                                                       {</div>
<div class="line"><span class="lineno"> 1636</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 1637</span>  TH2Poly *NumCopy = <span class="keyword">static_cast&lt;</span>TH2Poly*<span class="keyword">&gt;</span>(NumHist-&gt;Clone());</div>
<div class="line"><span class="lineno"> 1638</span>  std::string title = std::string(DenomHist-&gt;GetName()) + <span class="stringliteral">&quot;_ratio&quot;</span>;</div>
<div class="line"><span class="lineno"> 1639</span>  NumCopy-&gt;SetNameTitle(title.c_str(), title.c_str());</div>
<div class="line"><span class="lineno"> 1640</span> </div>
<div class="line"><span class="lineno"> 1641</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i &lt; NumCopy-&gt;GetNumberOfBins()+1; ++i)</div>
<div class="line"><span class="lineno"> 1642</span>  {</div>
<div class="line"><span class="lineno"> 1643</span>    NumCopy-&gt;SetBinContent(i,NumHist-&gt;GetBinContent(i)/DenomHist-&gt;GetBinContent(i));</div>
<div class="line"><span class="lineno"> 1644</span>  }</div>
<div class="line"><span class="lineno"> 1645</span> </div>
<div class="line"><span class="lineno"> 1646</span>  <span class="keywordflow">return</span> NumCopy;</div>
<div class="line"><span class="lineno"> 1647</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aec9b5e17c269714496bf717bd7d6ae81" name="aec9b5e17c269714496bf717bd7d6ae81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec9b5e17c269714496bf717bd7d6ae81">&#9670;&#160;</a></span>SetLikelihood()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::SetLikelihood </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="Structs_8h.html#a960da89e33ac45a56f7bbfac3068dc67">TestStatistic</a>&#160;</td>
          <td class="paramname"><em>TestStat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: Set likelihood type. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00049">49</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   49</span>{ <a class="code hl_variable" href="classSampleSummary.html#aafb18632bb987ae9a302d95781d5fdba">likelihood</a> = TestStat;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab659605093e8fb68607a0fd5691e0535" name="ab659605093e8fb68607a0fd5691e0535"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab659605093e8fb68607a0fd5691e0535">&#9670;&#160;</a></span>SetNModelParams()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::SetNModelParams </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nPars</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set number of model params used for BIC. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00051">51</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   51</span>{ <a class="code hl_variable" href="classSampleSummary.html#a49215601479aaa99f9f64d8f7c900385">nModelParams</a> = nPars;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3560f062913ea70912e7b9a1cb93e2a5" name="a3560f062913ea70912e7b9a1cb93e2a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3560f062913ea70912e7b9a1cb93e2a5">&#9670;&#160;</a></span>StudyBIC()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::StudyBIC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Study Bayesian Information Criterion (BIC) <a class="el" href="citelist.html#CITEREF_Gelman2014">[9]</a>. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l02484">2484</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2484</span>                            {</div>
<div class="line"><span class="lineno"> 2485</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 2486</span>  <span class="comment">//make fancy event rate histogram</span></div>
<div class="line"><span class="lineno"> 2487</span>  <span class="keywordtype">double</span> DataRate = 0.0;</div>
<div class="line"><span class="lineno"> 2488</span>  <span class="keywordtype">double</span> BinsRate = 0.0;</div>
<div class="line"><span class="lineno"> 2489</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 2490</span><span class="preprocessor">  #pragma omp parallel for reduction(+:DataRate, BinsRate)</span></div>
<div class="line"><span class="lineno"> 2491</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 2492</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++i)</div>
<div class="line"><span class="lineno"> 2493</span>  {</div>
<div class="line"><span class="lineno"> 2494</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i] == <span class="keyword">nullptr</span>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2495</span>    DataRate += <a class="code hl_function" href="Structs_8cpp.html#ab18c6b2408d7b9021bad06d47a06ee8d">NoOverflowIntegral</a>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i]);</div>
<div class="line"><span class="lineno"> 2496</span>    BinsRate += <a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[i];</div>
<div class="line"><span class="lineno"> 2497</span>  }</div>
<div class="line"><span class="lineno"> 2498</span> </div>
<div class="line"><span class="lineno"> 2499</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> EventRateBIC = <a class="code hl_function" href="StatisticalUtils_8h.html#a3dbcf2e503dd81c1c26f063a7e6b3362">GetBIC</a>(<a class="code hl_variable" href="classSampleSummary.html#aacac73b24f1e8b05d35fabe2322578e8">llh_total</a>, DataRate, <a class="code hl_variable" href="classSampleSummary.html#a49215601479aaa99f9f64d8f7c900385">nModelParams</a>);</div>
<div class="line"><span class="lineno"> 2500</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> BinBasedBIC = <a class="code hl_function" href="StatisticalUtils_8h.html#a3dbcf2e503dd81c1c26f063a7e6b3362">GetBIC</a>(<a class="code hl_variable" href="classSampleSummary.html#aacac73b24f1e8b05d35fabe2322578e8">llh_total</a>, BinsRate, <a class="code hl_variable" href="classSampleSummary.html#a49215601479aaa99f9f64d8f7c900385">nModelParams</a>);</div>
<div class="line"><span class="lineno"> 2501</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Calculated Bayesian Information Criterion using global number of events: {:.2f}&quot;</span>, EventRateBIC);</div>
<div class="line"><span class="lineno"> 2502</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Calculated Bayesian Information Criterion using global number of bins: {:.2f}&quot;</span>, BinBasedBIC);</div>
<div class="line"><span class="lineno"> 2503</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Additional info: nModelParams {} DataRate: {:.2f} BinsRate: {:.2f}&quot;</span>, <a class="code hl_variable" href="classSampleSummary.html#a49215601479aaa99f9f64d8f7c900385">nModelParams</a>, DataRate, BinsRate);</div>
<div class="line"><span class="lineno"> 2504</span>}</div>
<div class="ttc" id="aStatisticalUtils_8h_html_a3dbcf2e503dd81c1c26f063a7e6b3362"><div class="ttname"><a href="StatisticalUtils_8h.html#a3dbcf2e503dd81c1c26f063a7e6b3362">GetBIC</a></div><div class="ttdeci">double GetBIC(const double llh, const int data, const int nPars)</div><div class="ttdoc">Get the Bayesian Information Criterion (BIC) or Schwarz information criterion (also SIC,...</div><div class="ttdef"><b>Definition:</b> <a href="StatisticalUtils_8h_source.html#l00088">StatisticalUtils.h:88</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8e73fe07b8b8dfb1e2ee9245df4e7a4b" name="a8e73fe07b8b8dfb1e2ee9245df4e7a4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e73fe07b8b8dfb1e2ee9245df4e7a4b">&#9670;&#160;</a></span>StudyDIC()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::StudyDIC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: Get the Deviance Information Criterion (DIC) <a class="el" href="citelist.html#CITEREF_Spiegelhalter2002">[21]</a> <a class="el" href="citelist.html#CITEREF_BRugsDIC">[23]</a>. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l02508">2508</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2508</span>                             {</div>
<div class="line"><span class="lineno"> 2509</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 2510</span>  <span class="comment">//The posterior mean of the deviance</span></div>
<div class="line"><span class="lineno"> 2511</span>  <span class="keywordtype">double</span> Dbar = 0.;</div>
<div class="line"><span class="lineno"> 2512</span> </div>
<div class="line"><span class="lineno"> 2513</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 2514</span><span class="preprocessor">  #pragma omp parallel for reduction(+:Dbar)</span></div>
<div class="line"><span class="lineno"> 2515</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 2516</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">nThrows</a>; ++i)</div>
<div class="line"><span class="lineno"> 2517</span>  {</div>
<div class="line"><span class="lineno"> 2518</span>    <span class="keywordtype">double</span> LLH_temp = 0.;</div>
<div class="line"><span class="lineno"> 2519</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> SampleNum = 0;  SampleNum &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++SampleNum)</div>
<div class="line"><span class="lineno"> 2520</span>    {</div>
<div class="line"><span class="lineno"> 2521</span>      <span class="comment">// Get -2*log-likelihood</span></div>
<div class="line"><span class="lineno"> 2522</span>      LLH_temp += <a class="code hl_function" href="classSampleSummary.html#ad027b0716b707691e6a9565ee497b66f">GetLLH</a>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[SampleNum], <a class="code hl_variable" href="classSampleSummary.html#a13177305e8fd4b97812b2ca563740bf2">MCVector</a>[i][SampleNum], <a class="code hl_variable" href="classSampleSummary.html#a263b7541545b8b0ba735e0a3ac2d31e7">W2MCVector</a>[i][SampleNum]);</div>
<div class="line"><span class="lineno"> 2523</span>    }</div>
<div class="line"><span class="lineno"> 2524</span>    Dbar += LLH_temp;</div>
<div class="line"><span class="lineno"> 2525</span>  }</div>
<div class="line"><span class="lineno"> 2526</span>  Dbar = Dbar / <a class="code hl_variable" href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">nThrows</a>;</div>
<div class="line"><span class="lineno"> 2527</span> </div>
<div class="line"><span class="lineno"> 2528</span>  <span class="comment">// A point estimate of the deviance</span></div>
<div class="line"><span class="lineno"> 2529</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> Dhat = <a class="code hl_variable" href="classSampleSummary.html#aacac73b24f1e8b05d35fabe2322578e8">llh_total</a>;</div>
<div class="line"><span class="lineno"> 2530</span> </div>
<div class="line"><span class="lineno"> 2531</span>  <span class="comment">//Effective number of parameters</span></div>
<div class="line"><span class="lineno"> 2532</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> p_D = std::fabs(Dbar - Dhat);</div>
<div class="line"><span class="lineno"> 2533</span> </div>
<div class="line"><span class="lineno"> 2534</span>  <span class="comment">//Actual test stat</span></div>
<div class="line"><span class="lineno"> 2535</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> DIC_stat = Dhat + 2 * p_D;</div>
<div class="line"><span class="lineno"> 2536</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Effective number of parameters following DIC formalism is equal to: {:.2f}&quot;</span>, p_D);</div>
<div class="line"><span class="lineno"> 2537</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;DIC test statistic = {:.2f}&quot;</span>, DIC_stat);</div>
<div class="line"><span class="lineno"> 2538</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a02dcccd537e6e9a9ffc46b31429306ce" name="a02dcccd537e6e9a9ffc46b31429306ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02dcccd537e6e9a9ffc46b31429306ce">&#9670;&#160;</a></span>StudyInformationCriterion()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::StudyInformationCriterion </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceM3.html#a007e5ed320c3672a3faf79da0a38fb7a">M3::kInfCrit</a>&#160;</td>
          <td class="paramname"><em>Criterion</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Information Criterion. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l02459">2459</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2459</span>                                                                  {</div>
<div class="line"><span class="lineno"> 2460</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 2461</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;******************************&quot;</span>);</div>
<div class="line"><span class="lineno"> 2462</span>  <span class="keywordflow">switch</span>(Criterion) {</div>
<div class="line"><span class="lineno"> 2463</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespaceM3.html#a007e5ed320c3672a3faf79da0a38fb7aa79fe5945605f47383db32b24445e9d9b">M3::kInfCrit::kBIC</a>:</div>
<div class="line"><span class="lineno"> 2464</span>      <span class="comment">// Study Bayesian Information Criterion</span></div>
<div class="line"><span class="lineno"> 2465</span>      <a class="code hl_function" href="classSampleSummary.html#a3560f062913ea70912e7b9a1cb93e2a5">StudyBIC</a>();</div>
<div class="line"><span class="lineno"> 2466</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2467</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespaceM3.html#a007e5ed320c3672a3faf79da0a38fb7aaefce2d9c622c72dcb56556408d3d56dc">M3::kInfCrit::kDIC</a>:</div>
<div class="line"><span class="lineno"> 2468</span>      <span class="comment">// Study Deviance Information Criterion</span></div>
<div class="line"><span class="lineno"> 2469</span>      <a class="code hl_function" href="classSampleSummary.html#a8e73fe07b8b8dfb1e2ee9245df4e7a4b">StudyDIC</a>();</div>
<div class="line"><span class="lineno"> 2470</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2471</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespaceM3.html#a007e5ed320c3672a3faf79da0a38fb7aa37b99344010ca5011c37f1a609d6f61d">M3::kInfCrit::kWAIC</a>:</div>
<div class="line"><span class="lineno"> 2472</span>      <span class="comment">// Study Watanabe-Akaike information criterion (WAIC)</span></div>
<div class="line"><span class="lineno"> 2473</span>      <a class="code hl_function" href="classSampleSummary.html#a9f8198603d809480506cdc9bf171e9e8">StudyWAIC</a>();</div>
<div class="line"><span class="lineno"> 2474</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2475</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 2476</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;UNKNOWN Information Criterion SPECIFIED!&quot;</span>);</div>
<div class="line"><span class="lineno"> 2477</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;You gave {}&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(Criterion));</div>
<div class="line"><span class="lineno"> 2478</span>      <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno"> 2479</span>  }</div>
<div class="line"><span class="lineno"> 2480</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;******************************&quot;</span>);</div>
<div class="line"><span class="lineno"> 2481</span>}</div>
<div class="ttc" id="aclassSampleSummary_html_a3560f062913ea70912e7b9a1cb93e2a5"><div class="ttname"><a href="classSampleSummary.html#a3560f062913ea70912e7b9a1cb93e2a5">SampleSummary::StudyBIC</a></div><div class="ttdeci">void StudyBIC()</div><div class="ttdoc">Study Bayesian Information Criterion (BIC) .</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8cpp_source.html#l02484">SampleSummary.cpp:2484</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a8e73fe07b8b8dfb1e2ee9245df4e7a4b"><div class="ttname"><a href="classSampleSummary.html#a8e73fe07b8b8dfb1e2ee9245df4e7a4b">SampleSummary::StudyDIC</a></div><div class="ttdeci">void StudyDIC()</div><div class="ttdoc">KS: Get the Deviance Information Criterion (DIC)  .</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8cpp_source.html#l02508">SampleSummary.cpp:2508</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a9f8198603d809480506cdc9bf171e9e8"><div class="ttname"><a href="classSampleSummary.html#a9f8198603d809480506cdc9bf171e9e8">SampleSummary::StudyWAIC</a></div><div class="ttdeci">void StudyWAIC()</div><div class="ttdoc">KS: Get the Watanabe-Akaike information criterion (WAIC)  .</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8cpp_source.html#l02542">SampleSummary.cpp:2542</a></div></div>
<div class="ttc" id="anamespaceM3_html_a007e5ed320c3672a3faf79da0a38fb7aa37b99344010ca5011c37f1a609d6f61d"><div class="ttname"><a href="namespaceM3.html#a007e5ed320c3672a3faf79da0a38fb7aa37b99344010ca5011c37f1a609d6f61d">M3::kWAIC</a></div><div class="ttdeci">@ kWAIC</div><div class="ttdoc">Watanabe-Akaike information criterion.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00016">SampleSummary.h:16</a></div></div>
<div class="ttc" id="anamespaceM3_html_a007e5ed320c3672a3faf79da0a38fb7aa79fe5945605f47383db32b24445e9d9b"><div class="ttname"><a href="namespaceM3.html#a007e5ed320c3672a3faf79da0a38fb7aa79fe5945605f47383db32b24445e9d9b">M3::kBIC</a></div><div class="ttdeci">@ kBIC</div><div class="ttdoc">Bayesian Information Criterion.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00014">SampleSummary.h:14</a></div></div>
<div class="ttc" id="anamespaceM3_html_a007e5ed320c3672a3faf79da0a38fb7aaefce2d9c622c72dcb56556408d3d56dc"><div class="ttname"><a href="namespaceM3.html#a007e5ed320c3672a3faf79da0a38fb7aaefce2d9c622c72dcb56556408d3d56dc">M3::kDIC</a></div><div class="ttdeci">@ kDIC</div><div class="ttdoc">Deviance Information Criterion.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8h_source.html#l00015">SampleSummary.h:15</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afa199f8841fcbf007c293187ea60d795" name="afa199f8841fcbf007c293187ea60d795"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa199f8841fcbf007c293187ea60d795">&#9670;&#160;</a></span>StudyKinematicCorrelations()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::StudyKinematicCorrelations </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: Study how correlated are sample or kinematic bins. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l01791">1791</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1791</span>                                               {</div>
<div class="line"><span class="lineno"> 1792</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 1793</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Calculating Correlations&quot;</span>);</div>
<div class="line"><span class="lineno"> 1794</span>  TStopwatch timer;</div>
<div class="line"><span class="lineno"> 1795</span>  timer.Start();</div>
<div class="line"><span class="lineno"> 1796</span> </div>
<div class="line"><span class="lineno"> 1797</span>    <span class="comment">// Data vs Draw for 1D projection</span></div>
<div class="line"><span class="lineno"> 1798</span>  std::vector&lt;double&gt; NEvents_Sample(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno"> 1799</span>  <span class="keywordtype">double</span> event_rate = 0.;</div>
<div class="line"><span class="lineno"> 1800</span> </div>
<div class="line"><span class="lineno"> 1801</span>  <span class="comment">// The output tree we&#39;re going to write to</span></div>
<div class="line"><span class="lineno"> 1802</span>  TTree* Event_Rate_Tree = <span class="keyword">new</span> TTree(<span class="stringliteral">&quot;Event_Rate_draws&quot;</span>, <span class="stringliteral">&quot;Event_Rate_draws&quot;</span>);</div>
<div class="line"><span class="lineno"> 1803</span>  Event_Rate_Tree-&gt;Branch(<span class="stringliteral">&quot;Event_Rate&quot;</span>, &amp;event_rate);</div>
<div class="line"><span class="lineno"> 1804</span>  <span class="comment">// Loop over the samples and set the addresses of the variables to write to file</span></div>
<div class="line"><span class="lineno"> 1805</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++i)</div>
<div class="line"><span class="lineno"> 1806</span>  {</div>
<div class="line"><span class="lineno"> 1807</span>    <span class="comment">// Get the name</span></div>
<div class="line"><span class="lineno"> 1808</span>    std::string SampleName = <a class="code hl_variable" href="classSampleSummary.html#a9ba7df41774c45a14c0a97e4accc9cc0">SampleNames</a>[i];</div>
<div class="line"><span class="lineno"> 1809</span>    <span class="comment">//CW: Also strip out - signs because it messes up TBranches</span></div>
<div class="line"><span class="lineno"> 1810</span>    <span class="keywordflow">while</span> (SampleName.find(<span class="stringliteral">&quot;-&quot;</span>) != std::string::npos) {</div>
<div class="line"><span class="lineno"> 1811</span>      SampleName.replace(SampleName.find(<span class="stringliteral">&quot;-&quot;</span>), 1, std::string(<span class="stringliteral">&quot;_&quot;</span>));</div>
<div class="line"><span class="lineno"> 1812</span>    }</div>
<div class="line"><span class="lineno"> 1813</span>    Event_Rate_Tree-&gt;Branch((SampleName+<span class="stringliteral">&quot;_Event_Rate&quot;</span>).c_str(), &amp;NEvents_Sample[i]);</div>
<div class="line"><span class="lineno"> 1814</span>  }</div>
<div class="line"><span class="lineno"> 1815</span> </div>
<div class="line"><span class="lineno"> 1816</span>  <span class="comment">// Holds the total event rate</span></div>
<div class="line"><span class="lineno"> 1817</span>  <span class="keyword">auto</span> EventHist = std::make_unique&lt;TH1D&gt;(<span class="stringliteral">&quot;EventHist&quot;</span>, <span class="stringliteral">&quot;Total Event Rate&quot;</span>, 100, 1, -1);</div>
<div class="line"><span class="lineno"> 1818</span>  EventHist-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1819</span>  EventHist-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Total event rate&quot;</span>);</div>
<div class="line"><span class="lineno"> 1820</span>  EventHist-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Counts&quot;</span>);</div>
<div class="line"><span class="lineno"> 1821</span>  EventHist-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno"> 1822</span> </div>
<div class="line"><span class="lineno"> 1823</span>  <span class="comment">// Holds the event rate for the distribution</span></div>
<div class="line"><span class="lineno"> 1824</span>  std::vector&lt;std::unique_ptr&lt;TH1D&gt;&gt; SumHist(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno"> 1825</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++i)</div>
<div class="line"><span class="lineno"> 1826</span>  {</div>
<div class="line"><span class="lineno"> 1827</span>    std::string name = std::string(<a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i]-&gt;GetName());</div>
<div class="line"><span class="lineno"> 1828</span>    name = name.substr(0, name.find(<span class="stringliteral">&quot;_nom&quot;</span>));</div>
<div class="line"><span class="lineno"> 1829</span> </div>
<div class="line"><span class="lineno"> 1830</span>    SumHist[i] = std::make_unique&lt;TH1D&gt;((name+<span class="stringliteral">&quot;_sum&quot;</span>).c_str(),(name+<span class="stringliteral">&quot;_sum&quot;</span>).c_str(), 100, 1, -1);</div>
<div class="line"><span class="lineno"> 1831</span>    SumHist[i]-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;N_{events}&quot;</span>);</div>
<div class="line"><span class="lineno"> 1832</span>    SumHist[i]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Counts&quot;</span>);</div>
<div class="line"><span class="lineno"> 1833</span>    <span class="keywordtype">double</span> Integral = <a class="code hl_function" href="Structs_8cpp.html#ab18c6b2408d7b9021bad06d47a06ee8d">NoOverflowIntegral</a>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i]);</div>
<div class="line"><span class="lineno"> 1834</span>    std::stringstream ss;</div>
<div class="line"><span class="lineno"> 1835</span>    ss &lt;&lt; Integral;</div>
<div class="line"><span class="lineno"> 1836</span>    SumHist[i]-&gt;SetTitle((std::string(SumHist[i]-&gt;GetTitle())+<span class="stringliteral">&quot;_&quot;</span>+ss.str()).c_str());</div>
<div class="line"><span class="lineno"> 1837</span>  }</div>
<div class="line"><span class="lineno"> 1838</span> </div>
<div class="line"><span class="lineno"> 1839</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> it = 0; it &lt; <a class="code hl_variable" href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">nThrows</a>; ++it)</div>
<div class="line"><span class="lineno"> 1840</span>  {</div>
<div class="line"><span class="lineno"> 1841</span>    <span class="keywordtype">double</span> event_rate_temp = 0.;</div>
<div class="line"><span class="lineno"> 1842</span>    <span class="comment">// Loop over the samples</span></div>
<div class="line"><span class="lineno"> 1843</span><span class="preprocessor">    #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 1844</span><span class="preprocessor">    #pragma omp parallel for reduction(+:event_rate_temp)</span></div>
<div class="line"><span class="lineno"> 1845</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno"> 1846</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> SampleNum = 0;  SampleNum &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++SampleNum)</div>
<div class="line"><span class="lineno"> 1847</span>    {</div>
<div class="line"><span class="lineno"> 1848</span>      NEvents_Sample[SampleNum] = <a class="code hl_function" href="Structs_8cpp.html#ab18c6b2408d7b9021bad06d47a06ee8d">NoOverflowIntegral</a>(<a class="code hl_variable" href="classSampleSummary.html#a13177305e8fd4b97812b2ca563740bf2">MCVector</a>[it][SampleNum]);</div>
<div class="line"><span class="lineno"> 1849</span>      <span class="comment">// Fill the sum histogram with the integral of the sampled distribution</span></div>
<div class="line"><span class="lineno"> 1850</span>      SumHist[SampleNum]-&gt;Fill(NEvents_Sample[SampleNum], <a class="code hl_variable" href="classSampleSummary.html#ad40a0514f4be18ef026ea41bd5965fa3">WeightVector</a>[it]);</div>
<div class="line"><span class="lineno"> 1851</span> </div>
<div class="line"><span class="lineno"> 1852</span>      event_rate_temp += NEvents_Sample[SampleNum];</div>
<div class="line"><span class="lineno"> 1853</span>    } <span class="comment">// end samples loop</span></div>
<div class="line"><span class="lineno"> 1854</span>    event_rate = event_rate_temp;</div>
<div class="line"><span class="lineno"> 1855</span>    EventHist-&gt;Fill(event_rate);</div>
<div class="line"><span class="lineno"> 1856</span>    Event_Rate_Tree-&gt;Fill();</div>
<div class="line"><span class="lineno"> 1857</span>  } <span class="comment">//end loops over throws</span></div>
<div class="line"><span class="lineno"> 1858</span>  Event_Rate_Tree-&gt;Write();</div>
<div class="line"><span class="lineno"> 1859</span>  <span class="keyword">delete</span> Event_Rate_Tree;</div>
<div class="line"><span class="lineno"> 1860</span> </div>
<div class="line"><span class="lineno"> 1861</span>  <span class="keywordtype">double</span> DataRate = 0.0;</div>
<div class="line"><span class="lineno"> 1862</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 1863</span><span class="preprocessor">  #pragma omp parallel for reduction(+:DataRate)</span></div>
<div class="line"><span class="lineno"> 1864</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 1865</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++i)</div>
<div class="line"><span class="lineno"> 1866</span>  {</div>
<div class="line"><span class="lineno"> 1867</span>    DataRate += <a class="code hl_function" href="Structs_8cpp.html#ab18c6b2408d7b9021bad06d47a06ee8d">NoOverflowIntegral</a>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i]);</div>
<div class="line"><span class="lineno"> 1868</span>  }</div>
<div class="line"><span class="lineno"> 1869</span>  <a class="code hl_function" href="classSampleSummary.html#a0e21a2b9fd429261e378f4e505ba2f75">MakeCutEventRate</a>(EventHist.get(), DataRate);</div>
<div class="line"><span class="lineno"> 1870</span> </div>
<div class="line"><span class="lineno"> 1871</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> SampleNum = 0; SampleNum &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++SampleNum)</div>
<div class="line"><span class="lineno"> 1872</span>  {</div>
<div class="line"><span class="lineno"> 1873</span>    <a class="code hl_variable" href="classSampleSummary.html#aa2064e7455c3164ee5118a5e5162f282">Dir</a>[SampleNum]-&gt;cd();</div>
<div class="line"><span class="lineno"> 1874</span>    <span class="comment">//Make fancy event rate histogram</span></div>
<div class="line"><span class="lineno"> 1875</span>    <a class="code hl_function" href="classSampleSummary.html#a0e21a2b9fd429261e378f4e505ba2f75">MakeCutEventRate</a>(SumHist[SampleNum].get(), <a class="code hl_function" href="Structs_8cpp.html#ab18c6b2408d7b9021bad06d47a06ee8d">NoOverflowIntegral</a>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[SampleNum]));</div>
<div class="line"><span class="lineno"> 1876</span>  }</div>
<div class="line"><span class="lineno"> 1877</span> </div>
<div class="line"><span class="lineno"> 1878</span>  <span class="comment">// Make a new directory</span></div>
<div class="line"><span class="lineno"> 1879</span>  TDirectory *CorrDir = <a class="code hl_variable" href="classSampleSummary.html#aa7b948f290517a052f04f61dfa6af68f">Outputfile</a>-&gt;mkdir(<span class="stringliteral">&quot;Correlations&quot;</span>);</div>
<div class="line"><span class="lineno"> 1880</span>  CorrDir-&gt;cd();</div>
<div class="line"><span class="lineno"> 1881</span> </div>
<div class="line"><span class="lineno"> 1882</span>  TMatrixDSym* SampleCorrelation = <span class="keyword">new</span> TMatrixDSym(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno"> 1883</span>  std::vector&lt;std::vector&lt;std::unique_ptr&lt;TH2D&gt;&gt;&gt; SamCorr(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno"> 1884</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++i)</div>
<div class="line"><span class="lineno"> 1885</span>  {</div>
<div class="line"><span class="lineno"> 1886</span>    SamCorr[i].resize(<a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno"> 1887</span> </div>
<div class="line"><span class="lineno"> 1888</span>    (*SampleCorrelation)(i,i) = 1.0;</div>
<div class="line"><span class="lineno"> 1889</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Min_i = SumHist[i]-&gt;GetXaxis()-&gt;GetBinLowEdge(1);</div>
<div class="line"><span class="lineno"> 1890</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Max_i = SumHist[i]-&gt;GetXaxis()-&gt;GetBinUpEdge(SumHist[i]-&gt;GetNbinsX()+1);</div>
<div class="line"><span class="lineno"> 1891</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++j)</div>
<div class="line"><span class="lineno"> 1892</span>    {</div>
<div class="line"><span class="lineno"> 1893</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> Min_j = SumHist[j]-&gt;GetXaxis()-&gt;GetBinLowEdge(1);</div>
<div class="line"><span class="lineno"> 1894</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> Max_j = SumHist[j]-&gt;GetXaxis()-&gt;GetBinUpEdge(SumHist[j]-&gt;GetNbinsX()+1);</div>
<div class="line"><span class="lineno"> 1895</span> </div>
<div class="line"><span class="lineno"> 1896</span>      <span class="comment">// TH2D to hold the Correlation</span></div>
<div class="line"><span class="lineno"> 1897</span>      SamCorr[i][j] = std::make_unique&lt;TH2D&gt;(Form(<span class="stringliteral">&quot;SamCorr_%i_%i&quot;</span>, i, j), Form(<span class="stringliteral">&quot;SamCorr_%i_%i&quot;</span>, i, j), 70, Min_i, Max_i, 70, Min_j, Max_j);</div>
<div class="line"><span class="lineno"> 1898</span>      SamCorr[i][j]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1899</span>      SamCorr[i][j]-&gt;SetMinimum(0);</div>
<div class="line"><span class="lineno"> 1900</span>      SamCorr[i][j]-&gt;GetXaxis()-&gt;SetTitle(<a class="code hl_variable" href="classSampleSummary.html#a9ba7df41774c45a14c0a97e4accc9cc0">SampleNames</a>[i].c_str());</div>
<div class="line"><span class="lineno"> 1901</span>      SamCorr[i][j]-&gt;GetYaxis()-&gt;SetTitle(<a class="code hl_variable" href="classSampleSummary.html#a9ba7df41774c45a14c0a97e4accc9cc0">SampleNames</a>[j].c_str());</div>
<div class="line"><span class="lineno"> 1902</span>      SamCorr[i][j]-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Events&quot;</span>);</div>
<div class="line"><span class="lineno"> 1903</span>    }</div>
<div class="line"><span class="lineno"> 1904</span>  }</div>
<div class="line"><span class="lineno"> 1905</span> </div>
<div class="line"><span class="lineno"> 1906</span>  <span class="comment">// Now we are sure we have the diagonal elements, let&#39;s make the off-diagonals</span></div>
<div class="line"><span class="lineno"> 1907</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 1908</span><span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><span class="lineno"> 1909</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 1910</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++i)</div>
<div class="line"><span class="lineno"> 1911</span>  {</div>
<div class="line"><span class="lineno"> 1912</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)</div>
<div class="line"><span class="lineno"> 1913</span>    {</div>
<div class="line"><span class="lineno"> 1914</span>      <span class="comment">// Skip the diagonal elements which we&#39;ve already done above</span></div>
<div class="line"><span class="lineno"> 1915</span>      <span class="keywordflow">if</span> (j == i) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1916</span> </div>
<div class="line"><span class="lineno"> 1917</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> it = 0; it &lt; <a class="code hl_variable" href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">nThrows</a>; ++it)</div>
<div class="line"><span class="lineno"> 1918</span>      {</div>
<div class="line"><span class="lineno"> 1919</span>        SamCorr[i][j]-&gt;Fill(<a class="code hl_function" href="Structs_8cpp.html#ab18c6b2408d7b9021bad06d47a06ee8d">NoOverflowIntegral</a>(<a class="code hl_variable" href="classSampleSummary.html#a13177305e8fd4b97812b2ca563740bf2">MCVector</a>[it][i]), <a class="code hl_function" href="Structs_8cpp.html#ab18c6b2408d7b9021bad06d47a06ee8d">NoOverflowIntegral</a>(<a class="code hl_variable" href="classSampleSummary.html#a13177305e8fd4b97812b2ca563740bf2">MCVector</a>[it][j]));</div>
<div class="line"><span class="lineno"> 1920</span>      }</div>
<div class="line"><span class="lineno"> 1921</span>      SamCorr[i][j]-&gt;Smooth();</div>
<div class="line"><span class="lineno"> 1922</span> </div>
<div class="line"><span class="lineno"> 1923</span>      <span class="comment">// Get the Covariance for these two parameters</span></div>
<div class="line"><span class="lineno"> 1924</span>      (*SampleCorrelation)(i,j) = SamCorr[i][j]-&gt;GetCorrelationFactor();</div>
<div class="line"><span class="lineno"> 1925</span>      (*SampleCorrelation)(j,i) = (*SampleCorrelation)(i,j);</div>
<div class="line"><span class="lineno"> 1926</span>    }<span class="comment">// End j loop</span></div>
<div class="line"><span class="lineno"> 1927</span>  }<span class="comment">// End i loop</span></div>
<div class="line"><span class="lineno"> 1928</span> </div>
<div class="line"><span class="lineno"> 1929</span>  <span class="keyword">auto</span> hSamCorr = std::make_unique&lt;TH2D&gt;(<span class="stringliteral">&quot;Sample Correlation&quot;</span>, <span class="stringliteral">&quot;Sample Correlation&quot;</span>, <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>, 0, <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>, <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>, 0, <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>);</div>
<div class="line"><span class="lineno"> 1930</span>  hSamCorr-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1931</span>  hSamCorr-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Correlation&quot;</span>);</div>
<div class="line"><span class="lineno"> 1932</span>  hSamCorr-&gt;SetMinimum(-1);</div>
<div class="line"><span class="lineno"> 1933</span>  hSamCorr-&gt;SetMaximum(1);</div>
<div class="line"><span class="lineno"> 1934</span>  hSamCorr-&gt;GetXaxis()-&gt;SetLabelSize(0.015);</div>
<div class="line"><span class="lineno"> 1935</span>  hSamCorr-&gt;GetYaxis()-&gt;SetLabelSize(0.015);</div>
<div class="line"><span class="lineno"> 1936</span> </div>
<div class="line"><span class="lineno"> 1937</span>  <span class="comment">// Loop over the Covariance matrix entries</span></div>
<div class="line"><span class="lineno"> 1938</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++i)</div>
<div class="line"><span class="lineno"> 1939</span>  {</div>
<div class="line"><span class="lineno"> 1940</span>    hSamCorr-&gt;GetXaxis()-&gt;SetBinLabel(i+1, <a class="code hl_variable" href="classSampleSummary.html#a9ba7df41774c45a14c0a97e4accc9cc0">SampleNames</a>[i].c_str());</div>
<div class="line"><span class="lineno"> 1941</span> </div>
<div class="line"><span class="lineno"> 1942</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++j)</div>
<div class="line"><span class="lineno"> 1943</span>    {</div>
<div class="line"><span class="lineno"> 1944</span>      hSamCorr-&gt;GetYaxis()-&gt;SetBinLabel(j+1, <a class="code hl_variable" href="classSampleSummary.html#a9ba7df41774c45a14c0a97e4accc9cc0">SampleNames</a>[j].c_str());</div>
<div class="line"><span class="lineno"> 1945</span>      <span class="comment">// The value of the Covariance</span></div>
<div class="line"><span class="lineno"> 1946</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> corr = (*SampleCorrelation)(i,j);</div>
<div class="line"><span class="lineno"> 1947</span>      hSamCorr-&gt;SetBinContent(i+1, j+1, corr);</div>
<div class="line"><span class="lineno"> 1948</span>    }</div>
<div class="line"><span class="lineno"> 1949</span>  }</div>
<div class="line"><span class="lineno"> 1950</span>  hSamCorr-&gt;Draw(<span class="stringliteral">&quot;colz&quot;</span>);</div>
<div class="line"><span class="lineno"> 1951</span>  hSamCorr-&gt;Write(<span class="stringliteral">&quot;Sample_Corr&quot;</span>);</div>
<div class="line"><span class="lineno"> 1952</span> </div>
<div class="line"><span class="lineno"> 1953</span>  SampleCorrelation-&gt;Write(<span class="stringliteral">&quot;Sample_Correlation&quot;</span>);</div>
<div class="line"><span class="lineno"> 1954</span>  <span class="keyword">delete</span> SampleCorrelation;</div>
<div class="line"><span class="lineno"> 1955</span> </div>
<div class="line"><span class="lineno"> 1956</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++i)</div>
<div class="line"><span class="lineno"> 1957</span>  {</div>
<div class="line"><span class="lineno"> 1958</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)</div>
<div class="line"><span class="lineno"> 1959</span>    {</div>
<div class="line"><span class="lineno"> 1960</span>      <span class="comment">// Skip the diagonal elements which we&#39;ve already done above</span></div>
<div class="line"><span class="lineno"> 1961</span>      <span class="keywordflow">if</span> (j == i) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1962</span>      SamCorr[i][j]-&gt;Write();</div>
<div class="line"><span class="lineno"> 1963</span>    }<span class="comment">// End j loop</span></div>
<div class="line"><span class="lineno"> 1964</span>  }<span class="comment">// End i loop</span></div>
<div class="line"><span class="lineno"> 1965</span> </div>
<div class="line"><span class="lineno"> 1966</span>  <span class="comment">//KS: This can take ages so better turn it off by default</span></div>
<div class="line"><span class="lineno"> 1967</span>  <span class="keywordtype">bool</span> DoPerKinemBin = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1968</span>  <span class="keywordflow">if</span>(DoPerKinemBin)</div>
<div class="line"><span class="lineno"> 1969</span>  {</div>
<div class="line"><span class="lineno"> 1970</span>    <span class="comment">//KS: Now the same but for kinematic bin of each sample</span></div>
<div class="line"><span class="lineno"> 1971</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> SampleNum = 0; SampleNum &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++SampleNum)</div>
<div class="line"><span class="lineno"> 1972</span>    {</div>
<div class="line"><span class="lineno"> 1973</span>      TMatrixDSym* KinCorrelation = <span class="keyword">new</span> TMatrixDSym(<a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[SampleNum]);</div>
<div class="line"><span class="lineno"> 1974</span>      std::vector&lt;std::vector&lt;std::unique_ptr&lt;TH2D&gt;&gt;&gt; KinCorr(<a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[SampleNum]);</div>
<div class="line"><span class="lineno"> 1975</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[SampleNum]; ++i)</div>
<div class="line"><span class="lineno"> 1976</span>      {</div>
<div class="line"><span class="lineno"> 1977</span>        KinCorr[i].resize(<a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[SampleNum]);</div>
<div class="line"><span class="lineno"> 1978</span>        (*KinCorrelation)(i,i) = 1.0;</div>
<div class="line"><span class="lineno"> 1979</span> </div>
<div class="line"><span class="lineno"> 1980</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> Min_i = <a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[SampleNum][i+1]-&gt;GetXaxis()-&gt;GetBinLowEdge(1);</div>
<div class="line"><span class="lineno"> 1981</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> Max_i = <a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[SampleNum][i+1]-&gt;GetXaxis()-&gt;GetBinUpEdge(<a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[SampleNum][i+1]-&gt;GetNbinsX()+1);</div>
<div class="line"><span class="lineno"> 1982</span> </div>
<div class="line"><span class="lineno"> 1983</span>        <span class="comment">//Get PolyBin</span></div>
<div class="line"><span class="lineno"> 1984</span>        TH2PolyBin* bin = <span class="keyword">static_cast&lt;</span>TH2PolyBin*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[SampleNum]-&gt;GetBins()-&gt;At(i));</div>
<div class="line"><span class="lineno"> 1985</span>        <span class="comment">// Just make a little fancy name</span></div>
<div class="line"><span class="lineno"> 1986</span>        std::stringstream ss2;</div>
<div class="line"><span class="lineno"> 1987</span>        ss2 &lt;&lt; <span class="stringliteral">&quot;p_{#mu} (&quot;</span> &lt;&lt; bin-&gt;GetXMin() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; bin-&gt;GetXMax() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><span class="lineno"> 1988</span>        ss2 &lt;&lt; <span class="stringliteral">&quot; cos#theta_{#mu} (&quot;</span> &lt;&lt; bin-&gt;GetYMin() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; bin-&gt;GetYMax() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><span class="lineno"> 1989</span> </div>
<div class="line"><span class="lineno"> 1990</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[SampleNum]; ++j)</div>
<div class="line"><span class="lineno"> 1991</span>        {</div>
<div class="line"><span class="lineno"> 1992</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> Min_j = <a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[SampleNum][j+1]-&gt;GetXaxis()-&gt;GetBinLowEdge(1);</div>
<div class="line"><span class="lineno"> 1993</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> Max_j = <a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[SampleNum][j+1]-&gt;GetXaxis()-&gt;GetBinUpEdge(<a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[SampleNum][j+1]-&gt;GetNbinsX()+1);</div>
<div class="line"><span class="lineno"> 1994</span> </div>
<div class="line"><span class="lineno"> 1995</span>          <span class="comment">// TH2D to hold the Correlation</span></div>
<div class="line"><span class="lineno"> 1996</span>          KinCorr[i][j] = std::make_unique&lt;TH2D&gt;( Form(<span class="stringliteral">&quot;Kin_%i_%i_%i&quot;</span>, SampleNum, i, j),</div>
<div class="line"><span class="lineno"> 1997</span>                    Form(<span class="stringliteral">&quot;Kin_%i_%i_%i&quot;</span>, SampleNum, i, j), 70, Min_i, Max_i, 70, Min_j, Max_j);</div>
<div class="line"><span class="lineno"> 1998</span>          KinCorr[i][j]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1999</span>          KinCorr[i][j]-&gt;SetMinimum(0);</div>
<div class="line"><span class="lineno"> 2000</span> </div>
<div class="line"><span class="lineno"> 2001</span>          KinCorr[i][j]-&gt;GetXaxis()-&gt;SetTitle(ss2.str().c_str());</div>
<div class="line"><span class="lineno"> 2002</span> </div>
<div class="line"><span class="lineno"> 2003</span>          bin = <span class="keyword">static_cast&lt;</span>TH2PolyBin*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[SampleNum]-&gt;GetBins()-&gt;At(j));</div>
<div class="line"><span class="lineno"> 2004</span>          <span class="comment">// Just make a little fancy name</span></div>
<div class="line"><span class="lineno"> 2005</span>          std::stringstream ss3;</div>
<div class="line"><span class="lineno"> 2006</span>          ss3 &lt;&lt; <span class="stringliteral">&quot;p_{#mu} (&quot;</span> &lt;&lt; bin-&gt;GetXMin() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; bin-&gt;GetXMax() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><span class="lineno"> 2007</span>          ss3 &lt;&lt; <span class="stringliteral">&quot; cos#theta_{#mu} (&quot;</span> &lt;&lt; bin-&gt;GetYMin() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; bin-&gt;GetYMax() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><span class="lineno"> 2008</span>          KinCorr[i][j]-&gt;GetYaxis()-&gt;SetTitle(ss3.str().c_str());</div>
<div class="line"><span class="lineno"> 2009</span>          KinCorr[i][j]-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Events&quot;</span>);</div>
<div class="line"><span class="lineno"> 2010</span>        }</div>
<div class="line"><span class="lineno"> 2011</span>      }</div>
<div class="line"><span class="lineno"> 2012</span>      <span class="comment">// Now we are sure we have the diagonal elements, let&#39;s make the off-diagonals</span></div>
<div class="line"><span class="lineno"> 2013</span><span class="preprocessor">      #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 2014</span><span class="preprocessor">      #pragma omp parallel for</span></div>
<div class="line"><span class="lineno"> 2015</span><span class="preprocessor">      #endif</span></div>
<div class="line"><span class="lineno"> 2016</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[SampleNum]; ++i)</div>
<div class="line"><span class="lineno"> 2017</span>      {</div>
<div class="line"><span class="lineno"> 2018</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)</div>
<div class="line"><span class="lineno"> 2019</span>        {</div>
<div class="line"><span class="lineno"> 2020</span>          <span class="comment">// Skip the diagonal elements which we&#39;ve already done above</span></div>
<div class="line"><span class="lineno"> 2021</span>          <span class="keywordflow">if</span> (j == i) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2022</span> </div>
<div class="line"><span class="lineno"> 2023</span>          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> it = 0; it &lt; <a class="code hl_variable" href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">nThrows</a>; ++it)</div>
<div class="line"><span class="lineno"> 2024</span>          {</div>
<div class="line"><span class="lineno"> 2025</span>            KinCorr[i][j]-&gt;Fill(<a class="code hl_variable" href="classSampleSummary.html#a13177305e8fd4b97812b2ca563740bf2">MCVector</a>[it][SampleNum]-&gt;GetBinContent(i+1), <a class="code hl_variable" href="classSampleSummary.html#a13177305e8fd4b97812b2ca563740bf2">MCVector</a>[it][SampleNum]-&gt;GetBinContent(j+1));</div>
<div class="line"><span class="lineno"> 2026</span>          }</div>
<div class="line"><span class="lineno"> 2027</span>          KinCorr[i][j]-&gt;Smooth();</div>
<div class="line"><span class="lineno"> 2028</span> </div>
<div class="line"><span class="lineno"> 2029</span>          <span class="comment">// Get the Covariance for these two parameters</span></div>
<div class="line"><span class="lineno"> 2030</span>          (*KinCorrelation)(i,j) = KinCorr[i][j]-&gt;GetCorrelationFactor();</div>
<div class="line"><span class="lineno"> 2031</span>          (*KinCorrelation)(j,i) = (*KinCorrelation)(i,j);</div>
<div class="line"><span class="lineno"> 2032</span>        }<span class="comment">// End j loop</span></div>
<div class="line"><span class="lineno"> 2033</span>      }<span class="comment">// End i loop</span></div>
<div class="line"><span class="lineno"> 2034</span> </div>
<div class="line"><span class="lineno"> 2035</span>      <span class="keyword">auto</span> hKinCorr = std::make_unique&lt;TH2D&gt;(<a class="code hl_variable" href="classSampleSummary.html#a9ba7df41774c45a14c0a97e4accc9cc0">SampleNames</a>[SampleNum].c_str(), <a class="code hl_variable" href="classSampleSummary.html#a9ba7df41774c45a14c0a97e4accc9cc0">SampleNames</a>[SampleNum].c_str(),</div>
<div class="line"><span class="lineno"> 2036</span>                                          <a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[SampleNum], 0, <a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[SampleNum], <a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[SampleNum], 0, <a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[SampleNum]);</div>
<div class="line"><span class="lineno"> 2037</span>      hKinCorr-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 2038</span>      hKinCorr-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Correlation&quot;</span>);</div>
<div class="line"><span class="lineno"> 2039</span>      hKinCorr-&gt;SetMinimum(-1);</div>
<div class="line"><span class="lineno"> 2040</span>      hKinCorr-&gt;SetMaximum(1);</div>
<div class="line"><span class="lineno"> 2041</span>      hKinCorr-&gt;GetXaxis()-&gt;SetLabelSize(0.015);</div>
<div class="line"><span class="lineno"> 2042</span>      hKinCorr-&gt;GetYaxis()-&gt;SetLabelSize(0.015);</div>
<div class="line"><span class="lineno"> 2043</span> </div>
<div class="line"><span class="lineno"> 2044</span>      <span class="comment">// Loop over the Covariance matrix entries</span></div>
<div class="line"><span class="lineno"> 2045</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[SampleNum]; ++i)</div>
<div class="line"><span class="lineno"> 2046</span>      {</div>
<div class="line"><span class="lineno"> 2047</span>        <span class="comment">//Get PolyBin</span></div>
<div class="line"><span class="lineno"> 2048</span>        TH2PolyBin* bin = <span class="keyword">static_cast&lt;</span>TH2PolyBin*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[SampleNum]-&gt;GetBins()-&gt;At(i));</div>
<div class="line"><span class="lineno"> 2049</span>        <span class="comment">// Just make a little fancy name</span></div>
<div class="line"><span class="lineno"> 2050</span>        std::stringstream ss2;</div>
<div class="line"><span class="lineno"> 2051</span>        ss2 &lt;&lt; <span class="stringliteral">&quot;p_{#mu} (&quot;</span> &lt;&lt; bin-&gt;GetXMin() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; bin-&gt;GetXMax() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><span class="lineno"> 2052</span>        ss2 &lt;&lt; <span class="stringliteral">&quot; cos#theta_{#mu} (&quot;</span> &lt;&lt; bin-&gt;GetYMin() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; bin-&gt;GetYMax() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><span class="lineno"> 2053</span>        hKinCorr-&gt;GetXaxis()-&gt;SetBinLabel(i+1, ss2.str().c_str());</div>
<div class="line"><span class="lineno"> 2054</span> </div>
<div class="line"><span class="lineno"> 2055</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[SampleNum]; ++j)</div>
<div class="line"><span class="lineno"> 2056</span>        {</div>
<div class="line"><span class="lineno"> 2057</span>          bin = <span class="keyword">static_cast&lt;</span>TH2PolyBin*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[SampleNum]-&gt;GetBins()-&gt;At(j));</div>
<div class="line"><span class="lineno"> 2058</span>          <span class="comment">// Just make a little fancy name</span></div>
<div class="line"><span class="lineno"> 2059</span>          std::stringstream ss3;</div>
<div class="line"><span class="lineno"> 2060</span>          ss3 &lt;&lt; <span class="stringliteral">&quot;p_{#mu} (&quot;</span> &lt;&lt; bin-&gt;GetXMin() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; bin-&gt;GetXMax() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><span class="lineno"> 2061</span>          ss3 &lt;&lt; <span class="stringliteral">&quot; cos#theta_{#mu} (&quot;</span> &lt;&lt; bin-&gt;GetYMin() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; bin-&gt;GetYMax() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><span class="lineno"> 2062</span>          KinCorr[i][j]-&gt;GetYaxis()-&gt;SetTitle(ss3.str().c_str());</div>
<div class="line"><span class="lineno"> 2063</span> </div>
<div class="line"><span class="lineno"> 2064</span>          hKinCorr-&gt;GetYaxis()-&gt;SetBinLabel(j+1, ss3.str().c_str());</div>
<div class="line"><span class="lineno"> 2065</span>          <span class="comment">// The value of the Covariance</span></div>
<div class="line"><span class="lineno"> 2066</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> corr = (*KinCorrelation)(i,j);</div>
<div class="line"><span class="lineno"> 2067</span>          hKinCorr-&gt;SetBinContent(i+1, j+1, corr);</div>
<div class="line"><span class="lineno"> 2068</span>        }</div>
<div class="line"><span class="lineno"> 2069</span>      }</div>
<div class="line"><span class="lineno"> 2070</span>      hKinCorr-&gt;Draw(<span class="stringliteral">&quot;colz&quot;</span>);</div>
<div class="line"><span class="lineno"> 2071</span>      hKinCorr-&gt;Write((<a class="code hl_variable" href="classSampleSummary.html#a9ba7df41774c45a14c0a97e4accc9cc0">SampleNames</a>[SampleNum] + <span class="stringliteral">&quot;_Corr&quot;</span>).c_str());</div>
<div class="line"><span class="lineno"> 2072</span> </div>
<div class="line"><span class="lineno"> 2073</span>      KinCorrelation-&gt;Write((<a class="code hl_variable" href="classSampleSummary.html#a9ba7df41774c45a14c0a97e4accc9cc0">SampleNames</a>[SampleNum] + <span class="stringliteral">&quot;_Correlation&quot;</span>).c_str());</div>
<div class="line"><span class="lineno"> 2074</span>      <span class="keyword">delete</span> KinCorrelation;</div>
<div class="line"><span class="lineno"> 2075</span> </div>
<div class="line"><span class="lineno"> 2076</span>      <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 2077</span><span class="comment">      for (int i = 0; i &lt; maxBins[SampleNum]; ++i)</span></div>
<div class="line"><span class="lineno"> 2078</span><span class="comment">      {</span></div>
<div class="line"><span class="lineno"> 2079</span><span class="comment">        for (int j = 0; j &lt;= i; ++j)</span></div>
<div class="line"><span class="lineno"> 2080</span><span class="comment">        {</span></div>
<div class="line"><span class="lineno"> 2081</span><span class="comment">          // Skip the diagonal elements which we&#39;ve already done above</span></div>
<div class="line"><span class="lineno"> 2082</span><span class="comment">          if (j == i) continue;</span></div>
<div class="line"><span class="lineno"> 2083</span><span class="comment">          KinCorr[i][j]-&gt;Write();</span></div>
<div class="line"><span class="lineno"> 2084</span><span class="comment">        }// End j loop</span></div>
<div class="line"><span class="lineno"> 2085</span><span class="comment">      }// End i loop</span></div>
<div class="line"><span class="lineno"> 2086</span><span class="comment">      */</span></div>
<div class="line"><span class="lineno"> 2087</span>    }<span class="comment">//end loop over samples</span></div>
<div class="line"><span class="lineno"> 2088</span>  }<span class="comment">//end if DoPerKinemBin</span></div>
<div class="line"><span class="lineno"> 2089</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2090</span>  {</div>
<div class="line"><span class="lineno"> 2091</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Not calculating correlations per each kinematic bin&quot;</span>);</div>
<div class="line"><span class="lineno"> 2092</span>  }</div>
<div class="line"><span class="lineno"> 2093</span> </div>
<div class="line"><span class="lineno"> 2094</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#a795ac96bf6958c8a2f38c9de23c3c081">DoByModePlots</a>)</div>
<div class="line"><span class="lineno"> 2095</span>  {</div>
<div class="line"><span class="lineno"> 2096</span>    <span class="comment">// Holds the total event rate by mode</span></div>
<div class="line"><span class="lineno"> 2097</span>    std::vector&lt;TH1D*&gt; EventHist_ByMode(<a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1);</div>
<div class="line"><span class="lineno"> 2098</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1; j++)</div>
<div class="line"><span class="lineno"> 2099</span>    {</div>
<div class="line"><span class="lineno"> 2100</span>      std::string ModeName = <a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#abf4ac35511787907bc16ae26aa6c2a15">GetMaCh3ModeName</a>(j);</div>
<div class="line"><span class="lineno"> 2101</span>      EventHist_ByMode[j] = <span class="keyword">new</span> TH1D(Form(<span class="stringliteral">&quot;EventHist_%s&quot;</span>, ModeName.c_str()), Form(<span class="stringliteral">&quot;Total Event Rate %s&quot;</span>, ModeName.c_str()), 100, 1, -1);</div>
<div class="line"><span class="lineno"> 2102</span>      EventHist_ByMode[j]-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Total event rate&quot;</span>);</div>
<div class="line"><span class="lineno"> 2103</span>      EventHist_ByMode[j]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Counts&quot;</span>);</div>
<div class="line"><span class="lineno"> 2104</span>      EventHist_ByMode[j]-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno"> 2105</span>    }</div>
<div class="line"><span class="lineno"> 2106</span> </div>
<div class="line"><span class="lineno"> 2107</span>    <span class="comment">//KS: Here we calculate total event rates for each mode, maybe not most efficient but can be improved in the future</span></div>
<div class="line"><span class="lineno"> 2108</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> it = 0; it &lt; <a class="code hl_variable" href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">nThrows</a>; ++it)</div>
<div class="line"><span class="lineno"> 2109</span>    {</div>
<div class="line"><span class="lineno"> 2110</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1; j++)</div>
<div class="line"><span class="lineno"> 2111</span>      {</div>
<div class="line"><span class="lineno"> 2112</span>        <span class="keywordtype">double</span> event_rate_temp = 0.;</div>
<div class="line"><span class="lineno"> 2113</span><span class="preprocessor">        #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 2114</span><span class="preprocessor">        #pragma omp parallel for reduction(+:event_rate_temp)</span></div>
<div class="line"><span class="lineno"> 2115</span><span class="preprocessor">        #endif</span></div>
<div class="line"><span class="lineno"> 2116</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> SampleNum = 0;  SampleNum &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; SampleNum++)</div>
<div class="line"><span class="lineno"> 2117</span>        {</div>
<div class="line"><span class="lineno"> 2118</span>          event_rate_temp += <a class="code hl_function" href="Structs_8cpp.html#ab18c6b2408d7b9021bad06d47a06ee8d">NoOverflowIntegral</a>(<a class="code hl_variable" href="classSampleSummary.html#ab3eeac18b62f7ee3a5c943c3cd0e9b76">MCVectorByMode</a>[it][SampleNum][j]);</div>
<div class="line"><span class="lineno"> 2119</span>        }</div>
<div class="line"><span class="lineno"> 2120</span>        EventHist_ByMode[j]-&gt;Fill(event_rate_temp);</div>
<div class="line"><span class="lineno"> 2121</span>      }</div>
<div class="line"><span class="lineno"> 2122</span>    }</div>
<div class="line"><span class="lineno"> 2123</span> </div>
<div class="line"><span class="lineno"> 2124</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1; ++i)</div>
<div class="line"><span class="lineno"> 2125</span>    {</div>
<div class="line"><span class="lineno"> 2126</span>      <a class="code hl_function" href="classSampleSummary.html#a0e21a2b9fd429261e378f4e505ba2f75">MakeCutEventRate</a>(EventHist_ByMode[i], DataRate);</div>
<div class="line"><span class="lineno"> 2127</span>    }</div>
<div class="line"><span class="lineno"> 2128</span> </div>
<div class="line"><span class="lineno"> 2129</span>    TMatrixDSym* ModeCorrelation = <span class="keyword">new</span> TMatrixDSym(<a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1);</div>
<div class="line"><span class="lineno"> 2130</span> </div>
<div class="line"><span class="lineno"> 2131</span>    TH2D*** ModeCorr = <span class="keyword">new</span> TH2D**[<a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1]();</div>
<div class="line"><span class="lineno"> 2132</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1; ++i)</div>
<div class="line"><span class="lineno"> 2133</span>    {</div>
<div class="line"><span class="lineno"> 2134</span>      ModeCorr[i] = <span class="keyword">new</span> TH2D*[<a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1]();</div>
<div class="line"><span class="lineno"> 2135</span> </div>
<div class="line"><span class="lineno"> 2136</span>      (*ModeCorrelation)(i,i) = 1.0;</div>
<div class="line"><span class="lineno"> 2137</span> </div>
<div class="line"><span class="lineno"> 2138</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> Min_i = EventHist_ByMode[i]-&gt;GetXaxis()-&gt;GetBinLowEdge(1);</div>
<div class="line"><span class="lineno"> 2139</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> Max_i = EventHist_ByMode[i]-&gt;GetXaxis()-&gt;GetBinUpEdge(EventHist_ByMode[i]-&gt;GetNbinsX()+1);</div>
<div class="line"><span class="lineno"> 2140</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1; ++j)</div>
<div class="line"><span class="lineno"> 2141</span>      {</div>
<div class="line"><span class="lineno"> 2142</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> Min_j = EventHist_ByMode[j]-&gt;GetXaxis()-&gt;GetBinLowEdge(1);</div>
<div class="line"><span class="lineno"> 2143</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> Max_j = EventHist_ByMode[j]-&gt;GetXaxis()-&gt;GetBinUpEdge(EventHist_ByMode[j]-&gt;GetNbinsX()+1);</div>
<div class="line"><span class="lineno"> 2144</span> </div>
<div class="line"><span class="lineno"> 2145</span>        <span class="comment">// TH2D to hold the Correlation</span></div>
<div class="line"><span class="lineno"> 2146</span>        ModeCorr[i][j] = <span class="keyword">new</span> TH2D(Form(<span class="stringliteral">&quot;ModeCorr_%i_%i&quot;</span>,i,j), Form(<span class="stringliteral">&quot;ModeCorr_%i_%i&quot;</span>,i,j), 70, Min_i, Max_i, 70, Min_j, Max_j);</div>
<div class="line"><span class="lineno"> 2147</span>        ModeCorr[i][j]-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 2148</span>        ModeCorr[i][j]-&gt;SetMinimum(0);</div>
<div class="line"><span class="lineno"> 2149</span>        ModeCorr[i][j]-&gt;GetXaxis()-&gt;SetTitle(<a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#abf4ac35511787907bc16ae26aa6c2a15">GetMaCh3ModeName</a>(i).c_str());</div>
<div class="line"><span class="lineno"> 2150</span>        ModeCorr[i][j]-&gt;GetYaxis()-&gt;SetTitle(<a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#abf4ac35511787907bc16ae26aa6c2a15">GetMaCh3ModeName</a>(j).c_str());</div>
<div class="line"><span class="lineno"> 2151</span>        ModeCorr[i][j]-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Events&quot;</span>);</div>
<div class="line"><span class="lineno"> 2152</span>      }</div>
<div class="line"><span class="lineno"> 2153</span>    }</div>
<div class="line"><span class="lineno"> 2154</span> </div>
<div class="line"><span class="lineno"> 2155</span>    <span class="comment">// Now we are sure we have the diagonal elements, let&#39;s make the off-diagonals</span></div>
<div class="line"><span class="lineno"> 2156</span><span class="preprocessor">    #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 2157</span><span class="preprocessor">    #pragma omp parallel for</span></div>
<div class="line"><span class="lineno"> 2158</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno"> 2159</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1; ++i)</div>
<div class="line"><span class="lineno"> 2160</span>    {</div>
<div class="line"><span class="lineno"> 2161</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)</div>
<div class="line"><span class="lineno"> 2162</span>      {</div>
<div class="line"><span class="lineno"> 2163</span>        <span class="comment">// Skip the diagonal elements which we&#39;ve already done above</span></div>
<div class="line"><span class="lineno"> 2164</span>        <span class="keywordflow">if</span> (j == i) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2165</span> </div>
<div class="line"><span class="lineno"> 2166</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> it = 0; it &lt; <a class="code hl_variable" href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">nThrows</a>; ++it)</div>
<div class="line"><span class="lineno"> 2167</span>        {</div>
<div class="line"><span class="lineno"> 2168</span>          <span class="keywordtype">double</span> Integral_X = 0.;</div>
<div class="line"><span class="lineno"> 2169</span>          <span class="keywordtype">double</span> Integral_Y = 0.;</div>
<div class="line"><span class="lineno"> 2170</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> SampleNum = 0; SampleNum &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++SampleNum)</div>
<div class="line"><span class="lineno"> 2171</span>          {</div>
<div class="line"><span class="lineno"> 2172</span>            Integral_X += <a class="code hl_function" href="Structs_8cpp.html#ab18c6b2408d7b9021bad06d47a06ee8d">NoOverflowIntegral</a>(<a class="code hl_variable" href="classSampleSummary.html#ab3eeac18b62f7ee3a5c943c3cd0e9b76">MCVectorByMode</a>[it][SampleNum][i]);</div>
<div class="line"><span class="lineno"> 2173</span>            Integral_Y += <a class="code hl_function" href="Structs_8cpp.html#ab18c6b2408d7b9021bad06d47a06ee8d">NoOverflowIntegral</a>(<a class="code hl_variable" href="classSampleSummary.html#ab3eeac18b62f7ee3a5c943c3cd0e9b76">MCVectorByMode</a>[it][SampleNum][j]);</div>
<div class="line"><span class="lineno"> 2174</span>          }</div>
<div class="line"><span class="lineno"> 2175</span>          ModeCorr[i][j]-&gt;Fill(Integral_X, Integral_Y);</div>
<div class="line"><span class="lineno"> 2176</span>        }</div>
<div class="line"><span class="lineno"> 2177</span>        ModeCorr[i][j]-&gt;Smooth();</div>
<div class="line"><span class="lineno"> 2178</span> </div>
<div class="line"><span class="lineno"> 2179</span>        <span class="comment">// Get the Covariance for these two parameters</span></div>
<div class="line"><span class="lineno"> 2180</span>        (*ModeCorrelation)(i,j) = ModeCorr[i][j]-&gt;GetCorrelationFactor();</div>
<div class="line"><span class="lineno"> 2181</span>        (*ModeCorrelation)(j,i) = (*ModeCorrelation)(i,j);</div>
<div class="line"><span class="lineno"> 2182</span>      }<span class="comment">// End j loop</span></div>
<div class="line"><span class="lineno"> 2183</span>    }<span class="comment">// End i loop</span></div>
<div class="line"><span class="lineno"> 2184</span> </div>
<div class="line"><span class="lineno"> 2185</span>    TH2D* hModeCorr = <span class="keyword">new</span> TH2D(<span class="stringliteral">&quot;Mode Correlation&quot;</span>, <span class="stringliteral">&quot;Mode Correlation&quot;</span>, <a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1, 0, <a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1, <a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1, 0, <a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1);</div>
<div class="line"><span class="lineno"> 2186</span>    hModeCorr-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 2187</span>    hModeCorr-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Correlation&quot;</span>);</div>
<div class="line"><span class="lineno"> 2188</span>    hModeCorr-&gt;SetMinimum(-1);</div>
<div class="line"><span class="lineno"> 2189</span>    hModeCorr-&gt;SetMaximum(1);</div>
<div class="line"><span class="lineno"> 2190</span>    hModeCorr-&gt;GetXaxis()-&gt;SetLabelSize(0.015);</div>
<div class="line"><span class="lineno"> 2191</span>    hModeCorr-&gt;GetYaxis()-&gt;SetLabelSize(0.015);</div>
<div class="line"><span class="lineno"> 2192</span> </div>
<div class="line"><span class="lineno"> 2193</span>    <span class="comment">// Loop over the Covariance matrix entries</span></div>
<div class="line"><span class="lineno"> 2194</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1; ++i)</div>
<div class="line"><span class="lineno"> 2195</span>    {</div>
<div class="line"><span class="lineno"> 2196</span>      hModeCorr-&gt;GetXaxis()-&gt;SetBinLabel(i+1, <a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#abf4ac35511787907bc16ae26aa6c2a15">GetMaCh3ModeName</a>(i).c_str());</div>
<div class="line"><span class="lineno"> 2197</span> </div>
<div class="line"><span class="lineno"> 2198</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1; ++j)</div>
<div class="line"><span class="lineno"> 2199</span>      {</div>
<div class="line"><span class="lineno"> 2200</span>        hModeCorr-&gt;GetYaxis()-&gt;SetBinLabel(j+1, <a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#abf4ac35511787907bc16ae26aa6c2a15">GetMaCh3ModeName</a>(j).c_str());</div>
<div class="line"><span class="lineno"> 2201</span>        <span class="comment">// The value of the Covariance</span></div>
<div class="line"><span class="lineno"> 2202</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> corr = (*ModeCorrelation)(i,j);</div>
<div class="line"><span class="lineno"> 2203</span>        hModeCorr-&gt;SetBinContent(i+1, j+1, corr);</div>
<div class="line"><span class="lineno"> 2204</span>      }</div>
<div class="line"><span class="lineno"> 2205</span>    }</div>
<div class="line"><span class="lineno"> 2206</span>    hModeCorr-&gt;Draw(<span class="stringliteral">&quot;colz&quot;</span>);</div>
<div class="line"><span class="lineno"> 2207</span>    hModeCorr-&gt;Write(<span class="stringliteral">&quot;Mode_Corr&quot;</span>);</div>
<div class="line"><span class="lineno"> 2208</span>    <span class="keyword">delete</span> hModeCorr;</div>
<div class="line"><span class="lineno"> 2209</span> </div>
<div class="line"><span class="lineno"> 2210</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1; ++i)</div>
<div class="line"><span class="lineno"> 2211</span>    {</div>
<div class="line"><span class="lineno"> 2212</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)</div>
<div class="line"><span class="lineno"> 2213</span>      {</div>
<div class="line"><span class="lineno"> 2214</span>        <span class="comment">// Skip the diagonal elements which we&#39;ve already done above</span></div>
<div class="line"><span class="lineno"> 2215</span>        <span class="keywordflow">if</span> (j == i) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2216</span>        ModeCorr[i][j]-&gt;Write();</div>
<div class="line"><span class="lineno"> 2217</span>      }<span class="comment">// End j loop</span></div>
<div class="line"><span class="lineno"> 2218</span>    }<span class="comment">// End i loop</span></div>
<div class="line"><span class="lineno"> 2219</span> </div>
<div class="line"><span class="lineno"> 2220</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1; ++i)</div>
<div class="line"><span class="lineno"> 2221</span>    {</div>
<div class="line"><span class="lineno"> 2222</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1; ++j)</div>
<div class="line"><span class="lineno"> 2223</span>      {</div>
<div class="line"><span class="lineno"> 2224</span>        <span class="keyword">delete</span> ModeCorr[i][j];</div>
<div class="line"><span class="lineno"> 2225</span>      }</div>
<div class="line"><span class="lineno"> 2226</span>      <span class="keyword">delete</span>[] ModeCorr[i];</div>
<div class="line"><span class="lineno"> 2227</span>    }</div>
<div class="line"><span class="lineno"> 2228</span>    <span class="keyword">delete</span>[] ModeCorr;</div>
<div class="line"><span class="lineno"> 2229</span>    ModeCorrelation-&gt;Write(<span class="stringliteral">&quot;Mode_Correlation&quot;</span>);</div>
<div class="line"><span class="lineno"> 2230</span>    <span class="keyword">delete</span> ModeCorrelation;</div>
<div class="line"><span class="lineno"> 2231</span> </div>
<div class="line"><span class="lineno"> 2232</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1; j++)</div>
<div class="line"><span class="lineno"> 2233</span>    {</div>
<div class="line"><span class="lineno"> 2234</span>      <span class="keyword">delete</span> EventHist_ByMode[j];</div>
<div class="line"><span class="lineno"> 2235</span>    }</div>
<div class="line"><span class="lineno"> 2236</span>  }</div>
<div class="line"><span class="lineno"> 2237</span> </div>
<div class="line"><span class="lineno"> 2238</span>  CorrDir-&gt;Close();</div>
<div class="line"><span class="lineno"> 2239</span>  <span class="keyword">delete</span> CorrDir;</div>
<div class="line"><span class="lineno"> 2240</span> </div>
<div class="line"><span class="lineno"> 2241</span>  timer.Stop();</div>
<div class="line"><span class="lineno"> 2242</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Calculating correlations took  {:.2f}s&quot;</span>, timer.RealTime());</div>
<div class="line"><span class="lineno"> 2243</span>  <a class="code hl_variable" href="classSampleSummary.html#aa7b948f290517a052f04f61dfa6af68f">Outputfile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 2244</span>}</div>
<div class="ttc" id="aclassSampleSummary_html_a0e21a2b9fd429261e378f4e505ba2f75"><div class="ttname"><a href="classSampleSummary.html#a0e21a2b9fd429261e378f4e505ba2f75">SampleSummary::MakeCutEventRate</a></div><div class="ttdeci">void MakeCutEventRate(TH1D *Histogram, const double DataRate)</div><div class="ttdoc">Make the 1D Event Rate Hist.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8cpp_source.html#l01572">SampleSummary.cpp:1572</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9f8198603d809480506cdc9bf171e9e8" name="a9f8198603d809480506cdc9bf171e9e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f8198603d809480506cdc9bf171e9e8">&#9670;&#160;</a></span>StudyWAIC()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::StudyWAIC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: Get the Watanabe-Akaike information criterion (WAIC) <a class="el" href="citelist.html#CITEREF_Gelman2014">[9]</a> <a class="el" href="citelist.html#CITEREF_Hartig2024WAIC">[12]</a>. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l02542">2542</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2542</span>                              {</div>
<div class="line"><span class="lineno"> 2543</span><span class="comment">// ****************</span></div>
<div class="line"><span class="lineno"> 2544</span>  <span class="comment">// log pointwise predictive density</span></div>
<div class="line"><span class="lineno"> 2545</span>  <span class="keywordtype">double</span> lppd = 0.;</div>
<div class="line"><span class="lineno"> 2546</span>  <span class="comment">// effective number of parameters</span></div>
<div class="line"><span class="lineno"> 2547</span>  <span class="keywordtype">double</span> p_WAIC = 0.;</div>
<div class="line"><span class="lineno"> 2548</span> </div>
<div class="line"><span class="lineno"> 2549</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 2550</span><span class="preprocessor">  #pragma omp parallel for reduction(+:lppd, p_WAIC)</span></div>
<div class="line"><span class="lineno"> 2551</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 2552</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> SampleNum = 0; SampleNum &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++SampleNum) {</div>
<div class="line"><span class="lineno"> 2553</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="GetPostfitParamPlots_8cpp.html#ae4842c1619a902b2761696f3849889a1">nBins</a> = <a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[SampleNum];</div>
<div class="line"><span class="lineno"> 2554</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= <a class="code hl_variable" href="GetPostfitParamPlots_8cpp.html#ae4842c1619a902b2761696f3849889a1">nBins</a>; ++i) {</div>
<div class="line"><span class="lineno"> 2555</span>      <span class="keywordtype">double</span> mean_llh = 0.;</div>
<div class="line"><span class="lineno"> 2556</span>      <span class="keywordtype">double</span> sum_exp_llh = 0;</div>
<div class="line"><span class="lineno"> 2557</span>      <span class="keywordtype">double</span> mean_llh_squared = 0.;</div>
<div class="line"><span class="lineno"> 2558</span> </div>
<div class="line"><span class="lineno"> 2559</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> s = 0; s &lt; <a class="code hl_variable" href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">nThrows</a>; ++s) {</div>
<div class="line"><span class="lineno"> 2560</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> data = <a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[SampleNum]-&gt;GetBinContent(i);</div>
<div class="line"><span class="lineno"> 2561</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> mc = <a class="code hl_variable" href="classSampleSummary.html#a13177305e8fd4b97812b2ca563740bf2">MCVector</a>[s][SampleNum]-&gt;GetBinContent(i);</div>
<div class="line"><span class="lineno"> 2562</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> w2 = <a class="code hl_variable" href="classSampleSummary.html#a263b7541545b8b0ba735e0a3ac2d31e7">W2MCVector</a>[s][SampleNum]-&gt;GetBinContent(i);</div>
<div class="line"><span class="lineno"> 2563</span> </div>
<div class="line"><span class="lineno"> 2564</span>        <span class="comment">// Get the -log-likelihood for this sample and bin</span></div>
<div class="line"><span class="lineno"> 2565</span>        <span class="keywordtype">double</span> neg_LLH_temp = <a class="code hl_variable" href="classSampleSummary.html#abd938805245ca6cfeb8c49363f5ff11c">SamplePDF</a>-&gt;<a class="code hl_function" href="classsamplePDFBase.html#ab2e2eab110efc30a2aee13a5011acb8a">getTestStatLLH</a>(data, mc, w2);</div>
<div class="line"><span class="lineno"> 2566</span> </div>
<div class="line"><span class="lineno"> 2567</span>        <span class="comment">// Negate the negative log-likelihood to get the actual log-likelihood</span></div>
<div class="line"><span class="lineno"> 2568</span>        <span class="keywordtype">double</span> LLH_temp = -neg_LLH_temp;</div>
<div class="line"><span class="lineno"> 2569</span> </div>
<div class="line"><span class="lineno"> 2570</span>        mean_llh += LLH_temp;</div>
<div class="line"><span class="lineno"> 2571</span>        mean_llh_squared += LLH_temp * LLH_temp;</div>
<div class="line"><span class="lineno"> 2572</span>        sum_exp_llh += std::exp(LLH_temp);</div>
<div class="line"><span class="lineno"> 2573</span>      }</div>
<div class="line"><span class="lineno"> 2574</span> </div>
<div class="line"><span class="lineno"> 2575</span>      <span class="comment">// Compute the mean log-likelihood and the squared mean</span></div>
<div class="line"><span class="lineno"> 2576</span>      mean_llh /= <a class="code hl_variable" href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">nThrows</a>;</div>
<div class="line"><span class="lineno"> 2577</span>      mean_llh_squared /= <a class="code hl_variable" href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">nThrows</a>;</div>
<div class="line"><span class="lineno"> 2578</span>      sum_exp_llh /= <a class="code hl_variable" href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">nThrows</a>;</div>
<div class="line"><span class="lineno"> 2579</span>      sum_exp_llh = std::log(sum_exp_llh);</div>
<div class="line"><span class="lineno"> 2580</span> </div>
<div class="line"><span class="lineno"> 2581</span>      <span class="comment">// Log pointwise predictive density based on Eq. 4 in Gelman2014</span></div>
<div class="line"><span class="lineno"> 2582</span>      lppd += sum_exp_llh;</div>
<div class="line"><span class="lineno"> 2583</span> </div>
<div class="line"><span class="lineno"> 2584</span>      <span class="comment">// Compute the effective number of parameters for WAIC</span></div>
<div class="line"><span class="lineno"> 2585</span>      p_WAIC += mean_llh_squared - (mean_llh * mean_llh);</div>
<div class="line"><span class="lineno"> 2586</span>    }</div>
<div class="line"><span class="lineno"> 2587</span>  }</div>
<div class="line"><span class="lineno"> 2588</span> </div>
<div class="line"><span class="lineno"> 2589</span>  <span class="comment">// Compute WAIC, see Eq. 13 in Gelman2014</span></div>
<div class="line"><span class="lineno"> 2590</span>  <span class="keywordtype">double</span> WAIC = -2 * (lppd - p_WAIC);</div>
<div class="line"><span class="lineno"> 2591</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Effective number of parameters following WAIC formalism is equal to: {:.2f}&quot;</span>, p_WAIC);</div>
<div class="line"><span class="lineno"> 2592</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;WAIC = {:.2f}&quot;</span>, WAIC);</div>
<div class="line"><span class="lineno"> 2593</span>}</div>
<div class="ttc" id="aGetPostfitParamPlots_8cpp_html_ae4842c1619a902b2761696f3849889a1"><div class="ttname"><a href="GetPostfitParamPlots_8cpp.html#ae4842c1619a902b2761696f3849889a1">nBins</a></div><div class="ttdeci">int nBins</div><div class="ttdef"><b>Definition:</b> <a href="GetPostfitParamPlots_8cpp_source.html#l00066">GetPostfitParamPlots.cpp:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aacf987756d2024868bf28b9c2c4a5a99" name="aacf987756d2024868bf28b9c2c4a5a99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacf987756d2024868bf28b9c2c4a5a99">&#9670;&#160;</a></span>Write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SampleSummary::Write </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>KS: Write results into root file. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8cpp_source.html#l00676">676</a> of file <a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  676</span>                          {</div>
<div class="line"><span class="lineno">  677</span><span class="comment">// *******************</span></div>
<div class="line"><span class="lineno">  678</span>  <span class="comment">// Prepare the output tree</span></div>
<div class="line"><span class="lineno">  679</span>  <a class="code hl_function" href="classSampleSummary.html#a7b87a7ce0c38e968fb841f228aea7212">PrepareOutput</a>();</div>
<div class="line"><span class="lineno">  680</span> </div>
<div class="line"><span class="lineno">  681</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Summarising {} throws...&quot;</span>, <a class="code hl_variable" href="classSampleSummary.html#aa5c4055d4bb4dc720a4118032cdb4910">nThrows</a>);</div>
<div class="line"><span class="lineno">  682</span>  <span class="comment">// After all the throws are added finalise the sample</span></div>
<div class="line"><span class="lineno">  683</span>  TStopwatch timer;</div>
<div class="line"><span class="lineno">  684</span>  timer.Start();</div>
<div class="line"><span class="lineno">  685</span>  <a class="code hl_function" href="classSampleSummary.html#a44baf8959ced974c9a0b8ae640c336bd">MakePredictive</a>();</div>
<div class="line"><span class="lineno">  686</span>  timer.Stop();</div>
<div class="line"><span class="lineno">  687</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Made Prior/Posterior Predictive, it took {:.2f}s, now writing...&quot;</span>, timer.RealTime());</div>
<div class="line"><span class="lineno">  688</span> </div>
<div class="line"><span class="lineno">  689</span>  <span class="comment">// Studying information criterion</span></div>
<div class="line"><span class="lineno">  690</span>  <a class="code hl_function" href="classSampleSummary.html#a02dcccd537e6e9a9ffc46b31429306ce">StudyInformationCriterion</a>(<a class="code hl_enumvalue" href="namespaceM3.html#a007e5ed320c3672a3faf79da0a38fb7aa37b99344010ca5011c37f1a609d6f61d">M3::kWAIC</a>);</div>
<div class="line"><span class="lineno">  691</span> </div>
<div class="line"><span class="lineno">  692</span>  <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Write();</div>
<div class="line"><span class="lineno">  693</span> </div>
<div class="line"><span class="lineno">  694</span>  <span class="comment">// Make the various distributions</span></div>
<div class="line"><span class="lineno">  695</span>  <a class="code hl_variable" href="classSampleSummary.html#a70b109c60b7c82a3e36708bd2674cb5e">lnLHist</a>-&gt;Write();</div>
<div class="line"><span class="lineno">  696</span>  <a class="code hl_variable" href="classSampleSummary.html#aead1702a4c1522e685a8af5a875f05ab">lnLHist_drawfluc</a>-&gt;Write();</div>
<div class="line"><span class="lineno">  697</span>  <a class="code hl_variable" href="classSampleSummary.html#aa6f15a5750ae0224168d487e44ad3d94">lnLHist_drawflucdraw</a>-&gt;Write();</div>
<div class="line"><span class="lineno">  698</span>  <a class="code hl_variable" href="classSampleSummary.html#aaf23ed9a699d625adc8639a57de801e8">lnLHist_drawdata</a>-&gt;Write();</div>
<div class="line"><span class="lineno">  699</span>  <a class="code hl_variable" href="classSampleSummary.html#a8c7537f32164be9192f8ba2b12a69cdb">lnLDrawHist</a>-&gt;Write();</div>
<div class="line"><span class="lineno">  700</span>  <a class="code hl_variable" href="classSampleSummary.html#ae1aafef6414eafb5572893dded50a1b1">lnLFlucHist</a>-&gt;Write();</div>
<div class="line"><span class="lineno">  701</span>  <a class="code hl_variable" href="classSampleSummary.html#aae188cf135af004d5364e5b4f3b1bb31">lnLDrawHistRate</a>-&gt;Write();</div>
<div class="line"><span class="lineno">  702</span>  <span class="comment">//KS: Only available for Posterior Predictive</span></div>
<div class="line"><span class="lineno">  703</span>  <span class="keywordflow">if</span>(!<a class="code hl_variable" href="classSampleSummary.html#adb737e335e68edeb14a6ce2ca112dc8c">isPriorPredictive</a>) <a class="code hl_variable" href="classSampleSummary.html#a2ced5be9bc8ba79530464d53b9c23797">RandomHist</a>-&gt;Write();</div>
<div class="line"><span class="lineno">  704</span> </div>
<div class="line"><span class="lineno">  705</span>  <a class="code hl_variable" href="classSampleSummary.html#ae509f51ec2d0323e005e05c255bc0c1f">lnLFlucHist_ProjectX</a>-&gt;Write();</div>
<div class="line"><span class="lineno">  706</span>  </div>
<div class="line"><span class="lineno">  707</span>  <span class="comment">// Loop over each sample and write to file</span></div>
<div class="line"><span class="lineno">  708</span>  <span class="comment">//KS: Multithreading is tempting here but we also write to ROOT file, separating all LLH and poly projections from write could work well</span></div>
<div class="line"><span class="lineno">  709</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classSampleSummary.html#ab16d22bf65d2a9c15072901161fc160a">nSamples</a>; ++i)</div>
<div class="line"><span class="lineno">  710</span>  {</div>
<div class="line"><span class="lineno">  711</span>     <span class="comment">// Skip the null histograms</span></div>
<div class="line"><span class="lineno">  712</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i] == <span class="keyword">nullptr</span> || <a class="code hl_function" href="Structs_8cpp.html#ab18c6b2408d7b9021bad06d47a06ee8d">NoOverflowIntegral</a>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i]) == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  713</span>    <a class="code hl_variable" href="classSampleSummary.html#aa2064e7455c3164ee5118a5e5162f282">Dir</a>[i]-&gt;cd();</div>
<div class="line"><span class="lineno">  714</span> </div>
<div class="line"><span class="lineno">  715</span>    <span class="comment">// Make the data/MC ratio histogram</span></div>
<div class="line"><span class="lineno">  716</span>    TH2Poly *RatioHistMean = <a class="code hl_function" href="classSampleSummary.html#a6d7ad3d2ee9868e80548b8a73299bd5b">RatioPolys</a>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i], <a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[i]);</div>
<div class="line"><span class="lineno">  717</span>    RatioHistMean-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Data/Mean&quot;</span>);</div>
<div class="line"><span class="lineno">  718</span>    TH2Poly *RatioHistMode = <a class="code hl_function" href="classSampleSummary.html#a6d7ad3d2ee9868e80548b8a73299bd5b">RatioPolys</a>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i], <a class="code hl_variable" href="classSampleSummary.html#a9b21ff74bb8ebd7c3af2c24e02f3d7dc">ModeHist</a>[i]);</div>
<div class="line"><span class="lineno">  719</span>    RatioHistMode-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Data/Mode&quot;</span>);</div>
<div class="line"><span class="lineno">  720</span>    TH2Poly *RatioHistNom = <a class="code hl_function" href="classSampleSummary.html#a6d7ad3d2ee9868e80548b8a73299bd5b">RatioPolys</a>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i], <a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i]);</div>
<div class="line"><span class="lineno">  721</span>    RatioHistNom-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Data/Nom&quot;</span>);</div>
<div class="line"><span class="lineno">  722</span> </div>
<div class="line"><span class="lineno">  723</span>    <span class="comment">// And the normalised data histogram</span></div>
<div class="line"><span class="lineno">  724</span>    TH2Poly *DataNormHist = <a class="code hl_function" href="Structs_8cpp.html#ae28c217f8e8591248bfa54e95fdd7741">NormalisePoly</a>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i]);</div>
<div class="line"><span class="lineno">  725</span>    <span class="comment">// Last true refers to if project along x or y</span></div>
<div class="line"><span class="lineno">  726</span>    TH2Poly *MeanNormHist = <a class="code hl_function" href="Structs_8cpp.html#ae28c217f8e8591248bfa54e95fdd7741">NormalisePoly</a>(<a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[i]);</div>
<div class="line"><span class="lineno">  727</span>    TH2Poly *ModeNormHist = <a class="code hl_function" href="Structs_8cpp.html#ae28c217f8e8591248bfa54e95fdd7741">NormalisePoly</a>(<a class="code hl_variable" href="classSampleSummary.html#a9b21ff74bb8ebd7c3af2c24e02f3d7dc">ModeHist</a>[i]);</div>
<div class="line"><span class="lineno">  728</span>    TH1D *MeanProjectX = <a class="code hl_function" href="classSampleSummary.html#a685a8ef3180d4f6474328b5c806d8b74">ProjectPoly</a>(<a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[i], <span class="keyword">true</span>, i, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  729</span>    TH1D *MeanProjectY = <a class="code hl_function" href="classSampleSummary.html#a685a8ef3180d4f6474328b5c806d8b74">ProjectPoly</a>(<a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[i], <span class="keyword">false</span>, i, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  730</span>    TH1D *ModeProjectX = <a class="code hl_function" href="classSampleSummary.html#a685a8ef3180d4f6474328b5c806d8b74">ProjectPoly</a>(<a class="code hl_variable" href="classSampleSummary.html#a9b21ff74bb8ebd7c3af2c24e02f3d7dc">ModeHist</a>[i], <span class="keyword">true</span>, i, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  731</span>    TH1D *ModeProjectY = <a class="code hl_function" href="classSampleSummary.html#a685a8ef3180d4f6474328b5c806d8b74">ProjectPoly</a>(<a class="code hl_variable" href="classSampleSummary.html#a9b21ff74bb8ebd7c3af2c24e02f3d7dc">ModeHist</a>[i], <span class="keyword">false</span>, i, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  732</span> </div>
<div class="line"><span class="lineno">  733</span>    TH1D *MeanHistCorrectedProjectX = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  734</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#adf610d698a50c4930d95be320e99a8e8">DoBetaParam</a>) MeanHistCorrectedProjectX = <a class="code hl_function" href="classSampleSummary.html#a685a8ef3180d4f6474328b5c806d8b74">ProjectPoly</a>(<a class="code hl_variable" href="classSampleSummary.html#a6191a0fc1c8f1f0889b3dedcc5485a3d">MeanHistCorrected</a>[i], <span class="keyword">true</span>, i, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  735</span>    TH1D *MeanHistCorrectedProjectY = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  736</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#adf610d698a50c4930d95be320e99a8e8">DoBetaParam</a>) MeanHistCorrectedProjectY = <a class="code hl_function" href="classSampleSummary.html#a685a8ef3180d4f6474328b5c806d8b74">ProjectPoly</a>(<a class="code hl_variable" href="classSampleSummary.html#a6191a0fc1c8f1f0889b3dedcc5485a3d">MeanHistCorrected</a>[i], <span class="keyword">false</span>, i, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  737</span> </div>
<div class="line"><span class="lineno">  738</span>    TH1D *W2MeanProjectX = <a class="code hl_function" href="classSampleSummary.html#a685a8ef3180d4f6474328b5c806d8b74">ProjectPoly</a>(<a class="code hl_variable" href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">W2MeanHist</a>[i], <span class="keyword">true</span>, i);</div>
<div class="line"><span class="lineno">  739</span>    TH1D *W2MeanProjectY = <a class="code hl_function" href="classSampleSummary.html#a685a8ef3180d4f6474328b5c806d8b74">ProjectPoly</a>(<a class="code hl_variable" href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">W2MeanHist</a>[i], <span class="keyword">false</span>, i);</div>
<div class="line"><span class="lineno">  740</span>    TH1D *W2ModeProjectX = <a class="code hl_function" href="classSampleSummary.html#a685a8ef3180d4f6474328b5c806d8b74">ProjectPoly</a>(<a class="code hl_variable" href="classSampleSummary.html#adf9b943ba381875b3f2e0c4807a9b8c4">W2ModeHist</a>[i], <span class="keyword">true</span>, i);</div>
<div class="line"><span class="lineno">  741</span>    TH1D *W2ModeProjectY = <a class="code hl_function" href="classSampleSummary.html#a685a8ef3180d4f6474328b5c806d8b74">ProjectPoly</a>(<a class="code hl_variable" href="classSampleSummary.html#adf9b943ba381875b3f2e0c4807a9b8c4">W2ModeHist</a>[i], <span class="keyword">false</span>, i);</div>
<div class="line"><span class="lineno">  742</span> </div>
<div class="line"><span class="lineno">  743</span>    TH2Poly *NomNormHist = <a class="code hl_function" href="Structs_8cpp.html#ae28c217f8e8591248bfa54e95fdd7741">NormalisePoly</a>(<a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i]);</div>
<div class="line"><span class="lineno">  744</span>    TH1D *NomProjectX = <a class="code hl_function" href="classSampleSummary.html#a685a8ef3180d4f6474328b5c806d8b74">ProjectPoly</a>(<a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i], <span class="keyword">true</span>, i);</div>
<div class="line"><span class="lineno">  745</span>    TH1D *NomProjectY = <a class="code hl_function" href="classSampleSummary.html#a685a8ef3180d4f6474328b5c806d8b74">ProjectPoly</a>(<a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i], <span class="keyword">false</span>, i);</div>
<div class="line"><span class="lineno">  746</span> </div>
<div class="line"><span class="lineno">  747</span>    TH1D *W2NomProjectX = <a class="code hl_function" href="classSampleSummary.html#a685a8ef3180d4f6474328b5c806d8b74">ProjectPoly</a>(<a class="code hl_variable" href="classSampleSummary.html#a9c37d8669c0f55f6a4620b4f0d7b6e20">W2NomHist</a>[i], <span class="keyword">true</span>, i);</div>
<div class="line"><span class="lineno">  748</span>    TH1D *W2NomProjectY = <a class="code hl_function" href="classSampleSummary.html#a685a8ef3180d4f6474328b5c806d8b74">ProjectPoly</a>(<a class="code hl_variable" href="classSampleSummary.html#a9c37d8669c0f55f6a4620b4f0d7b6e20">W2NomHist</a>[i], <span class="keyword">false</span>, i);</div>
<div class="line"><span class="lineno">  749</span> </div>
<div class="line"><span class="lineno">  750</span>    <span class="comment">// Same for the TH2Ds</span></div>
<div class="line"><span class="lineno">  751</span>    <a class="code hl_function" href="classSampleSummary.html#a197d9d30abc14a76d65bd876b28cca32">CalcLLH</a>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i], <a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i], <a class="code hl_variable" href="classSampleSummary.html#a9c37d8669c0f55f6a4620b4f0d7b6e20">W2NomHist</a>[i]);</div>
<div class="line"><span class="lineno">  752</span>    <a class="code hl_function" href="classSampleSummary.html#a197d9d30abc14a76d65bd876b28cca32">CalcLLH</a>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i], <a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[i], <a class="code hl_variable" href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">W2MeanHist</a>[i]);</div>
<div class="line"><span class="lineno">  753</span>    <a class="code hl_function" href="classSampleSummary.html#a197d9d30abc14a76d65bd876b28cca32">CalcLLH</a>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i], <a class="code hl_variable" href="classSampleSummary.html#a9b21ff74bb8ebd7c3af2c24e02f3d7dc">ModeHist</a>[i], <a class="code hl_variable" href="classSampleSummary.html#adf9b943ba381875b3f2e0c4807a9b8c4">W2ModeHist</a>[i]);</div>
<div class="line"><span class="lineno">  754</span> </div>
<div class="line"><span class="lineno">  755</span>    <span class="comment">// Calculate the log likelihood for the 1D dists</span></div>
<div class="line"><span class="lineno">  756</span>    <span class="comment">// Sets the title of the second TH1D to the -2LLH</span></div>
<div class="line"><span class="lineno">  757</span>    <a class="code hl_function" href="classSampleSummary.html#a197d9d30abc14a76d65bd876b28cca32">CalcLLH</a>(<a class="code hl_variable" href="classSampleSummary.html#abeaca1195db794d9e660a377d81c1b21">DataHist_ProjectX</a>[i], NomProjectX, W2NomProjectX);</div>
<div class="line"><span class="lineno">  758</span>    <a class="code hl_function" href="classSampleSummary.html#a197d9d30abc14a76d65bd876b28cca32">CalcLLH</a>(<a class="code hl_variable" href="classSampleSummary.html#abeaca1195db794d9e660a377d81c1b21">DataHist_ProjectX</a>[i], MeanProjectX, W2MeanProjectX);</div>
<div class="line"><span class="lineno">  759</span>    <a class="code hl_function" href="classSampleSummary.html#a197d9d30abc14a76d65bd876b28cca32">CalcLLH</a>(<a class="code hl_variable" href="classSampleSummary.html#abeaca1195db794d9e660a377d81c1b21">DataHist_ProjectX</a>[i], ModeProjectX, W2ModeProjectX);</div>
<div class="line"><span class="lineno">  760</span>    <a class="code hl_function" href="classSampleSummary.html#a197d9d30abc14a76d65bd876b28cca32">CalcLLH</a>(<a class="code hl_variable" href="classSampleSummary.html#abfeb54f4d95b5b74257a1abf5c98824f">DataHist_ProjectY</a>[i], NomProjectY, W2NomProjectY);</div>
<div class="line"><span class="lineno">  761</span>    <a class="code hl_function" href="classSampleSummary.html#a197d9d30abc14a76d65bd876b28cca32">CalcLLH</a>(<a class="code hl_variable" href="classSampleSummary.html#abfeb54f4d95b5b74257a1abf5c98824f">DataHist_ProjectY</a>[i], MeanProjectY, W2MeanProjectY);</div>
<div class="line"><span class="lineno">  762</span>    <a class="code hl_function" href="classSampleSummary.html#a197d9d30abc14a76d65bd876b28cca32">CalcLLH</a>(<a class="code hl_variable" href="classSampleSummary.html#abfeb54f4d95b5b74257a1abf5c98824f">DataHist_ProjectY</a>[i], ModeProjectY, W2ModeProjectY);</div>
<div class="line"><span class="lineno">  763</span> </div>
<div class="line"><span class="lineno">  764</span>    std::string SampleName = <a class="code hl_variable" href="classSampleSummary.html#a9ba7df41774c45a14c0a97e4accc9cc0">SampleNames</a>[i];</div>
<div class="line"><span class="lineno">  765</span>    <span class="comment">// Also strip out - signs because it messes up TBranches</span></div>
<div class="line"><span class="lineno">  766</span>    <span class="keywordflow">while</span> (SampleName.find(<span class="stringliteral">&quot;-&quot;</span>) != std::string::npos) {</div>
<div class="line"><span class="lineno">  767</span>      SampleName.replace(SampleName.find(<span class="stringliteral">&quot;-&quot;</span>), 1, std::string(<span class="stringliteral">&quot;_&quot;</span>));</div>
<div class="line"><span class="lineno">  768</span>    } </div>
<div class="line"><span class="lineno">  769</span>    <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Draw((SampleName+<span class="stringliteral">&quot;_data_draw:&quot;</span>+SampleName+<span class="stringliteral">&quot;_drawfluc_draw&gt;&gt;htemp&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  770</span>    TH2D *TempHistogram = <span class="keyword">static_cast&lt;</span>TH2D*<span class="keyword">&gt;</span>(gDirectory-&gt;Get(<span class="stringliteral">&quot;htemp&quot;</span>)-&gt;Clone());</div>
<div class="line"><span class="lineno">  771</span>    TempHistogram-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;-2LLH(Draw Fluc, Draw)&quot;</span>);</div>
<div class="line"><span class="lineno">  772</span>    TempHistogram-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;-2LLH(Data, Draw)&quot;</span>);</div>
<div class="line"><span class="lineno">  773</span>    TempHistogram-&gt;SetNameTitle((<a class="code hl_variable" href="classSampleSummary.html#a9ba7df41774c45a14c0a97e4accc9cc0">SampleNames</a>[i]+<span class="stringliteral">&quot;_drawfluc_draw&quot;</span>).c_str(), (<a class="code hl_variable" href="classSampleSummary.html#a9ba7df41774c45a14c0a97e4accc9cc0">SampleNames</a>[i]+<span class="stringliteral">&quot;_drawfluc_draw&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  774</span>    <a class="code hl_function" href="classSampleSummary.html#a24fff19d07a5b11c9c4149a45d0265cd">MakeCutLLH2D</a>(TempHistogram);</div>
<div class="line"><span class="lineno">  775</span>    TempHistogram-&gt;Write();</div>
<div class="line"><span class="lineno">  776</span>    <span class="keyword">delete</span> TempHistogram;</div>
<div class="line"><span class="lineno">  777</span> </div>
<div class="line"><span class="lineno">  778</span>    <span class="comment">// Also write the 2D histograms for the p-value</span></div>
<div class="line"><span class="lineno">  779</span>    <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Draw((SampleName+<span class="stringliteral">&quot;_data_draw:&quot;</span>+SampleName+<span class="stringliteral">&quot;_predfluc_draw&gt;&gt;htemp2&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  780</span>    TH2D *TempHistogram2 = <span class="keyword">static_cast&lt;</span>TH2D*<span class="keyword">&gt;</span>(gDirectory-&gt;Get(<span class="stringliteral">&quot;htemp2&quot;</span>)-&gt;Clone());</div>
<div class="line"><span class="lineno">  781</span>    TempHistogram2-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;-2LLH(Pred Fluc, Draw)&quot;</span>);</div>
<div class="line"><span class="lineno">  782</span>    TempHistogram2-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;-2LLH(Data, Draw)&quot;</span>);</div>
<div class="line"><span class="lineno">  783</span>    TempHistogram2-&gt;SetNameTitle((<a class="code hl_variable" href="classSampleSummary.html#a9ba7df41774c45a14c0a97e4accc9cc0">SampleNames</a>[i]+<span class="stringliteral">&quot;_predfluc_draw&quot;</span>).c_str(), (<a class="code hl_variable" href="classSampleSummary.html#a9ba7df41774c45a14c0a97e4accc9cc0">SampleNames</a>[i]+<span class="stringliteral">&quot;_predfluc_draw&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  784</span>    <a class="code hl_function" href="classSampleSummary.html#a24fff19d07a5b11c9c4149a45d0265cd">MakeCutLLH2D</a>(TempHistogram2);</div>
<div class="line"><span class="lineno">  785</span>    TempHistogram2-&gt;Write();</div>
<div class="line"><span class="lineno">  786</span>    <span class="keyword">delete</span> TempHistogram2;</div>
<div class="line"><span class="lineno">  787</span>   </div>
<div class="line"><span class="lineno">  788</span>    <span class="comment">// finally p-value for 1D projection</span></div>
<div class="line"><span class="lineno">  789</span>    <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Draw((SampleName+<span class="stringliteral">&quot;_rate_data_draw:&quot;</span>+SampleName+<span class="stringliteral">&quot;_rate_predfluc_draw&gt;&gt;htemp3&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  790</span>    TH2D *TempHistogram3 = <span class="keyword">static_cast&lt;</span>TH2D*<span class="keyword">&gt;</span>(gDirectory-&gt;Get(<span class="stringliteral">&quot;htemp3&quot;</span>)-&gt;Clone());</div>
<div class="line"><span class="lineno">  791</span>    TempHistogram3-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;-2LLH(Pred Fluc, Draw)&quot;</span>);</div>
<div class="line"><span class="lineno">  792</span>    TempHistogram3-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;-2LLH(Data, Draw)&quot;</span>);</div>
<div class="line"><span class="lineno">  793</span>    TempHistogram3-&gt;SetNameTitle((<a class="code hl_variable" href="classSampleSummary.html#a9ba7df41774c45a14c0a97e4accc9cc0">SampleNames</a>[i]+<span class="stringliteral">&quot;_rate_predfluc_draw&quot;</span>).c_str(), (<a class="code hl_variable" href="classSampleSummary.html#a9ba7df41774c45a14c0a97e4accc9cc0">SampleNames</a>[i]+<span class="stringliteral">&quot;_rate_predfluc_draw&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  794</span>    <a class="code hl_function" href="classSampleSummary.html#a24fff19d07a5b11c9c4149a45d0265cd">MakeCutLLH2D</a>(TempHistogram3);</div>
<div class="line"><span class="lineno">  795</span>    TempHistogram3-&gt;Write();</div>
<div class="line"><span class="lineno">  796</span>    <span class="keyword">delete</span> TempHistogram3;</div>
<div class="line"><span class="lineno">  797</span> </div>
<div class="line"><span class="lineno">  798</span>    <span class="comment">// finally p-value for 1D projection</span></div>
<div class="line"><span class="lineno">  799</span>    <a class="code hl_variable" href="classSampleSummary.html#a78eb4766cc8b4758b909b6ce9113a56e">OutputTree</a>-&gt;Draw((SampleName+<span class="stringliteral">&quot;_data_draw_ProjectX:&quot;</span>+SampleName+<span class="stringliteral">&quot;_drawfluc_draw_ProjectX&gt;&gt;htemp4&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  800</span>    TH2D *TempHistogram4 = <span class="keyword">static_cast&lt;</span>TH2D*<span class="keyword">&gt;</span>(gDirectory-&gt;Get(<span class="stringliteral">&quot;htemp4&quot;</span>)-&gt;Clone());</div>
<div class="line"><span class="lineno">  801</span>    TempHistogram4-&gt;GetXaxis()-&gt;SetTitle((<span class="stringliteral">&quot;-2LLH_{Draw Fluc, Draw} for &quot;</span> + <a class="code hl_variable" href="classSampleSummary.html#abd938805245ca6cfeb8c49363f5ff11c">SamplePDF</a>-&gt;<a class="code hl_function" href="classsamplePDFBase.html#a2c02e6a8107a0fd8b9deed6d98015ba3">GetKinVarLabel</a>(i, 0)).c_str());</div>
<div class="line"><span class="lineno">  802</span>    TempHistogram4-&gt;GetYaxis()-&gt;SetTitle((<span class="stringliteral">&quot;-2LLH_{Data, Draw} for &quot;</span> + <a class="code hl_variable" href="classSampleSummary.html#abd938805245ca6cfeb8c49363f5ff11c">SamplePDF</a>-&gt;<a class="code hl_function" href="classsamplePDFBase.html#a2c02e6a8107a0fd8b9deed6d98015ba3">GetKinVarLabel</a>(i, 0)).c_str());</div>
<div class="line"><span class="lineno">  803</span>    TempHistogram4-&gt;SetNameTitle((<a class="code hl_variable" href="classSampleSummary.html#a9ba7df41774c45a14c0a97e4accc9cc0">SampleNames</a>[i]+<span class="stringliteral">&quot;_drawfluc_draw_ProjectX&quot;</span>).c_str(), (<a class="code hl_variable" href="classSampleSummary.html#a9ba7df41774c45a14c0a97e4accc9cc0">SampleNames</a>[i]+<span class="stringliteral">&quot;_drawfluc_draw_ProjectX&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  804</span>    <a class="code hl_function" href="classSampleSummary.html#a24fff19d07a5b11c9c4149a45d0265cd">MakeCutLLH2D</a>(TempHistogram4);</div>
<div class="line"><span class="lineno">  805</span>    TempHistogram4-&gt;Write();</div>
<div class="line"><span class="lineno">  806</span>    <span class="keyword">delete</span> TempHistogram4;</div>
<div class="line"><span class="lineno">  807</span>    </div>
<div class="line"><span class="lineno">  808</span>    <span class="comment">// Write the Histograms to each folder</span></div>
<div class="line"><span class="lineno">  809</span>    <a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i]-&gt;Write();</div>
<div class="line"><span class="lineno">  810</span>    <a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i]-&gt;Write();</div>
<div class="line"><span class="lineno">  811</span>    <a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[i]-&gt;Write();</div>
<div class="line"><span class="lineno">  812</span>    <a class="code hl_variable" href="classSampleSummary.html#a9b21ff74bb8ebd7c3af2c24e02f3d7dc">ModeHist</a>[i]-&gt;Write();</div>
<div class="line"><span class="lineno">  813</span>    RatioHistMean-&gt;Write();</div>
<div class="line"><span class="lineno">  814</span>    RatioHistMode-&gt;Write();</div>
<div class="line"><span class="lineno">  815</span>    RatioHistNom-&gt;Write();</div>
<div class="line"><span class="lineno">  816</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#adf610d698a50c4930d95be320e99a8e8">DoBetaParam</a>) <a class="code hl_variable" href="classSampleSummary.html#a6191a0fc1c8f1f0889b3dedcc5485a3d">MeanHistCorrected</a>[i]-&gt;Write();</div>
<div class="line"><span class="lineno">  817</span> </div>
<div class="line"><span class="lineno">  818</span>    <a class="code hl_variable" href="classSampleSummary.html#a9c37d8669c0f55f6a4620b4f0d7b6e20">W2NomHist</a>[i]-&gt;Write();</div>
<div class="line"><span class="lineno">  819</span>    <a class="code hl_variable" href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">W2MeanHist</a>[i]-&gt;Write();</div>
<div class="line"><span class="lineno">  820</span>    <a class="code hl_variable" href="classSampleSummary.html#adf9b943ba381875b3f2e0c4807a9b8c4">W2ModeHist</a>[i]-&gt;Write();</div>
<div class="line"><span class="lineno">  821</span> </div>
<div class="line"><span class="lineno">  822</span>    DataNormHist-&gt;Write();</div>
<div class="line"><span class="lineno">  823</span>    NomNormHist-&gt;Write();</div>
<div class="line"><span class="lineno">  824</span>    MeanNormHist-&gt;Write();</div>
<div class="line"><span class="lineno">  825</span>    ModeNormHist-&gt;Write();</div>
<div class="line"><span class="lineno">  826</span> </div>
<div class="line"><span class="lineno">  827</span>    <a class="code hl_variable" href="classSampleSummary.html#abeaca1195db794d9e660a377d81c1b21">DataHist_ProjectX</a>[i]-&gt;Write();</div>
<div class="line"><span class="lineno">  828</span>    NomProjectX-&gt;Write();</div>
<div class="line"><span class="lineno">  829</span>    MeanProjectX-&gt;Write();</div>
<div class="line"><span class="lineno">  830</span>    ModeProjectX-&gt;Write();</div>
<div class="line"><span class="lineno">  831</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#adf610d698a50c4930d95be320e99a8e8">DoBetaParam</a>) MeanHistCorrectedProjectX-&gt;Write();</div>
<div class="line"><span class="lineno">  832</span>    <a class="code hl_variable" href="classSampleSummary.html#a4a93fa8d52abe2828a4a25e49cf6fee8">ViolinHists_ProjectX</a>[i]-&gt;Write();</div>
<div class="line"><span class="lineno">  833</span>    </div>
<div class="line"><span class="lineno">  834</span>    <a class="code hl_variable" href="classSampleSummary.html#abfeb54f4d95b5b74257a1abf5c98824f">DataHist_ProjectY</a>[i]-&gt;Write();</div>
<div class="line"><span class="lineno">  835</span>    NomProjectY-&gt;Write();</div>
<div class="line"><span class="lineno">  836</span>    MeanProjectY-&gt;Write();</div>
<div class="line"><span class="lineno">  837</span>    ModeProjectY-&gt;Write();</div>
<div class="line"><span class="lineno">  838</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#adf610d698a50c4930d95be320e99a8e8">DoBetaParam</a>) MeanHistCorrectedProjectY-&gt;Write();</div>
<div class="line"><span class="lineno">  839</span>    <a class="code hl_variable" href="classSampleSummary.html#a93714cf9b778fa7713a641da0cd2d534">ViolinHists_ProjectY</a>[i]-&gt;Write();</div>
<div class="line"><span class="lineno">  840</span> </div>
<div class="line"><span class="lineno">  841</span>    W2NomProjectX-&gt;Write();</div>
<div class="line"><span class="lineno">  842</span>    W2MeanProjectX-&gt;Write();</div>
<div class="line"><span class="lineno">  843</span>    W2ModeProjectX-&gt;Write();</div>
<div class="line"><span class="lineno">  844</span> </div>
<div class="line"><span class="lineno">  845</span>    W2NomProjectY-&gt;Write();</div>
<div class="line"><span class="lineno">  846</span>    W2MeanProjectY-&gt;Write();</div>
<div class="line"><span class="lineno">  847</span>    W2ModeProjectY-&gt;Write();</div>
<div class="line"><span class="lineno">  848</span>    </div>
<div class="line"><span class="lineno">  849</span>    <span class="comment">//KS: This will dump lots of hists, use it only for debugging</span></div>
<div class="line"><span class="lineno">  850</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#a807e348a85fb460c5ca4a1ce56d08aab">Debug</a> &gt; 0)</div>
<div class="line"><span class="lineno">  851</span>    {</div>
<div class="line"><span class="lineno">  852</span>      TDirectory* DebugDir = <a class="code hl_variable" href="classSampleSummary.html#aa2064e7455c3164ee5118a5e5162f282">Dir</a>[i]-&gt;mkdir(<span class="stringliteral">&quot;Debug&quot;</span>);</div>
<div class="line"><span class="lineno">  853</span>      DebugDir-&gt;cd();</div>
<div class="line"><span class="lineno">  854</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b = 1; b &lt;= <a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[i]; ++b)</div>
<div class="line"><span class="lineno">  855</span>      {</div>
<div class="line"><span class="lineno">  856</span>        <a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[i][b]-&gt;Write();</div>
<div class="line"><span class="lineno">  857</span>        std::string Title = <a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[i][b]-&gt;GetName();</div>
<div class="line"><span class="lineno">  858</span> </div>
<div class="line"><span class="lineno">  859</span>        <span class="keyword">auto</span> TempLine = std::make_unique&lt;TLine&gt;(<a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i]-&gt;GetBinContent(b), <a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[i][b]-&gt;GetMinimum(),</div>
<div class="line"><span class="lineno">  860</span>                                                <a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i]-&gt;GetBinContent(b), <a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[i][b]-&gt;GetMaximum());</div>
<div class="line"><span class="lineno">  861</span>        TempLine-&gt;SetLineColor(kRed);</div>
<div class="line"><span class="lineno">  862</span>        TempLine-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno">  863</span> </div>
<div class="line"><span class="lineno">  864</span>        <span class="keyword">auto</span> TempLineData = std::make_unique&lt;TLine&gt;(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i]-&gt;GetBinContent(b), <a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[i][b]-&gt;GetMinimum(),</div>
<div class="line"><span class="lineno">  865</span>                                                    <a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i]-&gt;GetBinContent(b), <a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[i][b]-&gt;GetMaximum());</div>
<div class="line"><span class="lineno">  866</span>        TempLineData-&gt;SetLineColor(kGreen);</div>
<div class="line"><span class="lineno">  867</span>        TempLineData-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno">  868</span> </div>
<div class="line"><span class="lineno">  869</span>        <span class="comment">// Also fit a Gaussian because why not?</span></div>
<div class="line"><span class="lineno">  870</span>        TF1 *Fitter = <span class="keyword">new</span> TF1(<span class="stringliteral">&quot;Fit&quot;</span>, <span class="stringliteral">&quot;gaus&quot;</span>, <a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[i][b]-&gt;GetBinLowEdge(1), <a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[i][b]-&gt;GetBinLowEdge(<a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[i][b]-&gt;GetNbinsX()+1));</div>
<div class="line"><span class="lineno">  871</span>        <a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[i][b]-&gt;Fit(Fitter, <span class="stringliteral">&quot;RQ&quot;</span>);</div>
<div class="line"><span class="lineno">  872</span>        Fitter-&gt;SetLineColor(kRed-5);</div>
<div class="line"><span class="lineno">  873</span> </div>
<div class="line"><span class="lineno">  874</span>        <span class="keyword">auto</span> Legend = std::make_unique&lt;TLegend&gt;(0.4, 0.75, 0.98, 0.90);</div>
<div class="line"><span class="lineno">  875</span>        Legend-&gt;SetFillColor(0);</div>
<div class="line"><span class="lineno">  876</span>        Legend-&gt;SetFillStyle(0);</div>
<div class="line"><span class="lineno">  877</span>        Legend-&gt;SetLineWidth(0);</div>
<div class="line"><span class="lineno">  878</span>        Legend-&gt;SetLineColor(0);</div>
<div class="line"><span class="lineno">  879</span>        Legend-&gt;AddEntry(TempLineData.get(), Form(<span class="stringliteral">&quot;Data #mu=%.2f&quot;</span>, <a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i]-&gt;GetBinContent(b)), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno">  880</span>        Legend-&gt;AddEntry(TempLine.get(), Form(<span class="stringliteral">&quot;Prior #mu=%.2f&quot;</span>, <a class="code hl_variable" href="classSampleSummary.html#a503b0dc19bb1ad57e7f2560cc64feef9">NominalHist</a>[i]-&gt;GetBinContent(b)), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno">  881</span>        Legend-&gt;AddEntry(<a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[i][b].get(), Form(<span class="stringliteral">&quot;Post, #mu=%.2f#pm%.2f&quot;</span>, <a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[i][b]-&gt;GetMean(), <a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[i][b]-&gt;GetRMS()), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno">  882</span>        Legend-&gt;AddEntry(Fitter, Form(<span class="stringliteral">&quot;Gauss, #mu=%.2f#pm%.2f&quot;</span>, Fitter-&gt;GetParameter(1), Fitter-&gt;GetParameter(2)), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno">  883</span>        std::string TempTitle = std::string(<a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[i][b]-&gt;GetName());</div>
<div class="line"><span class="lineno">  884</span> </div>
<div class="line"><span class="lineno">  885</span>        TempTitle += <span class="stringliteral">&quot;_canv&quot;</span>;</div>
<div class="line"><span class="lineno">  886</span>        TCanvas *TempCanvas = <span class="keyword">new</span> TCanvas(TempTitle.c_str(), TempTitle.c_str(), 1024, 1024);</div>
<div class="line"><span class="lineno">  887</span>        TempCanvas-&gt;SetGridx();</div>
<div class="line"><span class="lineno">  888</span>        TempCanvas-&gt;SetGridy();</div>
<div class="line"><span class="lineno">  889</span>        TempCanvas-&gt;SetRightMargin(0.03);</div>
<div class="line"><span class="lineno">  890</span>        TempCanvas-&gt;SetBottomMargin(0.08);</div>
<div class="line"><span class="lineno">  891</span>        TempCanvas-&gt;SetLeftMargin(0.10);</div>
<div class="line"><span class="lineno">  892</span>        TempCanvas-&gt;SetTopMargin(0.06);</div>
<div class="line"><span class="lineno">  893</span>        TempCanvas-&gt;cd();</div>
<div class="line"><span class="lineno">  894</span>        <a class="code hl_variable" href="classSampleSummary.html#a508ef812c8b1275580759832e33c98ee">PosteriorHist</a>[i][b]-&gt;Draw();</div>
<div class="line"><span class="lineno">  895</span>        TempLine-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><span class="lineno">  896</span>        TempLineData-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><span class="lineno">  897</span>        Fitter-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><span class="lineno">  898</span>        Legend-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><span class="lineno">  899</span>        TempCanvas-&gt;Write();</div>
<div class="line"><span class="lineno">  900</span> </div>
<div class="line"><span class="lineno">  901</span>        <span class="keyword">delete</span> TempCanvas;</div>
<div class="line"><span class="lineno">  902</span>        <span class="keyword">delete</span> Fitter;</div>
<div class="line"><span class="lineno">  903</span>        <span class="comment">//This isn&#39;t useful check only in desperation</span></div>
<div class="line"><span class="lineno">  904</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#a807e348a85fb460c5ca4a1ce56d08aab">Debug</a> &gt; 1) <a class="code hl_variable" href="classSampleSummary.html#aa6773885be1b6a2660493718823a2f3f">w2Hist</a>[i][b]-&gt;Write();</div>
<div class="line"><span class="lineno">  905</span>      }</div>
<div class="line"><span class="lineno">  906</span>      DebugDir-&gt;Close();</div>
<div class="line"><span class="lineno">  907</span>      <span class="keyword">delete</span> DebugDir;</div>
<div class="line"><span class="lineno">  908</span>      <a class="code hl_variable" href="classSampleSummary.html#aa2064e7455c3164ee5118a5e5162f282">Dir</a>[i]-&gt;cd();</div>
<div class="line"><span class="lineno">  909</span>    }</div>
<div class="line"><span class="lineno">  910</span>    <a class="code hl_variable" href="classSampleSummary.html#a154c9bd15825713c48154fab66190d39">lnLHist_Mean</a>[i]-&gt;Write();</div>
<div class="line"><span class="lineno">  911</span>    <a class="code hl_variable" href="classSampleSummary.html#a03bbc94ee26b66875becf22255a205d2">lnLHist_Mode</a>[i]-&gt;Write();</div>
<div class="line"><span class="lineno">  912</span> </div>
<div class="line"><span class="lineno">  913</span>    <a class="code hl_variable" href="classSampleSummary.html#a7b1ba5b3b465f78019bb8c36ec5f56d7">lnLHist_Mean_ProjectX</a>[i]-&gt;Write();</div>
<div class="line"><span class="lineno">  914</span> </div>
<div class="line"><span class="lineno">  915</span>    <a class="code hl_variable" href="classSampleSummary.html#a718c83e1952f948a5c063c2039a68a19">lnLHist_Mean1D</a>[i]-&gt;Write();</div>
<div class="line"><span class="lineno">  916</span>    <a class="code hl_variable" href="classSampleSummary.html#a424b53de4d9e896526667ddb565e4a6b">lnLHist_Mode1D</a>[i]-&gt;Write();</div>
<div class="line"><span class="lineno">  917</span> </div>
<div class="line"><span class="lineno">  918</span>    <a class="code hl_function" href="classSampleSummary.html#abf964a8fd459fff903faaea17a98f8b1">MakeCutLLH1D</a>(<a class="code hl_variable" href="classSampleSummary.html#aa61561a1e3594ac9250aaee26409245e">lnLHist_Sample_DrawData</a>[i], <a class="code hl_function" href="classSampleSummary.html#ad027b0716b707691e6a9565ee497b66f">GetLLH</a>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i], <a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[i], <a class="code hl_variable" href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">W2MeanHist</a>[i]));</div>
<div class="line"><span class="lineno">  919</span>    <a class="code hl_variable" href="classSampleSummary.html#aa61561a1e3594ac9250aaee26409245e">lnLHist_Sample_DrawData</a>[i]-&gt;Write();</div>
<div class="line"><span class="lineno">  920</span>    <a class="code hl_function" href="classSampleSummary.html#abf964a8fd459fff903faaea17a98f8b1">MakeCutLLH1D</a>(<a class="code hl_variable" href="classSampleSummary.html#afddd2abc0ec07b52dc9004880522ab5a">lnLHist_Sample_DrawflucDraw</a>[i], <a class="code hl_function" href="classSampleSummary.html#ad027b0716b707691e6a9565ee497b66f">GetLLH</a>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i], <a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[i], <a class="code hl_variable" href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">W2MeanHist</a>[i]));</div>
<div class="line"><span class="lineno">  921</span>    <a class="code hl_variable" href="classSampleSummary.html#afddd2abc0ec07b52dc9004880522ab5a">lnLHist_Sample_DrawflucDraw</a>[i]-&gt;Write();</div>
<div class="line"><span class="lineno">  922</span>    <a class="code hl_function" href="classSampleSummary.html#abf964a8fd459fff903faaea17a98f8b1">MakeCutLLH1D</a>(<a class="code hl_variable" href="classSampleSummary.html#aecf1c224162e1055e8306d438e1a3761">lnLHist_Sample_PredflucDraw</a>[i], <a class="code hl_function" href="classSampleSummary.html#ad027b0716b707691e6a9565ee497b66f">GetLLH</a>(<a class="code hl_variable" href="classSampleSummary.html#a7e962b36331edb6ff1e9de849cbabee3">DataHist</a>[i], <a class="code hl_variable" href="classSampleSummary.html#af0edee6c71137e2a8150c7ba3e8fb6e0">MeanHist</a>[i], <a class="code hl_variable" href="classSampleSummary.html#a2828111584f80f855b56a9a093987673">W2MeanHist</a>[i]));</div>
<div class="line"><span class="lineno">  923</span>    <a class="code hl_variable" href="classSampleSummary.html#aecf1c224162e1055e8306d438e1a3761">lnLHist_Sample_PredflucDraw</a>[i]-&gt;Write();</div>
<div class="line"><span class="lineno">  924</span>    </div>
<div class="line"><span class="lineno">  925</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#a795ac96bf6958c8a2f38c9de23c3c081">DoByModePlots</a>)</div>
<div class="line"><span class="lineno">  926</span>    {</div>
<div class="line"><span class="lineno">  927</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classSampleSummary.html#a6593fed9709673a6910f96adc88fc8f2">Modes</a>-&gt;<a class="code hl_function" href="classMaCh3Modes.html#aaa508822590464a0ce36d2fed94e4d03">GetNModes</a>()+1; ++j)</div>
<div class="line"><span class="lineno">  928</span>      {</div>
<div class="line"><span class="lineno">  929</span>        <a class="code hl_variable" href="classSampleSummary.html#a20237446a72eda2dc833bfc72c7e42e1">MeanHist_ByMode</a>[i][j]-&gt;Write();</div>
<div class="line"><span class="lineno">  930</span>        TH1D *MeanProjectX_ByMode = <a class="code hl_function" href="classSampleSummary.html#a685a8ef3180d4f6474328b5c806d8b74">ProjectPoly</a>(<a class="code hl_variable" href="classSampleSummary.html#a20237446a72eda2dc833bfc72c7e42e1">MeanHist_ByMode</a>[i][j], <span class="keyword">true</span>, i, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  931</span>        TH1D *MeanProjectY_ByMode = <a class="code hl_function" href="classSampleSummary.html#a685a8ef3180d4f6474328b5c806d8b74">ProjectPoly</a>(<a class="code hl_variable" href="classSampleSummary.html#a20237446a72eda2dc833bfc72c7e42e1">MeanHist_ByMode</a>[i][j], <span class="keyword">false</span>, i, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  932</span>        MeanProjectX_ByMode-&gt;Write();</div>
<div class="line"><span class="lineno">  933</span>        MeanProjectY_ByMode-&gt;Write();</div>
<div class="line"><span class="lineno">  934</span>        <span class="comment">//KS: This will dump lots of hists, use it only for debugging</span></div>
<div class="line"><span class="lineno">  935</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#a807e348a85fb460c5ca4a1ce56d08aab">Debug</a> &gt; 0)</div>
<div class="line"><span class="lineno">  936</span>        {</div>
<div class="line"><span class="lineno">  937</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b = 1; b &lt;= <a class="code hl_variable" href="classSampleSummary.html#af5a3139cef917abfddc36dbb8d4ac2fd">maxBins</a>[i]; ++b)</div>
<div class="line"><span class="lineno">  938</span>          {</div>
<div class="line"><span class="lineno">  939</span>            <a class="code hl_variable" href="classSampleSummary.html#aa6cfe4fb92b67f08b0d94f0fe1d8a3a2">PosteriorHist_ByMode</a>[i][j][b]-&gt;Write();</div>
<div class="line"><span class="lineno">  940</span>          }</div>
<div class="line"><span class="lineno">  941</span>        }</div>
<div class="line"><span class="lineno">  942</span>        <span class="keyword">delete</span> MeanProjectX_ByMode;</div>
<div class="line"><span class="lineno">  943</span>        <span class="keyword">delete</span> MeanProjectY_ByMode;</div>
<div class="line"><span class="lineno">  944</span>      } <span class="comment">// End loop over bins</span></div>
<div class="line"><span class="lineno">  945</span>    }</div>
<div class="line"><span class="lineno">  946</span>    <span class="comment">// Delete temporary objects</span></div>
<div class="line"><span class="lineno">  947</span>    <span class="keyword">delete</span> RatioHistMean;</div>
<div class="line"><span class="lineno">  948</span>    <span class="keyword">delete</span> RatioHistMode;</div>
<div class="line"><span class="lineno">  949</span>    <span class="keyword">delete</span> RatioHistNom;</div>
<div class="line"><span class="lineno">  950</span> </div>
<div class="line"><span class="lineno">  951</span>    <span class="keyword">delete</span> DataNormHist;</div>
<div class="line"><span class="lineno">  952</span>    <span class="keyword">delete</span> MeanNormHist;</div>
<div class="line"><span class="lineno">  953</span>    <span class="keyword">delete</span> ModeNormHist;</div>
<div class="line"><span class="lineno">  954</span>    <span class="keyword">delete</span> NomNormHist;</div>
<div class="line"><span class="lineno">  955</span> </div>
<div class="line"><span class="lineno">  956</span>    <span class="keyword">delete</span> <a class="code hl_variable" href="classSampleSummary.html#abeaca1195db794d9e660a377d81c1b21">DataHist_ProjectX</a>[i];</div>
<div class="line"><span class="lineno">  957</span>    <span class="keyword">delete</span> MeanProjectX;</div>
<div class="line"><span class="lineno">  958</span>    <span class="keyword">delete</span> ModeProjectX;</div>
<div class="line"><span class="lineno">  959</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#adf610d698a50c4930d95be320e99a8e8">DoBetaParam</a>) <span class="keyword">delete</span> MeanHistCorrectedProjectX;</div>
<div class="line"><span class="lineno">  960</span>    <span class="keyword">delete</span> NomProjectX;</div>
<div class="line"><span class="lineno">  961</span> </div>
<div class="line"><span class="lineno">  962</span>    <span class="keyword">delete</span> <a class="code hl_variable" href="classSampleSummary.html#abfeb54f4d95b5b74257a1abf5c98824f">DataHist_ProjectY</a>[i];</div>
<div class="line"><span class="lineno">  963</span>    <span class="keyword">delete</span> MeanProjectY;</div>
<div class="line"><span class="lineno">  964</span>    <span class="keyword">delete</span> ModeProjectY;</div>
<div class="line"><span class="lineno">  965</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#adf610d698a50c4930d95be320e99a8e8">DoBetaParam</a>) <span class="keyword">delete</span> MeanHistCorrectedProjectY;</div>
<div class="line"><span class="lineno">  966</span>    <span class="keyword">delete</span> NomProjectY;</div>
<div class="line"><span class="lineno">  967</span> </div>
<div class="line"><span class="lineno">  968</span>    <span class="keyword">delete</span> W2NomProjectX;</div>
<div class="line"><span class="lineno">  969</span>    <span class="keyword">delete</span> W2MeanProjectX;</div>
<div class="line"><span class="lineno">  970</span>    <span class="keyword">delete</span> W2ModeProjectX;</div>
<div class="line"><span class="lineno">  971</span>  </div>
<div class="line"><span class="lineno">  972</span>    <span class="keyword">delete</span> W2NomProjectY;</div>
<div class="line"><span class="lineno">  973</span>    <span class="keyword">delete</span> W2MeanProjectY;</div>
<div class="line"><span class="lineno">  974</span>    <span class="keyword">delete</span> W2ModeProjectY;</div>
<div class="line"><span class="lineno">  975</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  976</span>  } <span class="comment">//end loop over samples</span></div>
<div class="line"><span class="lineno">  977</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSampleSummary.html#adf610d698a50c4930d95be320e99a8e8">DoBetaParam</a>) <a class="code hl_function" href="classSampleSummary.html#ac49aa59702b5e24cb0718c2642d6d793">PlotBetaParameters</a>();</div>
<div class="line"><span class="lineno">  978</span> </div>
<div class="line"><span class="lineno">  979</span>  <a class="code hl_function" href="classSampleSummary.html#afa199f8841fcbf007c293187ea60d795">StudyKinematicCorrelations</a>();</div>
<div class="line"><span class="lineno">  980</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Wrote to {}&quot;</span>, <a class="code hl_variable" href="classSampleSummary.html#aa7b948f290517a052f04f61dfa6af68f">Outputfile</a>-&gt;GetName());</div>
<div class="line"><span class="lineno">  981</span>}</div>
<div class="ttc" id="aStructs_8cpp_html_ae28c217f8e8591248bfa54e95fdd7741"><div class="ttname"><a href="Structs_8cpp.html#ae28c217f8e8591248bfa54e95fdd7741">NormalisePoly</a></div><div class="ttdeci">TH2Poly * NormalisePoly(TH2Poly *Histogram)</div><div class="ttdoc">WP: Helper to Normalise histograms.</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8cpp_source.html#l00314">Structs.cpp:314</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a02dcccd537e6e9a9ffc46b31429306ce"><div class="ttname"><a href="classSampleSummary.html#a02dcccd537e6e9a9ffc46b31429306ce">SampleSummary::StudyInformationCriterion</a></div><div class="ttdeci">void StudyInformationCriterion(M3::kInfCrit Criterion)</div><div class="ttdoc">Information Criterion.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8cpp_source.html#l02459">SampleSummary.cpp:2459</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a197d9d30abc14a76d65bd876b28cca32"><div class="ttname"><a href="classSampleSummary.html#a197d9d30abc14a76d65bd876b28cca32">SampleSummary::CalcLLH</a></div><div class="ttdeci">void CalcLLH(TH2Poly *const &amp;Data, TH2Poly *const &amp;MC, TH2Poly *const &amp;W2)</div><div class="ttdoc">Helper functions to calculate likelihoods using TH2Poly, will modify MC hist tittle to include LLH.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8cpp_source.html#l01673">SampleSummary.cpp:1673</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a44baf8959ced974c9a0b8ae640c336bd"><div class="ttname"><a href="classSampleSummary.html#a44baf8959ced974c9a0b8ae640c336bd">SampleSummary::MakePredictive</a></div><div class="ttdeci">void MakePredictive()</div><div class="ttdoc">Finalise the distributions from the thrown samples.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8cpp_source.html#l00985">SampleSummary.cpp:985</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a6d7ad3d2ee9868e80548b8a73299bd5b"><div class="ttname"><a href="classSampleSummary.html#a6d7ad3d2ee9868e80548b8a73299bd5b">SampleSummary::RatioPolys</a></div><div class="ttdeci">TH2Poly * RatioPolys(TH2Poly *NumPoly, TH2Poly *DenomPoly)</div><div class="ttdoc">Helper to make ratio of TH2Polys.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8cpp_source.html#l01635">SampleSummary.cpp:1635</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_a7b87a7ce0c38e968fb841f228aea7212"><div class="ttname"><a href="classSampleSummary.html#a7b87a7ce0c38e968fb841f228aea7212">SampleSummary::PrepareOutput</a></div><div class="ttdeci">void PrepareOutput()</div><div class="ttdoc">KS: Prepare output tree and necessary variables.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8cpp_source.html#l00563">SampleSummary.cpp:563</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_ac49aa59702b5e24cb0718c2642d6d793"><div class="ttname"><a href="classSampleSummary.html#ac49aa59702b5e24cb0718c2642d6d793">SampleSummary::PlotBetaParameters</a></div><div class="ttdeci">void PlotBetaParameters()</div><div class="ttdoc">KS: In Barlow Beeston we have Beta Parameters which scale generated MC.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8cpp_source.html#l01713">SampleSummary.cpp:1713</a></div></div>
<div class="ttc" id="aclassSampleSummary_html_afa199f8841fcbf007c293187ea60d795"><div class="ttname"><a href="classSampleSummary.html#afa199f8841fcbf007c293187ea60d795">SampleSummary::StudyKinematicCorrelations</a></div><div class="ttdeci">void StudyKinematicCorrelations()</div><div class="ttdoc">KS: Study how correlated are sample or kinematic bins.</div><div class="ttdef"><b>Definition:</b> <a href="SampleSummary_8cpp_source.html#l01791">SampleSummary.cpp:1791</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a479f46f89c0c752c3e3e147d5b04b458" name="a479f46f89c0c752c3e3e147d5b04b458"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a479f46f89c0c752c3e3e147d5b04b458">&#9670;&#160;</a></span>BetaHist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;std::unique_ptr&lt;TH1D&gt; &gt; &gt; SampleSummary::BetaHist</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Distribution of beta parameters in Barlow Beeston formalisms. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00261">261</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a7e962b36331edb6ff1e9de849cbabee3" name="a7e962b36331edb6ff1e9de849cbabee3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e962b36331edb6ff1e9de849cbabee3">&#9670;&#160;</a></span>DataHist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TH2Poly*&gt; SampleSummary::DataHist</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The data histogram for the selection. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00198">198</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="abeaca1195db794d9e660a377d81c1b21" name="abeaca1195db794d9e660a377d81c1b21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abeaca1195db794d9e660a377d81c1b21">&#9670;&#160;</a></span>DataHist_ProjectX</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TH1D*&gt; SampleSummary::DataHist_ProjectX</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The data histogram for the selection X projection. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00200">200</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="abfeb54f4d95b5b74257a1abf5c98824f" name="abfeb54f4d95b5b74257a1abf5c98824f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfeb54f4d95b5b74257a1abf5c98824f">&#9670;&#160;</a></span>DataHist_ProjectY</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TH1D*&gt; SampleSummary::DataHist_ProjectY</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The data histogram for the selection Y projection. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00202">202</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a807e348a85fb460c5ca4a1ce56d08aab" name="a807e348a85fb460c5ca4a1ce56d08aab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a807e348a85fb460c5ca4a1ce56d08aab">&#9670;&#160;</a></span>Debug</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SampleSummary::Debug</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Tells Debug level to save additional histograms. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00379">379</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="aa2064e7455c3164ee5118a5e5162f282" name="aa2064e7455c3164ee5118a5e5162f282"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2064e7455c3164ee5118a5e5162f282">&#9670;&#160;</a></span>Dir</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TDirectory*&gt; SampleSummary::Dir</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Directory for each sample. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00288">288</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="adf610d698a50c4930d95be320e99a8e8" name="adf610d698a50c4930d95be320e99a8e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf610d698a50c4930d95be320e99a8e8">&#9670;&#160;</a></span>DoBetaParam</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool SampleSummary::DoBetaParam</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Are we making Beta Histograms. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00263">263</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a795ac96bf6958c8a2f38c9de23c3c081" name="a795ac96bf6958c8a2f38c9de23c3c081"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a795ac96bf6958c8a2f38c9de23c3c081">&#9670;&#160;</a></span>DoByModePlots</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool SampleSummary::DoByModePlots</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>By mode variables. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00360">360</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="aebd01b201cf04608b251cd3e272878b7" name="aebd01b201cf04608b251cd3e272878b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebd01b201cf04608b251cd3e272878b7">&#9670;&#160;</a></span>doShapeOnly</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool SampleSummary::doShapeOnly</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>bool whether to normalise each toy to have shape based p-value and pos pred distribution </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00272">272</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a4ade2ccb94981d4483f0b4e6e367b1a0" name="a4ade2ccb94981d4483f0b4e6e367b1a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ade2ccb94981d4483f0b4e6e367b1a0">&#9670;&#160;</a></span>first_pass</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool SampleSummary::first_pass</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: Hacky flag to let us know if this is first toy. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00164">164</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="adb737e335e68edeb14a6ce2ca112dc8c" name="adb737e335e68edeb14a6ce2ca112dc8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb737e335e68edeb14a6ce2ca112dc8c">&#9670;&#160;</a></span>isPriorPredictive</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool SampleSummary::isPriorPredictive</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>bool whether we have Prior or Posterior Predictive </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00269">269</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="aafb18632bb987ae9a302d95781d5fdba" name="aafb18632bb987ae9a302d95781d5fdba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafb18632bb987ae9a302d95781d5fdba">&#9670;&#160;</a></span>likelihood</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="Structs_8h.html#a960da89e33ac45a56f7bbfac3068dc67">TestStatistic</a> SampleSummary::likelihood</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Type of likelihood for example Poisson, Barlow-Beeston or Ice Cube. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00373">373</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a668c1a7ce4ef8592eae4a91ef99c60dc" name="a668c1a7ce4ef8592eae4a91ef99c60dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a668c1a7ce4ef8592eae4a91ef99c60dc">&#9670;&#160;</a></span>llh_data_draw</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleSummary::llh_data_draw</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Data vs Draw. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00293">293</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a083eb13c61fe7d1b88b2ebe845312640" name="a083eb13c61fe7d1b88b2ebe845312640"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a083eb13c61fe7d1b88b2ebe845312640">&#9670;&#160;</a></span>llh_data_draw_ProjectX</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleSummary::llh_data_draw_ProjectX</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Projection X (most likely muon momentum) of LLH. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00321">321</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a999cbd0982694a364f8706ca2b435d81" name="a999cbd0982694a364f8706ca2b435d81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a999cbd0982694a364f8706ca2b435d81">&#9670;&#160;</a></span>llh_data_drawfluc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleSummary::llh_data_drawfluc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Data vs Fluctuated Draw. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00305">305</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a325a83aec886a90ed6d4c96ccf573c56" name="a325a83aec886a90ed6d4c96ccf573c56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a325a83aec886a90ed6d4c96ccf573c56">&#9670;&#160;</a></span>llh_data_predfluc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleSummary::llh_data_predfluc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Data vs Fluctuated Predictive. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00307">307</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="abe225db63f8137df4b74d138ab1eb6f2" name="abe225db63f8137df4b74d138ab1eb6f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe225db63f8137df4b74d138ab1eb6f2">&#9670;&#160;</a></span>llh_datafluc_draw</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleSummary::llh_datafluc_draw</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fluctuated Data vs Draw. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00318">318</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a7f46ee13ef20275c5dc162196190984b" name="a7f46ee13ef20275c5dc162196190984b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f46ee13ef20275c5dc162196190984b">&#9670;&#160;</a></span>llh_draw_pred</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleSummary::llh_draw_pred</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Draw vs Predictive. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00309">309</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a596fc0b5e504bf382c342e950dd7cb95" name="a596fc0b5e504bf382c342e950dd7cb95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a596fc0b5e504bf382c342e950dd7cb95">&#9670;&#160;</a></span>llh_drawfluc_draw</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleSummary::llh_drawfluc_draw</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fluctuated Draw vs Draw. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00295">295</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a81be1b29e649529930276daab33f7b69" name="a81be1b29e649529930276daab33f7b69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81be1b29e649529930276daab33f7b69">&#9670;&#160;</a></span>llh_drawfluc_draw_ProjectX</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleSummary::llh_drawfluc_draw_ProjectX</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00322">322</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="abc8205a6fddca44ed7c5b3e5c50612e7" name="abc8205a6fddca44ed7c5b3e5c50612e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc8205a6fddca44ed7c5b3e5c50612e7">&#9670;&#160;</a></span>llh_drawfluc_pred</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleSummary::llh_drawfluc_pred</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fluctuated Draw vs Predictive. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00311">311</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a642d0e2bb5bc0729744684a3f8bbc459" name="a642d0e2bb5bc0729744684a3f8bbc459"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a642d0e2bb5bc0729744684a3f8bbc459">&#9670;&#160;</a></span>llh_drawfluc_predfluc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleSummary::llh_drawfluc_predfluc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fluctuated Draw vs Fluctuated Predictive. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00316">316</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="aef70c5ef9c8432dc42ff7f6c73c7e8d5" name="aef70c5ef9c8432dc42ff7f6c73c7e8d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef70c5ef9c8432dc42ff7f6c73c7e8d5">&#9670;&#160;</a></span>llh_penalty</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SampleSummary::llh_penalty</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>LLH penalty for each throw. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00325">325</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a107a3073ee178eff7107ccd5f41b91c5" name="a107a3073ee178eff7107ccd5f41b91c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a107a3073ee178eff7107ccd5f41b91c5">&#9670;&#160;</a></span>llh_predfluc_draw</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleSummary::llh_predfluc_draw</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fluctuated Predictive vs Draw. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00297">297</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a464faf180667c999aec72c140ddb515a" name="a464faf180667c999aec72c140ddb515a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a464faf180667c999aec72c140ddb515a">&#9670;&#160;</a></span>llh_predfluc_pred</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleSummary::llh_predfluc_pred</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fluctuated Predictive vs Predictive. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00314">314</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="adae47fb3a91f5946c7329c6e3643ae9a" name="adae47fb3a91f5946c7329c6e3643ae9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adae47fb3a91f5946c7329c6e3643ae9a">&#9670;&#160;</a></span>llh_rate_data_draw</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleSummary::llh_rate_data_draw</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Data vs Draw using rate only. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00300">300</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="aa27591c1aff4c4e8e25fbf9c13ae37c5" name="aa27591c1aff4c4e8e25fbf9c13ae37c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa27591c1aff4c4e8e25fbf9c13ae37c5">&#9670;&#160;</a></span>llh_rate_predfluc_draw</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleSummary::llh_rate_predfluc_draw</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fluctuated Predictive vs Draw using rate only. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00302">302</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="aacac73b24f1e8b05d35fabe2322578e8" name="aacac73b24f1e8b05d35fabe2322578e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacac73b24f1e8b05d35fabe2322578e8">&#9670;&#160;</a></span>llh_total</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SampleSummary::llh_total</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total LLH for the posterior predictive distribution. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00281">281</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a068e2a5ad0c02aaa57a27d2b12e37810" name="a068e2a5ad0c02aaa57a27d2b12e37810"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a068e2a5ad0c02aaa57a27d2b12e37810">&#9670;&#160;</a></span>LLHPenaltyVector</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleSummary::LLHPenaltyVector</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector to hold the penalty term. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00177">177</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a8c7537f32164be9192f8ba2b12a69cdb" name="a8c7537f32164be9192f8ba2b12a69cdb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c7537f32164be9192f8ba2b12a69cdb">&#9670;&#160;</a></span>lnLDrawHist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;TH2D&gt; SampleSummary::lnLDrawHist</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The 2D lnLhist, showing (draw vs data) and (draw vs fluct), anything above y=x axis is the p-value. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00221">221</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="aae188cf135af004d5364e5b4f3b1bb31" name="aae188cf135af004d5364e5b4f3b1bb31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae188cf135af004d5364e5b4f3b1bb31">&#9670;&#160;</a></span>lnLDrawHistRate</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;TH2D&gt; SampleSummary::lnLDrawHistRate</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The 2D lnLhist, showing (draw vs data) and (draw vs fluct), using rate, anything above y=x axis is the p-value. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00226">226</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="ae1aafef6414eafb5572893dded50a1b1" name="ae1aafef6414eafb5572893dded50a1b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1aafef6414eafb5572893dded50a1b1">&#9670;&#160;</a></span>lnLFlucHist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;TH2D&gt; SampleSummary::lnLFlucHist</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The 2D lnLHist, showing (draw vs data) and (draw vs draw fluct), anything above y=x axis is the p-value. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00223">223</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="ae509f51ec2d0323e005e05c255bc0c1f" name="ae509f51ec2d0323e005e05c255bc0c1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae509f51ec2d0323e005e05c255bc0c1f">&#9670;&#160;</a></span>lnLFlucHist_ProjectX</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;TH2D&gt; SampleSummary::lnLFlucHist_ProjectX</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The 2D lnLHist but for ProjectionX histogram (pmu), showing (draw vs data) and (draw vs draw fluct), anything above y=x axis is the p-value. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00228">228</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a70b109c60b7c82a3e36708bd2674cb5e" name="a70b109c60b7c82a3e36708bd2674cb5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70b109c60b7c82a3e36708bd2674cb5e">&#9670;&#160;</a></span>lnLHist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;TH1D&gt; SampleSummary::lnLHist</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The histogram containing the lnL for each throw. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00213">213</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="aaf23ed9a699d625adc8639a57de801e8" name="aaf23ed9a699d625adc8639a57de801e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf23ed9a699d625adc8639a57de801e8">&#9670;&#160;</a></span>lnLHist_drawdata</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;TH1D&gt; SampleSummary::lnLHist_drawdata</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The lnLhist for the draw vs data. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00219">219</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="aead1702a4c1522e685a8af5a875f05ab" name="aead1702a4c1522e685a8af5a875f05ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aead1702a4c1522e685a8af5a875f05ab">&#9670;&#160;</a></span>lnLHist_drawfluc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;TH1D&gt; SampleSummary::lnLHist_drawfluc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The lnLhist for the draw vs MC fluctuated. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00215">215</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="aa6f15a5750ae0224168d487e44ad3d94" name="aa6f15a5750ae0224168d487e44ad3d94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6f15a5750ae0224168d487e44ad3d94">&#9670;&#160;</a></span>lnLHist_drawflucdraw</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;TH1D&gt; SampleSummary::lnLHist_drawflucdraw</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The lnLhist for the draw vs draw fluctuated. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00217">217</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a154c9bd15825713c48154fab66190d39" name="a154c9bd15825713c48154fab66190d39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a154c9bd15825713c48154fab66190d39">&#9670;&#160;</a></span>lnLHist_Mean</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TH2Poly*&gt; SampleSummary::lnLHist_Mean</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The LLH distribution in pmu cosmu for using the mean in each bin. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00238">238</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a718c83e1952f948a5c063c2039a68a19" name="a718c83e1952f948a5c063c2039a68a19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a718c83e1952f948a5c063c2039a68a19">&#9670;&#160;</a></span>lnLHist_Mean1D</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TH1D*&gt; SampleSummary::lnLHist_Mean1D</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds the bin-by-bin LLH for the mean posterior predictive vs the data. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00253">253</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a7b1ba5b3b465f78019bb8c36ec5f56d7" name="a7b1ba5b3b465f78019bb8c36ec5f56d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b1ba5b3b465f78019bb8c36ec5f56d7">&#9670;&#160;</a></span>lnLHist_Mean_ProjectX</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TH1D*&gt; SampleSummary::lnLHist_Mean_ProjectX</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The LLH distribution in pmu using the mean in each bin. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00243">243</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a03bbc94ee26b66875becf22255a205d2" name="a03bbc94ee26b66875becf22255a205d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03bbc94ee26b66875becf22255a205d2">&#9670;&#160;</a></span>lnLHist_Mode</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TH2Poly*&gt; SampleSummary::lnLHist_Mode</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The LLH distribution in pmu cosmu for using the mode in each bin. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00240">240</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a424b53de4d9e896526667ddb565e4a6b" name="a424b53de4d9e896526667ddb565e4a6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a424b53de4d9e896526667ddb565e4a6b">&#9670;&#160;</a></span>lnLHist_Mode1D</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TH1D*&gt; SampleSummary::lnLHist_Mode1D</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds the bin-by-bin LLH for the mode posterior predictive vs the data. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00255">255</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="aa61561a1e3594ac9250aaee26409245e" name="aa61561a1e3594ac9250aaee26409245e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa61561a1e3594ac9250aaee26409245e">&#9670;&#160;</a></span>lnLHist_Sample_DrawData</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TH1D*&gt; SampleSummary::lnLHist_Sample_DrawData</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The histogram containing the lnL (draw vs data) for each throw for each sample. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00231">231</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="afddd2abc0ec07b52dc9004880522ab5a" name="afddd2abc0ec07b52dc9004880522ab5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afddd2abc0ec07b52dc9004880522ab5a">&#9670;&#160;</a></span>lnLHist_Sample_DrawflucDraw</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TH1D*&gt; SampleSummary::lnLHist_Sample_DrawflucDraw</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The histogram containing the lnL (draw vs draw fluct) for each throw for each sample. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00233">233</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="aecf1c224162e1055e8306d438e1a3761" name="aecf1c224162e1055e8306d438e1a3761"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecf1c224162e1055e8306d438e1a3761">&#9670;&#160;</a></span>lnLHist_Sample_PredflucDraw</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TH1D*&gt; SampleSummary::lnLHist_Sample_PredflucDraw</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The histogram containing the lnL (draw vs pred fluct) for each throw for each sample. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00235">235</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="af5a3139cef917abfddc36dbb8d4ac2fd" name="af5a3139cef917abfddc36dbb8d4ac2fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5a3139cef917abfddc36dbb8d4ac2fd">&#9670;&#160;</a></span>maxBins</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; SampleSummary::maxBins</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Max Number of Bins per each sample. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00278">278</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a13177305e8fd4b97812b2ca563740bf2" name="a13177305e8fd4b97812b2ca563740bf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13177305e8fd4b97812b2ca563740bf2">&#9670;&#160;</a></span>MCVector</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;TH2Poly*&gt; &gt; SampleSummary::MCVector</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector of vectors which holds the loaded MC histograms. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00170">170</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="ab3eeac18b62f7ee3a5c943c3cd0e9b76" name="ab3eeac18b62f7ee3a5c943c3cd0e9b76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3eeac18b62f7ee3a5c943c3cd0e9b76">&#9670;&#160;</a></span>MCVectorByMode</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;std::vector&lt;TH2Poly*&gt; &gt; &gt; SampleSummary::MCVectorByMode</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector of vectors which holds the loaded MC histograms for each mode. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00174">174</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="af0edee6c71137e2a8150c7ba3e8fb6e0" name="af0edee6c71137e2a8150c7ba3e8fb6e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0edee6c71137e2a8150c7ba3e8fb6e0">&#9670;&#160;</a></span>MeanHist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TH2Poly*&gt; SampleSummary::MeanHist</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The posterior predictive distribution in pmu cosmu using the mean. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00246">246</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a20237446a72eda2dc833bfc72c7e42e1" name="a20237446a72eda2dc833bfc72c7e42e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20237446a72eda2dc833bfc72c7e42e1">&#9670;&#160;</a></span>MeanHist_ByMode</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH2Poly*** SampleSummary::MeanHist_ByMode</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The posterior predictive distribution in pmu cosmu using the mean. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00362">362</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a6191a0fc1c8f1f0889b3dedcc5485a3d" name="a6191a0fc1c8f1f0889b3dedcc5485a3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6191a0fc1c8f1f0889b3dedcc5485a3d">&#9670;&#160;</a></span>MeanHistCorrected</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TH2Poly*&gt; SampleSummary::MeanHistCorrected</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The posterior predictive distribution in pmu cosmu using the mean after applying Barlow-Beeston Correction. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00248">248</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a9b21ff74bb8ebd7c3af2c24e02f3d7dc" name="a9b21ff74bb8ebd7c3af2c24e02f3d7dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b21ff74bb8ebd7c3af2c24e02f3d7dc">&#9670;&#160;</a></span>ModeHist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TH2Poly*&gt; SampleSummary::ModeHist</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The posterior predictive distribution in pmu cosmu using the mode. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00250">250</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a6593fed9709673a6910f96adc88fc8f2" name="a6593fed9709673a6910f96adc88fc8f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6593fed9709673a6910f96adc88fc8f2">&#9670;&#160;</a></span>Modes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMaCh3Modes.html">MaCh3Modes</a>* SampleSummary::Modes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>MaCh3 Modes. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00370">370</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="af4767862e5c1f4e3319d16b861213555" name="af4767862e5c1f4e3319d16b861213555"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4767862e5c1f4e3319d16b861213555">&#9670;&#160;</a></span>nChainSteps</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int SampleSummary::nChainSteps</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of throws by user. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00266">266</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a49215601479aaa99f9f64d8f7c900385" name="a49215601479aaa99f9f64d8f7c900385"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49215601479aaa99f9f64d8f7c900385">&#9670;&#160;</a></span>nModelParams</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SampleSummary::nModelParams</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of parameters. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00376">376</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a503b0dc19bb1ad57e7f2560cc64feef9" name="a503b0dc19bb1ad57e7f2560cc64feef9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a503b0dc19bb1ad57e7f2560cc64feef9">&#9670;&#160;</a></span>NominalHist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TH2Poly*&gt; SampleSummary::NominalHist</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The nominal histogram for the selection. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00204">204</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="ab16d22bf65d2a9c15072901161fc160a" name="ab16d22bf65d2a9c15072901161fc160a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab16d22bf65d2a9c15072901161fc160a">&#9670;&#160;</a></span>nSamples</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SampleSummary::nSamples</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of samples. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00182">182</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="aa5c4055d4bb4dc720a4118032cdb4910" name="aa5c4055d4bb4dc720a4118032cdb4910"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5c4055d4bb4dc720a4118032cdb4910">&#9670;&#160;</a></span>nThrows</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int SampleSummary::nThrows</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of throws. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00275">275</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="aa7b948f290517a052f04f61dfa6af68f" name="aa7b948f290517a052f04f61dfa6af68f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7b948f290517a052f04f61dfa6af68f">&#9670;&#160;</a></span>Outputfile</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TFile* SampleSummary::Outputfile</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Output filename. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00286">286</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a4463f635de4e83c7ada683768454da82" name="a4463f635de4e83c7ada683768454da82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4463f635de4e83c7ada683768454da82">&#9670;&#160;</a></span>OutputName</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string SampleSummary::OutputName</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Output filename. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00284">284</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a78eb4766cc8b4758b909b6ce9113a56e" name="a78eb4766cc8b4758b909b6ce9113a56e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78eb4766cc8b4758b909b6ce9113a56e">&#9670;&#160;</a></span>OutputTree</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TTree* SampleSummary::OutputTree</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>TTree which we save useful information to. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00291">291</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a508ef812c8b1275580759832e33c98ee" name="a508ef812c8b1275580759832e33c98ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a508ef812c8b1275580759832e33c98ee">&#9670;&#160;</a></span>PosteriorHist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;std::unique_ptr&lt;TH1D&gt; &gt; &gt; SampleSummary::PosteriorHist</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The posterior predictive for the whole selection: this gets built after adding in the toys. Now an array of Th1ds, 1 for each poly bin, for each sample. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00188">188</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="aa6cfe4fb92b67f08b0d94f0fe1d8a3a2" name="aa6cfe4fb92b67f08b0d94f0fe1d8a3a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6cfe4fb92b67f08b0d94f0fe1d8a3a2">&#9670;&#160;</a></span>PosteriorHist_ByMode</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH1D**** SampleSummary::PosteriorHist_ByMode</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Histogram which corresponds to each bin in the sample's th2poly. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00364">364</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a2ced5be9bc8ba79530464d53b9c23797" name="a2ced5be9bc8ba79530464d53b9c23797"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ced5be9bc8ba79530464d53b9c23797">&#9670;&#160;</a></span>RandomHist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;TH1D&gt; SampleSummary::RandomHist</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds the history of which entries have been drawn in the MCMC file. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00258">258</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a364fb16938a26adbe59fdd057f4b9405" name="a364fb16938a26adbe59fdd057f4b9405"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a364fb16938a26adbe59fdd057f4b9405">&#9670;&#160;</a></span>rnd</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;TRandom3&gt; SampleSummary::rnd</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Random number generator. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00162">162</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a9ba7df41774c45a14c0a97e4accc9cc0" name="a9ba7df41774c45a14c0a97e4accc9cc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ba7df41774c45a14c0a97e4accc9cc0">&#9670;&#160;</a></span>SampleNames</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; SampleSummary::SampleNames</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>name for each sample </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00185">185</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="abd938805245ca6cfeb8c49363f5ff11c" name="abd938805245ca6cfeb8c49363f5ff11c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd938805245ca6cfeb8c49363f5ff11c">&#9670;&#160;</a></span>SamplePDF</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classsamplePDFBase.html">samplePDFBase</a>* SampleSummary::SamplePDF</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to samplePDF object, mostly used to get sample names, binning etc. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00367">367</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="ae502645ddf5c53a7a3f2c52566956bf3" name="ae502645ddf5c53a7a3f2c52566956bf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae502645ddf5c53a7a3f2c52566956bf3">&#9670;&#160;</a></span>StandardFluctuation</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool SampleSummary::StandardFluctuation</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: We have two methods for Poissonian fluctuation. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00167">167</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a2cb3d8dcbab49b62be3bc2a4a7e4d5f3" name="a2cb3d8dcbab49b62be3bc2a4a7e4d5f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cb3d8dcbab49b62be3bc2a4a7e4d5f3">&#9670;&#160;</a></span>total_llh_data_draw</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SampleSummary::total_llh_data_draw</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Data vs Draw. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00328">328</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a5a973692db89f52c19c9195ffe95c9a1" name="a5a973692db89f52c19c9195ffe95c9a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a973692db89f52c19c9195ffe95c9a1">&#9670;&#160;</a></span>total_llh_data_draw_ProjectX</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SampleSummary::total_llh_data_draw_ProjectX</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Data vs Draw for projection X (most likely muon momentum) </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00355">355</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a670c890357fd77997279c83c197f989c" name="a670c890357fd77997279c83c197f989c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a670c890357fd77997279c83c197f989c">&#9670;&#160;</a></span>total_llh_data_drawfluc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SampleSummary::total_llh_data_drawfluc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Data vs Fluctuated Draw. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00342">342</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="aeee48af77dc4e0beee5eab13c30f3d38" name="aeee48af77dc4e0beee5eab13c30f3d38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeee48af77dc4e0beee5eab13c30f3d38">&#9670;&#160;</a></span>total_llh_data_predfluc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SampleSummary::total_llh_data_predfluc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Data vs Fluctuated Predictive. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00340">340</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="af9e5d89095e6c6a81aedb5ea2402e3fb" name="af9e5d89095e6c6a81aedb5ea2402e3fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9e5d89095e6c6a81aedb5ea2402e3fb">&#9670;&#160;</a></span>total_llh_datafluc_draw</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SampleSummary::total_llh_datafluc_draw</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fluctuated Data vs Draw. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00350">350</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a58efe34df7c43fb40d211036e30a1b5d" name="a58efe34df7c43fb40d211036e30a1b5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58efe34df7c43fb40d211036e30a1b5d">&#9670;&#160;</a></span>total_llh_draw_pred</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SampleSummary::total_llh_draw_pred</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Draw vs Predictive. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00344">344</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a7e418146cce2c4201c3aa7e1eaad4a38" name="a7e418146cce2c4201c3aa7e1eaad4a38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e418146cce2c4201c3aa7e1eaad4a38">&#9670;&#160;</a></span>total_llh_drawfluc_draw</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SampleSummary::total_llh_drawfluc_draw</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fluctuated Draw vs Draw. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00330">330</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a22df11667306c7892f9ed3f8935a5c9e" name="a22df11667306c7892f9ed3f8935a5c9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22df11667306c7892f9ed3f8935a5c9e">&#9670;&#160;</a></span>total_llh_drawfluc_draw_ProjectX</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SampleSummary::total_llh_drawfluc_draw_ProjectX</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fluctuated Draw vs Draw for projection X (most likely muon momentum) </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00357">357</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a9c8b444ac7f80a5af63d5b9f4a150b79" name="a9c8b444ac7f80a5af63d5b9f4a150b79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c8b444ac7f80a5af63d5b9f4a150b79">&#9670;&#160;</a></span>total_llh_drawfluc_pred</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SampleSummary::total_llh_drawfluc_pred</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fluctuated Draw vs Predictive. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00346">346</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="af92a42a666e1bfcb2dc761ffa2253b7e" name="af92a42a666e1bfcb2dc761ffa2253b7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af92a42a666e1bfcb2dc761ffa2253b7e">&#9670;&#160;</a></span>total_llh_drawfluc_predfluc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SampleSummary::total_llh_drawfluc_predfluc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fluctuated Draw vs Fluctuated Predictive. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00348">348</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a804a117990fd1441c9e3a9d8e8d32e98" name="a804a117990fd1441c9e3a9d8e8d32e98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a804a117990fd1441c9e3a9d8e8d32e98">&#9670;&#160;</a></span>total_llh_predfluc_draw</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SampleSummary::total_llh_predfluc_draw</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fluctuated Predictive vs Draw. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00332">332</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a1f6c2e7ed8f9024cf928da5b56054e07" name="a1f6c2e7ed8f9024cf928da5b56054e07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f6c2e7ed8f9024cf928da5b56054e07">&#9670;&#160;</a></span>total_llh_predfluc_pred</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SampleSummary::total_llh_predfluc_pred</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fluctuated Predictive vs Predictive. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00352">352</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="aaf055562efe3e5f2592942f5151ece22" name="aaf055562efe3e5f2592942f5151ece22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf055562efe3e5f2592942f5151ece22">&#9670;&#160;</a></span>total_llh_rate_data_draw</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SampleSummary::total_llh_rate_data_draw</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Rate Data vs Draw. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00335">335</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a2ebe701d114669fdfcf61e1680bb144d" name="a2ebe701d114669fdfcf61e1680bb144d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ebe701d114669fdfcf61e1680bb144d">&#9670;&#160;</a></span>total_llh_rate_predfluc_draw</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double SampleSummary::total_llh_rate_predfluc_draw</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fluctuated Predictive vs Draw using Rate. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00337">337</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a4a93fa8d52abe2828a4a25e49cf6fee8" name="a4a93fa8d52abe2828a4a25e49cf6fee8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a93fa8d52abe2828a4a25e49cf6fee8">&#9670;&#160;</a></span>ViolinHists_ProjectX</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TH2D*&gt; SampleSummary::ViolinHists_ProjectX</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Posterior predictive but for X projection but as a violin plot. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00193">193</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a93714cf9b778fa7713a641da0cd2d534" name="a93714cf9b778fa7713a641da0cd2d534"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93714cf9b778fa7713a641da0cd2d534">&#9670;&#160;</a></span>ViolinHists_ProjectY</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TH2D*&gt; SampleSummary::ViolinHists_ProjectY</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Posterior predictive but for Y projection but as a violin plot. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00195">195</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="aa6773885be1b6a2660493718823a2f3f" name="aa6773885be1b6a2660493718823a2f3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6773885be1b6a2660493718823a2f3f">&#9670;&#160;</a></span>w2Hist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;std::unique_ptr&lt;TH1D&gt; &gt; &gt; SampleSummary::w2Hist</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The posterior predictive for the whole selection: this gets built after adding in the toys. Now an array of Th1ds, 1 for each poly bin, for each sample for W2. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00190">190</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a263b7541545b8b0ba735e0a3ac2d31e7" name="a263b7541545b8b0ba735e0a3ac2d31e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a263b7541545b8b0ba735e0a3ac2d31e7">&#9670;&#160;</a></span>W2MCVector</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;TH2Poly*&gt; &gt; SampleSummary::W2MCVector</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector of vectors which holds the loaded W2 histograms. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00172">172</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a2828111584f80f855b56a9a093987673" name="a2828111584f80f855b56a9a093987673"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2828111584f80f855b56a9a093987673">&#9670;&#160;</a></span>W2MeanHist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TH2Poly*&gt; SampleSummary::W2MeanHist</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to the w2 histograms (for mean values). </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00208">208</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="adf9b943ba381875b3f2e0c4807a9b8c4" name="adf9b943ba381875b3f2e0c4807a9b8c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf9b943ba381875b3f2e0c4807a9b8c4">&#9670;&#160;</a></span>W2ModeHist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TH2Poly*&gt; SampleSummary::W2ModeHist</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to the w2 histograms (for mode values). </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00210">210</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="a9c37d8669c0f55f6a4620b4f0d7b6e20" name="a9c37d8669c0f55f6a4620b4f0d7b6e20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c37d8669c0f55f6a4620b4f0d7b6e20">&#9670;&#160;</a></span>W2NomHist</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TH2Poly*&gt; SampleSummary::W2NomHist</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to the w2 histograms (for nominal values). </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00206">206</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<a id="ad40a0514f4be18ef026ea41bd5965fa3" name="ad40a0514f4be18ef026ea41bd5965fa3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad40a0514f4be18ef026ea41bd5965fa3">&#9670;&#160;</a></span>WeightVector</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; SampleSummary::WeightVector</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector holding weight. </p>

<p class="definition">Definition at line <a class="el" href="SampleSummary_8h_source.html#l00179">179</a> of file <a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>mcmc/<a class="el" href="SampleSummary_8h_source.html">SampleSummary.h</a></li>
<li>mcmc/<a class="el" href="SampleSummary_8cpp_source.html">SampleSummary.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
